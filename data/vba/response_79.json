[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1468448596, "post_id": 38362456, "comment_id": 64137713, "body": "in <code>CF Backlog.xls</code> go to the <code>Name Manager</code> in the Formulas tab and see if the Name <code>DATA</code> is there"}, {"owner": {"reputation": 27492, "user_id": 3773011, "user_type": "moderator", "profile_image": "https://i.stack.imgur.com/Hmfxy.jpg?s=128&g=1", "display_name": "Makyen", "link": "https://stackoverflow.com/users/3773011/makyen"}, "edited": false, "score": 0, "creation_date": 1468451633, "post_id": 38362456, "comment_id": 64138667, "body": "@cyboashu, I rejected your proposed edit as I did not feel you did enough. While what you did was an improvement, you should make all improvements which you reasonably see in one edit. In this case, the minimum that I would have expected was that you make the obvious capitalization changes to have capital letters at the beginning of sentences and change &quot; i &quot; to &quot; I &quot;. Just those significantly improve readability. In this instance (and most of the time), some method to distinguish the error text, usually code format, should be used (quote format can be OK, but is not preferred)"}, {"owner": {"reputation": 27492, "user_id": 3773011, "user_type": "moderator", "profile_image": "https://i.stack.imgur.com/Hmfxy.jpg?s=128&g=1", "display_name": "Makyen", "link": "https://stackoverflow.com/users/3773011/makyen"}, "edited": false, "score": 0, "creation_date": 1468451871, "post_id": 38362456, "comment_id": 64138733, "body": "@azerty, I have made the assumption that the text I indicated as the error text is exactly what was displayed to you as the error. If this is not the case, please <a href=\"https://stackoverflow.com/posts/38362456/edit\">edit</a> your question to include the exact text displayed. Another time, please indicate that you are providing the exact error text by putting it in code format, quote format, or enclosing it in quotes."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5654204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15de4d6b346e55ff1451fdb7697908c6?s=128&d=identicon&r=PG&f=1", "display_name": "azerty", "link": "https://stackoverflow.com/users/5654204/azerty"}, "edited": false, "score": 0, "creation_date": 1468452441, "post_id": 38363208, "comment_id": 64138875, "body": "Range(&quot;&#39;CF Backlog.xls&#39;!DATA&quot;).Select  gives me an error. can you suggest me what to do please ? thank you very much"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 13, "user_id": 5654204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15de4d6b346e55ff1451fdb7697908c6?s=128&d=identicon&r=PG&f=1", "display_name": "azerty", "link": "https://stackoverflow.com/users/5654204/azerty"}, "edited": false, "score": 0, "creation_date": 1468452584, "post_id": 38363208, "comment_id": 64138917, "body": "In <code>CF Backlog.xls</code> go to the Name Manager in the Formulas tab and see if the Name <code>DATA</code> is there"}, {"owner": {"reputation": 13, "user_id": 5654204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15de4d6b346e55ff1451fdb7697908c6?s=128&d=identicon&r=PG&f=1", "display_name": "azerty", "link": "https://stackoverflow.com/users/5654204/azerty"}, "edited": false, "score": 0, "creation_date": 1468485548, "post_id": 38363208, "comment_id": 64149747, "body": "Thank you all for your help. i could resolve it. the problem was in Range(&quot;&#39;CF Backlog.xls&#39;!DATA&quot;)"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 2, "last_activity_date": 1468451734, "creation_date": 1468451734, "answer_id": 38363208, "question_id": 38362456, "link": "https://stackoverflow.com/questions/38362456/vba-runtime-error-1004-the-extract-range-has-a-missing-or-invalid-field-name/38363208#38363208", "title": "VBA Runtime Error 1004 the extract range has a missing or invalid field name", "body": "<p>Maybe try clearing the destination range</p>\n\n<pre><code>Sheets(\"Template\").Activate\nRange(\"A1:B2\").Select\nActiveWorkbook.Names.Add Name:=\"Criteria\", RefersToR1C1:= \"=Template!R1C1:R2C2\"\n'ActiveWorkbook.Names.Add Name:=\"Criteria\", RefersToR1C1:= \"=Template!R1C1:R2C2\" ' why do you add the same named range two times ??!!\nRange(\"C1:BJ1\").ClearContents  ' &lt;-- uncomment this line \nRange(\"'CF Backlog.xls'!DATA\").Select  ' and check if this gives any error\nRange(\"'CF Backlog.xls'!DATA\").AdvancedFilter Action:=xlFilterCopy, _\n    CriteriaRange:=Range(\"A1:B2\"), CopyToRange:=Range(\"C1:BJ1\"), Unique:= _\n    False\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5654204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15de4d6b346e55ff1451fdb7697908c6?s=128&d=identicon&r=PG&f=1", "display_name": "azerty", "link": "https://stackoverflow.com/users/5654204/azerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7881, "favorite_count": 0, "accepted_answer_id": 38363208, "answer_count": 1, "score": 1, "last_activity_date": 1468451734, "creation_date": 1468447360, "last_edit_date": 1468451442, "question_id": 38362456, "link": "https://stackoverflow.com/questions/38362456/vba-runtime-error-1004-the-extract-range-has-a-missing-or-invalid-field-name", "title": "VBA Runtime Error 1004 the extract range has a missing or invalid field name", "body": "<p>Please, I am getting an error in this part of my macro. It shows me this error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>1004 the extract range has a missing or invalid field name\n</code></pre>\n\n<p>In this line:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Range(\"'CF Backlog.xls'!DATA\").AdvancedFilter Action:=xlFilterCopy, _\n    CriteriaRange:=Range(\"A1:B2\"), CopyToRange:=Range(\"C1:BJ1\"), Unique:= _\n    False\n</code></pre>\n\n<p>Code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sheets(\"Template\").Activate\nRange(\"A1:B2\").Select\nActiveWorkbook.Names.Add Name:=\"Criteria\", RefersToR1C1:= _\n    \"=Template!R1C1:R2C2\"\nActiveWorkbook.Names.Add Name:=\"Criteria\", RefersToR1C1:= _\n    \"=Template!R1C1:R2C2\"\n     'Range(\"C1:BJ1\").ClearContents\nRange(\"'CF Backlog.xls'!DATA\").AdvancedFilter Action:=xlFilterCopy, _\n    CriteriaRange:=Range(\"A1:B2\"), CopyToRange:=Range(\"C1:BJ1\"), Unique:= _\n    False\n</code></pre>\n\n<p>I have spent many hours checking forums. But, I still can't fix the problem. Any suggestions?</p>\n"}, {"tags": ["sql", "vb.net", "ms-access", "vba"], "comments": [{"owner": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1468446385, "post_id": 38362211, "comment_id": 64136862, "body": "On which line do you get the exception?"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1468456468, "post_id": 38362211, "comment_id": 64139781, "body": "The data mismatch is because you are not using SQL parameters.  Period.  The DbNull conversion error may result when no records match the query passed, which may be malformed due to not using SQL Parameters.  Also your app is leaking resources.  And use SQL Parameters."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6525829, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154729887266111/picture?type=large", "display_name": "Edgar Serna", "link": "https://stackoverflow.com/users/6525829/edgar-serna"}, "edited": false, "score": 0, "creation_date": 1468447727, "post_id": 38362343, "comment_id": 64137383, "body": "I changed to .Value and now the error message shows this &quot;Syntax error (missing operator) in the expression &#39;IdEmployee =  1 AND Date &gt;= 02/07/2016 05:06:37 pm AND Date &gt;= 08/07/2016 05:06:37 pm&#39;. &quot;"}], "tags": [], "owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "is_accepted": false, "score": 0, "last_activity_date": 1468446850, "creation_date": 1468446850, "answer_id": 38362343, "question_id": 38362211, "link": "https://stackoverflow.com/questions/38362211/cant-retrieve-data-from-access-db-query-to-my-vb-program/38362343#38362343", "title": "Can&#39;t retrieve data from Access DB query to my VB program", "body": "<p>I suspect this is because you use Textbox.Text for your datepickers. You can only use that property when the control has focus. Try replacing those with .Value ?</p>\n"}, {"tags": [], "owner": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "is_accepted": false, "score": 1, "last_activity_date": 1468451794, "creation_date": 1468451794, "answer_id": 38363219, "question_id": 38362211, "link": "https://stackoverflow.com/questions/38362211/cant-retrieve-data-from-access-db-query-to-my-vb-program/38363219#38363219", "title": "Can&#39;t retrieve data from Access DB query to my VB program", "body": "<p>I haven't written Access queries in years and do not have it to try now, but if I remember correctly DateTime values in the query need to be surrounded with hash marks (#).</p>\n\n<pre><code>Dim qHrsWorked As String = _\n    \"SELECT SUM(Hrs_worked) FROM Work WHERE IdEmployee = \" &amp; idEmptxt.Text &amp; _\n    \" AND Date &gt;= #\" &amp; firstDayDTP.Value &amp; \"# AND Date &lt;= #\" &amp; LastDayDTP.Value &amp; \"#\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 6525829, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154729887266111/picture?type=large", "display_name": "Edgar Serna", "link": "https://stackoverflow.com/users/6525829/edgar-serna"}, "edited": false, "score": 0, "creation_date": 1468510071, "post_id": 38369592, "comment_id": 64166609, "body": "Thank you very very much"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1468486151, "creation_date": 1468486151, "answer_id": 38369592, "question_id": 38362211, "link": "https://stackoverflow.com/questions/38362211/cant-retrieve-data-from-access-db-query-to-my-vb-program/38369592#38369592", "title": "Can&#39;t retrieve data from Access DB query to my VB program", "body": "<p>In SQL you must use a formatted string expression for the date values:</p>\n\n<pre><code>Dim qHrsWorked As String = \"SELECT SUM(Hrs_worked) FROM Work WHERE IdEmployee = \" &amp; idEmptxt.Text &amp; \" AND Date &gt;= #\" &amp; firstDayDTP.Value.ToString(\"yyyy'/'MM'/'dd\") &amp; \"# AND Date &lt;= #\" &amp; lastDayDTP.Value.ToString(\"yyyy'/'MM'/'dd\") &amp; \"#\"\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6525829, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154729887266111/picture?type=large", "display_name": "Edgar Serna", "link": "https://stackoverflow.com/users/6525829/edgar-serna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 38369592, "answer_count": 3, "score": 0, "last_activity_date": 1594641757, "creation_date": 1468446230, "last_edit_date": 1594641757, "question_id": 38362211, "link": "https://stackoverflow.com/questions/38362211/cant-retrieve-data-from-access-db-query-to-my-vb-program", "title": "Can&#39;t retrieve data from Access DB query to my VB program", "body": "<p>So this is my code so far...\nI have 2 DateTimePickers in which the user selects the first day of the week and the last day of the week, once selected these two I want to calculate the hours worked on each day and add them so I can display the amount of hours worked of the interval of days selected.  </p>\n\n<p>My Work table contains an idEmployee, Date, ArrivalTime, DepartureTime, and a calculated column(Hrs_worked) that displays the amount of hours worked on that day.</p>\n\n<p>When I run the program a message box pops an shows this \"Conversion from type 'DBNull' to type 'String' is not valid\" or \"Mismatch of data in the expression of criteria\"\nDo I need to change the datetimepickers values to string values? </p>\n\n<p>Im working on Visual Basic Express 2010 with an Access Database</p>\n\n<pre><code>Private Sub Button4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button4.Click\n\n    Dim provider As String = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source =\"\n    Dim dataFile As String = \"E:\\SIDB.accdb\"\n    Dim connString As String = provider &amp; dataFile\n    Dim myConnection As OleDbConnection\n    Dim cmd As OleDbCommand\n\n    Dim qHrsWorked As String = \"SELECT SUM(Hrs_worked) FROM Work WHERE IdEmployee = \" &amp; idEmptxt.Text &amp; \" AND Date &gt;= \" &amp; firstDayDTP.Value &amp; \" AND Date &lt;= \" &amp; lastDayDTP.Value &amp; \"\"\n\n    myConnection = New OleDbConnection(connString)\n    Try\n        myConnection.Open()\n        cmd = New OleDbCommand(qHrsWorked, myConnection)\n        Dim reader As OleDbDataReader = cmd.ExecuteReader()\n\n        While reader.Read\n            hrsWorkedtxt.Text = reader.Item(0)\n\n        End While\n        reader.Close()\n        cmd.Dispose()\n        myConnection.Close()\n\n    Catch ex As Exception\n        MessageBox.Show(ex.Message)\n    End Try\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros", "excel-2010"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1468446453, "post_id": 38362174, "comment_id": 64136896, "body": "its a nice article and long one too. :) But what is the actual error message and which line?"}, {"owner": {"reputation": 45, "user_id": 6553519, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/90875031c28fdf180188e36d77708617?s=128&d=identicon&r=PG&f=1", "display_name": "WalterC", "link": "https://stackoverflow.com/users/6553519/walterc"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1468446725, "post_id": 38362174, "comment_id": 64136996, "body": "&quot;Run-time error &#39;92&#39; For Loop not initialized&quot; at the Next line"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6553519, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/90875031c28fdf180188e36d77708617?s=128&d=identicon&r=PG&f=1", "display_name": "WalterC", "link": "https://stackoverflow.com/users/6553519/walterc"}, "edited": false, "score": 0, "creation_date": 1468448131, "post_id": 38362400, "comment_id": 64137542, "body": "When I do this it looks like I get into an infinite loop. Or something that makes it crash"}, {"owner": {"reputation": 45, "user_id": 6553519, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/90875031c28fdf180188e36d77708617?s=128&d=identicon&r=PG&f=1", "display_name": "WalterC", "link": "https://stackoverflow.com/users/6553519/walterc"}, "edited": false, "score": 0, "creation_date": 1468449216, "post_id": 38362400, "comment_id": 64137922, "body": "I&#39;ll try that. Since I&#39;m still new to vba could you explain what GoTo 0 does? I assume it means something like go to beginning of something"}, {"owner": {"reputation": 45, "user_id": 6553519, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/90875031c28fdf180188e36d77708617?s=128&d=identicon&r=PG&f=1", "display_name": "WalterC", "link": "https://stackoverflow.com/users/6553519/walterc"}, "edited": false, "score": 0, "creation_date": 1468449918, "post_id": 38362400, "comment_id": 64138179, "body": "That seems to have solved my problem. I&#39;ve also cleaned up my code so now it&#39;s just an error handle instead of a way to also skip code for the other stuff. I&#39;m just getting a random type mismatch error when it&#39;s on the master sheet but I&#39;m pretty sure I can fix that since that doesn&#39;t seem to be anything to do with my with the loop. Thanks for your help and advice"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 3, "last_activity_date": 1468449435, "last_edit_date": 1468449435, "creation_date": 1468447154, "answer_id": 38362400, "question_id": 38362174, "link": "https://stackoverflow.com/questions/38362174/looping-through-all-sheets-getting-error-at-end/38362400#38362400", "title": "Looping through all sheets, getting error at end", "body": "<p>I believe your problem might be because you are trying to use ErrCatch7 as an error handler.</p>\n\n<p>I suggest you replace \"On Error GoTo ErrCatch7\" with \"On Error GoTo ErrCatch7Err\", then include a section at the very end of your procedure (after an Exit Sub or Exit Function) which says:</p>\n\n<pre><code>ErrCatch7Err:\n    Resume ErrCatch7\n</code></pre>\n\n<p>Edit:  Based on what Maciej Los just said, it is also a problem that your error handler is enabled while outside the For Next loop as well as inside it.  I would recommend that you use</p>\n\n<pre><code>    ...\n    For Each WSCount In Worksheets\n        On Error GoTo ErrCatch7Err\n        ...\n        ... (other code, including \"GoTo ErrCatch7\" statements if needed)\n        ...\nErrCatch7:\n    Next\n    On Error GoTo 0\n    ...\n    Exit Sub\nErrCatch7Err:\n    Resume ErrCatch7\n</code></pre>\n\n<p>If you want an error handler to cover errors in the</p>\n\n<pre><code>MastLastRow = Sheets(\"Master\").Range(\"A7\").CurrentRegion.Rows.Count\n</code></pre>\n\n<p>statement which occurs before your loop starts, use a different handler.  (You would want different actions to be performed in that case anyway, so using the same handler makes no real sense.)</p>\n\n<p>As an example of the difference between using ErrCatch7 as the target of the On Error condition, and using a separate label as the target, consider the following two code samples:</p>\n\n<p>Sample 1:</p>\n\n<pre><code>Sub TestMe()\n    On Error GoTo ErrCatch7\n    For i = 1 To 10\n        MsgBox i\n        j = i / 0\n        MsgBox j\nErrCatch7:\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Sample 2:</p>\n\n<pre><code>Sub TestMe()\n    On Error GoTo ErrCatch7\n    For i = 1 To 10\n        MsgBox i\n        j = i / 0\n        MsgBox j\nErrCatch7:\n    Next i\n    Exit Sub\nErrCatch7Err:\n    Resume ErrCatch7\nEnd Sub\n</code></pre>\n\n<p>Sample 1 will display the number 1, then (while still handling the \"1 / 0\" error) 2, then (while attempting \"2 / 0\") give a division by zero error.</p>\n\n<p>Sample 2 will display all the numbers from 1 to 10.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 6553519, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/90875031c28fdf180188e36d77708617?s=128&d=identicon&r=PG&f=1", "display_name": "WalterC", "link": "https://stackoverflow.com/users/6553519/walterc"}, "edited": false, "score": 0, "creation_date": 1468448414, "post_id": 38362434, "comment_id": 64137656, "body": "How would I go about ignoring a sheet where I expect to get an error and continuing on to other sheets instead of stopping the process at the error then?"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1468449631, "post_id": 38362434, "comment_id": 64138058, "body": "If you expect an error, use and if statement and/or sub routine to catch it before it catches you."}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 2, "last_activity_date": 1468447291, "creation_date": 1468447291, "answer_id": 38362434, "question_id": 38362174, "link": "https://stackoverflow.com/questions/38362174/looping-through-all-sheets-getting-error-at-end/38362434#38362434", "title": "Looping through all sheets, getting error at end", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg251385.aspx\" rel=\"nofollow\">MSDN documentation</a> states:</p>\n\n<blockquote>\n  <p>You jumped into the middle of a For...Next loop. Remove the jump into the loop. <strong>Placing labels inside a For...Next loop isn't recommended.</strong></p>\n</blockquote>\n\n<p>The issue is here:\n</p>\n\n<pre><code>           'before loop\n            On Error GoTo ErrCatch7:\n            MastLastRow = Sheets(\"Master\").Range(\"A7\").CurrentRegion.Rows.Count\n            For Each WSCount In Worksheets\n            ....\n            'jump into the loop is here\n       ErrCatch7:\n            Next\n</code></pre>\n\n<p>The simplest way to resolve your problem is to debug programme using <code>F8</code> key.</p>\n"}, {"tags": [], "owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "is_accepted": false, "score": 1, "last_activity_date": 1468448953, "last_edit_date": 1525816150, "creation_date": 1468448953, "answer_id": 38362764, "question_id": 38362174, "link": "https://stackoverflow.com/questions/38362174/looping-through-all-sheets-getting-error-at-end/38362764#38362764", "title": "Looping through all sheets, getting error at end", "body": "<p>As answered <a href=\"https://stackoverflow.com/questions/11998836/excel-vba-on-error-goto-statement-not-working-inside-for-loop\">here</a> and <a href=\"https://stackoverflow.com/questions/7653287/vba-error-handling-in-loop\">here</a>:  </p>\n\n<blockquote>\n  <p>With the code as shown, you're actually still considered to be within\n  the error handling routine when you strike the next statement.</p>\n  \n  <p>That means that subsequent error handlers are not allowed until you\n  resume from the current one.</p>\n</blockquote>\n\n<p>A better architecture in your case would be something like: </p>\n\n<pre><code>        'before loop\n        On Error GoTo ErrCatch7\n        MastLastRow = Sheets(\"Master\").Range(\"A7\").CurrentRegion.Rows.Count\n        For Each WSCount In Worksheets\n        ....\n   NextWorksheet:\n        Next\n        ' the rest of your code\n\n   ErrCatch7:\n        Resume NextWorksheet\n</code></pre>\n\n<p>As also already mentioned in the answers above, you can find a great explanation about the problem in <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">this site</a></p>\n"}], "owner": {"reputation": 45, "user_id": 6553519, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/90875031c28fdf180188e36d77708617?s=128&d=identicon&r=PG&f=1", "display_name": "WalterC", "link": "https://stackoverflow.com/users/6553519/walterc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "accepted_answer_id": 38362400, "answer_count": 3, "score": 0, "last_activity_date": 1468449435, "creation_date": 1468446106, "question_id": 38362174, "link": "https://stackoverflow.com/questions/38362174/looping-through-all-sheets-getting-error-at-end", "title": "Looping through all sheets, getting error at end", "body": "<p>So I have a workbook with a master sheet and subordinate sheets and among other things (hence the choice = 7 thing) it calculates the totals for every row and every column of the data portion of the sheet as well as the total for all data. I have this part working but then when I went on to the next step/option of comparing the total of the master sheet to the sum of the totals of the subordinate sheets (with the addition of recalculating the totals of each sheet in case of changes or one wasn't filled out etc) I run into an error.</p>\n\n<p>It executes the totals functionality well on every sheet and then it seems to run into an issue at the end of the loop. Not every sheet in this workbook is a data sheet and thus does not adhere to the specific layout the others are. Since these are not in any particular order, I have in my code to just skip them. It does this by intentionally catching the error that arises from working with something not adhering to the layout of the others and then skipping to the bottom of the loop. </p>\n\n<p>At the moment I only have one of these extra sheets and I tried taking it out but it still gets an error near the end of the loop. The weird thing is that even though I have an error handling, it doesn't seem to be caught by it. k here is the sum of the subordinate totals, Position is just a max value (I wanted to make use of all my variables even if they weren't important in other functionalities), any odd numbers like MastLastRow - 6 is to account for the labels and other parts of the sheet that are not the data portion, and the flag part is making sure that someone didn't accidentally delete data. While I have multiple lines where I GoTo ErrCatch7: these just help me skip to the bottom and the only error that should come up anywhere in the code is when hitting an extra sheet. If you need any more possible clarification as to what in the code is doing what or need me to post a picture showing the spreadsheet let me know</p>\n\n<pre><code>ElseIf Fchoice = \"7\" Then\n                k = 0\n                Application.Calculation = xlCalculationManual\n                Application.ScreenUpdating = False\n                Application.DisplayStatusBar = False\n                On Error GoTo ErrCatch7:\n                MastLastRow = Sheets(\"Master\").Range(\"A7\").CurrentRegion.Rows.Count\n                For Each WSCount In Worksheets\n                    If WSCount.Name = \"Master\" Then\n                        MastLastCol = Sheets(\"Master\").Range(\"A5\").CurrentRegion.Columns.Count\n                        If Sheets(\"Master\").Range(\"C7\").Offset(MastLastRow - 7, 0) = \"\" Then\n                            Sheets(\"Master\").Range(\"C7\").Offset(MastLastRow - 7, 0).EntireRow.ClearContents\n                        End If\n                        MastLastRow = Sheets(\"Master\").Range(\"A7\").CurrentRegion.Rows.Count\n                        j = -1\n                        i = 0\n                        Set TempM = Range(\"H7\")\n                        Do While i &lt; MastLastRow - 6\n                            Set TempP = Range(TempM.Offset(0, 1), TempM.Offset(0, MastLastCol))\n                            TempM.Value = Application.Sum(TempP)\n                            Set TempM = TempM.Offset(1, 0)\n                            i = i + 1\n                        Loop\n\n                        Do While j &lt; MastLastCol - 8\n                            Set TempP = Sheets(\"Master\").Range(TempM.Offset(-1, 0), Sheets(\"Master\").Range(\"I7\").Offset(0, j))\n                            TempM.Value = Application.Sum(TempP)\n                            Set TempM = TempM.Offset(0, 1)\n                            j = j + 1\n                        Loop\n\n                        Sheets(\"Master\").Range(\"H7\").Offset(MastLastRow - 6, 0).Font.ColorIndex = 6\n                        Sheets(\"Master\").Range(\"H7\").Offset(MastLastRow - 6, 0).Interior.Color = RGB(0, 0, 255)\n                        Sheets(\"Master\").Range(\"H7\").Offset(MastLastRow - 6, -1).Value = \"Sheet Total\"\n                        GoTo ErrCatch7:\n                    Else\n                        Set MastData = Sheets(\"Master\").Range(\"A7\")\n                        Set SubordData = WSCount.Range(\"A7\")\n                        SubordLastRow = WSCount.Range(\"A7\").CurrentRegion.Rows.Count\n                        SubordLastCol = WSCount.Range(\"A5\").CurrentRegion.Columns.Count\n                        If WSCount.Range(\"C7\").Offset(SubordLastRow - 7, 0) = \"\" Then\n                            WSCount.Range(\"C7\").Offset(SubordLastRow - 7, 0).EntireRow.ClearContents\n                        End If\n                        SubordLastRow = WSCount.Range(\"A7\").CurrentRegion.Rows.Count\n                        Flag = True\n                        If MastLastRow &gt; SubordLastRow Then\n                            Position = MastLastRow\n                        Else\n                            Position = SubordLastRow\n                        End If\n\n                        'Check if tasks in subordinate sheet have been mistakenly erased or misformated\n                        Do While i &lt; Position And j &lt; Position\n                            If MastData.Offset(i, 0).Value = SubordData.Offset(j, 0).Value Then\n                                i = i + 1\n                                j = j + 1\n                            ElseIf MastData.Offset(i, 0).Value = SubordData.Offset(j, 0).Value And MastData.Offset(i, 0).Value = vbNullString Then\n                                i = i + 1\n                                j = j + 1\n                            ElseIf MastData.Offset(i, 0).Value = vbNullString And SubordData.Offset(j, 0).Value &lt;&gt; vbNullString Then\n                                i = i + 1\n                            ElseIf SubordData.Offset(j, 0).Value = vbNullString And MastData.Offset(i, 0).Value &lt;&gt; vbNullString Then\n                                j = j + 1\n                            Else\n                                Flag = False\n                                Exit Do\n                            End If\n                        Loop\n                        If Flag = False Then\n                            MsgBox (OrgName + \" appears to be missing tasks. This sheet will be ignored. Check for mistakes and compare totals later\")\n                            GoTo ErrCatch7:\n                        End If\n                        j = -1\n                        i = 0\n                        Set TempM = WSCount.Range(\"H7\")\n                        Do While i &lt; SubordLastRow - 6\n                            Set TempP = WSCount.Range(TempM.Offset(0, 1), TempM.Offset(0, SubordLastCol))\n                            TempM.Value = Application.Sum(TempP)\n                            Set TempM = TempM.Offset(1, 0)\n                            i = i + 1\n                        Loop\n\n                        Do While j &lt; SubordLastCol - 8\n                            Set TempP = WSCount.Range(TempM.Offset(-1, 0), WSCount.Range(\"I7\").Offset(0, j))\n                            TempM.Value = Application.Sum(TempP)\n                            Set TempM = TempM.Offset(0, 1)\n                            j = j + 1\n                        Loop\n\n                        WSCount.Range(\"H7\").Offset(SubordLastRow - 6, 0).Font.ColorIndex = 6\n                        WSCount.Range(\"H7\").Offset(SubordLastRow - 6, 0).Interior.Color = RGB(0, 0, 255)\n                        WSCount.Range(\"H7\").Offset(SubordLastRow - 6, -1).Value = \"Sheet Total\"\n                    End If\n                    k = k + WSCount.Range(\"H7\").Offset(SubordLastRow - 6, 0).Value\n    ErrCatch7:\n                Next\n                Application.Calculation = xlCalculationAutomatic\n                Application.ScreenUpdating = True\n                Application.DisplayStatusBar = True\n                MsgBox (\"Master sheet hourly total = \" + Sheets(\"Master\").Range(\"H7\").Offset(SubordLastRow - 6, 0).Value + \": Sum of subordinate sheets = \" + k)\n</code></pre>\n"}, {"tags": ["vba", "excel", "named-ranges"], "answers": [{"tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": false, "score": 0, "last_activity_date": 1468447777, "last_edit_date": 1468447777, "creation_date": 1468447287, "answer_id": 38362433, "question_id": 38362153, "link": "https://stackoverflow.com/questions/38362153/adding-an-error-check-to-vba-code-that-generates-named-ranges/38362433#38362433", "title": "Adding an error check to VBA code that generates named ranges", "body": "<p>The simplest way to do this is to change the error handling.  Include this code immediately before the line(s) of code that generates the error:</p>\n\n<pre><code>On Error Resume Next\n</code></pre>\n\n<p>This code instructs the script to ignore any errors generated from that point on.  If an error occurs, no error message will be generated and the script will continue to the next line of code.</p>\n\n<p>Turn error handling back on for the rest of the script by adding this immediately after the line(s) generating the error:</p>\n\n<pre><code>On Error Goto 0\n</code></pre>\n\n<p>There are better ways of dealing with errors but this is probably the easiest to use.</p>\n"}], "owner": {"reputation": 23, "user_id": 4403047, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/df64d5e02b82aa1558dcf8c3d0cac317?s=128&d=identicon&r=PG&f=1", "display_name": "Crazysasman", "link": "https://stackoverflow.com/users/4403047/crazysasman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468447777, "creation_date": 1468445982, "question_id": 38362153, "link": "https://stackoverflow.com/questions/38362153/adding-an-error-check-to-vba-code-that-generates-named-ranges", "title": "Adding an error check to VBA code that generates named ranges", "body": "<p>I have been using the following code to generate named ranges for datasets with a large number of columns</p>\n\n<pre><code>Sub Make_Named_Ranges()\n\nRange(\"A1\").Select\nActiveSheet.UsedRange\n\nDim rCell2 As Range\nDim wb2 As Workbook, ws2 As Worksheet\n\nActiveSheet.UsedRange.Select\nSet ws2 = Selection.Parent\nSet wb2 = ws2.Parent\n\nFor Each rCell2 In Selection.Cells\n\nIf rCell2.Address = \"$A$2\" Then Exit For\n\nwb2.Names.Add rCell2.Value, \"=\" &amp; ws2.Cells(2, rCell2.Column).Address  \n&amp; _\":\" &amp; ws2.Cells(ActiveSheet.Range(\"A\"&amp;   Rows.Count).End(xlUp).Row,rCell2.Column).Address\n\nNext rCell2\nEnd Sub\n</code></pre>\n\n<p>What I would like to add is a form of error checking - occassionally the code encounters a column heading in row 1 that isn't a valid name (e.g., M2 or SP500). Is there a simple way to have it just skip this column and keep going when it encounters an invalid name?</p>\n"}, {"tags": ["python", "excel", "vba", "win32com"], "comments": [{"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1468446752, "post_id": 38361949, "comment_id": 64137002, "body": "<a href=\"http://xlwings.org/\" rel=\"nofollow noreferrer\">xlwings</a> may help."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5965536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zVk4.jpg?s=128&g=1", "display_name": "phtnm28", "link": "https://stackoverflow.com/users/5965536/phtnm28"}, "edited": false, "score": 0, "creation_date": 1468447465, "post_id": 38362340, "comment_id": 64137290, "body": "thank you very much that does seem to try and execute it. However, now I receive the &quot;User-defined type not defined&quot; which I believe is because there is an object that isn&#39;t being referenced. If you don&#39;t mind my follow up question would be how do I add references when executing from Python?"}, {"owner": {"reputation": 35, "user_id": 5965536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zVk4.jpg?s=128&g=1", "display_name": "phtnm28", "link": "https://stackoverflow.com/users/5965536/phtnm28"}, "edited": false, "score": 0, "creation_date": 1468448423, "post_id": 38362340, "comment_id": 64137659, "body": "Is there a way to call out references for my macro within Python?"}, {"owner": {"reputation": 35, "user_id": 5965536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zVk4.jpg?s=128&g=1", "display_name": "phtnm28", "link": "https://stackoverflow.com/users/5965536/phtnm28"}, "edited": false, "score": 0, "creation_date": 1468512023, "post_id": 38362340, "comment_id": 64167999, "body": "Thank you ThunderFrame for the awesome help, I&#39;m sooo close to wrapping this up, I&#39;ve called out all of my references that I need but I&#39;m still receiving a user-defined error and debug is pointing to this piece of code. Set cn = CurrentProject.Connection Set rst = New ADODB.Recordset Dim cn As Object: Set cn = CreateObject(&quot;ADODB.Connection&quot;) Dim rst As New ADODB.Recordset Dim ConnectionString As String  More specifically the ADODB.Recordset but I have &#39;Microsoft ActiveX Data Objects Recordset referenced....any ideas?"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 1, "last_activity_date": 1468451265, "last_edit_date": 1468451265, "creation_date": 1468446839, "answer_id": 38362340, "question_id": 38361949, "link": "https://stackoverflow.com/questions/38361949/executing-vbascript-from-python/38362340#38362340", "title": "Executing VBAscript from Python", "body": "<p>You should be able to use Excel's <code>Application.Run</code> method:</p>\n\n<pre><code>xl.Run \"Download_Standard_BOM\"\n</code></pre>\n\n<p><strong>EDIT</strong>\nIf you need to refer to ADO, then you can either use late-binding, like this:</p>\n\n<pre><code>Dim cnn As Object 'ADODB.Connection\nDim rst As Object 'ADODB.Recordset\n\nSet cnn = CreateObject(\"ADODB.Connection\")\nSet rst = CreateObject(\"ADODB.Recordset\")\n</code></pre>\n\n<p>Or, use early binding and add a reference to the VBA Project:</p>\n\n<pre><code>ss.VBProject.References.AddFromGuid \"{2A75196C-D9EB-4129-B803-931327F72D5C}\", 2, 8\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5965536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zVk4.jpg?s=128&g=1", "display_name": "phtnm28", "link": "https://stackoverflow.com/users/5965536/phtnm28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 38362340, "answer_count": 1, "score": 3, "last_activity_date": 1468451265, "creation_date": 1468445093, "question_id": 38361949, "link": "https://stackoverflow.com/questions/38361949/executing-vbascript-from-python", "title": "Executing VBAscript from Python", "body": "<p>I am in need of some help in regards to win32com.client. I have the code working as far as creating the macro from Python and using Excel but I would like this code to also run the vbascript.</p>\n\n<p>Thank you guys for all of your wonderful feedback!</p>\n\n<pre><code>import pyodbc\n\nimport win32com.client as win32\n\nxl = win32.gencache.EnsureDispatch('Excel.Application')\nxl.Visible = True\nss = xl.Workbooks.Add()\nsh = ss.ActiveSheet\n\nxlmodule = ss.VBProject.VBComponents.Add(1)  # vbext_ct_StdModule\n\nsCode = '''Sub Download_Standard_BOM()\n'Initializes variables\nDim cnn As New ADODB.Connection\nDim rst As New ADODB.Recordset\nDim ConnectionString As String\nDim StrQuery As String\n\n    ConnectionString = \"Provider=SQLOLEDB; Network Library=dbmssocn;Password=********;User ID=*******;Initial Catalog=**;Data Source=*************;\"\n\n    cnn.Open ConnectionString\n\n    cnn.CommandTimeout = 900\n\n    StrQuery = \"SELECT * FROM car_search WHERE shop_id = *******\"\n\n    rst.Open StrQuery, cnn\n\n    Sheets(1).Range(\"A2\").CopyFromRecordset rst\nEnd Sub'''\n\nxlmodule.CodeModule.AddFromString(sCode)\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1468444007, "post_id": 38361689, "comment_id": 64135767, "body": "does spelling <code>Address</code> correctly help when passing the argument to <code>editRow</code> (or is it just a typo)?"}, {"owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1468444081, "post_id": 38361689, "comment_id": 64135790, "body": "@ScottHoltzman typo, the code is never actually triggered"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1468445491, "post_id": 38361689, "comment_id": 64136457, "body": "How about <code>Worksheet_BeforeDoubleClick</code>? This way the cell could look like you want it... also a &quot;normal click&quot; would not trigger any events... (I use it very often, because I never have any use for the normal double click behavior)..."}], "answers": [{"comments": [{"owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "edited": false, "score": 0, "creation_date": 1468445211, "post_id": 38361910, "comment_id": 64136327, "body": "by &quot;inserted hyperlink&quot; do you mean the Hyperlink.Add method?"}], "tags": [], "owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "is_accepted": false, "score": 0, "last_activity_date": 1468444925, "last_edit_date": 1495541290, "creation_date": 1468444925, "answer_id": 38361910, "question_id": 38361689, "link": "https://stackoverflow.com/questions/38361689/excel-hyperlink-to-run-userform-based-on-row/38361910#38361910", "title": "Excel Hyperlink to run userform based on row", "body": "<p>The HyperLink function doesn't work that way - it's intended not to trigger the FollowHyperlink event.</p>\n\n<p>See:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9828260/worksheet-followhyperlink-and-msgbox-not-working-in-excel-2010\">Worksheet_FollowHyperlink and MsgBox not working in Excel 2010</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/22113911/followhyperlink-event-not-working\">FollowHyperlink event not working</a></p>\n\n<p>You could try an inserted hyperlink (probably not very useful) or piggyback on another event like SelectionChange, although that's likely to slow you down because the code will run basically every time you click.</p>\n"}, {"comments": [{"owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "edited": false, "score": 0, "creation_date": 1468445917, "post_id": 38362039, "comment_id": 64136665, "body": "that&#39;s a beautiful answer, but I must be doing something wrong because it is trying to acess the address trough the browser, excel 2007"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "edited": false, "score": 0, "creation_date": 1468446113, "post_id": 38362039, "comment_id": 64136753, "body": "Hmm, it doesn&#39;t happen for me. Once I added <code>Worksheet_FollowHyperlink</code> method it completes the sub and doesn&#39;t open the browser. I use Excel 2010. There must be a way to cancel the event."}, {"owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "edited": false, "score": 0, "creation_date": 1468446421, "post_id": 38362039, "comment_id": 64136877, "body": "Ah it works now, just had remove and add the method again, thanks!"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1468446464, "post_id": 38362039, "comment_id": 64136900, "body": "create the hyperlink with something like: <code>ActiveSheet.Hyperlinks.Add Anchor:=Range(&quot;A1&quot;), Address:=&quot;&quot;, SubAddress:=&quot;Sheet1!A1&quot;, TextToDisplay:=&quot;My text here.&quot;</code> this way the cell will just lead to itself..."}], "tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": true, "score": 2, "last_activity_date": 1468445487, "creation_date": 1468445487, "answer_id": 38362039, "question_id": 38361689, "link": "https://stackoverflow.com/questions/38361689/excel-hyperlink-to-run-userform-based-on-row/38362039#38362039", "title": "Excel Hyperlink to run userform based on row", "body": "<p>You need to insert the hyperlink via <code>Ctrl-K</code> shortcut and it works:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BZNOg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BZNOg.png\" alt=\"Adding new hyperlink\"></a></p>\n\n<p>and this code</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n\n    Dim rowNum As Long\n    rowNum = CLng(Replace(Replace(Target.Address, \"https://row\", \"\"), \".com/\", \"\"))\n\n    MsgBox \"You are about to edit row \" &amp; rowNum\n\nEnd Sub\n</code></pre>\n\n<p>returns</p>\n\n<p><a href=\"https://i.stack.imgur.com/3mKJ2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3mKJ2.png\" alt=\"Message box result\"></a></p>\n\n<p><strong>But it gets better</strong> -- you don't even need to parse the row number from the URL as <code>Hyperlink</code> object provides <code>Range</code> method that you can use to determine the row where it was clicked:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n\n    MsgBox \"You are about to edit \" &amp; Target.Range.Address\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vzj9z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vzj9z.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "edited": false, "score": 0, "creation_date": 1468611802, "post_id": 38363257, "comment_id": 64216334, "body": "That works, but it fires twice and gives the invalid reference error in the end"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "edited": false, "score": 0, "creation_date": 1468612954, "post_id": 38363257, "comment_id": 64216882, "body": "I don&#39;t see that.  Did you try it exactly as I posted?  Make sure that works before making any changes."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1468452057, "creation_date": 1468452057, "answer_id": 38363257, "question_id": 38361689, "link": "https://stackoverflow.com/questions/38361689/excel-hyperlink-to-run-userform-based-on-row/38363257#38363257", "title": "Excel Hyperlink to run userform based on row", "body": "<p>In a cell:</p>\n\n<pre><code>=HYPERLINK(\"#Tester()\", \"Click to Edit\")\n</code></pre>\n\n<p>In a module:</p>\n\n<pre><code>Function Tester()\n    Debug.Print Selection.Row '&lt;&lt; do something with the row\n    Set Tester = Selection\nEnd Function\n</code></pre>\n\n<p>Credit for this approach goes to lori_m: <a href=\"https://stackoverflow.com/questions/32660492/running-vba-from-a-hyperlink/32662063#32662063\">Running VBA from a HYPERLINK()</a></p>\n"}], "owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "accepted_answer_id": 38362039, "answer_count": 3, "score": 0, "last_activity_date": 1468452057, "creation_date": 1468443885, "last_edit_date": 1468445136, "question_id": 38361689, "link": "https://stackoverflow.com/questions/38361689/excel-hyperlink-to-run-userform-based-on-row", "title": "Excel Hyperlink to run userform based on row", "body": "<p>I have a workbook that all data is managed through userforms, no manual input. I wanted to make it easier to edit a row by making one of the colums called \"Edit\" with this as its formula :</p>\n\n<p><code>=HYPERLINK(\"Edit:&gt;8\";\"Click to Edit\"</code>)</p>\n\n<p>The \"8\" is the row id number automatically added when creating the row</p>\n\n<p>I thought this would work, but aparrently the hyperlink address needs to be valid for this event to trigger :</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n\n    If Left(Target.Address, 8) = \"Edit:&gt;\" Then\n        editRow(Right(Target.Adress,9))\n    End If    \n\nEnd Sub\n</code></pre>\n\n<p>Any workarounds or better ideas?</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1468517272, "creation_date": 1468517272, "answer_id": 38380567, "question_id": 38361617, "link": "https://stackoverflow.com/questions/38361617/highlight-text-in-reading-pane-in-outlook-2013-vba/38380567#38380567", "title": "Highlight Text in Reading Pane in Outlook 2013 (VBA)", "body": "<p>No not use ActiveInspector - it is unrelated to the items shown by the Explorer.\nTry the following </p>\n\n<pre><code>set hed = Application.ActiveExplorer.Selection(1).GetInspector.WordEditor\n</code></pre>\n\n<p>Keep in mind that if the item is shown in an inspector <strong>and</strong> is selected in the active explorer, the change above will highlight text only in the inspector, preview pane will not be affected. If you want to always work with the preview pane, your might want to look into <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow\">Redemption</a> and its <a href=\"http://www.dimastr.com/redemption/SafeExplorer.htm\" rel=\"nofollow\">SafeExplorer</a> object which explicitly exposes the reading pane:</p>\n\n<pre><code>set sExplorer = CreateObject(\"Redemption.SafeExplorer\")\nsExplorer.Item = Application.ActiveExplorer\nset hed = sExplorer.ReadingPane.WordEditor\nSet appWord = hed.Application\nSet rng = appWord.Selection\nrng.Find.HitHighlight (\"Test\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6586476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30aa9c603e6dff2e41f951f59e617c13?s=128&d=identicon&r=PG&f=1", "display_name": "hoagieryder", "link": "https://stackoverflow.com/users/6586476/hoagieryder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 671, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468517272, "creation_date": 1468443614, "last_edit_date": 1468460357, "question_id": 38361617, "link": "https://stackoverflow.com/questions/38361617/highlight-text-in-reading-pane-in-outlook-2013-vba", "title": "Highlight Text in Reading Pane in Outlook 2013 (VBA)", "body": "<p>I am a novice at VBA and mashed together a bunch of code to accomplish my goal. I am trying to highlight specific text in the reader pane of Outlook, so when you click on a specific email, the reader pain will show the body of the email and any text highlighted, in this case the word \"Test\".</p>\n\n<p>Currently, nothing happens. but if I double click the email to open it in a new window, the preview behind it in the reading panel is now highlighted correctly. It appears as though the event it firing on open not preview, then the changes take effect on a window that is no longer on top. </p>\n\n<p>Here is the code I currently have:</p>\n\n<pre><code>Public WithEvents myItem As Outlook.MailItem\n\nPrivate Sub Application_ItemLoad(ByVal Item As Object)\nIf Item.Class = olMail Then\n    Set myItem = Item\nEnd If\nEnd Sub\n\n\nPrivate Sub myItem_Open(Cancel As Boolean)\nEventsDisable = True\n\nDim msg As Outlook.MailItem\nDim insp As Outlook.Inspector\n\nSet insp = Application.ActiveInspector\n\nIf insp.CurrentItem.Class = olMail Then\nSet msg = insp.CurrentItem\n\nIf insp.EditorType = olEditorWord Then\nSet hed = msg.GetInspector.WordEditor\nSet appWord = hed.Application\nSet rng = appWord.Selection\nrng.Find.HitHighlight (\"Test\")\nEnd If\n\nEnd If\n\nSet appWord = Nothing\nSet insp = Nothing\nSet rng = Nothing\nSet hed = Nothing\nSet msg = Nothing\nEventsDisable = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "filter", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1468443778, "post_id": 38361603, "comment_id": 64135654, "body": "Is the Project Status Field a <code>Report Filter</code> or a <code>Row Label</code> (or <code>Column Label</code>). The code is a bit different depending on which."}, {"owner": {"reputation": 867, "user_id": 5614011, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b09547b3658d918204b15e2ee17e1beb?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/5614011/raj"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1468453185, "post_id": 38361603, "comment_id": 64139066, "body": "@ScottHoltzman: In this particular case, it is a report filter, but i also have a column filter. I am assuming the difference between report, row and column is not too big."}], "answers": [{"tags": [], "owner": {"reputation": 867, "user_id": 5614011, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b09547b3658d918204b15e2ee17e1beb?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/5614011/raj"}, "is_accepted": true, "score": 0, "last_activity_date": 1468502898, "last_edit_date": 1495542758, "creation_date": 1468502898, "answer_id": 38375585, "question_id": 38361603, "link": "https://stackoverflow.com/questions/38361603/selecting-multiple-items-in-excel-pivot-table-filter/38375585#38375585", "title": "Selecting multiple items in excel pivot table filter", "body": "<p>I figured out the problem and the solution is to include the filters while assigning an orientation using the following command:</p>\n\n<pre><code>objField.PivotItems(\"XXX\").Visible = False\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/11162183/filtering-issues-with-macro-for-creating-pivot-table-in-excel-2010-vba?rq=1\">enter link description here</a></p>\n\n<p>I found the logic from the below link.</p>\n"}], "owner": {"reputation": 867, "user_id": 5614011, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b09547b3658d918204b15e2ee17e1beb?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/5614011/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11445, "favorite_count": 0, "accepted_answer_id": 38375585, "answer_count": 1, "score": 0, "last_activity_date": 1468502898, "creation_date": 1468443574, "last_edit_date": 1531164843, "question_id": 38361603, "link": "https://stackoverflow.com/questions/38361603/selecting-multiple-items-in-excel-pivot-table-filter", "title": "Selecting multiple items in excel pivot table filter", "body": "<p>I am using vba to create a pivot table. The table has some filters and i am unable to select multiple items from the filter.</p>\n\n<p>I recorded a macro and used the same functions as the system generated code but i am getting</p>\n\n<pre><code>\"Run-time error '1004': Unable to set the CurrentPage Property of the PivotField Class\"\n</code></pre>\n\n<p>Below is the code that is used to create the pivot table, which works:</p>\n\n<pre><code>Dim objTable As PivotTable\n    Dim objField As PivotField\n\n    ' Select the sheet and first cell of the table that contains the data.\n    ActiveWorkbook.Sheets(\"All Projects - iNexus\").Select\n    Range(\"A1\").Select\n\n    ' Create the PivotTable object based on the Employee data on Sheet1.\n    Set objTable = ActiveSheet.PivotTableWizard\n\n    ' Specify row and column fields.\n    Set objField = objTable.PivotFields(\"Product\")\n    objField.Orientation = xlRowField\n    Set objField = objTable.PivotFields(\"SPA Value Category\")\n    objField.Orientation = xlColumnField\n\n    ' Specify a data field with its summary\n    ' function and format.\n    Set objField = objTable.PivotFields(\"2014 FY Value ($)\")\n    objField.Orientation = xlDataField\n    objField.Function = xlSum\n    objField.NumberFormat = \"$ #,##0\"\n\n    Set objField = objTable.PivotFields(\"2015 FY Value ($)\")\n    objField.Orientation = xlDataField\n    objField.Function = xlSum\n    objField.NumberFormat = \"$ #,##0\"\n\n    ActiveSheet.Name = \"iNexus Pivot\"\n\n    ' Rename the pivot table\n    With Sheets(\"iNexus Pivot\")\n        .PivotTables(1).Name = \"PivotTable2\"\n    End With\n\n    With Sheets(\"iNexus Pivot\").PivotTables(\"PivotTable2\").DataPivotField\n        .Orientation = xlColumnField\n    End With\n</code></pre>\n\n<p>THis is code that i got from the recorded macro to select multiple items from the recorded macro:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Project Status\"). _\n    CurrentPage = \"(All)\"\n    With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Project Status\")\n        .PivotItems(\"A\").Visible = False\n        .PivotItems(\"B\").Visible = False\n        .PivotItems(\"C\").Visible = False\n    End With\n    ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Project Status\"). _\n        EnableMultiplePageItems = True\n</code></pre>\n\n<p>Both CurrentPage and PivotItems seem to be the source of the problem, my vba skills are very limited and i am unable to debug the problem.</p>\n\n<p>Thanks. Appreciate the help.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "edited": false, "score": 1, "creation_date": 1468443492, "post_id": 38361509, "comment_id": 64135510, "body": "I will when time limit has been reached"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1468443447, "last_edit_date": 1468443447, "creation_date": 1468443252, "answer_id": 38361509, "question_id": 38361434, "link": "https://stackoverflow.com/questions/38361434/loops-through-the-rows-of-a-single-column-in-set-range/38361509#38361509", "title": "Loops through the rows of a single column in Set Range", "body": "<p>You'd be very well served to add <code>Option Explicit</code> to the top of your code modules to always ensure all variables must be declared.</p>\n\n<p>You never declared <code>SystemCol</code> as a Range, nor <code>rw</code> as Range. </p>\n\n<p>Following that adding <code>.Cells</code> to <code>SystemCol</code> in the loop ensures that you will loop through each individual cell in SystemCol. See below.</p>\n\n<pre><code>For Each rw In SystemCol.Cells\n    Debug.Print rw.Address\nNext rw\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 38361509, "answer_count": 1, "score": 0, "last_activity_date": 1468443447, "creation_date": 1468442992, "last_edit_date": 1531164843, "question_id": 38361434, "link": "https://stackoverflow.com/questions/38361434/loops-through-the-rows-of-a-single-column-in-set-range", "title": "Loops through the rows of a single column in Set Range", "body": "<p>I am trying to iterate through the rows of a single column in the set range. I set the range as WorkingRange and then set the column I want as SystemCol. how do I loop the each in the set column? I would like to display a message box for each of the rows in the selected column that has a value. The area in the code with the ** is where I am trying to insert the code but what I get is the full column address not a single cell address.</p>\n\n<pre><code>'===============================================================================================\n'Description: Loops through the selected site and adds in the vulnerability totals for each _\n    systems\n'Originally written by: Troy Pilewski\n'Date: 2016-06-30\n'===============================================================================================\n\n'Declares variables\nDim ToWorkbook As Workbook, FromWorkbook As Workbook\nDim ToWorksheet As Worksheet, FromWorkSheet As Worksheet\nDim WorkingRange As Range, WholeRange As Range\nDim FromWorkbookVarient As Variant, ShipNameList() As Variant\nDim TitleString As String, FilterName As String, CurrentSystemName As String, _\n    ShipNames() As String, SelectedShipName As String\nDim LastRow As Long, ShipRow As Long\nDim StartRow As Integer\nConst RowMultiplyer As Integer = 47\n\n'-----------------------------------------------------------------------------------------------\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nSet ToWorkbook = ActiveWorkbook\nSet ToWorksheet = ToWorkbook.ActiveSheet\n\nLastRow = ToWorksheet.Range(\"Y:Y\").Find( _\n    What:=\"*\", _\n    After:=ToWorksheet.Range(\"Y1\"), _\n    LookAt:=xlByRows, _\n    SearchOrder:=xlByRows, _\n    SearchDirection:=xlPrevious _\n).Row\n\n'MsgBox _\n'    Prompt:=\"Y1:Y\" &amp; LastRow, _\n'    Title:=\"Ship Range\"\n\nShipNameList = ToWorksheet.Range(\"Y1:Y\" &amp; LastRow).Value\n\nFor Each Item In ShipNameList\n    Dim BoundCounter As Integer\n    If Left(Item, 3) = \"USS\" Then\n        BoundCounter = BoundCounter + 1\n    End If\nNext Item\n\nReDim ShipNames(BoundCounter - 1)\nBoundCounter = 0\n\nFor Each Item In ShipNameList\n    If Left(Item, 3) = \"USS\" Then\n        ShipNames(BoundCounter) = Item\n'        Debug.Print ShipNames(BoundCounter)\n        BoundCounter = BoundCoutner + 1\n    Else\n'        Debug.Print UBound(ShipNames())\n        Exit For\n    End If\nNext Item\n\nTitleString = \"Select a ship...\"\n\nSelectedShipName = GetChoiceFromChooserForm(ShipNames, TitleString)\n\nIf SelectedShipName = \"\" Then\n    Exit Sub\nEnd If\n\nShipRow = ToWorksheet.Range(\"Y:Y\").Find( _\n    What:=SelectedShipName, _\n    After:=ToWorksheet.Range(\"Y1\"), _\n    LookIn:=xlValues, _\n    LookAt:=xlWhole, _\n    SearchOrder:=xlByRows, _\n    SearchDirection:=xlNext, _\n    MatchCase:=True _\n).Row\n\n'Debug.Print ShipRow\n\nStartRow = 14\n\nIf ShipRow &gt; 1 Then\n    StartRow = (RowMultiplyer * (ShipRow - 1)) + StartRow\nElse\n    StartRow = 14\nEnd If\n\nSet WorkingRange = ToWorksheet.Range(\"B\" &amp; StartRow &amp; \":G\" &amp; StartRow + 38)\nSet SystemCol = WorkingRange.Columns(2)\n\n'Debug.Print WorkingRange.Address\n\nFilterName = \"Excel Files (*.xls), *.xls,Excel Files (*.xlsx), *.xlsx,All Files (*.*), *.*\"\nTitleString = \"Scan File Selection\"\n\n**For Each rw In SystemCol\n    Debug.Print rw.Address\nNext rw**\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1468444371, "post_id": 38361277, "comment_id": 64135912, "body": "you can just add a column to the data table and set the formula for the column once and it will apply to every row in the table ... see <a href=\"http://stackoverflow.com/questions/17549885/insert-new-column-in-table-excel-vba\">this</a> for adding column and <a href=\"http://stackoverflow.com/questions/13753563/add-modify-delete-calculated-column-formula-in-excel-listobject-table-via-vba\">this</a> for adding formula"}, {"owner": {"reputation": 313, "user_id": 2976696, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d48d5affd0f2cf7cae8126cc63316cd?s=128&d=identicon&r=PG", "display_name": "Reginald Greyling", "link": "https://stackoverflow.com/users/2976696/reginald-greyling"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1468445584, "post_id": 38361277, "comment_id": 64136506, "body": "Read my question @ScottHoltzman. The formula only needs to be applied to certain rows (promotion items). Not all items in the table are on promotion, which is why I need to loop through every row in the table and check its <code>Disc.</code> column for a value to determine whether it is a promotion item. If the item is on promotion, the <code>Disc.</code> column contains the discount that needs to be applied to its <code>List Price</code> of which the new <code>Unit Price</code> is calculated."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1468501453, "post_id": 38361277, "comment_id": 64160326, "body": "I did read the question. You can apply an <code>IF</code> statement into the formula and it will appear on each row <code>IF(ISBLANK([DISC]),&quot;&quot;,[DISC]*[LIST PRICE]) ... *(psuedo code)*</code>"}, {"owner": {"reputation": 1654, "user_id": 435317, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e7f7852857d3f428793d7f7463ec374?s=128&d=identicon&r=PG", "display_name": "Drewdin", "link": "https://stackoverflow.com/users/435317/drewdin"}, "edited": false, "score": 0, "creation_date": 1495572300, "post_id": 38361277, "comment_id": 75307056, "body": "Did you resolve this issue? I&#39;m running into a similar one"}], "owner": {"reputation": 313, "user_id": 2976696, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d48d5affd0f2cf7cae8126cc63316cd?s=128&d=identicon&r=PG", "display_name": "Reginald Greyling", "link": "https://stackoverflow.com/users/2976696/reginald-greyling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468442339, "creation_date": 1468442339, "last_edit_date": 1531164843, "question_id": 38361277, "link": "https://stackoverflow.com/questions/38361277/set-formula-of-specific-cell-in-table", "title": "Set Formula of Specific Cell in Table", "body": "<p>How do you set the formula of a specific cell in a table? I have a table (<code>tblPO</code>) with columns <code>Unit Price</code>, <code>List Price</code> and <code>Disc.</code>. I need to loop through the rows of the table checking whether the <code>Disc.</code> column of each row contains a value, and if it does, the formula of the <code>Unit Price</code> of that row needs to be set to the <code>List Price</code> minus the <code>Disc.</code> Here\u2019s what I have so far to loop through the table and check whether the <code>Disc.</code> has a value or not:</p>\n\n<pre><code>For I = 1 To Range(\"tblPO[#Data]\").Rows.Count\n  If [tblPO].Cells(I, [tblPO[Disc.]].Column) &lt;&gt; vbNullString Then\n    &lt;Unit Price cell formula&gt; = \"=[@[List Price]]*(1-[@[Disc.]])\"\n  End If\nNext I\n</code></pre>\n"}, {"tags": ["vba", "com", "vb6", "user-defined-types"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1468443230, "post_id": 38361445, "comment_id": 64135379, "body": "So UDT&#39;s can be a parameter to a <i>procedure</i> or a <i>function</i> (i.e. procedural code in a standard module), but not of a <i>method</i> (i.e. a class module member) - why? Why would the compiler even <i>mention</i> &quot;public user defined types defined in public object modules&quot;, if these are outright illegal?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1468444091, "post_id": 38361445, "comment_id": 64135793, "body": "Honestly, I dont know the reason behind this behavior. But to use UDT in classe, you can you <code>Friend</code> for your Sub/Function. See the edit."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1468515154, "post_id": 38361445, "comment_id": 64169798, "body": "I don&#39;t like <code>Friend</code> because it makes a factory method unusable to referencing projects, but for now I&#39;ll run with it, since it works and I don&#39;t need <i>this</i> code exposed to other VBA projects."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1468516151, "post_id": 38361445, "comment_id": 64170324, "body": "Actually, if I expose a getter property for the UDT member I get a new compiler error about coercing the UDT into a <code>Variant</code>. This is hopeless."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 3, "last_activity_date": 1468443947, "last_edit_date": 1468443947, "creation_date": 1468443027, "answer_id": 38361445, "question_id": 38361276, "link": "https://stackoverflow.com/questions/38361276/can-udts-be-used-as-method-parameters-in-any-way/38361445#38361445", "title": "Can UDT&#39;s be used as method parameters in any way?", "body": "<p>From standard module it works without any error.  Following code threw no error.</p>\n\n<pre><code>Public Type TEST_TYPE\n    Prop1   As String\nEnd Type\n\nPublic Function fTest(ByRef param1 As TEST_TYPE) As String\n    param1.Prop1 = \"Hello from function\"\nEnd Function\n\nPublic Sub sTest(ByRef param1 As TEST_TYPE)\n    param1.Prop1 = \"Hello from Sub\"\nEnd Sub\n\nPublic Sub caller()\n\n    Dim p   As TEST_TYPE\n\n    '/Call Sub\n    Call sTest(p)\n\n    MsgBox p.Prop1\n\n    '/Call Function\n    Call fTest(p)\n\n    MsgBox p.Prop1\n\nEnd Sub\n</code></pre>\n\n<p>One issue with UDT is about Forward referencing. So this will not compile, apart from that It works perfectly fine with standard modules.</p>\n\n<pre><code>Public Type TEST_TYPE\n    Prop1   As String\n    Prop2   As TEST_TYPE2 '/ Fails due to Forward referencing. TEST_TYPE2 should be declared before this UDT.\nEnd Type\n\nPublic Type TEST_TYPE2\n    Prop3   As String\nEnd Type\n</code></pre>\n\n<p>Edit: </p>\n\n<p>However, the work around to use the UDT in class is <code>Friend</code></p>\n\n<p>VBA Code for Class</p>\n\n<pre><code>'/ Using UDT in VBA-Class\nPrivate Type TEST_TYPE3\n    Prop3   As String\nEnd Type\n\nPublic Sub caller()\n\n    Dim p As TEST_TYPE3\n    p.Prop3 = \"Hello from Class\"\n    Call testClassUDT(p)\n\nEnd Sub\n\nFriend Sub testClassUDT(p As TEST_TYPE3)\n    MsgBox p.Prop3\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1468515082, "post_id": 38362150, "comment_id": 64169748, "body": "I <i>thought</i> I had it compiling, but no, it doesn&#39;t."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 1, "last_activity_date": 1468445962, "creation_date": 1468445962, "answer_id": 38362150, "question_id": 38361276, "link": "https://stackoverflow.com/questions/38361276/can-udts-be-used-as-method-parameters-in-any-way/38362150#38362150", "title": "Can UDT&#39;s be used as method parameters in any way?", "body": "<p>Here's a Type being passed as a parameter <em>to</em> a class method, and being <em>returned</em> by a class method.</p>\n\n<p>First the class <code>SomeClass</code> (doesn't need to be PublicNotCreatable)</p>\n\n<pre><code>Option Explicit\n\nSub test(foo As TFooBar)\n  Dim s As String\n  s = foo.foo\nEnd Sub\n\nFunction ReturnTFoo() As TFooBar\n  ReturnTFoo.bar = \"bar\"\n  ReturnTFoo.foo = \" bar\"\nEnd Function\n</code></pre>\n\n<p>And the Module:</p>\n\n<pre><code>Option Explicit\n\nPublic Type TFooBar\n  foo As String\n  bar As String\nEnd Type\n\nSub test()\n  Dim c As SomeClass\n  Set c = New SomeClass\n  Dim t1 As TFooBar\n  Dim t2 As TFooBar\n  t1.bar = \"bar\"\n  t1.foo = \"Foo\"\n  c.test t1\n\n  t2 = c.ReturnTFoo\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 38361445, "answer_count": 2, "score": 3, "last_activity_date": 1468445962, "creation_date": 1468442328, "last_edit_date": 1592644375, "question_id": 38361276, "link": "https://stackoverflow.com/questions/38361276/can-udts-be-used-as-method-parameters-in-any-way", "title": "Can UDT&#39;s be used as method parameters in any way?", "body": "<p>For years I've been avoiding the use of <code>Public Type</code> UDT's in VBA, because they're hard to pass around and I never really bothered trying to understand why.. until now - it was simply easier to just create a class module and work with actual objects instead.</p>\n<p>But recently I gave it a shot, and once I figured they had to be passed <code>ByRef</code> (as an array would), things started to look like I could start using them.</p>\n<p>So I defined a <code>Public Type</code> in a standard module, got this compile error:</p>\n<p><a href=\"https://i.stack.imgur.com/MVOD1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MVOD1.png\" alt=\"Only public UDT's defined in a public object module can be used as a parameter for public procedures of class modules\" /></a></p>\n<p>So I moved the <code>Public Type</code> into a class module, made the class <code>PublicNotCreatable</code>, and then got this compile error:</p>\n<p><a href=\"https://i.stack.imgur.com/SyiPS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SyiPS.png\" alt=\"Cannot define a public UDT in a class module\" /></a></p>\n<hr />\n<p>Here's some code to reproduce the compile error.</p>\n<h3>Class module &quot;Something&quot;:</h3>\n<pre><code>Option Explicit\n' cannot define a public user-defined type within an object module\nPublic Type TSomething\n    Foo As Integer\nEnd Type\n\nPublic Function Create(ByRef info As TSomething) As Something\nEnd Function\n</code></pre>\n<p>If you move the definition of <code>TSomething</code> to a standard module, you'll get the other compiler error, telling you that the public UDT must be defined in a public object module (i.e. a class module)... which takes you back to square one.</p>\n<hr />\n<p>So if you cannot define a <code>Public Type</code> in a class module, why would the compiler throw a fit and even <em>mention</em> &quot;public user defined types defined in public object modules&quot; if such a thing can't legally exist?</p>\n<p>Did it work in VB6 and the compiler message is a remnant of that version? Or is the reason somewhere in how COM works? Is it just me or the two error messages are contradicting each other? Or there's something I'm not understanding?</p>\n<p>Obviously I'm misusing/abusing UDT's here. So what are they supposed to be used for, if not for passing a &quot;record&quot; to some method?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1468441320, "post_id": 38360943, "comment_id": 64134413, "body": "Range expects a letter for the column and you are passing a number.  Use Cells() instead <code>.Cells(1,LColO ).</code> instead of <code>.Range(LColO &amp; &quot;1&quot;).</code>"}, {"owner": {"reputation": 3, "user_id": 6586281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acb6da3949546bdb530fbddc8292fe?s=128&d=identicon&r=PG&f=1", "display_name": "ARubaDubDub", "link": "https://stackoverflow.com/users/6586281/arubadubdub"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468441972, "post_id": 38360943, "comment_id": 64134783, "body": "Thanks @Scott Craner it worked!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468442118, "post_id": 38360943, "comment_id": 64134860, "body": "Personally I would look at @ScottHoltzman has.  It will be quicker for lots of data in that it does not involve the clipboard."}, {"owner": {"reputation": 3, "user_id": 6586281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acb6da3949546bdb530fbddc8292fe?s=128&d=identicon&r=PG&f=1", "display_name": "ARubaDubDub", "link": "https://stackoverflow.com/users/6586281/arubadubdub"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468442184, "post_id": 38360943, "comment_id": 64134890, "body": "I thought I would have to use the clipboard if I only want to copy values...?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468442281, "post_id": 38360943, "comment_id": 64134942, "body": "Nope, if you only want to copy values the quickest method is to directly assign the values to the new range."}], "answers": [{"comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1468441664, "post_id": 38361091, "comment_id": 64134601, "body": ".columns.count would still be referring to wsInput on your paste line."}, {"owner": {"reputation": 3, "user_id": 6586281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acb6da3949546bdb530fbddc8292fe?s=128&d=identicon&r=PG&f=1", "display_name": "ARubaDubDub", "link": "https://stackoverflow.com/users/6586281/arubadubdub"}, "edited": false, "score": 0, "creation_date": 1468497956, "post_id": 38361091, "comment_id": 64157839, "body": "Holy smokes that runs fast! Thank you! I had to remove the <code>End If</code> after <code>Next</code>. Thanks again for the help @ScottHoltzman and everyone."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 3, "user_id": 6586281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acb6da3949546bdb530fbddc8292fe?s=128&d=identicon&r=PG&f=1", "display_name": "ARubaDubDub", "link": "https://stackoverflow.com/users/6586281/arubadubdub"}, "edited": false, "score": 0, "creation_date": 1468501304, "post_id": 38361091, "comment_id": 64160227, "body": "@ARubaDubDub - It&#39;s amazing what clean code (which takes time to learn) can do for a program :). Please mark as answered so others benefit going fwd."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1468501260, "last_edit_date": 1495541291, "creation_date": 1468441514, "answer_id": 38361091, "question_id": 38360943, "link": "https://stackoverflow.com/questions/38360943/extract-one-column-of-data-from-every-tab-and-paste-all-data-onto-one-tab/38361091#38361091", "title": "Extract one column of data from every tab and paste all data onto one tab", "body": "<p>In addition to what <a href=\"https://stackoverflow.com/users/4851590/scott-craner\">@Scott Craner</a> said, you can also shorten the code to this:</p>\n\n<pre><code>Sub CopyPasteCombineSI()\n\nDim wsInput As Worksheet, wsOutput As Worksheet\nDim LRowI As Long\n\n'~~&gt; Set your Output Sheet\nSet wsOutput = ThisWorkbook.Sheets(\"Dual Flow\")\n\nFor Each wsInput In ThisWorkbook.Worksheets\n    '~~&gt; Ensure that we ignore the output sheet\n    If wsInput.Name &lt;&gt; wsOutput.Name Then\n        '~~&gt; Working with the input sheet\n        With wsInput\n            '~~&gt; Set your range for copying\n            .Range(\"F1\").Value = .Range(\"E1\").Value\n            '~~&gt; Get the last row of input sheet\n             LRowI = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n            '~~&gt; Copy your range\n            .Range(\"F1:F\" &amp; LRowI).Copy\n            '~~&gt; paste range to next available column, assumes headers in row 1 \n            wsOutput.Cells(1, wsOutput.Columns.Count).End(xlToLeft).Offset(, 1).PasteSpecial xlPasteValues\n        End With\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>To totally remove the clipboard (copy and paste).</p>\n\n<p>Use this:</p>\n\n<pre><code>With wsOutput\n    .Cells(1,.Columns.Count).End(xlToLeft).Offset(, 1).Resize(LRowI).Value = wsInput.Range(\"F1:F\" &amp; LRowI).Value\nEnd With\n</code></pre>\n\n<p>in place of the two lines for Copy and Paste.</p>\n"}], "owner": {"reputation": 3, "user_id": 6586281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42acb6da3949546bdb530fbddc8292fe?s=128&d=identicon&r=PG&f=1", "display_name": "ARubaDubDub", "link": "https://stackoverflow.com/users/6586281/arubadubdub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1319, "favorite_count": 0, "accepted_answer_id": 38361091, "answer_count": 1, "score": 0, "last_activity_date": 1468501260, "creation_date": 1468440904, "last_edit_date": 1495542757, "question_id": 38360943, "link": "https://stackoverflow.com/questions/38360943/extract-one-column-of-data-from-every-tab-and-paste-all-data-onto-one-tab", "title": "Extract one column of data from every tab and paste all data onto one tab", "body": "<p>I have an excel spreadsheet with 102 tabs-- each tab is formatted in the same way with several columns of operations. I want to copy the same column of data from each tab and put it on a single tab within the same worksheet, but I don't know how to paste each copy into a different column.</p>\n\n<p>This question is very similar to the one asked here:\n<a href=\"https://stackoverflow.com/questions/11787183/extract-tabular-data-from-every-excel-tab-and-paste-data-on-a-single-sheet\">Extract tabular data from every Excel tab, and paste data on a single sheet</a></p>\n\n<p>I have tried many variations on the following code, but cannot figure it out. I am getting the following error: </p>\n\n<blockquote>\n  <p>Method 'Range' of object '_Worksheet' failed</p>\n</blockquote>\n\n<p>I have pasted the code below. Thanks in advance for any and all help!</p>\n\n<pre><code>Option Explicit\n\n\nSub CopyPasteCombineSI()\nDim wsInput As Worksheet, wsOutput As Worksheet\nDim rngSI As Range, rngHeading As Range\nDim LColO As Long, LRowI As Long, LastColumn As Long\n\n'~~&gt; Set your Output Sheet\nSet wsOutput = ThisWorkbook.Sheets(\"Dual Flow\")\n\n'~~&gt; Loop through all sheets to copy and paste combined SI data\nFor Each wsInput In ThisWorkbook.Worksheets\n    '~~&gt; Ensure that we ignore the output sheet\n    If wsInput.Name &lt;&gt; wsOutput.Name Then\n        '~~&gt; Working with the input sheet\n        With wsInput\n            '~~&gt; Set your range for copying\n            Set rngHeading = .Range(\"E1\")\n            '~~&gt; Copy your range\n            rngHeading.Copy\n            '~~&gt; Paste\n            .Range(\"F1\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            '~~&gt; Get the last row of input sheet\n            LRowI = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n            '~~&gt; Set your range for copying\n            Set rngSI = .Range(\"F1:F\" &amp; LRowI)\n            '~~&gt; Copy your range\n            rngSI.Copy\n            '~~&gt; Pasting data in the output sheet\n            With wsOutput\n                If WorksheetFunction.CountA(Cells) &gt; 0 Then\n                    'Search for any entry, by searching backwards by Columns.\n                    LastColumn = Cells.Find(What:=\"*\", After:=[A1], _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious).Column\n                Else\n                    LastColumn = 0\n                End If\n                '~~&gt; Get the next available column in output sheet for pasting\n                LColO = LastColumn + 1\n\n                '~~&gt; Finally paste\n                .Range(LColO &amp; \"1\").PasteSpecial Paste:=xlPasteValues, _\n                Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\n            End With\n        End With\n    End If\nNext wsInput\n\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1468440582, "creation_date": 1468440582, "answer_id": 38360850, "question_id": 38360801, "link": "https://stackoverflow.com/questions/38360801/i-would-like-to-change-a-worksheets-name-to-the-filename-during-a-loop-as-i-open/38360850#38360850", "title": "I would like to change a worksheets name to the filename during a loop as I open its workbook VBA", "body": "<p>Try changing the line to:</p>\n\n<pre><code>Sheets(\"Sheet1\").Name = \"MyFile\"\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1468441089, "creation_date": 1468441089, "answer_id": 38360983, "question_id": 38360801, "link": "https://stackoverflow.com/questions/38360801/i-would-like-to-change-a-worksheets-name-to-the-filename-during-a-loop-as-i-open/38360983#38360983", "title": "I would like to change a worksheets name to the filename during a loop as I open its workbook VBA", "body": "<p>This will rename the Worksheets(\"Parts List\") in the newly opened workbook to MyFile.</p>\n\n<pre><code>Sub OpenFiles()\n    Dim wb As Workbook\n    Dim MyFolder As String\n    Dim MyFile As String\n    MyFolder = InputBox(\"Please enter the folder for files\")\n    MyFile = Dir(MyFolder &amp; \"\\*.xls\")\n    Do While MyFile &lt;&gt; \"\"\n        Set wb = Workbooks.Open(Filename:=MyFolder &amp; \"\\\" &amp; MyFile)\n\n        wb.Worksheets(\"Parts List\").Name = MyFile\n\n        MyFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6580596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96e507b6f63f3dac708a0ced79895a2f?s=128&d=identicon&r=PG&f=1", "display_name": "Hoopah", "link": "https://stackoverflow.com/users/6580596/hoopah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 38360983, "answer_count": 2, "score": 0, "last_activity_date": 1468445929, "creation_date": 1468440428, "last_edit_date": 1468445929, "question_id": 38360801, "link": "https://stackoverflow.com/questions/38360801/i-would-like-to-change-a-worksheets-name-to-the-filename-during-a-loop-as-i-open", "title": "I would like to change a worksheets name to the filename during a loop as I open its workbook VBA", "body": "<p>I am currently using this code to open all .xls files in a folder</p>\n\n<pre><code>Sub OpenFiles()\n\n    Dim MyFolder As String\n    Dim MyFile As String\n    MyFolder = InputBox(\"Please enter the folder for files\")\n    MyFile = Dir(MyFolder &amp; \"\\*.xls\")\n    Do While MyFile &lt;&gt; \"\"\n        Workbooks.Open Filename:=MyFolder &amp; \"\\\" &amp; MyFile\n        ****Sheet1.Name = \"MyFile\"****\n        MyFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>I am trying to change the worksheet name to the file name as it loops though</p>\n\n<p>Every worksheet I am opening will be called \"Parts List\"</p>\n\n<p>I am trying to use the asterisk portion to do this but it does not work. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1468440313, "post_id": 38360659, "comment_id": 64133903, "body": "have you even research <i>any</i> of these steps and tried to code that part? if not start with one set of steps and build on that, then come back to SO with [a very specific question on what is not working](<a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>("}, {"owner": {"reputation": 11, "user_id": 6586279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3875131195e57a97eb2421145df73b5d?s=128&d=identicon&r=PG&f=1", "display_name": "TeeCee77", "link": "https://stackoverflow.com/users/6586279/teecee77"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1468441938, "post_id": 38360659, "comment_id": 64134755, "body": "Yes, I have researched ALL of the steps, and have coded accordingly.  Looping through the files works, however retrieving the data does not.  I can only retrieve data from one field, since my range is not sequential.  Is that specific enough for you??"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1468442085, "post_id": 38360659, "comment_id": 64134836, "body": "Since you have code already built, post that so we can help edit it. You won&#39;t get much help without the coding efforts you have tried."}, {"owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "edited": false, "score": 0, "creation_date": 1468447203, "post_id": 38360659, "comment_id": 64137190, "body": "Since the Cells you have to copy are always different (from Workbook to Workbook) you will have to adress all cells/ranges individually (Use <code>Range.Copy</code>) Although you can strore the Ranges you have to adress in an array and then loop through the array."}, {"owner": {"reputation": 11, "user_id": 6586279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3875131195e57a97eb2421145df73b5d?s=128&d=identicon&r=PG&f=1", "display_name": "TeeCee77", "link": "https://stackoverflow.com/users/6586279/teecee77"}, "edited": false, "score": 0, "creation_date": 1468511310, "post_id": 38360659, "comment_id": 64167521, "body": "Thank you for your assistance.  I just discovered on another forum on this site that ranges can&#39;t process multiple pages.  I am going to have to find another process.  I will save my code for future reference."}], "owner": {"reputation": 11, "user_id": 6586279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3875131195e57a97eb2421145df73b5d?s=128&d=identicon&r=PG&f=1", "display_name": "TeeCee77", "link": "https://stackoverflow.com/users/6586279/teecee77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468439938, "creation_date": 1468439938, "question_id": 38360659, "link": "https://stackoverflow.com/questions/38360659/copying-multiple-ranges-from-multiple-worksheets-in-vba", "title": "Copying multiple ranges from multiple worksheets in VBA", "body": "<p>I am at a total loss.  I have about 10 workbooks in a folder, that are formatted identically. Each workbook contains three worksheets.  I am to combine the data from each of the worksheets in the workbook, and transfer the data to a master workbook.  The data from each workbook is to be a row on the master workbook.  My issue is this:  How do I copy the data from the various worksheets, and paste the data to the Master Workbook?  For example, I need to copy data from cells B3, B5, and B7 from Worksheet 1, and data from C2, K2, K3, and K4 from Sheet 2, and paste this data onto a row in the master spreadsheet.  Any help would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468439743, "post_id": 38360501, "comment_id": 64133578, "body": "You can use <code>Application.OnTime</code> to schedule a macro which will show the text box.  Use a global variable to keep track of whether you need to cancel previous calls if the user tabs to a next cell before the code triggers."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1468443612, "creation_date": 1468443612, "answer_id": 38361616, "question_id": 38360501, "link": "https://stackoverflow.com/questions/38360501/how-to-make-an-interruptible-delay-in-vba/38361616#38361616", "title": "How to make an interruptible delay in VBA?", "body": "<p>For example:</p>\n\n<pre><code>Dim d As Date\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    'cancel any previous scheduled call\n    If d &gt; 0 Then\n        Application.OnTime d, \"Sheet1.test\", , schedule:=False\n        d = 0\n    End If\n\n    'schedule?\n    If Not Intersect(Target, Range(\"A:A\")) Is Nothing Then\n        d = Now + TimeValue(\"0:00:02\")\n        Application.OnTime d, \"Sheet1.test\"\n    End If\n\nEnd Sub\n\nSub test()\n    d = 0\n    MsgBox \"ok\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 38361616, "answer_count": 1, "score": 0, "last_activity_date": 1468443612, "creation_date": 1468439402, "last_edit_date": 1531164843, "question_id": 38360501, "link": "https://stackoverflow.com/questions/38360501/how-to-make-an-interruptible-delay-in-vba", "title": "How to make an interruptible delay in VBA?", "body": "<p>I have some cells on a spreadsheet which, when selected, open a text box. </p>\n\n<p>I don't want the box to open if, for instance, the user is tabbing through the cell without stopping, so I'd like for the Worksheet_SelectionChange to wait for two seconds before opening the text box. If the Selection moves before then, the timer would be interrupted and start over for the new cell. </p>\n\n<p>I've been trying to experiment with: </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If (Intersect(Target, [rSpecialInstr]) Is Nothing) Then Exit Sub\n\n    Application.Wait (Now + TimeValue(\"0:00:02\"))\n\n    frmSpecialInstr.Show\n\nEnd Sub\n</code></pre>\n\n<p>...but I'm having a pre-existing problem with the macro stopping at random times, so I can't test this trick. (I'm hoping the community will lead me to answer by the time I've solved thatother issue.)</p>\n\n<p>I <em>suspect</em> that once the Selection lands on a cell and starts this timer, I can't actually move the Selection again until the 2 seconds pass. Can anyone confirm that? </p>\n\n<p>Is there a better approach to this task?</p>\n"}, {"tags": ["sql", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1468445169, "post_id": 38361532, "comment_id": 64136307, "body": "Excellent! Thank you"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1468443323, "creation_date": 1468443323, "answer_id": 38361532, "question_id": 38360446, "link": "https://stackoverflow.com/questions/38360446/sql-in-xl-vba-date-search-query/38361532#38361532", "title": "SQL in xl VBA Date search query", "body": "<p>It looks like <code>slot_dt</code> is a date-time field.  The issue that you are have is due to the time portion.  I think that you can fix it by using the date values for <strong>sDate</strong> and <strong>fDate</strong> and changing <strong>&lt;=</strong> to <strong>&lt;</strong>.</p>\n\n<pre><code>Dim sDate As Date\n    sDate = DateValue(Cells(6, 2))\nDim fDate As Date\n    fDate = DateValue(Cells(6, 3)) + 1\n\nSheets(\"Appts\").Select\nRange(\"A1\").Select\n\nDim appt As String\nappt = \"SELECT CONVERT(VARCHAR(10), slot_dt, 103) AS date, time \" _\n        &amp; \"FROM slotapp \" _\n        &amp; \"WHERE ( slot_dt &gt;= '\" &amp; sDate &amp; \"' AND slot_dt &lt; '\" &amp; fDate &amp; \"' ) \" _\n        &amp; \"ORDER BY slot_dt\"\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 38361532, "answer_count": 1, "score": 0, "last_activity_date": 1468443323, "creation_date": 1468439230, "last_edit_date": 1531164843, "question_id": 38360446, "link": "https://stackoverflow.com/questions/38360446/sql-in-xl-vba-date-search-query", "title": "SQL in xl VBA Date search query", "body": "<p>I have a FROM and TO cell reference in XL2010 for entering dates in dd/mm/yyyy format.</p>\n\n<p>However if I enter the same date in both FROM and TO it finds nothing.\nWhat is wrong with my query?</p>\n\n<p>If I change TO to the next day it finds everything in the FROM date.\nYet my query if using >= and &lt;=, therefore how come the equal to isn't working for the TO field?</p>\n\n<pre><code>Dim sDate As Date\n    sDate = Cells(6, 2)\nDim fDate As Date\n    fDate = Cells(6, 3)\n\nSheets(\"Appts\").Select\nRange(\"A1\").Select\n\nDim appt As String\nappt = \"SELECT CONVERT(VARCHAR(10), slot_dt, 103) AS date, time \" _\n        &amp; \"FROM slotapp \" _\n        &amp; \"WHERE ( slot_dt &gt;= '\" &amp; sDate &amp; \"' AND slot_dt &lt;= '\" &amp; fDate &amp; \"' ) \" _\n        &amp; \"ORDER BY slot_dt\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "save"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1468439196, "post_id": 38360392, "comment_id": 64133248, "body": "Either save the workbook or not. You can save only one sheet as a new workbook, but I assume that this is not what you are looking for..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1468439410, "post_id": 38360392, "comment_id": 64133375, "body": "Might be better to have your code log the information somewhere else, such as to a separate text file in the same folder as the workbook."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468441486, "post_id": 38360392, "comment_id": 64134495, "body": "Agreed with @TimWilliams. Security would be my main concern though. Someone could easily track down and change the log. May not matter to you, but it may."}], "answers": [{"tags": [], "owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "is_accepted": false, "score": 0, "last_activity_date": 1468449687, "creation_date": 1468449687, "answer_id": 38362902, "question_id": 38360392, "link": "https://stackoverflow.com/questions/38360392/tracking-login-logout-time-of-workbook-where-workbook-may-not-be-saved/38362902#38362902", "title": "Tracking login/logout time of workbook where workbook may not be saved", "body": "<p>If all you want is an audit log you can do that with a text file pretty easily. However you are currently logging your \"log ins\" can be modified to either log that into that sheet AND another excel workbook or a text file as mentioned. You can obviously edit the path to save to whatever directory you would like. Be sure to create a Log.txt (or whatever) file first also. Similarly, you can add in other variables if you are so inclined to capture them, which I assume you already have in your existing code. The open statements in this code aren't reflected on the screen. It pops up a task in event viewer and then closes it.</p>\n\n<pre><code>Sub LogIn()\n    Dim Path As String\n    Dim TxtLog As String\n    Dim i As Integer\n\n    i = FreeFile\n    Path = ThisWorkbook.Path &amp; \"\\Log.txt\"\n    Open Path For Input As i\n    TxtLog = Input(LOF(i), i) &amp; vbCr &amp; Now()'read entire log file into string and add new info\n    Close i 'close log.txt for reading to VBA\n\n    i = FreeFile\n\n    Open Path For Output As i 'open log.txt to write to it from VBA\n    Print #i, TxtLog \n    Close i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563497535, "creation_date": 1468439027, "last_edit_date": 1563497535, "question_id": 38360392, "link": "https://stackoverflow.com/questions/38360392/tracking-login-logout-time-of-workbook-where-workbook-may-not-be-saved", "title": "Tracking login/logout time of workbook where workbook may not be saved", "body": "<p>I have a workbook that tracks the user and time when logged into and logged out of.</p>\n\n<p>The logout is triggered by a button or by closing the workbook.</p>\n\n<p>Someone may want to <strong>not</strong> save the work they have done in the workbook but I would still like to see when they logged in and out on my audit log.</p>\n\n<p>Is there a way to only save data in one sheet and not the entire workbook?</p>\n"}, {"tags": ["excel", "vba", "keystroke"], "comments": [{"owner": {"reputation": 504, "user_id": 3448060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bzLfT.jpg?s=128&g=1", "display_name": "Namkce", "link": "https://stackoverflow.com/users/3448060/namkce"}, "edited": false, "score": 0, "creation_date": 1468439178, "post_id": 38360358, "comment_id": 64133244, "body": "use <code>SendKeys</code> <a href=\"http://www.contextures.com/excelvbasendkeys.html\" rel=\"nofollow noreferrer\">Excel VBA - SendKeys Method</a>"}, {"owner": {"reputation": 504, "user_id": 3448060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bzLfT.jpg?s=128&g=1", "display_name": "Namkce", "link": "https://stackoverflow.com/users/3448060/namkce"}, "edited": false, "score": 0, "creation_date": 1468439480, "post_id": 38360358, "comment_id": 64133416, "body": "Also, when you say you&#39;re converting <code>XXXX XXX (XXX XX XXX)</code> to <code>XXXX XXX</code>, are you basically removing everything after the <code>(</code>?  If so, then this might be a better resource for you <a href=\"https://www.extendoffice.com/documents/excel/1783-excel-remove-text-before-character.html\" rel=\"nofollow noreferrer\">Remove Text Before/After Character</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1468439535, "post_id": 38360358, "comment_id": 64133442, "body": "<code>ActiveCell.Value = Trim(Split(ActiveCell.Value,&quot;(&quot;)(0))</code>"}, {"owner": {"reputation": 21, "user_id": 6451535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xbs4u.jpg?s=128&g=1", "display_name": "Matthew Hall", "link": "https://stackoverflow.com/users/6451535/matthew-hall"}, "edited": false, "score": 0, "creation_date": 1468441175, "post_id": 38360358, "comment_id": 64134344, "body": "Thank you, both of those suggestions help!"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 5661471, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bbc630107393cdf2a394d94d4256b717?s=128&d=identicon&r=PG&f=1", "display_name": "MVZ", "link": "https://stackoverflow.com/users/5661471/mvz"}, "is_accepted": false, "score": 0, "last_activity_date": 1468447020, "last_edit_date": 1468447020, "creation_date": 1468439567, "answer_id": 38360547, "question_id": 38360358, "link": "https://stackoverflow.com/questions/38360358/highlighting-and-replacing-text/38360547#38360547", "title": "Highlighting and Replacing Text", "body": "<p>I recommend that you take a new column and put a formula like:</p>\n\n<pre><code>=Left('cell',10)\n</code></pre>\n\n<p>the left formula cuts everything from the right after a number of numbers, then if you want to make a macro (Example row 1 to 500):</p>\n\n<pre><code>Range(\"D1:D500\").FormulaR1C1 = \"(Formula)\"\n</code></pre>\n\n<p>Then copy paste value and delete original column</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6451535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xbs4u.jpg?s=128&g=1", "display_name": "Matthew Hall", "link": "https://stackoverflow.com/users/6451535/matthew-hall"}, "is_accepted": false, "score": 1, "last_activity_date": 1468532928, "creation_date": 1468532928, "answer_id": 38384816, "question_id": 38360358, "link": "https://stackoverflow.com/questions/38360358/highlighting-and-replacing-text/38384816#38384816", "title": "Highlighting and Replacing Text", "body": "<p>I ended up modifying some code I found. It gets me about 80% there, which saves a lot of repetitive keystrokes. I modified this code to remove the last 25 characters of a string. There are some bits that have more or fewer than 25 characters, but there are so few, it's pretty easy to spot them and make fixes.</p>\n\n<pre><code>Sub delEnd()\n'\n' delEnd Macro\n'\n' Keyboard Shortcut: Ctrl+j\n'\nDim Rng As Range\nDim WorkRng As Range\nDim xChar As String\nOn Error Resume Next\nxTitleId = \"Macro Options\"\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address,     Type:=8)\n'xChar = Application.InputBox(\"String\", xTitleId, \"\", Type:=2)\nFor Each Rng In WorkRng\n    xValue = Rng.Value\n    Rng.Value = VBA.Left(xValue, VBA.Len(xValue) - 25)\n'25 characters is the most common length of the text I am removing\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6451535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xbs4u.jpg?s=128&g=1", "display_name": "Matthew Hall", "link": "https://stackoverflow.com/users/6451535/matthew-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1563495791, "creation_date": 1468438921, "last_edit_date": 1563495791, "question_id": 38360358, "link": "https://stackoverflow.com/questions/38360358/highlighting-and-replacing-text", "title": "Highlighting and Replacing Text", "body": "<p>I'm trying to eliminate a long series of repetitive keystrokes.</p>\n\n<p>I'm taking text in the form:  </p>\n\n<blockquote>\n  <p>\"XXXXXXXX XXXXXXXX (XXXX XXXXX XXXXXXX)\"</p>\n</blockquote>\n\n<p>And removing the bit at the end, making it:  </p>\n\n<blockquote>\n  <p>\"XXXXXXXX XXXXXXXX\"</p>\n</blockquote>\n\n<p>I'm using the keystrokes: F2, Shift+Ctrl+RtArrow, Shift+Ctrl+RtArrow, Shift+Ctrl+RtArrow, Shift+RtArrow, Backspake, Enter</p>\n\n<p>I tried recording this sequence of keystrokes with Excel's Record Macro function. If I run the recorded macro on the next cell, containing \"YYYYYYYY YYYYYYYYY (YYYY YYYYYY YYYYYYYY)\", it doesn't perform the keystrokes I recorded, it replaces the contents of the cell with the resulting contents of the cell I recorded the macro in, \"XXXXXXXX XXXXXXXX\".</p>\n\n<p>The code Excel generated was this, in which it appears to have ignored the keystrokes I performed, and just copies the result:</p>\n\n<pre><code>Sub DelProcVintage()\n'\n' DelProcVintage Macro\n'\n' Keyboard Shortcut: Ctrl+j\n'\n    ActiveCell.FormulaR1C1 = \"XXXXXXXX XXXXXXXX\"\n    ActiveCell.Offset(1, 0).Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>Is there a way to issue my keystroke sequence through a macro?</p>\n"}, {"tags": ["excel", "select-case", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 2, "creation_date": 1468438382, "post_id": 38360163, "comment_id": 64132872, "body": "When the error happens which line does it stop at?"}, {"owner": {"reputation": 1, "user_id": 5828109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970901f359919fcc9107ae320ba460a?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5828109/brian"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1468438987, "post_id": 38360163, "comment_id": 64133161, "body": "x.EntireRow.Copy Destination:=Sheets(&quot;Deposit Details&quot;).Range(&quot;A&quot; &amp;    nrDD)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5828109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970901f359919fcc9107ae320ba460a?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5828109/brian"}, "edited": false, "score": 0, "creation_date": 1468440026, "post_id": 38360500, "comment_id": 64133753, "body": "Thanks Thomas, but I tried using &quot;BT.Range&quot; in place of the longer script, but I got Run-Time Error 438:  Object doesn&#39;t support this property or method."}, {"owner": {"reputation": 1, "user_id": 5828109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970901f359919fcc9107ae320ba460a?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5828109/brian"}, "edited": false, "score": 0, "creation_date": 1468440236, "post_id": 38360500, "comment_id": 64133863, "body": "I realized it should be: x.EntireRow.Copy Destination:=DD.Range(&quot;A&quot; &amp; nrDD)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1, "user_id": 5828109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970901f359919fcc9107ae320ba460a?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5828109/brian"}, "edited": false, "score": 0, "creation_date": 1468440410, "post_id": 38360500, "comment_id": 64133949, "body": "That&#39;s right.  Sorry I used the wrong reference myself."}, {"owner": {"reputation": 1, "user_id": 5828109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970901f359919fcc9107ae320ba460a?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5828109/brian"}, "edited": false, "score": 0, "creation_date": 1468440462, "post_id": 38360500, "comment_id": 64133979, "body": "I&#39;ve tested it with using the &quot;DD&quot; worksheet object and it now works everytime.  Thanks for your answer Thomas since it lead me to the proper  approach."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1468440312, "last_edit_date": 1468440312, "creation_date": 1468439399, "answer_id": 38360500, "question_id": 38360163, "link": "https://stackoverflow.com/questions/38360163/run-time-error-9-with-select-case/38360500#38360500", "title": "Run Time Error 9 with Select Case", "body": "<p><code>Sheets(\"Deposit Details\")</code>  is in <code>Workbooks(\"US98 1650 Backup Template.xlsx\")</code> use the DD variable to you already set to refer to <code>Workbooks(\"US98 1650 Backup Template.xlsx\").Sheets(\"Deposit Details\")</code> </p>\n\n<pre><code>Public Sub PopulateDepositDetails()\n\n    Set BT = Workbooks(\"US98 1650 Backup Template.xlsx\")\n\n    Set DD = BT.Sheets(\"Deposit Details\")\n    Set RDI = BT.Sheets(\"Raw Database Info\")\n    LastRowRDI = RDI.Cells(Rows.Count, 1).End(xlUp).Row\n\n    'Define Trading Partner(Company Number) Range\n    Dim x, ColX As Range, nrDD, rownum As Integer\n\n    Set ColX = RDI.Range(RDI.Cells(4, 24), RDI.Cells(LastRowRDI, 24))\n\n    nrDD = 2    ' sets Deposit Details sheet next row\n\n    Dim COName As String\n\n    COName = Application.InputBox(Prompt:=\"Enter Company to Process\", _\n                                  Title:=\"ENTER COMPANY\", Type:=2)\n\n    If COName = \"US96\" Or COName = \"US97\" Or COName = \"US98\" Or COName = \"US99\" Or COName = \"USZ0\" Then\n\n        For Each x In ColX\n            If x = COName And x.Offset(0, 4) = \"YES\" Then\n                nrDD = nrDD + 1\n                x.EntireRow.Copy Destination:=DD.Range(\"A\" &amp; nrDD)\n            End If\n        Next\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><code>Application.InputBox</code> with Type:=2 will always return a string.  If the user cancels the inputbox it will return an empty string. </p>\n"}], "owner": {"reputation": 1, "user_id": 5828109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970901f359919fcc9107ae320ba460a?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5828109/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468447297, "creation_date": 1468438077, "last_edit_date": 1531164843, "question_id": 38360163, "link": "https://stackoverflow.com/questions/38360163/run-time-error-9-with-select-case", "title": "Run Time Error 9 with Select Case", "body": "<p>Sometimes the below script works, but generally it yields the error message in the title.  I have set watches on the objects and variables, and they all appear to be defined and/or have proper values when the error occurs, so it is baffling.  Any suggestions?      </p>\n\n<pre><code>Public Sub PopulateDepositDetails()\n\n    Set BT = Workbooks(\"US98 1650 Backup Template.xlsx\")\n\n    Set DD = BT.Sheets(\"Deposit Details\")\n    Set RDI = BT.Sheets(\"Raw Database Info\")\n    LastRowRDI = RDI.Cells(Rows.Count, 1).End(xlUp).Row\n\n    'Define Trading Partner(Company Number) Range\n    Dim x, ColX As Range, nrDD, rownum As Integer\n    Set ColX = RDI.Range(Cells(4, 24).Address, Cells(LastRowRDI, 24).Address)\n\n    nrDD = 2    ' sets Deposit Details sheet next row\n\n    Dim COName As String\n\n    COName = InputBox(Prompt:=\"Enter Company to Process\", _\n                      Title:=\"ENTER COMPANY\")\n\n    If COName = vbNullString Then\n        Exit Sub\n\n    Else\n\n        Select Case COName\n\n            Case \"US96\"\n\n                For Each x In ColX\n                    If x = \"US96\" And x.Offset(0, 4) = \"YES\" Then\n                        nrDD = nrDD + 1\n                        x.EntireRow.Copy Destination:=Sheets(\"Deposit Details\").Range(\"A\" &amp; nrDD)\n                    End If\n                Next\n\n            Case \"US97\"\n                For Each x In ColX\n                    If x = \"US97\" And x.Offset(0, 4) = \"YES\" Then\n                        nrDD = nrDD + 1\n                        x.EntireRow.Copy Destination:=Sheets(\"Deposit Details\").Range(\"A\" &amp; nrDD)\n                    End If\n                Next\n\n            Case \"US98\"\n                For Each x In ColX\n                    If x = \"US98\" And x.Offset(0, 4) = \"YES\" Then\n                        nrDD = nrDD + 1\n                        x.EntireRow.Copy Destination:=Sheets(\"Deposit Details\").Range(\"A\" &amp; nrDD)\n                    End If\n                Next\n\n            Case \"US99\"\n                For Each x In ColX\n                    If x = \"US99\" And x.Offset(0, 4) = \"YES\" Then\n                        nrDD = nrDD + 1\n                        x.EntireRow.Copy Destination:=Sheets(\"Deposit Details\").Range(\"A\" &amp; nrDD)\n                    End If\n                Next\n\n            Case \"USZ0\"\n                For Each x In ColX\n                    If x = \"USZ0\" And x.Offset(0, 4) = \"YES\" Then\n                        nrDD = nrDD + 1\n                        x.EntireRow.Copy Destination:=Sheets(\"Deposit Details\").Range(\"A\" &amp; nrDD)\n                    End If\n                Next\n\n        End Select\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "edited": false, "score": 0, "creation_date": 1468438392, "post_id": 38359995, "comment_id": 64132878, "body": "Try adding <code>Option Explicit</code> to the start of your module. This won&#39;t solve your problem directly, but it will show you where things might be going wrong. I tried your code and it didn&#39;t work at all, all your variables will be of type variant, and things might not be getting copied as you expect."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6586144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1120569667981227/picture?type=large", "display_name": "Gavin Greenberg", "link": "https://stackoverflow.com/users/6586144/gavin-greenberg"}, "edited": false, "score": 0, "creation_date": 1469566979, "post_id": 38361309, "comment_id": 64587590, "body": "Thanks, that works and turns it into a formula. The point of me using VBA, though, was to be able to have the a different format for each of the columns I&#39;m concatenating into one. I originally did it with a normal formula like this, but found out it needed to be done in VBA to get the results I needed. For example, I want only the name column to be bolded, not the whole cell. If you know how to fix that it would be an extreme help! Thanks."}], "tags": [], "owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "is_accepted": true, "score": 0, "last_activity_date": 1468472294, "last_edit_date": 1468472294, "creation_date": 1468442463, "answer_id": 38361309, "question_id": 38359995, "link": "https://stackoverflow.com/questions/38359995/automatically-updating-vba-concatenate-column-when-changed/38361309#38361309", "title": "automatically updating vba concatenate column when changed", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\n\nSub joint1()\nDim iRow As Long\nDim iCol As Long\nDim rng As Range\nDim rngSelect As Range\nDim Name As String\n\nSet rngSelect = ActiveSheet.Range(\"a2\", ActiveSheet.Range(\"a2\").End(xlDown))\niRow = 2\niCol = 4\n\nFor Each rng In rngSelect\n    Name = Cells(iRow, iCol + 9)\n    Cells(iRow, Col) = \"=M\" &amp; iRow &amp; Chr(10) &amp; \" &amp; \"\"(\"\" &amp; S\" &amp; iRow &amp; \" &amp; \"\" - \"\" &amp; T\" &amp; iRow &amp; \" &amp; \"\")\"\" &amp;\" &amp; Chr(10) &amp; \"N\" &amp; iRow &amp; \" &amp; \"\"-PM\"\"\"\n    With Cells(iRow, iCol)\n        .ClearFormats\n        .Characters(1, Len(Name)).Font.Bold = True\n    End With\n    iRow = iRow + 1\nNext\n\nEnd Sub\n</code></pre>\n\n<p>This code creates a formula in each cell, rather than just copying the values.</p>\n\n<p>The job could probably be done just as well with an excel formula. The formatting doesn't work with my version of excel (2007).</p>\n"}], "owner": {"reputation": 3, "user_id": 6586144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1120569667981227/picture?type=large", "display_name": "Gavin Greenberg", "link": "https://stackoverflow.com/users/6586144/gavin-greenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 38361309, "answer_count": 1, "score": 0, "last_activity_date": 1468472294, "creation_date": 1468437533, "last_edit_date": 1531164843, "question_id": 38359995, "link": "https://stackoverflow.com/questions/38359995/automatically-updating-vba-concatenate-column-when-changed", "title": "automatically updating vba concatenate column when changed", "body": "<p>I'm concatenating 4 different formula based columns into one using VBA (to be able to change formatting while still concatenating). The concatenating VBA code works, but when the 4 individual columns update and pull the new information, the concatenated column doesn't change. </p>\n\n<p>My concatenated code is this and it lies in column D or 4:</p>\n\n<pre><code>Sub joint1()\n\nActiveSheet.Range(\"a2\", ActiveSheet.Range(\"a2\").End(xlDown)).Select\nRow = 2\nCol = 4\nFor Each Cell In Selection\nAE = Cells(Row, Col + 15)\nName = Cells(Row, Col + 9)\nSC = Cells(Row, Col + 16)\nPM = Cells(Row, Col + 10)\n\nCells(Row, Col) = Name &amp; Chr(10) &amp; \"(\" &amp; AE &amp; \" - \" &amp; SC &amp; \")\" &amp; Chr(10) &amp; PM &amp; \" - PM\"\n\nWith Cells(Row, Col)\n    .ClearFormats\n    .Characters(1, Len(Name)).Font.Bold = True\n\nEnd With\nRow = Row + 1\nNext\nEnd Sub\n</code></pre>\n\n<p>If you know how to add a feature to help my problem, I would be very appreciative! </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 5, "last_activity_date": 1468437120, "creation_date": 1468437120, "answer_id": 38359889, "question_id": 38359742, "link": "https://stackoverflow.com/questions/38359742/how-to-stop-excel-from-becoming-non-responsive-when-using-sleep/38359889#38359889", "title": "How To Stop Excel From Becoming Non-Responsive When Using Sleep", "body": "<p>add <code>DoEvents</code> to your loop.</p>\n\n<pre><code>Sub test()\n    Dim i As Integer\n    For i = 1 To 50\n        Sleep 250\n        Selection.Offset(1, 0).Select\n        DoEvents '/ Add do events to return the resource to interface.\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 6499901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089fe0017c8d9a16f386996646ef3ff?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/6499901/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 38359889, "answer_count": 1, "score": 1, "last_activity_date": 1468437120, "creation_date": 1468436599, "last_edit_date": 1468436960, "question_id": 38359742, "link": "https://stackoverflow.com/questions/38359742/how-to-stop-excel-from-becoming-non-responsive-when-using-sleep", "title": "How To Stop Excel From Becoming Non-Responsive When Using Sleep", "body": "<p>I'm playing with excel VBA and I'm trying to make it so I can watch the macro scroll through cells. When I try to use sleep to slowly iterate over cells (using a for loop) Excel becomes unresponsive after ~20 iterations. It then hangs until the end and then comes back after the sub has executed fully. </p>\n\n<p>Here is the code that makes it happen:</p>\n\n<pre><code>Option Explicit\n\nPublic Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n\nSub test()\n    Dim i As Integer\n    For i = 1 To 50\n        Sleep 250\n        Selection.Offset(1, 0).Select\n    Next i\nEnd Sub\n</code></pre>\n\n<p>How can I stop this from happening?</p>\n"}, {"tags": ["excel", "vba", "macros", "google-sheets", "compare"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1468438702, "post_id": 38359700, "comment_id": 64133010, "body": "Have you tried anything yet? please show us what you&#39;ve tried and what your <i>specific programming problem</i> is."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3717023"}, "edited": false, "score": 0, "creation_date": 1468438749, "post_id": 38359700, "comment_id": 64133038, "body": "Excel VBA macros have nothing to do with Google spreadsheets. Choose tags appropriately."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1468441016, "post_id": 38359700, "comment_id": 64134264, "body": "Your edit doesn&#39;t change anything.  Break the process up into smaller pieces, get each one to work one at a time, and then eventually you will have a complete procedure that does everything.  If you run into a specific problem with the code, feel free to post it here and I&#39;m sure someone will help.  If you want to learn how to code in VBA, keep plugging away and trying.  The people here have many years of experience with this, which is why they know how to do things so quickly.  They are glad to help, but we have our own jobs and are not being paid to do yours."}, {"owner": {"reputation": 1, "user_id": 6585826, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITEdo.jpg?s=128&g=1", "display_name": "Alfonso Irnan", "link": "https://stackoverflow.com/users/6585826/alfonso-irnan"}, "edited": false, "score": 0, "creation_date": 1468441534, "post_id": 38359700, "comment_id": 64134524, "body": "Ok, I will try. This is not actually my job, but I wanted this code to check sheets that I use for work to compare possible mistakes. I will post back when I can get something any close to the code I&#39;m looking for."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1468445767, "post_id": 38359700, "comment_id": 64136592, "body": "Not to nitpick, but in fact that is your job; you are trying to automate and improve it, which is laudable.  Anything you learn will be quite useful in future endeavors, and the hard work will be worth it.  If anyone were to give you the code, you wouldn&#39;t learn anything [or at least much].  When/if you do run into issues, make a new question as this one probably will not be seen at that point."}, {"owner": {"reputation": 1, "user_id": 6585826, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITEdo.jpg?s=128&g=1", "display_name": "Alfonso Irnan", "link": "https://stackoverflow.com/users/6585826/alfonso-irnan"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1468483275, "post_id": 38359700, "comment_id": 64148351, "body": "@OpiesDad I have done something close to what I was looking for. I hope this is what you were mentioning. Anyhow, I am not sure this is the proper way to get it done."}], "answers": [{"comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1468513313, "post_id": 38368614, "comment_id": 64168722, "body": "If you have another question, you should make a question, not post an answer with another question.  With that said, consider using the method here: <a href=\"http://stackoverflow.com/questions/14931700/how-to-find-a-value-in-an-excel-column-by-vba-code-cells-find\" title=\"how to find a value in an excel column by vba code cells find\">stackoverflow.com/questions/14931700/&hellip;</a> to find the value instead of looping.  Also, if your code is working, your question should go on Code Review: <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1468513390, "post_id": 38368614, "comment_id": 64168775, "body": "I applaud you for your attitude and effort.  A lot of people just give up when you give them feedback to try to figure it out themselves first.  And you did figure out a solution...Kudos."}, {"owner": {"reputation": 1, "user_id": 6585826, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITEdo.jpg?s=128&g=1", "display_name": "Alfonso Irnan", "link": "https://stackoverflow.com/users/6585826/alfonso-irnan"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1468700495, "post_id": 38368614, "comment_id": 64237898, "body": "Thanks. It&#39;s true that you learn a lot more from trying yourself."}], "tags": [], "owner": {"reputation": 1, "user_id": 6585826, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITEdo.jpg?s=128&g=1", "display_name": "Alfonso Irnan", "link": "https://stackoverflow.com/users/6585826/alfonso-irnan"}, "is_accepted": false, "score": 0, "last_activity_date": 1468492948, "last_edit_date": 1468492948, "creation_date": 1468483142, "answer_id": 38368614, "question_id": 38359700, "link": "https://stackoverflow.com/questions/38359700/compare-data-in-two-sheets-and-highlight-differences-in-mismatches/38368614#38368614", "title": "Compare data in two sheets and highlight differences in mismatches", "body": "<p>Ok, I could manage to prepare this code that more or less does what I wanted, with some modifications to speed up the testing:</p>\n\n<p>It checks sets of lists (3 columns) in two sheets, and verifies whether all conditions stated previously in this post match.</p>\n\n<p>If matching occurs, it adds a new value in column E, with value 'Ok'.</p>\n\n<p>This, combined to conditional formatting in the excel sheets, highlights rows that are found matching values en A, B and C.</p>\n\n<p><strong>The code seems to work and some improvements may be taken, but since I have to process some thousands of rows, I am afraid is gonna take too long.</strong></p>\n\n<p>Is there a more eficient way to do so, rather than looping through all the rows?</p>\n\n<p>This is the code:</p>\n\n<pre><code>Sub Compare()\n\n' Declare all the variables needed\n  Dim rng1 As Range, rng2 As Range, rngName As Range, i As Integer, j As Integer\n\nDim varCode1 As Integer\nDim varRevision1 As Integer\nDim varStatus1 As String\n\nDim varCode2 As Integer\nDim varRevision2 As Integer\nDim varStatus2 As String\n\n' Process second sheet\n For i = 2 To Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set rng1 = Sheets(\"Sheet2\").Range(\"A\" &amp; i)\n    varCode2 = Sheets(\"Sheet2\").Range(\"A\" &amp; i).Value\n    varRevision2 = Sheets(\"Sheet2\").Range(\"B\" &amp; i).Value\n    varStatus2 = Sheets(\"Sheet2\").Range(\"C\" &amp; i).Value\n    ' MsgBox \"Code \" &amp; varCode2 &amp; \", Rev. \" &amp; varRevision2 &amp; \", Status \" &amp; varStatus2\n    For j = 2 To Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        Set rng2 = Sheets(\"Sheet1\").Range(\"A\" &amp; j)\n        If rng1.Value = rng2.Value Then\n        varCode1 = rng2.Copy\n        varRevision1 = Sheets(\"Sheet1\").Range(\"B\" &amp; j).Value\n        varStatus1 = Sheets(\"Sheet1\").Range(\"C\" &amp; j).Value\n        ' This will just write 'Ok' in cells with matches between column A and B\n\n        If varRevision1 = varRevision2 And varStatus1 = varStatus2 Then\n            Worksheets(\"Sheet2\").Range(\"E\" &amp; i).Value = \"Ok\"\n        End If\n\n        End If\n\n        Set rng2 = Nothing\n    Next j\n    Set rng1 = Nothing\nNext i\n\n' Process first sheet\nFor i = 2 To Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set rng1 = Sheets(\"Sheet1\").Range(\"A\" &amp; i)\n    varCode1 = Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value\n    varRevision1 = Sheets(\"Sheet1\").Range(\"B\" &amp; i).Value\n    varStatus1 = Sheets(\"Sheet1\").Range(\"C\" &amp; i).Value\n    ' MsgBox \"Code \" &amp; varCode2 &amp; \", Rev. \" &amp; varRevision2 &amp; \", Status \" &amp; varStatus2\n    For j = 2 To Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        Set rng2 = Sheets(\"Sheet2\").Range(\"A\" &amp; j)\n        If rng1.Value = rng2.Value Then\n        varCode2 = rng2.Copy\n        varRevision2 = Sheets(\"Sheet2\").Range(\"B\" &amp; j).Value\n        varStatus2 = Sheets(\"Sheet2\").Range(\"C\" &amp; j).Value\n        ' This will just write 'Ok' in cells with matches between column A and B\n\n        If varRevision2 = varRevision1 And varStatus2 = varStatus1 Then\n            Worksheets(\"Sheet1\").Range(\"E\" &amp; i).Value = \"Ok\"\n        End If\n\n        End If\n\n        Set rng2 = Nothing\n    Next j\n    Set rng1 = Nothing\nNext i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6585826, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITEdo.jpg?s=128&g=1", "display_name": "Alfonso Irnan", "link": "https://stackoverflow.com/users/6585826/alfonso-irnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3489, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1468492948, "creation_date": 1468436387, "last_edit_date": 1468439230, "question_id": 38359700, "link": "https://stackoverflow.com/questions/38359700/compare-data-in-two-sheets-and-highlight-differences-in-mismatches", "title": "Compare data in two sheets and highlight differences in mismatches", "body": "<p>I have checked answers given in other questions, but since I am a newcomer to excel vba macros, I really can't find a way to get my problem solved using solutions provided.</p>\n\n<p><strong>EDIT: I am not able to write code on my own yet. I started one month ago with macros, copying and pasting from different posts, and editing as I needed, with many errors usually that I need to fix. It's pretty frustrating but I see this just too big of a problem to get it done on my own.</strong></p>\n\n<p>Thanks in advance for your kind help and shared knowledge.</p>\n\n<p>I have two excel sheets that:</p>\n\n<ol>\n<li>Contain different columns, of which I need to check three of them for matching values</li>\n<li>Number of entries (rows) in both may differ (different lenght)</li>\n<li>Values may or may not be sorted</li>\n<li>For every value in row A, macro shall check value in row B and C, and compare against sheet2, and the same routine taking as reference values in sheet 2 against sheet 1.</li>\n<li>Row A is numerical, B is numerical, and C is text</li>\n</ol>\n\n<p>Example:</p>\n\n<p><strong>Sheet 1</strong></p>\n\n<pre><code>    A         B            C        D        E  \n1  Code     Revision     Status  \n2  102        0            C  \n3  102        1            A  \n4   89        0            A  \n5  216        0            C  \n6  216        1            B  \n7  216        2            A  \n8  217        0            B  \n</code></pre>\n\n<p><strong>Sheet 2</strong></p>\n\n<pre><code>    A         B            C        D        E\n1  Code     Revision     Status  \n2  102        0            A  \n3  102        1            A  \n4   89        0            A  \n5   90        0            A  \n6  216        0            C  \n7  216        1            B  \n8  216        2            A  \n9   16        0            A  \n</code></pre>\n\n<p>After the macro runs, the result in Sheet 1 and Sheet 2 should be that:</p>\n\n<ol>\n<li>All values in column A in Sheet 2 that are missing in Sheet 1 shall be colored its background in, say, red.</li>\n<li>All values in column A in Sheet 1 that are missing in Sheet 2 shall be colored its background in, say, red.</li>\n<li>The same way, for values in column A that are matching in both sheets, missing 'Revisions' (Column B) in each sheet shall be highlighted the same way as in previous points 1 and 2</li>\n<li>finally, for rows that match both 'Code' and 'Revision' (Column A and B) in both sheets, in case that the 'Status' (Column C) is not matching, highlight in Sheet 1.</li>\n</ol>\n\n<p>The result would color red the following cells:</p>\n\n<p>Sheet 1:</p>\n\n<ul>\n<li>C2</li>\n<li>A8</li>\n</ul>\n\n<p>Sheet 2:</p>\n\n<ul>\n<li>A5</li>\n<li>A9</li>\n</ul>\n\n<p>Thanks again.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 6572198, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2b825b90ea44508b42194cbceb17a622?s=128&d=identicon&r=PG&f=1", "display_name": "InWoods", "link": "https://stackoverflow.com/users/6572198/inwoods"}, "edited": false, "score": 0, "creation_date": 1468436848, "post_id": 38359741, "comment_id": 64132109, "body": "That was so fast! Thank you! It works perfectly now :) I don&#39;t know how that slipped my mind."}, {"owner": {"reputation": 85, "user_id": 6572198, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2b825b90ea44508b42194cbceb17a622?s=128&d=identicon&r=PG&f=1", "display_name": "InWoods", "link": "https://stackoverflow.com/users/6572198/inwoods"}, "edited": false, "score": 0, "creation_date": 1468436892, "post_id": 38359741, "comment_id": 64132133, "body": "Thank you for your time and input @cyboashu you are awesome :D"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 85, "user_id": 6572198, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2b825b90ea44508b42194cbceb17a622?s=128&d=identicon&r=PG&f=1", "display_name": "InWoods", "link": "https://stackoverflow.com/users/6572198/inwoods"}, "edited": false, "score": 0, "creation_date": 1468436946, "post_id": 38359741, "comment_id": 64132170, "body": "you are welcome. :)  And mark the question as answered."}, {"owner": {"reputation": 85, "user_id": 6572198, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2b825b90ea44508b42194cbceb17a622?s=128&d=identicon&r=PG&f=1", "display_name": "InWoods", "link": "https://stackoverflow.com/users/6572198/inwoods"}, "edited": false, "score": 1, "creation_date": 1468437021, "post_id": 38359741, "comment_id": 64132211, "body": "yes it is currently on cooldown as the website didn;t expect such a quick answer. Will do it in 3 mins :) ty"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1468445866, "post_id": 38359741, "comment_id": 64136641, "body": "@ YowE3K: Removed. Thanks!"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 3, "last_activity_date": 1468445826, "last_edit_date": 1468445826, "creation_date": 1468436595, "answer_id": 38359741, "question_id": 38359669, "link": "https://stackoverflow.com/questions/38359669/excel-vba-column-auto-fills-even-after-specifying-not-to-if-input-column-is-emp/38359741#38359741", "title": "EXCEL VBA: Column auto-fills even after specifying not to if input column is empty", "body": "<p>Change <code>Cells(nr, \"C\") = \"\" &amp; Cells(nr, \"D\") = \"\"</code> to </p>\n\n<pre><code>Cells(nr, \"C\") = \"\" \n Cells(nr, \"D\") = \"\"\n</code></pre>\n\n<p>the <code>&amp;</code> and <code>=</code> in your line forces it to evaluate.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 6572198, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2b825b90ea44508b42194cbceb17a622?s=128&d=identicon&r=PG&f=1", "display_name": "InWoods", "link": "https://stackoverflow.com/users/6572198/inwoods"}, "edited": false, "score": 0, "creation_date": 1468437355, "post_id": 38359854, "comment_id": 64132372, "body": "Thank you for your time :) I will try to experiment with the code you gave me :D It&#39;s always fun to see every one looks and solves the same problem so uniquely :D ty"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1468436992, "creation_date": 1468436992, "answer_id": 38359854, "question_id": 38359669, "link": "https://stackoverflow.com/questions/38359669/excel-vba-column-auto-fills-even-after-specifying-not-to-if-input-column-is-emp/38359854#38359854", "title": "EXCEL VBA: Column auto-fills even after specifying not to if input column is empty", "body": "<p>This can be done very easily without VBA by the following formulas in C2 and D2, then drag down.</p>\n\n<p>C2:<code>=IF(DATE(YEAR(TODAY()),MONTH(B2),DAY(B2))&gt;=TODAY(),DATE(YEAR(TODAY()),MONTH(B2),DAY(B2)),DATE(YEAR(TODAY())+1,MONTH(B2),DAY(B2)))</code></p>\n\n<p>D2: <code>=C2-TODAY()</code></p>\n\n<p>If you really need VBA, the code can be refactored to the below to work as you like:</p>\n\n<pre><code>Sub Next_Birthday()\n\nDim Birthdate As Date\nDim nr As Long\nDim Today As Date\nDim Nextbdate As Date\nDim NoDays As Long\nDim rName As Range\n\nToday = Date\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\n\n    For Each rName In .Range(.Range(\"A2\"), .Range(\"A2\").End(xlDown))\n\n        Birthdate = rName.Offset(, 1)\n        Nextbdate = DateSerial(Year(Today), Month(Birthdate), Day(Birthdate))\n\n        If Nextbdate &gt;= Today Then\n            Nextbdate = DateSerial(Year(Today), Month(Birthdate), Day(Birthdate))\n        Else\n            Nextbdate = DateSerial(Year(Today) + 1, Month(Birthdate), Day(Birthdate))\n        End If\n\n        rName.Offset(, 2) = Nextbdate\n        rName.Offset(, 3) = (Nextbdate - Today)\n\n    Next\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6572198, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2b825b90ea44508b42194cbceb17a622?s=128&d=identicon&r=PG&f=1", "display_name": "InWoods", "link": "https://stackoverflow.com/users/6572198/inwoods"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 38359741, "answer_count": 2, "score": 0, "last_activity_date": 1468445826, "creation_date": 1468436279, "last_edit_date": 1531164843, "question_id": 38359669, "link": "https://stackoverflow.com/questions/38359669/excel-vba-column-auto-fills-even-after-specifying-not-to-if-input-column-is-emp", "title": "EXCEL VBA: Column auto-fills even after specifying not to if input column is empty", "body": "<p>I am new to VBA and this is my third code. It is a simple code which calculates when the next birthdate should be once I input the initial date of birth and also lets me know how many days are left before I need to make the necessary birthday preparations :)</p>\n\n<p>I will try to provide as much information as possible so please don't get intimidated by this wall of text. Also, since I just started learning a few days back I wrote the code with the limited amount o</p>\n\n<p>Any ways this is the code that I came up with:</p>\n\n<pre><code>Sub Next_Birthday()\n\nDim Birthdate As Date\nDim nr As Long\nDim Today As Date\nDim Nextbdate As Date\nDim NoDays As Long\n\nFor nr = 2 To 20000\n\nBirthdate = ThisWorkbook.Sheets(\"Sheet1\").Cells(nr, \"B\")\nToday = Date\n\nNextbdate = DateSerial(Year(Today), Month(Birthdate), Day(Birthdate))\n\nIf Nextbdate &gt;= Today Then\n    Nextbdate = DateSerial(Year(Today), Month(Birthdate), Day(Birthdate))\nElse\n Nextbdate = DateSerial(Year(Today) + 1, Month(Birthdate), Day(Birthdate))\nEnd If\n\nIf Cells(nr, \"A\") = \"\" Then\n    Cells(nr, \"C\") = \"\" &amp; Cells(nr, \"D\") = \"\"\nElse\n    Cells(nr, \"C\").Value = Nextbdate\n    Cells(nr, \"D\").Value = (Nextbdate - Today)\nEnd If\n\nNext\nEnd Sub\n</code></pre>\n\n<p>This is what my excel looks like once I play the code:\n<a href=\"https://i.stack.imgur.com/LLoGj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LLoGj.png\" alt=\"enter image description here\"></a>\nWhen I hit play, though I get the desired results but it autofills the remaining of column C with the value of TRUE. If you see the last part of my code I had specifically asked excel to not fill my columns if there are no values in Column A.</p>\n\n<p>Thank you for your time and I would really appreciate any suggestions tips to help solve that small issue. Also feel free to ask if you need more information. </p>\n\n<p>Regards,\nInWoods</p>\n"}, {"tags": ["excel", "vba", "list", "function"], "comments": [{"owner": {"reputation": 9353, "user_id": 1887101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6840488291a0b81df1e6fd0f91f7929?s=128&d=identicon&r=PG&f=1", "display_name": "Adjit", "link": "https://stackoverflow.com/users/1887101/adjit"}, "edited": false, "score": 0, "creation_date": 1468436964, "post_id": 38359660, "comment_id": 64132181, "body": "Best way I can think of would be to have a script that instead removes all the blanks from a given column and then pushes the data up. Why can&#39;t you delete the blank cells? could you re-arrange it so that you have the blank cells below the filled cells?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1468441820, "post_id": 38359660, "comment_id": 64134693, "body": "Add examples of how your columns look like"}], "owner": {"reputation": 331, "user_id": 4646183, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2533f4ceaa4201b23ff00c6534d65a58?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/4646183/megan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1468436251, "creation_date": 1468436251, "question_id": 38359660, "link": "https://stackoverflow.com/questions/38359660/make-excel-list-from-non-empty-values-of-column", "title": "Make Excel List from non-Empty values of column", "body": "<p>I have an excel sheet whose columns A:AC contain names.</p>\n\n<p>In every row below that name (Rows 2:2000), there is either a blank or the name of a company. \nThese rows and columns are dynamic and constantly updating, and I cannot delete the blank cells. </p>\n\n<p>I need to make a list of all the companies each person picked, but I do not want the blank cells to be included in the list.</p>\n\n<p>Is there a way to do this without creating a new column that excludes the blank cells? If not, how can I make the new column dynamic so that when the rows are updated they are included in the drop down list?</p>\n\n<p>Any help is appreciated. </p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6505837, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/377ee18f2b01b23be9803bffafb2868b?s=128&d=identicon&r=PG&f=1", "display_name": "EmsBish", "link": "https://stackoverflow.com/users/6505837/emsbish"}, "edited": false, "score": 0, "creation_date": 1468506269, "post_id": 38361147, "comment_id": 64163766, "body": "Rather than displaying it in a message, is there a way to mark initiate an If Then process for each one that is found to match a value in the array?"}, {"owner": {"reputation": 80, "user_id": 6566250, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v4yGPbDwdUA/AAAAAAAAAAI/AAAAAAAAALs/qV97lW9fT-o/photo.jpg?sz=128", "display_name": "DayLove.01", "link": "https://stackoverflow.com/users/6566250/daylove-01"}, "reply_to_user": {"reputation": 25, "user_id": 6505837, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/377ee18f2b01b23be9803bffafb2868b?s=128&d=identicon&r=PG&f=1", "display_name": "EmsBish", "link": "https://stackoverflow.com/users/6505837/emsbish"}, "edited": false, "score": 0, "creation_date": 1468512943, "post_id": 38361147, "comment_id": 64168530, "body": "@emsbish in your original question you have: <code>msg = msg &amp; stArray(i) &amp; vbCR                &#39;strings together displayed txt</code>  You can run your process on the value found by ref. ActiveCell.Value or .Range.  Just replace the <code>msg = msg</code> statment."}], "tags": [], "owner": {"reputation": 80, "user_id": 6566250, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v4yGPbDwdUA/AAAAAAAAAAI/AAAAAAAAALs/qV97lW9fT-o/photo.jpg?sz=128", "display_name": "DayLove.01", "link": "https://stackoverflow.com/users/6566250/daylove-01"}, "is_accepted": false, "score": 0, "last_activity_date": 1468441779, "creation_date": 1468441779, "answer_id": 38361147, "question_id": 38359612, "link": "https://stackoverflow.com/questions/38359612/searching-through-values-in-dynamic-array-vba/38361147#38361147", "title": "Searching through values in dynamic array (vba)", "body": "<p>Try this:</p>\n\n<pre><code>For i = 1 To UBound(stArray)                        'loops through all values of array\n\n    Range(\"$D2:\" &amp; Range(\"D\" &amp; Rows.Count).End(xlUp).Address).Select\n\n    Selection.Find(What:=stArray(i), After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Offset(0, 2).Select\n\n    msg = msg &amp; stArray(i) &amp; ActiveCell.Value &amp; vbCR                'strings together displayed txt\nNext i\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6505837, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/377ee18f2b01b23be9803bffafb2868b?s=128&d=identicon&r=PG&f=1", "display_name": "EmsBish", "link": "https://stackoverflow.com/users/6505837/emsbish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 733, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468441779, "creation_date": 1468436090, "question_id": 38359612, "link": "https://stackoverflow.com/questions/38359612/searching-through-values-in-dynamic-array-vba", "title": "Searching through values in dynamic array (vba)", "body": "<p>Users select desired options through use of a checkbox.  The caption values of each check box are stored in a dynamic array then displayed in message box confirming the selections.  </p>\n\n<p>I now need to loop through a range of cells, at every row determining if cell (x,4) is equal to any value in the array, but I don't know how to loop like that.  See code below where the array is populated.  </p>\n\n<p>Thank you in advance!</p>\n\n<pre><code>Sub ProcessStrats_Click()\nDim ctl As Control\nDim cnt As Long\nDim msg As String\nDim i As Long\nDim cResp As Integer\nDim stArray() As Variant\n\n    cnt = 0                                             'Initialize counter outside of loop\n    For Each ctl In StratFill.Controls                  'look at every control in StratForm box\n        If Left(ctl.Name, 8) = \"CheckBox\" Then          'if the control is named 'checkbox' then\n            If ctl.Value = True Then                    'if the control is marked as 'true' i.e. checked, then\n                ReDim Preserve stArray(0 To cnt)        'Reset the array dimension on each iteration of loop\n                stArray(cnt) = ctl.Caption              'Add value in value of checkbox caption to Array\n                cnt = cnt + 1                           'Advance the counter to next array item\n            End If\n        End If\n    Next\n\n    Unload StratFill                                    'unload and close stratfill form\n\n\n    msg = \"The following strategies will be priced:\" &amp; vbNewLine &amp; vbNewLine\n    For i = LBound(stArray) To UBound(stArray)          'loops through all values of array\n           msg = msg &amp; stArray(i) &amp; vbCR                'strings together displayed txt\n    Next i\n\n        If MsgBox(msg, vbYesNo, \"Confirm Strategies\") = vbYes Then\n                                                                    'if yes is clicked\n            Call RunPricing                                         '\"RunPricing\" will run\n        Else                                                        'if no is clicked\n            StratFill.Show                                          'then the strategy selector box will display again\n        End If\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1468437066, "post_id": 38359716, "comment_id": 64132237, "body": "Unfortunately, I won&#39;t know the actual amount of columns, it will vary depending on the information pasted into sheets 1 and 2 (Both will have the same amount of columns though). Also just FYI, I need to compare from column A through last column used. If that entire row of cells&#39; value isn&#39;t found in the other sheet, that entire row needs to be added in sheet3"}, {"owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1468438136, "post_id": 38359716, "comment_id": 64132744, "body": "Ok, from your code it seems like it loops through each column to find a difference. But, instead of just moving over the difference to ws3.cells(x, 1), I want to pretty much copy/paste that entire row that has a difference into corresponding columns on sheet3."}, {"owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1468508267, "post_id": 38359716, "comment_id": 64165213, "body": "So, attempting this code, it seems to work. But when the rows are placed into sheet3, they&#39;re not formatted correctly. I tried Autofitting the entire sheet, that row, and using pastespecial. Any recommendations?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1468508483, "post_id": 38359716, "comment_id": 64165401, "body": "@rdan1 - I don&#39;t know what <i>not formatted correctly</i> means, but I suggest posting another question with more details to receive help"}, {"owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1468535477, "post_id": 38359716, "comment_id": 64180373, "body": "Is there a way to just set the used cells in sheet2 as a searchrange, and then run a find on that searchrange. You&#39;d be individually using each row of data on sheet1 as the find object. Instead of just using one column for search range and a string as the find object. I&#39;d want to use find with a range (row i). And the search range, pretty much the whole sheet."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1468439076, "last_edit_date": 1468439076, "creation_date": 1468436441, "answer_id": 38359716, "question_id": 38359574, "link": "https://stackoverflow.com/questions/38359574/find-a-range-of-multiple-cells-in-another-sheet/38359716#38359716", "title": "Find a range of multiple cells in another sheet", "body": "<p>In the <code>'do nothing if filepath is found in both sheets</code> section, place something like this:</p>\n\n<pre><code>k = ws2.Cells(1,ws2.Columns.Count).End(xlToleft).Column\nFor j = 2 to k\n    If ws2.Cells(i, j).Value &lt;&gt; CellId.Offset(, j - 1).Value Then \n       CellId.EntireRow.Copy ws.Cells(x,1).EntireRow\n       x = x +1\n       Exit For\n       'or whatever code you need to move to sheet3 \n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1468439849, "post_id": 38360109, "comment_id": 64133649, "body": "Although it does do exactly what mine does (except starts pasting after row1), this method is a little more advanced for a beginner like myself. I appreciate the feedback, are there any resources you could link that I could read to help me understand your methodology?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1468440123, "post_id": 38360109, "comment_id": 64133800, "body": "You should watch all TheWiseOwlTutorials on Youtube.  Here is the relavent one <a href=\"https://www.youtube.com/watch?v=dND4coLI_B8&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5&amp;index=42\" rel=\"nofollow noreferrer\">Dictionary</a>"}, {"owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1468440854, "post_id": 38360109, "comment_id": 64134198, "body": "I will give it a look, appreciate it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1468437894, "creation_date": 1468437894, "answer_id": 38360109, "question_id": 38359574, "link": "https://stackoverflow.com/questions/38359574/find-a-range-of-multiple-cells-in-another-sheet/38360109#38360109", "title": "Find a range of multiple cells in another sheet", "body": "<p>I use a Dictionary when comparing multiple list.  This way I only iterate over each list one time.</p>\n\n<pre><code>Sub CopyMissingFileNames()\n    Dim filepath As Range, Target As Range\n    Dim dictFilePaths As Object\n    Set dictFilePaths = CreateObject(\"Scripting.Dictionary\")\n\n    With Worksheets(\"Sheet1\")\n\n        For Each filepath In .Range(\"A2\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\n\n            If Not dictFilePaths.Exists(filepath.Text) Then dictFilePaths.Add filepath.Text, \"\"\n        Next\n\n    End With\n\n\n    With Worksheets(\"Sheet2\")\n\n        For Each filepath In .Range(\"A2\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\n            If Not dictFilePaths.Exists(filepath.Text) Then\n                Set Target = Worksheets(\"Sheet3\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n\n                filepath.EntireRow.Copy Target\n            End If\n        Next\n\n    End With\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 38359716, "answer_count": 2, "score": 0, "last_activity_date": 1468439076, "creation_date": 1468435913, "question_id": 38359574, "link": "https://stackoverflow.com/questions/38359574/find-a-range-of-multiple-cells-in-another-sheet", "title": "Find a range of multiple cells in another sheet", "body": "<p>I am trying to enhance my current script. Sheet1 and Sheet2 contain only filepath names in column A. If a filepath in Sheet2 isn't found in Sheet1, it is copied over to sheet 3. </p>\n\n<pre><code>'row counter\nx = 1\n'Initiate Variables\nSet wb = ActiveWorkbook\nSet ws1 = wb.Sheets(\"Sheet1\")\nSet ws2 = wb.Sheets(\"Sheet2\")\n\n'create a new sheet 3, delete old one if it exists\nIf Sheets.Count &gt; 2 Then\nApplication.DisplayAlerts = False\n    Sheets(3).Delete\nApplication.DisplayAlerts = False\nEnd If\n\nSheets.Add After:=Sheets(Sheets.Count)\nSheets(Sheets.Count).Name = \"Sheet3\"\n\nSet ws3 = wb.Sheets(\"Sheet3\")\n\n'Get row count to know how many times to loop\nrowCount2 = ws2.Range(\"A1\").End(xlDown).Row\n\n'compare filepaths from sheet2 to sheet1\n'if there is a difference, that difference is put on sheet 3\nFor i = 1 To rowCount2\n    FilePath = ws2.Cells(i, 1)\n    With Sheets(\"Sheet1\").Range(\"A:A\")\n        Set CellId = .Find(What:=FilePath, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        If Not CellId Is Nothing Then\n        'do nothing if filepath is found in both sheets\n        Else\n            'put the filepath from file2 not found in file1, into\n            'sheet 3\n            ws3.Cells(x, 1) = FilePath\n            x = x + 1\n        End If\n    End With\nNext I\n</code></pre>\n\n<p>What I want to do, is be able to reference a range of cells to compare instead of just from column A. Instead of just file paths in column A, there will be last saved by in column B, Last opened by in column C, etc. So instead of just checking for difference in filepath, I want differences in multiple columns. So there might be the same filepaths, but it was opened by someone different on another day. I need to grab that difference. I don't know how to reference the range of multiple cells. So I need to fix up this section of code:</p>\n\n<pre><code>FilePath = ws2.Cells(i, 1)\nWith Sheets(\"Sheet1\").Range(\"A:A\")\n</code></pre>\n\n<p>And if there is an easier way to approach this I am open to advice. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "edited": false, "score": 0, "creation_date": 1468435221, "post_id": 38359373, "comment_id": 64131192, "body": "Have you tried to save the Worksheet?"}, {"owner": {"reputation": 47, "user_id": 4736081, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4590e852d78fe647666cf1ec8d19dc07?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi", "link": "https://stackoverflow.com/users/4736081/swathi"}, "reply_to_user": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "edited": false, "score": 0, "creation_date": 1468435406, "post_id": 38359373, "comment_id": 64131309, "body": "yeah. The code I uploaded is one of the modules in my application . I need to protect the sheet once the data is imported from database."}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1468435602, "creation_date": 1468435602, "answer_id": 38359496, "question_id": 38359373, "link": "https://stackoverflow.com/questions/38359373/protect-worksheet-after-operation/38359496#38359496", "title": "Protect worksheet after operation", "body": "<p>Are <code>Worksheets(\"Data\")</code> and <code>ActiveSheet</code> are same? You are manipulating the sheet called Data and protecting ActiveSheet. </p>\n\n<p><code>Worksheets(\"Data\").Protect</code> will ensure that its protected and not some random active sheet.</p>\n"}], "owner": {"reputation": 47, "user_id": 4736081, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4590e852d78fe647666cf1ec8d19dc07?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi", "link": "https://stackoverflow.com/users/4736081/swathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 38359496, "answer_count": 1, "score": 0, "last_activity_date": 1468435602, "creation_date": 1468435060, "question_id": 38359373, "link": "https://stackoverflow.com/questions/38359373/protect-worksheet-after-operation", "title": "Protect worksheet after operation", "body": "<p>I am trying to protect my worksheet called<a href=\"https://i.stack.imgur.com/NKSvv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NKSvv.png\" alt=\"enter image description here\"></a> <strong>DATA</strong> after the rows were imported and inserted from database. But unfortunately it's not getn protected. I also need the column J to be locked and hidden so that the user cannot view the formula </p>\n\n<p>Here is my code : </p>\n\n<pre><code>           Option Explicit\n</code></pre>\n\n<p>Sub GetDataFromADO()</p>\n\n<pre><code>        'Input query'\n        'Dim dbQuery As String\n        'dbQuery = InputBox(\"Enter Query\")\n\n    Dim pword As String\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n   ActiveSheet.Unprotect Password:=\"star\"\n\n    pword = InputBox(\"Please enter the password\", \"Password Required\")\n\n    If pword &lt;&gt; \"Audit2016\" Then\n         MsgBox \"You are not given access to view this!\", vbCritical + vbOKOnly\n         Exit Sub\n    Else\n\n        Sheets(\"Data\").Visible = True\n        On Error Resume Next\n\n        MsgBox \"Check Worksheet DATA to view the results \"\n        '   Your code here\n    End If\n\n        'Declare variables'\n        Dim objMyConn As ADODB.Connection\n        Dim objMyCmd As ADODB.Command\n        Dim objMyRecordset As ADODB.Recordset\n        Dim iCols As Integer\n        Dim tbl As ListObject\n\n        Set objMyConn = New ADODB.Connection\n        Set objMyCmd = New ADODB.Command\n        Set objMyRecordset = New ADODB.Recordset\n\n        'Open Connection'\n        objMyConn.ConnectionString = \"Provider=SQLOLEDB;Data Source=;Initial Catalog=;Trusted_connection=Yes;Integrated Security=;\"\n        objMyConn.Open\n\n        'Dim sSqL As String\n        'Set objMyCmd.ActiveConnection = objMyConn\n        'sSqL = \"Select AccName,Underwriter,Auditor, UT_Score, Underwriter_Score from AUTUARIAL.dbo.AUDIT_CHECKLIST\"\n        'objMyConn.Execute sSqL\n\n        'Set and Excecute SQL Command'\n        Dim u As String\n        Set objMyCmd.ActiveConnection = objMyConn\n        objMyCmd.CommandText = \"SELECT FileID, AccName, Underwriter, Auditor,UT_Score,Underwriter_Score from Checklist\"\n        'objMyCmd.CommandText = \"SELECT  CHECKLIST.FileID, CHECKLIST.AccName, CHECKLIST.Underwriter, CHECKLIST.Auditor, CHECKLIST.UT_Score, CHECKLIST.Underwriter_Score   \"\n\n\n        objMyCmd.CommandType = adCmdText\n        objMyCmd.Execute\n\n\n        'Open Recordset'\n        Set objMyRecordset.Source = objMyCmd\n        objMyRecordset.Open\n        For iCols = 0 To objMyRecordset.Fields.Count - 1\n        Worksheets(\"Data\").Cells(1, iCols + 1).Value = objMyRecordset.Fields(iCols).name\n        Next\n\n        'Copy Data to Excel'\n        Worksheets(\"Data\").Range(\"A2\").CopyFromRecordset objMyRecordset\n\n        'MsgBox \"Report Generated Succesfully. View the results in worksheet called DATA !\", vbOKOnly\n        ActiveSheet.Protect Password:=\"star\"\n\n        Application.ScreenUpdating = True\n        Application.DisplayAlerts = True\n\n\n\n        End Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1468434658, "post_id": 38359228, "comment_id": 64130874, "body": "In amazon site, its not as simple as to call the event. Find the parent form for the control and after all inputs just submit that form."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1468436335, "post_id": 38359228, "comment_id": 64131859, "body": "Could you please post the entire VBA code, including <code>objCollectionA</code> variable initialization. Have you tried <code>oIE.document.getElementById(&quot;diForm:addProductSizeLnk&quot;).clic&zwnj;&#8203;k</code>? And don&#39;t forget to wait until the element is ready. Also to simulate a click you can create mouse event object <code>Set oMouseEvt = oIE.document.createEvent(&quot;MouseEvents&quot;)</code>, initialize it <code>oMouseEvt.initMouseEvent &quot;click&quot;, True, True, .document.parentWindow, 0, 1, 1, 1, 1, False, False, True, False, 0, &quot;&quot;</code>and dispatch it to the target element <code>oIE.document.getElementById(&quot;diForm:addProductSizeLnk&quot;).disp&zwnj;&#8203;atchEvent oMouseEvt</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6585819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4627da97a231533e8f2b477094cf40be?s=128&d=identicon&r=PG&f=1", "display_name": "A.Heywood", "link": "https://stackoverflow.com/users/6585819/a-heywood"}, "is_accepted": false, "score": 0, "last_activity_date": 1468450148, "last_edit_date": 1495541683, "creation_date": 1468450148, "answer_id": 38362978, "question_id": 38359228, "link": "https://stackoverflow.com/questions/38359228/html-onclick-event-wont-fire-with-vba/38362978#38362978", "title": "html onClick event won&#39;t fire with vba", "body": "<p>Thank you <a href=\"https://stackoverflow.com/users/2165759/omegastripes\">omegastripes</a> for your comment. I thought I was waiting using <code>Do While IE.Busy   Application.Wait DateAdd(\"s\", 1, Now)   Loop</code> as well as the .readyState function. I noticed that the program was completing though, before the <code>objCollectionA(j).FireEvent (\"onclick\")</code> took effect. So I stepped through the code slowly and it worked. Now I am using <code>Application.Wait DateAdd(\"s\", t, Now)</code> to pause the program for a few seconds. I also am cleaning up the code a bit by using <code>IE.document.getElementById(\"diForm:addProductSizeLnk\").click</code> instead of using While-Wend to call from a collection. This is still pretty new to me as you can probably tell.</p>\n\n<blockquote>\n  <p>And don't forget to wait until the element is ready.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 6585819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4627da97a231533e8f2b477094cf40be?s=128&d=identicon&r=PG&f=1", "display_name": "A.Heywood", "link": "https://stackoverflow.com/users/6585819/a-heywood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468450148, "creation_date": 1468434511, "question_id": 38359228, "link": "https://stackoverflow.com/questions/38359228/html-onclick-event-wont-fire-with-vba", "title": "html onClick event won&#39;t fire with vba", "body": "<p>I am writing a vba program to interact with a website and automatically fill the form. I have gotten other types of links to work, but there are some links that expand hidden sections of the form. These will not work when using the code below. I need to know if there is a way to do this.</p>\n\n<p>Here is the html source code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;a name=\"diForm:addProductSizeLnk\" id=\"diForm:addProductSizeLnk\" style=\"float: right;\" \r\nonclick=\"jsf.util.chain(document.getElementById('diForm:addProductSizeLnk'),\r\nevent,'jsf.ajax.request(\\'diForm:addProductSizeLnk\\',event,{execute:\\'@none \\',\r\nrender:\\'@none \\',onevent:function(data){showEditor(data,\\'diForm:productSizeEditor\\',\r\n\\'diForm:productSizeAddDiv\\', false ? \\'diForm:in_clinicallyRelSizeText\\' :\r\n\\'diForm:in_clinRelSizeType\\')},\\'javax.faces.behavior.event\\':\\'action\\'})');\r\nreturn false;\" href=\"#\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I have correctly referenced the link and am using the following code:</p>\n\n<pre><code>For j = 0 To objCollectionA.Length - 1\n    If objCollectionA(j).Name = \"diForm:addProductSizeLnk\" Then\n        objCollectionA(j).FireEvent (\"onclick\")\n    End If\nNext\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1468434317, "post_id": 38359137, "comment_id": 64130664, "body": "Use <code>F8</code> in debugging to step through the code and identify which line actually raises the error. Also, get rid of your <code>On Error Resume Next</code> statements."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1468434388, "post_id": 38359137, "comment_id": 64130713, "body": "Changing or assigning the value to a <code>MultiPage</code> control may trigger that control&#39;s <code>_Change</code> event, too, so the error may be in that function."}, {"owner": {"reputation": 23, "user_id": 3900390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56jsS.jpg?s=128&g=1", "display_name": "MattB", "link": "https://stackoverflow.com/users/3900390/mattb"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1468447070, "post_id": 38359137, "comment_id": 64137134, "body": "@David\u2014Unfortunately this is on a user&#39;s computer in another county, and I can&#39;t debug on their machine; the error is not coming up on any machine here. I tried removing the <code>On Error Resume Next</code> statements and they&#39;re testng it again. And, there is no <code>_Change</code> event on the <code>MultiPage</code> control."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1468465902, "post_id": 38359137, "comment_id": 64141758, "body": "Would all the global scope variables be created when the Initialize function is first invoked?  If so, perhaps one of those variables is dependent on an external object that isn&#39;t on the user&#39;s computer."}, {"owner": {"reputation": 23, "user_id": 3900390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56jsS.jpg?s=128&g=1", "display_name": "MattB", "link": "https://stackoverflow.com/users/3900390/mattb"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1468526473, "post_id": 38359137, "comment_id": 64176380, "body": "@David\u2014I sent the user a version without the <code>On Error Resume Next</code> lines and it worked for them. I will investigate more especially given the advice from @Yow. But it&#39;s great that they can use it. Thanks!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1468526681, "post_id": 38359137, "comment_id": 64176488, "body": "That&#39;s absolutely bizarre!! If anything, the <code>On Error Resume Next</code> should be hiding/suppressing the error message (unless user has the VBE configured to &quot;break on all errors&quot; -- which is unlikely unless s/he is actively working in VBA), and so removing it <b>should</b> raise the error, if there is one..."}, {"owner": {"reputation": 23, "user_id": 3900390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56jsS.jpg?s=128&g=1", "display_name": "MattB", "link": "https://stackoverflow.com/users/3900390/mattb"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1468527174, "post_id": 38359137, "comment_id": 64176759, "body": "@David\u2014I&#39;m going to go through using the whole app over the phone with them, for vacation and timing reasons not til July 26, so I&#39;ll see if anything else is raised on their machine. It is baffling. (And sorry I have a reputation of just 8 so I can&#39;t vote up your answer.)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1468527260, "post_id": 38359137, "comment_id": 64176798, "body": "no worries, I haven&#39;t actually &quot;answered&quot; anything yet :) you might try to do some sort of web-conference that would allow you to remotely access the user&#39;s computer, for purpose of debugging."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1468527798, "post_id": 38359137, "comment_id": 64177100, "body": "I would look closely at is whether there are any event procedures for the <code>MultiPage</code> control (you&#39;ve mentioned that there is not a <code>_Change</code> event, but there might be other event(s) raised when accessing the control&#39;s <code>.Value</code> property, and the root cause may have been deeper in there somewhere. Also, unhandled errors can cause state loss of the ribbon object, global variables, etc., and that could raise an <code>Object Required</code> error but I wouldn&#39;t expect &quot;Variable not defined&quot;..."}], "owner": {"reputation": 23, "user_id": 3900390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56jsS.jpg?s=128&g=1", "display_name": "MattB", "link": "https://stackoverflow.com/users/3900390/mattb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1754, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1468434157, "creation_date": 1468434157, "last_edit_date": 1531164843, "question_id": 38359137, "link": "https://stackoverflow.com/questions/38359137/excel-vba-userform-initialize-error", "title": "Excel VBA Userform Initialize Error", "body": "<p>I've had an Excel VBA addin I've developed over many years. Many users have used this addin on Windows on both Excel 2007 and Excel 2010; it has even worked on Macbook. For the first time, a user is getting an error in Windows Excel 2010 when clicking a button I've added to a ribbon to bring up a form.</p>\n\n<p>The error is 'Compile error: Variable not defined'. I am using Option Explicit throughout the code, but there is no variable being defined when the userform initializes. I've compiled from within the VBA editor using Debug...Compile VBAProject and get no errors. I've googled this and read many posts but nowhere has this error been associated with a userform initializing.</p>\n\n<p>I have this code in the click event of a button I've added to a new ribbon:</p>\n\n<pre><code>Sub DisplayForm4Calc1(ByVal control As IRibbonControl)\nOn Error Resume Next\n    frmAA.Show\nEnd Sub\n</code></pre>\n\n<p>I have this code in frmAA, just initializing some controls:</p>\n\n<pre><code>Option Explicit\nPublic myPrevious As Boolean\n\nPrivate Sub UserForm_Initialize()\nOn Error Resume Next\n    refNumerator.value = \"\"\n    refDenominator.value = \"\"\n    MultiPage.value = 3\nEnd Sub\n</code></pre>\n\n<p>The error is highlighting the line 'Private Sub UserForm_Initialize()'.</p>\n"}, {"tags": ["vba", "excel", "range", "unique"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6461568, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2c78a271e31b8eeb19d6f04a57f9250?s=128&d=identicon&r=PG&f=1", "display_name": "beks123", "link": "https://stackoverflow.com/users/6461568/beks123"}, "edited": false, "score": 0, "creation_date": 1468435534, "post_id": 38359187, "comment_id": 64131378, "body": "okay but when I try to add a column, it gives me other errors"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 4, "last_activity_date": 1468434360, "creation_date": 1468434360, "answer_id": 38359187, "question_id": 38359087, "link": "https://stackoverflow.com/questions/38359087/subscript-out-of-range-error-within-array-for-loop-in-vba/38359187#38359187", "title": "subscript out of range error within array for loop in vba", "body": "<p>When you load the values in the array likes this:\n<code>arrValues = .Range(\"I2\", .Range(\"I\" &amp; .Rows.Count).End(xlUp))</code>\nit becomes multidimensional. ( Rows and Columns )</p>\n\n<p>In this line you are just providing one dimension(row) as <code>j</code> and missing the other dimension (column). Hence the error.</p>\n\n<p><code>.Range(.Cells(i, j * 4 + 2), .Cells(i, j * 4 + 4)).Value = arrValues(j)</code></p>\n"}], "owner": {"reputation": 55, "user_id": 6461568, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2c78a271e31b8eeb19d6f04a57f9250?s=128&d=identicon&r=PG&f=1", "display_name": "beks123", "link": "https://stackoverflow.com/users/6461568/beks123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 953, "favorite_count": 0, "accepted_answer_id": 38359187, "answer_count": 1, "score": 0, "last_activity_date": 1468434360, "creation_date": 1468433999, "question_id": 38359087, "link": "https://stackoverflow.com/questions/38359087/subscript-out-of-range-error-within-array-for-loop-in-vba", "title": "subscript out of range error within array for loop in vba", "body": "<p>Making a copy of data from a reference file and making the copy unique and then placing those unique texts in a loop of column headers in a new sheet. Anybody know why im getting the error \"subscript out of range\" within the \"With wsDB\" line?</p>\n\n<pre><code> Sub uniqueyes()\n\nDim wsRef As Worksheet\nDim wsDB As Worksheet\n\nSet wsRef = Worksheets(\"reference1\")\nSet wsDB = Worksheets(\"Sheet1\")\n\nWith wsRef\n    .Range(\"F1:F60\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=.Range(\"I1\"), unique:=True\n\n    Dim arrValues As Variant\n    arrValues = .Range(\"I2\", .Range(\"I\" &amp; .Rows.Count).End(xlUp))\n\nEnd With\n\nFor i = 1 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row\n\n    If Cells(i, 4) = \"Title\" Then\n\n        For j = 1 To (UBound(arrValues)) Step 1\n\n\n         With wsDB\n\n          .Range(.Cells(i, j * 4 + 2), .Cells(i, j * 4 + 4)).Value = arrValues(j)\n\n\n\n            End With\n\n        Next j\n\n    End If\n\nNext i\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 3, "creation_date": 1468432883, "post_id": 38358577, "comment_id": 64129797, "body": "Does this have to be VBA? You can do this with a formula: <code>=LEFT(A1,6)&amp;TEXT(MID(A1,FIND(&quot;-&quot;,A1)+1,LEN(A1)),&quot;0000&quot;)</code> and then just copy -&gt; paste special -&gt; values"}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1468432913, "creation_date": 1468432913, "answer_id": 38358777, "question_id": 38358577, "link": "https://stackoverflow.com/questions/38358577/excel-vba-add-zeros-inbetween-two-values/38358777#38358777", "title": "Excel VBA - add zero&#39;s inbetween two values", "body": "<pre><code>Sub testFunc()\n\n    MsgBox addZero(\"54126-3\")\n\nEnd Sub\n</code></pre>\n\n<p>'/ Function to add Zeros</p>\n\n<pre><code>Public Function addZero(strVal As String) As String\n\n    Dim arrTemp\n    Dim strTemp\n\n    arrTemp = Split(strVal, \"-\")\n\n    strTemp = arrTemp(0) &amp; \"-\" &amp; String(4 - Len(arrTemp(1)), \"0\") &amp; arrTemp(1)\n\n    addZero = strTemp\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1468433036, "creation_date": 1468433036, "answer_id": 38358817, "question_id": 38358577, "link": "https://stackoverflow.com/questions/38358577/excel-vba-add-zeros-inbetween-two-values/38358817#38358817", "title": "Excel VBA - add zero&#39;s inbetween two values", "body": "<p>As @tigeravatar stated it can be done with a formula.  With the Evaluate function we can use an array form of the formula he gave in his comment.</p>\n\n<p>You can apply this to your values in column C:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"C1:C4\").Value = Worksheets(\"Sheet1\").Evaluate(\"=INDEX(LEFT(C1:C4,6) &amp; TEXT(--MID(C1:C4,7,LEN(C1:C4)),\"\"0000\"\"),)\")\n</code></pre>\n\n<p>If your range is dynamic and you have the final row in a variable like <code>lstrow</code> you can replace all the <code>C4</code> with <code>C\" &amp; lstrow &amp; \"</code></p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"C1:C\" &amp; lstrow).Value = Worksheets(\"Sheet1\").Evaluate(\"=INDEX(LEFT(C1:C\" &amp; lstrow &amp; \",6) &amp; TEXT(--MID(C1:C\" &amp; lstrow &amp; \",7,LEN(C1:C\" &amp; lstrow &amp; \")),\"\"0000\"\"),)\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 3358196, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1428f9f51d2cc735fb0fc3750d1b4cd1?s=128&d=identicon&r=PG&f=1", "display_name": "smakfactor1", "link": "https://stackoverflow.com/users/3358196/smakfactor1"}, "edited": false, "score": 0, "creation_date": 1468438422, "post_id": 38359054, "comment_id": 64132885, "body": "I&#39;m liking your solution the best so far, however it is blowing up pretty commonly.  It seems to work half the time...then continuously dies on this line:         ary(1) = bry(Len(ary(1))) &amp; ary(1)                                                                                                       Interestingly enough, when it blows up, if I click stop debugging, and try again it will work momentarily, then have the same error shortly after."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 81, "user_id": 3358196, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1428f9f51d2cc735fb0fc3750d1b4cd1?s=128&d=identicon&r=PG&f=1", "display_name": "smakfactor1", "link": "https://stackoverflow.com/users/3358196/smakfactor1"}, "edited": false, "score": 0, "creation_date": 1468438636, "post_id": 38359054, "comment_id": 64132979, "body": "Data must have the dash and zero to four characters after"}, {"owner": {"reputation": 81, "user_id": 3358196, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1428f9f51d2cc735fb0fc3750d1b4cd1?s=128&d=identicon&r=PG&f=1", "display_name": "smakfactor1", "link": "https://stackoverflow.com/users/3358196/smakfactor1"}, "edited": false, "score": 0, "creation_date": 1468439019, "post_id": 38359054, "comment_id": 64133176, "body": "Blew up on the 544117-30 porttion of this data:                                                                                                                454117-0120 454117-0070 454117-0040 454117-0020 454117-30 454107-010 454117-080 454107-020 454868-020 454868-050"}, {"owner": {"reputation": 81, "user_id": 3358196, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1428f9f51d2cc735fb0fc3750d1b4cd1?s=128&d=identicon&r=PG&f=1", "display_name": "smakfactor1", "link": "https://stackoverflow.com/users/3358196/smakfactor1"}, "edited": false, "score": 0, "creation_date": 1468439055, "post_id": 38359054, "comment_id": 64133189, "body": "All in cells in the same Column.  It did the first 4 successfully, stopped on the 5th"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1468433874, "creation_date": 1468433874, "answer_id": 38359054, "question_id": 38358577, "link": "https://stackoverflow.com/questions/38358577/excel-vba-add-zeros-inbetween-two-values/38359054#38359054", "title": "Excel VBA - add zero&#39;s inbetween two values", "body": "<p>Select the cells you wish to process and run:</p>\n\n<pre><code>Sub dural()\n    Dim r As Range\n\n    bry = Array(\"0000\", \"000\", \"00\", \"0\", \"\")\n    For Each r In Selection\n        ary = Split(r.Value, \"-\")\n        ary(1) = bry(Len(ary(1))) &amp; ary(1)\n        r.Value = Join(ary, \"-\")\n    Next r\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TmzFZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TmzFZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>and after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RKcjj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RKcjj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 81, "user_id": 3358196, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1428f9f51d2cc735fb0fc3750d1b4cd1?s=128&d=identicon&r=PG&f=1", "display_name": "smakfactor1", "link": "https://stackoverflow.com/users/3358196/smakfactor1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1468433874, "creation_date": 1468432304, "last_edit_date": 1468432606, "question_id": 38358577, "link": "https://stackoverflow.com/questions/38358577/excel-vba-add-zeros-inbetween-two-values", "title": "Excel VBA - add zero&#39;s inbetween two values", "body": "<p>I've done quite a bit of searching around for this one...and I'm not getting anywhere.</p>\n\n<p>I have a spreadsheet(specific column) with values such as:</p>\n\n<pre><code>42153-95    \n54126-3    \n13613-6331    \n16136-336\n</code></pre>\n\n<p>My goal is to add zero's after the - and before the existing #'s(to 4 places).  Like:</p>\n\n<pre><code>42153-0095    \n54126-0003    \n13613-6331    \n16136-0336\n</code></pre>\n\n<p>I've tried a a lot of different options within the quotes of NumberFormat:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Columns(\"C\"). _ NumberFormat = \"00000-0000\"\n</code></pre>\n\n<p>No luck so far.  :(</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1468432715, "last_edit_date": 1468432715, "creation_date": 1468432198, "answer_id": 38358545, "question_id": 38358227, "link": "https://stackoverflow.com/questions/38358227/using-vba-to-read-autofilter-criteria/38358545#38358545", "title": "Using VBA to Read AutoFilter Criteria", "body": "<p>This isn't quite doing what you describe, I think it's processing it less-efficiently because it's checking every cell against every value. </p>\n\n<p>I think this is probably inefficient, because as the <code>values</code> collection grows in length, the second loop will take longer to process.</p>\n\n<p>You could get some improvement if you exit your nested <code>For</code> early:</p>\n\n<pre><code>    Do While Cells(i, col) &lt;&gt; \"\"\n        For Each value In values\n            If Cells(i, col).value = value Then \n                toAdd = False\n            Else:\n                values.Add (Cells(i, col).value) \n                Exit For  '### If the value is found, there's no use in checking the rest of the values!\n            End If\n        Next value\n        i = i + 1\n    Loop\n</code></pre>\n\n<p>But I think a Dictionary may give you performance improvement. This way, we don't need to loop over the collection, we just make use of the dictionary's <code>.Exists</code> method. If it doesn't exist, we add to the collection, if it does, we don't. Then the function still returns the collection of uniques.</p>\n\n<pre><code>Function getUnique(Optional col As Integer) As Collection\n    If col = 0 Then col = 2\n    Dim values As Object\n    Dim value As Variant\n    Dim i As Integer\n    Dim toAdd As Boolean\n    Dim ret as New Collection\n\n    i = 3 'first row with data\n    Set values = CreateObject(\"Scripting.Dictionary\")\n\n    With Cells(i, col)\n    Do While .Value &lt;&gt; \"\"\n        If Not values.Exists(.Value) \n            values(.Value) = 1\n            ret.Add(.Value)   '## Add the item to your collection\n        Else\n            '## Count the occurences, in case you need to use this later\n            values(.Value) = values(.Value) + 1\n\n        End If\n        i = i + 1\n    Loop\n\n    Set getUnique = ret\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1468433902, "creation_date": 1468433902, "answer_id": 38359063, "question_id": 38358227, "link": "https://stackoverflow.com/questions/38358227/using-vba-to-read-autofilter-criteria/38359063#38359063", "title": "Using VBA to Read AutoFilter Criteria", "body": "<p>The <code>AdvancedFilter</code> method may come in handy here and produce cleaner, easier to maintain code. This will work so long as you are calling this Function from another VBA module and not from a cell.</p>\n\n<pre><code>Function getUnique(Optional col As Integer) As Collection\n\n    If col = 0 Then col = 2\n\n    Dim values As Collection\n    Dim value As Variant\n    Dim i As Integer\n\n    i = 3 'first row with data\n\n    Range(Cells(i, col), Cells(Rows.Count, col).End(xlUp)).AdvancedFilter xlFilterCopy, CopyToRange:=Cells(1, Columns.Count)\n\n    Set values = New Collection\n\n    Dim cel As Range\n    For Each cel In Range(Cells(1, Columns.Count), Cells(1, Columns.Count).End(xlDown))\n        values.Add cel.value\n    Next\n\n    Range(Cells(2, Columns.Count), Cells(1, Columns.Count).End(xlDown)).Clear\n\n    Set getUnique = values\n\nEnd Function\n</code></pre>\n\n<p>Tested with this sub:</p>\n\n<pre><code>Sub Test()\n\nDim c As Collection\nSet c = getUnique(4)\n\nFor i = 1 To c.Count\n    Debug.Print c.Item(i)\nNext\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5119846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/801ad618315b8bafa4fe1a7f8470da50?s=128&d=identicon&r=PG&f=1", "display_name": "Matan P", "link": "https://stackoverflow.com/users/5119846/matan-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1029, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1468433902, "creation_date": 1468431047, "question_id": 38358227, "link": "https://stackoverflow.com/questions/38358227/using-vba-to-read-autofilter-criteria", "title": "Using VBA to Read AutoFilter Criteria", "body": "<p>I am working with an excel workbook where I want to find all unique values in a column. </p>\n\n<p>I have code that works by looping through all the rows and for each row looping through a collection of values seen so far and checking if I've seen it before. </p>\n\n<p>It works like this.\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Function getUnique(Optional col As Integer) As Collection\r\n    If col = 0 Then col = 2\r\n    Dim values As Collection\r\n    Dim value As Variant\r\n    Dim i As Integer\r\n    Dim toAdd As Boolean\r\n    \r\n    i = 3 'first row with data\r\n    Set values = New Collection\r\n    \r\n    Do While Cells(i, col) &lt;&gt; \"\"\r\n        toAdd = True\r\n        For Each value In values\r\n            If Cells(i, col).value = value Then toAdd = False\r\n        Next value\r\n        If toAdd Then values.Add (Cells(i, col).value)\r\n        i = i + 1\r\n    Loop\r\n    \r\n    Set getUnique = values\r\n        \r\nEnd Function</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>However, Excel AutoFilter is able to find these values much faster. Is there a way to filter and then read the unique values?</p>\n\n<p>I've tried using the AutoFilter.Filters object but all of the .ItemX.Criteria1 values have a \"Application-defined or object-defined error\" (found using a watch on ActiveSheet.AutoFilter.Filters).</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1468431118, "post_id": 38358197, "comment_id": 64128702, "body": "Looks like there&#39;s no form with that name?"}, {"owner": {"reputation": 11, "user_id": 6585751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c445a8019659b832177a71f295791d2?s=128&d=identicon&r=PG&f=1", "display_name": "A. Weiss", "link": "https://stackoverflow.com/users/6585751/a-weiss"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468431380, "post_id": 38358197, "comment_id": 64128852, "body": "Hi Tim, there is a form with that name."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1468431405, "post_id": 38358197, "comment_id": 64128865, "body": "Then there may be an error in the <code>Activate</code> or <code>Initilialize</code> procedure of the <code>frmBookingLCL</code> object?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1468431471, "post_id": 38358197, "comment_id": 64128906, "body": "Can you add screenshot of the object VBAProject, expanded to show all of your UserForms?"}, {"owner": {"reputation": 11, "user_id": 6585751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c445a8019659b832177a71f295791d2?s=128&d=identicon&r=PG&f=1", "display_name": "A. Weiss", "link": "https://stackoverflow.com/users/6585751/a-weiss"}, "edited": false, "score": 0, "creation_date": 1468431570, "post_id": 38358197, "comment_id": 64128970, "body": "this is the initialize sub for the form.Private Sub UserForm_Initialize()     txtPickupDate = &quot;&quot;     LogisOceanNeeded = False     Me.Caption = Me.Caption &amp; &quot;  *** &quot; &amp; sHBL &amp; &quot; ***&quot;     lblCustomerName = sCustomerName     lblHBL = sHBL          txtPickupDate = sA02     If txtPickupDate = &quot;&quot; Then             LogisOceanNeeded = True     End If     If sTruckerName = &quot;&quot; Then         frTrucker.Enabled = False         CheckBox1.Enabled = False         MsgBox (&quot;No Trucker in LOGIS&quot;)     Else         txtPickupDate.SetFocus         CheckBox1 = True     End If           End Sub"}, {"owner": {"reputation": 11, "user_id": 6585751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c445a8019659b832177a71f295791d2?s=128&d=identicon&r=PG&f=1", "display_name": "A. Weiss", "link": "https://stackoverflow.com/users/6585751/a-weiss"}, "edited": false, "score": 0, "creation_date": 1468431817, "post_id": 38358197, "comment_id": 64129112, "body": "sorry everyone I am new to the site and to programming."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1468432207, "post_id": 38358197, "comment_id": 64129346, "body": "Do not add relevant code in a comment. Instead, <a href=\"https://stackoverflow.com/posts/38358197/edit\">edit</a> your question and add it there, where it can be seen (and properly formatted)."}], "answers": [{"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 11, "user_id": 6585751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c445a8019659b832177a71f295791d2?s=128&d=identicon&r=PG&f=1", "display_name": "A. Weiss", "link": "https://stackoverflow.com/users/6585751/a-weiss"}, "edited": false, "score": 0, "creation_date": 1468433367, "post_id": 38358415, "comment_id": 64130100, "body": "Cheers!!. and make sure you mark the question as  answered."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1468432980, "last_edit_date": 1468432980, "creation_date": 1468431724, "answer_id": 38358415, "question_id": 38358197, "link": "https://stackoverflow.com/questions/38358197/run-time-error-424-object-required-for-case-function/38358415#38358415", "title": "Run-time error &#39;424;&quot; Object Required for case function", "body": "<p>Most likely, the error is in your user form.  See the code comments.</p>\n\n<p>I tried to replicate the issue below:</p>\n\n<pre><code>Sub test()\n\n'/Sub  to load the user form.\n\nDim x   As String\n\n    x = \"a\"\n\n    Select Case x\n    Case \"a\", \"b\", \"c\"\n        UserForm1.Show '/ It Will error-out here during debugging.\n    End Select\nEnd Sub\n</code></pre>\n\n<p>Code in UserForm1</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    '/ Code from : https://msdn.microsoft.com/en-us/library/office/gg251554.aspx\n    '/ Actually the error happens here.\n\n    Dim RetVal ' Implicitly a Variant.\n    ' Default property is assigned to Type 8 Variant RetVal.\n    RetVal = CreateObject(\"Excel.Application\")\n    RetVal.Visible = True ' Error occurs here.\nEnd Sub\n</code></pre>\n\n<p>So going by your intialize code, either you are missing or have incorrect name for one of these controls.\n<code>frTrucker</code>,<code>CheckBox1</code>,<code>txtPickupDate</code>. Once you correct them, the error will be gone.</p>\n"}], "owner": {"reputation": 11, "user_id": 6585751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c445a8019659b832177a71f295791d2?s=128&d=identicon&r=PG&f=1", "display_name": "A. Weiss", "link": "https://stackoverflow.com/users/6585751/a-weiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468432980, "creation_date": 1468430958, "last_edit_date": 1468431036, "question_id": 38358197, "link": "https://stackoverflow.com/questions/38358197/run-time-error-424-object-required-for-case-function", "title": "Run-time error &#39;424;&quot; Object Required for case function", "body": "<p>i can not figure this out below is the code.... I hit the error for the 2nd case to open the form frmBookingLCL.show the form name is correct. I can't figure this out.  the line with the **** us the error line. HELP!!</p>\n\n<pre><code>Public Sub SendBookingEmail()\n    StartTime = Timer\n    With Session\n            'check first 2 letters of shipper's code, if not US raise error\n            If IsStartPositionCorrect(5, 14, 2, \"US\") &lt;&gt; True Or IsStartPositionCorrect(5, 2, 8, \"Customer\") &lt;&gt; True And GetDisplayText(4, 20, 1) &lt;&gt; \"0\" Then\n                If MsgBox(\"You don't appear to be in Logis ocean export US file. Please enter the file first and then run the macro.\", vbOKOnly, \"Export file verification....\") Then\n                    Exit Sub\n                End If\n            End If\n\n            sTypeOfMessage = \"booking\"\n            sShipmentType = Trim(.GetDisplayText(9, 61, 3))\n            sFileType = Trim(.GetDisplayText(4, 32, 1))\n            bFullVersion = False\n\n            'On Error GoTo ErrHand\n\n            'Get Outlook if it's running\n            Set oOutlookApp = GetObject(, \"Outlook.Application\")\n\n            'collect data fields for the e-mail body\n            GetAllLogisDataBooking\n\n\n            'Blow up the question form\n            Select Case sShipmentType\n                Case \"FCL\", \"CMF\", \"CCS\", \"FPR\"\n                    frmBookingFCL.Show\n                Case \"LCL\", \"GWY\", \"CLD\"\n                    frmBookingLCL.Show**********ERROR HERE\n                Case Else\n                    frmBookingFCL.Show\n                    'frmBookingOthers.Show\n            End Select\n\n\n    End With\n\n    Finish = Timer\n    TimeTook = Finish - StartTime\n    MyMacroStats = GetProcedureStats(\"Booking Confirmation\", TimeTook)\n\n\n    Exit Sub\n\nErrHand:\n\n        If Err = 429 Then\n            MsgBox \"Please note you must start Microsoft Outlook first.\"\n            End\n        End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "getelementbyid"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1468430977, "post_id": 38358178, "comment_id": 64128628, "body": "<code>IE.Document.getElementById(&quot;myId&quot;)</code> will give you the specific input you want."}, {"owner": {"reputation": 305, "user_id": 3019986, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jq5E8.jpg?s=128&g=1", "display_name": "M. Coutinho", "link": "https://stackoverflow.com/users/3019986/m-coutinho"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468431184, "post_id": 38358178, "comment_id": 64128741, "body": "When I use that IE.Document.getElementById(&quot;myId&quot;).Value = 2  it returns a Run-time error &#39;424&#39;: Object required"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468431232, "post_id": 38358178, "comment_id": 64128764, "body": "Then likely there&#39;s no element with that id."}, {"owner": {"reputation": 305, "user_id": 3019986, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jq5E8.jpg?s=128&g=1", "display_name": "M. Coutinho", "link": "https://stackoverflow.com/users/3019986/m-coutinho"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468431286, "post_id": 38358178, "comment_id": 64128797, "body": "When I check the webpage code source i can find the element."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468431752, "post_id": 38358178, "comment_id": 64129078, "body": "Can&#39;t really suggest anything without seeing the URL or the HTML source and/or the rest of your code."}, {"owner": {"reputation": 305, "user_id": 3019986, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jq5E8.jpg?s=128&g=1", "display_name": "M. Coutinho", "link": "https://stackoverflow.com/users/3019986/m-coutinho"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468431937, "post_id": 38358178, "comment_id": 64129177, "body": "The webpage is only available if you are in the same network. I cannot share the URL."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1468432263, "post_id": 38358178, "comment_id": 64129384, "body": "Is it possible the page is not fully-loaded when your code runs?  Try putting a break in your code and waiting a few seconds before running the rest of the lines."}, {"owner": {"reputation": 305, "user_id": 3019986, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jq5E8.jpg?s=128&g=1", "display_name": "M. Coutinho", "link": "https://stackoverflow.com/users/3019986/m-coutinho"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468432581, "post_id": 38358178, "comment_id": 64129581, "body": "Maybe. The input tags refer to DatePicker and it is hidden when the page loads. You need to click an icon to popup the DatePicker.  Although Im selecting a value from a &lt;select&gt; tag in DatePicker without clicking on it.  I tested like you said and it worked. It seems I need to click on the icon first to popup the datepicker."}], "owner": {"reputation": 305, "user_id": 3019986, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jq5E8.jpg?s=128&g=1", "display_name": "M. Coutinho", "link": "https://stackoverflow.com/users/3019986/m-coutinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1350, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468430886, "creation_date": 1468430886, "question_id": 38358178, "link": "https://stackoverflow.com/questions/38358178/vba-excel-type-value-in-input-tag-using-id-attribute", "title": "VBA Excel: Type value in &lt;input&gt; tag (using Id attribute)", "body": "<p>How can I type a value from a cell into an  tag using Id attribute?</p>\n\n<p>I have phew  tags in a webpage (see example below):</p>\n\n<pre><code>&lt;input id=\"myId\" type=\"text\" value= \"2&gt;\n</code></pre>\n\n<p>I have the following code to search all  tags and when it finds the  tag with specific Id, I want to type the new value.</p>\n\n<pre><code>Set objInputCollection = IE.Document.getElementsByTagName(\"input\")\n\ncountInputObjects = 0\nDo While countInputObjects &lt; objInputCollection.Length\n\n    Select Case objInputCollection(countInputObjects).ID\n\n        Case \"myId\"\n            ' Set value\n            objInputCollection(countInputObjects).Value = Sheets(\"MySheet\").Range(\"D15\").Value\n\n        Case \"myID_2\"\n            ' Set \"Range\" value\n            objInputCollection(countInputObjects).Value = Sheets(\"MySheet\").Range(\"D10\").Value\n\n    End Select\n\n    countInputObjects = countInputObjects + 1\n\nLoop\n</code></pre>\n\n<p>My code is not working and does not go into any \"Case\". </p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1468433746, "post_id": 38358309, "comment_id": 64130336, "body": "Also <code>Select Case NamePart </code> should be <code>Select Case part</code>"}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": true, "score": 2, "last_activity_date": 1468433793, "last_edit_date": 1468433793, "creation_date": 1468431358, "answer_id": 38358309, "question_id": 38358036, "link": "https://stackoverflow.com/questions/38358036/vba-type-mismatch/38358309#38358309", "title": "VBA: Type Mismatch", "body": "<p><code>NamePart</code> is an enum, which means to use it for comparisons you probably want to ask if any one item in the enum is equal to some value. </p>\n\n<pre><code>If part = NamePart.EnvironmentDefined Then\n</code></pre>\n\n<p>also</p>\n\n<pre><code>Select Case part\n    Case NamePart.FullName\n        result = userInfo.FullName\n    Case NamePart.FirstName\n        result = userInfo.GivenName\n    Case NamePart.LastName\n        result = userInfo.LastName\n    Case Else\n        result = Environ$(\"USERNAME\")\nEnd Select\n</code></pre>\n\n<p>Notice that when you hit <code>.</code> after <code>NamePart</code> all your enum options appear. </p>\n"}], "owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 38358309, "answer_count": 1, "score": -2, "last_activity_date": 1468433793, "creation_date": 1468430442, "question_id": 38358036, "link": "https://stackoverflow.com/questions/38358036/vba-type-mismatch", "title": "VBA: Type Mismatch", "body": "<p>I'm not particularly good at VBA yet. I am getting the error in the title pointing to the line that begins with <code>If NamePart =</code> and it's highlighting the <code>=</code> sign. Anyone know why?</p>\n\n<pre><code>Public Enum NamePart\n    EnvironmentDefined\n    FullName\n    FirstName\n    LastName\nEnd Enum\n\nPublic Function GetUser(Optional ByVal part As NamePart = EnvironmentDefined) As String\n\n    Dim result As String\n    Dim sysInfo As Object\n    Dim userInfo As Object\n\n    If NamePart = EnvironmentDefined Then\n        GetUser = Environ$(\"USERNAME\")\n        Exit Function\n    End If\n\n    Set sysInfo = CreateObject(\"ADSystemInfo\")\n    Set userInfo = GetObject(\"LDAP://\" &amp; sysInfo.UserName)\n    Select Case NamePart\n        Case FullName\n            result = userInfo.FullName\n        Case FirstName\n            result = userInfo.GivenName\n        Case LastName\n            result = userInfo.LastName\n        Case Else\n            result = Environ$(\"USERNAME\")\n    End Select\n\n    GetUser = result\n\nEnd Function\n\nPrivate Sub Command363_Click()\n\n    Call GetUser\n    MsgBox \"Username: \" &amp; GetUser\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "edited": false, "score": 0, "creation_date": 1468441107, "post_id": 38358528, "comment_id": 64134322, "body": "Thomas, thank you for your answer! I tried running the code, but it gave me an application or object-defined error 1004...  I had to modify it a bit:  &lt;br&gt;  Sub try()  Dim rw As Long, Cell1 As Variant, Cell2 As Variant Dim y As Workbook Dim x as workbook  Set x = Workbooks.Add Set y = Workbooks(&quot;Book5.xlsm&quot;)    rw = 100 Cell1 = Range(&quot;A&quot; &amp; rw) Cell2 = Range(&quot;A&quot; &amp; rw).End(xlToRight).End(xlDown) &#39;This is the bottom left cell in the table   Set Target = Range(Cell1, Cell2) /error occurs here  Target.Copy x.Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;)  End Sub  &lt;/br&gt;  I&#39;ll see..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "edited": false, "score": 0, "creation_date": 1468441751, "post_id": 38358528, "comment_id": 64134651, "body": "It should have been <code>Set Cell1</code> and <code>Set Cell2</code>.  I added your example fixed the reference.  Note: Cell1 an Cell2 as ranges."}, {"owner": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "edited": false, "score": 0, "creation_date": 1468503052, "post_id": 38358528, "comment_id": 64161525, "body": "putting Set for Cell 1 and Cell 2 worked. I was under the impression that when you set the dynamic range, you don&#39;t put Set, because it&#39;s given me errors doing so in the past...  Another thing, instead of xlDown, it should be xlUp, and then the code is flawless. Thanks again!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "edited": false, "score": 0, "creation_date": 1468511711, "post_id": 38358528, "comment_id": 64167791, "body": "The reference a dynamic range is not dynamic it&#39;s set.  The example was merely to inform.  But I didn&#39;t explain myself very well."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1468441495, "last_edit_date": 1468441495, "creation_date": 1468432124, "answer_id": 38358528, "question_id": 38358018, "link": "https://stackoverflow.com/questions/38358018/vba-copy-a-dynamic-range-to-a-new-workbook/38358528#38358528", "title": "VBA - copy a dynamic range to a new workbook", "body": "<p>The Range object can take two parameters <code>Range([Cell1],[Cell2)</code>.  Gereerally, you'll use the top left cell as first parameter and the bottom right cell as the second. <br></p>\n\n<p>The first parameter of your code is <code>Cells(1, 1)</code> and the second is <code>Cells(xRow, xColumn)</code>.  The range will extend from <code>Row 1 Column 1</code> to <code>Row xRow, Column xColumn</code>.</p>\n\n<blockquote>\n  <p>Range(Cells(1, 1), Cells(xRow, xColumn))</p>\n</blockquote>\n\n<p>There is no need to select a range when copying and pasting.  We can chain ranges methods together. <br></p>\n\n<p>Here we set a range that starting in <code>D100</code> extending to the leftmost column and then down to the last used cell in the list.  We then copy it and paste it into <code>y.Worksheets(\"Sheet3\").Range(\"A1\")</code>. </p>\n\n<p>Foe example:</p>\n\n<pre><code>Dim rw As Long, Cell1 As Range, Cell2 As Range\nDim y As Workbook\nSet x = Workbooks.Add\nSet y = Workbooks(\"Book5.xlms\")\nrw = 100\nSet Cell1 = Range(\"A\" &amp; rw)\nSet Cell2 = Range(\"A\" &amp; rw).End(xlToRight).End(xlDown)    'This is the bottom left cell in the table\nSet Target = Range(Cell1, Cell2)\nTarget.Copy x.Worksheets(\"Sheet1\").Range(\"A1\")\n</code></pre>\n\n<p>We can do all this on 1 line like this:</p>\n\n<pre><code>rw = 100\nRange(\"D\" &amp; rw, Range(\"D\" &amp; rw).End(xlToRight).End(xlDown)).Copy y.Worksheets(\"Sheet3\").Range(\"A1\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "edited": false, "score": 0, "creation_date": 1468441352, "post_id": 38358685, "comment_id": 64134433, "body": "Logan, thank you for your input! Your solution works just fine, and I&#39;ll adjust to work for a new workbook. It copies and pastes the dynamic range as it should. Thanks again!"}], "tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": true, "score": 0, "last_activity_date": 1468433021, "last_edit_date": 1468433021, "creation_date": 1468432618, "answer_id": 38358685, "question_id": 38358018, "link": "https://stackoverflow.com/questions/38358018/vba-copy-a-dynamic-range-to-a-new-workbook/38358685#38358685", "title": "VBA - copy a dynamic range to a new workbook", "body": "<p>Another approach using <code>.Resize</code>. I think this method is a bit better than @Thomas Inzina because it goes along column and row headers (the <code>.End</code> methods) which are likely to not have empty cells. In Thomas'es example, if your data has empty cells in the last column, the code will copy incomplete table.</p>\n\n<p><a href=\"https://i.stack.imgur.com/S9yKs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S9yKs.png\" alt=\"Source Table\"></a></p>\n\n<pre><code>Sub copyTableIntoNewWorksheet()\n\n    ' locate the dynamic range / table\n    Dim rngTable As Range\n    With ActiveSheet.[b2]    ' top left cell of the dynamic range\n        Set rngTable = .Resize(Range(.Offset(0), .End(xlDown)).Rows.Count, _\n                               Range(.Offset(0), .End(xlToRight)).Columns.Count)\n    End With\n\n    ' create new worksheet\n    Dim wsNew As Worksheet\n    Set wsNew = Worksheets.Add\n    wsNew.Name = \"New Sheet\"\n\n    ' copy table to new worksheet\n    rngTable.Copy wsNew.[a1] ' top left cell where to copy the table to\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1210, "favorite_count": 0, "accepted_answer_id": 38358685, "answer_count": 2, "score": 0, "last_activity_date": 1468441495, "creation_date": 1468430397, "last_edit_date": 1531164843, "question_id": 38358018, "link": "https://stackoverflow.com/questions/38358018/vba-copy-a-dynamic-range-to-a-new-workbook", "title": "VBA - copy a dynamic range to a new workbook", "body": "<p>I'm trying to figure out how to copy a dynamic range into a new workbook. The actual project is to generate monthly budget reports based on the user's choice of month. The overarching system tracks a number of budget lines, where each line has its own sheet, and each sheet holds 12 tables for the fiscal year for expenses to be input; it all feeds back into an annual budget sheet. Upon the user picking a month, a new workbook will be created, mirroring the number of sheets and filling each sheet with that month's table. Each table is a dynamic range.</p>\n\n<p>What I've got below is a dry run to work out the mechanics, but the problem is that I cannot get the dynamic range to paste correctly:</p>\n\n<pre><code>Sub pasting()\n\nOn Error Resume Next\n\nDim x As Workbook\nDim y As Workbook\n\n'set the budget tracking system as the active workbook\nSet x = Workbooks(\"Save and copying proof of concept.xlsm\")\n\n'activate budget tracking system\nx.Activate\n\nSet y = Workbooks.Add\n\nDim z As Range\nDim w As Range\n\n\n'test copying two cells in two sheets into new sheets in the new workbook\nSet z = Workbooks(\"Save and copying proof of concept.xlsm\").Sheets(\"Sheet1\").Range(\"A1\")\nSet w = Workbooks(\"Save and copying proof of concept.xlsm\").Sheets(\"Sheet2\").Range(\"A1\")\n\n'call saveas option for monthly workbook\nWith y\n    Call save_workbook_newName\nEnd With\n\n'add 8 sheets to new workbook for 8 budget lines\nDim v As Worksheet\nDim i As Integer\n\nFor i = 1 To 7\n   Sheets.Add\n\nNext i\n\n'copy the specified range from the original sheet and into the newly created workbook.\n\nz.Copy\ny.Sheets(\"Sheet1\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\nw.Copy\ny.Sheets(\"Sheet2\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n'copy a dynamic range to a new workbook\n\nx.Worksheets(\"Sheet3\").Activate\n\nDim xRow As Long, xColumn As Long\n\n'determine the row and column limits of the dynamic range\nRange(\"A100\").End(xlUp).Select\nxRow = ActiveCell.Row\n\nRange(\"D\").End(xlToLeft).Activate\nxColumn = ActiveCell.Column\n\n'select the range specified by the dynamic boundaries\nRange(Cells(1, 1), Cells(xRow, xColumn)).Select\n\nSelection.Copy\n\n'activate newly created workbook\ny.Worksheets(\"Sheet3\").Activate\n\n'paste into the new workbook\nSelection.PasteSpecial Paste:=xlPasteAll, operation:=xlNone, SkipBlanks:=False, _\n    Transpose:=False\n\nEnd Sub\n\n\n\nSub save_workbook_newName()\n\n    Dim workbook_name As Variant\n\n    'display the SaveAs dialog box\n    'once a name is provided, the GetSaveAsFilename method gets the particular name and _\n    'assigns that name to the workbook_name variable\n\n    workbook_name = Application.GetSaveAsFilename\n\n    'if the user provides a filename, the true condition is executed, and if not (presses Cancel), the false condition is executed.\n    If workbook_name &lt;&gt; False Then\n\n    'the application.acriveworkbook property returns the workbooks to the current active window\n    'saves the file with the file name given by the user.\n\n        ActiveWorkbook.SaveAs Filename:=workbook_name &amp; \"xlsx\"\n    Else\n        ActiveWorkbook.Close\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This bit is the problematic code:</p>\n\n<pre><code>Range(\"A100\").End(xlUp).Select\nxRow = ActiveCell.Row\n\nRange(\"D\").End(xlToLeft).Activate\nxColumn = ActiveCell.Column\n\n'select the range specified by the dynamic boundaries\nRange(Cells(1, 1), Cells(xRow, xColumn)).Select\n</code></pre>\n\n<p>It essentially only copies column A, even if it's told to activate column D and choose everything to the left of it (Columns A to C hold random numbers).</p>\n\n<p>Using this method for selecting a dynamic range did not yield good results:</p>\n\n<pre><code>LR = Range(\"D1000\").End(xlUp).Row\nSet R1 = Range(\"D1:E\" &amp; LR)\n</code></pre>\n\n<p>Thanks, and I appreciate your help in this respect!</p>\n"}, {"tags": ["excel", "runtime-error", "vba"], "comments": [{"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1468430444, "post_id": 38357980, "comment_id": 64128293, "body": "if you manually open the workbook does it prompt for a password?  If so someone has protected the workbook which requires passwords to open now."}, {"owner": {"reputation": 867, "user_id": 5614011, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b09547b3658d918204b15e2ee17e1beb?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/5614011/raj"}, "reply_to_user": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1468430617, "post_id": 38357980, "comment_id": 64128412, "body": "@xQbert: No there is no password.The file is in my system and nothing has changed since yesterday. I tried it for another worksheet from a different file and the same error keeps repeating."}], "owner": {"reputation": 867, "user_id": 5614011, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b09547b3658d918204b15e2ee17e1beb?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/5614011/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 463, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468430901, "creation_date": 1468430243, "last_edit_date": 1531164843, "question_id": 38357980, "link": "https://stackoverflow.com/questions/38357980/run-time-error-1004-workbook-protected", "title": "Run time error &#39;1004&#39; - Workbook protected", "body": "<p>I wrote this code to move a sheet from one workbook to another. It was working till yesterday and suddenly is throwing</p>\n\n<pre><code>Run time error '1004': Workbook is protected and cannot be changed\n</code></pre>\n\n<p>Following is the code. Debug is showing the last statement before <code>END SUB</code> to be the problem. Am not able to figure out whats wrong.</p>\n\n<pre><code>Sub copydata()\n    Dim wkbSource As Workbook\n    Dim wkbDest As Workbook\n    Dim shttocopy As Worksheet\n    Dim wbname As String\n\n    ' check if the file is open (source file)\n    ret = Isworkbookopen(\"C:\\Users\\Desktop\\Scorecard\\Write Offs.xlsx\")\n    If ret = False Then\n        ' open file\n        Set wkbSource = Workbooks.Open(\"C:\\Users\\Desktop\\Scorecard\\Write Offs.xlsx\")\n    Else\n        Set wkbSource = Workbooks(\"Write Offs.xlsx\")\n    End If\n\n    ' check if the file is open\n\n    ret = Isworkbookopen(\"C:\\Users\\Desktop\\Scorecard\\Copy data from one excel to another.xlsm\")\n    If ret = False Then\n        ' open file\n        Set wkbDest = Workbooks.Open(\"C:\\Users\\Desktop\\Scorecard\\Copy data from one excel to another.xlsm\")\n    Else\n        Set wkbDest = Workbooks(\"Copy data from one excel to another.xlsm\")\n    End If\n\n    'Sheet to be copied from the PEH write off report\n    Set shttocopy = wkbSource.Sheets(\"PEH WBB TOTAL MPG\")\n    shttocopy.Copy wkbDest.Sheets(1)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "error-handling", "worksheet", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1468429581, "post_id": 38357770, "comment_id": 64127762, "body": "What row is the error?"}, {"owner": {"reputation": 69, "user_id": 5429103, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/223f5eac4d95f026d38a37abe43d58a6?s=128&d=identicon&r=PG&f=1", "display_name": "exlover", "link": "https://stackoverflow.com/users/5429103/exlover"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468521475, "post_id": 38357770, "comment_id": 64173375, "body": "@ScottCraner the error is in where it says Worksheets(&quot;Sheet1&quot;).Range(&quot;D11&quot;).Copy Worksheets(&quot;Sheet1&quot;).Range(&quot;W2:W&quot; &amp; LastRow4)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468521718, "post_id": 38357770, "comment_id": 64173523, "body": "When it stops what is the value of <code>LastRow4</code>?  The line works for me so the only thing I can think of is that <code>LastRow4</code> is 0 at the time."}, {"owner": {"reputation": 69, "user_id": 5429103, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/223f5eac4d95f026d38a37abe43d58a6?s=128&d=identicon&r=PG&f=1", "display_name": "exlover", "link": "https://stackoverflow.com/users/5429103/exlover"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468770346, "post_id": 38357770, "comment_id": 64252418, "body": "@ScottCraner mine is 5 because I have 5 records in the list. However, I understand why you get 0.  I am not sure why my code is not working on my machine? I would like to mention that the range in column U is used to create a curve using an offset formula. Would that be an issue?"}], "owner": {"reputation": 69, "user_id": 5429103, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/223f5eac4d95f026d38a37abe43d58a6?s=128&d=identicon&r=PG&f=1", "display_name": "exlover", "link": "https://stackoverflow.com/users/5429103/exlover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468429492, "creation_date": 1468429492, "last_edit_date": 1531164843, "question_id": 38357770, "link": "https://stackoverflow.com/questions/38357770/method-range-of-object-worksheet-failed-and-couldnt-solve-it", "title": "method &#39;range&#39; of object &#39;_worksheet&#39; failed and couldn&#39;t solve it", "body": "<p>I have a small problem that appears every time the code runs. I tried to change the code multiple times but I still get the same issue. I feel there the error is something related to the worksheet object but I couldn't fix it ! Any help is appreciated. </p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Excel.Range)\n\nDim LastRow4 As Long\n\nIf Worksheets(\"Sheet1\").Range(\"D12\").Value = \"Decrease\" Then\n\nIf Worksheets(\"Sheet1\").Range(\"D11\").Value &gt;= Worksheets(\"Sheet1\").Range(\"U1\").End(xlDown).Value Then\n\nWith ActiveSheet.Shapes(\"Chart 1\").Fill\n    .Visible = msoTrue\n    .ForeColor.RGB = RGB(146, 208, 80)\n    .Transparency = 0\n    .Solid\nEnd With\n\nElseIf Worksheets(\"Sheet1\").Range(\"D11\") &lt; Worksheets(\"Sheet1\").Range(\"U1\").End(xlDown).Value Then\n\nWith ActiveSheet.Shapes(\"Chart 1\").Fill\n    .Visible = msoTrue\n    .ForeColor.RGB = RGB(255, 0, 0)\n    .Transparency = 0\n    .Solid\nEnd With\nEnd If\n\nElseIf Worksheets(\"Sheet1\").Range(\"D12\").Value = \"Increase\" Then\nIf Worksheets(\"Sheet1\").Range(\"D11\").Value &gt;= Worksheets(\"Sheet1\").Range(\"U1\").End(xlDown).Value Then\n\nWith ActiveSheet.Shapes(\"Chart 1\").Fill\n    .Visible = msoTrue\n    .ForeColor.RGB = RGB(255, 0, 0)\n    .Transparency = 0\n    .Solid\nEnd With\nElseIf Worksheets(\"Sheet1\").Range(\"D11\") &lt; Worksheets(\"Sheet1\").Range(\"U1\").End(xlDown).Value Then\n\nWith ActiveSheet.Shapes(\"Chart 1\").Fill\n    .Visible = msoTrue\n    .ForeColor.RGB = RGB(146, 208, 80)\n    .Transparency = 0\n    .Solid\nEnd With\nEnd If\nEnd If\n\n\nLastRow4 = Worksheets(\"Sheet1\").Range(\"U\" &amp; Rows.Count).End(xlUp).Row\nWorksheets(\"Sheet1\").Range(\"D11\").Copy Worksheets(\"Sheet1\").Range(\"W2:W\" &amp; LastRow4)\nApplication.CutCopyMode = False\n\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1468429742, "post_id": 38357456, "comment_id": 64127869, "body": "You meant like to rename files? Or additional files that you want to get follow the format 1-xxxx?"}, {"owner": {"reputation": 1, "user_id": 6585142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224af98b51bae0a00b64193f25cdbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Carrie", "link": "https://stackoverflow.com/users/6585142/carrie"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1468434183, "post_id": 38357456, "comment_id": 64130586, "body": "I want the user to be able to name the file 1-(filename), e.g. 1-up close photo.  Then I need the code to recognize the 1- and choose that file, no matter what comes after the &quot;-&quot;.  I tried (&quot;U:\\Trial\\1- &amp; &quot;*&quot;.jpg&quot;) without success."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6585142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224af98b51bae0a00b64193f25cdbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Carrie", "link": "https://stackoverflow.com/users/6585142/carrie"}, "edited": false, "score": 0, "creation_date": 1468500860, "post_id": 38361635, "comment_id": 64159887, "body": "Yes, that works, but I am going to be inserting 10+ photos, I want them all to be named 1-(filename); 2-(filename); etc.  I just want it to pull the file based on the first two characters of the filename with a wildcard.  Not sure if possible..."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 1, "user_id": 6585142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224af98b51bae0a00b64193f25cdbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Carrie", "link": "https://stackoverflow.com/users/6585142/carrie"}, "edited": false, "score": 0, "creation_date": 1468502956, "post_id": 38361635, "comment_id": 64161453, "body": "Please explain, first you said you wanted the user being able to name the file and now you want them automatically named? What filename would be? (if picture is named 1; 1-1?)"}, {"owner": {"reputation": 1, "user_id": 6585142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224af98b51bae0a00b64193f25cdbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Carrie", "link": "https://stackoverflow.com/users/6585142/carrie"}, "edited": false, "score": 0, "creation_date": 1468508672, "post_id": 38361635, "comment_id": 64165555, "body": "I have 8 users naming the files.  I just want them all to name their first photo 1-(something).  Then I want the code to pull the photo that starts with 1-.  They will all be named, however the name will be different each time, depending on what the photo is, except they will all start 1-."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 1, "user_id": 6585142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224af98b51bae0a00b64193f25cdbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Carrie", "link": "https://stackoverflow.com/users/6585142/carrie"}, "edited": false, "score": 0, "creation_date": 1468510920, "post_id": 38361635, "comment_id": 64167215, "body": "You would need to loop through files in the folder then, take a look at this <a href=\"http://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">question</a>"}, {"owner": {"reputation": 1, "user_id": 6585142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224af98b51bae0a00b64193f25cdbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Carrie", "link": "https://stackoverflow.com/users/6585142/carrie"}, "edited": false, "score": 0, "creation_date": 1468517883, "post_id": 38361635, "comment_id": 64171286, "body": "Sorry, I don&#39;t follow"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 0, "last_activity_date": 1468443693, "creation_date": 1468443693, "answer_id": 38361635, "question_id": 38357456, "link": "https://stackoverflow.com/questions/38357456/insert-photo-with-wildcard-in-filename/38361635#38361635", "title": "insert photo with wildcard in filename", "body": "<p>Does this work?</p>\n\n<pre><code>Sub InsertPhotos_Click()\nDim PhotoString As String\n    Range(\"Photo1\").Select\n    PhotoString = Application.InputBox(\"Type text for picture\", \"Get Picture\", Type:=2)\n    If PhotoString &lt;&gt; \"\" Then ' 1. If PhotoString &lt;&gt; \"\"\n    ActiveSheet.Pictures.Insert(\"U:\\Trial\\1-\" &amp; PhotoString &amp; \".jpg\").Select\n    Selection.ShapeRange.Height = 151.2\n    Selection.ShapeRange.IncrementLeft 27\n    Selection.ShapeRange.IncrementTop 3\n    End If ' 1. If PhotoString &lt;&gt; \"\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6585142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7224af98b51bae0a00b64193f25cdbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Carrie", "link": "https://stackoverflow.com/users/6585142/carrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468443693, "creation_date": 1468428465, "last_edit_date": 1531164843, "question_id": 38357456, "link": "https://stackoverflow.com/questions/38357456/insert-photo-with-wildcard-in-filename", "title": "insert photo with wildcard in filename", "body": "<ol>\n<li><p>I have this code:</p>\n\n<pre><code>Sub InsertPhotos_Click()\n    Range(\"Photo1\").Select\n    ActiveSheet.Pictures.Insert(\"U:\\Trial\\1.jpg\").Select\n    Selection.ShapeRange.Height = 151.2\n    Selection.ShapeRange.IncrementLeft 27\n    Selection.ShapeRange.IncrementTop 3\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>I need to be able to name the filename 1-xxxx, but not sure how to use a wildcard.  When the filename is 1, the code does what I want it to.  Any help would be great, thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3801128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b07ca050e00478b00e2c49090518da4?s=128&d=identicon&r=PG&f=1", "display_name": "user3801128", "link": "https://stackoverflow.com/users/3801128/user3801128"}, "edited": false, "score": 0, "creation_date": 1468429487, "post_id": 38357616, "comment_id": 64127696, "body": "ahh thanks it work now indeed... What i need to use them if the file is close ?"}, {"owner": {"reputation": 35, "user_id": 3801128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b07ca050e00478b00e2c49090518da4?s=128&d=identicon&r=PG&f=1", "display_name": "user3801128", "link": "https://stackoverflow.com/users/3801128/user3801128"}, "edited": false, "score": 1, "creation_date": 1468429838, "post_id": 38357616, "comment_id": 64127936, "body": "humm after google found something but it&#39;s a complicated way (i mean i do not understand the code)... leave it please"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1468428967, "creation_date": 1468428967, "answer_id": 38357616, "question_id": 38357447, "link": "https://stackoverflow.com/questions/38357447/subscript-out-of-range-when-using-find-on-a-different-excel-file/38357616#38357616", "title": "Subscript out of range when using Find on a different excel file", "body": "<p>Find will not work on a closed workbook.  If the workbook is open then use just the workbook's name to reference it in the Workbooks collection.  You should test to see if a cell is found by the Find method before you attempt to reference it.</p>\n\n<pre><code>Sub Escala()\n    Dim Target As range\n    Set Target = Workbooks(\"File test.xlsm\").Worksheets(\"2016\").range(\"A:AJ\").Find(\"Julho\")\n\n    If Not Target Is Nothing Then\n        ActiveCell.Value = Target.Value\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3801128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b07ca050e00478b00e2c49090518da4?s=128&d=identicon&r=PG&f=1", "display_name": "user3801128", "link": "https://stackoverflow.com/users/3801128/user3801128"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 38357616, "answer_count": 1, "score": 0, "last_activity_date": 1468428988, "creation_date": 1468428412, "last_edit_date": 1531164843, "question_id": 38357447, "link": "https://stackoverflow.com/questions/38357447/subscript-out-of-range-when-using-find-on-a-different-excel-file", "title": "Subscript out of range when using Find on a different excel file", "body": "<p>When i try to run this small macro that i created it gives this error \"Run-time error '9': Subscript out of range\"</p>\n\n<pre><code>Sub Escala()\n\nActiveCell.Value = Workbooks(\"C:\\Users\\ASUS\\Documents\\File test.xlsm\").Worksheets(\"2016\").Range(\"A:AJ\").Find(\"Julho\")\n\nEnd Sub\n</code></pre>\n\n<p>Did try to check some other's with a similar error but can\u00b4t figured out why.. hope you guys can help.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "edited": false, "score": 0, "creation_date": 1468428674, "post_id": 38357442, "comment_id": 64127243, "body": "Thank you for your answer. I will accept once the time limit permits. I must have missed that line. Although, not sure why you are say to declare the variables as you stated."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "edited": false, "score": 1, "creation_date": 1468428943, "post_id": 38357442, "comment_id": 64127387, "body": "No additional answers before you upvote &amp; accept the answer. Just kidding:) I said so , because for this line <code>Dim ToWorkbook, FromWorkbook As Workbook</code> only <code>FromWorkbook</code> is declared as type <code>Workbook</code>. <code>ToWorkbook</code> remains as <code>Variant</code>. Proper way is : <code>Dim ToWorkbook As Workbook, FromWorkbook As Workbook</code>"}, {"owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "edited": false, "score": 0, "creation_date": 1468428999, "post_id": 38357442, "comment_id": 64127419, "body": "Roger! I understand!"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 2, "last_activity_date": 1468429058, "last_edit_date": 1468429058, "creation_date": 1468428395, "answer_id": 38357442, "question_id": 38357336, "link": "https://stackoverflow.com/questions/38357336/run-time-error-438-object-doesnt-support-this-property-or-method/38357442#38357442", "title": "Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method", "body": "<p>This is the error: <code>ToWorkbook.Range(\"Z1\")</code>. can't set range to a workbook. </p>\n\n<p>Fyi...\nAlso <code>Dim x , y as String</code> makes y as <code>string</code> and x as <code>variant</code>.</p>\n"}], "owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "accepted_answer_id": 38357442, "answer_count": 1, "score": 0, "last_activity_date": 1468429058, "creation_date": 1468428052, "last_edit_date": 1531164843, "question_id": 38357336, "link": "https://stackoverflow.com/questions/38357336/run-time-error-438-object-doesnt-support-this-property-or-method", "title": "Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method", "body": "<p>Receiving  Run-time error '438': Object doesn't support this property or method</p>\n\n<p>Could someone help me debug and find why I receive this error with the .Find method?</p>\n\n<pre><code>Sub TestCode()\n'===============================================================================================\n'Description: Loops through the selected site and adds in the vulnerability totals for each _\n    systems\n'Originally written by: Troy Pilewski\n'Date: 2016-06-30\n'===============================================================================================\n\n'Declares variables\nDim ToWorkbook, FromWorkbook As Workbook\nDim ToWorksheet, FromWorkSheet As Worksheet\nDim DataRange, WholeRange As Range\nDim FromWorkbookVarient As Variant\nDim TitleString, FilterName, CurrentSystemName As String\nDim LastRow As Long\n\n'-----------------------------------------------------------------------------------------------\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nSet ToWorkbook = ActiveWorkbook\nSet ToWorksheet = ToWorkbook.Worksheets(\"SITE\")\n\nLastRow = ToWorksheet.Range(\"Z:Z\").Find( _\n    What:=\"*\", _\n    After:=ToWorkbook.Range(\"Z1\"), _\n    LookAt:=xlByRows, _\n    SearchOrder:=xlByRows, _\n    SearchDirection:=xlPrevious _\n).Row\n\nMsgBox _\n    Title:=\"Ship Range\", _\n    Prompt:=\"Z1:Z\" &amp; LastRow\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "object", "ms-access"], "comments": [{"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 1, "creation_date": 1468427837, "post_id": 38357217, "comment_id": 64126763, "body": "Where is objSysInfo defined?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 1, "creation_date": 1468428019, "post_id": 38357217, "comment_id": 64126869, "body": "@Jeremy it&#39;s <i>not</i> defined, that&#39;s the problem"}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1468428036, "post_id": 38357217, "comment_id": 64126879, "body": "Ah, good catch. I&#39;m still a bit new to VBA, so how would I define this variable?"}, {"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1468428131, "post_id": 38357217, "comment_id": 64126933, "body": "@Mat&#39;sMug I know...I just wanted to be sure it wasn&#39;t defined at a module level that we couldn&#39;t see."}, {"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 1, "creation_date": 1468428145, "post_id": 38357217, "comment_id": 64126940, "body": "@whatwhatwhat Dim objSysInfo as Object"}], "answers": [{"comments": [{"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1468428641, "post_id": 38357465, "comment_id": 64127229, "body": "&quot;to the end of the function&#39;s signature.&quot; ...the what? Where is a function&#39;s signature located? First line?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1468428805, "post_id": 38357465, "comment_id": 64127304, "body": "@whatwhatwhat the &quot;signature&quot; of a member is its access modifier, member type, name, parameter list and return type."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1468429279, "post_id": 38357465, "comment_id": 64127581, "body": "I edited my question to include the suggestions you&#39;ve made. I&#39;m not sure if I implemented your last bullet point correctly."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1468429486, "post_id": 38357465, "comment_id": 64127694, "body": "Type mismatch on <code>If Namepart = </code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1468429560, "post_id": 38357465, "comment_id": 64127740, "body": "Well you changed it from a <code>String</code> to a <code>NamePart</code> enum type - you need to compare it to a <code>NamePart</code> value, not a <code>String</code> - that&#39;s the whole point, to use the enum to get rid of the magic strings."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1468429744, "post_id": 38357465, "comment_id": 64127870, "body": "I&#39;m sorry! :/ I&#39;m not experienced in VBA, so I&#39;m not sure what you mean. How do I compare <code>NamePart</code> values?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1468430827, "post_id": 38357465, "comment_id": 64128538, "body": "A little addendum to a great answer: To have <code>Option Explicit</code> automatically in all new modules, set the <a href=\"http://www.fmsinc.com/microsoftaccess/modules/options/index.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a> option in the VBA Editor."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1468430145, "last_edit_date": 1468430145, "creation_date": 1468428497, "answer_id": 38357465, "question_id": 38357217, "link": "https://stackoverflow.com/questions/38357217/variable-not-defined-in-vba-script/38357465#38357465", "title": "Variable not defined in VBA script", "body": "<p><code>Option Explicit</code> <strong>forces</strong> you to <em>declare all variables</em>.</p>\n\n<p>This means you <strong>must</strong> declare all variables you're using, otherwise your code won't compile - as you've noticed.</p>\n\n<p>You declared local variable <code>returnthis</code> as a <code>String</code>, using the <code>Dim</code> keyword:</p>\n\n<pre><code>Dim returnthis As String\n</code></pre>\n\n<p>That's how you declare a <em>local</em> (<em>procedure scope</em>) variable.</p>\n\n<p>You could declare variables at <em>module scope</em> using the <code>Private</code> keyword (<code>Dim</code> works as well, but better keep <code>Dim</code> for locals)</p>\n\n<pre><code>Option Explicit\nPrivate foo As Object\n</code></pre>\n\n<p>How you <em>scope</em> variables depends on where you're using them - if a variable is only ever used in one single procedure, then it's better to scope it to that procedure and declare it as a local variable.</p>\n\n<p>In this case you have <code>objSysInfo</code> and <code>objUser</code> that aren't declared anywhere.</p>\n\n<pre><code>Dim objSysInfo As Object\nDim objUser As Object\n</code></pre>\n\n<hr>\n\n<p>I know we're not on <a href=\"http://www.codereview.stackexchange.com\" rel=\"nofollow\">Code Review</a>, but while we're here there are other issues with your code:</p>\n\n<ul>\n<li>The return type of the function is implicitly <code>Variant</code>. Append <code>As String</code> to the end of the function's signature.</li>\n<li>The optional parameter <code>whatpart</code> is implicitly <code>Variant</code> as well, and implicitly passed <code>ByRef</code>, but you only need to <em>read</em> it, not <em>write and return to the caller</em> - so declare it <code>Optional ByVal whatpart As String = \"username\"</code>.</li>\n<li>Prefer the <code>Environ$</code> function over <code>Environ</code> - both do the same thing, but <code>Environ</code> returns a <code>Variant</code>, that you're implicitly converting to a <code>String</code> - best use <code>Environ$</code> and work with a string from the start.</li>\n<li><p>Instead of relying on magic, hard-coded strings, use an <code>Enum</code> value and <code>Select Case</code> over the possible legal values:</p>\n\n<pre><code>Public Enum NamePart\n    EnvironmentDefined\n    FullName\n    FirstName\n    LastName\nEnd Enum\n</code></pre></li>\n</ul>\n\n<p>The full code could look like this:</p>\n\n<pre><code>Public Enum NamePart\n    EnvironmentDefined\n    FullName\n    FirstName\n    LastName\nEnd Enum\n\nPublic Function GetUserName(Optional ByVal part As NamePart = EnvironmentDefined) As String\n\n    Dim result As String\n    Dim sysInfo As Object\n    Dim userInfo As Object\n\n    If Namepart = EnvironmentDefined Then \n        GetUser = Environ$(\"USERNAME\")\n        Exit Function\n    End If\n\n    Set sysInfo = CreateObject(\"ADSystemInfo\")\n    Set userInfo = GetObject(\"LDAP://\" &amp; sysInfo.UserName)\n    Select Case part\n        Case FullName\n            result = userInfo.FullName\n        Case FirstName\n            result = userInfo.GivenName\n        Case LastName\n            result = userInfo.LastName\n        Case Else\n            result = Environ$(\"USERNAME\")\n    End Select\n\n    GetUserName = result\n\nEnd Function\n</code></pre>\n\n<p>Note, I didn't include a <code>GivenName</code> enum member, since it's redundant; calling code can do this:</p>\n\n<pre><code>Dim value As String\nvalue = GetUserName(FirstName)\n</code></pre>\n"}], "owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3438, "favorite_count": 1, "accepted_answer_id": 38357465, "answer_count": 1, "score": 0, "last_activity_date": 1468431837, "creation_date": 1468427696, "last_edit_date": 1468431837, "question_id": 38357217, "link": "https://stackoverflow.com/questions/38357217/variable-not-defined-in-vba-script", "title": "Variable not defined in VBA script", "body": "<p>I'm getting into the good habit of using <code>Option Explicit</code> at the top of all my MS Access VBA scripts. However, for this function it's giving me a <code>Variable not defined</code> error highlighting the line that begins with <code>Set objSysInfo =</code></p>\n\n<pre><code>Public Function GetUser(Optional whatpart = \"username\")\n\n    Dim returnthis As String\n    If whatpart = \"username\" Then GetUser = Environ(\"USERNAME\"): Exit Function\n    Set objSysInfo = CreateObject(\"ADSystemInfo\")\n    Set objUser = GetObject(\"LDAP://\" &amp; objSysInfo.UserName)\n    Select Case whatpart\n        Case \"fullname\": returnthis = objUser.FullName\n        Case \"firstname\", \"givenname\": returnthis = objUser.givenName\n        Case \"lastname\": returnthis = objUser.LastName\n        Case Else: returnthis = Environ(\"USERNAME\")\n    End Select\n    GetUser = returnthis\n\nEnd Function\n</code></pre>\n\n<p>Might I be missing a specific reference?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1468429914, "post_id": 38357184, "comment_id": 64127991, "body": "Don&#39;t use <code>OnKey</code> to do this. You should be able to call the sub directly from the code."}, {"owner": {"reputation": 51, "user_id": 6519137, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/01e859e6401e85ea9cfd088f8cbba01b?s=128&d=identicon&r=PG&f=1", "display_name": "Help Man", "link": "https://stackoverflow.com/users/6519137/help-man"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1468432782, "post_id": 38357184, "comment_id": 64129734, "body": "I need to use it. could it be that alt x cannot be changed for the hot key?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1468435519, "post_id": 38357184, "comment_id": 64131372, "body": "Why do you need to use it? I have yet to see a situation where it is necessary to trigger a macro using a keyboard shortcut within a typed macro."}, {"owner": {"reputation": 116, "user_id": 1617907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7faa22bf34ee3ae592c10c08e3c47f9?s=128&d=identicon&r=PG", "display_name": "orev", "link": "https://stackoverflow.com/users/1617907/orev"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1521219378, "post_id": 38357184, "comment_id": 85653385, "body": "@Kyle: Just because you personally don&#39;t see a reason for something doesn&#39;t make it invalid.  The functionality exists for a reason -- because some people have a need for it."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 116, "user_id": 1617907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7faa22bf34ee3ae592c10c08e3c47f9?s=128&d=identicon&r=PG", "display_name": "orev", "link": "https://stackoverflow.com/users/1617907/orev"}, "edited": false, "score": 0, "creation_date": 1521226809, "post_id": 38357184, "comment_id": 85657429, "body": "@orev Yes, that is true, but my question is still valid. It is commonplace for folks on SO to try to tease out what the OP is trying to accomplish as opposed to what method they are using to accomplish it. Often there are better methods to solve problems that the method the OP is using. I&#39;m simply curious why the OP finds it necessary, so I know if I should spend my time trying to answer it, or offer a potentially better solution."}], "answers": [{"comments": [{"owner": {"reputation": 164, "user_id": 9536940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038b77276add349b407c8fc1e69073a4?s=128&d=identicon&r=PG&f=1", "display_name": "toucansame", "link": "https://stackoverflow.com/users/9536940/toucansame"}, "edited": false, "score": 0, "creation_date": 1527181693, "post_id": 41885579, "comment_id": 88041891, "body": "This is great, but it doesn&#39;t persist after closing excel.  Is there a way to &quot;run&quot; the macro every time I open Excel?"}], "tags": [], "owner": {"reputation": 21, "user_id": 7476613, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6d9131459429d45df7688c441875355a?s=128&d=identicon&r=PG", "display_name": "Zoraal", "link": "https://stackoverflow.com/users/7476613/zoraal"}, "is_accepted": false, "score": 2, "last_activity_date": 1485478549, "creation_date": 1485478549, "answer_id": 41885579, "question_id": 38357184, "link": "https://stackoverflow.com/questions/38357184/application-onkey-not-working-in-excel/41885579#41885579", "title": "Application.OnKey not working in excel?", "body": "<p>It's obviously a bit late, but since it took me a lot of googling to finally find the answer, it might help make it more likely for others to run into the answer in the future. </p>\n\n<p>I have no programming background, and all I wanted was to make <code>Ctrl+Shift+V</code> paste the formatting of a copied cell much like it does in Word. The following <em>should</em> have worked, but wouldn't:</p>\n\n<pre><code>Sub pfkey()\n    Application.OnKey \"^+v\", \"pformat\"\nEnd Sub\n\nSub pformat()\n' Pastes the formatting of a copied selection\n\n    Selection.PasteSpecial paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Despite being syntactically correct, this will only work if you first \"run\" the module. What I did was:</p>\n\n<ol>\n<li>Select the module containing the <code>pfkey()</code> subroutine</li>\n<li>Press <strong>F5</strong></li>\n<li>Select <strong>pfkey</strong> again in the dialogue box</li>\n<li>Click <strong>run</strong></li>\n</ol>\n\n<p>Bam -- working code.</p>\n\n<p><a href=\"https://www.mrexcel.com/forum/excel-questions/602726-application-onkey-not-working.html\" rel=\"nofollow noreferrer\">Where I found the answer:</a> <em>\"AFTER running the macro, the key combination would be assigned.\"</em></p>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 9536940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038b77276add349b407c8fc1e69073a4?s=128&d=identicon&r=PG&f=1", "display_name": "toucansame", "link": "https://stackoverflow.com/users/9536940/toucansame"}, "is_accepted": false, "score": 0, "last_activity_date": 1527182792, "creation_date": 1527182792, "answer_id": 50515002, "question_id": 38357184, "link": "https://stackoverflow.com/questions/38357184/application-onkey-not-working-in-excel/50515002#50515002", "title": "Application.OnKey not working in excel?", "body": "<p>Taking a cue from @Zoraal, I found that you can create an Auto_Open() sub that includes any/all of your application.onkey requirements.  This will \"activate\" them on starting excel so you don't need to manually run the module every time.</p>\n\n<p>I use the personal workbook method <a href=\"https://support.office.com/en-us/article/copy-your-macros-to-a-personal-macro-workbook-aa439b90-f836-4381-97f0-6e4c3f5ee566\" rel=\"nofollow noreferrer\">(discussed here)</a> to store all my macros.  I simply created a module called shortcuts and put in the following subroutine:</p>\n\n<pre><code>Sub Auto_Open()\n    Application.OnKey \"{yourshortcuthere}\", \"yoursub\"\n    Application.OnKey \"{yourothershortcuthere}\", \"yourothersub\"\nEnd Sub\n</code></pre>\n\n<p>The reference macros can be contained in multiple other modules.</p>\n"}], "owner": {"reputation": 51, "user_id": 6519137, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/01e859e6401e85ea9cfd088f8cbba01b?s=128&d=identicon&r=PG&f=1", "display_name": "Help Man", "link": "https://stackoverflow.com/users/6519137/help-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1789, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1527182792, "creation_date": 1468427579, "last_edit_date": 1468432604, "question_id": 38357184, "link": "https://stackoverflow.com/questions/38357184/application-onkey-not-working-in-excel", "title": "Application.OnKey not working in excel?", "body": "<p>I'm running a macro using <code>Application.OnKey \"%x\", \"myMacro\"</code>. But now it's not working, could there be any reasons this is not working? \nAlso if i wanted to change it and use <code>ALT + SHIFT + \"x\"</code> would it be <code>\"%+x\"</code> ? I've tried and it still haven't work. any ideas?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6462428, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e6e6aa41485b6d520dfbc54dd2df2336?s=128&d=identicon&r=PG&f=1", "display_name": "quenny", "link": "https://stackoverflow.com/users/6462428/quenny"}, "edited": false, "score": 0, "creation_date": 1468428397, "post_id": 38357211, "comment_id": 64127089, "body": "I don&#39;t want to copy over the first 3 rows. Only everything below row three. How can I account for that?"}, {"owner": {"reputation": 5, "user_id": 6462428, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e6e6aa41485b6d520dfbc54dd2df2336?s=128&d=identicon&r=PG&f=1", "display_name": "quenny", "link": "https://stackoverflow.com/users/6462428/quenny"}, "edited": false, "score": 0, "creation_date": 1468434321, "post_id": 38357211, "comment_id": 64130670, "body": "I am receiving an error: &quot;Object doesn&#39;t support this property or method&quot; and highlighted is the last row of code. &quot;Worksheets(&quot;sheet1&quot;).Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Offset(1)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 5, "user_id": 6462428, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e6e6aa41485b6d520dfbc54dd2df2336?s=128&d=identicon&r=PG&f=1", "display_name": "quenny", "link": "https://stackoverflow.com/users/6462428/quenny"}, "edited": false, "score": 0, "creation_date": 1468434452, "post_id": 38357211, "comment_id": 64130759, "body": "@quenny - see edit and try again, sorry for sloppiness :("}, {"owner": {"reputation": 5, "user_id": 6462428, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e6e6aa41485b6d520dfbc54dd2df2336?s=128&d=identicon&r=PG&f=1", "display_name": "quenny", "link": "https://stackoverflow.com/users/6462428/quenny"}, "edited": false, "score": 0, "creation_date": 1468435107, "post_id": 38357211, "comment_id": 64131124, "body": "In the second to last line of code, where does the closing parentheses go? I think &quot; .Range(.Range(&quot;A4&quot;),.Cells(lRow,lCol).Copy _&quot; Is missing one"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 5, "user_id": 6462428, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e6e6aa41485b6d520dfbc54dd2df2336?s=128&d=identicon&r=PG&f=1", "display_name": "quenny", "link": "https://stackoverflow.com/users/6462428/quenny"}, "edited": false, "score": 0, "creation_date": 1468435657, "post_id": 38357211, "comment_id": 64131453, "body": "@quenny - ugh! before the <code>.Copy</code>. I fixed."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1468435642, "last_edit_date": 1468435642, "creation_date": 1468427686, "answer_id": 38357211, "question_id": 38357070, "link": "https://stackoverflow.com/questions/38357070/vba-copy-below-row-3-and-paste-at-the-bottom-of-another-sheet/38357211#38357211", "title": "VBA: Copy below row 3 and paste at the bottom of another sheet", "body": "<pre><code>Dim ws as Worksheet\nSet ws = Worksheets(\"mySheet\") 'change name as needed\n\nWith ws\n   'assumes data is in a \"table\" format with all data rows in column A and data columns in row 1\n   Dim lRow as Long, lCol as Long\n   lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row \n   lCol = .Cells(1,.Columns.Count).End(xlToLeft).Column\n\n   .Range(.Range(\"A4\"),.Cells(lRow,lCol)).Copy _\n    Worksheets(\"Sheet1\").Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1)\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6462428, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e6e6aa41485b6d520dfbc54dd2df2336?s=128&d=identicon&r=PG&f=1", "display_name": "quenny", "link": "https://stackoverflow.com/users/6462428/quenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468435642, "creation_date": 1468427184, "last_edit_date": 1531161705, "question_id": 38357070, "link": "https://stackoverflow.com/questions/38357070/vba-copy-below-row-3-and-paste-at-the-bottom-of-another-sheet", "title": "VBA: Copy below row 3 and paste at the bottom of another sheet", "body": "<p>I want to copy all rows below Row 3 in sheet2 and paste them below the last row in sheet 1. I don't want to use 'Activesheet\" like I have below. Is there another way to accomplish this? </p>\n\n<p>(This doesn't work): </p>\n\n<pre><code>Rows(\"3:3\").Select\nRange(Selection, Selection.End(x1Down)).Select\nSelection.Copy\n\nSheets(\"sheet1\").Select\nRange(Selection, Selection.End(x1Down)).Select\nActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1468427081, "post_id": 38357013, "comment_id": 64126336, "body": "Fourteen columns?  How many values in each column?  I suspect that would be a huge number of combinations...  Edit: with only 3 values in each column you&#39;d have about 4.7 million combinations"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1468427218, "post_id": 38357013, "comment_id": 64126412, "body": "I imagine the result of offsetting by <code>UBound(c1) * UBound(c2) * UBound(c3) * UBound(c4) * UBound(c5) * UBound(c6) * UBound(c7) * UBound(c8) * UBound(c9) * UBound(c10) * UBound(c11) * UBound(c12) * UBound(c13) * UBound(c14)</code> number of rows is going to be beyond the number of rows on the sheet!"}, {"owner": {"reputation": 3, "user_id": 6581102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tx4Cp.jpg?s=128&g=1", "display_name": "T. Classens", "link": "https://stackoverflow.com/users/6581102/t-classens"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468428149, "post_id": 38357013, "comment_id": 64126944, "body": "@TimWilliams, seven of the columns only have one value, while the largest has 8 values. Do you think the size is why I&#39;m getting an error? Because I can try and combine attributes if 10 columns would be a more reasonable number. My end goal is to create a dashboard of sorts from survey data of items I have, so I need these combinations to populate it. Each of the columns has different independent attributes and scores, and I&#39;d like to create a dashboard where I can use slicers to select various desirable attributes, and it will populate with the item that fits those attributes."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468428294, "post_id": 38357013, "comment_id": 64127030, "body": "Multiply all of the numbers of items together from all 14 columns - what is the result ?"}, {"owner": {"reputation": 3, "user_id": 6581102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tx4Cp.jpg?s=128&g=1", "display_name": "T. Classens", "link": "https://stackoverflow.com/users/6581102/t-classens"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468428908, "post_id": 38357013, "comment_id": 64127369, "body": "@TimWilliams it&#39;s 235,200"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6581102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tx4Cp.jpg?s=128&g=1", "display_name": "T. Classens", "link": "https://stackoverflow.com/users/6581102/t-classens"}, "edited": false, "score": 0, "creation_date": 1468441183, "post_id": 38357523, "comment_id": 64134352, "body": "Thanks very much for your response. I changed the portion you mentioned; here&#39;s the first line I changed: &quot;Set col1 = Range(&quot;A66&quot;, Cells(Rows.Count, 1).End(xlUp))&quot;  However, then I got a Run-time error &#39;13&#39;: Type mismatch for the line: &quot;c1 = col1&quot;. I looked into it and saw another user had the same issue: <a href=\"http://stackoverflow.com/questions/28677005/excel-combination-generator\" title=\"excel combination generator\">stackoverflow.com/questions/28677005/&hellip;</a> I tried the answer given to add on the  &quot;If Not IsArray(c1) Then...&quot; code, but I&#39;m still getting the same &#39;Type mismatch&#39; error message. Do you have any ideas on that? BTW, I also changed the As Long back to the original."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 3, "user_id": 6581102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tx4Cp.jpg?s=128&g=1", "display_name": "T. Classens", "link": "https://stackoverflow.com/users/6581102/t-classens"}, "edited": false, "score": 0, "creation_date": 1468492299, "post_id": 38357523, "comment_id": 64154195, "body": "@T.Classens Check if the range has only one cell before <code>c1=col1</code>. If so, create the array yourself like in the question you linked. If it doesn&#39;t work post it as a new question because it has nothing to do with the original question any more."}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 2, "last_activity_date": 1468429110, "last_edit_date": 1468429110, "creation_date": 1468428700, "answer_id": 38357523, "question_id": 38357013, "link": "https://stackoverflow.com/questions/38357013/combining-all-combinations-of-data-from-fourteen-columns-in-excel-using-vba/38357523#38357523", "title": "Combining all combinations of data from fourteen columns in Excel using VBA", "body": "<p>Overflow means the number is too high to be stored as the data type that you want it to be. The <code>Offset</code> argument is a <code>Long</code> so the maximum input value would be 2147483648 for it to not cause an overflow. Since you said your maximum column size is 8 and there are only 8 non-trivial columns, there has to be something else going on.</p>\n\n<p>Ironically, the problem is caused by the columns with only one entry :)</p>\n\n<p>You are setting the columns like this:</p>\n\n<pre><code>Set col1 = Range(\"A66\", Range(\"A66\").End(xlDown))\n</code></pre>\n\n<p>I am not going to go into this but if \"A66\" is the last cell with an entry in that column, <code>.End(xlDown)</code> will go all the way down to the bottom of the sheet. That's where your high numbers come from.</p>\n\n<p>Use <code>Cells(rows.count,1).End(xlUp)</code> to find the last non-empty cell in column A:</p>\n\n<pre><code>Set col1 = Range(\"A66\", Cells(rows.count,1).End(xlUp))\n</code></pre>\n\n<p>Of course this fixes only the <code>Overflow</code> problem (hopefully), you still might end up with something larger than your row count that takes a long time.</p>\n\n<p>edit: btw, <code>Dim i, j, k As Long</code> only sets the last variable as <code>Long</code>, the others are set as <code>Variant</code>. It's the same as </p>\n\n<pre><code>Dim i\nDim j\nDim k as Long\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1468429729, "creation_date": 1468429729, "answer_id": 38357828, "question_id": 38357013, "link": "https://stackoverflow.com/questions/38357013/combining-all-combinations-of-data-from-fourteen-columns-in-excel-using-vba/38357828#38357828", "title": "Combining all combinations of data from fourteen columns in Excel using VBA", "body": "<p>You can do this pretty much variable with:</p>\n\n<pre><code>Option Explicit\nSub test()\n  Dim inputRng As Range\n  Set inputRng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A2:E5\") 'change this to fit your needs\n  Dim inputVal() As Variant\n  ReDim inputVal(1 To inputRng.Columns.Count)\n  Dim holder() As Variant\n  Dim i, j, k, xCol, xRow\n  j = 1: k = 1\n  'load in values\n  For Each xCol In inputRng.Columns\n    If Len(xCol.Cells(2, 1)) Then\n      xRow = xCol.Cells(1, 1).End(xlDown).Row\n    Else\n      xRow = xCol.Cells(1, 1).Row\n    End If\n    If xRow &gt; (xCol.Rows.Count + xCol.Row - 1) Then xRow = (xCol.Rows.Count + xCol.Row - 1)\n    ReDim holder(0 To xRow - xCol.Cells(1, 1).Row + 1)\n    holder(0) = UBound(holder)\n    j = j * holder(0)\n    For i = 1 To holder(0)\n      holder(i) = xCol.Cells(i).Value\n    Next\n    inputVal(k) = holder\n    k = k + 1\n  Next\n  Dim outputVal() As Variant\n  ReDim outputVal(1 To j, 1 To inputRng.Columns.Count)\n  k = 1\n  For i = UBound(outputVal, 2) To 1 Step -1\n    For j = 0 To UBound(outputVal) - 1\n      outputVal(j + 1, i) = inputVal(i)((Int(j / k) Mod inputVal(i)(0)) + 1)\n    Next\n    k = k * inputVal(i)(0)\n  Next\n  Dim outputRng As Range\n  Set outputRng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"G1\")  'set here the first cell to start output\n  outputRng.Resize(UBound(outputVal), UBound(outputVal, 2)).Value = outputVal\nEnd Sub\n</code></pre>\n\n<p>Just set the range for the input-values and the upper left cell for your output.</p>\n\n<p>But keep in mind: if you get overflow for <code>j</code>: there are so many combinations, it simply is to much to handle. (And also would never fit in 1 sheet)<br>\nIn that case, split up the whole process to 2 sections and then tell everyone to add the second part to every item in the first part... ... probably noone will do that :P</p>\n\n<p>If you have any questions, just ask :)</p>\n"}], "owner": {"reputation": 3, "user_id": 6581102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tx4Cp.jpg?s=128&g=1", "display_name": "T. Classens", "link": "https://stackoverflow.com/users/6581102/t-classens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 38357523, "answer_count": 2, "score": 0, "last_activity_date": 1570827254, "creation_date": 1468426963, "last_edit_date": 1495541683, "question_id": 38357013, "link": "https://stackoverflow.com/questions/38357013/combining-all-combinations-of-data-from-fourteen-columns-in-excel-using-vba", "title": "Combining all combinations of data from fourteen columns in Excel using VBA", "body": "<p>There were a couple conversations on here regarding VBA code to find all possible combinations among multiple columns with varying lengths of data in Excel. The conversations included 3, 4, and 5 columns, but I need to do this with 14 columns. The 5 column code given in this conversation is what I used:\n<a href=\"https://stackoverflow.com/questions/19780016/vba-write-all-possible-combinations-of-4-columns-of-data\">VBA - Write all possible combinations of 4 columns of data</a>\nBut I'm getting the following error: \"Run-time error '6': Overflow\" and it highlights this line when I go to debug: </p>\n\n<pre><code>Set out1 = Range(\"G2\", Range(\"K2\").Offset(UBound(c1) * UBound(c2) * UBound(c3) * UBound(c4) * UBound(c5) * UBound(c6) * UBound(c7) * UBound(c8) * UBound(c9) * UBound(c10) * UBound(c11) * UBound(c12) * UBound(c13) * UBound(c14)))\n</code></pre>\n\n<p>Here is the full code I tweaked from the example I found for 5 columns:</p>\n\n<pre><code>Sub combinations()\n\nDim c1() As Variant\nDim c2() As Variant\nDim c3() As Variant\nDim c4() As Variant\nDim c5() As Variant\nDim c6() As Variant\nDim c7() As Variant\nDim c8() As Variant\nDim c9() As Variant\nDim c10() As Variant\nDim c11() As Variant\nDim c12() As Variant\nDim c13() As Variant\nDim c14() As Variant\nDim out() As Variant\nDim j, k, l, m, n, o, p, q, r, s, t, u, v, w, x As Long\n\n\nDim col1 As Range\nDim col2 As Range\nDim col3 As Range\nDim col4 As Range\nDim col5 As Range\nDim col6 As Range\nDim col7 As Range\nDim col8 As Range\nDim col9 As Range\nDim col10 As Range\nDim col11 As Range\nDim col12 As Range\nDim col13 As Range\nDim col14 As Range\nDim out1 As Range\n\n\nSet col1 = Range(\"A66\", Range(\"A66\").End(xlDown))\nSet col2 = Range(\"B66\", Range(\"B66\").End(xlDown))\nSet col3 = Range(\"C66\", Range(\"C66\").End(xlDown))\nSet col4 = Range(\"D66\", Range(\"D66\").End(xlDown))\nSet col5 = Range(\"E66\", Range(\"E66\").End(xlDown))\nSet col6 = Range(\"F66\", Range(\"F66\").End(xlDown))\nSet col7 = Range(\"G66\", Range(\"G66\").End(xlDown))\nSet col8 = Range(\"H66\", Range(\"H66\").End(xlDown))\nSet col9 = Range(\"I66\", Range(\"I66\").End(xlDown))\nSet col10 = Range(\"J66\", Range(\"J66\").End(xlDown))\nSet col11 = Range(\"K66\", Range(\"K66\").End(xlDown))\nSet col12 = Range(\"L66\", Range(\"L66\").End(xlDown))\nSet col13 = Range(\"M66\", Range(\"M66\").End(xlDown))\nSet col14 = Range(\"N66\", Range(\"N66\").End(xlDown))\n\nc1 = col1\nc2 = col2\nc3 = col3\nc4 = col4\nc5 = col5\nc6 = col6\nc7 = col7\nc8 = col8\nc9 = col9\nc10 = col10\nc11 = col11\nc12 = col12\nc13 = col13\nc14 = col14\n\nSet out1 = Range(\"P66\", Range(\"AC66\").Offset(UBound(c1) * UBound(c2) * UBound(c3) * UBound(c4) * UBound(c5) * UBound(c6) * UBound(c7) * UBound(c8) * UBound(c9) * UBound(c10) * UBound(c11) * UBound(c12) * UBound(c13) * UBound(c14)))\nout = out1\n\nj = 1\nk = 1\nl = 1\nm = 1\nn = 1\no = 1\np = 1\nq = 1\nr = 1\ns = 1\nt = 1\nu = 1\nv = 1\nw = 1\nx = 1\n\nDo While j &lt;= UBound(c1)\n    Do While k &lt;= UBound(c2)\n        Do While l &lt;= UBound(c3)\n            Do While m &lt;= UBound(c4)\n                Do While n &lt;= UBound(c5)\n                    Do While o &lt;= UBound(c6)\n                        Do While p &lt;= UBound(c7)\n                            Do While q &lt;= UBound(c8)\n                                Do While r &lt;= UBound(c9)\n                                    Do While s &lt;= UBound(c10)\n                                        Do While t &lt;= UBound(c11)\n                                            Do While u &lt;= UBound(c12)\n                                                Do While v &lt;= UBound(c13)\n                                                    Do While w &lt;= UBound(c14)\n                                                        out(o, 1) = c1(j, 1)\n                                                        out(o, 2) = c2(k, 1)\n                                                        out(o, 3) = c3(l, 1)\n                                                        out(o, 4) = c4(m, 1)\n                                                        out(o, 5) = c5(n, 1)\n                                                        out(o, 6) = c6(o, 1)\n                                                        out(o, 7) = c7(p, 1)\n                                                        out(o, 8) = c8(q, 1)\n                                                        out(o, 9) = c9(r, 1)\n                                                        out(o, 10) = c10(s, 1)\n                                                        out(o, 11) = c11(t, 1)\n                                                        out(o, 12) = c12(u, 1)\n                                                        out(o, 13) = c13(v, 1)\n                                                        out(o, 14) = c14(w, 1)\n                                                        x = x + 1\n                                                        w = w + 1\n                                                    Loop\n                                                    w = 1\n                                                    v = v + 1\n                                                Loop\n                                                v = 1\n                                                u = u + 1\n                                            Loop\n                                            u = 1\n                                            t = t + 1\n                                        Loop\n                                        t = 1\n                                        s = s + 1\n                                    Loop\n                                    s = 1\n                                    r = r + 1\n                                Loop\n                                r = 1\n                                q = q + 1\n                            Loop\n                            q = 1\n                            p = p + 1\n                        Loop\n                        p = 1\n                        o = o + 1\n                    Loop\n                    o = 1\n                    n = n + 1\n                Loop\n                n = 1\n                m = m + 1\n            Loop\n            m = 1\n            l = l + 1\n        Loop\n        l = 1\n        k = k + 1\n    Loop\n    k = 1\n    j = j + 1\nLoop\n\n\nout1.Value = out\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Also, as a note, I tried tweaking the code so that my input started at the top of the spreadsheet (A1 vice the A66 I currently have), and that didn't help. Additionally, I know in the original code I used as reference it lists \"Dim j As Long, k As Long, l As Long, etc.) and I shortened it, but I had originally used the long-form and still got the error. Any assistance would be greatly appreciated. I am a total amateur with VBA, so my apologies if the error is obvious. I have tried to research the error code, but I cannot find why mine specifically is messing up. Thanks very much for your time.</p>\n\n<p>Very Respectfully,\nT.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468427284, "post_id": 38356949, "comment_id": 64126454, "body": "If you want to return them into the same cell look at this: <a href=\"http://stackoverflow.com/questions/37923950/look-values-in-column-1-and-bring-column-2-values\" title=\"look values in column 1 and bring column 2 values\">stackoverflow.com/questions/37923950/&hellip;</a> I have a quick dirty function that will help.  The problem is that you can&#39;t change the value of other cells with a function.  You can return and array and highlight the desired output cells and hit Ctrl-Shift-Enter to enter the formula as an array into all those cells at once."}, {"owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468427449, "post_id": 38356949, "comment_id": 64126543, "body": "Hi Scott, it doesnt need to be in the same cell, having a horizontal array would also be useful. Just can&#39;t seem to get this function to work."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468427552, "post_id": 38356949, "comment_id": 64126605, "body": "Please post the data that you are using, It works just fine for me. see here: <a href=\"http://imgur.com/a/xUDBB\" rel=\"nofollow noreferrer\">imgur.com/a/xUDBB</a>"}, {"owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468427975, "post_id": 38356949, "comment_id": 64126837, "body": "It just worked when I tried sample data , so could it be my workbook format?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468428319, "post_id": 38356949, "comment_id": 64127048, "body": "without seeing the data I could not tell."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468428428, "post_id": 38356949, "comment_id": 64127106, "body": "But there is nothing wrong with the code and it does what it should.  So the fault is in the data or the execution."}], "owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1416, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468427953, "creation_date": 1468426774, "question_id": 38356949, "link": "https://stackoverflow.com/questions/38356949/vba-udf-vlookup-to-return-multiple-values", "title": "VBA/UDF, Vlookup to return multiple values]", "body": "<p>I am trying to lookup a value and return multiple values (whether it be in the same cell or spread out horizontally pasted in different columns)I have tried the following UDF and continue to get #VALUE as result.</p>\n\n<pre><code>Option Explicit\nFunction LookupCSVResults(lookupValue As Variant, lookupRange As Range, resultsRange As Range) As String\n\n    Dim s As String 'Results placeholder\n    Dim sTmp As String  'Cell value placeholder\n    Dim r As Long   'Row\n    Dim c As Long   'Column\n    Const strDelimiter = \"|||\"  'Makes InStr more robust\n\n    s = strDelimiter\n    For r = 1 To lookupRange.Rows.Count\n        For c = 1 To lookupRange.Columns.Count\n            If lookupRange.Cells(r, c).Value = lookupValue Then\n                'I know it's weird to use offset but it works even if the two ranges\n                'are of different sizes and it's the same way that SUMIF works\n                sTmp = resultsRange.Offset(r - 1, c - 1).Cells(1, 1).Value\n                If InStr(1, s, strDelimiter &amp; sTmp &amp; strDelimiter) = 0 Then\n                    s = s &amp; sTmp &amp; strDelimiter\n                End If\n            End If\n        Next\n    Next\n\n    'Now make it look like CSV\n    s = Replace(s, strDelimiter, \",\")\n    If Left(s, 1) = \",\" Then s = Mid(s, 2)\n    If Right(s, 1) = \",\" Then s = Left(s, Len(s) - 1)\n\n    LookupCSVResults = s 'Return the function\n\nEnd Function\n</code></pre>\n\n<p><strong>Formula in cell =LookupCSVResults(Lookup Value, Col of Lookup Value, Col of Return Value)</strong></p>\n\n<p>Can anyone help trouble shoot this or have another UDF that will provide similar result? Thanks.</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6585137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f000b3942e35868c795e889cb84e79c?s=128&d=identicon&r=PG&f=1", "display_name": "koch11", "link": "https://stackoverflow.com/users/6585137/koch11"}, "edited": false, "score": 0, "creation_date": 1468429308, "post_id": 38357009, "comment_id": 64127602, "body": "Thanks for the input, it looks like the only thing left is to figure out how to copy a range of cells and inserting instead of just one."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 6585137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f000b3942e35868c795e889cb84e79c?s=128&d=identicon&r=PG&f=1", "display_name": "koch11", "link": "https://stackoverflow.com/users/6585137/koch11"}, "edited": false, "score": 0, "creation_date": 1468432181, "post_id": 38357009, "comment_id": 64129329, "body": "@koch11 - this copies the whole row, do you only want certain columns in the row? If so, which ones?"}, {"owner": {"reputation": 1, "user_id": 6585137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f000b3942e35868c795e889cb84e79c?s=128&d=identicon&r=PG&f=1", "display_name": "koch11", "link": "https://stackoverflow.com/users/6585137/koch11"}, "edited": false, "score": 0, "creation_date": 1468432877, "post_id": 38357009, "comment_id": 64129793, "body": "Each date on the spreadsheet has 294 rows of data. What I am trying to do is copy all 294 with Friday&#39;s date, and inserting them in for Saturday and Sunday. So the final result will be 294 rows for Saturday and 294 rows for Sunday that match the data for Friday. Currently the macro copies 1 of 294 rows for Friday, and inserts one row with Saturday and Sundays dates."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 6585137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f000b3942e35868c795e889cb84e79c?s=128&d=identicon&r=PG&f=1", "display_name": "koch11", "link": "https://stackoverflow.com/users/6585137/koch11"}, "edited": false, "score": 0, "creation_date": 1468433067, "post_id": 38357009, "comment_id": 64129924, "body": "When I tested this macro I listed a bunch of weekday dates. When I ran it inserted Saturday and Sunday lines for each Friday line and filled the proper date. Are you saying all 294 rows are only Friday dates?"}, {"owner": {"reputation": 1, "user_id": 6585137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f000b3942e35868c795e889cb84e79c?s=128&d=identicon&r=PG&f=1", "display_name": "koch11", "link": "https://stackoverflow.com/users/6585137/koch11"}, "edited": false, "score": 0, "creation_date": 1468433439, "post_id": 38357009, "comment_id": 64130146, "body": "Yes sorry, there are 294 rows associated with each date. Each line is a different item occurring on that date. Over the weekend I want to copy all 294 lines for both Saturday and Sunday. Thanks again for looking at this with me."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 6585137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f000b3942e35868c795e889cb84e79c?s=128&d=identicon&r=PG&f=1", "display_name": "koch11", "link": "https://stackoverflow.com/users/6585137/koch11"}, "edited": false, "score": 0, "creation_date": 1468434076, "post_id": 38357009, "comment_id": 64130521, "body": "@koch11 - is the date on each of the 294 associated rows? say in column A or something? its like date | item1 | item 2 in columns A,B,C?"}, {"owner": {"reputation": 1, "user_id": 6585137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f000b3942e35868c795e889cb84e79c?s=128&d=identicon&r=PG&f=1", "display_name": "koch11", "link": "https://stackoverflow.com/users/6585137/koch11"}, "edited": false, "score": 0, "creation_date": 1468438139, "post_id": 38357009, "comment_id": 64132747, "body": "Yes the date is included in each row. So row 1 has the date in column C, transaction data in column&#39;s D-S, and than row 2 has the same date in column C, 2nd transaction data in column&#39;s D-S and so forth."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1468440003, "last_edit_date": 1468440003, "creation_date": 1468426954, "answer_id": 38357009, "question_id": 38356865, "link": "https://stackoverflow.com/questions/38356865/how-to-build-a-macro-that-can-copy-a-range-of-cells-and-insert-rows-with-new-dat/38357009#38357009", "title": "How to build a macro that can copy a range of cells and insert rows with new date?", "body": "<p>Add this line:</p>\n\n<pre><code>wks.Rows(I - 1).Copy\n</code></pre>\n\n<p>Before this one:</p>\n\n<pre><code>wks.Rows(I).Insert xlShiftDown\n</code></pre>\n\n<p><strong>Update (based on comments)</strong></p>\n\n<pre><code>Sub AddDataWeekends()\n\n    Dim lRow As Long\n    lRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Dim x As Long\n\n    For x = lRow To 2 Step -294\n\n        If Weekday(Cells(x, 1), vbSunday) = 6 Then\n            Cells(x, 1).EntireRow.Copy\n            Cells(x, 1).Resize(294 * 2).Insert xlShiftDown\n            Cells(x + 1, 1).Resize(294).Value = Cells(x, 1) + 1\n            Cells(x + 1, 1).Offset(294).Resize(294).Value = Cells(x, 1) + 2\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6585137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f000b3942e35868c795e889cb84e79c?s=128&d=identicon&r=PG&f=1", "display_name": "koch11", "link": "https://stackoverflow.com/users/6585137/koch11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468440003, "creation_date": 1468426515, "question_id": 38356865, "link": "https://stackoverflow.com/questions/38356865/how-to-build-a-macro-that-can-copy-a-range-of-cells-and-insert-rows-with-new-dat", "title": "How to build a macro that can copy a range of cells and insert rows with new date?", "body": "<p>I have a spreadsheet each month that has 294 rows for each day of the month, excluding weekend dates. What I want to do is to be able to copy the range of rows for each Friday, and copy and paste the data for the missing Saturday and Sunday of each week. I have found a macro that finds missing dates and inserts a row for those dates, but do not know how to copy a range of cells while changing the date. </p>\n\n<p>This is the macro I found in another topic that adds in rows for missing dates.</p>\n\n<pre><code>Sub insertMissingDate()\nDim wks As Worksheet\nSet wks = Worksheets(\"Sheet1\")\n\nDim lastRow As Long\nlastRow = wks.Range(\"C2\").End(xlDown).Row\n\n'Work bottom up since we are inserting new rows\nFor I = lastRow To 3 Step -1\n    curcell = wks.Cells(I, 3).Value\n    prevcell = wks.Cells(I - 1, 3).Value\n\n    'Using a loop here allows us to bridge a gap of multiple missing dates\n    Do Until curcell - 1 = prevcell Or curcell = prevcell\n        'Insert new row\n        wks.Rows(I).Insert x1ShiftDown\n\n        'Insert missing date into new row\n        curcell = wks.Cells(I + 1, 3) - 1\n        wks.Cells(I, 3).Value = curcell\n    Loop\nNext I\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "string", "ms-access", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1468426285, "post_id": 38356770, "comment_id": 64125824, "body": "Please post the relevant code in your original post using the edit."}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 1, "creation_date": 1468426297, "post_id": 38356770, "comment_id": 64125830, "body": "Are you sure it&#39;s the <code>MID()</code> function call that is causing the issue? You are going to have to post more code to give an indication of what is causing the issue."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1468427188, "post_id": 38356770, "comment_id": 64126392, "body": "You need to <a href=\"http://www.aivosto.com/vbtips/stringopt2.html\" rel=\"nofollow noreferrer\">read this</a>"}, {"owner": {"reputation": 143, "user_id": 3912255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7755ce3434e12c664f2155504bb8b7ff?s=128&d=identicon&r=PG&f=1", "display_name": "casper", "link": "https://stackoverflow.com/users/3912255/casper"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1468427320, "post_id": 38356770, "comment_id": 64126465, "body": "Thank you for the source @Mat&#39;sMug"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1468427857, "post_id": 38356770, "comment_id": 64126772, "body": "<code>For i = 2 To Rows.count</code> you&#39;re looping over every row on the sheet (&gt;1M)  Try <code>For i = 2 To rng.Rows.count</code>  And <code>Mid()</code> is the least of your issues here."}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1468426611, "creation_date": 1468426611, "answer_id": 38356897, "question_id": 38356770, "link": "https://stackoverflow.com/questions/38356770/is-there-a-better-implementation-for-the-string-function-mid-or-is-there-a-bette/38356897#38356897", "title": "Is there a better implementation for the string function MID or is there a better style of implementation for VBA that is quicker", "body": "<p>No, there isn't a <em>better</em> implementation however you should be aware that <code>Mid()</code> returns a <code>Variant</code> and your code then uses <strong>implicit</strong> conversion to return the <code>String</code> version.</p>\n\n<p>If you use the string version of this function: <code>Mid$()</code> <em>(notice the dollar sign)</em> then the return type is <strong>explicit</strong> and always returned as a string. This <em>can be</em> marginally faster in high repeptitions of code.</p>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1468488409, "post_id": 38359732, "comment_id": 64151702, "body": "Might be worth noting the issue with <code>UsedRange</code> and worksheet bloat - complete personal preference but I tend to use <code>.End(xlUp)</code> or <code>.Find(&quot;*&quot;)</code> methods to get the row count when looping. Could add those to your answer?"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1468436560, "last_edit_date": 1525816150, "creation_date": 1468436560, "answer_id": 38359732, "question_id": 38356770, "link": "https://stackoverflow.com/questions/38356770/is-there-a-better-implementation-for-the-string-function-mid-or-is-there-a-bette/38359732#38359732", "title": "Is there a better implementation for the string function MID or is there a better style of implementation for VBA that is quicker", "body": "<p>In the Immediate Window (Ctrl+G), type:</p>\n\n<pre><code>? Rows.Count\n1048576 \n</code></pre>\n\n<p>That's the number of rows you are looping.</p>\n\n<p>Wherever you used <code>Rows.Count</code>, use this instead: </p>\n\n<pre><code>ActiveSheet.UsedRange.Rows.Count\n</code></pre>\n\n<p>or assign that to a Long variable <code>numRows</code> and use that.</p>\n\n<p><a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">Debugging VBA Code</a> would have helped finding the issue, with a breakpoint in the loop.</p>\n"}], "owner": {"reputation": 143, "user_id": 3912255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7755ce3434e12c664f2155504bb8b7ff?s=128&d=identicon&r=PG&f=1", "display_name": "casper", "link": "https://stackoverflow.com/users/3912255/casper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 38359732, "answer_count": 2, "score": 0, "last_activity_date": 1594641765, "creation_date": 1468426211, "last_edit_date": 1594641765, "question_id": 38356770, "link": "https://stackoverflow.com/questions/38356770/is-there-a-better-implementation-for-the-string-function-mid-or-is-there-a-bette", "title": "Is there a better implementation for the string function MID or is there a better style of implementation for VBA that is quicker", "body": "<p>I have script that calls 'MID' (16N) times and it takes around 4 minutes to execute when N = 43. I am not sure why it is taking so long it is a calling a String of ~440 characters each time:</p>\n\n<pre><code>Sub Button1_Click()\nIf Sheets.count = 1 Then\na = ActiveWorkbook.Name    \nChDir \"C:\\\"\nMsgBox \"Be Prepared to a text file\", vbExclamation, _\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nFileToOpen = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\")\nWorkbooks.OpenText FileToOpen, Origin:=xlWindows, _\n    StartRow:=1, DataType:=xlDelimited, Tab:=True\nx = ActiveWorkbook.Name     'SO # workbook\nWorkbooks(x).Sheets(1).Copy after:=Workbooks(a).Sheets(1)\nActiveSheet.Name = \"Results\"\nWindows(x).Activate         'SO # workbook\nActiveWorkbook.Close\n'I also need to declare the value of each column with each 'with' statement\nRange(\"A1\").Select\nWith Rows(\"1:1\")\n.Insert Shift:=xlDown\nEnd With\nWith Range(\"A1\")    \n.Font.Bold = True\nEnd With\n'Columns(\"A:A\").EntireColumn.AutoFit\nWith Range(\"B1\")   \n.Font.Bold = True\nEnd With\nColumns(\"B:B\").EntireColumn.AutoFit\nWith Range(\"C1\")    \n.Font.Bold = True\nEnd With\nColumns(\"C:C\").EntireColumn.AutoFit\nWith Range(\"D1\")   \n.Font.Bold = True\nEnd With\nColumns(\"D:D\").EntireColumn.AutoFit\nWith Range(\"E1\")   \n.Font.Bold = True\nEnd With\nColumns(\"E:E\").EntireColumn.AutoFit\nWith Range(\"F1\")    \n.Font.Bold = True\nEnd With\nColumns(\"F:F\").EntireColumn.AutoFit\nWith Range(\"G1\")    \n.Font.Bold = True\nEnd With\nColumns(\"G:G\").EntireColumn.AutoFit    \nWith Range(\"H1\")    \n.Font.Bold = True\nEnd With    \nColumns(\"H:H\").EntireColumn.AutoFit    \nWith Range(\"I1\")    \n.Font.Bold = True\nEnd With\nColumns(\"I:I\").HorizontalAlignment = xlLeft\nColumns(\"I:I\").EntireColumn.AutoFit\nWith Range(\"J1\")    \n.Font.Bold = True\nEnd With\nColumns(\"J:J\").EntireColumn.AutoFit\nWith Range(\"K1\")    \n.Font.Bold = True\nEnd With\nColumns(\"K:K\").EntireColumn.AutoFit\nWith Range(\"L1\")    \n.Font.Bold = True\nEnd With\nColumns(\"L:L\").EntireColumn.AutoFit\nWith Range(\"M1\")    \n.Font.Bold = True\nEnd With\nColumns(\"M:M\").EntireColumn.AutoFit    \nWith Range(\"N1\")    \n.Font.Bold = True\nEnd With    \nColumns(\"N:N\").EntireColumn.AutoFit   \nWith Range(\"O1\")    \n.Font.Bold = True\nEnd With    \nColumns(\"O:O\").EntireColumn.AutoFit   \nWith Range(\"P1\")    \nEnd With    \nSelection.Font.Bold = True\nColumns(\"P:P\").EntireColumn.AutoFit    \nWith Range(\"Q1\")\n.Font.Bold = True\nEnd With\nColumns(\"Q:Q\").EntireColumn.AutoFit\nDim i As Long\nDim current As String\n'Dim Strings As Variant\nDim count As Integer\nDim cell As Integer\nSet rng = Range(Cells(1, 1), Cells(Rows.count, 16))    \nFor i = 2 To Rows.count 'foreach row\n    current = Cells(i, 1).Value\n    cell = 0 '0\n    rng(i, cell + 1).Value = Mid(current, 3, 7) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 9, 7) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 16, 5) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 40, 10) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 50, 8) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 58, 8) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 66, 4) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 70, 2) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 100, 20)\n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 120, 6) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 126, 10) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 136, 10) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 146, 12) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 158, 12) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 170, 12) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 194, 255) \n    cell = cell + 1\n    rng(i, cell + 1).Value = Mid(current, 449, 255) \n    cell = cell + 1\nNext i\nActiveSheet.ListObjects.Add(xlSrcRange, Range(rng(1, 1), rng(Rows.count, cell)), , xlYes).Name = _\n    \"Table1\"\nActiveSheet.ListObjects(\"Table1\").TableStyle = \"TableStyleLight2\"\nApplication.ScreenUpdating = True\nMsgBox \"Macro has finished running\"\nMsgBox \"Data is now in Excel format and can be saved to a new file.\", _\nvbExclamation, \"MORE CHOICES\"\nApplication.Calculation = xlCalculationAutomatic\nElse\n   MsgBox \"Additional tab already exists. Only MACROS tab should exist in       workbook prior to running macro.\", _\nvbExclamation, \"**  Additional tab already exists  **\"\n End If  \n End Sub\n</code></pre>\n\n<p>I have been using <a href=\"http://www.cpearson.com/excel/optimize.htm\" rel=\"nofollow noreferrer\">this</a> source as a reference for to try to reduce the time it takes.</p>\n\n<p>Any ideas? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 394, "user_id": 1030506, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7c9ba14941175d9c3f9bd8c0ae074f02?s=128&d=identicon&r=PG", "display_name": "Sirus", "link": "https://stackoverflow.com/users/1030506/sirus"}, "edited": false, "score": 0, "creation_date": 1468426980, "post_id": 38356788, "comment_id": 64126279, "body": "i tried the first one and i get an error &quot;This operation requires the merged cells to be identically sized&quot;"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 394, "user_id": 1030506, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7c9ba14941175d9c3f9bd8c0ae074f02?s=128&d=identicon&r=PG", "display_name": "Sirus", "link": "https://stackoverflow.com/users/1030506/sirus"}, "edited": false, "score": 0, "creation_date": 1468427086, "post_id": 38356788, "comment_id": 64126339, "body": "@Sirus - that is whole different problem. It would have been useful to know you had merged cells to begin with. I suggest getting rid of the merged cells first. (If it&#39;s for formatting, try using <code>CenterAcrossSelection</code> in the formatting for two (or more) cells across a column)."}, {"owner": {"reputation": 394, "user_id": 1030506, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7c9ba14941175d9c3f9bd8c0ae074f02?s=128&d=identicon&r=PG", "display_name": "Sirus", "link": "https://stackoverflow.com/users/1030506/sirus"}, "edited": false, "score": 0, "creation_date": 1468428601, "post_id": 38356788, "comment_id": 64127208, "body": "i can&#39;t change the original spreadsheets.. they are formatted that way and cannot be changed"}, {"owner": {"reputation": 394, "user_id": 1030506, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7c9ba14941175d9c3f9bd8c0ae074f02?s=128&d=identicon&r=PG", "display_name": "Sirus", "link": "https://stackoverflow.com/users/1030506/sirus"}, "edited": false, "score": 0, "creation_date": 1468441568, "post_id": 38356788, "comment_id": 64134551, "body": "ok thanks for helping... i get an error on the line where you set range(cel.mergearea.address).value etc etc.  what do i set range as?  otherwise i get object not set to instance of an object..."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 394, "user_id": 1030506, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7c9ba14941175d9c3f9bd8c0ae074f02?s=128&d=identicon&r=PG", "display_name": "Sirus", "link": "https://stackoverflow.com/users/1030506/sirus"}, "edited": false, "score": 0, "creation_date": 1468441726, "post_id": 38356788, "comment_id": 64134639, "body": "@sirus - try with that edit, mine worked the other way as well"}, {"owner": {"reputation": 394, "user_id": 1030506, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7c9ba14941175d9c3f9bd8c0ae074f02?s=128&d=identicon&r=PG", "display_name": "Sirus", "link": "https://stackoverflow.com/users/1030506/sirus"}, "edited": false, "score": 0, "creation_date": 1468442059, "post_id": 38356788, "comment_id": 64134820, "body": "ok just trying and getting an Public member &#39;Value&#39; on type &#39;String&#39; not found. error now on that line.. trying to figure it out"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 394, "user_id": 1030506, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7c9ba14941175d9c3f9bd8c0ae074f02?s=128&d=identicon&r=PG", "display_name": "Sirus", "link": "https://stackoverflow.com/users/1030506/sirus"}, "edited": false, "score": 0, "creation_date": 1468442508, "post_id": 38356788, "comment_id": 64135038, "body": "hard to help more without seeing the data itself @sirus"}, {"owner": {"reputation": 394, "user_id": 1030506, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7c9ba14941175d9c3f9bd8c0ae074f02?s=128&d=identicon&r=PG", "display_name": "Sirus", "link": "https://stackoverflow.com/users/1030506/sirus"}, "edited": false, "score": 0, "creation_date": 1468443467, "post_id": 38356788, "comment_id": 64135499, "body": "sorry i forgot to remove the address part in that line... it loops through now but eventually crashes causing a HRESULT 0x800401A8.  i have to stop it... basically get a run time error 9, subscript out of range when i open the excel sheet after.."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1468441645, "last_edit_date": 1468441645, "creation_date": 1468426253, "answer_id": 38356788, "question_id": 38356564, "link": "https://stackoverflow.com/questions/38356564/copy-values-from-one-worksheet-to-another-worksheet-file/38356788#38356788", "title": "Copy values from one worksheet to another worksheet file", "body": "<p>This will work to paste cell formatting and values:</p>\n\n<pre><code>xlWorksheetSource.UsedRange.Copy()\nxlWorkDestSource = xlWorkbookDestination.Worksheets.Add()\nxlWorkDestSource.Range(\"A1\").PasteSpecial xlPasteAllUsingSourceTheme\nxlWorkDestSource.Range(\"A1\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>If you only need values and number formatting you can do this:</p>\n\n<pre><code>xlWorksheetSource.UsedRange.Copy()\nxlWorkDestSource = xlWorkbookDestination.Worksheets.Add()\nxlWorkDestSource.Range(\"A1\").PasteSpecial xlPasteValuesAndNumberFormats\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>To work with merged cells this will work. <em>There may be a better / faster way</em></p>\n\n<pre><code>xlWorksheetSource = xlWorkbookSource.Sheets(sheet.Name)\n                xlWorksheetSource.Copy(After:=xlWorkbookDestination.Worksheets(xlWorkbookDestination.Worksheets.Count))\n\nxlWorkDestSource = xlWorkbookDestination.Worksheets(xlWorkbookDestination.Worksheets.Count)\n\nFor each cel in xlWorkDestSource.UsedRange\n    cel.MergeArea.Value = cel.MergeArea.Value\nNext\n</code></pre>\n\n<p>*Please note that I didn't qualify any of the objects, because you didn't in your code, but its definitely a best practice.</p>\n"}], "owner": {"reputation": 394, "user_id": 1030506, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7c9ba14941175d9c3f9bd8c0ae074f02?s=128&d=identicon&r=PG", "display_name": "Sirus", "link": "https://stackoverflow.com/users/1030506/sirus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468441645, "creation_date": 1468425590, "last_edit_date": 1468432981, "question_id": 38356564, "link": "https://stackoverflow.com/questions/38356564/copy-values-from-one-worksheet-to-another-worksheet-file", "title": "Copy values from one worksheet to another worksheet file", "body": "<p>The first two lines, i have it looping to copy complete sheets over to another file.. Which is fine because i want the formatting but not the links back to the original file it copied from just the values only.  The second part that is commented out works as it will copy the values only.. but i want the formatting copied as it does in the first two lines with the values only.  How can i combine this .. i have looked at other examples and i can't seem to get a working answer. thanks</p>\n\n<pre><code>               xlWorksheetSource = xlWorkbookSource.Sheets(sheet.Name)\n                xlWorksheetSource.Copy(After:=xlWorkbookDestination.Worksheets(xlWorkbookDestination.Worksheets.Count))\n\n\n                'xlWorksheetSource.UsedRange.Copy()\n                'xlWorkDestSource = xlWorkbookDestination.Worksheets.Add()\n                'xlWorkDestSource.UsedRange._PasteSpecial(XlPasteType.xlPasteValues, XlPasteSpecialOperation.xlPasteSpecialOperationNone, False, False)\n                'xlWorkDestSource.Name = sheet.Name\n</code></pre>\n"}, {"tags": ["vba", "excel", "dynamic", "unique"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6461568, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2c78a271e31b8eeb19d6f04a57f9250?s=128&d=identicon&r=PG&f=1", "display_name": "beks123", "link": "https://stackoverflow.com/users/6461568/beks123"}, "edited": false, "score": 0, "creation_date": 1468430486, "post_id": 38356895, "comment_id": 64128321, "body": "I&#39;ve tried this but it just keeps telling me the subscript is out of range"}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 1, "last_activity_date": 1468426607, "creation_date": 1468426607, "answer_id": 38356895, "question_id": 38356511, "link": "https://stackoverflow.com/questions/38356511/placing-unique-text-from-separate-worksheet-into-looped-column-headers-in-vba/38356895#38356895", "title": "Placing unique text from separate worksheet into looped column headers in VBA", "body": "<p>You are looping over individual cells so you don't need to use the whole array every time. Since there's only one field to fill it will take the first entry of the array every time. Use the appropriate entry of the array:</p>\n\n<pre><code>.Range(.Cells(i, j * 4 + 2), .Cells(i, j * 4 + 4)).Value = arrValues(j)\n</code></pre>\n\n<p>Note that because <code>arrValues</code> comes from a column, it is a one-dimensional array.</p>\n"}], "owner": {"reputation": 55, "user_id": 6461568, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2c78a271e31b8eeb19d6f04a57f9250?s=128&d=identicon&r=PG&f=1", "display_name": "beks123", "link": "https://stackoverflow.com/users/6461568/beks123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468426607, "creation_date": 1468425391, "question_id": 38356511, "link": "https://stackoverflow.com/questions/38356511/placing-unique-text-from-separate-worksheet-into-looped-column-headers-in-vba", "title": "Placing unique text from separate worksheet into looped column headers in VBA", "body": "<p>I am trying to take a column from a separate worksheet and copy it with only its unique values into another worksheet as column headers. Right now, my code makes unique values in reference1 and attempts to copy them over to Sheet1 as column headers, but for some reason, my range only loops the first row in reference1 data (the picture shows it just continually loops title1) into every column header in sheet1. If I place \"Transpose(arrValues)\" in the with wsDB statement, it only places the first row of data and if I place \"Transpose(j)\" in the with wsDB statement, it only places the actual numbered columns from the reference1 sheet. </p>\n\n<p><a href=\"https://i.stack.imgur.com/jyUlY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jyUlY.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub uniqueyes()\nDim wsRef As Worksheet\nDim wsDB As Worksheet\n\nSet wsRef = Worksheets(\"reference1\")\nSet wsDB = Worksheets(\"Sheet1\")\n\nWith wsRef\n    .Range(\"F1:F60\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=.Range(\"I1\"), unique:=True\n\n    Dim arrValues As Variant\n    arrValues = .Range(\"I2\", .Range(\"I\" &amp; .Rows.Count).End(xlUp))\n\nEnd With\n\nFor i = 1 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row\n\n    If Cells(i, 4) = \"Title\" Then\n\n        For j = 1 To (UBound(arrValues)) Step 1\n\n            With wsDB\n            .Range(.Cells(i, j * 4 + 2), .Cells(i, j * 4 + 4)).Value = Application.WorksheetFunction.Transpose(arrValues)\n\n            End With\n\n        Next j\n\n    End If\n\nNext i\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "if-statement", "conditional"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4538061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc7eb4ac540cfefd0cdb33cf3a30ed1?s=128&d=identicon&r=PG&f=1", "display_name": "Viperwolfmn", "link": "https://stackoverflow.com/users/4538061/viperwolfmn"}, "edited": false, "score": 0, "creation_date": 1468432921, "post_id": 38356794, "comment_id": 64129823, "body": "This did not work but I was able to get the code working.  Similar to your example I stored both values in temporarily and then did some logic test and included NOT IsNull(Col_2)"}], "tags": [], "owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "is_accepted": false, "score": 1, "last_activity_date": 1468426274, "creation_date": 1468426274, "answer_id": 38356794, "question_id": 38356462, "link": "https://stackoverflow.com/questions/38356462/vba-if-value-is-null-end-script-else-continue/38356794#38356794", "title": "VBA IF Value is null end script else continue", "body": "<p>Try this</p>\n\n<pre><code>rightVal = RIGHT(xxxx.GetField(\"Col_2\"), 4)\nIf IsNull(rightVal) Or rightVal = \"\" Then\n    Exit Sub\nEnd If\n\nIf StrComp(XXXX.GetField(\"Col_1\"), rightVal) &lt;&gt; 0 Then\n    xxxx.SetField \"Col_1\" , rightVal\nEnd If\n</code></pre>\n\n<p>Nothing refers to an empty Object reference is VB, so comparing to nothing wasn't quite right. Also, you need to specify what to exit, in this case \"Exit Sub\", and enclose it in the If block (your If statement was left wide open).</p>\n\n<p>I also temporarily store the value of <code>RIGHT(xxxx.GetField(\"Col_2\"), 4)</code> to save on recomputing every time.</p>\n"}], "owner": {"reputation": 3, "user_id": 4538061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc7eb4ac540cfefd0cdb33cf3a30ed1?s=128&d=identicon&r=PG&f=1", "display_name": "Viperwolfmn", "link": "https://stackoverflow.com/users/4538061/viperwolfmn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1890, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468426274, "creation_date": 1468425256, "question_id": 38356462, "link": "https://stackoverflow.com/questions/38356462/vba-if-value-is-null-end-script-else-continue", "title": "VBA IF Value is null end script else continue", "body": "<p>New to VBA so I do apologize for any stupidity here.  I am working on custom script for software we have, it seems like everywhere has excel scripting.  </p>\n\n<p>Working code</p>\n\n<pre><code>IF StrComp(XXXX.GetField(\"Col_1\"), RIGHT(xxxx.GetField(\"Col_2\"), 4)) &lt;&gt; 0 \nThen xxxx.SetField \"Col_1\" , RIGHT(xxxx.GetField(\"Col_2\"), 4)\nEnd If\n</code></pre>\n\n<p>What is happening is the script is running fine but if there is a Blank value in Col_1 and a Null Value in Col_2 it is updating Col_1 with ****.  I would like that if Col_2 is nothing, blank or NULL to do nothing at all end script however if there is a value there to test if Col_1 = last 4 of Col_2 if those are not equal then run the update.  Hopefully this make sense.  This was my attempt but crashed and burned.</p>\n\n<pre><code>If RIGHT(xxxx.GetField(\"Col_2\"), 4) Is Nothing \nTHEN Exit\nIF StrComp(XXXX.GetField(\"Col_1\"), RIGHT(xxxx.GetField(\"Col_2\"), 4)) &lt;&gt; 0\nThen xxxx.SetField \"Col_1\" , RIGHT(xxxx.GetField(\"Col_2\"), 4)\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "merge-conflict-resolution"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1468425669, "post_id": 38356297, "comment_id": 64125447, "body": "Welcome to Stack Overflow.  SO is not a code for me site nor is it a teach me to code site.  what have you tried?  If you are using Office 365 Excel 2016 then most likely this can be done with an array formula or two and some SUMIFS().  Otherwise you will need to sort your data and use a helper column to do formulas.  If none of those will work then you are stuck with vba."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1468535676, "creation_date": 1468535676, "answer_id": 38385289, "question_id": 38356297, "link": "https://stackoverflow.com/questions/38356297/how-to-i-merge-two-or-more-cells-if-they-have-the-same-content-on-other-cells/38385289#38385289", "title": "How to I merge two or more cells if they have the same content on other cells", "body": "<p>This will do it for you!!</p>\n\n<pre><code>Sub Macro()\nDim lngRow As Long\nFor lngRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row To 2 Step -1\nIf StrComp(Range(\"B\" &amp; lngRow), Range(\"B\" &amp; lngRow - 1), vbTextCompare) = 0 Then\nIf Range(\"C\" &amp; lngRow) &lt;&gt; \"\" Then\nRange(\"A\" &amp; lngRow - 1) = Range(\"A\" &amp; lngRow - 1) &amp; \";\" &amp; Range(\"A\" &amp; lngRow)\nRange(\"C\" &amp; lngRow - 1) = Range(\"C\" &amp; lngRow - 1) + Range(\"C\" &amp; lngRow)\nRange(\"D\" &amp; lngRow - 1) = Range(\"D\" &amp; lngRow - 1) + Range(\"D\" &amp; lngRow)\nEnd If\nRows(lngRow).Delete\nEnd If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6585226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e471ed2f33b56ec134e281f6d38fcc?s=128&d=identicon&r=PG&f=1", "display_name": "S. Dic", "link": "https://stackoverflow.com/users/6585226/s-dic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1468535676, "creation_date": 1468424777, "last_edit_date": 1468425266, "question_id": 38356297, "link": "https://stackoverflow.com/questions/38356297/how-to-i-merge-two-or-more-cells-if-they-have-the-same-content-on-other-cells", "title": "How to I merge two or more cells if they have the same content on other cells", "body": "<p>I wanted to see if there is an easier way through an if(), VBA, or array formula to merge/sum cells with the same title. What I want is if the name matches, to merge the IDs together with a \",\" in one cell, then sum the rooms and SF together into one row together.</p>\n\n<pre><code> ID                 Name                  Rooms    Sf\n 00000121856000000  Dreadfall Apartments   123     44000\n 00000121865000000  Dreadfall Apartments   115     40000\n 00000121898000000  Clear Creek             22     11500\n 00000121897000000  Clear Creek             22     11500\n 00000121541000000  Clear Creek             23     12500\n</code></pre>\n\n<p>I want it to look like:</p>\n\n<pre><code>|00000121856000000, 00000121865000000                  | Dreadfall  Apartments  | 238 | 84000\n|00000121898000000,00000121897000000, 00000121541000000| Clear Creek            |  67 | 58500\n</code></pre>\n\n<p>Assume \"ID\" is A1 and \"Sf\" is D1. Thanks so much in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 3822027, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dcef5e4ca84d2f9df03b342d802b70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Ruiz", "link": "https://stackoverflow.com/users/3822027/tom-ruiz"}, "edited": false, "score": 0, "creation_date": 1468517401, "post_id": 38356186, "comment_id": 64170993, "body": "Why do I need this <code>Workbooks.Open (FilePath &amp; FileName)</code>"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 319, "user_id": 3822027, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dcef5e4ca84d2f9df03b342d802b70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Ruiz", "link": "https://stackoverflow.com/users/3822027/tom-ruiz"}, "edited": false, "score": 0, "creation_date": 1468556004, "post_id": 38356186, "comment_id": 64184849, "body": "You need this to open the file. <code>Workbooks.Open (FilePath &amp; FileName &amp; &quot;AgentTest.xslx&quot;)</code>"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 319, "user_id": 3822027, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dcef5e4ca84d2f9df03b342d802b70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Ruiz", "link": "https://stackoverflow.com/users/3822027/tom-ruiz"}, "edited": false, "score": 0, "creation_date": 1468900349, "post_id": 38356186, "comment_id": 64303570, "body": "<code>ActiveWorkbook.Close</code>. If you don&#39;t want to save the file  then it must be <code>ActiveWorkbook.Close (False)</code>"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1468555872, "last_edit_date": 1468555872, "creation_date": 1468424494, "answer_id": 38356186, "question_id": 38356011, "link": "https://stackoverflow.com/questions/38356011/how-to-copy-information-across-excel-workbooks/38356186#38356186", "title": "How to copy information across excel workbooks", "body": "<p>Try with below</p>\n\n<pre><code>Workbooks(FilePath &amp; \"Data Gap Project High Priority 2016.xslx\").Sheets(\"Consolidated\").Range (\"A\" &amp; iRow + 1)\n</code></pre>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>Not Tested. But try with below code.</p>\n\n<pre><code>Sub cnsldt()\n    Dim FilePath As String\n    Dim FileName As String\n    Dim iRow As Long\n    Dim lCell As Range\n    FilePath = \"Z:\\Lead Generation\\Jose Buitrago\\Special Projects-Asignments\\Data Gap Project\\\"\n    FileName = \"Data Gap Project High Priority 2016 - \"\n    Workbooks.Open (FilePath &amp; FileName &amp; \"AgentTest.xslx\")\n    iRow = ActiveSheet.Cells.Find(What:=\"*\", SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n    'First we clear the sheet where I'm going to paste the info\n    Set lCell = Sheets(\"Consolidated\").Cell(iRow, AP)\n    Range(\"A2\", lCell).ClearContents\n    'not sure if must open files or just copy the info\n    'not sure if should unhide Column A\n    'AgentTest not declared because that is the name of the file so in this example the target is Z:\\Lead Generation\\Jose Buitrago\\Special Projects-Asignments\\Data Gap Project\\Data Gap Project High Priority 2016 - AgentTest.xslx\n    Workbooks(FilePath &amp; FileName &amp; \"AgentTest.xslx\").Sheets(\"Sheet1\").Range(\"A2:AP1779\").Copy\n    Workbooks(FilePath &amp; \"Data Gap Project High Priority 2016.xslx\").Sheets(\"Consolidated\").Range(\"A2\").PasteSpecial xlPasteValuesApplication.CutCopyMode = False\n    Workbooks(FilePath &amp; \"Data Gap Project High Priority 2016.xslx\").Sheets(\"Consolidated\").Range (\"A\" &amp; iRow + 1)\n    'How should I proceed afterwards since the paste range its not A2 it would be Cell(iRow+1,A) ????\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 3822027, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dcef5e4ca84d2f9df03b342d802b70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Ruiz", "link": "https://stackoverflow.com/users/3822027/tom-ruiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482175819, "creation_date": 1468423981, "last_edit_date": 1482175819, "question_id": 38356011, "link": "https://stackoverflow.com/questions/38356011/how-to-copy-information-across-excel-workbooks", "title": "How to copy information across excel workbooks", "body": "<p>I have 5 different files (all in the same folder), one of them I use it as a Master/Reporting Workbook the others are where agents fill information, in the master file I have several sheets I want to paste the info in a sheet called Consolidated, all the other files have just 1 sheet (Sheet1) and the range to copy the info from is the same (A2:AP1779).</p>\n\n<p>I'm trying an approach such as (Please do mind the comments)</p>\n\n<pre><code>Sub cnsldt()Dim FilePath As String\nDim FileName As String\nDim iRow As Long\nDim lCell as Range\n\n\n    FilePath = \"Z:\\Lead Generation\\Jose Buitrago\\Special Projects-Asignments\\Data Gap Project\\\"\n    FileName = \"Data Gap Project High Priority 2016 - \"\n    iRow = ActiveSheet.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _    SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n\n'First we clear the sheet where I'm going to paste the info\nSet lCell = Sheets(\"Consolidated\").Cell(iRow,AP)\nRange(\"A2\",lCell).ClearContents\n\n'not sure if must open files or just copy the info\n'not sure if should unhide Column A\n'AgentTest not declared because that is the name of the file so in this example the target is Z:\\Lead Generation\\Jose Buitrago\\Special Projects-Asignments\\Data Gap Project\\Data Gap Project High Priority 2016 - AgentTest.xslx\n\nWorkbooks(\"FilePath &amp; FileName &amp; AgentTest.xslx\").Sheets(\"Sheet1\").Range(\"A2:AP1779\").Copy\nWorkbooks(\"FilePath &amp; Data Gap Project High Priority 2016.xslx\").Sheets(\"Consolidated\").Range(\"A2\").PasteSpecial xlPasteValuesApplication.CutCopyMode = False\n\n'How should I proceed afterwards since the paste range its not A2 it would be Cell(iRow+1,A) ?\n\n\n\nEnd Sub\n</code></pre>\n\n<p>I have many doubts on how to tackle this task.</p>\n"}, {"tags": ["vba", "excel", "internet-explorer", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6571399, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XT-QJ6EG83Q/AAAAAAAAAAI/AAAAAAAAFFk/StyWFrzwUR0/photo.jpg?sz=128", "display_name": "Shanti Oppenheimer", "link": "https://stackoverflow.com/users/6571399/shanti-oppenheimer"}, "edited": false, "score": 0, "creation_date": 1469374505, "post_id": 38487789, "comment_id": 64498270, "body": "Excel needs &quot;Cnt&quot; and &quot;oCell&quot; to be defined as variables, otherwise the code is not running properly."}, {"owner": {"reputation": 116, "user_id": 6494858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KAxGo.jpg?s=128&g=1", "display_name": "BigElittles", "link": "https://stackoverflow.com/users/6494858/bigelittles"}, "reply_to_user": {"reputation": 1, "user_id": 6571399, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XT-QJ6EG83Q/AAAAAAAAAAI/AAAAAAAAFFk/StyWFrzwUR0/photo.jpg?sz=128", "display_name": "Shanti Oppenheimer", "link": "https://stackoverflow.com/users/6571399/shanti-oppenheimer"}, "edited": false, "score": 0, "creation_date": 1469452218, "post_id": 38487789, "comment_id": 64527028, "body": "Correct, The cnt needs to be defined as a variable. The Ocell needs to be defined as an object..."}], "tags": [], "owner": {"reputation": 116, "user_id": 6494858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KAxGo.jpg?s=128&g=1", "display_name": "BigElittles", "link": "https://stackoverflow.com/users/6494858/bigelittles"}, "is_accepted": false, "score": 0, "last_activity_date": 1469452295, "last_edit_date": 1469452295, "creation_date": 1469038054, "answer_id": 38487789, "question_id": 38355762, "link": "https://stackoverflow.com/questions/38355762/how-do-i-modify-web-scraping-code-to-loop-through-product-bullets-until-it-finds/38487789#38487789", "title": "How do I modify web scraping code to loop through product bullets until it finds correct bullet and pull information?", "body": "<p>Try this, it will loop through every \"li\" item under that element id. Then it will replace/remove the \"Item model number:\" text so you're left with a clean model number for whatever product your looking at. </p>\n\n<blockquote>\n<pre><code>Dim Cnt As Variant\nDim oCell As Object\nCnt = 0  \nWith ie.Document.body.all.Item(\"detailBulletsWrapper_feature_div\").all\n    For Each oCell In .tags(\"li\")\n        If InStr(oCell.innerText, \"Item model number:\") &gt; 0 Then\n          ModelNum = oCell.innerText\n          ModelNum = VBA.Replace(ModelNum, \"Item model number:  \", \"\")\n          Debug.Print ModelNum\n        Exit For\n        End If\n  Cnt = Cnt + 1\nNext oCell\nEnd With\nSet oCell = Nothing\n   End Sub\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 6571399, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XT-QJ6EG83Q/AAAAAAAAAAI/AAAAAAAAFFk/StyWFrzwUR0/photo.jpg?sz=128", "display_name": "Shanti Oppenheimer", "link": "https://stackoverflow.com/users/6571399/shanti-oppenheimer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469452295, "creation_date": 1468423291, "last_edit_date": 1468424813, "question_id": 38355762, "link": "https://stackoverflow.com/questions/38355762/how-do-i-modify-web-scraping-code-to-loop-through-product-bullets-until-it-finds", "title": "How do I modify web scraping code to loop through product bullets until it finds correct bullet and pull information?", "body": "<p>Here is my code. It pulls the \"Item Model Number\" off of Amazon detail pages. This has been written to find \"Item Model Number\" in the detail page bullet points and extract the number next to it.</p>\n\n<p>The issue is that it sometimes will be unable to pull the \"Item Model Number\" from a page that clearly has an Item Model Number.</p>\n\n<p>Here is the code</p>\n\n<pre><code>Sub Get_ITEM_CODE(ie As Object)\n    Dim WB As Workbook\n    Dim WS As Worksheet\n    Dim y As String\n    Dim AmUrl As String\n    AmUrl = ActiveCell.Value\n    ''Set WB = Workbooks.Add\n\n    Set WS = Sheets(\"Extract Item COde\")\n    ie.Navigate AmUrl\n    Application.Wait (Now + TimeValue(\"00:00:02\"))\n    Do While ie.readyState &lt;&gt; 4: Loop\n    On Error Resume Next\n\n    y = ie.document.getElementById(\"productDetails_detailBullets_sections1\").innerText\n\n    WS.Range(\"A1\").Value = y\n\n    SplitTextItemCode\n    AddtoListItemCode\n\nEnd Sub\n</code></pre>\n\n<p>Here is a string of HTML where the Code does its job properly: </p>\n\n<pre><code>&lt;div id=\"detailBullets\" class=\"feature\" data-feature-name=\"detailBullets\"&gt;\n\n&lt;div id=\"detailBulletsWrapper_feature_div\" data-feature-name=\"detailBullets\" data-template-name=\"detailBullets\" class=\"a-section a-spacing-none feature\"&gt;\n    &lt;div id=\"detailBullets_feature_div\"&gt;\n</code></pre>\n\n<p><a href=\"https://rads.stackoverflow.com/amzn/click/com/B007P07T84\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">URL to webpage</a></p>\n\n<p>Here is a string of HTML where the Code did not do its job:</p>\n\n<pre><code>&lt;div id=\"detailBullets\" class=\"feature\" data-feature-name=\"detailBullets\"&gt;\n\n&lt;div id=\"detailBulletsWrapper_feature_div\" data-feature-name=\"detailBullets\" data-template-name=\"detailBullets\" class=\"a-section a-spacing-none feature\"&gt;\n    &lt;div id=\"detailBullets_feature_div\"&gt;\n</code></pre>\n\n<p><a href=\"https://rads.stackoverflow.com/amzn/click/com/B0059AHK4A\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">URL to Web Page</a></p>\n"}, {"tags": ["vba", "function", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1468423061, "post_id": 38355583, "comment_id": 64123596, "body": "change <code>As String</code> to <code>As Range</code>. Offset requires a Range Object as the first argument. Change <code>.Offset(CellRange)</code> to <code>.Offset(Range(CellRange)</code> will also work, but it&#39;s clunkier."}, {"owner": {"reputation": 1, "user_id": 6585184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d09a5eb39a42404410b5f80468841398?s=128&d=identicon&r=PG&f=1", "display_name": "Crusader0534", "link": "https://stackoverflow.com/users/6585184/crusader0534"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1468423323, "post_id": 38355583, "comment_id": 64123789, "body": "I changed the formula to the below and i still get #VALUE                        Function CellBefore(CellRange As Range)  CellBefore = ActiveSheet.WorksheetFunction.Offset(Range(CellRange), 0, 2).Value  End Function"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1468423435, "post_id": 38355583, "comment_id": 64123880, "body": "If CellRange is a range @ScottHoltzman then the offset should be <code>.Offset(CellRange,..</code>  If you are passing a sting address then leave it a string and then what Scott said is true it needs to be <code>.Offset(Range(CellRange)</code>"}, {"owner": {"reputation": 1, "user_id": 6585184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d09a5eb39a42404410b5f80468841398?s=128&d=identicon&r=PG&f=1", "display_name": "Crusader0534", "link": "https://stackoverflow.com/users/6585184/crusader0534"}, "edited": false, "score": 0, "creation_date": 1468423742, "post_id": 38355583, "comment_id": 64124078, "body": "I Assume for the String input, it would need to be =Cell(&quot;Address&quot;,A1) or something similar? I tried doing that and i&#39;m still getting a #VALUE issue"}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 2, "last_activity_date": 1468423935, "creation_date": 1468423935, "answer_id": 38355994, "question_id": 38355583, "link": "https://stackoverflow.com/questions/38355583/dynamic-cell-ranges-in-formula/38355994#38355994", "title": "Dynamic Cell Ranges in Formula", "body": "<p>Apparently <code>.Offset</code> is not available as a worksheet function from within a macro. You can use the <code>Range.Offset</code> method:</p>\n\n<pre><code>Function CellBefore(CellRange As String)\n    CellBefore = Range(CellRange).Offset.Value\nEnd Function\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Function CellBefore(CellRange As Range)\n    CellBefore = CellRange.Offset(0, 2).Value\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6585184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d09a5eb39a42404410b5f80468841398?s=128&d=identicon&r=PG&f=1", "display_name": "Crusader0534", "link": "https://stackoverflow.com/users/6585184/crusader0534"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1468423935, "creation_date": 1468422788, "last_edit_date": 1531164843, "question_id": 38355583, "link": "https://stackoverflow.com/questions/38355583/dynamic-cell-ranges-in-formula", "title": "Dynamic Cell Ranges in Formula", "body": "<p>I am having trouble creating a formula where a cell range in an input. </p>\n\n<pre><code>Function CellBefore(CellRange As String)\n\nCellBefore = ActiveSheet.WorksheetFunction.Offset(CellRange, 0, 2).Value\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6585145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a2d98ca733bd10222eafb11c6de49f?s=128&d=identicon&r=PG&f=1", "display_name": "Rusty", "link": "https://stackoverflow.com/users/6585145/rusty"}, "edited": false, "score": 0, "creation_date": 1468422864, "post_id": 38355571, "comment_id": 64123438, "body": "Oh wow, thank you. I was getting another error that I was attempting to resolve and I must have retyped this section incorrectly. Thank you so much!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 43, "user_id": 6585145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a2d98ca733bd10222eafb11c6de49f?s=128&d=identicon&r=PG&f=1", "display_name": "Rusty", "link": "https://stackoverflow.com/users/6585145/rusty"}, "edited": false, "score": 0, "creation_date": 1468422905, "post_id": 38355571, "comment_id": 64123470, "body": "No worries, don&#39;t forget to mark as the answer if it solved your issue."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 4, "last_activity_date": 1468422739, "creation_date": 1468422739, "answer_id": 38355571, "question_id": 38355533, "link": "https://stackoverflow.com/questions/38355533/excel-vba-copy-method-of-worksheet-class-failed-used-to-function-fine/38355571#38355571", "title": "Excel VBA - Copy Method of Worksheet class Failed - Used to function fine", "body": "<p>That code should have never worked, the argument is expecting a sheet object - so it should be:</p>\n\n<pre><code>ActiveSheet.Copy After:=Sheets(Sheets.Count)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1468422875, "creation_date": 1468422875, "answer_id": 38355619, "question_id": 38355533, "link": "https://stackoverflow.com/questions/38355533/excel-vba-copy-method-of-worksheet-class-failed-used-to-function-fine/38355619#38355619", "title": "Excel VBA - Copy Method of Worksheet class Failed - Used to function fine", "body": "<p>Try with below. It will work</p>\n\n<pre><code>ActiveSheet.Copy After:=Sheets(Sheets.Count)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6585145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a2d98ca733bd10222eafb11c6de49f?s=128&d=identicon&r=PG&f=1", "display_name": "Rusty", "link": "https://stackoverflow.com/users/6585145/rusty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 1, "accepted_answer_id": 38355571, "answer_count": 2, "score": 3, "last_activity_date": 1468422875, "creation_date": 1468422635, "last_edit_date": 1468422758, "question_id": 38355533, "link": "https://stackoverflow.com/questions/38355533/excel-vba-copy-method-of-worksheet-class-failed-used-to-function-fine", "title": "Excel VBA - Copy Method of Worksheet class Failed - Used to function fine", "body": "<p>I have a time card workbook that in it you can create a new card from the previous weeks card. It's worked just find until recently. I currently have 26 sheets, no code has changed but it throws a run-time error and higlights,</p>\n\n<pre><code>ActiveSheet.Copy After:=Sheets.Count\n</code></pre>\n\n<p>Here's the whole module:</p>\n\n<pre><code>Sub create_timecard()\n\n'copy sheet afterlast sheet\n\nDim timeCardNo As Integer\nDim user As String\nDim colCount As Integer\nDim topRow As Integer\nDim rightCol As Integer\nDim cardName As String\nDim timeCard As ListObject\nDim msgBoxResult As VbMsgBoxResult\n\nDim weekStart As String\nDim weekEnd As String\n\nDim curMonth As String\nDim endMonth As String\n\nmsgBoxResult = MsgBox(\"Would you like to keep the previous week's projects?\", vbExclamation + vbYesNoCancel, \"New Time Card\")\n\nIf msgBoxResult = vbCancel Then\n\nExit Sub\n\nEnd If\n\n'Get current week\ncurMonth = MonthName(Month(Date), True)\nweekStart = Day(Date - Weekday(Date, vbMonday) + 1)\nweekEnd = Day(Date - Weekday(Date, vbMonday) + 7)\n\nendMonth = MonthName(Month(Date - Weekday(Date, vbMonday) + 7), True)\n\n\nActiveSheet.Copy After:=Sheets.Count\n\n\n\nuser = Application.UserName\nSet timeCard = ActiveSheet.ListObjects(1)\n\ntimeCardNo = ThisWorkbook.Sheets.Count - 2 'minus one to remove summary sheet from count\ncardName = user &amp; timeCardNo\n\nActiveSheet.Name = cardName\n\ntopRow = timeCard.HeaderRowRange.Row - 1\nrightCol = timeCard.ListColumns.Count\n\n\nCells(topRow, rightCol).Value = cardName\nCells(topRow, timeCard.ListColumns(\"Monday\").Index).Value = curMonth &amp; \" \" &amp; weekStart &amp; \" - \" &amp; endMonth &amp; \" \" &amp; weekEnd\n\n\n\nIf msgBoxResult = vbNo Then\n\nRange(timeCard.DataBodyRange(1, 1), timeCard.DataBodyRange(timeCard.DataBodyRange.Rows.Count, timeCard.DataBodyRange.Columns.Count - 1)).ClearContents\n\nElseIf msgBoxResult = vbYes Then\n\nRange(timeCard.DataBodyRange(1, timeCard.ListColumns(\"Monday\").Index), timeCard.DataBodyRange(timeCard.DataBodyRange.Rows.Count, timeCard.DataBodyRange.Columns.Count - 1)).ClearContents\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I've searched one the site here, and I can't seems to get anything to work, other employees who are running the same sheet are not having the issue. I'm running Office 2013. and I don't know if this has anything to do with it, but it's the only difference, I have a Personal.xlsb for global macros.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "delete-row"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1468422293, "creation_date": 1468422293, "answer_id": 38355397, "question_id": 38355155, "link": "https://stackoverflow.com/questions/38355155/delete-2-rows-and-2-columns-in-vba/38355397#38355397", "title": "Delete 2 Rows and 2 Columns in VBA", "body": "<pre><code>With Sheets(\"PDEL_Report 500K\")\n    .Rows(\"81:82\").EntireRow.Delete Shift:=xlUp\n    .Columns(\"H:H\").EntireColumn.Delete Shift:=xlLeft 'delete H first so shift does not affect current column F\n    .Columns(\"F:F\").EntireColumn.Delete Shift:=xlLeft\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1468422714, "creation_date": 1468422714, "answer_id": 38355562, "question_id": 38355155, "link": "https://stackoverflow.com/questions/38355155/delete-2-rows-and-2-columns-in-vba/38355562#38355562", "title": "Delete 2 Rows and 2 Columns in VBA", "body": "<p>Try with below</p>\n\n<pre><code>With Sheets(\"PDEL_Report 500K\")\n    .Rows(\"81:82\").Delete Shift:=xlUp\n    .Columns(\"H:H\").EntireColumn.Delete Shift:=xlToLeft\n    .Columns(\"F:F\").EntireColumn.Delete Shift:=xlToLeft\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6462428, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e6e6aa41485b6d520dfbc54dd2df2336?s=128&d=identicon&r=PG&f=1", "display_name": "quenny", "link": "https://stackoverflow.com/users/6462428/quenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 38355397, "answer_count": 2, "score": 0, "last_activity_date": 1468422714, "creation_date": 1468421679, "question_id": 38355155, "link": "https://stackoverflow.com/questions/38355155/delete-2-rows-and-2-columns-in-vba", "title": "Delete 2 Rows and 2 Columns in VBA", "body": "<p>My code is below. I want to delete Rows 81 and 82 and columns F and H. My code below successfully deletes the rows but fails to delete the 2 columns. This with block is within a larger Sub. </p>\n\n<pre><code>With Sheets(\"PDEL_Report 500K\")\n    Rows(\"81:82\").Select\n    Selection.ClearContents\n    Selection.Delete Shift:=xlUp\n\n    Columns(\"F:F,H:H\").Select\n    Selection.ClearContents\n    Selection.EntireColumn.Delete Shift:=xlLeft\n\nEnd With\n</code></pre>\n"}, {"tags": ["sql", "database", "vba", "ms-access", "ms-access-2013"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468421702, "post_id": 38355040, "comment_id": 64122586, "body": "Yes, you need to add something in the source like a SQL statement based on others, or use the D functions of Access, so I generally have a hidden key, say USER_ID, then txtFirstName has the source, &quot;Dlookup(&quot;FirstName&quot;,&quot;tbl_Users&quot;,&quot;User_ID=&quot; &amp; me.txtUserID.value.   Can you not style the subform to be of textbox appearance single form?"}, {"owner": {"reputation": 119, "user_id": 6584970, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0115a1c68392ec4ca892d04d83ec5da0?s=128&d=identicon&r=PG&f=1", "display_name": "Orange56", "link": "https://stackoverflow.com/users/6584970/orange56"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468423134, "post_id": 38355040, "comment_id": 64123646, "body": "What are the proper steps styling the subform to be of textbox appearance? Sorry, I forgot to include the two ID fields within the table."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 1, "creation_date": 1468423428, "post_id": 38355040, "comment_id": 64123872, "body": "What does &quot;prefers textboxes instead&quot; mean? A subform has textboxes on it."}, {"owner": {"reputation": 119, "user_id": 6584970, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0115a1c68392ec4ca892d04d83ec5da0?s=128&d=identicon&r=PG&f=1", "display_name": "Orange56", "link": "https://stackoverflow.com/users/6584970/orange56"}, "edited": false, "score": 0, "creation_date": 1468425229, "post_id": 38355040, "comment_id": 64125112, "body": "The user prefers the lookup textboxes similar if the table was not in a relationship."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1468425280, "creation_date": 1468425280, "answer_id": 38356470, "question_id": 38355040, "link": "https://stackoverflow.com/questions/38355040/subform-vs-textboxes-for-a-many-relationship/38356470#38356470", "title": "Subform vs. Textboxes for a Many Relationship", "body": "<p>Don't even start going down this road. </p>\n\n<p>For the \"many\" part you need some sort of list. If it's read-only, a listbox does the job, but for editing and creating records, a subform with <code>Default View = Continuous Form</code> is the way to go. </p>\n\n<p>And as Brad wrote, it can have lots of textboxes. :)<br>\nOne per column * number of records.</p>\n"}], "owner": {"reputation": 119, "user_id": 6584970, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0115a1c68392ec4ca892d04d83ec5da0?s=128&d=identicon&r=PG&f=1", "display_name": "Orange56", "link": "https://stackoverflow.com/users/6584970/orange56"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468425280, "creation_date": 1468421430, "last_edit_date": 1468423212, "question_id": 38355040, "link": "https://stackoverflow.com/questions/38355040/subform-vs-textboxes-for-a-many-relationship", "title": "Subform vs. Textboxes for a Many Relationship", "body": "<p>I am currently in the process of creating an Access 2013 DB. The DB currently has two tables [Personal Information] and [Position Applied For], which is in a one to many relationship. With one person applying to many jobs. The problem that I am having with this database, is that within the form in order to successfully show the [Position Applied For] table it has to be in a subform. The user that I am building this DB for prefers textboxes instead. Is it possible to link textboxes to individual records/fields within the [Position Applied For] table since it is the many in the relationship? I have created the form but the textboxes are only linking to the first position the person applies for, I would like to show up to four position's the person applies for. </p>\n\n<p>[Position Applied For] Fields:</p>\n\n<ol>\n<li>ID (PK)</li>\n<li>Personal ID (FK)</li>\n<li>List item</li>\n<li>Resume Source Internal</li>\n<li>Personal Reference Name</li>\n<li>Job Board</li>\n<li>Position Applied For</li>\n<li>Date of Submission</li>\n</ol>\n"}, {"tags": ["excel", "vba", "file", "directory", "filesystemobject"], "comments": [{"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1468421575, "post_id": 38354947, "comment_id": 64122480, "body": "Nothing wrong. It retrieves all xl files correctly."}, {"owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "reply_to_user": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1468421699, "post_id": 38354947, "comment_id": 64122583, "body": "add some pdf to your folders and sub folders along with excel files and try again..main problem is with subfolders with different or pdf files.."}], "answers": [{"comments": [{"owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "edited": false, "score": 0, "creation_date": 1468422163, "post_id": 38355259, "comment_id": 64122914, "body": "Thanks ..i forget to change there. I have two versions of this code."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "edited": false, "score": 0, "creation_date": 1468422479, "post_id": 38355259, "comment_id": 64123143, "body": "It happens sometimes."}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 0, "last_activity_date": 1468421931, "creation_date": 1468421931, "answer_id": 38355259, "question_id": 38354947, "link": "https://stackoverflow.com/questions/38354947/using-vba-filesystemobject-specific-file-file-extension/38355259#38355259", "title": "Using VBA FileSystemObject, specific file File extension", "body": "<p>Add the below code after <code>For Each SubFolder In SourceFolder.SubFolders</code></p>\n\n<pre><code>Call List_XL_Files(SheetName, SubFolder.Path, True)\n</code></pre>\n\n<p>It will work</p>\n"}], "owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15650, "favorite_count": 0, "accepted_answer_id": 38355259, "answer_count": 1, "score": 2, "last_activity_date": 1468421931, "creation_date": 1468421188, "last_edit_date": 1468421455, "question_id": 38354947, "link": "https://stackoverflow.com/questions/38354947/using-vba-filesystemobject-specific-file-file-extension", "title": "Using VBA FileSystemObject, specific file File extension", "body": "<p>I'm using the following code to list all files with xls,xlsx or xlsm extension from folder and its subfolder.  The following code works but the problem is, it lists all files with all extensions from subfolders but lists only excel files from main folder.  I can not figure out whats wrong with this code.  Could you please help me?</p>\n\n<pre><code>Sub List_XL_Files(ByVal SheetName As String, ByVal SourceFolderName As String, ByVal IncludeSubfolders As Boolean)\n\nDim FSO As Object\nDim SourceFolder As Object\nDim SubFolder As Object\nDim FileItem As Object\nDim lRoMa As Long\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet SourceFolder = FSO.GetFolder(SourceFolderName)\n\nlRoMa = ThisWorkbook.Sheets(SheetName).Cells(Rows.Count, 2).End(xlUp).Row + 1\nReDim arrFolders(ctr)\n\nWith ThisWorkbook.Sheets(SheetName)\n    For Each FileItem In SourceFolder.Files\n           strFileExt = FSO.GetExtensionName(FileItem)\n           If strFileExt = \"xlsm\" Or strFileExt = \"xlsx\" Or strFileExt = \"xls\" Then\n                MsgBox strFileExt\n                .Cells(lRoMa + r, 1).Value = lRoMa + r - 7\n                .Cells(lRoMa + r, 2).Formula = strFileExt\n                .Cells(lRoMa + r, 3).Formula = FileItem.Name\n                .Cells(lRoMa + r, 4).Formula = FileItem.Path\n                .Cells(lRoMa + r, 5).Value = \"-\"\n                .Cells(lRoMa + r, 6).Value = \"\"\n                .Cells(lRoMa + r, 7).Value = \"\"\n                 r = r + 1                                      ' next row number\n                 X = SourceFolder.Path\n           End If\n    Next FileItem\nEnd With\n\nIf IncludeSubfolders Then\n    For Each SubFolder In SourceFolder.SubFolders\n        ListFilesInFolder SheetName, SubFolder.Path, True\n    Next SubFolder\nEnd If\n\nSet FileItem = Nothing\nSet SourceFolder = Nothing\nSet FSO = Nothing\n\nEnd sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1468421023, "post_id": 38354742, "comment_id": 64122044, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Don&#39;t use <code>.Select</code></a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468421221, "post_id": 38354742, "comment_id": 64122186, "body": "combine some things, look at the Return of the function in the help file, for example, three lines to delete the row, could be <code>activecell.offset(1,0).entirerow.delete</code>, I think that could go to <code>activecell.entirerow.delete</code> <code>Actvecell.offset(1,0).copy</code> too and   Use <code>.End(xlDown)</code> instead of the do while loop. and yes, avoid select"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1468422850, "post_id": 38354742, "comment_id": 64123427, "body": "Also, as a way to speed it up quickly, turn off screen updating.  Near the top of your macro, add <code>Application.ScreenUpdating = False</code> and at the end (before <code>End Sub</code>), add <code>Application.ScreenUpdating = True</code>."}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "edited": false, "score": 0, "creation_date": 1468432241, "post_id": 38356737, "comment_id": 64129367, "body": "You&#39;ve got <code>.ScreenUpdating = False</code> and <code>.Calculation = xlCalculationManual</code> at the end. I think they should be <code>.ScreenUpdating = True</code> and <code>.Calculation = xlCalculationAutomatic</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "edited": false, "score": 0, "creation_date": 1468433149, "post_id": 38356737, "comment_id": 64129978, "body": "Thanks Chris.  I got side tracked."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1468433009, "last_edit_date": 1468433009, "creation_date": 1468426099, "answer_id": 38356737, "question_id": 38354742, "link": "https://stackoverflow.com/questions/38354742/i-think-my-vba-excel-code-is-very-inefficient/38356737#38356737", "title": "I think my VBA Excel code is very inefficient", "body": "<p>It would be more efficient to collect the information in memory, delete all the rows at once, then copy the information back.<br>\n Here I add a Dictionary of Products to a Dictionary Customers.  To process the customers and products.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/77bUg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/77bUg.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub CombineCustomerProducts()\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    Dim k As String\n    Dim arr, key\n\n    Dim lastRow As Long, x As Long\n    Dim dictCustomers As Object, dictProducts\n\n    Set dictCustomers = CreateObject(\"Scripting.Dictionary\")\n\n    lastRow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n    For x = 2 To lastRow\n        k = Cells(x, 2)\n\n        If Cells(x, 2).Value &lt;&gt; \"\" Then\n         k = CStr(x)\n         Set dictProducts = CreateObject(\"Scripting.Dictionary\")\n\n         dictProducts.Add \"Key:\" &amp; dictProducts.Count, Cells(x, 1).Value\n         dictProducts.Add \"Key:\" &amp; dictProducts.Count, Cells(x, 2).Value\n\n         dictCustomers.Add k, dictProducts\n\n        End If\n\n        dictProducts.Add \"Key:\" &amp; dictProducts.Count, Cells(x, 3).Value\n\n    Next\n\n    Range(\"C2\", Range(\"C\" &amp; Rows.Count).End(xlUp)).EntireRow.Delete\n\n    x = 1\n\n    For Each key In dictCustomers.Keys\n        x = x + 1\n        Set dictProducts = dictCustomers(key)\n        arr = dictProducts.Items\n        Cells(x, 1).Resize(1, UBound(arr) + 1) = arr\n    Next\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1468433009, "creation_date": 1468420673, "last_edit_date": 1468421017, "question_id": 38354742, "link": "https://stackoverflow.com/questions/38354742/i-think-my-vba-excel-code-is-very-inefficient", "title": "I think my VBA Excel code is very inefficient", "body": "<p>I have a list of customer IDs (column B) and purchased products (column C). If the customer has bought more than one product, the cells beneath the customer ID are blank whilst col B lists on each row one product, until it runs out of purchased products for that customer. I want all of the products a customer has purchased in one row though, alongside their ID. (Column A is just a simple helper column, with a non-empty cell for each row of the table).</p>\n\n<p>Code is not my natural area of expertise, but I wrote the below very simple macro to move all the products onto single rows, and delete the empty rows afterwards. However it's slow - it takes about a minute per 1,000 rows, and I have several hundred thousand rows to go through.</p>\n\n<p>Is there any way to make it more efficient?</p>\n\n<pre><code>Sub RearrangeforR()\n\n    Range(\"B1\").Select\n\n    Do While IsEmpty(Cells(ActiveCell.Row, 1)) = False\n\n    If IsEmpty(ActiveCell) = True Then\n\n        ActiveCell.Offset(0, 1).Select\n\n        Selection.Copy\n\n        ActiveCell.Offset(-1, 0).Select\n\n            Do While IsEmpty(ActiveCell) = False\n\n            ActiveCell.Offset(0, 1).Select\n\n            Loop\n\n        ActiveCell.PasteSpecial\n\n        ActiveCell.Offset(1, 0).Select\n\n        ActiveCell.EntireRow.Delete\n\n        Cells(ActiveCell.Row, \"B\").Select\n\n    Else: ActiveCell.Offset(1, 0).Select\n\n    End If\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 121, "user_id": 5656179, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7d25b3c1db7b29e08acd57fdeb42d30?s=128&d=identicon&r=PG&f=1", "display_name": "Rukgo", "link": "https://stackoverflow.com/users/5656179/rukgo"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468420907, "post_id": 38354626, "comment_id": 64121953, "body": "I tried a DoCmd.Rename though with changing file names I was not sure how to include a LIKE into that. I also have a loop that deleted import error tables."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468421099, "post_id": 38354626, "comment_id": 64122100, "body": "Have a table, say tblMatrix, then you can have the part word, so say SSI and then the table name, so SSI_Data, then you can check the file name in this table and return, using docmd.transferspreadsheet.  Not in access at mo, so not 100% sure, this is probably where I&#39;d start <a href=\"https://msdn.microsoft.com/en-us/library/office/ff844793.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff844793.aspx</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1468424915, "post_id": 38354626, "comment_id": 64124883, "body": "<code>DoCmd.Rename strNewName, acTable, strOldName</code> works. I&#39;m not sure what the actual problem is you have."}, {"owner": {"reputation": 121, "user_id": 5656179, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7d25b3c1db7b29e08acd57fdeb42d30?s=128&d=identicon&r=PG&f=1", "display_name": "Rukgo", "link": "https://stackoverflow.com/users/5656179/rukgo"}, "edited": false, "score": 0, "creation_date": 1468427026, "post_id": 38354626, "comment_id": 64126303, "body": "If strOldName changes every week when I import a file with dates in it"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5656179, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7d25b3c1db7b29e08acd57fdeb42d30?s=128&d=identicon&r=PG&f=1", "display_name": "Rukgo", "link": "https://stackoverflow.com/users/5656179/rukgo"}, "edited": false, "score": 0, "creation_date": 1468422026, "post_id": 38354777, "comment_id": 64122809, "body": "So there is no fairly simple way to go about this then?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 121, "user_id": 5656179, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7d25b3c1db7b29e08acd57fdeb42d30?s=128&d=identicon&r=PG&f=1", "display_name": "Rukgo", "link": "https://stackoverflow.com/users/5656179/rukgo"}, "edited": false, "score": 0, "creation_date": 1468427072, "post_id": 38354777, "comment_id": 64126330, "body": "Not with a macro, I think, but I don&#39;t do macros."}, {"owner": {"reputation": 121, "user_id": 5656179, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7d25b3c1db7b29e08acd57fdeb42d30?s=128&d=identicon&r=PG&f=1", "display_name": "Rukgo", "link": "https://stackoverflow.com/users/5656179/rukgo"}, "edited": false, "score": 0, "creation_date": 1468429641, "post_id": 38354777, "comment_id": 64127797, "body": "When you say macro that includes the VBA coding aspect correct?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 121, "user_id": 5656179, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7d25b3c1db7b29e08acd57fdeb42d30?s=128&d=identicon&r=PG&f=1", "display_name": "Rukgo", "link": "https://stackoverflow.com/users/5656179/rukgo"}, "edited": false, "score": 0, "creation_date": 1468485900, "post_id": 38354777, "comment_id": 64149970, "body": "No, macros and VBA are two different things. But I can see that @Andre already provided the method for renaming a table."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1468420746, "creation_date": 1468420746, "answer_id": 38354777, "question_id": 38354626, "link": "https://stackoverflow.com/questions/38354626/changing-access-table-names-with-vba/38354777#38354777", "title": "Changing Access table names with VBA", "body": "<p>It would be much easier to rename the files before you import them.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1468534907, "creation_date": 1468534907, "answer_id": 38385163, "question_id": 38354626, "link": "https://stackoverflow.com/questions/38354626/changing-access-table-names-with-vba/38385163#38385163", "title": "Changing Access table names with VBA", "body": "<p>Something like this should do the job.</p>\n\n<pre><code>Dim dbCurr As DAO.Database\nDim tdfCurr As DAO.TableDef\n\nSet dbCurr = CurrentDb()\nFor Each tdfCurr In dbCurr.TableDefs\nIf Left$(tdfCurr.Name, 4) = \"dbo_\" Then\ntdfCurr.Name = Mid$(tdfCurr.Name, 5)\nEnd If\nNext tdfCurr\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 5656179, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7d25b3c1db7b29e08acd57fdeb42d30?s=128&d=identicon&r=PG&f=1", "display_name": "Rukgo", "link": "https://stackoverflow.com/users/5656179/rukgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1493, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1468534907, "creation_date": 1468420390, "last_edit_date": 1468421059, "question_id": 38354626, "link": "https://stackoverflow.com/questions/38354626/changing-access-table-names-with-vba", "title": "Changing Access table names with VBA", "body": "<p>I have a few tables that I import using a macro and then run some SQL queries, currently I have to rename the files before I import them and would like to automatically change their names after import.</p>\n\n<p>For example I have a file called <code>SSIReport()</code> and would like to change this table to <code>SSI_Data</code>. One issue is that within the brackets of SSIReport is a date of when the file is generated so it changes.\nHere is a little bit of code I currently use to delete import error tables, I am unsure if there is a way to convert this into rename tables.</p>\n\n<pre><code>For Each otable In CurrentDb.TableDefs\nIf otable.Name Like \"*ImportErrors*\" Then\nCurrentDb.TableDefs.Delete otable.Name\nEnd If\nNext otable\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "indices"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468420156, "post_id": 38354505, "comment_id": 64121353, "body": "can you post what you&#39;ve tried pleas."}, {"owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "edited": false, "score": 0, "creation_date": 1468420266, "post_id": 38354505, "comment_id": 64121436, "body": "What are names of your Sheets? Are they like Sheet1, Sheet2, Sheet3... or Random words?"}], "answers": [{"tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 0, "last_activity_date": 1468420257, "creation_date": 1468420257, "answer_id": 38354573, "question_id": 38354505, "link": "https://stackoverflow.com/questions/38354505/delete-every-second-and-third-sheet-in-a-workbook-using-vba/38354573#38354573", "title": "Delete every second and third sheet in a workbook using VBA", "body": "<p>Loop from the end to the beginning instead of beginning to end (always good practice when deleting things from a list in <em>any</em> coding language)</p>\n\n<p>Just keep a counter running as you go that counts up to three and resets, making sure first that it is set properly to act on the last sheet (aka figure out with math whether that last sheet would be a \"1st\", \"2nd\", or \"3rd\" sheet)</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 5817976, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/78a4bfdcd01b164b5ae1a93c09520da7?s=128&d=identicon&r=PG&f=1", "display_name": "Nechama", "link": "https://stackoverflow.com/users/5817976/nechama"}, "edited": false, "score": 0, "creation_date": 1468432929, "post_id": 38355076, "comment_id": 64129831, "body": "brilliant. Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 3, "last_activity_date": 1468421497, "creation_date": 1468421497, "answer_id": 38355076, "question_id": 38354505, "link": "https://stackoverflow.com/questions/38354505/delete-every-second-and-third-sheet-in-a-workbook-using-vba/38355076#38355076", "title": "Delete every second and third sheet in a workbook using VBA", "body": "<p>RGA is right you should loop from last to first when deleting.  Index mod 3 will return 1 for 1, 4, 7, 10 , 13, 16 .ect.</p>\n\n<pre><code>Sub DeleteEvery2ndAnd3rdSheet()\n   Application.DisplayAlerts = False\n\n    Dim i As Integer\n    For i = Worksheets.Count To 1 Step -1\n        If i Mod 3 &lt;&gt; 1 Then Worksheets(i).Delete\n    Next\n\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1468423282, "post_id": 38355222, "comment_id": 64123760, "body": "This is certainly the approach I would go for, delete in one swift move B-)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1468421827, "creation_date": 1468421827, "answer_id": 38355222, "question_id": 38354505, "link": "https://stackoverflow.com/questions/38354505/delete-every-second-and-third-sheet-in-a-workbook-using-vba/38355222#38355222", "title": "Delete every second and third sheet in a workbook using VBA", "body": "<p>While Thomas' answer may be the way to go, here is another approach that will only run the <code>Delete</code> statement once. </p>\n\n<pre><code>Sub Delete2nd3rdSheets()\n\nDim sSheetsToRemove As String\nDim i As Integer\n\nDim ws As Worksheet\nFor Each ws In ThisWorkbook.Worksheets\n\n    If ws.Index Mod 3 &lt;&gt; 1 Then\n        sSheetsToRemove = sSheetsToRemove &amp; \",\" &amp; ws.Name\n    End If\n\nNext\n\nsSheetsToRemove = Mid(sSheetsToRemove, 2)\n\nDim arrDeleteSheets() As String\narrDeleteSheets = Split(sSheetsToRemove, \",\")\n\nApplication.DisplayAlerts = False\nWorksheets(arrDeleteSheets).Delete\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5817976, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/78a4bfdcd01b164b5ae1a93c09520da7?s=128&d=identicon&r=PG&f=1", "display_name": "Nechama", "link": "https://stackoverflow.com/users/5817976/nechama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1468421827, "creation_date": 1468420086, "last_edit_date": 1531164843, "question_id": 38354505, "link": "https://stackoverflow.com/questions/38354505/delete-every-second-and-third-sheet-in-a-workbook-using-vba", "title": "Delete every second and third sheet in a workbook using VBA", "body": "<p>Im looking to delete second and third sheet in a workbook with hundreds of sheets. So, keep sheets 1,4,7,10... and delete the rest</p>\n\n<p>I'm running into issues because the indices reset with every sheet I delete so looping with i's is presenting a problem.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-word", "treeview"], "comments": [{"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1468419858, "post_id": 38354380, "comment_id": 64121132, "body": "Initialise i before using, also is the nodes array base 1 or 0?  i should be set accordingly."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468420106, "post_id": 38354380, "comment_id": 64121319, "body": "you&#39;re using a loop, which returns an object from a collection, then referring to the collection with an incremented variable.  objNode is redundant or I is, pick a suitable method, objNode.Remove or controls.nodes(I).remove"}, {"owner": {"reputation": 65, "user_id": 2823911, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d9f74ca2c49eb20674452fb19c3a2cb?s=128&d=identicon&r=PG&f=1", "display_name": "white_flag", "link": "https://stackoverflow.com/users/2823911/white-flag"}, "edited": false, "score": 0, "creation_date": 1468420767, "post_id": 38354380, "comment_id": 64121838, "body": "I mean,the error is coming after one item is removed (the length of loop is change&#39;t)"}, {"owner": {"reputation": 65, "user_id": 2823911, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d9f74ca2c49eb20674452fb19c3a2cb?s=128&d=identicon&r=PG&f=1", "display_name": "white_flag", "link": "https://stackoverflow.com/users/2823911/white-flag"}, "edited": false, "score": 0, "creation_date": 1468421076, "post_id": 38354380, "comment_id": 64122084, "body": "If I use <code>objNode.Remove</code> I received error &#39;438&#39; - object doesn&#39;t support this property or method"}, {"owner": {"reputation": 65, "user_id": 2823911, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d9f74ca2c49eb20674452fb19c3a2cb?s=128&d=identicon&r=PG&f=1", "display_name": "white_flag", "link": "https://stackoverflow.com/users/2823911/white-flag"}, "edited": false, "score": 0, "creation_date": 1468421236, "post_id": 38354380, "comment_id": 64122200, "body": "If I used <code>Me.TreeView1.Nodes(i).Remove</code> I have Method or data member not found."}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 2823911, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d9f74ca2c49eb20674452fb19c3a2cb?s=128&d=identicon&r=PG&f=1", "display_name": "white_flag", "link": "https://stackoverflow.com/users/2823911/white-flag"}, "is_accepted": false, "score": 0, "last_activity_date": 1468480461, "creation_date": 1468480461, "answer_id": 38367796, "question_id": 38354380, "link": "https://stackoverflow.com/questions/38354380/remove-non-checked-items-in-a-treeview/38367796#38367796", "title": "remove Non checked items in a treeview", "body": "<p>I putted like this (and it is good for me):</p>\n\n<pre><code>Dim i As Integer\nFor i = Me.TreeView1.Nodes.Count To 1 Step -1\n    If Me.TreeView1.Nodes(i).Checked = False Then Me.TreeView1.Nodes.Remove (i)\nNext i\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 2823911, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d9f74ca2c49eb20674452fb19c3a2cb?s=128&d=identicon&r=PG&f=1", "display_name": "white_flag", "link": "https://stackoverflow.com/users/2823911/white-flag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1468495767, "creation_date": 1468419783, "last_edit_date": 1468495767, "question_id": 38354380, "link": "https://stackoverflow.com/questions/38354380/remove-non-checked-items-in-a-treeview", "title": "remove Non checked items in a treeview", "body": "<p>I have an treeview controller with checkboxes. I like to loop through this controller and to do the following: delete all non checked items.</p>\n\n<p>my code (witch is not working) I received error 92 - For loop not initialized</p>\n\n<pre><code>Dim objNode As Node\nDim i As Integer\n\nFor Each objNode In Me.TreeView1.Nodes\ni = i + 1\n    If Me.TreeView1.Nodes(i).Checked = False Then Me.TreeView1.Nodes.Remove (i)\nNext\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468577522, "post_id": 38392724, "comment_id": 64195515, "body": "The sheet is not the best formatted in the world which has led us to the Macro we are using.  We need to be able to select where the new row is inputted then it will copy all the formula and formatting from above.  I can seen you a screen print if i new how too."}, {"owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468831737, "post_id": 38392724, "comment_id": 64270250, "body": "How can i do that?"}, {"owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468926348, "post_id": 38392724, "comment_id": 64317475, "body": "Would adding a .delete into the last line of code work?  So it then deletes the text in Column. S, V, W, X, Y, Z, AB, AD, AF, AI, AJ, AK of the new inserted row?"}], "tags": [], "owner": {"reputation": 56, "user_id": 3144505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc907c7947ecb936ec76c657357aa886?s=128&d=identicon&r=PG", "display_name": "Divyesh M.", "link": "https://stackoverflow.com/users/3144505/divyesh-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1468575284, "creation_date": 1468575284, "answer_id": 38392724, "question_id": 38354347, "link": "https://stackoverflow.com/questions/38354347/copy-formula-and-formatting/38392724#38392724", "title": "Copy formula and formatting", "body": "<pre><code>    For Each ShipWs In ShipmentWbObj.Worksheets\n    If ShipWs.name &lt;&gt; \"SAMPLE_FORMAT\" And ShipWs.name &lt;&gt; \"Transportercodes\" Then\n        Set ShipWsUsedrange = ShipWs.UsedRange\n        Set DataRange = Application.Intersect(ShipWsUsedrange, ShipWsUsedrange.Offset(1, 0))\n        If Not DataRange Is Nothing Then\n            SampleFormat.Rows(2).Copy\n            DataRange.PasteSpecial xlPasteFormats, xlPasteSpecialOperationNone, False, False\n            DataRange.PasteSpecial xlPasteFormulas, xlPasteSpecialOperationNone, False, False\n            Application.CutCopyMode = False\n        Endif\n    Endif\nNext\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468575284, "creation_date": 1468419703, "question_id": 38354347, "link": "https://stackoverflow.com/questions/38354347/copy-formula-and-formatting", "title": "Copy formula and formatting", "body": "<p>How can i make the bellow only copy the Formula and formatting not the text?</p>\n\n<pre><code>Sub Loop_InsertRowsandFormulas()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Risk Input Sheet\")\nDim vRows As Long\nDim lastCol As Long\nDim firstRow As Long\n\nfirstRow = InputBox(\"Enter Row To Start Insert From.\")\nvRows = InputBox(\"Enter Number Of Rows Required\")\n\nIf firstRow = 0 Or vRows = 0 Then Exit Sub\nDebug.Print firstRow\nIngA = ws.Cells(5, ws.Columns.Count).End(xlToLeft).Column\nFor Myloop = 1 To vRows\n    ws.Range(\"A\" &amp; (firstRow + Myloop)).EntireRow.Insert\n    ws.Range(\"N\" &amp; (firstRow) &amp; \":AW\" &amp; (firstRow + Myloop)).FillDown\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "shape"], "comments": [{"owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "edited": false, "score": 0, "creation_date": 1468419620, "post_id": 38354158, "comment_id": 64120896, "body": "Can&#39;t you just work with the <code>.Height</code> property of the object?"}], "answers": [{"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 0, "last_activity_date": 1468420233, "last_edit_date": 1468420233, "creation_date": 1468419783, "answer_id": 38354381, "question_id": 38354158, "link": "https://stackoverflow.com/questions/38354158/excel-vba-resize-group/38354381#38354381", "title": "Excel VBA Resize group", "body": "<p>Set shape properties to Don't move or size with cells</p>\n\n<pre><code>Shapes(\"YourShapename\").Placement = xlFreeFloating\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4555954, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b8994d5a9ead529ab26f75ff112767e9?s=128&d=identicon&r=PG&f=1", "display_name": "Aidan Williamson", "link": "https://stackoverflow.com/users/4555954/aidan-williamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 38354381, "answer_count": 1, "score": 0, "last_activity_date": 1468421246, "creation_date": 1468419229, "last_edit_date": 1468421246, "question_id": 38354158, "link": "https://stackoverflow.com/questions/38354158/excel-vba-resize-group", "title": "Excel VBA Resize group", "body": "<p>After executing some deleting rows in VBA, a shape size (group) changes height, but is there a way to do this in VBA rather than in the sheet itself. I've assigned it a Macro (Group1), but I am uncertain what to do next.  Any suggestions?</p>\n"}, {"tags": ["vba", "startup", "msgbox"], "answers": [{"tags": [], "owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "is_accepted": false, "score": 0, "last_activity_date": 1468419400, "creation_date": 1468419400, "answer_id": 38354223, "question_id": 38354131, "link": "https://stackoverflow.com/questions/38354131/first-time-start-up-mgsbox-in-vb/38354223#38354223", "title": "first time start up mgsbox in VB", "body": "<p>What you can try is to save a value in a cell (Let's say A1000):</p>\n\n<pre><code>Private Sub UserFrom1_Initialize()\n    If Worksheets(\"Sheet1\").Range(\"A1000\") = \"\" Then\n        MsgBox(\"Welcome to your frist time using this!\")\n        Worksheets(\"Sheet1\").Range(\"A1000\") = \"0\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>You can also store the information in a hidden worksheet, if you don't want it to be seen by everyone.</p>\n"}], "owner": {"reputation": 1, "user_id": 6576742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb76f5f09d20abf121b17761776bca9b?s=128&d=identicon&r=PG&f=1", "display_name": "nightfire2015", "link": "https://stackoverflow.com/users/6576742/nightfire2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468419400, "creation_date": 1468419165, "question_id": 38354131, "link": "https://stackoverflow.com/questions/38354131/first-time-start-up-mgsbox-in-vb", "title": "first time start up mgsbox in VB", "body": "<p>hello is there a way to have a msgbox to appear when form1 loads for the first time? So if I opened the program again that msgbox would not appear again.</p>\n\n<p>thanks for any help</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468419412, "post_id": 38354080, "comment_id": 64120725, "body": "What doesn&#39;t work?  Does it give you an error or does it not work as expected?"}, {"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1468419521, "post_id": 38354080, "comment_id": 64120811, "body": "You&#39;re looping with a variable <code>i</code> but you don&#39;t use that variable anywhere in the code inside the loop, so you&#39;re just doing the same thing multiple times. If there are fewer than 4 worksheets then the code inside the loop will never execute."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1468427535, "post_id": 38354080, "comment_id": 64126589, "body": "@Flower_Dance you wrote <code>Workbooks(&quot;finding Summary.xlsm&quot;).Sheets(&quot;Sheet1&quot;).Range(3, 1).Value=Workbooks(&quot;Finding_Master Summary and Response Template.xlsm&quot;).Sheets(&quot;Response Template&quot;).Range(54, 1).Value</code> , which means you are giving it Cell A54 , is it on purpose ? and not B54 ?"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1468427879, "creation_date": 1468427879, "answer_id": 38357280, "question_id": 38354080, "link": "https://stackoverflow.com/questions/38354080/vba-copy-value-from-one-workbook-to-another/38357280#38357280", "title": "VBA copy value from one workbook to another", "body": "<p>Try the following code:</p>\n\n<pre><code>Option Explicit\n\nSub WorksheetLoop()\n\n    Dim WS_Count As Integer\n    Dim i As Integer\n\n    ' Set WS_Count equal to the number of worksheets in the active workbook.\n    WS_Count = ActiveWorkbook.Worksheets.count\n\n   ' Begin the loop.\n    For i = 4 To WS_Count\n       If Workbooks(\"Finding_Master Summary and Response Template.xlsm\").Worksheets(i).Cells(54, 2).Value = \"No\" Then\n          Workbooks(\"finding Summary.xlsm\").Worksheets(\"Sheet1\").Cells(3, 1).Value = Workbooks(\"Finding_Master Summary and Response Template.xlsm\").Worksheets(\"Response Template\").Cells(54, 1).Value\n       End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6032786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce23403782e4fca53fdf4bfa21185e2?s=128&d=identicon&r=PG&f=1", "display_name": "Flower_Dance", "link": "https://stackoverflow.com/users/6032786/flower-dance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468427879, "creation_date": 1468419043, "last_edit_date": 1531164843, "question_id": 38354080, "link": "https://stackoverflow.com/questions/38354080/vba-copy-value-from-one-workbook-to-another", "title": "VBA copy value from one workbook to another", "body": "<p>I would like to copy a cell value from one workbook to another if the cell B54 is \"No\", but my code does not work.</p>\n\n<pre><code>Option Explicit\n\nSub WorksheetLoop()\nDim WS_Count As Integer\nDim i As Integer\n\n' Set WS_Count equal to the number of worksheets in the active workbook.\nWS_Count = ActiveWorkbook.Worksheets.Count\n\n' Begin the loop.\nFor i = 4 To WS_Count\n   If Workbooks(\"Finding_Master Summary and Response Template.xlsm\").Worksheets(i).Range(54, 2).Value = \"No\" Then\n      Workbooks(\"finding Summary.xlsm\").Sheets(\"Sheet1\").Range(3, 1).Value = Workbooks(\"Finding_Master Summary and Response Template.xlsm\").Sheets(\"Response Template\").Range(54, 1).Value\n   End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>And this line does not work</p>\n\n<pre><code>Workbooks(\"finding Summary.xlsm\").Sheets(\"Sheet1\").Range(3, 1).Value=Workbooks(\"Finding_Master Summary and Response Template.xlsm\").Sheets(\"Response Template\").Range(54, 1).Value\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468418722, "post_id": 38353812, "comment_id": 64120214, "body": "I&#39;m not sure you can do it like that as you&#39;re looking for the full string, the &amp; concatenates them like &quot;test;examp &amp; pay; possible fake&quot; which is what you&#39;ll look for, I think you&#39;ll need to run more than one instr."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1468419027, "post_id": 38353812, "comment_id": 64120431, "body": "Duplicate of <a href=\"http://stackoverflow.com/questions/38353529/my-instr-keeps-telling-me-its-mismatched\" title=\"my instr keeps telling me its mismatched\">stackoverflow.com/questions/38353529/&hellip;</a> posted half hour earlier.  Was going to say exact duplicate but last three lines are different."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": -1, "last_activity_date": 1468419217, "last_edit_date": 1468419217, "creation_date": 1468418858, "answer_id": 38354017, "question_id": 38353812, "link": "https://stackoverflow.com/questions/38353812/my-instr-is-always-returning-0/38354017#38354017", "title": "My InStr is always returning 0", "body": "<p><code>englishResult = InStr(1,  rowValue,\"test\", CompareMethod.Text)\nif englishResult=0 then englishResult = InStr(1,rowValue,  \"exam &amp; pay\", CompareMethod.Text)\nif englishResult=0 then englishResult = InStr(1, rowValue, \" possible fake\",  rowValue,CompareMethod.Text)</code></p>\n"}, {"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 2, "last_activity_date": 1468419095, "creation_date": 1468419095, "answer_id": 38354102, "question_id": 38353812, "link": "https://stackoverflow.com/questions/38353812/my-instr-is-always-returning-0/38354102#38354102", "title": "My InStr is always returning 0", "body": "<p>not sure about Access.. but the Instr method works in Excel VBA with a master string before the search string so </p>\n\n<p><code>InStr(1,englishReasonsToGoToSecondFloor, rowValue , CompareMethod.Text)</code> this should work.</p>\n"}, {"comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1468424809, "post_id": 38354192, "comment_id": 64124803, "body": "For the sake of future readers, can you explain why this solve the problem?"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1468474584, "last_edit_date": 1468474584, "creation_date": 1468419323, "answer_id": 38354192, "question_id": 38353812, "link": "https://stackoverflow.com/questions/38353812/my-instr-is-always-returning-0/38354192#38354192", "title": "My InStr is always returning 0", "body": "<p>it should be like below</p>\n\n<pre><code>englishResult = InStr(1, englishReasonsToGoToSecondFloor, rowValue, CompareMethod.Text)\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>The Syntax for Instr function is</p>\n\n<pre><code>InStr( [Start], String1, String2, [Compare] )\n</code></pre>\n\n<blockquote>\n  <p>where,</p>\n  \n  <p>[Start]    -   An optional integer argument, representing the position that you want to start searching from. If omitted, the [Start] argument takes on the default value of 1.</p>\n  \n  <p>String1    -   The string that you want to search.</p>\n  \n  <p>String2    -   The substring that you want to search for.</p>\n  \n  <p>[Compare]  -   An optional argument, specifying the type of comparison to make.\n  This can be any of the following values:</p>\n  \n  <p>vbBinaryCompare    -   performs a binary comparison</p>\n  \n  <p>vbTextCompare  -   performs a text comparison</p>\n  \n  <p>vbDatabaseCompare  -   performs a database comparison</p>\n  \n  <blockquote>\n    <p>If omitted, the [Compare] argument takes on the default value vbBinaryCompare.</p>\n  </blockquote>\n</blockquote>\n"}], "owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 38354192, "answer_count": 3, "score": 0, "last_activity_date": 1468474584, "creation_date": 1468418329, "question_id": 38353812, "link": "https://stackoverflow.com/questions/38353812/my-instr-is-always-returning-0", "title": "My InStr is always returning 0", "body": "<pre><code> englishReasonsToGoToSecondFloor = \"test\" &amp; \";\" &amp; \"exam &amp; pay\" &amp; \";\" &amp; \" possible fake\"\n</code></pre>\n\n<p>So my values may contain a <strong>&amp;</strong> or (space) or just a single word. Each item is separated by a \";\"</p>\n\n<p>so the final list will look like \"test;exam &amp; pay;possible fake\" (the real list is much longer)</p>\n\n<p>When the user selects an item from the Listbox, I want to quickly compare the selection with the words in the variable (if there is a better way to compare, please let me know)</p>\n\n<pre><code>rowValue = Trim(listboxTest.Column(1))\nenglishResult = InStr(1, rowValue, englishReasonsToGoToSecondFloor, CompareMethod.Text)\n</code></pre>\n\n<p>I can mouse over the rowValue and I see there is a value.</p>\n\n<pre><code>rowValue contains \"possible fake\"\n</code></pre>\n\n<p>but the englishResult is always 0</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "password-protection"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1468419542, "post_id": 38353751, "comment_id": 64120829, "body": "That is just the way it is. You have to reset it in the <code>Open</code> event."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4804767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eacf62d8e15e112f692a125ff54064?s=128&d=identicon&r=PG&f=1", "display_name": "Pwi", "link": "https://stackoverflow.com/users/4804767/pwi"}, "edited": false, "score": 0, "creation_date": 1468418500, "post_id": 38353796, "comment_id": 64120047, "body": "The Excel file has 15 sheets and doing protection in every time takes 10 second which is too much. I&#39; ve already experimenting with this."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 101, "user_id": 4804767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eacf62d8e15e112f692a125ff54064?s=128&d=identicon&r=PG&f=1", "display_name": "Pwi", "link": "https://stackoverflow.com/users/4804767/pwi"}, "edited": false, "score": 0, "creation_date": 1468418589, "post_id": 38353796, "comment_id": 64120122, "body": "@Pwi 10 seconds for 15 sheets??? I can&#39;t see how it would take that long if all you are doing is toggling protection.  I just tested it myself and it was essentially instantaneous.   Is there something else going on that might be slowing it down?"}, {"owner": {"reputation": 101, "user_id": 4804767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eacf62d8e15e112f692a125ff54064?s=128&d=identicon&r=PG&f=1", "display_name": "Pwi", "link": "https://stackoverflow.com/users/4804767/pwi"}, "edited": false, "score": 0, "creation_date": 1468418841, "post_id": 38353796, "comment_id": 64120292, "body": "I tried with a fully empty Workbook. Try with this code: <code>code:      For Each Sh In Worksheets         Sh.Protect Password:=&quot;passw&quot;, UserInterFaceOnly:=True     Next sh  &#47;code</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1468419494, "post_id": 38353796, "comment_id": 64120783, "body": "In Excel 2013 and up, the password algorithm was changed and it is a lot slower than it used to be."}, {"owner": {"reputation": 101, "user_id": 4804767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eacf62d8e15e112f692a125ff54064?s=128&d=identicon&r=PG&f=1", "display_name": "Pwi", "link": "https://stackoverflow.com/users/4804767/pwi"}, "edited": false, "score": 0, "creation_date": 1468419650, "post_id": 38353796, "comment_id": 64120930, "body": "Is there any way to protect sheet from user modifcation beside Protect/Unprotect method?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468419674, "post_id": 38353796, "comment_id": 64120952, "body": "@Rory for the first time in years, running 2010 is a good thing :)"}, {"owner": {"reputation": 101, "user_id": 4804767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eacf62d8e15e112f692a125ff54064?s=128&d=identicon&r=PG&f=1", "display_name": "Pwi", "link": "https://stackoverflow.com/users/4804767/pwi"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468419678, "post_id": 38353796, "comment_id": 64120956, "body": "@Rory I&#39;m using 2013, this is why happen"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1468419723, "post_id": 38353796, "comment_id": 64120991, "body": "@RGA Running 2010 is always a good thing IMO. Still the best version."}, {"owner": {"reputation": 101, "user_id": 4804767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eacf62d8e15e112f692a125ff54064?s=128&d=identicon&r=PG&f=1", "display_name": "Pwi", "link": "https://stackoverflow.com/users/4804767/pwi"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468419767, "post_id": 38353796, "comment_id": 64121038, "body": "@Rory Unfortunately i have no option running older version."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 101, "user_id": 4804767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eacf62d8e15e112f692a125ff54064?s=128&d=identicon&r=PG&f=1", "display_name": "Pwi", "link": "https://stackoverflow.com/users/4804767/pwi"}, "edited": false, "score": 0, "creation_date": 1468419831, "post_id": 38353796, "comment_id": 64121105, "body": "@Pwi You&#39;re stuck with what you have then."}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 1, "last_activity_date": 1468418290, "creation_date": 1468418290, "answer_id": 38353796, "question_id": 38353751, "link": "https://stackoverflow.com/questions/38353751/sheet-protection-userinterfaceonly-gone/38353796#38353796", "title": "Sheet protection: UserInterFaceOnly gone", "body": "<p>I'm not sure what the cause of that issue is, but you can circumvent it by adding protection code to the <code>Workbook_Open()</code> event, resetting every sheet protection to have <code>UserInterfaceOnly:=True</code> in each</p>\n"}, {"tags": [], "owner": {"reputation": 3489, "user_id": 2316433, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/SZibB.jpg?s=128&g=1", "display_name": "carlossierra", "link": "https://stackoverflow.com/users/2316433/carlossierra"}, "is_accepted": false, "score": 8, "last_activity_date": 1468502118, "last_edit_date": 1492087236, "creation_date": 1468502118, "answer_id": 38375298, "question_id": 38353751, "link": "https://stackoverflow.com/questions/38353751/sheet-protection-userinterfaceonly-gone/38375298#38375298", "title": "Sheet protection: UserInterFaceOnly gone", "body": "<p>You can't do it without reapplying <code>UserInterfaceOnly:=True</code> after reopening the workbook. Taken from Excel's Vb <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.protect(v=vs.100).aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-1\" rel=\"noreferrer\">protect</a> method reference:</p>\n\n<blockquote>\n  <p>If you apply this method with the UserInterfaceOnly argument set to true and then save the workbook, the entire worksheet (not just the interface) will be fully protected when you reopen the workbook. To re-enable the user interface protection after the workbook is opened, you must again apply this method with UserInterfaceOnly set to true</p>\n</blockquote>\n\n<p>Now, if your concern is that this takes too long (15 seconds, as you say), take a look at <a href=\"https://codereview.stackexchange.com/a/133650/103313\">this</a> Code Review answer. I have done this in several workbooks of varying level of complexity, and the time for reapplying protection is negligible in all versions I've tried, including 2010. </p>\n"}], "owner": {"reputation": 101, "user_id": 4804767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eacf62d8e15e112f692a125ff54064?s=128&d=identicon&r=PG&f=1", "display_name": "Pwi", "link": "https://stackoverflow.com/users/4804767/pwi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13102, "favorite_count": 1, "answer_count": 2, "score": 7, "last_activity_date": 1594837171, "creation_date": 1468418163, "last_edit_date": 1561708499, "question_id": 38353751, "link": "https://stackoverflow.com/questions/38353751/sheet-protection-userinterfaceonly-gone", "title": "Sheet protection: UserInterFaceOnly gone", "body": "<p>In VBA Excel if I protect sheets with  <code>UserInterFaceOnly:=True</code> option after I close and open the file again the <code>UserInterFaceOnly</code> mode is not active, only Password protection.</p>\n\n<p>The code: <code>ActiveSheet.Protect Password:=\"myPassword\", UserInterfaceOnly:=True</code></p>\n\n<p>Why?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 1, "creation_date": 1468417837, "post_id": 38353529, "comment_id": 64119540, "body": "<code>If Instr(1, &quot;String&quot;, &quot;Substring to search for&quot;, vbTextCompare) &gt; 0 Then</code> is the way I usually use InStr. I have never experienced an error with this"}], "answers": [{"comments": [{"owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "edited": false, "score": 0, "creation_date": 1468418017, "post_id": 38353656, "comment_id": 64119683, "body": "Thanks. I missed that so many times. I added the start position as 1. However the result is always 0 and I can see the result within string2 (since its hard-coded). Am I missing something else?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "edited": false, "score": 0, "creation_date": 1468418287, "post_id": 38353656, "comment_id": 64119893, "body": "See edit. My German reminder is &quot;DURCHsuchter string, GEsuchter string&quot;. :)"}, {"owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "edited": false, "score": 0, "creation_date": 1468418402, "post_id": 38353656, "comment_id": 64119973, "body": "I corrected my code to include a start string. but why swap rowValue with englishReasons...?"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 3, "last_activity_date": 1468418201, "last_edit_date": 1468418201, "creation_date": 1468417904, "answer_id": 38353656, "question_id": 38353529, "link": "https://stackoverflow.com/questions/38353529/my-instr-keeps-telling-me-its-mismatched/38353656#38353656", "title": "My InStr keeps telling me its mismatched", "body": "<p>Check the help for <code>InStr()</code>. Or <a href=\"https://support.office.com/en-us/article/InStr-Function-85d3392c-3b1c-4232-bb18-77cd0cb8a55b\" rel=\"nofollow\">here</a> .</p>\n\n<pre><code> InStr ([start, ] string1, string2 [, compare ] )\n</code></pre>\n\n<blockquote>\n  <p>The start argument is required if compare is specified.</p>\n</blockquote>\n\n<p>So leave out the <code>compare</code> argument, or supply <code>start</code>.</p>\n\n<p>And you have the string arguments mixed up (I need to remind myself of the correct order pretty often too).</p>\n\n<blockquote>\n  <p>string1 - Required. String expression being searched.<br>\n  string2 - Required. String expression sought.</p>\n</blockquote>\n\n<p>So you want</p>\n\n<pre><code>englishResult = InStr(1, englishReasonsToGoToSecondFloor, rowValue, vbTextCompare)\n</code></pre>\n"}], "owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 38353656, "answer_count": 1, "score": 1, "last_activity_date": 1468418201, "creation_date": 1468417545, "last_edit_date": 1468418049, "question_id": 38353529, "link": "https://stackoverflow.com/questions/38353529/my-instr-keeps-telling-me-its-mismatched", "title": "My InStr keeps telling me its mismatched", "body": "<pre><code> englishReasonsToGoToSecondFloor = \"test\" &amp; \";\" &amp; \"exam &amp; pay\" &amp; \";\" &amp; \" possible fake\"\n</code></pre>\n\n<p>So my values may contain a <strong>&amp;</strong> or (space) or just a single word. Each item is separated by a \";\"</p>\n\n<p>so the final list will look like \"test;exam &amp; pay;possible fake\"</p>\n\n<p>When the user selects an item from the Listbox, I want to quickly compare the selection with the words in the variable</p>\n\n<pre><code>rowValue = Trim(listboxTest.Column(1))\nenglishResult = InStr(rowValue, englishReasonsToGoToSecondFloor, CompareMethod.Text)\n</code></pre>\n\n<p>I can mouse over the rowValue and I see there is a value.</p>\n\n<p>I've also tried with </p>\n\n<pre><code>englishResult = InStr(rowValue, englishReasonsToGoToSecondFloor, vbTextCompare)\n</code></pre>\n\n<p>Error message is \"Run-time error '13'</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 2, "creation_date": 1468417857, "post_id": 38353471, "comment_id": 64119559, "body": "If it is consistent you could just go with (&quot;D&quot; &amp; Target.Row -1) if you don&#39;t hear back with a better answer as to why. ... also, I don&#39;t suppose you have a worksheet named email and another named emails and they are different by one row being offset? your line 5 references &quot;Email&quot; and your with block uses &quot;Emails&quot;"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1468418044, "post_id": 38353471, "comment_id": 64119702, "body": "Just FYI, you should add code to confirm that the <code>Target</code> is only a single cell, or this may throw an error if you were to select multiple cells"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1468418192, "post_id": 38353471, "comment_id": 64119831, "body": "Another FYI - if the user has a default signature already set up you can use the accepted answer in <a href=\"http://stackoverflow.com/questions/8994116/how-to-add-default-signature-in-outlook\">this question</a> which may help you."}, {"owner": {"reputation": 479, "user_id": 1617788, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/520166fcd7fc606f421657783d1adbda?s=128&d=identicon&r=PG", "display_name": "Grymjack", "link": "https://stackoverflow.com/users/1617788/grymjack"}, "edited": false, "score": 0, "creation_date": 1468420805, "post_id": 38353471, "comment_id": 64121865, "body": "Thanks for the replies.  Target -1 is working for now.  The &quot;Email&quot; &quot;Emails&quot; worksheet was a duplicate sheet I had for testing purposes.  As for the link pointing to the other solution, I tried that and the email composition window refused to come up.  Not sure why not as I don&#39;t have access to any Outlook dll errors that are throwing."}], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1468422716, "post_id": 38354055, "comment_id": 64123338, "body": "<b>Always</b> when working with Worksheet_change and target consider a loop because user may do so -unless you protect the sheet- <i>Private Sub Worksheet_Change(ByVal Target As Range)</i> <b>Dim ItemInRange as Range</b> For each ItemInRange in Target &#39;your code .... Next ItemInRange"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1468422886, "post_id": 38354055, "comment_id": 64123456, "body": "This is because user may delete multiple data and even it doesn&#39;t fall in your condition it will set an error exception due to target being only &quot;one <i>celled</i>&quot;"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1468418962, "creation_date": 1468418962, "answer_id": 38354055, "question_id": 38353471, "link": "https://stackoverflow.com/questions/38353471/target-row-not-working-right-in-vba/38354055#38354055", "title": "Target.Row not working right in VBA", "body": "<p>Use<code>Worksheet_Change</code> event and like RGA commented I would check to see if more then one cell is being changed.   </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n               ... Your Code.....\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 479, "user_id": 1617788, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/520166fcd7fc606f421657783d1adbda?s=128&d=identicon&r=PG", "display_name": "Grymjack", "link": "https://stackoverflow.com/users/1617788/grymjack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3497, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468418962, "creation_date": 1468417388, "last_edit_date": 1531164843, "question_id": 38353471, "link": "https://stackoverflow.com/questions/38353471/target-row-not-working-right-in-vba", "title": "Target.Row not working right in VBA", "body": "<p>Some weirdness I don't understand here.  Small routine here that launches an email composition window.  Target.Row is returning the correct row when clicked and concatenates correctly when done as a separate variable (see ??? section in middle).  When I use it directly within the 'With MItem' block it pulls the values from the next row of the spreadsheet, not the row indicated by the Target.Row value.  ex: row #3 is clicked on, and it loads the values from row #4.  When I use a pre-concatenated variable, it pulls the correct cell values.  Any ideas??  Thanks in advance for any help.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    ' checking to see if update number cell is picked\n    If Not Intersect(Target, Range(\"B3:B50\")) Is Nothing Then\n        ' testing for blank subject box\n        If (Worksheets(\"Email\").Range(\"C\" &amp; Target.Row).Value &lt;&gt; \"\") Then\n            ' initialize variables\n            Dim OutlookApp As Outlook.Application\n            Dim MItem As Outlook.MailItem\n            Dim sBlock As String\n\n\n            ' ????\n             Dim nTest As Integer\n             Dim sRange As String\n             nTest = Target.Row\n             sRange = \"C\" &amp; Target.Row                \n\n            ' creating html signature block\n            sBlock = \"&lt;br&gt;&lt;br&gt;&lt;font size=4&gt;Name Here&lt;/font&gt;&lt;br&gt;\"\n            sBlock = sBlock &amp; \"&lt;font size=2&gt;&lt;b&gt;Title&lt;/b&gt;&lt;br&gt;\"\n            sBlock = sBlock &amp; \"&lt;b&gt;phone 1&lt;/b&gt;&lt;br&gt;\"\n            sBlock = sBlock &amp; \"&lt;b&gt;phone 2&lt;/b&gt;&lt;/font&gt;&lt;br&gt;\"\n\n            'Create Outlook object\n            Set OutlookApp = New Outlook.Application\n\n            'Create Mail Item and view before sending\n            Set MItem = OutlookApp.CreateItem(olMailItem)\n            With MItem\n                .To = Worksheets(\"Emails\").Range(\"D\" &amp; Target.Row).Value\n                .Subject = Worksheets(\"Emails\").Range(\"C\" &amp; Target.Row).Value\n                .HTMLBody = Worksheets(\"Emails\").Range(\"E\" &amp; Target.Row).Value &amp; sBlock\n                .Display\n            End With\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement", "userform"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 4646183, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2533f4ceaa4201b23ff00c6534d65a58?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/4646183/megan"}, "edited": false, "score": 0, "creation_date": 1468417612, "post_id": 38353505, "comment_id": 64119348, "body": "Ah, I understand! Thanks for your help!"}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1468417489, "creation_date": 1468417489, "answer_id": 38353505, "question_id": 38353467, "link": "https://stackoverflow.com/questions/38353467/excel-vba-userform-if-not-isempty-then/38353505#38353505", "title": "Excel VBA UserForm- If Not IsEmpty Then", "body": "<p><code>IsEmpty</code> is used for arrays. use the below:</p>\n\n<pre><code>With ws3\n     If Not Me.SecondCompetitor.Value = \"\" Then 'This line could also be Me.SecondCompetitor.Value = vbNullString\n        .Cells(iRow3, 14).Value = Me.Ticker.Value\n        .Cells(iRow3, 2).Value = Me.Rec1.Value\n        .Cells(iRow3, 3).Value = Me.Rec2.Value\n        .Cells(iRow3, 4).Value = Me.Rec3.Value\n        .Cells(iRow3, 5).Value = Me.Rec4.Value\n        .Cells(iRow3, 6).Value = Me.Rec5.Value\n        .Cells(iRow3, 7).Value = Me.Rec6.Value\n        .Cells(iRow3, 8).Value = Me.Rec7.Value\n        .Cells(iRow3, 9).Value = Me.Rec8.Value\n        .Cells(iRow3, 10).Value = Me.Rec9.Value\n        .Cells(iRow3, 15).Value = Me.FirstCompetitor.Value\n        .Cells(iRow3, 17).Value = Me.SecondCompetitor.Value\n        .Cells(iRow3, 19).Value = Me.Winner.Value\n        .Cells(iRow3, 20).Value = Me.Exploration.Value\n        .Cells(iRow3, 21).Value = Me.DateAdded.Value\n    End If\nEnd With \n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 4646183, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2533f4ceaa4201b23ff00c6534d65a58?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/4646183/megan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468417489, "creation_date": 1468417380, "question_id": 38353467, "link": "https://stackoverflow.com/questions/38353467/excel-vba-userform-if-not-isempty-then", "title": "Excel VBA UserForm- If Not IsEmpty Then", "body": "<p>I am making a userform that asks for input from the user. </p>\n\n<p>There are lots of inputs, but I am having problems with one section in particular. If a user enters ANYTHING into the textbox (named SecondCompetitor), I want the function to place some values into one of my excel worksheets (named ws4).</p>\n\n<p>Here is the code I have written:</p>\n\n<pre><code>With ws3\n     If Not IsEmpty(Me.SecondCompetitor.Value) Then\n        .Cells(iRow3, 14).Value = Me.Ticker.Value\n        .Cells(iRow3, 2).Value = Me.Rec1.Value\n        .Cells(iRow3, 3).Value = Me.Rec2.Value\n        .Cells(iRow3, 4).Value = Me.Rec3.Value\n        .Cells(iRow3, 5).Value = Me.Rec4.Value\n        .Cells(iRow3, 6).Value = Me.Rec5.Value\n        .Cells(iRow3, 7).Value = Me.Rec6.Value\n        .Cells(iRow3, 8).Value = Me.Rec7.Value\n        .Cells(iRow3, 9).Value = Me.Rec8.Value\n        .Cells(iRow3, 10).Value = Me.Rec9.Value\n        .Cells(iRow3, 15).Value = Me.FirstCompetitor.Value\n        .Cells(iRow3, 17).Value = Me.SecondCompetitor.Value\n        .Cells(iRow3, 19).Value = Me.Winner.Value\n        .Cells(iRow3, 20).Value = Me.Exploration.Value\n        .Cells(iRow3, 21).Value = Me.DateAdded.Value\n    End If\nEnd With \n</code></pre>\n\n<p>When I actually execute the code, the values are placed in the rows REGARDLESS of whether or not a user has actually inputted anything into the SecondCompetitor textbox.</p>\n\n<p>Any suggestions on what the problem may be? </p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468417620, "post_id": 38353428, "comment_id": 64119355, "body": "RGA, thanks for picking those up, i have updated the post to define when there code is failing. Thanks!"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468417876, "post_id": 38353428, "comment_id": 64119574, "body": "@atame its hard to keep track of, but i think you may be missing some conditions in the IF statements in the formula.  what is it you are trying to calculate for <code>xMinWorks</code>?  There is likely a much easier way to do it directly in VBA and avoid the formula"}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468418228, "post_id": 38353428, "comment_id": 64119857, "body": "basically its working out the first date soemthing was sent, based on if the ID matches and with &#39;xMasScaff&#39; if it was scaffold, everyting else comes under &#39;xMinWorks&#39;. The formula works when i use it on the sheet when pressing CTRL SHIFTENTER. I thought this would be the quickest way of getting it done, as there are several thousand rows to search through. Thanks"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468418671, "post_id": 38353428, "comment_id": 64120177, "body": "@atame might be a dumb suggestion, but VBA can be annoying like this sometimes.  Try writing it instead as <code>Application.Evaluate(..)</code>"}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468419016, "post_id": 38353428, "comment_id": 64120420, "body": "it ran through the loop once and worked fine on the first row, then fail again on the second loop with the same error message. Thanks"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468419143, "post_id": 38353428, "comment_id": 64120516, "body": "@atame what does the formula look like when typed directly into a cell?  Can you copy that code to a comment here for me?"}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468419409, "post_id": 38353428, "comment_id": 64120721, "body": "Here is what the code looks like in the cell. <code>{=MIN(IF(&#39;Instruction History&#39;!$D:$D=A8,IF(&#39;Instruction History&#39;!$E:$E=&quot;Scaffold Req&quot;,&#39;Instruction History&#39;!$H:$H)))}</code> &amp; <code>{=MIN(IF(&#39;Instruction History&#39;!$D:$D=A8,IF(&#39;Instruction History&#39;!$E:$E&lt;&gt;&quot;Scaffold Req&quot;,&#39;Instruction History&#39;!$H:$H)))}</code>Thanks"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468419638, "post_id": 38353428, "comment_id": 64120922, "body": "@atame I&#39;m baffled... It looks like the code you&#39;ve written with the corrections should do exactly that."}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468419921, "post_id": 38353428, "comment_id": 64121179, "body": "as am I!! I have used a similar evaluate function elsewhere in other codes and works perfectly, although it only had one <code>if</code> statement. Is there another way i can do it whilst being quick? Thanks"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468420436, "post_id": 38353428, "comment_id": 64121556, "body": "@atame is it possible that the IF statements are not passing a valid value to the &quot;Min&quot; function, so it is erroring when not able to evaluate the value?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1468420514, "post_id": 38353428, "comment_id": 64121625, "body": "@atame Try removing the &quot;=&quot; from the function string, I just editted my answer to include this change"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 0, "last_activity_date": 1468420671, "last_edit_date": 1468420671, "creation_date": 1468417295, "answer_id": 38353428, "question_id": 38353343, "link": "https://stackoverflow.com/questions/38353343/excel-vba-evaluate-min-with-two-criteria-not-working/38353428#38353428", "title": "Excel VBA - Evaluate MIN with two criteria not working", "body": "<p>It appears there are some typos in your code, which could be the cause of your problem, although since you haven't told us where the error is thrown, there could be more issues.  I've corrected the typos below:</p>\n\n<pre><code>Private Sub CommandButton4_Click()\nDim cell, cellRange As Range\nDim lastRow As Long\nDim xMinScaff, xMinWorks As Double\n\nlastRow = sheets(\"Current Asset List\").cells(Rows.count, \"A\").End(xlUp).Row\nSet cellRange = sheets(\"Current Asset List\").Range(\"A8:A\" &amp; lastRow)\n\nFor Each cell In cellRange\n    If cell.Offset(0, 24) = \"\" Then\n        xMinScaff = Application.Evaluate(\"=MIN(IF('Instruction History'!$D:$D=\" &amp; cell.address(False, False) &amp; \",IF('Instruction History'!$E:$E=\"\"Scaffold Req\"\",'Instruction History'!$H:$H)))\")\n        If xMinScaff &lt;&gt; \"0\" Then\n            cell.offset(0, 24).Value = Format(xMinScaff, \"DD/MM/YYYY\")\n        End If\n    End If\n    If cell.Offset(0, 25) = \"\" Then\n        xMinWorks = Application.Evaluate(\"=MIN(IF('Instruction History'!$D:$D=\" &amp; cell.address(False, False) &amp; \",IF('Instruction History'!$E:$E&lt;&gt;\"\"Scaffold Req\"\",'Instruction History'!$H:$H)))\")\n        If xMinWorks &lt;&gt; \"0\" Then\n            cell.offset(0, 25).Value = Format(xMinWorks, \"DD/MM/YYYY\")\n        End If\n    End If\nNext cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468420671, "creation_date": 1468417044, "last_edit_date": 1468417558, "question_id": 38353343, "link": "https://stackoverflow.com/questions/38353343/excel-vba-evaluate-min-with-two-criteria-not-working", "title": "Excel VBA - Evaluate MIN with two criteria not working", "body": "<p>I am currently writing a piece of code, that finds the first date of something for two categories, in the cells.</p>\n\n<p>If one of the cells has a date filled in, it ignores it but if the other cell is blank it runs the evaluate formula.</p>\n\n<p>The problem I am having is the code formula works on the sheet, but not in the code I get Error: \"Run-time error '1004': Application-defined or object-defined error.\"</p>\n\n<p>The code is failing on the <code>xMinScaff = Evaluate(\"=MIN(IF('Instruction History'!$D:$D=\" &amp; cell.address(False, False) &amp; \",IF('Instruction History'!$E:$E=\"\"Scaffold Req\"\",'Instruction History'!$H:$H)))\")</code> and i would also asumme it will fail on <code>xMinWorks = Evaluate(\"=MIN(IF('Instruction History'!$D:$D=\" &amp; cell.address(False, False) &amp; \",IF('Instruction History'!$E:$E&lt;&gt;\"\"Scaffold Req\"\",'Instruction History'!$H:$H)))\")</code> as they are pretty identical.</p>\n\n<p>Here is the code I currently have. Thanks</p>\n\n<pre><code>Private Sub CommandButton4_Click()\nDim cell, cellRange As Range\nDim lastRow As Long\nDim xMinScaff, xMinWorks As Double\n\nlastRow = sheets(\"Current Asset List\").cells(Rows.count, \"A\").End(xlUp).Row\nSet cellRange = sheets(\"Current Asset List\").Range(\"A8:A\" &amp; lastRow)\n\nFor Each cell In cellRange\n    If cell.Offset(0, 24) = \"\" Then\n        xMinScaff = Evaluate(\"=MIN(IF('Instruction History'!$D:$D=\" &amp; cell.address(False, False) &amp; \",IF('Instruction History'!$E:$E=\"\"Scaffold Req\"\",'Instruction History'!$H:$H)))\")\n        If xMinScaff &lt;&gt; \"0\" Then\n            cell.offset(0, 24).Value = Format(xMinScaff, \"DD/MM/YYYY\")\n        End If\n    End If\n    If cell.Offset(0, 25) = \"\" Then\n        xMinWorks = Evaluate(\"=MIN(IF('Instruction History'!$D:$D=\" &amp; cell.address(False, False) &amp; \",IF('Instruction History'!$E:$E&lt;&gt;\"\"Scaffold Req\"\",'Instruction History'!$H:$H)))\")\n        If xMinWorks &lt;&gt; \"0\" Then\n            cell.offset(0, 25).Value = Format(xMinWorks, \"DD/MM/YYYY\")\n        End If\n    End If\nNext cell\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1468417297, "post_id": 38353306, "comment_id": 64119089, "body": "You should avoid naming a sub and a variable exactly the same (&quot;FindOfficer&quot;). Not only it is confusing, but if you decide to change the sub into a function in future -- the return value is assigned to a function name -- that will cause lots of troubles if gone unnoticed."}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1468418407, "creation_date": 1468418407, "answer_id": 38353843, "question_id": 38353306, "link": "https://stackoverflow.com/questions/38353306/vba-script-to-select-all-cells-between-2-ocurrences-of-variable-text-problems/38353843#38353843", "title": "VBA script to select all cells between 2 ocurrences of variable text. Problems", "body": "<p>There are many ways to do this. One of the simplest is to use R1C1 cell references in which columns are refered to by number, just like rows e.g. range B2 is cell 2,2. You can also use the Row property of a range to determine what row that range starts on. Replace this:</p>\n\n<pre><code>Set Rng3 = .Range(Rng1.Address &amp; \":\" &amp; Rng2.Address)\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>Set Rng3 = .Range(.Cells(Rng1.Row,2), .Cells(Rng2.Row, 38))\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6584700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451610e9ad9dbf12f3fa770d2a5972d4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael.Mullins", "link": "https://stackoverflow.com/users/6584700/michael-mullins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468418407, "creation_date": 1468416938, "question_id": 38353306, "link": "https://stackoverflow.com/questions/38353306/vba-script-to-select-all-cells-between-2-ocurrences-of-variable-text-problems", "title": "VBA script to select all cells between 2 ocurrences of variable text. Problems", "body": "<p>I am using the below macro to select all cells between 2 occurrences of a user defined phrase. </p>\n\n<pre><code>Sub FindOfficer()\nDim FindOfficer As String\nDim Rng1 As Range\nDim Rng2 As Range\nDim Rng3 As Range\nFindOfficer = InputBox(\"Enter Officer's Name\")\nIf Trim(FindOfficer) &lt;&gt; \"\" Then\n    With Sheets(\"Sheet1\").Range(\"J:M\")\n        Set Rng1 = .Find(What:=FindOfficer, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        Set Rng2 = .Find(What:=FindOfficer, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False)\n        Set Rng3 = .Range(Rng1.Address &amp; \":\" &amp; Rng2.Address)\n        If Not Rng3 Is Nothing Then\n            Application.Goto Rng3, False\n        Else\n            MsgBox \"Error\"\n        End If\n    End With\nEnd If\nEnd Sub\n</code></pre>\n\n<p>It is correctly selecting the rows i need, however it is only selecting columns B to AG whilst i would like B to AL to be selected.</p>\n\n<p>Any thoughts on how i could change the code to do this? I am very new to VBA</p>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1468418099, "post_id": 38353540, "comment_id": 64119750, "body": "I tried that but it doesn&#39;t works. I have win 10 and it&#39;s on a laptop with 1366 x 768 res"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1468418138, "post_id": 38353540, "comment_id": 64119777, "body": "Why isn&#39;t it working? Are they not aligned? Explain a bit please"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1468418323, "post_id": 38353540, "comment_id": 64119920, "body": "I it always show like this I can adjust the Top parameter but no matter what i provide to the left parameter they always have that space between them."}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1468417586, "creation_date": 1468417586, "answer_id": 38353540, "question_id": 38353294, "link": "https://stackoverflow.com/questions/38353294/position-two-userform-with-no-space-between-them/38353540#38353540", "title": "Position two userform with no space between them", "body": "<p>Set the <code>Left</code> option of the second form to the <code>Left</code> of the first form + <code>Width</code> of the first one</p>\n\n<pre><code>UserForm2.Left = UserForm1.Left + UserForm1.Width\n</code></pre>\n\n<p>On Windows 7 i had to add another 7 pixels, so like this: </p>\n\n<pre><code>UserForm2.Left = UserForm1.Left + UserForm1.Width + 7\n</code></pre>\n\n<p>You might have to modify this depending on the OS</p>\n"}, {"tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 1, "last_activity_date": 1468418859, "creation_date": 1468418859, "answer_id": 38354019, "question_id": 38353294, "link": "https://stackoverflow.com/questions/38353294/position-two-userform-with-no-space-between-them/38354019#38354019", "title": "Position two userform with no space between them", "body": "<p>You need to change the <code>StartUpPosition</code> property to Manual (value = 0, I believe).  Then, you can adjust the top and left placement to remove the gap</p>\n"}, {"comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1468419575, "post_id": 38354142, "comment_id": 64120855, "body": "Thanks but it kinda overlaps I guess need to tweak something since CIF width is  499.5 and Instructions width is 423.75"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1468421953, "post_id": 38354142, "comment_id": 64122764, "body": "The Instructions form doesn&#39;t move even a little bit form it&#39;s position horizontally."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1468422123, "post_id": 38354142, "comment_id": 64122888, "body": "I think the trick to don&#39;t overlap is to find the right position between the close and the border of the user form, I have tried different sizes and seems to be constantly 7, try now the updated one"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1468422800, "post_id": 38354142, "comment_id": 64123387, "body": "Thanks but it doesn&#39;t work I am out of ideas if you wish to download and experiment with it the file is here <a href=\"https://www.dropbox.com/s/yp8bisqua33usux/Copy_of_HHC_CIF_v010.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/yp8bisqua33usux/Copy_of_HHC_CIF_v010.xlsm?dl=0</a> thanks I know you provided correct answers but it doesn&#39;t works I tried everything."}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 2, "last_activity_date": 1468422448, "last_edit_date": 1468422448, "creation_date": 1468419186, "answer_id": 38354142, "question_id": 38353294, "link": "https://stackoverflow.com/questions/38353294/position-two-userform-with-no-space-between-them/38354142#38354142", "title": "Position two userform with no space between them", "body": "<p>Does this work?</p>\n\n<pre><code>Sub test()\nWith CIF\n.Show vbModeless\n.Left = .Left - .Width / 2\nEnd With\nWith Instructions\n.Show vbModeless\n.Left = .Left - .Width / 2\nEnd With\nUnload CIF\nUnload Instructions\nEnd sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ioN88.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ioN88.gif\" alt=\"enter image description here\"></a></p>\n\n<p><strong>UPDATED</strong>: <br>To avoid overlap<br>\nSeems like there's a constant value 7 among the close button and the border of the userform. Following should address it (doesn't matter userform size).</p>\n\n<pre><code>Sub test()\nWith CIF\n.Show vbModeless\n.Left = .Left - .Width / 2\nEnd With\nWith Instructions\n.Show vbModeless\n.Left = CIF.Left + CIF.Width + 7\nEnd With\nUnload CIF\nUnload Instructions\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vGTfn.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vGTfn.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 38354142, "answer_count": 3, "score": 0, "last_activity_date": 1468422448, "creation_date": 1468416890, "last_edit_date": 1468417986, "question_id": 38353294, "link": "https://stackoverflow.com/questions/38353294/position-two-userform-with-no-space-between-them", "title": "Position two userform with no space between them", "body": "<p>How can I adjust the userforms positions inorder to place them side by side when Intialized i.e. remove the space between them.</p>\n\n<p><a href=\"https://i.stack.imgur.com/y7Qcu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y7Qcu.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>From the answer I tried this but it doesn't work</p>\n\n<pre><code>CIF.Show\nWith CIF\n    .Top = Application.Top + 5\n    .Left = Application.Left + 10\nEnd With\n\nInstructions.Show\nWith Instructions\n    .Top = Application.Top + 5\n    .Left = CIF.Left + CIF.Width\nEnd With\n</code></pre>\n"}, {"tags": ["xml", "vba", "excel", "msxml"], "comments": [{"owner": {"reputation": 499, "user_id": 5048226, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a6f66f52bc861376c41ad78706becb2e?s=128&d=identicon&r=PG&f=1", "display_name": "limonik", "link": "https://stackoverflow.com/users/5048226/limonik"}, "edited": false, "score": 1, "creation_date": 1468416700, "post_id": 38353191, "comment_id": 64118611, "body": "What did you try? Which error/warning message did you take ?"}, {"owner": {"reputation": 499, "user_id": 5048226, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a6f66f52bc861376c41ad78706becb2e?s=128&d=identicon&r=PG&f=1", "display_name": "limonik", "link": "https://stackoverflow.com/users/5048226/limonik"}, "edited": false, "score": 0, "creation_date": 1468416787, "post_id": 38353191, "comment_id": 64118687, "body": "&quot;..... post a sample piece of code?&quot; I do not think so the aim of the people in this web page is to send sample codes"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 1, "creation_date": 1468418462, "post_id": 38353191, "comment_id": 64120021, "body": "XML documents are validated against the schema during parsing (either DOM or SAX). One way to achieve it is to save the current state of XML and validate it against schema from disk/memory. I am not sure if you can do it for already loaded and mapped XML document (I might be wrong)."}], "owner": {"reputation": 1, "user_id": 1401347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6975baaeec11286863cb7842bf7e61?s=128&d=identicon&r=PG", "display_name": "user1401347", "link": "https://stackoverflow.com/users/1401347/user1401347"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468416603, "creation_date": 1468416603, "question_id": 38353191, "link": "https://stackoverflow.com/questions/38353191/excel-vba-msxml2-domdocument-bind-to-mapped-data", "title": "Excel VBA MSXML2 DOMDocument bind to mapped data", "body": "<p>I have an Excel file with an xml schema mapped to selected tables and cells. What I want to do is build a data validation VBA script to inform the user if all fields comply with the xsd.</p>\n\n<p>I've gone through the MSXML2 documentation but the only way I found to bind the newly created instance of DOMDocument is to load data from an xml file. What I am actually looking for is to bind it to the data which is already in the workbook and residing in the mapped cells. </p>\n\n<p>Can anybody help and post a sample piece of code?</p>\n\n<p>Highly appreciated!</p>\n\n<p>Lukasz</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1468416879, "post_id": 38353194, "comment_id": 64118766, "body": "here is my code :  n = 8  j = 2  Sheets(&quot;1&quot;).Select                       Do While Cells(n, 1) &lt;&gt; &quot;x&quot;                               If Cells(n, 1) &lt;&gt; &quot;x&quot; Then                          Sheets(&quot;2&quot;).Cells(j, 2) = Sheets(&quot;1&quot;).Cells(n, 2)                            Sheets(&quot;2&quot;).Cells(j, 3) = Sheets(&quot;1&quot;).Cells(n, 3)                             j = j + 1                     End If                          n = n + 1                 Loop"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1468416914, "post_id": 38353194, "comment_id": 64118787, "body": "@babou please append this code to your question, not as a comment on my answer"}, {"owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1468417162, "post_id": 38353194, "comment_id": 64118983, "body": "done, didnt know it will do that ahah  so i just need to change n variable with Range.Find()   and my copy end with it find a &quot;x&quot; in column A"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": true, "score": 1, "last_activity_date": 1468417574, "last_edit_date": 1468417574, "creation_date": 1468416614, "answer_id": 38353194, "question_id": 38353071, "link": "https://stackoverflow.com/questions/38353071/copy-a-column-with-a-variable-start/38353194#38353194", "title": "copy a column with a variable start", "body": "<p>Use the <code>Range.Find()</code> method to find where \"Maintenance\" starts, then pull the data below it until whatever condition defines the end of that data (empty cells or a new category name)</p>\n\n<p>For OP's code:</p>\n\n<pre><code>n = Sheets(\"1\").UsedRange.Find(\"Maintenance\",LookAt:=xlWhole).Row\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 38353194, "answer_count": 1, "score": 1, "last_activity_date": 1468417574, "creation_date": 1468416294, "last_edit_date": 1468417087, "question_id": 38353071, "link": "https://stackoverflow.com/questions/38353071/copy-a-column-with-a-variable-start", "title": "copy a column with a variable start", "body": "<p>This is what I have:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yV1rH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yV1rH.png\" alt=\"enter image description here\"></a></p>\n\n<p>And my probleme is simple: I want to copy all rows Under \"Maintenance\" (C8) in worksheet 2, BUT I want it to work even if we delete some rows above \"Maintenance\" (C8).</p>\n\n<p>for example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xY9k1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xY9k1.png\" alt=\"enter image description here\"></a></p>\n\n<p>because it changes the start of the copy. (from 8 to end before, and 5 to end after)</p>\n\n<p>Here is my code :</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>n = 8 \r\nj = 2 \r\nSheets(\"1\").Select \r\nDo While Cells(n, 1) &lt;&gt; \"x\" \r\n   If Cells(n, 1) &lt;&gt; \"x\" Then \r\n    Sheets(\"2\").Cells(j, 2) = Sheets(\"1\").Cells(n, 2) \r\n    Sheets(\"2\").Cells(j, 3) = Sheets(\"1\").Cells(n, 3) \r\n    j = j + 1 \r\n   End If \r\n n = n + 1 \r\nLoop </code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468415633, "post_id": 38352761, "comment_id": 64117804, "body": "What is &quot;f&quot;.  It&#39;s hard to understand what you are trying to do with your variable names"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468415987, "post_id": 38352761, "comment_id": 64118056, "body": "I recommend researching how to properly reference ranges in VBA, as well as how a For Each loop works.  Your general structure is sound (like how you set up the code) but your syntax/method is all off"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468416505, "post_id": 38352761, "comment_id": 64118459, "body": "I&#39;m in agreement with @RGA. <code>a</code>, <code>c</code>, and <code>f</code> are not very descriptive names for variables and you WILL end up confused eventually. :) I personally start each variable with a 3 letter abbreviation for it data type. Eg, <code>strSN</code> for the serial number variable since it is a string or <code>rngSearchTerm</code> instead of <code>a</code> since it is a range and it contains the value we want to find."}, {"owner": {"reputation": 15, "user_id": 6581337, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/999cb125c6df746b5b3e01bae1bc5ef3?s=128&d=identicon&r=PG&f=1", "display_name": "eob", "link": "https://stackoverflow.com/users/6581337/eob"}, "edited": false, "score": 0, "creation_date": 1468416719, "post_id": 38352761, "comment_id": 64118628, "body": "Whoops! Realized that f was from an older version of the code that I forgot to delete. The problem now is that I want &#39;sn&#39; to be set equal to the string inside of whatever cell the loop is on in that iteration. For example, in the first loop, &#39;sn&#39; would equal whatever value is in cell A5, then the second loop would change &#39;sn&#39; to whatever value is in cell A6, and so on."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1468416742, "post_id": 38352761, "comment_id": 64118646, "body": "Also, recommend you use <code>Option Explicit</code> and fully define ALL variables before you use them.  This will save a lot of type mismatch headache"}], "answers": [{"comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468416392, "post_id": 38353050, "comment_id": 64118358, "body": "will that first for each work?  You say &quot;a&quot; is a range but you&#39;re looping through the values?"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1468416632, "post_id": 38353050, "comment_id": 64118561, "body": "@RGA Good catch! I didn&#39;t actually test the code, just corrected the mistakes in OP&#39;s code. I&#39;ll edit that."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1468417628, "post_id": 38353050, "comment_id": 64119368, "body": "@Tim - I wanted to make a note for OP that the <code>else</code> part of <code>if</code> is redundant. Once he understands how the code was changed, it can be removed."}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1468416653, "last_edit_date": 1468416653, "creation_date": 1468416243, "answer_id": 38353050, "question_id": 38352761, "link": "https://stackoverflow.com/questions/38352761/referencing-data-from-a-cell-that-is-not-explicitly-defined/38353050#38353050", "title": "Referencing data from a cell that is not explicitly defined", "body": "<p>Try this:</p>\n\n<pre><code>Sub Test1()\n    Dim n As Integer\n    Dim a As Range\n    Dim c As Range\n    Dim sn As String\n\n    n = 0\n    ' n is the counter for the number of times that the search term will appear\n\n    For Each a In Worksheets(\"Sheet1\").Range(\"A5:A34\")\n        'f = a.Cells\n        sn = a.Value\n        ' each sn is equal to the contents of the cell \"a\", which will be the serial number of the tooling\n\n        For Each c In Worksheets(\"RunsheetTest\").Range(\"A3:R3\")\n            ' Defines c as a range with cells A3 to R3?\n            If InStr(1, c.Value, sn, vbTextCompare) &gt; 0 Then\n                n = n + 1\n            Else\n                n = n\n            End If\n            ' If the serial number is found in one of the cells, add 1 to n and move on to the next.\n        Next\n\n        MsgBox \"Searching for \" &amp; sn\n        a.Value = n\n    Next\n    ' I'm also getting an error here, saying \"for loop not initialized\", however I thought I initialized it above.\n\nEnd Sub\n</code></pre>\n\n<p><code>a</code> and <code>c</code> are ranges, so you don't reference them by <code>range(a)</code> or <code>range(c)</code>. Also, just use <code>Next</code>, not <code>Next a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": false, "score": 0, "last_activity_date": 1468416999, "creation_date": 1468416999, "answer_id": 38353322, "question_id": 38352761, "link": "https://stackoverflow.com/questions/38352761/referencing-data-from-a-cell-that-is-not-explicitly-defined/38353322#38353322", "title": "Referencing data from a cell that is not explicitly defined", "body": "<p>Another take on your question -- VBA does support nested loops, but you are better off using built-in Range.Find() method. See example and my comments below:</p>\n\n<pre><code>Sub Test1()\n\n    Dim n As Long\n    n = 0 ' n is the counter for the number of times that the search term will appear\n\n    Dim sn As String\n    Dim c As Range\n    Dim a As Range\n\n    '' removing \".Value\" at the end -- you need to loop through a range\n    For Each a In Worksheets(\"Sheet1\").Range(\"A5:A34\")\n        '' here \"a\" is already a range object that contains one cell so all you need is:\n        n = 0 '' reset the counter for new serial number\n        sn = a\n\n        '' to search for a value it is better to use special .Find function on a range, not a loop\n        With Worksheets(\"RunsheetTest\").Range(\"A3:R3\")\n\n            Set c = .Find(sn, LookIn:=xlValues)\n            If Not c Is Nothing Then\n                '' you get here only if something is found, otherwise counter will be 0 -- i.e. nothing found\n                firstAddress = c.Address\n                Do\n                    n = n + 1\n                    Set c = .FindNext(c)\n                Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n            End If\n\n        End With\n\n        MsgBox \"Searching for \" &amp; sn &amp; \" and found it \" &amp; n &amp; \" times.\"\n\n    Next a\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6581337, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/999cb125c6df746b5b3e01bae1bc5ef3?s=128&d=identicon&r=PG&f=1", "display_name": "eob", "link": "https://stackoverflow.com/users/6581337/eob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1468416999, "creation_date": 1468415527, "last_edit_date": 1531164843, "question_id": 38352761, "link": "https://stackoverflow.com/questions/38352761/referencing-data-from-a-cell-that-is-not-explicitly-defined", "title": "Referencing data from a cell that is not explicitly defined", "body": "<p>I realize the wording is probably a bit strange with this question, but I'm relatively new to coding so I wasn't entirely sure how to put my problem into words. I want to iterate through a column of data on one sheet, and use each cell in that column as my search term for searching in a given row of a different sheet.</p>\n\n<pre><code>Sub Test1()\nn = 0\n' n is the counter for the number of times that the search term will appear\n\nDim sn As String\nFor Each a In Worksheets(\"Sheet1\").range(\"A5:A34\").Value\nf = a.Cells\nsn = range(a).Value\n' each sn is equal to the contents of the cell \"a\", which will be the serial number of the tooling\n\n\nFor Each c In Worksheets(\"RunsheetTest\").range(\"A3:R3\")\n' Defines c as a range with cells A3 to R3?\n\n\nIf InStr(c.Cells, sn) &gt; 0 Then\nn = n + 1\nElse\nn = n\nEnd If\n' If the serial number is found in one of the cells, add 1 to n and move on to the next.\n\nNext c\n\nMsgBox \"Searching for \" &amp; sn\nrange(a).Value = n\nNext a\n' I'm also getting an error here, saying \"for loop not initialized\", however I thought I initialized it above.\n\nEnd Sub\n</code></pre>\n\n<p>My biggest question is whether I'm using the right syntax for \"f = a.Cells\" at the top, since I want to reference the cell that the loop is currently on instead of a specific cell and why the compiler is giving me an error with my loop. Can I not run nested loops in VBA? Also, if any of my comments aren't entirely accurate to what is actually happening, please feel free t let me know.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 0, "last_activity_date": 1468418179, "last_edit_date": 1468418179, "creation_date": 1468417487, "answer_id": 38353504, "question_id": 38352619, "link": "https://stackoverflow.com/questions/38352619/place-a-date-in-a-range-based-on-date-values/38353504#38353504", "title": "Place a date in a range based on date values", "body": "<p>Does this work?</p>\n\n<pre><code>Sub test()\n\n    Range(\"E3\").Select\n    Set x = Range(Selection, Selection.End(xlDown))\n\n    Range(\"E20\").Select\n    Set y = Range(Selection, Selection.End(xlDown))\n\n    For Each cell In x\n        For Each cell2 In y\n\n            If (cell &gt;= cell2) Then\n                If (cell &lt;= cell2.Offset(1, 0).Value) Then\n                cell2.Offset(0, 1).Value = cell.Value\n                    End If\n                End If\n\n        Next cell2\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>I don't fully understand why to loop through cells, if there's only one desired cell, however, if it was for demonstration -which I think- and you really need it in loop, I fixed it that way.\nPS: Try to explicitly state what you need, there is a difference for asking a <a href=\"http://www.excel-easy.com/vba/function-sub.html\" rel=\"nofollow\">function and doing a sub</a></p>\n"}], "owner": {"reputation": 1529, "user_id": 6039787, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b02883ae7e82b518cef831ab5bacb10d?s=128&d=identicon&r=PG&f=1", "display_name": "Frits Verstraten", "link": "https://stackoverflow.com/users/6039787/frits-verstraten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 38353504, "answer_count": 1, "score": 0, "last_activity_date": 1468424598, "creation_date": 1468415164, "last_edit_date": 1531164843, "question_id": 38352619, "link": "https://stackoverflow.com/questions/38352619/place-a-date-in-a-range-based-on-date-values", "title": "Place a date in a range based on date values", "body": "<p>I have a dataset in excel that can be reproduced with the following routine:</p>\n\n<pre><code>sub dummy_data\n\n  Sheets(\"Blad1\").Cells(20, 2).FormulaLocal = 2014\n  Sheets(\"Blad1\").Cells(21, 2).FormulaLocal = 2014\n  Sheets(\"Blad1\").Cells(22, 2).FormulaLocal = 2014\n  Sheets(\"Blad1\").Cells(23, 2).FormulaLocal = 2014\n\n  Sheets(\"Blad1\").Cells(20, 3).FormulaLocal = 5\n  Sheets(\"Blad1\").Cells(21, 3).FormulaLocal = 6\n  Sheets(\"Blad1\").Cells(22, 3).FormulaLocal = 7\n  Sheets(\"Blad1\").Cells(23, 3).FormulaLocal = 8\n\n  Sheets(\"Blad1\").Cells(20, 5).FormulaLocal = \"27-02-2014\"\n  Sheets(\"Blad1\").Cells(21, 5).FormulaLocal = \"03-03-2014\"\n  Sheets(\"Blad1\").Cells(22, 5).FormulaLocal = \"10-03-2014\"\n  Sheets(\"Blad1\").Cells(23, 5).FormulaLocal = \"17-03-2014\"\n\n  Sheets(\"Blad1\").Cells(2, 5).FormulaLocal = \"Factuurmomenten\"\n  Sheets(\"Blad1\").Cells(3, 5).FormulaLocal = \"28-02-2014\"  \n  Sheets(\"Blad1\").Cells(4, 5).FormulaLocal = \"12-03-2014\"\nend sub\n</code></pre>\n\n<p>I need to write a VBA macro that takes the values in the range E3:E4 and places it below in the relevant week. So the value in cell (3,5) should be placed after 27-01-2014 and before 3-2-2014 in cell F20.</p>\n\n<p>I wrote the following code:</p>\n\n<pre><code>  Sub test()\n\n    Range(\"E3\").Select\n    Set x = Range(Selection, Selection.End(xlDown))\n\n    Range(\"E20\").Select\n    Set y = Range(Selection, Selection.End(xlDown))\n\n    For Each cell In x\n        For Each cell2 In y\n\n            cell3 = cell2.Offset(1, 0).Value\n\n            If (cell &gt;= cell2) Then\n                If (cell &lt;= cell3) Then\n                    MsgBox(\"Jes\")\n                    End If\n                End If\n\n        Next cell2\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>I think I'm almost there, but I just need something now that places the relevant date in the relevant cell. So instead of MsgBox(\"yes\"), it should be placed in the relevant cell.</p>\n\n<p>Any feedback on how I can do this? And if there is a better and more efficient way to reach my goal, I'm open for it :)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1468415204, "post_id": 38352357, "comment_id": 64117468, "body": "Have you tried out any modifications to the example code? What do you think each line is doing?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6584504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19ea7091a8cdae000d70cc5358affc2?s=128&d=identicon&r=PG&f=1", "display_name": "Greg B", "link": "https://stackoverflow.com/users/6584504/greg-b"}, "edited": false, "score": 0, "creation_date": 1468415144, "post_id": 38352561, "comment_id": 64117429, "body": "Can it be written to look through the entire worksheet and delete QA1 where ever it is found?"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 1, "user_id": 6584504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19ea7091a8cdae000d70cc5358affc2?s=128&d=identicon&r=PG&f=1", "display_name": "Greg B", "link": "https://stackoverflow.com/users/6584504/greg-b"}, "edited": false, "score": 0, "creation_date": 1468415237, "post_id": 38352561, "comment_id": 64117495, "body": "see jcarroll&#39;s answer"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1468414970, "creation_date": 1468414970, "answer_id": 38352561, "question_id": 38352357, "link": "https://stackoverflow.com/questions/38352357/using-vba-to-search-for-a-text-string-in-excel/38352561#38352561", "title": "Using VBA to search for a text string in Excel", "body": "<p>This code goes through columns in a specified row and removes the \"QA1\" if found</p>\n\n<pre><code>Dim LastColumn As Integer\nDim RowNumber As Integer\nDim i As Integer\n\nLastColumn = UsedRange.SpecialCells(xlCellTypeLastCell).Column\nRowNumber = 1 'Adjust to your needs\n\nFor i = 1 To LastColumn Step 1\n\n      Cells(RowNumber, i).Value = Replace(Cells(RowNumber, i).Value, \"QA1\", \"\")\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6584504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19ea7091a8cdae000d70cc5358affc2?s=128&d=identicon&r=PG&f=1", "display_name": "Greg B", "link": "https://stackoverflow.com/users/6584504/greg-b"}, "edited": false, "score": 0, "creation_date": 1468421646, "post_id": 38352592, "comment_id": 64122539, "body": "This worked but since I have a lot of rows and columns it took a great deal of time for Excel to execute.  I plan to keep it all the same for future use.  Thank you."}], "tags": [], "owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "is_accepted": false, "score": 0, "last_activity_date": 1468415090, "creation_date": 1468415090, "answer_id": 38352592, "question_id": 38352357, "link": "https://stackoverflow.com/questions/38352357/using-vba-to-search-for-a-text-string-in-excel/38352592#38352592", "title": "Using VBA to search for a text string in Excel", "body": "<p>Loops through the used range of the active worksheet, and removes the selected text.</p>\n\n<pre><code>Sub RemoveText()\n\n    Dim c As Range\n    Dim removeStr As String\n\n    removeStr = InputBox(\"Please enter the text to remove\")\n\n    For Each c In ActiveSheet.UsedRange\n        If c.Value = removeStr Then c.Delete\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6584504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19ea7091a8cdae000d70cc5358affc2?s=128&d=identicon&r=PG&f=1", "display_name": "Greg B", "link": "https://stackoverflow.com/users/6584504/greg-b"}, "edited": false, "score": 0, "creation_date": 1468421698, "post_id": 38352684, "comment_id": 64122582, "body": "Thank you, this was what I was looking for.  I&#39;m still in the process of learning VBA and macros so this is very appreciated.  Now to decipher what you wrote.  Thanks again."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 1, "user_id": 6584504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19ea7091a8cdae000d70cc5358affc2?s=128&d=identicon&r=PG&f=1", "display_name": "Greg B", "link": "https://stackoverflow.com/users/6584504/greg-b"}, "edited": false, "score": 0, "creation_date": 1468422095, "post_id": 38352684, "comment_id": 64122869, "body": "I&#39;d suggest checking these links:  <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/wc500chb.aspx</a> ,  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff839746.aspx</a>  Feel free to mark as accepted answer if it is."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1468415785, "last_edit_date": 1468415785, "creation_date": 1468415320, "answer_id": 38352684, "question_id": 38352357, "link": "https://stackoverflow.com/questions/38352357/using-vba-to-search-for-a-text-string-in-excel/38352684#38352684", "title": "Using VBA to search for a text string in Excel", "body": "<p>You want to clear the contents of the whole column if one cell contains <code>QA1</code>?</p>\n\n<pre><code>Sub Test()\n\n    Dim rCell As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\").Columns(4)\n        Set rCell = .Find(\"QA1\", LookIn:=xlValues)\n        If Not rCell Is Nothing Then\n            .ClearContents\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>If you want to just clear each instance of <code>QA1</code> in column D:</p>\n\n<pre><code>Sub Test()\n\n    Dim rCell As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\").Columns(4)\n        Set rCell = .Find(\"QA1\", LookIn:=xlValues)\n        If Not rCell Is Nothing Then\n            Do\n                rCell.ClearContents\n                Set rCell = .FindNext(rCell)\n            Loop While Not rCell Is Nothing\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Can it be written to look through the entire worksheet and delete QA1\n  where ever it is found?</p>\n</blockquote>\n\n<p>All instances of <code>QA1</code> on sheet:</p>\n\n<pre><code>Sub Test()\n\n    Dim rCell As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\").Cells\n        Set rCell = .Find(\"QA1\", LookIn:=xlValues)\n        If Not rCell Is Nothing Then\n            Do\n                rCell.ClearContents\n                Set rCell = .FindNext(rCell)\n            Loop While Not rCell Is Nothing\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong>  Add <code>LookAt:=xlWhole</code> to the <code>Find</code> arguments so it doesn't delete cells containing QA1 and other text (e.g. <code>QA11</code> or <code>Some text QA1</code>)</p>\n"}], "owner": {"reputation": 1, "user_id": 6584504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19ea7091a8cdae000d70cc5358affc2?s=128&d=identicon&r=PG&f=1", "display_name": "Greg B", "link": "https://stackoverflow.com/users/6584504/greg-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1468415785, "creation_date": 1468414399, "question_id": 38352357, "link": "https://stackoverflow.com/questions/38352357/using-vba-to-search-for-a-text-string-in-excel", "title": "Using VBA to search for a text string in Excel", "body": "<p>I'm trying to use VBA in a macro to search for a text string and delete the contents of the column. I previously found this on the website and would like to change it to search columns and delete the text \"QA1\" while retaining the columns.  I hope this makes sense.</p>\n\n<pre><code>LastRow = Cells(Columns.Count, \"D\").End(xlUp).Row\n\nFor i = LastRow To 1 Step -1\n   If Range(\"D\" &amp; i).Value = \"D\" Then\n      Range(\"D\" &amp; i).EntireColumn.Delete\n   End If\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1853, "user_id": 1114934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c298c7ba2be70138bf3142e47632a77?s=128&d=identicon&r=PG", "display_name": "ivan.mylyanyk", "link": "https://stackoverflow.com/users/1114934/ivan-mylyanyk"}, "edited": false, "score": 0, "creation_date": 1468414832, "post_id": 38352266, "comment_id": 64117205, "body": "You have provided some code, but didn&#39;t say what doesn&#39;t work or what did you expect. Also, can you please specify the task in more details?"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1468415521, "post_id": 38352266, "comment_id": 64117715, "body": "Not sure if this is a typo on your part or if it is actually in your code this way, but <code>criteria1=grt</code> should be <code>criteria1:=grt</code>. You also need to separate <code>field</code> and <code>criteria</code> with a comma, so that line should read <code>Selection.autofilter field:=4, criteria1:=grt</code>"}, {"owner": {"reputation": 1, "user_id": 6584476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aVARt6_jaNg/AAAAAAAAAAI/AAAAAAAAAKU/lMhQEB9qjxQ/photo.jpg?sz=128", "display_name": "vivek", "link": "https://stackoverflow.com/users/6584476/vivek"}, "edited": false, "score": 0, "creation_date": 1468512140, "post_id": 38352266, "comment_id": 64168071, "body": "thanks tim for your quick response, its typo error. What im trying to do is in my current sheet sheet1 which contains so many columns and filtering out  from a column (S) with the value i.e., &quot;&gt;21&quot; note this is not a logical operator just &quot;&gt;21&quot; value. After that it has to be copied and moved to another sheet.  A        lB       C      D      E asd   dsdd   ddas  sssd  &gt;21 dadf  bbdw  gege  gge   &gt;21"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6584476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aVARt6_jaNg/AAAAAAAAAAI/AAAAAAAAAKU/lMhQEB9qjxQ/photo.jpg?sz=128", "display_name": "vivek", "link": "https://stackoverflow.com/users/6584476/vivek"}, "edited": false, "score": 0, "creation_date": 1468551835, "post_id": 38353314, "comment_id": 64183976, "body": "Thanks for your help, I wanna read &quot;&gt;21&quot; as a value in my autofilter criteria not as a logical operator greater than 21. When Im trying to filter out its considering as logical operator greater than 21 instead of &quot;&gt;21&quot; value. Please help on this Thanks- Vivek"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 1, "user_id": 6584476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aVARt6_jaNg/AAAAAAAAAAI/AAAAAAAAAKU/lMhQEB9qjxQ/photo.jpg?sz=128", "display_name": "vivek", "link": "https://stackoverflow.com/users/6584476/vivek"}, "edited": false, "score": 0, "creation_date": 1468580115, "post_id": 38353314, "comment_id": 64197196, "body": "That is a good question... I don&#39;t know if it is possible? If it is, it is beyond my knowledge. I&#39;ve tried several things, but none work. I can make a workaround if you are willing to either change your dataset or create a helper column."}, {"owner": {"reputation": 1, "user_id": 6584476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aVARt6_jaNg/AAAAAAAAAAI/AAAAAAAAAKU/lMhQEB9qjxQ/photo.jpg?sz=128", "display_name": "vivek", "link": "https://stackoverflow.com/users/6584476/vivek"}, "edited": false, "score": 0, "creation_date": 1469073624, "post_id": 38353314, "comment_id": 64389902, "body": "I dont want to change the cell values and I want to read it as value &quot;&gt;21&quot;. Please help me on this."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 1, "user_id": 6584476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aVARt6_jaNg/AAAAAAAAAAI/AAAAAAAAAKU/lMhQEB9qjxQ/photo.jpg?sz=128", "display_name": "vivek", "link": "https://stackoverflow.com/users/6584476/vivek"}, "edited": false, "score": 0, "creation_date": 1477910194, "post_id": 38353314, "comment_id": 67935199, "body": "@vivek See updated code, I found out how to do it. :)"}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 1, "last_activity_date": 1477910169, "last_edit_date": 1477910169, "creation_date": 1468416963, "answer_id": 38353314, "question_id": 38352266, "link": "https://stackoverflow.com/questions/38352266/vba-want-to-use-21-as-a-value-not-as-a-logical-operator/38353314#38353314", "title": "VBA want to use &quot;&gt;21&quot; as a value not as a logical operator", "body": "<p>More than halfway into the reply, I realized it had already been covered by Tim's comment. If I reap any imaginary points for this, I'll split them!</p>\n\n<p>This is what your code should have looked like:</p>\n\n<pre><code>Public Const gt As String = \"=&gt;21\"\n\nSub main()\n    sample (gt)\nEnd Sub\n\nSub sample(grt As String)\n    Selection.AutoFilter Field:=4, Criteria1:=grt\nEnd Sub\n</code></pre>\n\n<p>If you are getting a type mismatch error, please indicate what line of code it is triggering on. Additionally, advise what datatype is used in the column you are autofiltering.</p>\n"}], "owner": {"reputation": 1, "user_id": 6584476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aVARt6_jaNg/AAAAAAAAAAI/AAAAAAAAAKU/lMhQEB9qjxQ/photo.jpg?sz=128", "display_name": "vivek", "link": "https://stackoverflow.com/users/6584476/vivek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477910169, "creation_date": 1468414214, "last_edit_date": 1531164843, "question_id": 38352266, "link": "https://stackoverflow.com/questions/38352266/vba-want-to-use-21-as-a-value-not-as-a-logical-operator", "title": "VBA want to use &quot;&gt;21&quot; as a value not as a logical operator", "body": "<p>In my requirement I have a column in which a cell value is defined as \">21\", <code>14-21</code> so on and I need to filter based on criteria <code>&gt;21</code> as a value not as a logical operator greater than 21.</p>\n\n<p>Im declaring</p>\n\n<pre><code>Const gt=\"&gt;21\"\n\nsub main()\n.\n.\n.\n.\nsample gt\n\nend sub\n\nsub sample(grt as string)\n.\n.\n.\n.\n.\n.\nSelection.autofilter field:=4 criteria1=grt\n\nEnd sub\n</code></pre>\n\n<p>Can any body help me on this please!!!!!!!!!!!!!!!!!!!!!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1468413402, "post_id": 38351884, "comment_id": 64116134, "body": "are you sure your <code>ActiveSheet</code> is the worksheet with the data you want <code>s</code> to refer to ? why not <code>s = ActiveWorkbook.Worksheet(&quot;wb_name&quot;).Cells(i, 1).Value</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 7, "last_activity_date": 1468413521, "creation_date": 1468413521, "answer_id": 38351992, "question_id": 38351884, "link": "https://stackoverflow.com/questions/38351884/why-activesheet-cells-dont-work/38351992#38351992", "title": "Why ActiveSheet.Cells() don&#39;t work?", "body": "<p>The rows start at 1, not 0 so you'll get an error when you're trying to access <code>.Cells(0,1)</code>. Start your <code>i</code> at 1 and it should be fine:</p>\n\n<pre><code>For i = 1 To 50\n    '...\nNext i\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6488394, "user_type": "registered", "profile_image": "https://graph.facebook.com/1701286416802078/picture?type=large", "display_name": "Jens Stenzeman", "link": "https://stackoverflow.com/users/6488394/jens-stenzeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6468, "favorite_count": 0, "accepted_answer_id": 38351992, "answer_count": 1, "score": 0, "last_activity_date": 1468420302, "creation_date": 1468413260, "last_edit_date": 1495540735, "question_id": 38351884, "link": "https://stackoverflow.com/questions/38351884/why-activesheet-cells-dont-work", "title": "Why ActiveSheet.Cells() don&#39;t work?", "body": "<p>I'am working on a VBA Module that reads Cells from a column of the active Workbook - the Output of an other Tool -, nothing spectecular, but it seems that I missed something.\nThe Solutions of similar Questions I read and tested them, but without any luck.\n<a href=\"https://stackoverflow.com/questions/32404582/get-value-from-a-cell-on-a-worksheet?rq=1\">Get Value from a cell on a worksheet</a> or\n<a href=\"https://stackoverflow.com/questions/19633721/gather-cells-and-write-it-in-active-worksheet#\">Gather Cells and write it in Active Worksheet</a>\nHere the Code until it throws \"1004\"</p>\n\n<pre><code>Dim FileName As String\nDim FileNameArray() As String\nDim VideoDataArray() As String\nDim TempString As String\nDim strPattern As String\n\nDim mot_H As Integer\nDim vok_H As Integer\nDim aufgest_H As Integer\nDim mot_S As Integer\nDim vok_S As Integer\nDim vis_Q As Integer\nDim aud_Q As Integer\nDim int_E As Integer\nDim i As Integer\n\n'Nehme den Dateinamen\nFileName = ActiveWorkbook.FullName\nDebug.Print FileName\n\n'Zerlege den Dateinamen\nFileNameArray() = Split(FileName, \"_\")\n\n'F\u00fclle ein Array mit den Daten\n    For i = 0 To 50\n\n    Dim s As String\n    s = ActiveSheet.Cells(i, 1).Value\n    TempString = TempString &amp; \"_\" &amp; s &amp; \"_\"\n\n    Next i\n</code></pre>\n\n<p>I am sure it is only a trivial failure, but I can't find it at the Moment.\nThank you very much!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1468418299, "post_id": 38351838, "comment_id": 64119898, "body": "Are you trying to resize an image by loading it into a command button?? Why?"}, {"owner": {"reputation": 3510, "user_id": 969400, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23a0c8dd29dc3a5975d5acb4cff362c2?s=128&d=identicon&r=PG", "display_name": "Nicero", "link": "https://stackoverflow.com/users/969400/nicero"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1468418976, "post_id": 38351838, "comment_id": 64120385, "body": "No no, the command button opens a dialog window (browse file) where the user selects an image. The image is then displayed into the <code>Me.Image1.Picture</code> image box."}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1468419109, "post_id": 38351838, "comment_id": 64120489, "body": "Well, LoadPicture has optional parameters x,y for requested height/width. What does that do for you?"}, {"owner": {"reputation": 3510, "user_id": 969400, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23a0c8dd29dc3a5975d5acb4cff362c2?s=128&d=identicon&r=PG", "display_name": "Nicero", "link": "https://stackoverflow.com/users/969400/nicero"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1468419313, "post_id": 38351838, "comment_id": 64120654, "body": "The <code>x y</code> parameters of <code>LoadPicture</code> are note related to setting the width or height of the image. I&#39;m looking for a way to resize an image and then save it (resized) to a file."}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1468421053, "post_id": 38351838, "comment_id": 64122064, "body": "I can only think of importing the picture into a shape, resizing the shape, converting the shape to either clipboard or OLEObject data and then saving it. Seems overly complicated --- you could use a console script to process the image using something like imagemagick instead. Maybe see <a href=\"https://stackoverflow.com/questions/18232987/export-pictures-from-excel-file-into-jpg-using-vba\" title=\"export pictures from excel file into jpg using vba\">stackoverflow.com/questions/18232987/&hellip;</a>"}, {"owner": {"reputation": 3510, "user_id": 969400, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23a0c8dd29dc3a5975d5acb4cff362c2?s=128&d=identicon&r=PG", "display_name": "Nicero", "link": "https://stackoverflow.com/users/969400/nicero"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1468422774, "post_id": 38351838, "comment_id": 64123371, "body": "Thank you for your time. Yes, it sounds really complicated. :-(("}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1468431997, "post_id": 38351838, "comment_id": 64129215, "body": "Add imagemagick as a COM+ object <a href=\"https://www.imagemagick.org/script/ImageMagickObject.php\" rel=\"nofollow noreferrer\">imagemagick.org/script/ImageMagickObject.php</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1469107897, "post_id": 38370593, "comment_id": 64409679, "body": "Cool! Glad to see you got it done. Your answer might help me too in the future when I refuse to do my general cmd/console output hackery."}], "tags": [], "owner": {"reputation": 3510, "user_id": 969400, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23a0c8dd29dc3a5975d5acb4cff362c2?s=128&d=identicon&r=PG", "display_name": "Nicero", "link": "https://stackoverflow.com/users/969400/nicero"}, "is_accepted": true, "score": 3, "last_activity_date": 1608624262, "last_edit_date": 1608624262, "creation_date": 1468488720, "answer_id": 38370593, "question_id": 38351838, "link": "https://stackoverflow.com/questions/38351838/excel-vba-save-resized-image-to-file/38370593#38370593", "title": "Excel Vba. Save resized image to file", "body": "<p><strong>SOLVED.</strong></p>\n<p>As suggested, I used <a href=\"https://imagemagick.org/index.php\" rel=\"nofollow noreferrer\">ImageMagick</a> (the following applies to v7.0.2-4).</p>\n<ol>\n<li><a href=\"https://www.imagemagick.org/script/download.php\" rel=\"nofollow noreferrer\">Download</a> the <em>dynamic</em> version ('Win32 dynamic at 16 bits-per-pixel component' or Win64)</li>\n<li>When installing select:\n<ul>\n<li>Add application directory to your system path</li>\n<li>Install ImageMagickObject OLE control for VBScript, VisualBasic and WSH</li>\n</ul>\n</li>\n</ol>\n<p><a href=\"https://i.stack.imgur.com/yT8sh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yT8sh.jpg\" alt=\"enter image description here\" /></a></p>\n<hr />\n<p>The following code opens a dialog window to select the image, calls ImageMagickObject OLE, resizes the image and saves it to a new file:</p>\n<pre><code>Private Sub CommandButtonImage_Click()\n    \n    Dim img\n    Set img = CreateObject(&quot;ImageMagickObject.MagickImage&quot;)\n    \n    With Application.FileDialog(msoFileDialogFilePicker)\n        .AllowMultiSelect = False\n        .ButtonName = &quot;Submit&quot;\n        .Title = &quot;Selezionare un'immagine&quot;\n        .Filters.Add &quot;Image&quot;, &quot;*.gif; *.jpg; *.jpeg; *.png&quot;, 1\n        If .Show = -1 Then\n            ' file has been selected\n         \n            ' fit image into image box\n            Me.Image1.PictureSizeMode = fmPictureSizeModeZoom\n            \n            ' display preview image in an image control\n            Me.Image1.Picture = LoadPicture(.SelectedItems(1))\n            \n            ' this will resize the selected image keeping the aspect ratio \n            ' but resizing will be done only to fit into the size given \n            ' ('&gt;' sign) and it will set the image name to 'resized.jpg'   \n            img.Convert .SelectedItems(1), &quot;-resize&quot;, &quot;300x300&gt;&quot;, &quot;c:\\resized.jpg&quot;\n            \n        Else\n            ' something\n        End If\n    End With\nEnd Sub\n</code></pre>\n<p>Other ImageMagick <a href=\"https://legacy.imagemagick.org/Usage/resize/#resize\" rel=\"nofollow noreferrer\">resize options</a>.</p>\n"}], "owner": {"reputation": 3510, "user_id": 969400, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23a0c8dd29dc3a5975d5acb4cff362c2?s=128&d=identicon&r=PG", "display_name": "Nicero", "link": "https://stackoverflow.com/users/969400/nicero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2867, "favorite_count": 1, "accepted_answer_id": 38370593, "answer_count": 1, "score": 1, "last_activity_date": 1608624262, "creation_date": 1468413152, "question_id": 38351838, "link": "https://stackoverflow.com/questions/38351838/excel-vba-save-resized-image-to-file", "title": "Excel Vba. Save resized image to file", "body": "<p>I'm trying to <strong>save to file a resized image</strong> loaded with <code>LoadPicture</code>. With the following code I load the image and resize it but I now understood that <code>Me.Image1.Width</code> resizes the image into the <code>image box</code> control for displaying purposes only.</p>\n\n<p>If I save the image with <code>savepicture()</code> the image saved is the same as loaded image.</p>\n\n<pre><code>Private Sub CommandButtonImage_Click()\n    With Application.FileDialog(msoFileDialogFilePicker)\n        .AllowMultiSelect = False\n        .ButtonName = \"Submit\"\n        .Title = \"Select a image\"\n        .Filters.Add \"Image\", \"*.gif; *.jpg; *.jpeg; *.png\", 1\n        If .Show = -1 Then\n            ' file has been selected\n\n            ' fit image into image box\n            Me.Image1.PictureSizeMode = fmPictureSizeModeZoom\n\n            ' display preview image in an image control\n            Me.Image1.Picture = LoadPicture(.SelectedItems(1))\n\n            ' resize image\n            Me.Image1.Width = 50\n\n        Else\n            ' something    \n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "outlook", "vba"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1468524912, "creation_date": 1468524912, "answer_id": 38382802, "question_id": 38351519, "link": "https://stackoverflow.com/questions/38351519/how-to-bring-up-message-if-email-closed-without-sending/38382802#38382802", "title": "How to bring up message if email closed without sending?", "body": "<p>You cannot do that in the Outlook Object Model. </p>\n\n<p>CDO 1.21 (no longer installed by Outlook or supported by Microsoft) used to raise an exception if the message was closed without sending. Your only two other alternatives are Extended MAPI (C++ or Delphi only) or <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow\">Redemption</a> - its <a href=\"http://www.dimastr.com/redemption/RDOMail.htm\" rel=\"nofollow\">RDOMail</a>.Display(true) method  will raise an exception (MAPI_E_USER_CANCEL) if the message is dismissed.</p>\n"}], "owner": {"reputation": 11, "user_id": 6584332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a79efabac0272c09c04e084a8fab80e3?s=128&d=identicon&r=PG&f=1", "display_name": "Lew", "link": "https://stackoverflow.com/users/6584332/lew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468524912, "creation_date": 1468412256, "last_edit_date": 1531164843, "question_id": 38351519, "link": "https://stackoverflow.com/questions/38351519/how-to-bring-up-message-if-email-closed-without-sending", "title": "How to bring up message if email closed without sending?", "body": "<p>I know this is very basic, but having a total mind blank right now.\nI have my basic code to send an email in outlook, but I need to know the line to bring up an error or message if the person closes the email without sending.</p>\n\n<pre><code>Set OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\n'Sends email\n\nWith OutMail\n    .to = \" someone@nowhere.com\"\n    .Subject = \" Rich Request\"\n    .HTMLBody = \"Please find attached new     request\"    .Attachments.AddApplication.ActiveWorkbook.FullName\n  .Display\n\nEnd With\n\nSet OutApp = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba", "shapes"], "answers": [{"comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468412015, "post_id": 38351377, "comment_id": 64115144, "body": "You can also just use <code>.Clear</code> if you don&#39;t want to preserve formatting"}, {"owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468412801, "post_id": 38351377, "comment_id": 64115678, "body": "To copy the shapes does not really suit me needs: I have a template in Excel, where the layout changes from time to time. The script shall transfer all the information from the old templates (about 150) to the new template format including annotations that come in the form of callouts."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468412854, "post_id": 38351377, "comment_id": 64115722, "body": "@derMax I&#39;m confused.  You need to copy more than the shapes or only the shapes?"}, {"owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468413015, "post_id": 38351377, "comment_id": 64115835, "body": "The template is kind of a userform, where most information is stored in the cells. All cells that are not intended to be edited by the user are locked. I need to transfer all the information from editable cells as well as all shapes on the chart. I already did the first task - now the shapes are what I havent achieved so far."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468413315, "post_id": 38351377, "comment_id": 64116068, "body": "@derMax Well using the third method i suggested would do all of that for you, but if not, try the second method.  Did you try it and it didn&#39;t work for you?"}, {"owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468413816, "post_id": 38351377, "comment_id": 64116416, "body": "The third method did not work - I have some merged cells, and apparently copying does not work well here. I also thought of the second method, but is not applicable since I also have pictures..."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468413858, "post_id": 38351377, "comment_id": 64116443, "body": "@derMax copying a sheet would preserve everything, including merged cells"}, {"owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468413925, "post_id": 38351377, "comment_id": 64116504, "body": "ok, let me check. Your idea might ruin the work of my morning. You mean simply with sheets.copy?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468413965, "post_id": 38351377, "comment_id": 64116536, "body": "@derMax yes.  Copy the sheet first and then change what you need to for the new template, rather than making a new sheet and copying all the individual items over"}, {"owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468414135, "post_id": 38351377, "comment_id": 64116673, "body": "Oh, I see what you mean. But I have various changes in the new template, including different conditional formatting styles, different formulas etc... Changing that inside VBA is possible, but a nightmare. Thus so far, I have an empty template where the formatting is already done and copy the content."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468414191, "post_id": 38351377, "comment_id": 64116716, "body": "@derMax then I would recommend cycling through the shapes and creating new ones with all properties identical, as suggested in my second method."}, {"owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468414239, "post_id": 38351377, "comment_id": 64116748, "body": ":) Which is a good idea, apart from the fact that I have pictures that I cant simply recreate. I will go for the other answer, as this works well as I can see so far. Thank you for your help."}, {"owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468414520, "post_id": 38351377, "comment_id": 64116948, "body": "Ok, the other answer did not really work. I will try some other things and get back to you as soon as I know how to do it"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 0, "last_activity_date": 1468411806, "creation_date": 1468411806, "answer_id": 38351377, "question_id": 38351247, "link": "https://stackoverflow.com/questions/38351247/excel-vba-copy-and-paste-shapes-at-same-position/38351377#38351377", "title": "Excel VBA: Copy and paste shapes at same position", "body": "<p>As far as I'm aware, there is no specific method to copy all of them.  You could try the regular <code>.Copy Destination:=...</code> method, but I'm not positive this will work.</p>\n\n<p>The alternative is to just generate a new shape on the new sheet with identical properties to the desired shape.  As you loop through the shapes on your current sheet, you would just need to create new shape objects with all of the same properties.</p>\n\n<p>The most effective method (although this depends slightly on your intentions) is just to copy the original worksheet, instead of generating a fresh sheet.  This will pull all the shapes (and other data) to the new sheet with all location and properties kept identical.  If you just need the shapes and none of the cell data, you can copy the sheet and then add <code>NewSheet.UsedRange.ClearContents</code> which will remove all the data but leave formatting intact.</p>\n"}, {"comments": [{"owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468414477, "post_id": 38351811, "comment_id": 64116917, "body": "Sorry, wrong shot, it does not work. I get an error message that I cant modify the &quot;top&quot; property of a range-object. Apparently &quot;selection&quot; does not give me the handle for the shape object."}, {"owner": {"reputation": 505, "user_id": 3047101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oV8MQ.jpg?s=128&g=1", "display_name": "Stephan", "link": "https://stackoverflow.com/users/3047101/stephan"}, "reply_to_user": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "edited": false, "score": 0, "creation_date": 1468414906, "post_id": 38351811, "comment_id": 64117242, "body": "I adjusted the code in my answer to avoid the use of <code>Selection.</code>"}], "tags": [], "owner": {"reputation": 505, "user_id": 3047101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oV8MQ.jpg?s=128&g=1", "display_name": "Stephan", "link": "https://stackoverflow.com/users/3047101/stephan"}, "is_accepted": true, "score": 3, "last_activity_date": 1468414887, "last_edit_date": 1468414887, "creation_date": 1468413083, "answer_id": 38351811, "question_id": 38351247, "link": "https://stackoverflow.com/questions/38351247/excel-vba-copy-and-paste-shapes-at-same-position/38351811#38351811", "title": "Excel VBA: Copy and paste shapes at same position", "body": "<p>The below code should get you going. Be aware that I'm using the internal sheet name in the code. (<code>Sheet1</code> and <code>Sheet2</code>. The names before the brackets in the Project Explorer)</p>\n\n<p>I used a bit of a workaround to avoid working with selections: You need to set the name of the shape first, because if it still has the standard name (e.g. \"Oval 3\") the name gets changed (\"Oval 4\"). In the end you can restore the original name of the shapes in both sheets.</p>\n\n<pre><code>Sub CopyShapes()\n\n    Dim s As Shape\n    Dim OriginalName As String\n\n    For Each s In Sheet1.Shapes\n        OriginalName = s.Name\n        s.Name = \"FixedName\"\n        s.Copy\n        Sheet2.Paste\n        Sheet2.Shapes(\"FixedName\").Top = s.Top\n        Sheet2.Shapes(\"FixedName\").Left = s.Left\n        s.Name = OriginalName\n        Sheet2.Shapes(\"FixedName\").Name = OriginalName\n    Next s\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong> Adjusted the code to avoid the use of <code>Selection.</code> as required in the comments</p>\n"}], "owner": {"reputation": 325, "user_id": 1428444, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3c08eaf4898688d7cdf17b2ec599add9?s=128&d=identicon&r=PG", "display_name": "derMax", "link": "https://stackoverflow.com/users/1428444/dermax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12709, "favorite_count": 1, "accepted_answer_id": 38351811, "answer_count": 2, "score": 1, "last_activity_date": 1468414887, "creation_date": 1468411428, "question_id": 38351247, "link": "https://stackoverflow.com/questions/38351247/excel-vba-copy-and-paste-shapes-at-same-position", "title": "Excel VBA: Copy and paste shapes at same position", "body": "<p>I want to copy all shapes from one worksheet and paste them on another worksheet at the same position. The shapes can be rectangular callouts or pictures. </p>\n\n<p>So far, I know how to loop through all shapes in my old worksheet: </p>\n\n<p><code>Dim s As Shape\nFor each s in Activesheet.Shapes\n...\nNext</code></p>\n\n<p>How do I copy and paste the shapes at the same position in another worksheet, say Sheets(\"new\")?</p>\n"}, {"tags": ["regex", "vba", "ms-word"], "comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1468410629, "post_id": 38350890, "comment_id": 64114175, "body": "Is it word or Excel? If it&#39;s both, how is each involved?"}, {"owner": {"reputation": 11, "user_id": 6584228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22178f1c201e36ce31da925371dbb54f?s=128&d=identicon&r=PG&f=1", "display_name": "Nandmp", "link": "https://stackoverflow.com/users/6584228/nandmp"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1468410866, "post_id": 38350890, "comment_id": 64114321, "body": "Word only, no excel"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1468410989, "post_id": 38350890, "comment_id": 64114400, "body": "So, the problem is that the highlight is set on the character before <code>?</code> or <code>!</code> with the 2nd and following matches, right? This is really strange because the match FirstIndex is calculated correctly."}, {"owner": {"reputation": 11, "user_id": 6584228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22178f1c201e36ce31da925371dbb54f?s=128&d=identicon&r=PG&f=1", "display_name": "Nandmp", "link": "https://stackoverflow.com/users/6584228/nandmp"}, "edited": false, "score": 0, "creation_date": 1468411072, "post_id": 38350890, "comment_id": 64114447, "body": "Index will be one before for every comment set in the text before the match."}, {"owner": {"reputation": 11, "user_id": 6584228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22178f1c201e36ce31da925371dbb54f?s=128&d=identicon&r=PG&f=1", "display_name": "Nandmp", "link": "https://stackoverflow.com/users/6584228/nandmp"}, "edited": false, "score": 0, "creation_date": 1468412242, "post_id": 38350890, "comment_id": 64115295, "body": "If there are comments on any part of the text before the appearance of a ? or ! the index will be one too less for every &quot;unique&quot; comment. i expect it to still highlight and comment on all following question or expressionmarks, even if there have been comments on parts of the text."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 6584387, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HYdb6JYuM-M/AAAAAAAAAAI/AAAAAAAAAFo/oi8-O84zpIs/photo.jpg?sz=128", "display_name": "Marius Schmack", "link": "https://stackoverflow.com/users/6584387/marius-schmack"}, "is_accepted": true, "score": 0, "last_activity_date": 1468414162, "creation_date": 1468414162, "answer_id": 38352245, "question_id": 38350890, "link": "https://stackoverflow.com/questions/38350890/word-vba-using-regex-and-comments/38352245#38352245", "title": "Word VBA using RegEx and Comments", "body": "<p>Not profound in regex so I tried a different approach to solve that problem. Hope it helps.</p>\n\n<pre><code>Sub Mark_QuestionAndExpressionMarks()\n\n    Dim charsToSearch As String\n\n    charsToSearch = \"?!\"\n\n    Dim doc As Document\n    Set doc = ActiveDocument\n\n    Dim j As Integer\n    For j = 1 To doc.Range.characters.Count\n        'Check if character is one of the searched ones\n        If (InStr(charsToSearch, doc.Range.characters(j)) &gt; 0) Then\n             Call HighlightAndComment(doc.Range.characters(j), \"Question or Expressionmark\")\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6584228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22178f1c201e36ce31da925371dbb54f?s=128&d=identicon&r=PG&f=1", "display_name": "Nandmp", "link": "https://stackoverflow.com/users/6584228/nandmp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "accepted_answer_id": 38352245, "answer_count": 1, "score": -2, "last_activity_date": 1468414162, "creation_date": 1468410490, "last_edit_date": 1468413232, "question_id": 38350890, "link": "https://stackoverflow.com/questions/38350890/word-vba-using-regex-and-comments", "title": "Word VBA using RegEx and Comments", "body": "<p>I am using RegEx with VBA Macros to find matches in a word file as the find function is not sufficient in some cases.\nMatches should be marked(working) and a comment should be appllied.\nHowever if i add comments(or comments already exist) the Match.FirstIndex gets thrown of by one for every previous comment.\nComments with the same text counting as one.</p>\n\n<p>Why is that? How to fix it?</p>\n\n<p>Simplified example:</p>\n\n<pre><code>Sub Mark_QuestionAndExpressionMarks()\n    Dim Match As Match\n    Dim Matches\n    Dim regEx As New regExp\n\n    regEx.Pattern = \"\\?|!\" 'regex for questionmark or expressionmark\n    regEx.IgnoreCase = False\n    regEx.Global = True\n\n    Set Matches = regEx.Execute(ActiveDocument.Content.Text) ' or ActiveDocument.Content.Text\n\n    For Each Match In Matches\n        Call HighlightAndComment(ActiveDocument.range(Match.FirstIndex, Match.FirstIndex + Len(Match.Value)), \"Question or Expressionmark\")\n// problem here as Match is realized correctly but the FirstIndex is off\n    Next\nEnd Sub\n\nSub HighlightAndComment(WordOrSentence As Object, comment As String)\n        WordOrSentence.HighlightColorIndex = wdYellow\n        Call ActiveDocument.range.Comments.Add(WordOrSentence, comment) \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468410776, "post_id": 38350975, "comment_id": 64114262, "body": "You also should reset the error handler after the object (and use a get object call instead)"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": true, "score": 1, "last_activity_date": 1468410733, "creation_date": 1468410733, "answer_id": 38350975, "question_id": 38350886, "link": "https://stackoverflow.com/questions/38350886/create-multiple-ppt-from-excel-using-vba/38350975#38350975", "title": "Create multiple PPT from Excel using VBA", "body": "<p>You don't want to create a new PPT application, what you need is a new PPT Presentation, and then add slides to that.  Easiest way is to add a variable for the presentation (ie <code>Dim PPPres As Powerpoint.Presentation</code>) and then add the new slides to that presentation</p>\n\n<p>Edit:  Including a version of the code that I use for initializing PPT presentations:</p>\n\n<pre><code>Dim PPApp As PowerPoint.Application\nDim PPPres As PowerPoint.Presentation\nDim PPSlide As PowerPoint.Slide\n\n'Open PPT if not running, otherwise select active instance\nOn Error Resume Next\nSet PPApp = GetObject(, \"PowerPoint.Application\")\nIf PPApp Is Nothing Then\n    'Open PowerPoint\n    Set PPApp = CreateObject(\"PowerPoint.Application\")\n    PPApp.Visible = True\nEnd If\nOn Error GoTo ErrHandler\n\n'Generate new Presentation and slide for graphic creation\nSet PPPres = PPApp.Presentations.Add\nSet PPSlide = PPPres.Slides.Add(1, ppLayoutBlank)\nPPApp.ActiveWindow.ViewType = ppViewSlide\nPPPres.PageSetup.SlideSize = ppSlideSizeOnScreen\nPPApp.ActiveWindow.WindowState = ppWindowMaximized\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6518340, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DNiGPOVFyHE/AAAAAAAAAAI/AAAAAAAAAvU/xe3p8ls3rK8/photo.jpg?sz=128", "display_name": "Nikhil Asati", "link": "https://stackoverflow.com/users/6518340/nikhil-asati"}, "is_accepted": false, "score": 0, "last_activity_date": 1545047674, "last_edit_date": 1545047674, "creation_date": 1544961405, "answer_id": 53801874, "question_id": 38350886, "link": "https://stackoverflow.com/questions/38350886/create-multiple-ppt-from-excel-using-vba/53801874#53801874", "title": "Create multiple PPT from Excel using VBA", "body": "<p>*' Code to convert excel to ppt using vba </p>\n\n<p>Sub ExcelToPowerPointv2()\n    Dim rng As Range\n    Dim PowerPointApp As Object\n    Dim myPresentation As Object\n    Dim mySlide As Object\n    Dim myShape As Object\n    Dim ArrayOne As Variant</p>\n\n<pre><code>'Create an Instance of PowerPoint\nOn Error Resume Next\n\n'Is PowerPoint already opened?\nSet PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n'Clear the error between errors\nErr.Clear\n\n'If PowerPoint is not already open then open PowerPoint\nIf PowerPointApp Is Nothing Then Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n\n'Handle if the PowerPoint Application is not found\nIf Err.Number = 429 Then\nMsgBox \"PowerPoint could not be found, aborting.\"\nExit Sub\nEnd If\n\nOn Error GoTo 0\n\n'Optimize Code\nApplication.ScreenUpdating = False\n\nArray_Sheet = Array(\"S1\", \"S2\")\n\n'Create a New Presentation\nSet myPresentation = PowerPointApp.Presentations.Add\nDim pptSlide As Slide\nDim pptLayout As CustomLayout\nDim sld As Slides\n\n'inside for loop, copy the elements of the sheet &amp; paste it on PPT\nFor n = 1 To 0 Step -1 '2 sheets less 1, because of the array index 0\nSet rng = ActiveWorkbook.Sheets(Array_Sheet(n)).Range(\"B2:B10\")\nrng.Copy\n\nSet mySlide = myPresentation.Slides.Add(1, 11) '11 = ppLayoutTitleOnly\nmySlide.Shapes.PasteSpecial DataType:=2  '2 = ppPasteEnhancedMetafile\n\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n'Set position:\nmyShape.Left = 66\nmyShape.Top = 152\nNext n\n\nDim PPslide As PowerPoint.Slide\n'Dim sld As Slide\nSlidesCount = myPresentation.Slides.Count\n\nFor SlideNumber = 1 To SlidesCount\nSet rng = ActiveWorkbook.Sheets(Array_Sheet(SlideNumber - 1)).Range(\"D2:D10\")\nrng.Copy\n'MsgBox (SlideNumber)\nSet PPslide = myPresentation.Slides(SlideNumber)\nPPslide.Shapes.PasteSpecial DataType:=2\nApplication.CutCopyMode = False\n'mySlide(SlideNumber).Shapes.PasteSpecial DataType:=2\nSet myShape = PPslide.Shapes(PPslide.Shapes.Count)\n'Set position:\nmyShape.Left = 66\nmyShape.Top = 300\nNext SlideNumber\n\nDim myTextbox As PowerPoint.Shape\nFor SlideNumber = 1 To SlidesCount\n'MsgBox (SlideNumber)\nWith myPresentation.Slides(SlideNumber)\nSet myTextbox = .Shapes.AddTextbox _\n(Orientation:=msoTextOrientationHorizontal, Left:=500, Top:=250, Width:=400, Height:=100)\nmyTextbox.TextFrame.TextRange.Text = \"Hello I am a text box\"\nEnd With\nNext SlideNumber\n\nEnd Sub\n\n'https://stackoverflow.com/questions/41803095/paste-a-range-from-excel-into-certain-slide-of-powerpoint-template-using-vba\n'Slide Count https://stackoverflow.com/questions/45391119/powerpoint-slide-count-variable-in-vba\n'http://www.java2s.com/Code/VBA-Excel-Access-Word/PowerPoint/UsetheAddTextboxMethodtoaddatextboxtotheeighthslideandassigntexttoit.htm\n'https://www.thespreadsheetguru.com/blog/2014/3/17/copy-paste-an-excel-range-into-powerpoint-with-vba\n'https://docs.microsoft.com/en-us/office/vba/api/powerpoint.shapes.addtextbox\n'https://img.chandoo.org/vba/Automatically_Create_PowerPoint_From_Excel_VBA_Code.txt*\n</code></pre>\n"}], "owner": {"reputation": 755, "user_id": 1008219, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/yIZg6.jpg?s=128&g=1", "display_name": "Singaravelan", "link": "https://stackoverflow.com/users/1008219/singaravelan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2557, "favorite_count": 1, "accepted_answer_id": 38350975, "answer_count": 2, "score": 1, "last_activity_date": 1545047674, "creation_date": 1468410482, "last_edit_date": 1545008367, "question_id": 38350886, "link": "https://stackoverflow.com/questions/38350886/create-multiple-ppt-from-excel-using-vba", "title": "Create multiple PPT from Excel using VBA", "body": "<p>I want to create multiple PPT files using VBA.</p>\n\n<p>Consider this case, PPT application has been opened.<br>\nWhen I run the macro, it should create a new PPT file but my macro appends slides on the open file.</p>\n\n<p>How to create a separate PPT file and do rest of things?</p>\n\n<p>Below is part of the code.</p>\n\n<pre><code>Dim newPowerPoint As Object 'PowerPoint.Application  '\nDim activeSlide As Object 'PowerPoint.Slide\nDim sht As Worksheet \n\nOn Error Resume Next\nSet newPowerPoint = CreateObject(\"PowerPoint.Application\")\n'If newPowerPoint Is Nothing Then\n    'Set newPowerPoint = New PowerPoint.Application\n'End If\n\nIf newPowerPoint.Presentations.Count = 0 Then\n    newPowerPoint.Presentations.Add\nEnd If\n\n'Show the PowerPoint\nnewPowerPoint.Visible = True\n\nFor Each sht In ActiveWorkbook.Sheets  \n    newPowerPoint.ActivePresentation.Slides.Add newPowerPoint.ActivePresentation.Slides.Count + 1, ppLayoutText\n    newPowerPoint.ActiveWindow.View.GotoSlide newPowerPoint.ActivePresentation.Slides.Count\n    Set activeSlide = newPowerPoint.ActivePresentation.Slides(newPowerPoint.ActivePresentation.Slides.Count)\n\n    activeSlide.Shapes(1).Delete\n    activeSlide.Shapes(1).Delete\n    Range(\"A1:T32\").Select\n    Selection.Copy\n    activeSlide.Shapes.PasteSpecial(DataType:=ppPasteEnhancedMetafile).Select\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468410227, "post_id": 38350753, "comment_id": 64113883, "body": "what is the error thrown?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6577141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43377c1664fb3ffbb563fe403be963f1?s=128&d=identicon&r=PG&f=1", "display_name": "wainseven", "link": "https://stackoverflow.com/users/6577141/wainseven"}, "edited": false, "score": 0, "creation_date": 1468416847, "post_id": 38350846, "comment_id": 64118737, "body": "Sorted! Thank you very much!"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": true, "score": 1, "last_activity_date": 1468410356, "creation_date": 1468410356, "answer_id": 38350846, "question_id": 38350753, "link": "https://stackoverflow.com/questions/38350753/counting-the-occurrences-of-names-using-vba/38350846#38350846", "title": "Counting the occurrences of names using VBA", "body": "<p>I think you are missing a parenthese in your function string, as well as escape quotes for the empty string, so it should be:</p>\n\n<pre><code> Range(\"Z2:Z\" &amp; lastrow).FormulaR1C1 = \"=LEN(RC[-22])-LEN(SUBSTITUTE(RC[-22], \"\";\"\", \"\"\"\"))+1\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468417030, "post_id": 38353170, "comment_id": 64118871, "body": "This won&#39;t work properly if there are blanks or merged cells in the range"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468417247, "post_id": 38353170, "comment_id": 64119056, "body": "@RGA Well, I clearly stated &quot;Here I&#39;m assuming the string names in <b>column A</b> and the number of names in <b>column B</b>&quot; in my answer. That&#39;s why I provided the Excel formula, too."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468417414, "post_id": 38353170, "comment_id": 64119188, "body": "OP already had the Formula in their code, that wasn&#39;t their problem.  And the reason it would fail is your <code>End(xlDown)</code> call.  If you don&#39;t believe me, go into a sheet, merge a few cells, start above them and see where <code>End(xlDown)</code> sends your selection. (Hint: It will select the merged cell even if there are contiguous values past that)"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468417467, "post_id": 38353170, "comment_id": 64119233, "body": "And the sentence you quoted to me isn&#39;t even grammatically correct.  What are you assuming?  You&#39;re missing an active verb"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468417678, "post_id": 38353170, "comment_id": 64119405, "body": "@RGA Sorry Sir, I&#39;m an ESL speaker"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468417762, "post_id": 38353170, "comment_id": 64119469, "body": "I realize reading what I sent that it sounds aggressive, which was not my intention.  Just trying to help you clarify your own answer"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468418010, "post_id": 38353170, "comment_id": 64119675, "body": "@RGA Thanks for your help. I really appreciate it. I wish I were good at speaking English so that I could convey my thought and convert it to the answer"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468418195, "post_id": 38353170, "comment_id": 64119834, "body": "Having seen your answers in Mathematics, it is definitely clear that you are more intelligent than your english alone conveys.  Keep practicing at it and I&#39;m sure your contributions will be recognized :)"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468418356, "post_id": 38353170, "comment_id": 64119944, "body": "@RGA Thanks for the vote of confidence, I really appreciate it :)"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468463094, "post_id": 38353170, "comment_id": 64141154, "body": "@RGA I fix my code. I think the blanks or merged cells in the range won&#39;t be a problem anymore if any"}], "tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": false, "score": 1, "last_activity_date": 1468479869, "last_edit_date": 1468479869, "creation_date": 1468416551, "answer_id": 38353170, "question_id": 38350753, "link": "https://stackoverflow.com/questions/38350753/counting-the-occurrences-of-names-using-vba/38353170#38353170", "title": "Counting the occurrences of names using VBA", "body": "<p>I realize that this answer doesn't answer your question but at least the following code  serve the same purpose. And to fix the problem if there are blanks or merged cells in the range as pointed out by Mr. RGA, I change the way to formulate variable <code>Last_Row</code></p>\n\n<pre><code>    Sub Count_Name()\n    Dim i As Long, Last_Row As Long\n    With Sheets(\"Sheet1\")\n        'It won't be a problem anymore if there are blanks or merged cells in the range using this line\n        Last_Row = Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        For i = 2 To Last_Row\n           If .Cells(i, \"A\") = \"\" Then\n                .Cells(i, \"B\") = 0\n           Else\n                .Cells(i, \"B\") = Len(.Cells(i, \"A\")) - Len(Replace(.Cells(i, \"A\"), \";\", \"\")) + 1\n           End If\n       Next i\n    End With\n    End Sub\n</code></pre>\n\n<p>Here I'm assuming the string names are in <strong>column A</strong>, the number of names are in <strong>column B</strong>,  and both of the data are in <strong>Sheet1</strong>. The equivalent Excel formula for the above code is</p>\n\n<pre><code>=LEN(A2) - LEN(SUBSTITUTE(A2, \";\", \"\")) + 1\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6577141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43377c1664fb3ffbb563fe403be963f1?s=128&d=identicon&r=PG&f=1", "display_name": "wainseven", "link": "https://stackoverflow.com/users/6577141/wainseven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 38350846, "answer_count": 2, "score": 1, "last_activity_date": 1468479869, "creation_date": 1468410072, "last_edit_date": 1468412388, "question_id": 38350753, "link": "https://stackoverflow.com/questions/38350753/counting-the-occurrences-of-names-using-vba", "title": "Counting the occurrences of names using VBA", "body": "<p>Sorry I am new to VBA. The Vlookup calls for Column X &amp; Y work fine. However, for column Z, I am trying to count the number of names in Column B, but an error kept popping up. I wonder why?</p>\n\n<pre><code>Dim lastrow As Long\nlastrow = Range(\"A2\").End(xlDown).Row\n\nRange(\"X2:X\" &amp; lastrow).FormulaR1C1 = \"=VLOOKUP(RC[-23],'Sheet2'!R1C1:R25000C10,7,0)\"\nRange(\"Y2:Y\" &amp; lastrow).FormulaR1C1 = \"=VLOOKUP(RC[-24],'Sheet2'!R1C1:R25000C10,2,0)\"\nRange(\"Z2:Z\" &amp; lastrow).FormulaR1C1 = \"=LEN(RC[-22]-LEN(SUBSTITUTE(RC[-22], \"\";\"\", \"\"))+1\"\nColumns(\"X:Z\").EntireColumn.AutoFit\n</code></pre>\n\n<p>Basically, what I am try to achieve is like the following. Column Z will autofill the occurrences of names in column B</p>\n\n<p><a href=\"https://i.stack.imgur.com/wTdVV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wTdVV.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "edited": false, "score": 0, "creation_date": 1468409753, "post_id": 38350300, "comment_id": 64113530, "body": "Thanks @Gareth,That was quick :)"}, {"owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "edited": false, "score": 1, "creation_date": 1468409940, "post_id": 38350300, "comment_id": 64113657, "body": "Oops!!Checked it now  again."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1468410038, "post_id": 38350300, "comment_id": 64113721, "body": "Correct me if I&#39;m wrong, however it looks like OP wants to count how many PDF&#39;s appear in a folder; you can&#39;t pass wild cards through to an fso filepath?"}, {"owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "reply_to_user": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1468411857, "post_id": 38350300, "comment_id": 64115032, "body": "@luke_t you are right.I want to count the pdf files and just realized if there are sub folders the answer provided by Gareth will not work.@Gareth so for being unclear here The folderpath contains sub folders too."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "edited": false, "score": 0, "creation_date": 1468416760, "post_id": 38350300, "comment_id": 64118666, "body": "@Neelesh The way you&#39;re originally counting the files is the quickest, as far as I am aware. I do not believe there are any built-in methods to work with filtered files within a folder."}], "tags": [], "owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "is_accepted": false, "score": 1, "last_activity_date": 1468408929, "creation_date": 1468408929, "answer_id": 38350300, "question_id": 38350110, "link": "https://stackoverflow.com/questions/38350110/display-folder-propertycontains/38350300#38350300", "title": "Display Folder Property:&quot;Contains&quot;", "body": "<p>The below function will return the number of files in a folder.</p>\n\n<pre><code>Function CountFiles(folderPath As String) As Long\n\n    Dim fso As Object\n    Dim files As Object\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set files = fso.GetFolder(folderPath).Files\n\n    CountFiles = files.Count\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468409095, "creation_date": 1468408455, "last_edit_date": 1468409095, "question_id": 38350110, "link": "https://stackoverflow.com/questions/38350110/display-folder-propertycontains", "title": "Display Folder Property:&quot;Contains&quot;", "body": "<p>I'm using following code to count the number of files in a folder. However, if there are more than 500 files it would be hard to loop through each file. So my question is, is it possible to fetch the Folder property -\"Contains\" instead of looping through each file.</p>\n\n<pre><code>Sub pdfcount()\n    Dim FolderPath As String, path As String, count As Integer\n    FolderPath = \"C:\\Documents and Settings\\FPY\\\"\n    path = FolderPath &amp;\"\\*.pdf\"\n    Filename = Dir(path)\n    Do While Filename &lt;&gt;\"\"\n        count = count +1\n        Filename = Dir()\n    Loop\n    Range(\"A1\").Value = count\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 788, "user_id": 4507149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3913c49f5baf6ef3467001151a1e6724?s=128&d=identicon&r=PG&f=1", "display_name": "TobiasR.", "link": "https://stackoverflow.com/users/4507149/tobiasr"}, "edited": false, "score": 0, "creation_date": 1468406954, "post_id": 38349463, "comment_id": 64111612, "body": "What did you try so far?"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1468407361, "post_id": 38349463, "comment_id": 64111888, "body": "Do some research about the <code>Worksheet_Change</code> event and see if that fit&#39;s your needs."}], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 3144505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc907c7947ecb936ec76c657357aa886?s=128&d=identicon&r=PG", "display_name": "Divyesh M.", "link": "https://stackoverflow.com/users/3144505/divyesh-m"}, "edited": false, "score": 0, "creation_date": 1468408249, "post_id": 38350000, "comment_id": 64112469, "body": "use this vba code and put into macro , do you have idea, right how to run this code and run it."}, {"owner": {"reputation": 56, "user_id": 3144505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc907c7947ecb936ec76c657357aa886?s=128&d=identicon&r=PG", "display_name": "Divyesh M.", "link": "https://stackoverflow.com/users/3144505/divyesh-m"}, "reply_to_user": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468412945, "post_id": 38350000, "comment_id": 64115784, "body": "send me snap of that error, as well the snap of code"}, {"owner": {"reputation": 56, "user_id": 3144505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc907c7947ecb936ec76c657357aa886?s=128&d=identicon&r=PG", "display_name": "Divyesh M.", "link": "https://stackoverflow.com/users/3144505/divyesh-m"}, "reply_to_user": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468413143, "post_id": 38350000, "comment_id": 64115942, "body": "I have updated the code , Please take latest code from above"}, {"owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468413892, "post_id": 38350000, "comment_id": 64116475, "body": "The code works fine thanks..  Maybe a stupid question but how do i make it run all the time..."}, {"owner": {"reputation": 56, "user_id": 3144505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc907c7947ecb936ec76c657357aa886?s=128&d=identicon&r=PG", "display_name": "Divyesh M.", "link": "https://stackoverflow.com/users/3144505/divyesh-m"}, "reply_to_user": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468414443, "post_id": 38350000, "comment_id": 64116896, "body": "call  that function code into worksheet_change event."}, {"owner": {"reputation": 56, "user_id": 3144505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc907c7947ecb936ec76c657357aa886?s=128&d=identicon&r=PG", "display_name": "Divyesh M.", "link": "https://stackoverflow.com/users/3144505/divyesh-m"}, "reply_to_user": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468414744, "post_id": 38350000, "comment_id": 64117136, "body": "please dont forget to rate this question helpfull or answered"}, {"owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468415093, "post_id": 38350000, "comment_id": 64117377, "body": "Currently only 60 but that will grow."}, {"owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468415116, "post_id": 38350000, "comment_id": 64117398, "body": "call that function code into worksheet_change event. what do you mean by this..  I am new to VBA"}, {"owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468417129, "post_id": 38350000, "comment_id": 64118957, "body": "Sorted it...  Thanks :)"}], "tags": [], "owner": {"reputation": 56, "user_id": 3144505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc907c7947ecb936ec76c657357aa886?s=128&d=identicon&r=PG", "display_name": "Divyesh M.", "link": "https://stackoverflow.com/users/3144505/divyesh-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1468413119, "last_edit_date": 1468413119, "creation_date": 1468408198, "answer_id": 38350000, "question_id": 38349463, "link": "https://stackoverflow.com/questions/38349463/zero-values-based-on-another-cells-content/38350000#38350000", "title": "Zero values based on another cells content", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Public Sub SetZeroForClosed()\r\nDim TRange As Range\r\n   Set TRange = ActiveSheet.UsedRange\r\n   For i = 1 To TRange.Rows.Count\r\n If VBA.LCase(VBA.Trim(TRange.Cells(i, 17).Value)) = VBA.LCase(\"Closed\") Then\r\n    TRange.Cells(i, 28).Value = 0\r\n    TRange.Cells(i, 30).Value = 0\r\n    TRange.Cells(i, 32).Value = 0\r\n    TRange.Cells(i, 38).Value = 0\r\n    TRange.Cells(i, 40).Value = 0\r\n    TRange.Cells(i, 42).Value = 0\r\n End If\r\n   Next i\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 38350000, "answer_count": 1, "score": 0, "last_activity_date": 1468413119, "creation_date": 1468406737, "question_id": 38349463, "link": "https://stackoverflow.com/questions/38349463/zero-values-based-on-another-cells-content", "title": "Zero values based on another cells content", "body": "<p>I am after a bit of code please.  </p>\n\n<p>I would like columns AB, AD, AF, AL, AN, AP to all revert to 0 if column Q is closed.  This is for each row.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468407073, "post_id": 38349171, "comment_id": 64111690, "body": "Show us what you have tried"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468407110, "post_id": 38349171, "comment_id": 64111714, "body": "This is not a free coding service"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1468409721, "post_id": 38349972, "comment_id": 64113505, "body": "Dear Sir i want to move these value to (remaining sheet) in one row Date               city       card type         card NO.     free    Card remaining 27/09/2016    erbil       35,000            27               1        3 Thanks for your support"}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1468412029, "post_id": 38349972, "comment_id": 64115152, "body": "Dear @Anastasiya-Romanova  i want to move these value to (remaining sheet) in one row  (27/09/2016  /  erbil   /    35,000    /        27       /        1   /     3) and i want to move the others like (erbil -- 4,8000)(soran --35,000)(soran-- 48,000)  and so on (last entered data with filter of city and card type)you can select last entered data by date in picture there are 3 columns with (erbil-35,000) i want to move the last one  Thanks for your kind support"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1468412736, "post_id": 38349972, "comment_id": 64115624, "body": "Dear Mr. @pashew, the 2nd code does the job by copying entire row 8 in &quot;Main Data Sheet&quot; to row 2 in &quot;Remaining&quot; sheet. But I don&#39;t understand your next request. Can you give me the picture of the data that you want to move instead of explaining using  words?"}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1468413618, "post_id": 38349972, "comment_id": 64116279, "body": "this line don&#39;t work givs error Sheets(\u201cMain Data Sheet\u201d).Rows(i).EntireRow.Copy"}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1468415379, "post_id": 38349972, "comment_id": 64117594, "body": "Amazing it&#39;s working Can i make it give me some of these data because i don&#39;t need all of theme and can you make it just give me data not format cells , in the remaining sheet i have different style thank you again you really helped me thank you"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1468416870, "post_id": 38349972, "comment_id": 64118752, "body": "@pashew In my opinion, you should ask another question for that request but make sure this time state clearly what you want and show your attempt. I&#39;m glad I can be of help"}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1468475243, "post_id": 38349972, "comment_id": 64144266, "body": "Dear  @Anastasiya-Romanova \u79c0 .. thank you for kind support i have what i need ..... thank you again  :)"}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1468930579, "post_id": 38349972, "comment_id": 64320625, "body": "Dear @Anastasiya-Romanova \u79c0 ... what if i add one more condition like (name)? that mean (city , name  and card type)----thank you in advance"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 1, "creation_date": 1468931632, "post_id": 38349972, "comment_id": 64321504, "body": "@pashew Add a variable <code>Name = Cells(i, &quot;D&quot;).Value</code> before the loop and change the condition to for example <code>If City = &quot;erbil&quot; And Mid(Cells(i, &quot;E&quot;), 1, 6) = &quot;35,000&quot; And Name = &quot;dana&quot; Then</code>"}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1469345482, "post_id": 38349972, "comment_id": 64490663, "body": "Dear @Anastasiya-Romanova \u79c0 . you really helped me . i have one last question ** :) ** ... what if i want to create another range of sheets based on monthly(create sheet for jan , feb ....and containing the whole data of this month) ? that mean 2 range of sheets the first range based on row(d) and the second range based on date (row c). i asked many people they didn&#39;t answer me....** thank you for your Kind support **"}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1469354540, "post_id": 38349972, "comment_id": 64492528, "body": "please help i really need it"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1469354919, "post_id": 38349972, "comment_id": 64492607, "body": "@pashew I&#39;ve just got online. Where is that question? Can you post it &amp; make sure this time you state clearly your request so I can help you"}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1469362930, "post_id": 38349972, "comment_id": 64494554, "body": "Dear @Anastasiya-Romanova \u79c0 . you really helped me . i have one last question ** :) ** ... what if i want to create another range of sheets based on monthly(create sheet for jan , feb ....and containing the whole data of this month) ? that mean 2 range of sheets the first range based on row(d) and the second range based on date (row c). i asked many people they didn&#39;t answer me....** thank you for your Kind support **"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1469363920, "post_id": 38349972, "comment_id": 64494852, "body": "@pashew You kept repeating your question but I&#39;m not really sure what are asking for that&#39;s why I ask you to post another question regarding your problem so that I can fully understand your request. I&#39;ll help you if I really understand your question completely"}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1469365432, "post_id": 38349972, "comment_id": 64495333, "body": "Sorry i am confused hhhh. see this link(<a href=\"http://stackoverflow.com/questions/38499331/extract-to-sheets-by-month\" title=\"extract to sheets by month\">stackoverflow.com/questions/38499331/extract-to-sheets-&zwnj;&#8203;by-month</a>) and you understand me :)"}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1469371481, "post_id": 38349972, "comment_id": 64497251, "body": ":my question in mentioned page is blocked if you can answer it here it will be greate"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1469372674, "post_id": 38349972, "comment_id": 64497679, "body": "Sorry, I couldn&#39;t help. It&#39;s out of my coding skills. Maybe you can update your question by adding flowchart of your algorithm so that someone here can help you."}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1469373073, "post_id": 38349972, "comment_id": 64497813, "body": "i am really appreciate your support and  thank you again"}], "tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": true, "score": 1, "last_activity_date": 1468414106, "last_edit_date": 1468414106, "creation_date": 1468408121, "answer_id": 38349972, "question_id": 38349171, "link": "https://stackoverflow.com/questions/38349171/find-last-row-of-specific-range-of-data-excel/38349972#38349972", "title": "Find last row of specific range of data excel", "body": "<p>If I understand your question correctly, then you try this code:</p>\n\n<pre><code>Sub MatchingCityAndCardType1()\nDim City As String, i As Long, Last_Row As Long\nLast_Row = Cells(Rows.Count, \"E\").End(xlUp).Row\n\nFor i = Last_Row To 2 Step -1\n    City = Cells(i, \"C\").Value\n    If City = \"erbil\" And Mid(Cells(i, \"E\"), 1, 6) = \"35,000\" Then\n        MsgBox \"The card remaining of \" &amp; City &amp; \" city with card type \" _\n        &amp; Cells(i, \"E\").Value &amp; \" is \" &amp; Cells(i, \"J\").Value &amp; \".\"\n        Exit For\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>The output of this code is</p>\n\n<p><a href=\"https://i.stack.imgur.com/cdXmo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cdXmo.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>As per pashew's request in the comment below, this code should work</p>\n\n<pre><code>    Sub MatchingCityAndCardType2()\n    Dim City As String, i As Long, Last_Row As Long\n    Last_Row = Cells(Rows.Count, \"E\").End(xlUp).Row\n\n    For i = Last_Row To 2 Step -1\n        City = Cells(i, \"C\").Value\n        If City = \"erbil\" And Mid(Cells(i, \"E\"), 1, 6) = \"35,000\" Then\n            'Set the range destination, Range(\u201cA2\u201d), depending on which \n            'range you want in Sheets(\u201cRemaining\u201d)\n            Rows(i).EntireRow.Copy Destination:=Worksheets(\"Remaining\").Range(\"A2\")\n            Exit For\n        End If\n    Next i\n    End Sub\n</code></pre>\n\n<p>I put this code in the worksheet code module: <strong>Main Data Sheet</strong>.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "edited": false, "score": 0, "creation_date": 1468413476, "post_id": 38350665, "comment_id": 64116171, "body": "Dear @Tom  i want to move these value to (remaining sheet) in one row (27/09/2016 / erbil / 35,000 / 27 / 1 / 3) and i want to move the others like (erbil -- 4,8000)(soran --35,000)(soran-- 48,000) and so on (last entered data with filter of city and card type)you can select last entered data by date in picture there are 3 columns with (erbil-35,000) i want to move the last one Thanks for your kind support"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1468409859, "creation_date": 1468409859, "answer_id": 38350665, "question_id": 38349171, "link": "https://stackoverflow.com/questions/38349171/find-last-row-of-specific-range-of-data-excel/38350665#38350665", "title": "Find last row of specific range of data excel", "body": "<p>There's a couple of ways you could approach this: </p>\n\n<ul>\n<li>Using the method Anastasiya-Romanova has stated.</li>\n<li>Using an Autofilter and special cells</li>\n<li>Using an Array</li>\n<li>And probably more</li>\n</ul>\n\n<p>This one uses the <code>find</code> method which is faster then looping.</p>\n\n<p>I'm assuming the card type is an integer value and not string, but if it is a string just updated the <code>CardType</code> as string and wrap the value in quotes.</p>\n\n<pre><code>Sub FindLastRow()\n    Dim city As String, FirstAddress As String\n    Dim CardType As Long\n    Dim rng As Range\n    Dim a\n\n    city = \"erbil\"\n    CardType = 35000\n\n    With ThisWorkbook.Sheets(\"Main Data Sheet\")\n        Set rng = .Range(.Cells(1, 1), .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, 10))\n    End With\n\n    With rng\n        Set a = .Find(what:=city, SearchDirection:=xlPrevious)\n\n        If Not a Is Nothing Then\n            FirstAddress = a.Address\n            Do\n                If a.Offset(0, 2) = CardType Then\n                    ' Update this part with whatever you want to do to the last row\n                    MsgBox a.Address\n                    Exit Do\n                Else\n                    Set a = .FindNext(a)\n                End If\n            Loop While Not a Is Nothing And a.Address &lt;&gt; FirstAddress\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "accepted_answer_id": 38349972, "answer_count": 2, "score": 0, "last_activity_date": 1468414106, "creation_date": 1468405921, "last_edit_date": 1468406590, "question_id": 38349171, "link": "https://stackoverflow.com/questions/38349171/find-last-row-of-specific-range-of-data-excel", "title": "Find last row of specific range of data excel", "body": "<p>I have an Excel sheet that contains these data (attached Picture)\n<img src=\"https://i.stack.imgur.com/I91u0.jpg\" alt=\"enter image description here\"></p>\n\n<p>I want to have the selected row in (Remaining sheet)\nThe selected row is last data of (35,000IQD) in erbil city.</p>\n\n<p>That means I want to have last row of in (specific) city with specific(card type)\n(there is two row of data of erbil city with card type 35,000 I want to give me the last one)\nThanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1468405984, "post_id": 38349148, "comment_id": 64111019, "body": "&quot;bugs out&quot;. What does it do? If it throws an error, whats the error?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1468406190, "post_id": 38349148, "comment_id": 64111154, "body": "You should put <code>Option Explicit</code> at the top of your module and declare all of your variables. Such heavy use of undeclared variables is a bug waiting to happen."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468406218, "post_id": 38349148, "comment_id": 64111170, "body": "You&#39;re probably trying to select a cell below the last available one, as you have no controls for stopping the loop if the name doesn&#39;t match."}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1468406418, "post_id": 38349148, "comment_id": 64111286, "body": "@Nick.McDermaid The error I get is &quot;Runtime error &#39;1004&#39; Application-defined or object-deined error&quot; and then just stops but if i use F8 to step through it, it will work"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468406505, "post_id": 38349148, "comment_id": 64111344, "body": "@Rory I neglected to mention this is my question but the code bugs out at the origional cell that was selected, so if A1 was selected befor ethe code was run it will remain there at the point it bugs out regardless of the [C7].select"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468406748, "post_id": 38349148, "comment_id": 64111488, "body": "You turned off screen updating, so it would appear that way even if another cell was selected."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1468406759, "post_id": 38349148, "comment_id": 64111495, "body": "you say in your comment you want to check row 3, but you are using the <code>ActiveCell.Offset(1, 0).Select</code> to go one row below. If you want to check row 3, you need to offest the Column like <code>ActiveCell.Offset(0, 1).Select</code>."}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1468406777, "post_id": 38349148, "comment_id": 64111502, "body": "@JohnColeman, Just used Options Explicit and cleaned up the undeclared variables, still the same issue"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468406844, "post_id": 38349148, "comment_id": 64111536, "body": "@Rory , As mentioned in the question I removed screen updating and still have the same issue"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1468407003, "post_id": 38349148, "comment_id": 64111650, "body": "First, please stop saying bugs out and tell us the actual error. Second, you said the error comes at the <code>activecell.offset</code> line, not the <code>[C7].Select</code> line. Which is it?"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468407232, "post_id": 38349148, "comment_id": 64111793, "body": "@Rory First I have given the full error in my first comment to Nick.McDermaid. Second the error message appears at <code>activecell.offset</code>"}, {"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1468407568, "post_id": 38349148, "comment_id": 64112018, "body": "@JohnColeman actually <code>[C7].Select</code> works fine - but correct that it&#39;s better to avoid using <code>Select</code>."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1468407741, "post_id": 38349148, "comment_id": 64112122, "body": "@nekomatic I just realized that -- I was used to thinking of things like [C7] as being an alias for the value, but apparently it can work as an object reference as well. I don&#39;t really use that syntax. Thanks."}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1468408273, "post_id": 38349148, "comment_id": 64112489, "body": "Would love to know the reson for the downvote so I can improve my question"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468408578, "post_id": 38349148, "comment_id": 64112704, "body": "Possible someone downvoted because this is <a href=\"http://stackoverflow.com/help/mcve\">not an MCVE</a>?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468408921, "post_id": 38349148, "comment_id": 64112938, "body": "When the error occurs, press debug, open the Immediate window (Ctrl+G) and type: <code>?Activecell.address</code> and press Enter. What is the result?"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468409191, "post_id": 38349148, "comment_id": 64113137, "body": "@Rory , It comes up with $A$33"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468409394, "post_id": 38349148, "comment_id": 64113283, "body": "Is the worksheet protected? Do you have a ScrollArea set?"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468409708, "post_id": 38349148, "comment_id": 64113495, "body": "@Rory , The sheet isnt protected, I dont know what a scrollarea is so as a default I would say no"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468409964, "post_id": 38349148, "comment_id": 64113674, "body": "Can you put a workbook somewhere that shows the problem? I can&#39;t see why that line would be a problem given your responses so far. (As an aside though, you really need to learn to code without <code>Select</code> and <code>Goto</code>.)"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1468410464, "post_id": 38349148, "comment_id": 64114059, "body": "@Rory , Unfortunally this is a work document (and on a work PC) so I cant upload anything and even if I could it has personal information in it which would risk my job, at best. So I cannot put the workbook somewhere to be viewed, sorry"}], "answers": [{"comments": [{"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1468408109, "post_id": 38349738, "comment_id": 64112367, "body": "I think you have the columns and rows the wrong way round for <code>Cells</code> it should be <code>Cells(RowNum, ColNum)</code>, so <code>Cells(7,3)</code> is <code>[C7]</code>. I am also wanting to move down the rows and not move along the columns"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1468408559, "post_id": 38349738, "comment_id": 64112688, "body": "you are right, allways getting them wrong when switching from cells to rows. So now I am really confused with the need to look for row 3 when he is slecting <code>Range(&quot;C7&quot;).Select</code> which is in row 7, did you understand where is he looking for the dates ?"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1468411205, "post_id": 38349738, "comment_id": 64114547, "body": "I think there has been a bit of miscommunication, when starting at <code>[C7].select</code> I am checking A7 (<code>sName = Cells(ActiveCell.Row, 1).Value</code>) for a persons name, it then needs to offset down the cells till it reachs that persons name. The problem is, is that <code>[C7].select</code> (or any other varation of .select) doesnt actually work (it runs past the code but doesnt execute it so no error message)"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1468421569, "post_id": 38349738, "comment_id": 64122476, "body": "Apologies for the late reply. My workbook was corrupted so no matter what anyone posted it seems that my error wouldnt go away, I have tried you code on a uncorrupted version of the file and it works fine."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1468413219, "last_edit_date": 1468413219, "creation_date": 1468407511, "answer_id": 38349738, "question_id": 38349148, "link": "https://stackoverflow.com/questions/38349148/vba-excel-2010-runtime-error-1004-application-defined-or-object-deined-error/38349738#38349738", "title": "VBA Excel 2010 - Runtime error &#39;1004&#39; Application-defined or object-deined error", "body": "<p>Hope I understand now, the code below find the row number in Column C, where the name is identical co the name in Cell A7. </p>\n\n<pre><code>' find last row in Column C\nlast_row = Cells(Rows.count, \"C\").End(xlUp).Row\n\n' find row number in column C where the name is identical to cell A7\nrow_found = Application.WorksheetFunction.Match(Range(\"A7\"), Range(\"C1:C\" &amp; last_row), 0)\nMsgBox \" Name found at Cell C\" &amp; last_row\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1468413733, "post_id": 38351851, "comment_id": 64116362, "body": "I have tried you code but the same issue happens at <code>Do Until (ActiveSheet.Cells(LngRow, 1) = sName) Or (ActiveSheet.Cells(LngRow, 1) = &quot;&quot;)</code> however this appears to be no fault other than my own, after speaking to several other colleagues it was suggested that I try the same thing in another excel document, it turns out my excel document with the code has been corrupted to a lesser extent. your code posted is a great example on how to run through cells without using .select though"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1468420965, "post_id": 38351851, "comment_id": 64122008, "body": "Once you fix the corruption does the above fix your issue, or does the fix corruption mean you have no issue?"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 1, "creation_date": 1468421323, "post_id": 38351851, "comment_id": 64122260, "body": "Since the corruption has been fixed my origional code works fine."}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 1, "creation_date": 1468421620, "post_id": 38351851, "comment_id": 64122511, "body": "I have tried your code on the uncorrupted version on the file and that worked fine (<code>Or (ActiveSheet.Cells(LngRow, 1) = &quot;&quot;)</code> needed to be removed but thats because of the formatting in my workbook)"}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1468420885, "last_edit_date": 1468420885, "creation_date": 1468413181, "answer_id": 38351851, "question_id": 38349148, "link": "https://stackoverflow.com/questions/38349148/vba-excel-2010-runtime-error-1004-application-defined-or-object-deined-error/38351851#38351851", "title": "VBA Excel 2010 - Runtime error &#39;1004&#39; Application-defined or object-deined error", "body": "<p>I'm taking the question to be:-</p>\n\n<p>It should run down the cells in column C looking at column A until it reaches the persons name (defined by sName), once it gets to that is will then exit the loop and continue with the rest of the code.</p>\n\n<p>(The above is paraphrased from your question)</p>\n\n<p>The code I am suggesting to replace is: -</p>\n\n<pre><code>[C7].Select\n'Do Until ActiveCell.Row &gt;= Finalrow\n'drop out of loop if no more dates detected in row 3\nDo Until sName = Cells(ActiveCell.Row, 1).Value\nActiveCell.Offset(1, 0).Select\nLoop\n</code></pre>\n\n<p>Replacing it with the below would fix the issue with minimal change: -</p>\n\n<pre><code>ActiveSheet.Cells(7, 3).Select\nDo Until sName = Cells(ActiveCell.Row, 1).Value\n    ActiveCell.Offset(1, 0).Select\nLoop\n</code></pre>\n\n<p>However, using select is not recommended and if <code>sName</code> is not found this would keep going to the end of the sheet where it would throw an error referring to exceeding the maximum sheet size being exceeded.</p>\n\n<p>I would suggest the below as a better replacement:-</p>\n\n<pre><code>Dim LngRow As Long\nLngRow = 7\nDo Until (ActiveSheet.Cells(LngRow, 1) = sName) Or (ActiveSheet.Cells(LngRow, 1) = \"\")\n    LngRow = LngRow + 1\nLoop\nIf ActiveSheet.Cells(LngRow, 1) = \"\" Then\n    MsgBox \"Pearson not found\"\n    Exit Sub\nElse\n    ActiveSheet.Cells(LngRow, 3).Select\nEnd If\n</code></pre>\n\n<p>(I have placed <code>ActiveSheet.Cells(LngRow, 3).Select</code> at the end as your remaining code may rely on the cell being selected)</p>\n"}, {"tags": [], "owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1468421735, "creation_date": 1468421735, "answer_id": 38355177, "question_id": 38349148, "link": "https://stackoverflow.com/questions/38349148/vba-excel-2010-runtime-error-1004-application-defined-or-object-deined-error/38355177#38355177", "title": "VBA Excel 2010 - Runtime error &#39;1004&#39; Application-defined or object-deined error", "body": "<p>To those that have helped,</p>\n\n<p>The issue has been resolved as this was a corruption in my workbook. </p>\n\n<p>Since this has been fixed (Moved everything into a new Excel document) my origional code is now working fine</p>\n\n<p>Thanks to all those that helps</p>\n"}], "owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 38355177, "answer_count": 3, "score": -1, "last_activity_date": 1468457714, "creation_date": 1468405865, "last_edit_date": 1468457714, "question_id": 38349148, "link": "https://stackoverflow.com/questions/38349148/vba-excel-2010-runtime-error-1004-application-defined-or-object-deined-error", "title": "VBA Excel 2010 - Runtime error &#39;1004&#39; Application-defined or object-deined error", "body": "<p><strong>EDIT:</strong></p>\n\n<p>So, it appears my excel document contain my code has corrupted thus causes the quite unusual problem, I thank you all for the help you have given. This has been resolved by moving all macros and sheets into a new excel document</p>\n\n<p>The code below will get the error message \"Runtime error '1004' Application-defined or object-deined error\" at <code>ActiveCell.Offset(1, 0).Select</code> at the bottom but when it is run the code also doesnt run the <code>[C7].Select</code> part either (but there is no error message at this point)</p>\n\n<p>I have tried using, <code>Range(\"C7\").select</code> and <code>Cells(7,3).select</code> which also dont work. I have also tried <code>Application.Wait</code> to see if the macro may have been too fast however this also doesnt resolve the issue, I have removed the <code>Application.ScreenUpdating = False</code> and again this doesnt work.</p>\n\n<p>I have tried this macro on 4 different PCs and 2 different versions of excel and all have the same issue.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Just to clear things up as I think my explination above may be a bit unclear</p>\n\n<p>The problem is currently with this section of code</p>\n\n<pre><code>[C7].Select\n'Do Until ActiveCell.Row &gt;= Finalrow\n'drop out of loop if no more dates detected in row 3\nDo Until sName = Cells(ActiveCell.Row, 1).Value\nActiveCell.Offset(1, 0).Select\nLoop\n</code></pre>\n\n<p>What happens when I run the code to this part of the code is the error message above will appear at <code>ActiveCell.Offset(1, 0).Select</code> this line, however <code>[C7].Select</code> also does not select cell C7 (it remains at the cell that was already selected). </p>\n\n<p>What is supposed to happen is that it runs down the cells in column C looking at column A until it reachs the persons name (defined by <code>sName</code>), once it gets to that is will then run the rest of the code (that I havent posted at I cant get further than this point, I can post the whole thing if requested)</p>\n\n<hr>\n\n<pre><code>Option Compare Text\nPublic sLeave As Integer, iAnnualLeave As Integer, sLeaveType As String\n\nSub LeaveChecker()\n\nDim iAnnualLeave As Integer\n\nbTrackingLeave = False\nbReachedEndOfChart = False\nbStartDateFound = False\n\n'Set Color with If Statement\n\n\n\nsTypeOfLeave = [D12].Value\n\nIf sTypeOfLeave = \"Annual Leave\" Then\nsLeaveType = \"AL\"\nElseIf sTypeOfLeave = \"Flexi Leave\" Then\nsLeaveType = \"FL\"\nsLeaveTypeAmPm = \"FL???\"\n\nElseIf sTypeOfLeave = \"Special Leave\" Then\nsLeaveType = \"SpL\"\nElseIf sTypeOfLeave = \"Study Leave\" Then\nsLeaveType = \"StL\"\nElseIf sTypeOfLeave = \"Meeting/Traning\" Then\nsLeaveType = \"M/T\"\nEnd If\n\n'Check to see if type of leave is populated\nIf sTypeOfLeave = \"\" Then\nMsgBox (\"Please Populate Type Of Leave\")\nEnd If\n\n\n\n\nApplication.ScreenUpdating = False\n\n'Find last sheet name\nSet ws = Sheets(Sheets.Count)\nsLastSheet = ws.Name\n\nsName = [M3].Value\n\nIf sName = \"\" Then\nMsgBox (\"Please Enter A Staff Members Name\")\nExit Sub\nEnd If\n\nSheets(ActiveSheet.Index + 1).Activate\n\nSearchNewSheet:\n\nIf ActiveSheet.Name = sLastSheet Then\nbReachedEndOfChart = True\nGoTo LastStage\nEnd If\n\nDo Until ActiveSheet.Name = sLastSheet 'Main   LOOP~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nIf bReachedEndOfChart = True Then GoTo FinalGather\n\n'Find Person Name\n\n\n[C7].Select\n'Do Until ActiveCell.Row &gt;= Finalrow\n'drop out of loop if no more dates detected in row 3\nDo Until sName = Cells(ActiveCell.Row, 1).Value\nActiveCell.Offset(1, 0).Select\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468405700, "post_id": 38349009, "comment_id": 64110865, "body": "Have you tried google, recording a macro, I think you could of got the answer in the time taken to add the question."}], "answers": [{"tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": false, "score": 0, "last_activity_date": 1468405932, "creation_date": 1468405932, "answer_id": 38349174, "question_id": 38349009, "link": "https://stackoverflow.com/questions/38349009/vba-macro-for-copying-and-pasting-columns-on-same-excel-sheet/38349174#38349174", "title": "VBA Macro for copying and pasting columns on same excel sheet", "body": "<p>Insert this line to your code</p>\n\n<pre><code>Range(\"B3:B100\").Copy Destination:=Range(\"C3:C100\")\n</code></pre>\n\n<p>The range destination can be changed depending on which range you want to paste the data.</p>\n"}], "owner": {"reputation": 29, "user_id": 5218793, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/764a458e84513e8472f95b8bc3b66115?s=128&d=identicon&r=PG&f=1", "display_name": "George Halford", "link": "https://stackoverflow.com/users/5218793/george-halford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1468405932, "creation_date": 1468405521, "question_id": 38349009, "link": "https://stackoverflow.com/questions/38349009/vba-macro-for-copying-and-pasting-columns-on-same-excel-sheet", "title": "VBA Macro for copying and pasting columns on same excel sheet", "body": "<p>I would like to know how to copy the 3rd row to the 100th row for the 2nd column into the 3rd column how would this be done?</p>\n"}, {"tags": ["excel", "checkbox", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 0, "last_activity_date": 1468407282, "creation_date": 1468407282, "answer_id": 38349663, "question_id": 38348852, "link": "https://stackoverflow.com/questions/38348852/add-date-upon-checkbox-tick-vba/38349663#38349663", "title": "add date upon checkbox tick vba", "body": "<p>Add the time call <code>Now</code> and store that value wherever you want your date-time stamp to be</p>\n"}], "owner": {"reputation": 1, "user_id": 5222871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5beb7833168ab58d871b30acb96990?s=128&d=identicon&r=PG&f=1", "display_name": "Dillon L", "link": "https://stackoverflow.com/users/5222871/dillon-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468407282, "creation_date": 1468405041, "last_edit_date": 1531164843, "question_id": 38348852, "link": "https://stackoverflow.com/questions/38348852/add-date-upon-checkbox-tick-vba", "title": "add date upon checkbox tick vba", "body": "<p>In excel vba I have added a checkbox to a worksheet, once this checkbox is ticked, I want to move a range of data from one worksheet to another. I have already written the code that moves the data across the worksheets, but I just want to find out how to add the date (and time maybe) that the checkbox was clicked into the range of cells that is being moved across,\nThanks</p>\n"}, {"tags": ["vba", "excel", "locking"], "comments": [{"owner": {"reputation": 4511, "user_id": 767642, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PktIl.jpg?s=128&g=1", "display_name": "Kannan Suresh", "link": "https://stackoverflow.com/users/767642/kannan-suresh"}, "edited": false, "score": 0, "creation_date": 1468404941, "post_id": 38348760, "comment_id": 64110370, "body": "Unprotect the sheet before editing and then protect again programmatically."}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1468405100, "post_id": 38348760, "comment_id": 64110478, "body": "check if this can help you <a href=\"http://stackoverflow.com/questions/36915492/copying-chart-from-locked-sheet\" title=\"copying chart from locked sheet\">stackoverflow.com/questions/36915492/&hellip;</a>"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468407500, "post_id": 38348760, "comment_id": 64111985, "body": "Its possible that the capital &quot;F&quot; in <code>UserInterfaceOnly</code> is giving you a problem (and not being recognized if <code>Option Explicit</code> is not declared)"}, {"owner": {"reputation": 49, "user_id": 6573890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8fd5ddf3645cdb35ba35ca7202776ea0?s=128&d=identicon&r=PG&f=1", "display_name": "PyVas", "link": "https://stackoverflow.com/users/6573890/pyvas"}, "reply_to_user": {"reputation": 4511, "user_id": 767642, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PktIl.jpg?s=128&g=1", "display_name": "Kannan Suresh", "link": "https://stackoverflow.com/users/767642/kannan-suresh"}, "edited": false, "score": 0, "creation_date": 1468413132, "post_id": 38348760, "comment_id": 64115933, "body": "@Ian: The other problem is with this solution, that the sheets scripts changing other sheets too, so this recursively will give me errors."}, {"owner": {"reputation": 49, "user_id": 6573890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8fd5ddf3645cdb35ba35ca7202776ea0?s=128&d=identicon&r=PG&f=1", "display_name": "PyVas", "link": "https://stackoverflow.com/users/6573890/pyvas"}, "reply_to_user": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1468413140, "post_id": 38348760, "comment_id": 64115939, "body": "@L.Dutch: Same problem. I already tried this."}, {"owner": {"reputation": 49, "user_id": 6573890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8fd5ddf3645cdb35ba35ca7202776ea0?s=128&d=identicon&r=PG&f=1", "display_name": "PyVas", "link": "https://stackoverflow.com/users/6573890/pyvas"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1468413143, "post_id": 38348760, "comment_id": 64115943, "body": "@RGA: This was a type, your were right, but it didn&#39;t solve the problem"}, {"owner": {"reputation": 4511, "user_id": 767642, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PktIl.jpg?s=128&g=1", "display_name": "Kannan Suresh", "link": "https://stackoverflow.com/users/767642/kannan-suresh"}, "edited": false, "score": 0, "creation_date": 1468477498, "post_id": 38348760, "comment_id": 64145247, "body": "@PyVas Write a subroutine to unprotect and protect all sheets in your excel file. Call the unprotect function before the code you want to run and then call the protect function."}, {"owner": {"reputation": 49, "user_id": 6573890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8fd5ddf3645cdb35ba35ca7202776ea0?s=128&d=identicon&r=PG&f=1", "display_name": "PyVas", "link": "https://stackoverflow.com/users/6573890/pyvas"}, "edited": false, "score": 0, "creation_date": 1468832791, "post_id": 38348760, "comment_id": 64270876, "body": "This is not working, because in Excel 2010 and above encryption algorythm is very slow and It takes so long protect all the sheets."}], "owner": {"reputation": 49, "user_id": 6573890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8fd5ddf3645cdb35ba35ca7202776ea0?s=128&d=identicon&r=PG&f=1", "display_name": "PyVas", "link": "https://stackoverflow.com/users/6573890/pyvas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468417038, "creation_date": 1468404804, "question_id": 38348760, "link": "https://stackoverflow.com/questions/38348760/vba-excel-script-with-locked-sheets", "title": "VBA Excel script with locked sheets", "body": "<p>I have a lot of VBA excel scripts which modifying the cells value. The scripts worked fine until I locked the sheets. After I locked sheets I get this error:\n<a href=\"http://i.stack.imgur.com/I9QKE.png\" rel=\"nofollow\">Click to see image</a></p>\n\n<p>I also read here that there is a way to enable to scripts only to modify cells value, like that:</p>\n\n<pre><code>    For Each Sh In Worksheets\n        Sh.Protect Password:=\"password\", UserInterFaceOnly:=True\n    Next\n</code></pre>\n\n<p>I locked sheets with this script, but It's working only until I reopen the workbook. After I closed and open again the locks on the sheet is sill active, but gives me the same error message.</p>\n\n<p>What is the best solution to use script with locked sheets?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1468400985, "post_id": 38347221, "comment_id": 64107671, "body": "You realize, that you are checking ANSI X12 and you are adding to Sheet1?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468401041, "post_id": 38347221, "comment_id": 64107707, "body": "What was the error?"}, {"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1468401506, "post_id": 38347221, "comment_id": 64108001, "body": "@Vityata I&#39;ve updated the code :) sorry for the typo"}, {"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468401595, "post_id": 38347221, "comment_id": 64108064, "body": "@Nathan_Sav Application-defined or object-defined error"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468402196, "post_id": 38347221, "comment_id": 64108494, "body": "and the error is where the **&lt; line is?"}, {"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468402411, "post_id": 38347221, "comment_id": 64108643, "body": "@Nathan_Sav yes after the If statement"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1468403875, "post_id": 38347221, "comment_id": 64109645, "body": "you can use <code>ThisWorkbook.Sheets(&quot;Sheet1&quot;).Cells(i, j).Interior.Color = vbGreen</code> but then you are limited to the colors VB keeps."}], "answers": [{"comments": [{"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1468402141, "post_id": 38347588, "comment_id": 64108452, "body": "In this line &quot;ThisWorkbook.Sheets(&quot;Sheet1&quot;).Cells(i, j).Interior.ColorIndex = 3&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1468402257, "post_id": 38347588, "comment_id": 64108542, "body": "write &gt;debug.Print ThisWorkbook.Sheets(&quot;Main&quot;).cells(i,j).address&lt; before it."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1468404171, "post_id": 38347588, "comment_id": 64109830, "body": "Yup. It works. I have changed the code. Just make sure you do not have &quot;Option Explicit&quot; anywhere on top. Because it is not exactly &quot;high quality&quot; code."}, {"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1468404409, "post_id": 38347588, "comment_id": 64109999, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/117187/discussion-between-peters-and-vityata\">continue this discussion in chat</a>."}, {"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1468404804, "post_id": 38347588, "comment_id": 64110276, "body": "I dont know why it&#39;s not working on me :( we almost have the same code right? Or I missed something different on your code?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1468405033, "post_id": 38347588, "comment_id": 64110435, "body": "Yup. No idea. Probably something with the text/value. Can you open a completely new Excel file and write my code there? Just change &quot;Tabelle1&quot; to &quot;sheet1&quot;."}, {"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1468483034, "post_id": 38347588, "comment_id": 64148211, "body": "it&#39;s working on the new excel file. Do you have any idea why it&#39;s not working on my excel file? I have a current feature in Sheet1 wherein we have to fill the cell with green for mandatory cells and remove this fill when cell value != NULL"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1468490792, "post_id": 38347588, "comment_id": 64153234, "body": "No idea, really. Have you tried the debug.print from my second comment here?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1468404152, "last_edit_date": 1468404152, "creation_date": 1468401769, "answer_id": 38347588, "question_id": 38347221, "link": "https://stackoverflow.com/questions/38347221/how-to-fill-color-in-a-cell-in-workbook-beforesave/38347588#38347588", "title": "How to Fill Color in A cell in Workbook_BeforeSave", "body": "<p>Try with this one (before save):</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    ThisWorkbook.Sheets(\"Tabelle1\").Cells(1, 1).Select\n\n    For i = 2 To 10\n        If ThisWorkbook.Sheets(\"Tabelle1\").Cells(i, 1).Value = \"YES\" Then\n            For j = 2 To 5\n                If ThisWorkbook.Sheets(\"Tabelle1\").Cells(i, j).Value = \"\" Then\n                    ThisWorkbook.Sheets(\"Tabelle1\").Cells(i, j).Interior.ColorIndex = 3\n                    '**&lt;insert format here&gt;**\n                End If\n            Next j\n        End If\n\n\n        If ThisWorkbook.Sheets(\"Tabelle1\").Cells(i, 1).Value = \"\" Then\n            For j = 2 To 5\n                If ThisWorkbook.Sheets(\"Tabelle1\").Cells(i, j).Value = \"\" Then\n                    ThisWorkbook.Sheets(\"Tabelle1\").Cells(i, j).Interior.ColorIndex = 3\n                    '**&lt;insert format here&gt;**\n                End If\n            Next j\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1468429641, "post_id": 38348130, "comment_id": 64127799, "body": "@PeterS, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1468603322, "post_id": 38348130, "comment_id": 64211877, "body": "@PeterS, it&#39;d be nice from you to give feedback to people trying at helping you"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470727737, "post_id": 38348130, "comment_id": 65054113, "body": "@PeterS, I see you keep asking in SO. It&#39;s fine. It&#39;d be fine you answer, too. Thank you."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1468403227, "creation_date": 1468403227, "answer_id": 38348130, "question_id": 38347221, "link": "https://stackoverflow.com/questions/38347221/how-to-fill-color-in-a-cell-in-workbook-beforesave/38348130#38348130", "title": "How to Fill Color in A cell in Workbook_BeforeSave", "body": "<p><code>Interior.ColorIndex</code> must work on range</p>\n\n<p>maybe is the logic that doesn't work as expected</p>\n\n<p>try this</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim i As Long\n\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        For i = 2 To 10\n            Select Case .Cells(i, 1).value\n                Case \"YES\"\n                    If WorksheetFunction.CountA(.Cells(i, 2).Resize(, 4)) &lt; 4 Then .Cells(i, 2).Resize(, 4).SpecialCells(xlCellTypeBlanks).Interior.ColorIndex = 3\n                Case \"NO\"\n                    If WorksheetFunction.CountA(.Cells(i, 2).Resize(, 4)) &lt; 4 Then .Cells(i, 2).Resize(, 4).SpecialCells(xlCellTypeBlanks).Interior.ColorIndex = 2\n            End Select\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1468404152, "creation_date": 1468400791, "last_edit_date": 1468401476, "question_id": 38347221, "link": "https://stackoverflow.com/questions/38347221/how-to-fill-color-in-a-cell-in-workbook-beforesave", "title": "How to Fill Color in A cell in Workbook_BeforeSave", "body": "<p>I currently have this code below:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nThisWorkbook.Sheets(\"Sheet1\").Cells(1, 1).Select\n\nFor i = 2 To 10\n    If ThisWorkbook.Sheets(\"Sheet1\").Cells(i, 1).Value = \"YES\" Then\n        For j = 2 To 5\n            If ThisWorkbook.Sheets(\"Sheet1\").Cells(i, j).Value = \"\" Then\n                **&lt;insert format here&gt;**\n            End If\n        Next j\n    End If\n\n\n    If ThisWorkbook.Sheets(\"Sheet1\").Cells(i, 1).Value = \"NO\" Then\n        For j = 2 To 5\n            If ThisWorkbook.Sheets(\"Sheet1\").Cells(i, j).Value = \"\" Then\n                **&lt;insert format here&gt;**\n            End If\n        Next j\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Now. I tried to add the code below inside the If statement but didn't worked</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Sheet1\").Cells(i, j).Interior.ColorIndex = 3\n</code></pre>\n\n<p>How can we add fill color to the cells without value?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1468401110, "post_id": 38347189, "comment_id": 64107756, "body": "Can you include your data or the picture of it on your question?"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1468402799, "post_id": 38347189, "comment_id": 64108922, "body": "Refer to your picture, are there any other data above <code>Cells(56,1)</code>?"}, {"owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "reply_to_user": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1468403662, "post_id": 38347189, "comment_id": 64109503, "body": "y sir , and the pb is that i can delete row above, that means that &quot;maintenance&quot; will up, and i want to copy all Under &quot;maintenance&quot;  In my code, i copy all Under row 58... :-/"}], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1468408072, "post_id": 38348661, "comment_id": 64112335, "body": "I want to copy all row Under &quot;maintenance&quot;, BUT the row of &quot;maintenance&quot; can change.  the pb is not when the row is ending, but when it start. In my code, it copies column B and C between 58 and when there is a &quot;x&quot; in column 1. but I want that the copy start when in column B its &quot;maintenance&quot;"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1468408592, "post_id": 38348661, "comment_id": 64112713, "body": "@babou Truth be told, I find hard to understand what you want. Can you elaborate your question to convey your request? And what is <b>pb</b>? Also, where do you want to paste the copied data?"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1468411496, "post_id": 38348661, "comment_id": 64114776, "body": "@babou Is &quot;maintenance&quot; in a merged cell? Are the above &quot;maintenance&quot; empty cells?"}, {"owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1468413070, "post_id": 38348661, "comment_id": 64115877, "body": "Maintenance is the text in cellule row 55, and no, above this its only full cells"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1468413234, "post_id": 38348661, "comment_id": 64116023, "body": "@babou I know &quot;maintenance&quot; in row 55, but is it a merged cell? Can you give a full picture of above &quot;maintenance&quot;?"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1468418608, "post_id": 38348661, "comment_id": 64120140, "body": "@babou I&#39;m really tired right now &amp; it&#39;s already late night here. If no one here helps you, I&#39;ll try my best to help you tomorrow. I hope you&#39;re fine with that."}], "tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": true, "score": 1, "last_activity_date": 1468484377, "last_edit_date": 1468484377, "creation_date": 1468404566, "answer_id": 38348661, "question_id": 38347189, "link": "https://stackoverflow.com/questions/38347189/start-a-condition-when-there-s-a-specific-text/38348661#38348661", "title": "Start a condition when there s a specific text", "body": "<p>If I understand your question correctly, then you may replace <code>n = 58 'start to look row 58</code> with the following code to determine the value of variable <code>n</code> as a start row.</p>\n\n<pre><code>Dim WordToFind As String, FirstWord As String\nDim FindWord\n\nWordToFind = \"Maintenance\"\n    With Sheets(\"1\").Range(\"A:C\")\n        Set FindWord = .Find(what:=WordToFind, SearchDirection:=xlNext)\n\n        If Not FindWord Is Nothing Then\n            FirstWord = FindWord.Row\n            Do\n                n = FindWord.Row + 1 'The value of n start from the row below \"Maintenance\"\n                Exit Do\n            Loop While Not FindWord Is Nothing And FindWord.Row &lt;&gt; FirstWord\n        Else\n            MsgBox \"There is no word \" &amp; WordToFind\n        Exit Sub\n        End If\n    End With\n</code></pre>\n\n<p>You can change the value <code>WordToFind</code> depending on a word or string you are looking for.</p>\n"}], "owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 38348661, "answer_count": 1, "score": -1, "last_activity_date": 1468484377, "creation_date": 1468400676, "last_edit_date": 1468414824, "question_id": 38347189, "link": "https://stackoverflow.com/questions/38347189/start-a-condition-when-there-s-a-specific-text", "title": "Start a condition when there s a specific text", "body": "<p>I want to copy the end of the column B and C in worksheet 1 \nTo column B and C in worksheet 2</p>\n\n<p>I have this :\n<a href=\"https://i.stack.imgur.com/go8ch.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/go8ch.png\" alt=\"Worksheet1\"></a></p>\n\n<p>and this is above : <a href=\"https://i.stack.imgur.com/OOUPp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OOUPp.png\" alt=\"above\"></a></p>\n\n<p>And here is the code</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>'Copy of \"Maintenances\" in worksheet 2\r\n                n = 58 'start to look row 58\r\n                j = 2 'copy in row 2 in worksheet 2\r\n                Sheets(\"1\").Select 'select sheet 1 \r\n             \r\n                Do While Cells(n, 1) &lt;&gt; \"x\" 'do for each cells untill there is a \"x\" in column A                    \r\n                    If Cells(n, 1) &lt;&gt; \"x\" Then 'if column A is empty, then :                    \r\n                        Sheets(\"2\").Cells(j, 2) = Sheets(\"1\").Cells(n, 2) '                             \r\nSheets(\"2\").Cells(j, 3) = Sheets(\"1\").Cells(n, 3) '                             \r\nj = j + 1\r\n                    End If 'fin du if\r\n                        n = n + 1\r\n                Loop 'retourne au do while</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I want to copy all row Under \"maintenance\" in worksheet 2, BUT the row of \"maintenance\" can change. the problem is not when the row is ending, but when it start. In my code, it copies column B and C between 58 and when there is a \"x\" in column 1. but I want that the copy start when in column B its \"maintenance\" </p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 0, "creation_date": 1468404010, "post_id": 38347011, "comment_id": 64109723, "body": "What have you done so far? I suggest you go from the last row of the name column until the top, check if the cell is empty and if so you copy the value from the previous cell. Try to do something and if it does not work, show it to us"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468404179, "post_id": 38347011, "comment_id": 64109835, "body": "You&#39;ll need to use the split function by chr(10) or chr(13)  best to try something first and post what you&#39;ve done though."}], "answers": [{"comments": [{"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1468420593, "post_id": 38353307, "comment_id": 64121679, "body": "Welcome to SO, Thanks for participating! Please read <a href=\"http://stackoverflow.com/help/how-to-answer\">how to answer</a>. I have removed opinions and personal comments, these should be added in comments."}], "tags": [], "owner": {"reputation": 1, "user_id": 6584704, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700830606860154/picture?type=large", "display_name": "Joshua Svt", "link": "https://stackoverflow.com/users/6584704/joshua-svt"}, "is_accepted": false, "score": 0, "last_activity_date": 1468454805, "last_edit_date": 1468454805, "creation_date": 1468416940, "answer_id": 38353307, "question_id": 38347011, "link": "https://stackoverflow.com/questions/38347011/excel-vba-transferring-multiline-cell-content-to-multiple-rows/38353307#38353307", "title": "excel vba - transferring multiline cell content to multiple rows", "body": "<p>Select column \"name\" then use Ctrl+G->bank->type \"=\" then hit down arrow and Ctrl +Enter-> all blank cells will be filled as shown as ur output data ( unmerge first if column \"name\" contains merged cells )</p>\n"}], "owner": {"reputation": 63, "user_id": 5317656, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/2bea3b887c4be41261257f6592b26ef0?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/5317656/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1468454805, "creation_date": 1468400220, "last_edit_date": 1468401432, "question_id": 38347011, "link": "https://stackoverflow.com/questions/38347011/excel-vba-transferring-multiline-cell-content-to-multiple-rows", "title": "excel vba - transferring multiline cell content to multiple rows", "body": "<p>In Excel, my requirement is to transfer multiline cell content to multiple rows. I have attached some sample input data and output data. Please let me know on how to proceed. Thanks in advance. <a href=\"https://i.stack.imgur.com/Q5EpK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q5EpK.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1468399573, "post_id": 38346616, "comment_id": 64106663, "body": "This exact issue is why I like to use a delimiter that is highly unlikely to &quot;naturally&quot; occur, like &quot;&lt;&gt;&quot; or something of that sort.  In terms of escaping the unintended delimiters, I think you will need to use replace to change the intended delimiters to something else and use some clever string logic to detect which should be replaced"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1468399959, "post_id": 38346616, "comment_id": 64106951, "body": "That would ofcourse be the most desired option. But unfortunately you can&#39;t always decide the delimiter and therefore have to deal with what third parties give you."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1468404180, "post_id": 38346616, "comment_id": 64109836, "body": "Are the not-delimiter-commas delimited by something themselves e.g. <code>&quot;Tom, Bob and Harry each have $1, how many $ in total?&quot;,&quot;$9&quot;</code> ?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1468409037, "post_id": 38346616, "comment_id": 64113023, "body": "If you can consider a numeric character as such a delimiter then yes. For example: &quot;Price: 0,09,Quantity 12,Sold: Yes&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1468410355, "post_id": 38350496, "comment_id": 64113972, "body": "That is indeed a neat solution. I wonder if there would be anything shorter though?"}, {"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1468411287, "post_id": 38350496, "comment_id": 64114621, "body": "Don&#39;t see how.. You could skip the second iteration, and handle empty values in the function that calls this, i.e. when using the data. I prefer to clean that sort of thing out a the source. Other than that, VB doesn&#39;t have great support for removing array entries."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1468412794, "post_id": 38350496, "comment_id": 64115669, "body": "I don&#39;t mean your code in specific, its written fairly efficient and clean. Just for the problem in general, does there exist a shorter solution."}, {"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1468413181, "post_id": 38350496, "comment_id": 64115978, "body": "Yep, using another separator. Could be as easy as a semicolon or pipe (<code>;</code>, <code>|</code>) instead of colon. But you said you can&#39;t control the sep, shame..."}], "tags": [], "owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "is_accepted": true, "score": 0, "last_activity_date": 1468410060, "last_edit_date": 1468410060, "creation_date": 1468409466, "answer_id": 38350496, "question_id": 38346616, "link": "https://stackoverflow.com/questions/38346616/split-escaping-certain-splits/38350496#38350496", "title": "Split, escaping certain splits", "body": "<p>One possibility, given this test data, is to loop through the array after splitting, and whenever there's no <code>:</code> in the string, add this entry to the previous one.</p>\n\n<p>The function that does this might look like this:</p>\n\n<pre><code>Public Function CleanUpSeparator(celldata As String) As String()\n    Dim ret() As String\n    Dim tmp() As String\n    Dim i As Integer, j As Integer\n\n    tmp = Split(celldata, \",\")\n    For i = 0 To UBound(tmp)\n        If InStr(1, tmp(i), \":\") &lt; 1 Then\n            ' Put this value on the previous line, and restore the comma\n            tmp(i - 1) = tmp(i - 1) &amp; \",\" &amp; tmp(i)\n            tmp(i) = \"\"\n        End If\n    Next i\n\n    j = 0\n    ReDim ret(j)\n    For i = 0 To UBound(tmp)\n        If tmp(i) &lt;&gt; \"\" Then\n            ret(j) = tmp(i)\n            j = j + 1\n            ReDim Preserve ret(j)\n        End If\n    Next i\n\n    ReDim Preserve ret(j - 1)\n\n    CleanUpSeparator = ret\nEnd Function\n</code></pre>\n\n<p>Note that there's room for improvement by making the separator caharacters <code>:</code> and <code>,</code> into parameters, for instance.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9841356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-siOjVcZkzy8/AAAAAAAAAAI/AAAAAAAABqY/KP4InwnSWRA/photo.jpg?sz=128", "display_name": "Stephen McNutt", "link": "https://stackoverflow.com/users/9841356/stephen-mcnutt"}, "is_accepted": false, "score": 0, "last_activity_date": 1527171955, "creation_date": 1527171955, "answer_id": 50511827, "question_id": 38346616, "link": "https://stackoverflow.com/questions/38346616/split-escaping-certain-splits/50511827#50511827", "title": "Split, escaping certain splits", "body": "<p>I spent the last 24 hours or so puzzling over what I THINK is a completely analogous problem, so I'll share my solution here.  Forgive me if I'm wrong about the applicability of my solution to this question. :-)</p>\n\n<p>My Problem: I have a SharePoint list in which teachers (I'm an elementary school technology specialist) enter end-of-year award certificates for me to print.  Teachers can enter multiple students' names for a given award, separating each name using a comma.  I have a VBA macro in Access that turns each name into a separate record for mail merging.  Okay, I lied.  That was more of a story.  HERE'S the problem: How can teachers add a student name like Hank Williams, Jr. (note the comma) without having the comma cause \"Jr.\" to be interpreted as a separate student in my macro?</p>\n\n<p>The full contents of the (SharePoint exported to Excel) field \"Students\" are stored within the macro in a variable called strStudentsBeforeSplit, and this string is eventually split with this statement:</p>\n\n<p>strStudents = Split(strStudentsBeforeSplit, \",\", -1, vbTextCompare)</p>\n\n<p>So there's the problem, really.  The Split function is using a comma as a separator, but poor student Hank Williams, Jr. has a comma in his name.  What to do?</p>\n\n<p>I spent a long time trying to figure out how to escape the comma.  If this is possible, I never figured it out.</p>\n\n<p>Lots of forum posts suggested using a different character as the separator.  That's okay, I guess, but here's the solution I came up with:</p>\n\n<ol>\n<li>Replace only the special commas preceding \"Jr\" with a different, uncommon character BEFORE the Split function runs.</li>\n<li>Swap back to the commas after Split runs.</li>\n</ol>\n\n<p>That's really the end of my post, but here are the lines from my macro that accomplish step 1.  This may or may not be of interest because it really just deals with the minutiae of making the swap.   Note that the code handles several different (mostly wrong) ways my teachers might type the \"Jr\" part of the name.</p>\n\n<pre><code>'Dealing with the comma before Jr.  This will handle \", Jr.\" and \", Jr\" and \" Jr.\" and \" Jr\".\n'Replaces the comma with ~ because commas are used to separate fields in Split function below.\n'Will swap ~ back to comma later in UpdateQ_Comma_for_Jr query.\nstrStudentsBeforeSplit = Replace(strStudentsBeforeSplit, \"Jr\", \"~ Jr.\") 'Every Jr gets this treatment regardless of what else is around it.\n'Note that because of previous Replace functions a few lines prior, the space between the comma and Jr will have been removed.  This adds it back.\nstrStudentsBeforeSplit = Replace(strStudentsBeforeSplit, \",~ Jr\", \"~ Jr\") 'If teacher had added a comma, strip it.\nstrStudentsBeforeSplit = Replace(strStudentsBeforeSplit, \" ~ Jr\", \"~ Jr\") 'In cases when teacher added Jr but no comma, remove the (now extra)...\n'...space that was before Jr.\n</code></pre>\n"}], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "accepted_answer_id": 38350496, "answer_count": 2, "score": 2, "last_activity_date": 1527171955, "creation_date": 1468399113, "last_edit_date": 1531164843, "question_id": 38346616, "link": "https://stackoverflow.com/questions/38346616/split-escaping-certain-splits", "title": "Split, escaping certain splits", "body": "<p>I have a cell that contains multiple questions and answers and is organised like a CSV. So to get all these questions and answers separated a simple split using the comma as the delimiter should separate this easily.</p>\n\n<p>Unfortunately, there are some values that use the comma as the decimal separator. Is there a way to escape the split for those occurrences?</p>\n\n<p>Fortunately, my data can be split using \", \" as separator, but if this wouldn't be the case, would there still be a solution besides manually replacing the decimal delimiter from a comma to a dot?</p>\n\n<p>Example:</p>\n\n<p>\"Price: 0,09,Quantity: 12,Sold: Yes\"\nUsing Split(\"Price: 0,09,Quantity: 12,Sold: Yes\",\",\") would yield:</p>\n\n<p>Price: 0<br>\n09<br>\nQuantity: 12<br>\nSold: Yes  </p>\n"}, {"tags": ["vb.net", "vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468396554, "post_id": 38345683, "comment_id": 64104824, "body": "What are the errors when it breaks?"}, {"owner": {"reputation": 23, "user_id": 6451318, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Yh5Ro.jpg?s=128&g=1", "display_name": "Sorx", "link": "https://stackoverflow.com/users/6451318/sorx"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1468396941, "post_id": 38345683, "comment_id": 64105067, "body": "There are no Errors :( It just finishes when it comes to objWorkbook.Worksheets(&quot;Tabelle1&quot;).Cells(i, 3).FormulaR1C1 = Formula"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1468397237, "post_id": 38345683, "comment_id": 64105238, "body": "I&#39;ve just tried, this <code>&quot;=SUM(R2C1,R2C2)&quot;</code> and it&#39;s fine, im not sure if you need to put the 1st 2 in as values."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1468397545, "post_id": 38345938, "comment_id": 64105413, "body": "Putting a constant (e.g. <b>5</b> or <b>&quot;text&quot;</b> in as a formula defaults to being put in as the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193.aspx\" rel=\"nofollow noreferrer\">Range.Value property</a> since they are not formulas."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1468399216, "post_id": 38345938, "comment_id": 64106406, "body": "fwiw, it is never a good idea to repurpose the name of a reserved word, property or method as a variable. Using <i>*myFormula</i> as the string would have been  infinitely more preferable. Yes, they are different and may be completely disparate to you but it can only lead of confusion when others view your code. I mean, seriously, you even proper cased the var."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1468399860, "post_id": 38345938, "comment_id": 64106886, "body": "True of course, although I&#39;m not OP, just interested ;) I recently had an issue with German R1C1/Z1S1 references myself so I was curious. (ps: you mixes up the last line, should be <code>.FormulaR1C1Local</code>. Now I&#39;m done!)"}, {"owner": {"reputation": 23, "user_id": 6451318, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Yh5Ro.jpg?s=128&g=1", "display_name": "Sorx", "link": "https://stackoverflow.com/users/6451318/sorx"}, "edited": false, "score": 0, "creation_date": 1468400084, "post_id": 38345938, "comment_id": 64107044, "body": "Can&#39;t ask another question yet so Jeeped I hope you might help me here :3; I got a new Problem with : destWorkbook.Worksheets(&quot;Intern&quot;).Cells(SumIndex, j + 8).NumberFormatLocal = &quot;0,00&quot; The fields which should be formatted get formatted with custom #.000"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1468400296, "post_id": 38345938, "comment_id": 64107194, "body": "<code>&quot;0.00&quot;</code> should work as a format mask for EN-US or DE-DE I believe. The laptop I&#39;m on doesn&#39;t have enough languages loaded to fully test. May be just use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196401.aspx\" rel=\"nofollow noreferrer\">Range.NumberFormat property</a>."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1468400767, "post_id": 38345938, "comment_id": 64107533, "body": "@Jeeped apart from the last line and the extra <code>)</code> in the 4th-to-last line it looks what I would expect to work properly. I don&#39;t have German installed either so I can&#39;t test it^^ I agree on deleting these comments..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1468400913, "last_edit_date": 1468400913, "creation_date": 1468397142, "answer_id": 38345938, "question_id": 38345683, "link": "https://stackoverflow.com/questions/38345683/formular1c1-doesnt-work-with-summe/38345938#38345938", "title": "FormulaR1C1 doesn&#39;t work with SUMME", "body": "<p>You have to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838851.aspx\" rel=\"nofollow\">Range.FormulaLocal property</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838568.aspx\" rel=\"nofollow\">Range.FormulaR1C1Local property</a> if you plan to use a string that contains non-EN-US function. VB.Net <strong>expects</strong> a EN-US formula and will translate that to the regional language of the worksheet.</p>\n\n<pre><code>Formula = \"=SUM(A1, B2)\"\n'or depending on your requiements,\nFormula = \"=SUM(A1:B2)\"\n.Formula = Formula\n\nFormula = \"=SUM(R1C1, R2C2)\"\n'or depending on your requiements,\nFormula = \"=SUM(R1C1:R2C2)\"\n.FormulaR1C1 = Formula\n\nFormula = \"=SUMME(Z1S1;Z2S1)\"\n'or depending on your requirements,\nFormula = \"=SUMME(Z1S1:Z2S1)\"\n.FormulaLocalR1C1 = Formula\n</code></pre>\n\n<p>Don't confuse xlA1 cell references with xlR1C1 references. <strong>R23</strong> would mean Cells(23, 18) in xlA1 and 23:23 in xlR1C1.</p>\n\n<p>Note that using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838835.aspx\" rel=\"nofollow\">Range.Formula property</a>  or <a href=\"https://msdn.microsoft.com/en-us/library/bb213527.aspx\" rel=\"nofollow\">Range.FormulaR1C1 property</a> enforces the use of a comma (EN-US standard) instead of a semicolon as a system list separator.</p>\n\n<hr>\n\n<p><sub>\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff838835.aspx\" rel=\"nofollow\">Range.Formula property</a><br/>\n<a href=\"https://msdn.microsoft.com/en-us/library/bb213527.aspx\" rel=\"nofollow\">Range.FormulaR1C1 property</a><br/>\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff838851.aspx\" rel=\"nofollow\">Range.FormulaLocal property</a><br/>\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff838568.aspx\" rel=\"nofollow\">Range.FormulaR1C1Local property</a><br/>\n</sub></p>\n"}], "owner": {"reputation": 23, "user_id": 6451318, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Yh5Ro.jpg?s=128&g=1", "display_name": "Sorx", "link": "https://stackoverflow.com/users/6451318/sorx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 1, "accepted_answer_id": 38345938, "answer_count": 1, "score": 1, "last_activity_date": 1468400913, "creation_date": 1468396363, "last_edit_date": 1468398447, "question_id": 38345683, "link": "https://stackoverflow.com/questions/38345683/formular1c1-doesnt-work-with-summe", "title": "FormulaR1C1 doesn&#39;t work with SUMME", "body": "<p>The FormulaR1C1 Method doesn't work as it's supposed to.</p>\n\n<pre><code>objExcel = CreateObject(\"Excel.Application\")\n    objWorkbook = objExcel.Workbooks.Add\n    Dim Formula As String\n    Formula = \"=SUMME(Z1S1;Z2S1)\"\n    For i = 1 To 5 Step 1\n        objWorkbook.Worksheets(\"Tabelle1\").Cells(i, 1).FormulaR1C1 = 5\n        objWorkbook.Worksheets(\"Tabelle1\").Cells(i, 5).FormulaR1C1 = \"Text\"\n        objWorkbook.Worksheets(\"Tabelle1\").Cells(i, 3).FormulaR1C1 = Formula\n    Next\n</code></pre>\n\n<p>This should give me 10 in the third column 5 times, but it doesn't. I even tried it with:</p>\n\n<pre><code>Formula = \"=SUMME(Z[0]S[-2];Z[1]S[-2])\"\n</code></pre>\n\n<p>but that doesn't work either. The Loop just breaks when coming to the assigment line :( . If I try it with </p>\n\n<pre><code>Formula = \"=SUMME(Z1S1,Z2S1)\"\n</code></pre>\n\n<p>It executes completely but it doesn't work for excel because then it says  =SUMME('Z1S1';'Z2S1') in the Excel Field</p>\n"}]