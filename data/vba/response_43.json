[{"tags": ["vba", "email", "outlook", "report"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1447109960, "post_id": 33534303, "comment_id": 55014293, "body": "(I removed &quot;Solved&quot; from your title. Since you accepted an answer, that is the proper indication  for others with a similar question.)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5451476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a266c59c29eff1e904ee64c54d42a8c3?s=128&d=identicon&r=PG&f=1", "display_name": "jerome Williams ", "link": "https://stackoverflow.com/users/5451476/jerome-williams"}, "edited": false, "score": 0, "creation_date": 1447107153, "post_id": 33534383, "comment_id": 55013037, "body": "This solution was interesting but at the bottom of the forum, there was another idea which I used to allow this to work out. Thanks!"}], "tags": [], "owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "is_accepted": false, "score": 0, "last_activity_date": 1446681543, "creation_date": 1446681543, "answer_id": 33534383, "question_id": 33534303, "link": "https://stackoverflow.com/questions/33534303/outlook-undeliverable-bounce-report-item-search-issues-vba/33534383#33534383", "title": "Outlook Undeliverable Bounce Report-Item Search Issues, VBA", "body": "<p>Well, there is always <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2013_release-customize/problem-in-vba-reading-text-from-body-of-out-of/1d8ca369-a4c0-41da-9d28-3f490de3ed8c\" rel=\"nofollow\">this</a> solution.</p>\n\n<p>The gist is that ReportItem.Body returns an unreadable string, so this solution saves the ReportItem as a text file, then parses the text file. Its not exactly elegant, but it should work.</p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5451476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a266c59c29eff1e904ee64c54d42a8c3?s=128&d=identicon&r=PG&f=1", "display_name": "jerome Williams ", "link": "https://stackoverflow.com/users/5451476/jerome-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1447107624, "creation_date": 1447107624, "answer_id": 33619390, "question_id": 33534303, "link": "https://stackoverflow.com/questions/33534303/outlook-undeliverable-bounce-report-item-search-issues-vba/33619390#33619390", "title": "Outlook Undeliverable Bounce Report-Item Search Issues, VBA", "body": "<p>The solution I ended up going with involved converting the body of the message back to Unicode and then searching for what I needed. This ended up being very simple to implement.</p>\n\n<p>Here is my finished, working code for future reference. I ended up adding a progress bar to monitor where it was in the code. It unfortunately runs fairly slow but it gets the job done.</p>\n\n<p>Hopefully this helps someone in the future!</p>\n\n<pre><code>On Error Resume Next\nSet myOlApp = Outlook.Application\nSet mynamespace = myOlApp.GetNamespace(\"MAPI\")\n\nSet xlobj = CreateObject(\"excel.application\")\nxlobj.Visible = True\nxlobj.Workbooks.Add\n\nxlobj.Range(\"a\" &amp; 1).Value = \"Email\"\nxlobj.Application.displayStatusBar = True\n\nFor I = 1 To myOlApp.ActiveExplorer.CurrentFolder.Items.Count\n    Set myitem = myOlApp.ActiveExplorer.CurrentFolder.Items(I)\n    msgtext = StrConv(myitem.Body, vbUnicode)\n\n    delimtedMessage = Replace(msgtext, \"mailto:\", \"###\")\n    delimtedMessage = Replace(delimtedMessage, \"&lt;/a&gt;&lt;br&gt;\", \"###\")\n    messageArray = Split(delimtedMessage, \"###\")\n\n    xlobj.Range(\"a\" &amp; I + 1).Value = Split(messageArray(1), \"\"\"\")(0)\n    xlobj.Application.StatusBar = \"Progress: \" &amp; I &amp; \" of \" &amp; myOlApp.ActiveExplorer.CurrentFolder.Items.Count &amp; Format(I / myOlApp.ActiveExplorer.CurrentFolder.Items.Count, \" 0%\")\nNext I\n\nxlobj.Application.displayStatusBar = False\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5451476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a266c59c29eff1e904ee64c54d42a8c3?s=128&d=identicon&r=PG&f=1", "display_name": "jerome Williams ", "link": "https://stackoverflow.com/users/5451476/jerome-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2030, "favorite_count": 0, "accepted_answer_id": 33619390, "answer_count": 2, "score": 0, "last_activity_date": 1447109985, "creation_date": 1446681062, "last_edit_date": 1447109985, "question_id": 33534303, "link": "https://stackoverflow.com/questions/33534303/outlook-undeliverable-bounce-report-item-search-issues-vba", "title": "Outlook Undeliverable Bounce Report-Item Search Issues, VBA", "body": "<p>I have some undeliverable emails in a folder. I am trying to go through each email in the folder and pull out the intended recipients email address by searching the message. </p>\n\n<p>I have some VBA code that works on regular emails, but since undeliverable's aren't Outlook \"Mail Items\", they are Outlook \"Report Items\", I am having issues searching the message. The search function is coming back empty and after a lot of research, it seems that maybe \"Report Items\" do not actually have a \"body\" that can be searched. </p>\n\n<p>The email in all the error reports are in the following format in the report.</p>\n\n<pre><code>(xxxxxx@xxxxxx.com)\n</code></pre>\n\n<p>Here is the code I am using, which works on normal Mail Items. </p>\n\n<pre><code>Sub Undeliver()\n\nOn Error Resume Next\nSet myOlApp = Outlook.Application\nSet mynamespace = myOlApp.GetNamespace(\"MAPI\")\n\n'Selects the current active folder to use\nSet myfolder = myOlApp.ActiveExplorer.CurrentFolder\n\n'creates excel spreadsheet where data will go\nSet xlobj = CreateObject(\"excel.application\")\nxlobj.Visible = True\nxlobj.Workbooks.Add\n\n'names column a row 1 \"email\" and column b row 1 \"else\"\nxlobj.Range(\"a\" &amp; 1).Value = \"Email\"\nxlobj.Range(\"b\" &amp; 1).Value = \"Else\"\n\n'loops through all the items in the current folder selected\nFor I = 1 To myfolder.Items.Count\n    Set myitem = myfolder.Items(I)\n\n    'selects the body of the current email being searched\n    msgtext = myitem.Body\n\n    'searches the body for the first open parentheses and first close\n    'parentheses and copies the value in between into an array\n    delimtedMessage = Replace(msgtext, \"(\", \"###\")\n    delimtedMessage = Replace(delimtedMessage, \")\", \"###\")\n\n    'splits the array up into two pieces\n    messageArray = Split(delimitedMessage, \"###\")\n\n    'this inputs the values of the array into my excel spreadsheet\n    xlobj.Range(\"a\" &amp; I + 1).Value = messageArray(1)\n    xlobj.Range(\"b\" &amp; I + 1).Value = messageArray(2)\nNext I\n\nEnd Sub\n</code></pre>\n\n<p>Does anyone know how I can access the message part of the report for searching purposes?</p>\n"}, {"tags": ["arrays", "vba", "excel", "random"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446681184, "post_id": 33534263, "comment_id": 54850042, "body": "<code>arr(15)</code> only gives you 15 elements."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1446681329, "post_id": 33534263, "comment_id": 54850086, "body": "So...have you tried anything"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1446681397, "post_id": 33534263, "comment_id": 54850102, "body": "<code>arr(15)</code> (aka <code>arr(0 to 15)</code>) gives 16 elements."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446681478, "post_id": 33534263, "comment_id": 54850130, "body": "I thought the number gives you number of elements so arr(15) would be 0-14? But Jeeped is always right ^_^; Edit: ah, the number is upperbound not elements. But if you have option base of 1, then it&#39;s elements =P Edit2: so I have been doing it all wrong XD"}, {"owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "edited": false, "score": 0, "creation_date": 1446681718, "post_id": 33534263, "comment_id": 54850194, "body": "Yeah, if just a single value is in the brackets, it treats it as the upper bound, with 0 as the lower bound."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446681823, "post_id": 33534263, "comment_id": 54850218, "body": "Possible <a href=\"http://stackoverflow.com/questions/18543169/unique-random-numbers-using-vba\">duplicate</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449064445, "post_id": 33534567, "comment_id": 55843413, "body": "No it wont, I thought of that in this code. If the rnd function returns a value that has already been used, it will just restart the loop."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449065878, "post_id": 33534567, "comment_id": 55844390, "body": "You are correct, I apologize and will delete my comment.  I missed the if statement.  This works great for the requested small subset.  I would be interested in knowing the average number loops to get them all filled.  By the odds there is a chance of an infinite loop if the subset got to large.  That is not what was asked, and this small of a subset would not run that risk."}, {"owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1449155547, "post_id": 33534567, "comment_id": 55891915, "body": "Yeah, as I said it isn&#39;t great code but it&#39;ll do the job here of you are only going to use it for small sets. I ran it 500 times and it took an average of 35 loops to complete, but all 500 took less than a second, so I&#39;m not too worried. If this was code for a serious production I would write it properly."}], "tags": [], "owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "is_accepted": false, "score": 1, "last_activity_date": 1446682828, "creation_date": 1446682828, "answer_id": 33534567, "question_id": 33534263, "link": "https://stackoverflow.com/questions/33534263/how-do-i-create-an-array-with-random-numbers/33534567#33534567", "title": "How do I create an array with random numbers?", "body": "<p>Here is some very lazy code:</p>\n\n<pre><code>Dim arr(15) As Integer\nDim i As Integer, j As Integer\ni = 1\nDo\n    j = Int(16 * Rnd)\n    If arr(j) = 0 Then\n        arr(j) = i\n        i = i + 1\n    End If\nLoop Until i = 17\n</code></pre>\n\n<p>Rnd generates a <code>single</code> from 0 to 1, multiply that by 16 and strip the decimal portion with <code>Int</code> and it will give you a random number from 0 to 15.</p>\n\n<p>It isn't efficient, I wouldn't use this in production, but it'll do the job.</p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1446693679, "creation_date": 1446693679, "answer_id": 33536101, "question_id": 33534263, "link": "https://stackoverflow.com/questions/33534263/how-do-i-create-an-array-with-random-numbers/33536101#33536101", "title": "How do I create an array with random numbers?", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub MAIN()\n   Dim ary(1 To 16) As Variant\n   Dim i As Long, msg As String\n\n   For i = 1 To 16\n      ary(i) = i\n   Next i\n\n   Call Shuffle(ary)\n\n   msg = \"\"\n   For i = 1 To 16\n      msg = msg &amp; vbCrLf &amp; ary(i)\n   Next i\n   MsgBox msg\nEnd Sub\n\nSub Shuffle(InOut() As Variant)\n    Dim HowMany As Long, i As Long, J As Long\n    Dim tempF As Double, temp As Variant\n\n    Hi = UBound(InOut)\n    Low = LBound(InOut)\n    ReDim Helper(Low To Hi) As Double\n    Randomize\n\n    For i = Low To Hi\n        Helper(i) = Rnd\n    Next i\n\n\n    J = (Hi - Low + 1) \\ 2\n    Do While J &gt; 0\n        For i = Low To Hi - J\n          If Helper(i) &gt; Helper(i + J) Then\n            tempF = Helper(i)\n            Helper(i) = Helper(i + J)\n            Helper(i + J) = tempF\n            temp = InOut(i)\n            InOut(i) = InOut(i + J)\n            InOut(i + J) = temp\n          End If\n        Next i\n        For i = Hi - J To Low Step -1\n          If Helper(i) &gt; Helper(i + J) Then\n            tempF = Helper(i)\n            Helper(i) = Helper(i + J)\n            Helper(i + J) = tempF\n            temp = InOut(i)\n            InOut(i) = InOut(i + J)\n            InOut(i + J) = temp\n          End If\n        Next i\n        J = J \\ 2\n    Loop\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/G5Ws3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G5Ws3.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 5526996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3205f0d2067f7c4c02985a812aa1d3dd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/5526996/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6800, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1446695533, "creation_date": 1446680858, "last_edit_date": 1531164843, "question_id": 33534263, "link": "https://stackoverflow.com/questions/33534263/how-do-i-create-an-array-with-random-numbers", "title": "How do I create an array with random numbers?", "body": "<p>I'm new at this. I want to create an array of 16 elements. Let's say that my array is ReDim arr(15) as Integer and in that array I want to put the numbers from 1 to 16 but scrambled, for example arr(0) = 3, arr(5) = 8 and so on.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 1, "creation_date": 1446680631, "post_id": 33534175, "comment_id": 54849865, "body": "Trying to select shapes may require selecting the sheet first.  Perhaps try adding the following <code>currentWB.Activate</code> and <code>currentWB.Worksheets(j).Select</code> before the line <code>currentWB.Worksheets(j).Shapes.SelectAll</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1446680894, "post_id": 33534175, "comment_id": 54849961, "body": "<code>currentWB</code> or <code>masterWB</code>? If they are intended to be different, does <code>currentWB</code> contain one more worksheet than <code>masterWB</code>"}, {"owner": {"reputation": 77, "user_id": 3764284, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Kds7a.jpg?s=128&g=1", "display_name": "Imamadmad", "link": "https://stackoverflow.com/users/3764284/imamadmad"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1446684420, "post_id": 33534175, "comment_id": 54850983, "body": "@Demetri Yup, that&#39;s worked! I just added the <code>currentWB.Worksheets(j).Select</code> line and it&#39;s now working!  Thanks for that! Can you please write that as an answer so I can accept it?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1446684584, "post_id": 33534175, "comment_id": 54851029, "body": "As it looks right now to me, he copies something to <code>currentWB.Worksheets(j)</code> earlier without any errors... that way we may need more informations..."}], "answers": [{"comments": [{"owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1446768067, "post_id": 33534649, "comment_id": 54893819, "body": "Good point. &#39;For i = 2 to currentWB.Worksheets.Count&#39; then, and &#39;currentWB.Worksheets(i).Shapes.Delete&#39; in the loop."}], "tags": [], "owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "is_accepted": false, "score": 2, "last_activity_date": 1446683395, "creation_date": 1446683395, "answer_id": 33534649, "question_id": 33534175, "link": "https://stackoverflow.com/questions/33534175/single-action-only-occurring-on-last-instance-of-loop-but-rest-of-actions-in-lo/33534649#33534649", "title": "Single action only occurring on last instance of loop (but rest of actions in loop working as expected)", "body": "<p>I'm not sure why you are looping through <code>masterWB</code>, but the shape delete operation relates to <code>currentWB</code> (as Jeeped states above), but try deleting the shapes directly rather than selecting them:</p>\n\n<pre><code>currentWB.Worksheets(j).Shapes.Delete\n</code></pre>\n\n<p>If that doesn't work, a separate loop perhaps:</p>\n\n<pre><code>Dim sht as worksheet\nFor each sht in currentWB.Worksheets\n    sht.shapes.delete\nnext sht\n</code></pre>\n\n<p>Something else worth noting - you are looping through sheets, but referring to worksheets by the same number. The Sheets collection contains worksheets, charts, macros, forms and other stuff - do you have any of these?</p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": true, "score": 2, "last_activity_date": 1446697873, "creation_date": 1446697873, "answer_id": 33536750, "question_id": 33534175, "link": "https://stackoverflow.com/questions/33534175/single-action-only-occurring-on-last-instance-of-loop-but-rest-of-actions-in-lo/33536750#33536750", "title": "Single action only occurring on last instance of loop (but rest of actions in loop working as expected)", "body": "<p>Trying to select shapes may require selecting the sheet first. Perhaps try adding the following currentWB.Activate and currentWB.Worksheets(j).Select before the line currentWB.Worksheets(j).Shapes.SelectAll</p>\n"}], "owner": {"reputation": 77, "user_id": 3764284, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Kds7a.jpg?s=128&g=1", "display_name": "Imamadmad", "link": "https://stackoverflow.com/users/3764284/imamadmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 33536750, "answer_count": 2, "score": 1, "last_activity_date": 1446697873, "creation_date": 1446680362, "last_edit_date": 1446682201, "question_id": 33534175, "link": "https://stackoverflow.com/questions/33534175/single-action-only-occurring-on-last-instance-of-loop-but-rest-of-actions-in-lo", "title": "Single action only occurring on last instance of loop (but rest of actions in loop working as expected)", "body": "<p>I have an Excel VBA macro that copies contents between files and sheets.  One of the things that it does is copy content from a template into new sheets and then fills in the information on those sheets from other files.  That's all working as expected.  What's not acting as expected is the code to delete the buttons and shapes carried over from the template sheet into the information sheets.  That code is within a for loop that acts on each page, yet it only is deleting these shapes from the last page while leaving them in place on every other page the loop touches. Everything else in the loop affects every page as expected.  </p>\n\n<p>The relevant section of my Macro is as follows. <code>masterWB</code> and <code>currentWB</code> are two separate workbooks:</p>\n\n<pre><code>For k = 1 To masterWB.Sheets.Count\n    j = k + 1\n\n    ' Removed because irrelevant to this query:\n    ' Copying of content from other workbooks to each sheet\n    ' Copying of formatting to all lines with content within sheet\n    ' All of this is still working as expected on every sheet.\n\n    ' Deletes button copied from first (template) sheet\n    currentWB.Worksheets(j).Shapes.SelectAll\n    Selection.Delete\n\nNext k\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "edited": false, "score": 1, "creation_date": 1446681159, "post_id": 33534098, "comment_id": 54850033, "body": "You can use excel to separate these out with Text to columns, using the double quote as a seperator. then just find replace &quot;) &gt; 0 Or InStr(1, TestVendor, &quot; with blanks, and use goto to delete blank cells. <a href=\"http://pastebin.com/GfHUdemn\" rel=\"nofollow noreferrer\">This</a> is the full list after that process."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "edited": false, "score": 0, "creation_date": 1446682110, "post_id": 33534098, "comment_id": 54850303, "body": "@AndrewWynn I started by pasting that Or statement into Notepad and doing some replaces but still had some noise when I pasted the result into VBA which I removed manually. It should be accurate but I didn&#39;t want to bet the farm on it. Your approach seems less error-prone than what I did."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "edited": false, "score": 0, "creation_date": 1446724012, "post_id": 33534098, "comment_id": 54867303, "body": "@AndrewWynn I just checked my list against yours and saw that they both had 56 elements, so I removed the disclaimer I had at the end of my answer. Thanks for the tip."}, {"owner": {"reputation": 21, "user_id": 5526875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038c7cbd97fcd5cfd0faad78b15dc7b3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulCalvert", "link": "https://stackoverflow.com/users/5526875/paulcalvert"}, "edited": false, "score": 0, "creation_date": 1446751717, "post_id": 33534098, "comment_id": 54885694, "body": "Thank you John! I was positive that there had to be a way to organize my IF statements into an Array, but I was unable to find how to do so. This ended up working and stopped my Excel from crashing when I ran the earlier Macro. I will try implementing your solution as well Andrew, it sounds like it would clean up my results after running the formula"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 21, "user_id": 5526875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038c7cbd97fcd5cfd0faad78b15dc7b3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulCalvert", "link": "https://stackoverflow.com/users/5526875/paulcalvert"}, "edited": false, "score": 0, "creation_date": 1446753703, "post_id": 33534098, "comment_id": 54886856, "body": "@PaulCalvert Glad it worked for you. Note that if some of the vendors like &quot;Fed Ex&quot; are more common than others than moving them earlier in the array could speed things up -- so sorting them by how common they are might help. Also note that if &quot;Federal Express&quot; is in your string then so is &quot;Federal Ex&quot; -- so there are some redundant cases which I didn&#39;t eliminate."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1446723889, "last_edit_date": 1446723889, "creation_date": 1446679877, "answer_id": 33534098, "question_id": 33533812, "link": "https://stackoverflow.com/questions/33533812/excel-formula-and-macro-not-compatible/33534098#33534098", "title": "Excel Formula and Macro not compatible?", "body": "<p>You can reduce the complexity of <code>Navs</code> by moving the target names into an array and looping:</p>\n\n<pre><code>Function NAVs(Vendor)\n\n    Dim TestVendor As String\n    Dim target As Variant, i As Long\n    TestVendor = UCase(Vendor)\n\n    target = Array(\"ADP\", \"FEDEX\", \"AFLAC\", \"AMERISOURCE\", \"ANTHEM\", \"AT&amp;T\", \"BELL SOUTH\", \"BLUE CROSS\", \"BLUE SHIELD\", _\n                   \"BLUECROSS\", \"C. H. ROBINSON\", \"CDW\", \"CH ROBINSON\", \"COMDATA\", \"COSTCO\", \"DEH SALES\", \"DELL\", _\n                   \"DEPARTMENT OF TREASURY\", \"ENTERGY\", \"FEDERAL EX\", \"FEDERAL EXPRESS\", \"FED EX\", _\n                   \"FOOD SERVICES OF AMERICA\", \"FRITO LAY\", \"GRAINGER\", \"INTERNAL REVENUE\", \"IRS\", \"KAISER\", _\n                   \"MC MASTER\", \"MCMASTER\", \"MERRITT EQUIP\", \"MICROSOFT\", \"NATIONAL GYPSUM\", \"OFFICE DEPOT\", _\n                   \"OLD DOMINION\", \"OTIS ELEVATOR\", \"OWENS &amp; MINOR\", \"OWENS AND MINOR\", \"OWENS&amp;MINOR\", _\n                   \"PEPSI\", \"PERMANENTE\", \"PITNEY BOWES\", \"PSE &amp; G\", \"PSE&amp;G\", \"PURCHASE POWER\", \"QUILL\", _\n                   \"STAPLES\", \"UNITED PARCEL SERVICE\", \"UNITED STATES TREASURY\", \"UPS\", \"US FOODS\", _\n                   \"US FOODSERVICE\", \"US TREASURY\", \"VERIZON\", \"WASTE MANAGEMENT\", \"XEROX\")\n    For i = 0 To UBound(target)\n        If InStr(1, TestVendor, target(i)) &gt; 0 Then\n            NAVs = \"NAV\"\n            Exit Function\n        End If\n    Next i\n\nEnd Function\n</code></pre>\n\n<p>As an added benefit -- this returns as soon as there is a match but VBA doesn't use short-circuit evaluation of <code>Or</code> so your original version would evaluate each clause every time.</p>\n\n<p>Whether or not this will solve your problem -- I have no idea. Try and see. </p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5526875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038c7cbd97fcd5cfd0faad78b15dc7b3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulCalvert", "link": "https://stackoverflow.com/users/5526875/paulcalvert"}, "edited": false, "score": 0, "creation_date": 1446753793, "post_id": 33534250, "comment_id": 54886904, "body": "I had not considered using this approach. I am writing another process to help mark personal names in a vendor list, and this may be a good way to go about it. Thanks Andrew!"}], "tags": [], "owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "is_accepted": false, "score": 0, "last_activity_date": 1446680800, "creation_date": 1446680800, "answer_id": 33534250, "question_id": 33533812, "link": "https://stackoverflow.com/questions/33533812/excel-formula-and-macro-not-compatible/33534250#33534250", "title": "Excel Formula and Macro not compatible?", "body": "<p>So are you using the NAVs function on the worksheet? Because Custom User Functions are a big resource hog, if you are running this on a lot of cells, it will slow down considerably, and any time you do anything, or anything changes, it has to rerun all of that code multiplied by all of the cells which contain it.</p>\n\n<p>So when the splitter writes any value to a cell, it has to recalculate all NAVs again. Every single time.</p>\n\n<p>I would recommend instead using the function off-sheet whenever you need it, as it looks like it doesn't need to recalculate at all, so just do something like this:</p>\n\n<pre><code>Sub DispNavs()\n    Dim cel as Range\n    For each cel in Range(\"Put a range here, in the format A1:A500\")\n        cel.offset(,1).value = Navs(cel.value)\n    Next cel\nEnd Sub\n</code></pre>\n\n<p>This will write the value returned by your function into the cells to the right of the range you provide, and of course, you should remove the function from the worksheet itself</p>\n\n<p>Having said that, you could also disable calculation with <code>application.calculation = xlManual</code> at the start of your splitter module, and reenable it with <code>application.calculation = xlAutomatic</code> at the end.</p>\n\n<p>Let me know how this goes, or if for some reason, neither solution helps.</p>\n"}], "owner": {"reputation": 21, "user_id": 5526875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038c7cbd97fcd5cfd0faad78b15dc7b3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulCalvert", "link": "https://stackoverflow.com/users/5526875/paulcalvert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447056858, "creation_date": 1446678544, "last_edit_date": 1447056858, "question_id": 33533812, "link": "https://stackoverflow.com/questions/33533812/excel-formula-and-macro-not-compatible", "title": "Excel Formula and Macro not compatible?", "body": "<p>I am working on creating some new macros and formulas to help automate our work in the office. We process a lot of company information, so the formula I wrote is a company identification process that marks all companies in the list as \"NAV\". The Macro we are using takes a combined address cell and expands it out into multiple columns (Ad1, Ad2, City, State, Zip). Both would be very handy in taking out some of the busy work that we have to deal with.</p>\n\n<p>The problem that I have been experiencing is that when the formula is active in the Add-In (toggled), running the macro in file will cause Excel to time out and freeze. The formula by itself works even when the Macro is installed, and the macro runs successfully when the company identification formula is not active. I had thought that it was a memory issue, but I am running this in Excel 2016 64 Bit, which I thought was only limited by the physical memory (8GB on the tower). Is the problem actually the memory, or is there a conflict between the two processes?</p>\n\n<p>The Company Identification formula is below:</p>\n\n<pre><code>Function NAVs(Vendor)\n\nDim TestVendor As String\nTestVendor = UCase(Vendor)\n\nIf InStr(1, TestVendor, \"ADP\") &gt; 0 Or InStr(1, TestVendor, \"FEDEX\") &gt; 0 Or InStr(1, TestVendor, \"AFLAC\") &gt; 0 Or InStr(1, TestVendor, \"AMERISOURCE\") &gt; 0 Or InStr(1, TestVendor, \"ANTHEM\") &gt; 0 Or InStr(1, TestVendor, \"AT&amp;T\") &gt; 0 Or InStr(1, TestVendor, \"BELL SOUTH\") &gt; 0 Or InStr(1, TestVendor, \"BLUE CROSS\") &gt; 0 Or InStr(1, TestVendor, \"BLUE SHIELD\") &gt; 0 Or InStr(1, TestVendor, \"BLUECROSS\") &gt; 0 Or InStr(1, TestVendor, \"C. H. ROBINSON\") &gt; 0 Or InStr(1, TestVendor, \"CDW\") &gt; 0 Or InStr(1, TestVendor, \"CH ROBINSON\") &gt; 0 Or InStr(1, TestVendor, \"COMDATA\") &gt; 0 Or InStr(1, TestVendor, \"COSTCO\") &gt; 0 Or InStr(1, TestVendor, \"DEH SALES\") &gt; 0 Or InStr(1, TestVendor, \"DELL\") &gt; 0 Or InStr(1, TestVendor, \"DEPARTMENT OF TREASURY\") &gt; 0 _\n    Or InStr(1, TestVendor, \"ENTERGY\") &gt; 0 Or InStr(1, TestVendor, \"FEDERAL EX\") &gt; 0 Or InStr(1, TestVendor, \"FEDERAL EXPRESS\") &gt; 0 Or InStr(1, TestVendor, \"FED EX\") &gt; 0 Or InStr(1, TestVendor, \"FOOD SERVICES OF AMERICA\") &gt; 0 Or InStr(1, TestVendor, \"FRITO LAY\") &gt; 0 Or InStr(1, TestVendor, \"GRAINGER\") &gt; 0 Or InStr(1, TestVendor, \"INTERNAL REVENUE\") &gt; 0 Or InStr(1, TestVendor, \"IRS\") &gt; 0 Or InStr(1, TestVendor, \"KAISER\") &gt; 0 Or InStr(1, TestVendor, \"MC MASTER\") &gt; 0 Or InStr(1, TestVendor, \"MCMASTER\") &gt; 0 Or InStr(1, TestVendor, \"MERRITT EQUIP\") &gt; 0 Or InStr(1, TestVendor, \"MICROSOFT\") &gt; 0 Or InStr(1, TestVendor, \"NATIONAL GYPSUM\") &gt; 0 Or InStr(1, TestVendor, \"OFFICE DEPOT\") &gt; 0 Or InStr(1, TestVendor, \"OLD DOMINION\") &gt; 0 Or InStr(1, TestVendor, \"OTIS ELEVATOR\") &gt; 0 Or InStr(1, TestVendor, \"OWENS &amp; MINOR\") &gt; 0 Or InStr(1, TestVendor, \"OWENS AND MINOR\") &gt; 0 Or InStr(1, TestVendor, \"OWENS&amp;MINOR\") &gt; 0 _\n    Or InStr(1, TestVendor, \"PEPSI\") &gt; 0 Or InStr(1, TestVendor, \"PERMANENTE\") &gt; 0 Or InStr(1, TestVendor, \"PITNEY BOWES\") &gt; 0 Or InStr(1, TestVendor, \"PSE &amp; G\") &gt; 0 Or InStr(1, TestVendor, \"PSE&amp;G\") &gt; 0 Or InStr(1, TestVendor, \"PURCHASE POWER\") &gt; 0 Or InStr(1, TestVendor, \"QUILL\") &gt; 0 Or InStr(1, TestVendor, \"STAPLES\") &gt; 0 Or InStr(1, TestVendor, \"UNITED PARCEL SERVICE\") &gt; 0 Or InStr(1, TestVendor, \"UNITED STATES TREASURY\") &gt; 0 Or InStr(1, TestVendor, \"UPS\") &gt; 0 Or InStr(1, TestVendor, \"US FOODS\") &gt; 0 Or InStr(1, TestVendor, \"US FOODSERVICE\") &gt; 0 Or InStr(1, TestVendor, \"US TREASURY\") &gt; 0 Or InStr(1, TestVendor, \"VERIZON\") &gt; 0 Or InStr(1, TestVendor, \"WASTE MANAGEMENT\") &gt; 0 Or InStr(1, TestVendor, \"XEROX\") &gt; 0 _\nThen NAVs = \"NAV\"\n\nEnd Function\n</code></pre>\n\n<p>The Address Splitter macro is:</p>\n\n<pre><code>Sub Splitter()\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nOn Error Resume Next\n\nSelCol = ActiveCell.Column\n\nBlanks = 0\nCurRow = 1\nHeader = 0\nLastRow = 0\n\nCityList = shtCity.Range(\"CityList\").Column\n\nDo Until Blanks = 10\n    If Cells(CurRow, SelCol) = \"\" Then\n    Blanks = Blanks + 1\n    Else\n    Blanks = 0\n\n        If Header = 0 Then\n        Header = CurRow\n        Else\n        LastRow = CurRow\n        End If\n    End If\n\nCurRow = CurRow + 1\nLoop\n\nIf LastRow &gt; Header Then\nCityRow = 1\n\n    Do Until shtCity.Cells(CityRow, 1) = \"\"\n    Range(Cells(Header + 1, SelCol), Cells(LastRow, SelCol)).Replace    What:=shtCity.Cells(CityRow, 1), Replacement:=VBA.Replace(shtCity.Cells(CityRow, 1), \" \", \"ZZZ\"), Lookat:=xlPart\n    CityRow = CityRow + 1\n    Loop\n\nColumns(SelCol).Insert\nColumns(SelCol).Insert\nColumns(SelCol).Insert\nColumns(SelCol).Insert\nCells(Header, SelCol) = \"AD1\"\nCells(Header, SelCol + 1) = \"AD2\"\nCells(Header, SelCol + 2) = \"City\"\nCells(Header, SelCol + 3) = \"State\"\nCells(Header, SelCol + 4) = \"Zip\"\n\n    For n = Header + 1 To LastRow\n    TextStr = VBA.Trim(VBA.Replace(Cells(n, SelCol + 4), \",\", \" \"))\n    LastSpace = VBA.InStrRev(TextStr, \" \")\n\n        If LastSpace = 0 Then GoTo Nextn\n\n    Cells(n, SelCol + 4) = VBA.Trim(VBA.Mid(TextStr, LastSpace))\n\n        If VBA.IsNumeric(VBA.Replace(Cells(n, SelCol + 4), \"-\", \"\") * 1) = False Or (VBA.Len(Cells(n, SelCol + 4)) &lt;&gt; 5 And VBA.Len(Cells(n, SelCol + 4)) &lt;&gt; 10) Then\n        Cells(n, SelCol + 4) = \"\"\n            GoTo StateCodeList\n        End If\n\n    TextStr = VBA.Trim(VBA.Left(TextStr, LastSpace))\n    LastSpace = VBA.InStrRev(TextStr, \" \")\n\n        If LastSpace = 0 Then GoTo Nextn\nStateCodeList:\n        If LastSpace &lt;&gt; VBA.Len(TextStr) - 2 Then GoTo NoStateCode\n\n    Cells(n, SelCol + 3) = VBA.Right(TextStr, 2)\n    TextStr = VBA.Trim(VBA.Replace(VBA.Left(TextStr, VBA.Len(TextStr) - 2), \",\", \" \"))\n    LastSpace = VBA.InStrRev(TextStr, \" \")\n\n        If LastSpace = 0 Then GoTo Nextn\nNoStateCode:\n    Cells(n, SelCol + 2) = VBA.Replace(VBA.Trim(VBA.Mid(TextStr, LastSpace)), \"ZZZ\", \" \")\n    TextStr = VBA.Replace(VBA.Trim(VBA.Left(TextStr, LastSpace)), \",\", \" \")\n\n    SearchStr = VBA.InStr(1, TextStr, \"P.O.\")\n\n        If SearchStr &gt; 1 Then\n        Cells(n, SelCol) = VBA.Trim(VBA.Left(TextStr, SearchStr - 1))\n        Cells(n, SelCol + 1) = VBA.Trim(VBA.Mid(TextStr, SearchStr))\n            GoTo Nextn\n        End If\n\n    SearchStr = VBA.InStr(1, VBA.UCase(TextStr), \"PO BOX\")\n\n        If SearchStr &gt; 1 Then\n        Cells(n, SelCol) = VBA.Trim(VBA.Left(TextStr, SearchStr - 1))\n        Cells(n, SelCol + 1) = VBA.Trim(VBA.Mid(TextStr, SearchStr))\n            GoTo Nextn\n        End If\n\n    Cells(n, SelCol) = TextStr\nNextn:\n    Next n\n\nRange(Columns(SelCol), Columns(SelCol + 4)).AutoFit\nEnd If\n\nExitsub:\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nEnd Sub\nSub ShiftLeft()\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nOn Error GoTo Exitsub\n\nSelCol = ActiveCell.Column\nSelRow = ActiveCell.Row\n\nTextStr = VBA.Trim(Cells(SelRow, SelCol))\nLastSpace = VBA.InStr(TextStr, \" \")\n\nIf LastSpace = 0 Then\nCells(SelRow, SelCol) = \"\"\nCells(SelRow, SelCol - 1) = VBA.Trim(VBA.Trim(Cells(SelRow, SelCol - 1)) &amp; \" \" &amp; TextStr)\nCells(SelRow, SelCol - 1).Select\nElse\nCells(SelRow, SelCol - 1) = VBA.Trim(Cells(SelRow, SelCol - 1) &amp; \" \" &amp; VBA.Trim(VBA.Left(TextStr, LastSpace - 1)))\nCells(SelRow, SelCol) = VBA.Trim(VBA.Mid(TextStr, LastSpace))\nEnd If\n\nExitsub:\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nEnd Sub\nSub ShiftRight()\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nOn Error GoTo Exitsub\n\nSelCol = ActiveCell.Column\nSelRow = ActiveCell.Row\n\nTextStr = VBA.Trim(Cells(SelRow, SelCol))\nLastSpace = VBA.InStrRev(TextStr, \" \")\n\nIf LastSpace = 0 Then\nCells(SelRow, SelCol) = \"\"\nCells(SelRow, SelCol + 1) = VBA.Trim(TextStr &amp; \" \" &amp; VBA.Trim(Cells(SelRow, SelCol + 1)))\nCells(SelRow, SelCol + 1).Select\nElse\nCells(SelRow, SelCol + 1) = VBA.Trim(VBA.Trim(VBA.Mid(TextStr, LastSpace)) &amp; \" \" &amp; Cells(SelRow, SelCol + 1))\nCells(SelRow, SelCol) = VBA.Trim(VBA.Left(TextStr, LastSpace - 1))\nEnd If\n\nExitsub:\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I tried looking up a solution to this on the forums and online but I was unable to find anything. It does not seem like it is a memory limitation thing, though I realize it can be. Please let me know if there is anything else I can provide to help resolve this.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1446676385, "post_id": 33533149, "comment_id": 54848312, "body": "What does <code>qry_Maui_Division_KWH_Produced</code> do? Can you post its SQL? Are you sure that it works when you run it directly (without vba)?"}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1446676618, "post_id": 33533149, "comment_id": 54848414, "body": "I just verified that it works without vba.  It creates one row of data and puts it in a table which is then referenced for the report.  I put the sql code on the post."}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1446683654, "post_id": 33533149, "comment_id": 54850728, "body": "Ok, I added Option Explicit and am getting stuck on the debug issues.  I had the delete the table object already in my db, but now I&#39;m getting the following run-time error &quot;3061: Too few parameters.  Expected 1&quot; when I execute the code: dbs.Execute sql, dbFailOnError.  From looking at my local variables all the parameters looks to be in place.  Any ideas to why I&#39;m still getting an error?"}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1446687414, "post_id": 33533149, "comment_id": 54851806, "body": "I think I&#39;m getting a little closer.  I referenced the syntax for the query to have square brackets: sql=&quot;[qry_Maui_Division_KWH_Produced]&quot;.  But now my error is &quot;3078: ..cannot find the input table or query...&quot;  I&#39;ve made sure that the query was named the same but is still not working. My saved query is a make table query.  Is there a different syntax for this?"}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1446743439, "post_id": 33533149, "comment_id": 54880931, "body": "@HansUp Yes, I can share it.  What&#39;s the best way to share it?  Github?"}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1446757790, "post_id": 33533149, "comment_id": 54889264, "body": "Yes, that&#39;s correct.  I intended it to update the end date and the user will have to enter an end date if they want to do a longer period report.  The reason you get that error is that table should be deleted before you run that query.  I haven&#39;t added any code to delete the table from VBA since I was just trying to get this code to execute without errors."}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1446759967, "post_id": 33533149, "comment_id": 54890525, "body": "@HansUp I&#39;m using the DoCmd.OpenQuery syntax and that&#39;s able to run the query for me.  I&#39;m just trying to run the query using VBA so I can run it in the background without any warnings.  Thanks for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1446758371, "post_id": 33552681, "comment_id": 54889611, "body": "Thanks @neuralgroove This worked for me, except now I get a &quot;Enter Paramater Value for: Bad&quot;.  I&#39;m assuming this is used for any errors in the data, do you know how I can get rid of this prompt?"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "reply_to_user": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1446768332, "post_id": 33552681, "comment_id": 54893906, "body": "I was gonna say something about that query, the WHERE clause is looking for a condition (like WHERE Field1=&#39;bad&#39; or something) Without seeing your dataset i&#39;m not sure what the condition is looking for"}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1446833766, "post_id": 33552681, "comment_id": 54924043, "body": "my understanding of that WHERE clause is if it has a bad data point or a &quot;null&quot; data point then you would delete it from the table.  I removed it from my VBA code in the meantime, but for the future is there a way I can look at null values and output N/A instead of deleting it from the table?"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "reply_to_user": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1446836106, "post_id": 33552681, "comment_id": 54925278, "body": "when querying the table you can use iif(ISNULL(value),&quot;N/A&quot;,value) or you could run an update query to update those fields to N/A..<code>UPDATE tbl_Maui_Division_KWH_Produced SET FieldName=&quot;N&#47;A&quot; WHERE FieldName IS NULL</code> or <code>UPDATE tbl_Maui_Division_KWH_Produced SET FieldName=&quot;N&#47;A&quot; WHERE FieldName=&quot;&quot;</code>"}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": true, "score": 1, "last_activity_date": 1446750063, "creation_date": 1446750063, "answer_id": 33552681, "question_id": 33533149, "link": "https://stackoverflow.com/questions/33533149/run-query-in-the-background/33552681#33552681", "title": "Run query in the background", "body": "<p>This will run your queries without warnings:</p>\n\n<pre><code>Private Sub PS_Report_Date_AfterUpdate()\n    DoCmd.SetWarnings False\n    DoCmd.OpenQuery \"qry_Maui_Division_KWH_Produced\"\n    DoCmd.RunSQL \"DELETE FROM tbl_Maui_Division_KWH_Produced WHERE Bad\"\n    DoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3489, "favorite_count": 0, "accepted_answer_id": 33552681, "answer_count": 1, "score": 0, "last_activity_date": 1446750063, "creation_date": 1446675480, "last_edit_date": 1446687459, "question_id": 33533149, "link": "https://stackoverflow.com/questions/33533149/run-query-in-the-background", "title": "Run query in the background", "body": "<p>I have a database which I'm working on. It is composed of split database, both front and multiple links to backend tables.</p>\n\n<p>I am working on a report which is composed of 15 different sub-reports.  I have a form which allows me to input start date and end date for the report.  There's a button which generates the final report.  The problem is when I want to generate the report, I would have to re-run each of the different make-table queries for each of the sub-reports.  The issue with this is that there would be 2 warnings for each query, one to delete my table and another for rows added to the table. </p>\n\n<p>I researched online and found this code to run the Execute command which will remove all the warnings.  I'm new to VB but I figured I'll give it a try and I get the following run-time error \"3078: The MS Access database engine cannot find the input table or query\".  I checked the query name and it matches so I'm not sure why I'm getting this error.  I've only tried one of the 15 queries so I can make sure it works.  Once I get this to work, my other question is would combining all these into 15 execute commands work in the module?</p>\n\n<pre><code>Private Sub PS_Report_Date_AfterUpdate()\n\nDim dbs As DAO.Database\nDim lngRowsAffected As Long\nDim lngRowsDeleted As Long\nDim sql$\n\nsql = \"[qry_Maui_Division_KWH_Produced]\"\n\nSet dbs = CurrentDb\n\n' Execute runs both saved queries and SQL strings\ndbs.Execute sql, dbFailOnError\n\n' Get the number of rows affected by the Action query.\n' You can display this to the user, store it in a table, or trigger an action\n' if an unexpected number (e.g. 0 rows when you expect &gt; 0).\nlngRowsAffected = dbs.RecordsAffected\n\ndbs.Execute \"DELETE FROM tbl_Maui_Division_KWH_Produced WHERE Bad\", dbFailOnError\nlngRowsDeleted = dbs.RecordsAffected    \nEnd Sub\n</code></pre>\n\n<p>SQL Code: </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \ntbl_MPP_DailyGenerationReport.DateLog, \n[MPP_Daily_Gross_Gen_kWh]+[Total_Gross_kWh] AS Maui_Gross_kWh_Produced,\n[Total_Aux]+[Total_Aux_kWh] AS Maui_Gross_Aux_kWh_Produced, [MPP_Daily_Gross_Gen_kWh]-[Total_Aux]+[Total_Net_kWh] AS Maui_Net_kWh_Produced, \nRound(([Total_MBTU_Burned]*1000000)/([MPP_Daily_Gross_Gen_kWh]+[Total_Gross_kWh]),0) AS Maui_Gross_BTU_kWh, \nRound([Total_MBTU_Burned]*1000000/([MPP_Daily_Gross_Gen_kWh]-[Total_Aux]+[Total_Net_kWh]),0) AS Maui_Net_BTU_kWh, \nRound(([MPP_Daily_Gross_Gen_kWh]+[Total_Gross_kWh])/[Total_Barrels_Burned],0) AS Maui_Gross_kWh_BBL, \nRound(([MPP_Daily_Gross_Gen_kWh]-[Total_Aux]+[Total_Net_kWh])/[Total_Barrels_Burned],0) AS Maui_Net_kWh_BBL \n\nINTO tbl_Maui_Division_KWH_Produced\n\nFROM ((tbl_MPP_DailyGenerationReport \nINNER JOIN tbl_KPP_DailyGenerationReport \nON tbl_MPP_DailyGenerationReport.DateLog = tbl_KPP_DailyGenerationReport.DateLog) \nINNER JOIN tbl_MPP_Aux_DailyGenerationReport \nON tbl_MPP_DailyGenerationReport.DateLog = tbl_MPP_Aux_DailyGenerationReport.DateLog) \nINNER JOIN qry_Maui_Total_Fuel_Burned \nON tbl_MPP_DailyGenerationReport.DateLog = qry_Maui_Total_Fuel_Burned.DateLog\nWHERE (((tbl_MPP_DailyGenerationReport.DateLog)=[Forms]![Power Supply Reports]![PS_Report_Date]));\u200b\n</code></pre>\n"}, {"tags": ["mysql", "vba", "excel", "database-connection"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1446672716, "post_id": 33532300, "comment_id": 54846411, "body": "Are those databases in the same MySQL instance? Also could you add your VBA code where you did do a <code>LEFT JOIN</code> command and what error you got back? I&#39;ve run into trouble in the past with my data types for running queries getting truncated. Try doing a break and confirm your query string."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1446673219, "post_id": 33532300, "comment_id": 54846660, "body": "Also note that on your Workbench example you use <code>AB</code> and <code>XY</code> rather than <code>abc</code> and <code>xyz</code>. Is this just a typo or could it be the reason for the issue."}], "answers": [{"tags": [], "owner": {"reputation": 225, "user_id": 4824432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df769d1e76098d5af680f5b9e0f98a3?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4824432/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1448554529, "creation_date": 1448554529, "answer_id": 33943043, "question_id": 33532300, "link": "https://stackoverflow.com/questions/33532300/single-mysql-query-on-multiple-databases/33943043#33943043", "title": "Single MySQL Query on multiple databases", "body": "<p>I found a way to solve my above problem by simply setting two connections to the two different databases (working on the same MySQL instance).</p>\n\n<p>My code looks like that :</p>\n\n<pre><code>Set conn = New ADODB.Connection\nconn.Open \"DRIVER={MySQL ODBC 5.3 Unicode Driver}\" _\n&amp; \";SERVER=\" &amp; server_name _\n&amp; \";DATABASE=\" &amp; database_name _\n&amp; \";UID=\" &amp; user_id _\n&amp; \";PWD=\" &amp; password _\n&amp; \";OPTION=3\" '\n\nSet conn2 = New ADODB.Connection\nconn2.Open \"DRIVER={MySQL ODBC 5.3 Unicode Driver}\" _\n&amp; \";SERVER=\" &amp; server_name _\n&amp; \";DATABASE=\" &amp; database_name2 _\n&amp; \";UID=\" &amp; user_id2 _\n&amp; \";PWD=\" &amp; password2 _\n&amp; \";OPTION=3\" '\n\n' SELECT Query with LEFT JOIN on the two different databases\nSet rs1 = New ADODB.Recordset\nsqlstr = \"SELECT AB.* , XY.* FROM `abc`.`table_in_abc` AB LEFT JOIN `xyz`.`table_in_xyz` XY ON AB.`ID` = XY`ID`\"\nrs1.Open sqlstr, conn, adOpenStatic\nWith Worksheets(\"main\").Cells(1, 1)\n.ClearContents\n.CopyFromRecordset rs1\nEnd With\nrs1.Close\nSet rs1 = Nothing\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 4824432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df769d1e76098d5af680f5b9e0f98a3?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4824432/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1065, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448554529, "creation_date": 1446672334, "last_edit_date": 1446672549, "question_id": 33532300, "link": "https://stackoverflow.com/questions/33532300/single-mysql-query-on-multiple-databases", "title": "Single MySQL Query on multiple databases", "body": "<p>I am working with the following set-up:</p>\n\n<p>Consider two MySQL databases: <code>abc</code>and <code>xyz</code>, each with their own table:<code>abc</code>.<code>table_in_abc</code> and <code>xyz</code>.<code>table_in_xyz</code>. I need to run a simple MySQL query that select elements from the <code>table_in_abc</code> with a JOIN relationship to <code>table_in_xyz</code>.</p>\n\n<p>In Workbench, the following query works fine:</p>\n\n<pre><code>SELECT AB.* , XY.*\nFROM `abc`.`table_in_abc` AB\nLEFT JOIN `xyz`.`table_in_xyz` XY ON AB.`ID` = XY`ID`\n</code></pre>\n\n<p>I am trying to achieve the same things in VBA. I am able to run a MySQL query on a single database (see example below) but unable to do so when the query involves multiple databases.</p>\n\n<p>Example of simple VBA query on single database:</p>\n\n<pre><code>Set conn = New ADODB.Connection\nconn.Open \"DRIVER={MySQL ODBC 5.3 Unicode Driver}\" _\n&amp; \";SERVER=\" &amp; server_name _\n&amp; \";DATABASE=\" &amp; database_name _\n&amp; \";UID=\" &amp; user_id _\n&amp; \";PWD=\" &amp; password _\n&amp; \";OPTION=3\" '\n\nSet rs1 = New ADODB.Recordset\nsqlstr = \"SELECT * FROM `abc`.`table_in_abc` WHERE `ID`=\" &amp; ID &amp; \";\" \nrs1.Open sqlstr, conn, adOpenStatic\nWith Worksheets(\"Main\").Cells(a, 1)\n.ClearContents\n.CopyFromRecordset rs1\nEnd With\nrs1.Close\nSet rs1 = Nothing\n</code></pre>\n"}, {"tags": ["vba", "loops", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3943192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36743426fe71eaeb6789e6341d5dbd16?s=128&d=identicon&r=PG&f=1", "display_name": "Naaiif", "link": "https://stackoverflow.com/users/3943192/naaiif"}, "edited": false, "score": 0, "creation_date": 1446674341, "post_id": 33532531, "comment_id": 54847272, "body": "Thanks DanL the 2nd loop really explained it well and now I understand. This is now working, thanks alot for your help!"}, {"owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "reply_to_user": {"reputation": 3, "user_id": 3943192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36743426fe71eaeb6789e6341d5dbd16?s=128&d=identicon&r=PG&f=1", "display_name": "Naaiif", "link": "https://stackoverflow.com/users/3943192/naaiif"}, "edited": false, "score": 0, "creation_date": 1446674387, "post_id": 33532531, "comment_id": 54847298, "body": "Great! Please mark as answer if it solved your issue :-)"}], "tags": [], "owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "is_accepted": true, "score": 0, "last_activity_date": 1446673979, "last_edit_date": 1446673979, "creation_date": 1446673182, "answer_id": 33532531, "question_id": 33532284, "link": "https://stackoverflow.com/questions/33532284/vba-excel-distributing-number/33532531#33532531", "title": "VBA Excel - Distributing number", "body": "<p>This happens because you're essentially skipping one iteration of i for every time you fill every cell. See that 500 / 18 is actually 27 floored, and that's the work total you're losing.</p>\n\n<p>To avoid this issue, for every cell, you should only increment i for every value assigned <em>after</em> the first cell. For example, you can replace the inner <code>For Each</code> loop with this:</p>\n\n<pre><code>For r = 1 To rngAmount.Cells.Count\n    Set c = rngAmount.Cells(r)\n\n    If i &lt; worktotal.Value Then\n        c.Value = c.Value + 1\n        If r &gt; 1 Then i = i + 1\n    Else\n        Exit For\n    End If\nNext r\n</code></pre>\n\n<p>EDIT: Here's a simpler and more readable loop for ya. It should replace your main loop.</p>\n\n<pre><code>i = worktotal.Value\n\nWhile (i &gt; 0)\n    For Each c In rngAmount\n        c.Value = c.Value + 1\n\n        If i &gt; 0 Then i = i - 1\n        If i = 0 Then Exit For\n    Next\nWend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3943192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36743426fe71eaeb6789e6341d5dbd16?s=128&d=identicon&r=PG&f=1", "display_name": "Naaiif", "link": "https://stackoverflow.com/users/3943192/naaiif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 33532531, "answer_count": 1, "score": 0, "last_activity_date": 1446674915, "creation_date": 1446672269, "last_edit_date": 1446674915, "question_id": 33532284, "link": "https://stackoverflow.com/questions/33532284/vba-excel-distributing-number", "title": "VBA Excel - Distributing number", "body": "<p>So i want to loop through a range of cells and add 1 until the work total (500 in this example) has depleted, so basically it adds a 1 in each cell until it adds up to 500. However everytime i run this code, the actual amount comes up short (473 in this example). I know this is pretty basic, but I have a pretty basic brain. Is it something to do with the for loop completing 500 times, but not the for each loop? Here is some really bad code:</p>\n\n<pre><code>Sub dividerloop()\n\nDim rngAmount As Range\nDim c As Range\nDim worktotal As Range\nDim i As Long\n\nSet rngAmount = Sheet1.Range(\"E4:E21\")\nSet worktotal = Sheet1.Range(\"G2\")\n\n'set loop from 1 to work total\n'set loop between cells\nFor i = 1 To worktotal.Value\n    If i &lt; worktotal.Value Then\n        For Each c In rngAmount\n'add 1 to each cell and increment i by 1\n            If i &lt; worktotal.Value Then\n                c.Value = c.Value + 1\n                i = i + 1\n            Else\n                Exit For\n            End If\n        Next c\n    Else\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>Here is a pic of the spreadsheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xspct.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xspct.jpg\" alt=\"spreadsheet image\"></a></p>\n\n<p>Thanks guys!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1446673062, "post_id": 33532185, "comment_id": 54846593, "body": "I don&#39;t quite see your question here. Remember that SO is not a code writing service but rather a forum to get assistance on specific issues with programming. Try coming up with a solution and if you run into specific issues with your code then you can post it here for assistance. One way to start is to use the Macro Recorder and move a couple of cells to what you want it. Then reviewing your code you can adapt it to scale to the rest of your sheet. Hope this guides you on your way. Cheers."}, {"owner": {"reputation": 1, "user_id": 5521660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5710d3ad3baae1cf7d63e780fca319d?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Marcos", "link": "https://stackoverflow.com/users/5521660/andres-marcos"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1446739700, "post_id": 33532185, "comment_id": 54878410, "body": "Hi nbayly, mea culpa, I am trying to use this as a code writing service because I had no idea where to start. I have no knowledge of VBA and am trying to learn by solving some of the problems I&#39;m facing every day."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5521660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5710d3ad3baae1cf7d63e780fca319d?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Marcos", "link": "https://stackoverflow.com/users/5521660/andres-marcos"}, "edited": false, "score": 0, "creation_date": 1446750030, "post_id": 33532602, "comment_id": 54884782, "body": "Andrew, this is great, thank you! How would you preserve formatting?"}], "tags": [], "owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "is_accepted": false, "score": 1, "last_activity_date": 1446673445, "creation_date": 1446673445, "answer_id": 33532602, "question_id": 33532185, "link": "https://stackoverflow.com/questions/33532185/change-data-in-vertical-table-to-individual-rows-using-vba/33532602#33532602", "title": "Change data in vertical table to individual rows using VBA", "body": "<p>If your headers are all contained in rows 1:2 and column A:A, then you could use this code:</p>\n\n<pre><code>Dim sht1 As Worksheet, sht2 As Worksheet\nDim cel As Range\nDim rowWrite As Long\n\nrowWrite = 1\nSet sht1 = ActiveSheet\nSet sht2 = ActiveWorkbook.Worksheets.Add\nFor Each cel In sht1.Range(\"B3\", sht1.Range(\"B2\").End(xlToRight).End(xlDown).Address)\n    With sht2.Range(\"A\" &amp; rowWrite)\n        .Offset(, 0).Value = cel.EntireColumn.Resize(1).Value\n        .Offset(, 1).Value = cel.EntireColumn.Resize(1).Offset(1).Value\n        .Offset(, 2).Value = cel.EntireRow.Resize(1).Value\n        .Offset(, 3).Value = cel.Value\n    End With\n    rowWrite = rowWrite + 1\nNext cel\n</code></pre>\n\n<p>This will create a new worksheet and write your data to that.\nIt won't preserve formatting, let me know if you need that.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 5521660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5710d3ad3baae1cf7d63e780fca319d?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Marcos", "link": "https://stackoverflow.com/users/5521660/andres-marcos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1446673445, "creation_date": 1446671896, "last_edit_date": 1531161705, "question_id": 33532185, "link": "https://stackoverflow.com/questions/33532185/change-data-in-vertical-table-to-individual-rows-using-vba", "title": "Change data in vertical table to individual rows using VBA", "body": "<p>I have an Excel workbook with the following format:</p>\n\n<pre><code>  | A  | B     | C     | D     | E     |   \n  |----|-------|-------|-------|-------|  \n 1|    | po#1  | po#2  | po#3  | po#1  |\n 2|    | date1 | date2 | date3 | date4 |\n 3|sku1| qty1  | qty4  | qty7  | qty10 | \n 4|sku2| qty2  | qty5  | qty8  | qty11 |\n 5|sku3| qty3  | qty6  | qty9  | qty12 |\n</code></pre>\n\n<p>that I need to convert to the following format:</p>\n\n<pre><code>  | A      | B     | C     | D     |\n  |--------|-------|-------|-------|\n 1|  po#1  | date1 | sku1  | qty1  |\n 2|  po#1  | date1 | sku2  | qty2  |\n 3|  po#1  | date1 | sku3  | qty3  |\n 4|  po#1  | date4 | sku1  | qty10 |\n 5|  po#1  | date4 | sku2  | qty11 |\n 6|  po#1  | date4 | sku3  | qty12 |\n 7|  po#2  | date2 | sku1  | qty4  |\n 8|  po#2  | date2 | sku2  | qty5  |\n 9|  po#2  | date2 | sku3  | qty6  |\n10|  po#3  | date3 | sku1  | qty7  |\n11|  po#3  | date3 | sku2  | qty8  |\n12|  po#3  | date3 | sku3  | qty9  |\n</code></pre>\n\n<p>using VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1446672268, "post_id": 33532166, "comment_id": 54846201, "body": "What are you trying to do with <code>Set i = ActiveWorkbook.Worksheet.Item(3)</code>?"}, {"owner": {"reputation": 13, "user_id": 5526530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3399d3c1ced542d8a5b94b7686fc9cef?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen", "link": "https://stackoverflow.com/users/5526530/jeroen"}, "edited": false, "score": 0, "creation_date": 1446713464, "post_id": 33532166, "comment_id": 54860855, "body": "I do not really know, I saw that somewhere in order to activate the worksheet you&#39;re working on? Because I work with multiple worksheets."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5526530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3399d3c1ced542d8a5b94b7686fc9cef?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen", "link": "https://stackoverflow.com/users/5526530/jeroen"}, "edited": false, "score": 0, "creation_date": 1446713664, "post_id": 33532186, "comment_id": 54860962, "body": "Thank u for your reaction. Still doesn&#39;t work however. Now I don&#39;t get any errors, but it still doesnt copy the range. And I forgot to add d = d + 1"}, {"owner": {"reputation": 13, "user_id": 5526530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3399d3c1ced542d8a5b94b7686fc9cef?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen", "link": "https://stackoverflow.com/users/5526530/jeroen"}, "edited": false, "score": 0, "creation_date": 1446714146, "post_id": 33532186, "comment_id": 54861221, "body": "I&#39;ve found something that worked, but whenever I run the macro, the excelfile goed grazy because it is continouisly selecting 2 worksheets. I&#39;ve put the code above aswell. So i prefer to do it with your anwer"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1446671909, "creation_date": 1446671909, "answer_id": 33532186, "question_id": 33532166, "link": "https://stackoverflow.com/questions/33532166/copy-range-from-one-worksheet-to-another-based-on-criterion/33532186#33532186", "title": "Copy range from one worksheet to another based on criterion", "body": "<p>When using multiple spreadsheets, you need to be careful and make sure all <code>.Range</code> and <code>.Cells</code> references include the worksheet you want to.  First things first, replace your <code>If</code> statement with this one:</p>\n\n<pre><code>If i.Range(\"N\" &amp; j) = \"1\" Then \n    e.Range(e.Cells(d, 1), e.Cells(d, 8)) = i.Range(i.Cells(j, 1), i.Cells(j,8))\nEnd If\n</code></pre>\n\n<p>Or, you can use <code>With</code> (which I personally prefer):</p>\n\n<pre><code>With i\n If .Range(\"N\" &amp; j) = \"1\" Then\n     e.Range(e.Cells(d,1),e.Cells(d,8)) = .Range(.Cells(j,1),.Cells(j,8))\n End If\nEnd with\n</code></pre>\n\n<p>Without the explicit reference to a worksheet, the <code>Cells()</code> and <code>Range()</code> will defer to whichever one is the <code>ActiveSheet</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5526530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3399d3c1ced542d8a5b94b7686fc9cef?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen", "link": "https://stackoverflow.com/users/5526530/jeroen"}, "edited": false, "score": 0, "creation_date": 1446714508, "post_id": 33540202, "comment_id": 54861444, "body": "Yes it worked perfectly now! Thank you so much. Finally, I can continue!"}], "tags": [], "owner": {"reputation": 16, "user_id": 5523822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8c632ab85b1c04a3b502739087c420?s=128&d=identicon&r=PG", "display_name": "Kael", "link": "https://stackoverflow.com/users/5523822/kael"}, "is_accepted": true, "score": 0, "last_activity_date": 1446713844, "creation_date": 1446713844, "answer_id": 33540202, "question_id": 33532166, "link": "https://stackoverflow.com/questions/33532166/copy-range-from-one-worksheet-to-another-based-on-criterion/33540202#33540202", "title": "Copy range from one worksheet to another based on criterion", "body": "<p>try this. Ive add .value and d =d + 1</p>\n\n<pre><code>    Sub TCoutput()\n       Dim i As New Worksheet\n       Dim e As New Worksheet\n\n       Set i = ActiveWorkbook.Worksheets.Item(1)\n       Set e = ActiveWorkbook.Worksheets.Item(2)\n       Dim d\n       Dim j\n\n       d = 10\n       j = 3\n\n       Do Until IsEmpty(i.Range(\"N\" &amp; j))\n\n           If i.Range(\"N\" &amp; j) = \"1\" Then\n               e.Range(e.Cells(d, 1), e.Cells(d, 8)).Value = i.Range(i.Cells(j, 1), i.Cells(j, 8)).Value\n                d = d + 1\n           End If\n           j = j + 1\n       Loop\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5526530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3399d3c1ced542d8a5b94b7686fc9cef?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen", "link": "https://stackoverflow.com/users/5526530/jeroen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 33540202, "answer_count": 2, "score": 1, "last_activity_date": 1446713844, "creation_date": 1446671778, "last_edit_date": 1446713790, "question_id": 33532166, "link": "https://stackoverflow.com/questions/33532166/copy-range-from-one-worksheet-to-another-based-on-criterion", "title": "Copy range from one worksheet to another based on criterion", "body": "<p>I want to copy a range of cells to another worksheet based on the criterion given in column N.   So for each row it has to check whether or not it meets criterion in column N. If the value in Column N = <code>1</code>, it should copy from that row  <code>Range(Cells(j, 1), Cells(j, 8))</code> to another worksheet starting at row 10. If the value in Column N = <code>0</code> it skips that row and checks the next one. So it doesn't copy that row. </p>\n\n<p>Maybe my wrong code can explain it better than me:</p>\n\n<pre><code>Sub TCoutput()\n   Dim i As New Worksheet\n   Dim e As New Worksheet\n\n   Set i = ActiveWorkbook.Worksheet.Item(3)\n   Set e = ActiveWorkbook.Worksheets.Item(4)\n   Dim d\n   Dim j\n\n   d = 10\n   j = 3\n\n   Do Until IsEmpty(i.Range(\"N\" &amp; j))\n\n       If i.Range(\"N\" &amp; j) = \"1\" Then \n         d = d + 1\n           e.Range(Cells(d, 1), Cells(d, 8)) = i.Range(Cells(j, 1), Cells(j,8))\n       End If\n       j = j + 1\n   Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "oracle", "vba"], "answers": [{"tags": [], "owner": {"reputation": 781, "user_id": 5175125, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10206341392667431/picture?type=large", "display_name": "Richard Lusch", "link": "https://stackoverflow.com/users/5175125/richard-lusch"}, "is_accepted": true, "score": 0, "last_activity_date": 1447168820, "creation_date": 1447168820, "answer_id": 33633381, "question_id": 33532059, "link": "https://stackoverflow.com/questions/33532059/ie-automation-of-html-java-form-to-oracle-database-input-data-does-not-save-to/33633381#33633381", "title": "IE Automation of HTML/Java Form to Oracle Database: Input data does not save to database", "body": "<p>The root cause of the issue was that the input values were not firing off the function that checked the validity of the input.  This function then feeds the data into an array that ultimately is saved to the database.  I was clued in when I tried typing a decimal or character into the field; they automatically changed to zero.  The offending snippet of code is below:</p>\n\n<pre><code>$('.allowedValues').keyup(function(){\n    var n = this.value;\n    if(this.value.length &gt;0 &amp;&amp; !(isNaN(this.value)) &amp;&amp; !(n.indexOf(\".\")&gt;0) ){\n    //Nothing\n    }else {\n        this.value=\"0\";\n    }\n});\n</code></pre>\n\n<p>Firing this function allows the data to be saved to the database once it is submitted.  I altered the code from above in the following way.  The code then worked as expected.</p>\n\n<pre><code>x = 1\nFor Each i In Range(\"dailyCV\")\n    IE.document.all(col_1.Item(x)).Value = i\n    Call IE.document.parentWindow.execScript(\"$('.allowedValues').keyup()\", \"JavaScript\")\n    IE.document.all(col_2.Item(x)).Value = col_5(x)\n    Call IE.document.parentWindow.execScript(\"$('.allowedValues').keyup()\", \"JavaScript\")\n    x = x + 1\nNext i\n</code></pre>\n\n<p>I found the function by using the 'Inspect Elements' feature of Google Chrome, and inspecting the Event Listeners that were listed when I inspected the element of the text box.</p>\n"}], "owner": {"reputation": 781, "user_id": 5175125, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10206341392667431/picture?type=large", "display_name": "Richard Lusch", "link": "https://stackoverflow.com/users/5175125/richard-lusch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 33633381, "answer_count": 1, "score": 0, "last_activity_date": 1447168820, "creation_date": 1446671372, "last_edit_date": 1446673620, "question_id": 33532059, "link": "https://stackoverflow.com/questions/33532059/ie-automation-of-html-java-form-to-oracle-database-input-data-does-not-save-to", "title": "IE Automation of HTML/Java Form to Oracle Database: Input data does not save to database", "body": "<p>I have created VBA code which opens a web form to an Oracle Database, manipulates the page so that all pertinent text boxes are visible, and input the values from an Excel spreadsheet.  This all works well and as expected.</p>\n\n<p>When I submit the form, I get a congratulatory message advising that my data has been accepted and is updated.  But when I go to view this data, it is missing.  When I manually update the webpage the data updates as expected.  </p>\n\n<p>Any thoughts on what this behavior stems from and how to overcome it?</p>\n\n<p>It is on an intranet, so I will not be able to share the URL. I personally think that the the webpage differentiates between how I have entered the data and when it has been typed in.</p>\n\n<pre><code>x = 1\nFor Each i In Range(\"dailyCV\")\n    IE.document.all(col_1.Item(x)).Value = i\n    IE.document.all(col_2.Item(x)).Value = col_5(x)\n    x = x + 1\nNext i\n</code></pre>\n\n<p>Is there a way to have VBA mimic the actual typing of the numbers, or an even easier way of handling this?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1446742553, "post_id": 33531879, "comment_id": 54880331, "body": "Try substituting the WdBuiltinStyle enum values for the literal string values - wdStyleNormal instead of &quot;Normal&quot;, for example - and see if that makes a difference. You can find the list in the VBA object browser (F2) or Intellisense should provide it if you type WdBuiltinStyle. (but note that I&#39;m giving you this from memory so I might be making typos!)"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1446792614, "post_id": 33531879, "comment_id": 54900527, "body": "It might be that the <code>Style</code> does update but it did not update in the Document text. It also worked fine for me, except for the TOC styles, which I do not have assigned in my Style Set."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 4589140, "user_type": "registered", "accept_rate": 6, "profile_image": "https://graph.facebook.com/365776543606774/picture?type=large", "display_name": "Nathaniel Lindsey", "link": "https://stackoverflow.com/users/4589140/nathaniel-lindsey"}, "edited": false, "score": 0, "creation_date": 1446675950, "post_id": 33532562, "comment_id": 54848101, "body": "That&#39;s actually really helpful!  It worked for someone!  Maybe there&#39;s a box I need to check or uncheck somewhere..."}], "tags": [], "owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "is_accepted": false, "score": 0, "last_activity_date": 1446673279, "creation_date": 1446673279, "answer_id": 33532562, "question_id": 33531879, "link": "https://stackoverflow.com/questions/33531879/word-vba-script-compiles-without-error-but-doesnt-work/33532562#33532562", "title": "Word VBA script compiles without error but doesn&#39;t work", "body": "<p>I cant confirm a problem, macro works properly, changing the style according to defined parameters</p>\n"}, {"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": false, "score": 0, "last_activity_date": 1446794086, "creation_date": 1446794086, "answer_id": 33561383, "question_id": 33531879, "link": "https://stackoverflow.com/questions/33531879/word-vba-script-compiles-without-error-but-doesnt-work/33561383#33561383", "title": "Word VBA script compiles without error but doesn&#39;t work", "body": "<p>The problem i had was that it updated the style but it did not update the document text.</p>\n\n<p>What I did is run a <code>Loop</code> after you have reset your <code>Styles</code>.</p>\n\n<p>Add this after your last Style Editing Statement.</p>\n\n<pre><code>For p = 1 To ActiveDocument.Paragraphs.Count\n\n    ActiveDocument.Paragraphs(p).Range.Select\n\n    ParaStyle = ActiveDocument.Paragraphs(p).Range.style\n\n    Selection.Range.style = ParaStyle\n\nNext\n</code></pre>\n\n<p>I'm not sure if there is another way do this.</p>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1446969903, "creation_date": 1446969903, "answer_id": 33591930, "question_id": 33531879, "link": "https://stackoverflow.com/questions/33531879/word-vba-script-compiles-without-error-but-doesnt-work/33591930#33591930", "title": "Word VBA script compiles without error but doesn&#39;t work", "body": "<p>It also worked fine for me, but based on Jean-Pierre's answer I have to wonder whether direct formatting has been applied to the text. That will over-ride the style formatting so changes to the style won't show up.</p>\n\n<p>There are a set of commands that remove various types of formatting from the current Selection. They all start with the term \"Clear\".</p>\n\n<p>I selected a paragraph and applied a different font to it, for example. Changing the style didn't show up until I first did this:</p>\n\n<pre><code>ntsReportDoc.Select\nSelection.ClearCharacterDirectFormatting\n</code></pre>\n\n<p>But you have to be aware that this kind of thing could also remove italics, etc. if they haven't been applied using a style.</p>\n"}], "owner": {"reputation": 115, "user_id": 4589140, "user_type": "registered", "accept_rate": 6, "profile_image": "https://graph.facebook.com/365776543606774/picture?type=large", "display_name": "Nathaniel Lindsey", "link": "https://stackoverflow.com/users/4589140/nathaniel-lindsey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1446969903, "creation_date": 1446670705, "question_id": 33531879, "link": "https://stackoverflow.com/questions/33531879/word-vba-script-compiles-without-error-but-doesnt-work", "title": "Word VBA script compiles without error but doesn&#39;t work", "body": "<p>I wrote the VBA macro below for the purpose of reinforcing some Word 2010 style specifications that tend to unravel during my report authoring process.  The macro compiles without error, but when I run it on a test report in which all formatting but the style name assignments have been removed, nothing happens at all.</p>\n\n<pre><code>Sub ntsReportFormatting()\n\n    Dim ntsReportDoc As Word.Document\n\n    Dim ntsNormal As Style\n    Dim ntsTOC1 As Style\n    Dim ntsTOC2 As Style\n    Dim ntsTOC3 As Style\n\n    Set ntsReportDoc = ActiveDocument\n\n    Set ntsNormal = ntsReportDoc.Styles(\"Normal\")\n    With ntsNormal\n        .Font.Name = \"Arial\"\n        .Font.Size = 12\n        .ParagraphFormat.LeftIndent = 0.5\n        .ParagraphFormat.SpaceAfter = 0.6\n    End With\n\n    Set ntsTOC1 = ntsReportDoc.Styles(\"TOC 1\")\n    With ntsTOC1\n        .Font.Name = \"Arial\"\n        .Font.Size = 12\n        .Font.Bold = True\n        .ParagraphFormat.LeftIndent = 0\n        .ParagraphFormat.SpaceBefore = 0.6\n        .ParagraphFormat.SpaceAfter = 0.6\n    End With\n\n    Set ntsTOC2 = ntsReportDoc.Styles(\"TOC 2\")\n    With ntsTOC2\n        .Font.Name = \"Arial\"\n        .Font.Size = 12\n        .ParagraphFormat.LeftIndent = 0.17\n        .ParagraphFormat.SpaceBefore = 0.6\n        .ParagraphFormat.SpaceAfter = 0.6\n        .NoSpaceBetweenParagraphsOfSameStyle = True\n    End With\n\n    Set ntsTOC3 = ntsReportDoc.Styles(\"TOC 3\")\n    With ntsTOC3\n        .Font.Name = \"Arial\"\n        .Font.Size = 12\n        .ParagraphFormat.LeftIndent = 0.33\n        .ParagraphFormat.SpaceBefore = 0.6\n        .ParagraphFormat.SpaceAfter = 0.6\n        .NoSpaceBetweenParagraphsOfSameStyle = True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I've consulted Lynda.com, the MSDN documentation, Youtube and Google and I haven't been able to find a clear solution.</p>\n"}, {"tags": ["vba", "excel", "selenium", "selenium-webdriver", "phantomjs"], "answers": [{"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1452261248, "creation_date": 1452261248, "answer_id": 34678726, "question_id": 33531286, "link": "https://stackoverflow.com/questions/33531286/phantomjsdrivertimes-out-on-button-click-event-in-selenium/34678726#34678726", "title": "PhantomJSDriverTimes Out On Button Click Event in Selenium", "body": "<p>It means that after the button is clicked, the new loaded page doesn't return a completed state within 30 seconds.\nIt could be due to a dead resource within the page.</p>\n\n<p>You could try to increase the server timeout:</p>\n\n<pre><code>Dim driver As New PhantomJSDriver\ndriver.Timeouts.Server = 60000  ' 60 seconds\ndriver.Get \"https://...\"\n\ndriver.FindElementByName(\"loginSubmitButton\").Click\n</code></pre>\n\n<p>Or you could define a timeout to load the page and skip the error:</p>\n\n<pre><code>Dim driver As New PhantomJSDriver\ndriver.Timeouts.PageLoad = 20000 ' 20 seconds\ndriver.Get \"https://...\"\n\nOn Error Resume Next\ndriver.FindElementByName(\"loginSubmitButton\").Click\nOn Error Goto 0\n</code></pre>\n\n<p>To get the latest version in date working with the above example:\n<a href=\"https://github.com/florentbr/SeleniumBasic/releases/latest\" rel=\"nofollow\">https://github.com/florentbr/SeleniumBasic/releases/latest</a></p>\n"}], "owner": {"reputation": 501, "user_id": 3570438, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PSwi1.png?s=128&g=1", "display_name": "110SidedHexagon", "link": "https://stackoverflow.com/users/3570438/110sidedhexagon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 472, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452261248, "creation_date": 1446668522, "last_edit_date": 1446669064, "question_id": 33531286, "link": "https://stackoverflow.com/questions/33531286/phantomjsdrivertimes-out-on-button-click-event-in-selenium", "title": "PhantomJSDriverTimes Out On Button Click Event in Selenium", "body": "<p>I have VBA code in Excel that is supposed to login to a website and download some files using Selenium. I have my code working using the <code>ChromeDriver</code> and am trying to modify it to work with the <code>PhantomJSDriver</code> so I can do something else while the program runs (it runs for ~45 minutes). The issue is that when I try to have Selenium click on the login button I get a timeout error:</p>\n\n<pre><code>Run-time error '101': \nWebRequestTimeout: \nNo response from the server within 30000 seconds\n</code></pre>\n\n<p>The interesting thing is that after it times out, I can use the immediate window to take a screenshot and it's clear that the button was clicked and the browser has advanced to the next page.</p>\n\n<pre><code>Dim D As New PhantomJSDriver\n\nWith D\n   .ExecuteScript (\"window.resizeTo(1920,1080)\")\n   .SendKeys MyKeys.Control, \"0\" 'Set zoom to 100% (causes errors if not 100%)\n   .Get \"LoginPage.com\"\n   .FindElementByName(\"username\").SendKeys \"UserName\"\n   .FindElementByXPath(\"/html/body/div[@class='centreContent']/form[@id='loginForm']/input[@id='passwordDummy']\").Click\n   .FindElementByXPath(\"/html/body/div[@class='centreContent']/form[@id='loginForm']/input[@id='password']\").SendKeys \"Password\"\n\n   .TakeScreenShot.SaveAs \"C:\\Users\\110SidedHexagon\\Downloads\\Capture.png\" '&lt;---Takes screenshot of login screen with uesername and password filled in\n   .FindElementByName(\"loginSubmitButton\", 0.1).Click '&lt;---Error occurs here\n   &lt;--Using the immediate window taking a picture after the error breaks code execution shows login was successful--&gt;\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "amazon-web-services"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1446678745, "post_id": 33531194, "comment_id": 54849234, "body": "as a dirty workaraund -&gt; <code>WshShell.SendKeys &quot;{ENTER}&quot;</code>? more like a question :D"}], "owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1446668509, "creation_date": 1446668181, "last_edit_date": 1531164843, "question_id": 33531194, "link": "https://stackoverflow.com/questions/33531194/issue-with-finding-element-on-amazon-seller-homepage-with-vba-code", "title": "Issue with finding element on Amazon Seller homepage with VBA code", "body": "<p>I recently came across a new problem while working with my Excel VBA code in order to automate the input a value from a cell (order number) into Amazon's search box and searching for the order. I can't seem to locate the proper object to reference the search button on the homepage of the Amazon Seller home page in order to click and proceed. My code is this:</p>\n\n<pre><code>Option Explicit\nDim HTMLDoc As HTMLDocument\nDim MyBrowser As InternetExplorer\nSub MyAmazonSeller()\nDim MyHTML_Element As IHTMLElement\nDim MyURL As String\nDim oSignInLink As HTMLLinkElement\nDim oInputEmail As HTMLInputElement\nDim oInputPassword As HTMLInputElement\nDim oInputSigninButton As HTMLInputButtonElement\nDim oInputSearchOrder As HTMLInputElement\nDim oInputSearchButton As HTMLInputButtonElement\n\n\nMyURL = \"https://sellercentral.amazon.com/gp/homepage.html\"\n\nSet MyBrowser = New InternetExplorer\n\n' Open the browser and navigate.\nWith MyBrowser\n    .Silent = True\n    .Navigate MyURL\n    .Visible = True\n    Do\n        DoEvents\n    Loop Until .ReadyState = READYSTATE_COMPLETE\nEnd With\n\n\n' Get the html document.\nSet HTMLDoc = MyBrowser.Document\n\n' See if you have the sign in link is because you are in the main\n' page\nSet oSignInLink = HTMLDoc.getElementById(\"signin-button-container\")\nIf Not oSignInLink Is Nothing Then\n    oSignInLink.Click\n    Do\n        DoEvents\n    Loop Until MyBrowser.ReadyState = READYSTATE_COMPLETE\nEnd If\n\n' Get the email field and the next button\nSet oInputEmail = HTMLDoc.getElementById(\"username\")\nSet oInputPassword = HTMLDoc.getElementById(\"password\")\n\n' Click the button and wait\noInputEmail.Value = \"xxxxxxxxx@xxxxxx.net\"\n\n\n' Get the password field and the sign in button\nSet oInputPassword = HTMLDoc.getElementById(\"password\")\nSet oInputSigninButton = HTMLDoc.getElementById(\"sign-in-button\")\n\n\n' Click the button and wait\noInputPassword.Value = \"xxxxxxxx\"\noInputSigninButton.Click\n  Do\n    DoEvents\nLoop Until MyBrowser.ReadyState = READYSTATE_COMPLETE\n\n\n\nSet oInputSearchOrder = HTMLDoc.getElementById(\"sc-search-field\")\noInputSearchOrder.Value = \"110-7706193-5695453\"\nSet oInputSearchButton = HTMLDoc.getElementByClassName(\"sc-search-button\")\noInputSearchButton.Click\n  Do\n    DoEvents\nLoop Until MyBrowser.ReadyState = READYSTATE_COMPLETE\nErr_Clear:\nIf Err &lt;&gt; 0 Then\n    Err.Clear\n    Resume Next\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The section right before the Err_Clear is the new snippet of code I've been trying to modify and work with. It seems that the search button does not have a proper ID, so therefore is more difficult to reference. I am getting an Error 91 every time the code gets to the second to last snippet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446666953, "post_id": 33530797, "comment_id": 54843158, "body": "Yea, you can do <code>if strName like</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1446666966, "post_id": 33530797, "comment_id": 54843170, "body": "<code>If objFile.Name Like &quot;s*&quot; Then</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446667646, "post_id": 33531006, "comment_id": 54843576, "body": "I think Tim&#39;s comment is more straightforward, implying the use of an <code>and</code> in the <code>if</code> statement for modified date."}], "tags": [], "owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "is_accepted": false, "score": 0, "last_activity_date": 1446667476, "creation_date": 1446667476, "answer_id": 33531006, "question_id": 33530797, "link": "https://stackoverflow.com/questions/33530797/search-for-a-specific-pattern/33531006#33531006", "title": "Search for a specific pattern", "body": "<p>As you already have strName to hold the filename, you can use the built in INSTR function to test if a string contains a substring. INSTR takes these paramaters:</p>\n\n<p>The position of the string to start searching, \nThe string itself,\nThe string to search for,\nHow to search (vbTextCompare [case insensitive] and vbBinaryCompare [case sensitive] are the two relevant enums here)</p>\n\n<p>INSTR will then return a number indicating the position of the found string, or 0 if the string was not found. For example;</p>\n\n<pre><code>strName = \"this is a test file.txt\"\n\n?INSTR(1,strName,\"test file\",vbTextCompare)\n</code></pre>\n\n<p>Will return 11 as 'test file' appears at the 11th position.</p>\n\n<p>So to build in your code, I would add an if statement to run the copy command:</p>\n\n<pre><code>If Instr(1,strName,\"test file\",vbTextCompare) &gt; 0 then\n    FileCopy objFile, strpaste\nend if\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446669978, "creation_date": 1446666708, "last_edit_date": 1446669978, "question_id": 33530797, "link": "https://stackoverflow.com/questions/33530797/search-for-a-specific-pattern", "title": "Search for a specific pattern", "body": "<p>Below VBA finds the most recently modified file in a specific location then copies that file to another location:</p>\n\n<pre><code>Dim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\n\nDim strcopyfile As String\nDim strpaste As String\nDim strName As String\nDim varDate As Variant\n\nstrcopyfile = \"C:\\Flow\"\nstrpaste = \"C:\\Users\\Draft.xlsx\"\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.getfolder(strcopyfile)\n\nFor Each objFile In objFolder.Files\n    If objFile.DateLastModified &gt; varDate Then\n        varDate = objFile.DateLastModified\n        strName = objFile.Name\n\n        FileCopy objFile, strpaste\n\n    End If\nNext 'objFile  \n</code></pre>\n\n<p>Is there a way of only copying specifically worded files?  </p>\n\n<p>Something similar to the <code>LIKE</code> function in SQL, e.g.: <code>WHERE City LIKE 's%'</code>.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1446666183, "post_id": 33530593, "comment_id": 54842736, "body": "i don&#39;t think the OP means has the word &quot;comment&quot; in a cell, but is actually a comment (little red triangle @ the top right of the cell)."}], "tags": [], "owner": {"reputation": 170, "user_id": 3737152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vENaX.jpg?s=128&g=1", "display_name": "Pieter van der Heijden", "link": "https://stackoverflow.com/users/3737152/pieter-van-der-heijden"}, "is_accepted": false, "score": 0, "last_activity_date": 1446666383, "last_edit_date": 1446666383, "creation_date": 1446666046, "answer_id": 33530593, "question_id": 33530472, "link": "https://stackoverflow.com/questions/33530472/how-do-i-count-cells-with-in-a-range-in-excel-with-specific-value-that-has-a-com/33530593#33530593", "title": "How do I count cells with in a range in excel with specific value that has a comment using vba or formula?", "body": "<pre><code>=COUNTIF(A:A;\"comment\")\n</code></pre>\n\n<p>Where A:A specifies that you want to examine the whole column of A. Instead of A:A, you could also use A1:A3, which means examine A1, A2 and A3.</p>\n\n<p>EDIT:</p>\n\n<p>If you want to count the cells with comments (not with the word \"comment\"), I would suggest to do the following:</p>\n\n<pre><code>=COUNT(A1:A3) - COUNTBLANK(A1:A3)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "is_accepted": true, "score": 1, "last_activity_date": 1446666811, "creation_date": 1446666811, "answer_id": 33530827, "question_id": 33530472, "link": "https://stackoverflow.com/questions/33530472/how-do-i-count-cells-with-in-a-range-in-excel-with-specific-value-that-has-a-com/33530827#33530827", "title": "How do I count cells with in a range in excel with specific value that has a comment using vba or formula?", "body": "<p>Here is one way.  It loops through each cell you pass in the range and checks if there is a comment.  If so, it adds it to a counter.  This is probably going to be pretty expensive if used on large range, but it should at least get you started:</p>\n\n<p>Add to a regular module:</p>\n\n<pre><code>Function CommentCounter(rng As Range) As Integer\n    Dim cell As Range\n    Dim counter As Integer\n    Dim currentComment As String\n\n\n    For Each cell In rng\n        On Error Resume Next\n        currentComment = cell.Comment.Text\n        If Len(currentComment) &gt; 0 Then counter = counter + 1\n        currentComment = \"\"\n    Next cell\n\n    CommentCounter = counter\nEnd Function\n</code></pre>\n\n<p>Just saw the part about having a specific value AND a comment. This should get you going:</p>\n\n<pre><code>Function CommentCounter(rng As Range) As Integer\n    Dim cell As Range\n    Dim counter As Integer\n    Dim currentComment As String\n    Dim specificValue As String\n\n    specificValue = \"Something Specific\"\n\n\n    For Each cell In rng\n        On Error Resume Next\n        currentComment = cell.Comment.Text\n        If cell.Value = specificValue And Len(currentComment) &gt; 0 Then counter = counter + 1\n        currentComment = \"\"\n    Next cell\n\n    CommentCounter = counter\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5526012, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205293411590322/picture?type=large", "display_name": "DMac", "link": "https://stackoverflow.com/users/5526012/dmac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 33530827, "answer_count": 2, "score": 1, "last_activity_date": 1446666811, "creation_date": 1446665607, "last_edit_date": 1531164843, "question_id": 33530472, "link": "https://stackoverflow.com/questions/33530472/how-do-i-count-cells-with-in-a-range-in-excel-with-specific-value-that-has-a-com", "title": "How do I count cells with in a range in excel with specific value that has a comment using vba or formula?", "body": "<p>I need help on this. I'm doing a report and inserting comments on cells. How do I count cells with in a range in excel with specific value that has a comment using vba or formula? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1446665773, "post_id": 33530460, "comment_id": 54842497, "body": "As a first thought, it is probable that the source worksheet is too big, and the destination workbook is from an older version of Excel. Is that right?"}, {"owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1446666106, "post_id": 33530460, "comment_id": 54842692, "body": "Put something down in the answer section so I can accept that one too, because you were right. I was using and .xlsm, and the one I was copying to was an .xls. When I saved it as an .xlsm, it worked."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1446666201, "post_id": 33530460, "comment_id": 54842748, "body": "I am glad it helped. Well, dont worry about that, the important is that the issue is solved. Thanks for your kindness anyway ;)"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1446670163, "post_id": 33530460, "comment_id": 54845011, "body": "@A.S.H I would suggest you do place it as an answer for future users looking for a similar post can easily find a solution. Regards,"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1446671486, "post_id": 33530460, "comment_id": 54845744, "body": "@nbayly okay, in fact, I tested it and interestingly, it seems to occur even if the used range is small. It is a compatibility issue, hence I think it deserves a comprehensive answer. Thanks for you suggestion :)"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1446671673, "last_edit_date": 1446671673, "creation_date": 1446671222, "answer_id": 33532017, "question_id": 33530460, "link": "https://stackoverflow.com/questions/33530460/copy-and-paste-excel-sheets/33532017#33532017", "title": "Copy and paste Excel sheets", "body": "<p>If the destination workbook comes from an older version of Excel (extension .xls for instance, Excel 97 or Excel 2003), the limit of number of rows in old worksheets is 2^16-1, as the row number is encoded on 16 bits. In newer versions, this number is encoded on 32 bits.</p>\n\n<p>Hence, copying a worksheet \"as a whole\" from  a newer version into a workbook from an older version raises this error. From my test, this error occurs even if the actually used range in the copied worksheet is small.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 10314120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1379c9de1b2e85adbdc211cdebfbeffe?s=128&d=identicon&r=PG&f=1", "display_name": "JJAA", "link": "https://stackoverflow.com/users/10314120/jjaa"}, "is_accepted": false, "score": 0, "last_activity_date": 1552477000, "creation_date": 1552477000, "answer_id": 55140982, "question_id": 33530460, "link": "https://stackoverflow.com/questions/33530460/copy-and-paste-excel-sheets/55140982#55140982", "title": "Copy and paste Excel sheets", "body": "<p>I had this same problem. \nFollowing @A.S.G. suggestion, I saved the old workbook with the new file format (xlsx), closed and reopened it and everything worked fine afterwards.\nHope it helps.</p>\n"}], "owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 0, "accepted_answer_id": 33532017, "answer_count": 2, "score": 2, "last_activity_date": 1552477000, "creation_date": 1446665557, "last_edit_date": 1446666070, "question_id": 33530460, "link": "https://stackoverflow.com/questions/33530460/copy-and-paste-excel-sheets", "title": "Copy and paste Excel sheets", "body": "<pre><code>Private Sub CommandButton1_Click()\nDim ws As Worksheet\n    With Application.FileDialog(msoFileDialogFilePicker)\n       .Show\n       If .SelectedItems.Count &lt;&gt; 0 Then\n       fldr = .SelectedItems(1)\n       End If\n    End With\n    Sheets.link.Value = fldr\n    For i = 1 To Worksheets.Count\n        Set ws = Worksheets(i)\n        If ws.Cells(2, 1) = \"X\" Then\n            Sheets.ComboBox1.AddItem (ws.Name)\n        End If\n    Next i\n    Workbooks.Open (fldr)\n    Sheets.Show\nEnd Sub\n\nPrivate Sub Add_Click()\n\nDim x As String\nDim ws As Workbook\n\nx = Right(link.Value, (Len(link.Value) - InStrRev(link.Value, \"ild\") - 3))\n\nWorkbooks(\"Test.xlsm\").Activate\n\nWorksheets(ComboBox1.Value).Copy Before:=Workbooks(x).Worksheets(\"Contract\")\n\nEnd Sub\n</code></pre>\n\n<p>So the basic idea is, you click a button on an Excel sheet. The user then finds the file they want to copy the sheets to. It will find all of a specific type of sheet, put it in a forms combobox and open the selected Excel file.\nThen you choose a sheet from the combobox and copy it from one workbook to the other. It all works until the copying part. I get a long error:</p>\n\n<blockquote>\n  <p>Excel cannot insert the sheets into the destination workbook, because it contains fewer rows and columns that the source workbook. To move or copy the data to the destination workbook, you can select the data and then use Copy and Paste commands to insert it into the sheets of another workbook.</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446666901, "post_id": 33530397, "comment_id": 54843126, "body": "How are you creating the hyperlinks?"}, {"owner": {"reputation": 11, "user_id": 4689609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db02d90f3b7574b72b123b50487bb366?s=128&d=identicon&r=PG&f=1", "display_name": "Sen", "link": "https://stackoverflow.com/users/4689609/sen"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446672956, "post_id": 33530397, "comment_id": 54846534, "body": "ActiveCell.Offset(currentrow, 4).Hyperlinks.Add Anchor:=ActiveCell.Offset(currentrow, 4), Address:=MyFilename"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446674161, "post_id": 33530397, "comment_id": 54847161, "body": "Is <code>MyFileName</code> a regular drive path, or a network (UNC) path?"}, {"owner": {"reputation": 11, "user_id": 4689609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db02d90f3b7574b72b123b50487bb366?s=128&d=identicon&r=PG&f=1", "display_name": "Sen", "link": "https://stackoverflow.com/users/4689609/sen"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446675189, "post_id": 33530397, "comment_id": 54847720, "body": "Its randomly selected by the user. Could be C:\\ drive or on network Q:\\ drive."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446676993, "post_id": 33530397, "comment_id": 54848578, "body": "I see the same thing - I don&#39;t think there&#39;s any way to alter that behavior from Excel."}, {"owner": {"reputation": 11, "user_id": 4689609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db02d90f3b7574b72b123b50487bb366?s=128&d=identicon&r=PG&f=1", "display_name": "Sen", "link": "https://stackoverflow.com/users/4689609/sen"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446724749, "post_id": 33530397, "comment_id": 54867800, "body": "What if I create a process to copy the selected files in a temporary folder on C:\\ drive. Will that work?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446750446, "post_id": 33530397, "comment_id": 54884999, "body": "I tested using my c drive - same security popup"}, {"owner": {"reputation": 11, "user_id": 4689609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db02d90f3b7574b72b123b50487bb366?s=128&d=identicon&r=PG&f=1", "display_name": "Sen", "link": "https://stackoverflow.com/users/4689609/sen"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446750972, "post_id": 33530397, "comment_id": 54885275, "body": "Thanks for trying Tim."}], "owner": {"reputation": 11, "user_id": 4689609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db02d90f3b7574b72b123b50487bb366?s=128&d=identicon&r=PG&f=1", "display_name": "Sen", "link": "https://stackoverflow.com/users/4689609/sen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 700, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446665309, "creation_date": 1446665309, "question_id": 33530397, "link": "https://stackoverflow.com/questions/33530397/convert-excel-to-pdf-embedded-hyperlinks-open-as-files", "title": "Convert Excel to PDF - Embedded hyperlinks open as Files", "body": "<p>I have Adobe Acrobat X Pro. When I create a file hyperlink in MS Excel 2010 and convert the spreadsheet (using VBA code) into a PDF, the link in PDF document is created as \u201copen a web link\u201d as opposed to \u201cOpen a File\u201d.  A security warning always pops up when the link is clicked in the PDF document. Is there any way we can setup the hyperlink in Excel in such a way so that it opens the link as \u201cOpen a File\u201d in execute menu item? Am I missing any parameter?</p>\n\n<p>My code is :</p>\n\n<pre><code>pRng1.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\nMyDirectory &amp; \"\\CLOSING INDEX.pdf\", Quality:= _\nxlQualityStandard, IncludeDocProperties:=False, IgnorePrintAreas:=False, _\nOpenAfterPublish:=False\n</code></pre>\n\n<p>Where \u2018pRng1\u2019 is the range on the spreadsheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446668984, "post_id": 33530161, "comment_id": 54844324, "body": "I concur with @findwindow - just filter your table, then copy the appropriate cells."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1446669096, "post_id": 33530161, "comment_id": 54844393, "body": "What are you evaluating in <code>If Cells(RowCnt, ChkCol).Value &lt; 1 Then</code>? Doesn&#39;t seem related to evaluating if cell is empty? Unless it&#39;s some obscure way to determine if cell is blank? The first thing I would suggest is to only do 1 pass and evaluate both conditions on the same loop. No reason to loop back again when conditions are exclusive."}], "answers": [{"comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1446693403, "post_id": 33531677, "comment_id": 54853240, "body": "You need to be careful, he checks for column &quot;B&quot; in the first loop and &quot;E&quot; in the second. You only check &quot;B&quot; for both."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1446825984, "post_id": 33531677, "comment_id": 54919728, "body": "@Marco Getrost Good point, had not noticed that he changed his &quot;check column&quot;. I have edited my answer appropriately. Thanks."}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 0, "last_activity_date": 1446825900, "last_edit_date": 1446825900, "creation_date": 1446669958, "answer_id": 33531677, "question_id": 33530161, "link": "https://stackoverflow.com/questions/33530161/copy-non-blank-rows-to-new-tab-fast/33531677#33531677", "title": "Copy non-blank rows to new tab fast", "body": "<p>Please consider using the following script for your requested purpose:</p>\n\n<pre><code>Sub Summary_BOM()\n'\n' Hide Empty Rows Macro\n\n    Application.ScreenUpdating = False\n\n    Dim rng As Range\n    Set rng = ActiveSheet.Range(\"B72:B808\")\n\n    Dim cell As Range\n\n    For Each cell In rng.Cells\n        If cell.Value2 = \"\" Or cell.Offset(0, 3).Value2 = \"E\" Then\n            cell.EntireRow.Hidden = True\n        Else\n            cell.EntireRow.Hidden = False\n        End If\n    Next cell\n\n    Application.ScreenUpdating = True\n    MsgBox (\"   Systems and BOM Update Complete!   \")\n\nEnd Sub\n</code></pre>\n\n<p>The script will hopefully be more efficient because you are only doing 1 loop and evaluating both conditions at the same time. It also doesn't use <code>.Select</code> which tends to slow down scripts. You can add further conditions to the if either with <code>And</code> or <code>Or</code> as well as through an <code>ElseIf</code>. Regards,</p>\n\n<p>EDIT: As per Marco Getrost's very valid indication I have changed the second condition of the <code>If</code> statement to evaluate 3 columns to the right of the looped cell.</p>\n"}, {"tags": [], "owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "is_accepted": false, "score": 0, "last_activity_date": 1446693340, "creation_date": 1446693340, "answer_id": 33536042, "question_id": 33530161, "link": "https://stackoverflow.com/questions/33530161/copy-non-blank-rows-to-new-tab-fast/33536042#33536042", "title": "Copy non-blank rows to new tab fast", "body": "<p>Try this:</p>\n\n<pre><code>Sub test()\n\nApplication.ScreenUpdating = False\n\nDim BeginRow As Long, EndRow As Long, c As Long\n\nBeginRow = 72\nEndRow = 808\n\nWith ActiveSheet\n\nFor c = BeginRow To EndRow\n\nIf .Cells(c, 2).Value &lt; 1 Or .Cells(c, 5).Value = \"E\" Then\n\n    .Rows(c).EntireRow.Hidden = True\n\nEnd If\n\nNext\n\nEnd With\n\nMsgBox \"complete\"\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5525991, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HhKX8vWa30Y/AAAAAAAAAAI/AAAAAAAAACw/yzobgd17owQ/photo.jpg?sz=128", "display_name": "Chris Rodgers", "link": "https://stackoverflow.com/users/5525991/chris-rodgers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1448417347, "creation_date": 1446664417, "last_edit_date": 1531161705, "question_id": 33530161, "link": "https://stackoverflow.com/questions/33530161/copy-non-blank-rows-to-new-tab-fast", "title": "Copy non-blank rows to new tab fast", "body": "<p>I am a novice, just starting to use VBA.  I have the following code that works for what I am doing, but as my range has become 800 rows long, it has become very slow to execute.  I'm hoping someone can suggest changes to make this run faster.</p>\n\n<p>I have my Summary Sheet, which I pre-populate with values of column A and C from several other tabs, then I run the following macro to hide the blank rows, based on column B having any value besides blank.</p>\n\n<p>I only want the tabs that have relevant systems to show on the summary tab, so I use the \"E\" qualifier based on a formula in that cell of the summary sheet, so it hides the non-needed systems.</p>\n\n<p>So my loop happens twice, once for blank rows, and the second to hide non-needed systems.</p>\n\n<p>Thank all for your code/comments.  However, I am rethinking this project, and would like your thoughts on if the following is a better approach.  First, what I'm trying to accomplish:\nI am trying to generate a Proposal that shows only the systems that the user wants to include in their proposal. Each tab is a separate estimate for a system.  I have a Project Info tab listing each system that the user chooses Y or N to include only the systems he wants to estimate, allowing the user to choose if they want to include the system or not.  So, I have a button on the Summary tab that should only pull the systems marked \"Y\" from the Project Info tab, go to that tab, pull the rows that have a quantity >0, and list them on the Summary tab to show the Bill of Materials for each system.</p>\n\n<p>So I am thinking a better way to accomplish this is, Check for a Y, or Y, then go to that system tab, sort the rows so only rows with column 2 >0 are the result of the filter, then copy these rows to the Summary tab, then go to next tab with a \"Y\".</p>\n\n<p>Is this a better way to generate this summary tab? </p>\n\n<pre><code>Sub Summary_BOM()\n'\n' Hide Empty Rows Macro\n\nRows(\"72:808\").Select\n    Selection.EntireRow.Hidden = False\n\n    BeginRow = 72\n    EndRow = 808\n    ChkCol = 2\n\n    For RowCnt = BeginRow To EndRow\n        If Cells(RowCnt, ChkCol).Value &lt; 1 Then\n           Cells(RowCnt, ChkCol).EntireRow.Hidden = True\n        End If\n    Next RowCnt\n\n' RemoveUnusedSystems Macro\n'\n    Rows(\"72:808\").Select\n    Selection.SpecialCells(xlCellTypeVisible).Select\n    Selection.EntireRow.Hidden = False\n\n    BeginRow = 72\n    EndRow = 808\n    ChkCol = 5\n\n    For RowCnt = BeginRow To EndRow\n        If Cells(RowCnt, ChkCol).Value = \"E\" Then\n            Cells(RowCnt, ChkCol).EntireRow.Hidden = True\n        End If\n    Next RowCnt\n\n    Application.ScreenUpdating = True\n    Range(\"A71\").Select\n\n    MsgBox (\"   Systems and BOM Update Complete!   \")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 5508319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3679e8f058b22fe7c3e15adee88840?s=128&d=identicon&r=PG&f=1", "display_name": "Inglis", "link": "https://stackoverflow.com/users/5508319/inglis"}, "edited": false, "score": 0, "creation_date": 1446662603, "post_id": 33529540, "comment_id": 54840692, "body": "This months data is 2015     -10-October, the next month will be, 2015    -11-November, and so on and so forth. Id like to exchange the later month code with the older month. Sorry for any confusion"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446663179, "post_id": 33529540, "comment_id": 54841038, "body": "Is there a pattern to the dates?"}, {"owner": {"reputation": 1, "user_id": 5508319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3679e8f058b22fe7c3e15adee88840?s=128&d=identicon&r=PG&f=1", "display_name": "Inglis", "link": "https://stackoverflow.com/users/5508319/inglis"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446663264, "post_id": 33529540, "comment_id": 54841098, "body": "The only way I can think to answer that would be... yes... I use these worksheets once a month. The month im in, for instance this one, would be shown as 2015-10-October. Next month would be 2015-11-November. I have multiple macros to do similar functions with different worksheets. Instead of manually changing the October to a November, I would like a macro to do it for me... Thought?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446663380, "post_id": 33529540, "comment_id": 54841180, "body": "What is the pattern? Something like the third Thursday of each month? or something like that.  Because if there is a pattern set your date as a variable that follows the pattern."}, {"owner": {"reputation": 1, "user_id": 5508319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3679e8f058b22fe7c3e15adee88840?s=128&d=identicon&r=PG&f=1", "display_name": "Inglis", "link": "https://stackoverflow.com/users/5508319/inglis"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446663471, "post_id": 33529540, "comment_id": 54841220, "body": "Sorry for the edit within an edit. I hit the return button to quick... the data could be run randomly every month. could be Friday the 10th of the month, or Thursday the 23rd of the month..."}, {"owner": {"reputation": 1, "user_id": 5508319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3679e8f058b22fe7c3e15adee88840?s=128&d=identicon&r=PG&f=1", "display_name": "Inglis", "link": "https://stackoverflow.com/users/5508319/inglis"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446663974, "post_id": 33529540, "comment_id": 54841517, "body": "Completely random is what I mean"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1446664891, "post_id": 33529540, "comment_id": 54842013, "body": "@Inglis if I uderstood, you want to replace the hardcoded date with the date of the moment, formatted in the same way as <code>2015-10-October</code>. Is that what you want?"}], "answers": [{"tags": [], "owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "is_accepted": false, "score": 0, "last_activity_date": 1446668776, "creation_date": 1446668776, "answer_id": 33531352, "question_id": 33529540, "link": "https://stackoverflow.com/questions/33529540/macro-to-change-date-criteria1-within-macro/33531352#33531352", "title": "Macro to change date criteria1 within macro", "body": "<p>Inglis,</p>\n\n<p>There are several ways to do this.</p>\n\n<p>If you want the quickest way that I wouldn't recommend distributing, (because users can be dumb), just set the autofilter conditions to an inputbox:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$I$1000\").AutoFilter Field:=8, Criteria1:= _\ninputbox(\"Prompt\",\"Title\",\"=2015       -10-October\")\n</code></pre>\n\n<p>Just replace <em>Prompt</em> and <em>Title</em> with something more appropriate.</p>\n\n<p>You could also have an inputbox that formats the date entered as required, but if you don't follow a particular format, the code will error out. Such as:</p>\n\n<pre><code>Dim vDate as Variant\nvDate = inputbox(\"Type a date in the format dd/mm/yyyy\")\nvDate = DateSerial(Mid(vDate, 7, 4), Mid(vDate, 4, 2), Mid(vDate, 1, 2))\nvDate = \"=\" &amp; Format(vDate, \"yyyy       -dd-mmmm\")\nActiveSheet.Range(\"$A$1:$I$1000\").AutoFilter Field:=8, Criteria1:=vDate\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 1, "user_id": 5508319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3679e8f058b22fe7c3e15adee88840?s=128&d=identicon&r=PG&f=1", "display_name": "Inglis", "link": "https://stackoverflow.com/users/5508319/inglis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1446668776, "creation_date": 1446662359, "last_edit_date": 1446662936, "question_id": 33529540, "link": "https://stackoverflow.com/questions/33529540/macro-to-change-date-criteria1-within-macro", "title": "Macro to change date criteria1 within macro", "body": "<p>With the code I have below, this is a few lines from the whole macro, but I need to be able to change the date <code>criteria1</code> easily without having to manually do it each time. This is on a monthly report worksheet. The format of the date is generated from a data-collecting database and cannot be changed. </p>\n\n<p>Does code exist to be able to change a macro, a line in a macro, by using a macro, specifically the date I have in my example?  </p>\n\n<pre><code>Sheets(\"Raw Data 3M\").Select\n    Cells.Select\n    Application.CutCopyMode = False\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$I$1000\").AutoFilter Field:=8, Criteria1:= _\n    \"=2015       -10-October\"\n    Range(\"A1:I5000\").Select\n    Selection.Copy\n    Sheets(\"Raw Data\").Select\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1446661669, "post_id": 33529087, "comment_id": 54840174, "body": "I don&#39;t think <code>On Error</code> captures memory issues. Could you update your question with the <code>Calculate</code> procedure as it might help with establishing the issue."}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1446662221, "post_id": 33529087, "comment_id": 54876885, "body": "Specifically, what error is coming up from excel? Also when is this code being called? Is this in an event, EG: inside a &#39;Workbook_Open&#39; event that&#39;s being ran?"}, {"owner": {"reputation": 1, "user_id": 5525981, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H5sNxcZD-PI/AAAAAAAAAAI/AAAAAAAAAEA/OAiOFYMBmqI/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/5525981/mike"}, "edited": false, "score": 0, "creation_date": 1446662890, "post_id": 33529087, "comment_id": 54876886, "body": "The error is &quot;Excel ran out of resources while attempting to calculate one or more formulas.  As a result, these formulas cannot be evaluated.&quot;"}, {"owner": {"reputation": 1, "user_id": 5525981, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H5sNxcZD-PI/AAAAAAAAAAI/AAAAAAAAAEA/OAiOFYMBmqI/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/5525981/mike"}, "edited": false, "score": 0, "creation_date": 1446662965, "post_id": 33529087, "comment_id": 54876887, "body": "The code is being called in a general module, not inside an event."}, {"owner": {"reputation": 1, "user_id": 5525981, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H5sNxcZD-PI/AAAAAAAAAAI/AAAAAAAAAEA/OAiOFYMBmqI/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/5525981/mike"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1446663254, "post_id": 33529087, "comment_id": 54841094, "body": "Yes, thanks.  Instead of <code>Calculate</code> it&#39;s really <code>ActiveSheet.Calculate</code>.  It&#39;s really that simple.  Any idea if it&#39;s possible to determine which formulas in the worksheet are causing the error?  I don&#39;t have any array formulas but do have some that feed directly into some pivot tables using variables and the indirect function."}], "answers": [{"tags": [], "owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "is_accepted": false, "score": 0, "last_activity_date": 1452098006, "last_edit_date": 1525816150, "creation_date": 1452096410, "answer_id": 34637526, "question_id": 33529087, "link": "https://stackoverflow.com/questions/33529087/err-number-not-populating-for-excel-ran-out-of-resources-error/34637526#34637526", "title": "Err.Number not populating for &#39;Excel Ran Out of Resources&#39; error", "body": "<p>I just happened to run across <a href=\"https://stackoverflow.com/questions/34496888/does-excel-have-vba-for-on-alert-like-it-does-for-on-error\">another issue</a> that sounds like yours.</p>\n\n<p>The point from the other thread is that Excel does not treat these <em>application method</em> results as <em>VBA errors</em>. Rather, they are <em>Excel alerts</em>, and they can be suppressed but not trapped in VBA as errors.</p>\n\n<p>The way I interpret this is that when you execute certain application methods from VBA, it does not raise errors that VBA can trap. Rather, Excel interacts with the user as if the user had issued a GUI command. On the other hand, if an application method is designed to interact with VBA (e.g., if it returns a value), then VBA might be able to handle its errors.</p>\n\n<p>This is distinct from the way VBA handles <em>worksheet functions</em> rather than application methods. VBA can intercept errors raised by worksheet functions, as noted in \"Error Handling With Worksheet Functions\" <a href=\"http://www.cpearson.com/excel/CallingWorksheetFunctionsInVBA.aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I realize this does not solve your problem, but it gives you an idea of why.</p>\n"}], "owner": {"reputation": 1, "user_id": 5525981, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H5sNxcZD-PI/AAAAAAAAAAI/AAAAAAAAAEA/OAiOFYMBmqI/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/5525981/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452098006, "creation_date": 1446660729, "last_edit_date": 1446661735, "question_id": 33529087, "link": "https://stackoverflow.com/questions/33529087/err-number-not-populating-for-excel-ran-out-of-resources-error", "title": "Err.Number not populating for &#39;Excel Ran Out of Resources&#39; error", "body": "<p>I've developed a program using Excel VBA which occasionally causes an 'Excel Ran Out of Resources' error.</p>\n\n<p>Closing the file, reopening, and rerunning the macro always fixes whatever issue created the error.  I know that preventing the error in the first place is best practice, but am resigned to believe that it's unavoidable.</p>\n\n<p>So, I would like to alert the user of the error, instead of Excel doing it, and perform some actions once the error has been detected.  The problem is that I can't get VBA to recognize the error using the <code>On Error GoTo ErrorHandler</code> routine or the <code>Err.Number</code> property.  I never get to the msgbox below:</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Sub test()\n\nOn Error GoTo ErrorHandler\n\n    Calculate\n\nProcedureDone:\n    Exit Sub\n\nErrorHandler:\n    MsgBox \"Error\", vbOKOnly, \"Oops\"\n    Resume ProcedureDone\n\nEnd Sub\n</code></pre>\n\n<p>Any insight would be fantastic since I've been searching for several days and haven't been able to find a work around.</p>\n"}, {"tags": ["vba", "excel", "copy"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446659535, "post_id": 33528691, "comment_id": 54838806, "body": "If you&#39;re using variables as parameters, you don&#39;t add the <code>.value</code> after."}, {"owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446660403, "post_id": 33528691, "comment_id": 54839404, "body": "@findwindow They aren&#39;t variables. One is a ComboBox, one is a TextBox."}, {"owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1446663296, "post_id": 33528691, "comment_id": 54841121, "body": "@Davesexcel link is the file the user browses to. So it&#39;ll be something like C:\\users\\me\\etc\\Test.xls"}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "edited": false, "score": 0, "creation_date": 1446664385, "post_id": 33529957, "comment_id": 54841758, "body": "Now I&#39;m getting a different, very long, error. &quot;Excel cannot insert the sheets into the destination workbook, because it contains fewer rows or columns than the source workbook....&quot;"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "edited": false, "score": 0, "creation_date": 1446664472, "post_id": 33529957, "comment_id": 54841802, "body": "This means it was fixed, but you have another error. I think it deserves a question on its own, it is totally another (interesting) issue! :)"}, {"owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "edited": false, "score": 0, "creation_date": 1446664608, "post_id": 33529957, "comment_id": 54841879, "body": "I actually figured out that piece of code after you told me I needed the filename."}, {"owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "edited": false, "score": 0, "creation_date": 1446664768, "post_id": 33529957, "comment_id": 54841955, "body": "You just want another question so you can have 2 accepted answers, don&#39;t you?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "edited": false, "score": 0, "creation_date": 1446665036, "post_id": 33529957, "comment_id": 54842091, "body": "Not at all, really. But it seems to me that you have a really different issue here.! I am not even sure I can really help in it, but I will try :)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "edited": false, "score": 0, "creation_date": 1446665165, "post_id": 33529957, "comment_id": 54842158, "body": "Remember that SO is daily used by many people browsing for issues that they encounter, so it would be better if we repertoriate the issues correctly."}, {"owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "edited": false, "score": 1, "creation_date": 1446665251, "post_id": 33529957, "comment_id": 54842203, "body": "I know, it was just a joke. I guess those work better when they end with &quot;lol&quot;"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1446664403, "last_edit_date": 1446664403, "creation_date": 1446663652, "answer_id": 33529957, "question_id": 33528691, "link": "https://stackoverflow.com/questions/33528691/subscript-out-of-range-when-attempting-to-copy-worksheet/33529957#33529957", "title": "&quot;Subscript out of Range&quot; when attempting to copy worksheet", "body": "<p>The problem comes from:</p>\n\n<pre><code>Before := Workbooks(link.Value)\n</code></pre>\n\n<p>From your comments it appears that <code>link.value</code> holds the full path name of the file. The method <code>Workbooks(somename)</code> needs the <em>somename</em> to be a name, such as <code>Workbooks(test.xls)</code>, without the path.</p>\n\n<p>Try to get the file name without a path from the browse dialog and feed it to this function without the path. Eventually, to fix it fast, you can use this:</p>\n\n<pre><code>ActiveWorkbook.Worksheets(ComboBox1.Value).Copy Before:=Workbooks(Right(link.Value, Len(link.Value) - InStrRev(link.Value, \"\\\"))).Worksheets(\"Contract\")\n</code></pre>\n\n<p>The added code extracts the file name from the full path given in link.value.</p>\n"}], "owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2001, "favorite_count": 0, "accepted_answer_id": 33529957, "answer_count": 1, "score": 0, "last_activity_date": 1446664403, "creation_date": 1446659436, "last_edit_date": 1446659869, "question_id": 33528691, "link": "https://stackoverflow.com/questions/33528691/subscript-out-of-range-when-attempting-to-copy-worksheet", "title": "&quot;Subscript out of Range&quot; when attempting to copy worksheet", "body": "<pre><code>Private Sub Add_Click()\nActiveWorkbook.Worksheets(ComboBox1.Value).Copy Before:=Workbooks(link.Value).Worksheets(\"Contract\")\nEnd Sub\n</code></pre>\n\n<p>This is the I am 100% sure that link and ComboBox1 have the values that I'm looking for.  </p>\n\n<p>Can someone tell me why I keep getting the error \"<em>Subscript out of Range</em>\"?</p>\n"}, {"tags": ["vba", "sql-update", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1446662434, "post_id": 33529047, "comment_id": 54840593, "body": "There&#39;s something wrong with this syntax - everything from the SELECT statement onwards is red."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1446662857, "post_id": 33529047, "comment_id": 54840832, "body": "I played around with it and tried this: <code>dbsCurrent.Execute &quot; INSERT INTO tbl_Downtime (job, suffix, production_date, reason, downtime_minutes, comment) SELECT &#39;&quot; &amp; Me.Text116 &amp; &quot;&#39;,&#39;&quot; &amp; Me.Text118 &amp; &quot;&#39;,&#39;&quot; &amp; Me.Text126 &amp; &quot;&#39;,&#39;&quot; &amp; Me.Text121 &amp; &quot;&#39;,&#39;&quot; &amp; Me.Text123 &amp; &quot;&#39;,&#39;&quot; &amp; Me.Text128 &amp; &quot;&#39; FROM tbl_Downtime As t WHERE t.ID = &#39;&quot; &amp; Me.Text135 &amp; &quot;&#39;;&quot;</code> - all in ONE line (because I didn&#39;t want to have to deal with that extra underscore you need to use in VBA). But now I&#39;m getting another error: <code>Data type mismatch in criteria expression.</code> Any tips?"}, {"owner": {"reputation": 159, "user_id": 3525055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DRPQt.png?s=128&g=1", "display_name": "Yllzarith", "link": "https://stackoverflow.com/users/3525055/yllzarith"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 1, "creation_date": 1446665554, "post_id": 33529047, "comment_id": 54842370, "body": "That might be caused because you&#39;re passing in text box values, which are text/char datatypes. If the production_date field is a datetime and downtime_minutes is a number you&#39;ll have to use <code>CDate()</code> and <code>CINT()</code> functions to convert them, first.  You should double-check your other fields&#39; data types to see if you need to do any other conversions."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1446747317, "post_id": 33529047, "comment_id": 54883178, "body": "I simplified it to tackle each conversion one at a time, but I&#39;m still getting a data type error: <code>dbsCurrent.Execute &quot; INSERT INTO tbl_Downtime (production_date) SELECT &#39;&quot; &amp; CDate(Me.Text126) &amp; &quot;&#39; FROM tbl_Downtime As t WHERE t.ID = &#39;&quot; &amp; Me.Text135 &amp; &quot;&#39;;&quot;</code> I set my form control to &quot;Short Date&quot;, but it&#39;s still not working. Any thoughts?"}, {"owner": {"reputation": 159, "user_id": 3525055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DRPQt.png?s=128&g=1", "display_name": "Yllzarith", "link": "https://stackoverflow.com/users/3525055/yllzarith"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1446747667, "post_id": 33529047, "comment_id": 54883389, "body": "Access needs dates surrounded by <code>#</code> instead of <code>&#39;</code>, and the integers shouldn&#39;t have any enclosing character.  I should&#39;ve mentioned that before."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1446748000, "post_id": 33529047, "comment_id": 54883603, "body": "<code>dbsCurrent.Execute &quot; INSERT INTO tbl_Downtime (production_date) SELECT #Me.Text126# FROM tbl_Downtime As t WHERE t.ID = Me.Text135 ;&quot;</code> I&#39;m getting an error: <code>Syntax error in date in query expression &#39;#Me.Text126&#39;.</code>"}, {"owner": {"reputation": 159, "user_id": 3525055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DRPQt.png?s=128&g=1", "display_name": "Yllzarith", "link": "https://stackoverflow.com/users/3525055/yllzarith"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1446748264, "post_id": 33529047, "comment_id": 54883769, "body": "The textbox values still have to be concatenated with the string: <code>&quot; INSERT INTO tbl_Downtime (production_date) SELECT #&quot; &amp; Me.Text126 &amp; &quot;# FROM tbl_Downtime As t WHERE t.ID = &quot; &amp; Me.Text135 &amp; &quot;;&quot;</code>"}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1446748607, "post_id": 33529047, "comment_id": 54883985, "body": "That fixed the syntax errors, but now when I hit the button the form gets submitted but nothing changes in the table...."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1446749799, "post_id": 33529047, "comment_id": 54884646, "body": "What struck me as strange at first was that I was still using an <code>INSERT</code> instead of something like <code>UPDATE</code>....might that be a possibility?"}, {"owner": {"reputation": 159, "user_id": 3525055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DRPQt.png?s=128&g=1", "display_name": "Yllzarith", "link": "https://stackoverflow.com/users/3525055/yllzarith"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1446752369, "post_id": 33529047, "comment_id": 54886097, "body": "If nothing changed in the table it would be because none of the rows in the table satisfied your <code>WHERE</code> clause. <code>INSERT</code> adds new rows, while <code>UPDATE</code> changes values in existing rows. An update would be written very differently. I&#39;ve edited my response with an <code>UPDATE</code> statement. It still won&#39;t update anything unless the <code>WHERE</code> is satisfied."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1446753314, "post_id": 33529047, "comment_id": 54886648, "body": "It&#39;s giving me an error: <code>Syntax error in UPDATE statement.</code> - We&#39;re getting close!!"}], "tags": [], "owner": {"reputation": 159, "user_id": 3525055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DRPQt.png?s=128&g=1", "display_name": "Yllzarith", "link": "https://stackoverflow.com/users/3525055/yllzarith"}, "is_accepted": false, "score": 0, "last_activity_date": 1446752317, "last_edit_date": 1446752317, "creation_date": 1446660600, "answer_id": 33529047, "question_id": 33528676, "link": "https://stackoverflow.com/questions/33528676/access-vba-query-input-must-contain-at-least-one-table-or-query/33529047#33529047", "title": "Access VBA: Query input must contain at least one table or query", "body": "<p>It looks like the problem is related to that <code>WHERE</code> statement you have on the end of your SQL statement.  Using the <code>INSERT INTO ... VALUES ...</code> method is used to insert a single row of supplied values, so having a WHERE clause doesn't make sense.</p>\n\n<p>If, instead, you are trying to insert values for one or more rows in an existing table then you want to write your SQL something like:</p>\n\n<pre><code> \"INSERT INTO tbl_Downtime (job, suffix, production_date, reason, downtime_minutes, comment)\n SELECT '\" &amp; Me.Text116 &amp; \"', '\" ... [your other fields go here] ... \"'\n FROM [src_table] As t\n WHERE t.ID = '\" &amp; Me.Text135 &amp; \"';\"\n</code></pre>\n\n<p><strong>EDIT</strong>\nIf you are looking to update values in existing row(s) instead of trying to add new rows with the new values then you'll need something like this, instead:</p>\n\n<pre><code>\"UPDATE tbl_Downtime SET job = '\" &amp; Me.Text116 &amp; \"', suffix = '\" &amp; Me.Text118 &amp; \"', production_date = #\" &amp; Me.Text126 &amp; \"#, reason = '\" &amp; Me.Text121 &amp; \"', downtime_minutes = \" &amp; Me.Text123 &amp; \", comment = '\" &amp; Me.Text128 &amp; \"' WHERE t.ID = '\" &amp; Me.Text135 &amp; \"';\"\n</code></pre>\n"}], "owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581891264, "creation_date": 1446659377, "question_id": 33528676, "link": "https://stackoverflow.com/questions/33528676/access-vba-query-input-must-contain-at-least-one-table-or-query", "title": "Access VBA: Query input must contain at least one table or query", "body": "<p>I'm trying to code a button to update a row based on the ID entered by the user. The ID is an autonumber field generated by the table. The users can create rows with another button but when they need to fix a mistake, I want them to be able to update the row with the correct info. However, my code is giving me the error in the title.</p>\n\n<p>This is the \"Update\" button:</p>\n\n<pre><code>Private Sub Command133_Click()\n\n    Dim dbsCurrent As Database\n    Set dbsCurrent = CurrentDb\n\n    dbsCurrent.Execute \" INSERT INTO tbl_Downtime \" _\n    &amp; \"(job, suffix, production_date, reason, downtime_minutes, comment) VALUES \" _\n    &amp; \"('\" &amp; Me.Text116 &amp; \"','\" &amp; Me.Text118 &amp; \"','\" &amp; Me.Text126 &amp; \"','\" &amp; Me.Text121 &amp; \"','\" &amp; Me.Text123 &amp; \"','\" &amp; Me.Text128 &amp; \"') WHERE ID='\" &amp; Me.Text135 &amp; \"';\"\n\n    Call ClearControl(Me.Text116)\n    Call ClearControl(Me.Text118)\n    Call ClearControl(Me.Text126)\n    Call ClearControl(Me.Text121)\n    Call ClearControl(Me.Text123)\n    Call ClearControl(Me.Text128)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "html", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446662972, "post_id": 33528596, "comment_id": 54840899, "body": "xmlhttp doesn&#39;t render the page - it just has the response from the server for that particular URL (and doesn&#39;t include any linked resources such as scripts, css, images, etc). So there is no button to click (or script to execute).  You need to load the page into a host object which can implement the full functionality - I don&#39;t know if <code>htmlDocument</code> will do that: that&#39;s one thing to try..."}, {"owner": {"reputation": 309, "user_id": 3180897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d907a81cf407e605edf39075d468403e?s=128&d=identicon&r=PG&f=1", "display_name": "MeSS83", "link": "https://stackoverflow.com/users/3180897/mess83"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446663684, "post_id": 33528596, "comment_id": 54841354, "body": "thanks @TimWilliams  for this answer, at least I know that what I was trying to do can&#39;t work. I am going to try your idea and I will let you now"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446667421, "post_id": 33528596, "comment_id": 54843429, "body": "@MeSS83 could you please provide the actual link to the webpage and describe the changes of the content after button clicked?"}, {"owner": {"reputation": 309, "user_id": 3180897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d907a81cf407e605edf39075d468403e?s=128&d=identicon&r=PG&f=1", "display_name": "MeSS83", "link": "https://stackoverflow.com/users/3180897/mess83"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446667674, "post_id": 33528596, "comment_id": 54843597, "body": "Hi @TimWilliams I tried your suggestion. The  <code>htmlDocument</code> support the script execution so I tried to add the  command <code>htmlPage.parentWindow.execScript strScript, &quot;jscript&quot;</code> at the end of the subroutine but I am getting a runtime error"}, {"owner": {"reputation": 309, "user_id": 3180897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d907a81cf407e605edf39075d468403e?s=128&d=identicon&r=PG&f=1", "display_name": "MeSS83", "link": "https://stackoverflow.com/users/3180897/mess83"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446668549, "post_id": 33528596, "comment_id": 54844083, "body": "@omegastripes the effect after button clicked is to update the table in the page with the required data. The link is this one <a href=\"https://www.sisal.it/scommesse-matchpoint/\" rel=\"nofollow noreferrer\">link</a>. I did not put in the question because this site is only accessible from Italy (at least I believe)"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446669433, "post_id": 33528596, "comment_id": 54844575, "body": "Is the page in your browser looks like at <a href=\"http://i.stack.imgur.com/HeXUb.jpg\" rel=\"nofollow noreferrer\">this screenshot</a>? And what is the button you click?"}, {"owner": {"reputation": 309, "user_id": 3180897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d907a81cf407e605edf39075d468403e?s=128&d=identicon&r=PG&f=1", "display_name": "MeSS83", "link": "https://stackoverflow.com/users/3180897/mess83"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446670195, "post_id": 33528596, "comment_id": 54845030, "body": "@omegastripes yes it is the same page, I click the option &quot;ITA Serie A&quot; under &quot;Calcio&quot; (the first choice on the right under the search tab). Normally &quot;Calcio&quot; is open by default for me but it is not important. The script associated to the &quot;ITA Serie A&quot; option is <code>getAlberaturaAntepostManager().clickManifestazione(1, 21)</code>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446672579, "post_id": 33528596, "comment_id": 54846348, "body": "Could you elaborate what your final goal is? I suppose there may be another approach to achieve, excluding browser click &quot;emulation&quot;. It depends on what data are you intent to retrieve from the generated table, and target categories (calcio, basket ..). For example, after click  &quot;ITA Serie A&quot; I see XHR POST request to <a href=\"https://www.sisal.it/scommesse-matchpoint/palinsesto\" rel=\"nofollow noreferrer\">sisal.it/scommesse-matchpoint/palinsesto</a> and <a href=\"http://pastebin.com/NzY8iUP8\" rel=\"nofollow noreferrer\">JSON response</a>, which includes the most of the data presented in the <a href=\"http://i.stack.imgur.com/XFKGf.png\" rel=\"nofollow noreferrer\">generated table</a>."}, {"owner": {"reputation": 309, "user_id": 3180897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d907a81cf407e605edf39075d468403e?s=128&d=identicon&r=PG&f=1", "display_name": "MeSS83", "link": "https://stackoverflow.com/users/3180897/mess83"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446673378, "post_id": 33528596, "comment_id": 54846751, "body": "@omegastripes the goal is to retrieve the data  from the generated table (the one you have)  and insert it in a spreadsheet. In particular I would like to retrieve the data for the  1 X 2 columns. I do not know if this answer you question"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446675353, "post_id": 33528596, "comment_id": 54847812, "body": "I would try to get that data via XHR POST: parse JSON and retrieve values to the sheet (that isn&#39;t hard, see  <a href=\"http://stackoverflow.com/a/33484763/2165759\">link</a>, <a href=\"http://stackoverflow.com/a/32429348/2165759\">link</a>). It&#39;s necessary to find out how to get appropriate XHR parameters and headers. That may be done inspecting the web page XHRs after clicking with e. g. Chrome developer tools Network tab."}, {"owner": {"reputation": 309, "user_id": 3180897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d907a81cf407e605edf39075d468403e?s=128&d=identicon&r=PG&f=1", "display_name": "MeSS83", "link": "https://stackoverflow.com/users/3180897/mess83"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446675625, "post_id": 33528596, "comment_id": 54847964, "body": "thanks @omegastripes tomorrow I will try and let you know"}, {"owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "edited": false, "score": 0, "creation_date": 1446722173, "post_id": 33528596, "comment_id": 54866245, "body": "What do you need is headless browser that can be controlled via vba"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446744479, "post_id": 33528596, "comment_id": 54881579, "body": "@MeSS83, <code>htmlDocument</code> not need, parse JSON with <code>Sub ParseJson()</code> by <a href=\"http://stackoverflow.com/a/30494373/2165759\">the link</a>. First of all, examine XHR made by browser to find out the appropriate parameters you have to send. That could be done in Chrome: open your page, press F12 to open developer tools window, click <code>ITA Serie A</code>, open Network tab, click XHR marked (1) at <a href=\"http://i.stack.imgur.com/lPFaI.png\" rel=\"nofollow noreferrer\">my screenshot</a>, examine parameters (2) and header (3). JSON response the data should be retrieved from is on Response tab (use <a href=\"http://jsbeautifier.org/\" rel=\"nofollow noreferrer\">jsbeautifier.org</a> to make it readable)."}, {"owner": {"reputation": 309, "user_id": 3180897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d907a81cf407e605edf39075d468403e?s=128&d=identicon&r=PG&f=1", "display_name": "MeSS83", "link": "https://stackoverflow.com/users/3180897/mess83"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446746105, "post_id": 33528596, "comment_id": 54882532, "body": "thanks @omegastripes for your help, the steps (1)(2)(3) of your screenshot are what  I have done (or at least I believe :) ) in the code posted in the updated question. I am not sure if I am missing something in   <code>strFormData</code> because i do not full understand how it is created in your <a href=\"http://stackoverflow.com/questions/33462100/how-can-i-automate-save-as-dialog-box-in-ie11-using-vba/33484763#33484763\">link</a>. Unfortunately I cannot use your    <code>Sub ParseJson() </code>  because <code>ScriptControl</code> is not working (i think because i use 64-bit Office that is why i tried to use <code>htmlDOcument</code>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446747161, "post_id": 33528596, "comment_id": 54883105, "body": "<code>strFormData</code> is used there to send Form data, but for this case I suppose there is no Form data send, all necessary parameters are being sent withing <code>Request URL</code> (2). So, target URL and all parameters you have prepared should be joined together (see browser&#39;s XHR as example), then make POST XHR passing that string as URL (like in GET XHR). Concerning JSON parsing, read that post carefully, especially update - <code>Sub ParseJson()</code> uses RegEx&#39;s but not ScriptControl."}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 3180897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d907a81cf407e605edf39075d468403e?s=128&d=identicon&r=PG&f=1", "display_name": "MeSS83", "link": "https://stackoverflow.com/users/3180897/mess83"}, "edited": false, "score": 0, "creation_date": 1446833568, "post_id": 33556335, "comment_id": 54923934, "body": "Thanks a lot @omegastripes,  I really don&#39;t know what I would have done without your help"}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 2, "last_activity_date": 1446764001, "creation_date": 1446764001, "answer_id": 33556335, "question_id": 33528596, "link": "https://stackoverflow.com/questions/33528596/press-a-button-on-a-webpage-using-vba-and-without-opening-ie/33556335#33556335", "title": "Press a button on a webpage using VBA and without opening IE", "body": "<p>Consider the below example:</p>\n\n<pre><code>Option Explicit\n\nSub TestDownload()\n\n    Dim strParams As String\n    Dim strURL As String\n    Dim strJsonString As String\n    Dim varJson As Variant\n    Dim strState As String\n    Dim arrScommessaList() As Variant\n    Dim varScommessa As Variant\n\n    strParams = Join(Array( _\n        \"p_p_id=ScommesseAntepostPalinsesto_WAR_scommesseportlet\", _\n        \"p_p_lifecycle=2\", _\n        \"p_p_state=normal\", _\n        \"p_p_resource_id=dettagliManifestazione\", _\n        \"p_p_cacheability=cacheLevelPage\", _\n        \"_ScommesseAntepostPalinsesto_WAR_scommesseportlet_codDisc=1\", _\n        \"_ScommesseAntepostPalinsesto_WAR_scommesseportlet_codMan=21\", _\n        \"_ScommesseAntepostPalinsesto_WAR_scommesseportlet_codClusterScomm=\", _\n        \"_ScommesseAntepostPalinsesto_WAR_scommesseportlet_filtro=0\" _\n    ), \"&amp;\")\n    strURL = \"http://www.sisal.it/scommesse-matchpoint/palinsesto?\" &amp; strParams\n\n    With CreateObject(\"Microsoft.XMLHTTP\")\n        .Open \"GET\", strURL, False\n        .Send\n        strJsonString = .ResponseText\n    End With\n\n    ParseJson strJsonString, varJson, strState\n\n    arrScommessaList = varJson(\"scommessaList\")\n    For Each varScommessa In arrScommessaList\n        Debug.Print varScommessa(\"descrizioneAvvenimento\")\n        Debug.Print vbTab &amp; _\n        varScommessa(\"esitoList\")(0)(\"formattedQuota\") &amp; vbTab &amp; _\n        varScommessa(\"esitoList\")(1)(\"formattedQuota\") &amp; vbTab &amp; _\n        varScommessa(\"esitoList\")(2)(\"formattedQuota\")\n    Next\n\nEnd Sub\n\nSub ParseJson(ByVal strContent As String, varJson As Variant, strState As String)\n    ' strContent - source JSON string\n    ' varJson - created object or array to be returned as result\n    ' strState - Object|Array|Error depending on processing to be returned as state\n    Dim objTokens As Object\n    Dim lngTokenId As Long\n    Dim objRegEx As Object\n    Dim bMatched As Boolean\n\n    Set objTokens = CreateObject(\"Scripting.Dictionary\")\n    lngTokenId = 0\n    Set objRegEx = CreateObject(\"VBScript.RegExp\")\n    With objRegEx\n        ' specification http://www.json.org/\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = True\n        .Pattern = \"\"\"(?:\\\\\"\"|[^\"\"])*\"\"(?=\\s*(?:,|\\:|\\]|\\}))\"\n        Tokenize objTokens, objRegEx, strContent, lngTokenId, bMatched, \"str\"\n        .Pattern = \"(?:[+-])?(?:\\d+\\.\\d*|\\.\\d+|\\d+)e(?:[+-])?\\d+(?=\\s*(?:,|\\]|\\}))\"\n        Tokenize objTokens, objRegEx, strContent, lngTokenId, bMatched, \"num\"\n        .Pattern = \"(?:[+-])?(?:\\d+\\.\\d*|\\.\\d+|\\d+)(?=\\s*(?:,|\\]|\\}))\"\n        Tokenize objTokens, objRegEx, strContent, lngTokenId, bMatched, \"num\"\n        .Pattern = \"\\b(?:true|false|null)(?=\\s*(?:,|\\]|\\}))\"\n        Tokenize objTokens, objRegEx, strContent, lngTokenId, bMatched, \"cst\"\n        .Pattern = \"\\b[A-Za-z_]\\w*(?=\\s*\\:)\" ' unspecified name without quotes\n        Tokenize objTokens, objRegEx, strContent, lngTokenId, bMatched, \"nam\"\n        .Pattern = \"\\s\"\n        strContent = .Replace(strContent, \"\")\n        .MultiLine = False\n        Do\n            bMatched = False\n            .Pattern = \"&lt;\\d+(?:str|nam)&gt;\\:&lt;\\d+(?:str|num|obj|arr|cst)&gt;\"\n            Tokenize objTokens, objRegEx, strContent, lngTokenId, bMatched, \"prp\"\n            .Pattern = \"\\{(?:&lt;\\d+prp&gt;(?:,&lt;\\d+prp&gt;)*)?\\}\"\n            Tokenize objTokens, objRegEx, strContent, lngTokenId, bMatched, \"obj\"\n            .Pattern = \"\\[(?:&lt;\\d+(?:str|num|obj|arr|cst)&gt;(?:,&lt;\\d+(?:str|num|obj|arr|cst)&gt;)*)?\\]\"\n            Tokenize objTokens, objRegEx, strContent, lngTokenId, bMatched, \"arr\"\n        Loop While bMatched\n        .Pattern = \"^&lt;\\d+(?:obj|arr)&gt;$\" ' unspecified top level array\n        If Not (.test(strContent) And objTokens.Exists(strContent)) Then\n            varJson = Null\n            strState = \"Error\"\n        Else\n            Retrieve objTokens, objRegEx, strContent, varJson\n            strState = IIf(IsObject(varJson), \"Object\", \"Array\")\n        End If\n    End With\nEnd Sub\n\nSub Tokenize(objTokens, objRegEx, strContent, lngTokenId, bMatched, strType)\n    Dim strKey As String\n    Dim strRes As String\n    Dim lngCopyIndex As Long\n    Dim objMatch As Object\n\n    strRes = \"\"\n    lngCopyIndex = 1\n    With objRegEx\n        For Each objMatch In .Execute(strContent)\n            strKey = \"&lt;\" &amp; lngTokenId &amp; strType &amp; \"&gt;\"\n            bMatched = True\n            With objMatch\n                objTokens(strKey) = .Value\n                strRes = strRes &amp; Mid(strContent, lngCopyIndex, .FirstIndex - lngCopyIndex + 1) &amp; strKey\n                lngCopyIndex = .FirstIndex + .Length + 1\n            End With\n            lngTokenId = lngTokenId + 1\n        Next\n        strContent = strRes &amp; Mid(strContent, lngCopyIndex, Len(strContent) - lngCopyIndex + 1)\n    End With\nEnd Sub\n\nSub Retrieve(objTokens, objRegEx, strTokenKey, varTransfer)\n    Dim strContent As String\n    Dim strType As String\n    Dim objMatches As Object\n    Dim objMatch As Object\n    Dim strName As String\n    Dim varValue As Variant\n    Dim objArrayElts As Object\n\n    strType = Left(Right(strTokenKey, 4), 3)\n    strContent = objTokens(strTokenKey)\n    With objRegEx\n        .Global = True\n        Select Case strType\n            Case \"obj\"\n                .Pattern = \"&lt;\\d+\\w{3}&gt;\"\n                Set objMatches = .Execute(strContent)\n                Set varTransfer = CreateObject(\"Scripting.Dictionary\")\n                For Each objMatch In objMatches\n                    Retrieve objTokens, objRegEx, objMatch.Value, varTransfer\n                Next\n            Case \"prp\"\n                .Pattern = \"&lt;\\d+\\w{3}&gt;\"\n                Set objMatches = .Execute(strContent)\n\n                Retrieve objTokens, objRegEx, objMatches(0).Value, strName\n                Retrieve objTokens, objRegEx, objMatches(1).Value, varValue\n                If IsObject(varValue) Then\n                    Set varTransfer(strName) = varValue\n                Else\n                    varTransfer(strName) = varValue\n                End If\n            Case \"arr\"\n                .Pattern = \"&lt;\\d+\\w{3}&gt;\"\n                Set objMatches = .Execute(strContent)\n                Set objArrayElts = CreateObject(\"Scripting.Dictionary\")\n                For Each objMatch In objMatches\n                    Retrieve objTokens, objRegEx, objMatch.Value, varValue\n                    If IsObject(varValue) Then\n                        Set objArrayElts(objArrayElts.Count) = varValue\n                    Else\n                        objArrayElts(objArrayElts.Count) = varValue\n                    End If\n                    varTransfer = objArrayElts.Items\n                Next\n            Case \"nam\"\n                varTransfer = strContent\n            Case \"str\"\n                varTransfer = Mid(strContent, 2, Len(strContent) - 2)\n                varTransfer = Replace(varTransfer, \"\\\"\"\", \"\"\"\")\n                varTransfer = Replace(varTransfer, \"\\\\\", \"\\\")\n                varTransfer = Replace(varTransfer, \"\\/\", \"/\")\n                varTransfer = Replace(varTransfer, \"\\b\", Chr(8))\n                varTransfer = Replace(varTransfer, \"\\f\", Chr(12))\n                varTransfer = Replace(varTransfer, \"\\n\", vbLf)\n                varTransfer = Replace(varTransfer, \"\\r\", vbCr)\n                varTransfer = Replace(varTransfer, \"\\t\", vbTab)\n                .Global = False\n                .Pattern = \"\\\\u[0-9a-fA-F]{4}\"\n                Do While .test(varTransfer)\n                    varTransfer = .Replace(varTransfer, ChrW((\"&amp;H\" &amp; Right(.Execute(varTransfer)(0).Value, 4)) * 1))\n                Loop\n            Case \"num\"\n                varTransfer = Evaluate(strContent)\n            Case \"cst\"\n                Select Case LCase(strContent)\n                    Case \"true\"\n                        varTransfer = True\n                    Case \"false\"\n                        varTransfer = False\n                    Case \"null\"\n                        varTransfer = Null\n                End Select\n        End Select\n    End With\nEnd Sub\n</code></pre>\n\n<p>The output is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M532X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M532X.png\" alt=\"output\"></a></p>\n\n<p>For actual table on the page:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TLlBt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TLlBt.png\" alt=\"table\"></a></p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 309, "user_id": 3180897, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d907a81cf407e605edf39075d468403e?s=128&d=identicon&r=PG&f=1", "display_name": "MeSS83", "link": "https://stackoverflow.com/users/3180897/mess83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2125, "favorite_count": 0, "accepted_answer_id": 33556335, "answer_count": 1, "score": 2, "last_activity_date": 1446764001, "creation_date": 1446659129, "last_edit_date": 1495542220, "question_id": 33528596, "link": "https://stackoverflow.com/questions/33528596/press-a-button-on-a-webpage-using-vba-and-without-opening-ie", "title": "Press a button on a webpage using VBA and without opening IE", "body": "<p>I was wondering if it is possible to \"click a button\" on a webpage without opening the page in IE. The webpage is dynamically generated and the click on the button calls a script that changes the content of the page.</p>\n\n<p>I am able to do this opening Internet Explorer with this sub:</p>\n\n<pre><code>Sub DownloadPageScript(strUrl As String, htmlPage As htmlDocument, strScript As String)\n\n  Dim IE            As Object\n\n  Set IE = CreateObject(\"InternetExplorer.application\")\n  IE.navigate strUrl\n\n  Do\n      DoEvents\n  Loop Until IE.ReadyState = READYSTATE_COMPLETE \n\n  ' Run the scripts associated to the button to get the data\n  IE.Document.parentWindow.execScript strScript, \"jscript\"\n\n  Do\n      DoEvents\n  Loop Until IE.ReadyState = READYSTATE_COMPLETE\n\n  Set htmlPage = IE.Document\n\nEnd Sub\n</code></pre>\n\n<p>But I would like to avoid opening Internet Explorer so I would like to something like this:</p>\n\n<pre><code>Sub Download_Page(strUrl As String, htmlPage As htmlDocument, strScript As String)\n\n  Dim xmlHttp      As Object\n  '\n  Set xmlHttp = CreateObject(\"MSXML2.XMLHTTP\")\n  xmlHttp.Open \"GET\", strUrl, False\n  xmlHttp.setRequestHeader \"Content-Type\", \"text/xml\"\n  xmlHttp.send\n  '\n  ' Here I should add something to execute the script\n  ' \n  ' After execution\n  '\n  Set htmlPage = New htmlDocument\n  htmlPage.body.innerHTML = xmlHttp.ResponseText\n  '\nEnd Sub\n</code></pre>\n\n<p>I was expecting to find something like a <code>xmlHttp.execute(args)</code> method to replicate the action of clicking the button but I was wrong.\nSo my question is: Is it possible to replicate the button click if I do not want to open Internet Explorer? and if yes what should I do?</p>\n\n<p><strong>New approach based on the idea in the comments</strong></p>\n\n<p>I tried the approach suggested by @omegastripes in the comments and I wrote this sub taken by his answer <a href=\"https://stackoverflow.com/questions/33462100/how-can-i-automate-save-as-dialog-box-in-ie11-using-vba/33484763#33484763\">33484763</a>:</p>\n\n<pre><code>Sub TestDownload()\n\n  Dim xmlHttp      As Object\n  Dim htmlPage       As htmlDocument\n  Dim strExportURL   As String\n  Dim strFormData    As Variant\n  Dim strContent     As String\n\n\n    ' build exportURL parameter\n  strExportURL = Join(Array( _\n      \"p_p_id=ScommesseAntepostPalinsesto_WAR_scommesseportle\", _\n      \"p_p_lifecycle=2\", _\n      \"p_p_resource_id=dettagliManifestazione\", _\n      \"p_p_cacheability=cacheLevelPage\", _\n      \"_ScommesseAntepostPalinsesto_WAR_scommesseportlet_codDisc=1\", _\n      \"_ScommesseAntepostPalinsesto_WAR_scommesseportlet_codMan=21\", _\n      \"_ScommesseAntepostPalinsesto_WAR_scommesseportlet_codScomm=3\", _\n      \"_ScommesseAntepostPalinsesto_WAR_scommesseportlet_codClusterScomm=80\", _\n      \"_ScommesseAntepostPalinsesto_WAR_scommesseportlet_filtro=0\" _\n      ), \"&amp;\")\n\n  ' build the whole form data\n  strFormData = Join(Array( _\n        \"languageCode=en\", _\n        \"exportURL=\" &amp; URLEncode(strExportURL) _\n    ), \"&amp;\")\n\n  ' POST XHR to retrieve the content\n  Set xmlHttp = CreateObject(\"Microsoft.XMLHTTP\")\n  xmlHttp.Open \"POST\", \"http://www.sisal.it/scommesse-matchpoint/palinsesto\", False\n  xmlHttp.setRequestHeader \"Content-Type\", \"application/json\"\n  xmlHttp.send strFormData\n\n  Set htmlPage = New htmlDocument\n  htmlPage.body.innerHTML = xmlHttp.responseText\n  '\nEnd Sub\n\nPublic Function URLEncode( _\n   StringVal As String, _\n   Optional SpaceAsPlus As Boolean = False _\n) As String\n  Dim bytes() As Byte, b As Byte, i As Integer, space As String\n\n  If SpaceAsPlus Then space = \"+\" Else space = \"%20\"\n\n  If Len(StringVal) &gt; 0 Then\n    With New ADODB.Stream\n      .Mode = adModeReadWrite\n      .Type = adTypeText\n      .Charset = \"UTF-8\"\n      .Open\n      .WriteText StringVal\n      .Position = 0\n      .Type = adTypeBinary\n      .Position = 3 ' skip BOM\n      bytes = .Read\n    End With\n\n    ReDim result(UBound(bytes)) As String\n\n    For i = UBound(bytes) To 0 Step -1\n      b = bytes(i)\n      Select Case b\n        Case 97 To 122, 65 To 90, 48 To 57, 45, 46, 95, 126\n          result(i) = Chr(b)\n        Case 32\n          result(i) = space\n        Case 0 To 15\n          result(i) = \"%0\" &amp; Hex(b)\n        Case Else\n          result(i) = \"%\" &amp; Hex(b)\n      End Select\n    Next i\n\n    URLEncode = Join(result, \"\")\n  End If\nEnd Function\n</code></pre>\n\n<p>The <code>URLEncode()</code> function is from this post <a href=\"https://stackoverflow.com/questions/218181/how-can-i-url-encode-a-string-in-excel-vba/3812363#3812363\">URLEncode</a>. (I tried to use JScriptControl but It does not work probably because I have Office 64-bit).</p>\n\n<p>This code runs without errors but when I look to the content of <code>htmlPage</code> it is almost empty. I think the problem is that the request I am sending is wrong but I am not able to correct it, can you help me?</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1446658052, "post_id": 33528149, "comment_id": 54837793, "body": "Invert the order of <code>Next K</code> through <code>Next T</code>."}, {"owner": {"reputation": 109, "user_id": 967709, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/716e26e0ca0d17a458fd57b1cc18a602?s=128&d=identicon&r=PG", "display_name": "karhu", "link": "https://stackoverflow.com/users/967709/karhu"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1446658456, "post_id": 33528149, "comment_id": 54838079, "body": "Thanks @ExcelHero! Now the macro is running. Still not in the right order, but it&#39;s a step in the right direction."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 967709, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/716e26e0ca0d17a458fd57b1cc18a602?s=128&d=identicon&r=PG", "display_name": "karhu", "link": "https://stackoverflow.com/users/967709/karhu"}, "edited": false, "score": 0, "creation_date": 1446658545, "post_id": 33528250, "comment_id": 54838147, "body": "Very clear. Thanks. Any idea for which order I should run my statements?"}], "tags": [], "owner": {"reputation": 12642, "user_id": 2655678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LcrLy.jpg?s=128&g=1", "display_name": "AndreaBogazzi", "link": "https://stackoverflow.com/users/2655678/andreabogazzi"}, "is_accepted": false, "score": 2, "last_activity_date": 1446658115, "creation_date": 1446658115, "answer_id": 33528250, "question_id": 33528149, "link": "https://stackoverflow.com/questions/33528149/how-should-i-nest-my-for-next-statements/33528250#33528250", "title": "How should I nest my &#39;For Next&#39; statements?", "body": "<p>You have to close the For Next in the inverse order you opened it.</p>\n\n<pre><code>For k = LBound(A) To UBound(A)\n  ...\n  For J = 1 To 9\n    ...\n    For m = 1 To 8 step 2\n      ....\n    Next m\n    For n = 1 To 9 step 3\n      ....\n    Next n\n  Next J\nNext k\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 4783435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f7c3532f1baaeed6dca4c9e5e98ab8d?s=128&d=identicon&r=PG&f=1", "display_name": "wk11", "link": "https://stackoverflow.com/users/4783435/wk11"}, "is_accepted": false, "score": 0, "last_activity_date": 1446670999, "creation_date": 1446670999, "answer_id": 33531961, "question_id": 33528149, "link": "https://stackoverflow.com/questions/33528149/how-should-i-nest-my-for-next-statements/33531961#33531961", "title": "How should I nest my &#39;For Next&#39; statements?", "body": "<p>If I am reading this correctly:</p>\n\n<p>Machines have multiple finished products\nFinished Products have multiple components\nComponents have multiple attributes</p>\n\n<p>Your innermost loop should handle the components. Next loop out should be finished products, next loop out should be Machines.</p>\n\n<p>To troubleshoot, start new and:\nGet a for/next loop working to do components.\nAdd a for/next loop outside of this (so the FOR is before it in the macro, the next is after it) to expand everything to multiple finished prodocuts\nFinally add a loop outside all of this for machines</p>\n"}], "owner": {"reputation": 109, "user_id": 967709, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/716e26e0ca0d17a458fd57b1cc18a602?s=128&d=identicon&r=PG", "display_name": "karhu", "link": "https://stackoverflow.com/users/967709/karhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446670999, "creation_date": 1446657792, "last_edit_date": 1446658658, "question_id": 33528149, "link": "https://stackoverflow.com/questions/33528149/how-should-i-nest-my-for-next-statements", "title": "How should I nest my &#39;For Next&#39; statements?", "body": "<p>I have a number of 'For Next' statements, but I can't get them to run in the order I want them to. Basically four cells are filled, eight rows are added to the row number index (starting where the previous product was started) and then four cells are filled again:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/sobGB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sobGB.png\" alt=\"1\"></a></p>\n\n<p>Then we jump 1192 cells to the next machine and start the process again:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pGEGl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pGEGl.png\" alt=\"2\"></a></p>\n\n<pre><code>1. Machine 1 Component 0 Attribute 1\n2. Machine 1 Component 0 Attribute 2\n\n...\n\n5. Machine 1 Component 1 Attribute 1\n6. Machine 1 Component 1 Attribute 2\n\n...\n\n9. Machine 2 Component 0 Attribute 1\n10. Machine 2 Component 0 Attribute 2\n\n...\n\n13. Machine 2 Component 1 Attribute 1\n</code></pre>\n\n<p>Here's how I believe the code should run. (I may be completely wrong about the structure here):</p>\n\n<pre><code>cycle through array of attributes K\n    increment component number I\n        increment S \"jump 8 cells\"\n            increment finished product number R\n                increment machine number M\n                    reset finished product number R to 0\n                            increment T \"jump 1192 cells\" \n\n                            increment T \"jump 1192 cells\" \n                    reset finished product number R to 0\n                increment machine number M\n            increment finished product number R \n        increment S \"jump 8 cells\"  \n    increment component number I\ncycle through array of attributes K\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub Button1_Click()\n'r is the current finished product and starts at 0\nr = 0\n\n'k is attribute index. .length, .width, .height, .weight\nDim A(): ReDim A(3)\nA(0) = \"Length\": A(1) = \"Width\": A(2) = \"Height\": A(3) = \"Weight\"\nFor K = LBound(A) To UBound(A)\n\n    'i is part number. 0-19 for 20 components. limited to first part to make output smaller for testing.\n    For i = 0 To 0\n\n        's is row offset. 0 to 1184 for 149 finished products. adds 8 to the row index to start each finished product at the right row.\n        For s = 0 To 8 Step 8\n\n            'r is current finished product. increments by 1 here\n\n            r = r + 1\n\n                'm is machine index. 1,2,3,8. limited to 2 here to make output smaller for testing.\n                Dim Q(): ReDim Q(1)\n                Q(0) = \"1\": Q(1) = \"2\"\n                For m = LBound(Q) To UBound(Q)\n\n                    'p and t for machine row value offset. need to add 1192 for each machine. limited to 2 here to make output smaller for testing.\n                    Dim P(): ReDim P(1)\n                    P(0) = \"0\": P(1) = \"1192\"\n                    For T = LBound(P) To UBound(P)\n\n                        'this msgbox is helpful for debugging. it shows data stores in the variables for each cycle.\n                        MsgBox \"m\" &amp; Q(m) &amp; \" r\" &amp; r &amp; \" i\" &amp; i &amp; \" k\" &amp; A(K) &amp; \" Location: (\" &amp; 4 + s + K + P(T) &amp; \", \" &amp; 2 + i &amp; \")\"\n                        ProductName = \"machine\" &amp; Q(m) &amp; \".finishedProduct[\" &amp; r &amp; \"].component[\" &amp; i &amp; \"].\" &amp; A(K)\n\n\n  If TypeName(Data) = \"Error\" Then\n                            If MsgBox(\"Error reading machine\" &amp; Q(m) &amp; \".finishedProduct[\" &amp; r &amp; \"].Component[\" &amp; i &amp; \"]. \" &amp; _\n                            \"Continue with read?\", vbYesNo + vbExclamation, _\n                            \"Error\") = vbNo Then Exit For\n                            Else\n                            'no error, put data in cell\n                            End If\n\n\n     '0=b4,1=c4,3=d4, etc.   FYI 2,4 = D2 so b4= 4,2 (+0 because first i value)\n                        'writes result to cell. second iteration should start 8 rows below end of previous\n                        Cells(4 + s + K + P(T), 2 + i) = ProductName\n\n 'increment attribute name\nNext K\n\n  'increment component number\n    Next i\n\n     'increment row offset for finished product\n        Next s\n\n          'increment machine number\n                Next m\n\n\n            'increment machine row offset (1190 rows)\n                    Next T\n\nEnd Sub\n</code></pre>\n\n<p>I'm getting an <em>invalid next control variable</em> error at <code>Next K</code> as soon as the sub starts.</p>\n\n<p>How can I make this work?</p>\n"}, {"tags": ["excel", "excel-formula", "conditional-formatting", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1446657977, "post_id": 33528129, "comment_id": 54837735, "body": "Condition formatting works. Say I want F1 to be the formatted text when D1 is &quot;&lt;&quot;.  I would use the following formula in the conditional formatting for F1 <code>=D1=&quot;&lt;&quot;</code>"}, {"owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446658031, "post_id": 33528129, "comment_id": 54837776, "body": "Can I extend this formula to multiple cells?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446658172, "post_id": 33528129, "comment_id": 54837884, "body": "Certainly in the manage rules you would fill in the &quot;applies to:&quot; area with the desired cells. if you make the top one correct it will automatically make the changes to references automatically like autofill.  so if you do not want something to change put a &quot;$&quot; in front."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1446658260, "post_id": 33528129, "comment_id": 54837946, "body": "copy down a range if you want before setting the conditional formatting of the range. Then in your formula rule, reference the active cell of the selected range."}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "edited": false, "score": 0, "creation_date": 1446663944, "post_id": 33528491, "comment_id": 54841498, "body": "I appreciate the help...it seems as if everyone has a different way to do macros.  For example, what are the arguments you&#39;re putting in parentheses (ByVal Sh As Object, ByVal Target As Range)?"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "edited": false, "score": 0, "creation_date": 1446739957, "post_id": 33528491, "comment_id": 54878584, "body": "Those are the standard variables that are needed for the <code>Workbook_SheetChange</code> event. They are added automatically by Excel when you select that event in the IDE dropdowns.. <code>Sh</code> is the sheet that is changing and <code>Target</code> is the range that is changing."}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1446658805, "creation_date": 1446658805, "answer_id": 33528491, "question_id": 33528129, "link": "https://stackoverflow.com/questions/33528129/formatting-an-adjacent-cell-based-on-the-content-of-another-cell/33528491#33528491", "title": "Formatting an adjacent cell based on the content of another cell", "body": "<p>You're right, it is an easy macro. And @Scott Craner is correct as well; conditional formatting will work. However, there are times when you already have a lot of conditional formatting and adding another rule becomes a bit tricky, so here is the macro. Put it in the ThisWorkbook section.</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    If Target.Value = \"&lt;\" Then\n        Sh.Cells(Target.Row, Target.Column + 1).Font.Bold = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>As you can see, you can make your own little formatting rules by checking the value of the cell that changed.</p>\n\n<p>To learn more, search up \"Learn Excel\". Plenty of resources.</p>\n"}, {"comments": [{"owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "edited": false, "score": 0, "creation_date": 1446667132, "post_id": 33528653, "comment_id": 54843264, "body": "I&#39;ve updated the question so that it is a bit more clear."}, {"owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "edited": false, "score": 1, "creation_date": 1446670737, "post_id": 33528653, "comment_id": 54845352, "body": "I very much appreciate your help.  Thank you!!"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1446668072, "last_edit_date": 1446668072, "creation_date": 1446659307, "answer_id": 33528653, "question_id": 33528129, "link": "https://stackoverflow.com/questions/33528129/formatting-an-adjacent-cell-based-on-the-content-of-another-cell/33528653#33528653", "title": "Formatting an adjacent cell based on the content of another cell", "body": "<p>With CF, select the range of cells to apply the formatting to - say Columns B:M (not A because that has no \"immediately to the <em>left</em>\") - HOME > Styles - Conditional Formatting, New Rule..., <em>Use a formula to determine which cells to format</em> and <strong>Format values where this formula is true:</strong>:    </p>\n\n<pre><code>=A1=\"&lt;\"\n</code></pre>\n\n<p><kbd>Format...</kbd>, select Bold, OK, OK. </p>\n\n<p><strong>Edit</strong> By \"those do not need to be emboldened\" I take it you don't mind if they are. That might allow you to embolden the entire sheet (or rather ColumnsC:X) and apply a single <em>conditional</em> format. However that would result in the <code>&lt;</code> themselves being emboldened and I take it you would prefer not. So if formatting is to be applied according to two separate conditions two separate rules are required. Select Columns D:X and for *bold**:  </p>\n\n<pre><code>=C1=\"\"  \n</code></pre>\n\n<p>For Regular, with the same range selection:  </p>\n\n<pre><code>=C1=\"&lt;\" \n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1477, "favorite_count": 0, "accepted_answer_id": 33528653, "answer_count": 2, "score": 1, "last_activity_date": 1447505664, "creation_date": 1446657720, "last_edit_date": 1531161705, "question_id": 33528129, "link": "https://stackoverflow.com/questions/33528129/formatting-an-adjacent-cell-based-on-the-content-of-another-cell", "title": "Formatting an adjacent cell based on the content of another cell", "body": "<p>I believe this is probably an easy macro; it does not appear to be possible with conditional formatting and I have limited experience with macros.</p>\n\n<p>I have many rows in an Excel workbook.  What I'd like to is say:  </p>\n\n<blockquote>\n  <p>If I place a <code>&lt;</code> sign in the currently selected cell, then cell immediately to the right should format as bold, otherwise, it should not be emboldened. </p>\n</blockquote>\n\n<p>I have fooled around with different \"IF\" statements, but I think I'm way off base.  </p>\n\n<p>How in the world do I do this?</p>\n\n<h2>EDIT</h2>\n\n<p>Here is perhaps a better way to show this, because for some reason I still cannot get it to work; I've included a screenshot.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LKspn.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LKspn.gif\" alt=\"Screenshot of What I&#39;m Working On\"></a></p>\n\n<p>(Actually, I realized that I asked the question backwards...it should be that if there if there is a cell with a \"&lt;\" sign then the cell immediately to the right should <strong>not</strong> be bold).</p>\n\n<p>Anyways, let's focus on row 12 for the sake of an example.  It would be nice to have a formula to apply to the entire row that says \"look at cell C12.  If there is nothing in it, then D12 is emboldened.  Look at cell E12, if there is nothing in it then F12 should be emboldened, etc.  Look at cell Q12.  If it has a \"&lt;\" sign, then R12 should not be emboldened\".  The only exception to this would be cells that contain a \"--\"...those do not need to be emboldened.  </p>\n"}, {"tags": ["vba", "email", "outlook", "rule"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1447193091, "post_id": 33528009, "comment_id": 55055044, "body": "Only one question per thread. First search for something like &quot;vba structured text&quot; and start a new question, if necessary, after you put together some code."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1447193012, "creation_date": 1447193012, "answer_id": 33640507, "question_id": 33528009, "link": "https://stackoverflow.com/questions/33528009/outlook-2013-rule-to-copy-email-body-to-clipboard/33640507#33640507", "title": "Outlook 2013 rule to copy email body to clipboard", "body": "<p>You are missing important pieces described in the samples on that site.</p>\n\n<p>As well use the mailitem passed in (itm As mailItem).</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub SaveToClipboard_test()\n\n    Dim curritem As Object\n    Set curritem = ActiveExplorer.Selection(1)\n    If TypeOf curritem Is mailItem Then SaveToClipboard curritem\n\nExitRoutine:\n    Set curritem = Nothing\n\nEnd Sub\n\n\nSub SaveToClipboard(itm As mailItem)\n\n    Dim oData As MSForms.DataObject\n    Dim strPaste As Variant\n\n    Set oData = New MSForms.DataObject\n    oData.SetText itm.body\n    oData.PutInClipboard\n\n    oData.GetFromClipboard\n    strPaste = oData.GetText\n\n    strPaste = Left(strPaste, 1024)\n    MsgBox strPaste\n\nExitRoutine:\n    Set oData = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3514147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b191d9f8ccab4690b36d2bad0d3ae2?s=128&d=identicon&r=PG&f=1", "display_name": "touring", "link": "https://stackoverflow.com/users/3514147/touring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1397, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447193012, "creation_date": 1446657374, "last_edit_date": 1446658239, "question_id": 33528009, "link": "https://stackoverflow.com/questions/33528009/outlook-2013-rule-to-copy-email-body-to-clipboard", "title": "Outlook 2013 rule to copy email body to clipboard", "body": "<p>Using an e-mail rule to trigger a VBA script, is it possible to send the body of an email to the clipboard?  I've found this <a href=\"http://www.slipstick.com/developer/code-samples/paste-clipboard-contents-vba/\" rel=\"nofollow\">method</a> but it doesn't appear to work.</p>\n\n<pre><code>Sub SaveToClipboard(Item As Outlook.MailItem)\nDim Explorer As Outlook.Explorer\nDim oitem As Outlook.MailItem\nDim oData As MSForms.DataObject\n\n\nSet Explorer = Application.ActiveExplorer\n\nIf Explorer.Selection.Count Then\n\n    Set CurrentItem = Explorer.Selection(1)\n    Set oitem = CurrentItem\n\n    oData = oitem.Body  \n    oData.PutInClipboard\n\n    'Using this to test the output\n    MsgBox oData\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>And following that, how would I search for a line in the body of the email starting with \"Info:\" and only copy that line to the clipboard?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "is_accepted": false, "score": 0, "last_activity_date": 1446658872, "creation_date": 1446658872, "answer_id": 33528511, "question_id": 33527997, "link": "https://stackoverflow.com/questions/33527997/how-to-pass-control-values-between-userform-events/33528511#33528511", "title": "How to pass control values between userform events?", "body": "<p>Try making LotBox and SensorCheckBox public variables</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1446659358, "creation_date": 1446659358, "answer_id": 33528666, "question_id": 33527997, "link": "https://stackoverflow.com/questions/33527997/how-to-pass-control-values-between-userform-events/33528666#33528666", "title": "How to pass control values between userform events?", "body": "<p>You've declared <code>LotBox</code> and <code>SensorCheckBox</code> within UserForm_Initialize, so as soon as that sub ends they will both go out of scope.  </p>\n\n<p>Move them up to the top of the module as Global variables.</p>\n"}], "owner": {"reputation": 11, "user_id": 5525735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3666246f4b783045a769af865f311d29?s=128&d=identicon&r=PG&f=1", "display_name": "J. Belz", "link": "https://stackoverflow.com/users/5525735/j-belz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1446659358, "creation_date": 1446657345, "question_id": 33527997, "link": "https://stackoverflow.com/questions/33527997/how-to-pass-control-values-between-userform-events", "title": "How to pass control values between userform events?", "body": "<p>I'm struggling with a userform (called Label_Select) that I created.\nI'm initializing the userform with some text boxes and check boxes and assigning some values in them. \nThen I have a OK button on the userform that was created at design mode (I can create this button at runtime if that helps).</p>\n\n<p>I need to use the text boxes and check boxes values in the code of the OK_Click, refer below.\nCurrently I get a \"Sub or Function not defined\" for the OK_Click sub.</p>\n\n<p>How can I pass the text boxes and check boxes values between the userform initialize code and other click events of the userform?</p>\n\n<p>Thank you for your responses</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim LotBox(500) As MSForms.TextBox\nDim SensorCheckBox(500) As MSForms.CheckBox\n\nFor i = 1 To 4\nFor j = 1 To 4\n\nk = i + (4 * j)\n\nSet LotBox(k - 4) = Label_Select.Controls.Add(\"Forms.TextBox.1\")\nSet SensorCheckBox(k - 4) = Label_Select.Controls.Add(\"Forms.CheckBox.1\")\n\nWith LotBox(k - 4)\n .Top = 250 + i * 25\n .Left = (j * 80) - 50\n .Width = 40\n .Height = 30\n .Font.Size = 14\n .Font.Name = \"Calibri\"\n .SpecialEffect = fmSpecialEffectSunken\n .Value = k\n .AutoSize = True\nEnd With\n\nWith SensorCheckBox(k - 4)\n    .Top = 246 + i * 25\n    .Left = (j * 80) - 8\n    .Height = 30\nEnd With\n\nIf LotBox(k - 4).Value = \" \" Then\n   Label_Select.Controls.Remove LotBox(k - 4).Name\n   Label_Select.Controls.Remove SensorCheckBox(k - 4).Name\nEnd If\n\nNext j\nNext i\n\nEnd Sub\n\nPrivate Sub OK_Click()\n\nWorksheets(\"Sheet1\").Cells(1,1)=LotBox(1).Value\nWorksheets(\"Sheet1\").Cells(2,1)=SensorCheckBox(1).Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 15224, "user_id": 2397327, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b1b4bb1ed29f123c55b9c916212f47ed?s=128&d=identicon&r=PG", "display_name": "Jonathan Lam", "link": "https://stackoverflow.com/users/2397327/jonathan-lam"}, "edited": false, "score": 0, "creation_date": 1446657325, "post_id": 33527938, "comment_id": 54837312, "body": "What flavor of regex are you using (e.g. PHP, Java, JS, etc.)?"}, {"owner": {"reputation": 6677, "user_id": 2282445, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/G3qze.jpg?s=128&g=1", "display_name": "Matt Williamson", "link": "https://stackoverflow.com/users/2282445/matt-williamson"}, "reply_to_user": {"reputation": 15224, "user_id": 2397327, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b1b4bb1ed29f123c55b9c916212f47ed?s=128&d=identicon&r=PG", "display_name": "Jonathan Lam", "link": "https://stackoverflow.com/users/2397327/jonathan-lam"}, "edited": false, "score": 0, "creation_date": 1446657468, "post_id": 33527938, "comment_id": 54837407, "body": "I&#39;m sorry I forgot to mention it. I&#39;m using the Microsoft Regex Parser in Excel VBA. I&#39;ve updated my post."}], "answers": [{"comments": [{"owner": {"reputation": 6677, "user_id": 2282445, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/G3qze.jpg?s=128&g=1", "display_name": "Matt Williamson", "link": "https://stackoverflow.com/users/2282445/matt-williamson"}, "edited": false, "score": 1, "creation_date": 1446663063, "post_id": 33528050, "comment_id": 54840957, "body": "Thanks Jonathan. While this does work, I&#39;m looking for something more generic because I have other userdefined fields that weren&#39;t included and some of them I don&#39;t know what are yet. I don&#39;t want to recode every time I get a new set of fields."}, {"owner": {"reputation": 6677, "user_id": 2282445, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/G3qze.jpg?s=128&g=1", "display_name": "Matt Williamson", "link": "https://stackoverflow.com/users/2282445/matt-williamson"}, "edited": false, "score": 0, "creation_date": 1446732174, "post_id": 33528050, "comment_id": 54872682, "body": "That works great to match the userdefined fields after they are split out but I need to match them from the first set of fields in my post. LiqUserDefField#(where#=1\u20132 etc,"}, {"owner": {"reputation": 6677, "user_id": 2282445, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/G3qze.jpg?s=128&g=1", "display_name": "Matt Williamson", "link": "https://stackoverflow.com/users/2282445/matt-williamson"}, "edited": false, "score": 0, "creation_date": 1446743984, "post_id": 33528050, "comment_id": 54881264, "body": "I&#39;ve updated my original post. I&#39;ve made some progress but still not quite there."}, {"owner": {"reputation": 6677, "user_id": 2282445, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/G3qze.jpg?s=128&g=1", "display_name": "Matt Williamson", "link": "https://stackoverflow.com/users/2282445/matt-williamson"}, "edited": false, "score": 0, "creation_date": 1447083898, "post_id": 33528050, "comment_id": 54999804, "body": "I&#39;m just getting back to this now. Can you take a look at my latest regex and tell me what I can do to improve it?"}], "tags": [], "owner": {"reputation": 15224, "user_id": 2397327, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b1b4bb1ed29f123c55b9c916212f47ed?s=128&d=identicon&r=PG", "display_name": "Jonathan Lam", "link": "https://stackoverflow.com/users/2397327/jonathan-lam"}, "is_accepted": false, "score": 0, "last_activity_date": 1446685461, "last_edit_date": 1446685461, "creation_date": 1446657489, "answer_id": 33528050, "question_id": 33527938, "link": "https://stackoverflow.com/questions/33527938/regular-expression-to-match-userdeffields/33528050#33528050", "title": "Regular expression to match userdeffields", "body": "<p>Try this:</p>\n\n<pre><code>LiqUserDefField[1-2]|UserDefField(1[0-8]|[0-9])|UserDefinedField[0-3]|UserDefType[1-3]|UserDefinedField(10|[0-9])\n</code></pre>\n\n<p>See it at <a href=\"https://regex101.com/r/iH5cA2/1\" rel=\"nofollow\">Regex101</a>.</p>\n\n<hr />\n\n<p>For a much more generic matcher (on request), you can simplify this to:</p>\n\n<pre><code>[a-zA-Z]+(Field|Type)[0-9]{1,2}\n</code></pre>\n\n<p>See this at <a href=\"https://regex101.com/r/eE8qR8/1\" rel=\"nofollow\">Regex101</a>.</p>\n"}], "owner": {"reputation": 6677, "user_id": 2282445, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/G3qze.jpg?s=128&g=1", "display_name": "Matt Williamson", "link": "https://stackoverflow.com/users/2282445/matt-williamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446750545, "creation_date": 1446657189, "last_edit_date": 1531164843, "question_id": 33527938, "link": "https://stackoverflow.com/questions/33527938/regular-expression-to-match-userdeffields", "title": "Regular expression to match userdeffields", "body": "<p>I'm looking for a regular expression that will match the following:</p>\n\n<pre><code>LiqUserDefField#(where#=1\u20132\nUserDefField(#=1\u201318)\nUserDefinedField#(where#=1\u20133)\nUserDefType#(where#=1\u20132)\nUserDefinedField#(#=1\u201310)\n</code></pre>\n\n<p>I want to return:</p>\n\n<pre><code>LiqUserDefField1\nLiqUserDefField2\n\nUserDefField1\nUserDefField2\nUserDefField3\nUserDefField4\nUserDefField5\nUserDefField6\nUserDefField7\nUserDefField8\nUserDefField9\nUserDefField10\nUserDefField11\nUserDefField12\nUserDefField13\nUserDefField14\nUserDefField15\nUserDefField16\nUserDefField17\nUserDefField18\n\nUserDefinedField1\nUserDefinedField2\nUserDefinedField3\n\nUserDefType1\nUserDefType2\nUserDefType3\n\nUserDefField1\nUserDefField2\nUserDefField3\nUserDefField4\nUserDefField5\nUserDefField6\nUserDefField7\nUserDefField8\nUserDefField9\nUserDefField10\n</code></pre>\n\n<p>I've been playing at Regex101.com for a few hours now but I'm not making any progress. I'll embarrass myself and show what I've been trying so far:</p>\n\n<pre><code>\\w+UserDef\\w+\\#\\(\\w+\\#\\=\\(\\d)\\-(\\d) \n</code></pre>\n\n<p>I'm using the Microsoft Regex Parser in Excel VBA. </p>\n\n<p>Here is an example I came up with: <a href=\"https://regex101.com/r/eE8qR8/4\" rel=\"nofollow\">Regex101</a></p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "edited": false, "score": 0, "creation_date": 1446719034, "post_id": 33528218, "comment_id": 54864296, "body": "In the real code it is not &quot;tblMain,Name&quot;. I rewrote the code so that my question would be clearer. I am putting the real code here: <code>sqlUrlCount = &quot;SELECT tblNewMain.WebAddressCompareString, Count(*) AS [How Many?] FROM tblNewMain WHERE (((tblNewMain.WebAddressCompareString) Like &#39;&quot; &amp; Chr(letter) &amp; &quot;*&#39;)) GROUP BY tblNewMain.WebAddressCompareString HAVING (((Count(*))&gt;1))&quot; </code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "edited": false, "score": 0, "creation_date": 1446728716, "post_id": 33528218, "comment_id": 54870268, "body": "That string is fine - using CHR(34) - a double quote, will return error 2342, CHR(39) - a single quote, returns error 3075.  Ahhh.... think I&#39;ve got it.  Are you using <b>DoCmd.RunSQL</b> to execute the statement? That only works on action type queries - UPDATE, CREATE TABLE, etc."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1446729164, "last_edit_date": 1446729164, "creation_date": 1446657968, "answer_id": 33528218, "question_id": 33527916, "link": "https://stackoverflow.com/questions/33527916/how-can-i-put-a-variable-in-an-sql-command-string-in-vba-access/33528218#33528218", "title": "how can I put a variable in an sql command string in vba access?", "body": "<p>When I tried to create a field called 'Name' in Access it complained that it was a reserved word - could be part of the problem.</p>\n\n<p>The code below returned an SQL string which worked when I pasted it into the query window (note - have updated 'Name' to 'sName' and the field type is Text).<br>\nAlso note - Access loves putting brackets around everything and most of the time they're not required.</p>\n\n<pre><code>Sub test()\n\n    Dim letter As Long\n    Dim sqlUrlCount As String\n\n    letter = 65\n\n    sqlUrlCount = \"SELECT sName FROM tblMain WHERE sName Like '\" &amp; Chr(letter) &amp; \"*'\"\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong><br>\nTo use a SELECT query:</p>\n\n<pre><code>Sub Test()\n\n    Dim sqlUrlCount As String\n    Dim letter As Long\n    Dim rst As DAO.Recordset\n\n    letter = 65\n\n    sqlUrlCount = \"SELECT tblNewMain.WebAddressCompareString, \" &amp; _\n        \"Count(*) AS [How Many?] FROM tblNewMain \" &amp; _\n        \"WHERE (((tblNewMain.WebAddressCompareString) Like '\" &amp; Chr(letter) &amp; \"*')) \" &amp; _\n        \"GROUP BY tblNewMain.WebAddressCompareString HAVING (((Count(*))&gt;1))\"\n\n    Set rst = CurrentDb.OpenRecordset(sqlUrlCount)\n\n    With rst\n        If Not .BOF And Not .EOF Then\n            .MoveFirst\n            Do\n                Debug.Print .Fields(\"WebAddressCompareString\") &amp; \" : \" &amp; .Fields(1)\n                .MoveNext\n            Loop Until .EOF\n        End If\n        .Close\n    End With\n\n    Set rst = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>If it's a DDL or DML type query - i.e. UPDATE, CREATE TABLE, SELECT INTO, etc then you can use <code>DoCmd.RunSQL</code></p>\n"}, {"comments": [{"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "edited": false, "score": 0, "creation_date": 1446719825, "post_id": 33538876, "comment_id": 54864795, "body": "What i mean is; it works fine with the <code>like &#39;A*&#39;</code> but the minute I change it to the dynamic version i get the message."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "edited": false, "score": 0, "creation_date": 1446720886, "post_id": 33538876, "comment_id": 54865503, "body": "Then <code>letter</code> probably doesn&#39;t hold a valid value. Try to print out the string before running the query: <code>Debug.Print sqlUrlCount</code> and tell us what you see."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1446708734, "creation_date": 1446708734, "answer_id": 33538876, "question_id": 33527916, "link": "https://stackoverflow.com/questions/33527916/how-can-i-put-a-variable-in-an-sql-command-string-in-vba-access/33538876#33538876", "title": "how can I put a variable in an sql command string in vba access?", "body": "<p>Your syntax is correct so try to copy-n-paste the resulting string:</p>\n\n<pre><code>SELECT tblMain.Name FROM tblMain WHERE (((tblMain.Name) Like 'A*'))\n</code></pre>\n\n<p>into a new query. </p>\n\n<p>If it fails, adjust the SQL and then your code.</p>\n\n<p>If it runs, then rewrite your code line (no copy-n-paste), then delete the old code line.</p>\n"}], "owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1489, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594643282, "creation_date": 1446657136, "last_edit_date": 1594643282, "question_id": 33527916, "link": "https://stackoverflow.com/questions/33527916/how-can-i-put-a-variable-in-an-sql-command-string-in-vba-access", "title": "how can I put a variable in an sql command string in vba access?", "body": "<pre><code>letter=65 \n</code></pre>\n\n<p>is a variable representing a letter (A) in the alphabet.\nI want to insert letter into part of an sql command string:\n    <code>sqlUrlCount = \"SELECT tblMain.Name FROM tblMain WHERE (((tblMain.Name) Like     '\" &amp; Chr(letter) &amp; \"*'))\"</code></p>\n\n<p>but I get an error: \"Run-time error '3075': Syntax error in string in query expression '(((tblMain.Name) Like\".</p>\n\n<p>this is probably because of the quotes and double quotes I used. but how else can I do this?</p>\n"}, {"tags": ["vba", "outlook", "subdirectory"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1446684741, "post_id": 33527816, "comment_id": 54851071, "body": "See <a href=\"http://stackoverflow.com/questions/2272361/can-i-iterate-through-all-outlook-emails-in-a-folder-including-sub-folders\" title=\"can i iterate through all outlook emails in a folder including sub folders\">stackoverflow.com/questions/2272361/&hellip;</a>"}, {"owner": {"reputation": 63, "user_id": 5227878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6aed51a7509065cd288bd61e95f0b724?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Torpey", "link": "https://stackoverflow.com/users/5227878/colin-torpey"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1446735345, "post_id": 33527816, "comment_id": 54875097, "body": "Thanks. I used the code given in the link and it imports everything in Outlook. While this is useful it gives too much information. I was hoping that I could specify a folder (such as the Inbox) and import everything from this and it&#39;s subfolders. Do you know if it is possible to modify the above code to achieve this?"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1446754499, "last_edit_date": 1495542771, "creation_date": 1446754499, "answer_id": 33553951, "question_id": 33527816, "link": "https://stackoverflow.com/questions/33527816/outlook-vba-importing-emails-from-subfolders-into-excel/33553951#33553951", "title": "Outlook VBA Importing Emails from Subfolders into Excel", "body": "<p>From this question <a href=\"https://stackoverflow.com/questions/2272361/can-i-iterate-through-all-outlook-emails-in-a-folder-including-sub-folders\">Can I iterate through all Outlook emails in a folder including sub-folders?</a></p>\n\n<p>Replace your attempt to iterate the folders ...</p>\n\n<pre><code>For Each olFolderA In olParentFolder.Folders\n    For Each olMail In olFolderA.Items\n    If TypeName(olMail) = \"MailItem\" Then\n    On Error Resume Next\n        lCnt = lCnt + 1\n        aOutput(lCnt, 1) = olMail.SenderEmailAddress\n        aOutput(lCnt, 2) = olMail.ReceivedTime\n        aOutput(lCnt, 3) = olMail.Subject\n        aOutput(lCnt, 4) = olMail.Sender\n        aOutput(lCnt, 5) = olMail.To\n    End If\n    Next\nNext\n</code></pre>\n\n<p>...using the idea of recursion described in the currently accepted answer.</p>\n\n<pre><code>Private Sub processFolder(ByVal oParent As Outlook.MAPIFolder)\n    Dim oFolder As Outlook.MAPIFolder\n    Dim oMail As Outlook.MailItem\n\n    For Each oMail In oParent.Items\n\n    'Get your data here ...\n\n    Next\n\n    If (oParent.Folders.Count &gt; 0) Then\n        For Each oFolder In oParent.Folders\n            processFolder oFolder   ' &lt;--- no brackets around oFolder\n        Next\n    End If\nEnd Sub\n</code></pre>\n\n<p>The fleshed out second answer shows how to declare variables outside of the code to pass values.</p>\n\n<pre><code>Option Explicit\n\nDim aOutput() As Variant\nDim lCnt As Long\n\nSub SubFolders()\n'\n' Code for Outlook versions 2007 and subsequent\n' Declare with Folder rather than MAPIfolder\n'\nDim xlApp As Excel.Application\nDim xlSh As Excel.Worksheet\n\nDim olNs As Namespace\nDim olParentFolder As Folder\n\nSet olNs = GetNamespace(\"MAPI\")\nSet olParentFolder = olNs.GetDefaultFolder(olFolderInbox)\n\nlCnt = 0\nReDim aOutput(1 To 100000, 1 To 5)\n\nProcessFolder olParentFolder\n\nOn Error Resume Next\nSet xlApp = GetObject(, \"Excel.Application\")\nOn Error GoTo 0\nIf xlApp Is Nothing Then Set xlApp = CreateObject(\"Excel.Application\")\n\nSet xlSh = xlApp.Workbooks.Add.Sheets(1)\n\nxlSh.range(\"A1\").Resize(UBound(aOutput, 1), UBound(aOutput, 2)).Value = aOutput\nxlApp.Visible = True\n\nExitRoutine:\n    Set olNs = Nothing\n    Set olParentFolder = Nothing\n    Set xlApp = Nothing\n    Set xlSh = Nothing\n\nEnd Sub\n\nPrivate Sub ProcessFolder(ByVal oParent As Folder)\n\nDim oFolder As Folder\nDim oMail As Object\n\nFor Each oMail In oParent.Items\n\n    If TypeName(oMail) = \"MailItem\" Then\n        lCnt = lCnt + 1\n        aOutput(lCnt, 1) = oMail.SenderEmailAddress\n        aOutput(lCnt, 2) = oMail.ReceivedTime\n        aOutput(lCnt, 3) = oMail.Subject\n        aOutput(lCnt, 4) = oMail.Sender\n        aOutput(lCnt, 5) = oMail.To\n    End If\n\nNext\n\nIf (oParent.Folders.count &gt; 0) Then\n    For Each oFolder In oParent.Folders\n        ProcessFolder oFolder\n    Next\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5227878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6aed51a7509065cd288bd61e95f0b724?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Torpey", "link": "https://stackoverflow.com/users/5227878/colin-torpey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1596, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1592984027, "creation_date": 1446656797, "last_edit_date": 1592984027, "question_id": 33527816, "link": "https://stackoverflow.com/questions/33527816/outlook-vba-importing-emails-from-subfolders-into-excel", "title": "Outlook VBA Importing Emails from Subfolders into Excel", "body": "<p>I am trying to import details of every email (sender, received time, subject etc.) in my Inbox into an Excel file. I have code that works fine for a specific folder within the Inbox but my Inbox has several subfolders, and these subfolders also have subfolders. </p>\n\n<p>After much trial and error I have managed to import details of all subfolders under the Inbox. However the code does not import the emails from the 2nd tier of subfolders and it also skips the emails that are still in the Inbox itself. I have searched this site and others but cannot find the code to loop through all folders and subfolders of an Inbox.</p>\n\n<p>For example I have an Inbox with subfolders Reports, Pricing and Projects.\nThe Report subfolder has subfolders called Daily, Weekly and Monthly. I can import the emails in Reports but not in Daily, Weekly and Monthly.</p>\n\n<p>My code as it stands is below:</p>\n\n<pre><code>Sub SubFolders()\n\nDim olMail As Variant\nDim aOutput() As Variant\nDim lCnt As Long\nDim xlSh As Excel.Worksheet\nDim olApp As Outlook.Application\nDim olNs As Folder\nDim olParentFolder As Outlook.MAPIFolder\nDim olFolderA As Outlook.MAPIFolder\nDim olFolderB As Outlook.MAPIFolder\n\nSet olApp = New Outlook.Application\nSet olNs = olApp.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox)\n\nSet olParentFolder = olNs\nReDim aOutput(1 To 100000, 1 To 5)\n\nFor Each olFolderA In olParentFolder.Folders\n    For Each olMail In olFolderA.Items\n    If TypeName(olMail) = \"MailItem\" Then\n    On Error Resume Next\n        lCnt = lCnt + 1\n        aOutput(lCnt, 1) = olMail.SenderEmailAddress\n        aOutput(lCnt, 2) = olMail.ReceivedTime\n        aOutput(lCnt, 3) = olMail.Subject\n        aOutput(lCnt, 4) = olMail.Sender\n        aOutput(lCnt, 5) = olMail.To\n\n    End If\n    Next\nNext\n\nSet xlApp = New Excel.Application\nSet xlSh = xlApp.Workbooks.Add.Sheets(1)\n\nxlSh.Range(\"A1\").Resize(UBound(aOutput, 1), UBound(aOutput, 2)).Value = aOutput\nxlApp.Visible = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446662613, "post_id": 33527771, "comment_id": 54840700, "body": "Hah!  Yes I see your meaning now..."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 5016790, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LGeve0xiC0o/AAAAAAAAAAI/AAAAAAAAGgs/U7FMjfwz518/photo.jpg?sz=128", "display_name": "Alex Roberts", "link": "https://stackoverflow.com/users/5016790/alex-roberts"}, "is_accepted": false, "score": 0, "last_activity_date": 1446660682, "creation_date": 1446660682, "answer_id": 33529075, "question_id": 33527771, "link": "https://stackoverflow.com/questions/33527771/extract-smtp-address-from-exchange-user-in-the-from-field-of-a-message/33529075#33529075", "title": "Extract SMTP address from Exchange User in the FROM field of a message", "body": "<p>I have a work-around that seems decently efficient. </p>\n\n<pre><code>Const PR_TRANSPORT_MESSAGE_HEADERS = \"http://schemas.microsoft.com/mapi/proptag/0x007D001E\"\n\na = Split(obj.PropertyAccessor.GetProperty(PR_TRANSPORT_MESSAGE_HEADERS), vbCrLf)\nFor i = 0 To UBound(a)\n    If InStr(1, a(i), \"From:\", vbTextCompare) = 1 Then\n    MsgBox Replace(Split(a(i), \"&lt;\")(1), \"&gt;\", \"\")\n    End If\nNext\n</code></pre>\n\n<p>This pulls the SMTP address directly from the header and does not care what type of message it is. </p>\n\n<p>There still has to be a better way though... </p>\n"}, {"comments": [{"owner": {"reputation": 56, "user_id": 5016790, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LGeve0xiC0o/AAAAAAAAAAI/AAAAAAAAGgs/U7FMjfwz518/photo.jpg?sz=128", "display_name": "Alex Roberts", "link": "https://stackoverflow.com/users/5016790/alex-roberts"}, "edited": false, "score": 0, "creation_date": 1446826382, "post_id": 33550840, "comment_id": 54919962, "body": "Yeah, that SenderEmailAddress property fixed a LOT of problems. I cant believe I missed that! Thanks! I plan to implement the PR_SENT... soon too. I really appreciate your help!"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1446743887, "creation_date": 1446743887, "answer_id": 33550840, "question_id": 33527771, "link": "https://stackoverflow.com/questions/33527771/extract-smtp-address-from-exchange-user-in-the-from-field-of-a-message/33550840#33550840", "title": "Extract SMTP address from Exchange User in the FROM field of a message", "body": "<p><code>MailItem.Sender.GetExchnageUser().ProimarySmtpAddress</code> should work fine for the EX senders, but your code checks the <code>SenderEmailAddress</code> property instead of <code>SenderEmailType</code>. Change it to</p>\n\n<pre><code>If obj.SenderEmailType = \"EX\" Then\n</code></pre>\n\n<p>You can also check the PR_SENT_REPRESENTING_SMTP_ADDRESS property (DASL name <code>http://schemas.microsoft.com/mapi/proptag/0x5D02001F</code>, use <code>MailItem.PropertyAccessor.GetProperty</code>) before using the MailItem.Sender property (which is more expensive)</p>\n"}], "owner": {"reputation": 56, "user_id": 5016790, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LGeve0xiC0o/AAAAAAAAAAI/AAAAAAAAGgs/U7FMjfwz518/photo.jpg?sz=128", "display_name": "Alex Roberts", "link": "https://stackoverflow.com/users/5016790/alex-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 0, "accepted_answer_id": 33550840, "answer_count": 2, "score": 0, "last_activity_date": 1447264036, "creation_date": 1446656658, "last_edit_date": 1447264036, "question_id": 33527771, "link": "https://stackoverflow.com/questions/33527771/extract-smtp-address-from-exchange-user-in-the-from-field-of-a-message", "title": "Extract SMTP address from Exchange User in the FROM field of a message", "body": "<p>I want to organize messages in folders by domain (and possibly user). I have a script but it can't get the SMTP addresses from exchange users. The below code is an excerpt from the address extractor.</p>\n\n<pre><code>///For each obj in objFolder.Items\n    If obj.SenderEmailAddress = \"EX\" Then\n    Set objSender = obj.Sender\n        If Not (objSender Is Nothing) Then\n            Set objExchUser = Sender.GetExchangeUser()\n            If Not (objExchUser Is Nothing) Then\n                strSender = objExchUser.PrimarySmtpAddress\n            End If\n        End If\n    Else\n        If obj.SenderEmailAddress = \"\" Then\n        strSender = \"ERROR@ERROR.GOV\"\n        Else\n        MsgBox obj.SenderEmailAddress\n        'MsgBox obj.PrimarySmtpAddress 'errs out\n        'MsgBox Sender.GetExchangeUser() 'errs out\n        'MsgBox Obj.Sender.GetExchangeUser() 'errs out\n        strSender = obj.PrimarySmtpAddress\n        End If\n    End If\n///Next\n</code></pre>\n\n<p>The code works but for those coming from an email group (helpdesk@myexchange.org for example) or spoofed email addresses. </p>\n\n<p>obj.SenderEmailAddress results in \"/O=EXCHANGELABS/OU=EXCHANGE ADMINISTRATIVE GROUP (removedtextforstack)/CN=RECIPIENTS/CN=7E2removedtextforstackF6-USERNAME\"</p>\n\n<p>I believe this is to be expected, but Sender.GetExchangeUser() gives an Object Required error. I don't particularly want 3000 lines of code to dig through AD to try to look up an AD code/user for every email. We use office 365 and it's managed by many people, so things aren't straitforward with accessing the address lists.</p>\n"}, {"tags": ["excel", "rows", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3490381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8103be3ed45e2dd09d90094e945d04db?s=128&d=identicon&r=PG&f=1", "display_name": "user3490381", "link": "https://stackoverflow.com/users/3490381/user3490381"}, "edited": false, "score": 0, "creation_date": 1446662572, "post_id": 33528318, "comment_id": 54840668, "body": "Thank you for your response, both macros worked for what I was trying to do!"}], "tags": [], "owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1446658279, "creation_date": 1446658279, "answer_id": 33528318, "question_id": 33527758, "link": "https://stackoverflow.com/questions/33527758/macro-to-re-arrange-data-from-x-number-of-columns-into-x-number-of-rows-then-cop/33528318#33528318", "title": "Macro to re-arrange data from x number of columns into x number of rows then copy down data in rows A and B", "body": "<p>This should do the trick, i put my many assumptions in the code comments. </p>\n\n<p>My main one is that there are no gaps between columns with data. EG: Column D is filled out, Column E is blank, Column F is filled out.</p>\n\n<p>Also that there are no 'blank' rows for entries for Column A, and that when we do see a blank row the function stops. Please fill in your 'Worksheet Name' where it says 'Customize to your sheet name'.</p>\n\n<pre><code>Public Sub ReOrder()\n    Dim sheet As Worksheet\n    Dim row As Integer\n    Dim col As Integer\n    Dim offset As Integer\n    row = 2\n\n    'Customize to your sheet name\n    Set sheet = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    'I am assuming there are no 'blanks' between rows or columns\n    'If there are such 'blanks' use UsedRange.Rows or UsedRange.Columns\n    'Then skip over the blanks with an if statement\n\n    'Keep processing while we see data in the first column\n    While (sheet.Cells(row, 1).Value &lt;&gt; \"\")\n        'We only need to make a new row if anything past column C is filled out with something\n        col = 4\n        offset = 1\n        While (sheet.Cells(row, col).Value &lt;&gt; \"\")\n            'Insert new row\n            sheet.Rows(row + offset).EntireRow.Insert shift:=xlDown\n\n            'Assign Column values to the new row\n            sheet.Cells(row + offset, 1).Value = sheet.Cells(row, 1).Value\n            sheet.Cells(row + offset, 2).Value = sheet.Cells(row, 2).Value\n            sheet.Cells(row + offset, 3).Value = sheet.Cells(row, col).Value\n\n            'Remove Column value from the source row\n            sheet.Cells(row, col).Value = \"\"\n\n            col = col + 1\n            offset = offset + 1\n        Wend\n        row = row + 1\n    Wend\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3490381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8103be3ed45e2dd09d90094e945d04db?s=128&d=identicon&r=PG&f=1", "display_name": "user3490381", "link": "https://stackoverflow.com/users/3490381/user3490381"}, "edited": false, "score": 0, "creation_date": 1446662539, "post_id": 33528396, "comment_id": 54840646, "body": "Thank you so much! This helped a ton!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 3490381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8103be3ed45e2dd09d90094e945d04db?s=128&d=identicon&r=PG&f=1", "display_name": "user3490381", "link": "https://stackoverflow.com/users/3490381/user3490381"}, "edited": false, "score": 0, "creation_date": 1446663341, "post_id": 33528396, "comment_id": 54841146, "body": "@user3490381 - If it works for you, do you mind marking as answer? (or if Kris&#39; is better, mark his).  If you need any tweaks, just let me know!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1446658506, "creation_date": 1446658506, "answer_id": 33528396, "question_id": 33527758, "link": "https://stackoverflow.com/questions/33527758/macro-to-re-arrange-data-from-x-number-of-columns-into-x-number-of-rows-then-cop/33528396#33528396", "title": "Macro to re-arrange data from x number of columns into x number of rows then copy down data in rows A and B", "body": "<p>Here's a short one that should work:</p>\n\n<pre><code>Sub test()\nDim lastRow&amp;, lastCol&amp;, noItems&amp;\nDim i&amp;, k&amp;\n' This macro will assume your column A and B are constant, and your items will start in column C\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = lastRow To 1 Step -1\n    lastCol = Cells(i, Columns.Count).End(xlToLeft).Column\n    noItems = WorksheetFunction.CountA(Range(Cells(i, 3), Cells(i, lastCol)))\n\n    ' Now we know how many items, so add the info to the new rows.\n    ' Start with the name and col B\n    Range(Cells(i + 1, 1), Cells(i + noItems - 1, 1)).EntireRow.Insert\n    Range(Cells(i, 1), Cells(i + noItems - 1, 2)).FillDown\n    For k = 1 To noItems - 1\n        Cells(i + k, 3).Value = Cells(i, 3 + k).Value\n        Cells(i, 3 + k).Value = \"\"\n    Next k\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>It will look in column C through [whatever column in that row is the last one, going right], then create new rows to fit the amount of items in there.</p>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1446662461, "last_edit_date": 1495540938, "creation_date": 1446662461, "answer_id": 33529574, "question_id": 33527758, "link": "https://stackoverflow.com/questions/33527758/macro-to-re-arrange-data-from-x-number-of-columns-into-x-number-of-rows-then-cop/33529574#33529574", "title": "Macro to re-arrange data from x number of columns into x number of rows then copy down data in rows A and B", "body": "<p>I\u2019m guessing the 3a3n codes are company specific. Assuming <code>ABC1231</code> is in B1 of Sheet1, insert a new Row1 and apply the technique detailed <a href=\"https://stackoverflow.com/questions/20541905/convert-matrix-to-3-column-table-reverse-pivot-unpivot-flatten-normal/20543651#20543651\">here</a>, selecting Range in \u201cStep 2b of 3\u201d to be B1: to the end of your data. When you get to the Table you may filter to select and delete the rows blank in Column <code>Value</code>.  </p>\n\n<p>In B2 enter:  </p>\n\n<pre><code>=INDEX(Sheet3!A:A,MATCH(A4,Sheet3!B:B,0))  \n</code></pre>\n\n<p>Select and Copy Table then Paste Special\u2026, Values over the top and switch the order of Columns A and B.</p>\n"}], "owner": {"reputation": 13, "user_id": 3490381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8103be3ed45e2dd09d90094e945d04db?s=128&d=identicon&r=PG&f=1", "display_name": "user3490381", "link": "https://stackoverflow.com/users/3490381/user3490381"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1446662461, "creation_date": 1446656622, "last_edit_date": 1531161705, "question_id": 33527758, "link": "https://stackoverflow.com/questions/33527758/macro-to-re-arrange-data-from-x-number-of-columns-into-x-number-of-rows-then-cop", "title": "Macro to re-arrange data from x number of columns into x number of rows then copy down data in rows A and B", "body": "<p>I have a rather significant amount of data in a spreadsheet that is poorly arranged. The current format has a company, a product name, and the ingredients listed afterwards. The ingredients all have their own column without a header. For instance, and I apologize this is not reflected below since I'm terrible at markup language, Column A would be labeled <strong>Manufacturer</strong>, Column B would be labeled as <strong>Product Name</strong>, Column C would be labeled <strong>Ingredients</strong> but then the rest of the columns are unlabeled.</p>\n\n<p>Ultimately, I need to move the data to a new sheet, where data only appears in columns A, B, and C. The number of ingredients each product has varies.</p>\n\n<p>I hope that the desired format helps.</p>\n\n<p>Current Format:<br/></p>\n\n<pre><code>1| Acme Inc.    | ABC123       | Water       | Sugar     | Eggs    | Salt\n2| Acme Inc.    | BCD456       | Cornmeal    | Salt\n3| JJ Baking    | JJ4567       | Flour       | Nuts      | Fruit\n</code></pre>\n\n<p>Desired Format:<br/></p>\n\n<pre><code>1| Acme Inc. | ABC123 | Water\n2| Acme Inc. | ABC123 | Sugar\n3| Acme Inc. | ABC123 | Eggs\n4| Acme Inc. | ABC123 | Salt\n5| Acme Inc. | BCD456 | Cornmeal\n6| Acme Inc. | BCD456 | Salt\n7| JJ Baking | JJ4567 | Flour\n8| JJ Baking | JJ4567 | Nuts\n9| JJ Baking | JJ4567 | Fruit\n</code></pre>\n"}, {"tags": ["forms", "excel", "button", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446656796, "post_id": 33527593, "comment_id": 54836931, "body": "Try removing the () and just a space like <code>ExcelRangeToPowerPoint &quot;mystring&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 5525768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f7889c52a227f6328d9da86802867f9?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice Cinque", "link": "https://stackoverflow.com/users/5525768/maurice-cinque"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446676260, "post_id": 33527593, "comment_id": 54848256, "body": "I finally managed to get it work selecting Macro in &quot;myworkbook.xlsm&quot; instead of &quot;this workbook&quot;. It works with the original syntax &#39;ExcelRangeToPowerPoint(&quot;mystring&quot;)&#39;. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "is_accepted": false, "score": 0, "last_activity_date": 1446659767, "creation_date": 1446659767, "answer_id": 33528797, "question_id": 33527593, "link": "https://stackoverflow.com/questions/33527593/parameter-to-form-button-macro/33528797#33528797", "title": "Parameter to form button macro?", "body": "<p>This is the form code </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Module1.test\n\nEnd Sub\n</code></pre>\n\n<p>This is the module code</p>\n\n<pre><code>Sub test()\n    MsgBox UserForm.CommandButton1.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5525768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f7889c52a227f6328d9da86802867f9?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice Cinque", "link": "https://stackoverflow.com/users/5525768/maurice-cinque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446772237, "creation_date": 1446656177, "last_edit_date": 1531164843, "question_id": 33527593, "link": "https://stackoverflow.com/questions/33527593/parameter-to-form-button-macro", "title": "Parameter to form button macro?", "body": "<p>I am trying to pass a parameter from a form button to a macro called \"Sub ExcelRangeToPowerPoint(s As String)\"</p>\n\n<p>I assign the macro using the following syntax as indicated in an other thread: 'ExcelRangeToPowerPoint(\"mystring\")'</p>\n\n<p>When firing the button, I get an error: impossible to execute macro ''ExcelRangeToPowerPoint(\"mystring\")'' ....</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["excel", "vba", "compiler-errors", "event-handling"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1446654839, "post_id": 33527006, "comment_id": 54835498, "body": "Sometimes event procedure signatures get corrupted internally, even while able to &quot;display&quot; correctly. This even happened in classic VB. Copy the entire procedure to a text editor, like Notepad. Delete the entire procedure from the sheet module. Save the workbook. Use the VBE to insert the Worksheet_Change signature... let it do it. Copy the internal text from Notepad and paste it inside the signature the VBE created."}, {"owner": {"reputation": 13, "user_id": 5525592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9052f537b1d6d44e1a1742c300888b?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Kuter", "link": "https://stackoverflow.com/users/5525592/taylor-kuter"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1446666968, "post_id": 33527006, "comment_id": 54843171, "body": "Thanks, that seemed to help. I&#39;m not entirely sure what happened, but it seems to have worked itself out."}], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 0, "last_activity_date": 1446667092, "creation_date": 1446667092, "answer_id": 33530908, "question_id": 33527006, "link": "https://stackoverflow.com/questions/33527006/compile-error-in-event-handler-subroutine/33530908#33530908", "title": "Compile error in event handler subroutine", "body": "<p>Sometimes event procedure signatures get corrupted internally, even while able to \"display\" correctly. This even happened in classic VB. </p>\n\n<p>Copy the entire procedure to a text editor, like Notepad. Delete the entire procedure from the sheet module. </p>\n\n<p>Save the workbook. Use the VBE to insert the Worksheet_Change signature... let it do it. </p>\n\n<p>Copy the internal text from Notepad and paste it inside the signature the VBE created.</p>\n"}], "owner": {"reputation": 13, "user_id": 5525592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9052f537b1d6d44e1a1742c300888b?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Kuter", "link": "https://stackoverflow.com/users/5525592/taylor-kuter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 33530908, "answer_count": 1, "score": 1, "last_activity_date": 1446667092, "creation_date": 1446654440, "last_edit_date": 1446655594, "question_id": 33527006, "link": "https://stackoverflow.com/questions/33527006/compile-error-in-event-handler-subroutine", "title": "Compile error in event handler subroutine", "body": "<p>I have a script that is supposed to run when a change is made in a particular sheet, so I created a Worksheet_Change() type sub in the specified sheet.</p>\n\n<p>However, once a change is made, VBA spits out a Compile Error for \"<em>Wrong number of arguments or invalid property assignment</em>\", and highlights the first line of the sub, which is <code>Private Sub Worksheet_Change(ByVal Target As Range)</code>:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim newVal As String\nDim oldVal As String\nDim pageEnd As Integer\nDim oldRng As Range\nDim newRng As Range\nDim toolList As Range\n</code></pre>\n\n<p>The code continues on for many lines after the Dim statements.</p>\n\n<p>How can I get past the first line? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1446654660, "post_id": 33526988, "comment_id": 54835368, "body": "Welcome to SO!  When posting code, while a screenshot is better than nothing, instead would you mind posting the actual code (putting it in code tags, the {} icon), and then you can add a line after saying you get an error, and what that error is.  That way, we can easily copy the code and try it on our end."}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1446661080, "post_id": 33526988, "comment_id": 54839835, "body": "I second everything that @BruceWayne said.  Please post code as text."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1446654727, "post_id": 33527023, "comment_id": 54835417, "body": "To piggy back off of this, it&#39;s not recommended to use <code>Range</code> or <code>Cells</code> as a variable name too, for the same reason.  (OP didn&#39;t do this, but it&#39;s something beginners to VB understandably do often)."}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1446661330, "post_id": 33527023, "comment_id": 54839991, "body": "strComp is a function, not a keyword, thus the reason for the missing &quot;(&quot; error."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 4, "last_activity_date": 1446723493, "last_edit_date": 1446723493, "creation_date": 1446654487, "answer_id": 33527023, "question_id": 33526988, "link": "https://stackoverflow.com/questions/33526988/string-len-error/33527023#33527023", "title": "String.Len() error", "body": "<p>strComp is a function of VB, so you cant assign to it.  Use strComplete or something else.</p>\n"}], "owner": {"reputation": 73, "user_id": 5291888, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10206436781932296/picture?type=large", "display_name": "Jack Tilley", "link": "https://stackoverflow.com/users/5291888/jack-tilley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 33527023, "answer_count": 1, "score": 0, "last_activity_date": 1453571877, "creation_date": 1446654387, "last_edit_date": 1453571877, "question_id": 33526988, "link": "https://stackoverflow.com/questions/33526988/string-len-error", "title": "String.Len() error", "body": "<p>I am having difficulty finding the length of this string. Looking up examples of this but it looks correct.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vKtBH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vKtBH.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446654309, "post_id": 33526919, "comment_id": 54835103, "body": "comment out the <code>On Error Resume Next</code> and see where it hangs.  That will give a better idea where your problem lays."}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446654533, "post_id": 33526919, "comment_id": 54835271, "body": "Tried this, but nothing changed."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446654663, "post_id": 33526919, "comment_id": 54835371, "body": "set up a breakpoint and verify that the value of <code>region</code> is found in the data range.  the error is stating it cannot find the value in the region."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1446655211, "post_id": 33526919, "comment_id": 54835782, "body": "<code>0</code> as the third parameter of <code>VLookup</code> is definitely causing problems."}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "edited": false, "score": 0, "creation_date": 1446655678, "post_id": 33526919, "comment_id": 54836093, "body": "Good catch.  I corrected that mistake, but still get the N/A value."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446655759, "post_id": 33526919, "comment_id": 54836140, "body": "Will you fix the code in your original post to reflect the change you made?"}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "edited": false, "score": 0, "creation_date": 1446655858, "post_id": 33526919, "comment_id": 54836216, "body": "Will do.  Actually, I found teh error is it was quite stupid.  My <code>vlookoup</code> range was not correct.  Apologies for wasting time."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1446657354, "post_id": 33526919, "comment_id": 54837327, "body": "One more thing: you don&#39;t need a loop, <code>If</code> and <code>index...</code> variables. Simply replace <code>i</code> with <code>riskLookupScore</code> in the second <code>Vlookup</code>"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1446695015, "post_id": 33526919, "comment_id": 54853689, "body": "Whats <code>region</code>? could be that <code>region</code> is a range defined on another sheet than the one you are using the VLookUp in. This could cause a problem."}], "owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446654163, "creation_date": 1446654163, "question_id": 33526919, "link": "https://stackoverflow.com/questions/33526919/referencing-sheets-by-index-number", "title": "Referencing sheets by index number", "body": "<p>I am creating a model that asks users to input parameters (year, region, risktype), and return values associated with them.  The returned values will change depending on the year and region that they input.  At the moment, I trying to create a <code>for loop</code> that searches across multiple sheets.  I am only focused on the region, and will work on the year input later.  I created two functions to get the index numbers of the sheets in question:</p>\n\n<pre><code>'creates index number for first needed sheet, used to locate projected scores\nPublic Function GetStartIndex() As Integer\n    On Error Resume Next\n    GetStartIndex = ThisWorkbook.Worksheets(\"LMC_Model\").Index + 1\nEnd Function\n\n'creates index number for final sheet, used to locate projected scores\nPublic Function GetEndIndex() As Integer\n    On Error Resume Next\n    GetEndIndex = ThisWorkbook.Worksheets(\"Other\").Index - 2 'ensures that we get correct sheet\nEnd Function\n</code></pre>\n\n<p>Later on, I have a section with the actual <code>for loop</code>.  </p>\n\n<pre><code>indexStart = GetStartIndex()\nindexEnd = GetEndIndex()\nriskLookupScore = Application.VLookup(risk, ws9.range(\"G10:H14\"), 2)\n\nFor i = indexStart To indexEnd\n    If i = riskLookupScore Then\n        Cells(16, 4).Value = Application.VLookup(region, ThisWorkbook.Worksheets(i).range(\"c3:c11\"), 0)\n    End If\nNext i\n</code></pre>\n\n<p>The <code>riskLookupScore</code> variable is assigned a number used for matching in the <code>for loop</code>.  When I run the code, however, I get a 'NA' value for my result.  I feel as though referencing the sheet used with <code>ThisWorkbook.Worksheets(i).range(\"c3:c11\")</code> is where this is occurring.  Can anyone offer any advice?</p>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1446655509, "post_id": 33526910, "comment_id": 54835974, "body": "Which line is throwing the error?"}, {"owner": {"reputation": 3, "user_id": 5463400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c304d39497486c44c38bfe86d4ac9a78?s=128&d=identicon&r=PG&f=1", "display_name": "md393", "link": "https://stackoverflow.com/users/5463400/md393"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1446655659, "post_id": 33526910, "comment_id": 54836082, "body": "If cell.Value Like &quot;?*@xyz.com&quot; And _            LCase(Cells(cell.Row, &quot;N&quot;).Value) = &quot;open&quot; Then"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5463400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c304d39497486c44c38bfe86d4ac9a78?s=128&d=identicon&r=PG&f=1", "display_name": "md393", "link": "https://stackoverflow.com/users/5463400/md393"}, "edited": false, "score": 0, "creation_date": 1446657369, "post_id": 33527807, "comment_id": 54837340, "body": "The error still occurs, is it because my Sheet1 still references N3? If so how do I get around this?"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "reply_to_user": {"reputation": 3, "user_id": 5463400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c304d39497486c44c38bfe86d4ac9a78?s=128&d=identicon&r=PG&f=1", "display_name": "md393", "link": "https://stackoverflow.com/users/5463400/md393"}, "edited": false, "score": 0, "creation_date": 1447094070, "post_id": 33527807, "comment_id": 55005941, "body": "I can&#39;t recreate an error on this line. Maybe post your file somewhere and I&#39;ll have a look."}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": false, "score": 0, "last_activity_date": 1446656776, "creation_date": 1446656776, "answer_id": 33527807, "question_id": 33526910, "link": "https://stackoverflow.com/questions/33526910/run-time-error-13-type-mismatch-when-there-is-no-email-address/33527807#33527807", "title": "&quot;Run-time error &#39;13&#39;: Type Mismatch.&quot; when there is no email address", "body": "<p>I am addressing only the error in the title, I haven't looked at the rest of the code or whether it does what you want. Your problem is in this line</p>\n\n<pre><code>LCase(Cells(cell.Row, \"N\").Value) = \"open\" Then\n</code></pre>\n\n<p>Cells() is expecting a row number and a column number but you are using a string (\"N\") as the column number, thats a type mismatch, if you want column \"N\" then use the number 14 like this</p>\n\n<pre><code>LCase(Cells(cell.Row, 14).Value) = \"open\" Then\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5463400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c304d39497486c44c38bfe86d4ac9a78?s=128&d=identicon&r=PG&f=1", "display_name": "md393", "link": "https://stackoverflow.com/users/5463400/md393"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 858, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446658123, "creation_date": 1446654118, "last_edit_date": 1446658123, "question_id": 33526910, "link": "https://stackoverflow.com/questions/33526910/run-time-error-13-type-mismatch-when-there-is-no-email-address", "title": "&quot;Run-time error &#39;13&#39;: Type Mismatch.&quot; when there is no email address", "body": "<p>I am having trouble solving an error that occurs when sending an email through excel. At the moment it is set so that when a drop down list is titled \"Open\" in column \"N\" it send an email to a specific person who's email address appears in column \"M\" (I select the name for emailing in \"J\" and it creates the address in \"M\"). I think the problem could be that it checks every row that I have \"Open\" in \"N\" and so when there is no email address it throws up the \"Run-time error '13': Type Mismatch.\" I currently have the following code:</p>\n\n<p>In Sheet 1 (Issue Sheet):</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"N3\")) Is Nothing Then\nSelect Case Range(\"N3\")\n    Case \"Open\": Macro1\nEnd Select\nEnd If\nEnd Sub\n</code></pre>\n\n<p>and my Module being:</p>\n\n<pre><code>Option Explicit\n</code></pre>\n\n<p>Sub Macro1()\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim cell As Range</p>\n\n<pre><code>Application.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nOn Error GoTo cleanup\nFor Each cell In Columns(\"M\").Cells\n    If cell.Value Like \"?*@xyz.com\" And _\n       LCase(Cells(cell.Row, 14).Value) = \"open\" Then\n\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n        With OutMail\n            .To = cell.Value\n            .Subject = \"Open Issue\"\n            .Body = \"Dear \" &amp; Cells(cell.Row, \"J\").Value _\n                    &amp; vbNewLine &amp; _\n                    \"Issue raised: \" &amp; Cells(cell.Row, \"C\").Value _\n                    &amp; vbNewLine &amp; _\n                    \"Regards\"\n            'You can add files also like this\n            '.Attachments.Add (\"C:\\test.txt\")\n            .Display  'Or use Display\n        End With\n        On Error GoTo 0\n        Set OutMail = Nothing\n    End If\nNext cell\n\ncleanup:\nSet OutApp = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Essentially what I want it to do is be able to send an email only to the address, in the row that the \"Open\" drop down is selected from i.e \"Open\" chosen in column \"N\" and then will send email only to the address in \"M\" of that row.  I need this to be expandable too so I can go down several rows and only send email from that one.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1446657118, "post_id": 33526446, "comment_id": 54837171, "body": "Do you need the Explorer view to open, or would a listing of the files in that directory suffice?"}, {"owner": {"reputation": 1, "user_id": 5525526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f042e69da9ec8614698d441a568f3e?s=128&d=identicon&r=PG&f=1", "display_name": "jcmckeon", "link": "https://stackoverflow.com/users/5525526/jcmckeon"}, "reply_to_user": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1446751021, "post_id": 33526446, "comment_id": 54885299, "body": "Listing of the files may be okay. Thanks for answering"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5525526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f042e69da9ec8614698d441a568f3e?s=128&d=identicon&r=PG&f=1", "display_name": "jcmckeon", "link": "https://stackoverflow.com/users/5525526/jcmckeon"}, "edited": false, "score": 0, "creation_date": 1449073763, "post_id": 33528571, "comment_id": 55850400, "body": "Hi neuralgroove, can you provide an excel file with this code - I&#39;m not sure how to implement. thank you"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "reply_to_user": {"reputation": 1, "user_id": 5525526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f042e69da9ec8614698d441a568f3e?s=128&d=identicon&r=PG&f=1", "display_name": "jcmckeon", "link": "https://stackoverflow.com/users/5525526/jcmckeon"}, "edited": false, "score": 0, "creation_date": 1449078136, "post_id": 33528571, "comment_id": 55853413, "body": "What seems to be the problem? This code will do what you were asking for, but it needs to be adjusted to your sheet (the one from your picture, the cell references need to be changed for your situation..in my example its looking in <code>cells(1,1)</code> for the company name, but in your sheet it might be <code>cells(1,4)</code>. After that you need a sheet named &quot;Results&quot; for the output"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "reply_to_user": {"reputation": 1, "user_id": 5525526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f042e69da9ec8614698d441a568f3e?s=128&d=identicon&r=PG&f=1", "display_name": "jcmckeon", "link": "https://stackoverflow.com/users/5525526/jcmckeon"}, "edited": false, "score": 0, "creation_date": 1449078415, "post_id": 33528571, "comment_id": 55853575, "body": "Basically mine is set up to look for the Company in Column A and the Part Number in Column B, in the first row. If you want it to work on multiple rows, then the row number will need to be supplied to the sub"}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": false, "score": 0, "last_activity_date": 1446659059, "creation_date": 1446659059, "answer_id": 33528571, "question_id": 33526446, "link": "https://stackoverflow.com/questions/33526446/excel-2013-open-network-location-from-data-in-2-different-cells/33528571#33528571", "title": "Excel 2013 - open network location from data in 2 different cells", "body": "<p>This doesn't open up explorer, but gives you a list of clickable links of the matching directories that you can follow to that folder</p>\n\n<pre><code>'this assumes there is a sheet named \"Results\" with a header in row 1\n'output is a list of links on the results page matching that part\nSub GetFileList()\nConst BaseFilePath As String = \"C:\\Test\\\" '\"\\ds2\\data\\customer\\customer docs\\\"\nSheets(\"Results\").Rows(\"2:100000\").Clear\nFilePath = BaseFilePath &amp; Sheets(\"Search\").Cells(1, 1) &amp; \"\\\" 'cells(1,1) has the company, adjust as necessary\nFileSearch = \"*\" &amp; Sheets(\"Search\").Cells(1, 2) &amp; \"*\" 'cells(1,2) has the part, adjust as necessary\nr = 2\nfolderresult = Dir(FilePath &amp; FileSearch, vbDirectory)\nWhile folderresult &lt;&gt; \"\"\n    Sheets(\"Results\").Cells(r, 1) = FilePath &amp; folderresult\n    Sheets(\"Results\").Hyperlinks.Add Anchor:=Sheets(\"Results\").Cells(r, 1), Address:= _\n        FilePath &amp; folderresult, TextToDisplay:=FilePath &amp; folderresult\n    folderresult = Dir$\n    r = r + 1\nWend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5525526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f042e69da9ec8614698d441a568f3e?s=128&d=identicon&r=PG&f=1", "display_name": "jcmckeon", "link": "https://stackoverflow.com/users/5525526/jcmckeon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1446659059, "creation_date": 1446652958, "last_edit_date": 1531164843, "question_id": 33526446, "link": "https://stackoverflow.com/questions/33526446/excel-2013-open-network-location-from-data-in-2-different-cells", "title": "Excel 2013 - open network location from data in 2 different cells", "body": "<p>I want to use the combined data from 2 cells and then search for that particular folder on my network.</p>\n\n<p>The structure is as follows:</p>\n\n<ul>\n<li>column B: <strong>company name</strong></li>\n<li>column C: <strong>part number</strong></li>\n</ul>\n\n<p>The combined path would be something like:</p>\n\n<pre><code>\\\\ds2\\data\\customer\\customer docs\\${COMPANY_NAME}\\${PART_NUMBER}\n</code></pre>\n\n<p>The expected result is a Windows Explorer view with all the folders with that part number.</p>\n\n<p>See the <a href=\"http://i.stack.imgur.com/N4vTT.gif\" rel=\"nofollow\"><code>following image</code></a> for an example.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1446652794, "post_id": 33526199, "comment_id": 54834014, "body": "By avoiding merged cells at all cost."}, {"owner": {"reputation": 5856, "user_id": 1616488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aCLot.jpg?s=128&g=1", "display_name": "Wakan Tanka", "link": "https://stackoverflow.com/users/1616488/wakan-tanka"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1446653573, "post_id": 33526199, "comment_id": 54834562, "body": "@ExcelHero and is there a way how to check if row contains merged cells? If yes I could skip them and in destination worksheet print notification message instead of given row."}, {"owner": {"reputation": 649, "user_id": 4271859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300a758b7adcf9faa29b5b4beffc9528?s=128&d=identicon&r=PG&f=1", "display_name": "Yaegz", "link": "https://stackoverflow.com/users/4271859/yaegz"}, "edited": false, "score": 0, "creation_date": 1446653706, "post_id": 33526199, "comment_id": 54834654, "body": "I will second Excel Hero&#39;s comment. However, since that may not be a solution, you might be able to use an On Error statement that goes and manually unmerges all cells regardless if they are merged or not, and then attempts to copy and paste again after the cells are unmerged.  This is a kind of ugly but that&#39;s why merged cells are a nightmare."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1446654031, "post_id": 33526199, "comment_id": 54834892, "body": "You can check a row for merged cells by using the following (checking row 12 in this example):   <code>MsgBox IsNull(Rows(12).MergeCells)</code>"}, {"owner": {"reputation": 5856, "user_id": 1616488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aCLot.jpg?s=128&g=1", "display_name": "Wakan Tanka", "link": "https://stackoverflow.com/users/1616488/wakan-tanka"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1446654260, "post_id": 33526199, "comment_id": 54835061, "body": "@ExcelHero Thank you for that. One question that comes to my mind is: what happens if the cells are merged vertically? For example A12 with A11 ?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1446654368, "post_id": 33526199, "comment_id": 54835142, "body": "You run the test for each row you are interested in. In your example, both row 11 and row 12&#39;s text would return True."}], "owner": {"reputation": 5856, "user_id": 1616488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aCLot.jpg?s=128&g=1", "display_name": "Wakan Tanka", "link": "https://stackoverflow.com/users/1616488/wakan-tanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446653398, "creation_date": 1446652348, "last_edit_date": 1446653398, "question_id": 33526199, "link": "https://stackoverflow.com/questions/33526199/copying-row-including-formatting-gives-this-operation-requires-the-merged-cell", "title": "Copying row including formatting gives: &quot;This operation requires the merged cells to be identically sized&quot;", "body": "<p>I'm using following subroutine to copy row including formatting from one worksheet to another:</p>\n\n<pre><code>Sub CpRowToSheetInclFormatting(rowNumber, srcWSheetName, dstWSheetName)\n  '* SELECT SRC\n  Worksheets(srcWSheetName).Activate\n  Worksheets(srcWSheetName).Rows(rowNumber).Select\n\n  '* COPY\n  Selection.Copy\n\n  '* SELECT DST\n  Worksheets(dstWSheetName).Activate\n  Worksheets(dstWSheetName).Rows(rowNumber).Select\n\n  ' PASTE\n  Selection.PasteSpecial Paste:=xlPasteFormats\n  Selection.PasteSpecial Paste:=xlPasteValues\nEnd Sub\n</code></pre>\n\n<p>This is working except one scenario (one that I've experienced maybe there are others). If there are merged cells in source worksheet then I get:  </p>\n\n<blockquote>\n  <p>This operation requires the merged cells to be identically sized</p>\n</blockquote>\n\n<p>How can I copy row from source to destination worksheet including formatting and ensure that merged cells will be merged also in destination worksheet?</p>\n\n<p>Bonus question: Can those be combined into one command?:</p>\n\n<pre><code>Selection.PasteSpecial Paste:=xlPasteFormats\nSelection.PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1446652471, "post_id": 33526190, "comment_id": 54833783, "body": "don&#39;t you want to look at worksheet to worksheet rather than workbook to worksheet?  Seems you have a bit of a typo:wk.Range(&quot;B3&quot;).Value = ws.Range(i, &quot;A&quot;).Value  should be ws.Range(&quot;B3&quot;).Value = ws.Range(i, &quot;A&quot;).Value"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1446652586, "post_id": 33526190, "comment_id": 54833864, "body": "you can also avoid the loop by concatenating your usernames and passwords together in column C of your Users worksheet and using the match function..."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1446653030, "post_id": 33526190, "comment_id": 54834185, "body": "souldn&#39;t <code>ws.Range(i, &quot;A&quot;).Value</code> be <code>ws.Range(&quot;A&quot; &amp; i).Value</code> or <code>ws.Cells(i, 1).Value</code>"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1446653243, "post_id": 33526190, "comment_id": 54834342, "body": "also... having a network where ppl need to log in, you can get the username from the network (in this case, they do not need to input a password)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446665348, "post_id": 33526190, "comment_id": 54842262, "body": "Have you tried <code>application.username</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "is_accepted": false, "score": 0, "last_activity_date": 1446671618, "last_edit_date": 1446671618, "creation_date": 1446671275, "answer_id": 33532035, "question_id": 33526190, "link": "https://stackoverflow.com/questions/33526190/log-in-multiple-users/33532035#33532035", "title": "Log in multiple users", "body": "<p>I cant comment yet (less than 50 rep), so I'll put this in an answer, but I'd like to address a commenter above:</p>\n\n<p>sous2817 - both wk and ws are dimensioned as worksheets, so the comparison is correct.</p>\n\n<p>Now to the Answer:</p>\n\n<p>As Dirk states, the <em>workbook</em>.Range() function takes two arguments, but they should both be cell addresses in string format, and if both are supplied, the range returned will include all cells between them. You have:</p>\n\n<pre><code>ws.Range(i, \"A\").Value\n</code></pre>\n\n<p>which is telling excel to get cell i and cell \"A\" and get all cells in a square between them. This won't work because there is no such cell as \"A\" (and you would refer to column <em>A</em> as \"A:A\"), and the variable <em>i</em> will evaluate to a number (again there is no such address as 1,2,3, etc, only \"1:1\" etc)</p>\n\n<p>What you need to change this to is, as Dirk says:</p>\n\n<pre><code>ws.Range(\"A\" &amp; i).value\n</code></pre>\n\n<p>The ampersand (&amp;) acts as a concatenator, and will create a string for each iteration of the loop, evaluating into A1, A2, A3 etc.</p>\n\n<p>You will need to do the same for the Range function that references column B as well.</p>\n\n<p>Having said all that, a better solution would the answer eluded to by sous2817 in their second comment in that you could do this:</p>\n\n<pre><code>Dim userCell as Range\nSet userCell = ws.Range(\"Users\").Resize(,1).Find(wk.Range(\"B3\").Value)\nIf userCell is nothing then\n    'Username is invalid code goes here\nElseif wk.Range(\"B4\").Value = userCell.offset(,1).value then\n    'Password is valid\nElse\n    'Password is invalid\nEnd If\n</code></pre>\n\n<p>As findwindow stated, you can expand upon this by first checking if the username supplied matches Application.UserName to see if it is the current windows user.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 49, "user_id": 4954235, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10152936698147963/picture?type=large", "display_name": "Lauren Neely", "link": "https://stackoverflow.com/users/4954235/lauren-neely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446671618, "creation_date": 1446652315, "last_edit_date": 1446653195, "question_id": 33526190, "link": "https://stackoverflow.com/questions/33526190/log-in-multiple-users", "title": "Log in multiple users", "body": "<p>I'm trying to create a log in with multiple users. I have a welcome sheet with cells specifically for the username and password and a sheet with the username and password combinations.</p>\n\n<p>I'm getting an error at <code>If wk.Range(\"B3\").Value = ws.Range(i, \"A\").Value Then</code>\nit says \"object defined\" error.</p>\n\n<p>I thought it made sense to just try to check if the string in the cell matched a username/password in the users sheet through a loop. \nI'm not sure if I'm going about it right. And then depending on if you log in as an operator or another user it affects which sheets you see.</p>\n\n<pre><code>Public CurrentUser As String, CurrentRole As String, LoginUserName As String, LoginPassword As String\nPublic LoginStatus As Boolean\n\nSub Login()\n'Worksheets(\"Users\").Activate\nDim numberOfUsers, i As Integer\nDim ws, wk As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Users\")\nSet wk = ThisWorkbook.Worksheets(\"Welcome\")\n\nnumberOfUsers = ws.Range(\"Users\").Rows.Count\nLoginStatus = False\n\n\nFor i = 1 To numberOfUsers\nIf wk.Range(\"B3\").Value = ws.Range(i, \"A\").Value Then\n  If wk.Range(\"B4\").Value = ws.Range(i, \"B\").Value Then\n  CurrentUser = wk.Range(\"B3\").Value\n  LoginStatus = True\n  Else\n  LoginStatus = False\n  MsgBox (\"Wrong Login Data\")\n  End If\nElse\nLoginStatus = False\nMsgBox (\"Wrong Login Data\")\nNext i`\n\nSelect Case CurrentUser\n    Case \"Operator\"\n    Worksheets(\"Received_Calls\").Visible = True\n    Worksheets(\"Welcome\").Visible = False\n    Worksheets(\"Users\").Visible = False\n    Worksheets(\"Reported_actions\").Visible = False\n    Worksheets(\"Parameters\").Visible = False\n    Worksheets(\"Distances\").Visible = False\n    Worksheets(\"NewCalls\").Visible = False\n    Worksheets(\"NewActions\").Visible = False\nCase Else\n     Worksheets(\"Received_Calls\").Visible = False\n     Worksheets(\"Welcome\").Visible = False\n     Worksheets(\"Users\").Visible = False\n     Worksheets(\"Reported_actions\").Visible = True\n     Worksheets(\"Parameters\").Visible = False\n     Worksheets(\"Distances\").Visible = False\n     Worksheets(\"NewCalls\").Visible = False\n     Worksheets(\"NewActions\").Visible = False\n'need to filter\nEnd Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 2076, "user_id": 2860193, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0793dc8385ef6af35cebe31c1ecc10ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathismyfriend", "link": "https://stackoverflow.com/users/2860193/deathismyfriend"}, "edited": false, "score": 1, "creation_date": 1446651948, "post_id": 33525790, "comment_id": 54833400, "body": "Have you tried anything ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446654190, "post_id": 33525790, "comment_id": 54835011, "body": "Here is how I would do it: 1)sort data on column C. 2) iterate through column C.3) on each new value in column I would redim preserve a single dimension array adding one new space 4) put the value of C and a &quot;|&quot; then for each column A that has the same column C I would add column A and &quot;|&quot; so it was &quot;100-Base|Alpha|Charly&quot;. 5) iterate through the array after filling splitting on the &quot;|&quot; putting the values in the order desired."}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1446653944, "last_edit_date": 1446653944, "creation_date": 1446652866, "answer_id": 33526411, "question_id": 33525790, "link": "https://stackoverflow.com/questions/33525790/i-think-i-need-an-array-but-i-dont-know-how-to-build-this/33526411#33526411", "title": "I think I need an array, but I don&#39;t know how to build this", "body": "<p>this should solve your issue with just an Excel formula. If you want a vba solution, that is of course possible too.</p>\n\n<p>In your new sheet, in column A Setup it like:</p>\n\n<p>Column A</p>\n\n<pre><code>1\n1\n2\n2\n3\n3\n</code></pre>\n\n<p>You can get this format by entering the following in Cell A3 and pull it down as far as you need (set Cell A1, A2 with a value of 1).</p>\n\n<p><code>=A1+1</code></p>\n\n<p>In Column B you are going to enter an Indirect Formula. In cell B1, put this:</p>\n\n<p><code>=INDIRECT(\"Sheet1!A\"&amp;A1)</code></p>\n\n<p>In Cell B2, put this:</p>\n\n<p><code>=INDIRECT(\"Sheet1!C\"&amp;A2)</code></p>\n\n<p>Column A will keep track of which row to pull from, then the indirect formula will dynamically build the formula to get the value. Hope it helps!</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1446656684, "creation_date": 1446656684, "answer_id": 33527779, "question_id": 33525790, "link": "https://stackoverflow.com/questions/33525790/i-think-i-need-an-array-but-i-dont-know-how-to-build-this/33527779#33527779", "title": "I think I need an array, but I don&#39;t know how to build this", "body": "<p>Here is one without arrays,</p>\n\n<pre><code>Sub unique4()\n\nDim i As Long\nDim lastrow As Long\nDim j As Long\nDim tws As Worksheet\n\nSet tws = Sheets(\"Sheet2\")'Change to desired sheet output name.\nj = 1\nWith Sheets(\"GetData\")\n    lastrow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n    For i = 1 To lastrow\n        If i &lt;&gt; 1 Then\n            If .Cells(i, 3) &lt;&gt; .Cells(i - 1, 3) Then\n                tws.Cells(j, 1) = .Cells(i, 3)\n                j = j + 1\n                tws.Cells(j, 1) = .Cells(i, 1)\n                j = j + 1\n            Else\n                tws.Cells(j, 1) = .Cells(i, 1)\n                j = j + 1\n            End If\n        Else\n            tws.Cells(j, 1) = .Cells(i, 3)\n            j = j + 1\n            tws.Cells(j, 1) = .Cells(i, 1)\n            j = j + 1\n        End If\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>One Caveat, you will need to sort the data on column C to make work.</p>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1446670490, "creation_date": 1446670490, "answer_id": 33531816, "question_id": 33525790, "link": "https://stackoverflow.com/questions/33525790/i-think-i-need-an-array-but-i-dont-know-how-to-build-this/33531816#33531816", "title": "I think I need an array, but I don&#39;t know how to build this", "body": "<p>Without sorting any data or something like that:</p>\n\n<pre><code>Sub test()\nDim LastRow As Long, i As Long, j As Long, k As Long, chkB As Boolean\nDim wsGet As Worksheet, wsPut As Worksheet\nSet wsGet = ThisWorkbook.Worksheets(1)\nSet wsPut = ThisWorkbook.Worksheets(2)\nConst FirstRow As Long = 3\nLastRow = wsGet.Range(\"C\" &amp; wsGet.Rows.Count).End(xlUp).Row\nFor i = FirstRow To LastRow\n  chkB = True\n  For j = FirstRow To i - 1\n    If wsGet.Cells(i, 3) = wsGet.Cells(j, 3) Then chkB = False: Exit For\n  Next\n  If chkB Then\n    k = k + 1\n    wsPut.Cells(k, 1) = wsGet.Cells(i, 3)\n    For j = i To LastRow\n      If wsGet.Cells(j, 3) = wsGet.Cells(i, 3) Then\n        k = k + 1\n        wsPut.Cells(k, 1) = wsGet.Cells(j, 1)\n      End If\n    Next\n  End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5525359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/542d1054a4970ac8755ff828cc6d9f33?s=128&d=identicon&r=PG&f=1", "display_name": "saint0r", "link": "https://stackoverflow.com/users/5525359/saint0r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 33527779, "answer_count": 3, "score": -2, "last_activity_date": 1446670490, "creation_date": 1446651234, "last_edit_date": 1446656043, "question_id": 33525790, "link": "https://stackoverflow.com/questions/33525790/i-think-i-need-an-array-but-i-dont-know-how-to-build-this", "title": "I think I need an array, but I don&#39;t know how to build this", "body": "<p>I've a worksheet named \"GetData\". In this worksheet are more columns.</p>\n\n<pre><code>A(Names)|B...   |C(Center)\n++++++++|+++++++|+++++++++\nAlpha   |       |100-Base\nBeta    |       |110-2nd\nCharly  |       |100-Base\n</code></pre>\n\n<p>Now I want sort them into another worksheet named \"Overview\" like this:</p>\n\n<pre><code>A(Grouped)\n++++++++++\n100-Base\nAlpha\nCharly\n110-2nd\nBeta\n</code></pre>\n\n<p>I think I need an array, but I don't know how to build this. I tried this for beginning:</p>\n\n<pre><code>     Sub unique4()\n        Dim arr As New Collection, a\n        Dim aFirstArray() As Variant\n        Dim i As Long\n\n        Dim LastRow As Long\n        LastRow = Worksheets(\"GetData\").Cells(Worksheets(\"GetData\").Rows.Count, \"C\").End(xlUp).Row\n\n        aFirstArray() = Worksheets(\"GetData\").Range(\"C2:C\" &amp; LastRow).Value\n\n\n        On Error Resume Next\n        For Each a In aFirstArray\n           arr.Add a, a\n        Next\n\n        For i = 1 To arr.Count\n           Cells(i, 1) = arr(i)\n        Next\n     End Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 41522, "user_id": 1359668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xtsl4.jpg?s=128&g=1", "display_name": "Steven Doggart", "link": "https://stackoverflow.com/users/1359668/steven-doggart"}, "edited": false, "score": 0, "creation_date": 1446650595, "post_id": 33525520, "comment_id": 54832355, "body": "VBA or VB.NET?  They are not the same thing."}, {"owner": {"reputation": 175, "user_id": 3545370, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1551536573/picture?type=large", "display_name": "user3545370", "link": "https://stackoverflow.com/users/3545370/user3545370"}, "reply_to_user": {"reputation": 41522, "user_id": 1359668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xtsl4.jpg?s=128&g=1", "display_name": "Steven Doggart", "link": "https://stackoverflow.com/users/1359668/steven-doggart"}, "edited": false, "score": 0, "creation_date": 1446650784, "post_id": 33525520, "comment_id": 54832480, "body": "noted, sorry for the mistake"}], "owner": {"reputation": 175, "user_id": 3545370, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1551536573/picture?type=large", "display_name": "user3545370", "link": "https://stackoverflow.com/users/3545370/user3545370"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "closed_date": 1446650926, "answer_count": 0, "score": 0, "last_activity_date": 1446650750, "creation_date": 1446650474, "last_edit_date": 1446650750, "question_id": 33525520, "link": "https://stackoverflow.com/questions/33525520/string-search-regular-expressions-vb", "closed_reason": "Duplicate", "title": "String search Regular expressions VB?", "body": "<p>In Excel VB I'm trying to search a string for a 4 digit number denoting a year, ie. <strong><em>\"The man was born in the year 1986, it was a sunny day\"</em></strong>, I am trying to extract the <strong><em>\"1986\"</em></strong> from this string. It seems like using regular expressions would be my best option however I'm unfamiliar with them, is the regular expression for a 4 digit number something like <strong><em>\"\\d{4}\"</em></strong> ?, </p>\n\n<p>if I find that my string contains such a number is there an efficient way for getting the start and end point of the string for extraction? I have ideas on how to do it but they seem very inefficient, is there a fast way to find and extract this data?</p>\n\n<p>pseudocode:</p>\n\n<pre><code>dim bool As boolean\nbool = cells(d, 1).Value.contains(\\d{4})\n\nif bool then\n   'extract string\nend if\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf", "adobe"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446650745, "post_id": 33525366, "comment_id": 54832459, "body": "just to confirm, Excel crashes on this line: <code>Set objAcroApp = CreateObject(&quot;AcroExch.App&quot;)</code>"}, {"owner": {"reputation": 187, "user_id": 5508651, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/354d90156f30bc03cbafd310c0c79363?s=128&d=identicon&r=PG&f=1", "display_name": "Farellia", "link": "https://stackoverflow.com/users/5508651/farellia"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446650806, "post_id": 33525366, "comment_id": 54832491, "body": "Yes, that&#39;s correct."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446650865, "post_id": 33525366, "comment_id": 54832536, "body": "I am curious what other references you have set in the VBE? I have code very similar to this with XL2010 and it works perfectly."}, {"owner": {"reputation": 187, "user_id": 5508651, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/354d90156f30bc03cbafd310c0c79363?s=128&d=identicon&r=PG&f=1", "display_name": "Farellia", "link": "https://stackoverflow.com/users/5508651/farellia"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446650995, "post_id": 33525366, "comment_id": 54832639, "body": "I have Visual Basic for Applications, Microsoft Excel 14.0 Object Library, OLE Automation, Microsoft Office 14.0 Object Library, and Adobe Acrobat 10.0 Type Library.  At one point, I selected all the options with the word &quot;Adobe&quot; in there and tried running the code, and it still crashed..."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446651122, "post_id": 33525366, "comment_id": 54832743, "body": "I think the issue may be with Excel, rather than your code."}, {"owner": {"reputation": 187, "user_id": 5508651, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/354d90156f30bc03cbafd310c0c79363?s=128&d=identicon&r=PG&f=1", "display_name": "Farellia", "link": "https://stackoverflow.com/users/5508651/farellia"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446651851, "post_id": 33525366, "comment_id": 54833319, "body": "Thanks. I asked to try this code on my coworker&#39;s computer, and it worked. Do you have any idea what may be causing this on my Excel?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5635978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5de1830300a5b23f05d31975107519?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Anderson", "link": "https://stackoverflow.com/users/5635978/jay-anderson"}, "is_accepted": false, "score": 0, "last_activity_date": 1449161770, "creation_date": 1449161770, "answer_id": 34071807, "question_id": 33525366, "link": "https://stackoverflow.com/questions/33525366/convert-multiple-pdf-to-excel-unable-to-initiate-app/34071807#34071807", "title": "Convert multiple PDF to Excel - unable to initiate APP?", "body": "<p>I had a similar issue and after researching found a suggestion to do an installation repair on the Adobe.  After that my code worked fine.  Don't know why!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5636533, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/ed978219c029eb5269317cc16a676e1a?s=128&d=identicon&r=PG", "display_name": "Kaleem Haider", "link": "https://stackoverflow.com/users/5636533/kaleem-haider"}, "is_accepted": false, "score": 0, "last_activity_date": 1449169726, "creation_date": 1449169726, "answer_id": 34074187, "question_id": 33525366, "link": "https://stackoverflow.com/questions/33525366/convert-multiple-pdf-to-excel-unable-to-initiate-app/34074187#34074187", "title": "Convert multiple PDF to Excel - unable to initiate APP?", "body": "<p>try deleting the following codes, I had similar problem and I let MS Excel decide the Dim.</p>\n\n<pre><code>Dim objAcroApp      As Acrobat.AcroApp\nDim objAcroAVDoc    As Acrobat.AcroAVDoc\nDim objAcroPDDoc    As Acrobat.AcroPDDoc\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 12623802, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCMPuGJY_OG5UuvqOLGM14cOK9dBNu_CiU1kPWz=k-s128", "display_name": "zzzcolin", "link": "https://stackoverflow.com/users/12623802/zzzcolin"}, "is_accepted": false, "score": 1, "last_activity_date": 1618559586, "creation_date": 1618559586, "answer_id": 67121219, "question_id": 33525366, "link": "https://stackoverflow.com/questions/33525366/convert-multiple-pdf-to-excel-unable-to-initiate-app/67121219#67121219", "title": "Convert multiple PDF to Excel - unable to initiate APP?", "body": "<p>The reason why error was thrown at Set objAcroApp = CreateObject(&quot;AcroExch.App&quot;) may be:</p>\n<p>You can only create Adobe App once in your whole script, which means you can't use this Sub SavePDFAs() in a loop because in which App will be created at every iteration.</p>\n<p>Try pass an array contains all PDF paths (which you want to convert) into this Sub, and:</p>\n<ol>\n<li>Only Set objAcroApp = CreateObject(&quot;AcroExch.App&quot;) once;</li>\n<li>Loop boResult = objJSO.SaveAs(NewFilePath, ExportFormat) to convert all PDFs.</li>\n</ol>\n"}], "owner": {"reputation": 187, "user_id": 5508651, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/354d90156f30bc03cbafd310c0c79363?s=128&d=identicon&r=PG&f=1", "display_name": "Farellia", "link": "https://stackoverflow.com/users/5508651/farellia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1422, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1618559586, "creation_date": 1446650113, "last_edit_date": 1447358736, "question_id": 33525366, "link": "https://stackoverflow.com/questions/33525366/convert-multiple-pdf-to-excel-unable-to-initiate-app", "title": "Convert multiple PDF to Excel - unable to initiate APP?", "body": "<p>I have a few thousand similar PDF files that I would like to convert to Excel workbooks.</p>\n\n<p>I'm not super familiar with VBA and even less with Adobe API, but I got this code from this <a href=\"http://www.myengineeringworld.net/2013/03/vba-macro-to-convert-pdf-files-into.html\" rel=\"nofollow\">website</a> which seems to be exactly what I need.</p>\n\n<p>However, every time I try to run the code (I downloaded the 2nd version btw where it's a zip folder) by clicking Convert Files, my Excel crashes instantly with the pop-up box of \"Microsoft Excel has stopped working...\"</p>\n\n<p>So I decided to look into the code to check where exactly it's hiccuping. </p>\n\n<ol>\n<li><p>First of all, I've followed the directions, went into tools -> references and checked Adobe Acrobat 10.0 Type Library. I have Adobe Acrobat Pro DC installed, and all previous version of Adobe Reader uninstalled. I'm using Excel 2010, so I don't necessarily think there are any compatibility issues...</p></li>\n<li><p>The code is in two pieces. The outer piece is completely fine - it checks whether you have the file path in there and whether everything is in the correct format, and then it calls the sub \"SavePDFAs\". By adding in random MsgBox \"tests\", I can tell that the code passes through this part perfectly fine.</p></li>\n<li><p>The error occurs in the Sub SavePDFAs where the code initializes Acrobat by creating the APP Object. It seems like Excel is unable to create an APP Object... Can somebody help me debug this? At this point, I'm not even sure where to start to look for a solution since Excel just crashes... </p></li>\n</ol>\n\n<p>I've attached the code below.</p>\n\n<blockquote>\n<pre><code>   Private Sub SavePDFAs(PDFPath As String, FileExtension As String)\n    'Saves a PDF file as other format using Adobe Professional.\n\n    'In order to use the macro you must enable the Acrobat library from VBA editor:\n    'Go to Tools -&gt; References -&gt; Adobe Acrobat xx.0 Type Library, where xx depends\n    'on your Acrobat Professional version (i.e. 9.0 or 10.0) you have installed to your PC.\n\n    'Alternatively you can find it Tools -&gt; References -&gt; Browse and check for the path\n    'C:\\Program Files\\Adobe\\Acrobat xx.0\\Acrobat\\acrobat.tlb\n    'where xx is your Acrobat version (i.e. 9.0 or 10.0 etc.).\n\n    'By Christos Samaras\n    'Date: 30/03/2013\n    'http://www.myengineeringworld.net\n    '---------------------------------------------------------------------------------------\n\n    Dim objAcroApp      As Acrobat.AcroApp\n    Dim objAcroAVDoc    As Acrobat.AcroAVDoc\n    Dim objAcroPDDoc    As Acrobat.AcroPDDoc\n    Dim objJSO          As Object\n    Dim boResult        As Boolean\n    Dim ExportFormat    As String\n    Dim NewFilePath     As String\n\n    'Initialize Acrobat by creating App object.\n    Set objAcroApp = CreateObject(\"AcroExch.App\")\n\n\n    'Set AVDoc object.\n    Set objAcroAVDoc = CreateObject(\"AcroExch.AVDoc\")\n\n    'Open the PDF file.\n    boResult = objAcroAVDoc.Open(PDFPath, \"\")\n\n    'Set the PDDoc object.\n    Set objAcroPDDoc = objAcroAVDoc.GetPDDoc\n\n    'Set the JS Object - Java Script Object.\n    Set objJSO = objAcroPDDoc.GetJSObject\n\n    'Check the type of conversion.\n    Select Case LCase(FileExtension)\n        Case \"eps\": ExportFormat = \"com.adobe.acrobat.eps\"\n        Case \"html\", \"htm\": ExportFormat = \"com.adobe.acrobat.html\"\n        Case \"jpeg\", \"jpg\", \"jpe\": ExportFormat = \"com.adobe.acrobat.jpeg\"\n        Case \"jpf\", \"jpx\", \"jp2\", \"j2k\", \"j2c\", \"jpc\": ExportFormat = \"com.adobe.acrobat.jp2k\"\n        Case \"docx\": ExportFormat = \"com.adobe.acrobat.docx\"\n        Case \"doc\": ExportFormat = \"com.adobe.acrobat.doc\"\n        Case \"png\": ExportFormat = \"com.adobe.acrobat.png\"\n        Case \"ps\": ExportFormat = \"com.adobe.acrobat.ps\"\n        Case \"rft\": ExportFormat = \"com.adobe.acrobat.rft\"\n        Case \"xlsx\": ExportFormat = \"com.adobe.acrobat.xlsx\"\n        Case \"xls\": ExportFormat = \"com.adobe.acrobat.spreadsheet\"\n        Case \"txt\": ExportFormat = \"com.adobe.acrobat.accesstext\"\n        Case \"tiff\", \"tif\": ExportFormat = \"com.adobe.acrobat.tiff\"\n        Case \"xml\": ExportFormat = \"com.adobe.acrobat.xml-1-00\"\n        Case Else: ExportFormat = \"Wrong Input\"\n    End Select\n\n    'Check if the format is correct and there are no errors.\n    If ExportFormat &lt;&gt; \"Wrong Input\" And Err.Number = 0 Then\n\n        'Format is correct and no errors.\n\n        'Set the path of the new file. Note that Adobe instead of xls uses xml files.\n        'That's why here the xls extension changes to xml.\n        If LCase(FileExtension) &lt;&gt; \"xls\" Then\n            NewFilePath = WorksheetFunction.Substitute(PDFPath, \".pdf\", \".\" &amp; LCase(FileExtension))\n        Else\n            NewFilePath = WorksheetFunction.Substitute(PDFPath, \".pdf\", \".xml\")\n        End If\n\n        'Save PDF file to the new format.\n        boResult = objJSO.SaveAs(NewFilePath, ExportFormat)\n\n        'Close the PDF file without saving the changes.\n        boResult = objAcroAVDoc.Close(True)\n\n        'Close the Acrobat application.\n        boResult = objAcroApp.Exit\n\n    Else\n\n        'Something went wrong, so close the PDF file and the application.\n\n        'Close the PDF file without saving the changes.\n        boResult = objAcroAVDoc.Close(True)\n\n        'Close the Acrobat application.\n        boResult = objAcroApp.Exit\n\n    End If\n\n    'Release the objects.\n    Set objAcroPDDoc = Nothing\n    Set objAcroAVDoc = Nothing\n    Set objAcroApp = Nothing\n\nEnd Sub\n</code></pre>\n</blockquote>\n\n<p>----EDIT-----\nIt's been pointed out that the code actually works, and it's just my Excel that's malfunctioning. Any thoughts on what's wrong with what settings I need to change for my Excel?</p>\n\n<p>---EDIT 2---\nI've called a help desk, and the answer I got is that every Adobe version has some really weird quirks that's not compatible with previous versions. My coworker's Adobe license was 10 while mine is DC, hence it doesn't work on my machine. Not necessarily the answer I wanted to hear... </p>\n"}, {"tags": ["excel", "vba", "performance", "user-defined-functions"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1446650307, "post_id": 33525364, "comment_id": 54832134, "body": "Without benchmarking, not really - but you can follow simple guidelines for improving performance, e.g. use arrays in memory, avoid loops etc. The main question you should always ask is whether VBA is even required. Sometimes using a few helper columns is much faster than a UDF - all comes down to design"}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1446652627, "post_id": 33525364, "comment_id": 54833893, "body": "I like the VBA for view-ability, a lot of my worksheets are viewed by a wide range of people. I used to use a lot of helper columns, but it was cluttered if they weren&#39;t hidden and obfuscated the calculation if they were; for my audience I found that a UDF with a meaningful name helped keep people from getting weeded in the minutia of calculations."}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1446652856, "post_id": 33525364, "comment_id": 54834070, "body": "That said, you&#39;re hinting on a presumption that I&#39;ve made -- when coding it is best to follow best practices, my presumption was that built-ins were designed employing these mechanisms - I&#39;ve recently had cause to challenge that assumption.  What I&#39;m slowly realizing is that Compounded or nested formulas, especially in indexed arrays seem to have more elegant UDF counterparts; but where that line is drawn between BIFs and UDFs is still very murky."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1446653236, "post_id": 33525364, "comment_id": 54834335, "body": "Unfortunately, as there is no way to view the source code for Excel&#39;s worksheet functions then the best we can do without benchmarking is assume, and we all know where that leads..."}], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 693, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551922854, "creation_date": 1446650110, "last_edit_date": 1551922854, "question_id": 33525364, "link": "https://stackoverflow.com/questions/33525364/udfs-vs-built-in-functions-in-excel", "title": "UDFs Vs Built In Functions in Excel", "body": "<p>Is there a way to assess a speed comparison between UDFs, User-Defined-Functions, and Excel's built in functions without benchmark testing? A purely mathematical approach if you will.</p>\n\n<p>For instance, I recently posted the following question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/33521389/unique-count-excel-vba-vs-formulas-faster-approach\">Unique Count (Excel VBA vs Formulas) Faster Approach</a></p>\n\n<p>After writing the UDF it was obvious that it was much faster, but I frankly assumed it wouldn't have been, and am looking for clarity on how I can better align my judgement BEFORE writing vba that proves useless.</p>\n\n<p>I found this:\n<a href=\"https://stackoverflow.com/questions/23263795/speed-vba-vs-excel-formulas\">Speed, VBA VS Excel Formulas</a> , but their question wasn't exactly the same as mine.</p>\n"}, {"tags": ["vb.net", "vba", "ping"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1446650079, "post_id": 33525043, "comment_id": 54831957, "body": "Hey there, check out this post. <a href=\"http://stackoverflow.com/questions/21020077/ping-ip-address-with-vba-code-and-return-results-in-excel\" title=\"ping ip address with vba code and return results in excel\">stackoverflow.com/questions/21020077/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 1886762, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36b95564f5baa8562105da5379494a3b?s=128&d=identicon&r=PG", "display_name": "Sevaara", "link": "https://stackoverflow.com/users/1886762/sevaara"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1446650385, "post_id": 33525043, "comment_id": 54832203, "body": "For an excel spreadsheet sure.  I still have no idea what I&#39;m doing with VBA, how would that translate into a Word macro?  I&#39;m not fussed about error handling, I literally just need to ping and watch the traffic in my VM."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 3, "last_activity_date": 1446650382, "creation_date": 1446650382, "answer_id": 33525481, "question_id": 33525043, "link": "https://stackoverflow.com/questions/33525043/vb-ping-macro-object-required/33525481#33525481", "title": "VB ping macro - object required", "body": "<p><code>My.Computer.Network.Ping()</code> is a VB.Net function and is not available in VBA.</p>\n\n<p>From some time ago I have a function to get the ping time, this should get you going.<br>\nYou probably need only the <code>StatusCode = 0</code> check.</p>\n\n<pre><code>' strAddress = IP or name\nPublic Function PingTime(strAddress) As Long\n\n    Dim objPing As Object, objStatus As Object\n\n    ' Init: Assume error\n    PingTime = -1\n\n    On Error Resume Next\n    Set objPing = GetObject(\"WinMgmts:{impersonationLevel=impersonate}\").ExecQuery _\n                           (\"SELECT * FROM Win32_PingStatus WHERE Address = '\" &amp; strAddress &amp; \"' \")\n    If Err.Number &lt;&gt; 0 Then\n        Exit Function\n    End If\n\n    For Each objStatus In objPing\n        If objStatus.StatusCode = 0 Then\n            PingTime = objStatus.Properties_(\"ResponseTime\").Value\n            Exit For\n        End If\n    Next\n    Set objStatus = Nothing\n    Set objPing = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 1886762, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36b95564f5baa8562105da5379494a3b?s=128&d=identicon&r=PG", "display_name": "Sevaara", "link": "https://stackoverflow.com/users/1886762/sevaara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "accepted_answer_id": 33525481, "answer_count": 1, "score": -1, "last_activity_date": 1447056843, "creation_date": 1446649135, "last_edit_date": 1447056843, "question_id": 33525043, "link": "https://stackoverflow.com/questions/33525043/vb-ping-macro-object-required", "title": "VB ping macro - object required", "body": "<p>I know absolutely nothing about VB but I'm trying to compile a quick ping test macro within a word document to test some malware sandbox software.  However, I keep getting the runtime 424 error.</p>\n\n<p>I've done a bit of research but with 0 knowledge of VB, I've failed to identify a solution.  The code is as follows.</p>\n\n<pre><code>Sub Ping()\n\n' Ping Macro\n\nIf My.Computer.Network.Ping(\"192.168.1.10\") Then\n  MsgBox (\"Server pinged successfully.\")\nElse\n  MsgBox (\"Ping request timed out.\")\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I'm clearly missing something here. I assumed the object would have been the message box but I was wrong.  Anybody know what I'm missing here?</p>\n\n<p>EDIT: Debug shows the first line being the issue.</p>\n\n<pre><code>If My.Computer.Network.Ping(\"192.168.1.10\") Then\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 5405592, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee214acfe35a95faf2dd8fd93c69a66a?s=128&d=identicon&r=PG&f=1", "display_name": "Venetian", "link": "https://stackoverflow.com/users/5405592/venetian"}, "edited": false, "score": 0, "creation_date": 1446650709, "post_id": 33525508, "comment_id": 54832435, "body": "Thank you, this looks like it should work. I saw something similar to this on another answer but did not have comments and therefore did not fully understand what the code was doing. I&#39;ll try this and provide and update shortly. Thank you!"}, {"owner": {"reputation": 233, "user_id": 5405592, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee214acfe35a95faf2dd8fd93c69a66a?s=128&d=identicon&r=PG&f=1", "display_name": "Venetian", "link": "https://stackoverflow.com/users/5405592/venetian"}, "edited": false, "score": 0, "creation_date": 1446650887, "post_id": 33525508, "comment_id": 54832559, "body": "Also, is there any way the If statement can refer to Column B on Sheet1 rather than Column G on Sheet2? In otherwords, something like Sheet1.Range(&quot;A&quot; &amp; i)?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 233, "user_id": 5405592, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee214acfe35a95faf2dd8fd93c69a66a?s=128&d=identicon&r=PG&f=1", "display_name": "Venetian", "link": "https://stackoverflow.com/users/5405592/venetian"}, "edited": false, "score": 0, "creation_date": 1446651228, "post_id": 33525508, "comment_id": 54832832, "body": "Change your reference like this: <code>Range(&quot;Sheet2!G&quot; &amp; i)</code>"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 0, "last_activity_date": 1446650444, "creation_date": 1446650444, "answer_id": 33525508, "question_id": 33524978, "link": "https://stackoverflow.com/questions/33524978/conditionally-clear-contents-of-range-of-cells-in-a-row-based-on-cell-value/33525508#33525508", "title": "Conditionally clear contents of range of cells in a row based on cell value", "body": "<p>Something like this?</p>\n\n<pre><code>For i = 2 To 6 'This is the starting row (2) to the ending row (6)\n    If Range(\"G\" &amp; i) &lt;&gt; \"Open\" Then 'We use i to dynamically build the range as a string\n        Range(\"B\" &amp; i &amp; \":F\" &amp; i).ClearContents\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 5405592, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee214acfe35a95faf2dd8fd93c69a66a?s=128&d=identicon&r=PG&f=1", "display_name": "Venetian", "link": "https://stackoverflow.com/users/5405592/venetian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7341, "favorite_count": 0, "accepted_answer_id": 33525508, "answer_count": 1, "score": 0, "last_activity_date": 1446650444, "creation_date": 1446648976, "last_edit_date": 1446649187, "question_id": 33524978, "link": "https://stackoverflow.com/questions/33524978/conditionally-clear-contents-of-range-of-cells-in-a-row-based-on-cell-value", "title": "Conditionally clear contents of range of cells in a row based on cell value", "body": "<p>I have an excel file with two sheets: Sheet1 and Sheet2. Sheet 1 has store information while Sheet 2 has product quantity by store information</p>\n\n<p>In Sheet 1, Range \"A1:A5\" lists 5 store names, Store A through Store E, while range \"B1:B5\" in Sheet 1 is a drop down box that lets the user choose from the following: \"Open\", \"Closed\", or \"\". </p>\n\n<p>In Sheet 2, there is a table that lists the quantity of products by store. Something like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/H6Azs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H6Azs.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I am looking for a way to clear the contents of range B:F in Sheet2 when the respective store in Sheet1 is not set to \"Open\".</p>\n\n<p>Currently, I am linking the values in Column B from Sheet1 to Column G in Sheet2, and have set the code to the following in Sheet2:</p>\n\n<pre><code>Private Sub Worksheet_Activate() \nIf Range(\"G2\") &lt;&gt; \"Open\" Then\nRange(\"B2:F2\").ClearContents\nEnd If\n</code></pre>\n\n<p>How can I perform this in a loop rather than copying this code five separate times?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 6529, "user_id": 4252320, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh3.googleusercontent.com/-_DAs7Dtci9U/AAAAAAAAAAI/AAAAAAAAIf8/96ZNJAUF2Xk/photo.jpg?sz=128", "display_name": "ergonaut", "link": "https://stackoverflow.com/users/4252320/ergonaut"}, "edited": false, "score": 0, "creation_date": 1446648500, "post_id": 33524713, "comment_id": 54830754, "body": "How big is your keyword list?"}, {"owner": {"reputation": 169, "user_id": 5092236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c9dea858559fb747eafd9f9896cd470?s=128&d=identicon&r=PG&f=1", "display_name": "Poof", "link": "https://stackoverflow.com/users/5092236/poof"}, "edited": false, "score": 0, "creation_date": 1446648796, "post_id": 33524713, "comment_id": 54830978, "body": "If you have uniq list why dont use Find function?"}, {"owner": {"reputation": 1153, "user_id": 912800, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/68a1a5a1ac8932d7a4929b15d9653c67?s=128&d=identicon&r=PG", "display_name": "steve_o", "link": "https://stackoverflow.com/users/912800/steve-o"}, "reply_to_user": {"reputation": 6529, "user_id": 4252320, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh3.googleusercontent.com/-_DAs7Dtci9U/AAAAAAAAAAI/AAAAAAAAIf8/96ZNJAUF2Xk/photo.jpg?sz=128", "display_name": "ergonaut", "link": "https://stackoverflow.com/users/4252320/ergonaut"}, "edited": false, "score": 0, "creation_date": 1446648814, "post_id": 33524713, "comment_id": 54830998, "body": "@ergonaut - the list is several dozen, about 45, and subject to change."}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1446649092, "post_id": 33524713, "comment_id": 54831234, "body": "Put your list in a dictionary, then iterate through the cells and the words in the cells (use SPLIT) and lookup the values in the dictionary. I can see two problems: 1) When there is more than one match in a single string (Cat hates dog) which one will it return 2) only exact matches will be found so it wouldn&#39;t pick up &quot;Hamster&quot; in your list"}, {"owner": {"reputation": 1153, "user_id": 912800, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/68a1a5a1ac8932d7a4929b15d9653c67?s=128&d=identicon&r=PG", "display_name": "steve_o", "link": "https://stackoverflow.com/users/912800/steve-o"}, "reply_to_user": {"reputation": 169, "user_id": 5092236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c9dea858559fb747eafd9f9896cd470?s=128&d=identicon&r=PG&f=1", "display_name": "Poof", "link": "https://stackoverflow.com/users/5092236/poof"}, "edited": false, "score": 0, "creation_date": 1446649121, "post_id": 33524713, "comment_id": 54831265, "body": "@Poof -I&#39;m not sure how you mean.  The keyword list is several dozen (subject to change), and the string list is several hundred.  In column B2, I need to return the Information (Column E) for whichever keyword is found in A2."}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1446649384, "post_id": 33524713, "comment_id": 54831439, "body": "Or go the other way and iterate through your list, finding every instance in the strings list and marking them. That solves problem 2 but not problem 1"}], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 5, "last_activity_date": 1446649377, "creation_date": 1446649377, "answer_id": 33525114, "question_id": 33524713, "link": "https://stackoverflow.com/questions/33524713/finding-string-and-returning-information-from-an-adjacent-cell/33525114#33525114", "title": "Finding string and returning information from an adjacent cell", "body": "<p>No need for VBA. This can be done with a simple formula:</p>\n\n<p>Enter this formula in cell B2:</p>\n\n<pre><code>=LOOKUP(2,1/SEARCH(D$2:D$7,A2),E$2:E$7)\n</code></pre>\n\n<p>Copy downward as far as needed.</p>\n\n<p>Note: adjust the range references to the size of your data.</p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": -2, "last_activity_date": 1446651031, "creation_date": 1446651031, "answer_id": 33525727, "question_id": 33524713, "link": "https://stackoverflow.com/questions/33524713/finding-string-and-returning-information-from-an-adjacent-cell/33525727#33525727", "title": "Finding string and returning information from an adjacent cell", "body": "<p>Not done it all, but this formula</p>\n\n<p>=MAX(IF(ISNUMBER(SEARCH(D1,$A$1:$A$4,1)),ROW($A$1:$A$4),0))</p>\n\n<p>Array Formula</p>\n\n<p>Will give you the row of the A1:a4 where D1 etc, is contained.  Then you can index on that.  However it will only show the max row, so if its in 1 &amp; 2, then it will only show row 2.</p>\n\n<p>Cheers.</p>\n"}], "owner": {"reputation": 1153, "user_id": 912800, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/68a1a5a1ac8932d7a4929b15d9653c67?s=128&d=identicon&r=PG", "display_name": "steve_o", "link": "https://stackoverflow.com/users/912800/steve-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 1, "accepted_answer_id": 33525114, "answer_count": 2, "score": 0, "last_activity_date": 1446651031, "creation_date": 1446648268, "last_edit_date": 1446649824, "question_id": 33524713, "link": "https://stackoverflow.com/questions/33524713/finding-string-and-returning-information-from-an-adjacent-cell", "title": "Finding string and returning information from an adjacent cell", "body": "<p>Using Excel 2010. I need to see if a string in one set of cells exists in another set of cells, and if so, return information from the adjacent cell that matched that string.  I had originally done this with SEARCH, ISNUMBER and nested IF statements, but my source data set has several dozen entries in it, and the strings that must be searched has several hundred entries. The data resembles that in the picture (a simplified example):  </p>\n\n<p><a href=\"https://i.stack.imgur.com/f7nEQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f7nEQ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>For a limited data set, I used nested IF statements, like:</p>\n\n<pre><code>IF(ISNUMBER(SEARCH($D$2,$A2,1)),\"Cat Info\",IF(ISNUMBER(SEARCH($D$3,$A2,1)),\"Dog Info\",IF(ISNUMBER(SEARCH($D$4,$A2,1)),\"Elephant Info\",\"Not Found\")))\n</code></pre>\n\n<p>But now both sets of data are too large to do that on. </p>\n\n<p>What I need to do is to search the strings in column A for the keyword in column D.  If the keyword is found, I need to return the corresponding information from column E.</p>\n\n<p>For example, in column B2, since the word <code>dog</code> is in A2, I would want the contents of E3 (<code>Dog Section</code>) to be displayed in B2.  </p>\n\n<p>My list of keywords are unique (Column D, List) and I know that zero or one keyword will appear in the string in Column A (TheString).  </p>\n\n<p>I think that INDEX &amp; MATCH functions may be part of my solution, but I am unsure how to find which List keyword is in the string and then return the Information column value.</p>\n"}, {"tags": ["vba", "excel", "excel-addins"], "answers": [{"comments": [{"owner": {"reputation": 43748, "user_id": 1967396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qBbwd.png?s=128&g=1", "display_name": "Floris", "link": "https://stackoverflow.com/users/1967396/floris"}, "edited": false, "score": 0, "creation_date": 1446685539, "post_id": 33524733, "comment_id": 54851311, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff822158.aspx\" rel=\"nofollow noreferrer\">Useful reference</a>"}, {"owner": {"reputation": 61, "user_id": 5037832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SojnO.jpg?s=128&g=1", "display_name": "Marcus Martins", "link": "https://stackoverflow.com/users/5037832/marcus-martins"}, "edited": false, "score": 0, "creation_date": 1467845104, "post_id": 33524733, "comment_id": 63891516, "body": "Yes! Thank you very much."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 2, "last_activity_date": 1446648316, "creation_date": 1446648316, "answer_id": 33524733, "question_id": 33524372, "link": "https://stackoverflow.com/questions/33524372/programming-a-macro-to-run-automatically-after-installing-an-addin/33524733#33524733", "title": "Programming a macro to run automatically after installing an AddIn", "body": "<p>In the ThisWorkbook code module of the add-in:</p>\n\n<pre><code>Private Sub Workbook_AddinInstall()\n    displayParameters\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5037832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SojnO.jpg?s=128&g=1", "display_name": "Marcus Martins", "link": "https://stackoverflow.com/users/5037832/marcus-martins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1446648316, "creation_date": 1446647199, "last_edit_date": 1446647638, "question_id": 33524372, "link": "https://stackoverflow.com/questions/33524372/programming-a-macro-to-run-automatically-after-installing-an-addin", "title": "Programming a macro to run automatically after installing an AddIn", "body": "<p>I have an Add-In that will be shared among several users. </p>\n\n<p>Inside that Add-In, I have a Macro called <code>displayParameters()</code>, which just registers the other functions from the Add-In, along with the description of those functions and their parameters. </p>\n\n<p><strong>The problem is that everytime an user installs the Add-In, he/she has to run that macro once in order to register the functions/parameters.</strong></p>\n\n<p>Is there a way I can <strong>make the macro run automatically everytime an user install the Add-In?</strong> </p>\n\n<p>I do not want the macro to run everytime an user opens a spreadsheet with the add-in installed, or anything like that. </p>\n\n<p>I want the macro to run only after installing the Add-In. </p>\n\n<p>By installing the Add-In I mean going to <code>Developer -&gt; Add-Ins -&gt; Selecting the Add-In -&gt; Ok</code></p>\n\n<p>Is there anything similar to Change Event but related to AddIns?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1446651827, "creation_date": 1446651827, "answer_id": 33526002, "question_id": 33524219, "link": "https://stackoverflow.com/questions/33524219/alternative-to-access-app/33526002#33526002", "title": "Alternative to Access app", "body": "<p>Yeah make an Adodb connection object, and a Adodb recordset object. Untested code below.</p>\n\n<pre><code>set conn = CreateObject(\"ADODB.Connection\")\nconn.Provider=\"Microsoft.Jet.OLEDB.4.0\" 'Or Microsoft.ACE.OLEDB.12.0 for 2007+ version of access\nconn.Open \"c:/webdata/northwind.mdb\" 'path to your db\n\nset objRecordset=CreateObject(\"ADODB.Recordset\")\nobjRecordset.open(\"Select * from SomeTable\",conn,0,3,1)\n\n'do you work here, something like a loop for each field and for each row\n\nobjRecordset.close\nconn.close\n</code></pre>\n"}], "owner": {"reputation": 891, "user_id": 2672634, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/03b9819527625d5198e71248e7590cbe?s=128&d=identicon&r=PG", "display_name": "Jason Samuels", "link": "https://stackoverflow.com/users/2672634/jason-samuels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446651827, "creation_date": 1446646810, "last_edit_date": 1446650176, "question_id": 33524219, "link": "https://stackoverflow.com/questions/33524219/alternative-to-access-app", "title": "Alternative to Access app", "body": "<p>A subroutine in Excel VBA runs a macro in an Access database. This exports a table in the db to a .csv file. I have Access installed on my PC but other people that will also need to use this do not, so see an error message.</p>\n\n<p>Is there any other method I can use to run a macro from Access besides creating an object as in my code below, maybe something like a ADODB?  </p>\n\n<p>My Excel VBA code:</p>\n\n<pre><code>Dim accApp As Object\nSet accApp = CreateObject(\"Access.Application\")\n\n\ndbPath = ThisWorkbook.Path &amp; \"\\Database\\STORE_TOC_FRONTEND.accdb\"\n\naccApp.OpenCurrentDatabase dbPath\naccApp.DoCmd.RunMacro \"Create SS Upload\"\n\nSet accApp = Nothing\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "edited": false, "score": 0, "creation_date": 1446729393, "post_id": 33524783, "comment_id": 54870725, "body": "Exactly what I needed... Seems to work perfectly. Thanks for your help."}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": true, "score": 2, "last_activity_date": 1446648457, "creation_date": 1446648457, "answer_id": 33524783, "question_id": 33523796, "link": "https://stackoverflow.com/questions/33523796/excel-vba-average-last-15-non-blank-cells/33524783#33524783", "title": "Excel VBA average last 15 non blank cells", "body": "<p>Id write a UDF and reference it in the sheet, this displays a message if it can't find 15 numbers to average, you can adjust it take average of all the numbers it finds up to a max of 15, or something like that</p>\n\n<pre><code>Function Average15(rng As Range) 'take entire column as argument\nColumnNumber = rng.Column\nrownumber = Cells(65536, ColumnNumber).End(xlUp).Row\nIf rownumber &lt; 15 Then\n    Average15 = \"Not Enough Cells\"\n    Exit Function\nEnd If\nCounter = 0\nWhile Counter &lt; 15\n    If rownumber = 1 Then 'assumes no header row(s), change this to the first row with data in it\n        Average15 = \"Not enough values\"\n        Exit Function\n    End If\n    If Cells(rownumber, ColumnNumber).Value &lt;&gt; \"\" Then\n        Counter = Counter + 1\n        Totals = Totals + Cells(rownumber, ColumnNumber).Value\n    End If\n    rownumber = rownumber - 1\nWend\nAverage15 = Totals / 15\nEnd Function\n</code></pre>\n\n<p>in the sheet the formula would be </p>\n\n<pre><code>=AVERAGE15(A:A)\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 33524783, "answer_count": 1, "score": 1, "last_activity_date": 1449103329, "creation_date": 1446645654, "last_edit_date": 1531164843, "question_id": 33523796, "link": "https://stackoverflow.com/questions/33523796/excel-vba-average-last-15-non-blank-cells", "title": "Excel VBA average last 15 non blank cells", "body": "<p>I am using the formula below to enter into a cell from VBA and it works fine until I have a formula in the cells I am counting which I leave blank until other data is entered. How can I get this formula to average the last 15 cells and ignore blank cells that contain a formula? </p>\n\n<pre><code>=AVERAGE(OFFSET(AE8,COUNTA(AE:AE)-16,0,16,1))\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "edited": false, "score": 1, "creation_date": 1446647084, "post_id": 33523709, "comment_id": 54829704, "body": "=[myNumber] &amp; &quot; &#176;&quot; should work if you are putting it in the controlsource of the textbox. Unless the name of the textbox is the same as the field name. If that is the case, change the name of the textbox."}], "answers": [{"comments": [{"owner": {"reputation": 232, "user_id": 2796515, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cca163ebbc0729f1a55adef143de46e2?s=128&d=identicon&r=PG&f=1", "display_name": "user2796515", "link": "https://stackoverflow.com/users/2796515/user2796515"}, "edited": false, "score": 0, "creation_date": 1446646603, "post_id": 33524016, "comment_id": 54829351, "body": "I am using 2013.  Not sure if that makes any difference.  I tried your second formula, and it gives me a #Size! error.  I&#39;ve never seen that, any ideas?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 232, "user_id": 2796515, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cca163ebbc0729f1a55adef143de46e2?s=128&d=identicon&r=PG&f=1", "display_name": "user2796515", "link": "https://stackoverflow.com/users/2796515/user2796515"}, "edited": false, "score": 0, "creation_date": 1446646735, "post_id": 33524016, "comment_id": 54829458, "body": "@user2796515: What datatype is <code>myNumber</code>, and what value does it have? It doesn&#39;t sound like it is 44."}, {"owner": {"reputation": 232, "user_id": 2796515, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cca163ebbc0729f1a55adef143de46e2?s=128&d=identicon&r=PG&f=1", "display_name": "user2796515", "link": "https://stackoverflow.com/users/2796515/user2796515"}, "edited": false, "score": 0, "creation_date": 1446646922, "post_id": 33524016, "comment_id": 54829592, "body": "Sorry, it is a number field that can contain a null value.  When first opening the form it is null - I should have mentioned that - sorry"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 232, "user_id": 2796515, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cca163ebbc0729f1a55adef143de46e2?s=128&d=identicon&r=PG&f=1", "display_name": "user2796515", "link": "https://stackoverflow.com/users/2796515/user2796515"}, "edited": false, "score": 0, "creation_date": 1446647017, "post_id": 33524016, "comment_id": 54829662, "body": "@user2796515: NULL should be covered by the Nz() function - it should return &quot;&quot; and the textbox should be &quot; &#176;&quot;."}, {"owner": {"reputation": 232, "user_id": 2796515, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cca163ebbc0729f1a55adef143de46e2?s=128&d=identicon&r=PG&f=1", "display_name": "user2796515", "link": "https://stackoverflow.com/users/2796515/user2796515"}, "edited": false, "score": 0, "creation_date": 1446647152, "post_id": 33524016, "comment_id": 54829757, "body": "That is what I figured, and that is exactly what I was expecting.  Perhaps it may be best to add a text box with the static symbol.   This will come down to a design decision.  I will mark your answer as correct.  Not sure why I get the size error still though.  Thanks!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1446646248, "creation_date": 1446646248, "answer_id": 33524016, "question_id": 33523709, "link": "https://stackoverflow.com/questions/33523709/concatenate-number-and-symbol/33524016#33524016", "title": "Concatenate number and symbol", "body": "<pre><code>=[myNumber] &amp; \" \u00b0\"  \n</code></pre>\n\n<p>works for me in Access 2010.</p>\n\n<p>You can try to explicitely convert it into a string (and check for NULL, because CStr() doesn't like NULL):</p>\n\n<pre><code>=CStr(Nz([myNumber], \"\")) &amp; \" \u00b0\"  \n</code></pre>\n"}], "owner": {"reputation": 232, "user_id": 2796515, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cca163ebbc0729f1a55adef143de46e2?s=128&d=identicon&r=PG&f=1", "display_name": "user2796515", "link": "https://stackoverflow.com/users/2796515/user2796515"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "accepted_answer_id": 33524016, "answer_count": 1, "score": 0, "last_activity_date": 1446693413, "creation_date": 1446645408, "last_edit_date": 1446693413, "question_id": 33523709, "link": "https://stackoverflow.com/questions/33523709/concatenate-number-and-symbol", "title": "Concatenate number and symbol", "body": "<p>I am trying to concatenate a number with a symbol in an MS Access textbox.</p>\n\n<p>The field is a number (ie 44), and a symbol (ie \u00b0).</p>\n\n<p>I have tried several different ways:</p>\n\n<pre><code>=[myNumber] &amp; \" \u00b0\"    \n</code></pre>\n\n<p>gives a #Type error</p>\n\n<pre><code>=myNumber &amp; \" \u00b0\"\n</code></pre>\n\n<p>also results in a #Type error</p>\n\n<pre><code>=[myNumber] &amp; [\u00b0]\n</code></pre>\n\n<p>results in a #Name error</p>\n"}, {"tags": ["excel", "vba", "dictionary"], "comments": [{"owner": {"reputation": 85, "user_id": 1209721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ad11d5ddefb48cde28d39feb980b59?s=128&d=identicon&r=PG", "display_name": "Tomamais", "link": "https://stackoverflow.com/users/1209721/tomamais"}, "edited": false, "score": 0, "creation_date": 1446645717, "post_id": 33523658, "comment_id": 54828718, "body": "Do you meant Scripting.Dictionary?"}, {"owner": {"reputation": 161961, "user_id": 4653, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a525b89ed2980a2bbc41e1f23dc350cf?s=128&d=identicon&r=PG&f=1", "display_name": "leora", "link": "https://stackoverflow.com/users/4653/leora"}, "reply_to_user": {"reputation": 85, "user_id": 1209721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ad11d5ddefb48cde28d39feb980b59?s=128&d=identicon&r=PG", "display_name": "Tomamais", "link": "https://stackoverflow.com/users/1209721/tomamais"}, "edited": false, "score": 0, "creation_date": 1446652955, "post_id": 33523658, "comment_id": 54834132, "body": "@Tomamais - yes, that is what i am talking about"}], "answers": [{"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 9, "last_activity_date": 1446645965, "creation_date": 1446645965, "answer_id": 33523909, "question_id": 33523658, "link": "https://stackoverflow.com/questions/33523658/what-is-the-easiest-way-to-take-two-columns-of-data-and-convert-to-dictionary/33523909#33523909", "title": "What is the easiest way to take two columns of data and convert to dictionary?", "body": "<p>You would need to loop, E.g.</p>\n\n<pre><code>Function CreateDictFromColumns(sheet As String, keyCol As String, valCol As String) As Dictionary\n    Set CreateDictFromColumns = New Dictionary\n    Dim rng As Range: Set rng = Sheets(sheet).Range(keyCol &amp; \":\" &amp; valCol)\n    Dim i As Long\n    Dim lastCol As Long '// for non-adjacent (\"A:ZZ\")\n    lastCol = rng.Columns.Count\n    For i = 1 To rng.Rows.Count\n        If (rng(i, 1).Value = \"\") Then Exit Function\n        CreateDictFromColumns.Add rng(i, 1).Value, rng(i, lastCol).Value\n    Next\nEnd Function\n</code></pre>\n\n<p>This breaks on the first empty key value cell.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 12292279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e8c5652f283318b7b734d34c36728a?s=128&d=identicon&r=PG", "display_name": "Dave Greene", "link": "https://stackoverflow.com/users/12292279/dave-greene"}, "edited": false, "score": 1, "creation_date": 1572362780, "post_id": 33524145, "comment_id": 103531542, "body": "This code snippet worked very nicely for me, except that I had to reverse &quot;Val&quot; and &quot;Key&quot; in the Dic.Add call.  The docs for the Add method seem to say that the key is the first parameter and the value is the second parameter -- <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/add-method-dictionary\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a> -- and that&#39;s what I found in practice."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1572371238, "last_edit_date": 1572371238, "creation_date": 1446646618, "answer_id": 33524145, "question_id": 33523658, "link": "https://stackoverflow.com/questions/33523658/what-is-the-easiest-way-to-take-two-columns-of-data-and-convert-to-dictionary/33524145#33524145", "title": "What is the easiest way to take two columns of data and convert to dictionary?", "body": "<p>This should do the trick :</p>\n\n<pre><code>Public Function test_leora(SheetName As String, _\n                            KeyColumn As String, _\n                            ValColumn As String) _\n                                    As Variant\nDim Dic, _\n    Val As String, _\n    Key As String, _\n    Ws As Worksheet, _\n    LastRow As Long\n\nSet Ws = ThisWorkbook.Sheets(SheetName)\nSet Dic = CreateObject(\"Scripting.Dictionary\")\n\nWith Ws\n    LastRow = .Range(KeyColumn &amp; .Rows.Count).End(xlUp).Row\n    For i = 1 To LastRow\n        Val = .Cells(i, ValColumn)\n        Key = .Cells(i, KeyColumn)\n        If Dic.exists(Key) Then\n        Else\n            Dic.Add Key, Val\n        End If\n    Next i\nEnd With\n\ntest_leora = Dic\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 3, "last_activity_date": 1446652548, "last_edit_date": 1446652548, "creation_date": 1446646708, "answer_id": 33524182, "question_id": 33523658, "link": "https://stackoverflow.com/questions/33523658/what-is-the-easiest-way-to-take-two-columns-of-data-and-convert-to-dictionary/33524182#33524182", "title": "What is the easiest way to take two columns of data and convert to dictionary?", "body": "<p>The best approach to take, is to populate a variant array with the data from the worksheet. You can then loop through the array, assigning the elements of the first array column as the dictionary key; the elements of the second array column can then be used as the value.</p>\n\n<p>The <code>lrow</code> function is used to find the last populated row from column A - allowing the code to create a dynamically sized array and dictionary.</p>\n\n<blockquote>\n  <p>To enable use of dictionaries within VBA, you will need to go to Tools -> References and then enable Microsoft Scripting Runtime.</p>\n</blockquote>\n\n<pre><code>Sub createDictionary()\n    Dim dict As Scripting.Dictionary\n    Dim arrData() As Variant\n    Dim i as Long\n\n    arrData = Range(\"A1\", Cells(lrow(1), 2))\n    set dict = new Scripting.Dictionary        \n\n    For i = LBound(arrData, 1) To UBound(arrData, 1)\n        dict(arrData(i, 1)) = arrData(i, 2)\n    Next i\nEnd Sub\n\nFunction lrow(ByVal colNum As Long) As Long\n    lrow = Cells(Rows.Count, 1).End(xlUp).Row\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "is_accepted": false, "score": 5, "last_activity_date": 1446652329, "last_edit_date": 1446652329, "creation_date": 1446648541, "answer_id": 33524813, "question_id": 33523658, "link": "https://stackoverflow.com/questions/33523658/what-is-the-easiest-way-to-take-two-columns-of-data-and-convert-to-dictionary/33524813#33524813", "title": "What is the easiest way to take two columns of data and convert to dictionary?", "body": "<p>I think it'd be best form to pass two ranges to a create dictionary function. This allows for the ranges to be completely separate, even different workbooks. It also allows for a 1D range to be mapped to a 2D range as demonstrated below.</p>\n\n<p>Alternatively, you could also pass two arrays of range values.  That may be cleaner for 1D ranges, but would result in slightly more code for 2D mapping. Notice that range elements can be looped through left to right top to bottom by index.  You can use <code>Application.Transpose(Range(\"A1:A5\"))</code> to effectively run top to bottom left to right.</p>\n\n<h2><strong>Jagged Mapping</strong></h2>\n\n<pre><code>Sub Test()\n    RangeToDict Sheets(1).Range(\"A1:A5\"), Sheets(2).Range(\"C1:E2\")\nEnd Sub\n\nFunction RangeToDict(ByVal KeyRng As Range, ByVal ValRng As Range) As Dictionary\n    Set RangeToDict = New Dictionary\n    For Each r In KeyRng\n        vi = vi + 1\n        'It may not be advisable to handle empty key values this way\n        'The handling of empty values and #N/A/Error values \n        'Depends on your exact usage\n        If r.Value2 &lt;&gt; \"\" Then\n            RangeToDict.Add r.Value2, ValRng(vi)\n            Debug.Print r.Value2 &amp; \", \" &amp; ValRng(vi)\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/RvM43.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/RvM43.png\" alt=\"enter image description here\"></a></p>\n\n<h2><strong>Side-By-Side (As Range)</strong></h2>\n\n<p>If your target range is a single 2 column range side by side, you can simplify to passing a single range as shown below.  Consequently, this also works for mapping every other element in a 1 dimensional range.</p>\n\n<pre><code>Sub Test()\n    RangeToDict2 Range(\"A1:B5\")\nEnd Sub\nFunction RangeToDict2(ByVal R As Range) As Dictionary\n    Set RangeToDict2 = New Dictionary\n    i = 1\n    Do Until i &gt;= (R.Rows.Count * R.Columns.Count)\n        RangeToDict2.Add R(i), R(i + 1)\n        Debug.Print R(i) &amp; \", \" &amp; R(i + 1)\n        i = i + 2\n    Loop\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dfocU.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/dfocU.png\" alt=\"enter image description here\"></a></p>\n\n<h2><strong>Two Columns (As Array)</strong></h2>\n\n<p>Lastly, as an example of passing arrays as arguments, you could do something like the following.  However, the following code will only work given the OP's specific scenario of mapping two columns.  As is, it won't handle mapping rows or alternating elements. </p>\n\n<pre><code>Sub Test()\n    Dim Keys() As Variant: Keys = Range(\"E1:I1\").Value2\n    Dim Values() As Variant: Values = Range(\"E3:I3\").Value2\n    RangeToDict Keys, Values\nEnd Sub\nFunction RangeToDict(Keys() As Variant, Values() As Variant) As Dictionary\n    Set RangeToDict = New Dictionary\n    For i = 1 To UBound(Keys)\n        RangeToDict.Add Keys(i, 1), Values(i, 1)\n        Debug.Print Keys(i, 1) &amp; \", \" &amp; Values(i, 1)\n    Next\nEnd Function\n</code></pre>\n\n<h2><strong>Use of Named Ranges</strong></h2>\n\n<p>It may be convenient to used named ranges, in which case you can pass a Range as an argument likes this...</p>\n\n<pre><code>Sub Test()\n    RangeToDict Names(\"Keys\").RefersToRange, Names(\"Values\").RefersToRange\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 161961, "user_id": 4653, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a525b89ed2980a2bbc41e1f23dc350cf?s=128&d=identicon&r=PG&f=1", "display_name": "leora", "link": "https://stackoverflow.com/users/4653/leora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8792, "favorite_count": 2, "accepted_answer_id": 33523909, "answer_count": 4, "score": 9, "last_activity_date": 1572371238, "creation_date": 1446645275, "last_edit_date": 1446652940, "question_id": 33523658, "link": "https://stackoverflow.com/questions/33523658/what-is-the-easiest-way-to-take-two-columns-of-data-and-convert-to-dictionary", "title": "What is the easiest way to take two columns of data and convert to dictionary?", "body": "<p>I have a worksheet with data in columns A and B.  </p>\n\n<p>I am looking for a <strong>convenient way to take these columns and convert to dictionary</strong> where the cell in <strong>column A is the key</strong> and <strong>column B is the value</strong>, something like :</p>\n\n<pre><code>Dim dict as Dictionary\nSet dict = CreateDictFromColumns(\"SheetName\", \"A\", \"B\")\n</code></pre>\n\n<p>NOTE: I am already referencing the scripting dll.</p>\n"}, {"tags": ["excel", "vba", "target", "worksheet"], "comments": [{"owner": {"reputation": 102, "user_id": 1217386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/59d57ef041c04beb91f167f121d13ae5?s=128&d=identicon&r=PG", "display_name": "ChrisBuck", "link": "https://stackoverflow.com/users/1217386/chrisbuck"}, "edited": false, "score": 0, "creation_date": 1447031095, "post_id": 33523507, "comment_id": 54977401, "body": "Have you tried putting the code into a public subroutine? And then calling the sub from the worksheet change event? Example: Make a new public variable called &quot;TargetR&quot;, set it to Target in the private sub, then copy-paste everything to a new sub named NewSub. Your private sub would simply set TargetR, and then call NewSub."}, {"owner": {"reputation": 102, "user_id": 1217386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/59d57ef041c04beb91f167f121d13ae5?s=128&d=identicon&r=PG", "display_name": "ChrisBuck", "link": "https://stackoverflow.com/users/1217386/chrisbuck"}, "edited": false, "score": 0, "creation_date": 1447112477, "post_id": 33523507, "comment_id": 55015254, "body": "Another potential issue I see is the paste special statement referencing xlvalues, which ought not need to be enclosed in parentheses."}, {"owner": {"reputation": 57, "user_id": 4078073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba05aad4f4dfecd7bc269b633baa55f?s=128&d=identicon&r=PG&f=1", "display_name": "lobochrome", "link": "https://stackoverflow.com/users/4078073/lobochrome"}, "reply_to_user": {"reputation": 102, "user_id": 1217386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/59d57ef041c04beb91f167f121d13ae5?s=128&d=identicon&r=PG", "display_name": "ChrisBuck", "link": "https://stackoverflow.com/users/1217386/chrisbuck"}, "edited": false, "score": 0, "creation_date": 1447142385, "post_id": 33523507, "comment_id": 55024238, "body": "Hi Chris, thanks for commenting on this apparently unsexy issue here on se. I&#39;ve tried that now, yet it doesn&#39;t seem to change anything. The event isn&#39;t executing at all thus whether it executes the code directly or in another sub isn&#39;t changing behaviour. Your second point isn&#39;t really clear to me. Do you mean xlPasteFormats? I&#39;ve never come to terms with attribute/parameter naming in VBA but that part works like a charm that way..."}, {"owner": {"reputation": 102, "user_id": 1217386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/59d57ef041c04beb91f167f121d13ae5?s=128&d=identicon&r=PG", "display_name": "ChrisBuck", "link": "https://stackoverflow.com/users/1217386/chrisbuck"}, "edited": false, "score": 0, "creation_date": 1447160548, "post_id": 33523507, "comment_id": 55034497, "body": "I&#39;ll take another look at the code on my computer, and try and replicate the problem. In the meantime, the pastespecial observation simply means that you don&#39;t have to enclose xlPasteFormats in parentheses. It would look like this:  <b>.Range(&quot;AC7:AO&quot; &amp; EndRow - 1).PasteSpecial xlPasteFormats</b>. You don&#39;t need to enclose parameters unless they&#39;re not on the right side of an equals sign."}, {"owner": {"reputation": 102, "user_id": 1217386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/59d57ef041c04beb91f167f121d13ae5?s=128&d=identicon&r=PG", "display_name": "ChrisBuck", "link": "https://stackoverflow.com/users/1217386/chrisbuck"}, "edited": false, "score": 0, "creation_date": 1447160597, "post_id": 33523507, "comment_id": 55034524, "body": "I agree that it&#39;s probably not the cause of the issue. Just an FYI."}, {"owner": {"reputation": 57, "user_id": 4078073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba05aad4f4dfecd7bc269b633baa55f?s=128&d=identicon&r=PG&f=1", "display_name": "lobochrome", "link": "https://stackoverflow.com/users/4078073/lobochrome"}, "reply_to_user": {"reputation": 102, "user_id": 1217386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/59d57ef041c04beb91f167f121d13ae5?s=128&d=identicon&r=PG", "display_name": "ChrisBuck", "link": "https://stackoverflow.com/users/1217386/chrisbuck"}, "edited": false, "score": 1, "creation_date": 1447660125, "post_id": 33523507, "comment_id": 55229934, "body": "Thanks Chris, I believe I&#39;m running isn&#39;t memory issues somewhere. My solution was to rewrite the whole book, so you needn&#39;t bother."}], "owner": {"reputation": 57, "user_id": 4078073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba05aad4f4dfecd7bc269b633baa55f?s=128&d=identicon&r=PG&f=1", "display_name": "lobochrome", "link": "https://stackoverflow.com/users/4078073/lobochrome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1446644756, "creation_date": 1446644756, "question_id": 33523507, "link": "https://stackoverflow.com/questions/33523507/worksheet-change-event-not-firing-after-a-while", "title": "Worksheet_change Event not firing after a while", "body": "<p>I've got this pretty simple Worksheet change event - which used to work just fine, in a book with lots of other code. I use it to format a range adjacent to a pivot table in the color scheme of said table.</p>\n\n<p>Now all of a sudden, the code is only firing for a while, whence the book is open. Only a closing the Excel 2010 instance seems to fix the problem.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim EndRow As Integer\nDim StartRange As Range\n\nSet StartRange = ActiveCell\n\nEndRow = Sheet8.Range(\"A7:A9999\").Find(vbNullString, , xlValues).Row\n\nIf IsNumeric(EndRow) Then\n\n    If Target.Column = 1 Then\n        With Sheet8\n           .Range(\"AC8:AO9999\").ClearFormats\n           .Range(\"C7:O\" &amp; EndRow - 1).Copy\n           .Range(\"AC7:AO\" &amp; EndRow - 1).PasteSpecial (xlPasteFormats)\n        End With\n    Application.CutCopyMode = False\n    StartRange.Select\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1446643507, "post_id": 33522982, "comment_id": 54827244, "body": "is your form unbound? silly question really but I had to ask"}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1446647435, "post_id": 33522982, "comment_id": 54829957, "body": "I tried it bound and unbound, does not solve the issue."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1446648343, "post_id": 33522982, "comment_id": 54830623, "body": "are you ensuring that your form is dirty? use an <code>if dirty then</code> to ensure theres something to save."}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1446649016, "post_id": 33522982, "comment_id": 54831168, "body": "I enter information into the controls, so there should be something to save. However, how exactly would I use your proposal?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1446649378, "post_id": 33522982, "comment_id": 54831434, "body": "&quot;The code gets executed, however, no new record is created.&quot; -- What exactly happens? Does the record selector still show the &quot;pen&quot; editing icon? If <code>acCmdSaveRecord</code> fails, it usually displays an error."}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1446649550, "post_id": 33522982, "comment_id": 54831580, "body": "Yes, pen is displayed. I do not get an any error message."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1446649981, "post_id": 33522982, "comment_id": 54831879, "body": "What do you have as the form&#39;s Record Source property?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1446653942, "post_id": 33522982, "comment_id": 54834817, "body": "Either your code isn&#39;t executed (put a MsgBox in <code>btnSave_Click()</code> just to be sure), or the button is on a different form than the data. Are there subforms involved? -- <code>Me.Dirty = False</code> is much more reliable than <code>DoCmd.RunCommand acCmdSaveRecord</code> in that regard."}], "answers": [{"tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": true, "score": 0, "last_activity_date": 1446650242, "last_edit_date": 1446650242, "creation_date": 1446649786, "answer_id": 33525249, "question_id": 33522982, "link": "https://stackoverflow.com/questions/33522982/accmdsaverecord-does-not-save-record/33525249#33525249", "title": "acCmdSaveRecord does not save record", "body": "<p>I would ensure that the form only attempts a save when it is dirty like below.\nI have added an error handler to notify the user that the form cannot be saved. </p>\n\n<pre><code>option explicit\nprivate sub btnSave_Click()\non Error goto ErrTrap\nif me.dirty= true then\n     DoCmd.RunCommand acCmdSaveRecord\n     DoCmd.GoToRecord , , acNewRec\nend if\n\nErrTrap:\n   MsgBox Err.Number &amp; \": \" &amp; Err.Description\nend sub\n</code></pre>\n\n<p>there is a work around to avoid the <code>docmd.runcommand</code> ; it will save the record... but I have never used it :</p>\n\n<pre><code>if me.dirty=true then\n   me.dirty=false\nend if\n</code></pre>\n"}], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4219, "favorite_count": 0, "accepted_answer_id": 33525249, "answer_count": 1, "score": 0, "last_activity_date": 1446650242, "creation_date": 1446643129, "last_edit_date": 1446648470, "question_id": 33522982, "link": "https://stackoverflow.com/questions/33522982/accmdsaverecord-does-not-save-record", "title": "acCmdSaveRecord does not save record", "body": "<p>I have a MS Access 2010 application. In a form new records can be entered. Therefore I go to new record on form load:</p>\n\n<pre><code>Private Sub Form_Load()    \n    DoCmd.GoToRecord Record:=acNewRec\nEnd Sub\n</code></pre>\n\n<p>After information is entered, by click a save button, the record shall be saved and the form shall go to a new record.</p>\n\n<pre><code>Private Sub btnSave_Click()\n    DoCmd.RunCommand acCmdSaveRecord\n    DoCmd.GoToRecord , , acNewRec\nEnd Sub\n</code></pre>\n\n<p>The code gets executed, however, no new record is created. The input controls are linked to the table fields.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1446644701, "post_id": 33523095, "comment_id": 54828021, "body": "Good explanation. I edited it also to include the option for using the <code>RowSource</code> method as an alternative."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1446646706, "post_id": 33523095, "comment_id": 54829434, "body": "@DavidZemens : thx for the edit, I forgot about <code>RowSource</code> as I haven&#39;t used it in few years! But nice completion and actual answer of the OP! ;)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1446647613, "post_id": 33523095, "comment_id": 54830088, "body": "I forget about it to because I do mainly PPT development anymore, I don&#39;t do much with Excel but I remember that one can be useful <i>if</i> your UserForm needs to be linked to the worksheet. The neat thing about that is then the ListBox will reflect changes to the worksheet, without having to explicitly &quot;update&quot; the <code>.List</code> property"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1446644499, "last_edit_date": 1446644499, "creation_date": 1446643504, "answer_id": 33523095, "question_id": 33522788, "link": "https://stackoverflow.com/questions/33522788/adding-rows-in-a-multicolumn-listbox/33523095#33523095", "title": "Adding rows in a MultiColumn ListBox", "body": "<p>The items in a multicolumn listbox can be accessed using the <code>.List</code> member. This member accepts two parameters as input:</p>\n\n<pre><code>ListBox1.List(RowIndex, ColumnIndex)\n</code></pre>\n\n<p><em>RowIndex</em>: The row index of the record we want to access. Note the rows in a listbox are zero based. Therefor the index of the first row is <em>0</em>.</p>\n\n<p><em>ColumnIndex</em>: The column index of the field we want to access. Note the columns in a multi column listbox are also zero indexed. Therefore the first column has an index of <em>0</em>.</p>\n\n<p>For example :</p>\n\n<pre><code>'Assign values to the columns \nFor i = 1 To 9\n    ListBox1.AddItem 'Create a new row\n    ListBox1.List(i - 1, 0) = i 'Fill the first column\n    ListBox1.List(i - 1, 1) = i * 10 \n    ListBox1.List(i - 1, 2) = i * 100 \n    ListBox1.List(i - 1, 3) = i * 1000 \nNext i\n</code></pre>\n\n<p><strong>Alternatively</strong></p>\n\n<blockquote>\n  <p>but if we want the entire row from where search result is, how do we add it, instead of doing something like this vba listbox multicolumn add ?</p>\n</blockquote>\n\n<p>Assuming you have a range object (e.g., <code>rngFound</code>) which represent the result of your <code>.Find</code>:</p>\n\n<pre><code>Me.ListBox1.Clear\nMe.ListBox1.ColumnCount = rngFound.Columns.Count\nMe.ListBox.RowSource = rngFound.Address\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 4704290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/l3RmA.jpg?s=128&g=1", "display_name": "svacx", "link": "https://stackoverflow.com/users/4704290/svacx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9596, "favorite_count": 1, "accepted_answer_id": 33523095, "answer_count": 1, "score": 1, "last_activity_date": 1446656629, "creation_date": 1446642531, "last_edit_date": 1495540719, "question_id": 33522788, "link": "https://stackoverflow.com/questions/33522788/adding-rows-in-a-multicolumn-listbox", "title": "Adding rows in a MultiColumn ListBox", "body": "<p>I'm messing around with VBA, especially with listboxes.</p>\n\n<p>I've created a search button, that's using a find property (.Find) and searches whatever we've put in the textbox in it's data table. </p>\n\n<p>It can add the search results to a listbox, but if we want the entire row from where search result is, how do we add it, instead of doing something like this <a href=\"https://stackoverflow.com/questions/11213962/vba-listbox-multicolumn-add\">vba listbox multicolumn add</a>?<br>\nHow can it be done, using VBA?<br>\nIs it even possible?<br>\nElse, is it possible without VBA?</p>\n\n<p><strong>What is happening:</strong></p>\n\n<pre><code>Data table: a | b | c | d | e\n            1 | 2 | 3 | 4 | 5\nSearch:   a \nListbox : a\n\nSearch:   1 \nListbox : 1\n\nSearch:   2\nListbox : 2\n\nSearch:   d \nListbox : d\n</code></pre>\n\n<p><strong>What I \"want\":</strong></p>\n\n<pre><code>Data table: a | b | c | d | e\n            1 | 2 | 3 | 4 | 5\n\nSearch:  a\nListbox: a | b | c | d | e\n\nSearch:  1\nListbox: 1 | 2 | 3 | 4 | 5\n\nSearch:  2\nListbox: 1 | 2 | 3 | 4 | 5\n\nSearch:  d\nListbox: a | b | c | d | e\n</code></pre>\n\n<p>If it's needed I can provide the code I am using for testing the search.</p>\n"}, {"tags": ["excel", "csv", "vba"], "comments": [{"owner": {"reputation": 11569, "user_id": 5015207, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3GiGl.jpg?s=128&g=1", "display_name": "B&#246; macht Blau", "link": "https://stackoverflow.com/users/5015207/b%c3%b6-macht-blau"}, "edited": false, "score": 2, "creation_date": 1446641000, "post_id": 33522259, "comment_id": 54825608, "body": "it&#39;s easier for people to help you if they have some relevant <b>piece of code</b> to work on - please show us what you have tried so far"}, {"owner": {"reputation": 1, "user_id": 5524702, "user_type": "registered", "profile_image": "https://graph.facebook.com/938502589519071/picture?type=large", "display_name": "rayZa", "link": "https://stackoverflow.com/users/5524702/rayza"}, "reply_to_user": {"reputation": 11569, "user_id": 5015207, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3GiGl.jpg?s=128&g=1", "display_name": "B&#246; macht Blau", "link": "https://stackoverflow.com/users/5015207/b%c3%b6-macht-blau"}, "edited": false, "score": 0, "creation_date": 1446643511, "post_id": 33522259, "comment_id": 54827246, "body": "I do have a code but it copy everything in csv sheets and stack it in single worksheet. I have to cut so many unneeded data.i will show the cod later"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5524702, "user_type": "registered", "profile_image": "https://graph.facebook.com/938502589519071/picture?type=large", "display_name": "rayZa", "link": "https://stackoverflow.com/users/5524702/rayza"}, "edited": false, "score": 0, "creation_date": 1446697460, "post_id": 33523533, "comment_id": 54854342, "body": "Neuralgroove..thanks for ur code but nothing happen when i run it.i cant share my code bcause im using mobile.any idea how?im very new in here"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "reply_to_user": {"reputation": 1, "user_id": 5524702, "user_type": "registered", "profile_image": "https://graph.facebook.com/938502589519071/picture?type=large", "display_name": "rayZa", "link": "https://stackoverflow.com/users/5524702/rayza"}, "edited": false, "score": 0, "creation_date": 1446722880, "post_id": 33523533, "comment_id": 54866646, "body": "need more detail..make sure you change the FileDirectory path to wherever your files are, then step through the code (F8) to try and see whats going on..you can also comment out the  <code>On Error GoTo errorhandler</code> line  to debug"}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": false, "score": 0, "last_activity_date": 1446722787, "last_edit_date": 1446722787, "creation_date": 1446644847, "answer_id": 33523533, "question_id": 33522259, "link": "https://stackoverflow.com/questions/33522259/vba-code-for-merge-bunch-of-csv-file-to-single-worksheet-with-certain-range-only/33523533#33523533", "title": "VBA code for merge bunch of CSV file to single worksheet with certain range only", "body": "<p>Try this</p>\n\n<pre><code>Dim FileNum As Integer\nDim FileName As String\nDim DataLine As String\nDim ws As Worksheet\nDim SkipLines As Integer\nDim r As Long\nConst FileDirectory As String = \"C:\\Test\\\"\nConst FileMask As String = \"*.csv\"\nSub LoadCSV()\nOn Error GoTo errorhandler\nSet ws = Sheets.Add\nr = 1\nFileName = Dir(FileDirectory &amp; FileMask, vbNormal)\nWhile FileName &lt;&gt; \"\"\n    FileNum = FreeFile()\n    Open FileName For Input As #FileNum\n    For SkipLines = 1 To 10\n        If Not EOF(FileNum) Then\n            Line Input #FileNum, DataLine\n        Else\n            MsgBox \"There must be at least 11 rows of data. Skipping File\", vbInformation, FileName\n            GoTo skipfile\n        End If\n    Next SkipLines\n    While Not EOF(FileNum)\n        Line Input #FileNum, DataLine\n        arrDataLine = Split(DataLine, \",\")\n        If UBound(arrDataLine) &gt;= 3 Then\n            ws.Cells(r, 1) = arrDataLine(0)\n            ws.Cells(r, 2) = arrDataLine(3)\n            r = r + 1\n        Else\n            MsgBox \"There must be at least 4 columns of data. Skipping File\", vbInformation, FileName\n            GoTo skipfile\n        End If\n    Wend\nskipfile:\n    Close #FileNum\n    FileName = Dir$\nWend\nGoTo cleanup\nerrorhandler:\nMsgBox Err.Number &amp; \"-&gt;\" &amp; Err.Description, vbCritical, \"Error\"\ncleanup:\nClose #FileNum\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5524702, "user_type": "registered", "profile_image": "https://graph.facebook.com/938502589519071/picture?type=large", "display_name": "rayZa", "link": "https://stackoverflow.com/users/5524702/rayza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1446722787, "creation_date": 1446640943, "last_edit_date": 1531164843, "question_id": 33522259, "link": "https://stackoverflow.com/questions/33522259/vba-code-for-merge-bunch-of-csv-file-to-single-worksheet-with-certain-range-only", "title": "VBA code for merge bunch of CSV file to single worksheet with certain range only", "body": "<p>I need to merge bunch of CSV files in the same folder to a single worksheet. I just need data from <code>A11</code> until last column and <code>D11</code> until last column. When it pastes in worksheets, it will be at <code>A</code> and <code>B</code> column.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1446640828, "creation_date": 1446640828, "answer_id": 33522218, "question_id": 33522094, "link": "https://stackoverflow.com/questions/33522094/split-based-on-dash-and-em-dash/33522218#33522218", "title": "Split based on dash and &#39;em dash&#39;", "body": "<p>Try this:</p>\n\n<pre><code>Split(\"This\u2013not\u2013so\u2013well\", chrw(8211))\n</code></pre>\n"}], "owner": {"reputation": 609, "user_id": 1742962, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/aRDMd.gif?s=128&g=1", "display_name": "frostbite", "link": "https://stackoverflow.com/users/1742962/frostbite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 33522218, "answer_count": 1, "score": 2, "last_activity_date": 1446656671, "creation_date": 1446640486, "last_edit_date": 1446656671, "question_id": 33522094, "link": "https://stackoverflow.com/questions/33522094/split-based-on-dash-and-em-dash", "title": "Split based on dash and &#39;em dash&#39;", "body": "<p>I'm trying to use VBA Split to tokenize a string with dashes/hyphens\nThe data has the Excel em-dashes in it.  </p>\n\n<p>Any idea how I can split them?</p>\n\n<pre><code>Split(\"This-works-fine\", \"-\") \nSplit(\"This\u2013not\u2013so\u2013well\", \"-\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 675, "user_id": 3134786, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b45d2c5f0c7377b82e751c07d99f7d52?s=128&d=identicon&r=PG&f=1", "display_name": "Joba", "link": "https://stackoverflow.com/users/3134786/joba"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1446643451, "post_id": 33522049, "comment_id": 54827207, "body": "I don&#39;t really want to do that, because that would make the handling for the people who are going to use the document way harder (And I want to minimize the risk of someone not being able to use the makro). If it was for myself this would have been a good way of solving the issue though."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446644471, "post_id": 33522049, "comment_id": 54827865, "body": "can you add the code that you are using and will ultimately set the formula? This may help us provide a creative solution for you."}, {"owner": {"reputation": 675, "user_id": 3134786, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b45d2c5f0c7377b82e751c07d99f7d52?s=128&d=identicon&r=PG&f=1", "display_name": "Joba", "link": "https://stackoverflow.com/users/3134786/joba"}, "edited": false, "score": 0, "creation_date": 1446646164, "post_id": 33522049, "comment_id": 54829016, "body": "I&#39;m sorry that&#39;s not possible since I&#39;m not allowed to make parts of the code public :/"}], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 3134786, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b45d2c5f0c7377b82e751c07d99f7d52?s=128&d=identicon&r=PG&f=1", "display_name": "Joba", "link": "https://stackoverflow.com/users/3134786/joba"}, "edited": false, "score": 0, "creation_date": 1446645206, "post_id": 33523282, "comment_id": 54828361, "body": "I don&#39;t think I can use that because since I don&#39;t know the formula before it&#39;s being entered and therefore can&#39;t just replace the referenced row number with <code>c.Row</code>. Also, wouldn&#39;t your method post the formula somewhere? If yes, is that absolutely required and is there no way to just do <code>result = processFormula(formula)</code>?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 675, "user_id": 3134786, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b45d2c5f0c7377b82e751c07d99f7d52?s=128&d=identicon&r=PG&f=1", "display_name": "Joba", "link": "https://stackoverflow.com/users/3134786/joba"}, "edited": false, "score": 0, "creation_date": 1446647540, "post_id": 33523282, "comment_id": 54830031, "body": "The formula should be inputed into the processed cell <code>c</code> with my code, but if you only want the result it&#39;s possible too. But as you don&#39;t know which formula will be entered, all of this will be very tricky...** Why not propose a few tests/conditions** (like <code>&gt;</code> here) that the user can set limits (like <code>30000</code> here) and the column (<code>K</code> here)? With that you will be able to create some code to do the calculations directly!"}, {"owner": {"reputation": 675, "user_id": 3134786, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b45d2c5f0c7377b82e751c07d99f7d52?s=128&d=identicon&r=PG&f=1", "display_name": "Joba", "link": "https://stackoverflow.com/users/3134786/joba"}, "edited": false, "score": 0, "creation_date": 1446648196, "post_id": 33523282, "comment_id": 54830519, "body": "I&#39;m probably going to do that if I don&#39;t find an easy way of processing a formula.. I just would have prefered it because I thought it would have been simpler than just writing my own parser for the userinput."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 675, "user_id": 3134786, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b45d2c5f0c7377b82e751c07d99f7d52?s=128&d=identicon&r=PG&f=1", "display_name": "Joba", "link": "https://stackoverflow.com/users/3134786/joba"}, "edited": false, "score": 0, "creation_date": 1446651980, "post_id": 33523282, "comment_id": 54833421, "body": "yup, I had to do that in a project (a long time ago), but I add only two variables to identify in the formula that was inputed from the userform, and I had to struggle quite a long time to make it work, so I think a few test would work more easily in your case which seems wider!"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1446644059, "creation_date": 1446644059, "answer_id": 33523282, "question_id": 33522049, "link": "https://stackoverflow.com/questions/33522049/process-excel-formula-in-vba-without-pasting-it-in-excel/33523282#33523282", "title": "Process excel formula in VBA without pasting it in excel", "body": "<p>I don't think it'll be easier to maintain with relative references, so give this a try :</p>\n\n<pre><code>Dim c as Range\nFor Each c in Selection.Cells\n    c.formula = \"=AND($K\" &amp; c.Row &amp; \"&gt;30000,$C\" &amp; c.Row &amp; \"&lt;&gt;\" &amp; Chr(34) &amp; \"W\" &amp; Chr(34) &amp; \")\"\nNext c\n</code></pre>\n"}], "owner": {"reputation": 675, "user_id": 3134786, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b45d2c5f0c7377b82e751c07d99f7d52?s=128&d=identicon&r=PG&f=1", "display_name": "Joba", "link": "https://stackoverflow.com/users/3134786/joba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446721894, "creation_date": 1446640356, "last_edit_date": 1446643763, "question_id": 33522049, "link": "https://stackoverflow.com/questions/33522049/process-excel-formula-in-vba-without-pasting-it-in-excel", "title": "Process excel formula in VBA without pasting it in excel", "body": "<p>I'm iterating through a table of user data. </p>\n\n<p>The macro then does something with the data of each user, but I want to add a way to only select certain users with a formula that is entered through a UserForm</p>\n\n<p>Is there any way to have a formula like <code>=AND($K2&gt;30000;$C2&lt;&gt;\"W\")</code> processed for every single cell I'm iterating through (with relative cell references)?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 1, "creation_date": 1446642524, "post_id": 33521738, "comment_id": 54826602, "body": "Since the VLOOKUP takes the first value where there&#39;s a match, once it was changed to <code>STL1</code> if won&#39;t implement more changes after the first one&#39;s. <code>Country = Cel7.Offset(0,7) | Code = Cel7.Offset(0,12) | Weight = Cel7.Offset(0,17)</code> won&#39;t use lookup."}, {"owner": {"reputation": 5, "user_id": 2166874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cecc85b01b89776a75cf09584b8d484?s=128&d=identicon&r=PG", "display_name": "user2166874", "link": "https://stackoverflow.com/users/2166874/user2166874"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1446645106, "post_id": 33521738, "comment_id": 54828301, "body": "Would the INDEX/MATCH function be better for this"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1446645641, "post_id": 33521738, "comment_id": 54828660, "body": "Nope, MATCH takes first match too."}, {"owner": {"reputation": 5, "user_id": 2166874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cecc85b01b89776a75cf09584b8d484?s=128&d=identicon&r=PG", "display_name": "user2166874", "link": "https://stackoverflow.com/users/2166874/user2166874"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1446645782, "post_id": 33521738, "comment_id": 54828767, "body": "Ok... Thanks for your help"}, {"owner": {"reputation": 5, "user_id": 2166874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cecc85b01b89776a75cf09584b8d484?s=128&d=identicon&r=PG", "display_name": "user2166874", "link": "https://stackoverflow.com/users/2166874/user2166874"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1446649473, "post_id": 33521738, "comment_id": 54831513, "body": "Did what you suggested, removed the Vlookup section and replaced It with Country = Cel7.Offset(0,7).Value &amp; Code = Cel7.Offset(0,12).Value &amp; Weight = Cel7.Offset(0,17).Value and it worked as it should."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 2166874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cecc85b01b89776a75cf09584b8d484?s=128&d=identicon&r=PG", "display_name": "user2166874", "link": "https://stackoverflow.com/users/2166874/user2166874"}, "edited": false, "score": 0, "creation_date": 1446658654, "post_id": 33523999, "comment_id": 54838218, "body": "Thanks Figured it out from comment above, but this clarifies it nicely"}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": true, "score": 1, "last_activity_date": 1446646196, "creation_date": 1446646196, "answer_id": 33523999, "question_id": 33521738, "link": "https://stackoverflow.com/questions/33521738/for-each-loop-not-looping-through-rows-with-repeating-ids/33523999#33523999", "title": "&#39;For Each&#39; loop not looping through rows with repeating ID&#39;s", "body": "<p>I may be missing something, but I think a loop will perform much better than lookups</p>\n\n<pre><code>Dim Cel7_Lastrow As Integer\nCel7_Lastrow = Sheet2.Cells(Rows.Count, 1).End(xlUp).Row\nFor r = 2 To Cel7_Lastrow\n    If Sheet2.Cells(r, 8) = \"GB\" And Sheet2.Cells(r, 18) &lt;= 0.1 Then\n      If Sheet2.Cells(r, 13) = \"CRL1\" Then Sheet2.Cells(r, 13) = \"STL1\"\n      If Sheet2.Cells(r, 13) = \"CRL2\" Then Sheet2.Cells(r, 13) = \"STL2\"\n    End If\nNext r\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 2166874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cecc85b01b89776a75cf09584b8d484?s=128&d=identicon&r=PG", "display_name": "user2166874", "link": "https://stackoverflow.com/users/2166874/user2166874"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 33523999, "answer_count": 1, "score": 0, "last_activity_date": 1446646196, "creation_date": 1446639498, "last_edit_date": 1446642674, "question_id": 33521738, "link": "https://stackoverflow.com/questions/33521738/for-each-loop-not-looping-through-rows-with-repeating-ids", "title": "&#39;For Each&#39; loop not looping through rows with repeating ID&#39;s", "body": "<p>This is a part of a VBA macro that alters order information exported from an online shop to be later imported into a shipping manager.</p>\n\n<p>The code below is doing what it is meant to do which is replace the CRL1/2 with STL1/2 if the criteria is met. </p>\n\n<p>The issue arising is when a single order from the shop is split into separate rows with the same order number in column A for each row. The macro only processes the first of the rows with the same order number.</p>\n\n<pre><code>  Dim Cel7_Lastrow As Integer\n  Cel7_Lastrow = Sheet2.Cells(Rows.Count, 1).End(xlUp).Row\n  Dim Rng As Range\n  Set Rng = Sheet2.Range(\"A2:A\" &amp; Cel7_Lastrow)\n\n  For Each Cel7 In Rng\n      Dim Lookup_Range2 As Range\n\n      Country_Name = Cel7.Value2\n      C_Code = Cel7.Value2\n      Weight_V = Cel7.Value2\n\n      Set Lookup_Range2 = Sheet2.Range(\"A2:R\" &amp; Cel7_Lastrow)\n      Country = Application.WorksheetFunction.VLookup(Country_Name,Lookup_Range2, 8, False)\n      Code = Application.WorksheetFunction.VLookup(C_Code,Lookup_Range2, 13, False)\n      Weight = Application.WorksheetFunction.VLookup(Weight_V,Lookup_Range2, 18, False)\n\n      If Country = \"GB\" And Code = \"CRL1\" And Weight &lt;= 0.1 Then\n             Cel7.Offset(0, 12).Value = \"STL1\"\n      End If\n\n      If Country = \"GB\" And Code = \"CRL2\" And Weight &lt;= 0.1 Then\n             Cel7.Offset(0, 12).Value = \"STL2\"\n      End If        \n Next Cel7\n</code></pre>\n"}, {"tags": ["excel", "unique", "user-defined-functions", "vba"], "comments": [{"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1446640252, "post_id": 33521389, "comment_id": 54825076, "body": "I have not, the reason I&#39;m doing this is to break apart the dataset into smaller tables for upload into my access database -- the dataset it too large for access&#39; memory constraints to break internally. I imagine I would reach these limitations with a pivot table as well. They&#39;re the same limitations I reach when applying the formulaic approach across all 105 columns."}], "answers": [{"comments": [{"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1446641603, "post_id": 33521821, "comment_id": 54826012, "body": "Interestingly, and in hindsight intuitively, the duration of the calculation is based more heavily on the number of unique matches found as that nested iteration compounds the selection iteration so our UDFs perform very similarly when there&#39;s a small number of unique values, but your performs MUCH better when there are a large number of unique values -- Thank You!"}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": true, "score": 0, "last_activity_date": 1446639704, "creation_date": 1446639704, "answer_id": 33521821, "question_id": 33521389, "link": "https://stackoverflow.com/questions/33521389/unique-count-excel-vba-vs-formulas-faster-approach/33521821#33521821", "title": "Unique Count (Excel VBA vs Formulas) Faster Approach", "body": "<p>Try this</p>\n\n<pre><code>'Set a reference to MS Scripting runtime ('Microsoft Scripting Runtime')\nFunction UniqueCount(SelRange As Range)\n    Dim Rng As Range\n    Dim dict As New Scripting.Dictionary\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    For Each Rng In SelRange\n        If Not dict.Exists(Rng.Value) Then\n            dict.Add Rng.Value, 0\n        End If\n    Next Rng\n    UniqueCount = dict.Count\n    Set dict = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1446640498, "creation_date": 1446640498, "answer_id": 33522099, "question_id": 33521389, "link": "https://stackoverflow.com/questions/33521389/unique-count-excel-vba-vs-formulas-faster-approach/33522099#33522099", "title": "Unique Count (Excel VBA vs Formulas) Faster Approach", "body": "<p>I'd use an array as well as the Dictionary:</p>\n\n<pre><code>Public Function CountUnique(rngInput As Range) As Double\n    Dim rngCell               As Range\n    Dim dData                 As Object\n    Dim vData\n    Dim x                     As Long\n    Dim y                     As Long\n\n    Set dData = CreateObject(\"Scripting.Dictionary\")\n\n    vData = rngInput.Value2\n    For x = LBound(vData, 1) To UBound(vData, 1)\n        For y = LBound(vData, 2) To UBound(vData, 2)\n            If LenB(vData(x, y)) &lt;&gt; 0 Then dData(CStr(vData(x, y))) = Empty\n        Next y\n    Next x\n    CountUnique = dData.Count\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 33521821, "answer_count": 2, "score": 0, "last_activity_date": 1446640498, "creation_date": 1446638508, "last_edit_date": 1531161705, "question_id": 33521389, "link": "https://stackoverflow.com/questions/33521389/unique-count-excel-vba-vs-formulas-faster-approach", "title": "Unique Count (Excel VBA vs Formulas) Faster Approach", "body": "<p>32 Bit Excel 365 on 64 Bit Win7\nWorksheet 300600 Rows x 105 Columns\nGoal: Calculate the Number of Unique Entries in each Column</p>\n\n<p>Attempted Solution 1: Formula</p>\n\n<pre><code>{=SUM(1/COUNTIF(A8:A300600,A8:A300600))}\n</code></pre>\n\n<p>Issue: Long Runtime, Freezes Excel, Must Stop Calculation</p>\n\n<p>Attempted Solution 2: VBA UDF</p>\n\n<pre><code>Function UniqueCount(Selection As Range) As Integer\nDim UniqueArray()\nReDim UniqueArray(0 To Selection.Count)\nDim Rng As Range\nDim CUniqueCount As Integer\nCUniqueCount = 0\nFor Each Rng In Selection\n    For i = 0 To Selection.Count\n        If UniqueArray(i) = Rng.Value Then Exit For\n        If UniqueArray(i) = \"\" Then\n            UniqueArray(i) = Rng.Value\n            CUniqueCount = CUniqueCount + 1\n            Exit For\n        End If\n    Next i\nNext\nUniqueCount = CUniqueCount\nEnd Function\n</code></pre>\n\n<p>Note: This is Much faster, but I'm still looking for an even faster approach</p>\n"}, {"tags": ["excel", "vba", "filter", "module"], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 5520258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c29231299f2b1a31b78e2a36d982134?s=128&d=identicon&r=PG&f=1", "display_name": "andy01q", "link": "https://stackoverflow.com/users/5520258/andy01q"}, "is_accepted": false, "score": 0, "last_activity_date": 1446639080, "creation_date": 1446639080, "answer_id": 33521571, "question_id": 33520918, "link": "https://stackoverflow.com/questions/33520918/want-an-advanced-sort-filter-that-search-for-particular-combination-of-letters-i/33521571#33521571", "title": "Want an advanced sort filter that search for particular combination of letters in specific column irrespective of its post and pre letters", "body": "<p>How about you use a helper-column with the code =search($E$2,B2) in Cell D2, pull the formula down and filter for it's result? (Of course you can tinker with the formula to make it more pretty first.)</p>\n"}, {"comments": [{"owner": {"reputation": 319, "user_id": 1597345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6b322fa36dd281baa818e0a81d80146?s=128&d=identicon&r=PG", "display_name": "M Faizan Farooq", "link": "https://stackoverflow.com/users/1597345/m-faizan-farooq"}, "edited": false, "score": 0, "creation_date": 1446639582, "post_id": 33521579, "comment_id": 54824668, "body": "that works but on the same sheet it filter it out i want the option of &quot;color = red&quot;  in sheet1 and not in code like  Criteria1:=&quot;<i>red</i>&quot; and one more thing that the filtered data goes to sheet 2."}, {"owner": {"reputation": 319, "user_id": 1597345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6b322fa36dd281baa818e0a81d80146?s=128&d=identicon&r=PG", "display_name": "M Faizan Farooq", "link": "https://stackoverflow.com/users/1597345/m-faizan-farooq"}, "edited": false, "score": 0, "creation_date": 1446648942, "post_id": 33521579, "comment_id": 54831103, "body": "i want to shift criteria cells to sheet3 what to do now ? i made it like this Sheet3.Range(&quot;E1&quot;) it is working want to ask if it is right or not"}, {"owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "reply_to_user": {"reputation": 319, "user_id": 1597345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6b322fa36dd281baa818e0a81d80146?s=128&d=identicon&r=PG", "display_name": "M Faizan Farooq", "link": "https://stackoverflow.com/users/1597345/m-faizan-farooq"}, "edited": false, "score": 0, "creation_date": 1446649557, "post_id": 33521579, "comment_id": 54831585, "body": "it should be Sheets(3) - 3rd sheet in workbook or Sheets(&quot;Name&quot;) for refering to sheet name"}, {"owner": {"reputation": 319, "user_id": 1597345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6b322fa36dd281baa818e0a81d80146?s=128&d=identicon&r=PG", "display_name": "M Faizan Farooq", "link": "https://stackoverflow.com/users/1597345/m-faizan-farooq"}, "edited": false, "score": 0, "creation_date": 1446658544, "post_id": 33521579, "comment_id": 54838145, "body": "can you make it work for number combination as wll like 220 or 132 etc"}], "tags": [], "owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "is_accepted": true, "score": 2, "last_activity_date": 1446641115, "last_edit_date": 1446641115, "creation_date": 1446639113, "answer_id": 33521579, "question_id": 33520918, "link": "https://stackoverflow.com/questions/33520918/want-an-advanced-sort-filter-that-search-for-particular-combination-of-letters-i/33521579#33521579", "title": "Want an advanced sort filter that search for particular combination of letters in specific column irrespective of its post and pre letters", "body": "<p>try this little piece of code, basically what you are looking for is <code>Criteria1:=\"*red*\"</code></p>\n\n<pre><code>Sub filter\n  With Sheets(1)\n    LastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    .Range(\"A1:C1\").AutoFilter\n    .Range(\"A2:C\" &amp; LastRow).AutoFilter Field:=1, Criteria1:=\"*\" &amp; .Range(\"E1\") &amp; \"*\"\n    .Range(\"A2:C\" &amp; LastRow).AutoFilter Field:=2, Criteria1:=\"*\" &amp; .Range(\"E2\") &amp; \"*\"\n    .Range(\"A2:C\" &amp; LastRow).AutoFilter Field:=3, Criteria1:=\"*\" &amp; .Range(\"E3\") &amp; \"*\"\n    .Range(\"A1:C\" &amp; LastRow).Copy Sheets(2).Range(\"A1\")\n    .ShowAllData\n  End With\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>what you can do is use cells E1, E2, E3 as filter values for your columns 1,2,3 respectively. so if you want to filter \"kiwi\" in column 1, \"red\" in column 2 and \"Yes\" in column 3, put those values in E1-E3 and it will filter these 3 conditions. You can easily change destination, where you want paste your data.</p>\n"}], "owner": {"reputation": 319, "user_id": 1597345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6b322fa36dd281baa818e0a81d80146?s=128&d=identicon&r=PG", "display_name": "M Faizan Farooq", "link": "https://stackoverflow.com/users/1597345/m-faizan-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 33521579, "answer_count": 2, "score": 1, "last_activity_date": 1446641115, "creation_date": 1446637191, "last_edit_date": 1446638149, "question_id": 33520918, "link": "https://stackoverflow.com/questions/33520918/want-an-advanced-sort-filter-that-search-for-particular-combination-of-letters-i", "title": "Want an advanced sort filter that search for particular combination of letters in specific column irrespective of its post and pre letters", "body": "<p>Here is my data set\n<a href=\"https://i.stack.imgur.com/lbKq6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lbKq6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now I want all all rows having combination of red filter to my sheet2 irrespective of its pre and post letters. I want result like this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yrEbz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yrEbz.png\" alt=\"enter image description here\"></a></p>\n\n<p>But could only be able to acheive this using the code below.\n<a href=\"https://i.stack.imgur.com/PSmLR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PSmLR.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub FilterCopyToOtherSheet()\n'\n    Sheets(\"Sheet1\").Range(\"A1:C14\").AdvancedFilter _\n        Action:=xlFilterCopy, _\n        CriteriaRange:=Sheets(\"Sheet1\").Range(\"E1:E2\"), _\n        CopyToRange:=Sheets(\"Sheet2\").Range(\"A1\"), _\n        Unique:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1446637300, "post_id": 33520482, "comment_id": 54823173, "body": "Replace <code>Range(Range(r.Address), Range(r.Address).End(xlDown)).Copy         &#39;last_row = ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Cells(Row.Count, 1).End(xlUp).Row         LastLine = Range((&quot;B&quot; &amp; Rows.Count).End(xlUp).Row + 2).Select         LastLine.Paste</code> with <code>Range(Range(r.Address), Range(r.Address).End(xlDown)).Copy Cells(Rows.Count, &quot;B&quot;).End(xlUp).Offset(2)</code> all in one line."}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1446637972, "creation_date": 1446637972, "answer_id": 33521184, "question_id": 33520482, "link": "https://stackoverflow.com/questions/33520482/vba-get-address-for-last-empty-row-and-copy/33521184#33521184", "title": "VBA get address for last empty row and copy", "body": "<p>You have dimmed the rng as a variant and you should dim r as range as well</p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim rng As Range, r As Range\n\n    Set rng = Range(Range(\"C2\"), Range(\"C2\").End(xlToRight))\n\n    For Each r In rng.Cells\n        Range(Range(r.Address), Range(r.Address).End(xlDown)).Copy Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(2)\n    Next r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 519, "user_id": 5239781, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1165238156826039/picture?type=large", "display_name": "Nant", "link": "https://stackoverflow.com/users/5239781/nant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 33521184, "answer_count": 1, "score": 1, "last_activity_date": 1446637972, "creation_date": 1446635947, "last_edit_date": 1531164843, "question_id": 33520482, "link": "https://stackoverflow.com/questions/33520482/vba-get-address-for-last-empty-row-and-copy", "title": "VBA get address for last empty row and copy", "body": "<p>Hi I have a worksheet where the date is stored in columns, I want to write a macro which cuts the data and paste the data in row B. Please see picture attached. </p>\n\n<p>I have already written this code: </p>\n\n<pre><code>Sub test()\n\n    Dim rng, copy_paste_range As Range\n\n\n    Set rng = Range(Range(\"C2\"), Range(\"C2\").End(xlToRight))\n\n    For Each r In rng\n\n        Range(Range(r.Address), Range(r.Address).End(xlDown)).Copy\n        'last_row = ThisWorkbook.Worksheets(\"Sheet1\").Cells(Row.Count, 1).End(xlUp).Row\n        LastLine = Range((\"B\" &amp; Rows.Count).End(xlUp).Row + 2).Select\n        LastLine.Paste\n\n    Next r\n\nEnd Sub\n</code></pre>\n\n<p>However I always want to leave 1 row empty when I copy the data from every column but I always get an error for: </p>\n\n<pre><code>LastLine = Range((\"B\" &amp; Rows.Count).End(xlUp).Row + 2).Select\n            LastLine.Paste\n</code></pre>\n\n<p>Can anyone assist ? If you look in the picture I am trying to cut-copythe data from C2:C5 and past it to <a href=\"https://i.stack.imgur.com/YEMaI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YEMaI.png\" alt=\"enter image description here\"></a>B12:B15</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1446634091, "post_id": 33519596, "comment_id": 54821044, "body": "It&#39;s not clear in the original question if altering the cell&#39;s formula is what they actually want.  I&#39;d say that that was a bad idea - what happens when the predicate cells no longer give a zero value?"}, {"owner": {"reputation": 63, "user_id": 3619789, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/a2c5d3c497a1c38958432be6a39cdce0?s=128&d=identicon&r=PG&f=1", "display_name": "user3619789", "link": "https://stackoverflow.com/users/3619789/user3619789"}, "edited": false, "score": 0, "creation_date": 1446634097, "post_id": 33519596, "comment_id": 54821050, "body": "Thanks, that really helped me. Still I will try to make the vba code. Even if it is more complex it&#39;s awesome"}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 1, "last_activity_date": 1446648378, "last_edit_date": 1446648378, "creation_date": 1446633337, "answer_id": 33519596, "question_id": 33519538, "link": "https://stackoverflow.com/questions/33519538/excel-macro-if-replace-formula/33519596#33519596", "title": "Excel Macro IF replace formula", "body": "<p>Give this link a view:\n<a href=\"http://www.techrepublic.com/blog/microsoft-office/three-ways-to-hide-zero-values-in-an-excel-sheet/\" rel=\"nofollow\">Three ways to hide zero values</a></p>\n\n<p>I'd still strongly recommend going down the cell formatting route:</p>\n\n<pre><code>Sub apply_Error_Control()\n    Dim rngCurrent As Range\n\n    If TypeName(Selection) = \"Range\" Then\n        Set rngCurrent = Selection.SpecialCells(xlCellTypeFormulas)\n        rngCurrent.NumberFormat = \"0;-0;;@\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>But if you insist on the formula-based approach, please at least employ the method I've outlined so that you avoid running the code on (for example) an embedded chart or button and you'll immediately hit those cells with a formula - looping through to find those with a formula is tedious and slow.</p>\n"}, {"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1446635587, "post_id": 33519798, "comment_id": 54822046, "body": "The <code>Formula</code> property needs commas rather than semicolons."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1446637021, "post_id": 33519798, "comment_id": 54822986, "body": "Only first <code>&quot;=&quot;</code> should be replaced."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1447188176, "last_edit_date": 1447188176, "creation_date": 1446633915, "answer_id": 33519798, "question_id": 33519538, "link": "https://stackoverflow.com/questions/33519538/excel-macro-if-replace-formula/33519798#33519798", "title": "Excel Macro IF replace formula", "body": "<p>Give this a try (note the <code>Selection.Cells</code> so it'll only work in the Range that you selected manually) :</p>\n\n<pre><code>Sub apply_Error_Control()\n    Dim cel As Range, _\n        RangeInForumla As String\n\n    For Each cel In Selection.Cells\n        If cel.HasFormula Then\n            RangeInForumla = Replace(cel.Formula, \"=\", \"\",1,1)\n            cel.Formula = \"=IF(\" &amp; RangeInForumla &amp; \"=0,\" &amp; Chr(34) &amp; Chr(34) &amp; \",\" &amp; RangeInForumla &amp; \")\"\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 3619789, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/a2c5d3c497a1c38958432be6a39cdce0?s=128&d=identicon&r=PG&f=1", "display_name": "user3619789", "link": "https://stackoverflow.com/users/3619789/user3619789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447188176, "creation_date": 1446633182, "last_edit_date": 1446633952, "question_id": 33519538, "link": "https://stackoverflow.com/questions/33519538/excel-macro-if-replace-formula", "title": "Excel Macro IF replace formula", "body": "<p>I am trying to replace the value in a cell so if it has 0 to hide it. </p>\n\n<p>The excel formula is the following <code>IF(A1=0;\"\";A1)</code>. </p>\n\n<p>I am trying to this automaticaly but I am having problems.</p>\n\n<hr>\n\n<p>So far I came up with this: </p>\n\n<pre><code>Sub apply_Error_Control()\n    Dim cel As Range\n\n    For Each cel In Selection\n        If cel.HasFormula Then\n\n            cel.Formula = Replace(cel.Formula, \"=\", \"=IFF(\") &amp; \"=0\" &amp; \";\" &amp; \"\")\"\n\n        End If\n    Next cel\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "if-statement", "excel-formula", "worksheet-function", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5520601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310adf81f783101d74873e942a2e12ce?s=128&d=identicon&r=PG", "display_name": "tualinda", "link": "https://stackoverflow.com/users/5520601/tualinda"}, "edited": false, "score": 1, "creation_date": 1446637512, "post_id": 33520380, "comment_id": 54823290, "body": "I shall try and use this method, although my &quot;blocks&quot; will be 20 cells wide, so I will have to merge them later to make the table more readable. If anyone knows an easier method, please share, but this will do for now. Thank you!"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 0, "last_activity_date": 1446635682, "creation_date": 1446635682, "answer_id": 33520380, "question_id": 33519183, "link": "https://stackoverflow.com/questions/33519183/comparing-values-within-a-row/33520380#33520380", "title": "Comparing values within a row", "body": "<p>This is quite easy if you are prepared to deal with <code>Common</code>/<code>Removed</code>/<code>Added</code> as blocks of the same size each as <code>Before</code> and <code>After</code>:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/jXEt4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jXEt4.jpg\" alt=\"SO33519183 example\"></a>  </p>\n\n<p>In G2:</p>\n\n<pre><code>=IF(ISERROR(MATCH(A2,$D2:$F2,0)),\"\",A2)  \n</code></pre>\n\n<p>In J2:  </p>\n\n<pre><code>=IF(ISERROR(MATCH(A2,$D2:$F2,0)),A2,\"\")  \n</code></pre>\n\n<p>In M2:  </p>\n\n<pre><code>=IF(ISERROR(MATCH(D2,$A2:$C2,0)),D2,\"\")  \n</code></pre>\n\n<p>With each copied two cells to the right and then all copied down to suit. </p>\n"}], "owner": {"reputation": 13, "user_id": 5520601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310adf81f783101d74873e942a2e12ce?s=128&d=identicon&r=PG", "display_name": "tualinda", "link": "https://stackoverflow.com/users/5520601/tualinda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 33520380, "answer_count": 1, "score": 0, "last_activity_date": 1450172497, "creation_date": 1446632234, "last_edit_date": 1531161705, "question_id": 33519183, "link": "https://stackoverflow.com/questions/33519183/comparing-values-within-a-row", "title": "Comparing values within a row", "body": "<p>I have a table in Excel with a large amount of rows containing data from before and after a certain procedure. I want to compare the values in each row, so that:</p>\n\n<ul>\n<li>I see the values that stayed before and after the procedure</li>\n<li>I see the values removed during the procedure (aka the values that were there before)</li>\n<li>I see the values added during the procedure (aka the values that weren't there before)</li>\n</ul>\n\n<p>So, in the end, I would have a table like this:</p>\n\n<pre><code>Before                  After                   Common          Removed         Added\nMax     Marie   Peter   Eve     Peter   Marie   Marie, Peter    Max             Eve\nPaul    Sarah   Marie   Sarah   Marie   Max     Sarah, Marie    Paul            Max\nPeter   Lucas   Marie   Sarah   Lucas   Chris   Lucas           Peter, Marie    Sarah, Chris\n</code></pre>\n\n<p>What is the most effective way to achieve this?<br>\nIs there a good function for this, or should a macro be created?</p>\n"}, {"tags": ["vba", "ms-word", "ibm-doors"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1446643662, "post_id": 33518906, "comment_id": 54827339, "body": "Is the property name &quot;Autor&quot; or &quot;Author&quot;? There is a BuiltinDocumentProperty named Author and if that&#39;s the one you want then you need to correct both the spelling and the property name you&#39;re using. If the property is, indeed, Autor then you need to make sure it&#39;s pre-defined in the template, under the Custom Properties tab in the Word UI&#39;s Document Properties dialog box."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1446643668, "post_id": 33518906, "comment_id": 54827345, "body": "Note that the actual property name &quot;Author&quot; is used even if the UI of your environment displays a different name as the translation of the English &quot;Author&quot;. A BuiltinDocumentProperty is one that displays on any tab other than the Custom Properties tab."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "is_accepted": false, "score": 0, "last_activity_date": 1446633512, "creation_date": 1446633512, "answer_id": 33519670, "question_id": 33518906, "link": "https://stackoverflow.com/questions/33518906/updating-custom-properties-when-exporting-data-from-dxl-doors-to-word-using-temp/33519670#33519670", "title": "Updating custom properties when exporting data from DXL DOORS to Word using template containing VBA macros", "body": "<p>I found the solution in the Word Object model. Read the section for the \"Remarks\"\nhere <a href=\"https://msdn.microsoft.com/EN-US/library/ff195603.aspx\" rel=\"nofollow\">Document.CustomDocumentProperties Property (Word)</a></p>\n\n<p>Use this code.</p>\n\n<pre><code>Sub macro_name(text As String)\n\n    Dim sPropName As String\n\n    sPropName = \"Autor\"\n    ActiveDocument.BuiltInDocumentProperties(sPropName).Value = text\n\nEnd Sub\n</code></pre>\n\n<p>Hope this helps :)</p>\n"}], "owner": {"reputation": 1, "user_id": 5524089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PIOdvQ0KR1w/AAAAAAAAAAI/AAAAAAAACN8/jIoeFxatjmk/photo.jpg?sz=128", "display_name": "Jayant", "link": "https://stackoverflow.com/users/5524089/jayant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 716, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1446633512, "creation_date": 1446631499, "question_id": 33518906, "link": "https://stackoverflow.com/questions/33518906/updating-custom-properties-when-exporting-data-from-dxl-doors-to-word-using-temp", "title": "Updating custom properties when exporting data from DXL DOORS to Word using template containing VBA macros", "body": "<p>I am writing a DXL script that would export data from IBM Rational DOORS to MS Word. I am using a template (.docm) using which the export happens and I have written macros in the template which will be used by DXL during execution. </p>\n\n<p>I am facing a problem when updating the Document properties (Custom). I am using the below code, but the document properties are not being updated.</p>\n\n<p>Sub macro_name(text As String)</p>\n\n<p>Dim sPropName As String</p>\n\n<p>sPropName = \"Autor\"</p>\n\n<p>ActiveDocument.CustomDocumentProperties(sPropName).Value = text</p>\n\n<p>End Sub </p>\n\n<p>Could anyone please advice. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1446632615, "post_id": 33518427, "comment_id": 54820100, "body": "Are your regional settings the same as your client&#39;s? Setting page fields with date values is extremely tricky in non US regions."}, {"owner": {"reputation": 51, "user_id": 5497774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039024d24b5ea0da45e381c3770f13c7?s=128&d=identicon&r=PG&f=1", "display_name": "May Ann", "link": "https://stackoverflow.com/users/5497774/may-ann"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1446647312, "post_id": 33518427, "comment_id": 54829868, "body": "No, they are different.  Mine uses US date system (mm/dd/yyyy) and the client uses Europe date system (dd/mm/yyyy). But I checked that the filter contains the same date string, for example &quot;11/2/2015&quot; is the latest date, &quot;11/2/2015&quot; is also on the list of available values on the filter. Or the excel on my client&#39;s PC interpret it as &quot;2/11/2015&quot;?"}, {"owner": {"reputation": 51, "user_id": 5497774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039024d24b5ea0da45e381c3770f13c7?s=128&d=identicon&r=PG&f=1", "display_name": "May Ann", "link": "https://stackoverflow.com/users/5497774/may-ann"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447332447, "post_id": 33518427, "comment_id": 55116232, "body": "We have changed the date format of the client&#39;s PC to the US date system (mm/dd/yyyy). The error is still there. Do you have ideas on this?"}, {"owner": {"reputation": 51, "user_id": 5497774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039024d24b5ea0da45e381c3770f13c7?s=128&d=identicon&r=PG&f=1", "display_name": "May Ann", "link": "https://stackoverflow.com/users/5497774/may-ann"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1448617040, "post_id": 33518427, "comment_id": 55666480, "body": "I was able to solve this by just upgrading the Excel on the client&#39;s PC to Excel 2010. Though I still have no idea why it does not work on Excel 2007."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 5497774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039024d24b5ea0da45e381c3770f13c7?s=128&d=identicon&r=PG&f=1", "display_name": "May Ann", "link": "https://stackoverflow.com/users/5497774/may-ann"}, "is_accepted": true, "score": 0, "last_activity_date": 1448617066, "creation_date": 1448617066, "answer_id": 33954375, "question_id": 33518427, "link": "https://stackoverflow.com/questions/33518427/unable-to-update-a-pivot-filter-vba-ms-excel-2007/33954375#33954375", "title": "Unable to update a Pivot filter VBA MS Excel 2007", "body": "<p>I was able to solve this by just upgrading the Excel on the client's PC to Excel 2010. Though I still have no idea why it does not work on Excel 2007.</p>\n"}], "owner": {"reputation": 51, "user_id": 5497774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039024d24b5ea0da45e381c3770f13c7?s=128&d=identicon&r=PG&f=1", "display_name": "May Ann", "link": "https://stackoverflow.com/users/5497774/may-ann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 33954375, "answer_count": 1, "score": 0, "last_activity_date": 1448617340, "creation_date": 1446630214, "last_edit_date": 1531164843, "question_id": 33518427, "link": "https://stackoverflow.com/questions/33518427/unable-to-update-a-pivot-filter-vba-ms-excel-2007", "title": "Unable to update a Pivot filter VBA MS Excel 2007", "body": "<p>I am having a problem with updating a pivot filter progmatically in VBA.  What I want to do is filter the pivot with the latest date on my recordset (I am getting my data from a Jet database). I have tried the code below for MS Excel 2010 and works fine. I also have tried this on an Excel 2007 on one of our computers and works fine as well. However, when I deployed it on my clients PC, it returns an \"Error 1004: Application defined or object defined error\" on the last line of the code below.  The odd thing is my client has Excel 2007.. </p>\n\n<p>Do you guys have an idea why this is happening?</p>\n\n<pre><code>        ActiveSheet.PivotTables(sPivotName).PivotFields(sPivotField).CurrentPage = \"(All)\"\n        ActiveSheet.PivotTables(sPivotName).PivotFields(sPivotField).ClearAllFilters\n        ActiveSheet.PivotTables(sPivotName).PivotFields(sPivotField).CurrentPage = CStr(rsDate(\"MaxValue\"))\n</code></pre>\n"}, {"tags": ["vba", "excel", "events", "event-handling"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1446628735, "post_id": 33517521, "comment_id": 54817647, "body": "Do you mean you want to raise an event when the user unhides a row/column, or when the code you posted actually unhides something?"}, {"owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1446628761, "post_id": 33517521, "comment_id": 54817668, "body": "When the code unhides something."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1446628866, "post_id": 33517521, "comment_id": 54817732, "body": "You can create custom events in VBA too, take a look a CPearson article about events : <a href=\"http://www.cpearson.com/excel/Events.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/Events.aspx</a>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1446629118, "post_id": 33517521, "comment_id": 54817908, "body": "Since unhiding initiated from your code, than it&#39;s easier just check the number of hidden rows and columns, and if any then unhide and show message"}], "answers": [{"comments": [{"owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "edited": false, "score": 0, "creation_date": 1446629721, "post_id": 33517982, "comment_id": 54818271, "body": "thanks for your answer. doese this code run on your maschine? I created a new WB and hid a column but I get an Overflow Error in lVisColCount = .Rows(1).SpecialCells(xlCellTypeVisible).Count. Do you know why that is?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "edited": false, "score": 0, "creation_date": 1446631128, "post_id": 33517982, "comment_id": 54819143, "body": "Did you put any data in it?"}, {"owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "edited": false, "score": 0, "creation_date": 1446631469, "post_id": 33517982, "comment_id": 54819354, "body": "That was it. Thanks a lot!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1446628981, "creation_date": 1446628981, "answer_id": 33517982, "question_id": 33517521, "link": "https://stackoverflow.com/questions/33517521/how-to-fire-on-unhiding-rows-or-columns/33517982#33517982", "title": "How to fire on unhiding rows or columns", "body": "<p>Something like this should do it:</p>\n\n<pre><code>Sub ReInvisible()\n    Dim lVisColCount          As Long\n    Dim lVisRowCount          As Long\n    With ThisWorkbook.Worksheets(1).UsedRange\n        lVisColCount = .Rows(1).SpecialCells(xlCellTypeVisible).Count\n        lVisRowCount = .Columns(1).SpecialCells(xlCellTypeVisible).Count\n        .EntireRow.Hidden = False\n        .EntireColumn.Hidden = False\n        If .Rows(1).SpecialCells(xlCellTypeVisible).Count &lt;&gt; lVisColCount Then MsgBox \"Columns unhidden\"\n        If .Columns(1).SpecialCells(xlCellTypeVisible).Count &lt;&gt; lVisRowCount Then MsgBox \"Rows unhidden\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 1, "accepted_answer_id": 33517982, "answer_count": 1, "score": 1, "last_activity_date": 1446628981, "creation_date": 1446627493, "last_edit_date": 1531164843, "question_id": 33517521, "link": "https://stackoverflow.com/questions/33517521/how-to-fire-on-unhiding-rows-or-columns", "title": "How to fire on unhiding rows or columns", "body": "<p>Some users hide columns/rows and forget to unhide them before saving a workbook. I want to catch that with unhide all columns/rows on the save event with</p>\n\n<pre><code>Sub ReInvisible()\n    ThisWorkbook.Worksheets(1).UsedRange.EntireRow.Hidden = False\n    ThisWorkbook.Worksheets(1).UsedRange.EntireColumn.Hidden = False\nEnd Sub\n</code></pre>\n\n<p>this works fine but I would like to inform the user that all hidden columns/rows are now visible. Now I am looking for a way to trigger on unhiding a column/row so as soon as at least one column or row is made visible I want to fire a messagebox. </p>\n\n<p>In <code>VB.NET</code> I would try to write my own <code>event</code> but in <code>VBA</code> I do not know how I can do a workaround. Does anyone have an idea?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1446628199, "last_edit_date": 1446628199, "creation_date": 1446627686, "answer_id": 33517583, "question_id": 33517477, "link": "https://stackoverflow.com/questions/33517477/refer-to-range-in-another-file/33517583#33517583", "title": "Refer to range in another file", "body": "<p>To reference a range in another workbook, include the Workbook object and then the Range object:</p>\n\n<pre><code>Workbooks(\"Bla.xlsx\").Worksheets(\"Sheet1\").Range(\"A1\")\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>Option Explicit\nSub Test()\n    Dim FilePath As String\n    '// File Path\n    FilePath = Environ(\"USERPROFILE\") &amp; \"\\Documents\\\"\n\n    With Range(\"B1:B2\")\n        .Formula = \"='\" &amp; FilePath &amp; \"[Bla.xlsx]Sheet1'!A1:A2\"\n        .Value = .Value\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "is_accepted": false, "score": 1, "last_activity_date": 1446628002, "creation_date": 1446628002, "answer_id": 33517672, "question_id": 33517477, "link": "https://stackoverflow.com/questions/33517477/refer-to-range-in-another-file/33517672#33517672", "title": "Refer to range in another file", "body": "<p>you should use :</p>\n\n<pre><code>Workbooks(\"Book1\").Range(\"A1\").Value = Workbooks(\"Book2\").Range(\"A1\").Value\n</code></pre>\n\n<p>or if you like your approach, then (if it's open)</p>\n\n<pre><code>ActiveCell.Value = \"=('[Workbook1.xls]Sheet1'!$A$1)\"\n</code></pre>\n\n<p>and in case it is closed, then use full path refference :</p>\n\n<pre><code>ActiveCell.Value = \"=('C:\\Users\\username\\Desktop\\[Workbook1.xls]Sheet1'!$A$1)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 5520258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c29231299f2b1a31b78e2a36d982134?s=128&d=identicon&r=PG&f=1", "display_name": "andy01q", "link": "https://stackoverflow.com/users/5520258/andy01q"}, "is_accepted": false, "score": 0, "last_activity_date": 1446631555, "creation_date": 1446631555, "answer_id": 33518924, "question_id": 33517477, "link": "https://stackoverflow.com/questions/33517477/refer-to-range-in-another-file/33518924#33518924", "title": "Refer to range in another file", "body": "<p>.activate is for workbooks and worksheets.</p>\n\n<pre><code>Range(\"b5\").Select\nActiveCell.Value = '[jobpl1.xlsx]Sheet1'!E16\n</code></pre>\n\n<p>should work, but you should only select cells if you want to take the user to that place, never to do anything with that cell. (Because selecting cells wastes processing time.)\nInstead asign the value directly to the cell in question:</p>\n\n<pre><code>Range(\"b5\").value = \"=('[Workbook1.xls]Sheet1'!$A$1)\"\n</code></pre>\n\n<p>or use a range-variable instead.</p>\n\n<pre><code>dim temprange as range\n\nset temprange = Range(\"B5\")\ntamprange.value =  \"=('[Workbook1.xls]Sheet1'!$A$1)\"\n</code></pre>\n\n<p>also if you want to asign a formula to a cell I suggest using .formula instead of .value which in this case likely won't matter, but when you read the contents of a cell it will matter and it will also matter if you write to the cell and the code is used on an Excel-Sheet with another country-setting. (.formula automatically recognizes language settings and converts , and . and the like.)</p>\n"}], "owner": {"reputation": 1, "user_id": 5523185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23b11e109f52e6fede3a65cd43833a66?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh", "link": "https://stackoverflow.com/users/5523185/leigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14587, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1446631555, "creation_date": 1446627376, "last_edit_date": 1446628672, "question_id": 33517477, "link": "https://stackoverflow.com/questions/33517477/refer-to-range-in-another-file", "title": "Refer to range in another file", "body": "<p>I have a macro in an open Excel file and want to refer to a cell in another open Excel file.</p>\n\n<pre><code>Range(\"b5\").Activate\nActiveCell.Value = '[jobpl1.xlsx]Sheet1'!E16\n</code></pre>\n\n<p>It fails to compile.  </p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 28006, "user_id": 960828, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5dbfc386f986b9d600324cd02dae266d?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/960828/alex-d"}, "edited": false, "score": 0, "creation_date": 1446629308, "post_id": 33517925, "comment_id": 54818028, "body": "Hmm. Then, what is the use of dynamically assigning an event handler? If <code>mfrmForm.onUnload</code> can <b>only</b> be set to <code>Form_mfrmForm.FormUnload</code>, why set it at all in VBA code?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 28006, "user_id": 960828, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5dbfc386f986b9d600324cd02dae266d?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/960828/alex-d"}, "edited": false, "score": 0, "creation_date": 1446630383, "post_id": 33517925, "comment_id": 54818664, "body": "I have no idea. It is rather unusual to do that. It may be completely superfluous. A remote possibility: under some conditions the setting is <code>=SomeFunction()</code> and under other conditions it is set to <code>=[Event Procedure]</code>. But that would be quite hackish. @AlexD"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 28006, "user_id": 960828, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5dbfc386f986b9d600324cd02dae266d?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/960828/alex-d"}, "edited": false, "score": 0, "creation_date": 1446632088, "post_id": 33517925, "comment_id": 54819757, "body": "It may be a relic. If you e.g. cut and paste a control from a form to a tab control on the form, the <code>[Event Procedure]</code> setting for event handlers gets lost. Maybe someone wanted to make sure this never happens again. Or so. @AlexD"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1446628827, "creation_date": 1446628827, "answer_id": 33517925, "question_id": 33517100, "link": "https://stackoverflow.com/questions/33517100/how-to-tell-what-event-procedure-refers-to-in-vba-code/33517925#33517925", "title": "How to tell what &quot;[Event Procedure]&quot; refers to in VBA code?", "body": "<p>The code is in the class module of the form, i.e. <code>Form_mfrmForm</code>.</p>\n\n<p>The procedure is called:</p>\n\n<pre><code>Private Sub Form_Unload(Cancel As Integer)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "is_accepted": false, "score": 1, "last_activity_date": 1446669133, "creation_date": 1446669133, "answer_id": 33531445, "question_id": 33517100, "link": "https://stackoverflow.com/questions/33517100/how-to-tell-what-event-procedure-refers-to-in-vba-code/33531445#33531445", "title": "How to tell what &quot;[Event Procedure]&quot; refers to in VBA code?", "body": "<p>To the best of my understanding the <code>[Event Procedure]</code> declaration for the <code>OnUnload</code> property is a flag for Access to know there is a VBA coded event handler defined in the code module for that object. Since you are also able to specify a <code>macro</code> or <code>expression</code> the <code>[Event Procedure]</code> flag is used for VBA coded events.</p>\n\n<p>Lets say you create the handler in the code module for <code>Form_Unload</code> event manually, and the <code>OnUnload</code> property is left blank. Since the <code>[Event Procedure]</code> declaration is not defined, the event will not be triggered when the form is unloaded.</p>\n"}], "owner": {"reputation": 28006, "user_id": 960828, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5dbfc386f986b9d600324cd02dae266d?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/960828/alex-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594643286, "creation_date": 1446626051, "last_edit_date": 1594643286, "question_id": 33517100, "link": "https://stackoverflow.com/questions/33517100/how-to-tell-what-event-procedure-refers-to-in-vba-code", "title": "How to tell what &quot;[Event Procedure]&quot; refers to in VBA code?", "body": "<p>I'm just reading some VBA code which sets event handlers on controls like this:</p>\n\n<pre><code>mfrmForm.OnUnload = \"[Event Procedure]\"\n</code></pre>\n\n<p>How am I supposed to tell which function/method is being assigned, and where its implementation is located?</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5523621, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ZcGoon2Knk/AAAAAAAAAAI/AAAAAAAAAOo/CUGyPNi9HYQ/photo.jpg?sz=128", "display_name": "Panayotova", "link": "https://stackoverflow.com/users/5523621/panayotova"}, "edited": false, "score": 0, "creation_date": 1446626329, "post_id": 33516943, "comment_id": 54816176, "body": "It does not work - the code works, but the colour of the cells does not change at all in power point. Thank you!"}], "tags": [], "owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "is_accepted": false, "score": 0, "last_activity_date": 1446625451, "creation_date": 1446625451, "answer_id": 33516943, "question_id": 33516654, "link": "https://stackoverflow.com/questions/33516654/change-colour-of-specific-values-in-table-in-powerpoint/33516943#33516943", "title": "Change colour of specific values in table in PowerPoint", "body": "<p>Try this:</p>\n\n<pre><code>Sub RangeTransferToTable102()\n '\n ' Copy each data cell in Excel range to the PowerPoint Slide 46 Shape 102 Table\n '\n Dim pptApp As PowerPoint.Application\n Dim oPPTShape As PowerPoint.Shape\n Dim rng As Excel.Range\n Dim frmt As Variant\n '\n ' Set oPPP to PowerPoint by creating a new instance of PowerPoint.\n ' If PowerPoint is already open, you would instead use the GetObject\n ' method instead.\n '\n Set pptApp = GetObject(, \"PowerPoint.Application\")\n '\n ' Set PowerPoint to be Visible.\n '\n pptApp.Visible = msoTrue\n pptApp.ActivePresentation.Slides(\"Slide310\").Select\n pptApp.Activate\n Worksheets(\"Switch_CS\").Activate\n Set rng = Range(\"GR2:GV11\")\n\n For rw = 1 To 10\n For cl = 1 To 5\n Data = rng.Cells(rw, cl).Value\n\n If Not (IsEmpty(rng.Cells(rw, cl))) Then\n If IsNumeric(rng.Cells(rw, cl)) Then 'Convert numeric value to text using number format\n\n If rng.Cells(rw, cl).value &gt;= 0 Then\n rng.Cells(rw, cl).Font.Color = -11489280\n Else\n rng.Cells(rw, cl).Font.Color = -16776961\n End If\n\n frmt = rng.Cells(rw, cl).NumberFormat\n Data = WorksheetFunction.Text(rng.Cells(rw, cl).Value, frmt)\n End If\n Else\n Data = rng.Cells(rw, cl).Value\n End If\n With pptApp.ActivePresentation.Slides(\"Slide310\").Shapes(\"Table 102\").table.cell(rw + 1, cl)\n .Shape.TextFrame.TextRange.Delete\n .Shape.TextFrame.TextRange.Text = Data\n End With\n Next cl\n Next rw\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5523621, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ZcGoon2Knk/AAAAAAAAAAI/AAAAAAAAAOo/CUGyPNi9HYQ/photo.jpg?sz=128", "display_name": "Panayotova", "link": "https://stackoverflow.com/users/5523621/panayotova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 758, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446626441, "creation_date": 1446624402, "last_edit_date": 1446626441, "question_id": 33516654, "link": "https://stackoverflow.com/questions/33516654/change-colour-of-specific-values-in-table-in-powerpoint", "title": "Change colour of specific values in table in PowerPoint", "body": "<p>I have a table in PowerPoint, that is generated from a macro code using VBA. I want to change the colour of the negative numbers to red, and the colour of the positive ones to green(the values that need to change their colour are in the third column). The code that generates the table and puts all numbers into the exact rows and columns is the following: </p>\n\n<pre><code>Sub RangeTransferToTable102()\n '\n ' Copy each data cell in Excel range to the PowerPoint Slide 46 Shape 102 Table\n '\n Dim pptApp As PowerPoint.Application\n Dim oPPTShape As PowerPoint.Shape\n Dim rng As Excel.Range\n Dim frmt As Variant\n '\n ' Set oPPP to PowerPoint by creating a new instance of PowerPoint.\n ' If PowerPoint is already open, you would instead use the GetObject\n ' method instead.\n '\n Set pptApp = GetObject(, \"PowerPoint.Application\")\n '\n ' Set PowerPoint to be Visible.\n '\npptApp.Visible = msoTrue\n pptApp.ActivePresentation.Slides(\"Slide310\").Select\n pptApp.Activate\n Worksheets(\"Switch_CS\").Activate\n Set rng = Range(\"GR2:GV11\")\n\n For rw = 1 To 10\n For cl = 1 To 5\n Data = rng.Cells(rw, cl).Value\n\n If Not (IsEmpty(rng.Cells(rw, cl))) Then\n If IsNumeric(rng.Cells(rw, cl)) Then 'Convert numeric value to text using number format\n frmt = rng.Cells(rw, cl).NumberFormat\n Data = WorksheetFunction.Text(rng.Cells(rw, cl).Value, frmt)\n End If\n Else\n Data = rng.Cells(rw, cl).Value\n End If\n With pptApp.ActivePresentation.Slides(\"Slide310\").Shapes(\"Table 102\").table.cell(rw + 1, cl)\n .Shape.TextFrame.TextRange.Delete\n .Shape.TextFrame.TextRange.Text = Data\n End With\n Next cl\n Next rw\n\n End Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "winhttp"], "comments": [{"owner": {"reputation": 613, "user_id": 2213887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U44UC.png?s=128&g=1", "display_name": "Hugues Paquet Blanchette", "link": "https://stackoverflow.com/users/2213887/hugues-paquet-blanchette"}, "edited": false, "score": 0, "creation_date": 1446645629, "post_id": 33515352, "comment_id": 54828649, "body": "Take a look at this post: <a href=\"http://stackoverflow.com/questions/17877389/how-do-i-download-a-file-using-vba-without-internet-explorer\" title=\"how do i download a file using vba without internet explorer\">stackoverflow.com/questions/17877389/&hellip;</a>"}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "reply_to_user": {"reputation": 613, "user_id": 2213887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U44UC.png?s=128&g=1", "display_name": "Hugues Paquet Blanchette", "link": "https://stackoverflow.com/users/2213887/hugues-paquet-blanchette"}, "edited": false, "score": 1, "creation_date": 1446700936, "post_id": 33515352, "comment_id": 54855433, "body": "Thaks @HuguesPaquetBlanchette. Problem is My link is not directly downloading the file. I need to crawl withing HTML to find link to PDF."}, {"owner": {"reputation": 613, "user_id": 2213887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U44UC.png?s=128&g=1", "display_name": "Hugues Paquet Blanchette", "link": "https://stackoverflow.com/users/2213887/hugues-paquet-blanchette"}, "edited": false, "score": 0, "creation_date": 1446730324, "post_id": 33515352, "comment_id": 54871406, "body": "XMLHTTP object will give you all http codes inside web page, where you can find link to the file and download it. Inside the response, after dynamically calling url,you can search for &quot;&lt;embed src&quot;http://...&quot; as in a string. If you fond it, download it. Hope this help. -Hugues"}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "reply_to_user": {"reputation": 613, "user_id": 2213887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U44UC.png?s=128&g=1", "display_name": "Hugues Paquet Blanchette", "link": "https://stackoverflow.com/users/2213887/hugues-paquet-blanchette"}, "edited": false, "score": 1, "creation_date": 1446807790, "post_id": 33515352, "comment_id": 54908604, "body": "@HuguesPaquetBlanchette: I am new to Programming. I will try and post the answer if succed. Thanks for your help."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4670366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/35p7G.png?s=128&g=1", "display_name": "Pushpak", "link": "https://stackoverflow.com/users/4670366/pushpak"}, "edited": false, "score": 0, "creation_date": 1489586059, "post_id": 34062426, "comment_id": 72735619, "body": "hi rahul can we have word? reach me at 9867711779"}], "tags": [], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "is_accepted": true, "score": 0, "last_activity_date": 1449135488, "creation_date": 1449135488, "answer_id": 34062426, "question_id": 33515352, "link": "https://stackoverflow.com/questions/33515352/download-embeded-pdf-file-using-vba/34062426#34062426", "title": "Download Embeded PDF file using VBA", "body": "<p>This worked finally.</p>\n\n<pre><code>HttpReq.Open \"GET\", myURL, False\nHttpReq.send\nStrTxt = HttpReq.responseText\ni = InStr(StrTxt, \"http://pimg-faiw.uspto.gov/fdd\")\nIf i &gt; 0 Then\nStrTxt = Mid(StrTxt, i, Len(StrTxt) - i)\ni = InStr(StrTxt, \".pdf\")\nIf i &gt; 0 Then\nmyURL = Left(StrTxt, i + 3)\nWinHttpReq.Open \"GET\", myURL, False\nWinHttpReq.send\nmyURL = WinHttpReq.responseBody\nIf WinHttpReq.Status = 200 Then\n    Set oStream = CreateObject(\"ADODB.Stream\")\n    oStream.Open\n    oStream.Type = 1\n    oStream.Write WinHttpReq.responseBody\n    oStream.SaveToFile \"C:\\file.Pdf\", 2\n    oStream.Close\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 1, "accepted_answer_id": 34062426, "answer_count": 1, "score": 1, "last_activity_date": 1449135488, "creation_date": 1446619647, "last_edit_date": 1446700854, "question_id": 33515352, "link": "https://stackoverflow.com/questions/33515352/download-embeded-pdf-file-using-vba", "title": "Download Embeded PDF file using VBA", "body": "<p>I have word document containing hyperlinked text.\nI want to go to that page and check if there is any embedded pdf.\nIf there is I want to download the PDF</p>\n\n<p>Hyperlink looks like this</p>\n\n<p><a href=\"http://pdfaiw.uspto.gov/.aiw?PageNum=0&amp;docid=20150299141&amp;homeurl=http%5C%5Cappft.uspto.gov\" rel=\"nofollow\">http://pdfaiw.uspto.gov/.aiw?PageNum=0&amp;docid=20150299141&amp;homeurl=http\\appft.uspto.gov</a></p>\n\n<p>Most of the time link contains</p>\n\n<pre><code>&lt;embed src=\"http://pimg-faiw.uspto.gov/fdd/41/2015/91/029/0.pdf\"\n       width=\"100%\" height=\"850\" type=application/pdf&gt;&lt;/embed&gt;\n</code></pre>\n\n<p>Is there any way?\nI am completely novice in VBA.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5515222, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh6.googleusercontent.com/-Q2oSgmPSQWY/AAAAAAAAAAI/AAAAAAAAAFk/0iLl4ffHbFg/photo.jpg?sz=128", "display_name": "Andre Gotlieb", "link": "https://stackoverflow.com/users/5515222/andre-gotlieb"}, "edited": false, "score": 0, "creation_date": 1446711533, "post_id": 33516900, "comment_id": 54859832, "body": "I know ... but how do you then detect a successful operation."}, {"owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "reply_to_user": {"reputation": 31, "user_id": 5515222, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh6.googleusercontent.com/-Q2oSgmPSQWY/AAAAAAAAAAI/AAAAAAAAAFk/0iLl4ffHbFg/photo.jpg?sz=128", "display_name": "Andre Gotlieb", "link": "https://stackoverflow.com/users/5515222/andre-gotlieb"}, "edited": false, "score": 0, "creation_date": 1446719574, "post_id": 33516900, "comment_id": 54864632, "body": "If there&#39;s no error returned from DAO then you can assume that the statement completed successfully. I suppose that you could always query the database again to check the insertion but I think that&#39;s probably unnecessary overhead."}], "tags": [], "owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1446625307, "creation_date": 1446625307, "answer_id": 33516900, "question_id": 33514935, "link": "https://stackoverflow.com/questions/33514935/passthrough-query-in-access/33516900#33516900", "title": "PassThrough Query in Access", "body": "<p>You need to set the ReturnsRecords property of the query to False because an insert query does not return anything. </p>\n\n<p>Also a good idea to include:</p>\n\n<pre><code>set nocount on\n</code></pre>\n\n<p>as the first line of your passthrough query - Access doesn't appear to understand the return messages that you would see in SSMS for example.</p>\n"}], "owner": {"reputation": 31, "user_id": 5515222, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh6.googleusercontent.com/-Q2oSgmPSQWY/AAAAAAAAAAI/AAAAAAAAAFk/0iLl4ffHbFg/photo.jpg?sz=128", "display_name": "Andre Gotlieb", "link": "https://stackoverflow.com/users/5515222/andre-gotlieb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594651557, "creation_date": 1446617756, "last_edit_date": 1594651557, "question_id": 33514935, "link": "https://stackoverflow.com/questions/33514935/passthrough-query-in-access", "title": "PassThrough Query in Access", "body": "<p>I am new to using SQL server express for upsizing an Access (2007-2010) front end.</p>\n\n<p>I wrote a class module that manages the SQL connection. for automating the call of functions, called procedures, and dynamic SQL strings, the last two return successfully a table using a SELECT statement that I attach to a DAO.recordset for further extracting results.</p>\n\n<p>However when trying to do the same for an insert statement I encounter a problem\nThe SQL passthrough query is:</p>\n\n<pre><code>DECLARE @ret int;\nBEGIN TRANSACTION T1;\nBEGIN TRY\nINSERT INTO dbo.[Munten](Munt, Decimalen, Volgorde) VALUES ('XYZ', 4, 99)\nEND TRY\nBEGIN CATCH\nIF @@TRANCOUNT &gt; 0 ROLLBACK TRANSACTION T1;\nEND CATCH;\nIF @@TRANCOUNT = 0\nSET @ret = 0\nELSE\nBEGIN\n        COMMIT TRANSACTION T1;\n    SET @ret = 1\nEND;\nSELECT @ret as Retval;\n</code></pre>\n\n<p>that runs fine on SQL management studio returning a one column record but when executing the poassthrough query I get:</p>\n\n<blockquote>\n  <p>\"Passtrhough with returnrecords property set to true did not return any record\"</p>\n</blockquote>\n\n<p>Bellow the Access code:</p>\n\n<pre><code>Public Function AddRecord(TblName As String, Connectstring As String,      ParamArray Pars()) As Boolean\nDim s As String, I As Integer, str As String, sc As String, sv As String, rs As DAO.Recordset\nProcList.Start procmodule, \"AddRecord\", TblName, Connectstring, Pars()\nOn Local Error GoTo ErrHandler\nWith appdb.CreateQueryDef(\"\")\n    If Len(Connectstring) = 0 Then\n       .Connect = StConnectstr\n    Else\n       .Connect = Connectstring\n   End If\n   For I = 0 To UBound(Pars)     ' ubound=-1 if no pars are passed\n       If I Mod 2 = 0 Then     ' list of columns\n          If I &gt; 0 Then sc = sc &amp; \", \"\n          sc = sc &amp; Pars(I)\n       Else                    '  list of values\n          If I &gt; 1 Then sv = sv &amp; \", \"\n          If IsDate(Pars(I)) Then\n              sv = sv &amp; DateForSQL(Pars(I))\n          ElseIf IsNumeric(Pars(I)) Then\n              sv = sv &amp; ConvDecimal(Pars(I), True)\n          Else\n              sv = sv &amp; cSquote &amp; Pars(I) &amp; cSquote\n         End If\n       End If\n   Next\n   s = \"INSERT INTO \" &amp; Me.WithSchema(TblName, IsTable) &amp; \"(\" &amp; sc &amp; \") VALUES (\" &amp; sv &amp; \")\"\n   str = EmbedTryCatch(s, .Connect)\n   .ReturnsRecords = True\n   .SQL = str\n   AddRecord = (.OpenRecordset(, dbSQLPassThrough).Fields(0) &lt;&gt; 0)\n   .Close\nEnd With\nExit_Here:\n     ProcList.Leave\n     Exit Function\nErrHandler:\n     If Error_message() Then Resume 0\n     Resume Exit_Here\nEnd Function\n\nPrivate Function EmbedTryCatch(SQLstring As String, Connectstr As String) As String\nEmbedTryCatch = \"DECLARE @ret BIT;\" &amp; vbCrLf _\n    &amp; \"BEGIN TRANSACTION T1;\" &amp; vbCrLf _\n    &amp; \"BEGIN TRY\" &amp; vbCrLf _\n        &amp; SQLstring &amp; vbCrLf _\n    &amp; \"END TRY\" &amp; vbCrLf _\n    &amp; \"BEGIN CATCH\" &amp; vbCrLf _\n        &amp; \"IF @@TRANCOUNT &gt; 0 ROLLBACK TRANSACTION T1;\" &amp; vbCrLf _\n    &amp; \"END CATCH;\" &amp; vbCrLf _\n    &amp; \"IF @@TRANCOUNT = 0\" &amp; vbCrLf _\n        &amp; \"SET @ret = 0\" &amp; vbCrLf _\n    &amp; \"ELSE\" &amp; vbCrLf _\n        &amp; \"BEGIN\" &amp; vbCrLf _\n            &amp; \"COMMIT TRANSACTION T1;\" &amp; vbCrLf _\n            &amp; \"SET @ret = 1\" &amp; vbCrLf _\n        &amp; \"END;\" &amp; vbCrLf _\n    &amp; \"SELECT @ret as Retval;\"\nEnd Function\n</code></pre>\n\n<p>Where is the catch ?</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1446614779, "post_id": 33513822, "comment_id": 54811330, "body": "Why not use rule + run script."}, {"owner": {"reputation": 650, "user_id": 5400761, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/443ce70224cc0aec5a99a23ee92cfd01?s=128&d=identicon&r=PG&f=1", "display_name": "Tikkaty", "link": "https://stackoverflow.com/users/5400761/tikkaty"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1446615406, "post_id": 33513822, "comment_id": 54811527, "body": "I&#39;ve got a rule + script. but Its only working for personal mailbox and not group inbox, maybe I should change the question"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1446677060, "post_id": 33513822, "comment_id": 54848604, "body": "@Om3r I recommend pretending Run a script does not exist."}, {"owner": {"reputation": 650, "user_id": 5400761, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/443ce70224cc0aec5a99a23ee92cfd01?s=128&d=identicon&r=PG&f=1", "display_name": "Tikkaty", "link": "https://stackoverflow.com/users/5400761/tikkaty"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1446682664, "post_id": 33513822, "comment_id": 54850454, "body": "@Niton why ? Run + Script seems like a good suggestion"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1446685304, "post_id": 33513822, "comment_id": 54851244, "body": "Run a script will breaks rules for unknown reasons. If you have that experience you can put the rule conditions in ItemAdd code."}], "answers": [{"comments": [{"owner": {"reputation": 650, "user_id": 5400761, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/443ce70224cc0aec5a99a23ee92cfd01?s=128&d=identicon&r=PG&f=1", "display_name": "Tikkaty", "link": "https://stackoverflow.com/users/5400761/tikkaty"}, "edited": false, "score": 0, "creation_date": 1446683820, "post_id": 33519080, "comment_id": 54850775, "body": "thanks @R3uk for this. Also looking to expand your code a bit. I&#39;ve posted the details in another question. <a href=\"http://stackoverflow.com/questions/33534706/in-vba-outlook-how-to-compare-text-from-the-subject-line-against-current-date\">link</a>"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1446631992, "creation_date": 1446631992, "answer_id": 33519080, "question_id": 33513822, "link": "https://stackoverflow.com/questions/33513822/how-do-i-write-an-if-statement-that-searches-for-a-specific-word-in-an-emails-s/33519080#33519080", "title": "How do I write an IF statement that searches for a specific word in an email&#39;s subject line", "body": "<p>This is how to go and read the email subject to launch further code :</p>\n\n<pre><code>Public Sub saveAttachtoDisk()\nDim olApp As Outlook.Application, _\n    oNS As Outlook.NameSpace, _\n    oFld As Outlook.Folder, _\n    oMails As Outlook.Items, _\n    oMail As Outlook.MailItem, _\n    oAtt As Outlook.Attachment, _\n    SaveFolder As String\n\nSaveFolder = \"d:\\temp\\\"\n\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err.Number &gt; 0 Then Set olApp = CreateObject(\"Outlook.Application\")\nOn Error GoTo 0\n\nSet oNS = olApp.GetNamespace(\"MAPI\")\nSet oFld = oNS.GetDefaultFolder(olFolderInbox)\nSet oMails = oFld.Items\n\nFor Each oMail In oMails\n    If InStr(1, oMail.Subject, \"Txt_to_Find\") Then\n        '----Your code comes here\n        For Each oAtt In oMail.Attachments\n            oAtt.SaveAsFile SaveFolder &amp; \"\\\" &amp; oAtt.DisplayName\n            Set oAtt = Nothing\n        Next oAtt\n    Else\n    End If\nNext oMail\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 650, "user_id": 5400761, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/443ce70224cc0aec5a99a23ee92cfd01?s=128&d=identicon&r=PG&f=1", "display_name": "Tikkaty", "link": "https://stackoverflow.com/users/5400761/tikkaty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 33519080, "answer_count": 1, "score": 1, "last_activity_date": 1593518267, "creation_date": 1446611976, "last_edit_date": 1593518267, "question_id": 33513822, "link": "https://stackoverflow.com/questions/33513822/how-do-i-write-an-if-statement-that-searches-for-a-specific-word-in-an-emails-s", "title": "How do I write an IF statement that searches for a specific word in an email&#39;s subject line", "body": "<p>I've got a rule + script setup in outlook. The rule looks for specific words in the email subject and then runs the script (defined in Modules) below. But it seems to be only working for my personal inbox and not a group inbox. The below is the code that works. </p>\n\n<p><em>The lines in comments are me trying to work it out.</em></p>\n\n<pre><code>Public Sub saveAttachtoDisk(item As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\nsaveFolder = \"d:\\temp\\\"\n\nDim objNS As Outlook.NameSpace\n\nSet Items = objNS.GetDefaultFolder(olFolderInbox).Items\n\n'Set objNS = olApp.GetNamespace(\"MAPI\")\n'Set myRecipient = objNS.CreateRecipient(\"XXXXXXX\")\n'myRecipient.Resolve\n'set Items = objNS.GetSharedDefaultFolder(myRecipient, olFolderInbox).Items\n'Dim itm As Outlook.MailItem\n\n' If TypeName(item) = \"MailItem\" Then\n'    Set itm = item\n\n     For Each objAtt In itm.Attachments\n          objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; objAtt.DisplayName\n          Set objAtt = Nothing\n     Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 1, "creation_date": 1446626431, "post_id": 33513789, "comment_id": 54816232, "body": "Exit Sub is going to screw up your loop... but guessing by the downvotes this is not a very popular question. Cannot say I blame them. Why would you want to create a calender in Excel?"}, {"owner": {"reputation": 19, "user_id": 4654178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d84fcf396d47fde34a63ea050de0fa9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/4654178/jack"}, "reply_to_user": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1446639956, "post_id": 33513789, "comment_id": 54824887, "body": "@Tom it is part of my school project"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4654178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d84fcf396d47fde34a63ea050de0fa9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/4654178/jack"}, "edited": false, "score": 0, "creation_date": 1446653448, "post_id": 33522686, "comment_id": 54834484, "body": "Tham totally makes sense ! I changed my code according to your post, and now it work perfectly ! But i have a question, why the new spreadsheets are added to the left of the existing worksheets?    For example: If i select start day: Mach and end date May, all my spreadsheets are in this order: May April March, but should be in this order: March April May"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "reply_to_user": {"reputation": 19, "user_id": 4654178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d84fcf396d47fde34a63ea050de0fa9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/4654178/jack"}, "edited": false, "score": 0, "creation_date": 1446656126, "post_id": 33522686, "comment_id": 54836423, "body": "add this line after you add the sheet    <code>ws.Move After:=Sheets(ActiveWorkbook.Sheets.Count)</code>"}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": true, "score": 0, "last_activity_date": 1446642230, "creation_date": 1446642230, "answer_id": 33522686, "question_id": 33513789, "link": "https://stackoverflow.com/questions/33513789/creating-a-monthly-calendar-in-each-spreadsheet/33522686#33522686", "title": "Creating a monthly calendar in each spreadsheet", "body": "<p>Several things to consider:</p>\n\n<p>1-This line is stopping execution from the get go. If start date is smaller than end date then this condition is true and will never enter the loop.</p>\n\n<pre><code>Do Until start_date.ListIndex &lt;= end_date.ListIndex\n</code></pre>\n\n<p>I think you should use Do..While instead</p>\n\n<pre><code>Do While start_date.ListIndex &lt;= end_date.ListIndex\n</code></pre>\n\n<p>2-This line gives error, I think you are looking to set the Value, not the NumberFormat</p>\n\n<pre><code>Range(\"a1\").NumberFormat = ArrayTwo(start_date.ListIndex)\n</code></pre>\n\n<p>3-This line is exiting your loop after one iteration, comment it out</p>\n\n<pre><code>Exit Sub\n</code></pre>\n\n<p>4-You are adding two sheets each time with these lines, since you're not using that sheet as a reference (which you should), you can comment out the first line</p>\n\n<pre><code>Set wsArrayOne(start_date.ListIndex) = Sheets.Add\nSheets.Add.Name = strArrayOne(start_date.ListIndex)\n</code></pre>\n\n<p>a better way would be to declare a worksheet variable and then use that as your reference throughout (if you don't bind the cell manipulation calls to a sheet, they will happen on whatever the active sheet is at the time, which is OK in this case, but will get you into trouble later on if you are working with multiple sheets at a time. This would be better</p>\n\n<pre><code>Dim ws as worksheet\nSet ws=Sheets.Add\nws.name=strArrayOne(start_date.ListIndex)\n'then bind your cell manuipulations to the worksheet variable like this\n\nws.Range(\"a1:g14\").Clear\n</code></pre>\n\n<p>Other things to consider are when the user does the unexpected, like picks May to February..the loop will not run, but you could give the user a message saying the start date has to be smaller than the end date. Also, get in the habit of adding error handling to your code, if coding becomes more than a school project then error handling is essential and its best to pick it up early! Good luck!</p>\n"}], "owner": {"reputation": 19, "user_id": 4654178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d84fcf396d47fde34a63ea050de0fa9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/4654178/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 33522686, "answer_count": 1, "score": -1, "last_activity_date": 1446642230, "creation_date": 1446611763, "last_edit_date": 1446627282, "question_id": 33513789, "link": "https://stackoverflow.com/questions/33513789/creating-a-monthly-calendar-in-each-spreadsheet", "title": "Creating a monthly calendar in each spreadsheet", "body": "<p>Now I finally managed to get all the code together, and now everything looks correct and does not give any syntax error. However, after the code is completed, the program does not do anything at all. </p>\n\n<p>I have an application in VBA that asks for the start date (month) and for the end date, and then it outputs the monthly calendar with each month in each spreadsheet.</p>\n\n<p>For example: If the user selects September (8) as the start date and December as the end date (11) it should output all the months between September and December in each spreadsheet. </p>\n\n<p>Here is the code for this </p>\n\n<pre><code>   Private Sub UserForm_Initialize()\n    start_date.AddItem (\"January\"), 0\n    start_date.AddItem (\"February\"), 1\n    start_date.AddItem (\"March\"), 2\n    start_date.AddItem (\"April\"), 3\n    start_date.AddItem (\"May\"), 4\n    start_date.AddItem (\"June\"), 5\n    start_date.AddItem (\"July\"), 6\n    start_date.AddItem (\"August\"), 7\n    start_date.AddItem (\"September\"), 8\n    start_date.AddItem (\"October\"), 9\n    start_date.AddItem (\"November\"), 10\n    start_date.AddItem (\"December\"), 11\n\n\n    end_date.AddItem (\"January\"), 0\n    end_date.AddItem (\"February\"), 1\n    end_date.AddItem (\"March\"), 2\n    end_date.AddItem (\"April\"), 3\n    end_date.AddItem (\"May\"), 4\n    end_date.AddItem (\"June\"), 5\n    end_date.AddItem (\"July\"), 6\n    end_date.AddItem (\"August\"), 7\n    end_date.AddItem (\"September\"), 8\n    end_date.AddItem (\"October\"), 9\n    end_date.AddItem (\"November\"), 10\n    end_date.AddItem (\"December\"), 11\n\nEnd Sub\n\n\nPrivate Sub newProjectNext1_Click()\n    Dim strArrayOne(11) As String\n    Dim wsArrayOne(11) As Worksheet\n\n    strArrayOne(0) = \"January\"\n    strArrayOne(1) = \"February\"\n    strArrayOne(2) = \"March\"\n    strArrayOne(3) = \"April\"\n    strArrayOne(4) = \"May\"\n    strArrayOne(5) = \"June\"\n    strArrayOne(6) = \"July\"\n    strArrayOne(7) = \"August\"\n    strArrayOne(8) = \"September\"\n    strArrayOne(9) = \"October\"\n    strArrayOne(10) = \"November\"\n    strArrayOne(11) = \"December\"\n\n    Dim ArrayTwo(11) As String\n    ArrayTwo(0) = \"January 2015\"\n    ArrayTwo(1) = \"February 2015\"\n    ArrayTwo(2) = \"March 2015\"\n    ArrayTwo(3) = \"April 2015\"\n    ArrayTwo(4) = \"May 2015\"\n    ArrayTwo(5) = \"June 2015\"\n    ArrayTwo(6) = \"July 2015\"\n    ArrayTwo(7) = \"August 2015\"\n    ArrayTwo(8) = \"September 2015\"\n    ArrayTwo(9) = \"October 2015\"\n    ArrayTwo(10) = \"November 2015\"\n    ArrayTwo(11) = \"December 2015\"\n\n    Do Until start_date.ListIndex &lt;= end_date.ListIndex\n        Set wsArrayOne(start_date.ListIndex) = Sheets.Add\n        Sheets.Add.Name = strArrayOne(start_date.ListIndex)\n        Application.ScreenUpdating = False\n        Range(\"a1:g14\").Clear\n        MyInput = ArrayTwo(start_date.ListIndex)\n        If MyInput = \"\" Then Exit Sub\n        StartDay = DateValue(MyInput)\n        If Day(StartDay) &lt;&gt; 1 Then\n            StartDay = DateValue(Month(StartDay) &amp; \"/1/\" &amp; _\n                                 Year(StartDay))\n        End If\n        Range(\"a1\").NumberFormat = ArrayTwo(start_date.ListIndex)\n        With Range(\"a1:g1\")\n            .HorizontalAlignment = xlCenterAcrossSelection\n            .VerticalAlignment = xlCenter\n            .Font.Size = 18\n            .Font.Bold = True\n            .RowHeight = 35\n        End With\n        With Range(\"a2:g2\")\n            .ColumnWidth = 11\n            .VerticalAlignment = xlCenter\n            .HorizontalAlignment = xlCenter\n            .VerticalAlignment = xlCenter\n            .Orientation = xlHorizontal\n            .Font.Size = 12\n            .Font.Bold = True\n            .RowHeight = 20\n        End With\n        Range(\"a2\") = \"Sunday\"\n        Range(\"b2\") = \"Monday\"\n        Range(\"c2\") = \"Tuesday\"\n        Range(\"d2\") = \"Wednesday\"\n        Range(\"e2\") = \"Thursday\"\n        Range(\"f2\") = \"Friday\"\n        Range(\"g2\") = \"Saturday\"\n        With Range(\"a3:g8\")\n            .HorizontalAlignment = xlRight\n            .VerticalAlignment = xlTop\n            .Font.Size = 18\n            .Font.Bold = True\n            .RowHeight = 21\n        End With\n        Range(\"a1\").Value = Application.Text(MyInput, \"mmmm yyyy\")\n        DayofWeek = Weekday(StartDay)\n        CurYear = Year(StartDay)\n        CurMonth = Month(StartDay)\n        FinalDay = DateSerial(CurYear, CurMonth + 1, 1)\n        Select Case DayofWeek\n        Case 1\n            Range(\"a3\").Value = 1\n        Case 2\n            Range(\"b3\").Value = 1\n        Case 3\n            Range(\"c3\").Value = 1\n        Case 4\n            Range(\"d3\").Value = 1\n        Case 5\n            Range(\"e3\").Value = 1\n        Case 6\n            Range(\"f3\").Value = 1\n        Case 7\n            Range(\"g3\").Value = 1\n        End Select\n        For Each cell In Range(\"a3:g8\")\n            RowCell = cell.Row\n            ColCell = cell.Column\n            If cell.Column = 1 And cell.Row = 3 Then\n            ElseIf cell.Column &lt;&gt; 1 Then\n                If cell.Offset(0, -1).Value &gt;= 1 Then\n                    cell.Value = cell.Offset(0, -1).Value + 1\n                    If cell.Value &gt; (FinalDay - StartDay) Then\n                        cell.Value = \"\"\n                        Exit For\n                    End If\n                End If\n            ElseIf cell.Row &gt; 3 And cell.Column = 1 Then\n                cell.Value = cell.Offset(-1, 6).Value + 1\n                If cell.Value &gt; (FinalDay - StartDay) Then\n                    cell.Value = \"\"\n                    Exit For\n                End If\n            End If\n        Next\n        For x = 0 To 5\n            Range(\"A4\").Offset(x * 2, 0).EntireRow.Insert\n            With Range(\"A4:G4\").Offset(x * 2, 0)\n                .RowHeight = 65\n                .HorizontalAlignment = xlCenter\n                .VerticalAlignment = xlTop\n                .WrapText = True\n                .Font.Size = 10\n                .Font.Bold = False\n                .Locked = False\n            End With\n            With Range(\"A3\").Offset(x * 2, 0).Resize(2, _\n                                                     7).Borders(xlLeft)\n                .Weight = xlThick\n                .ColorIndex = xlAutomatic\n            End With\n            With Range(\"A3\").Offset(x * 2, 0).Resize(2, _\n                                                     7).Borders(xlRight)\n                .Weight = xlThick\n                .ColorIndex = xlAutomatic\n            End With\n            Range(\"A3\").Offset(x * 2, 0).Resize(2, 7).BorderAround _\n                    Weight:=xlThick, ColorIndex:=xlAutomatic\n        Next\n        If Range(\"A13\").Value = \"\" Then Range(\"A13\").Offset(0, 0) _\n           .Resize(2, 8).EntireRow.Delete\n        ActiveWindow.DisplayGridlines = False\n        ActiveSheet.Protect DrawingObjects:=True, Contents:=True, _\n                            Scenarios:=True\n        ActiveWindow.WindowState = xlMaximized\n        ActiveWindow.ScrollRow = 1\n        Application.ScreenUpdating = True\n        Exit Sub\n\n        start_date.ListIndex = start_date.ListIndex + 1\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>I tried checking if the numbers for the <code>start_date.ListIndex</code> and <code>end_date.ListIndex</code> output the correct selected values from the combobox, and they worked well. </p>\n\n<p>It does not output anything, even the errors.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 287, "user_id": 5458854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71d4ee178e2286b2d9017bdf26d2e889?s=128&d=identicon&r=PG&f=1", "display_name": "Louis. B", "link": "https://stackoverflow.com/users/5458854/louis-b"}, "edited": false, "score": 0, "creation_date": 1446622012, "post_id": 33513118, "comment_id": 54814116, "body": "You can do that in a very efficient way just with Excel. With some vlookup function you should be able to setup a sheet in which as soon as you paste the IDs in a specific column, Excel retrieve the corresponding data and display them. And when you delete the IDs, corresponding data are no longer displayed. Is that what you want?"}, {"owner": {"reputation": 13, "user_id": 2491448, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2c3208a87b7a0c4fb6a7e6dcdfb4fbef?s=128&d=identicon&r=PG", "display_name": "user2491448", "link": "https://stackoverflow.com/users/2491448/user2491448"}, "reply_to_user": {"reputation": 287, "user_id": 5458854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71d4ee178e2286b2d9017bdf26d2e889?s=128&d=identicon&r=PG&f=1", "display_name": "Louis. B", "link": "https://stackoverflow.com/users/5458854/louis-b"}, "edited": false, "score": 0, "creation_date": 1446638987, "post_id": 33513118, "comment_id": 54824298, "body": "@Louis.B This was my initial goal, but after spending a lot of time researching I was made to believe using VBA was the only way to go. I got it working using VBA, but I would still like to explore this option. Any idea on how I can use VLOOKUP to copy an entire row?"}, {"owner": {"reputation": 287, "user_id": 5458854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71d4ee178e2286b2d9017bdf26d2e889?s=128&d=identicon&r=PG&f=1", "display_name": "Louis. B", "link": "https://stackoverflow.com/users/5458854/louis-b"}, "edited": false, "score": 0, "creation_date": 1446668576, "post_id": 33513118, "comment_id": 54844103, "body": "The idea is not to &quot;copy&quot; the entire row with <code>vlookup</code> but rather to use <code>vlookup</code> to retrieve data in each column you want. Just to give you an idea, something like that should work : <code>=vlookup(&quot;Paste New IDs Here&quot;!A&quot;correspoding row&quot; ; &quot;Raw Export&quot;!DataSet ; correponding column)</code>. You can even add the appropriate if condition to display nothing if the vlookup return some error. Tell me if you need more detail I can add an answer about that."}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 5506472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0d43fbf3e53483bb7723a35e39d8883?s=128&d=identicon&r=PG&f=1", "display_name": "Svendsen", "link": "https://stackoverflow.com/users/5506472/svendsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1446622923, "creation_date": 1446622923, "answer_id": 33516245, "question_id": 33513118, "link": "https://stackoverflow.com/questions/33513118/copy-row-into-new-spreadsheet-based-on-unique-identifier/33516245#33516245", "title": "Copy row into new spreadsheet based on unique identifier", "body": "<p>You need to add an inner loop over k:</p>\n\n<pre><code>Do Until IsEmpty(i.Range(\"B\" &amp; j))    \n  Do Until isEmpty(p.Range(\"A\"&amp;k))\n    If i.Range(\"B\" &amp; j) = p.Range(\"A\" &amp; k) Then\n      d = d + 1          \n      e.Rows(d).Value = i.Rows(j).Value\n    End If\n    k = k + 1\n  Loop\n  k=2\n  j = j + 1    \nLoop\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2491448, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2c3208a87b7a0c4fb6a7e6dcdfb4fbef?s=128&d=identicon&r=PG", "display_name": "user2491448", "link": "https://stackoverflow.com/users/2491448/user2491448"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1062, "favorite_count": 1, "accepted_answer_id": 33516245, "answer_count": 1, "score": 0, "last_activity_date": 1446626251, "creation_date": 1446607191, "last_edit_date": 1446626251, "question_id": 33513118, "link": "https://stackoverflow.com/questions/33513118/copy-row-into-new-spreadsheet-based-on-unique-identifier", "title": "Copy row into new spreadsheet based on unique identifier", "body": "<p>In the tab <code>Paste New IDs Here</code> column A, starting at row 2, has a list of unique IDs used to identify a person. There are thirty unique ID numbers.  </p>\n\n<p>In the <code>Raw Export</code> tab, there's a bunch of raw data, where column B, starting at row 2, has all the IDs for 200+ people.  </p>\n\n<p>I am putting a list of ID numbers in <code>Paste New IDs Here</code> and pulling the entire row associated with that ID number into <code>Test</code>. Therefore, only rows that have ID numbers specified in the <code>Paste New IDs Here</code> sheet will be copied into <code>Test</code>.</p>\n\n<p>Only ten rows (out of the thirty) are being generated.  </p>\n\n<p>Do I need another loop?</p>\n\n<pre><code>Sub ExtractID()\n\nSet i = Sheets(\"Raw Export\")\nSet e = Sheets(\"Test\")\nSet p = Sheets(\"Paste New IDs Here\")\n\nDim d\nDim j\nDim k\n\nd = 1\nj = 2\nk = 2\n\nDo Until IsEmpty(i.Range(\"B\" &amp; j))\n\nIf i.Range(\"B\" &amp; j) = p.Range(\"A\" &amp; k) Then\nd = d + 1\nk = k + 1\ne.Rows(d).Value = i.Rows(j).Value\n\n\nEnd If\nj = j + 1\n\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1446629189, "creation_date": 1446629189, "answer_id": 33518062, "question_id": 33513112, "link": "https://stackoverflow.com/questions/33513112/pivot-orientation-single-into-multiple-column/33518062#33518062", "title": "Pivot orientation single into multiple column", "body": "<p>You need to add:</p>\n\n<pre><code>With objTable.DataPivotField\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 5319870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-a6r6fG_3CmQ/AAAAAAAAAAI/AAAAAAAAAJI/c_6KZR7CCJg/photo.jpg?sz=128", "display_name": "IlhamideaZ", "link": "https://stackoverflow.com/users/5319870/ilhamideaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 33518062, "answer_count": 1, "score": 0, "last_activity_date": 1446629189, "creation_date": 1446607177, "last_edit_date": 1446626482, "question_id": 33513112, "link": "https://stackoverflow.com/questions/33513112/pivot-orientation-single-into-multiple-column", "title": "Pivot orientation single into multiple column", "body": "<pre>This is the layout I want:         but this is what currently I get:</pre>\n\n<p><a href=\"https://i.stack.imgur.com/qhRAfm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qhRAfm.png\" alt=\"Orientation Wanted\"></a>\n<a href=\"https://i.stack.imgur.com/p4fGgm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p4fGgm.png\" alt=\"Orientation Need To Change\"></a></p>\n\n<p>from this code:</p>\n\n<pre><code>Private Sub KPIDashboardTable()\nSheets(\"KPI Dashboard List\").Activate\nDim objTable As PivotTable, objField As PivotField, Ws As Worksheet\nActiveWorkbook.Sheets(\"KPI Dashboard List\").Range(\"A1\").Select\n\nSet Ws = Sheets.Add\nWs.Name = \"KPI Dashboard List Table\"\n\nSet objTable = Sheets(\"KPI Dashboard List\").PivotTableWizard(TableDestination:=Ws.Cells(3, \"A\"))\nobjTable.PivotCache.MissingItemsLimit = xlmissingItemNone\nobjTable.PivotCache.Refresh\n\nSet objField = objTable.PivotFields(\"DATE OPENED\")\nobjField.Orientation = xlRowField\n\nSet objField = objTable.PivotFields(\"KPI\")\nobjField.Orientation = xlDataField\nobjField.Function = xlSum\nobjField.Position = 1\n\nSet objField = objTable.PivotFields(\"KPI\")\nobjField.Orientation = xlDataField\n\nDim pf As PivotField\nSet pf = ActiveSheet.PivotTables(1).PivotFields(\"DATE OPENED\")\npf.DataRange.Cells(1).Group Start:=True, End:=True, Periods:=Array(False, False, _\nFalse, False, True, False, False)\n\nRange(\"B2\").Value = \"KPI Dashboard\"\nRange(\"A2:O2\").Font.Bold = True\nRange(\"A2:O2\").Interior.Color = vbYellow\n\nEnd Sub\n</code></pre>\n\n<p>How can I change the orientation of the PivotTable? </p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 497, "user_id": 480765, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b4448339d1e21ba7d8f1439ceb33ce2c?s=128&d=identicon&r=PG", "display_name": "Dave Stuart", "link": "https://stackoverflow.com/users/480765/dave-stuart"}, "edited": false, "score": 0, "creation_date": 1446664415, "post_id": 33517139, "comment_id": 54841778, "body": "Right! I will try the backwards loop tonight. I&#39;m pretty sure that is the reason why it was not finding some of the Shapes, but will confirm that."}, {"owner": {"reputation": 497, "user_id": 480765, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b4448339d1e21ba7d8f1439ceb33ce2c?s=128&d=identicon&r=PG", "display_name": "Dave Stuart", "link": "https://stackoverflow.com/users/480765/dave-stuart"}, "edited": false, "score": 0, "creation_date": 1446777877, "post_id": 33517139, "comment_id": 54896501, "body": "Thanks for this reminder JamieG. It worked perfectly!"}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "reply_to_user": {"reputation": 497, "user_id": 480765, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b4448339d1e21ba7d8f1439ceb33ce2c?s=128&d=identicon&r=PG", "display_name": "Dave Stuart", "link": "https://stackoverflow.com/users/480765/dave-stuart"}, "edited": false, "score": 0, "creation_date": 1446882103, "post_id": 33517139, "comment_id": 54937727, "body": "Super. Glad it solved your problem Dave and happy to help :-)"}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": true, "score": 1, "last_activity_date": 1446627195, "last_edit_date": 1446627195, "creation_date": 1446626205, "answer_id": 33517139, "question_id": 33513077, "link": "https://stackoverflow.com/questions/33513077/powerpoint-shape-not-in-the-shape-collection/33517139#33517139", "title": "PowerPoint Shape not in the Shape Collection", "body": "<p>You can also use the <strong>For Each</strong> structure to loop through a <strong>Collection</strong> e.g.</p>\n\n<pre><code>Dim oShp As Shape\nDim oSld As Slide\nFor Each oShp In oSld.Shapes\n  ' Do suff\nNext\n</code></pre>\n\n<p>But you mentioned the critical word \"Delete\".</p>\n\n<p>If you are deleting any object in a <strong>Collection</strong> that you are looping through in VBA, you MUST loop backwards!</p>\n\n<p>So, use this instead:</p>\n\n<pre><code>Dim intLoop As Integer\nFor intLoop = objPPPresentation.Slides(1).Shapes.Count to 1 Step -1\n</code></pre>\n"}], "owner": {"reputation": 497, "user_id": 480765, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b4448339d1e21ba7d8f1439ceb33ce2c?s=128&d=identicon&r=PG", "display_name": "Dave Stuart", "link": "https://stackoverflow.com/users/480765/dave-stuart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "accepted_answer_id": 33517139, "answer_count": 1, "score": 0, "last_activity_date": 1593763092, "creation_date": 1446606881, "last_edit_date": 1593763092, "question_id": 33513077, "link": "https://stackoverflow.com/questions/33513077/powerpoint-shape-not-in-the-shape-collection", "title": "PowerPoint Shape not in the Shape Collection", "body": "<p>MS Access VBA Code updating a PowerPoint Presentation.</p>\n\n<p>I have been frustrated with writing to PowerPoint just recently that I have had to revert to hardcoding which I hate doing but had no choice.</p>\n\n<p>Using <code>Do Until intShapes &gt; objPPPresentation.Slides(1).Shapes.Count</code> does not always get all Shapes on Slide 1!</p>\n\n<p>This Select case code does not always find the Shape I need to update.</p>\n\n<pre><code>        Select Case objPPPresentation.Slides(intSlide).Shapes(intShapes).Name\n        Case Is = \"BuildingAddress\"\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).TextFrame.TextRange.Text = Nz(Me.txtStreetNumber, \"\") &amp; \" \" &amp; UCase(Nz(Me.txtAddress, \"\"))\n</code></pre>\n\n<p>So instead I did this, which works every time.</p>\n\n<pre><code>objPPPresentation.Slides(intSlide).Shapes(\"BuildingName\").TextFrame.TextRange.Text = Nz(Me.txtStreetNumber, \"\") &amp; \" \" &amp; UCase(Nz(Me.txtAddress, \"\"))\n</code></pre>\n\n<p>Can anyone explain why the Shapes.Count does not always find the Shape I need to update?</p>\n\n<p>This is my entire loop which includes deleting an Item and replacing it with a Picture and centering the Picture Shape! OH, Is the deletion of an item enough to throw off the code? Maybe I should delete that Shape AFTER I'm doing with the Loop?</p>\n\n<pre><code>    ' Page ONE First.\nDo Until intShapes &gt; objPPPresentation.Slides(1).Shapes.Count\n    'Debug.Print objPPPresentation.Slides(intSlide).Shapes(intShapes).ID &amp; \":\" &amp; objPPPresentation.Slides(1).Shapes(intShapes).Name\n\n    Select Case objPPPresentation.Slides(intSlide).Shapes(intShapes).Name\n        Case Is = \"BuildingAddress\"\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).TextFrame.TextRange.Text = Nz(Me.txtStreetNumber, \"\") &amp; \" \" &amp; UCase(Nz(Me.txtAddress, \"\"))\n\n        Case Is = \"BuildingName\"\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).TextFrame.TextRange.Text = UCase(Nz(Me.cboBuilding.Column(1), \"\"))\n\n        Case Is = \"tableData\"\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(1).Cells(2).Shape.TextFrame.TextRange.Text = \"Floors: \" &amp; Nz(Me.txtFloors, \"\")\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(2).Cells(2).Shape.TextFrame.TextRange.Text = Nz(Me.txtAvailability, \"\")\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(3).Cells(2).Shape.TextFrame.TextRange.Text = Nz(Me.txtLeaseTerm, \"\")\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(4).Cells(2).Shape.TextFrame.TextRange.Text = \"WHERE FROM?\"\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(5).Cells(2).Shape.TextFrame.TextRange.Text = Nz(Me.txtAskingNetRent, \"\")\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(6).Cells(2).Shape.TextFrame.TextRange.Text = Nz(Me.TIA, \"\")\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(7).Cells(2).Shape.TextFrame.TextRange.Text = \"WHERE FROM?\"\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(8).Cells(2).Shape.TextFrame.TextRange.Text = Nz(Me.txtHVACHours, \"\")\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(9).Cells(2).Shape.TextFrame.TextRange.Text = Nz(Me.txtSecurity, \"\")\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(10).Cells(2).Shape.TextFrame.TextRange.Text = \"GetPlus15 Function!\"\n            objPPPresentation.Slides(intSlide).Shapes(intShapes).Table.Rows(11).Cells(2).Shape.TextFrame.TextRange.Text = Nz(Me.txtComments, \"\")\n\n        Case Is = \"pictureBuildingPhoto\"\n            imageWidth = GetGraphicWidthOrHeight(strExportFolder &amp; strBuildingPhotoFileName, \"Width\")\n            imageHeight = GetGraphicWidthOrHeight(strExportFolder &amp; strBuildingPhotoFileName, \"Height\")\n            ' The ratio of image Pixels vs. Shape sizes is.\n            imageWidth = imageWidth * (71 / 96)\n            imageHeight = imageHeight * (71 / 96)\n\n            ' Can't change the image of a picture object so this Shape has been removed from the Template\n            Set pptShape = objPPPresentation.Slides(intSlide).Shapes(intShapes)\n\n            Top = objPPPresentation.Slides(intSlide).Shapes(intShapes).Top\n            Left = objPPPresentation.Slides(intSlide).Shapes(intShapes).Left\n            Height = objPPPresentation.Slides(intSlide).Shapes(intShapes).Height\n            Width = objPPPresentation.Slides(intSlide).Shapes(intShapes).Width\n            pptShape.Delete\n\n            If imageHeight &gt; imageWidth Then\n                Left = Left + ((Width / 2) - (imageWidth / 2))\n                objPPPresentation.Slides(intSlide).Shapes.AddPicture strExportFolder &amp; strBuildingPhotoFileName, msoFalse, msoCTrue, _\n                Left, Top, -1, Height\n            Else\n                'Adjust Top value so the image in centered\n                Top = Top + ((Height / 2) - (imageHeight / 2))\n                objPPPresentation.Slides(intSlide).Shapes.AddPicture strExportFolder &amp; strBuildingPhotoFileName, msoFalse, msoCTrue, _\n                Left, Top, Width, -1\n            End If\n\n    End Select\n\n    intShapes = intShapes + 1\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1446606774, "post_id": 33512824, "comment_id": 54809299, "body": "You want the mode, but only for the filtered values?  In your example above, the result would be 1947?  Just clarifying...  What is the filter condition that helps to eliminate the &quot;unnecessary&quot; data?  I know it&#39;s beyond the scope of your project, but a database, even a simple one like SQLite or MS Access might make short work of this effort and be a little more scalable than Excel."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1446606846, "post_id": 33512824, "comment_id": 54809317, "body": "By the way, there apparently is a hack for a subtotal-type mode formula:  <a href=\"http://www.mrexcel.com/forum/excel-questions/371589-mode-subtotal.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/371589-mode-subtotal.html</a>"}, {"owner": {"reputation": 349, "user_id": 4390183, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a68530b31137941645416aa8dd87b530?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah Hulsey", "link": "https://stackoverflow.com/users/4390183/josiah-hulsey"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1446607101, "post_id": 33512824, "comment_id": 54809359, "body": "@Hambone  yes I would like the mode for the filtered values only and yes the mdoe is 1947 for the displayed field. I have attached what the data looks like before the filter. It essentially takes out headings, some production information, and a few other things"}, {"owner": {"reputation": 349, "user_id": 4390183, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a68530b31137941645416aa8dd87b530?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah Hulsey", "link": "https://stackoverflow.com/users/4390183/josiah-hulsey"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1446607133, "post_id": 33512824, "comment_id": 54809370, "body": "@Hambone I saw that hack, but honestly couldnt figure out how to apply it  to my instance."}], "answers": [{"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": true, "score": 0, "last_activity_date": 1446608480, "creation_date": 1446608480, "answer_id": 33513277, "question_id": 33512824, "link": "https://stackoverflow.com/questions/33512824/calculating-the-mode-of-filtered-data/33513277#33513277", "title": "Calculating the mode of filtered data", "body": "<p>In a nutshell, I think you need to change your formula from <code>=Year()</code> to include a conditional to see if the row is a \"necessary\" row or not.  Based on the latest screenshot you posted, I think the simplest solution might be to do something like this in your year (Q) column, where this is the formula in Q2:</p>\n\n<pre><code>=if(isnumber(H2),Year(I2),\"\")\n</code></pre>\n\n<p>This would result in blanks for any invalid row, and your mode function could simply be:</p>\n\n<pre><code>=MODE(Q:Q)\n</code></pre>\n\n<p>Which would know to ignore blanks.</p>\n\n<p>Now, there is a greater than 0% chance my formula above is too simplistic and that your filtering criteria can't be replicated with a formula.  If you have to that, you can create a custom VBA function to tell if a row is hidden or not (a filtered row will have hidden = true) that would look something like this:</p>\n\n<pre><code>Function Hidden(CellValue As Range) As Boolean\n    Hidden = Rows(CellValue.Row).Hidden\nEnd Function\n</code></pre>\n\n<p>And the corresponding year function in Q2 would change to:</p>\n\n<pre><code>=IF(Hidden(A2),\"\",YEAR(B2))\n</code></pre>\n\n<p>And the same mode function would apply.  I tested it on a small spreadsheet.  Before filtering, the mode for this data is 2006:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ivJQr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ivJQr.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I filter out non-blanks in column C, to eliminate my known mode, the formula in E1 does change to the next mode, demonstrating that filtered values are ignored:</p>\n\n<p><a href=\"https://i.stack.imgur.com/q5X17.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q5X17.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 349, "user_id": 4390183, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a68530b31137941645416aa8dd87b530?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah Hulsey", "link": "https://stackoverflow.com/users/4390183/josiah-hulsey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2198, "favorite_count": 0, "accepted_answer_id": 33513277, "answer_count": 1, "score": 2, "last_activity_date": 1446666927, "creation_date": 1446604902, "last_edit_date": 1446666927, "question_id": 33512824, "link": "https://stackoverflow.com/questions/33512824/calculating-the-mode-of-filtered-data", "title": "Calculating the mode of filtered data", "body": "<p>I am a graduate student pursuing my masters in geology (aka I am not an Excel guru) and currently working on my thesis have run into a problem.</p>\n\n<p>My thesis's main point is to communicate that there are large amounts of undiscovered hydrocarbons left in the onshore section of Louisiana. I am trying to quantify this by showing that the majority of oil fields in Louisiana were operated before 1980 (since 1980 technology has really taken off in the industry and a lot of new techniques are available that could help re-open some of these old fields).</p>\n\n<p>I have an Excel workbook of approximately 1850 pages. Each page contains the well data for one field. Some fields have had thousands of wells drilled on them, while other have had only a few. One of the many pieces of data contained within theses sheets are the dates of well permits. I would like to calculate the mode year of these well permits to identify the years in which each oil field hit its \"peak development\".</p>\n\n<p>I am currently employing a filter to eliminate a lot of unnecessary data and to try and make calculations/macro creation easier for myself. The permit date is located in Column  I. I used the Year function in Column Q to remove the day and month from the date so as to be able to calculate the mode year. However, Excel refuses to calculate the mode as it keeps trying to use the filtered information to calculate and thus returns an error. There is no subtotal function for mode and I cannot find a solution that works for my circumstances on the Internet. </p>\n\n<p>A filtered sheet looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/4YaLS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4YaLS.jpg\" alt=\"Before Filtering\"></a>  </p>\n\n<p>For the solution, I need the formula to calculate the mode for the entire Q column as the range of permit data will vary by field.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/gzeTv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gzeTv.jpg\" alt=\"After Filtering\"></a></p>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1446706106, "post_id": 33512765, "comment_id": 54857284, "body": "I thought this would make an interesting blogpost, so added some more commentary as well as a simple sample file and posted it at <a href=\"http://dailydoseofexcel.com/archives/2015/11/04/listbox-bulk-refresh-wont-redraw-if-called-by-listbox-click/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2015/11/04/&hellip;</a> if anyone&#39;s interested.  If any new info turns up at that blogpost, I&#39;ll be sure to update this thread."}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1446708475, "creation_date": 1446708475, "answer_id": 33538804, "question_id": 33512765, "link": "https://stackoverflow.com/questions/33512765/vba-listbox-not-updating-to-reflect-new-source-list-when-called-from-itself/33538804#33538804", "title": "VBA Listbox not updating to reflect new source list when called from itself", "body": "<p>Ah, what an idiot I am for overlooking the painfully obvious solution. The ListBox list happily redraws in response to any event <em>other</em> than the ListBox_Click event, right? So all I needed to do was to use the ListBox_<strong>Click</strong> event to determine what got clicked (as I currently do), and then use the ListBox_<strong>MouseUp</strong> event to trigger the actual updating of the ListBox list. Works a treat.</p>\n\n<p>Hopefully this post will save someone else two days of pain in the future. Probably me.</p>\n"}], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1087, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446708475, "creation_date": 1446604483, "last_edit_date": 1446610969, "question_id": 33512765, "link": "https://stackoverflow.com/questions/33512765/vba-listbox-not-updating-to-reflect-new-source-list-when-called-from-itself", "title": "VBA Listbox not updating to reflect new source list when called from itself", "body": "<p><strong>Edit:</strong> </p>\n\n<p>Playing around further, it seems that  you <em>can't</em> assign a new array to a listbox via the .list=somelist approach when the assignment happens in response to a click on the listbox itself. Or rather, you can assign the list, but it simply won't visually populate the listbox...although Excel seems to think it's there. </p>\n\n<p>The .additem or .removeitem methods do however result in a visual change when called from a listbox click, which means you have to build your new array up that way I guess. How tedious.</p>\n\n<p>You <em>can</em> however feed a listbox an entirely new array using the .list=somelist approach via  a CommandButton-initiated action. But the user has to obviously click a button to do this. Which in my case below defeats the purpose.</p>\n\n<p><strong>Edit Over.</strong></p>\n\n<p>I'm designing a UserForm to help filter PivotTables. It's a cross between the existing Pivot Filter functionality and a Slicer. Here's what you see if you double-click on a PivotField header:</p>\n\n<p><a href=\"https://i.stack.imgur.com/s4dXR.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s4dXR.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Note the Search field at the top, and the three buttons immediately below that search field. If you type something into that field, then instead of displaying everything that's currently filtered, you instead get a list of any matches, and you can then apply those search results to the underlying PivotTable via those three CommandButtons. The first cb simply filters the PivotTable to reflect the search, and the other two let you add or remove any search result from an existing filter. </p>\n\n<p>I want to do away with those three command buttons, and instead (in the event that a search is performed) simply list those three options at the top of the ListBox above any search results returned. Clicking on those three options will then trigger the exact same code as currently triggered by the Command Button. </p>\n\n<p>Here's how that looks currently if I actually type something in that Search box (Note I haven't yet removed the three command buttons this does away with from that Search frame):</p>\n\n<p><a href=\"https://i.stack.imgur.com/faQsr.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/faQsr.gif\" alt=\"enter image description here\"></a></p>\n\n<p>I've added a simple bit of code to the lbResults_Change() event handler that checks if a user clicks any of those first three options. All that code does is trigger the <em>exact same</em> routines as would be triggered if they'd simply clicked on the actual command buttons themselves:</p>\n\n<pre><code>For i = 0 To 4\n    If Me.lbResults.Selected(i) Then Exit For\nNext i\nSelect Case i\n    Case 0: cmdApplySearch_Click\n    Case 1: cmdAddToFilter_Click\n    Case 2: cmdSubtractFromFilter_Click\n    Case 3: Me.lbResults.Selected(3) = False\nEnd Select\n</code></pre>\n\n<p><strong>Here' the problem:</strong> The listbox gets updated just fine if I click on those command buttons, as you can see from the below. The Pivot has been filtered accordingly, and those contextual search options have been removed from the top of the listbox (and the search field cleared):</p>\n\n<p><a href=\"https://i.stack.imgur.com/PDS9j.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PDS9j.gif\" alt=\"enter image description here\"></a></p>\n\n<p>But the listbox does NOT get updated if the <em>exact same routine</em> is triggered from a click on one of those top three options in listbox itself:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XYpjJ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XYpjJ.gif\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see from the above screenshot, it still shows those three options at the top, even though they are NOT in the array that I assigned to the listbox, as evidenced by the screenshot below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nusby.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nusby.gif\" alt=\"enter image description here\"></a></p>\n\n<p>But as you could see from the earlier screenshot, it shows 7 items in the ListBox instead of the three there actually are. But there are indeed just three items that should be showing in that list box:</p>\n\n<p>? .ListCount\n3 \n? .List(0)\n263213: ICT Systems Test Engineer\n? .List(1)\n263299: ICT Support and Test Engineers nec\n? .List(2)\n839313: Product Tester</p>\n\n<p>Basically, as soon as I try to update what's in the listbox via a click on the listbox itself, I can't update it.</p>\n\n<p>It doesn't seem to matter if I set focus to something other than the listbox before the filtering code executes, and I've even tried completely clearing the Listbox with .clear. It just doesn't clear, until I manually click on one of those command buttons again.</p>\n\n<p>Anyone have any pointers? </p>\n"}, {"tags": ["mysql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1446611569, "post_id": 33512646, "comment_id": 54810398, "body": "When you first open the form, if it appears as in the Form View screenshot, that VBA code has nothing to do with the problem.  What is the form&#39;s Record Source?"}, {"owner": {"reputation": 65, "user_id": 4480411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4602df1894a379a77218740b385f22b?s=128&d=identicon&r=PG&f=1", "display_name": "Tichigan", "link": "https://stackoverflow.com/users/4480411/tichigan"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1446669242, "post_id": 33512646, "comment_id": 54844468, "body": "Yes, I think they are two different problems.  But I&#39;m hoping for one cause..."}, {"owner": {"reputation": 65, "user_id": 4480411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4602df1894a379a77218740b385f22b?s=128&d=identicon&r=PG&f=1", "display_name": "Tichigan", "link": "https://stackoverflow.com/users/4480411/tichigan"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1446669580, "post_id": 33512646, "comment_id": 54844666, "body": "I&#39;m going to try to run the select query in SQL and see what I get.  I&#39;m not sure if it is related, but I used to be able to modify a record when I did a select query in Access but now that it is linked to MySQL, it won&#39;t allow me to (e.g.) enter a date for that one record."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4480411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4602df1894a379a77218740b385f22b?s=128&d=identicon&r=PG&f=1", "display_name": "Tichigan", "link": "https://stackoverflow.com/users/4480411/tichigan"}, "edited": false, "score": 0, "creation_date": 1446688502, "post_id": 33518324, "comment_id": 54852088, "body": "Ok, I ran the SQL query manually for the choose your plate and choose your locus controls.  There is no row source (RecordSource) for the others, because they are meant to be inputs (this worked before the migration, but is it wrong now?)."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 65, "user_id": 4480411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4602df1894a379a77218740b385f22b?s=128&d=identicon&r=PG&f=1", "display_name": "Tichigan", "link": "https://stackoverflow.com/users/4480411/tichigan"}, "edited": false, "score": 0, "creation_date": 1446707416, "post_id": 33518324, "comment_id": 54857795, "body": "It seems to be the case."}, {"owner": {"reputation": 65, "user_id": 4480411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4602df1894a379a77218740b385f22b?s=128&d=identicon&r=PG&f=1", "display_name": "Tichigan", "link": "https://stackoverflow.com/users/4480411/tichigan"}, "edited": false, "score": 0, "creation_date": 1446745944, "post_id": 33518324, "comment_id": 54882438, "body": "Thanks.  Would you (or anyone) have any advice on how to set up a form where I choose a record from one table (Plate) and copy it with a modification (Plate_geneMod) to another table, while filling in some metadata (barcoded, date)?  Much appreciated."}, {"owner": {"reputation": 65, "user_id": 4480411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4602df1894a379a77218740b385f22b?s=128&d=identicon&r=PG&f=1", "display_name": "Tichigan", "link": "https://stackoverflow.com/users/4480411/tichigan"}, "edited": false, "score": 0, "creation_date": 1446761727, "post_id": 33518324, "comment_id": 54891421, "body": "Ok, the record source of the form was conflicting with some of the input controls.  I deleted the RecordSource query and it works now.  Thanks for your help!"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1446629944, "creation_date": 1446629944, "answer_id": 33518324, "question_id": 33512646, "link": "https://stackoverflow.com/questions/33512646/vba-scripts-no-longer-work-after-sql-migration/33518324#33518324", "title": "VBA scripts no longer work after SQL migration", "body": "<p>The happens when your <code>RecordSource</code> of the form returns zero records and the form or record source does not allow adding new records.</p>\n\n<p>Check the record source (table, query, or SQL string) and run it manually to see if it returns records.</p>\n"}], "owner": {"reputation": 65, "user_id": 4480411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4602df1894a379a77218740b385f22b?s=128&d=identicon&r=PG&f=1", "display_name": "Tichigan", "link": "https://stackoverflow.com/users/4480411/tichigan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 33518324, "answer_count": 1, "score": 0, "last_activity_date": 1446629944, "creation_date": 1446603627, "question_id": 33512646, "link": "https://stackoverflow.com/questions/33512646/vba-scripts-no-longer-work-after-sql-migration", "title": "VBA scripts no longer work after SQL migration", "body": "<p>I recently migrated an Access database (that someone more knowledgeable than I designed) to MySQL, and linked the tables back into Access to use as a front end.  <em>Almost</em> everything looks great.  There is just one form and chunk of VBA code that doesn't seem to work.  There is a form that should show drop down menus and controls, but is blank in form view.  <a href=\"http://i.stack.imgur.com/242u2.jpg\" rel=\"nofollow\">The form in design view and form view</a>  The VBA code that goes with the form is </p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub cmdPreviewPlate_Click()\n'show user the new plate that is to be added to tblPCRsamples\nOn Error GoTo Err_cmdPreviewPlate_Click\n\n'check whether boxes are blank\nDim bolBlank As Boolean\nbolBlank = False\n\nIf IsNull(Me.Controls!cboChooseTemplatePlate) Then bolBlank = True\nIf IsNull(Me.Controls!cboChooseLocus) Then bolBlank = True\nIf IsNull(Me.Controls!txtEnterDate) Then bolBlank = True\n\nIf bolBlank = False Then\n    'enable the Add button\n    Me.Controls!cmdAddPlate.Enabled = True\n\n    'generate the unique PCRplate from the template plate number and locus\n    ' using the global variable GstrPCRPlateName so that the queries can add the plate name to both tables\n    GstrPCRPlateName = Me.Controls!cboChooseTemplatePlate.Value &amp; \"_\" &amp; Me.Controls!cboChooseLocus\n\n    'check: does this PCRplate already exist in tblPCRplates?\n    Dim dbs As Database\n    Dim rst As Recordset\n    Dim bolDone As Boolean\n    Dim bolNameExists As Boolean\n\n    bolDone = False\n    bolNameExists = False\n    Set dbs = CurrentDb\n    Set rst = dbs.OpenRecordset(\"tblPCRplates\", dbOpenDynaset)\n\n    rst.MoveFirst\n\n    Do Until bolDone = True\n        'does the new plate name automatically generated here = the value of PCRplate in the current record?\n        If GstrPCRPlateName = rst![PCRPlate] Then\n            bolNameExists = True\n            bolDone = True\n        End If\n\n        rst.MoveNext\n\n        If rst.EOF Then bolDone = True\n    Loop\n\n    'if the name already exists, make a new name by appending _ and the date\n    If bolNameExists = True Then\n        GstrPCRPlateName = GstrPCRPlateName &amp; \"_\" &amp; Me.Controls!txtEnterDate\n    End If\n\n    'set the value for the Locus\n    GstrGetLocus = Me.Controls!cboChooseLocus\n\n    'open the select query to show user what they're going to add to the PCR plates &amp; samples tables\n    Dim stDocName As String\n\n    stDocName = \"qryNewPCR_1SelectTemplatePlate\"\n    DoCmd.OpenQuery stDocName, acNormal, acReadOnly\nElse\n    'if user left fields blank (except page number, that can be blank), show an error message\n    MsgBox \"Choose/enter values for all the boxes\"\nEnd If\n\nExit_cmdPreviewPlate_Click:\n    Exit Sub\n\nErr_cmdPreviewPlate_Click:\nMsgBox Err.Description\nResume Exit_cmdPreviewPlate_Click\n\nEnd Sub\n\nPrivate Sub cmdAddPlate_Click()\n'add this new plate to tblPCRplates and tblPCRsamples\nOn Error GoTo Err_cmdAddPlate_Click\n\n'add the new plate to tblPCRplates\nDim stDocName As String\nstDocName = \"qryNewPCR_2AppendPlate\"\nDoCmd.OpenQuery stDocName, acNormal, acEdit\n\n'run the query to append the samples to tblPCRsamples\nstDocName = \"qryNewPCR_3AppendSamples\"\nDoCmd.OpenQuery stDocName, acNormal, acEdit\n\n'open frmPCRSamples to show the new plate has been added\nstDocName = \"frmPCRSamples\"\nDoCmd.OpenForm stDocName, acFormDS\n\nExit_cmdAddPlate_Click:\nExit Sub\n\nErr_cmdAddPlate_Click:\nMsgBox Err.Description\nResume Exit_cmdAddPlate_Click\n\nEnd Sub\n</code></pre>\n\n<p>So my question is, should the linked tables be causing errors?  Is there something I can amend to say that they are linked?  Or am I barking up the wrong tree?</p>\n\n<p>Thanks for your help.  I know nothing of VBA (I mean, I can follow along) and have been tasked to destroy, I mean...admin...this database.  This is what happens when you give biologists computers ;-)  Even just some good resources would help a great deal.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1446601824, "creation_date": 1446601824, "answer_id": 33512367, "question_id": 33512259, "link": "https://stackoverflow.com/questions/33512259/create-the-array-of-spreadsheets/33512367#33512367", "title": "Create the array of spreadsheets", "body": "<p>You have declared <code>ArrayOne</code> as type <code>Worksheet</code>, but you're populating it with strings.</p>\n\n<p>Should be like this:</p>\n\n<pre><code>Dim ArrayOne(11) As Worksheet\nSet ArrayOne(0) = Worksheets(\"January 2015\")\nSet ArrayOne(1) = Worksheets(\"February 2015\")\n'...etc\n</code></pre>\n\n<p>You don't show where <code>ArrayTwo</code> comes from.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 4654178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d84fcf396d47fde34a63ea050de0fa9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/4654178/jack"}, "edited": false, "score": 0, "creation_date": 1446602526, "post_id": 33512393, "comment_id": 54808234, "body": "Just a quick question, do i  even need this -&gt; strArrayone(1).Protect DrawingObjects:=False, Contents:=False, _"}, {"owner": {"reputation": 26, "user_id": 5522327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5b1cc2233d6c04388c2450a540f5ff?s=128&d=identicon&r=PG&f=1", "display_name": "BrandonCoder", "link": "https://stackoverflow.com/users/5522327/brandoncoder"}, "reply_to_user": {"reputation": 19, "user_id": 4654178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d84fcf396d47fde34a63ea050de0fa9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/4654178/jack"}, "edited": false, "score": 0, "creation_date": 1446603339, "post_id": 33512393, "comment_id": 54808421, "body": "If you are just adding an unprotected worksheet and naming it, then I don&#39;t see any reason for that line of code.  What exactly are you trying to do?"}], "tags": [], "owner": {"reputation": 26, "user_id": 5522327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5b1cc2233d6c04388c2450a540f5ff?s=128&d=identicon&r=PG&f=1", "display_name": "BrandonCoder", "link": "https://stackoverflow.com/users/5522327/brandoncoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1446601956, "creation_date": 1446601956, "answer_id": 33512393, "question_id": 33512259, "link": "https://stackoverflow.com/questions/33512259/create-the-array-of-spreadsheets/33512393#33512393", "title": "Create the array of spreadsheets", "body": "<p>You're trying to assign a <code>String</code> value to a <code>Worksheet</code> data type.  You could declare <code>String</code> variables for the worksheet names, and <code>Worksheet</code> variables for the actual worksheets.  Something like this perhaps:</p>\n\n<pre><code>Dim strArrayOne(11) As String\nDim wsArrayOne(11) As Worksheet\n\nstrArrayOne(0) = \"January 2015\"\nstrArrayOne(1) = \"February 2015\"\nstrArrayOne(2) = \"March 2015\"\nstrArrayOne(3) = \"April 2015\"\n\nSet wsArrayOne(1) = Sheets.Add\nSheets.Add.Name = strArrayOne(1)\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4654178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2d84fcf396d47fde34a63ea050de0fa9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/4654178/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 33512393, "answer_count": 2, "score": 0, "last_activity_date": 1446602029, "creation_date": 1446600948, "last_edit_date": 1446602029, "question_id": 33512259, "link": "https://stackoverflow.com/questions/33512259/create-the-array-of-spreadsheets", "title": "Create the array of spreadsheets", "body": "<p>I have the following array of worksheets:</p>\n\n<pre><code> Dim ArrayOne(11) As Worksheet\nArrayOne(0) = \"January 2015\"\nArrayOne(1) = \"February 2015\"\nArrayOne(2) = \"March 2015\"\nArrayOne(3) = \"April 2015\"\nArrayOne(4) = \"May 2015\"\nArrayOne(5) = \"June 2015\"\nArrayOne(6) = \"July 2015\"\nArrayOne(7) = \"August 2015\"\nArrayOne(8) = \"September 2015\"\nArrayOne(9) = \"October 2015\"\nArrayOne(10) = \"November 2015\"\nArrayOne(11) = \"December 2015\"\n</code></pre>\n\n<p>and when I'm trying to do the following: </p>\n\n<pre><code>Set ArrayOne(1) = Sheets.Add\nSheets.Add.Name = ArrayOne(1)  \nArrayOne(1).Protect DrawingObjects:=False, Contents:=False, _\n</code></pre>\n\n<p>It gives me an error: </p>\n\n<blockquote>\n  <p>Object variable or With block variable not set</p>\n</blockquote>\n\n<p>And the error points here:</p>\n\n<pre><code> ArrayTwo(0) = \"January 2015\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446597502, "post_id": 33511749, "comment_id": 54806988, "body": "Try your vlookup without the <code>worksheetFunction</code> Just do <code>Application.Vlookup...</code>"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 1, "creation_date": 1446598603, "post_id": 33511749, "comment_id": 54807289, "body": "Are the values you&#39;re looking for numbers or text? Are they formatted as numbers or text?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446599179, "post_id": 33511749, "comment_id": 54807439, "body": "In your data set use the clean function to and trim function <code>=Trim(Clean(A1))</code> this will should get rid of any unwanted characters."}, {"owner": {"reputation": 91, "user_id": 5302295, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1605e4427904cd1ae1b65ae86a180d7?s=128&d=identicon&r=PG&f=1", "display_name": "willlow1044", "link": "https://stackoverflow.com/users/5302295/willlow1044"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446654574, "post_id": 33511749, "comment_id": 54835298, "body": "@scott - what is the difference between using the worksheetFunction and Application forms? Also, when I tried just taking out the worksheetFunction portion of the code I receive a type mismatch."}, {"owner": {"reputation": 91, "user_id": 5302295, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1605e4427904cd1ae1b65ae86a180d7?s=128&d=identicon&r=PG&f=1", "display_name": "willlow1044", "link": "https://stackoverflow.com/users/5302295/willlow1044"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1446654748, "post_id": 33511749, "comment_id": 54835431, "body": "@Enigmativity I checked and they are all general format values in both sets of data (the search terms and in the range to be searched)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446655274, "post_id": 33511749, "comment_id": 54835823, "body": "See <a href=\"http://www.mrexcel.com/forum/excel-questions/584913-application-vs-application-worksheetfunction.html\" rel=\"nofollow noreferrer\">This</a>. One of the answers gives a great answer to the difference.  As to the type mismatch without the code it is hard to figure out."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446660683, "post_id": 33511749, "comment_id": 54839572, "body": "@ScottCraner type mismatch may occur with any strongly-typed variable container because the <code>Application.Vlookup</code> can return an <code>Error</code> type, so  if you&#39;re assigning the result of <code>Application.VLookup</code>, need to assign it to a variant type, and then test for error -- IOW you can&#39;t assign an Error value to a <code>Long</code> data type, etc."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1446661132, "post_id": 33511749, "comment_id": 54839870, "body": "@DavidZemens You are correct and it is good to have as an explanation for future reference. I was aware of that I wanted to see the code before assuming that was the issue. :) But it appears as of the last edit that the OP may have figured out the issue ."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1446660586, "post_id": 33528897, "comment_id": 54839508, "body": "What is the full formula you&#39;re using? It&#39;s perfectly expected in some circumstances that VLOOKUP will return an &quot;approximate&quot; match unless you use the Exact Match parameter, OR the data is alpha-sorted."}, {"owner": {"reputation": 91, "user_id": 5302295, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1605e4427904cd1ae1b65ae86a180d7?s=128&d=identicon&r=PG&f=1", "display_name": "willlow1044", "link": "https://stackoverflow.com/users/5302295/willlow1044"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1446675472, "post_id": 33528897, "comment_id": 54847877, "body": "@DavidZemens Yes, I believe that the I had the range_lookup value set to true which I didn&#39;t realise returned approximate matches.  <i>Sigh</i> Live and learn."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1446676228, "post_id": 33528897, "comment_id": 54848241, "body": "I got burned by that back in 2008, too. Mine went out to about a dozen clients before we caught the error!  Cheers."}], "tags": [], "owner": {"reputation": 91, "user_id": 5302295, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1605e4427904cd1ae1b65ae86a180d7?s=128&d=identicon&r=PG&f=1", "display_name": "willlow1044", "link": "https://stackoverflow.com/users/5302295/willlow1044"}, "is_accepted": false, "score": 0, "last_activity_date": 1446660101, "creation_date": 1446660101, "answer_id": 33528897, "question_id": 33511749, "link": "https://stackoverflow.com/questions/33511749/vlookup-throws-errors-for-some-values-but-not-others/33528897#33528897", "title": "VLookup throws errors for some values but not others", "body": "<p>Ok, palm to face moment.  The data set that I was searching through is fairly large so somehow when I set the named range it was only set on a sub-set of the data! Not sure how that happended...</p>\n\n<p>This still doesn't explain the inconsistent results for \"United Statess\" returning \"United Kingdom\" instead which just made debugging that much harder.</p>\n\n<p>Thanks for your help.</p>\n"}], "owner": {"reputation": 91, "user_id": 5302295, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1605e4427904cd1ae1b65ae86a180d7?s=128&d=identicon&r=PG&f=1", "display_name": "willlow1044", "link": "https://stackoverflow.com/users/5302295/willlow1044"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446660101, "creation_date": 1446597315, "last_edit_date": 1446659697, "question_id": 33511749, "link": "https://stackoverflow.com/questions/33511749/vlookup-throws-errors-for-some-values-but-not-others", "title": "VLookup throws errors for some values but not others", "body": "<p>VLookup is throwing an error when I search for some string values and not others:</p>\n\n<blockquote>\n  <p>Run-time error '1004': Unable to get the VLookup property of the Worksheet Function class</p>\n</blockquote>\n\n<p>Apparently this error indicates that there was no value found BUT to my human eye the values match!  </p>\n\n<p>Is this the result of a hidden character or a space or something I can't see?  </p>\n\n<p>How do I go about ensuring that values on one page are actually the same as values on another?</p>\n\n<p>Also, I thought that maybe I'm not searching where I think I'm searching which would explain why I can't find some of the values. As a test I changed the return value in the column and the change came back correctly. Then I change the lookup value which should have thrown an error but it didn't. It returned a different value instead. I searched for \"United States\" which isn't there and instead it returned the value for \"United Kingdom\" instead.</p>\n"}, {"tags": ["excel", "ms-access-2007", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5165550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d27e85cb3308fe648172613d42ca03?s=128&d=identicon&r=PG&f=1", "display_name": "James Zen", "link": "https://stackoverflow.com/users/5165550/james-zen"}, "is_accepted": true, "score": 0, "last_activity_date": 1446597528, "creation_date": 1446597528, "answer_id": 33511779, "question_id": 33511666, "link": "https://stackoverflow.com/questions/33511666/compact-an-external-access-accdb-database/33511779#33511779", "title": "Compact an external Access (.accdb) database", "body": "<p>solved question myself by looking at some online reference, if anyone needs it here it is:</p>\n\n<p>Dim oApp As Object</p>\n\n<p>Set oApp = CreateObject(\"Access.Application\")</p>\n\n<p>oApp.DBEngine.CompactDatabase SourcedDatabase, DestDatabase</p>\n\n<p>Kill SourcedDatabase</p>\n\n<p>Name DestDatabase As SourcedDatabase</p>\n\n<p>Set oApp = Nothing</p>\n"}], "owner": {"reputation": 1, "user_id": 5165550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d27e85cb3308fe648172613d42ca03?s=128&d=identicon&r=PG&f=1", "display_name": "James Zen", "link": "https://stackoverflow.com/users/5165550/james-zen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "closed_date": 1446611270, "accepted_answer_id": 33511779, "answer_count": 1, "score": -1, "last_activity_date": 1446598253, "creation_date": 1446596782, "last_edit_date": 1531161705, "question_id": 33511666, "link": "https://stackoverflow.com/questions/33511666/compact-an-external-access-accdb-database", "closed_reason": "Needs more focus", "title": "Compact an external Access (.accdb) database", "body": "<p>I have tried many codes to do this task, and none of them seems to work, anyone can help me with this problem?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1446596613, "post_id": 33511426, "comment_id": 54806724, "body": "remove the .select at the end of the find statement."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1446601673, "creation_date": 1446601673, "answer_id": 33512350, "question_id": 33511426, "link": "https://stackoverflow.com/questions/33511426/how-to-dim-and-set-variables-to-create-a-do-while-loop-by-using-the-find-functio/33512350#33512350", "title": "How to Dim and Set Variables to create a Do While loop by using the find function and offset to cut-paste to another place", "body": "<p>A few errors in your code in addition to @Scott Craner's comment - try this:</p>\n\n<pre><code>Sub cdformatdata()\n\nDim closeddatecell As Range\nDim firstaddress As String\n\n    With ActiveSheet.Columns(3)\n\n        Set closeddatecell = .Find(What:=\"Closed Date/Time\", After:=.Cells(1), _\n                                   LookIn:=xlFormulas, LookAt:=xlPart)\n\n        If Not closeddatecell Is Nothing Then\n            firstaddress = closeddatecell.Address\n            Do\n                closeddatecell.Offset(-1, 0).Copy closeddatecell.Offset(0, -1)\n                closeddatecell.Offset(-1, 0).Clear\n\n                Set closeddatecell = .FindNext(closeddatecell)\n\n            Loop While (Not closeddatecell Is Nothing) And _\n                 closeddatecell.Address &lt;&gt; firstaddress\n\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446601673, "creation_date": 1446595248, "last_edit_date": 1531164843, "question_id": 33511426, "link": "https://stackoverflow.com/questions/33511426/how-to-dim-and-set-variables-to-create-a-do-while-loop-by-using-the-find-functio", "title": "How to Dim and Set Variables to create a Do While loop by using the find function and offset to cut-paste to another place", "body": "<p>Can you suggest what is wrong with code? A Run-time Error '424 \"Object required\" highlights the beginning of code (Set CloseddateCell). Using a do loop because there are different types of coupons and the report generates different transactions each time. Not sure if it is the loop or naming of Dim is correct\u2026<br>\nI want to loop through column (3) find \u201cClosed Date/Time\u201d cut/paste \u201cCouponType\u201d in column(2) Alongside each transaction that is under its CouponType.</p>\n\n<pre><code>Sub cdformatdata()\n\nDim closeddatecell As Range\nDim coupontype As String\nDim firstaddress As Range\nDim newcouponplace As Range\n\n\n\nSet closeddatecell = Cells.Find(What:=\"Closed Date/Time\", After:=ActiveCell, LookIn:= _\n                        xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n                        xlNext, MatchCase:=False, SearchFormat:=False).Select\n\nDo\n    If ActiveCell.Value = (closeddatecell) Then\n        coupontype = ActiveCell.Offset(-1, 0).Cells.Cut\n        newcouponplace = ActiveCell.Offset(0, -1).PasteSpecial\n    End If\n\n    Set closeddatecell = closeddatecell.FindNext(closeddatecell)\n\nLoop While Not closeddatecell Is Nothing And closeddatecell.Address &lt;&gt; firstaddress And Selection.Value &lt;&gt; \"\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1446595280, "post_id": 33511304, "comment_id": 54806344, "body": "Your strcomp cells are backward, they should be <code>(row,Arrival)</code> and <code>(row,Departure)</code>"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1446598129, "post_id": 33511304, "comment_id": 54807148, "body": "Agree with @Scott Craner, but your <code>k</code> value is also wrong. This is deriving the number of rows in the range &quot;A1:A[end]&quot; but you&#39;re starting the comparison from row 2 so you&#39;re checking empty rows at the bottom. Change that line to: <code>k = sh.Cells(sh.Rows.Count, &quot;A&quot;).End(xlUp).Row</code>"}], "owner": {"reputation": 962, "user_id": 4787855, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/809517039155976/picture?type=large", "display_name": "Lucas Crostarosa", "link": "https://stackoverflow.com/users/4787855/lucas-crostarosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 641, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446594487, "creation_date": 1446594487, "last_edit_date": 1531164843, "question_id": 33511304, "link": "https://stackoverflow.com/questions/33511304/vba-string-match-with-a-for-loop-and-strcomp", "title": "VBA String Match with a For Loop and StrComp", "body": "<p>I am trying to use a for loop to change a cell in a column to \"truck\" if the conditions are met. </p>\n\n<p>With the code below, some rows are going through the loop incorrectly.\nFor instance: Lets say Milwaukee is the departure city, and Doral is the Arrival, it will still put in a \"truck\" in column 13.</p>\n\n<p>Can anyone offer direction on how to fix?</p>\n\n<pre><code>Sub VBAtest()\n\n'Declare Variables\nDim Departure As Integer\nDim Arrival As Integer\nDim row As Integer\nDim sh As Worksheet\nDim k As Long\n\n'Initialize Variables\nSet sh = ThisWorkbook.ActiveSheet\nDeparture = 4\nArrival = 8    \n\n'Count Rows and Store in Variable\nk = sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).Rows.Count\n\n'For Loop that is putting \"Truck\" in the wrong places\nFor row = 2 To k\n    If StrComp(Cells(Arrival, row), \"Doral\") = 1 Then\n        If StrComp(Cells(Departure, row), \"Albany\") = 1 Then\n            Cells(row, 13) = \"truck\"\n        End If\n    End If\nNext row\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "worksheet-function"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5042277, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c89b1218e7f560e572253418d901bde7?s=128&d=identicon&r=PG&f=1", "display_name": "Tempyr", "link": "https://stackoverflow.com/users/5042277/tempyr"}, "edited": false, "score": 1, "creation_date": 1446593267, "post_id": 33510968, "comment_id": 54805634, "body": "I tried using the full zip and just the first 3 digits but its still outputting #N/A. I put the value I am searching for in E2 and the formula in F2. Oh and I made sure the list is sorted as ascending."}, {"owner": {"reputation": 47, "user_id": 5042277, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c89b1218e7f560e572253418d901bde7?s=128&d=identicon&r=PG&f=1", "display_name": "Tempyr", "link": "https://stackoverflow.com/users/5042277/tempyr"}, "edited": false, "score": 0, "creation_date": 1446593671, "post_id": 33510968, "comment_id": 54805787, "body": "If i pull one of the values from Column A into E2 it works, but the value wont always be exactly as in Column A since each zone has a range of zip codes. It uses the first 3 digits of the zip codes."}, {"owner": {"reputation": 47, "user_id": 5042277, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c89b1218e7f560e572253418d901bde7?s=128&d=identicon&r=PG&f=1", "display_name": "Tempyr", "link": "https://stackoverflow.com/users/5042277/tempyr"}, "edited": false, "score": 1, "creation_date": 1446594246, "post_id": 33510968, "comment_id": 54805986, "body": "Whoops guess I did have an extra space in there. This is working great now. Thanks a bunch!"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1446592888, "creation_date": 1446592888, "answer_id": 33510968, "question_id": 33510891, "link": "https://stackoverflow.com/questions/33510891/search-zip-code-range-and-pull-corresponding-zone/33510968#33510968", "title": "Search ZIP code range and pull corresponding Zone", "body": "<p>If <code>Lower Bounds</code> is in A1 and what you are looking up in E2, please try: </p>\n\n<pre><code>=INDEX(C:C,MATCH(E2,A:A))  \n</code></pre>\n\n<p>Make sure ColumnA is sorted ascending.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 5042277, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c89b1218e7f560e572253418d901bde7?s=128&d=identicon&r=PG&f=1", "display_name": "Tempyr", "link": "https://stackoverflow.com/users/5042277/tempyr"}, "edited": false, "score": 0, "creation_date": 1446593497, "post_id": 33510984, "comment_id": 54805727, "body": "I tried removing the upper bounds and making the list just 2 columns. The data is now from A10:C101, so I used the following formula. <code>=LOOKUP(2,A10:A101,B10:B101)</code>"}], "tags": [], "owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1446592972, "creation_date": 1446592972, "answer_id": 33510984, "question_id": 33510891, "link": "https://stackoverflow.com/questions/33510891/search-zip-code-range-and-pull-corresponding-zone/33510984#33510984", "title": "Search ZIP code range and pull corresponding Zone", "body": "<p>Is removing the upper bounds and creating a two column list out of the question?\nIf not then you can use =LOOKUP(2,A10:A101,C10:D101)</p>\n\n<pre><code>Zip  Zone\n004  008\n005  008\n006  045\n007  045\n009  045\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5042277, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c89b1218e7f560e572253418d901bde7?s=128&d=identicon&r=PG&f=1", "display_name": "Tempyr", "link": "https://stackoverflow.com/users/5042277/tempyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "accepted_answer_id": 33510968, "answer_count": 2, "score": 2, "last_activity_date": 1447505805, "creation_date": 1446592497, "last_edit_date": 1447505805, "question_id": 33510891, "link": "https://stackoverflow.com/questions/33510891/search-zip-code-range-and-pull-corresponding-zone", "title": "Search ZIP code range and pull corresponding Zone", "body": "<p>I have a workbook that has the first three digits of a ZIP code in both columns A and B. A is the lower bound of the range and B is the upper bound. I then have the corresponding zone for that ZIP code range in column C. I tried the following formula with no luck.    </p>\n\n<pre><code>=LOOKUP(2,1/((I11&gt;=A10:A101)*(I11&lt;=B10:B101)),D10:D101)\n</code></pre>\n\n<p>What I am trying to accomplish is to use this formula to grab the appropriate zone for any ZIP code entered, to streamline the process of doing a cost analysis for a potential customer. If it is easier to achieve this using a VBA script I am open to that as well.</p>\n\n<p>Here is an example of the first three rows of data from my workbook:</p>\n\n<pre><code>Lower Bounds | Upper Bounds | Zone\n004          | 005          | 008\n006          | 007          | 045\n009          |              | 045\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 1, "creation_date": 1446644753, "post_id": 33510678, "comment_id": 54828047, "body": "it will return you <code>Compile error: Expected: line number or label or statement or end of statement</code>, should be <code>Right(cell.Value,2)</code>"}], "tags": [], "owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1446591439, "creation_date": 1446591439, "answer_id": 33510678, "question_id": 33510536, "link": "https://stackoverflow.com/questions/33510536/if-statement-to-check-text-within-cells/33510678#33510678", "title": "IF statement to check text within cells", "body": "<p>This may be a hack based on your sample input but try this:</p>\n\n<pre><code>if(Right(cell.Value) &lt;&gt; \"01\") then\n    cell.Value = Left(cell.Value, 7)\nend if\n</code></pre>\n\n<p>What this does is checks the right 2 most characters, see's if they are not \"01\" and proceeds to do your code if they are in fact not \"01\". I'll need more information if you're doing something more complex.</p>\n"}, {"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1446591781, "creation_date": 1446591781, "answer_id": 33510746, "question_id": 33510536, "link": "https://stackoverflow.com/questions/33510536/if-statement-to-check-text-within-cells/33510746#33510746", "title": "IF statement to check text within cells", "body": "<p>So something like this?</p>\n\n<pre><code>Sub TruncateCells()\n    Dim strCellVal as String\n    Dim arrCellValParts as Variant\n    For Each cell In Selection\n        strCellVal = cell.Value\n        If Len(strCellVal) &gt; 7 Then\n            arrCellValParts = Split(strCellVal, \":\")\n            On Error Resume Next 'It will throw an error if there's only 3 parts\n            If arrCellValParts(3) = \"01\" or arrCellValParts(4) = \"01\" Then\n                cell.Value = Left(strCellVal, 7)\n            End If\n            On Error Goto 0\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "is_accepted": false, "score": 0, "last_activity_date": 1446591972, "creation_date": 1446591972, "answer_id": 33510783, "question_id": 33510536, "link": "https://stackoverflow.com/questions/33510536/if-statement-to-check-text-within-cells/33510783#33510783", "title": "IF statement to check text within cells", "body": "<p>There's probably a better way, but this will look at the length of your cell value and if it's longer than 7 characters and the last two characters are \"01\" then it will truncate the same way as your original code. If it's 7 or fewer characters long or the last two digits are not \"01\" then it will not truncate. </p>\n\n<pre><code>Sub TruncateCells()\n    For Each cell In Selection\n        If Len(cell.Value) &gt; 7 And Right(cell.Value, 2) = \"01\" Then\n            cell.Value = Left(cell.Value, 7)\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1446618884, "creation_date": 1446618884, "answer_id": 33515184, "question_id": 33510536, "link": "https://stackoverflow.com/questions/33510536/if-statement-to-check-text-within-cells/33515184#33515184", "title": "IF statement to check text within cells", "body": "<p>Is be inclined to do this directly on the worksheet: use =Left(, 7) where the first argument is the cell. Copy this formula downwards and / or across as appropriate.</p>\n\n<p>This way you avoid using VBA and you retain the original data, and will work with repeated calculation.</p>\n\n<p>Hide the original columns from view if you must.</p>\n"}], "owner": {"reputation": 319, "user_id": 5522197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/doLaR.jpg?s=128&g=1", "display_name": "saheed", "link": "https://stackoverflow.com/users/5522197/saheed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1446618884, "creation_date": 1446590817, "last_edit_date": 1446591912, "question_id": 33510536, "link": "https://stackoverflow.com/questions/33510536/if-statement-to-check-text-within-cells", "title": "IF statement to check text within cells", "body": "<p>I've been using the following macro in Excel to replace the contents of a cell with the first seven characters currently in the cell:</p>\n\n<pre><code>Sub TruncateCells()\n\n    For Each cell In Selection\n        cell.Value = Left(cell.Value, 7)\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>The values in these cells are </p>\n\n<blockquote>\n  <p>A*nn:nn:nn:nn </p>\n</blockquote>\n\n<p>or </p>\n\n<blockquote>\n  <p>A*nn:nn:nn</p>\n</blockquote>\n\n<p>or </p>\n\n<blockquote>\n  <p>A*nn:nn</p>\n</blockquote>\n\n<p>Where n is a number and * is just an asterisk (not a wildcard)</p>\n\n<p>I want to modify the macro so that it does not run on cells where the third and fourth pairs of nn is anything other than '01.' So it should only run if a cell is:</p>\n\n<blockquote>\n  <p>A*nn:nn (in this case it doesn't modify the cell)</p>\n</blockquote>\n\n<p>or</p>\n\n<blockquote>\n  <p>A*nn:nn:01</p>\n</blockquote>\n\n<p>or</p>\n\n<blockquote>\n  <p>A*nn:nn:01:01</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1446591958, "creation_date": 1446591958, "answer_id": 33510779, "question_id": 33510123, "link": "https://stackoverflow.com/questions/33510123/goal-seek-macro-changing-cell-reference-not-a-hard-value/33510779#33510779", "title": "Goal seek macro, changing cell reference not a hard value", "body": "<pre><code>Public Function GoalSeek(Goal As Double, ChangingCell As Range) As Double\n   Dim changingCellVal As Double\n\n   'Ensure the user only passes in a single cell, not a range of cells\n   if(ChangingCell.Rows.Count = 1 And ChangingCell.Columns.Count = 1) Then\n       changingCellVal = ChangingCell.Value\n   end if\n\n   'Calculate GoalSeek\n   GoalSeek = 0\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 5522327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5b1cc2233d6c04388c2450a540f5ff?s=128&d=identicon&r=PG&f=1", "display_name": "BrandonCoder", "link": "https://stackoverflow.com/users/5522327/brandoncoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1446592824, "creation_date": 1446592824, "answer_id": 33510955, "question_id": 33510123, "link": "https://stackoverflow.com/questions/33510123/goal-seek-macro-changing-cell-reference-not-a-hard-value/33510955#33510955", "title": "Goal seek macro, changing cell reference not a hard value", "body": "<p>You could create a range object for the cell that will be changing by using the DirectPrecedents method on cell D424.  This is assuming D424 refers only to one cell.</p>\n\n<pre><code>Sub MyGoalSeek()\n\nDim precedentRange As Range\n\nSet precedentRange = Range(\"D424\").DirectPrecedents\n\nRange(\"D1\").GoalSeek Goal:=0.17, ChangingCell:=precedentRange\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5522159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550fae3324b2c0c1a37367ef62123b84?s=128&d=identicon&r=PG&f=1", "display_name": "Calvin", "link": "https://stackoverflow.com/users/5522159/calvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1567, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446592824, "creation_date": 1446588945, "last_edit_date": 1446589252, "question_id": 33510123, "link": "https://stackoverflow.com/questions/33510123/goal-seek-macro-changing-cell-reference-not-a-hard-value", "title": "Goal seek macro, changing cell reference not a hard value", "body": "<p>I am trying to make a goal seek macro for my excel model. Is it possible to create a macro that the <code>ChangingCell</code> is not a hard value but an equal formula that refers to a hard value. </p>\n\n<pre><code>Range(\"D1\").GoalSeek Goal:=0.17, ChangingCell:=Range(\"D424\")\n</code></pre>\n\n<p>So in this case cell D424 would be = to another cell that has a hard value in it. The reason why I can set the <code>ChangingCell</code> directly to D424 is that the goal seek reference for the changing cell changes based on various selections on the file. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 1, "creation_date": 1446588986, "post_id": 33510031, "comment_id": 54803828, "body": "It&#39;s worth noting that if OP hadn&#39;t used <code>On Error Resume Next</code>, the error would have been a lot more easily visible and debuggable."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1446589445, "post_id": 33510031, "comment_id": 54804062, "body": "@nwhaught - I knew there was a reason I don&#39;t use those statements (they can hide some info for debugging), good call!"}, {"owner": {"reputation": 13, "user_id": 5522091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ec49dc5b2b80952266243b63a35564?s=128&d=identicon&r=PG&f=1", "display_name": "DavidKn", "link": "https://stackoverflow.com/users/5522091/davidkn"}, "edited": false, "score": 1, "creation_date": 1446651811, "post_id": 33510031, "comment_id": 54833295, "body": "Awesome, this small tweak makes it work perfectly.  I&#39;m just learning this VBA and seems like a lot of functions and properties to figure out how they work.  Thanks again, and I did remove that &quot;on error resume next&quot; statement..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 5522091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ec49dc5b2b80952266243b63a35564?s=128&d=identicon&r=PG&f=1", "display_name": "DavidKn", "link": "https://stackoverflow.com/users/5522091/davidkn"}, "edited": false, "score": 0, "creation_date": 1446653150, "post_id": 33510031, "comment_id": 54834273, "body": "@DavidKn - I found that using the macro recorder greatly helps in learning VBA.  Record some mundane tasks, and try to change it up a bit...since the macro recorder records your steps exactly, in the code, try to learn how to change it and make it more dynamic.  And of course, Google and SO is a great resource when you&#39;re stuck."}, {"owner": {"reputation": 13, "user_id": 5522091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ec49dc5b2b80952266243b63a35564?s=128&d=identicon&r=PG&f=1", "display_name": "DavidKn", "link": "https://stackoverflow.com/users/5522091/davidkn"}, "edited": false, "score": 1, "creation_date": 1446676338, "post_id": 33510031, "comment_id": 54848294, "body": "@BruceWayne - will use the macro recorder and debugger.  thanks again for your quick response and help!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 5522091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ec49dc5b2b80952266243b63a35564?s=128&d=identicon&r=PG&f=1", "display_name": "DavidKn", "link": "https://stackoverflow.com/users/5522091/davidkn"}, "edited": false, "score": 0, "creation_date": 1446676454, "post_id": 33510031, "comment_id": 54848340, "body": "@DavidKn - also, you can press F8 when in a macro to go through it line by line.  The only time I do use <code>.Select</code> is when walking through a macro, I&#39;ll use say <code>Range(Cells(1,1),Cells(x,y)).Select</code>, then I can see my range being selected, to confirm if it&#39;s working or not.  Then in the &quot;final version&quot;, I comment out that line."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1446588556, "last_edit_date": 1495541683, "creation_date": 1446588556, "answer_id": 33510031, "question_id": 33509825, "link": "https://stackoverflow.com/questions/33509825/looping-through-worksheets-and-trying-to-count-the-data-in-columns/33510031#33510031", "title": "Looping through worksheets and trying to count the data in columns", "body": "<p>It's because of your use of <code>Set myRange...</code>  You don't need to <code>.Select</code> it. Just change that line to <code>Set myRange = ws.Columns(i)</code></p>\n\n<p>If you want to leave <code>.Select</code>, then the next line should be \n<code>NumRows = ws.application.worksheetfunction.counta(selection)</code>, but it is <strong>highly</strong> recommended you <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code></a>, this is just for your info.</p>\n"}], "owner": {"reputation": 13, "user_id": 5522091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ec49dc5b2b80952266243b63a35564?s=128&d=identicon&r=PG&f=1", "display_name": "DavidKn", "link": "https://stackoverflow.com/users/5522091/davidkn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 33510031, "answer_count": 1, "score": 1, "last_activity_date": 1446588905, "creation_date": 1446587739, "last_edit_date": 1446588905, "question_id": 33509825, "link": "https://stackoverflow.com/questions/33509825/looping-through-worksheets-and-trying-to-count-the-data-in-columns", "title": "Looping through worksheets and trying to count the data in columns", "body": "<p>I have a workbook of ten sheets.  In sheet 1, I want to list out sheet names (sheets 3 thru 10), column heading values in the sheet (columns 8 and beyond only) and for that column the number of cells that have data in it.  </p>\n\n<p>My code works for two of these three requirements.  On my sheet 1 (named: SheetName Columns) I get the Sheet Names in column A and Column Heading in column B, however not having any luck getting that sheet/columns number of data rows.</p>\n\n<p>On my sheet 1, column A gets duplicated per number of columns after column 7 on that sheet and that is fine.  </p>\n\n<pre><code>Sub ListColumnHeadings()\n\nDim cNbrs As Long, i As Integer, tr As Long, tc As Long, wst As Worksheet\nDim charList(300, 300) As String\n\nDim ws As Worksheet, OutputRow As Long\nDim myRange As Range\nDim NumRows As Integer\nDim colNbr As Range\n\nSet shSkip1 = ThisWorkbook.Sheets(\"SheetName Record Cnt\")\nSet shList = ThisWorkbook.Sheets(\"SheetName Columns\")\n\nOutputRow = 1\nOn Error Resume Next\n\nFor Each ws In Worksheets\n  If ws.Name &lt;&gt; shList.Name And ws.Name &lt;&gt; shSkip1.Name Then\n\n    cNbrs = ws.Range(\"A1\").CurrentRegion.Columns.Count\n\n    For i = 8 To cNbrs\n      shList.Cells(OutputRow, \"A\").Value = ws.Name\n      shList.Cells(OutputRow, \"B\").Value = ws.Cells(1, i)\n\n      Set myRange = ws.Columns(i).Select\n\n      NumRows = ws.Application.WorksheetFunction.CountA(myRange)\n      If NumRows &gt; 0 Then\n        shList.Cells(OutputRow, \"C\").Value = NumRows\n      End If\n\n      OutputRow = OutputRow + 1\n    Next i\n\n  End If\nNext ws\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1446588800, "post_id": 33509806, "comment_id": 54803717, "body": "I&#39;m not sure what you mean, when you double click a cell what happens?, and what do you want to happen or don&#39;t want to happen?"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 2047224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8288172656ffc781fb16761547e45a11?s=128&d=identicon&r=PG", "display_name": "lieutenantmudd", "link": "https://stackoverflow.com/users/2047224/lieutenantmudd"}, "edited": false, "score": 0, "creation_date": 1446588211, "post_id": 33509898, "comment_id": 54803434, "body": "Nope.  EnableEvents would suppress the BeforeDoubleClick macro itself, I am trying to ignore the physical clicks inside a macro called by BeforeDoubleClick"}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "reply_to_user": {"reputation": 47, "user_id": 2047224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8288172656ffc781fb16761547e45a11?s=128&d=identicon&r=PG", "display_name": "lieutenantmudd", "link": "https://stackoverflow.com/users/2047224/lieutenantmudd"}, "edited": false, "score": 0, "creation_date": 1446588803, "post_id": 33509898, "comment_id": 54803720, "body": "So, I am not sure I follow, correct me if I am wrong:  1) You double click, a macro fires 2) The macro launches a form 3) The form also captures the SAME double click and breaks  Is this correct?"}, {"owner": {"reputation": 47, "user_id": 2047224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8288172656ffc781fb16761547e45a11?s=128&d=identicon&r=PG", "display_name": "lieutenantmudd", "link": "https://stackoverflow.com/users/2047224/lieutenantmudd"}, "edited": false, "score": 0, "creation_date": 1446591086, "post_id": 33509898, "comment_id": 54804799, "body": "Yes.  Although breaks is a bit strong, unintentionally selects an item on my UserForm"}, {"owner": {"reputation": 47, "user_id": 2047224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8288172656ffc781fb16761547e45a11?s=128&d=identicon&r=PG", "display_name": "lieutenantmudd", "link": "https://stackoverflow.com/users/2047224/lieutenantmudd"}, "edited": false, "score": 0, "creation_date": 1446614431, "post_id": 33509898, "comment_id": 54811234, "body": "As I poorly stated in my question (&quot;sleeping the thread works&quot;), I know how to hack around the problem using various methods.  I am wondering if there&#39;s a built in or idiomatic way to solve this issue"}], "tags": [], "owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1446589157, "last_edit_date": 1446589157, "creation_date": 1446587988, "answer_id": 33509898, "question_id": 33509806, "link": "https://stackoverflow.com/questions/33509806/doubleclick-captured-in-my-userform/33509898#33509898", "title": "DoubleClick captured in my UserForm", "body": "<p>If the issue is the form you are launching from the macro is catching the same double click event try the following:</p>\n\n<p>1) Have your macro call a new sub routine via 'Application.OnTime()' schedule it to run just long enough in the future to pass the 'physical click', maybe 1s. Instead of directly calling Form.Show(), as you are currently doing.</p>\n\n<p>2) Your new subroutine just has to do: Form.Show(), and whatever else you deem necessary.</p>\n"}], "owner": {"reputation": 47, "user_id": 2047224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8288172656ffc781fb16761547e45a11?s=128&d=identicon&r=PG", "display_name": "lieutenantmudd", "link": "https://stackoverflow.com/users/2047224/lieutenantmudd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446589157, "creation_date": 1446587662, "question_id": 33509806, "link": "https://stackoverflow.com/questions/33509806/doubleclick-captured-in-my-userform", "title": "DoubleClick captured in my UserForm", "body": "<p>As I bet I can tell the following is happening in my Excel 2013 macro:</p>\n\n<ol>\n<li>Sub WorkSheet_BeforeDoubleClick is calling a form</li>\n<li>Some logic populates and shows the form</li>\n<li>The double click event is captured by the form as an undesired selection in a listbox</li>\n</ol>\n\n<p>Is there a correct way to suppress the double click in the middle of the subroutine?  I have ideas for getting around it (sleeping the thread works, re-positioning the form works, locking and unlocking the listbox based on other events works)  Those are all poor workarounds and I am hoping for a built-in solution that I am just not aware of. </p>\n\n<p>(And setting Cancel = True does not work because I believe setting only kicks in once the code is finished running.  The double click becomes a selection in the middle of the subroutines)</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5520893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d81ab814beba99b153e7d6279cc651c?s=128&d=identicon&r=PG&f=1", "display_name": "Smithmi8", "link": "https://stackoverflow.com/users/5520893/smithmi8"}, "edited": false, "score": 0, "creation_date": 1446646507, "post_id": 33517738, "comment_id": 54829288, "body": "This worked perfectly Thank you.  I was not sure about the title being shape 1, I read it on the MSDN website so I thought it was a built in function of PowerPoint, but you are right, better safe then sorry. if it accurate or if MS changes something then it will still perform the Job,  Once again, thanks"}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": true, "score": 4, "last_activity_date": 1446628227, "creation_date": 1446628227, "answer_id": 33517738, "question_id": 33509765, "link": "https://stackoverflow.com/questions/33509765/vba-powerpoint-slide-title/33517738#33517738", "title": "VBA PowerPoint slide Title", "body": "<p>You can use the HastTitle method of the Shapes Collection to check if a slide has a title placeholder:</p>\n\n<pre><code>If sld.Shapes.HasTitle then\n</code></pre>\n\n<p>You should also not rely on the title placeholder being shape 1 and rather loop through all shapes on the slide, checking each one as follows:</p>\n\n<pre><code>Option Explicit\n\n' Function to return an array of title texts from a presentation\n' Written by Jamie Garroch at http://youpresent.co.uk\n' Inputs : None\n' Outputs : Array of title strings\nFunction GetTitlesArr() As Variant\n  Dim oSld As Slide\n  Dim oShp As Shape\n  Dim iCounter As Integer\n  Dim arrTitles() As String\n  For Each oSld In ActivePresentation.Slides\n    For Each oShp In oSld.Shapes\n      With oShp\n        If .Type = msoPlaceholder Then\n          Select Case .PlaceholderFormat.Type\n            Case ppPlaceholderCenterTitle, ppPlaceholderTitle\n              ReDim Preserve arrTitles(iCounter)\n              arrTitles(iCounter) = oShp.TextFrame.TextRange.Text\n              iCounter = iCounter + 1\n          End Select\n        End If\n      End With\n    Next\n  Next\n  GetTitlesArr = arrTitles\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5520893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d81ab814beba99b153e7d6279cc651c?s=128&d=identicon&r=PG&f=1", "display_name": "Smithmi8", "link": "https://stackoverflow.com/users/5520893/smithmi8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8875, "favorite_count": 2, "accepted_answer_id": 33517738, "answer_count": 1, "score": 2, "last_activity_date": 1446628227, "creation_date": 1446587469, "last_edit_date": 1446589341, "question_id": 33509765, "link": "https://stackoverflow.com/questions/33509765/vba-powerpoint-slide-title", "title": "VBA PowerPoint slide Title", "body": "<p>I am working on a custom tool that generates customized Instructor notes for a given presentation.  I am having a problem where I am processing a presentation where a slide basically has no Title object on it Then I run through the code it is bi-passing my if statements with .</p>\n\n<p>I have reduced the code to the basics to make it as easy as possible.</p>\n\n<p>My test lesson has a normal slide with the text place holder filled out, the next slide is a logo slide with no title text box, just a copyright information and logo, (this is the slide that is having issues) and then another slide where the title place holder is present, but left blank.</p>\n\n<p>How do I check the individual slide to make sure that the title placeholder exists?</p>\n\n<pre><code>Public Sub GetTitle()\n    Dim pres As Presentation    'PowerPoint presentation\n    Dim sld As Slide            'Individual slide\n    Dim shp As Shape            'EIAG Text Shape\n    Dim ShpType As String       'Shape Type\n    Dim SldTitle As String      'Slide TITLE\n\n    'Go through each slide object\n    Set pres = ActivePresentation\n    For Each sld In ActivePresentation.Slides.Range\n    On Error Resume Next\n        If sld.Shapes(1).PlaceholderFormat.Type = ppPlaceholderCenterTitle Or sld.Shapes(1).PlaceholderFormat.Type = ppPlaceholderTitle Then\n            If sld.Shapes.Title.TextFrame.TextRange &lt;&gt; \"\" Then\n                SldTitle = sld.Shapes.Title.TextFrame.TextRange\n                Debug.Print SldTitle &amp; \" - Slide: \" &amp; CStr(sld.SlideNumber)\n            Else\n                Debug.Print \"BLANK TITLE - Slide: \" &amp; CStr(sld.SlideNumber)\n            End If\n        Else\n            ShpType = sld.Shapes.Item(1).Type\n            Debug.Print ShpType &amp; \"Not Processed There is no Title object\"\n        End If\n    Next sld\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1446587410, "post_id": 33509613, "comment_id": 54803001, "body": "Have you tried anything? If so, please post any code/formulas that you&#39;ve attempted to use.  Also kindly clarify: We start at the end of the list, and go up.  If we hit a date, use that date to fill the gap until the next date.  If, starting out, there is no date, use some default date?  So, your <code>Actual End Date</code> column will have some default date for all &quot;Veg&quot; category, and some Fruit?  Can you post a completed table, for an example?"}, {"owner": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446751797, "post_id": 33509613, "comment_id": 54885754, "body": "Each item has 9 dates, and they happen in process, e.g. the first item needs to happen before starting the next one, hence if there is an actual date present for 3rd row and the above are empty then I would like the actual date for 3rd row to be copied to actual date column of the above two. Also, if there is no date below for same item then put 1/1/2018."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446666310, "post_id": 33510231, "comment_id": 54842806, "body": "Thanks for this, also is it possible to make it copy the date up to with rows where there is no date (planned or actual end date), for example, if there is planned date for 4th apple row but there is an actual end date for 1st apple row and the row 2 and 3 are empty, so in this case I would like it to copy the planned date for 4th apple to row 2 and 3. is it possible to do this in vba?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446668037, "post_id": 33510231, "comment_id": 54843810, "body": "@danny - Does the above not do that? Can you restate your question (perhaps add it to your OP with an example?).  Which column do you want the planned date to go in?"}, {"owner": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446669097, "post_id": 33510231, "comment_id": 54844395, "body": "Planned Date is the third column, and the acutal end date is the fourth column, so if there is no date for both the fields then it should look for next available date in both columns and copy to blanks above until next date is available in either of columns."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446669703, "post_id": 33510231, "comment_id": 54844736, "body": "By &quot;next available&quot;, do you mean the next date going <i>down</i> the column, or <i>up</i>?"}, {"owner": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446669890, "post_id": 33510231, "comment_id": 54844848, "body": "Since these items are listed in a process so the items would not have happened if the ones before that is not there, so if there is actual end date or planned date then they would be copied up, else if there is none then it would have date of 1/1/2018."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446670176, "post_id": 33510231, "comment_id": 54845021, "body": "One final clarification - what does the above macro do that you <i>don&#39;t</i> want it to do?"}, {"owner": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446670580, "post_id": 33510231, "comment_id": 54845263, "body": "Above macro copies the date up to all the blank cells in one particular column without looking if there is a value present in the actual end date for a particular row because if there is then that value should move up. there is no need of planned date if there is an actual end date."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446671061, "post_id": 33510231, "comment_id": 54845518, "body": "@Danny - Can you use your table, that you have in the OP, and also add a &quot;completed&quot; table, with the dates filled in like expected?"}, {"owner": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446672963, "post_id": 33510231, "comment_id": 54846536, "body": "I have added in a table which I want to achieve"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446674406, "post_id": 33510231, "comment_id": 54847309, "body": "@danny - thanks! That clarified it for me, please see my edit."}, {"owner": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1446675424, "post_id": 33510231, "comment_id": 54847851, "body": "This looks greats, but can I just ask for some more help, since each nine rows refer to same type of item, but this code put the date of apple in banana, so instead can we do if there is no banana dates below then put 1/1/2018 (Custom date)."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1446674321, "last_edit_date": 1446674321, "creation_date": 1446589396, "answer_id": 33510231, "question_id": 33509613, "link": "https://stackoverflow.com/questions/33509613/iterate-and-copy-data-from-cells-with-data-for-cells-with-no-data-before-that-ce/33510231#33510231", "title": "Iterate and copy data from cells with data for cells with no data before that cell", "body": "<p>Okay, I have written something that should get you started.</p>\n\n<pre><code>Sub test()\nDim wsLastRow&amp;, partLastRow&amp;, nextRow&amp;, firstRow&amp;\nDim i&amp;, k&amp;\nDim custDate$\n\nwsLastRow = Cells(Rows.Count, 1).End(xlUp).Row ' this assumes your Column A will have the most data\n\nFor k = 3 To 4 ' using columns C and then D\n    For i = wsLastRow To 2 Step -1\n        If IsEmpty(Cells(i, k)) Then\n            custDate = WorksheetFunction.Text(InputBox(\"What date do you want to put, as there isn't one currently (dd/mm/yyyy)\"), \"dd/mm/yyyy\")\n            Cells(i, k).Value = custDate\n        Else\n            firstRow = i\n            partLastRow = Cells(i, k).End(xlUp).Row + 1\n            Range(Cells(firstRow, k), Cells(partLastRow, k)).FillUp\n            i = partLastRow\n        End If\n    Next i\nNext k\nEnd Sub\n</code></pre>\n\n<p>Note: When there's a blank cell, without a previous date, it's going to prompt <em>each time</em> for a date.  Let me know how you want to handle such dates, adn we can update that to do something else.  If you walk through the code with <kbd>F8</kbd> you'll see how this works.  Let me know any thoughts/changes necessary!</p>\n\n<p>Edit:</p>\n\n<p>The following code should work, per your comments and final table example.</p>\n\n<pre><code>Sub test2()\nDim wsLastRow&amp;, partLastRow&amp;, nextRow&amp;, firstRow&amp;\nDim i&amp;, k&amp;\nDim custDate$\nDim runLastRow As Boolean\n\nrunLastRow = False\n\nwsLastRow = Cells(Rows.Count, 1).End(xlUp).Row    ' this assumes your Column A will have the most data\ncustDate = WorksheetFunction.Text(InputBox(\"What date do you want to put, when there isn't one? (dd/mm/yyyy)\"), \"dd/mm/yyyy\")\n\nk = 3                        'noting the \"C\" Column\n\nFor i = wsLastRow To 2 Step -1\n    If IsEmpty(Cells(i, 3)) And IsEmpty(Cells(i, 4)) Then\n        Cells(i, k).Value = custDate\n        runLastRow = False\n    ElseIf IsEmpty(Cells(i, k)) And Cells(i, k + 1) &lt;&gt; \"\" Then\n        k = 4                ' Set the column to use as K\n        runLastRow = True\n    Else\n        k = 3\n        runLastRow = True\n    End If\n\n    If runLastRow Then\n        firstRow = i\n        partLastRow = WorksheetFunction.Max(Cells(i, 3).End(xlUp).Row + 1, Cells(i, 4).End(xlUp).Row + 1)\n        Range(Cells(firstRow, k), Cells(partLastRow, k)).FillUp\n        i = partLastRow\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1446712492, "creation_date": 1446586909, "last_edit_date": 1446712492, "question_id": 33509613, "link": "https://stackoverflow.com/questions/33509613/iterate-and-copy-data-from-cells-with-data-for-cells-with-no-data-before-that-ce", "title": "Iterate and copy data from cells with data for cells with no data before that cell", "body": "<p>Below I have listed the table which I require help on. What I'm trying to do is iterate through the list and copy the date (planned or actual) to the cells before that if they are empty and if there is no data cells after that for a particular type then enter a default date of an year after that.</p>\n\n<pre><code>**Category**    **Type**    **Planned Date**    **Actual End Date**\nFruit           Banana      \nFruit           Banana      \nFruit           Banana      \nFruit           Banana                              18/06/2015\nFruit           Banana      \nFruit           Banana      \nFruit           Banana         11/11/2017   \nFruit           Banana      \nFruit           Banana         21/12/2017   \nFruit           Apple       \nFruit           Apple       \nFruit           Apple       \nFruit           Apple                              11/01/2015\nFruit           Apple       \nFruit           Apple       \nFruit           Apple       \nFruit           Apple       \nFruit           Apple         18/12/2015    \n\nVeg            Cucumber     \nVeg            Cucumber     \n\nVeg            Cucumber       12/01/2016\n\nVeg            Cucumber     \n\nVeg            Cucumber       25/06/2016    \n\nVeg            Cucumber     \nVeg            Cucumber     \nVeg            Cucumber       03/11/2016    \nVeg            Cucumber     \n</code></pre>\n\n<p>I would like it to look like this;</p>\n\n<pre><code>**Category**    **Type**    **Planned Date**    **Actual End Date**\nFruit           Banana                              18/06/2015\nFruit           Banana                              18/06/2015\nFruit           Banana                              18/06/2015\nFruit           Banana                              18/06/2015\nFruit           Banana         11/11/2017\nFruit           Banana         11/11/2017\nFruit           Banana         11/11/2017   \nFruit           Banana         21/12/2017\nFruit           Banana         21/12/2017   \nFruit           Apple                              11/01/2015\nFruit           Apple                              11/01/2015\nFruit           Apple                              11/01/2015\nFruit           Apple                              11/01/2015\nFruit           Apple         18/12/2015\nFruit           Apple         18/12/2015\nFruit           Apple         18/12/2015\nFruit           Apple         18/12/2015\nFruit           Apple         18/12/2015    \n\nVeg            Cucumber       12/01/2016\nVeg            Cucumber       12/01/2016\n\nVeg            Cucumber       12/01/2016\n\nVeg            Cucumber       25/06/2016\n\nVeg            Cucumber       25/06/2016    \n\nVeg            Cucumber       03/11/2016\nVeg            Cucumber       03/11/2016\nVeg            Cucumber       03/11/2016    \nVeg            Cucumber       01/01/2018\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1446587622, "post_id": 33509497, "comment_id": 54803122, "body": "Is the listbox configured to display one column or more than one?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1446588942, "post_id": 33509497, "comment_id": 54803804, "body": "Try <code>Set rngNewTarget = Intersect(Target,Target.Offset(0,1))</code>? The idea is to use intersect to remove the left most column."}, {"owner": {"reputation": 13, "user_id": 5322287, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/73dc7612976c12c734b78023cedb0d71?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Larson", "link": "https://stackoverflow.com/users/5322287/scott-larson"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1446663894, "post_id": 33509497, "comment_id": 54841472, "body": "@ExcelHero it is one column, that needs to start at A3 and check everything there and after in A. If a value is added in a cell below what was previously the last cell, the item must be in the dropbox just after being added."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5322287, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/73dc7612976c12c734b78023cedb0d71?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Larson", "link": "https://stackoverflow.com/users/5322287/scott-larson"}, "edited": false, "score": 0, "creation_date": 1446647995, "post_id": 33509702, "comment_id": 54830347, "body": "Hi, what does the Count part do here? When I use this suggestion, the dropdown shows Cell B2 (correct) but then goes all the way down B (B3, B4...B2000). I would like to go from B2, C2.... (last Column with characters)2, which needs to be dynamic."}], "tags": [], "owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1446587221, "creation_date": 1446587221, "answer_id": 33509702, "question_id": 33509497, "link": "https://stackoverflow.com/questions/33509497/set-starting-point-for-usedrange/33509702#33509702", "title": "Set starting point for UsedRange", "body": "<p>Instead of:</p>\n\n<pre><code>Database.UsedRange.Rows(2)\n</code></pre>\n\n<p>Try:  </p>\n\n<pre><code>Database.Range(Database.Cells(2,2),Database.Cells(Database.UsedRange.Rows.Count, 2))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5322287, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/73dc7612976c12c734b78023cedb0d71?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Larson", "link": "https://stackoverflow.com/users/5322287/scott-larson"}, "edited": false, "score": 0, "creation_date": 1446651513, "post_id": 33509969, "comment_id": 54833067, "body": "Hi, I editing my code on my post to reflect entirely what&#39;s going on. I used your new way of expressing the range, but did not change the adding to combobox behavior, which I may need to if the current error can&#39;t get ironed out. Using the entire block you helped with would have introduced problems later on in the code, which I have added to the post."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1446588295, "creation_date": 1446588295, "answer_id": 33509969, "question_id": 33509497, "link": "https://stackoverflow.com/questions/33509497/set-starting-point-for-usedrange/33509969#33509969", "title": "Set starting point for UsedRange", "body": "<p>May be best to use specialcells, and loop through the cells that have values.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim rRng As Range, c As Range, ws As Worksheet\n    Set ws = Sheets(\"Database\")\n\n    Me.ComboBox1.Clear\n\n    Set rRng = ws.Rows(\"2:2\").SpecialCells(xlCellTypeConstants, 23)\n    For Each c In rRng.Cells\n        Me.ComboBox1.AddItem c\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 5322287, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/73dc7612976c12c734b78023cedb0d71?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Larson", "link": "https://stackoverflow.com/users/5322287/scott-larson"}, "is_accepted": true, "score": 0, "last_activity_date": 1446665182, "last_edit_date": 1446665182, "creation_date": 1446655547, "answer_id": 33527369, "question_id": 33509497, "link": "https://stackoverflow.com/questions/33509497/set-starting-point-for-usedrange/33527369#33527369", "title": "Set starting point for UsedRange", "body": "<p>Use Intersect to exclude columns</p>\n\n<pre><code>With Worksheets(\"Database\")\n    Set rng = Application.Intersect(.UsedRange.Rows(2), .Cells.Resize(.Columns.Count - 1).Offset(1))\n    End With\n</code></pre>\n\n<p>Change the line in question to the newly defined range</p>\n\n<pre><code>If IsEmpty(cLst) Then cLst = rng\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5322287, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/73dc7612976c12c734b78023cedb0d71?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Larson", "link": "https://stackoverflow.com/users/5322287/scott-larson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "accepted_answer_id": 33527369, "answer_count": 3, "score": 0, "last_activity_date": 1446665182, "creation_date": 1446586470, "last_edit_date": 1446651402, "question_id": 33509497, "link": "https://stackoverflow.com/questions/33509497/set-starting-point-for-usedrange", "title": "Set starting point for UsedRange", "body": "<p>I have a combobox drop down that populates items from a list, with a function to filter to dropdown options by characters type in the combobox gathered by the following code</p>\n\n<pre><code>Option Explicit\n\nPrivate cLstPrior As Variant\n\nPrivate Sub Worksheet_SelectionChangePrior(ByVal Target As Range)\n    cLstPrior = Application.Transpose(Database.Columns(\"1:1\").SpecialCells(xlCellTypeConstants, 23)) 'set module-level variable\n    Tool.priorCmb.List = cLstPrior        'initialize ComboBox to range Col A (UsedRange only)\n    Tool.priorCmb.ListIndex = -1     'set ComboBox value to empty\nEnd Sub\n\nPrivate Sub priorCmb_Change()\n   filterComboListPrior Tool.priorCmb, cLstPrior\nEnd Sub\n\nPrivate Sub priorCmb_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)\n    Tool.priorCmb.DropDown\nEnd Sub\n\nPrivate Sub priorCmb_GotFocus()   'or _MouseDown()\n    Tool.priorCmb.DropDown\nEnd Sub\n\nPublic Sub filterComboListPrior(ByRef cmbPrior As ComboBox, ByRef dLstPrior As Variant)\n    Dim itmPrior As Variant, lstPrior As String, selPrior As String\n\n\n    Application.EnableEvents = False\n    With cmbPrior\n        selPrior = .Value\n        If IsEmpty(cLstPrior) Then cLstPrior = Worksheets(\"Database\").Columns(\"1:1\").SpecialCells(xlCellTypeConstants, 23)\n        For Each itmPrior In cLstPrior\n            If Len(itmPrior) &gt; 1 Then If InStr(1, itmPrior, selPrior, 1) Then lstPrior = lstPrior &amp; itmPrior &amp; \"||\"\n        Next\n        If Len(lstPrior) &gt; 1 Then .List = Split(Left(lstPrior, Len(lstPrior) - 2), \"||\") Else .List = dLstPrior\n    End With\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>The data the combobox needs to populate with is all from Column 1 in this case, any cell with characters in it.\nThe issue is that there are blank cells at A1 and A2, so blank entries populate the combobox dropdown later on. I am trying to force the range to only include cells with values in them, but am getting an application-defined or object-defined error at <code>If IsEmpty(cLstPrior) Then cLstPrior = Worksheets(\"Database\").Columns(\"1:1\").SpecialCells(xlCellTypeConstants, 23)</code>\nI can't seem to figure this out. Also, is my <code>Application.Transpose</code> behavior correct or not needed?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446586398, "post_id": 33509418, "comment_id": 54802475, "body": "You need to clarify the <code>rows.count</code> in finding the last row to <code>...Sheets(&quot;M200 46mm Setting Log&quot;).Rows.Count...</code>. Just to be safe"}, {"owner": {"reputation": 17, "user_id": 5521972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ea11b03628c3ff04ed42f401f47092?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Witzke", "link": "https://stackoverflow.com/users/5521972/rob-witzke"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446651881, "post_id": 33509418, "comment_id": 54833346, "body": "Yeah, it&#39;s always the small nuances like this that get me. I&#39;ll definitely remember to do this in the future. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5521972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ea11b03628c3ff04ed42f401f47092?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Witzke", "link": "https://stackoverflow.com/users/5521972/rob-witzke"}, "edited": false, "score": 0, "creation_date": 1446652418, "post_id": 33511033, "comment_id": 54833740, "body": "Thank you so much! This worked perfectly for all of the settings I had to carry over. And thank you for explaining how it worked as well. As I mentioned in my original post (before that sentence got removed), I&#39;m pretty new to using macros and VBA, so I appreciate the opportunity to learn how it works rather than just copy, paste, and forget."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 0, "last_activity_date": 1446593215, "creation_date": 1446593215, "answer_id": 33511033, "question_id": 33509418, "link": "https://stackoverflow.com/questions/33509418/how-to-transfer-row-data-to-specific-cells-in-a-variable-sheet/33511033#33511033", "title": "How to transfer row data to specific cells in a variable sheet?", "body": "<p>This is easier than you might imagine. You don't need to loop through each of the worksheets because you can assign the target worksheet by its name: <code>Set ws = WorkSheets([name as a string])</code>. So you really only need to loop through the rows and pick up each sheet name.</p>\n\n<p>I'd also recommend creating an address map of each old sheet cell and its new sheet cell address. In your example, column \"B\" goes to \"D11\", so create a collection of all of these and simply loop through them for the copying. There are quicker ways of doing it but with only 100 or so different parts it's not worth worrying about.</p>\n\n<p>The code below shows you how to do both. From your question you mention that you have created templates for each new sheet. Presumably, then, the format is correctly set, so you've no need to do a copy/paste, just write each cell value to the new cell.</p>\n\n<p>By the way, the most obvious error in your code (and probably the reason for your error) is that this line: <code>Sheets(\"M200 46mm Setting Log\").Range(j, \"B\").Copy ...</code> should be <code>Sheets(\"M200 46mm Setting Log\").Cells(j, \"B\").Copy ...</code></p>\n\n<pre><code>Sub RunMe()\n    Dim wsLog As Worksheet\n    Dim wsPart As Worksheet\n    Dim sheetName As String\n    Dim addressMap As Collection\n    Dim map As Variant\n    Dim lastRow As Long\n    Dim r As Long\n\n    Set addressMap = New Collection\n    ' Map the transfer cell addresses\n    addressMap.Add SetRangeMap(\"B\", \"D11\")\n    ' 1st item is old log sheet column, 2nd is address of new sheet\n    ' ...\n    ' ... repeat for all the address maps\n    ' ...\n\n    'Loop through the rows in the source sheet\n    Set wsLog = ThisWorkbook.Worksheets(\"M200 46mm Setting Log\")\n    lastRow = wsLog.Cells(wsLog.Rows.Count, \"A\").End(xlUp).Row\n    For r = 4 To lastRow\n        ' Acquire the sheet name from the part number cell\n        sheetName = CStr(wsLog.Cells(r, \"A\").Value2)\n        ' Try to assign the parts number worksheet\n        Set wsPart = Nothing\n        On Error Resume Next\n        Set wsPart = ThisWorkbook.Worksheets(sheetName)\n        On Error GoTo 0\n        ' If assigment worked then transfer data\n        If Not wsPart Is Nothing Then\n            For Each map In addressMap\n                wsPart.Range(map(1)).Value = wsLog.Cells(r, map(0)).Value2\n            Next\n        End If\n    Next\nEnd Sub\n\nPrivate Function SetRangeMap(sourceCol As String, partAddress As String) As Variant\n    Dim map(1) As String\n    map(0) = sourceCol\n    map(1) = partAddress\n    SetRangeMap = map\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5521972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ea11b03628c3ff04ed42f401f47092?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Witzke", "link": "https://stackoverflow.com/users/5521972/rob-witzke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 33511033, "answer_count": 1, "score": 0, "last_activity_date": 1446595194, "creation_date": 1446586162, "last_edit_date": 1446595194, "question_id": 33509418, "link": "https://stackoverflow.com/questions/33509418/how-to-transfer-row-data-to-specific-cells-in-a-variable-sheet", "title": "How to transfer row data to specific cells in a variable sheet?", "body": "<p>Ok, this might take a bit to explain. I have a single MS Excel setting log sheet for a machine in our plant that contains setting specs for over 100 different part numbers built on that machine (each row is a different part number). We're switching to a new format that will have a separate sheet for each part number, with each sheet following a certain format (I set up a template beforehand and copied it for each part number). The first column of the old log sheet contains all of the part numbers, and the sheet names correspond to these part numbers.</p>\n\n<p>So I'm trying to set up a program that will repeat for each part number (each sheet), and will find that number in the first column of the old log sheet. Then it will pull the value from the cell in, let's say, column B of that row, and will place that value in a specific cell in the sheet for that part number. Now, this will need to pull data from several cells for each part number, but if I can get it to work for one, I can go from there.</p>\n\n<p>Here's what I've got so far:</p>\n\n<pre><code>Sub EditSettings()\n\nDim i As Integer\nDim j As Integer\nDim lastrow As Integer\n\nlastrow = Sheets(\"M200 46mm Setting Log\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 5 To Worksheets.Count\n\n    For j = 4 To lastrow\n\n            If Sheets(\"M200 46mm Setting Log\").Cells(j, \"A\").Value = \"\" Then\n\n            ElseIf Sheets(\"M200 46mm Setting Log\").Cells(j, \"A\").Value = Sheets(i).Name Then\n\n                Sheets(\"M200 46mm Setting Log\").Range(j, \"B\").Copy _\n                Destination:=Sheets(i).Range(\"D11\")\n\n            End If\n\n    Next\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>When I run this however, it gives me an error saying \"Run-time error '1004': Application-defined or object-defined error\".</p>\n"}, {"tags": ["sql", "vba", "ms-access", "union"], "comments": [{"owner": {"reputation": 645, "user_id": 5480105, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/841b4691076eab3f865a151c57176e5f?s=128&d=identicon&r=PG&f=1", "display_name": "Mark He", "link": "https://stackoverflow.com/users/5480105/mark-he"}, "edited": false, "score": 0, "creation_date": 1446585407, "post_id": 33508945, "comment_id": 54801981, "body": "Can you post the VBA code you have right now? Or are you just running the sql script? And you are using sql-server, correct?"}, {"owner": {"reputation": 3, "user_id": 5521832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8V_tlIBkpbs/AAAAAAAAAAI/AAAAAAAAAsU/kKCjJ_Hcox4/photo.jpg?sz=128", "display_name": "eriv", "link": "https://stackoverflow.com/users/5521832/eriv"}, "reply_to_user": {"reputation": 645, "user_id": 5480105, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/841b4691076eab3f865a151c57176e5f?s=128&d=identicon&r=PG&f=1", "display_name": "Mark He", "link": "https://stackoverflow.com/users/5480105/mark-he"}, "edited": false, "score": 0, "creation_date": 1446586238, "post_id": 33508945, "comment_id": 54802370, "body": "This is MS Access. I current don&#39;t have VBA code to do anything. Although I&#39;m open to an approach to accomplishing this in VBA. Just not sure how to &quot;call&quot; a query and join (i.e. UNION) them together. My SELECT queries run the calculations and pull the data."}, {"owner": {"reputation": 645, "user_id": 5480105, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/841b4691076eab3f865a151c57176e5f?s=128&d=identicon&r=PG&f=1", "display_name": "Mark He", "link": "https://stackoverflow.com/users/5480105/mark-he"}, "edited": false, "score": 0, "creation_date": 1446586776, "post_id": 33508945, "comment_id": 54802666, "body": "Oops, my bad, somehow didn&#39;t see Access. Anyway, even if you create a method like you described above, you will STILL have to replace the original <code>SELECT</code> statements so it might not be worth your time."}, {"owner": {"reputation": 3, "user_id": 5521832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8V_tlIBkpbs/AAAAAAAAAAI/AAAAAAAAAsU/kKCjJ_Hcox4/photo.jpg?sz=128", "display_name": "eriv", "link": "https://stackoverflow.com/users/5521832/eriv"}, "edited": false, "score": 0, "creation_date": 1446589869, "post_id": 33508945, "comment_id": 54804252, "body": "<code>Run-time error &#39;3192&#39;: Could note find output table &#39;tempTable&#39;</code> is the error i get when i run this."}, {"owner": {"reputation": 3, "user_id": 5521832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8V_tlIBkpbs/AAAAAAAAAAI/AAAAAAAAAsU/kKCjJ_Hcox4/photo.jpg?sz=128", "display_name": "eriv", "link": "https://stackoverflow.com/users/5521832/eriv"}, "edited": false, "score": 0, "creation_date": 1446590470, "post_id": 33508945, "comment_id": 54804502, "body": "Thanks for your help. Still getting error... <code>Could not find output table &#39;tbl_P54_Union&#39;.</code>"}, {"owner": {"reputation": 3, "user_id": 5521832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8V_tlIBkpbs/AAAAAAAAAAI/AAAAAAAAAsU/kKCjJ_Hcox4/photo.jpg?sz=128", "display_name": "eriv", "link": "https://stackoverflow.com/users/5521832/eriv"}, "edited": false, "score": 0, "creation_date": 1446591263, "post_id": 33508945, "comment_id": 54804866, "body": "It would help if I used the correct names. But it works! Perfect! I need to set alerts to false... otherwise I&#39;m prompted to OK appending rows."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1446619940, "post_id": 33508945, "comment_id": 54813246, "body": "Use <code>DB.Execute</code> instead of <code>DoCmd.RunSQL</code>: <a href=\"http://allenbrowne.com/ser-60.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-60.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5521832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8V_tlIBkpbs/AAAAAAAAAAI/AAAAAAAAAsU/kKCjJ_Hcox4/photo.jpg?sz=128", "display_name": "eriv", "link": "https://stackoverflow.com/users/5521832/eriv"}, "edited": false, "score": 0, "creation_date": 1446587513, "post_id": 33509237, "comment_id": 54803060, "body": "They weren&#39;t named that way, but they are easily renamed as they are all independent queries, all with the same number of columns."}], "tags": [], "owner": {"reputation": 83, "user_id": 2418188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IPu85.png?s=128&g=1", "display_name": "Ispep Aloc", "link": "https://stackoverflow.com/users/2418188/ispep-aloc"}, "is_accepted": true, "score": 0, "last_activity_date": 1446585505, "creation_date": 1446585505, "answer_id": 33509237, "question_id": 33508945, "link": "https://stackoverflow.com/questions/33508945/how-to-union-all-multiple-select-queries-in-vba-without-typing-sql-in-vba/33509237#33509237", "title": "How to UNION ALL multiple SELECT queries in VBA, without typing SQL in VBA?", "body": "<p>I would take a different approach to this.  Assuming your queries are named qry_Input_1, qry_Input_2, etc., I would create a for loop in VBA to populate a table with the _1, _2 be dynamic and then have a query created that simply selects from that table.  Roughly something like this </p>\n\n<pre><code>dim i as integer\n\nfor i = 1 to 7\n    docmd.runsql \"insert into temp table select * from qry_Input_\" + CStr(i)\nnext i\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5521832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8V_tlIBkpbs/AAAAAAAAAAI/AAAAAAAAAsU/kKCjJ_Hcox4/photo.jpg?sz=128", "display_name": "eriv", "link": "https://stackoverflow.com/users/5521832/eriv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 954, "favorite_count": 0, "accepted_answer_id": 33509237, "answer_count": 1, "score": 0, "last_activity_date": 1446592420, "creation_date": 1446584326, "last_edit_date": 1446588074, "question_id": 33508945, "link": "https://stackoverflow.com/questions/33508945/how-to-union-all-multiple-select-queries-in-vba-without-typing-sql-in-vba", "title": "How to UNION ALL multiple SELECT queries in VBA, without typing SQL in VBA?", "body": "<p>I can successfully create a <code>UNION ALL</code> query using SQL to join multiple (7 total) <code>SELECT</code> queries, which were built in Design View in Access--I simply copy the SQL, create a new query, and put <code>UNION ALL</code> between them. Works just as I expect and quickly.</p>\n\n<p>However, I'm often asked to modify certain aspects of the individual <code>SELECT</code> queries. Only way to recreate the query with <code>UNION ALL</code> is to copy the <code>SELECT</code> statement and paste it again.</p>\n\n<p>Is there a better way to run this using <code>DoCmd.OpenQuery</code> or <code>RunSQL</code>?</p>\n\n<p>I'm looking for a simple way to call a method that might look like <code>qry_Input_1 UNION ALL qry_Input_2</code> without having to retype/copy/paste the <code>SELECT</code> query every time I make a change. I'm open to either SQL or VBA approaches.</p>\n\n<hr>\n\n<p>Here is my VBA that I started based on inputs from below (thanks @Ispep Aloc). I'm having trouble with my tempTable as suggested.</p>\n\n<pre><code>Sub UnionQuery()\nDim i As Integer\nDim tempTable As String\ntempTable = \"tbl_P54_Union\"\n\nFor i = 1 To 7\n    DoCmd.RunSQL \"INSERT INTO tempTable SELECT * FROM qry_P54Input_\" + CStr(i)\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1446586465, "post_id": 33508902, "comment_id": 54802512, "body": "Very confusing, your title reads &quot;Spreadsheet&quot; your code reads &quot;Workbook&quot;. Your description reads &quot;Command Button&quot;, your Code reads &quot;OptionButton&quot;"}, {"owner": {"reputation": 1, "user_id": 5521921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8df15870fdf86883c31a1536e541afe?s=128&d=identicon&r=PG&f=1", "display_name": "IBstudent", "link": "https://stackoverflow.com/users/5521921/ibstudent"}, "edited": false, "score": 0, "creation_date": 1446593774, "post_id": 33508902, "comment_id": 54805831, "body": "Sorry about that, Yes im working in Option Button. The last line i believe is terrible wrong. I am coding in spanish so there might be a translation problem"}, {"owner": {"reputation": 1, "user_id": 5521921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8df15870fdf86883c31a1536e541afe?s=128&d=identicon&r=PG&f=1", "display_name": "IBstudent", "link": "https://stackoverflow.com/users/5521921/ibstudent"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1446667620, "post_id": 33508902, "comment_id": 54843564, "body": "and by the way thank you"}], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 3758099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gE6bK.jpg?s=128&g=1", "display_name": "tc_NYC", "link": "https://stackoverflow.com/users/3758099/tc-nyc"}, "is_accepted": false, "score": 0, "last_activity_date": 1446585999, "creation_date": 1446585999, "answer_id": 33509370, "question_id": 33508902, "link": "https://stackoverflow.com/questions/33508902/how-to-open-a-spreadsheet-in-excel/33509370#33509370", "title": "How to open a spreadsheet in Excel?", "body": "<p>The code can be simplified into this:</p>\n\n<pre><code>Sub firstSheet()\n\nSheets(1).Select\n\nEnd Sub\n</code></pre>\n\n<p>Then go to the Developer tab, add a button, and assign it to this macro.</p>\n"}], "owner": {"reputation": 1, "user_id": 5521921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8df15870fdf86883c31a1536e541afe?s=128&d=identicon&r=PG&f=1", "display_name": "IBstudent", "link": "https://stackoverflow.com/users/5521921/ibstudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1446597476, "creation_date": 1446584138, "last_edit_date": 1446597476, "question_id": 33508902, "link": "https://stackoverflow.com/questions/33508902/how-to-open-a-spreadsheet-in-excel", "title": "How to open a spreadsheet in Excel?", "body": "<p>How can I make that, when pressing the command button, it opens the first spreadsheet of Excel?  </p>\n\n<p>I am coding in Visual Basic Forms in Excel 2016. This is my code: </p>\n\n<pre><code>Private Sub OptionButton1_Click()\nIf OptionButton1.Value = True Then MsgBox (\" Has decidido Actualizar el Inventario\")\n\nWorkbook(\"Hoja1\").ShowAllData\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "visual-studio-2010", "checkbox"], "comments": [{"owner": {"reputation": 15695, "user_id": 682404, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxO2o.png?s=128&g=1", "display_name": "xxbbcc", "link": "https://stackoverflow.com/users/682404/xxbbcc"}, "edited": false, "score": 0, "creation_date": 1446582703, "post_id": 33508439, "comment_id": 54800512, "body": "Wow. You need to quickly fix this code before it grows any more."}], "answers": [{"tags": [], "owner": {"reputation": 15695, "user_id": 682404, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxO2o.png?s=128&g=1", "display_name": "xxbbcc", "link": "https://stackoverflow.com/users/682404/xxbbcc"}, "is_accepted": true, "score": 1, "last_activity_date": 1446583296, "last_edit_date": 1446583296, "creation_date": 1446582978, "answer_id": 33508580, "question_id": 33508439, "link": "https://stackoverflow.com/questions/33508439/visual-basic-how-to-disable-all-checkbox/33508580#33508580", "title": "Visual Basic how to disable all checkbox?", "body": "<p>Loop through all children of the form and if the child is of type <code>CheckBox</code>, disable it. This should take only a few lines of code: you can use the <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.control.controls%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>Controls</code></a> collection of the form to access children. Something like:</p>\n\n<pre><code>For Each ctrl As Control In container.Controls\n    If TypeOf ctrl Is CheckBox Then\n        ctrl.Enabled = False\n    End If\nNext\n</code></pre>\n\n<p>You should do the same with event handlers: instead of having that crazy <code>Handles</code> control list, just add the event handler to the checkboxes in a loop during runtime. <a href=\"https://msdn.microsoft.com/en-us/library/dfty2w4e%28v=vs.110%29.aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-1\" rel=\"nofollow\">MSDN</a> has an example on how to use <code>AddHandler</code> for that.</p>\n"}], "owner": {"reputation": 524, "user_id": 2447290, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/CMOHm.jpg?s=128&g=1", "display_name": "Cazs", "link": "https://stackoverflow.com/users/2447290/cazs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 33508580, "answer_count": 1, "score": 0, "last_activity_date": 1446583296, "creation_date": 1446582461, "question_id": 33508439, "link": "https://stackoverflow.com/questions/33508439/visual-basic-how-to-disable-all-checkbox", "title": "Visual Basic how to disable all checkbox?", "body": "<p>I'm working in Visual Basic 2010 Express</p>\n\n<p>I want to disable all checkbox of a Form</p>\n\n<p>Not only that, as you can see in the code, there are 49 checkbox. And everyone has an event, I want to save code and optimize it.</p>\n\n<pre><code>Public Class Form1\n        Dim intNumber As Integer\n        Dim arrNumber(0 To 5) As Integer\n        Dim i, x, y As Integer\n        Dim maxCheck = 6\n        Dim count As Integer = 1\n\n        Private Sub setCheckbox(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox9.Click, CheckBox8.Click, CheckBox7.Click, CheckBox6.Click, CheckBox5.Click, CheckBox49.Click, CheckBox48.Click, CheckBox47.Click, CheckBox46.Click, CheckBox45.Click, CheckBox44.Click, CheckBox43.Click, CheckBox42.Click, CheckBox41.Click, CheckBox40.Click, CheckBox4.Click, CheckBox39.Click, CheckBox38.Click, CheckBox37.Click, CheckBox36.Click, CheckBox35.Click, CheckBox34.Click, CheckBox33.Click, CheckBox32.Click, CheckBox31.Click, CheckBox30.Click, CheckBox3.Click, CheckBox29.Click, CheckBox28.Click, CheckBox27.Click, CheckBox26.Click, CheckBox25.Click, CheckBox24.Click, CheckBox23.Click, CheckBox22.Click, CheckBox21.Click, CheckBox20.Click, CheckBox2.Click, CheckBox19.Click, CheckBox18.Click, CheckBox17.Click, CheckBox16.Click, CheckBox15.Click, CheckBox14.Click, CheckBox13.Click, CheckBox12.Click, CheckBox11.Click, CheckBox10.Click, CheckBox1.Click\n        If count &lt; 6 Then\n            count = count + 1\n        Else\n\n\n        End If\n    End Sub\nEnd Class\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1446582584, "post_id": 33508293, "comment_id": 54800438, "body": "In your document, will it literally say <code>**Bankruptcy Required**</code> and the like? Or is there a technical marker that notes that?  The thought is to go through each cell in column B, when it finds some text (<code>**Bankruptcy</code> or <code>**Judicial</code>), place that in column A, and copy all the cells below, until the next &quot;bankruptcy&quot; part and repeat.  Edit: This can also probably be done with a formula, given the different types of &quot;Column A&quot; parts.  Have you tried anything? If so, let us know."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5036962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b9f90523b6eec0b12076e14c15387c60?s=128&d=identicon&r=PG&f=1", "display_name": "AYJK", "link": "https://stackoverflow.com/users/5036962/ayjk"}, "edited": false, "score": 0, "creation_date": 1446590906, "post_id": 33508518, "comment_id": 54804716, "body": "Close @MatthewD ! But the ** just indicates that the text in that line is bold. The character * is not present there. Any idea how to do the same that you did checking for bold text&#39; lines?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 99, "user_id": 5036962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b9f90523b6eec0b12076e14c15387c60?s=128&d=identicon&r=PG&f=1", "display_name": "AYJK", "link": "https://stackoverflow.com/users/5036962/ayjk"}, "edited": false, "score": 0, "creation_date": 1446601708, "post_id": 33508518, "comment_id": 54808058, "body": "Sure @AYJK I believe that it is Range().Font.Bold = True. I&#39;ll make the change to the answer so you can try it but I can&#39;t test it myself until tomorrow."}, {"owner": {"reputation": 99, "user_id": 5036962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b9f90523b6eec0b12076e14c15387c60?s=128&d=identicon&r=PG&f=1", "display_name": "AYJK", "link": "https://stackoverflow.com/users/5036962/ayjk"}, "edited": false, "score": 0, "creation_date": 1446635172, "post_id": 33508518, "comment_id": 54821789, "body": "Thank you very much @MatthewD ! It works just perfect. Is there any &quot;thumbs up&quot; that I can do for your answer?"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 0, "last_activity_date": 1446646438, "last_edit_date": 1446646438, "creation_date": 1446582745, "answer_id": 33508518, "question_id": 33508293, "link": "https://stackoverflow.com/questions/33508293/select-status-from-a-column-to-populate-another-column/33508518#33508518", "title": "Select status from a column to populate another column", "body": "<p>Loop through the rows and examine what is in Column B.</p>\n\n<pre><code>Private Sub FixData()\n    Dim ws As Excel.Worksheet\n    Set ws = ActiveWorkbook.Sheets(\"Sheet2\")\n    Dim lastRow As Long\n    Dim szStatus As String\n    Dim lrow As Long\n    lrow = 1\n\n    lastRow = ws.Cells(ws.Rows.count, \"B\").End(xlUp).Row\n\n    'Loop through the rows\n    Do While lrow &lt;= lastRow\n        'Check if the value in column B is bold\n        If ws.Range(\"B\" &amp; lrow).Font.Bold = True Then\n            'Get the value\n            szStatus = Trim(ws.Range(\"B\" &amp; lrow).Value)\n            'Delete that row\n            ws.Rows(lrow).EntireRow.Delete\n        Else\n            'If it does not have ** in it we get to here\n            If ws.Range(\"B\" &amp; lrow).Value &lt;&gt; \"\" Then\n                'Write the status we got from the line we deleted into column A.\n                ws.Range(\"A\" &amp; lrow).Value = szStatus\n            End If\n            lrow = lrow + 1\n        End If\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 5036962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b9f90523b6eec0b12076e14c15387c60?s=128&d=identicon&r=PG&f=1", "display_name": "AYJK", "link": "https://stackoverflow.com/users/5036962/ayjk"}, "edited": false, "score": 0, "creation_date": 1446588321, "post_id": 33508748, "comment_id": 54803479, "body": "As I said, &quot;These status can vary and new ones can be added&quot;, so it should be flexible, I mean, not limited to &quot;bankruptcy&quot;, &quot;required&quot; and &quot;judicial&quot;."}, {"owner": {"reputation": 99, "user_id": 5036962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b9f90523b6eec0b12076e14c15387c60?s=128&d=identicon&r=PG&f=1", "display_name": "AYJK", "link": "https://stackoverflow.com/users/5036962/ayjk"}, "edited": false, "score": 0, "creation_date": 1446589360, "post_id": 33508748, "comment_id": 54804020, "body": "Thank you for your response pnuts. Maybe I was kind rude because of my bad english, but I didn&#39;t mean it. I agree with you, but I&#39;m really new in VBA and my codes for know are unpublishable!"}, {"owner": {"reputation": 99, "user_id": 5036962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b9f90523b6eec0b12076e14c15387c60?s=128&d=identicon&r=PG&f=1", "display_name": "AYJK", "link": "https://stackoverflow.com/users/5036962/ayjk"}, "edited": false, "score": 1, "creation_date": 1446589995, "post_id": 33508748, "comment_id": 54804300, "body": "Totally agree! Cheers!"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1446583573, "creation_date": 1446583573, "answer_id": 33508748, "question_id": 33508293, "link": "https://stackoverflow.com/questions/33508293/select-status-from-a-column-to-populate-another-column/33508748#33508748", "title": "Select status from a column to populate another column", "body": "<p>Possible without VBA, for example by adding an extra column:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/jAZrP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jAZrP.jpg\" alt=\"SO33508293 example\"></a>  </p>\n\n<p>The formula in A2 being:  </p>\n\n<pre><code>=IFERROR(SEARCH(\"Bankruptcy\",C2),IFERROR(SEARCH(\"Required\",C2),IFERROR(SEARCH(\"Judicial\",C2),)))\n</code></pre>\n\n<p>and in B2:  </p>\n\n<pre><code>=IF(A2&gt;0,C2,B1)  \n</code></pre>\n\n<p>If the formula are converted to the values resulting from the formulae then the rows that don't start <code>0</code> may be deleted and then the helper column (<code>A</code>) also. </p>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1446590969, "creation_date": 1446590969, "answer_id": 33510576, "question_id": 33508293, "link": "https://stackoverflow.com/questions/33508293/select-status-from-a-column-to-populate-another-column/33510576#33510576", "title": "Select status from a column to populate another column", "body": "<p>I'll try again then, still without VBA. Define a Name, say BOLD, as:  </p>\n\n<pre><code>=GET.CELL(20,OFFSET(INDIRECT(\"RC2\",FALSE),0,1))  \n</code></pre>\n\n<p>then enter in A2 (of added column, as my other answer):  </p>\n\n<pre><code>=BOLD  \n</code></pre>\n\n<p>and change B2 formula to:</p>\n\n<pre><code>  =IF(A2,C2,B1)  \n</code></pre>\n\n<p>then proceed as before though delete the <code>TRUE</code> rows rather than the non <code>0</code> ones.</p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 5523822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8c632ab85b1c04a3b502739087c420?s=128&d=identicon&r=PG", "display_name": "Kael", "link": "https://stackoverflow.com/users/5523822/kael"}, "is_accepted": false, "score": 0, "last_activity_date": 1446628290, "last_edit_date": 1446628290, "creation_date": 1446627492, "answer_id": 33517519, "question_id": 33508293, "link": "https://stackoverflow.com/questions/33508293/select-status-from-a-column-to-populate-another-column/33517519#33517519", "title": "Select status from a column to populate another column", "body": "<p>Maybe this can help.</p>\n\n<pre><code>Sub CleanAndTransfer2()\n    Dim ws As Excel.Worksheet\n    Set ws = ActiveWorkbook.Sheets(\"Sheet1\")\n    Dim bankruptcy  As String\n    ws.Activate\n    Dim i As Integer\n    i = 2\n    Do Until IsEmpty(Cells(i, 2))\n        If Cells(i, 2).Font.Bold = True Then\n            bankruptcy = Cells(i, 2)\n            Rows(i).EntireRow.Delete\n        End If\n        Cells(i, 1) = bankruptcy\n        i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5036962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b9f90523b6eec0b12076e14c15387c60?s=128&d=identicon&r=PG&f=1", "display_name": "AYJK", "link": "https://stackoverflow.com/users/5036962/ayjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 33508518, "answer_count": 4, "score": 2, "last_activity_date": 1446646438, "creation_date": 1446581939, "last_edit_date": 1446582164, "question_id": 33508293, "link": "https://stackoverflow.com/questions/33508293/select-status-from-a-column-to-populate-another-column", "title": "Select status from a column to populate another column", "body": "<p>I have a spreadsheet which is daily updated with a list of companies at different states of bankruptcy (<code>**text**</code>). These status can vary and new ones can be added.</p>\n\n<p>What the macro has to do is fill the <code>column A</code> with the current bankruptcy status of the company, and delete it from <code>column B</code>. An example, before:</p>\n\n<pre><code>column A    column B\n            **Bankruptcy Required**\n            Company 1\n            Company 2\n            Company 3\n            **Bankruptcy Decreed**\n            Company 4\n            Company 5\n            **Extinct Bankruptcy Process**\n            Company 6\n            **Required Reorganization**\n            Company 9\n            Company 10\n            Company 11\n            **Judicial Recovery Upheld**\n            Company 12\n            Company 14\n            Company 15\n            Company 16\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>column A                          column B\nBankruptcy Required               Company 1\nBankruptcy Required               Company 2\nBankruptcy Required               Company 3\nBankruptcy Decreed                Company 4\nBankruptcy Decreed                Company 5\nExtinct Bankruptcy Process        Company 6\nRequired Reorganization           Company 9\nRequired Reorganization           Company 10\nRequired Reorganization           Company 11\nJudicial Recovery Upheld          Company 12\nJudicial Recovery Upheld          Company 14\nJudicial Recovery Upheld          Company 15\nJudicial Recovery Upheld          Company 16\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1446582407, "post_id": 33508364, "comment_id": 54800347, "body": "Thanks, that&#39;s not the actual issue, it&#39;s more pulling it in the sub via the worksheet code. I can not seem to access the cells correctly. Thanks though."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1446584059, "last_edit_date": 1446584059, "creation_date": 1446582188, "answer_id": 33508364, "question_id": 33508252, "link": "https://stackoverflow.com/questions/33508252/pull-month-name-and-year-from-main-sheet-to-separate-sheet/33508364#33508364", "title": "Pull month name and year from main sheet to separate sheet", "body": "<p>To get the month use:</p>\n\n<pre><code>.cells(1,5) = MonthName(Month(.Cells(1,3).value)\n</code></pre>\n\n<p>to get year:</p>\n\n<pre><code>.cells(1,5) = Year(.Cells(1,3).value)\n</code></pre>\n\n<p>edit:</p>\n\n<p>If all you want is the month and date from one cell into another then</p>\n\n<pre><code> Sheets(\"TargetSheetName\").Cells(1,5) = format(Sheets(\"DataSheetName\").Cells(1,3), \"mmmm yyyy\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 4969843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9de638e578e9e7422a03b0378a91b967?s=128&d=identicon&r=PG&f=1", "display_name": "bjaegers", "link": "https://stackoverflow.com/users/4969843/bjaegers"}, "is_accepted": false, "score": 0, "last_activity_date": 1446582643, "creation_date": 1446582643, "answer_id": 33508495, "question_id": 33508252, "link": "https://stackoverflow.com/questions/33508252/pull-month-name-and-year-from-main-sheet-to-separate-sheet/33508495#33508495", "title": "Pull month name and year from main sheet to separate sheet", "body": "<p>Here is what I came up with to solve your issue. Given your date is in cell D2 on the mainsheet page this will put the month and year in the format \"January 2010\" into cell E1 on the same page.</p>\n\n<pre><code>Public Sub test()\n    Dim ws2 As Worksheet\n    Set ws2 = ThisWorkbook.Sheets(\"mainsheet\")\n    With ws2\n        yr = Year(.Range(\"D2\"))\n        mn = Format(.Range(\"D2\"), \"MMMM\")\n        .Cells(1, 5) = mn &amp; \" \" &amp; yr\n        .Cells(1, 5).NumberFormat = \"MMMM YYYY\"         \n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1446583864, "post_id": 33508603, "comment_id": 54801157, "body": "I get a type mismatch?"}, {"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "reply_to_user": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1446584987, "post_id": 33508603, "comment_id": 54801761, "body": "That means you don&#39;t have a valid date in D2. Enter a valid date and try again."}, {"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1446585545, "post_id": 33508603, "comment_id": 54802045, "body": "I just hovered over the .Range and I get 3219101... Interesting as when I go to the main sheet it says it&#39;s formatted as a date?? Do I need to format it before or after or something?"}, {"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "reply_to_user": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1446586254, "post_id": 33508603, "comment_id": 54802380, "body": "No, the format is not important. It is used to display the data in whatever way you want. You need to enter a valid date in the cell. Try entering 2015-01-01 for testing."}], "tags": [], "owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "is_accepted": true, "score": 0, "last_activity_date": 1446583055, "creation_date": 1446583055, "answer_id": 33508603, "question_id": 33508252, "link": "https://stackoverflow.com/questions/33508252/pull-month-name-and-year-from-main-sheet-to-separate-sheet/33508603#33508603", "title": "Pull month name and year from main sheet to separate sheet", "body": "<p>Try this:</p>\n\n<pre><code>Dim ws2 As Worksheet\nSet ws2 = ThisWorkbook.Sheets(\"mainsheet\")\n    With ws2\n     Dim y As Integer, m As String\n     y = Year(.Range(\"D2\"))\n     m = MonthName(Month(.Range(\"D2\")))\n    End With\nSet ws2 = ThisWorkbook.Sheets(\"Sheet1\")\n    With ws2\n     .Range(\"E1\") = m &amp; \" \" &amp; y\n    End With\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 33508603, "answer_count": 3, "score": 0, "last_activity_date": 1446596615, "creation_date": 1446581789, "last_edit_date": 1446596615, "question_id": 33508252, "link": "https://stackoverflow.com/questions/33508252/pull-month-name-and-year-from-main-sheet-to-separate-sheet", "title": "Pull month name and year from main sheet to separate sheet", "body": "<p>So I have a main sheet that contains a date column (D). Date is as <code>01/01/2010</code>.\nI want to be able to pull month name and year in a VBA subroutine to sheet1 based on other user input. Here is some of the code I'm trying to make work, this is in a sub in mainsheet:</p>\n\n<pre><code>Dim ws2 As Worksheet\nSet ws2 = ThisWorkbook.Sheets(\"mainsheet\")\n    With ws2 \n     '=YEAR(mainsheet!D2)\n      ' mn = Text([Date], \"mmmm\")\n       my= .Cells(Year(1, 3))\n    End With\n</code></pre>\n\n<p>After I get the correct month and year (January 2010) I plan to put that in a variable that goes into E1 on sheet1.</p>\n\n<p>I've moved things around, I've used quotes, I've tried range ... it's just not working.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 0, "creation_date": 1446581775, "post_id": 33508194, "comment_id": 54800039, "body": "Same can be accomplished by using filter in column A."}, {"owner": {"reputation": 115, "user_id": 5521559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9372cccc46f9d107151e835e976c35c5?s=128&d=identicon&r=PG&f=1", "display_name": "Feifei Zhang", "link": "https://stackoverflow.com/users/5521559/feifei-zhang"}, "reply_to_user": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 0, "creation_date": 1446582752, "post_id": 33508194, "comment_id": 54800538, "body": "If Column B has 100, I do not want to click 100 times by using filter in column A. This is why I am trying to use macro. Thanks."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446584909, "post_id": 33508194, "comment_id": 54801716, "body": "What should the output be? By your code it would have 7 lines all the rows with 1,2 or 7 in column A.  Is this correct?"}, {"owner": {"reputation": 115, "user_id": 5521559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9372cccc46f9d107151e835e976c35c5?s=128&d=identicon&r=PG&f=1", "display_name": "Feifei Zhang", "link": "https://stackoverflow.com/users/5521559/feifei-zhang"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446589202, "post_id": 33508194, "comment_id": 54803938, "body": "@Scott This is correct."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446589863, "post_id": 33508194, "comment_id": 54804248, "body": "Then @jeffCarey answer should work."}], "answers": [{"tags": [], "owner": {"reputation": 2094, "user_id": 5508728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3gtR.jpg?s=128&g=1", "display_name": "jeff carey", "link": "https://stackoverflow.com/users/5508728/jeff-carey"}, "is_accepted": true, "score": 1, "last_activity_date": 1446584957, "creation_date": 1446584957, "answer_id": 33509112, "question_id": 33508194, "link": "https://stackoverflow.com/questions/33508194/how-to-select-rows-that-meet-multiple-criteria-from-a-column/33509112#33509112", "title": "How to select rows that meet multiple criteria from a column?", "body": "<p>Reset the j value each time you iterate through the outer loop</p>\n\n<pre><code>Do Until IsEmpty(t.Range(\"B\" &amp; i))\n    ' Insert this line here\n    j = 2\n\n    Do Until IsEmpty(t.Range(\"A\" &amp; j))\n    If t.Range(\"A\" &amp; j) = t.Range(\"B\" &amp; i) Then\n    d = d + 1    \n    r.Rows(d).Value = t.Rows(j).Value\n    End If\n    j = j + 1\n    Loop\n  i = i + 1\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 5521559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9372cccc46f9d107151e835e976c35c5?s=128&d=identicon&r=PG&f=1", "display_name": "Feifei Zhang", "link": "https://stackoverflow.com/users/5521559/feifei-zhang"}, "edited": false, "score": 0, "creation_date": 1446647942, "post_id": 33509732, "comment_id": 54830306, "body": "Can you explain how mCellA (or mCellB) works? I did not see you define it? If I want to copy the whole row to the &quot;select&quot;, I guess we need to tweak this line a little bit &quot;wks2.Cells(currentEndingRow, 1).Value = mCellA.Value&quot;. How to change this? Thanks."}, {"owner": {"reputation": 145, "user_id": 4335636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f1dea4d045d5bb00ba76c3885748a5?s=128&d=identicon&r=PG", "display_name": "Michael B.", "link": "https://stackoverflow.com/users/4335636/michael-b"}, "reply_to_user": {"reputation": 115, "user_id": 5521559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9372cccc46f9d107151e835e976c35c5?s=128&d=identicon&r=PG&f=1", "display_name": "Feifei Zhang", "link": "https://stackoverflow.com/users/5521559/feifei-zhang"}, "edited": false, "score": 0, "creation_date": 1446648957, "post_id": 33509732, "comment_id": 54831123, "body": "mCellA is defined within the For Each loop automatically, its definition is implied by just simply creating the For Loop.  I commented out my original code before I saw you wanted the whole row copied over.  What I have on there now will do the trick for copying the entire row, and not just a single cell."}, {"owner": {"reputation": 115, "user_id": 5521559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9372cccc46f9d107151e835e976c35c5?s=128&d=identicon&r=PG&f=1", "display_name": "Feifei Zhang", "link": "https://stackoverflow.com/users/5521559/feifei-zhang"}, "edited": false, "score": 0, "creation_date": 1446660605, "post_id": 33509732, "comment_id": 54839522, "body": "Thank you very much. This is very helpful!"}], "tags": [], "owner": {"reputation": 145, "user_id": 4335636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f1dea4d045d5bb00ba76c3885748a5?s=128&d=identicon&r=PG", "display_name": "Michael B.", "link": "https://stackoverflow.com/users/4335636/michael-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1446601450, "last_edit_date": 1446601450, "creation_date": 1446587348, "answer_id": 33509732, "question_id": 33508194, "link": "https://stackoverflow.com/questions/33508194/how-to-select-rows-that-meet-multiple-criteria-from-a-column/33509732#33509732", "title": "How to select rows that meet multiple criteria from a column?", "body": "<p>A couple For/Each loops iterating over a Range.  It just seems a bit cleaner.</p>\n\n<pre><code>Dim LastRowA As Long\nDim LastRowB As Long\n\nDim WB As Workbook\nSet WB = ActiveWorkbook\n\nDim wks As Worksheet\nDim wks2 As Worksheet\nSet wks = WB.Sheets(\"test\")\nSet wks2 = WB.Sheets(\"select\")\n\nLastRowA = wks.Cells(wks.Rows.Count, \"A\").End(xlUp).ROW\nLastRowB = wks.Cells(wks.Rows.Count, \"B\").End(xlUp).ROW\n\nDim rowRangeA As Range\nDim rowRangeB As Range\nSet rowRangeA = wks.Range(\"A1:A\" &amp; LastRowA)\nSet rowRangeB = wks.Range(\"B1:B\" &amp; LastRowB)\n\n' keep track of our current line on second worksheet\nDim currentEndingRow As Integer\ncurrentEndingRow = 1\n\nFor Each mCellA In rowRangeA\n    'Our nested loop, will cycle through each row in B once for every row in A.\n    For Each mCellB In rowRangeB\n        If mCellA.Value = mCellB.Value Then\n           'wks2.Cells(currentEndingRow, 1).Value = mCellA.Value\n            wks2.Rows(currentEndingRow).Value = wks.Rows(mCellB.Row).Value\n            currentEndingRow = currentEndingRow + 1\n        End If\n    Next mCellB\n' Move on to the next Row A after it finishes the last row in B.\nNext mCellA\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5521559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9372cccc46f9d107151e835e976c35c5?s=128&d=identicon&r=PG&f=1", "display_name": "Feifei Zhang", "link": "https://stackoverflow.com/users/5521559/feifei-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2087, "favorite_count": 0, "accepted_answer_id": 33509112, "answer_count": 2, "score": 1, "last_activity_date": 1446601450, "creation_date": 1446581559, "last_edit_date": 1446596486, "question_id": 33508194, "link": "https://stackoverflow.com/questions/33508194/how-to-select-rows-that-meet-multiple-criteria-from-a-column", "title": "How to select rows that meet multiple criteria from a column?", "body": "<p>I am trying to copy and paste the rows based on column A that appear in column B to a new sheet (e.g. copy and paste all rows that contain 1, 2 and 7 in column A to a new sheet). I know a less smart way using macro. I believe using a nested loop will make life easier (when column B is a long list), however, mine did not work. Please see my LessSmartWay code and FailedSmartWay code below.</p>\n\n<p>The table looks like this:</p>\n\n<pre><code>A   B   C   D  \n1   1   a   1/1/2015  \n1   2   b   1/2/2015  \n1   7   c   1/3/2015  \n2   -   a   1/4/2015  \n3   -   b   1/5/2015  \n3   -   c   1/6/2015  \n3   -   a   1/7/2015  \n3   -   b   1/8/2015  \n4   -   c   1/9/2015  \n4   -   a   1/10/2015  \n5   -   b   1/11/2015  \n5   -   c   1/12/2015  \n6   -   a   1/13/2015  \n6   -   b   1/14/2015  \n6   -   c   1/15/2015  \n7   -   a   1/16/2015  \n7   -   b   1/17/2015  \n7   -   c   1/18/2015  \n</code></pre>\n\n<p>.  </p>\n\n<pre><code>Sub LessSmartWay()    \n    Set t = Sheets(\"test\")\n    Set r = Sheets(\"select\")\n    Dim d As Integer\n    Dim j As Integer\n    d = 1\n    j = 2\n    Do Until IsEmpty(t.Range(\"A\" &amp; j))\n    If t.Range(\"A\" &amp; j) = t.Range(\"B2\") Or t.Range(\"A\" &amp; j) = t.Range(\"B3\") Or t.Range(\"A\" &amp; j) = t.Range(\"B4\") Then\n    d = d + 1\n    r.Rows(d).Value = t.Rows(j).Value\n    End If\n    j = j + 1\n    Loop\nEnd Sub  \n</code></pre>\n\n<p>.  </p>\n\n<pre><code>Sub FailedSmartWay()\n    Set t = Sheets(\"test\")\n    Set r = Sheets(\"select\")\n    Dim d As Integer\n    Dim j As Integer\n    Dim i As Integer\n    d = 1\n    j = 2\n    i = 2\n    Do Until IsEmpty(t.Range(\"B\" &amp; i))\n        Do Until IsEmpty(t.Range(\"A\" &amp; j))\n        If t.Range(\"A\" &amp; j) = t.Range(\"B\" &amp; i) Then\n        d = d + 1    \n        r.Rows(d).Value = t.Rows(j).Value\n        End If\n        j = j + 1\n        Loop\n      i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n"}]