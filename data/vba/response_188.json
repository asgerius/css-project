[{"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534374923, "post_id": 51867500, "comment_id": 90687109, "body": "I can see you have used <code>selection</code>, you should not use it if you want VBA take care of everything. you can find the last row and then loop from row 1 to the last row, in each row simply concatenate the cell values using a loop and then merge the cells, clear the content and paste the value"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534375086, "post_id": 51867500, "comment_id": 90687151, "body": "the code should not be that long, what is the logic behind merging the cells? why do you want to merge the cells? all the rows have values in 3 columns or it could be different? if different how do you want to merge them? why not pasting all of the data in column A without merging? there can be ton of questions and that is why I did not write any code for you"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1534380880, "last_edit_date": 1534380880, "creation_date": 1534376218, "answer_id": 51867801, "question_id": 51867500, "link": "https://stackoverflow.com/questions/51867500/merging-cells-row-by-row-without-losing-any-data/51867801#51867801", "title": "Merging Cells row by row without losing any data", "body": "<h2>I never recommend merging cells, but if you must...</h2>\n\n<p>This is dynamic by row (<em>determined by</em> <code>Column A</code>) and column. Each merge size is dependent on each rows furthest right non-blank column. Therefore, some merged cells will span 2 columns and some will span 3. If you don\u2019t want that to be the case, you will need to find the max used column and merge by that column index </p>\n\n<p>I.E. replacing <code>MyCell.Resize(1, i -1).Merge</code> with <code>MyCell.Resize(1, MaxCol).Merge</code> where <code>MaxCol</code> is your max used column.</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub Merger()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim MyCell As Range, Merged As String, i, iArr\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nFor Each MyCell In ws.Range(\"A2:A\" &amp; ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row)\n    For i = 1 To ws.Cells(MyCell.Row, ws.Columns.Count).End(xlToLeft).Column\n        Merged = Merged &amp; Chr(32) &amp; MyCell.Offset(, i - 1) 'Build String\n    Next i\n        MyCell.Resize(1, i - 1).Merge 'Merge\n        MyCell = Right(Merged, Len(Merged) - 1) 'Insert String\n        Merged = \"\" 'Reset string for next loop\n        MyCell.HorizontalAlignment = xlGeneral\n        MyCell.VerticalAlignment = xlCenter\n        MyCell.WrapText = True\nNext MyCell\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1534401199, "last_edit_date": 1534401199, "creation_date": 1534400031, "answer_id": 51870647, "question_id": 51867500, "link": "https://stackoverflow.com/questions/51867500/merging-cells-row-by-row-without-losing-any-data/51870647#51870647", "title": "Merging Cells row by row without losing any data", "body": "<p>It can't be stressed too much.  Merged cells should be avoided.</p>\n\n<p>They  play havoc when dragging an area to populate cells.  They interrupt the double click autofill and make copying and pasting an exercise in frustration. They delay development and add complexity to formulas and VBA code all the while creating more opportunities for an error to occur or a bug to go unnoticed.</p>\n\n<p>So i urge you to reconsider using merged cells.</p>\n\n<p>Almost to prove the point, you'll find \"*****\" on a few lines in the two solutions below.  Each one of those lines needs to be handled uniquely.  Care to guess why?  The merged cell you currently have in row 1.  That merged cell can cause those lines to either halt with an error or continue with the possibility of unwanted consequences depending on which cell addresses actually hold row 1 data.</p>\n\n<p>Merged cells are absolutely horrid and considered among the greatest of Excel sins. </p>\n\n<p>Here are two ways forward without merged cells...</p>\n\n<p>In VBA (psuedo code)</p>\n\n<pre><code>For (Columns, 2, LastColumn, Step 2)\n\n   For(Rows, 3, LastRow)\n\n      With Worksheet\n\n         If .Cells(Row,Column) &lt;&gt; vbNullString then\n\n            .cells(Row,Column-1)=.cells(Row,Column-1).Value2 _\n\n                &amp; StringDeliminator &amp; .cells(Row,Column).Value2\n\n         End If\n\n      End with\n\n   Next Rows\n\n   Columns (Column).EntireColumn.Delete*****\n\nNext Columns\n</code></pre>\n\n<p>Using formulas in a worksheet</p>\n\n<p>Add a new column C</p>\n\n<p>In cell C3 use the formula</p>\n\n<p><code>=If(A3&lt;&gt;\"\",C3=A3 &amp; \"         \" &amp; B3,\"\")</code></p>\n\n<p>Drag the formula down(copy to other columns if needed)</p>\n\n<p>Ctrl Shift Up to select all the formulas</p>\n\n<p>Copy *****</p>\n\n<p>Paste Special Values *****</p>\n\n<p>Delete columns A and B *****</p>\n\n<p>There is one situation where merged cells are ok... </p>\n\n<p>if you're in a situation where you're against the wall, there is nothing you can do because your manager doesn't care if your work is incompatible with his analyst's automation tools and refuses to accept center across selection as a viable alternative because \"i know what center does and it does not help, you have to merge cells to get the text centered over those columns \".... if this is your situation then merged cells are ok, just use this method:: first, start looking for another job (or a promotion above your manager, your company should already be looking) and second, submit the broken merged cell version to the snowflake and quitely slip the functional version to your analyst as a preliminary estimate</p>\n\n<p>That's the only time I authorize you to use merged cells.</p>\n"}], "owner": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 51867801, "answer_count": 2, "score": 0, "last_activity_date": 1534401199, "creation_date": 1534373511, "last_edit_date": 1534381539, "question_id": 51867500, "link": "https://stackoverflow.com/questions/51867500/merging-cells-row-by-row-without-losing-any-data", "title": "Merging Cells row by row without losing any data", "body": "<p>I'm getting data that is in 1, 2, or 3 columns (possibly more). I need each row to combine the data in the respective row without losing any of the data from any columns. </p>\n\n<p>I managed to get some code together that will combine the cells properly, but I'm struggling to use this code to look through each row and combine the cells in that row, for all rows that contain data.</p>\n\n<p><strong>Here is what I have so far:</strong></p>\n\n<pre><code>Sub JoinAndMerge()\n'joins all the content in selected cells\n'and puts the resulting text in top most cell\n'then merges all cells\n\nDim outputText As String\nConst delim = \" \"\n\nOn Error Resume Next\n\nFor Each cell In Selection\noutputText = outputText &amp; cell.value &amp; delim\nNext cell\nWith Selection\n.Clear\n.Cells(1).value = outputText\n.Merge\n.HorizontalAlignment = xlGeneral\n.VerticalAlignment = xlCenter\n.WrapText = True\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>And here's what I've got as far as trying to get it to look through each row.</strong></p>\n\n<pre><code>Sub JoinAndMerge2()\n'joins all the content in selected cells\n'and puts the resulting text in top most cell\n'then merges all cells\n\nDim outputText As String\nConst delim = \" \"\n\nOn Error Resume Next\n\nDim cell_value As Variant\nDim counter As Integer\nDim xlastRow As Long\nDim xlastColumn As Long\n\nxlastRow = Worksheets(\"Sheet48\").UsedRange.Rows.Count\nxlastColumn = Worksheets(\"Sheet48\").UsedRange.Columns.Count\n\n'Looping through A column define max value\nFor i = 1 To xlastRow\n    'Row counter\n    counter = 1\n\n    'Take cell one at the time\n    cell_value = ThisWorkbook.ActiveSheet.Cells(1, i).value\n\n    For Each cell In Selection\n    outputText = outputText &amp; cell.value &amp; delim\n    Next cell\n        With Selection\n        .Clear\n        .Cells(1).value = outputText\n        .Merge\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlCenter\n        .WrapText = True\n    End With\n\n    counter = counter + 1\n\n\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>How do I get this to loop properly through each row?</strong><br>\nIf it helps, before on left, after on right:</p>\n\n<p><img src=\"https://i.stack.imgur.com/f2hSJ.png\" alt=\"1\">\n<img src=\"https://i.stack.imgur.com/ntTYg.png\" alt=\"2\"></p>\n"}, {"tags": ["vba", "ms-access", "corrupt"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10231465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e4a7aa31cd745adea6b3a4820c2673e?s=128&d=identicon&r=PG&f=1", "display_name": "5uper BonBon", "link": "https://stackoverflow.com/users/10231465/5uper-bonbon"}, "edited": false, "score": 0, "creation_date": 1534374706, "post_id": 51867310, "comment_id": 90687064, "body": "Thank you, KySoto!"}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 3, "user_id": 10231465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e4a7aa31cd745adea6b3a4820c2673e?s=128&d=identicon&r=PG&f=1", "display_name": "5uper BonBon", "link": "https://stackoverflow.com/users/10231465/5uper-bonbon"}, "edited": false, "score": 0, "creation_date": 1534516315, "post_id": 51867310, "comment_id": 90746116, "body": "I have had this EXACT thing happen to me. it was not fun."}], "tags": [], "owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "is_accepted": true, "score": 1, "last_activity_date": 1534372152, "creation_date": 1534372152, "answer_id": 51867310, "question_id": 51867056, "link": "https://stackoverflow.com/questions/51867056/delete-vba-module/51867310#51867310", "title": "Delete VBA module", "body": "<p>A potential option is to create a new database file, and import all of the content from the old database file. that will clear out the funky ghost stuff.</p>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 10140353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f44816c13d6678a2c6d07254e212e31d?s=128&d=identicon&r=PG&f=1", "display_name": "Duncan Drake", "link": "https://stackoverflow.com/users/10140353/duncan-drake"}, "is_accepted": false, "score": 0, "last_activity_date": 1534437033, "creation_date": 1534437033, "answer_id": 51881635, "question_id": 51867056, "link": "https://stackoverflow.com/questions/51867056/delete-vba-module/51881635#51881635", "title": "Delete VBA module", "body": "<p>you write you tried compile already and it did not work.</p>\n\n<p>Did you try decompile first though?</p>\n\n<p>First of all make a backup copy (but am sure you already did that :) )</p>\n\n<p>With Access and your access file closed type from the command prompt:\nC:\\yourOfficeInstallPath\\MSACCESS.EXE /decompile</p>\n\n<p>Access will start. Click File > Open and select the database you want to decompile\nOpen any module and click Debug > Compile</p>\n\n<p>Then save your file and close.</p>\n\n<p>Open again your file and compact it.</p>\n\n<p>Let me know if it solved it.</p>\n"}], "owner": {"reputation": 3, "user_id": 10231465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e4a7aa31cd745adea6b3a4820c2673e?s=128&d=identicon&r=PG&f=1", "display_name": "5uper BonBon", "link": "https://stackoverflow.com/users/10231465/5uper-bonbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 51867310, "answer_count": 2, "score": 0, "last_activity_date": 1534437033, "creation_date": 1534370539, "last_edit_date": 1534382202, "question_id": 51867056, "link": "https://stackoverflow.com/questions/51867056/delete-vba-module", "title": "Delete VBA module", "body": "<p>I was deleting an Access Object (a report) and Access crashed during the delete.</p>\n\n<p>The object no longer exists in Access, but its module still shows up in VBA like a ghost.</p>\n\n<p>If I click on it, I get a FILE NOT FOUND error.</p>\n\n<p>If I try to compact &amp; repair or compile the database, I get a FILE NOT FOUND error.</p>\n\n<p>How can I solve this problem?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1534369361, "post_id": 51866837, "comment_id": 90685740, "body": "You never mention to start at B7"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1534369491, "post_id": 51866837, "comment_id": 90685785, "body": "Do you want the data \u201cpasted\u201d to also start on Row 7?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1534369620, "post_id": 51866837, "comment_id": 90685838, "body": "What does it do different from your expectations? In my test, it works as described. It takes the last value in column B on the Resource sheet and puts it into the next empty cell in column B on the TEST sheet. What do you want done differently? What had you hoped?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534370437, "post_id": 51866837, "comment_id": 90686087, "body": "sorry was error on post. updated and working fine now"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1534370407, "last_edit_date": 1534370407, "creation_date": 1534369898, "answer_id": 51866950, "question_id": 51866837, "link": "https://stackoverflow.com/questions/51866837/vba-copying-and-pasting-from-different-worksheets/51866950#51866950", "title": "VBA copying and pasting from different worksheets", "body": "<p>This will</p>\n\n<ol>\n<li>Grab range from <code>Resource</code> starting from <code>B7</code> down to the last used row in <code>Column B</code></li>\n<li>Move the range to <code>Test</code> on first available non-blank cell</li>\n</ol>\n\n<hr>\n\n<pre><code>Sub CopyName()\n\nDim Resource As Worksheet: Set Resource = ThisWorkbook.Sheets(\"Resource\")\nDim Test As Worksheet: Set Test = ThisWorkbook.Sheets(\"TEST\")\nDim ResourceRange As Range\n\nSet ResourceRange = Resource.Range(\"B7:B\" &amp; Resource.Range(\"B\" &amp; Resource.Rows.Count).End(xlUp).Row)\n\nTest.Range(\"B\" &amp; Test.Rows.Count).End(xlUp).Offset(1).Resize(ResourceRange.Rows.Count, 1).Value = ResourceRange.Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 9192957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5ac96e2e7ea76afe0213f04aa6ba45?s=128&d=identicon&r=PG&f=1", "display_name": "CGG", "link": "https://stackoverflow.com/users/9192957/cgg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51866950, "answer_count": 1, "score": -1, "last_activity_date": 1534380720, "creation_date": 1534369207, "last_edit_date": 1534380720, "question_id": 51866837, "link": "https://stackoverflow.com/questions/51866837/vba-copying-and-pasting-from-different-worksheets", "title": "VBA copying and pasting from different worksheets", "body": "<p>I am trying to copy data from <code>column B</code> in the <code>Resource</code> worksheet to the <code>TEST</code> worksheet. </p>\n\n<p>It\u00b4s meant to copy from <code>B7</code> onwards and I wanted it so that it searched the last row in the <code>TEST</code> one and paste it there using <code>Offset (1,0)</code> but it doesn't seem to work as I had hoped.    </p>\n\n<pre><code> Sub CopyName()\n Worksheets(\"TEST\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0) = \n Worksheets(\"Resource\").Range(\"B\" &amp; Rows.Count).End(xlUp).Value\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "named-ranges"], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1534393417, "post_id": 51866856, "comment_id": 90690660, "body": "That actually works! amazing! a follow-up question.. where can I read about that? what should I look for? because I don&#39;t know how to refer the subject.."}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "reply_to_user": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1534433136, "post_id": 51866856, "comment_id": 90712527, "body": "Wow, is that ever a tough question to answer. Most of what I learn about Excel I have learned from years of playing with it, as well as reading snippets of code here and there. I record macros and look at the code that Excel generates, using that as a kick-off to understand the Excel object model. I even got help from the Microsoft Excel help system itself. Unusual, I know. This is all built on top of a four year Computer Science degree and years in the industry. Anyway, search for Excel object model and read away. Have fun! I love Excel."}], "tags": [], "owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "is_accepted": true, "score": 1, "last_activity_date": 1534369304, "creation_date": 1534369304, "answer_id": 51866856, "question_id": 51866625, "link": "https://stackoverflow.com/questions/51866625/dynamic-range-based-formula-results-change-every-time-i-switch-sheet-excel-vba/51866856#51866856", "title": "Dynamic range based formula results&#39; change every time I switch sheet Excel VBA", "body": "<p>In several places, the code references the ActiveSheet. Wherever the function appears, it will reflect the value of whatever sheet is active. You'll want to use the parent of the supplied range object instead.</p>\n\n<pre><code>Dim currentSheet as Worksheet\nSet currentSheet = rangeObj.Parent\n</code></pre>\n\n<p>Then, search and replace ActiveSheet with currentSheet in the method.</p>\n"}], "owner": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 51866856, "answer_count": 1, "score": 1, "last_activity_date": 1594151347, "creation_date": 1534368147, "last_edit_date": 1594151347, "question_id": 51866625, "link": "https://stackoverflow.com/questions/51866625/dynamic-range-based-formula-results-change-every-time-i-switch-sheet-excel-vba", "title": "Dynamic range based formula results&#39; change every time I switch sheet Excel VBA", "body": "<p>I wrote a function that supposed to get a specific part of a specific Column, and then, by comparing each entry of the column to the value of the cell that is left to it, count the times a specific condition is met.\nIt all works alright, except one problem.. if I use the function on \"Sheet1\", get a result and then switch to \"Sheet2\" and use the function on this sheet it changes the result on \"Sheet1\" for some reason.</p>\n\n<pre><code>Function countStable(rangeObj As Range) 'rangeObj that being passed is a namedRange(Synamic Range)\n    Application.Volatile\n    ActiveSheet.Select\n    Dim entry, preEntryVal, entryVal As Variant\n    Dim counters(1 To 5, 1 To 1) As Integer\n\n    Dim cStable, cIncreased, cDecreased, cAdded, cLost\n\n    cStable = 0\n    cIncreased = 0\n    cDecreased = 0\n    cAdded = 0\n    cLost = 0\n\n    Set rangeObj = Intersect(rangeObj, rangeObj.Parent.UsedRange)\n\n    For Each entry In rangeObj\n    If Not IsEmpty(entry.Value) And Not IsEmpty(ActiveSheet.Range(\"A\" &amp; entry.Row)) Then\n        entryVal = entry.Value\n        preEntryVal = ActiveSheet.Cells(entry.Row, entry.Column - 1).Value\n\n        If entryVal = preEntryVal Then\n            cStable = cStable + 1\n        ElseIf InStr(entryVal, \"-\") And Not (InStr(preEntryVal, \"-\")) Then\n            cLost = cLost + 1\n        ElseIf Not InStr(entryVal, \"-\") And InStr(preEntryVal, \"-\") Then\n            cAdded = cAdded + 1\n        ElseIf preEntryVal &lt; entryVal Then\n            cDecreased = cDecreased + 1\n        ElseIf preEntryVal &gt; entryVal Then\n             cIncreased = cIncreased + 1\n        End If\n\n    End If\n\n    counters(1, 1) = cStable\n    counters(2, 1) = cIncreased\n    counters(3, 1) = cDecreased\n    counters(4, 1) = cAdded\n    counters(5, 1) = cLost\n\n    Next\n    countStable = counters\n\nEnd Function\n</code></pre>\n\n<p>As commented inside the code, rangeObj that is being passed as parameter was defined in the name manager and it is based on an Offset formula.\nI know it changes the values on both sheets because of the dynamic range, but not sure why.. I don't want it to be changed.</p>\n\n<p>Help please?</p>\n"}, {"tags": ["vba", "merge", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1534514741, "post_id": 51866401, "comment_id": 90745107, "body": "A suggestion/thought: instead of copy/pasting slides, try Presentation.Slides.InsertFromFile."}], "answers": [{"tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": false, "score": 0, "last_activity_date": 1535273328, "creation_date": 1535273328, "answer_id": 52024664, "question_id": 51866401, "link": "https://stackoverflow.com/questions/51866401/combining-powerpoints-in-target-folder/52024664#52024664", "title": "Combining powerpoints in target folder", "body": "<p>Did Steve's suggestion work?</p>\n\n<pre><code>Public Sub DoFiles()\n    Dim strFileName As String\n    Dim strFolderName As String\n    strFolderName = \"Target Folder\"\n    strFileName = Dir(strFolderName &amp; \"\\*.ppt*\")\n    Do While Len(strFileName) &gt; 0\n        ActivePresentation.Slides.InsertFromFile strFolderName &amp; \"\\\" &amp; strFileName, ActivePresentation.Slides.Count\n        strFileName = Dir\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7982415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eeb16f3a18acdef5b019dfe37f70b61?s=128&d=identicon&r=PG&f=1", "display_name": "Halfrican008", "link": "https://stackoverflow.com/users/7982415/halfrican008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593730015, "creation_date": 1534366994, "last_edit_date": 1593730015, "question_id": 51866401, "link": "https://stackoverflow.com/questions/51866401/combining-powerpoints-in-target-folder", "title": "Combining powerpoints in target folder", "body": "<p>I have never posted here before, so I thought I would give it a try. I have a macro that I have been using for over a year, and at beginning of the week it started to give me some problems. It will either just pull in the first slide of each powerpoint, or it will give me a Run-Time error \"Slides (Unknown Member): Invalid request. Clipboard is empty or contains data which may not be pasted here.\"</p>\n\n<p>The macro works fine if I just step through it using F8, the only time that I have issues is if I try to run it. It may be something super obvious, as I am pretty new to VBA. Thanks for the help!</p>\n\n<pre><code>Public Sub DoFiles()\nDim strFileName As String\nDim strFolderName As String\nDim objPresentation As Presentation\n'set default directory here if needed\nstrFolderName = \"Target Folder\"\nstrFileName = Dir(strFolderName &amp; \"\\*.ppt*\")\nDo While Len(strFileName) &gt; 0\n   Set objPresentation = Presentations.Open(strFolderName &amp; \"\\\" &amp; \nstrFileName)\nOn Error Resume Next\n\nDim i As Integer\n\nFor i = 1 To objPresentation.Slides.Count\nobjPresentation.Slides.Item(i).Copy\nPresentations.Item(1).Slides.Paste\nPresentations.Item(1).Slides.Item(Presentations.Item(1).Slides.Count).Design \n= _\n    objPresentation.Slides.Item(i).Design\nNext i\nobjPresentation.Close\n\n\n    strFileName = Dir\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1534561362, "post_id": 51866457, "comment_id": 90760466, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/178235/discussion-on-answer-by-dmitry-streblechenko-loop-through-all-outlook-inboxes-in\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1534521947, "last_edit_date": 1534521947, "creation_date": 1534367268, "answer_id": 51866457, "question_id": 51866322, "link": "https://stackoverflow.com/questions/51866322/loop-through-all-outlook-inboxes-including-shared-inboxes-error/51866457#51866457", "title": "Loop through all Outlook inboxes including shared inboxes error", "body": "<p>Firstly, get rid of the <code>On Error Resume Next</code> line.\nSecondly, <code>Fldr</code> variable is never set. Did you mean to use <code>storeInbox</code> variable instead? </p>\n\n<pre><code>Sub Display()\n\nDim Fldr As Outlook.Folder\nDim olfolder As Outlook.MAPIFolder\nDim olMail As Outlook.MailItem\nDim olReply As Outlook.MailItem\nDim olItems As Outlook.Items\nDim i As Integer\nDim signature As String\nDim allStores As Stores\nDim storeInbox As Folder\nDim j As Long\n\nSet allStores = Session.Stores\n\nFor j = 1 To allStores.count\nOn Error Resume Next\nDebug.Print i &amp; \" DisplayName - \" &amp; allStores(i).DisplayName\nOn Error GoTo 0\n\nSet storeInbox = Nothing\nOn Error Resume Next\nSet storeInbox = allStores(i).GetDefaultFolder(olFolderInbox)\nOn Error GoTo 0\n\nIf Not storeInbox Is Nothing Then\n\n     Set olItems = Fldr.Items\n\nolItems.Sort \"[Received]\", True\n\nFor i = 1 To olItems.count\n    signature = Environ(\"appdata\") &amp; \"\\Microsoft\\Signatures\\\"\n\n    If Dir(signature, vbDirectory) &lt;&gt; vbNullString Then\n        signature = signature &amp; Dir$(signature &amp; \"*.htm\")\n    Else\n        signature = \"\"\n    End If\n\n    signature = CreateObject(\"Scripting.FileSystemObject\").GetFile(signature).OpenAsTextStream(1, -2).ReadAll\n\n    Set olMail = olItems(i)\n\n    If InStr(olMail.Subject, Worksheets(\"Checklist Form\").Range(\"B8\")) &lt;&gt; 0 Then\n        If Not olMail.Categories = \"Executed\" Then\n            Set olReply = olMail.ReplyAll\n\n            With olReply\n                .HTMLBody = \"&lt;p style='font-family:calibri;font-size:14.5'&gt;\" &amp; \"Hi Everyone,\" &amp; _\n                    \"&lt;p style='font-family:calibri;font-size:14.5'&gt;\" &amp; \"Workflow ID:\" &amp; \" \" &amp; _\n                    Worksheets(\"Checklist Form\").Range(\"B6\") &amp; \"&lt;p style='font-family:calibri;font-size:14.5'&gt;\" &amp; _\n                    Worksheets(\"Checklist Form\").Range(\"B11\") &amp; \"&lt;p style='font-family:calibri;font-size:14.5'&gt;\" &amp; _\n                    \"Regards,\" &amp; \"&lt;/p&gt;&lt;br&gt;\" &amp; signature &amp; .HTMLBody\n                .Display\n                .Subject = \"RO Finalized WF:\" &amp; Worksheets(\"Checklist Form\").Range(\"B6\") &amp; \" \" &amp; _\n                    Worksheets(\"Checklist Form\").Range(\"B2\") &amp; \" -\" &amp; Worksheets(\"Fulfillment Checklist\").Range(\"B3\")\n            End With\n\n            Exit For\n            olMail.Categories = \"Executed\"\n\n        End If\n    End If\n\nNext i\n\nEnd if\n\nNext\n\nExitRoutine:\nSet allStores = Nothing\nSet storeInbox = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1592945069, "creation_date": 1534366635, "last_edit_date": 1592945069, "question_id": 51866322, "link": "https://stackoverflow.com/questions/51866322/loop-through-all-outlook-inboxes-including-shared-inboxes-error", "title": "Loop through all Outlook inboxes including shared inboxes error", "body": "<p>I have code that will search through a user's Outlook and reply to an email depending on the Subject phrase you input in the worksheet cell. I did have it working a couple days ago, but now I can not seem to get it to work (was deleted). Once run, an error message will continuously display for code line \"Set olitems = flrd.Items\", saying \"Object variable or With block variable not set\". I think the problem is the End if but wherever I place it either the code does nothing or the same error displays.</p>\n\n<p>The only other problem with the working code (when it worked) was that it populated more than once. I wish it to populate only one time.</p>\n\n<pre><code>Sub Display()\n\nDim Fldr As Outlook.Folder\nDim olfolder As Outlook.MAPIFolder\nDim olMail As Outlook.MailItem\nDim olReply As Outlook.MailItem\nDim olItems As Outlook.Items\nDim i As Integer\nDim signature As String\nDim allStores As Stores\nDim storeInbox As Folder\nDim j As Long\n\nSet allStores = Session.Stores\n\nFor j = 1 To allStores.count\nOn Error Resume Next\nDebug.Print i &amp; \" DisplayName - \" &amp; allStores(i).DisplayName\nOn Error GoTo 0\n\nSet storeInbox = Nothing\nOn Error Resume Next\nSet storeInbox = allStores(i).GetDefaultFolder(olFolderInbox)\nOn Error GoTo 0\n\nIf Not storeInbox Is Nothing Then\nEnd if\n     Set olItems = Fldr.Items\n\nolItems.Sort \"[Received]\", True\n\nFor i = 1 To olItems.count\n    signature = Environ(\"appdata\") &amp; \"\\Microsoft\\Signatures\\\"\n\n    If Dir(signature, vbDirectory) &lt;&gt; vbNullString Then\n        signature = signature &amp; Dir$(signature &amp; \"*.htm\")\n    Else\n        signature = \"\"\n    End If\n\n    signature = CreateObject(\"Scripting.FileSystemObject\").GetFile(signature).OpenAsTextStream(1, -2).ReadAll\n\n    Set olMail = olItems(i)\n\n    If InStr(olMail.Subject, Worksheets(\"Checklist Form\").Range(\"B8\")) &lt;&gt; 0 Then\n        If Not olMail.Categories = \"Executed\" Then\n            Set olReply = olMail.ReplyAll\n\n            With olReply\n                .HTMLBody = \"&lt;p style='font-family:calibri;font-size:14.5'&gt;\" &amp; \"Hi Everyone,\" &amp; _\n                    \"&lt;p style='font-family:calibri;font-size:14.5'&gt;\" &amp; \"Workflow ID:\" &amp; \" \" &amp; _\n                    Worksheets(\"Checklist Form\").Range(\"B6\") &amp; \"&lt;p style='font-family:calibri;font-size:14.5'&gt;\" &amp; _\n                    Worksheets(\"Checklist Form\").Range(\"B11\") &amp; \"&lt;p style='font-family:calibri;font-size:14.5'&gt;\" &amp; _\n                    \"Regards,\" &amp; \"&lt;/p&gt;&lt;br&gt;\" &amp; signature &amp; .HTMLBody\n                .Display\n                .Subject = \"RO Finalized WF:\" &amp; Worksheets(\"Checklist Form\").Range(\"B6\") &amp; \" \" &amp; _\n                    Worksheets(\"Checklist Form\").Range(\"B2\") &amp; \" -\" &amp; Worksheets(\"Fulfillment Checklist\").Range(\"B3\")\n            End With\n\n            Exit For\n            olMail.Categories = \"Executed\"\n\n        End If\n    End If\n\nNext i\n Set Fldr = StoreInbox\n\nNext\n\nExitRoutine:\nSet allStores = Nothing\nSet storeInbox = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "connection-string", "sql-server-express", "mdf"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534367359, "post_id": 51866101, "comment_id": 90685074, "body": "I am not sure what exactly the problem is because you explained too much that I lost the thread, but there are things you have to try first and then see what happens, 1-do NOT name any file <code>test</code>, it is a bad idea and sometimes you get nothing like an error or sth, but you don&#39;t get any result too so rename the file and try again 2-are you sure the address is valid? when you copy paste the address for <code>sDBFile</code> in the address bar of the file explorer does file explorer on windows takes you there?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534368868, "post_id": 51866101, "comment_id": 90685577, "body": "also, remove your password from the SQL database and then edit this connection string and try it <code>Private Const sCONNECTION_STRING As String = &quot;Provider=SQLNCLI10;Server=SLI0115\\SQLEXPRESS;Database=TMS;T&zwnj;&#8203;rusted_Connection=ye&zwnj;&#8203;s;&quot;</code>"}, {"owner": {"reputation": 527, "user_id": 662586, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e02811681b46047f576392d3db3f74dd?s=128&d=identicon&r=PG", "display_name": "JeffR", "link": "https://stackoverflow.com/users/662586/jeffr"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534406420, "post_id": 51866101, "comment_id": 90695910, "body": "I just can&#39;t open the .mdf file. Just trying on PCA, then migrate to PCB. No, I don&#39;t use &#39;test&#39; or &#39;password&#39;, just an example."}, {"owner": {"reputation": 527, "user_id": 662586, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e02811681b46047f576392d3db3f74dd?s=128&d=identicon&r=PG", "display_name": "JeffR", "link": "https://stackoverflow.com/users/662586/jeffr"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534406479, "post_id": 51866101, "comment_id": 90695939, "body": "Yes, the .mdf file exists and explorer finds it"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534439431, "post_id": 51866101, "comment_id": 90715983, "body": "did you try the connection string I gave you? just edit it based on your database"}, {"owner": {"reputation": 527, "user_id": 662586, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e02811681b46047f576392d3db3f74dd?s=128&d=identicon&r=PG", "display_name": "JeffR", "link": "https://stackoverflow.com/users/662586/jeffr"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1534594335, "post_id": 51866101, "comment_id": 90767148, "body": "So I successfully got this working. Here is my connection string: sConnectionString = &quot;Provider=SQLOLEDB;Server=&quot; &amp; sComputer &amp; &quot;;AttachDbFilename=\\\\&quot; &amp; sDBFile &amp; &quot;;Database=test;Trusted_Connection=Yes;&quot;"}, {"owner": {"reputation": 527, "user_id": 662586, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e02811681b46047f576392d3db3f74dd?s=128&d=identicon&r=PG", "display_name": "JeffR", "link": "https://stackoverflow.com/users/662586/jeffr"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534594930, "post_id": 51866101, "comment_id": 90767331, "body": "I got local and remote working. To get it, I think I just needed to understand how SQL Server attaches databases. I attached a local copy of the test.mdf file on each server. Using the Microsoft SQL Server Management Studio (SSMS) really helped. First, I RDP&#39;ed into the remote server. Once in, I enabled TCP/IP in SQL Server. I then attached the test.mdf database file using SSMS. Back on my local computer, I loaded the local copy of test.MDF into SSMS. Then, in my VB6 code, I connected successfully to the local DB."}, {"owner": {"reputation": 527, "user_id": 662586, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e02811681b46047f576392d3db3f74dd?s=128&d=identicon&r=PG", "display_name": "JeffR", "link": "https://stackoverflow.com/users/662586/jeffr"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534629773, "post_id": 51866101, "comment_id": 90775836, "body": "To connect to the remote sql server, I used the same connection string, EXCEPT I did not use &quot;Database=test;&quot;. This also worked perfectly. Setting the &quot;Database=test;&quot; only should be enabled if it&#39;s the local PC if that database is already attached to SQL Server on the local PC."}], "owner": {"reputation": 527, "user_id": 662586, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e02811681b46047f576392d3db3f74dd?s=128&d=identicon&r=PG", "display_name": "JeffR", "link": "https://stackoverflow.com/users/662586/jeffr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2524, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534365622, "creation_date": 1534365622, "question_id": 51866101, "link": "https://stackoverflow.com/questions/51866101/vba-connection-string-to-sql-server-express-2017", "title": "VBA connection string to SQL Server Express 2017", "body": "<p>My environment is Windows 10 (PCA), SQL Server Express 2017, and I'm using VBA.</p>\n\n<p>I'm trying to do something really simple. Since I can't use SQL Server CE, I'm using SQL Server Express 2017. I simply want to create an MDF file I can use on another Windows 10 computer (PCB) that is also running SQL Server Express 2017 and have my VBA code open up the database.</p>\n\n<p>So I went about this task by creating a database in SQL Server Mgt Studio. It put the .mdf file in \"C:\\Program Files\\Microsoft SQL Server\\MSSQL14.MSSQLSERVER\\MSSQL\\DATA\".</p>\n\n<p>If I stop the service \"SQL Server (MSSQLSERVER)\", I can copy out the .mdf and log file to another location. Eventually I want to access the file from a remote computer, but just trying to get this seemingly simple task done.</p>\n\n<p>The problem is I can't open up the file using ADODB on another computer, even after I copy it from PCA to PCB. Heck, I can't even open it up on the same computer I created it on (PCA) using the VBA code below! Maybe it's my connection string?</p>\n\n<p>Everyone can have access to it, and I plan on accessing it through password and also encrypting the file,  but for now I'll take just opening it!</p>\n\n<p>I've tried all these connection strings, but I'm a bit confused on password protecting the file in SSE?</p>\n\n<pre><code>Set dbConn = CreateObject(\"ADODB.Connection\")\ndbConn.Mode = adModeShareDenyNone\ndbConn.CursorLocation = adUseServer\n\nsDBFile = \"\\\\PCB\\c$\\programdata\\company\\product\\test.mdf\"\n\n'   SQL Express 2017\nsConnectionString = \"Driver={SQL Server};Server=M10;Database=test;Trusted_Connection=True;\"\nsConnectionString = \"Driver={SQL Server};Server=M10;AttachDbFilename=\" &amp; Chr$(34) &amp; sDBFile &amp; Chr$(34) &amp; \";Database=test;Trusted_Connection=Yes;Initial Catalog=test;User Instance=True; \"\nsConnectionString = \"Driver={SQL Server};Server=M10;AttachDbFilename=\" &amp; Chr$(34) &amp; sDBFile &amp; Chr$(34) &amp; \";Trusted_Connection=Yes;\"\nsConnectionString = \"Driver={SQL Server};Server=M10;Initial Catalog=\" &amp; Chr$(34) &amp; sDBFile &amp; Chr$(34) &amp; \";Trusted_Connection=yes;\"\nsConnectionString = \"Driver={SQL Server};Server=M10;Initial Catalog=\" &amp; Chr$(34) &amp; sDBFile &amp; Chr$(34) &amp; \";Trusted_Connection=Yes;User ID=domain\\user1;Password=password;Database=\" &amp; Chr$(34) &amp; Chr$(34) &amp; \";\"\nsConnectionString = \"Driver={SQL Server};Server=M10;Initial Catalog=\" &amp; Chr$(34) &amp; sDBFile &amp; Chr$(34) &amp; \";Trusted_Connection=Yes;User ID=domain\\user1;Password=password;Database=test;\"\nsConnectionString = \"Driver={SQL Server};Server=M10;Initial Catalog=\" &amp; Chr$(34) &amp; sDBFile &amp; Chr$(34) &amp; \";User ID=domain\\user1;Password=password;\"\n\nsConnectionString = \"Driver={SQL Server};Data Source=M10;Initial Catalog=\" &amp; Chr$(34) &amp; sDBFile &amp; Chr$(34) &amp; \";Integrated Security=True;Pooling=False\"\nsConnectionString = \"Data Source=M10;Initial Catalog=test.sdf;Integrated Security=True;Pooling=False\"\n\nsConnectionString = \"Driver={SQL Server};Data Source=M10;AttachDbFilename=\" &amp; Chr$(34) &amp; sDBFile &amp; Chr$(34) &amp; \";Initial Catalog=test;Integrated Security=True;\"\nsConnectionString = \"Driver={SQL Server};Server=M10;AttachDbFilename=\" &amp; Chr$(34) &amp; sDBFile &amp; Chr$(34) &amp; \";Initial Catalog=test;Integrated Security=True;Trusted_Connection=Yes;\"\nsConnectionString = \"Data Source=M10;Initial Catalog=test;Integrated Security=True;Connect Timeout=30;Encrypt=False;TrustServerCertificate=False;ApplicationIntent=ReadWrite;MultiSubnetFailover=False\"\n\ndbConn.ConnectionString = sConnectionString\n\ndbConn.Open\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 2682623, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e72c8b4cf81414503287ba9a61b5325?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2682623/mike"}, "edited": false, "score": 0, "creation_date": 1534431572, "post_id": 51866769, "comment_id": 90711578, "body": "Thank you!  The &quot;InsertParagraphAfter&quot; was the key!  One thing, though - the font did not apply using this as provided.  I have added another answer with full font handling."}], "tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": true, "score": 1, "last_activity_date": 1534368859, "creation_date": 1534368859, "answer_id": 51866769, "question_id": 51866047, "link": "https://stackoverflow.com/questions/51866047/adding-document-property-field-to-footer-removes-existing-page-numbering/51866769#51866769", "title": "Adding document property field to footer removes existing page numbering", "body": "<p>If that is how you want the new field positioned, then try something like this ...</p>\n\n<pre><code>Dim docSection As word.Section, sectionFooter As word.HeaderFooter\nDim rng As word.Range\nFor Each docSection In ActiveDocument.Sections\n    For Each sectionFooter In docSection.Footers\n        Set rng = sectionFooter.Range\n        rng.InsertParagraphAfter\n        rng.Collapse wdCollapseEnd\n        rng.Font.Size = 8\n        rng.Font.Name = \"Arial\"\n        rng.Fields.Add Range:=rng, Type:=wdFieldEmpty, Text:=\"DOCVARIABLE  ndGeneratedStamp\", PreserveFormatting:=False\n    Next\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 316, "user_id": 2682623, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e72c8b4cf81414503287ba9a61b5325?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2682623/mike"}, "edited": false, "score": 0, "creation_date": 1534421537, "post_id": 51870669, "comment_id": 90704708, "body": "I thought this would work as well :)  However, it eliminates the existing footer fields.  The template I have been using has  different first page footer, with a page number on it, and this disappears when I run the macro as you have it."}, {"owner": {"reputation": 1676, "user_id": 9992612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef2e5e68dd3a455ba00724f5fdfaf604?s=128&d=identicon&r=PG&f=1", "display_name": "Seiya Su", "link": "https://stackoverflow.com/users/9992612/seiya-su"}, "reply_to_user": {"reputation": 316, "user_id": 2682623, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e72c8b4cf81414503287ba9a61b5325?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2682623/mike"}, "edited": false, "score": 1, "creation_date": 1534422044, "post_id": 51870669, "comment_id": 90705023, "body": "So we also need to try different solution to meet your requirement."}], "tags": [], "owner": {"reputation": 1676, "user_id": 9992612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef2e5e68dd3a455ba00724f5fdfaf604?s=128&d=identicon&r=PG&f=1", "display_name": "Seiya Su", "link": "https://stackoverflow.com/users/9992612/seiya-su"}, "is_accepted": false, "score": -1, "last_activity_date": 1534400754, "last_edit_date": 1534400754, "creation_date": 1534400141, "answer_id": 51870669, "question_id": 51866047, "link": "https://stackoverflow.com/questions/51866047/adding-document-property-field-to-footer-removes-existing-page-numbering/51870669#51870669", "title": "Adding document property field to footer removes existing page numbering", "body": "<p>Based on my test, we can just remove the commented code too.</p>\n\n<p><strong>Note</strong> If we use this way, we need to set the page-number first then run the Macro.</p>\n\n<pre><code>Dim docSection As Word.Section, sectionFooter As Word.HeaderFooter \nFor Each docSection In ActiveDocument.Sections\n    For Each sectionFooter In docSection.Footers\n            'sectionFooter.Range.Collapse wdCollapseEnd\n            'sectionFooter.Range.Text = sectionFooter.Range.Text + \" \"\n            sectionFooter.Range.Collapse wdCollapseEnd\n            Dim newPP As Paragraph\n            Set newPP = sectionFooter.Range.Paragraphs.Add()\n\n            newPP.Range.Font.Size = 8\n            newPP.Range.Font.Name = \"Arial\"\n            ActiveDocument.Fields.Add Range:=newPP.Range, Type:=wdFieldEmpty, Text:=\"DOCVARIABLE  ndGeneratedStamp\", preserveformatting:=False\n\n    Next\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 316, "user_id": 2682623, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e72c8b4cf81414503287ba9a61b5325?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2682623/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1534431755, "creation_date": 1534431755, "answer_id": 51880154, "question_id": 51866047, "link": "https://stackoverflow.com/questions/51866047/adding-document-property-field-to-footer-removes-existing-page-numbering/51880154#51880154", "title": "Adding document property field to footer removes existing page numbering", "body": "<p>Rich's answer handled the heavy lifting, but for anyone who happens upon this, wanted to spell out how I was also able to isolate the new paragraph and apply the font.</p>\n\n<pre><code>Set rng = sectionFooter.Range\n\n            rng.InsertParagraphAfter\n            Set rng = sectionFooter.Range\n            rng.Collapse wdCollapseEnd\n            Set newPP = rng.Paragraphs.Last\n            newPP.Range.Font.Size = 8\n            newPP.Range.Font.Name = \"Arial\"\n            rng.Fields.Add Range:=newPP.Range, Type:=wdFieldEmpty, Text:=\"DOCVARIABLE  ndGeneratedStamp\", preserveformatting:=False\n</code></pre>\n"}], "owner": {"reputation": 316, "user_id": 2682623, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e72c8b4cf81414503287ba9a61b5325?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2682623/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 51866769, "answer_count": 3, "score": 0, "last_activity_date": 1594010434, "creation_date": 1534365364, "last_edit_date": 1594010434, "question_id": 51866047, "link": "https://stackoverflow.com/questions/51866047/adding-document-property-field-to-footer-removes-existing-page-numbering", "title": "Adding document property field to footer removes existing page numbering", "body": "<p>I am tying to stamp a document variable field in the footer of every page in a document.  I have figured out how to add the field.  However, in doing so, the page numbering field that already exists in the footer becomes disabled, leaving only the text and no longer acting as a dynamic page number.  Any help would be appreciated.</p>\n\n<p>Here is my code that adds the field, but disables the page numbers somehow. (the \"sectionFooter.Range.Text = sectionFooter.Range.Text + \" \"\" line is the only way I could find to even get the page number to still show):</p>\n\n<pre><code>For Each docSection In ActiveDocument.Sections\n    For Each sectionFooter In docSection.Footers\n\n            sectionFooter.Range.Collapse wdCollapseEnd\n            sectionFooter.Range.Text = sectionFooter.Range.Text + \" \"\n            sectionFooter.Range.Collapse wdCollapseEnd\n            Dim newPP As Paragraph\n            Set newPP = sectionFooter.Range.Paragraphs.Add()\n\n            newPP.Range.Font.Size = 8\n            newPP.Range.Font.Name = \"Arial\"\n            ActiveDocument.Fields.Add Range:=newPP.Range, Type:=wdFieldEmpty, Text:=\"DOCVARIABLE  ndGeneratedStamp\", preserveformatting:=False\n\n    Next\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 0, "creation_date": 1534364806, "post_id": 51865850, "comment_id": 90684065, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20635629/how-to-add-date-and-time-to-file-name-using-vba-in-excel\">How to Add Date and Time To File Name Using VBA in Excel</a>"}, {"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 0, "creation_date": 1534364841, "post_id": 51865850, "comment_id": 90684081, "body": "If your file name is always based on the date, then just compute the file name using the date."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534364857, "post_id": 51865850, "comment_id": 90684088, "body": "Loop through files in the folder and check <code>LEFT([filename],8) = &quot;bankinfo&quot;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "is_accepted": false, "score": 0, "last_activity_date": 1534365074, "creation_date": 1534365074, "answer_id": 51865993, "question_id": 51865850, "link": "https://stackoverflow.com/questions/51865850/excel-vba-how-to-point-to-relative-directory-name-of-the-file-changes-a-bit-ev/51865993#51865993", "title": "Excel VBA: How to point to relative directory (name of the file changes a bit everyday)?", "body": "<p>Try this:</p>\n\n<pre><code>MyFile = \"Z:\\test\\bankinfo\"\nSet Workbook = Workbooks.Open(MyFile &amp; \"*.xls\")\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 0, "last_activity_date": 1534366630, "creation_date": 1534366630, "answer_id": 51866320, "question_id": 51865850, "link": "https://stackoverflow.com/questions/51865850/excel-vba-how-to-point-to-relative-directory-name-of-the-file-changes-a-bit-ev/51866320#51866320", "title": "Excel VBA: How to point to relative directory (name of the file changes a bit everyday)?", "body": "<p>You can use a wildcard like *, but if there are multiple files, it can open a wrong file so a better method is to make sure you are opening the exact file. </p>\n\n<pre><code> Sub OpenMyWB()\n    sdir = \"Z:\\test\\\"\n    sFile = Dir(sdir &amp; \"bankinfo\" &amp; Format(Date, \"yyyymmdd\") &amp; \".xls\")\n    Set wb = Application.Workbooks.Open(sdir &amp; sFile)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10230628, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156869033434172/picture?type=large", "display_name": "Henry Cao", "link": "https://stackoverflow.com/users/10230628/henry-cao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534366630, "creation_date": 1534364381, "last_edit_date": 1534364650, "question_id": 51865850, "link": "https://stackoverflow.com/questions/51865850/excel-vba-how-to-point-to-relative-directory-name-of-the-file-changes-a-bit-ev", "title": "Excel VBA: How to point to relative directory (name of the file changes a bit everyday)?", "body": "<p>The current code is: </p>\n\n<pre><code>Set Workbook = Workbooks.Open(\"Z:\\test\\bankinfo20180815.xls\")\n</code></pre>\n\n<p>The file in the folder would change. For example: it was bankinfo20180814.xls yesterday, bankinfo20180815.xls today and bankinfo20180816.xls tomorrow. So I am wondering how I can specify in VBA code to point to the file that starts with \"bankinfo\"?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1534364047, "creation_date": 1534364047, "answer_id": 51865776, "question_id": 51865449, "link": "https://stackoverflow.com/questions/51865449/want-excel-userform-to-populate-a-specific-range-in-the-next-blank-row/51865776#51865776", "title": "Want excel userform to populate a specific range in the next blank row", "body": "<p>This should work for your first check. Can carry the logic down for each check needed</p>\n\n<pre><code>IF ws.Range(\"B\" &amp; lastRow) &lt;&gt; \"\" Then ws.Range(\"B\" &amp; lastRow) = ComboBox1.Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "is_accepted": false, "score": -1, "last_activity_date": 1534364076, "creation_date": 1534364076, "answer_id": 51865783, "question_id": 51865449, "link": "https://stackoverflow.com/questions/51865449/want-excel-userform-to-populate-a-specific-range-in-the-next-blank-row/51865783#51865783", "title": "Want excel userform to populate a specific range in the next blank row", "body": "<p>You can loop through the cells in the last row to check if each one is blank. If not, do the same with the next row until you find the first row in which all cells from column B to Q are blank.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub test()\nDim lastRow As Long\nDim ws As Worksheet\nDim rowFilled As Boolean\n\nSet ws = Sheets(\"Risk&amp;Opp\")\nlastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n'Set boolean to true\nrowFilled = True\n\n'Count rows until you find a row where range B:Q is blank\nWhile rowFilled = True\n    rowFilled = False\n\n    'Loop from column B (index 2) to column Q (index 17)\n    For i = 2 To 17\n\n        'If one of the cell is not blank increase lastrow\n        If ws.Cells(lastRow, i) &lt;&gt; \"\" Then\n            rowFilled = True\n            lastRow = lastRow + 1\n            Exit For\n        End If\n    Next i\nWend\n\n'The first row with blank range B:Q\nMsgBox lastRow\n\n'...Add your existing code here...\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10231084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fdcbee808376090ca5e5ff3c6710785?s=128&d=identicon&r=PG&f=1", "display_name": "User4567890", "link": "https://stackoverflow.com/users/10231084/user4567890"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1534365315, "creation_date": 1534362456, "question_id": 51865449, "link": "https://stackoverflow.com/questions/51865449/want-excel-userform-to-populate-a-specific-range-in-the-next-blank-row", "title": "Want excel userform to populate a specific range in the next blank row", "body": "<p>first time posting here. I am trying to have my userform values fill in the next \"blank row\", but the row won't truly be blank. The range I want the userform to fill will be blank, but the first column and last 2 columns of the sheet will have formulas.<br>\nfor example, \"A\", \"D\" and \"E\" will have formulas already in them, I need my userform to populate \"B\" and \"C\". I hope that makes sense.</p>\n\n<pre><code>Private Sub Add_Click()\n'Copy input values to sheet.\nDim lastRow As Long\nDim ws As Worksheet\nSet ws = Sheets(\"Risk&amp;Opp\")\nlastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\nws.Range(\"B\" &amp; lastRow).Value = ComboBox1.Value\nws.Range(\"C\" &amp; lastRow).Value = ComboBox2.Value\nws.Range(\"D\" &amp; lastRow).Value = TextBox1.Value\nws.Range(\"E\" &amp; lastRow).Value = TextBox2.Value\nws.Range(\"F\" &amp; lastRow).Value = ComboBox4.Value\nws.Range(\"G\" &amp; lastRow).Value = ComboBox5.Value\nws.Range(\"H\" &amp; lastRow).Value = Me.ComboBox6.Value\nws.Range(\"I\" &amp; lastRow).Value = Me.ComboBox7.Value\nws.Range(\"J\" &amp; lastRow).Value = Me.ComboBox8.Value\nws.Range(\"K\" &amp; lastRow).Value = Me.TextBox3.Value\nws.Range(\"M\" &amp; lastRow).Value = Me.TextBox4.Value\nws.Range(\"O\" &amp; lastRow).Value = Me.ComboBox9.Value\nws.Range(\"P\" &amp; lastRow).Value = Me.TextBox5.Value\nws.Range(\"Q\" &amp; lastRow).Value = Me.TextBox6.Value\n</code></pre>\n\n<p>Here I have formulas in A,R, and S. I would like my userform to see if the range B:Q is blank, and if so, assign those values from the userform.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 6, "creation_date": 1534360568, "post_id": 51865017, "comment_id": 90682267, "body": "<code>LastRow2 = Cells(Rows.Count, 2).End(xlUp).Row</code>. You have 1 (Column A) instead of 2."}, {"owner": {"reputation": 51, "user_id": 10171431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e264beb6e34b2fbb8e2bc0c650515afe?s=128&d=identicon&r=PG&f=1", "display_name": "user10171431", "link": "https://stackoverflow.com/users/10171431/user10171431"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534360707, "post_id": 51865017, "comment_id": 90682328, "body": "Amazing, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 3597925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58c4d3f24cbe9de6ac4d4faaafd1556d?s=128&d=identicon&r=PG&f=1", "display_name": "StringsAndThings", "link": "https://stackoverflow.com/users/3597925/stringsandthings"}, "is_accepted": false, "score": 0, "last_activity_date": 1543458867, "creation_date": 1543458867, "answer_id": 53531006, "question_id": 51865017, "link": "https://stackoverflow.com/questions/51865017/excel-vba-finding-last-row/53531006#53531006", "title": "Excel VBA: Finding last row", "body": "<p>You can add a VBA Function like the below:</p>\n\n<pre><code>    Function GetLastRow(wsTarget As Worksheet, iCol)\n    'Gets the last non-blank cell\n    Dim lrow As Long, Max_Row\n\n    Max_Row = 1048576\n        On Error GoTo SmallFile\n\n    TryAgain:\n        With wsTarget\n            lrow = .Cells(Max_Row, iCol).End(xlUp).Row\n        End With\n\n        GetLastRow = lrow\n\n        Exit Function\n    SmallFile:\n        Max_Row = 65536\n        On Error GoTo 0\n        GoTo TryAgain\n\n    End Function\n</code></pre>\n\n<p>Then you specificy the worksheet and column number you're after. i.e. GetLastRow(worksheets(\"Sheet1\"),1) would return the last row for Column A in the Sheet1 tab.</p>\n"}], "owner": {"reputation": 51, "user_id": 10171431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e264beb6e34b2fbb8e2bc0c650515afe?s=128&d=identicon&r=PG&f=1", "display_name": "user10171431", "link": "https://stackoverflow.com/users/10171431/user10171431"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543458867, "creation_date": 1534360473, "question_id": 51865017, "link": "https://stackoverflow.com/questions/51865017/excel-vba-finding-last-row", "title": "Excel VBA: Finding last row", "body": "<p>I am trying to find the last row of a set of numbers for each column, however it seems my code is using the same last row as the previous column's last row. </p>\n\n<p>Here is the first column's code:</p>\n\n<pre><code>Dim WorkRng As Range\nxTitleId = \"Select Total Sales cell\"\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\nWorkRng.Select\nSelection.Copy\nRange(\"A65\") = \"Total Sales\"\nRange(\"A66\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSet WorkRng = Range(\"A66\")\n</code></pre>\n\n<p>Here is the adjacent column's code:</p>\n\n<pre><code>Dim WorkRng2 As Range\nxTitleId2 = \"Select Collected Range\"\nSet WorkRng2 = Application.Selection\nSet WorkRng2 = Application.InputBox(\"Range\", xTitleId2, WorkRng2.Address, Type:=8)\nWorkRng2.Select\nSelection.Copy\nRange(\"B65\") = \"Collected Range\"\nRange(\"B66\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"B66:B100\").Select\nSelection.SpecialCells(xlCellTypeBlanks).Select\nSelection.Delete Shift:=xlUp\nRange(\"B66\").Select\nDim LastRow2 As Long\nLastRow2 = Cells(Rows.Count, 1).End(xlUp).Row\nRange(\"B\" &amp; LastRow2).Offset(1, 0).Formula = \"=SUM(B66:B\" &amp; LastRow2 &amp; \")\"\nRange(\"B\" &amp; LastRow2).Offset(1, 0).Select\nSet WorkRng2 = Range(\"B\" &amp; LastRow2).Offset(1, 0)\n</code></pre>\n\n<p>It keeps saying that LastRow2 is 66, however I would like it to be dynamic and independent of the first column's last row. </p>\n\n<p>Any help is greatly appreciated</p>\n"}, {"tags": ["vba", "excel", "gmail"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1534361585, "post_id": 51864983, "comment_id": 90682686, "body": "I&#39;m assuming that by &quot;without using credentials&quot; you mean by using a session that is already logged in on a browser? I&#39;m confused as to what exactly you are trying to accomplish."}, {"owner": {"reputation": 95, "user_id": 4177780, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b214b1d6d61977220e9710e0de869f5a?s=128&d=identicon&r=PG&f=1", "display_name": "BillyMadison", "link": "https://stackoverflow.com/users/4177780/billymadison"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1534362444, "post_id": 51864983, "comment_id": 90683058, "body": "Yes, that is correct. I will edit with more background on what I want to accomplish."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1534363062, "post_id": 51864983, "comment_id": 90683303, "body": "You might want to take a look at the <a href=\"https://developers.google.com/gmail/api/\" rel=\"nofollow noreferrer\">Gmail RESTful API</a> before you try to do this with CDO."}], "owner": {"reputation": 95, "user_id": 4177780, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b214b1d6d61977220e9710e0de869f5a?s=128&d=identicon&r=PG&f=1", "display_name": "BillyMadison", "link": "https://stackoverflow.com/users/4177780/billymadison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 581, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534362689, "creation_date": 1534360293, "last_edit_date": 1534362689, "question_id": 51864983, "link": "https://stackoverflow.com/questions/51864983/compose-gmail-email-using-vba", "title": "Compose Gmail Email using VBA", "body": "<p>Using VBA in Excel, and user is already signed into Gmail, how can I compose an email in Gmail without sending, either as a draft or as a pop-up? I've seen several examples of using credentials to send email, but can I do it without using credentials because the user is already logged in?</p>\n\n<pre><code>Set iMsg = CreateObject(\"CDO.Message\")\nSet iConf = CreateObject(\"CDO.Configuration\")\n\niConf.Load -1    ' CDO Source Defaults\nSet Flds = iConf.Fields\nWith Flds\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = True\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\") = 1\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = \"someone@gmail.com\"\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"*******\"\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtp.gmail.com\"\n\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 465\n    .Update\nEnd With\n\n\n\nWith iMsg\n    Set .Configuration = iConf\n    .To = \"me@hotmail.com\"\n    .CC = \"\"\n    .BCC = \"\"\n    .From = \"\"\"Dave\"\" &lt;me@hotmail.com&gt;\"\n    .Subject = \"New form\"\n    .AddAttachment TempFilePath &amp; TempFileName &amp; FileExtStr\n    .Send\nEnd With\n</code></pre>\n\n<p>EDIT: My company uses Outlook but we are switching to Google soon. In my auto generated email in Outlook, in Excel I take certain cells to help populate the subject line, body, and email recipient. I am hoping to do the same process but instead of using Outlook, I would like to use Google.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 35130, "user_id": 1255289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5ed02658b2440179f00eeff8beb7aa4c?s=128&d=identicon&r=PG", "display_name": "miken32", "link": "https://stackoverflow.com/users/1255289/miken32"}, "edited": false, "score": 2, "creation_date": 1534360133, "post_id": 51864876, "comment_id": 90682060, "body": "You may want to look at using regular expressions. <a href=\"https://stackoverflow.com/q/22542834/1255289\">stackoverflow.com/q/22542834/1255289</a>"}, {"owner": {"reputation": 35130, "user_id": 1255289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5ed02658b2440179f00eeff8beb7aa4c?s=128&d=identicon&r=PG", "display_name": "miken32", "link": "https://stackoverflow.com/users/1255289/miken32"}, "edited": false, "score": 2, "creation_date": 1534360203, "post_id": 51864876, "comment_id": 90682092, "body": "Or why not just <code>Mid(String.value, InStr(1, String.value, &quot;.&quot;) + 1, 1)</code>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1534360291, "post_id": 51864876, "comment_id": 90682124, "body": "Change your <code>Mid</code> to <code>Mid(String.Value, Instr(1, String.value, &quot;.&quot;) + 1, 1)</code>"}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "reply_to_user": {"reputation": 35130, "user_id": 1255289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5ed02658b2440179f00eeff8beb7aa4c?s=128&d=identicon&r=PG", "display_name": "miken32", "link": "https://stackoverflow.com/users/1255289/miken32"}, "edited": false, "score": 0, "creation_date": 1534360464, "post_id": 51864876, "comment_id": 90682220, "body": "@miken32 amazing... please put that as answer and I will mark correct."}], "answers": [{"tags": [], "owner": {"reputation": 35130, "user_id": 1255289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5ed02658b2440179f00eeff8beb7aa4c?s=128&d=identicon&r=PG", "display_name": "miken32", "link": "https://stackoverflow.com/users/1255289/miken32"}, "is_accepted": true, "score": 2, "last_activity_date": 1534360848, "last_edit_date": 1534360848, "creation_date": 1534360484, "answer_id": 51865018, "question_id": 51864876, "link": "https://stackoverflow.com/questions/51864876/vba-search-for-and-what-is-after-it/51865018#51865018", "title": "VBA search for &#39;.&#39; and what is after it", "body": "<p>Perhaps the fastest solution would be to just increase the offset of your <code>Mid</code> to move past the period:</p>\n\n<pre><code>result = Mid(String.value, InStr(1, String.value, \".\") + 1, 1)\n</code></pre>\n\n<p>Then check if <code>result</code> is a number.</p>\n\n<hr>\n\n<p>A more powerful option would be to use <a href=\"https://stackoverflow.com/q/22542834/1255289\">regular expressions</a>. Once enabled, you could do something like this:</p>\n\n<pre><code>Dim regex As New RegExp\n\nregex.Pattern = \"\\.([0-9])\"\nIf regex.test(String.value) Then\n    theNumber = $1\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 51865018, "answer_count": 1, "score": 1, "last_activity_date": 1534361033, "creation_date": 1534359796, "last_edit_date": 1534361033, "question_id": 51864876, "link": "https://stackoverflow.com/questions/51864876/vba-search-for-and-what-is-after-it", "title": "VBA search for &#39;.&#39; and what is after it", "body": "<p>I would like to perform a rather complicated piece of search on VBA. What I want to look for is for anything in my column that contains a \".\" (period/full stop) followed by a single digit.</p>\n\n<p>I.e. anything that looks like this xxxx.0xxx, or xx.1.xxx ... etc</p>\n\n<p>Note that the full stop can appear anywhere in the string.</p>\n\n<p>To look for a full stop in string is relatively straightforward, I stick in a <code>For</code> loop to go through Column:</p>\n\n<pre><code>If InStr(1, String.value, \".\") Then\n     'do vba code\nEnd If\n</code></pre>\n\n<p>The challenge is to how to isolate and identify the single character that is followed by the full stop.</p>\n\n<p>When I use this formula, I am able to get the full stop and what is next to it.. But just the character next to it:</p>\n\n<pre><code>Mid(String.value, InStr(1, String.value, \".\"), 2)\n</code></pre>\n\n<p>Can you guys please advise what is the best method to proceed?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Sample data and outcome:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ilMTo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ilMTo.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 486, "user_id": 7702557, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1CvmzaRcsJA/AAAAAAAAAAI/AAAAAAAAAuM/adI9FGhMf5w/photo.jpg?sz=128", "display_name": "Kwright02", "link": "https://stackoverflow.com/users/7702557/kwright02"}, "edited": false, "score": 0, "creation_date": 1534359012, "post_id": 51864660, "comment_id": 90681546, "body": "if you&#39;re able to do something (like handle an event of when something happens) when an input or field is changed and make it pull up a pop-up that asks them to confirm the change they just made, and if they say no, then revert it back to what it was"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1534359115, "post_id": 51864660, "comment_id": 90681581, "body": "Generally we would use the form&#39;s <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/form-beforeupdate-event-access\" rel=\"nofollow noreferrer\">BeforeUpdate Event</a> to confirm or undo pending changes."}], "answers": [{"tags": [], "owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "is_accepted": true, "score": 1, "last_activity_date": 1534359745, "creation_date": 1534359745, "answer_id": 51864866, "question_id": 51864660, "link": "https://stackoverflow.com/questions/51864660/how-to-ask-a-user-to-confirm-edits-to-a-record-in-access/51864866#51864866", "title": "How to ask a user to confirm edits to a record in access", "body": "<p>This type of event can be handled with a simple response on save / update event.</p>\n\n<pre><code>response = MsgBox(\"Save your record?\", vbQuestion + vbYesNo, \"Save Confirmation\")\nIf response = vbNo Then\n    Cancel = True\n    Me.Undo\nEnd If\n</code></pre>\n\n<p><code>Cancel = True</code> stops the record from being written and saved.<br>\n<code>Me.Undo</code> reverts the changes to the source</p>\n\n<p>This would be handled through the <code>BeforeUpdate</code> event.</p>\n\n<p>Alternatively, this can be handled differently by using a specific <code>save</code> function for the form (where the form would otherwise never update the source), and simply posting a similiar confirmation where a <code>vbYes</code> results in a save.</p>\n"}, {"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 1, "last_activity_date": 1534360584, "creation_date": 1534360584, "answer_id": 51865030, "question_id": 51864660, "link": "https://stackoverflow.com/questions/51864660/how-to-ask-a-user-to-confirm-edits-to-a-record-in-access/51865030#51865030", "title": "How to ask a user to confirm edits to a record in access", "body": "<p>You can do what others have suggested and process the <code>BeforeUpdate</code> event or use an unbound form with a <code>Save</code> button. There is a third option, which is ideal for preventing accidental edits on forms that are mainly meant for data retrieval and only occasionally for data editing. Add a toggle button that toggles the form from <code>ReadOnly</code> to <code>ReadWrite</code> by means of the <code>AllowEdits</code> parameter.</p>\n"}], "owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 51864866, "answer_count": 2, "score": 1, "last_activity_date": 1534360584, "creation_date": 1534358852, "question_id": 51864660, "link": "https://stackoverflow.com/questions/51864660/how-to-ask-a-user-to-confirm-edits-to-a-record-in-access", "title": "How to ask a user to confirm edits to a record in access", "body": "<p>I have a working access database that uses a multiple items form along with a search function in order to display records. I noticed that it was really easy to change information in a record without noticing.</p>\n\n<p>Is there a way to ask a user if they're sure they want to make changes to a record before the table is updated?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1534357649, "post_id": 51864340, "comment_id": 90680905, "body": "Can anyone help me format this question? I have no idea why but I&#39;m unable to add pictures. It tells me to indent my code... @PeterT Much appreciated."}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 1, "creation_date": 1534358959, "post_id": 51864340, "comment_id": 90681526, "body": "Nothing but problems with the RefEdit Object!"}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 1, "creation_date": 1534359939, "post_id": 51864340, "comment_id": 90681969, "body": "It seems that the <code>DropButtonClick</code> event gets fired twice, once on the way in and once on the way out...hence the issue."}, {"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "reply_to_user": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1534361169, "post_id": 51864340, "comment_id": 90682518, "body": "Even removing the frames, which usually causes issues, is of no help"}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1534362537, "post_id": 51865316, "comment_id": 90683091, "body": "I must first say that I didn&#39;t know that combo boxes were part of the RefEdit object. Otherwise, I think I&#39;ll move away from the combo boxes to encounter less issues. Thanks for the 2nd resource."}], "tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": true, "score": 1, "last_activity_date": 1534363579, "last_edit_date": 1592644375, "creation_date": 1534361944, "answer_id": 51865316, "question_id": 51864340, "link": "https://stackoverflow.com/questions/51864340/combobox-inputbox-causes-reselection-of-range/51865316#51865316", "title": "ComboBox inputbox causes reselection of range", "body": "<p>When I've used the <code>RefEdit</code> object in the past, I used the real thing (which I know has it's issues) and just used the <code>Change</code> event.</p>\n<p>Perhaps you could just use the <code>Enter</code> event (you just have to ignore it the first time, if's it the first object that gets focus when initialized)</p>\n<p><em><strong>Resources:</strong></em></p>\n<p><strong><a href=\"https://peltiertech.com/using-refedit-controls-in-excel-dialogs/\" rel=\"nofollow noreferrer\">Using RefEdit Controls in Excel\nDialogs</a> - Jon Peltier</strong></p>\n<blockquote>\n<p><strong>RefEdits must be placed directly on the UserForm itself.</strong> If you put a\nRefEdit in a frame or on a multipage, strange things will happen,\nincluding bizarre Excel crashes.</p>\n<p><strong>RefEdits must not be used on modeless forms.</strong> RefEdits on modeless\nforms will result in bizarre Excel crashes.</p>\n<p><strong>RefEdit event procedures should be avoided.</strong> RefEdit events do not\nbehave reliably, and they may result in VBA errors which are difficult\nto debug.</p>\n<p><strong>References to RefEdits must be removed.</strong> When a UserForm is added to a\nVB project, Excel adds a reference to the Microsoft Forms 2.0 Object\nLibrary. This reference is required for proper operation of the\nUserForms in your project. To see what references your project has,\nselect the project in the Project Explorer, then select References\nfrom the Tools menu.</p>\n</blockquote>\n<p><strong><a href=\"https://peltiertech.com/refedit-control-alternative/\" rel=\"nofollow noreferrer\">Alternative to Excel\u2019s Flaky RefEdit Control</a> - Jon Peltier</strong></p>\n<blockquote>\n<p>The new approach uses a TextBox in the dialog instead of the RefEdit.</p>\n<p>The TextBox does not interact directly with a range as does the RefEdit. Instead, when this drop button is clicked, the dialog is temporarily hidden, and an InputBox appears to solicit the user\u2019s input.</p>\n<p>&quot;It may be tempting to use type 8 to indicate a range object, but there\nis an obscure glitch that causes it to fail when the worksheet\ncontains conditional formatting conditions that use formulas in their\ndefinitions. Fortunately using Type 0 to specify a formula works just\nfine.&quot;</p>\n</blockquote>\n<p><strong><a href=\"http://support.microsoft.com/kb/291110\" rel=\"nofollow noreferrer\">Cannot use keyboard shortcuts to select ranges in RefEdit control in Excel</a></strong></p>\n"}, {"comments": [{"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1534364105, "post_id": 51865514, "comment_id": 90683749, "body": "FYI, <code>Set InputCell =...</code> will error if the user cancels input.  This if one of the only times where you need to wrap it with <code>On Error Resume Next</code>.  Then you can check <code>If Not InputCell is Nothing Then</code> and continue setting the address."}], "tags": [], "owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1534362735, "creation_date": 1534362735, "answer_id": 51865514, "question_id": 51864340, "link": "https://stackoverflow.com/questions/51864340/combobox-inputbox-causes-reselection-of-range/51865514#51865514", "title": "ComboBox inputbox causes reselection of range", "body": "<p>From this source: <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/100576-combobox-change-event-firing-multiple-times\" rel=\"nofollow noreferrer\">Ozgrid</a></p>\n\n<p>Though I'll be using custom text boxes, this could also work if anyone wants to use the combo boxes.</p>\n\n<pre><code>Private Sub ComboBox1_DropButtonClick()\n    Static Abort As Boolean\n\n    If Abort Then Exit Sub\n    Abort = False\n\n    Dim InputCell As Range\n    Set InputCell = Application.InputBox(\"Select Lookup Cell\", \"Obtain Object Range\", Type:=8)\n\n    ComboBox1.Text = InputCell.Address(0, 0, external:=True)\n\n    Abort = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 51865316, "answer_count": 2, "score": 1, "last_activity_date": 1534363579, "creation_date": 1534357433, "last_edit_date": 1534357788, "question_id": 51864340, "link": "https://stackoverflow.com/questions/51864340/combobox-inputbox-causes-reselection-of-range", "title": "ComboBox inputbox causes reselection of range", "body": "<p>Currently I'm working on a userform prompting an inputbox for a range whenever the combobox dropdown button is clicked.</p>\n\n<p>The problem is that whenever the range is selected (selecting a cell and then clicking ok), the userform is unselected (greys out), shows an empty dropdown list and forces me to reselect a range after I click anywhere on the workbook.</p>\n\n<p><strong>Is there any way to prevent a re selection of a range when clicking the dropdown button?</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/zqNJN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zqNJN.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/YemBe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YemBe.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/BwPEv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BwPEv.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code Below:</p>\n\n<pre><code>Private Sub ComboBox1_DropButtonClick()\n    Dim InputCell As Range\n    Set InputCell = Application.InputBox(\"Select Lookup Cell\", \"Obtain Object Range\", Type:=8)\n    ComboBox1.Text = InputCell.Address(0, 0, external:=True)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9290848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ded95ebc7bcf1073746b26e04037fe?s=128&d=identicon&r=PG&f=1", "display_name": "CRunyon", "link": "https://stackoverflow.com/users/9290848/crunyon"}, "edited": false, "score": 0, "creation_date": 1534359616, "post_id": 51864271, "comment_id": 90681818, "body": "Wow... such and elegant and easy solution. Yet I couldn&#39;t find it anywhere and didn&#39;t even think I could use With on a userform. Thank you for the fast and detailed response!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 37, "user_id": 9290848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ded95ebc7bcf1073746b26e04037fe?s=128&d=identicon&r=PG&f=1", "display_name": "CRunyon", "link": "https://stackoverflow.com/users/9290848/crunyon"}, "edited": false, "score": 0, "creation_date": 1534363774, "post_id": 51864271, "comment_id": 90683599, "body": "You are welcome. While as to the best practice for handling UserForm object you can find something better around here: what I showed you is improvable"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1534357110, "creation_date": 1534357110, "answer_id": 51864271, "question_id": 51864144, "link": "https://stackoverflow.com/questions/51864144/pulling-option-button-value-when-user-form-closes/51864271#51864271", "title": "Pulling Option Button value when user form closes", "body": "<p>don't unload the Userform from within its code, hence use <code>Me.Hide</code> instead of <code>Unload Me</code></p>\n\n<p>this way once in your code (that caleed the userform) you dtill have access to userform members</p>\n\n<p>so your main code could look like</p>\n\n<pre><code>Sub main()\n\n    With UserForm1 ' load the userform\n        .Show ' show the useform\n\n        MsgBox .OptionButton1 ' &lt;-- you still have access to Userform1 members\n        MsgBox .OptionButton2\n        MsgBox .OptionButton3\n    End With\n    Unload UserForm1 ' unload userform1\n\nEnd Sub\n</code></pre>\n\n<p>while your <em>exiting</em> userform code would look like:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Me.Hide ' just hide the userform, but still keep it \"alive\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9290848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ded95ebc7bcf1073746b26e04037fe?s=128&d=identicon&r=PG&f=1", "display_name": "CRunyon", "link": "https://stackoverflow.com/users/9290848/crunyon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 51864271, "answer_count": 1, "score": 0, "last_activity_date": 1534357110, "creation_date": 1534356546, "question_id": 51864144, "link": "https://stackoverflow.com/questions/51864144/pulling-option-button-value-when-user-form-closes", "title": "Pulling Option Button value when user form closes", "body": "<p>I looked around for an answer but everything I saw had the option button on a sheet rather than a user form like what I'm trying to do.</p>\n\n<p>Quick run-through: User clicks a button on the sheet to add info to a list, but needs to choose which list they want to add to. I have a user form pop up with option buttons to select which one they want to add to. </p>\n\n<p>Problem is, I can't seem to get the values of the buttons when I go back to my code. I'm guessing that when I unload the user form, all variables and objects get cleaned so I was thinking to save a value into a global variable but the scope of the user form and scope of the code don't seem to talk to each other. </p>\n\n<p>Any ideas on how I can pull the value of an option button from a user form into my module code?</p>\n\n<p>I've tried these different variations:</p>\n\n<pre><code>    Not OptionButton1 Is Empty\n\n    If UserForm1.OptionButton2 = True\n\n    If UserForm1.OptionButton3.Value = True\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 9, "creation_date": 1534356227, "post_id": 51864001, "comment_id": 90680285, "body": "You can&#39;t declare a <code>Public</code> variable inside a <code>Sub</code>. It goes in the declarations section at the top. But don&#39;t do that. Global variables cause <b><i>way</i></b> more problems than they solve."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1534356400, "post_id": 51864001, "comment_id": 90680361, "body": "Agree with @Comintern - <b>don&#39;t</b> use global variables.  Why not simply keep that saved in your <code>personal.xlsb</code> as a misc. sub (which you won&#39;t use!), but keep it there.  Or store in a .txt file somwehere on your computer.   Then, when you need it, simple copy/paste the variables to the <code>Sub</code> you are actually using."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1534357771, "post_id": 51864001, "comment_id": 90680954, "body": "@Comintern Unfortunately, VBA has enough coding limitations that you are practically-speaking compelled to use them for many things.  But yes, they should be used as sparingly as possible and with certain restrictions.  I added some paragraphs to my answer to explain this."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 1, "creation_date": 1534358011, "post_id": 51864001, "comment_id": 90681057, "body": "@RBarryYoung That&#39;s not strictly true. You can create a property on <i>anything</i> to encapsulate a variable, even a standard module.  In my experience the use of global variables is a short-cut that comes from fast and sloppy coding, and the problems that come with using them are almost always avoidable and deserved."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1534358149, "post_id": 51864001, "comment_id": 90681122, "body": "Thank you all for your guidance and knowledge.  I really appreciate it!  This helped me greatly."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1534357543, "post_id": 51864244, "comment_id": 90680857, "body": "More specifically, it doesn&#39;t just have to be &quot;outside of any subroutine or function&quot;, it <b><i>must</i></b> be above the first procedure. Otherwise it makes the grammar impossible to parse because <code>Private Foo</code> is an ambiguous fragment after the first procedure."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1534358293, "post_id": 51864244, "comment_id": 90681198, "body": "Thank you for providing an example of how to set this up.  This now makes more sense to me.  I think i will just stick with declaring the variables as needed instead of using &quot;Public&quot; as it sounds like it could open the doors for a major headache and since I am still relatively new to VBA; I think its best to stick with what works to save me or any users down the road any issues.  Thank you again!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1534362101, "post_id": 51864244, "comment_id": 90682899, "body": "@ZackE FWIW I downvoted this answer because 1) &quot;VBA has too many limitations&quot; has a tendency to be flatout wrong and make me less receptive about the content of everything else in a post; 2) Recommending public fields is a bad recommendation, especially when 3) no mention is made of <code>Workheet.CodeName</code> which is absolutely applicable and preferred here, since the sheets appear to exist at compile-time in <code>ThisWorkbook</code>, and 4) the part about <code>Option Private Module</code> is wrong."}], "tags": [], "owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "is_accepted": true, "score": -1, "last_activity_date": 1534358248, "last_edit_date": 1534358248, "creation_date": 1534356994, "answer_id": 51864244, "question_id": 51864001, "link": "https://stackoverflow.com/questions/51864001/public-vs-private-dim-in-excel-vba/51864244#51864244", "title": "Public vs Private/Dim in Excel VBA", "body": "<p>You really should only need <code>Option Private Module</code> if you are making your own Excel Add-In (*.XLAM file).  It allows a module's <code>Public</code> variables to be visible to other modules within the Add-In's own project but keeps them from being visible/callable by other worksheets that use your AddIn.</p>\n\n<p>As for the rest, it's not clear what you are asking.  The question you linked has a good explanation of Public vs Dim/Private.  Private/Dim variables cannot be seen by the VBA code in different Modules, Forms or Classes in the same VBA project.  You use public if you want all of your VBA code to be able to see/call it.  You use private/dim if you want it to only be visible/callable from within it's own module.</p>\n\n<p>But <em>generally</em> you want to be judicious with what you make public, both because it can give you too many global names (confusing), can cause problems with duplicate names (problematic, can be addressed with naming standard) and most of all because it can lead to confusing/obscure bugs and horrendous debugging problems (because any public variable change could cause any other code that can see it to behave differently).  And some things are worse than others:</p>\n\n<pre><code>Public Subs        OK in a module, but better in a Class\nPublic Function    Usually fine, especially if its a true function\nPublic Const       No problem, belongs in modules\nPublic Variables   Very Bad.  *UNLESS ...*\n</code></pre>\n\n<p>Public variables are the ones that good coders worry about.  They are to be avoided, UNLESS they are what we call \"Read-Only Variables\".  These are variables that <em>you set only once, and never change again</em>.  As long as you follow that rule, they are effectively constants and are OK (though read-only static properties would be better, but VBA has too many limitations in this regard).</p>\n\n<p>Finally If you want to use named variables for all of your worksheets that are visible/useable from all code, but you only have to setup once, that is what <code>Public</code> is for, but the declaration (\"Public \") needs to be at \"<em>the Module Level</em>\" which means, in a module, <em>but</em> outside of any subroutine or function.  Like this:</p>\n\n<pre><code>Public wb As Workbook\nPublic wsSI As Worksheet\nPublic wsRR As Worksheet\nPublic wsCalcs As Worksheet\nPublic wsNarr As Worksheet\nPublic wsEval As Worksheet\nPublic wsUW As Worksheet\nPublic wsLVBA As Worksheet\n\n' sets all of the Worksheet variables\nSub PubVar()\n\n    Set wb = Application.ThisWorkbook\n    Set wsSI = wb.Sheets(\"SavedInfo\")\n    Set wsCalcs = wb.Sheets(\"Calcs\")\n    Set wsNarr = wb.Sheets(\"Narrative\")\n    Set wsEval = wb.Sheets(\"EvalCL\")\n    Set wsUW = wb.Sheets(\"UWCL\")\n    Set wsLVBA = wb.Sheets(\"ListsForVBA\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1534362367, "last_edit_date": 1534362367, "creation_date": 1534361841, "answer_id": 51865287, "question_id": 51864001, "link": "https://stackoverflow.com/questions/51864001/public-vs-private-dim-in-excel-vba/51865287#51865287", "title": "Public vs Private/Dim in Excel VBA", "body": "<h1>Option Private Module</h1>\n\n<p><code>Option Private Module</code> should be used in any standard module that doesn't mean to expose its public members to Excel as macros (i.e. <code>Public Sub</code> procedures) or User-Defined-Functions (i.e. <code>Public Function</code> procedures).</p>\n\n<p>Without this option, a standard module's public parameterless <code>Sub</code> procedures appear in Excel's list of available macros, and public <code>Function</code> procedures appear in Excel's cell \"intellisense\" as available worksheet functions.</p>\n\n<p>Note that this merely <em>hides</em> a module's members from the macros list: if you type the exact name of a \"hidden\" procedure, Excel will still run it.</p>\n\n<hr>\n\n<h1>Dim vs Private vs Public</h1>\n\n<p><code>Dim</code> is a keyword you use for declaring <strong>local variables</strong>, inside a procedure scope. The keyword is also <em>legal</em> for declaring private, module-level variables, but then you might as well use <code>Private</code>.</p>\n\n<p>When used for declaring module-level variables, <code>Private</code> makes that variable only accessible from within the module it's declared in.</p>\n\n<p>When used for declaring module-level variables, <code>Public</code> makes that variable accessible from anything that has access to the module it's declared in - in a standard module, that means the variable is effectively <code>Global</code>. In a class (/document/userform/anything else) module, it means the variable holds <em>instance state</em> and is accessible from anything that has access to <em>an instance of</em> that class. Classes that have a <em>predeclaredId</em>, such as <code>UserForm</code> classes, all have an instance that's globally accessible: avoid storing instance state in this default instance.</p>\n\n<hr>\n\n<h1>Use Worksheet.CodeName</h1>\n\n<blockquote>\n<pre><code>Set wb = Application.ThisWorkbook\nSet wsSI = wb.Sheets(\"SavedInfo\")\nSet wsCalcs = wb.Sheets(\"Calcs\")\nSet wsNarr = wb.Sheets(\"Narrative\")\nSet wsEval = wb.Sheets(\"EvalCL\")\nSet wsUW = wb.Sheets(\"UWCL\")\nSet wsLVBA = wb.Sheets(\"ListsForVBA\")\n</code></pre>\n</blockquote>\n\n<p><code>ThisWorkbook</code> is the workbook you're looking at - the one that contains your VBA code. The <code>ThisWorkbook</code> identifier is globally accessible, and <code>Application.ThisWorkbook</code> is merely a pointer to that object.</p>\n\n<p>Use <code>ThisWorkbook</code> over <code>Application.ThisWorkbook</code>, unless you've declared a local variable and named it <code>ThisWorkbook</code> - then that local variable would be <em>shadowing</em> the global identifier; don't do that. There shouldn't be any reason to need to qualify <code>ThisWorkbook</code> with <code>Application</code>.</p>\n\n<p>Now, if any of these worksheets exist at compile-time in <code>ThisWorkbook</code>, then you don't need any of these variables. Find each sheet in the <em>Project Explorer</em> (Ctrl+R), then hit F4 and give its <code>(Name)</code> property a meaningful identifier name.</p>\n\n<p>So if you rename <code>Sheet1</code> to <code>SavedInfoSheet</code>, then you can access <code>SavedInfoSheet</code> from anywhere in the code, and you don't ever need to dereference it from the <code>Workbook.Sheets</code> (or better, <code>Workbook.Worksheets</code>) collection. The reason for this is that VBA automatically creates a global-scope identifier by the name of whatever identifier you put as the <code>(Name)</code> property of a <code>Worksheet</code> module.</p>\n\n<p>If the sheets don't exist at compile-time (i.e. they're created at run-time), then you don't need these variables either, because the code that created them should already have that reference:</p>\n\n<pre><code>Set theNewSheet = theBook.Worksheets.Add\n</code></pre>\n\n<p>Then you can (and should) pass these worksheet object references around, as parameters, as needed.</p>\n\n<hr>\n\n<h2>There is no worksheet.</h2>\n\n<blockquote>\n  <p><em>What I would like to do is set this up in a Standard Mod so I dont have to continue setting variables for worksheets through all of my UserForms that use the same naming convention for Worksheets they reference</em></p>\n</blockquote>\n\n<p>Your forms are running the show. The code that fires them looks like this:</p>\n\n<pre><code>UserForm1.Show\n</code></pre>\n\n<p>Like any UI, forms are responsible for <em>collecting user input</em>, and <em>showing data to the user</em>. If you find yourself writing userform code-behind that accesses a dozen worksheets (and/or worse, <a href=\"https://stackoverflow.com/a/51864244/1188513\">makes them <em>public fields</em></a>), you're making your form much, <em>much</em> more complicated than it needs to be, and you're <strong>treating a full-fledged object as a mere container for procedures, by making its <em>default instance</em> stateful</strong>.</p>\n\n<p><a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">This article</a> goes in details about how to fix that. <a href=\"https://rubberduckvba.wordpress.com/2018/05/08/apply-logic-for-userform-dialog/\" rel=\"nofollow noreferrer\">This article</a> pushes the concept further and allows back-and-forth communication between the <em>view</em> and the <em>presenter</em>, and has a download link with a simple example to study (disclaimer: I wrote these articles, and the accompanying example code).</p>\n\n<p>UserForm code done right, looks extremely simple, and is responsible for so little logic, it's boring. In fact, it's not responsible for <strong>any</strong> logic beyond <em>presentation</em> - all a UserForm should do, is respond to control events, relay control state to some <em>model</em>, and if application logic needs to be executed before the form is closed (e.g. if a command button is clicked but the form should remain open), then it fires an event, and the calling code (\"presenter\") handles it by triggering the logic that needs to run.</p>\n\n<p>When the dialog is okayed, or when it relays an event to the <em>presenter</em>, code <em>outside</em> the form's code-behind is executed to to the work: the form never needs to know anything about any worksheet.</p>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3246, "favorite_count": 1, "accepted_answer_id": 51864244, "answer_count": 2, "score": 4, "last_activity_date": 1534362367, "creation_date": 1534355854, "last_edit_date": 1534356433, "question_id": 51864001, "link": "https://stackoverflow.com/questions/51864001/public-vs-private-dim-in-excel-vba", "title": "Public vs Private/Dim in Excel VBA", "body": "<p>I could use some help in understanding using Public vs Dim in a module in Excel 2013 VBA.</p>\n\n<p>First I want to say I did find this great post with excellent definitions (see link below), but no examples and I could use some examples of how I could apply the Public Variables to my project.  Also I am a little confused on when I would need to use the Option Private Module; would I need to use that on each module I have or just the module that holds the below code?</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3815547/what-is-the-difference-between-dim-global-public-and-private-as-modular-field\">stackoverflow descriptions difference between Public/Private</a></p>\n\n<p>What I would like to do is set this up in a Standard Mod so I dont have to continue setting variables for worksheets through all of my UserForms that use the same naming convention for Worksheets they reference.  </p>\n\n<pre><code>Sub PubVar()\nPublic wb As Workbook\nPublic wsSI As Worksheet\nPublic wsRR As Worksheet\nPublic wsCalcs As Worksheet\nPublic wsNarr As Worksheet\nPublic wsEval As Worksheet\nPublic wsUW As Worksheet\nPublic wsLVBA As Worksheet\n\nSet wb = Application.ThisWorkbook\nSet wsSI = wb.Sheets(\"SavedInfo\")\nSet wsCalcs = wb.Sheets(\"Calcs\")\nSet wsNarr = wb.Sheets(\"Narrative\")\nSet wsEval = wb.Sheets(\"EvalCL\")\nSet wsUW = wb.Sheets(\"UWCL\")\nSet wsLVBA = wb.Sheets(\"ListsForVBA\")\nEnd Sub\n</code></pre>\n\n<p>Thank you for your assistance.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534356167, "post_id": 51863907, "comment_id": 90680249, "body": "First thing I see is that you loop through rows to hide rows. This can be improved on by using a filter and foregoing the loop"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534358412, "post_id": 51863907, "comment_id": 90681252, "body": "None of the optimizations are put into effect. They are true throughout."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1534364220, "post_id": 51864726, "comment_id": 90683799, "body": "the consolidation of this makes SO much more sense than what was previously there. What else were you intending on editing? Thanks a lot, so far, this looks amazing"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1534364315, "post_id": 51864726, "comment_id": 90683843, "body": "Did you test it? Does it work the same way it did? It should be faster already. Let me know IF and HOW it runs now. Don&#39;t want to make any edits if I broke something"}, {"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1534425674, "post_id": 51864726, "comment_id": 90707447, "body": "I&#39;m going to be in the office in a couple of hours, I&#39;ll let you know when I get in."}, {"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1534440038, "post_id": 51864726, "comment_id": 90716245, "body": "I keep getting a pathway error here: <code>If Dir(SavePath, vbDirectory) &lt;&gt; &quot;&quot; Then     MkDir SavePath End If</code>"}, {"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1534441390, "post_id": 51864726, "comment_id": 90716872, "body": "<code>Set SM = MCST.Sheets(CS.Range(&quot;A&quot; &amp; i))</code> type mismatch error here, too"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1534441660, "post_id": 51864726, "comment_id": 90716991, "body": "You can try <code>CS.Range(&quot;A&quot; &amp; i).Value</code>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1534441721, "post_id": 51864726, "comment_id": 90717013, "body": "I&#39;m going to delete the answer and may to to re-work if if i have time later. THis is the approach I would take though. The most important part is noticing the bottom two subs. The code you shared never turned all those options off which were there in the first place to boost run time"}, {"owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "edited": false, "score": 0, "creation_date": 1534787364, "post_id": 51864726, "comment_id": 90822137, "body": "I get a &quot;Run-time error 1004: document not saved. the document may be open, or an error may have been encountered when saving.&quot; when I try executing this block of code:                          ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _                                 Filename:=MgrPath &amp; &quot;2018 Mid-Year Comp Statement - &quot; &amp; SM.Range(&quot;C5&quot;).Value &amp; &quot;.pdf&quot;, _                                 Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _                                 OpenAfterPublish:=False"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1534359153, "creation_date": 1534359153, "answer_id": 51864726, "question_id": 51863907, "link": "https://stackoverflow.com/questions/51863907/loop-through-list-of-employee-ids-for-index-match-template/51864726#51864726", "title": "loop through list of employee IDs for INDEX &amp; MATCH template?", "body": "<p>I started this but won't have time to finish today. I tried to condense this so you could follow and hopefully see the pain points yourself. </p>\n\n<p>I would get rid of the <code>For Each MyCell</code> loop and just filter on your criteria <code>HIDE</code>. Looping &amp; Hiding can be time consuming so a filter would be much faster.</p>\n\n<pre><code>Option Explicit\n\nSub Statement_Autoprint()\n\nDim StartTime As Date: StartTime = Now()\n\nDim MCST As Workbook: Set MCST = ActiveWorkbook\nDim User As String: User = Environ$(\"Username\")\nDim SavePath As String: SavePath = \"C:\\Users\\\" &amp; User &amp; \"\\Desktop\\Manual Comp Statements\\\"\nDim CS As Worksheet: Set CS = MCST.Sheets(\"Control Sheet\")\n\nDim MgrPath As String, MyCell As Range, Printed As Integer, i As Integer, SM As Worksheet\nPrinted = 0\n\nIf Dir(SavePath, vbDirectory) &lt;&gt; \"\" Then\n    MkDir SavePath\nEnd If\n\nCall Disable\n\nFor i = 2 To CS.Range(\"B\" &amp; CS.Rows.Count).End(xlUp).Row\n    If CS.Range(\"A\" &amp; i) &lt;&gt; \"\" &amp; CS.Range(\"B\" &amp; i) &lt;&gt; \"\" Then\n        Set SM = MCST.Sheets(CS.Range(\"A\" &amp; i))\n        SM.Calculate\n        SM.Range(\"P1\") = Format(CS.Range(\"B\" &amp; i), \"000000000\")\n\n            For Each MyCell In SM.Range(\"N2:N70\")\n                If MyCell = \"HIDE\" Then\n                    MyCell.EntireRow.Hidden = True\n                ElseIf MyCell &lt;&gt; \"HIDE\" Then\n                    MyCell.EntireRow.Hidden = False\n                End If\n            Next MyCell\n\n        If Not Application.CalculationState = xlDone Then\n            DoEvents\n        End If\n\n        MgrPath = \"C:\\Users\\\" &amp; User &amp; \"\\Desktop\\Manual Comp Statements\\\" &amp; SM.Range(\"K5\") &amp; \"\\\"\n\n        If Dir(MgrPath, vbDirectory) &lt;&gt; \"\" Then\n            MkDir MgrPath\n        End If\n\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\n            Filename:=MgrPath &amp; \"2018 Mid-Year Comp Statement - \" &amp; SM.Range(\"C5\") &amp; \".pdf\", _\n            Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n            OpenAfterPublish:=False\n\n        Printed = Printed + 1\n    End If\nNext i\n\nCS.Activate\n\nCall Re_Enable\n\nMsgBox \"Execution Complete;\" &amp; vbCrLf &amp; _\n        Round((Now() - StartTime) * 86400, 0) &amp; \" Second Run Time.\" &amp; vbCrLf &amp; _\n        (i - 2) &amp; \" Considered\" &amp; vbCrLf &amp; _\n        Printed &amp; \" Statements Printed\"\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Disable()\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Re_Enable()\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10076310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2a4cec09554a1af167e0294de38fbe?s=128&d=identicon&r=PG&f=1", "display_name": "bloomfieldhero9219", "link": "https://stackoverflow.com/users/10076310/bloomfieldhero9219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534359153, "creation_date": 1534355450, "last_edit_date": 1534355971, "question_id": 51863907, "link": "https://stackoverflow.com/questions/51863907/loop-through-list-of-employee-ids-for-index-match-template", "title": "loop through list of employee IDs for INDEX &amp; MATCH template?", "body": "<p>I have a workbook with Employee ID's in (Control Sheet), Data with their ID's and various comp info (Data Sheet) and a sheet displaying a template with their compensation statements (Merit Sheet). </p>\n\n<p>The Merit sheet has a form template that populates a bunch of boxes based on Index/Match formulas (all referencing from the employee ID in cell P1 on that sheet). </p>\n\n<p>My coworker is using this incredibly complex VBA script that is prone to errors, and I was wondering if there's a simpler way to do this: </p>\n\n<ol>\n<li>go to control sheet, find first employee ID (there is a header row)</li>\n<li>populate that ID in cell P1 of Merit sheet</li>\n<li>take that newly filled in data and export as a .pdf</li>\n<li>loop to the next employee ID in the control sheet until all have been made into .pdfs in the merit sheet. </li>\n</ol>\n\n<p>original code: </p>\n\n<pre><code>Sub Statement_Autoprint()\n'\n' Macro1 Macro\n\nDim StartTime As Date\nStartTime = Now()\n\nDim MCST As Workbook\nSet MCST = ActiveWorkbook\nDim User As String\nUser = Environ$(\"Username\")\nDim SavePath As String\nDim MgrPath As String\nSavePath = \"C:\\Users\\\" &amp; User &amp; \"\\Desktop\\Manual Comp Statements\\\"\n\nIf Dir(SavePath, vbDirectory) = vbNullString Then\n    MkDir SavePath\nEnd If\n\nDim LoopRow As Integer\nDim Printed As Integer\nLoopRow = 2\nPrinted = 0\n\nDim Emplid As String\nDim EmpName As String\nDim MgrName As String\nDim Statement As String\nDim Range As Range\nDim rowstocheck As Range\n'With MCST.Sheets(Statement)\n\n'End With\n\nOn Error GoTo ErrorHandler:\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\n\nDo While Trim(MCST.Sheets(\"Control Sheet\").Range(\"B\" &amp; LoopRow)) &lt;&gt; \"\"\n\n    If Trim(MCST.Sheets(\"Control Sheet\").Range(\"A\" &amp; LoopRow)) &lt;&gt; \"\" Then\n        Statement = MCST.Sheets(\"Control Sheet\").Range(\"A\" &amp; LoopRow)\n        Emplid = Format(MCST.Sheets(\"Control Sheet\").Range(\"B\" &amp; LoopRow), \"000000000\")\n\n        MCST.Sheets(Statement).Activate\n        MCST.Sheets(Statement).Calculate\n        MCST.Sheets(Statement).Range(\"P1\") = Emplid\n            Set rowstocheck = MCST.Sheets(Statement).Range(\"N2:N70\")     \n                For Each Cell In rowstocheck\n                If Cell.Value = \"HIDE\" Then\n                        Cell.EntireRow.Hidden = True\n                ElseIf Cell.Value &lt;&gt; \"HIDE\" Then Cell.EntireRow.Hidden = False\n                End If\n                Next Cell                                              \n        If Not Application.CalculationState = xlDone Then\n            DoEvents\n        End If\n\n        EmpName = MCST.Sheets(Statement).Range(\"C5\")\n        MgrName = MCST.Sheets(Statement).Range(\"K5\")\n\n        MgrPath = \"C:\\Users\\\" &amp; User &amp; \"\\Desktop\\Manual Comp Statements\\\" &amp; MgrName &amp; \"\\\"\n        If Dir(MgrPath, vbDirectory) = vbNullString Then\n            MkDir MgrPath\n        End If\n\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\n            Filename:=MgrPath &amp; \"2018 Mid-Year Comp Statement - \" &amp; EmpName &amp; \".pdf\", _\n            Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n            OpenAfterPublish:=False\n        Printed = Printed + 1\n    End If\n    LoopRow = LoopRow + 1\nLoop\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nSheets(\"Control Sheet\").Activate\n\nMsgBox \"Execution Complete;\" &amp; vbCrLf &amp; _\n        Round((Now() - StartTime) * 86400, 0) &amp; \" Second Run Time.\" &amp; vbCrLf &amp; _\n        (LoopRow - 2) &amp; \" Considered\" &amp; vbCrLf &amp; _\n        Printed &amp; \" Statements Printed\"\n\nExit Sub\n\nErrorHandler:\n    Resume Next\nEnd Sub\n\nSub Reactivate_Functions()\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>I just feel that it doesn't need to be nearly this complex, does this seem overly complex for what I'm trying to achieve? I'd rather have something simpler so I can understand what to fix incase the code breaks.</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10230628, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156869033434172/picture?type=large", "display_name": "Henry Cao", "link": "https://stackoverflow.com/users/10230628/henry-cao"}, "edited": false, "score": 0, "creation_date": 1534359134, "post_id": 51863791, "comment_id": 90681593, "body": "After adding that, I am getting the following: &quot;Compile error: Expected: end of statement&quot;"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 39, "user_id": 10230628, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156869033434172/picture?type=large", "display_name": "Henry Cao", "link": "https://stackoverflow.com/users/10230628/henry-cao"}, "edited": false, "score": 0, "creation_date": 1534359326, "post_id": 51863791, "comment_id": 90681690, "body": "If you are referring to the correct book &amp; correct sheet name with this code on 2 separate lines, there is no reason for this not work <b>unless</b> there is more code to your sub that you are not showing"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1534354995, "creation_date": 1534354995, "answer_id": 51863791, "question_id": 51863744, "link": "https://stackoverflow.com/questions/51863744/how-to-copy-and-paste-value-excel-vba/51863791#51863791", "title": "How to copy-and-paste value (Excel VBA)?", "body": "<p>Just paste values using: </p>\n\n<pre><code>Workbooks(\"workbook name 1\").Sheets(\"sheet name 1\").Range(\"A1:M10\").Copy   \nWorkbooks(\"workbook name 2\").Sheets(\"sheet name 2\").Range(\"A1\").PasteSpecial xlPasteValues\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": false, "score": 2, "last_activity_date": 1534355046, "creation_date": 1534355046, "answer_id": 51863805, "question_id": 51863744, "link": "https://stackoverflow.com/questions/51863744/how-to-copy-and-paste-value-excel-vba/51863805#51863805", "title": "How to copy-and-paste value (Excel VBA)?", "body": "<p>Alternatively, you can use:</p>\n\n<pre><code>Workbooks(\"workbook name 1\").Sheets(\"sheet name 1\").Range(\"A1:M10\").Value = _\nWorkbooks(\"workbook name 2\").Sheets(\"sheet name 2\").Range(\"A1:M10\").Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4690719, "user_type": "registered", "profile_image": "https://graph.facebook.com/1065932300100535/picture?type=large", "display_name": "\u062d\u0633\u0627\u0645 \u0647\u062f\u0627\u064a\u0629", "link": "https://stackoverflow.com/users/4690719/%d8%ad%d8%b3%d8%a7%d9%85-%d9%87%d8%af%d8%a7%d9%8a%d8%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1537226217, "creation_date": 1537226217, "answer_id": 52376852, "question_id": 51863744, "link": "https://stackoverflow.com/questions/51863744/how-to-copy-and-paste-value-excel-vba/52376852#52376852", "title": "How to copy-and-paste value (Excel VBA)?", "body": "<p>Paste values only: try this</p>\n\n<pre><code>Sub Paste()\n\n'Declare ranges\n    Dim Source_Rg As Range 'Copy from source range\n    Dim To_Rg As Range     'Past to target range\n\n'Set source and target ranges\n    'Source range\n    Set Source_Rg = Workbooks(\"Source file name.xlsx\") _\n                   .Worksheets(\"Sheet name\").Range(\"A1\")\n\n    'Target range (Active workbook)\n    Set To_Rg = ActiveWorkbook.Worksheets(\"Sheet name\") _\n               .Range(\"A1\")\n\n'Paste values only\n    To_Rg = Source_Rg\n\n    Source_Rg = Nothing\n    To_Rg = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10230628, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156869033434172/picture?type=large", "display_name": "Henry Cao", "link": "https://stackoverflow.com/users/10230628/henry-cao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8862, "favorite_count": 0, "closed_date": 1608059935, "answer_count": 3, "score": 0, "last_activity_date": 1593592602, "creation_date": 1534354799, "last_edit_date": 1593592602, "question_id": 51863744, "link": "https://stackoverflow.com/questions/51863744/how-to-copy-and-paste-value-excel-vba", "closed_reason": "Duplicate", "title": "How to copy-and-paste value (Excel VBA)?", "body": "<p>I am trying to do a simple copy-and-paste value from one Excel file to another using Excel VBA. I have the following code but it seems to copy-and-paste over the format as well. How can I specify it so it does paste value only? Thanks.</p>\n\n<pre><code>Sub PasteValue()\n\nSet x = Workbooks.Open(\"workbook name 1\")\n\nWorkbooks(\"workbook name 1\").Sheets(\"sheet name 1\").Range(\"A1:M10\").Copy Workbooks(\"workbook name 2\").Sheets(\"sheet name 2\").Range(\"A1\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1534354127, "post_id": 51863553, "comment_id": 90679268, "body": "Does it work for sheets named &quot;Sheet1&quot; and &quot;Sheet2&quot;?  Those are the only sheets you have specified to put these headers in.  Do you actually have sheets named &quot;Sheet1&quot; and &quot;Sheet2&quot; in your workbook?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1534354286, "post_id": 51863553, "comment_id": 90679322, "body": "<code>Dim ws as Worksheet</code> and <code>For Each ws in Worksheets</code> (this will do <i>all</i> worksheets). This appears to be, essentially a typo, voting to close as off-topic."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1534354295, "post_id": 51863553, "comment_id": 90679328, "body": "What isn&#39;t working? Does it loop? Are there error messages?"}, {"owner": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "edited": false, "score": 0, "creation_date": 1534354297, "post_id": 51863553, "comment_id": 90679329, "body": "@tigerayater There are actually 16 more worksheets, I just put &quot;Sheet1&quot; and &quot;Sheet2&quot; to save space. The worksheets&#39; actual names are not Sheet1 and Sheet2, but it is just easier to type on here."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1534354384, "post_id": 51863553, "comment_id": 90679362, "body": "well you&#39;re going to have to help us out here.If you put a breakpoint on your loop and step through using F8, what happens?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534354506, "post_id": 51863553, "comment_id": 90679419, "body": "There&#39;s typos in your array.  The code, as you posted here, works fine.  Triple check the worksheet names, and make sure there aren&#39;t any leading or trailing spaces.  Otherwise, we can&#39;t reproduce."}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1534354515, "creation_date": 1534354515, "answer_id": 51863676, "question_id": 51863553, "link": "https://stackoverflow.com/questions/51863553/loop-not-working-excel-vba/51863676#51863676", "title": "Loop not working - Excel VBA", "body": "<p>I suspect something like this is what you're looking for:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim aHeaders As Variant\n\n    aHeaders = Array(\"PRECID\", \"PACCT\", \"PEXCH\", \"PFC\", \"PSUBTY\", \"PSTRIK\", \"PCTYM\", \"PSBCUS\", \"PBS\", \"PQTY\", \"PPRTCP\")\n\n    For Each ws In ActiveWorkbook.Sheets\n        Select Case ws.Name\n            'any worksheet names listed here won't have their headers updated\n            Case \"NoUpdate\", \"Leave Alone\"\n                'Do nothing\n\n            'Update headers for all other sheets\n            Case Else\n                ws.Range(\"A1\").Resize(, UBound(aHeaders) - LBound(aHeaders) + 1).Value = aHeaders\n        End Select\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 51863676, "answer_count": 1, "score": -2, "last_activity_date": 1534404707, "creation_date": 1534353991, "last_edit_date": 1534404707, "question_id": 51863553, "link": "https://stackoverflow.com/questions/51863553/loop-not-working-excel-vba", "title": "Loop not working - Excel VBA", "body": "<p>For some reason this Array isnt working! What could be wrong? Basically it is supposed to loop through every worksheet and give the same header to each worksheet.    </p>\n\n<pre><code>WorksheetNames = Array(\"Sheet1\", \"Sheet2\")\nFor Each ws In WorksheetNames\n    With Worksheets(ws)\n        .Range(\"F1\").FormulaR1C1 = \"PSTRIK\"\n        .Range(\"A1\").FormulaR1C1 = \"PRECID\"\n        .Range(\"C1\").FormulaR1C1 = \"PEXCH\"\n        .Range(\"J1\").FormulaR1C1 = \"PQTY\"\n        .Range(\"G1\").FormulaR1C1 = \"PCTYM\"\n        .Range(\"D1\").FormulaR1C1 = \"PFC\"\n        .Range(\"B1\").FormulaR1C1 = \"PACCT\"\n        .Range(\"K1\").FormulaR1C1 = \"PPRTCP\"\n        .Range(\"E1\").FormulaR1C1 = \"PSUBTY\"\n        .Range(\"H1\").FormulaR1C1 = \"PSBCUS\"\n        .Range(\"I1\").FormulaR1C1 = \"PBS\"\n    End With\nNext ws\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 10197397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rJQobPK1FNs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rjUN7cwMgBpP6DaD1uybFF8UzIdw/mo/photo.jpg?sz=128", "display_name": "senthil sg", "link": "https://stackoverflow.com/users/10197397/senthil-sg"}, "edited": false, "score": 0, "creation_date": 1534354561, "post_id": 51863529, "comment_id": 90679447, "body": "Just a beginner in scripting. Added my script in the question (now)."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534355267, "post_id": 51863529, "comment_id": 90679762, "body": "how many rows and columns? Just an estimate or max is fine"}, {"owner": {"reputation": 1, "user_id": 10197397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rJQobPK1FNs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rjUN7cwMgBpP6DaD1uybFF8UzIdw/mo/photo.jpg?sz=128", "display_name": "senthil sg", "link": "https://stackoverflow.com/users/10197397/senthil-sg"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534355348, "post_id": 51863529, "comment_id": 90679793, "body": "both the number of rows and columns are dynamic. or can consider number of rows as 1000, but column is dynamic."}], "answers": [{"tags": [], "owner": {"reputation": 703, "user_id": 5142585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWQdR.jpg?s=128&g=1", "display_name": "Pm Duda", "link": "https://stackoverflow.com/users/5142585/pm-duda"}, "is_accepted": false, "score": 0, "last_activity_date": 1534357072, "last_edit_date": 1534357072, "creation_date": 1534355334, "answer_id": 51863870, "question_id": 51863529, "link": "https://stackoverflow.com/questions/51863529/need-vba-macro-to-delete-cells-except-first-and-last-row-in-each-column/51863870#51863870", "title": "need vba macro to delete cells except first and last row in each column", "body": "<p>You can use <a href=\"https://msdn.microsoft.com/de-de/vba/excel-vba/articles/range-delete-method-excel\" rel=\"nofollow noreferrer\">Range.Delete Method (Excel)</a></p>\n\n<pre><code>range(ID.Offset(0, 0), ID.Offset(0, b)).Delete Shift:=xlToLeft \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10197397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rJQobPK1FNs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rjUN7cwMgBpP6DaD1uybFF8UzIdw/mo/photo.jpg?sz=128", "display_name": "senthil sg", "link": "https://stackoverflow.com/users/10197397/senthil-sg"}, "edited": false, "score": 0, "creation_date": 1534358753, "post_id": 51863937, "comment_id": 90681442, "body": "This really worked,thanks for your support. And what if, if I want to run this code only after column H, i.e. delete first and last row after column H leaving column A to G untouched. Can you advice for the same."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 1, "user_id": 10197397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rJQobPK1FNs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rjUN7cwMgBpP6DaD1uybFF8UzIdw/mo/photo.jpg?sz=128", "display_name": "senthil sg", "link": "https://stackoverflow.com/users/10197397/senthil-sg"}, "edited": false, "score": 0, "creation_date": 1534360081, "post_id": 51863937, "comment_id": 90682037, "body": "@senthilsg No problem. For that, change &quot;B&quot; to &quot;H&quot; and also change (row, 3) to (row, 9) on the next line"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": false, "score": 0, "last_activity_date": 1534356113, "last_edit_date": 1534356113, "creation_date": 1534355595, "answer_id": 51863937, "question_id": 51863529, "link": "https://stackoverflow.com/questions/51863529/need-vba-macro-to-delete-cells-except-first-and-last-row-in-each-column/51863937#51863937", "title": "need vba macro to delete cells except first and last row in each column", "body": "<p>This is a little different approach but should help.</p>\n\n<p>Also, it is generally not best to declare variables in a loop as you do with b &amp; k just fyi</p>\n\n<pre><code>Sub test()\n\n    Dim sh As Worksheet\n    Dim row As Integer\n    Dim lastCol As Integer\n\n    Set sh = ThisWorkbook.Sheets(\"Sheet1\")\n\n    For row = 2 To sh.Cells(Sheets(1).Rows.Count, \"A\").End(xlUp).row\n\n        lastCol = sh.Cells(row, Columns.Count).End(xlToLeft).Column\n\n        sh.Range(\"B\" &amp; row).Value = sh.Cells(row, lastCol).Value\n        sh.Range(sh.Cells(row, 3), sh.Cells(row, lastCol)).ClearContents\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Best of luck</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1534356282, "creation_date": 1534356282, "answer_id": 51864090, "question_id": 51863529, "link": "https://stackoverflow.com/questions/51863529/need-vba-macro-to-delete-cells-except-first-and-last-row-in-each-column/51864090#51864090", "title": "need vba macro to delete cells except first and last row in each column", "body": "<p>I'd go as follows:</p>\n\n<pre><code>Sub test()\n    Dim cell As Range\n\n    With ThisWorkbook.Sheets(\"Sheet1\") ' reference relevant sheet\n        For Each cell In .Range(\"A2\", .Cells(.Rows.Count, \"A\").End(xlUp)) ' loop through referenced sheet column A cells from row 2 down to last not empty one\n            With .Range(cell, .Cells(cell.Row, .Columns.Count).End(xlToLeft)) ' reference referenced sheet range spanning from current cell to last not empty one in the same row\n                If .Count &gt; 2 Then ' if referenced range has more then 2 cells\n                    cell.Offset(, 1).Value = .Cells(1, .Count).Value ' store last cell value next to the current one\n                    .Offset(, 2).Resize(, .Columns.Count - 1).ClearContents 'clear all cells right of current one\n                End If\n            End With\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10197397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rJQobPK1FNs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rjUN7cwMgBpP6DaD1uybFF8UzIdw/mo/photo.jpg?sz=128", "display_name": "senthil sg", "link": "https://stackoverflow.com/users/10197397/senthil-sg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1049, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1534357072, "creation_date": 1534353898, "last_edit_date": 1534354607, "question_id": 51863529, "link": "https://stackoverflow.com/questions/51863529/need-vba-macro-to-delete-cells-except-first-and-last-row-in-each-column", "title": "need vba macro to delete cells except first and last row in each column", "body": "<p>I have a excel which has multiple rows and columns and range of column values differ for each row.</p>\n\n<p>Need a macro which will delete all cells in a row except first and last in each row and paste the last value next to first value.</p>\n\n<p><strong>Tried the below script:</strong></p>\n\n<pre><code>Sub test()\nDim sh As Worksheet\nDim IDS As range\nDim ID As range\n\nSet sh = ThisWorkbook.Sheets(\"Sheet1\")\n\n    Set IDS = ActiveSheet.range(\"A2\", range(\"A1\").End(xlDown))\n\n    For Each ID In IDS\n\n        Dim b As Integer\n        Dim k As Integer\n\n        k = sh.range(\"ID\", sh.range(\"ID\").End(xlToRight)).Columns.Count\n        b = k - 1\n\n        range(ID.Offset(0, 0), ID.Offset(0, \"b\")).Select\n        Selection.ClearContents\n\n    Next ID\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10230035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef5e90ba77b07e6560a8d8bf9a1ad9c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris R", "link": "https://stackoverflow.com/users/10230035/chris-r"}, "edited": false, "score": 0, "creation_date": 1534354969, "post_id": 51863564, "comment_id": 90679618, "body": "Thank you for the quick response. I do not think the above code is in VBA. I can follow some of the logic but I don&#39;t think it will work with VBA Class structure."}], "tags": [], "owner": {"reputation": 703, "user_id": 5142585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWQdR.jpg?s=128&g=1", "display_name": "Pm Duda", "link": "https://stackoverflow.com/users/5142585/pm-duda"}, "is_accepted": false, "score": 1, "last_activity_date": 1534354047, "creation_date": 1534354047, "answer_id": 51863564, "question_id": 51863333, "link": "https://stackoverflow.com/questions/51863333/excel-vba-count-non-business-days-weekend-days/51863564#51863564", "title": "Excel VBA count non business days/weekend days", "body": "<p>Solution found here: <a href=\"https://www.experts-exchange.com/questions/23461938/VB-net-Add-Days-to-a-Date.html\" rel=\"nofollow noreferrer\">https://www.experts-exchange.com/questions/23461938/VB-net-Add-Days-to-a-Date.html</a></p>\n\n<pre><code>Public Function AddNBusinessDays(ByVal startDate As DateTime, ByVal numDays As Integer) As DateTime\n\n    If numDays = 0 Then Return New DateTime(startDate.Ticks)\n\n    If numDays &lt; 0 Then Throw New ArgumentException()\n\n    Dim i As Integer\n    Dim totalDays As Integer\n    Dim businessDays As Integer\n\n    totalDays = 0\n    businessDays = 0\n\n    Dim currDate As DateTime\n    While businessDays &lt; numDays\n        totalDays += 1\n\n        currDate = startDate.AddDays(totalDays)\n\n        If Not (currDate.DayOfWeek = DayOfWeek.Saturday Or currDate.DayOfWeek = DayOfWeek.Sunday) Then\n            businessDays += 1\n        End If\n\n    End While\n\n    Return currDate\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10230035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef5e90ba77b07e6560a8d8bf9a1ad9c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris R", "link": "https://stackoverflow.com/users/10230035/chris-r"}, "edited": false, "score": 0, "creation_date": 1534356066, "post_id": 51863815, "comment_id": 90680190, "body": "Thank you for the quick response. This code is exactly what I was trying to do and was just on the struggle buss with it lol. Thank you for all the in-code comments and keeping to the style of code in the question."}, {"owner": {"reputation": 116, "user_id": 10139201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YBlOS.jpg?s=128&g=1", "display_name": "ComradeMicha", "link": "https://stackoverflow.com/users/10139201/comrademicha"}, "reply_to_user": {"reputation": 3, "user_id": 10230035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef5e90ba77b07e6560a8d8bf9a1ad9c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris R", "link": "https://stackoverflow.com/users/10230035/chris-r"}, "edited": false, "score": 0, "creation_date": 1534358236, "post_id": 51863815, "comment_id": 90681161, "body": "Pleasure. Just note that this code is rather inefficient, it&#39;s just relatively easy to follow. In theory you can ignore all weeks except for the first and the last one when looping through this, so if the user was entering 10 billion days, it would run ridiculously long for no good reason. But as you said your limit is 14, it doesn&#39;t matter."}], "tags": [], "owner": {"reputation": 116, "user_id": 10139201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YBlOS.jpg?s=128&g=1", "display_name": "ComradeMicha", "link": "https://stackoverflow.com/users/10139201/comrademicha"}, "is_accepted": true, "score": 0, "last_activity_date": 1534355110, "creation_date": 1534355110, "answer_id": 51863815, "question_id": 51863333, "link": "https://stackoverflow.com/questions/51863333/excel-vba-count-non-business-days-weekend-days/51863815#51863815", "title": "Excel VBA count non business days/weekend days", "body": "<p>The most intuitive way to do this (in my opinion) is to simply count the days forward one by one until you added as many work days as requested by the user. The 14 days limit is not necessary anyways, as it is a loop that works with any integer up to billions of days...</p>\n\n<pre><code>Sub adddays()\n\nDim iNumDays As Integer\nDim iWeekDay As Integer\nDim dDate As Date\n\n'prompt to enter number of days to look out for shortage, new addition to the code added to expand usability\niNumDays = Application.InputBox(prompt:=\"Enter number of business days to look out for\")\n\ndDate = Date                            ' initialize dDate with today's date before entering the counting loop\n\nWhile iNumDays &gt; 0                      ' as long as the there are still workdays left to add, repeat this\n    dDate = dDate + 1                   ' move calendar forward by one day\n    iWeekDay = Weekday(dDate, vbMonday) ' check what weekday we arrived at\n    If iWeekDay &lt; 6 Then                ' if we're looking at a working day, we successfully added one of the desired weekdays to be added\n        iNumDays = iNumDays - 1\n    End If\nWend\n\nMsgBox (\"Target date is: \" &amp; Str(dDate)) 'check results of the calculation or replace with whatever other logic you want here\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10230035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef5e90ba77b07e6560a8d8bf9a1ad9c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris R", "link": "https://stackoverflow.com/users/10230035/chris-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 51863815, "answer_count": 2, "score": 0, "last_activity_date": 1594151354, "creation_date": 1534353114, "last_edit_date": 1594151354, "question_id": 51863333, "link": "https://stackoverflow.com/questions/51863333/excel-vba-count-non-business-days-weekend-days", "title": "Excel VBA count non business days/weekend days", "body": "<p>**Hello all,\nI have a question that is \u00bd about the code and \u00bd about the logic behind the code.</p>\n\n<p>Background:</p>\n\n<p>This is a vary small part of one Sub in a large workbook collection. The goal of this bit of code is to accept a user input for the number of business days they want to look out for a date range. Determine if the dates between contain weekend days, if so, add 2 to the range. The input is data type Integer. The number is added to the current date to get the last date in the range and assigned to dDate for use in this and other Sub\u2019s.</p>\n\n<p>What the code should do:</p>\n\n<p>The most a user can request to look out for is 14 (don\u2019t need error handling for more then 14). The request can be made any day of the week including weekends. If a request is made on Wednesday to look out 3 business days, the program should add 2 to show Thursday, Friday, Saturday, Sunday, and Monday. If the request is made on a Saturday to show 2 business days the program should add 1 to show Sunday, Monday, and Tuesday. If the number requested has 2 weekends between the range (8-14) then add 4.</p>\n\n<p>So in short, for every weekend day in the date range, add one day to the user input number.</p>\n\n<p>Please explain any responses with in code comments for all VBA skill levels.\nBoth Code and logic help is welcome.\n**</p>\n\n<pre><code>'prompt to enter number of days to look out for shortage, new addition to the code added to expand usability\niNumDays = Application.InputBox(prompt:=\"Enter number of business days to look out for\")\n\niweekday = Weekday(Date, vbMonday) 'get todays weekday number 1-7 with Monday being 1, Sunday being 7\n\n'if today is Thursday or Friday the next 2 business days fall on the weekend, if so then we need to look out 2 days more\nIf iweekday &gt; 3 Then 'iweekday is integer of todays weekday number, if its past Wednesday then enter If\n\n    iNumDays = iNumDays + 2 'add 2 to user input\nEnd If\n\ndDate = Date + iNumDays    'add user day to look out input to todays date to get last date in desired date range             'get the column header for the date we are looking out to\n</code></pre>\n"}, {"tags": ["javascript", "html", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534437810, "post_id": 51863238, "comment_id": 90715117, "body": "Thanks for the suggestion QHarr. Unfortunately it didn&#39;t work. I&#39;ve added the code as tested above. The system is on a private network so access isn&#39;t possible."}, {"owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534439131, "post_id": 51863238, "comment_id": 90715809, "body": "No error message but ele = Nothing, so presumably just nothing found?"}, {"owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534440173, "post_id": 51863238, "comment_id": 90716310, "body": "Ah, well spotted. Run-time error &#39;91&#39;: Object variable or With block variable not set. Don&#39;t know if it helps but there&#39;s another dropdown on the page with frow=&quot;Y&quot; in all the items."}, {"owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534453674, "post_id": 51863238, "comment_id": 90722201, "body": "It&#39;s in a form. I realised I&#39;d declared element as IHTMLElement instead of object. I&#39;ve used your code exactly and now I get error 424 Object required at the next line: element.Item(1).Selected = True"}, {"owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534501233, "post_id": 51863238, "comment_id": 90737236, "body": "Thanks. That seems to get the NodeList ok but everything I try to get to the element I want causes an unhandled error.For Each ele In elements  If ele.Value = &quot;F&quot; Then ele.Selected = True Next ele (where ele is IHTMLElement. There should only be one in the list so could it be selected directly?"}, {"owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534502514, "post_id": 51863238, "comment_id": 90737880, "body": "I get error 438 Object doesn&#39;t support this property or method. I tried it with fkey=F and got the same result."}, {"owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534502993, "post_id": 51863238, "comment_id": 90738145, "body": "when I run it to Set elements = ie.document.getElementsByTagName(&quot;form&quot;)(0).querySelector(&quot;d&zwnj;&#8203;iv[fkey=F]&quot;), hoverover on elements shows elements = &quot;[object HTMLDivElement]&quot;. Which looks promising."}, {"owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534503277, "post_id": 51863238, "comment_id": 90738311, "body": "Phew - that did it! Thanks so much."}, {"owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1534511120, "post_id": 51863238, "comment_id": 90742778, "body": "That&#39;s fine, I was wondering how to credit you with the solution on here."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534511183, "post_id": 51863238, "comment_id": 90742811, "body": "Glad we got there. I don&#39;t like unsolved cases!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "edited": false, "score": 0, "creation_date": 1534511308, "post_id": 51894055, "comment_id": 90742898, "body": "Thanks again QHarr. Couldn&#39;t have got there on my own."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "edited": false, "score": 0, "creation_date": 1534511351, "post_id": 51894055, "comment_id": 90742925, "body": "You will next time! CSS selectors are really cool btw. <a href=\"https://www.w3schools.com/cssref/css_selectors.asp\" rel=\"nofollow noreferrer\">w3schools.com/cssref/css_selectors.asp</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1534504040, "creation_date": 1534504040, "answer_id": 51894055, "question_id": 51863238, "link": "https://stackoverflow.com/questions/51863238/excel-vba-to-select-item-from-dropdown-on-webpage/51894055#51894055", "title": "Excel vba to select item from dropdown on webpage", "body": "<p>After much debugging the solution was as follows:</p>\n\n<pre><code>ie.document.getElementsByTagName(\"form\")(0).querySelector(\"div[fkey=F]\").Click \n</code></pre>\n\n<p>A form needed to be navigated and then a CSS selector combination of <code>div[fkey=F]</code> to target the element in question.</p>\n\n<p>The selector combination looks for a <code>div</code> element with attribute <code>fkey</code> whose value is <code>F</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 10230423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o97ficW2vO8/AAAAAAAAAAI/AAAAAAAAADk/OpQ5rRrG7CU/photo.jpg?sz=128", "display_name": "Ged Warren", "link": "https://stackoverflow.com/users/10230423/ged-warren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 1, "accepted_answer_id": 51894055, "answer_count": 1, "score": 0, "last_activity_date": 1534573462, "creation_date": 1534352653, "last_edit_date": 1534573462, "question_id": 51863238, "link": "https://stackoverflow.com/questions/51863238/excel-vba-to-select-item-from-dropdown-on-webpage", "title": "Excel vba to select item from dropdown on webpage", "body": "<p>I'm having trouble getting the syntax right to select an item from a dropdown on a webpage. It's to select gender. I think it's something to do with it using javascript. When I do Inspect element on the dropdown I get the following:</p>\n\n<pre><code>&lt;table width=\"100%\" style=\"z-index: auto;\" cellspacing=\"0\" cellpadding=\"0\" oldz=\"auto\"&gt;&lt;tbody style=\"z-index: auto;\" oldz=\"auto\"&gt;\n&lt;tr style=\"z-index: auto;\" oldz=\"auto\"&gt;\n&lt;td style=\"width: 100%; z-index: auto;\" oldz=\"auto\"&gt;\n&lt;div class=\"FBox\" style=\"width: auto; position: relative; z-index: auto;\" oldz=\"auto\" outerdiv=\"Y\"&gt;&lt;input name=\"VX_Gender\" id=\"VX_Gender\" type=\"hidden\" value=\"M\"&gt;\n&lt;div class=\"EditDiv EditDropDown\" id=\"VX_Gender_ext\" role=\"textbox\" contenteditable=\"true\" spellcheck=\"false\" ondrop=\"return false\" origval=\"Male\" hig=\"1\" max=\"-1\" strictselection=\"Y\" focstyle=\"EditDropDownFoc\" isfilter=\"Y\" filterbox=\"Y\" val2=\"Male\" LastTouchType=\"Y\"&gt;Male&lt;/div&gt;\n&lt;script&gt;initDiv('VX_Gender');&lt;/script&gt;\n&lt;/div&gt;\n&lt;/td&gt;\n&lt;td style=\"white-space: nowrap;\"&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>When I do the same on a dropdown item I get:</p>\n\n<pre><code>&lt;table width=\"100%\" style=\"z-index: auto;\" cellspacing=\"0\" cellpadding=\"0\" oldz=\"auto\"&gt;\n&lt;div class=\"filtermenu\" style=\"left: 271.76px; top: 252.5px; width: 122px; height: auto; margin-top: 0px; display: none; z-index: 1698; -ms-overflow-y: auto; max-height: 67px;\" onclick=\"return filterPopupClick( event );\" hovermenu=\"Y\" shrink=\"Y\" unselectable=\"on\" lastfilter=\"Male\"&gt;\n&lt;div class=\"bcrow rsel\" onmouseover=\"return fRowHov(this);\" value=\"F\" origva=\"Female\" hc=\"#FFFFFF\" fkey=\"F\" frow=\"Y\" fIdx=\"2\"&gt;\nFe\n&lt;span class=\"fsr\"&gt;male&lt;/span&gt;\n&lt;/div&gt;\n\n&lt;div class=\"bcrow\" onmouseover=\"return fRowHov(this);\" value=\"I\" origva=\"Indeterminate\" hc=\"#FFFFFF\" fkey=\"I\" frow=\"Y\" fIdx=\"-1\"&gt;Indeterminate&lt;/div&gt;\n\n&lt;div class=\"bcrow\" onmouseover=\"return fRowHov(this);\" value=\"M\" origva=\"Male\" hc=\"#FFFFFF\" fkey=\"M\" frow=\"Y\" fIdx=\"0\"&gt;&lt;span class=\"fsr\"&gt;Male&lt;/span&gt;&lt;/div&gt;\n\n&lt;div class=\"bcrow\" onmouseover=\"return fRowHov(this);\" value=\"U\" origva=\"Unborn\" hc=\"#FFFFFF\" fkey=\"U\" frow=\"Y\" fIdx=\"-1\"&gt;Unborn&lt;/div&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>I've tried various formats in my code but none seem to work. Any help would be much appreciated.</p>\n\n<pre><code>Sub gender()\n\nDim URL, PER_ID As String\nDim objShell, ie  As Object\nDim ele As IHTMLElement\n\n'Determine if a specific instance of IE is already open.\nSet objShell = CreateObject(\"Shell.Application\")\nIE_count = objShell.Windows.Count\nFor x = 0 To (IE_count - 1)\n    On Error Resume Next    'Sometimes more web pages are counted than are open\n    URL = objShell.Windows(x).document.Location\n\n    If URL = \"https://protocolshef.syhapp.com:51020/web/faorc.htm\" Then   'Identify the existing web page\n        Set ie = objShell.Windows(x)\n        Exit For\n    Else\n    End If\nNext\n\nFor Each ele In ie.document.getElementsByTagName(\"div\")\n    If ele.ID = \"VX_Gender_ext\" Then\n        ele.innerText = \"Female\"\n        ele.Val2 = \"Female\"\n        Call ie.document.parentWindow.execScript(\"initDiv('VX_Gender');\", \"JavaScript\")\n    End If\nNext\n\nFor Each ele In ie.document.getElementsByName(\"VX_Gender\")\n    ele.Value = \"F\"\n    ele.origval = \"F\"\nNext\n\nFor Each ele In ie.document.getElementsByTagName(\"div\")\n    If ele.ID = \"VX_Gender_ext\" Then\n        ele.innerText = \"Female\"\n        ele.Val2 = \"Female\"\n        Call ie.document.parentWindow.execScript(\"initDiv('VX_Gender');\", \"JavaScript\")\n    End If\nNext\n\nFor Each ele In ie.document.getElementsByName(\"VX_Gender\")\n    ele.Type = \"text\"\n    ele.Value = \"F\"\n    ele.origval = \"F\"\nNext  \n\nEnd Sub\n</code></pre>\n\n<p>Code testing QHarr's suggestion, which unfortunately didn't work.</p>\n\n<pre><code>Sub gender()\n\nDim URL, PER_ID As String\nDim objShell, ie  As Object\nDim x, IE_count As Long\nDim ele As IHTMLElement\n\n'Determine if a specific instance of IE is already open.\nSet objShell = CreateObject(\"Shell.Application\")\nIE_count = objShell.Windows.Count\nFor x = 0 To (IE_count - 1)\n    On Error Resume Next    'Sometimes more web pages are counted than are open\n    URL = objShell.Windows(x).document.Location\n\n    If URL = \"https://protocolshef.syhapp.com:51020/web/faorc.htm\" Then   'Identify the existing web page\n        Set ie = objShell.Windows(x)\n        Exit For\n    Else\n    End If\nNext\n\nSet ele = ie.document.querySelectorAll(\"div[frow=Y]\")\nele.Item(1).Selected = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10141011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55381e4ef71b066fb84e1a4aa153f4af?s=128&d=identicon&r=PG&f=1", "display_name": "Nav kaur", "link": "https://stackoverflow.com/users/10141011/nav-kaur"}, "edited": false, "score": 0, "creation_date": 1534353158, "post_id": 51863279, "comment_id": 90678836, "body": "Hi Tim, Is there a way to specify it to copy only few columns, instead of entire row. Say from A:D"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1534354438, "last_edit_date": 1534354438, "creation_date": 1534352841, "answer_id": 51863279, "question_id": 51863219, "link": "https://stackoverflow.com/questions/51863219/copying-values-only-from-one-sheet-to-another/51863279#51863279", "title": "Copying values only from one sheet to another -", "body": "<p>You can assign values directly without using <code>Copy</code>:</p>\n\n<pre><code>Sub CopyTrue()\nDim c As Range\nDim j As Integer\nDim Source As Worksheet\nDim Target As Worksheet\n\n' Change worksheet designations as needed\nSet Source = ActiveWorkbook.Worksheets(\"Hidden Cable Setup\")\nSet Target = ActiveWorkbook.Worksheets(\"Main\")\n\nj = 2     ' Start copying to row 1 in target sheet\nFor Each c In Source.Range(\"O1:O20000\").Cells\n    If c.Value = \"True\" Then\n       Target.Rows(j).Value = c.EntireRow.Value\n       'or just selected columns:\n       Target.Cells(j, 1).Resize(1, 4).Value = _\n             c.EntireRow.Cells(1).Resize(1, 4).Value\n       j = j + 1\n    End If\nNext c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10141011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55381e4ef71b066fb84e1a4aa153f4af?s=128&d=identicon&r=PG&f=1", "display_name": "Nav kaur", "link": "https://stackoverflow.com/users/10141011/nav-kaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 51863279, "answer_count": 1, "score": 0, "last_activity_date": 1534404766, "creation_date": 1534352573, "last_edit_date": 1534404766, "question_id": 51863219, "link": "https://stackoverflow.com/questions/51863219/copying-values-only-from-one-sheet-to-another", "title": "Copying values only from one sheet to another -", "body": "<p>I was trying to copy from one sheet to another based on criteria. Now I have the code but it does not copy the values. Source sheet only contain formulas and I was trying to copy the values with or wihout formatting.</p>\n\n<p>My Code is:</p>\n\n<pre><code>Sub CopyTrue()\nDim c As Range\nDim j As Integer\nDim Source As Worksheet\nDim Target As Worksheet\n\n' Change worksheet designations as needed\nSet Source = ActiveWorkbook.Worksheets(\"Hidden Cable Setup\")\nSet Target = ActiveWorkbook.Worksheets(\"Main\")\n\nj = 2     ' Start copying to row 1 in target sheet\nFor Each c In Source.Range(\"O1:O20000\")   ' Do 1000 rows\n    If c = \"True\" Then\n       Source.Rows(c.Row).Copy Target.Rows(j)\n       j = j + 1\n    End If\nNext c\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1534351108, "post_id": 51862831, "comment_id": 90677917, "body": "What exactly is your problem? What have you tried which has not worked?"}, {"owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1534351144, "post_id": 51862831, "comment_id": 90677932, "body": "Edited the above, I want to access the dictionary while it&#39;s sitting in the array. Syntax wise, I cannot figure how to access the dictionary while its sitting in the array. This is what I need help with."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1534351214, "post_id": 51862831, "comment_id": 90677958, "body": "See tigeravatar&#39;s answer!"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534351428, "post_id": 51862831, "comment_id": 90678060, "body": "@Joseph <i>(et al)</i> - Here is an excellent reference: <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\"><b>Excel VBA Dictionary \u2013 A Complete Guide</b></a>.  ...and while you&#39;re bookmarking that link, bookmark this one too (from the same site): <a href=\"https://excelmacromastery.com/excel-vba-collections/\" rel=\"nofollow noreferrer\"><b>The Ultimate Guide To Collections in Excel VBA</b></a>.  (I generally avoid coding sites whose main purpose is to sell books, but this one&#39;s the exception since the site content is very thorough and well organized with examples of all the usual tasks involving VBA collections and/or dictionaries.)"}, {"owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534351635, "post_id": 51862831, "comment_id": 90678173, "body": "@ashleedawg love that first link, it&#39;s what turned me on to dictionaries. I don&#39;t believe that stipulates behaviors with arrays, but great ref for sure."}], "answers": [{"comments": [{"owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "edited": false, "score": 0, "creation_date": 1534351219, "post_id": 51862858, "comment_id": 90677959, "body": "Perfect. I googled and searched stack, couldn&#39;t find this exact answer. Much appreciated."}, {"owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "edited": false, "score": 0, "creation_date": 1534351448, "post_id": 51862858, "comment_id": 90678075, "body": "Can you clarify the benefit of using <code>CreateObject(&quot;Scripting.Dictionary&quot;)</code> as opposed to the way I declared and set the object, as my syntax works without using it"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "edited": false, "score": 1, "creation_date": 1534352445, "post_id": 51862858, "comment_id": 90678520, "body": "@JosephErickson It all depends on the machine you\u2019re using. For portability, we use late binding like above because some machines don\u2019t have the same \u201cReferences\u201d picked. Both ways work, but using early binding like you did in your question means you need to have checked the proper reference first"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "edited": false, "score": 0, "creation_date": 1534352822, "post_id": 51862858, "comment_id": 90678687, "body": "@JosephErickson Marcucciboy2 is correct, it&#39;s just a difference of early binding vs late binding.  I personally prefer late binding because it has a higher compatibility with different kinds of systems and version of MS Office. See here for a brief description of the differences: <a href=\"https://excelmacromastery.com/vba-dictionary/#Early_versus_Late_Binding\" rel=\"nofollow noreferrer\">excelmacromastery.com/vba-dictionary/#Early_versus_Late_Bind&zwnj;&#8203;ing</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 2, "creation_date": 1534353019, "post_id": 51862858, "comment_id": 90678768, "body": "@Marcucciboy2 except it&#39;s not &quot;the machine&quot; that has references picked, but the project. Project references are always saved along with the VBA project (in the <code>VBProject.References</code> collection, if you&#39;ve toyed with the VBIDE API a bit). Late-binding the scripting runtime is always completely useless, because 1) it&#39;s the exact same version on every single Windows box since 1998 or so (and won&#39;t be updated anytime soon), and 2) late-bound or not, it will blow up all the same if ever executed on a machine that doesn&#39;t have the library (e.g. MacOS)."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 5, "last_activity_date": 1534351132, "creation_date": 1534351132, "answer_id": 51862858, "question_id": 51862831, "link": "https://stackoverflow.com/questions/51862831/accessing-dictionary-within-array-vba/51862858#51862858", "title": "Accessing dictionary within array VBA", "body": "<p>This should work for you:</p>\n\n<pre><code>Function dictTest() As Object\n    Dim m_info As Object\n    Set m_info = CreateObject(\"Scripting.Dictionary\")\n    m_info.Add \"first\", \"watermelon\"\n    Set dictTest = m_info\nEnd Function\n\nSub checker()\n    Dim x(1 To 1) As Object\n    Set x(1) = dictTest\n    MsgBox x(1)(\"first\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 1, "accepted_answer_id": 51862858, "answer_count": 1, "score": 2, "last_activity_date": 1534351132, "creation_date": 1534351022, "last_edit_date": 1534351109, "question_id": 51862831, "link": "https://stackoverflow.com/questions/51862831/accessing-dictionary-within-array-vba", "title": "Accessing dictionary within array VBA", "body": "<p>I want to access the dictionary value \"Watermelon\" by using the key \"first\", while the dictionary is sitting within the array. I believe this is the correct method for inserting a dictionary into an array. I've tried every combination I can think of for syntax, and can't find the answer anywhere for how to access the dictionary while it's sitting in the array.</p>\n\n<pre><code>Function dictTest() As Object\n    Dim m_info As Dictionary\n    Set m_info = New Dictionary\n    m_info.Add \"first\", \"watermelon\"\n    Set dictTest = m_info\nEnd Function\n\nSub checker()\n    Dim x(1 to 1) As Object\n    Set x(1) = dictTest\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534349546, "post_id": 51862364, "comment_id": 90677129, "body": "Take a look at the <code>isNumeric()</code> function <a href=\"https://www.techonthenet.com/excel/formulas/isnumeric.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/isnumeric.php</a>"}, {"owner": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534349847, "post_id": 51862364, "comment_id": 90677269, "body": "I&#39;ve tried making an IF loop that includes IsNumeric and have gotten nowhere, hence the call for help. Could you outline how to include it in my current code?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534349917, "post_id": 51862364, "comment_id": 90677313, "body": "It\u2019s probably not necessary given the details you provided, but if you also wanted to be sure that there is text in either cell, you can use the <code>Len()</code> function <a href=\"https://www.techonthenet.com/excel/formulas/len.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/len.php</a>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534349979, "post_id": 51862364, "comment_id": 90677347, "body": "Yeah, you would say <code>If Not isNumeric(Selection.Value) Then With...</code>"}, {"owner": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534350116, "post_id": 51862364, "comment_id": 90677410, "body": "It still seems to be aligning numbers to the left unfortunately, but thanks for the help"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534351085, "post_id": 51862364, "comment_id": 90677905, "body": "is the second line of code supposed to be a comment?"}, {"owner": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 0, "creation_date": 1534352266, "post_id": 51862364, "comment_id": 90678441, "body": "yes sorry, missed that"}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1534355022, "post_id": 51862364, "comment_id": 90679642, "body": "@Thomas_3454262534332, If you&#39;re having issues with selecting ranges, I&#39;d suggest that you either place a watch on it (actually the address property), or print it to the Immediate window using <code>Debug.Print Selection.Columns(1).Address</code>.  That way you can step through the code and fiddle with the range; get it right before you make any changes."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 0, "creation_date": 1534349959, "post_id": 51862490, "comment_id": 90677336, "body": "Thanks for the speedy reply, however Ideally I would like everything (formulas included) to align centrally and only text in the first column to align left"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 0, "creation_date": 1534350150, "post_id": 51862490, "comment_id": 90677427, "body": "Well you can incorporate formulae into this (edited above). The code for other columns remains as is. If you&#39;ve already centred everything you don&#39;t need the two xlcenter lines in this code."}, {"owner": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 0, "creation_date": 1534350464, "post_id": 51862490, "comment_id": 90677592, "body": "It&#39;s giving me the error: &quot;No cells were found&quot;, any ideas?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 0, "creation_date": 1534350605, "post_id": 51862490, "comment_id": 90677674, "body": "OK so we need to &quot;ignore&quot; the error if no cells are found in any of those categories - see the first line I have added."}, {"owner": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 0, "creation_date": 1534351987, "post_id": 51862490, "comment_id": 90678316, "body": "Actually just noticed something strange, if I only select 1 row, then it aligns all cells that contain text in the row to the left (not just the first column) and does the same to the row beneath (i.e. a row i didn&#39;t even select). Sorry to have to bother you again but have you encountered this before? (Also how do I make it so that once the macro has run, I&#39;m returned to my original highlighted section - i.e. if I select a range and run the macro, ideally that range would still be selected when its done)?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 0, "creation_date": 1534352732, "post_id": 51862490, "comment_id": 90678644, "body": "I guess you are not using code as posted but have updated? There is a bug with specialcells if only one cell is selected it considers the whole sheet similar cells."}, {"owner": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 0, "creation_date": 1534353278, "post_id": 51862490, "comment_id": 90678899, "body": "Currently using:      With Selection         .HorizontalAlignment = xlCenter         .VerticalAlignment = xlCenter         .WrapText = False         .Orientation = 0         .AddIndent = False         .IndentLevel = 0         .ShrinkToFit = False         .ReadingOrder = xlContext         .MergeCells = False     End With     Selection.Columns(1).Select     On Error Resume Next     With Selection         .SpecialCells(xlCellTypeConstants, xlTextValues).HorizontalAlignment = xlLeft         .SpecialCells(xlCellTypeFormulas, xlTextValues).HorizontalAlignment = xlLeft"}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "reply_to_user": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 1, "creation_date": 1534354530, "post_id": 51862490, "comment_id": 90679432, "body": "@Thomas_3454262534332,  The first time, you aren&#39;t limiting the changes to the first column.  Also, you only need the to change the <code>HorizontalAlignment</code> property; the rest is just noise.  Read up on <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">how to avoid using select in excel vba</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1534355915, "post_id": 51862490, "comment_id": 90680095, "body": "Can you add that code to your original question? I\u2019ll take a look later but Profex\u2019s point is a good one."}, {"owner": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 0, "creation_date": 1534407666, "post_id": 51862490, "comment_id": 90696600, "body": "Just added it now, sorry. I&#39;m pretty new at VBA so while I am able to roughly follow what you guys are saying, I&#39;m struggling with the execution haha"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1534415980, "post_id": 51862490, "comment_id": 90701499, "body": "Why did you start a new question?"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1534350519, "last_edit_date": 1534350519, "creation_date": 1534349744, "answer_id": 51862490, "question_id": 51862364, "link": "https://stackoverflow.com/questions/51862364/vba-macro-that-works-if-a-cell-contains-text-but-not-if-it-contains-a-number/51862490#51862490", "title": "VBA Macro that works IF a cell contains text but not if it contains a number", "body": "<p>If you mean left align if text or centred if numeric then here is a way which avoids looping through each cell.</p>\n\n<pre><code>Sub x()\nOn Error Resume Next\nWith Columns(1)\n    .SpecialCells(xlCellTypeConstants, xlTextValues).HorizontalAlignment = xlLeft\n    .SpecialCells(xlCellTypeConstants, xlNumbers).HorizontalAlignment = xlCenter\n    .SpecialCells(xlCellTypeFormulas, xlNumbers).HorizontalAlignment = xlCenter\n    .SpecialCells(xlCellTypeFormulas, xlTextValues).HorizontalAlignment = xlLeft\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "edited": false, "score": 0, "creation_date": 1534350190, "post_id": 51862501, "comment_id": 90677444, "body": "Don&#39;t really want to ignore the first column, just want it to align left if it contains text, and align centrally if it contains anything else (even if blank)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1534349782, "creation_date": 1534349782, "answer_id": 51862501, "question_id": 51862364, "link": "https://stackoverflow.com/questions/51862364/vba-macro-that-works-if-a-cell-contains-text-but-not-if-it-contains-a-number/51862501#51862501", "title": "VBA Macro that works IF a cell contains text but not if it contains a number", "body": "<p>If you just want to leave the first column alone you could do something like:</p>\n\n<pre><code>Sub Test_align_left()\n\n    'Test_align_left Macro\n\n    With Selection.offset(0,1).resize(,Selection.columns.count-1)\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlCenter\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10224994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6be623d69de40daa0d6ef81a6dfa17?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas_3454262534332", "link": "https://stackoverflow.com/users/10224994/thomas-3454262534332"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534407546, "creation_date": 1534349302, "last_edit_date": 1534407546, "question_id": 51862364, "link": "https://stackoverflow.com/questions/51862364/vba-macro-that-works-if-a-cell-contains-text-but-not-if-it-contains-a-number", "title": "VBA Macro that works IF a cell contains text but not if it contains a number", "body": "<p>Hi I'm currently using a macro that autoformats tables for me and aligns all cells centrally except for the ones in the first selected column.</p>\n\n<p>I was wondering if there was a way to tweak this so that the 1st selected column is aligned left only if it contains text and not if it contains a number</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub Test_align_left()\n\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlCenter\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\n\nSelection.Columns(1).Select\n\nOn Error Resume Next\n\nWith Selection\n    .SpecialCells(xlCellTypeConstants, xlTextValues).HorizontalAlignment = xlLeft\n    .SpecialCells(xlCellTypeFormulas, xlTextValues).HorizontalAlignment = xlLeft\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance,</p>\n\n<p>Thomas</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 4, "creation_date": 1534349192, "post_id": 51862305, "comment_id": 90676933, "body": "please insert your code into the actual question and remove the link. no one wants to (or probably will) click your link and open your file."}, {"owner": {"reputation": 17, "user_id": 7625254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93229e2f18a0d28744368cb47ac8cc1a?s=128&d=identicon&r=PG&f=1", "display_name": "Akika.YS", "link": "https://stackoverflow.com/users/7625254/akika-ys"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1534350957, "post_id": 51862305, "comment_id": 90677849, "body": "Ok noted. Codes added for search &amp; update btn."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7625254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93229e2f18a0d28744368cb47ac8cc1a?s=128&d=identicon&r=PG&f=1", "display_name": "Akika.YS", "link": "https://stackoverflow.com/users/7625254/akika-ys"}, "edited": false, "score": 0, "creation_date": 1534351628, "post_id": 51862904, "comment_id": 90678169, "body": "but this piece of code i&#39;ve added as i hv created a new text box to be hidden in the form. It concatenate the combo box values selected. is there another way to do it selected values from DD / MM/YYYY combo updates the required cell?"}, {"owner": {"reputation": 17, "user_id": 7625254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93229e2f18a0d28744368cb47ac8cc1a?s=128&d=identicon&r=PG&f=1", "display_name": "Akika.YS", "link": "https://stackoverflow.com/users/7625254/akika-ys"}, "edited": false, "score": 0, "creation_date": 1534352495, "post_id": 51862904, "comment_id": 90678550, "body": "and when click on search btn, it should re-populate the combo box wz ze values from cells.. Any idea?"}], "tags": [], "owner": {"reputation": 40, "user_id": 10165736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bRim3GUnX_w/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppywRDXmj6Z5qL4bcjB34IxVp2nQ/mo/photo.jpg?sz=128", "display_name": "Kau&#234; Delmonte", "link": "https://stackoverflow.com/users/10165736/kau%c3%aa-delmonte"}, "is_accepted": false, "score": 0, "last_activity_date": 1534351323, "creation_date": 1534351323, "answer_id": 51862904, "question_id": 51862305, "link": "https://stackoverflow.com/questions/51862305/excel16-vba-how-choose-date-dd-mm-yyyy-from-combo-box-and-update-cells/51862904#51862904", "title": "excel16: vba, how choose date dd/mm/yyyy from combo box and update cells", "body": "<p>Remove this from your UserForm1 code:</p>\n\n<pre><code>Private Sub txt_date_Change()\n\ntxt_date.Text = cbo_dd.Value &amp; \"/\" &amp; cbo_mm.Value &amp; \"/\" &amp; cbo_yy.Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7625254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93229e2f18a0d28744368cb47ac8cc1a?s=128&d=identicon&r=PG&f=1", "display_name": "Akika.YS", "link": "https://stackoverflow.com/users/7625254/akika-ys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1534351323, "creation_date": 1534349052, "last_edit_date": 1534350884, "question_id": 51862305, "link": "https://stackoverflow.com/questions/51862305/excel16-vba-how-choose-date-dd-mm-yyyy-from-combo-box-and-update-cells", "title": "excel16: vba, how choose date dd/mm/yyyy from combo box and update cells", "body": "<p>Pls help... In excel V16 forms,\nI've added combo boxes for date of entry &amp; date of last payment set as DD / MM / YYYY defaulted with values:\nDD (01 to 31)/ MM (01 to 12)/ YYYY (2000 to 2020)</p>\n\n<p>User can input a studentID and click on search its retrieve the data from sheet1 and fill in the form with the required values.</p>\n\n<p>i'm Getting below issues: \n1. after the search for existing record the combo boxes DD/ MM/YYYY are not being loaded with the data stored in cell Q date of entry &amp; cell X date of last payment.\n2. when updating the date (DD/MM/YYYY) data, it's not replicating in the cells Q &amp; X.</p>\n\n<p>Pls help Macros in\n<a href=\"https://drive.google.com/drive/folders/1k8UKQQOS8tWa7I-wucEgIA5ypN6MFPOq?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/drive/folders/1k8UKQQOS8tWa7I-wucEgIA5ypN6MFPOq?usp=sharing</a></p>\n\n<p>Codes for search &amp; update btn:</p>\n\n<pre><code>Private Sub txt_date_Change()\ntxt_date.Text = cbo_dd.Value &amp; \"/\" &amp; cbo_mm.Value &amp; \"/\" &amp; cbo_yy.Value\nEnd Sub\n\nPrivate Sub cmd_search_Click()\nDim lastrow\nDim ref As String\nSheets(\"sheet1\").Activate\nlastrow = Sheets(\"sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nref = txt_ref.Text\nFor currentrow = 2 To lastrow\nIf Cells(currentrow, 1).Text = ref Then\n\n'txt_date.Text = Cells(currentrow, 17).Text\ntxt_datein.Text = Cells(currentrow, 17).Text   'date of entry \ntxt_dateout.Text = Cells(currentrow, 24).Value 'date last payment\nExit For\nEnd If\nNext currentrow\ntxt_datein.Enabled = False\ntxt_date.Enabled = False\nEnd Sub\n\nPrivate Sub cmd_update_Click()\nDim ref As String, cir As String\nSheets(\"sheet1\").Activate\n\ndatein = txt_datein.Text\nCells(currentrow, 17).Value = datein\n\ndateout = txt_dateout.Text\nCells(currentrow, 24).Value = dateout\n\nWith Me.cbo_mm\n.Clear\n.AddItem \"01\"\n.AddItem \"02\"\n.AddItem \"03\"\n.AddItem \"04\"\n.AddItem \"05\"\n.AddItem \"06\"\n.AddItem \"07\"\n.AddItem \"08\"\n.AddItem \"09\"\n.AddItem \"10\"\n.AddItem \"11\"\n.AddItem \"12\"\nEnd With\n\nWith Me.cbo_yy\n.Clear\n.AddItem \"2018\"\n.AddItem \"2019\"\n.AddItem \"2020\"\nEnd With\n\nCall clear_all\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "sql", "vba"], "comments": [{"owner": {"reputation": 621, "user_id": 9542374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b40e2d98a6793af81964218ea37d92?s=128&d=identicon&r=PG&f=1", "display_name": "Davesoft", "link": "https://stackoverflow.com/users/9542374/davesoft"}, "edited": false, "score": 2, "creation_date": 1534348839, "post_id": 51861864, "comment_id": 90676771, "body": "I recommend looking at case/when/else. It&#39;ll be big and ugly, but it&#39;ll be pretty much what you already have, just in sql :)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1534349376, "post_id": 51861864, "comment_id": 90677034, "body": "Did you get the data set as an Excel file, or a CSV? If it&#39;s the later, just don&#39;t open it in Excel."}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 0, "creation_date": 1534349515, "post_id": 51861864, "comment_id": 90677106, "body": "In VBA too you wouldn&#39;t do it like that :) What if you were dealing with a code that is 1000 in length instead of 5?"}], "answers": [{"tags": [], "owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "is_accepted": false, "score": 4, "last_activity_date": 1534349052, "creation_date": 1534349052, "answer_id": 51862304, "question_id": 51861864, "link": "https://stackoverflow.com/questions/51861864/convert-code-from-vba-to-sql-fixing-zip-codes/51862304#51862304", "title": "Convert code from VBA to SQL (fixing zip codes)", "body": "<p>for a sql query you could use a substr and lpad</p>\n\n<pre><code> select lpad(substr(your_column, 1,5), 5, '0') \n from your_table \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1534349999, "post_id": 51862516, "comment_id": 90677359, "body": "Yep. Skip Excel <i>entirely</i>. The bit about &quot;is also over 2 million lines&quot; is a pretty good hint that the OP&#39;s file isn&#39;t an Excel file to begin with..."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1534350069, "post_id": 51862516, "comment_id": 90677391, "body": "Indeed @Comintern ... data could be in multiple sheets! I have seen insane things done in Excel, forgetting it is not a database."}, {"owner": {"reputation": 35, "user_id": 10081939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uAzWin701_Y/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7raxTHDrePn_ma-mRUirPTXg1pvPQ/mo/photo.jpg?sz=128", "display_name": "tdlanghe", "link": "https://stackoverflow.com/users/10081939/tdlanghe"}, "edited": false, "score": 0, "creation_date": 1534360772, "post_id": 51862516, "comment_id": 90682356, "body": "This code worked perfectly! Thank you so much! Been pulling my hair out for hours."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1534350007, "last_edit_date": 1534350007, "creation_date": 1534349829, "answer_id": 51862516, "question_id": 51861864, "link": "https://stackoverflow.com/questions/51861864/convert-code-from-vba-to-sql-fixing-zip-codes/51862516#51862516", "title": "Convert code from VBA to SQL (fixing zip codes)", "body": "<p>Simply use pure SQL and have the MySQL engine process the needed results and not the Excel application. Below is the long-winded version to show how your Excel VBA can translate to SQL. Additionally, using <code>CASE</code> and double pipes is the ANSI standard and should work across most SQL dialects.</p>\n\n<p><strong>Select SQL</strong></p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>SET sql_mode='PIPES_AS_CONCAT';\n\nSELECT bad_zip, LENGTH(bad_zip),\n\n       CASE LENGTH(bad_zip)\n            WHEN 2 THEN '000' || bad_zip\n            WHEN 3 THEN '00' || bad_zip\n            WHEN 4 THEN '0' || bad_zip\n            WHEN 7 THEN '00' || LEFT(bad_zip, LENGTH(bad_zip) - 4)\n            WHEN 8 THEN '0' || LEFT(bad_zip, LENGTH(bad_zip) - 4)\n            WHEN 9 THEN LEFT(bad_zip, LENGTH(bad_zip) - 4)\n            ELSE bad_zip\n       END As clean_zip\n\nFROM myTable;\n</code></pre>\n\n<p><strong>Update SQL</strong></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SET sql_mode='PIPES_AS_CONCAT';\n\nUPDATE myTable \nSET    final_zip = CASE LENGTH(bad_zip)\n                        WHEN 2 THEN '000' || bad_zip\n                        WHEN 3 THEN '00' || bad_zip\n                        WHEN 4 THEN '0' || bad_zip\n                        WHEN 7 THEN '00' || LEFT(bad_zip, LENGTH(bad_zip) - 4)\n                        WHEN 8 THEN '0' || LEFT(bad_zip, LENGTH(bad_zip) - 4)\n                        WHEN 9 THEN LEFT(bad_zip, LENGTH(bad_zip) - 4)\n                        ELSE bad_zip\n                   END;\n</code></pre>\n\n<p><a href=\"http://rextester.com/YHNF83088\" rel=\"nofollow noreferrer\">RexTester Demo</a></p>\n"}], "owner": {"reputation": 35, "user_id": 10081939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uAzWin701_Y/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7raxTHDrePn_ma-mRUirPTXg1pvPQ/mo/photo.jpg?sz=128", "display_name": "tdlanghe", "link": "https://stackoverflow.com/users/10081939/tdlanghe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 51862516, "answer_count": 2, "score": 0, "last_activity_date": 1534360910, "creation_date": 1534347279, "last_edit_date": 1534360910, "question_id": 51861864, "link": "https://stackoverflow.com/questions/51861864/convert-code-from-vba-to-sql-fixing-zip-codes", "title": "Convert code from VBA to SQL (fixing zip codes)", "body": "<p>I downloaded a dataset from the internet and it was ill formatted. The zip codes are breaking my website. Some are the full 9 integer codes, others are 2 or 3 integers because the leading zeros didn't get formatted correctly, and everything in between. I need the normal 5 digit zip code for my site to work. The dataset is also over 2 million lines so it's difficult to work in Excel. I was hoping to get it working in MySQL.</p>\n\n<p>I have written code in VBA and tested it on parts of the data in Excel and i get the desired results.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function fixZips()\n\n    Dim cel As Range\n\n    For Each cel In Application.Selection\n\n        If Len(cel.Value) = 4 Then\n            cel.Value = \"0\" &amp; cel.Value\n\n        ElseIf Len(cel.Value) = 3 Then\n            cel.Value = \"00\" &amp; cel.Value\n\n        ElseIf Len(cel.Value) = 2 Then\n            cel.Value = \"000\" &amp; cel.Value\n\n        ElseIf Len(cel.Value) = 7 Then\n            cel.Value = \"00\" &amp; Left(cel.Value, Len(cel.Value) - 4)\n\n        ElseIf Len(cel.Value) = 8 Then\n            cel.Value = \"0\" &amp; Left(cel.Value, Len(cel.Value) - 4)\n\n        ElseIf Len(cel.Value) = 9 Then\n            cel.Value = Left(cel.Value, Len(cel.Value) - 4)\n\n        End If\n\n    Next cel\n\nEnd Function\n</code></pre>\n\n<p>I am having the hardest time figuring out how to do this in MySQL. I am using phpMyAdmin. Can I do this all in the SQL box? Do I need to create a stored procedure? If so, how do I do that in phpMyAdmin?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 1, "creation_date": 1534347485, "post_id": 51861579, "comment_id": 90676043, "body": "thanks for the catch: edited. btw ... you may want to mark the answer as accepted. thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 7, "last_activity_date": 1534347406, "last_edit_date": 1534347406, "creation_date": 1534346218, "answer_id": 51861579, "question_id": 51861536, "link": "https://stackoverflow.com/questions/51861536/vba-skip-cell-if/51861579#51861579", "title": "VBA, Skip Cell If", "body": "<p>use <code>Offset</code> to point to a <code>Range</code> at given rows and/or columns offsets from referenced one</p>\n\n<pre><code>Dim cell As Range\nFor Each cell In Range(\"A2:A100\")\n    If cell.Offset(0, 1).Value2 &lt;&gt; \"NO\" Then FilePaths.Add cell.Value2\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 51861579, "answer_count": 1, "score": 1, "last_activity_date": 1534347406, "creation_date": 1534346112, "question_id": 51861536, "link": "https://stackoverflow.com/questions/51861536/vba-skip-cell-if", "title": "VBA, Skip Cell If", "body": "<p>I want to loop through my range and incorporate the logic that if B2:B100 is \"No\" then skip.</p>\n\n<p>Original code:</p>\n\n<pre><code> Dim cell As Range\n    For Each cell In Range(\"A2:A100\")\n        FilePaths.Add cell.Value\n    Next cell\n</code></pre>\n\n<p>Trying:</p>\n\n<pre><code>If cell.Range(\"B2:B100\") &lt;&gt; \"Yes\" Then\n</code></pre>\n\n<p>Not sure on where to go next.  I want to go to next cell in col A, or continue back into col A.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1534345617, "post_id": 51861254, "comment_id": 90674931, "body": "&quot;showing Error&quot; is not a useful description of the problem you have..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534348389, "post_id": 51861254, "comment_id": 90676536, "body": "If the error is not a compile error arising from your possible misuse of smart-quotes, you should provide more information (and also please revise the code above so that it does compile)."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534352861, "post_id": 51861254, "comment_id": 90678706, "body": "OP I edited solution to address the error you were having and addressed other errors that you were bound to run into after."}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534352731, "post_id": 51862017, "comment_id": 90678643, "body": "\u201cUr so smart\u201d !"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1534352903, "post_id": 51862017, "comment_id": 90678730, "body": "@Marcucciboy2 OP actually had 3 different types of quotes in his code. I didn&#39;t notice until I tried to compile it."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534353019, "post_id": 51862017, "comment_id": 90678769, "body": "Is that a record you think?"}, {"owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "edited": false, "score": 0, "creation_date": 1534399905, "post_id": 51862017, "comment_id": 90692556, "body": "Thanks alot @urdearboy for the Code it&#39;s works perfect, i realised my mistakes and take care to not repeat this mistakes while writing the Code."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 3, "last_activity_date": 1534381963, "last_edit_date": 1534381963, "creation_date": 1534347813, "answer_id": 51862017, "question_id": 51861254, "link": "https://stackoverflow.com/questions/51861254/how-to-get-data-from-workbook-into-user-form-combox-and-text-boxes-with-excel-vb/51862017#51862017", "title": "How to Get Data from Workbook into User Form Combox and Text Boxes with Excel VBA?", "body": "<p>The error is due to <code>Smart Quotes</code> wrapping your sheet and range references.<br>\nRemove all <code>Smart Quotes</code> with <KBD>CTRL</KBD> + <KBD>F</KBD> &amp; <code>Find and Replace All</code> swapping (<strong>\u201c</strong>) &amp; (<strong>\u201d</strong>) for the correct quote notation,  (<strong>\"</strong>).  </p>\n\n<p>Note the subtle difference betwen the 3 quotes used below. VBA requires the 3rd </p>\n\n<h2>\u201c &lt;> \u201d &lt;> \"</h2>\n\n<hr>\n\n<p>Here are some other updates. You did not declare your worksheet reference and need to qualify all of your objects. This compiles now, but may still produce <code>Run Time Errors</code> or may have <code>Logic Errors</code> present. </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub cmbls_DropButtonClick()\n\nDim WB As Workbook: Set WB = Workbooks.Open(\"C:\\Users\\Desktop\\Inputs for Gate 1.xlsx\")\nDim WS As Worksheet: Set WS = WB.Worksheets(\"Sheet1\")\nDim i As Long\n\nIf Me.cmbls.ListCount = 0 Then\n    For i = 2 To WS.Range(\"A\" &amp; WS.Rows.Count).End(xlUp).Row\n        Me.cmbls.AddItem Sheets(\"Sheet1\").Cells(i, \"A\").Value\n    Next i\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub cmbls_Change()\n\nDim WB As Workbook: Set WB = Workbooks.Open(\"C:\\Users\\Inputs for Gate 1.xlsx\")\nDim WS As Worksheet: Set WS = WB.Worksheets(\"Sheet1\")\nDim i As Long\n\nFor i = 2 To WS.Range(\"A\" &amp; WS.Rows.Count).End(xlUp).Row\n    If WS.Cells(i, \"A\").Value = (Me.cmbls) Or WS.Cells(i, \"A\").Value = Val(Me.cmbls) Then\n        Me.TextBox1 = WS.Cells(i, \"B\").Value\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 51862017, "answer_count": 1, "score": -1, "last_activity_date": 1534382010, "creation_date": 1534345226, "last_edit_date": 1534382010, "question_id": 51861254, "link": "https://stackoverflow.com/questions/51861254/how-to-get-data-from-workbook-into-user-form-combox-and-text-boxes-with-excel-vb", "title": "How to Get Data from Workbook into User Form Combox and Text Boxes with Excel VBA?", "body": "<p>I am trying to get the data from the other Excel workbook into Userform. So when selected from the Dropdown list the user get automatcally fill the textboxes.</p>\n\n<p>Below is the Code I tried but showing error. Please help me to resolve this issue.</p>\n\n<pre><code>Private Sub cmbls_DropButtonClick()\nDim i As Long, LastRow As Long\nDim w As Workbook\n Set w = Workbooks.Open(\"C:\\Users\\Desktop\\Inputs for Gate 1.xlsx\")\n Set ssheet = w.Worksheets(\"Sheet1\")\n 'showing error in the below line LastRow'\n LastRow = Sheets(\u201cSheet1\u201d).Range(\u201cA\u201d &amp; Rows.Count).End(xlUp).Row  \n If Me.cmbls.ListCount = 0 Then\n For i = 2 To LastRow\n Me.cmbls.AddItem Sheets(\u201cSheet1\u201d).Cells(i, \u201cA\u201d).Value\n Next i\n End If\nEnd Sub\n\nPrivate Sub cmbls_Change()\nDim i As Long, LastRow As Long\nDim w As Workbook\n Set w = Workbooks.Open(\"C:\\Users\\Inputs for Gate 1.xlsx\")\n Set ssheet = w.Worksheets(\"Sheet1\")\n LastRow = Sheets(\u201cSheet1\u201d).Range(\u201cA\u201d &amp; Rows.Count).End(xlUp).Row\n For i = 2 To LastRow\n If Sheets(\u201cSheet1\u201d).Cells(i, \u201cA\u201d).Value = (Me.cmbls) Or _\n Sheets(\u201cSheet1\u201d).Cells(i, \u201cA\u201d).Value = Val(Me.cmbls) Then\n Me.TextBox1 = Sheets(\u201cSheet1\u201d).Cells(i, \u201cB\u201d).Value\n End If\n Next\nEnd Sub\n</code></pre>\n\n\n"}, {"tags": ["vba", "excel", "32bit-64bit", "excel-2016"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1534345705, "post_id": 51861236, "comment_id": 90674997, "body": "What does &quot;Crash&quot; mean? Any error message or just force close of Excel? Try to disable calculation <code>Application.Calculation = xlCalculationManual</code> before adding the formulas and enable it afterwards <code>Application.Calculation = xlCalculationAutomatic</code>. Make sure everyone runs the latest build version of Excel (run a update)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534345709, "post_id": 51861236, "comment_id": 90675000, "body": "&quot;Regular&quot; VBA runs the same on 32 and 64 bit: there&#39;s nothing in the posted code which would cause a problem on 64-bit"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1534345715, "post_id": 51861236, "comment_id": 90675001, "body": "There is nothing in that code that would vary for 64bit."}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1534346162, "post_id": 51861236, "comment_id": 90675261, "body": "It can crash if rows ends up being zero or not a number, but crashed will be a VBA error message"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534348025, "post_id": 51861236, "comment_id": 90676319, "body": "I second what @P\u1d07\u029c said - turn off calculations before inputting the formulas, then recalculate at the end."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1534349412, "post_id": 51861236, "comment_id": 90677050, "body": "Since some of the formulas you&#39;re entering are dependent on sheet names, it could cause issues if any of the sheets are renamed....."}, {"owner": {"reputation": 33, "user_id": 10096257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c95d4806fd1f29e4bf4d0b5b8051b797?s=128&d=identicon&r=PG&f=1", "display_name": "Myra", "link": "https://stackoverflow.com/users/10096257/myra"}, "edited": false, "score": 1, "creation_date": 1534349639, "post_id": 51861236, "comment_id": 90677171, "body": "The code ended up being fine. We had to do a registry hack as posted under the &quot;Registry Information&quot; section here: <a href=\"https://support.microsoft.com/en-us/help/3085435/august-8-2017-update-for-excel-2016-kb3085435\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/3085435/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 10096257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c95d4806fd1f29e4bf4d0b5b8051b797?s=128&d=identicon&r=PG&f=1", "display_name": "Myra", "link": "https://stackoverflow.com/users/10096257/myra"}, "edited": false, "score": 1, "creation_date": 1534349650, "post_id": 51861236, "comment_id": 90677175, "body": "Thanks for your help, everybody!"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 10096257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c95d4806fd1f29e4bf4d0b5b8051b797?s=128&d=identicon&r=PG&f=1", "display_name": "Myra", "link": "https://stackoverflow.com/users/10096257/myra"}, "is_accepted": true, "score": 2, "last_activity_date": 1534349682, "creation_date": 1534349682, "answer_id": 51862473, "question_id": 51861236, "link": "https://stackoverflow.com/questions/51861236/how-to-make-macro-written-on-32-bit-excel-2016-work-on-64-bit-excel-2016/51862473#51862473", "title": "How to make Macro written on 32 bit Excel 2016 work on 64 bit Excel 2016", "body": "<p>The code ended up being fine. We had to do a registry hack as posted under the \"Registry Information\" section here: <a href=\"https://support.microsoft.com/en-us/help/3085435/august-8-2017-update-for-excel-2016-kb3085435\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/3085435/august-8-2017-update-for-excel-2016-kb3085435</a></p>\n"}], "owner": {"reputation": 33, "user_id": 10096257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c95d4806fd1f29e4bf4d0b5b8051b797?s=128&d=identicon&r=PG&f=1", "display_name": "Myra", "link": "https://stackoverflow.com/users/10096257/myra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1992, "favorite_count": 0, "accepted_answer_id": 51862473, "answer_count": 1, "score": 1, "last_activity_date": 1534349682, "creation_date": 1534345154, "last_edit_date": 1534345517, "question_id": 51861236, "link": "https://stackoverflow.com/questions/51861236/how-to-make-macro-written-on-32-bit-excel-2016-work-on-64-bit-excel-2016", "title": "How to make Macro written on 32 bit Excel 2016 work on 64 bit Excel 2016", "body": "<p>A macro was originally created on a 64 bit excel 2016 version (from Office 365) but I have been working on it in my 32 bit 2016 version (from Office 365). The macro works perfectly on my 32 bit computer. However, the person I am working on it for is using the 64 bit version of Excel 2016, and they say it keeps crashing for them, but it is inconsistent, crashing in different places all the time and even occasionally running properly. The code DOES NOT contain any declare statements or longs, so I am not sure why this is happening or what to do about it. Any help regarding how to fix this or what the problem is would be much appreciated. Thank you. A copy of the code that has been crashing is included below.</p>\n\n<pre><code>Sub Formulas()\n\nDim rows As String\n\nrows = CStr(Range(\"Sheet1!C31\").Value)\n\nRange(\"Sheet2!M2:M\" &amp; rows).Formula = \"=((F2*1000)-(Sheet1!$C$13*(COS(2*PI()*(Sheet1!$C$15/360)))))*-1\"\nRange(\"Sheet2!N2:N\" &amp; rows).Formula = \"=IF(G2&lt;0,0,((G2+Sheet1!$C$19+Sheet1!$C$21)*Sheet1!$C$17))\"\nRange(\"Sheet2!O2:O\" &amp; rows).Formula = \"=M2+N2\"\nRange(\"Sheet2!P2:P\" &amp; rows).Formula = \"=O2/Sheet1!$C$23\"\nRange(\"Sheet2!Q2:Q\" &amp; rows).Formula = \"=IF(OR(P2&gt;(Sheet1!$C$25),P2&lt;(Sheet1!$C$26)),1,0)\"\nRange(\"Sheet2!R2:R\" &amp; rows).Formula = \"=IF(H2&gt;0,1,0)\"\nRange(\"Sheet2!S2:S\" &amp; rows).Formula = \"=IF(AND(Q2=1),(R2=1)*1,0)\"\nRange(\"Sheet2!B17\").Formula = \"=1-(SUM(S:S)/SUM(R:R))\"\nRange(\"Sheet1!C28\") = Range(\"Sheet2!B17\")\n\n'Do While Not IsEmpty(ActiveCell.Value)\n'     Range(\"Sheet2!M\" &amp; CStr(ActiveCell.Row)).EntireRow.Delete\n'Loop\n\n\nEnd Sub\n</code></pre>\n\n<p>I am fairly new to vba and macros, so if someone could point out what aspect of the code is incompatible in 64 bit or even suggest how to fix it, I would be extremely grateful. Thank you.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": true, "score": 0, "last_activity_date": 1534346643, "last_edit_date": 1534346643, "creation_date": 1534345470, "answer_id": 51861337, "question_id": 51861137, "link": "https://stackoverflow.com/questions/51861137/change-the-font-color-of-the-last-3-digits-in-a-number/51861337#51861337", "title": "Change the Font Color of the Last 3 Digits in a Number", "body": "<p>Try the following:</p>\n\n<pre><code>Sub Test    \n\nDim i As Long\n\nFor i = 1 To 3\n    RResult = Right(ActiveCell, 3)\n    LResult = Left(ActiveCell, 4)\n    ActiveCell = LResult + \" \" + RResult\n    ActiveCell.Characters(Start:=6, Length:=3).Font.Color = 255\n    ActiveCell.Offset(1, 0).Select\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1619256515, "post_id": 51862584, "comment_id": 118853541, "body": "<i>This method gives you a few more options:</i> ... indeed +:)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1534350634, "last_edit_date": 1534350634, "creation_date": 1534350122, "answer_id": 51862584, "question_id": 51861137, "link": "https://stackoverflow.com/questions/51861137/change-the-font-color-of-the-last-3-digits-in-a-number/51862584#51862584", "title": "Change the Font Color of the Last 3 Digits in a Number", "body": "<p>This method gives you a few more options:  </p>\n\n<p>You pass it the range reference and an optional character count and RGB colour.</p>\n\n<pre><code>Public Sub ColourLastThree(Target As Range, Optional CharCount As Long = 3, Optional RGBColour As Long = 255)\n\n    Dim rCell As Range\n\n    For Each rCell In Target\n        If Len(rCell) &gt;= CharCount Then\n            rCell = \"'\" &amp; rCell\n            rCell.Characters(Start:=Len(rCell) - (CharCount - 1), Length:=CharCount).Font.Color = RGBColour\n        End If\n    Next rCell\n\nEnd Sub\n</code></pre>\n\n<p>You can then call the procedure:  </p>\n\n<pre><code>'Colour the last three characters in the ActiveCell to red.\nSub Test()\n    ColourLastThree ActiveCell\nEnd Sub\n\n'Colour last four characters in Sheet1!A1 to red.\nSub Test1()\n    ColourLastThree Worksheets(\"Sheet1\").Range(\"A1\"), 4\nEnd Sub\n\n'Colour last four characters in Sheet1!A1 to Green.\nSub Test2()\n    ColourLastThree Worksheets(\"Sheet1\").Range(\"A3\"), 4, RGB(0, 255, 0) 'or can use 65535 as RGB.\nEnd Sub\n\n'Colour last three character in each cell on the ActiveSheet in A1:A4.\nSub Test3()\n    ColourLastThree Range(\"A1:A4\")\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong>  I've updated the code to cycle through each cell in the passed Target range (as shown in Test3 procedure).</p>\n"}], "owner": {"reputation": 3, "user_id": 10229904, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KTMMnR8Nr6Y/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oscjqbxG3477mXTAkkMO8ig7MATQ/mo/photo.jpg?sz=128", "display_name": "Austen Tong", "link": "https://stackoverflow.com/users/10229904/austen-tong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 51861337, "answer_count": 2, "score": 0, "last_activity_date": 1619256320, "creation_date": 1534344850, "last_edit_date": 1619256320, "question_id": 51861137, "link": "https://stackoverflow.com/questions/51861137/change-the-font-color-of-the-last-3-digits-in-a-number", "title": "Change the Font Color of the Last 3 Digits in a Number", "body": "<p>I'm having trouble with some of my code in Excel VBA.</p>\n<p>I have an identification number that's always 7 digits long and is located in column B. I need to take the last 3 digits of the ID number and change the font color.</p>\n<p>I've tried using the Right() function, but I can't figure out how to combine it with the Font.Color function.</p>\n<pre><code>Sub Test    \n\nDim i As Long\n    \nFor i = 1 To 3\n    RResult = Right(ActiveCell, 3)\n    LResult = Left(ActiveCell, 4)\n    ActiveCell = LResult + &quot; &quot; + RResult\n    ActiveCell.Offset(1, 0).Select\nNext i\n    \nEnd Sub\n</code></pre>\n<p>I tried the above code to seperate the digits, but I can't change the font color of the RResult (Right Result) variable.</p>\n"}, {"tags": ["excel", "vba", "image", "dynamic"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1534344260, "post_id": 51860828, "comment_id": 90674143, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17110425/vba-to-insert-embedded-picture-excel\">VBA to insert embedded picture</a>"}, {"owner": {"reputation": 1, "user_id": 10055934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd9f98433350215386cd81daf43ecb75?s=128&d=identicon&r=PG&f=1", "display_name": "Kristie", "link": "https://stackoverflow.com/users/10055934/kristie"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534521281, "post_id": 51860828, "comment_id": 90748961, "body": "I did find Dim xlApp as Object Set xlApp = CreateObject(&quot;Excel.Application&quot;) So I tried Dim shpPic = xlApp.Shape but is this what I need? Would I just paste after the section that resizes the image?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534521584, "post_id": 51860828, "comment_id": 90749152, "body": "You&#39;re already in Excel - I&#39;m not why sure why you&#39;re using <code>Set xlApp = CreateObject...</code> But in any case, if you&#39;re using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Shapes.AddPicture\" rel=\"nofollow noreferrer\"><code>Shapes.AddPicture</code></a>, <code>shpPic</code> is just a <code>Shape</code> - <code>Dim shpPic as Shape</code>."}, {"owner": {"reputation": 1, "user_id": 10055934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd9f98433350215386cd81daf43ecb75?s=128&d=identicon&r=PG&f=1", "display_name": "Kristie", "link": "https://stackoverflow.com/users/10055934/kristie"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534522436, "post_id": 51860828, "comment_id": 90749614, "body": "Thank you. I am REALLY new to VBA, Would you mind letting me know the format for how I should add that above?"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 1, "user_id": 10055934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd9f98433350215386cd81daf43ecb75?s=128&d=identicon&r=PG&f=1", "display_name": "Kristie", "link": "https://stackoverflow.com/users/10055934/kristie"}, "edited": false, "score": 0, "creation_date": 1534533828, "post_id": 51899926, "comment_id": 90754543, "body": "Glad to help you! If it worked, feel free to mark the answer as accepted by clicking the check mark beside it."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1534526486, "last_edit_date": 1534526486, "creation_date": 1534524965, "answer_id": 51899926, "question_id": 51860828, "link": "https://stackoverflow.com/questions/51860828/insert-dynamically-in-excel-using-image-from-server-path/51899926#51899926", "title": "Insert Dynamically in Excel using image from server path", "body": "<p>Based on both answers from the question <a href=\"https://stackoverflow.com/questions/17110425/vba-to-insert-embedded-picture-excel\">VBA to insert embedded picture</a>, use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Shapes.AddPicture\" rel=\"nofollow noreferrer\"><code>Shapes.AddPicture</code></a> (or <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.shapes.addpicture2\" rel=\"nofollow noreferrer\"><code>Shapes.AddPicture2</code></a> if you want to compress the picture when inserting.)</p>\n\n<ul>\n<li><em>LinktoFile</em> is <code>msoFalse</code></li>\n<li><em>SaveWithDocument</em> is <code>msoTrue</code></li>\n<li><em>Width</em> and <em>Height</em> are each <code>-1</code> to preserve the existing dimensions of the picture</li>\n</ul>\n\n<hr>\n\n<pre><code>Sub ImageUpdate()\n' inserts the picture files listed in col A into the workbook,\n' and sizes and centers in col B\n\nConst sPath       As String = \"S:\\Images\\Casio\\\"\n'Const sPath       As String = \"C:\\Users\\shg\\Pictures\\shg\"\nDim cell          As Range\nDim sFile         As String\nDim shpPic        As Shape\nDim ws            As Worksheet: Set ws = ActiveSheet\n\nWith ws\n    For Each cell In .Range(.Range(\"A2\"), .Cells(.Rows.Count, \"A\").End(xlUp))\n        sFile = sPath &amp; cell.Text &amp; \".jpg\"\n\n        If Len(Dir(sFile)) Then\n            Set shpPic = .Shapes.AddPicture(sFile, msoFalse, msoTrue, 0, 0, -1, -1)\n            shpPic.LockAspectRatio = msoTrue\n\n            With cell.Offset(, 1)\n                If shpPic.Height &gt; .Height Then shpPic.Height = .Height\n                If shpPic.Width &gt; .Width Then shpPic.Width = .Width\n\n                shpPic.Top = .Top + .Height / 2 - shpPic.Height / 2\n                shpPic.Left = .Left + .Width / 2 - shpPic.Width / 2\n            End With\n        Else\n            cell.Select\n            MsgBox sFile &amp; \" not found\"\n        End If\n    Next cell\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10055934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd9f98433350215386cd81daf43ecb75?s=128&d=identicon&r=PG&f=1", "display_name": "Kristie", "link": "https://stackoverflow.com/users/10055934/kristie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 787, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534526486, "creation_date": 1534343844, "last_edit_date": 1534521416, "question_id": 51860828, "link": "https://stackoverflow.com/questions/51860828/insert-dynamically-in-excel-using-image-from-server-path", "title": "Insert Dynamically in Excel using image from server path", "body": "<p>I have code below to look for an image of a sku in a specific folder in our server and insert /autosize - but the issue i have is that if I send this spreadsheet to anyone else not on the server, they cannot see images. \nCan someone help fix this so it inserts the image dynamically? I believe this is what has to be done to place the actual image in the sheet rather than link-back when the sheet is updated/Opened. \nOr, how can I format this to send out and include images if they are not linked to the server? \nI have looked at other posts which refer to inserting dynamically but I cant get anything to work</p>\n\n<pre><code>Sub Imageupdate()\n' inserts the picture files listed in col A into the workbook,\n' and sizes and centers in col B\n\nConst sPath       As String = \"S:\\Images\\Casio\\\"\n'Const sPath       As String = \"C:\\Users\\shg\\Pictures\\shg\"\nDim cell          As Range\nDim sFile         As String\nDim oPic          As Picture\n\nFor Each cell In Range(\"A2\", Cells(Rows.Count, \"A\").End(xlUp))\nsFile = sPath &amp; cell.Text &amp; \".jpg\"\nIf Len(Dir(sFile)) Then\n  Set oPic = ActiveSheet.Pictures.Insert(sFile)\n  oPic.ShapeRange.LockAspectRatio = msoTrue\n\n  With cell.Offset(, 1)\n    If oPic.Height &gt; .Height Then oPic.Height = .Height\n    If oPic.Width &gt; .Width Then oPic.Width = .Width\n\n    oPic.Top = .Top + .Height / 2 - oPic.Height / 2\n    oPic.Left = .Left + .Width / 2 - oPic.Width / 2\n  End With\nElse\n  cell.Select\n  MsgBox sFile &amp; \" not found\"\nEnd If\nNext cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy", "copy-paste"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1534343881, "post_id": 51860822, "comment_id": 90673914, "body": "<code>xlUp</code>, not <code>xlToUp</code>. Also, your <code>Offset(, 1)</code> is offsetting by 1 column - the row offset is the first argument."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534344108, "post_id": 51860822, "comment_id": 90674062, "body": "The 2nd argument of <code>Cells</code> is the column number, why <code>Cells(1, UsdRows)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9479664, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rodge95", "link": "https://stackoverflow.com/users/9479664/rodge95"}, "edited": false, "score": 0, "creation_date": 1534345181, "post_id": 51860983, "comment_id": 90674677, "body": "this has copied A4:A6 into cells A7:A9 - for example in cells A3,A4,A5 and A5 contain text A,B,C and D - this has put the text B, C and D into cells A7:A9. I need it so that A, B, C and D goes into A8:A11. Thanks"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1534344697, "last_edit_date": 1534344697, "creation_date": 1534344321, "answer_id": 51860983, "question_id": 51860822, "link": "https://stackoverflow.com/questions/51860822/vba-copy-and-paste-to-row-1-below/51860983#51860983", "title": "VBA Copy and Paste to Row +1 below", "body": "<p>I suggest the following:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub RollFile()\n    Const RowsToCopy As Long = 4 'amount of rows that should be copied\n\n    Dim LastCell As Range\n    Set LastCell = Cells(Rows.Count, \"A\").End(xlUp) 'last cell in col A\n\n    With LastCell.Offset(RowOffset:=-RowsToCopy + 1).Resize(RowSize:=RowsToCopy) '= last 4 cells (4 = RowsToCopy)\n        .Copy LastCell.Offset(RowOffset:=2)\n        .Value = .Value 'not needed I think\n    End With\nEnd Sub\n</code></pre>\n\n<p>It looks for the last used cell in column A. Then selects the previous 4 cells from there and copies that 2 rows below.</p>\n\n<p>Note that I think <code>.Value = .Value</code> is not needed at all because that only makes sense if formulas were copied that need to be transformed into values.</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1534345158, "creation_date": 1534345158, "answer_id": 51861237, "question_id": 51860822, "link": "https://stackoverflow.com/questions/51860822/vba-copy-and-paste-to-row-1-below/51861237#51861237", "title": "VBA Copy and Paste to Row +1 below", "body": "<p>you could try this</p>\n\n<pre><code>Sub RollFile()\n\n    With Cells(Rows.Count, 1).End(xlUp) ' reference column A last not empty cell\n        With Range(.End(xlUp), .Cells) ' reference the range from referenced cell up to last adjacent one\n            .Offset(.Rows.Count + 1).Value = .Value ' copy referenced range values to a range two row below its end\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9479664, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rodge95", "link": "https://stackoverflow.com/users/9479664/rodge95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 0, "accepted_answer_id": 51861237, "answer_count": 2, "score": 0, "last_activity_date": 1534345158, "creation_date": 1534343813, "question_id": 51860822, "link": "https://stackoverflow.com/questions/51860822/vba-copy-and-paste-to-row-1-below", "title": "VBA Copy and Paste to Row +1 below", "body": "<p>I'm trying to write some code that will copy and paste data in cells A3:A6 to A8:A11 and then when run again it will paste it the row +1 beneath, so the next time it's run the data in A8:A11 will be copy and pasted into A13:A16 and the next time after that it's run it will paste the data in A13:16 to A18:21 and so on.</p>\n\n<p>The below is what I've tried to come up with but I might be quite a way off, any guidance will be appreciated:</p>\n\n<pre><code>Sub RollFile()\n\nDim UsdRows As Long\n\nUsdRows = Cells(Rows.Count, 3).End(xlToUp).Row\nWith Range(Cells(1, UsdRows), Cells(UsdRows, 1))\n  .Copy .Offset(, 1)\n  .Value = .Value\n  .Offset(-1, 1)(1).Select\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Many thanks</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1534349125, "post_id": 51860727, "comment_id": 90676900, "body": "I don&#39;t know which code needs conversion, but you can simplify naming the data range to just the line <code>Range(Sheets(&quot;Data&quot;).Range(&quot;A1&quot;),Sheets(&quot;Data&quot;).Range(&quot;A1&quot;).&zwnj;&#8203;End(xlToRight).End(x&zwnj;&#8203;lDown)).Name = &quot;PIVOT_RANGE&quot;</code>. This also removes most of the changing focus/selects in the code."}, {"owner": {"reputation": 11, "user_id": 10229661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d69e8e27d9f69b8dc9108a86dbbcf2e?s=128&d=identicon&r=PG&f=1", "display_name": "SBHA", "link": "https://stackoverflow.com/users/10229661/sbha"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1534369426, "post_id": 51860727, "comment_id": 90685760, "body": "Thanks @Mistella that does simplify things considerably - and will also help narrow down whether it is indeed the Activeworkbook.RefreshAll statement that is causing the issue."}], "owner": {"reputation": 11, "user_id": 10229661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d69e8e27d9f69b8dc9108a86dbbcf2e?s=128&d=identicon&r=PG&f=1", "display_name": "SBHA", "link": "https://stackoverflow.com/users/10229661/sbha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593587652, "creation_date": 1534343495, "last_edit_date": 1593587652, "question_id": 51860727, "link": "https://stackoverflow.com/questions/51860727/refresh-pivot-table-on-mac", "title": "Refresh pivot table on Mac", "body": "<p>I have a working VBA Macro in Excel for Windows, attached to a button, to recalculate and refresh all pivot tables.</p>\n\n<p>I have shared this with a client who uses a Mac, and it does not work. I am unable to test which element is not working but suspect it is the pivot table refresh.</p>\n\n<p>Is there anything here that would require translation from Windows to a Mac?</p>\n\n<p>All source data for the pivot tables are linked to the 'Data' sheet.</p>\n\n<pre><code>'## Define current worksheet\nDim wkst As Worksheet\nSet wkst = ActiveSheet\n\n'## recalculate all formulas ##\nCalculate \n\n'## select data sheet, find the whole range and name it PIVOT_RANGE ##     \nSheets(\"Data\").Select\nRange(\"A1\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Name = \"PIVOT_RANGE\"\n\n'## Refresh all pivot tables in the workbook ## \nActiveWorkbook.RefreshAll\n\n'## select original worksheet\nwkst.Select\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 5010, "user_id": 9754169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/785875bd9271c02795b886d3a9c65331?s=128&d=identicon&r=PG&f=1", "display_name": "Yuca", "link": "https://stackoverflow.com/users/9754169/yuca"}, "edited": false, "score": 0, "creation_date": 1534343980, "post_id": 51860711, "comment_id": 90673973, "body": "what error or misbehavior are you getting?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534344471, "post_id": 51860711, "comment_id": 90674258, "body": "Which bank are you trying to select? And what is the data you are hoping to get back?"}, {"owner": {"reputation": 11, "user_id": 10229762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155504086897213/picture?type=large", "display_name": "Francis Wong", "link": "https://stackoverflow.com/users/10229762/francis-wong"}, "reply_to_user": {"reputation": 5010, "user_id": 9754169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/785875bd9271c02795b886d3a9c65331?s=128&d=identicon&r=PG&f=1", "display_name": "Yuca", "link": "https://stackoverflow.com/users/9754169/yuca"}, "edited": false, "score": 0, "creation_date": 1534344709, "post_id": 51860711, "comment_id": 90674397, "body": "@Yuca: When I run the code it copies the query page and not the data output that appears in the pop-up window."}, {"owner": {"reputation": 11, "user_id": 10229762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155504086897213/picture?type=large", "display_name": "Francis Wong", "link": "https://stackoverflow.com/users/10229762/francis-wong"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534344798, "post_id": 51860711, "comment_id": 90674451, "body": "@Qharr: for now, I am trying to copy the data of Total All Banks. I want to copy the output that appears in the pop up window in excel."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534352205, "post_id": 51860711, "comment_id": 90678414, "body": "what is Z005 ? It appears to be a variable but I can&#39;t see it assigned anywhere."}, {"owner": {"reputation": 11, "user_id": 10229762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155504086897213/picture?type=large", "display_name": "Francis Wong", "link": "https://stackoverflow.com/users/10229762/francis-wong"}, "edited": false, "score": 0, "creation_date": 1534355374, "post_id": 51860711, "comment_id": 90679804, "body": "It is the option for the dropdown list to select Total All Banks."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534355410, "post_id": 51860711, "comment_id": 90679827, "body": "If it is a string it should be in &quot;&quot; ?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10229762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155504086897213/picture?type=large", "display_name": "Francis Wong", "link": "https://stackoverflow.com/users/10229762/francis-wong"}, "edited": false, "score": 0, "creation_date": 1534355335, "post_id": 51862042, "comment_id": 90679787, "body": "Thanks i&#39;ll try this."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1534347910, "creation_date": 1534347910, "answer_id": 51862042, "question_id": 51860711, "link": "https://stackoverflow.com/questions/51860711/vba-copy-data-from-website-into-excel/51862042#51862042", "title": "VBA: copy data from website into excel", "body": "<p>I don't have time to get into all the stuff about controlling one browser from another, but I think you can figure that part out, especially since you made some great progress on this already.  Get URL#2 from URL#1, like you are doing, but with some better data controls around it, and then do this...</p>\n\n<pre><code>Option Explicit\nSub Web_Table_Option_One()\n    Dim xml    As Object\n    Dim html   As Object\n    Dim objTable As Object\n    Dim result As String\n    Dim lRow As Long\n    Dim lngTable As Long\n    Dim lngRow As Long\n    Dim lngCol As Long\n    Dim ActRw As Long\n    Set xml = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n    With xml\n        .Open \"GET\", \"http://ws1.osfi-bsif.gc.ca/WebApps/Temp/2f40b7ef-d024-4eca-a8a3-fb82153efafaFinancialData.aspx\", False\n        .send\n    End With\n    result = xml.responseText\n    Set html = CreateObject(\"htmlfile\")\n    html.body.innerHTML = result\n    Set objTable = html.getElementsByTagName(\"Table\")\n    For lngTable = 0 To objTable.Length - 1\n        For lngRow = 0 To objTable(lngTable).Rows.Length - 1\n            For lngCol = 0 To objTable(lngTable).Rows(lngRow).Cells.Length - 1\n                ThisWorkbook.Sheets(\"Sheet1\").Cells(ActRw + lngRow + 1, lngCol + 1) = objTable(lngTable).Rows(lngRow).Cells(lngCol).innerText\n            Next lngCol\n        Next lngRow\n        ActRw = ActRw + objTable(lngTable).Rows.Length + 1\n    Next lngTable\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1534404787, "last_edit_date": 1534404787, "creation_date": 1534402944, "answer_id": 51871343, "question_id": 51860711, "link": "https://stackoverflow.com/questions/51860711/vba-copy-data-from-website-into-excel/51871343#51871343", "title": "VBA: copy data from website into excel", "body": "<p>You were using the current test with <code>document.Title</code>. I found that <code>For Each</code> of all windows looking for the full title worked in combination with copy pasting the pop-up window outerHTML. No additional wait time was required.</p>\n\n<p>Inside the <code>For Each Loop</code>, after you reset the IE instance to the new window, you can obtain the new URL with <code>ie.document.url</code>. As you already have the data loaded you might as well just copy paste it straight away in my opinion.</p>\n\n<hr>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub GetOsfiFinancialData()\n    Dim UrlAddress As String, objButton, ie As Object\n    UrlAddress = \"http://ws1.osfi-bsif.gc.ca/WebApps/FINDAT/DTIBanks.aspx?T=0&amp;LANG=E\"\n    Set ie = CreateObject(\"internetexplorer.application\")\n\n    With ie\n        .Silent = True\n        .Visible = False\n        .navigate UrlAddress\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        .document.getElementById(\"DTIWebPartManager_gwpDTIBankControl1_DTIBankControl1_institutionTypeCriteria_institutionsDropDownList\").Value = \"Z005\"\n\n        Set objButton = .document.getElementById(\"DTIWebPartManager_gwpDTIBankControl1_DTIBankControl1_submitButton\")\n        objButton.Focus\n        objButton.Click\n\n        Dim objShellWindows As New SHDocVw.ShellWindows, currentWindow As IWebBrowser2\n\n        For Each currentWindow In objShellWindows\n            If currentWindow.document.Title = \"Consolidated Monthly Balance Sheet - Banks, Trust and Loan\" Then\n                Set ie = currentWindow\n                Exit For\n            End If\n        Next\n\n        Dim clipboard As Object\n        Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n        clipboard.SetText ie.document.body.outerHTML\n        clipboard.PutInClipboard\n        ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 1).PasteSpecial\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>References (VBE > Tools > References):</strong></p>\n\n<ol>\n<li>Microsoft Internet Controls</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 10229762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155504086897213/picture?type=large", "display_name": "Francis Wong", "link": "https://stackoverflow.com/users/10229762/francis-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2367, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539084046, "creation_date": 1534343441, "last_edit_date": 1539084046, "question_id": 51860711, "link": "https://stackoverflow.com/questions/51860711/vba-copy-data-from-website-into-excel", "title": "VBA: copy data from website into excel", "body": "<p>I have a VBA code that selects info from drop-down menus on a government website and then submits the query. The requested data then opens up in another IE page. I am trying to copy this data into excel; however, I am unable to do so. \nMy code currently copies the text on the first IE page that contains the drop-down menus. The government website is: <a href=\"http://www.osfi-bsif.gc.ca/Eng/wt-ow/Pages/FINDAT.aspx\" rel=\"nofollow noreferrer\">http://www.osfi-bsif.gc.ca/Eng/wt-ow/Pages/FINDAT.aspx</a></p>\n\n<p>I have look all over the internet for a solution but nothing seems to work...</p>\n\n<p>Here is my code: </p>\n\n<pre><code>Sub GetOsfiFinancialData()\n\nDim UrlAddress As String\nUrlAddress = \"http://ws1.osfi-bsif.gc.ca/WebApps/FINDAT/DTIBanks.aspx?T=0&amp;LANG=E\"\n\nDim ie As Object\nSet ie = CreateObject(\"internetexplorer.application\")\nWith ie\n    .Silent = True\n    .Visible = False\n    .navigate UrlAddress\nEnd With\n\nDo Until Not ie.Busy And ie.readyState = 4\n    DoEvents\nLoop\n\nApplication.Wait (Now() + TimeValue(\"00:00:05\"))\n\n'Select Bank\nie.document.getElementById(\"DTIWebPartManager_gwpDTIBankControl1_DTIBankControl1_institutionTypeCriteria_institutionsDropDownList\").Value = Z005\n\n'open window with financial data\nDim objButton\nSet objButton = ie.document.getElementById(\"DTIWebPartManager_gwpDTIBankControl1_DTIBankControl1_submitButton\")\nobjButton.Focus\nobjButton.Click\n\n'select new pop-up window\nmarker = 0\nSet objshell = CreateObject(\"Shell.Application\")\nIE_count = objshell.Windows.Count\nFor x = 0 To (IE_count - 1)\n    On Error Resume Next    ' sometimes more web pages are counted than are open\n    my_title = objshell.Windows(x).document.Title\n\n    If my_title Like \"Consolidated Monthly Balance Sheet\" &amp; \"*\" Then 'compare to find if the desired web page is already open\n        Set ie = objshell.Windows(x)\n        marker = 1\n        Exit For\n    Else\n    End If\nNext\n\nDo Until Not ie.Busy And ie.readyState = 4\n    DoEvents\nLoop\n\nApplication.Wait (Now() + TimeValue(\"00:00:05\"))\n\nDim doc As MSHTML.HTMLDocument\nDim tables As MSHTML.IHTMLElementCollection\nDim table As MSHTML.HTMLTable\nDim clipboard As MSForms.DataObject\n\nSet doc = ie.document\nSet tables = doc.getElementsByTagName(\"body\")\nSet table = tables(0)\nSet clipboard = New MSForms.DataObject\n\n'paste in sheets\nDim test\nSet test = ActiveWorkbook.Sheets(\"Test\")\nclipboard.SetText table.outerHTML\nclipboard.PutInClipboard\ntest.Range(\"A1\").PasteSpecial xlPasteAll\nclipboard.Clear\n\nMsgBox (\"Task Completed\")\n\nEnd Sub\n</code></pre>\n\n<p>Your help is greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1534344060, "post_id": 51860699, "comment_id": 90674028, "body": "It&#39;s unclear what you&#39;re asking for. You want to do something without doing it the way it&#39;s meant to be done?"}, {"owner": {"reputation": 3, "user_id": 9660412, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iw0yCZYcWBk/AAAAAAAAAAI/AAAAAAAAACo/9sX8dCNIyHs/photo.jpg?sz=128", "display_name": "Camil Haroune", "link": "https://stackoverflow.com/users/9660412/camil-haroune"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1534344416, "post_id": 51860699, "comment_id": 90674230, "body": "I basically want to stock the value into a variable without having to bother managing a cell."}, {"owner": {"reputation": 3, "user_id": 9660412, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iw0yCZYcWBk/AAAAAAAAAAI/AAAAAAAAACo/9sX8dCNIyHs/photo.jpg?sz=128", "display_name": "Camil Haroune", "link": "https://stackoverflow.com/users/9660412/camil-haroune"}, "edited": false, "score": 0, "creation_date": 1534344915, "post_id": 51860699, "comment_id": 90674515, "body": "I want to use Small on MyRange without considering the zeros."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9660412, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iw0yCZYcWBk/AAAAAAAAAAI/AAAAAAAAACo/9sX8dCNIyHs/photo.jpg?sz=128", "display_name": "Camil Haroune", "link": "https://stackoverflow.com/users/9660412/camil-haroune"}, "edited": false, "score": 0, "creation_date": 1534346496, "post_id": 51861312, "comment_id": 90675441, "body": "The problem with this solution is that you can only get the minimum and you cannot access the n-th smallest element."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1534346952, "last_edit_date": 1534346952, "creation_date": 1534345401, "answer_id": 51861312, "question_id": 51860699, "link": "https://stackoverflow.com/questions/51860699/bypassing-formulaarray/51861312#51861312", "title": "Bypassing FormulaArray", "body": "<p>Comparing array to 0 is not valid in VBA, but you can <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-evaluate-method-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\"><code>Evaluate</code></a> (<code>hello As Variant</code> for error values) :</p>\n\n<pre><code>hello = Sheet1.Evaluate(\"Small(If(\" &amp; MyRange.Address &amp; \"&lt;&gt;0, \" &amp; MyRange.Address &amp; \"), 2)\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9660412, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iw0yCZYcWBk/AAAAAAAAAAI/AAAAAAAAACo/9sX8dCNIyHs/photo.jpg?sz=128", "display_name": "Camil Haroune", "link": "https://stackoverflow.com/users/9660412/camil-haroune"}, "edited": false, "score": 0, "creation_date": 1534359787, "post_id": 51862825, "comment_id": 90681910, "body": "Thank you for this solution even though it&#39;s not really what I was looking for."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 9660412, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iw0yCZYcWBk/AAAAAAAAAAI/AAAAAAAAACo/9sX8dCNIyHs/photo.jpg?sz=128", "display_name": "Camil Haroune", "link": "https://stackoverflow.com/users/9660412/camil-haroune"}, "edited": false, "score": 0, "creation_date": 1534363166, "post_id": 51862825, "comment_id": 90683341, "body": "In that case you might consider updating your question.  This is just a more elaborate version of your line of code."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1534372512, "last_edit_date": 1534372512, "creation_date": 1534351011, "answer_id": 51862825, "question_id": 51860699, "link": "https://stackoverflow.com/questions/51860699/bypassing-formulaarray/51862825#51862825", "title": "Bypassing FormulaArray", "body": "<p>I don't think you can use <code>IF</code> as a worksheet function in VBA.</p>\n\n<p>However, if you have this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/akD5r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/akD5r.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can do this:</p>\n\n<pre><code>Sub tester()\n\n    Dim r, i\n\n    r = ActiveSheet.Evaluate(\"IF(A1:A10=0,FALSE,A1:A10)\")\n\n    For i = LBound(r) To UBound(r)\n        Debug.Print i, Application.Small(r, i)\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>and get this:</p>\n\n<pre><code> 1             1 \n 2             2 \n 3             3 \n 4             5 \n 5             6 \n 6             7 \n 7             8 \n 8             9 \n 9            Error 2036\n 10           Error 2036\n</code></pre>\n\n<p>To translate your posted line of code:</p>\n\n<pre><code>hello = Application.Small(ActiveSheet.Evaluate(\"IF(A1:A10=0,FALSE,A1:A10)\"), n)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9660412, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iw0yCZYcWBk/AAAAAAAAAAI/AAAAAAAAACo/9sX8dCNIyHs/photo.jpg?sz=128", "display_name": "Camil Haroune", "link": "https://stackoverflow.com/users/9660412/camil-haroune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534372512, "creation_date": 1534343407, "last_edit_date": 1534346835, "question_id": 51860699, "link": "https://stackoverflow.com/questions/51860699/bypassing-formulaarray", "title": "Bypassing FormulaArray", "body": "<p>I would like to use an array formula (the ones you need to enter through Ctrl+Shift+Enter in worksheets) without using Range.FormulaArray.</p>\n\n<p>Do you think it is possible?\nThe formula I specifically want is:</p>\n\n<pre><code>    hello = WorksheetFunction.SMALL(WorksheetFunction.IF(MyRange&lt;&gt;0,MyRange),n)\n</code></pre>\n\n<p>Thank you all for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 2, "creation_date": 1534342123, "post_id": 51860158, "comment_id": 90672846, "body": "What line does the code show an error for when you stop and go to the debugger?"}, {"owner": {"reputation": 1, "user_id": 10229609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v6Uz0.jpg?s=128&g=1", "display_name": "BMNK", "link": "https://stackoverflow.com/users/10229609/bmnk"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1534345039, "post_id": 51860158, "comment_id": 90674590, "body": "&quot;ActiveSheet.Shapes(Range(&quot;actReg&quot;).Value).Select&quot; is highlighted in the Debugger.  Is there a good way to add/share the file or is that discouraged?"}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1534348057, "post_id": 51860158, "comment_id": 90676340, "body": "Perhaps <code>Range(&quot;actRegCode&quot;).Value</code> should be <code>Range(&quot;actRegCode&quot;).Address</code>"}, {"owner": {"reputation": 1, "user_id": 10229609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v6Uz0.jpg?s=128&g=1", "display_name": "BMNK", "link": "https://stackoverflow.com/users/10229609/bmnk"}, "edited": false, "score": 0, "creation_date": 1534356520, "post_id": 51860158, "comment_id": 90680410, "body": "Thanks - unfortunately changing to &quot;Range(&quot;actRegCode&quot;).Address&quot; yields the exact same result"}, {"owner": {"reputation": 1, "user_id": 10229609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v6Uz0.jpg?s=128&g=1", "display_name": "BMNK", "link": "https://stackoverflow.com/users/10229609/bmnk"}, "edited": false, "score": 0, "creation_date": 1534418607, "post_id": 51860158, "comment_id": 90703030, "body": "File is here if of benefit:  <a href=\"https://www.dropbox.com/s/0x703p1njz4pwdd/Run-time%20error%20%27-2147024809%20%2880070057%27%29.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/0x703p1njz4pwdd/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 10229609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v6Uz0.jpg?s=128&g=1", "display_name": "BMNK", "link": "https://stackoverflow.com/users/10229609/bmnk"}, "edited": false, "score": 0, "creation_date": 1534421420, "post_id": 51860158, "comment_id": 90704626, "body": "Issue solved - the shapes were named as numbers but because there are only 205 actual shapes, the &quot;name&quot; must be less than 205, hence 211 which is the first name after the limit is where the error occurs.  Fixed by renaming all the shapes to include verbiage...thanks for assistance"}], "owner": {"reputation": 1, "user_id": 10229609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v6Uz0.jpg?s=128&g=1", "display_name": "BMNK", "link": "https://stackoverflow.com/users/10229609/bmnk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 409, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594152714, "creation_date": 1534341517, "last_edit_date": 1594152714, "question_id": 51860158, "link": "https://stackoverflow.com/questions/51860158/excel-run-time-error-2147024809-80070057-the-index-into-the-specified-col", "title": "Excel - Run-time error &#39;-2147024809 (80070057&#39;) The index into the specified collection is out of bounds", "body": "<p>I have a macro that I have run successfully in Excel for the past two years but continue to get the following message on my latest project: </p>\n\n<blockquote>\n  <p>\"Run-time error '-2147024809 (80070057') The index into the specified collection is out of bounds\".  </p>\n</blockquote>\n\n<p>I am referencing more shapes than I have done in previous iterations (204 shapes in file) but not sure if that has anything to do with the issue.  The macro follows:  </p>\n\n<pre><code>Sub MapMacro()\n\n    For i = 5 To 207\n    Range(\"actReg\").Value = Range(\"A\" &amp; i).Value\n\n    If ActiveSheet.Name = \"Variables\" Then\n        Worksheets(\"Map\").Activate\n    End If\n\n    ActiveSheet.Shapes(Range(\"actReg\").Value).Select\n    Selection.ShapeRange.Fill.ForeColor.RGB = Range(Range(\"actRegCode\").Value).Interior.Color\n\n    If ActiveSheet.Name = \"Map\" Then\n        Worksheets(\"Variables\").Activate\n    End If\n\n    Next i\n\n    Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Any assistance is greatly appreciated!!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1534341282, "post_id": 51859967, "comment_id": 90672364, "body": "This code seems overly convoluted to just create 3 unique random numbers..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534341360, "post_id": 51859967, "comment_id": 90672406, "body": "Why not create a separate function that creates a random number, and simply assign as many variables to that as you want?  Also, you declare <code>RanBefore</code> then immediately do a logic test on it. Why? You can skip that part completely, and just do <code>ranBefore = True &#47;&#47; Randomize</code>, no?"}, {"owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "edited": false, "score": 0, "creation_date": 1534342169, "post_id": 51859967, "comment_id": 90672872, "body": "I am new to VBA, and this code is not what I am currently using, but it gives me a start for the &quot;unique value&quot; function. I edited my original post to show my code."}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1534342226, "last_edit_date": 1534342226, "creation_date": 1534341900, "answer_id": 51860270, "question_id": 51859967, "link": "https://stackoverflow.com/questions/51859967/excel-vba-generate-3-unique-random-numbers-between-range/51860270#51860270", "title": "Excel VBA - Generate 3 unique random numbers between range", "body": "<p>You can use the following function to generate a random number.</p>\n\n<pre><code>Function Random(Low&amp;, High&amp;) As Long\n   Randomize\n   Random = Int((High - Low + 1) * Rnd + Low)\nEnd Function\n</code></pre>\n\n<p>Then your issue as stated:</p>\n\n<blockquote>\n  <p><em>generate (3) unique random numbers, stored in X, Y, and Z variables</em></p>\n</blockquote>\n\n<p>Then you would assign your <code>x</code>, <code>y</code>, and <code>z</code> variables using the above function.</p>\n\n<pre><code>x = Random(1, 3)\ndo\n    y = Random(1, 3)\nloop Until y &lt;&gt; x\ndo\n    z = Random(1, 3)\nloop until z &lt;&gt; y and z &lt;&gt; x\n</code></pre>\n\n<p>I'm sure there's a more direct way to do this without using a loop, but this is a start.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "edited": false, "score": 0, "creation_date": 1534348675, "post_id": 51860393, "comment_id": 90676686, "body": "Thanks for the code, it works great! I have tried (unsuccessfully) to integrate that into the code in my original post. Would you be able to help me with that? Much appreciate the help!"}, {"owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "edited": false, "score": 0, "creation_date": 1534381189, "post_id": 51860393, "comment_id": 90688413, "body": "That code works great, thanks!!! I added the following code to color the cell if it has no fill, but now it only colors cells if none of them have color. Any idea what I am doing wrong? I appreciate all the help!     {If ActiveCell.Interior.Color = ActiveSheet.UsedRange.Interior.Color Then}"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "edited": false, "score": 0, "creation_date": 1534387715, "post_id": 51860393, "comment_id": 90689594, "body": "@sparkynerd <code>ActiveSheet.UsedRange</code> is referring to more cells than you&#39;re intending - I don&#39;t think that&#39;s what you want to us."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1534349220, "last_edit_date": 1534349220, "creation_date": 1534342369, "answer_id": 51860393, "question_id": 51859967, "link": "https://stackoverflow.com/questions/51859967/excel-vba-generate-3-unique-random-numbers-between-range/51860393#51860393", "title": "Excel VBA - Generate 3 unique random numbers between range", "body": "<p>This wasn't as simple as I thought it'd be, but here's code to store 3 (or up to however many you want based on the array size) unique numbers in an array:</p>\n\n<pre><code>Sub GetUniqueNumbers()\nDim myarr As Variant\nDim i As Long, j as long\nDim allset As Boolean\n\nReDim myarr(0 To 2) 'Change array size here\n\nFor i = 0 To UBound(myarr)\n    Do\n        myarr(i) = WorksheetFunction.RandBetween(0, 127) 'Change number range here\n        For j = 0 To UBound(myarr)\n            If i &lt;&gt; j Then\n                If myarr(i) = myarr(j) Then\n                    Exit For\n                Else\n                    If j = UBound(myarr) Then\n                        allset = True\n                    End If\n                End If\n            End If\n            If j = UBound(myarr) Then\n                allset = True\n            End If\n        Next j\n    Loop Until allset = True\n    allset = False\nNext i\n\nDebug.Print myarr(0)\nDebug.Print myarr(1)\nDebug.Print myarr(2)\nEnd Sub\n</code></pre>\n\n<p>Integrating it into your existing code:</p>\n\n<pre><code>Dim myarr As Variant\nSub FormatSuperProjectHeadings()\n\nDim r As Byte, g As Byte, b As Byte\nDim r2 As Byte, g2 As Byte, b2 As Byte\nDim spcolor As Integer\nDim vR(), n As Integer\n\n'Clear Cells\nn = 3000\nReDim vR(1 To n)\n\nFor i = 1 To n\n    Call GetUniqueNumbers\n\n    r = myarr(0)\n    g = myarr(1)\n    b = myarr(2)\n\n    r2 = r + 127\n    g2 = g + 127\n    b2 = b + 127\n    vR(i) = RGB(r2, g2, b2)\n\nNext i\n\nApplication.ScreenUpdating = False\n\nDim MyCell As Range\n\nWith Sheets(1) 'Projects Sheet\n    For Each MyCell In .Range(\"Y5:Y\" &amp; .Range(\"Y\" &amp; .Rows.Count).End(xlUp).Row)\n        If MyCell = \"Super Project\" Then\n            MyCell.EntireRow.Interior.Color = vR(WorksheetFunction.RandBetween(1, n))\n            MyCell.Offset(, -22).Font.Bold = True\n        End If\n    Next\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\nSub GetUniqueNumbers()\n\nDim i As Long, j As Long\nDim allset As Boolean\n\nReDim myarr(0 To 2) 'Change array size here\n\nFor i = 0 To UBound(myarr)\n    Do\n        myarr(i) = WorksheetFunction.RandBetween(0, 127) 'Change number range here\n        For j = 0 To UBound(myarr)\n            If i &lt;&gt; j Then\n                If myarr(i) = myarr(j) Then\n                    Exit For\n                Else\n                    If j = UBound(myarr) Then\n                        allset = True\n                    End If\n                End If\n            End If\n            If j = UBound(myarr) Then\n                allset = True\n            End If\n        Next j\n    Loop Until allset = True\n    allset = False\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1534343711, "last_edit_date": 1534343711, "creation_date": 1534343153, "answer_id": 51860619, "question_id": 51859967, "link": "https://stackoverflow.com/questions/51859967/excel-vba-generate-3-unique-random-numbers-between-range/51860619#51860619", "title": "Excel VBA - Generate 3 unique random numbers between range", "body": "<p>To generate unique numbers you need to check the actual generated number against all previously generated numbers.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Generate10Numbers()\n    Dim Numbers(1 To 10) As Long 'generate 10 numbers\n    UniqueRandomNumbersBetween Numbers, 10, 20 'between 10 and 20\n\n    'print all numbers\n    Dim No As Variant\n    For Each No In Numbers\n        Debug.Print No\n    Next No\nEnd Sub\n\nPublic Function UniqueRandomNumbersBetween(ByRef ReturnNumbers() As Long, LowerBound As Long, UpperBound As Long)\n    'check if there are enough numbers to generate them unique\n    If UBound(ReturnNumbers) - LBound(ReturnNumbers) &gt; UpperBound - LowerBound Then\n        MsgBox \"Number range is too small to generate unique numbers\"\n        Exit Function\n    End If\n\n    Dim RndNo As Long\n    Dim IsUnique As Boolean\n\n    Dim i As Long, j As Long\n    For i = LBound(ReturnNumbers) To UBound(ReturnNumbers)\n        Do\n            IsUnique = True 'init\n            RndNo = WorksheetFunction.RandBetween(LowerBound, UpperBound) 'generate a random number in boundaries\n            For j = LBound(ReturnNumbers) To i - 1 'check if it is unique\n                If ReturnNumbers(j) = RndNo Then\n                    IsUnique = False\n                    Exit For\n                End If\n            Next j\n        Loop While Not IsUnique 'loop until a unique number is found\n        ReturnNumbers(i) = RndNo 'save the unique number\n    Next i\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "edited": false, "score": 0, "creation_date": 1534376189, "post_id": 51863192, "comment_id": 90687396, "body": "I get Runtime error 9 with this code at the vR(I) = RGB(r2, g2, b2) line. Not sure what it doesn&#39;t like..."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "reply_to_user": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "edited": false, "score": 0, "creation_date": 1534413053, "post_id": 51863192, "comment_id": 90699789, "body": "Oops - it&#39;s because i is used twice for different loops: slight edit will fix it"}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1534413179, "last_edit_date": 1534413179, "creation_date": 1534352430, "answer_id": 51863192, "question_id": 51859967, "link": "https://stackoverflow.com/questions/51859967/excel-vba-generate-3-unique-random-numbers-between-range/51863192#51863192", "title": "Excel VBA - Generate 3 unique random numbers between range", "body": "<p>You usually use a dictionary object if you are looking to generate a unique array of objects. The following code will assign 3 unique values to 3 variables</p>\n\n<blockquote>\n  <p>Random function taken from answer by K.D\u1d00\u1d20\u026as</p>\n</blockquote>\n\n<pre><code>Sub GenerateUniqueValues()\n    Dim Dict As Object: Set Dict = CreateObject(\"Scripting.Dictionary\")\n    Dim i As Long, x As Long, y As Long, z As Long\n\n    Do Until Dict.Count = 3\n        With Dict\n            i = Random(0, 127)\n            If Not .Exists(i) Then .Add i, i\n        End With\n    Loop\n\n    x = Dict.keys()(0)\n    y = Dict.keys()(1)\n    z = Dict.keys()(2)\n    Debug.Print x, y, z\n\nEnd Sub\n\nFunction Random(Low&amp;, High&amp;) As Long\n   Randomize\n   Random = Int((High - Low + 1) * Rnd + Low)\nEnd Function\n</code></pre>\n\n<p><strong>* And Integrated *</strong></p>\n\n<pre><code>Sub FormatSuperProjectHeadings()\n\n    Dim Dict As Object: Set Dict = CreateObject(\"Scripting.Dictionary\")\n\n    Dim r As Byte, g As Byte, b As Byte\n    Dim r2 As Byte, g2 As Byte, b2 As Byte\n    Dim spcolor As Integer\n    Dim vR(), n As Integer\n    Dim i As Long, j As Long\n\n    'Clear Cells\n    n = 3000\n    ReDim vR(1 To n)\n    For i = 1 To n\n        Dict.RemoveAll\n        Do Until Dict.Count = 3\n            With Dict\n                j = Random(0, 127)\n                If Not .Exists(j) Then .Add j, j\n            End With\n        Loop\n        r = Dict.keys()(0)\n        g = Dict.keys()(1)\n        b = Dict.keys()(2)\n        r2 = r + 127\n        g2 = g + 127\n        b2 = b + 127\n        vR(i) = RGB(r2, g2, b2)\n    Next i\n\n    Application.ScreenUpdating = False\n    Dim MyCell As Range\n    With Sheets(1) 'Projects Sheet\n        For Each MyCell In .Range(\"Y5:Y\" &amp; .Range(\"Y\" &amp; .Rows.Count).End(xlUp).Row)\n            If MyCell = \"Super Project\" Then\n                MyCell.EntireRow.Interior.Color = vR(WorksheetFunction.RandBetween(1, n))\n                MyCell.Offset(, -22).Font.Bold = True\n            End If\n        Next\n    End With\n\n    Application.ScreenUpdating = True\nEnd Sub\n\nFunction Random(Low&amp;, High&amp;) As Long\n   Randomize\n   Random = Int((High - Low + 1) * Rnd + Low)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1534413179, "creation_date": 1534340802, "last_edit_date": 1534342109, "question_id": 51859967, "link": "https://stackoverflow.com/questions/51859967/excel-vba-generate-3-unique-random-numbers-between-range", "title": "Excel VBA - Generate 3 unique random numbers between range", "body": "<p>I found the following code and would like to make it generate (3) unique random numbers, stored in X, Y, and Z variables. Can someone help me modify this to add (2) more random numbers stored as variables, and also specify a range for these random numbers in the code?</p>\n\n<pre><code>Sub RandomizeArray(ArrayIn As Variant)\n  Dim X As Long, RandomIndex As Long, TempElement As Variant\n  Static RanBefore As Boolean\n  If Not RanBefore Then\n    RanBefore = True\n    Randomize\n  End If\n  If VarType(ArrayIn) &gt;= vbArray Then\n    For X = UBound(ArrayIn) To LBound(ArrayIn) Step -1\n      RandomIndex = Int((X - LBound(ArrayIn) + 1) * Rnd + LBound(ArrayIn))\n      TempElement = ArrayIn(RandomIndex)\n      ArrayIn(RandomIndex) = ArrayIn(X)\n      ArrayIn(X) = TempElement\n    Next\n  Else\n    'The passed argument was not an array, so put error handler here, such as . . .\n    Beep\n  End If\nEnd Sub \n</code></pre>\n\n<p>My original code which needs the random number to be unique:</p>\n\n<pre><code>Sub FormatSuperProjectHeadings()\n\n        Dim r As Byte, g As Byte, b As Byte\n        Dim r2 As Byte, g2 As Byte, b2 As Byte\n        Dim spcolor As Integer\n            Dim vR(), n As Integer\n\n     'Clear Cells\n            n = 3000\n            ReDim vR(1 To n)\n            For i = 1 To n\n                r = WorksheetFunction.RandBetween(0, 127)\n                g = WorksheetFunction.RandBetween(0, 127)\n                b = WorksheetFunction.RandBetween(0, 127)\n                r2 = r + 127\n                g2 = g + 127\n                b2 = b + 127\n                vR(i) = RGB(r2, g2, b2)\n            Next i\n\n            Application.ScreenUpdating = False\n                Dim MyCell As Range\n\n        With Sheets(1) 'Projects Sheet\n            For Each MyCell In .Range(\"Y5:Y\" &amp; .Range(\"Y\" &amp; .Rows.Count).End(xlUp).Row)\n                If MyCell = \"Super Project\" Then\n                    MyCell.EntireRow.Interior.Color = vR(WorksheetFunction.RandBetween(1, n))\n                    MyCell.Offset(, -22).Font.Bold = True\n                End If\n            Next\n        End With\n            Application.ScreenUpdating = True\n        End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534340842, "post_id": 51859913, "comment_id": 90672107, "body": "Seems likely related to the <code>Clean</code> function against the target cell text in Word."}, {"owner": {"reputation": 67, "user_id": 10145622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-21MJFo41zjc/AAAAAAAAAAI/AAAAAAAAABQ/3IgbRuiwc2s/photo.jpg?sz=128", "display_name": "Jane Alice", "link": "https://stackoverflow.com/users/10145622/jane-alice"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534340955, "post_id": 51859913, "comment_id": 90672185, "body": "So I did try deleting that out but it&#39;s really no different."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534341024, "post_id": 51859913, "comment_id": 90672218, "body": "Have you tried copying the table and pasting directly to Excel? There might be a way to do it like that, let me check..."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 10145622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-21MJFo41zjc/AAAAAAAAAAI/AAAAAAAAABQ/3IgbRuiwc2s/photo.jpg?sz=128", "display_name": "Jane Alice", "link": "https://stackoverflow.com/users/10145622/jane-alice"}, "edited": false, "score": 0, "creation_date": 1534344364, "post_id": 51860881, "comment_id": 90674200, "body": "Thanks again David. I just tried your edit and nothing pasted to excel at all. Also, I updated the post with some pictures to see if that would help."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 67, "user_id": 10145622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-21MJFo41zjc/AAAAAAAAAAI/AAAAAAAAABQ/3IgbRuiwc2s/photo.jpg?sz=128", "display_name": "Jane Alice", "link": "https://stackoverflow.com/users/10145622/jane-alice"}, "edited": false, "score": 0, "creation_date": 1534344450, "post_id": 51860881, "comment_id": 90674245, "body": "It doesn&#39;t seem possible that no data would transfer, you should debug using some breakpoints to see if the inner loop <code>For iCol</code> actually executes. I&#39;m not sure why it wouldn&#39;t, but this edit uses your entire solution with only modification to alter the text slightly."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 67, "user_id": 10145622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-21MJFo41zjc/AAAAAAAAAAI/AAAAAAAAABQ/3IgbRuiwc2s/photo.jpg?sz=128", "display_name": "Jane Alice", "link": "https://stackoverflow.com/users/10145622/jane-alice"}, "edited": false, "score": 0, "creation_date": 1534345060, "post_id": 51860881, "comment_id": 90674601, "body": "see revision, tested &amp; confirmed with screenshot output."}, {"owner": {"reputation": 67, "user_id": 10145622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-21MJFo41zjc/AAAAAAAAAAI/AAAAAAAAABQ/3IgbRuiwc2s/photo.jpg?sz=128", "display_name": "Jane Alice", "link": "https://stackoverflow.com/users/10145622/jane-alice"}, "edited": false, "score": 0, "creation_date": 1534345106, "post_id": 51860881, "comment_id": 90674629, "body": "got it. Just did that and the iCol inner loop executes without errors but there&#39;s no data being transferred over :/"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 67, "user_id": 10145622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-21MJFo41zjc/AAAAAAAAAAI/AAAAAAAAABQ/3IgbRuiwc2s/photo.jpg?sz=128", "display_name": "Jane Alice", "link": "https://stackoverflow.com/users/10145622/jane-alice"}, "edited": false, "score": 0, "creation_date": 1534345183, "post_id": 51860881, "comment_id": 90674679, "body": "That doesn&#39;t seem possible. If you examine the value of <code>thisText</code> in the Locals or immediate pane, what do you see? Put a <code>MsgBox Cells(resultRow, iCol)</code> just before the <code>Next iCol</code> also to confirm."}, {"owner": {"reputation": 67, "user_id": 10145622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-21MJFo41zjc/AAAAAAAAAAI/AAAAAAAAABQ/3IgbRuiwc2s/photo.jpg?sz=128", "display_name": "Jane Alice", "link": "https://stackoverflow.com/users/10145622/jane-alice"}, "edited": false, "score": 0, "creation_date": 1534345298, "post_id": 51860881, "comment_id": 90674736, "body": "David - I just tried the &quot;Actual Code That You Tested&quot; and it works!! Thank you sir!!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 67, "user_id": 10145622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-21MJFo41zjc/AAAAAAAAAAI/AAAAAAAAABQ/3IgbRuiwc2s/photo.jpg?sz=128", "display_name": "Jane Alice", "link": "https://stackoverflow.com/users/10145622/jane-alice"}, "edited": false, "score": 0, "creation_date": 1534345351, "post_id": 51860881, "comment_id": 90674771, "body": "OK perfect. I might&#39;ve mistyped or maybe you mistyped something when transferring the other code to your function, but if the test code is working, then it&#39;s just a matter of adapting that to your solution. Cheers."}, {"owner": {"reputation": 67, "user_id": 10145622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-21MJFo41zjc/AAAAAAAAAAI/AAAAAAAAABQ/3IgbRuiwc2s/photo.jpg?sz=128", "display_name": "Jane Alice", "link": "https://stackoverflow.com/users/10145622/jane-alice"}, "edited": false, "score": 0, "creation_date": 1534345786, "post_id": 51860881, "comment_id": 90675047, "body": "I just want to thank you again. I cannot thank you enough sir. Have a blessed day!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1534344948, "last_edit_date": 1534344948, "creation_date": 1534343999, "answer_id": 51860881, "question_id": 51859913, "link": "https://stackoverflow.com/questions/51859913/copy-paste-tables-from-word-with-multi-line-cells/51860881#51860881", "title": "Copy paste tables from word with multi-line cells", "body": "<p>I've found this solution which still requires the cell-wise iteration (unfortunately the line breaks are treated as cell delimiters when Pasting directly to Excel using <code>Paste</code>, <code>PasteSpecial</code> or several of the <code>CommandBars.ExecuteMso</code> options.</p>\n\n<p>Try replacing the Ascii 13 character with a <code>vbCrLf</code> (carriage return + line feed) and also replacing Ascii 7 with an empty string:</p>\n\n<pre><code>Dim thisText as String, newText as String\nFor tableStart = 1 To tableTot\n    With .Tables(tableStart)\n        'copy cell contents from Word table cells to Excel cells\n        For iRow = 1 To .Rows.Count\n            For iCol = 1 To .Columns.Count\n                thisText = .Cell(iRow, iCol).Range.Text\n                newText = Replace(thisText, Chr(13), vbCrLf)\n                newText = Replace(newText, Chr(7), vbNullString)\n                Cells(resultRow, iCol) = WorksheetFunction.Clean(newText)\n            Next iCol\n            resultRow = resultRow + 1\n        Next iRow\n    End With\n    resultRow = resultRow + 1\nNext tableStart\n</code></pre>\n\n<p>There may be a more elegant way to do this without looping row/column, but for now this should work.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nPYFN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nPYFN.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>Actual code that I tested</em></p>\n\n<pre><code>Sub foo2()\nDim wdApp As Object, wdDoc As Object, wdTable As Object\nSet wdApp = GetObject(, \"Word.Application\")\nSet wdDoc = wdApp.Documents(1)\nSet wdTable = wdDoc.Tables(1)\nDim iRow As Long, iCol As Long, resultRow As Long\nDim thisText As String, newText As String\nresultRow = 1\n\nWith wdTable\n    For iRow = 1 To .Rows.Count\n        For iCol = 1 To .Columns.Count\n            thisText = .Cell(iRow, iCol).Range.Text\n            newText = Replace(thisText, Chr(13), vbCrLf)\n            newText = Replace(newText, Chr(7), vbNullString)\n            Cells(resultRow, iCol) = newText\n        Next iCol\n        resultRow = resultRow + 1\n    Next iRow\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10145622, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-21MJFo41zjc/AAAAAAAAAAI/AAAAAAAAABQ/3IgbRuiwc2s/photo.jpg?sz=128", "display_name": "Jane Alice", "link": "https://stackoverflow.com/users/10145622/jane-alice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "accepted_answer_id": 51860881, "answer_count": 1, "score": 2, "last_activity_date": 1534344948, "creation_date": 1534340593, "last_edit_date": 1534344054, "question_id": 51859913, "link": "https://stackoverflow.com/questions/51859913/copy-paste-tables-from-word-with-multi-line-cells", "title": "Copy paste tables from word with multi-line cells", "body": "<p>I have a word document that contains a number of tables. I've written a script to retrieve the tables starting at a specified table number i.e. table 1, 2, 3, or 4 and so on (user selects). The script then pulls the tables into an excel workbook. The problem I am having is that all of the tables have 4 columns. The 3rd column has content in it which contains multiple lines so when it pastes to excel, it looks bad. I understand that if you copy the 3rd column of any table, double click in a cell in excel and paste, it'll paste in the line breaks so it looks ok. Was wondering if there was a way to do this in vba.</p>\n\n<p>Here is my table that I want to copy into Excel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/k7gj2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k7gj2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is what it looks like it when the script pastes it in:</p>\n\n<p><a href=\"https://i.stack.imgur.com/v8s4h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v8s4h.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is what I needed it to look like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aI500.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aI500.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n\nDim wdDoc As Object\nDim wdFileName As Variant\nDim tableNo As Integer 'table number in Word\nDim iRow As Long 'row index in Excel\nDim iCol As Integer 'column index in Excel\nDim resultRow As Long\nDim tableStart As Integer\nDim tableTot As Integer\n\nOn Error Resume Next\n\nActiveSheet.Range(\"A:AZ\").ClearContents\n\nwdFileName = Application.GetOpenFilename(\"Word files (*.docx),*.docx\", , _\n\"Browse for file containing table(s) to be imported\")\n\nIf wdFileName = False Then Exit Sub '(user cancelled import file browser)\n\nSet wdDoc = GetObject(wdFileName) 'open Word file\n\nWith wdDoc\n    tableNo = wdDoc.Tables.Count\n    tableTot = wdDoc.Tables.Count\n    If tableNo = 0 Then\n        MsgBox \"This document contains no tables\", _\n        vbExclamation, \"Import Word Table\"\n    ElseIf tableNo &gt; 1 Then\n        tableNo = InputBox(\"This Word document contains \" &amp; tableNo &amp; \" tables.\" &amp; vbCrLf &amp; _\n        \"Enter the table to start from\", \"Import Word Table\", \"1\")\n    End If\n\n    resultRow = 1\n\n    For tableStart = 1 To tableTot\n        With .Tables(tableStart)\n            'copy cell contents from Word table cells to Excel cells\n            For iRow = 1 To .Rows.Count\n                For iCol = 1 To .Columns.Count\n                    Cells(resultRow, iCol) = WorksheetFunction.Clean(.Cell(iRow, iCol).Range.Text)\n                Next iCol\n                resultRow = resultRow + 1\n            Next iRow\n        End With\n        resultRow = resultRow + 1\n    Next tableStart\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "tree"], "comments": [{"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1534342262, "post_id": 51859897, "comment_id": 90672920, "body": "<a href=\"https://stackoverflow.com/questions/9821545/how-to-build-parent-child-data-table-in-excel\" title=\"how to build parent child data table in excel\">stackoverflow.com/questions/9821545/&hellip;</a> should be of some interest"}, {"owner": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "reply_to_user": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1534342796, "post_id": 51859897, "comment_id": 90673239, "body": "@PankajJaju, it is an interesting solution, however it is dependent on sorting. Order is not a criteria of my problem, the issue inherently is associating one or multiple children with 1 parent - ideally using the VBA dictionary, which I&#39;m not sure how to implement."}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1534342944, "post_id": 51859897, "comment_id": 90673327, "body": "Sorting should be easy in Excel. You can either do it manually using Excel&#39; Sort feature or you can record a macro of it. For example, you can sort it based on ParentID and then by ItemID/Name."}, {"owner": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "reply_to_user": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1534343843, "post_id": 51859897, "comment_id": 90673889, "body": "I think you misunderstood my comment, I don&#39;t believe sorting could be useful here. I updated my post with the theory, I was thinking that perhaps recursion could be useful but I&#39;m not sure if that is beneficial."}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1534343952, "post_id": 51859897, "comment_id": 90673954, "body": "How are you going to identify the root in this case? Based on itemID or if the text is Root?"}, {"owner": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "reply_to_user": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1534344127, "post_id": 51859897, "comment_id": 90674068, "body": "I believe for consistency, it would be better to identify everything by ID&#39;s, so by itemID."}], "answers": [{"comments": [{"owner": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "edited": false, "score": 0, "creation_date": 1534350707, "post_id": 51862291, "comment_id": 90677736, "body": "This is really useful... would you mind including a couple comments so I can understand what&#39;s going on? I&#39;m a little lost trying to understand this."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "edited": false, "score": 0, "creation_date": 1534365276, "post_id": 51862291, "comment_id": 90684250, "body": "You can create a helper sheet, copy/paste columns 9 &amp; 11 into columns 1 &amp; 2, and it will work fine.  Or, feel free to adjust the script that I posted.  Basically, Cells(1, 1), translates to Cells(Row, Column).  So, Cells(1, 1), is equal to Cell A1."}, {"owner": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "edited": false, "score": 0, "creation_date": 1534372990, "post_id": 51862291, "comment_id": 90686707, "body": "I see. Rather than growing the children horizontally, if I wanted to match the cell-formatting in the table in the post, how would I do so? The end goal is that format, and it&#39;s not efficient to create a sheet as an intermediary process to achieve that to the best of my knowledge, if there is a simple way to do so."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 3, "last_activity_date": 1534349015, "creation_date": 1534349015, "answer_id": 51862291, "question_id": 51859897, "link": "https://stackoverflow.com/questions/51859897/generating-a-tree-like-structure-using-parent-child-ids-with-vba/51862291#51862291", "title": "generating a tree like structure using parent-child ID&#39;s with VBA", "body": "<p>It's a little hard for me to understand exactly what you want, but I think it should be done like this.</p>\n\n<pre><code>Sub newlist()\nSet w1 = Sheets(\"Sheet1\")\nSet w2 = Sheets(\"Sheet2\")\nw2.Cells(1, 1).Value = w1.Cells(1, 1).Value\nw2.Cells(1, 2).Value = w1.Cells(1, 2).Value\nIde = Cells(1, 1).Value\nw1.Activate\nn = Cells(Rows.Count, 1).End(xlUp).Row\nk = 3\nkk = 1\nFor i = 2 To n\nIf w1.Cells(i, 1).Value = Ide Then\nw2.Cells(kk, k).Value = w1.Cells(i, 2).Value\nk = k + 1\nElse\nkk = kk + 1\nk = 3\nIde = w1.Cells(i, 1).Value\nw2.Cells(kk, 1).Value = Ide\nw2.Cells(kk, 2).Value = w1.Cells(i, 2).Value\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wE3Sx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wE3Sx.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LMj5w.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LMj5w.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1534379252, "creation_date": 1534379252, "answer_id": 51868103, "question_id": 51859897, "link": "https://stackoverflow.com/questions/51859897/generating-a-tree-like-structure-using-parent-child-ids-with-vba/51868103#51868103", "title": "generating a tree like structure using parent-child ID&#39;s with VBA", "body": "<p>Ok, I made a small tweak to the original code.  Try this and see how you get along.</p>\n\n<pre><code>Sub newlist()\nSet w1 = Sheets(\"Sheet1\")\nSet w2 = Sheets(\"Sheet2\")\nw2.Cells(1, 1).Value = w1.Cells(1, 1).Value\nw2.Cells(1, 2).Value = w1.Cells(1, 2).Value\nIde = Cells(1, 1).Value\nw1.Activate\nn = Cells(Rows.Count, 1).End(xlUp).Row\nk = 3\nkk = 1\nFor i = 2 To n\nIf w1.Cells(i, 1).Value = Ide Then\nw2.Cells(kk + 1, 2).Value = w1.Cells(i, 2).Value\nkk = kk + 1\nk = k + 1\nElse\nkk = kk + 1\nk = 3\nIde = w1.Cells(i, 1).Value\nw2.Cells(kk, 1).Value = Ide\nw2.Cells(kk, 2).Value = w1.Cells(i, 2).Value\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ya1B5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ya1B5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZYu5V.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZYu5V.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2475, "favorite_count": 0, "accepted_answer_id": 51862291, "answer_count": 2, "score": 0, "last_activity_date": 1534379252, "creation_date": 1534340547, "last_edit_date": 1534343678, "question_id": 51859897, "link": "https://stackoverflow.com/questions/51859897/generating-a-tree-like-structure-using-parent-child-ids-with-vba", "title": "generating a tree like structure using parent-child ID&#39;s with VBA", "body": "<p>I have the following four columns, where I need to iterate over 'item':</p>\n\n<pre><code>parentID    parent  itemID  item\n398735  Papa    398713  Alpha\n398735  Papa    399270  Bravo\n398735  Papa    399822  Charlie\n398731  Lima    398732  Delta\n398731  Lima    398733  Echo\n398733  Echo    66359   Foxtrot\n398733  Echo    66360   Golf\n398733  Echo    66361   Hotel\n398733  Echo    66362   India\n398733  Echo    66363   Juliett\n398733  Echo    66364   Kilo\n398730  Root    66281   Mike\n398730  Root    66283   November\n398730  Root    398731  Lima\n398730  Root    398734  Oscar\n398734  Oscar   398735  Papa\n398734  Oscar   66281   Quebec\n</code></pre>\n\n<p>I want to generate a dynamic hierarchy (tree-like structure), like so:</p>\n\n<pre><code>Mike\nNovember\nLima\n    Delta\n    Echo\n        Foxtrot\n        Golf\n        Hotel\n        India\n        Juliett\n        Kilo\nOscar\n    Papa\n        Alpha\n        Bravo\n        Charlie\n    Quebec\n</code></pre>\n\n<p>If this was in Python for example, it would be extremely easy to create a hierarchy by iterating over my items, looking to see if its a parent (root if not), and using a dictionary to store all this information, then build this structure on an  excel sheet by iterating over the dictionary. However, for the purposes of this Macro I have no idea how to even do a simple column lookup, let alone use a dictionary. </p>\n\n<p>My theory is to:</p>\n\n<blockquote>\n  <p>1) Begin by somehow iterating over the four \"roots\", and store them as keys with null values in dict1.</p>\n  \n  <p>2) For each root, update it's value in dict1 to be an array of immediate children.</p>\n  \n  <p>3) Then, for each child of each root, create another dictionary (dict2) where all keys are all the root-children.</p>\n  \n  <p>4) Iterate over dict2 keys and set each key value to an array of children.</p>\n  \n  <p>5) Iterate over dict1, write everything, reference dict2 as you go for further children.</p>\n</blockquote>\n\n<p>Can this be implemented in VBA elegantly?</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1534341735, "post_id": 51859830, "comment_id": 90672623, "body": "Perhaps read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> - not sure I follow what you&#39;re doing. A screenshot might help too."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10229146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e83f3a24c5b4aed9a21b8c82123830?s=128&d=identicon&r=PG&f=1", "display_name": "joopert", "link": "https://stackoverflow.com/users/10229146/joopert"}, "is_accepted": false, "score": 1, "last_activity_date": 1534342829, "creation_date": 1534342829, "answer_id": 51860526, "question_id": 51859830, "link": "https://stackoverflow.com/questions/51859830/how-to-create-a-loop-to-read-a-range-of-cells-and-determine-which-have-values-an/51860526#51860526", "title": "How to create a loop to read a range of cells and determine which have values and what is to the right of each", "body": "<p>After reading your explanation, which was quite challenging I tried to recreate what you are asking.\nI used cells A1:L1 with numbers 1 to 12. in the row below that A2:L2, some numbers have been added. with an <code>if value &lt;&gt; \"\"</code> you can see which cells contain a value.\nIn the second worksheet the table is made:</p>\n\n<pre><code>Sub test()\nDim a As Integer\nDim i As Integer\nDim name As String\n\nActiveWorkbook.Sheets(1).Activate\na = 1\n\nFor i = 1 To endcel\n    If Sheets(1).Range(\"a1\").Offset(a, i - 1).Value &lt;&gt; \"\" Then\n       name = Sheets(1).Range(\"A1\").Offset(a, i - 1).Value\n       Sheets(2).Activate\n       Sheets(2).Range(\"b2\").Offset(i).Value = name\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>Does this help? You can adapt it a bit to your problem.\nGood luck!</p>\n"}], "owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534528865, "creation_date": 1534340285, "last_edit_date": 1534528865, "question_id": 51859830, "link": "https://stackoverflow.com/questions/51859830/how-to-create-a-loop-to-read-a-range-of-cells-and-determine-which-have-values-an", "title": "How to create a loop to read a range of cells and determine which have values and what is to the right of each", "body": "<p>I'm trying to have a program that can read a range of cells which consist of 12 cells (let's say: P79, R79, T79, V79, X79, Z79, AB79, AD79, AF79, AH79, AJ79, AL79) and under those cells there are 6 cells (let's say: V81, X81, Z81, AB81, AD81, AF81), the program is looking for whether or not there are values typed in the cells within the described range. </p>\n\n<p>The program should be able to read the cells from left to right on the top row and loop down to the bottom row and read that from right to left. </p>\n\n<p>If all the cells in the top row have values in them, then the program breaks and doesn't read the values in the bottom row. </p>\n\n<p>As the program reads the values from each cell it should create a table consisting of three columns (let's say: M88, N88, O88), the leftmost column should have the cell number (in order of cell as read by the program (whichever cell has a value first in the loop is given the number 1 and then the next cell to have a value is given number 2 etc.). The middle column should have whatever value is written in it's corresponding cell read from the range. The right column should have the value of whatever is to the right of each cell containing a value.</p>\n\n<p>The first value to be read with a value should give the value \"Left End\" and the last value to read (whether or not it is the 12th cell to have a value in the top row or the leftmost cell to have a value in the bottom row) should give the value \"Right end\".</p>\n\n<p>An example of what a row from the table could look like:</p>\n\n<pre><code>Cell #   Cell Value   Position/Left/Right\n\n 1         First            Left End\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/CTFtp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CTFtp.png\" alt=\"Example of Layout\"></a></p>\n\n<p>This is the code I have so far:</p>\n\n<pre><code>Sub Code()\n    Dim wb As Workbook: Set wb = ThisWorkbook\n    Dim ws As Worksheet: Set ws = wb.Sheets(\"Sheet1\")\n    Dim i As Integer, j As Integer, k As Integer\n\n' First loop to compare a car to the rest after it\n    For i = 1 To 12\n        For j = i + 1 To 12\n        If Not IsEmpty(ws.Range(\"Cell_\" &amp; i)) And Not IsEmpty(ws.Range(\"Cell_\" &amp; j)) Then\n                ws.Range(\"B82\").Offset(i).Value = j\n                Exit For\n            End If\n        Next j\n    Next i\n\n' Loop backwards to find \"Right End\"\n\nFor k = 12 To 2 Step -1 '24 To 2\n        If Not IsEmpty(ws.Range(\"Cell_12\")) Then\n        ws.Range(\"B82\").Offset(12).Value = \"Right End\"\n        Exit For\n\n\n' Has the \"Right End\" Follow when cars are left blank for lower row\n\n    ElseIf IsEmpty(ws.Range(\"Cell_\" &amp; k)) And Not IsEmpty(ws.Range(\"Cell_\" &amp; k - 1)) Then\n        ws.Range(\"B82\").Offset(k - 1).Value = \"Right End\"\n        Exit For\n\n\n        End If\nNext k\n</code></pre>\n\n<p>What I have here merely inserts a count into a cell range, what I'm trying to do is have my code actually read the cells in the range in the order I described and one at a time look at which cells have values written in them and look at which cells (with values in them) are to the right of any cell with a value and produce the table described above.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1534453179, "post_id": 51859797, "comment_id": 90722044, "body": "Is there a reason for looping through the records instead of executing just three <code>UPDATE</code> queries, eventually one DDL or a make table query and  an <code>INSERT</code> query?"}, {"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "reply_to_user": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1534513232, "post_id": 51859797, "comment_id": 90744168, "body": "The status of the .WithBracket field determines which fields in the table [Caliper Master] need to be updated.  While I&#39;m sure it&#39;s possible to work this into the SQL, my general level of proficiency before taking on this project was &quot;Customize minecraft and Skyrim mod .ini files&quot;, and I kinda got thrown at &quot;Here&#39;s MS Access, build an inventory system for the company and automate our office processes.&quot;  I&#39;m figuring this out as I go through online research and books."}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1534517717, "post_id": 51859797, "comment_id": 90746996, "body": "Sounds like a great start of a wonderful career! :) I&#39;m wondering if it is important to loop through the records of the form instead of using the forms recordsource directly (what&#39;s the table/query name and coumn names?). Can the form be filtered by the user? Another question: What is the intention of <code>ElseIf Me.WithBracket &lt;&gt; -1 Or 0 Or Null</code>? This expression for sure does not what you want."}, {"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "reply_to_user": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1534534024, "post_id": 51859797, "comment_id": 90754616, "body": ".WithBracket is a field that carries a variant for a triple-state check box to determine if an individual part has another part with it, doesn&#39;t have the other part with it, or is solely ordering the extra part.  These quantities are stored in the [Caliper Master] table individually, and split/combined as necessary through code. That line is there basically to make sure no other values get passed through.  Although I suppose a simple &quot;Else&quot; would work, wouldn&#39;t it?"}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1534535002, "post_id": 51859797, "comment_id": 90754971, "body": "If <i>WithBracket</i> is a triple-state ComboBox, there can only be three cases\u2026 remove the fourth one completely and change the third one to a simple <code>Else</code>, because comparing with <code>Null</code> won&#39;t work with the <i>equal</i> comparison operator. What about my question about using the forms RecordSource table/query instead of the RecordsetClone?"}, {"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "reply_to_user": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1534535231, "post_id": 51859797, "comment_id": 90755063, "body": "Frankly, I just learned looping using recordsetclone, so I went with what worked before.  If there&#39;s a better way I&#39;m all ears."}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1534535385, "post_id": 51859797, "comment_id": 90755113, "body": "Oops, of course I meant <i>Checkbox</i>. Well, then we are already two that are all ears, although for different reasons."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 0, "creation_date": 1534341511, "post_id": 51859848, "comment_id": 90672500, "body": "This results in a compile error, method or data member not found on rs.QuantityHv.  I have the proper references for DAO methods, and the rs contains the field."}, {"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 0, "creation_date": 1534341975, "post_id": 51859848, "comment_id": 90672761, "body": "Got it.  Had to use ! rather than . in rs!QuantityHv.  Thanks!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 3, "last_activity_date": 1534340897, "last_edit_date": 1534340897, "creation_date": 1534340389, "answer_id": 51859848, "question_id": 51859797, "link": "https://stackoverflow.com/questions/51859797/vba-do-loop-repeats-same-record/51859848#51859848", "title": "VBA Do loop repeats same record", "body": "<p>You loop a recordset <code>rs</code>, but you use form data like <code>Me.QuantityHv</code> when creating your sql strings. </p>\n\n<p>This will always use the data from the current record on the form, i.e. the same value for every loop iteration.</p>\n\n<p>Use values from <code>rs</code> instead, e.g. <code>rs!QuantityHv</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534540307, "creation_date": 1534340147, "last_edit_date": 1534340472, "question_id": 51859797, "link": "https://stackoverflow.com/questions/51859797/vba-do-loop-repeats-same-record", "title": "VBA Do loop repeats same record", "body": "<p>So my problem this time is that my do loop doesn't seem to be progressing through the recordset, instead using the same criteria for every SQL event in the loop.  I want it to cycle through the rs for the form, using the criteria from each record to determine the match on a separate table and adjust values there accordingly.</p>\n\n<p>Immediate window when running the loop on test data looks like this...</p>\n\n<pre><code>    UPDATE [Caliper Master] SET [Bid] = [Bid] - 281, [Sold] = [Sold] + 281 WHERE [A1CardoneItemNo] = '16-4021A';\n    UPDATE [Caliper Master] SET [Bid] = [Bid] - 281, [Sold] = [Sold] + 281 WHERE [A1CardoneItemNo] = '16-4021A';\n    UPDATE [Caliper Master] SET [Bid] = [Bid] - 281, [Sold] = [Sold] + 281 WHERE [A1CardoneItemNo] = '16-4021A';\n    UPDATE [Caliper Master] SET [Bid] = [Bid] - 281, [Sold] = [Sold] + 281 WHERE [A1CardoneItemNo] = '16-4021A';\n    UPDATE [Caliper Master] SET [Bid] = [Bid] - 281, [Sold] = [Sold] + 281 WHERE [A1CardoneItemNo] = '16-4021A';\n</code></pre>\n\n<p>Both the numerical values and the '16-4021A' at the end should be changing every record.</p>\n\n<p>Here's my code.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>   Private Sub btnConfirm_Click()\n\n   Dim db As DAO.Database\n   Dim rs As DAO.Recordset\n   Dim strSQL As String\n\n   On Error GoTo EH\n\n    If Me.Dirty Then Me.Dirty = False\n    If MsgBox(\"All records have been saved.  Do you wish to exit?/ Todos los registros han sido guardados. \u00bfDeseas salir?\", vbYesNo) = vbYes Then\n\n   Set db = CurrentDb\n   Set rs = Me.RecordsetClone\n\nDoCmd.DeleteObject acTable, \"tblCalOrderShorts\"\nrs.MoveFirst\nDo Until rs.EOF\n    If Me.QuantityHv &lt;&gt; 0 Then\n        If Me.WithBracket = -1 Then\n            strSQL = \"UPDATE [Caliper Master] SET [Bid] = [Bid] - \" &amp; Me.QuantityHv &amp; \", [Sold] = [Sold] + \" &amp; Me.QuantityHv &amp; \" WHERE [A1CardoneItemNo] = '\" &amp; Me.Cardone &amp; \"';\"\n            Debug.Print strSQL\n            db.Execute strSQL, dbFailOnError\n        ElseIf Me.WithBracket = 0 Then\n            strSQL = \"UPDATE [Caliper Master] SET [WOBracketBid] = [WOBracketBid] - \" &amp; Me.QuantityHv &amp; \", [WOBracketSold] = [WOBracketSold] + \" &amp; Me.QuantityHv &amp; \" WHERE [A1CardoneItemNo] = '\" &amp; Me.Cardone &amp; \"';\"\n            Debug.Print strSQL\n            db.Execute strSQL, dbFailOnError\n        ElseIf Me.WithBracket = Null Then\n            strSQL = \"UPDATE [Caliper Master] SET [BracketBid] = [BracketBid] - \" &amp; Me.QuantityHv &amp; \", [BracketSold] = [BracketSold] + \" &amp; Me.QuantityHv &amp; \" WHERE [A1CardoneItemNo] = '\" &amp; Me.Cardone &amp; \"';\"\n            Debug.Print strSQL\n            db.Execute strSQL, dbFailOnError\n        ElseIf Me.WithBracket &lt;&gt; -1 Or 0 Or Null Then\n            MsgBox \"Invalid value for bracket status./ No esta correcto el estado por bracket.\"\n            Exit Sub\n        End If\n    ElseIf Me.QuantityHv = 0 Then\n    End If\n    If Me.QuantityHv &lt; Me.QuantityNd Then\n        If Not IsNull(DLookup(\"tblCalOrderShorts\", \"MSysObjects\", \"Name = 'tblCalOrderShorts'\")) Then\n            db.Execute \"CREATE TABLE tblCalOrderShorts(Cardone CHAR, QuantityNd INTEGER, QuantityHv INTEGER, Short INTEGER) \"\n        End If\n        strSQL = \"INSERT INTO tblCalOrderShorts(Cardone, QuantityNd, QuantityHv, Short) VALUES('\" &amp; Me.Cardone &amp; \"', \" &amp; Me.QuantityNd &amp; \", \" &amp; Me.QuantityHv &amp; \", \" &amp; Me.QuantityNd - Me.QuantityHv &amp; \");\"\n        Debug.Print strSQL\n        db.Execute strSQL, dbFailOnError\n    End If\n    rs.MoveNext\nLoop\nDoCmd.RunCommand acCmdSaveRecord\nDoCmd.OpenForm \"subCaliperOrderDetails\", , , \"[Cardone] =\" &amp; Me!subCaliperOrderDetails.Form!Cardone, , acDialog\nForms!subCaliperOrderDetails.Form.Requery\nDoCmd.Close acForm, \"frmCaliperPack\"\n   Else\n   Exit Sub\n   End If\n\n   EH:\n   Select Case Err\n       Case 3376\n            Resume Next\n       Case 7874\n            Resume Next\n       Case 2465\n            Resume Next\n       Case Else\n           MsgBox \"Run Time Error \" &amp; Err.Number &amp; \", \" &amp; Err.DESCRIPTION\n   End Select\n\n   End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 10229518, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215811789543112/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/10229518/nick"}, "edited": false, "score": 0, "creation_date": 1534340277, "post_id": 51859778, "comment_id": 90671790, "body": "I&#39;m looking at my post and the code didn&#39;t come out right.  Sorry!  I think I must need a space between comment lines beginning with &#39; and lines that actually contain code.  This was my first post and next time I will be aware of this issue and try to avoid it."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1534340583, "post_id": 51859778, "comment_id": 90671972, "body": "Remove the quotes around VPName <code>If Cells(i, 13).Value &lt;&gt; VPName Then</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1534340759, "post_id": 51859778, "comment_id": 90672059, "body": "At present the code is looking for the actual text &quot;VPName&quot; but you mean it to represent the text entered in the input box."}], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "is_accepted": false, "score": 0, "last_activity_date": 1534430789, "last_edit_date": 1534430789, "creation_date": 1534342716, "answer_id": 51860490, "question_id": 51859778, "link": "https://stackoverflow.com/questions/51859778/excel-vba-code-issue-goal-to-delete-or-clear-entire-rows-for-which-specific/51860490#51860490", "title": "Excel VBA - Code Issue - Goal to Delete or Clear Entire Rows for which Specific Cell doesn&#39;t Certain Text", "body": "<p>Below is some code I have used in the past to do what you have described above.  Hope this helps.</p>\n\n<pre><code>Sub Delete_Row_If_Not_IT()\n'Macro deletes entire row if \"IT\" is not found in column \"E\"\n\n    Dim RowToTest As Long\n    Application.ScreenUpdating = False      'turn off screen updating. Code runs faster without screen flicker\n    Application.Calculation = xlManual      'turn auto calc to manual\n\n    'Column Count 5 = \"E\"\n    For RowToTest = Cells(Rows.Count, 5).End(xlUp).Row To 2 Step -1\n\n    'Saves listed \"IT\" entities and deletes the rest.\n    'Column Count 5 = \"E\"\n    With Cells(RowToTest, 5)\n        If .Value &lt;&gt; \"IT\" Then               'maybe use wildcard char \"*\" before and after search word.\n        Rows(RowToTest).EntireRow.Delete\n        End IF \n    End With\n\n    Next RowToTest\n\n    Application.Calculation = xlAutomatic    'turns auto calc back on\n    Application.ScreenUpdating = True        'turn on screen updating\n\n    End Sub\n</code></pre>\n\n<p>You can probably utilize an InputBox to replace the anti-search variable.</p>\n"}], "owner": {"reputation": 11, "user_id": 10229518, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215811789543112/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/10229518/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594151325, "creation_date": 1534340088, "last_edit_date": 1594151325, "question_id": 51859778, "link": "https://stackoverflow.com/questions/51859778/excel-vba-code-issue-goal-to-delete-or-clear-entire-rows-for-which-specific", "title": "Excel VBA - Code Issue - Goal to Delete or Clear Entire Rows for which Specific Cell doesn&#39;t Certain Text", "body": "<p>I am trying to write a macro that will go through my spreadsheet and clear or delete each row for which a specific cell in that row doesn't contain certain text.  Here is my code. </p>\n\n<pre><code>Sub BIWeekly_VP_Removal()\n\nDim BI_Erow As Long\nDim VPName As String\nDim i As Integer\n\n\n'Find and store last row\nBI_Erow = Cells(Rows.Count, 1).End(xlUp).Row\n\n'Store VP to not delete\nVPName = InputBox(\"VP to Keep\")\n\n'Loop through and clear all rows not containing target VP\nFor i = 2 To BI_Erow\n\n    If Cells(i, 13).Value &lt;&gt; \"VPName\" Then\n\n        ActiveSheet.Rows(i).EntireRow.Clear\n\n    End If\n\nNext i\n\n'set new last row of range\nBI_Erow = Cells(Rows.Count, 1).End(xlUp).Row\n\n'Select new range and sort\nRows(\"2:\" &amp; BI_Erow).Select\n\nEnd Sub\n</code></pre>\n\n<p>Currently, when run this code clears every line of this range, even when the identified cell contains the name that has been input.  I am guessing I am doing something obviously wrong but I am stuck.</p>\n\n<p>I am new to coding and am trying to teach myself.  I know I am doing something wrong and any constructive feedback the community may have would be greatly appreciated!</p>\n\n<p>Thank You</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 5, "creation_date": 1534338184, "post_id": 51859228, "comment_id": 90670576, "body": "use <code>Dim arr As variant</code> and <code>arr=Split(&quot;xxx_YYYY_zzz&quot;,&quot;_&quot;)</code> and then loop through <code>arr</code> elements and count their length with <code>Len()</code> function"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1534338201, "post_id": 51859228, "comment_id": 90670583, "body": "What have you tried and what didn&#39;t work?"}, {"owner": {"reputation": 81, "user_id": 9891975, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "vib500", "link": "https://stackoverflow.com/users/9891975/vib500"}, "edited": false, "score": 0, "creation_date": 1534338560, "post_id": 51859228, "comment_id": 90670800, "body": "Thank you DIsplayName, exactly what i was looking for. NEver heard about split befoe, very useful"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1534338583, "post_id": 51859228, "comment_id": 90670822, "body": "you are welcome"}], "owner": {"reputation": 81, "user_id": 9891975, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "vib500", "link": "https://stackoverflow.com/users/9891975/vib500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534338037, "creation_date": 1534338037, "question_id": 51859228, "link": "https://stackoverflow.com/questions/51859228/how-to-count-number-of-char-between-specific-characters-with-vba", "title": "How to count number of char between specific characters with VBA", "body": "<p>I have string variables such as: \"xxx_YYYY_zzz\"\nboth x, y and z may change their value and number of chars hence I can have:\n 1. xx_YYY_z\n 2. xxxx_Y_zzzzzzzzz\n 3. x_yy_zzz\n 4. etc</p>\n\n<p>For each string variable, I would like to count and store in another variable the number of x, y and z chars because in the end I want to be able to print only the relevant part such as :</p>\n\n<ol>\n<li>z</li>\n<li>zzzzzzzzz</li>\n<li>zzz</li>\n</ol>\n\n<p>(Hence i take all chars after the last underscore)</p>\n\n<p>or</p>\n\n<p>I take all chars between the 2 underscores</p>\n\n<ol>\n<li>YYY</li>\n<li>Y</li>\n<li>yy</li>\n</ol>\n\n<p>The only thing which stay the same is the number of underscores. I always have: string_string_string \nThank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 1, "creation_date": 1534338101, "post_id": 51859224, "comment_id": 90670521, "body": "So, nobody knows what you try to acomplish. Can you please tell us what you want to do exept writing a loog for something on some sheet with a date format? ;)"}, {"owner": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "reply_to_user": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 1, "creation_date": 1534338225, "post_id": 51859224, "comment_id": 90670595, "body": "@Lutscha Sorry about that! Let me edit the post"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "edited": false, "score": 0, "creation_date": 1534340074, "post_id": 51859332, "comment_id": 90671663, "body": "Did you put the code in a standard module? And are the sheets in the same workbook as the code that you want to format?"}, {"owner": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "edited": false, "score": 0, "creation_date": 1534340216, "post_id": 51859332, "comment_id": 90671747, "body": "Yes, All of the worksheets are in the same workbook. And the code itself is all within one module"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "edited": false, "score": 0, "creation_date": 1534340269, "post_id": 51859332, "comment_id": 90671783, "body": "Are you working with actual dates in column G or are they text strings? You can test with ISNUMBER( cell) If text string s then you need to do some additional work."}, {"owner": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "edited": false, "score": 0, "creation_date": 1534340371, "post_id": 51859332, "comment_id": 90671832, "body": "there is a chance it could be Text strings. How would I double check?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "edited": false, "score": 0, "creation_date": 1534340410, "post_id": 51859332, "comment_id": 90671859, "body": "choose one say it was A1 then in B1 you would put ISNUMERIC(A1)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "edited": false, "score": 0, "creation_date": 1534340467, "post_id": 51859332, "comment_id": 90671899, "body": "If they are strings are they in a consistent format and is that format 8/15/2018  ?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 5, "last_activity_date": 1534343893, "last_edit_date": 1534343893, "creation_date": 1534338390, "answer_id": 51859332, "question_id": 51859224, "link": "https://stackoverflow.com/questions/51859224/how-to-create-a-loop-for-this-excel-vba/51859332#51859332", "title": "How to create a Loop for this? Excel VBA", "body": "<p>You can loop the worksheets collection to apply to each sheet the formatting for that column. Using the worksheets collection has the advantage of avoiding any chart sheets you may have in the workbook.</p>\n\n<pre><code>Option Explicit\nPublic Sub ApplyFormatting()\n    Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n        ws.Columns(\"G:G\").NumberFormat = \"yyyymm\"\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you have string rather than dates you could try converting the string to date format e.g.</p>\n\n<pre><code>Option Explicit\nPublic Sub ApplyFormatting()\n    Dim ws As Worksheet, inputArray(), lastRow As Long\n    For Each ws In ThisWorkbook.Worksheets\n        With ws.Columns(\"G:G\")\n            lastRow = ws.Cells(.Rows.Count, \"G\").End(xlUp).Row\n            inputArray = ws.Range(\"G1:G\" &amp; lastRow).Value\n            inputArray = ProcessArray(inputArray)\n            .Cells(1, 1).Resize(UBound(inputArray, 1), UBound(inputArray, 2)) = inputArray\n            .NumberFormat = \"yyyymm\"\n        End With\n    Next\nEnd Sub\n\nPublic Function ProcessArray(ByRef inputArray As Variant) As Variant\n    Dim i As Long\n    For i = LBound(inputArray, 1) To UBound(inputArray, 1)\n        inputArray(i, 1) = GetDate(inputArray(i, 1))\n    Next\n    ProcessArray = inputArray\nEnd Function\n\nPublic Function GetDate(ByVal dateString As String) As String\n    Dim arr() As String\n    If dateString = vbNullString Or Not InStr(dateString, \"/\") &gt; 0 Then\n        GetDate = vbNullString\n    Else\n        arr = Split(dateString, \"/\")\n        GetDate = Format$(DateSerial(arr(2), arr(0), arr(1)), \"yyyy-mm-dd\")\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 51859332, "answer_count": 1, "score": -1, "last_activity_date": 1534343893, "creation_date": 1534338018, "last_edit_date": 1534339228, "question_id": 51859224, "link": "https://stackoverflow.com/questions/51859224/how-to-create-a-loop-for-this-excel-vba", "title": "How to create a Loop for this? Excel VBA", "body": "<p>I am relatively new to VBA. I wanted to create this loop for a macro that would circulate through all worksheets within the workbook. Essentially what I am trying to do is to change all the dates in the \"G\" Column to change from 8/15/2018 to 201808 (yyyymm). Here is the recorded macro:</p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nColumns(\"G:G\").Select\nSelection.NumberFormat = \"yyyymm\"\nApplication.ScreenUpdating = False\n</code></pre>\n\n<p>How would I go about doing this?</p>\n"}, {"tags": ["excel", "vba", "ready"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534352923, "post_id": 51859174, "comment_id": 90678734, "body": "Your variable names make me feel dyslexic"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1534353850, "post_id": 51859174, "comment_id": 90679149, "body": "you have too many redundant lines that I have no idea why you are doing it. There is no point to unprotect and protect back again for many times in the code. You need to explain what you want to achieve? Do you want to give access to people in the authorized list? Do you want to give access to the whole workbook or just a specific sheet? Do you have many users opening the workbook at the same time?"}, {"owner": {"reputation": 21, "user_id": 10229320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-34t3Nc3n_jw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rP69Lat1l1MprgNk5t3z-Fp7YMMQ/mo/photo.jpg?sz=128", "display_name": "Robert Lutes", "link": "https://stackoverflow.com/users/10229320/robert-lutes"}, "edited": false, "score": 0, "creation_date": 1534354947, "post_id": 51859174, "comment_id": 90679609, "body": "Neither of those comments really pertain to the question at hand, but there are two user types: managers and write only. Managers can add write only users on top of what write only users can do. Write only users get partial access to one sheet. The sheet should be saved protected so non-authorized users can&#39;t touch anything. Really though, I&#39;m looking for help on fixing the 50290 error caused by the non-ready state. Everything else works as intended."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534448842, "post_id": 51859174, "comment_id": 90720296, "body": "Should managers also have access to the sheet workers can edit?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10229320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-34t3Nc3n_jw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rP69Lat1l1MprgNk5t3z-Fp7YMMQ/mo/photo.jpg?sz=128", "display_name": "Robert Lutes", "link": "https://stackoverflow.com/users/10229320/robert-lutes"}, "edited": false, "score": 0, "creation_date": 1534526848, "post_id": 51884296, "comment_id": 90751668, "body": "That&#39;s definitely cleaner code than what I used, and I&#39;ll incorporate much of it into my code However, the issue is with the while not application.ready portion. I have a similar variant that has the same problem. application.ready isn&#39;t changing state and its getting stuck in an infinite loop. I&#39;m sure it has something to do with our networks setup, but I can&#39;t change that. The problem is anything that would &quot;pulse&quot; the check (sleep, application.wait, etc) throws an error.... because the sheet isn&#39;t ready."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 21, "user_id": 10229320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-34t3Nc3n_jw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rP69Lat1l1MprgNk5t3z-Fp7YMMQ/mo/photo.jpg?sz=128", "display_name": "Robert Lutes", "link": "https://stackoverflow.com/users/10229320/robert-lutes"}, "edited": false, "score": 0, "creation_date": 1534526926, "post_id": 51884296, "comment_id": 90751700, "body": "@RobertLutes Yeah I wasn&#39;t able to replicate the same problem with <code>application.ready</code> on my end so I thought I&#39;d retry it just to be sure. sorry it didn&#39;t help"}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1534448570, "creation_date": 1534448570, "answer_id": 51884296, "question_id": 51859174, "link": "https://stackoverflow.com/questions/51859174/excel-vba-protect-unprotect-macro-breaks-during-saves-due-to-not-ready/51884296#51884296", "title": "Excel VBA: Protect/Unprotect macro breaks during saves due to not ready", "body": "<p>Let me know how this one works for you. If it works and you want it, I can make a list of the changes that I made</p>\n\n<pre><code>Option Explicit\n\nPrivate Const THE_PASSWORD As String = \"TDM\"\n\nPrivate Sub Auto_Open()\n    Call AuthProtect(False)\n\n    ThisWorkbook.Sheets(1).Cells.Clear\nEnd Sub\n\nPrivate Function GetAuth() As Long\n\n    With ThisWorkbook.Sheets(\"Authorized users\")\n        Dim managers As Range\n        Set managers = .Range(\"A1\").Resize(.Range(\"A1\").End(xlDown).Row)\n\n        Dim workers As Range\n        Set workers = .Range(\"B1\").Resize(.Range(\"B1\").End(xlDown).Row)\n    End With\n\n    On Error GoTo errorhandler\n    While Not Application.Ready\n        DoEvents\n    Wend\n    On Error GoTo 0\n\n    Dim currentUser As String\n    currentUser = Environ$(\"username\")\n\n    Dim auth As Long\n\n    Dim cell As Range\n    For Each cell In Union(managers, workers)\n        If LCase$(currentUser) = LCase$(cell.Value2) Then\n            auth = cell.Column\n            Exit For\n        End If\n    Next cell\n\n    GetAuth = auth\n\n    Exit Function\n\nerrorhandler:\n    GetAuth = -1\n\nEnd Function\n\nPrivate Sub AuthProtect(ByVal doProtect As Boolean)\n\n    On Error GoTo errorhandler\n    SpeedUp True\n\n    If doProtect Then\n\n        With ThisWorkbook\n            .Unprotect THE_PASSWORD\n\n            With .Sheets(\"Authorized users\")\n                .Unprotect THE_PASSWORD\n                .Columns(\"B\").Locked = True\n                .Protect THE_PASSWORD\n\n                .Visible = xlVeryHidden\n            End With\n\n            With .Sheets(\"Part Tracker\")\n                .Unprotect THE_PASSWORD\n                .Rows(\"6:\" &amp; Rows.Count).Locked = True\n                .Protect THE_PASSWORD\n            End With\n\n            .Protect THE_PASSWORD\n        End With\n\n    Else\n\n        Select Case GetAuth\n\n            Case 1\n\n                With ThisWorkbook\n                    .Unprotect THE_PASSWORD\n\n                    With .Sheets(\"Authorized users\")\n                        .Visible = xlSheetVisible\n\n                        .Unprotect THE_PASSWORD\n                        .Columns(\"B\").Locked = False\n                        .Protect THE_PASSWORD\n                    End With\n\n                    .Protect THE_PASSWORD\n                End With\n\n            Case 2\n\n                With ThisWorkbook.Sheets(\"Part Tracker\")\n                    .Unprotect THE_PASSWORD\n\n                    .Rows(\"6:\" &amp; Rows.Count).Locked = False\n\n                    .Protect THE_PASSWORD, _\n                        AllowInsertingRows:=True, _\n                        AllowInsertingHyperlinks:=True, _\n                        AllowDeletingRows:=True, _\n                        AllowFiltering:=True, _\n                        UserInterfaceOnly:=True, _\n                        DrawingObjects:=False\n\n                    .EnableOutlining = True\n                End With\n\n            Case -1\n\n                MsgBox \"Error with Application.Ready state\"\n\n            Case Else\n\n                With ThisWorkbook.Sheets(\"Authorized users\")\n                    Dim managers As Range\n                    Set managers = .Range(\"A1\").Resize(.Range(\"A1\").End(xlDown).Row)\n                End With\n\n                Dim managerList As String\n\n                Dim cell As Range\n                For Each cell In managers\n                    managerList = managerList &amp; \"        \" &amp; cell.Value2 &amp; vbCrLf\n                Next cell\n\n                MsgBox \"You do not have write access to this file.\" &amp; vbNewLine &amp; \"To request access, please seek out any of the following managers: \" &amp; vbCrLf &amp; vbCrLf &amp; managerList\n\n        End Select\n\n    End If\n\nerrorhandler:\n    SpeedUp False\n\nEnd Sub\n\nSub SpeedUp(ByVal toggleOn As Boolean)\n\n    With Application\n        .Calculation = IIf(toggleOn, xlCalculationManual, xlCalculationAutomatic)\n        .ScreenUpdating = Not toggleOn\n        .DisplayStatusBar = Not toggleOn\n        .EnableEvents = Not toggleOn\n    End With\n\nEnd Sub\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Call AuthProtect(True)\nEnd Sub\n\nPrivate Sub Workbook_AfterSave(ByVal Success As Boolean)\n    Call AuthProtect(False)\nEnd Sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Call AuthProtect(True)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10229320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-34t3Nc3n_jw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rP69Lat1l1MprgNk5t3z-Fp7YMMQ/mo/photo.jpg?sz=128", "display_name": "Robert Lutes", "link": "https://stackoverflow.com/users/10229320/robert-lutes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1534448570, "creation_date": 1534337869, "last_edit_date": 1534356804, "question_id": 51859174, "link": "https://stackoverflow.com/questions/51859174/excel-vba-protect-unprotect-macro-breaks-during-saves-due-to-not-ready", "title": "Excel VBA: Protect/Unprotect macro breaks during saves due to not ready", "body": "<p>I'm currently working on a set of code that locks and unlocks a sheet based on the username of the current user, nothing fancy. This code works quite well, except during the after save portion. Intermittently, when saved on the company server, on my computer only (though its only been lightly tested on 3 computers), I get a 50290 error with anything that tries to modify the sheet - even application.wait. Eventually I traced this to the workbook not being ready (application.ready returns false after save, but true if I manually run the code or during the open workbook event). It seems that the standard procedure is to do while loop until application.ready = true, but that locks the computer up with no recovery. I've tried methods of slowing the loop down (sleep, doevent, wait) and none of those seem to fix the issue.</p>\n\n<p>Any ideas?</p>\n\n<pre><code>Sub AuthorizedUser()\n\n- initialize variables here\n\n    On Error GoTo errorhandler\n\n    Do 'attempt to wait until sheet is ready\n        DoEvents\n    Loop Until Application.Ready = True\n\n    - Do stuff to protect sheet here - \n    - If the sheet isn't ready, error state -\n    - Any change, such as application.wait, coloring cells, or protecting sheet is what the error state occurs on -\n\n\n    errorhandler:\n    MsgBox \"Unlocker broke. Please hit the unlock button\"\n\nEnd Sub\n\nPrivate Sub Workbook_AfterSave(ByVal Success As Boolean)\n\n\n    Call AuthorizedUser\n\nEnd Sub\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n- do stuff to protect worksheet -\nEnd Sub\n\nPrivate Sub Workbook_Open()\n\n    Call AuthorizedUser\n    Application.Run \"sheet1.ClearSheet\"\n\nEnd Sub\n</code></pre>\n\n<p>editted to remove the inner workings of the code. This code works just fine when excel is ready and does things as intended. </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 604, "user_id": 2989291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gHyYS.jpg?s=128&g=1", "display_name": "ShellNinja", "link": "https://stackoverflow.com/users/2989291/shellninja"}, "edited": false, "score": 0, "creation_date": 1534337899, "post_id": 51858999, "comment_id": 90670396, "body": "Welcome to Stack! Please see <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>. You&#39;ll get some better help if you post what VBA you&#39;ve already tried."}, {"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1534338035, "post_id": 51858999, "comment_id": 90670482, "body": "Welcome to SO. Please provide a Minimal, Complete, and Verifiable example. Show us the code for your latest attempt and where you got stuck. and explain why the result is not what you expected. <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 1, "user_id": 10229271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5538f13956c88774f56cbd798f8bcee5?s=128&d=identicon&r=PG&f=1", "display_name": "NHDesai248", "link": "https://stackoverflow.com/users/10229271/nhdesai248"}, "edited": false, "score": 0, "creation_date": 1534340269, "post_id": 51858999, "comment_id": 90671784, "body": "Thank you  - I tried using the code from this previous post <a href=\"https://stackoverflow.com/questions/39715877/properly-align-columns-for-rows-that-end-early-vba-excel\" title=\"properly align columns for rows that end early vba excel\">stackoverflow.com/questions/39715877/&hellip;</a>   The 1st response (1st code) aligns the last three cells of each row. I think if this was amended to remove that rule and just make sure all rows (within Columns L - Columns AA) perform the same action."}, {"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1534345354, "post_id": 51858999, "comment_id": 90674773, "body": "Please try to include <b>your</b> code as it is written, not by describing it (you may have bugs in it that aren&#39;t visible from your description). Include your code in the question."}, {"owner": {"reputation": 1, "user_id": 10229271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5538f13956c88774f56cbd798f8bcee5?s=128&d=identicon&r=PG&f=1", "display_name": "NHDesai248", "link": "https://stackoverflow.com/users/10229271/nhdesai248"}, "edited": false, "score": 0, "creation_date": 1534353971, "post_id": 51858999, "comment_id": 90679195, "body": "Updated - appreciate the patience with this newbie."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10229271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5538f13956c88774f56cbd798f8bcee5?s=128&d=identicon&r=PG&f=1", "display_name": "NHDesai248", "link": "https://stackoverflow.com/users/10229271/nhdesai248"}, "edited": false, "score": 0, "creation_date": 1534440388, "post_id": 51867490, "comment_id": 90716405, "body": "this worked - thank you!  What would you add to get all cells to have cells &quot;middle align&quot; and stay in text format?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1534466238, "last_edit_date": 1534466238, "creation_date": 1534373438, "answer_id": 51867490, "question_id": 51858999, "link": "https://stackoverflow.com/questions/51858999/need-to-align-data-and-eliminate-blanks/51867490#51867490", "title": "Need to align data and eliminate blanks", "body": "<p>Try something like this:</p>\n\n<pre><code>Sub main()\n\n    Dim rw As Range, arr, arr2(), i, n, num\n\n    Set rw = Worksheets(\"Align\").Range(\"L2:AA2\")\n    num = rw.Cells.Count\n\n    'run until row is empty\n    Do While Application.CountA(rw) &gt; 0\n\n        arr = rw.Value                '&lt;&lt; pick up the row contents\n        ReDim arr2(1 To 1, 1 To num)  '&lt;&lt; new array for consolidated values\n        n = num\n        For i = num To 1 Step -1      '&lt;&lt; loop backwards\n            If Len(arr(1, i)) &gt; 0 Then\n                arr2(1, n) = arr(1, i)\n                n = n - 1\n            End If\n        Next i\n\n        With rw\n            .HorizontalAlignment = xlCenter   '&lt;&lt; added\n            .NumberFormat = \"@\"               '&lt;&lt; added\n            .Value = arr2                     '&lt;&lt; re-populate the row\n        End With\n\n        Set rw = rw.Offset(1, 0)      '&lt;&lt; next row\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10229271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5538f13956c88774f56cbd798f8bcee5?s=128&d=identicon&r=PG&f=1", "display_name": "NHDesai248", "link": "https://stackoverflow.com/users/10229271/nhdesai248"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1534466238, "creation_date": 1534337228, "last_edit_date": 1534353954, "question_id": 51858999, "link": "https://stackoverflow.com/questions/51858999/need-to-align-data-and-eliminate-blanks", "title": "Need to align data and eliminate blanks", "body": "<p>I have a data set from Column L through Column AA. I want all cells to move such that the last cell in each row moves to Column AA and the rest shift right such that all blank cells are gone. Could someone please assist with a VBA code? Thank you!</p>\n\n<pre><code>Option Explicit\n\nSub main()\nDim rng As Range, cell As Range\nDim lastCol As Long, maxCol As Long, iCol As Long\n\nWith Worksheets(\"Align\") '&lt;--| change \"Align\" to your actual sheet name\n    Set rng = .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp)).SpecialCells(XlCellType.xlCellTypeConstants) '&lt;--| get all columns \"A\" not empty cells\n    ReDim lastCols(1 To rng.Count) As Long '&lt;--| resize last column index array accordingly to the number of not empty cells\n\n    For Each cell In rng '&lt;--| loop through column \"A\" not empty cells\n        iCol = iCol + 1 '&lt;--| update last column index array index\n        lastCols(iCol) = .Cells(cell.row, .Columns.Count).End(xlToLeft).Column '&lt;--| update last column index array current index value\n        If lastCols(iCol) &gt; maxCol Then maxCol = lastCols(iCol) '&lt;--| update maximum column index\n    Next cell\n\n    iCol = 1 '&lt;--| initialize last column index array index\n    For Each cell In rng '&lt;--| loop through column \"A\" not empty cells\n        If lastCols(iCol) &lt; maxCol And lastCols(iCol) &gt; 3 Then cell.Offset(, lastCols(iCol) - 3).Resize(, maxCol - lastCols(iCol)).Insert xlShiftToRight '&lt;--| if current cell row has at least three not empty cells and the last one has smaller column index than maximum column index then shift current cell row last three cells to align left with maximum column index\n        iCol = iCol + 1\n    Next cell\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 3, "creation_date": 1534336885, "post_id": 51858748, "comment_id": 90669833, "body": "Ideally, you should be using your worksheet &quot;anchors&quot; for all your range access, i.e. <code>Ov.Range...</code>. Alternatively, you can wrap all your range statements with a simple <code>With Ov  ...  End With</code>, which would be more efficient. As to your error, especially if all the other <code>Range.Formula = ...</code> statements are working, try changing the line that errors with a dummy formula, such as <code>Range(&quot;U&quot; &amp; ar).Formula = &quot;=&quot;&quot;hello world&quot;&quot;&quot;</code> and see if that gives you an error too. It will help to bracket where the exact problem is."}, {"owner": {"reputation": 1997, "user_id": 4409883, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/xZatI.jpg?s=128&g=1", "display_name": "Edgar", "link": "https://stackoverflow.com/users/4409883/edgar"}, "edited": false, "score": 0, "creation_date": 1534336912, "post_id": 51858748, "comment_id": 90669850, "body": "I don&#39;t know the answer but I am suspicious with name like this &#39;PCA &amp; Feedback&#39;!M&quot; with special characters. These are often errors waiting to happen. Does the error happen all the time independent of the data? or is there only and error with some data?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1534337098, "post_id": 51858748, "comment_id": 90669962, "body": "Remember to declare <code>Ov</code>, <code>Bo</code>, <code>Bi</code>, <code>SU</code>, <code>Co</code> &amp; <code>PF</code> as worksheets. At the moment they&#39;re variants - only <code>ws</code> is a worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10229217, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6x7RTAekTFk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rMJVkalZ1QiKWHWhey5D3kKs7Gxg/mo/photo.jpg?sz=128", "display_name": "Zara Adamson", "link": "https://stackoverflow.com/users/10229217/zara-adamson"}, "edited": false, "score": 0, "creation_date": 1534339042, "post_id": 51859295, "comment_id": 90671065, "body": "Ah amazing thank you so much! I&#39;ve been looking at the code all morning I must have gone cross eyed to miss that!  Thanks for all the formating as well - just tried it with the excel document and its now 100x faster, I will definitely be using more with statements in the future."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 3, "user_id": 10229217, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6x7RTAekTFk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rMJVkalZ1QiKWHWhey5D3kKs7Gxg/mo/photo.jpg?sz=128", "display_name": "Zara Adamson", "link": "https://stackoverflow.com/users/10229217/zara-adamson"}, "edited": false, "score": 0, "creation_date": 1534339176, "post_id": 51859295, "comment_id": 90671141, "body": "I know that feeling.  Especially when it has been working in the past - you must&#39;ve accidentally deleted the character without noticing.  Easy to do. :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1534338267, "creation_date": 1534338267, "answer_id": 51859295, "question_id": 51858748, "link": "https://stackoverflow.com/questions/51858748/excel-vba-run-time-error-1004-application-defined-or-object-defined-error/51859295#51859295", "title": "Excel VBA: Run-time error &#39;1004&#39; Application-defined or object-defined error", "body": "<p>Your specific problem is that the formula is missing an <code>!</code> at <code>PCA &amp; Feedback'R &amp; ar</code>  </p>\n\n<p><code>Range(\"U\" &amp; ar).Formula = \"=IF('PCA &amp; Feedback'!Q\" &amp; ar &amp; \"=\"\"Y\"\", 'PCA &amp; Feedback'R\" &amp; ar &amp; \", IF('PCA &amp; Feedback'!N\" &amp; ar &amp; \"=\"\"\"\", 'PCA &amp; Feedback'!M\" &amp; ar &amp; \", 'PCA &amp; Feedback'!N\" &amp; ar &amp; \"))\"</code>  </p>\n\n<p>I've rewritten the code to include <code>With</code> and removing the need to activate each sheet.<br>\nI also commented out the screen updating - shouldn't really need it as the sheets aren't activated anymore.  </p>\n\n<p><strong>Note 1:</strong>  where I have written <code>ThisWorkbook</code> I'm referring to the workbook that the code is in.<br>\n<strong>Note 2:</strong>  When using a cell reference within a <code>With...End With</code> block start the reference with <code>.</code>.<br>\nSo <code>.Range(\"E\" &amp; ar)</code> rather than just <code>Range(\"E\" &amp; ar)</code></p>\n\n<pre><code>Sub InsertRows()\n\n    Dim Ov As Worksheet, Bo As Worksheet, Bi As Worksheet, SU As Worksheet\n    Dim Co As Worksheet, PF As Worksheet, ws As Worksheet\n    Dim ar As Long\n    Dim ce As Range\n\n    With ThisWorkbook\n        Set Ov = .Sheets(\"Overview\")\n        Set Bo = .Sheets(\"Booking\")\n        Set Bi = .Sheets(\"Billing\")\n        Set SU = .Sheets(\"Set Up\")\n        Set Co = .Sheets(\"Copy\")\n        Set PF = .Sheets(\"PCA &amp; Feedback\")\n    End With\n\n    ar = ActiveCell.Row\n\n    'Application.ScreenUpdating = False\n\n    For Each ws In ThisWorkbook.Worksheets\n        ws.Unprotect\n    Next\n\n    'Bo.Activate\n    With Bo\n        .Rows(ar &amp; \":\" &amp; ar).EntireRow.Insert\n        .Range(\"E\" &amp; ar).Formula = \"=VLOOKUP(C\" &amp; ar &amp; \",'Deal Numbers 2015'!$A$2:$B$85,2,FALSE)\"\n        .Range(\"Q\" &amp; ar).Formula = \"=VLOOKUP(H\" &amp; ar &amp; \", Lists!$A$18:$B$25, 2, FALSE)\"\n        .Range(\"R\" &amp; ar).Formula = \"=WORKDAY(I\" &amp; ar &amp; \", -Q\" &amp; ar &amp; \")\"\n    End With\n\n    'Bi.Activate\n    With Bi\n        .Rows(ar &amp; \":\" &amp; ar).EntireRow.Insert\n\n        .Range(\"B\" &amp; ar).Formula = \"=Booking!B\" &amp; ar\n        .Range(\"C\" &amp; ar).Formula = \"=Booking!C\" &amp; ar\n        .Range(\"D\" &amp; ar).Formula = \"=Booking!D\" &amp; ar\n        .Range(\"E\" &amp; ar).Formula = \"=Booking!I\" &amp; ar\n        .Range(\"F\" &amp; ar).Formula = \"=Booking!J\" &amp; ar\n        .Range(\"G\" &amp; ar).Formula = \"=Booking!P\" &amp; ar\n        .Range(\"H\" &amp; ar).Formula = \"=Booking!F\" &amp; ar\n        .Range(\"I\" &amp; ar).Formula = \"=Booking!G\" &amp; ar\n        .Range(\"M\" &amp; ar).Formula = \"=IF(AND(L\" &amp; ar &amp; \"=\"\"Y\"\", N\" &amp; ar &amp; \" = \"\"\"\"), \"\"Y\"\", \"\"N\"\")\"\n    End With\n\n    'SU.Activate\n    With SU\n        .Rows(ar &amp; \":\" &amp; ar).EntireRow.Insert\n\n        .Range(\"B\" &amp; ar).Formula = \"=Booking!B\" &amp; ar\n        .Range(\"C\" &amp; ar).Formula = \"=Booking!C\" &amp; ar\n        .Range(\"D\" &amp; ar).Formula = \"=Booking!D\" &amp; ar\n        .Range(\"E\" &amp; ar).Formula = \"=Booking!I\" &amp; ar\n        .Range(\"F\" &amp; ar).Formula = \"=Booking!J\" &amp; ar\n        .Range(\"G\" &amp; ar).Formula = \"=Booking!P\" &amp; ar\n        .Range(\"L\" &amp; ar).Formula = \"=WORKDAY(Booking!I\" &amp; ar &amp; \", -8)\"\n        .Range(\"N\" &amp; ar).Formula = \"=IF(AND(COUNTA(O\" &amp; ar &amp; \")=1, ISBLANK(M\" &amp; ar &amp; \")), \"\"Y\"\", \"\"N\"\")\"\n    End With\n\n    'Co.Activate\n    With Co\n        .Rows(ar &amp; \":\" &amp; ar).EntireRow.Insert\n\n        .Range(\"B\" &amp; ar).Formula = \"=Booking!B\" &amp; ar\n        .Range(\"C\" &amp; ar).Formula = \"=Booking!C\" &amp; ar\n        .Range(\"D\" &amp; ar).Formula = \"=Booking!D\" &amp; ar\n        .Range(\"E\" &amp; ar).Formula = \"=Booking!I\" &amp; ar\n        .Range(\"F\" &amp; ar).Formula = \"=Booking!J\" &amp; ar\n        .Range(\"G\" &amp; ar).Formula = \"='Set Up'!K\" &amp; ar\n        .Range(\"H\" &amp; ar).Formula = \"='Set Up'!O\" &amp; ar\n        .Range(\"J\" &amp; ar).Formula = \"=WORKDAY(Booking!I\" &amp; ar &amp; \", -7)\"\n        .Range(\"L\" &amp; ar).Formula = \"=IF(AND(ISNUMBER(SEARCH(\"\"Copy Attached\"\", M\" &amp; ar &amp; \")), ISBLANK(K\" &amp; ar &amp; \")), \"\"Y\"\", \"\"N\"\")\"\n        .Range(\"N\" &amp; ar).Formula = \"=IF(AND(M\" &amp; ar &amp; \"=\"\"Copy Attached\"\", OR(O\" &amp; ar &amp; \"=\"\"N\"\", O\" &amp; ar &amp; \" = \"\"\"\")), \"\"Y\"\", \"\"N\"\")\"\n\n        .Range(\"I\" &amp; ar).Value = \"Awaiting Set Up\"\n        .Range(\"M\" &amp; ar).Value = \"Copy Not Attached\"\n    End With\n\n    'PF.Activate\n    With PF\n        .Rows(ar &amp; \":\" &amp; ar).EntireRow.Insert\n        .Range(\"B\" &amp; ar).Formula = \"=Booking!B\" &amp; ar\n        .Range(\"C\" &amp; ar).Formula = \"=Booking!C\" &amp; ar\n        .Range(\"D\" &amp; ar).Formula = \"=Booking!D\" &amp; ar\n        .Range(\"E\" &amp; ar).Formula = \"=Booking!J\" &amp; ar\n        .Range(\"F\" &amp; ar).Formula = \"=WORKDAY(Booking!J\" &amp; ar &amp; \", 8)\"\n        .Range(\"H\" &amp; ar).Formula = \"=IF(AND(G\" &amp; ar &amp; \"=\"\"Y\"\", I\" &amp; ar &amp; \"=\"\"\"\"), \"\"Y\"\", \"\"N\"\")\"\n        .Range(\"M\" &amp; ar).Formula = \"=WORKDAY(F\" &amp; ar &amp; \", 10)\"\n        .Range(\"P\" &amp; ar).Formula = \"=WORKDAY(O\" &amp; ar &amp; \", 10)\"\n    End With\n\n      'Adding Row to Sheet\n    'Ov.Activate\n\n    With Ov\n\n        .Rows(ar &amp; \":\" &amp; ar).EntireRow.Insert\n\n        'Adding formulas to Sheet\n        .Range(\"B\" &amp; ar).Formula = \"=Booking!B\" &amp; ar\n        .Range(\"C\" &amp; ar).Formula = \"=Booking!C\" &amp; ar\n        .Range(\"D\" &amp; ar).Formula = \"=IF(Booking!D\" &amp; ar &amp; \"=0, \"\"\"\", Booking!D\" &amp; ar &amp; \"&amp;\"\"-\"\"&amp;Booking!K\" &amp; ar &amp; \")\"\n        .Range(\"E\" &amp; ar).Formula = \"=Booking!F\" &amp; ar\n        .Range(\"F\" &amp; ar).Formula = \"=Booking!I\" &amp; ar\n        .Range(\"G\" &amp; ar).Formula = \"=Booking!J\" &amp; ar\n        .Range(\"H\" &amp; ar).Formula = \"=Booking!H\" &amp; ar\n        .Range(\"I\" &amp; ar).Formula = \"=ISBLANK(Booking!P\" &amp; ar &amp; \")\"\n        .Range(\"J\" &amp; ar).Formula = \"=IF(D\" &amp; ar &amp; \"=\"\"\"\", \"\"\"\", IF(Booking!M\" &amp; ar &amp; \"=\"\"Y\"\", \"\"On SF\"\", \"\"Not on SF\"\"))\"\n        .Range(\"K\" &amp; ar).Formula = \"=IF(D\" &amp; ar &amp; \"=\"\"\"\", \"\"\"\", IF(I\" &amp; ar &amp; \"=TRUE, J\" &amp; ar &amp; \", Booking!P\" &amp; ar &amp; \"))\"\n        .Range(\"L\" &amp; ar).Formula = \"=ISBLANK('Set Up'!K\" &amp; ar &amp; \")\"\n        .Range(\"M\" &amp; ar).Formula = \"=Booking!R\" &amp; ar\n        .Range(\"N\" &amp; ar).Formula = \"=IF(Booking!G\" &amp; ar &amp; \"=\"\"Y\"\", 1, 0)\"\n        .Range(\"O\" &amp; ar).Formula = \"=IF(Booking!N\" &amp; ar &amp; \"=\"\"Closed Won\"\", 1, 0)\"\n        .Range(\"P\" &amp; ar).Formula = \"=IF(D\" &amp; ar &amp; \"=\"\"\"\", \"\"\"\", IF(SUM(N\" &amp; ar &amp; \":O\" &amp; ar &amp; \")&lt;2, \"\"N\"\", IF(SUM(N\" &amp; ar &amp; \":O\" &amp; ar &amp; \")=2, \"\"Y\"\")))\"\n        .Range(\"Q\" &amp; ar).Formula = \"=IF(D\" &amp; ar &amp; \"=\"\"\"\", \"\"\"\", IF(L\" &amp; ar &amp; \"=TRUE, \"\"Requested\"\", 'Set Up'!K\" &amp; ar &amp; \"))\"\n        .Range(\"R\" &amp; ar).Formula = \"=IF(D\" &amp; ar &amp; \"=\"\"\"\", \"\"\"\", IF(Copy!M\" &amp; ar &amp; \"=\"\"Copy Not Attached\"\", Copy!I\" &amp; ar &amp; \", Copy!M\" &amp; ar &amp; \"))\"\n        .Range(\"S\" &amp; ar).Formula = \"=Copy!J\" &amp; ar\n        .Range(\"T\" &amp; ar).Formula = \"='PCA &amp; Feedback'!I\" &amp; ar\n        .Range(\"U\" &amp; ar).Formula = \"=IF('PCA &amp; Feedback'!Q\" &amp; ar &amp; \"=\"\"Y\"\", 'PCA &amp; Feedback'!R\" &amp; ar &amp; \", IF('PCA &amp; Feedback'!N\" &amp; ar &amp; \"=\"\"\"\", 'PCA &amp; Feedback'!M\" &amp; ar &amp; \", 'PCA &amp; Feedback'!N\" &amp; ar &amp; \"))\"\n        .Range(\"V\" &amp; ar).Formula = \"=IF(COUNTBLANK(Booking!S\" &amp; ar &amp; \")+COUNTBLANK('Set Up'!R\" &amp; ar &amp; \")+COUNTBLANK(Copy!P\" &amp; ar &amp; \")=3, \"\"\"\", Booking!S\" &amp; ar &amp; \"&amp;\"\"; \"\"&amp;'Set Up'!R\" &amp; ar &amp; \"&amp;\"\"; \"\"&amp;Copy!P\" &amp; ar &amp; \")\"\n\n    End With\n\n    For Each ws In Worksheets\n        ws.Protect , DrawingObjects:=False, AllowFiltering:=True\n    Next\n\n    Bo.Activate\n    Bo.Range(\"B\" &amp; ar).Activate\n\n    'Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10229217, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6x7RTAekTFk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rMJVkalZ1QiKWHWhey5D3kKs7Gxg/mo/photo.jpg?sz=128", "display_name": "Zara Adamson", "link": "https://stackoverflow.com/users/10229217/zara-adamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 51859295, "answer_count": 1, "score": 0, "last_activity_date": 1594151365, "creation_date": 1534336281, "last_edit_date": 1594151365, "question_id": 51858748, "link": "https://stackoverflow.com/questions/51858748/excel-vba-run-time-error-1004-application-defined-or-object-defined-error", "title": "Excel VBA: Run-time error &#39;1004&#39; Application-defined or object-defined error", "body": "<p>I have written a piece of code for a checklist that we use at my place of work - this has been working for 6 months with no issues and now suddenly I am getting a \"Run-time error '1004' Application-defined or object-defined error\" caused by this line:</p>\n\n<pre><code>Range(\"U\" &amp; ar).Formula = \"=IF('PCA &amp; Feedback'!Q\" &amp; ar &amp; \"=\"\"Y\"\", 'PCA &amp; Feedback'R\" &amp; ar &amp; \", IF('PCA &amp; Feedback'!N\" &amp; ar &amp; \"=\"\"\"\", 'PCA &amp; Feedback'!M\" &amp; ar &amp; \", 'PCA &amp; Feedback'!N\" &amp; ar &amp; \"))\"\n</code></pre>\n\n<p>The sheets I use are protected but as you can see they are unprotected at the start of the macro. The code is placed in a module so this shouldn't be the issue either. I have also tried specifying the worksheet before each range but this isn't working for me either (E.g., Ov.Range(\"U\" &amp; ar)....).</p>\n\n<p>Everything works fine up until that line and for the life of me I can't figure out whats causing the error. Any help you can provide is appreciated!</p>\n\n<pre><code>Sub InsertRows()\n\nDim Ov, Bo, Bi, SU, Co, PF, ws As Worksheet\nDim ar As Long\nDim ce As Range\nSet Ov = Sheets(\"Overview\")\nSet Bo = Sheets(\"Booking\")\nSet Bi = Sheets(\"Billing\")\nSet SU = Sheets(\"Set Up\")\nSet Co = Sheets(\"Copy\")\nSet PF = Sheets(\"PCA &amp; Feedback\")\n\nar = ActiveCell.Row\n\nApplication.ScreenUpdating = False\n\nFor Each ws In Worksheets\nws.Unprotect\nNext\n\nBo.Activate\nRows(ar &amp; \":\" &amp; ar).EntireRow.Insert\nRange(\"E\" &amp; ar).Formula = \"=VLOOKUP(C\" &amp; ar &amp; \",'Deal Numbers 2015'!$A$2:$B$85,2,FALSE)\"\nRange(\"Q\" &amp; ar).Formula = \"=VLOOKUP(H\" &amp; ar &amp; \", Lists!$A$18:$B$25, 2, FALSE)\"\nRange(\"R\" &amp; ar).Formula = \"=WORKDAY(I\" &amp; ar &amp; \", -Q\" &amp; ar &amp; \")\"\n\nBi.Activate\nRows(ar &amp; \":\" &amp; ar).EntireRow.Insert\n\nRange(\"B\" &amp; ar).Formula = \"=Booking!B\" &amp; ar\nRange(\"C\" &amp; ar).Formula = \"=Booking!C\" &amp; ar\nRange(\"D\" &amp; ar).Formula = \"=Booking!D\" &amp; ar\nRange(\"E\" &amp; ar).Formula = \"=Booking!I\" &amp; ar\nRange(\"F\" &amp; ar).Formula = \"=Booking!J\" &amp; ar\nRange(\"G\" &amp; ar).Formula = \"=Booking!P\" &amp; ar\nRange(\"H\" &amp; ar).Formula = \"=Booking!F\" &amp; ar\nRange(\"I\" &amp; ar).Formula = \"=Booking!G\" &amp; ar\nRange(\"M\" &amp; ar).Formula = \"=IF(AND(L\" &amp; ar &amp; \"=\"\"Y\"\", N\" &amp; ar &amp; \" = \"\"\"\"), \"\"Y\"\", \"\"N\"\")\"\n\nSU.Activate\nRows(ar &amp; \":\" &amp; ar).EntireRow.Insert\n\nRange(\"B\" &amp; ar).Formula = \"=Booking!B\" &amp; ar\nRange(\"C\" &amp; ar).Formula = \"=Booking!C\" &amp; ar\nRange(\"D\" &amp; ar).Formula = \"=Booking!D\" &amp; ar\nRange(\"E\" &amp; ar).Formula = \"=Booking!I\" &amp; ar\nRange(\"F\" &amp; ar).Formula = \"=Booking!J\" &amp; ar\nRange(\"G\" &amp; ar).Formula = \"=Booking!P\" &amp; ar\nRange(\"L\" &amp; ar).Formula = \"=WORKDAY(Booking!I\" &amp; ar &amp; \", -8)\"\nRange(\"N\" &amp; ar).Formula = \"=IF(AND(COUNTA(O\" &amp; ar &amp; \")=1, ISBLANK(M\" &amp; ar &amp; \")), \"\"Y\"\", \"\"N\"\")\"\n\nCo.Activate\nRows(ar &amp; \":\" &amp; ar).EntireRow.Insert\n\nRange(\"B\" &amp; ar).Formula = \"=Booking!B\" &amp; ar\nRange(\"C\" &amp; ar).Formula = \"=Booking!C\" &amp; ar\nRange(\"D\" &amp; ar).Formula = \"=Booking!D\" &amp; ar\nRange(\"E\" &amp; ar).Formula = \"=Booking!I\" &amp; ar\nRange(\"F\" &amp; ar).Formula = \"=Booking!J\" &amp; ar\nRange(\"G\" &amp; ar).Formula = \"='Set Up'!K\" &amp; ar\nRange(\"H\" &amp; ar).Formula = \"='Set Up'!O\" &amp; ar\nRange(\"J\" &amp; ar).Formula = \"=WORKDAY(Booking!I\" &amp; ar &amp; \", -7)\"\nRange(\"L\" &amp; ar).Formula = \"=IF(AND(ISNUMBER(SEARCH(\"\"Copy Attached\"\", M\" &amp; ar &amp; \")), ISBLANK(K\" &amp; ar &amp; \")), \"\"Y\"\", \"\"N\"\")\"\nRange(\"N\" &amp; ar).Formula = \"=IF(AND(M\" &amp; ar &amp; \"=\"\"Copy Attached\"\", OR(O\" &amp; ar &amp; \"=\"\"N\"\", O\" &amp; ar &amp; \" = \"\"\"\")), \"\"Y\"\", \"\"N\"\")\"\n\nRange(\"I\" &amp; ar).Value = \"Awaiting Set Up\"\nRange(\"M\" &amp; ar).Value = \"Copy Not Attached\"\n\nPF.Activate\nRows(ar &amp; \":\" &amp; ar).EntireRow.Insert\nRange(\"B\" &amp; ar).Formula = \"=Booking!B\" &amp; ar\nRange(\"C\" &amp; ar).Formula = \"=Booking!C\" &amp; ar\nRange(\"D\" &amp; ar).Formula = \"=Booking!D\" &amp; ar\nRange(\"E\" &amp; ar).Formula = \"=Booking!J\" &amp; ar\nRange(\"F\" &amp; ar).Formula = \"=WORKDAY(Booking!J\" &amp; ar &amp; \", 8)\"\nRange(\"H\" &amp; ar).Formula = \"=IF(AND(G\" &amp; ar &amp; \"=\"\"Y\"\", I\" &amp; ar &amp; \"=\"\"\"\"), \"\"Y\"\", \"\"N\"\")\"\nRange(\"M\" &amp; ar).Formula = \"=WORKDAY(F\" &amp; ar &amp; \", 10)\"\nRange(\"P\" &amp; ar).Formula = \"=WORKDAY(O\" &amp; ar &amp; \", 10)\"\n\n  'Adding Row to Sheet\nOv.Activate\n\nRows(ar &amp; \":\" &amp; ar).EntireRow.Insert\n\n'Adding formulas to Sheet\nRange(\"B\" &amp; ar).Formula = \"=Booking!B\" &amp; ar\nRange(\"C\" &amp; ar).Formula = \"=Booking!C\" &amp; ar\nRange(\"D\" &amp; ar).Formula = \"=IF(Booking!D\" &amp; ar &amp; \"=0, \"\"\"\", Booking!D\" &amp; ar &amp; \"&amp;\"\"-\"\"&amp;Booking!K\" &amp; ar &amp; \")\"\nRange(\"E\" &amp; ar).Formula = \"=Booking!F\" &amp; ar\nRange(\"F\" &amp; ar).Formula = \"=Booking!I\" &amp; ar\nRange(\"G\" &amp; ar).Formula = \"=Booking!J\" &amp; ar\nRange(\"H\" &amp; ar).Formula = \"=Booking!H\" &amp; ar\nRange(\"I\" &amp; ar).Formula = \"=ISBLANK(Booking!P\" &amp; ar &amp; \")\"\nRange(\"J\" &amp; ar).Formula = \"=IF(D\" &amp; ar &amp; \"=\"\"\"\", \"\"\"\", IF(Booking!M\" &amp; ar &amp; \"=\"\"Y\"\", \"\"On SF\"\", \"\"Not on SF\"\"))\"\nRange(\"K\" &amp; ar).Formula = \"=IF(D\" &amp; ar &amp; \"=\"\"\"\", \"\"\"\", IF(I\" &amp; ar &amp; \"=TRUE, J\" &amp; ar &amp; \", Booking!P\" &amp; ar &amp; \"))\"\nRange(\"L\" &amp; ar).Formula = \"=ISBLANK('Set Up'!K\" &amp; ar &amp; \")\"\nRange(\"M\" &amp; ar).Formula = \"=Booking!R\" &amp; ar\nRange(\"N\" &amp; ar).Formula = \"=IF(Booking!G\" &amp; ar &amp; \"=\"\"Y\"\", 1, 0)\"\nRange(\"O\" &amp; ar).Formula = \"=IF(Booking!N\" &amp; ar &amp; \"=\"\"Closed Won\"\", 1, 0)\"\nRange(\"P\" &amp; ar).Formula = \"=IF(D\" &amp; ar &amp; \"=\"\"\"\", \"\"\"\", IF(SUM(N\" &amp; ar &amp; \":O\" &amp; ar &amp; \")&lt;2, \"\"N\"\", IF(SUM(N\" &amp; ar &amp; \":O\" &amp; ar &amp; \")=2, \"\"Y\"\")))\"\nRange(\"Q\" &amp; ar).Formula = \"=IF(D\" &amp; ar &amp; \"=\"\"\"\", \"\"\"\", IF(L\" &amp; ar &amp; \"=TRUE, \"\"Requested\"\", 'Set Up'!K\" &amp; ar &amp; \"))\"\nRange(\"R\" &amp; ar).Formula = \"=IF(D\" &amp; ar &amp; \"=\"\"\"\", \"\"\"\", IF(Copy!M\" &amp; ar &amp; \"=\"\"Copy Not Attached\"\", Copy!I\" &amp; ar &amp; \", Copy!M\" &amp; ar &amp; \"))\"\nRange(\"S\" &amp; ar).Formula = \"=Copy!J\" &amp; ar\nRange(\"T\" &amp; ar).Formula = \"='PCA &amp; Feedback'!I\" &amp; ar\nRange(\"U\" &amp; ar).Formula = \"=IF('PCA &amp; Feedback'!Q\" &amp; ar &amp; \"=\"\"Y\"\", 'PCA &amp; Feedback'R\" &amp; ar &amp; \", IF('PCA &amp; Feedback'!N\" &amp; ar &amp; \"=\"\"\"\", 'PCA &amp; Feedback'!M\" &amp; ar &amp; \", 'PCA &amp; Feedback'!N\" &amp; ar &amp; \"))\"\nRange(\"V\" &amp; ar).Formula = \"=IF(COUNTBLANK(Booking!S\" &amp; ar &amp; \")+COUNTBLANK('Set Up'!R\" &amp; ar &amp; \")+COUNTBLANK(Copy!P\" &amp; ar &amp; \")=3, \"\"\"\", Booking!S\" &amp; ar &amp; \"&amp;\"\"; \"\"&amp;'Set Up'!R\" &amp; ar &amp; \"&amp;\"\"; \"\"&amp;Copy!P\" &amp; ar &amp; \")\"\n\nFor Each ws In Worksheets\nws.Protect , DrawingObjects:=False, AllowFiltering:=True\nNext\n\nBo.Activate\nRange(\"B\" &amp; ar).Activate\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "lookup"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1534337259, "post_id": 51858679, "comment_id": 90670055, "body": "Quick question, should multiple coccurances be taken into consideration here?"}, {"owner": {"reputation": 294, "user_id": 2976401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c5515193d5a58d5d39eff486ed06a92?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/2976401/adam"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1534337321, "post_id": 51858679, "comment_id": 90670086, "body": "Nope, all the values are unique."}], "answers": [{"comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 1, "creation_date": 1534337443, "post_id": 51859005, "comment_id": 90670153, "body": "Can you explain the formula a little bit? :)"}, {"owner": {"reputation": 294, "user_id": 2976401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c5515193d5a58d5d39eff486ed06a92?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/2976401/adam"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1534337982, "post_id": 51859005, "comment_id": 90670442, "body": "Awesome! The formula works! But agree with @Pierre44, do you mind explaining the formula a little? It seems fairly complicated :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534338022, "post_id": 51859005, "comment_id": 90670467, "body": "There is a nice explanation of this technique here: <a href=\"https://stackoverflow.com/a/24949769/6241235\">stackoverflow.com/a/24949769/6241235</a> My example uses same approach but is expanded for intersect as neither row nor column is known, only the bounding area."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 3, "last_activity_date": 1534338018, "last_edit_date": 1534338018, "creation_date": 1534337252, "answer_id": 51859005, "question_id": 51858679, "link": "https://stackoverflow.com/questions/51858679/finding-location-of-value-from-multiple-columns/51859005#51859005", "title": "Finding location of value from multiple columns", "body": "<p>You can use the following with distinct values</p>\n\n<pre><code>=CELL(\"ADDRESS\",INDEX(A1:D4,SMALL(IF(NOT(ISERROR(SEARCH(\"a\",A1:D4))),ROW(1:4),99^99),1),SMALL(IF(NOT(ISERROR(SEARCH(\"a\",A1:D4))),COLUMN(A:D),99^99),1)))\n</code></pre>\n\n<p>Enter as an array formula with <kbd>Ctrl</kbd> + <kbd>Shift</kbd>+<kbd>Enter</kbd> </p>\n\n<p>Data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/epkrA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/epkrA.png\" alt=\"Data\"></a></p>\n\n<hr>\n\n<p>You could move what you are looking for into a separate cell rather than hard code into the formula, and wrap the whole thing in an IFERROR in case not found e.g.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ei8UN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ei8UN.png\" alt=\"example2\"></a></p>\n\n<p>Search value in G1 and formula in F1.</p>\n\n<pre><code>=IFERROR(CELL(\"ADDRESS\",INDEX(A1:D4,SMALL(IF(NOT(ISERROR(SEARCH(G1,A1:D4))),ROW(1:4),99^99),1),SMALL(IF(NOT(ISERROR(SEARCH(G1,A1:D4))),COLUMN(A:D),99^99),1))),\"\")\n</code></pre>\n\n<hr>\n\n<p>This returns the row where found:</p>\n\n<pre><code>SMALL(IF(NOT(ISERROR(SEARCH(\"a\",A1:D4))),ROW(1:4),99^99),1)\n</code></pre>\n\n<p>This returns the column where found:</p>\n\n<pre><code>SMALL(IF(NOT(ISERROR(SEARCH(\"a\",A1:D4))),COLUMN(A:D),99^99),1)\n</code></pre>\n\n<p>And then you use these for the intersect on the range indexed with</p>\n\n<pre><code>INDEX(A1:D4,.......)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 294, "user_id": 2976401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c5515193d5a58d5d39eff486ed06a92?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/2976401/adam"}, "edited": false, "score": 0, "creation_date": 1534338567, "post_id": 51859205, "comment_id": 90670808, "body": "Great answer as well. Thanks for the reference!"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1534340653, "post_id": 51859205, "comment_id": 90672012, "body": "You can also use <code>=ADDRESS(Row, Column)</code> instead of <code>=CELL(&quot;address&quot;,INDIRECT(&quot;R&quot; &amp; Row &amp; &quot;C&quot; &amp; Column, FALSE))</code>.  (Also, the <code>-ROW(data)+1</code> and <code>-COLUMN(data)+1</code> are to find the Row and Column <i>in the array</i>, and should probably be removed to find the Row and Column <i>in the worksheet</i>)"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1534342517, "post_id": 51859205, "comment_id": 90673058, "body": "Excellent suggestion!  see above edits with credit for @Chronocidal :)"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 2, "last_activity_date": 1534342486, "last_edit_date": 1534342486, "creation_date": 1534337965, "answer_id": 51859205, "question_id": 51858679, "link": "https://stackoverflow.com/questions/51858679/finding-location-of-value-from-multiple-columns/51859205#51859205", "title": "Finding location of value from multiple columns", "body": "<p>Here's another way to do it (without an array formula, i.e. without hitting cntrl-enter), based on <a href=\"https://exceljet.net/formula/get-location-of-value-in-2d-array\" rel=\"nofollow noreferrer\">this solution to locate a value in a 2D array</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nbmMZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nbmMZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I won't repeat the excellent explanation of how it works it, in order to properly credit the author on his website.</p>\n\n<blockquote>\n  <p><strong>EDIT:</strong>  Based on @Chronocidal's excellent suggestions, here is the new and improved version for reference:</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/AbIgh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AbIgh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": false, "score": 0, "last_activity_date": 1534338729, "creation_date": 1534338729, "answer_id": 51859413, "question_id": 51858679, "link": "https://stackoverflow.com/questions/51858679/finding-location-of-value-from-multiple-columns/51859413#51859413", "title": "Finding location of value from multiple columns", "body": "<p>And a last one using VBA:</p>\n\n<pre><code>Function FINDaddress(VALUESEARCHED As String, ra As Range) As Variant\n\nDim A As Range\n\n    Set A = ra.Find(What:=VALUESEARCHED, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\nFINDaddress = A.Address\n\nEnd Function\n</code></pre>\n\n<p>After that you only need to use the homemade function: </p>\n\n<pre><code>=FINDaddress(\"a\",A1:D4)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 0, "last_activity_date": 1534339450, "creation_date": 1534339450, "answer_id": 51859585, "question_id": 51858679, "link": "https://stackoverflow.com/questions/51858679/finding-location-of-value-from-multiple-columns/51859585#51859585", "title": "Finding location of value from multiple columns", "body": "<p>You can create a custom <code>Function</code> via VBA:</p>\n\n<hr>\n\n<h2><code>findIn(what, where)</code></h2>\n\n<blockquote>\n  <p><strong>returns</strong>  a \"<code>A1</code>\" styled <code>String</code> of a sought element (<code>what</code>) in a range/array (<code>where</code>).<br>\n  If not contained inside the searched range, returns \"<code>Not found</code>\"</p>\n</blockquote>\n\n<pre><code>Private Function findIn(ByVal what As String, ByVal where As Range) As String\n\n   Dim res As Range\n   Set res = where.Find(what, LookIn:=xlValues)\n\n   If Not res Is Nothing Then\n     findIn = Col_Letter(res.Column) &amp; res.Row 'returns A1 styled result\n   Else\n     findIn = \"Not Found\"\n   End If\n\nEnd Function\n\n'col number to letter by brettdj\n'(so.com)/questions/12796973/function-to-convert-column-number-to-letter/49577009)\nFunction Col_Letter(lngCol As Long) As String\n    Dim vArr\n    vArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\n    Col_Letter = vArr(0)\nEnd Function\n</code></pre>\n\n<p>So if we were to test it, produces result as expected: </p>\n\n<pre><code>Private Sub test()\n    Range(\"E1\") = findIn(\"d\", Range(\"A1:D4\"))\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/sA9sd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sA9sd.png\" alt=\"enter image description here\"></a></p>\n\n<p>Or you can also use it as a Worksheet Function, if you place it inside a separate module (<code>Insert -&gt; Module</code>)</p>\n\n<p><a href=\"https://i.stack.imgur.com/vMRir.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vMRir.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 294, "user_id": 2976401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c5515193d5a58d5d39eff486ed06a92?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/2976401/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1588, "favorite_count": 0, "accepted_answer_id": 51859205, "answer_count": 4, "score": 2, "last_activity_date": 1537762913, "creation_date": 1534336026, "last_edit_date": 1537762913, "question_id": 51858679, "link": "https://stackoverflow.com/questions/51858679/finding-location-of-value-from-multiple-columns", "title": "Finding location of value from multiple columns", "body": "<p>I have a 4x4 table. All the values in the table are unique. </p>\n\n<pre><code>    A   B   C   D\n1   a   b   c   d\n2   e   f   g   h\n3   i   j   k   l\n4   m   n   o   p\n</code></pre>\n\n<p>How do i find the <code>address</code> of a particular value? I've tried <code>=CELL(\"address\",MATCH(A1,A1:D4,0))</code> to find <code>a</code> but it returns an error value because <code>=MATCH(A1,A1:D4,0)</code> is an error value. </p>\n\n<p>It seems <code>=match</code> only works on a single row/column. </p>\n\n<p>Any solutions to this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534336440, "post_id": 51858575, "comment_id": 90669588, "body": "Hi, If it works but you are looking for a critique then consider the <a href=\"https://codereview.stackexchange.com/\">code review site</a>. SO is for specific programming problems. On the face of it the code looks well and good."}, {"owner": {"reputation": 169, "user_id": 9467345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165c58028b315476346cd6b38be59910?s=128&d=identicon&r=PG&f=1", "display_name": "ck3mp", "link": "https://stackoverflow.com/users/9467345/ck3mp"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534336469, "post_id": 51858575, "comment_id": 90669603, "body": "Ah thank you. My apologies."}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 9467345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165c58028b315476346cd6b38be59910?s=128&d=identicon&r=PG&f=1", "display_name": "ck3mp", "link": "https://stackoverflow.com/users/9467345/ck3mp"}, "edited": false, "score": 0, "creation_date": 1534337755, "post_id": 51859060, "comment_id": 90670313, "body": "Thanks. But as stated in the question this doesn&#39;t work for me due to internal networking issues."}, {"owner": {"reputation": 169, "user_id": 9467345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165c58028b315476346cd6b38be59910?s=128&d=identicon&r=PG&f=1", "display_name": "ck3mp", "link": "https://stackoverflow.com/users/9467345/ck3mp"}, "edited": false, "score": 0, "creation_date": 1534338581, "post_id": 51859060, "comment_id": 90670820, "body": "The bottom line under the code &quot;I have used various other methods to download and had working including XMLHTTP and URLDownloadToFile but due to network issues I need the proxy handling that VBA-Web offers...&quot; the issue is we have an internal system that requires an automated login when accessing the outside web."}, {"owner": {"reputation": 169, "user_id": 9467345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165c58028b315476346cd6b38be59910?s=128&d=identicon&r=PG&f=1", "display_name": "ck3mp", "link": "https://stackoverflow.com/users/9467345/ck3mp"}, "edited": false, "score": 1, "creation_date": 1534339017, "post_id": 51859060, "comment_id": 90671052, "body": "Thank you for the help though."}], "tags": [], "owner": {"reputation": 351, "user_id": 10117882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b0785e48cf991cbdce327c31018405?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom Lord", "link": "https://stackoverflow.com/users/10117882/phantom-lord"}, "is_accepted": false, "score": 3, "last_activity_date": 1534337463, "creation_date": 1534337463, "answer_id": 51859060, "question_id": 51858575, "link": "https://stackoverflow.com/questions/51858575/web-download-image-and-save-to-folder/51859060#51859060", "title": "Web download image and save to folder", "body": "<p>no need to use custom libraries, try this</p>\n\n<pre><code>Public Declare Function URLDownloadToFile Lib \"urlmon\" Alias _\n   \"URLDownloadToFileA\" (ByVal pCaller As Long, _\n   ByVal szURL As String, _\n   ByVal szFileName As String, _\n   ByVal dwReserved As Long, _\n   ByVal lpfnCB As Long) As Long\n\nPublic Sub GURoL(url As String, FileName As String)\nDim lngRetVal As Long\n    lngRetVal = URLDownloadToFile(0, url, FileName, 0, 0)\n    If lngRetVal &lt;&gt; 0 Then\n    MsgBox \"GURol godo: Can't download from \" &amp; url &amp; \" to \" &amp; FileName\n    End If\nEnd Sub\n\nSub Download_Procedure()\nCall GURoL(\"http://i.msdn.microsoft.com/ms348103.LOGO_WINDOWS(en-us,MSDN.10).png\", _\n           \"c:\\Temp\\plik.png\") '&lt;change your dest. path\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 10845500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78df246116d215ace6139445c8ebe7a8?s=128&d=identicon&r=PG", "display_name": "Pop", "link": "https://stackoverflow.com/users/10845500/pop"}, "is_accepted": false, "score": 0, "last_activity_date": 1591631224, "creation_date": 1591631224, "answer_id": 62265985, "question_id": 51858575, "link": "https://stackoverflow.com/questions/51858575/web-download-image-and-save-to-folder/62265985#62265985", "title": "Web download image and save to folder", "body": "<p>Note: in case you got the error massage <strong>\"Compile error: The code in this project must be updated for use on 64-bit systems. Please review and update Declare statements and then mark them with the PtrSafe attribute\".</strong> <a href=\"https://i.stack.imgur.com/5fqB5.png\" rel=\"nofollow noreferrer\">Image of this prompted error massage</a><br></p>\n\n<p>try add the <code>PtrSafe</code> keyword to <code>Declare</code> statement could help.</p>\n\n<p>For example, make change of the above code snippet to be </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Declare PtrSafe Function URLDownloadToFile Lib \"urlmon\" Alias _\n</code></pre>\n\n<p>This is also working on Excel 2016 64-bit.</p>\n\n<p>Ref: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ptrsafe-keyword\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ptrsafe-keyword</a></p>\n"}], "owner": {"reputation": 169, "user_id": 9467345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165c58028b315476346cd6b38be59910?s=128&d=identicon&r=PG&f=1", "display_name": "ck3mp", "link": "https://stackoverflow.com/users/9467345/ck3mp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3417, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1593935527, "creation_date": 1534335533, "last_edit_date": 1593935527, "question_id": 51858575, "link": "https://stackoverflow.com/questions/51858575/web-download-image-and-save-to-folder", "title": "Web download image and save to folder", "body": "<p>I am trying to use the VBA-Web library (<a href=\"https://github.com/VBA-tools/VBA-Web\" rel=\"nofollow noreferrer\">https://github.com/VBA-tools/VBA-Web</a>) to download an image and save it to my computer.</p>\n\n<p>This code works fine but I want to check its the right way to get the job done. VBA isn't a my primary experience.</p>\n\n<pre><code>Sub Run()\n\n    Dim client As New WebClient\n    With client\n        .BaseUrl = \"http://chart.apis.google.com/chart?cht=qr&amp;chs=160x160&amp;chld=L|0&amp;chl=hello\"\n        .EnableAutoProxy = True\n    End With\n\n    Dim request As New WebRequest\n    With request\n        .Method = WebMethod.HttpGet\n        .AddHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n    End With\n\n    Dim Response As WebResponse\n    Set Response = client.Execute(request)\n\n    ProcessResponse Response\n\nEnd Sub\n\nSub ProcessResponse(Response As WebResponse)\n\n    Dim oStream As Object\n\n    Set oStream = CreateObject(\"ADODB.Stream\")\n    oStream.Open\n    oStream.Type = 1\n    oStream.Write Response.Body\n    oStream.SaveToFile Environ(\"USERPROFILE\") &amp; \"\\Desktop\\image_test.png\", 2\n    oStream.Close\n\nEnd Sub\n</code></pre>\n\n<p>I have used various other methods to download and had working including XMLHTTP and URLDownloadToFile but due to network issues I need the proxy handling that VBA-Web offers...</p>\n"}, {"tags": ["vba", "excel", "charts", "excel-charts"], "comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1534336119, "post_id": 51858385, "comment_id": 90669421, "body": "what do you expect to do with your &quot;i&quot;?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1534339605, "post_id": 51858385, "comment_id": 90671388, "body": "@Shaon, see my answer. And please take your time to properly give feedback to your previous question. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1534339563, "creation_date": 1534339563, "answer_id": 51859621, "question_id": 51858385, "link": "https://stackoverflow.com/questions/51858385/vba-excel-to-create-chart-on-a-particular-location-of-a-particular-worksheet/51859621#51859621", "title": "VBA Excel to Create Chart on a particular location of a particular worksheet", "body": "<p>you can try this:</p>\n\n<pre><code>    With ActiveSheet.Shapes.AddChart\n        With .Chart\n            .ChartType = xlColumnClustered\n            .SetSourceData Source:=Range(\"Pivot!$A$3:$E$5\").Offset(i)\n            .SeriesCollection(1).ApplyDataLabels\n            .SeriesCollection(2).ApplyDataLabels\n            .SeriesCollection(3).ApplyDataLabels\n            .ShowValueFieldButtons = False\n            .HasTitle = True\n            .ChartTitle.Text = \"Consolidated\"\n        End With\n\n        .Name = \"chart\" &amp; Format(i + 1, \"000\")\n        .Top = Range(\"Pivot!$A$5:$F$18\").Top\n        .Left = Range(\"Pivot!$A$5:$F$18\").Left\n        .Width = Range(\"Pivot!$A$5:$F$18\").Width\n        .Height = Range(\"Pivot!$A$5:$F$18\").Height\n        .LockAspectRatio = msoTrue\n    End With\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 9329168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cc8e9f295a7bd9569253e242a744638?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon", "link": "https://stackoverflow.com/users/9329168/shaon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 51859621, "answer_count": 1, "score": 0, "last_activity_date": 1534339770, "creation_date": 1534334749, "last_edit_date": 1534339770, "question_id": 51858385, "link": "https://stackoverflow.com/questions/51858385/vba-excel-to-create-chart-on-a-particular-location-of-a-particular-worksheet", "title": "VBA Excel to Create Chart on a particular location of a particular worksheet", "body": "<p>I have a code which creates charts.I want to create this chart on a specific worksheet named as \"Charts\" with a particular location A5:F18.My code is given below:</p>\n\n<pre><code>Sub Macro1()\n    Dim i As Long\n\n        Range(\"B5:E5\").Offset(i).Select\n        With ActiveSheet.Shapes.AddChart\n            With .Chart\n                .ChartType = xlColumnClustered\n                .SetSourceData Source:=Range(\"Pivot!$A$3:$E$5\").Offset(i)\n                .SeriesCollection(1).ApplyDataLabels\n                .SeriesCollection(2).ApplyDataLabels\n                .SeriesCollection(3).ApplyDataLabels\n                .ShowValueFieldButtons = False\n                .HasTitle = True\n                .ChartTitle.Text = \"Consolidated\"\n\n                End With\n                .Name = \"chart\" &amp; Format(i + 1, \"000\")\n                .Width = 288\n                .LockAspectRatio = msoTrue\n            End With\nEnd Sub\n</code></pre>\n\n<p>I am not be able to create that chart on that particular worksheet with this particular location. How to do that?</p>\n"}, {"tags": ["python", "r", "excel", "vba"], "comments": [{"owner": {"reputation": 30474, "user_id": 2875563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umbJB.jpg?s=128&g=1", "display_name": "Reblochon Masque", "link": "https://stackoverflow.com/users/2875563/reblochon-masque"}, "reply_to_user": {"reputation": 1601, "user_id": 8258902, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5skEuMLeVww/AAAAAAAAAAI/AAAAAAAAAEI/qEw8kbWS1L0/photo.jpg?sz=128", "display_name": "Mastisa", "link": "https://stackoverflow.com/users/8258902/mastisa"}, "edited": false, "score": 1, "creation_date": 1534334417, "post_id": 51858187, "comment_id": 90668633, "body": "Great formatting in your edid @Saeed, well done! (your profile says &quot;Do It Right, Do It Fast, Do It Once.&quot;, and you&#39;ve lived up to it.)"}, {"owner": {"reputation": 784, "user_id": 6360875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wta2LddsrRY/AAAAAAAAAAI/AAAAAAAAAlA/9mA91SZNpn8/photo.jpg?sz=128", "display_name": "Tanmay jain", "link": "https://stackoverflow.com/users/6360875/tanmay-jain"}, "edited": false, "score": 0, "creation_date": 1534341191, "post_id": 51858187, "comment_id": 90672310, "body": "@user23456 D instead of  getting postponement to M11 should get postponement to M12 right?"}], "answers": [{"tags": [], "owner": {"reputation": 784, "user_id": 6360875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wta2LddsrRY/AAAAAAAAAAI/AAAAAAAAAlA/9mA91SZNpn8/photo.jpg?sz=128", "display_name": "Tanmay jain", "link": "https://stackoverflow.com/users/6360875/tanmay-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1534342000, "creation_date": 1534342000, "answer_id": 51860297, "question_id": 51858187, "link": "https://stackoverflow.com/questions/51858187/track-movement-of-data-between-two-data-sets-or-matrices/51860297#51860297", "title": "Track movement of data between two data sets (or matrices)", "body": "<p>I still have few doubts so was able to generate intermediate output only..\nplease add little more explanation with desired output for the example mentioned with type A, B, C, D</p>\n\n<pre><code>from collections import defaultdict\ndata_2dlist_1 = [\n    ['Type', 'M09' ,'M10', 'M11', 'M12'],\n    ['A' ,  0 , 1 , 2 , 0] ,     \n    ['B' ,  1 , 0 , 0 , 0] ,     \n    ['C' ,  1 , 2 , 0 , 0] ,     \n    ['D' ,  1 , 2 , 2 , 0] ]\n\ndata_2dlist_2 =[\n['Type', 'M09' ,'M10', 'M11', 'M12'],\n['A', 0,   1,   2,   0],\n['B', 0,   0,   1,   0],\n['C', 0,   1,   0,   0],\n['D', 1,   0,   0,   2]]\n\noutput_2d = [['Type', 'M09' ,'M10', 'M11', 'M12']]\nfinal_output_2d = [['Type','Detail','Previous month'  ,'New month']]\n\n\nfor d1, d2 in zip(data_2dlist_1[1:],data_2dlist_2[1:]):\n    #print(d1,d2)\n    output_2d.append([d1[0]]) #new_type row creation\n    looked = defaultdict()\n\n    for i in range(1,len(d1),1):\n\n        if d1[i] == 0: \n            output_2d[-1].append('-')\n\n        elif d1[i] == d2[i]:\n            output_2d[-1].append('no change')\n\n        elif d1[i] != 0: \n            start = i+1\n            if d1[i] in looked:\n                start = looked[d1[i]] + 1\n            try:\n                found_at = d2.index(d1[i],start)\n                output_2d[-1].append('postponement to '+ str(data_2dlist_2[0][found_at]))\n                looked[d1[i]] = found_at\n\n            except ValueError: #not found \n                output_2d[-1].append('cancellation')\n\n        elif d2[i] not in looked: #and d1[i] == 0\n            output_2d[-1].append('new order')\n\nprint(output_2d)\n\n'''       \n\n[['Type', 'M09', 'M10', 'M11', 'M12'],\n['A', '-', 'no change', 'no change', '-'],\n['B', 'postponement to M11', '-', '-', '-'],\n['C', 'postponement to M10', 'cancellation', '-', '-'],\n['D', 'no change', 'postponement to M12', 'cancellation', '-']]\n\n'''\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 10229061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab373a30bcdc1084e8e7c4deb9197a4?s=128&d=identicon&r=PG&f=1", "display_name": "jackie21", "link": "https://stackoverflow.com/users/10229061/jackie21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1594152708, "creation_date": 1534333997, "last_edit_date": 1594152708, "question_id": 51858187, "link": "https://stackoverflow.com/questions/51858187/track-movement-of-data-between-two-data-sets-or-matrices", "title": "Track movement of data between two data sets (or matrices)", "body": "<p>I have two data sets for example July and August data and each number means the number of orders placed.\nI would like to compare the data between the two sets and find any differences between them. \nThere can be three differences mainly<br>\na)= order cancelled (number exists in left dataset and not in right)<br>\nb) = new order (number exists in right dataset but not in left)<br>\nc) = postponed order (number exists in both datasets (but the number in the right dataset exists at a later month M0)<br>\nd) = preponed (to simplify we will assume this does not occur)</p>\n\n<pre><code>     July                       August              \nTypeM09 M10 M11 M12     TypeM09 M10 M11 M12\nA   0   1   2   0       A   0   1   2   0\nB   1   0   0   0       B   0   0   1   0\nC   1   2   0   0       C   0   1   0   0\nD   1   2   2   0       D   1   0   0   2\n</code></pre>\n\n<p>Note - in Type D above, the number 2 occurs twice on the left dataset in M10 and M11, and once on the right dataset in M12. Since the program is checking data from left to right, as soon as the program picks up that M10 (in left dataset) exists in M12 (in right dataset), hence the number in M11 (left dataset is in fact cancelled since there are no more ''free'' numbers for it to match to in the right dataset.</p>\n\n<p>the program should read something like this </p>\n\n<pre><code>Type    M09                   M10                     M11            M12\nA       -                     no change no change     -              -\nB       postponement to M11   -                       -              -\nC       postponement to M10   cancellation  -   -\nD       no change             postponement to M11      cancellation  -\n</code></pre>\n\n<p>As an output I would like to achieve something like this:</p>\n\n<pre><code>Type    Detail          Previous month  New month\nx       Postponement    M07             M11\nx       Postponement    M08             M12\ny       Cancellation    M08             -\nz       New order       -               M12\n</code></pre>\n"}, {"tags": ["vba", "excel", "subdirectory", "fso"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1534333662, "post_id": 51857996, "comment_id": 90668277, "body": "To confirm, you&#39;re just needing to list file in a folder recursively (so it includes sub-folders) is that correct?"}, {"owner": {"reputation": 64, "user_id": 5805873, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153548052914215/picture?type=large", "display_name": "Jacob Crux", "link": "https://stackoverflow.com/users/5805873/jacob-crux"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534334034, "post_id": 51857996, "comment_id": 90668462, "body": "I think so? but I dont know how to call recursively - I&#39;ve seen others doing it but i dont understand it myself,"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534349864, "post_id": 51857996, "comment_id": 90677280, "body": "To find the sub-folders (or any hierarchical subset) you&#39;ll need to use <b>recursion</b> (in this case a <i>self-referring procedure</i>.) There is an example of a self-referring loop <a href=\"https://stackoverflow.com/questions/51857996/searching-directory-for-files-and-listing-their-name-and-path-two-levels-of-su/51858386#comment90677287_51858386\"><b>here</b></a>."}], "answers": [{"comments": [{"owner": {"reputation": 64, "user_id": 5805873, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153548052914215/picture?type=large", "display_name": "Jacob Crux", "link": "https://stackoverflow.com/users/5805873/jacob-crux"}, "edited": false, "score": 0, "creation_date": 1534336429, "post_id": 51858386, "comment_id": 90669585, "body": "Thanks dude - I will check them out"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 64, "user_id": 5805873, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153548052914215/picture?type=large", "display_name": "Jacob Crux", "link": "https://stackoverflow.com/users/5805873/jacob-crux"}, "edited": false, "score": 0, "creation_date": 1534349877, "post_id": 51858386, "comment_id": 90677287, "body": "A recursive procedure is also sometimes called self-referring. There is an example of a <i>self-referring loop</i> right over <a href=\"https://stackoverflow.com/questions/51857996/searching-directory-for-files-and-listing-their-name-and-path-two-levels-of-su#comment90677280_51857996\"><b>here</b></a>."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 3, "last_activity_date": 1534334752, "creation_date": 1534334752, "answer_id": 51858386, "question_id": 51857996, "link": "https://stackoverflow.com/questions/51857996/searching-directory-for-files-and-listing-their-name-and-path-two-levels-of-su/51858386#51858386", "title": "Searching directory for files and listing their name and path - two levels of subfolders", "body": "<p>Further to comments above... </p>\n\n<p>A <strong>recursive</strong> procedure generally repeats into \"lower levels\" <strong><em>by calling itself</em></strong>.  Obviously this can cause an issue if not coded properly, but there are countless code example on this site and others, such as:</p>\n\n<ul>\n<li>Stack Overflow : <strong><a href=\"https://stackoverflow.com/questions/33887223/list-all-files-in-a-folder-and-subfolders-in-excel\">List all files in a folder and subfolders in excel</a></strong>  </li>\n<li>Stack Overflow: <strong><a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">Loop through files in a folder using VBA?</a></strong>  </li>\n<li>Stack Overflow: <strong><a href=\"https://stackoverflow.com/questions/9827715/get-list-of-subdirs-in-vba\">get list of subdirs in vba</a></strong>  </li>\n<li>Stack Overflow: <strong><a href=\"https://stackoverflow.com/questions/20219362/list-files-in-folder-and-subfolder-with-path-to-txt-file\">List files in folder and subfolder with path to .txt file</a></strong>  </li>\n<li>Allen Browne: <a href=\"http://allenbrowne.com/ser-59.html\" rel=\"nofollow noreferrer\"><strong>List files recursively</strong></a>  </li>\n<li>Chip Pearson: <a href=\"http://www.cpearson.com/excel/recursionandfso.htm\" rel=\"nofollow noreferrer\"><strong>Recursion And The FileSystemObject</strong></a>   </li>\n<li>Wikipedia : <a href=\"https://en.wikipedia.org/wiki/Recursion_(computer_science)\" rel=\"nofollow noreferrer\"><strong>Recursion in Computer Science</strong></a></li>\n</ul>\n\n<p>Everything you need to know is contained in (or linked from) those pages.</p>\n"}], "owner": {"reputation": 64, "user_id": 5805873, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153548052914215/picture?type=large", "display_name": "Jacob Crux", "link": "https://stackoverflow.com/users/5805873/jacob-crux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 51858386, "answer_count": 1, "score": 2, "last_activity_date": 1537114041, "creation_date": 1534333200, "last_edit_date": 1537114041, "question_id": 51857996, "link": "https://stackoverflow.com/questions/51857996/searching-directory-for-files-and-listing-their-name-and-path-two-levels-of-su", "title": "Searching directory for files and listing their name and path - two levels of subfolders", "body": "<p>Im currently trying to edit a previously created Macro by another team\nIt very successfully is able to retrieve all file names and paths from a specific location, very useful if all the files are there.</p>\n\n<p>My issue is Im trying to adapt this to another area where the files are held in a \"Storage\" directory\nFrom here they go:</p>\n\n<p>Storage\\ProposalFolder\\(1 of 3 folders)\\File</p>\n\n<p>the 1 of 3 folders thing helps sort them based on what type of proposal they are</p>\n\n<p>Project, Prospect or Suspect</p>\n\n<p>So what I need to do is have a macro thats given the Storage directory and then scans through each Proposal subfolder, then sees which folder type the file is stored in (if the file is in Project, the other 2 folders WILL be empty)</p>\n\n<p>Please see below</p>\n\n<p>Storage View</p>\n\n<p><a href=\"https://i.stack.imgur.com/deGAw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/deGAw.png\" alt=\"Storage view\"></a></p>\n\n<p>Proposal Folder</p>\n\n<p><a href=\"https://i.stack.imgur.com/goGcG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/goGcG.png\" alt=\"1st level view\"></a></p>\n\n<p>Project/prospect/suspect folder</p>\n\n<p><a href=\"https://i.stack.imgur.com/WZOqN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WZOqN.png\" alt=\"File level view\"></a></p>\n\n<p>This is the code left behind - I've edited it here and there</p>\n\n<pre><code>Sub ListFilesInDirectory()\n\nIf MsgBox(\"Are you sure you want to list the files?\", vbYesNo) = vbNo Then\nEnd\nElse\nEnd If\n\nSelect Case MsgBox(\"Press Yes to retrieve ALL files.\" &amp; vbNewLine &amp; vbNewLine &amp; \"Press No to retrieve *** files only\", vbQuestion + vbYesNoCancel + vbDefaultButton1, \"Which Do You Want To Retrieve?\")\nCase vbCancel\nEnd\nCase vbNo\n***_Option = 1\nCase vbYes\n***_Option = 2\nEnd Select\n\n\nDim counter As Single\ncounter = Timer\n\nOn Error GoTo error_message\nApplication.StatusBar = \"The macro is running. Please wait...\"\n\n\nApplication.Calculation = xlCalculationManual\nRange(\"A7:KZ10000\").Select\nSelection.ClearContents\nCells.FormatConditions.Delete\nRange(\"A1\").Select\nApplication.ScreenUpdating = False\n\n\n'Populate columns A to C\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim ws As Worksheet\n    Dim objSubfolders As Object\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set ws = ActiveSheet\n\n    startrow = 7\n\n\n    If IsEmpty(Range(\"file_directory\")) Then\n        GoTo skip_this\n        Else\n        filedir = Range(\"file_directory\").Value\n    End If\n\n\n    'Get the folder object associated with the directory\n    Set objFolder = objFSO.GetFolder(filedir)\n    Set objSubfolders = objFolder.subfolders\n    'ws.Cells(1, 1).Value = \"The files found in \" &amp; objFolder.Name &amp; \" are:\"\n\n     'Loop through the Files collection\n    If ***_Option = 1 Then\n     For Each objFile In objFolder.Files\n     DoEvents\n\n      If InStr(UCase(objFile.Name), \"****\") &gt; 0 Then\n        ws.Cells(startrow, 1).Value = filedir\n'        ws.Cells(startrow, 2).Value = \"=HYPERLINK(\" &amp; Chr(34) &amp; filedir &amp; \"\\\" &amp; objFile.Name &amp; Chr(34) &amp; \",\" &amp; Chr(34) &amp; objFile.Name &amp; Chr(34) &amp; \")\"\n        ws.Cells(startrow, 2).Value = objFile.Name\n        ws.Cells(startrow, 2).Hyperlinks.Add ws.Cells(startrow, 2), filedir &amp; \"\\\" &amp; objFile.Name\n\n        ws.Cells(startrow, 3).Value = objFile.DateLastModified\n        startrow = startrow + 1\n      End If\n     Next\n    End If\n\n    If ***_Option = 2 Then\n    For Each objFile In objFolder.Files\n     DoEvents\n        ws.Cells(startrow, 1).Value = filedir\n'        ws.Cells(startrow, 2).Value = \"=HYPERLINK(\" &amp; Chr(34) &amp; filedir &amp; \"\\\" &amp; objFile.Name &amp; Chr(34) &amp; \",\" &amp; Chr(34) &amp; objFile.Name &amp; Chr(34) &amp; \")\"\n        ws.Cells(startrow, 2).Value = objFile.Name\n        ws.Cells(startrow, 2).Hyperlinks.Add ws.Cells(startrow, 2), filedir &amp; \"\\\" &amp; objFile.Name\n        ws.Cells(startrow, 3).Formula = \"=CONCATENATE(\" &amp; startrow &amp; \"2,\" &amp; startrow &amp; \"3)\"\n        startrow = startrow + 1\n     Next\n\n'    For Each SubFolder In objSubfolders\n'\n'     For Each objFile In objSubfolders.Files\n'     DoEvents\n'        ws.Cells(startrow, 1).Value = filedir\n''        ws.Cells(startrow, 2).Value = \"=HYPERLINK(\" &amp; Chr(34) &amp; filedir &amp; \"\\\" &amp; objFile.Name &amp; Chr(34) &amp; \",\" &amp; Chr(34) &amp; objFile.Name &amp; Chr(34) &amp; \")\"\n'        ws.Cells(startrow, 2).Value = objFile.Name\n'        ws.Cells(startrow, 2).Hyperlinks.Add ws.Cells(startrow, 2), filedir &amp; \"\\\" &amp; objFile.Name\n'        ws.Cells(startrow, 3).Value = objFile.DateLastModified\n'        startrow = startrow + 1\n'     Next\n'    Next SubFolder\n    End If\n\n\n'        For Each SubFolder In SourceFolder.subfolders\n'            ListFilesInFolder SubFolder.Path, True\n'        Next SubFolder\n'\n'    If subfolders = True Then\n'        For Each SubFolder In SourceFolder.subfolders\n'            ListFilesInFolder SubFolder.Path, True\n'        Next SubFolder\n'    End If\n\nskip_this:\n  Next\n\n    Set objFolder = Nothing\n    Set objFile = Nothing\n    Set objFSO = Nothing\n\n    lastrow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'Format any potential error files in red\n    Cells.FormatConditions.Delete\n    Range(\"B7:B\" &amp; lastrow).Select\n\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n        \"=RIGHT(B7,5)&lt;&gt;\"\".xlsm\"\"\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Font\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = 0\n    End With\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 255\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n        \"=LEFT(B7,1)=\"\"~\"\"\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Font\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = 0\n    End With\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 255\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = True\n\n\n'Range(\"C4\").Select\n'ActiveCell.FormulaR1C1 = \"Date\" &amp; Chr(10) &amp; \"Modified\"\n\nRange(\"C7:C\" &amp; lastrow).Select\nSelection.NumberFormat = \"dd/mm/yyyy  hh:mm:ss\"\nSelection.HorizontalAlignment = xlCenter\n\nRange(\"A1\").Select\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.StatusBar = False\n\nMsgBox (\"Time taken to list files (hr:min:sec): \" &amp; Format((Timer - counter) / 86400, \"hh:mm:ss\") &amp; vbNewLine &amp; vbNewLine &amp; \"Please now do an initial cleanup of the files listed:\" &amp; vbNewLine &amp; \"  1) Delete any obvious older versions of the files\" &amp; vbNewLine &amp; \"  2) Files highlighted red are likely to be incorrect and should be deleted\")\n\nExit Sub\nerror_message:\nIf Err.Number &lt;&gt; 0 Then\n     Msg = \"Error # \" &amp; Str(Err.Number) &amp; \" was generated by \" _\n         &amp; Err.Source &amp; Chr(13) &amp; \"Error Line: \" &amp; Erl &amp; Chr(13) &amp; Err.Description\n     MsgBox Msg, , \"Error\", Err.HelpFile, Err.HelpContext\n     End If\nRange(\"A7:KZ10000\").Select\nSelection.ClearContents\nCells.FormatConditions.Delete\nRange(\"A1\").Select\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.StatusBar = False\nMsgBox (\"You have entered an incorrect directory path. Please ensure the 3 cells in the Variables tab are showing valid directory paths, or the cells are empty\")\nEnd Sub\n</code></pre>\n\n<p>What I need to do is list the files in the subfolders just like the \"For each objFile\" code does, but I cant get my head around how to go further than one level of subfolders - the code commented out about subfolders was me :/</p>\n\n<p>Any help would be super!</p>\n"}, {"tags": ["vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1534334457, "post_id": 51857887, "comment_id": 90668649, "body": "Just use the table as row source. What specifically doesn&#39;t work?"}, {"owner": {"reputation": 21, "user_id": 10229014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-APz9VnW3diM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ohtGQ8tGAQQ-ZCEhGy_A_9k_ms5w/mo/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/10229014/tony"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534427431, "post_id": 51857887, "comment_id": 90708682, "body": "Honestly I&#39;m not sure where to start. I am in just in the beginning stages of learning VBA and have watched a few tutorials but couldn&#39;t find anything relevant online."}, {"owner": {"reputation": 21, "user_id": 10229014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-APz9VnW3diM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ohtGQ8tGAQQ-ZCEhGy_A_9k_ms5w/mo/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/10229014/tony"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1534431588, "post_id": 51857887, "comment_id": 90711592, "body": "Okay so I did get it working and can populate the listbox with the table data. I used the following code:.                     Listbox.rowsource = &quot;SELECT tablename.fieldname FROM tablename&quot;"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534434256, "post_id": 51857887, "comment_id": 90713141, "body": "Good! You learn much more by trying things and reading documentation or examples than by asking questions. You can post this as answer, and later accept that answer, to resolve your question."}, {"owner": {"reputation": 21, "user_id": 10229014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-APz9VnW3diM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ohtGQ8tGAQQ-ZCEhGy_A_9k_ms5w/mo/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/10229014/tony"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534446758, "post_id": 51857887, "comment_id": 90719453, "body": "I definitely find that when I have something specific to achieve it helps me learn a language faster."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10229014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-APz9VnW3diM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ohtGQ8tGAQQ-ZCEhGy_A_9k_ms5w/mo/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/10229014/tony"}, "is_accepted": true, "score": 1, "last_activity_date": 1534446667, "creation_date": 1534446667, "answer_id": 51883924, "question_id": 51857887, "link": "https://stackoverflow.com/questions/51857887/how-to-populate-listbox-from-linked-table/51883924#51883924", "title": "How to populate listbox from linked table?", "body": "<p>Thanks to Andre I found a working solution which is shown below:</p>\n\n<p>Listbox.rowsource = \"SELECT tablename.fieldname FROM tablename\" </p>\n\n<p>This pulls record(s) from my table and shows them in the listbox. For simplicity sake I only included a single column name but the actual code I used included 4 columns.  </p>\n"}], "owner": {"reputation": 21, "user_id": 10229014, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-APz9VnW3diM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ohtGQ8tGAQQ-ZCEhGy_A_9k_ms5w/mo/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/10229014/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 0, "accepted_answer_id": 51883924, "answer_count": 1, "score": 0, "last_activity_date": 1537566640, "creation_date": 1534332747, "last_edit_date": 1537566640, "question_id": 51857887, "link": "https://stackoverflow.com/questions/51857887/how-to-populate-listbox-from-linked-table", "title": "How to populate listbox from linked table?", "body": "<p>I am working with a database that has an Excel table.</p>\n\n<p>I created a form and want to populate a listbox with the contents of the linked table when the form loads.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534332621, "post_id": 51857104, "comment_id": 90667791, "body": "Note: Instead of <code>On Error Resume Next</code> you should use <code>On Error Goto exitHandler</code> otherwise this is no proper error handling. \u2022 And there are 2 <code>End Sub</code> in your code."}, {"owner": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "edited": false, "score": 0, "creation_date": 1534332876, "post_id": 51857104, "comment_id": 90667901, "body": "Can you explain or show the layout of your spreadsheet. I think youll need to use the <code>MergeArea</code> property and then <code>ClearContents</code> and if you mean you need to clear contents to the left of the changed column then your ofssets will need to be negative"}, {"owner": {"reputation": 57, "user_id": 9145814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089c6b34291f4fed4b5127791ad678f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Halili", "link": "https://stackoverflow.com/users/9145814/mr-halili"}, "reply_to_user": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "edited": false, "score": 0, "creation_date": 1534422397, "post_id": 51857104, "comment_id": 90705244, "body": "Thank you for your answers. @Peh , I&#39;ll change the <code>On Error Resume Next</code>. The second <code>End Sub</code> is by accident.  @maxhob17 , The layout of the spreadsheet is from Right To Left. It means the first column (column A) is in the right hand (Hebrew language). Can you give me an example of how <code>MergeArea</code> property should be applied in this case?"}, {"owner": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "edited": false, "score": 0, "creation_date": 1534433879, "post_id": 51857104, "comment_id": 90712931, "body": "@MrHalili, sure I think you would stick it on the end of the range before the <code>ClearContents</code> like so: <code>Range(Target.Offset(0, 1), Target.Offset(0, 2)).MergeArea.ClearContents</code>"}, {"owner": {"reputation": 57, "user_id": 9145814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089c6b34291f4fed4b5127791ad678f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Halili", "link": "https://stackoverflow.com/users/9145814/mr-halili"}, "reply_to_user": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "edited": false, "score": 0, "creation_date": 1534442220, "post_id": 51857104, "comment_id": 90717259, "body": "@maxhob17 Thank you! it works very good! But I have to eliminate <code>Range(Target...</code> and for every offset write separate code line i.e. <code>Target.Offset(0, 1).MergeArea.ClearContents   Target.Offset(0, 2).MergeArea.ClearContents</code> any Idea why the Range(Target... does not work?"}], "owner": {"reputation": 57, "user_id": 9145814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089c6b34291f4fed4b5127791ad678f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Halili", "link": "https://stackoverflow.com/users/9145814/mr-halili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 481, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1594152728, "creation_date": 1534329195, "last_edit_date": 1594152728, "question_id": 51857104, "link": "https://stackoverflow.com/questions/51857104/clearing-contents-of-dependent-drop-down-lists-in-merged-cells-using-vba-code", "title": "Clearing contents of dependent drop down lists in merged cells using VBA code", "body": "<p>I have multiple dependent drop down lists and I want to clear the contents of child drop down lists when the parent content is changed by the user.\nI found the following sample code, </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'clear contents of dependent cells\n    On Error Resume Next\n    If Target.Validation.Type = 3 Then\n        Application.EnableEvents = False\n        Select Case Target.Column\n            Case 2  'clear columns C and D\n                Range(Target.Offset(0, 1), _\n                  Target.Offset(0, 2)).ClearContents\n            Case 3  'clear column D\n                Target.Offset(0, 1).ClearContents\n        End Select\n    End If\n\nexitHandler:\n    Application.EnableEvents = True\n    Exit Sub\n\nEnd Sub\n\nEnd Sub\n</code></pre>\n\n<p>But it does not work for me and I assume that it is due to one or both reasons: </p>\n\n<ol>\n<li>my drop down lists are in merged cells; </li>\n<li>I use a Right To Left worksheet.</li>\n</ol>\n\n<p>I'd like to know what changes I should make to the code so it will work.</p>\n\n<p>Thank You.</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1534329399, "post_id": 51857079, "comment_id": 90666463, "body": "Have your source dates in format yyyy-mm-dd"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1534334598, "post_id": 51857079, "comment_id": 90668709, "body": "If your region is UK, specify the <code>Local:=True</code> argument when opening the file."}, {"owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1534335686, "post_id": 51857079, "comment_id": 90669220, "body": "@Rory thanks rory, I open the file using the below code; Set wb1 = Workbooks.Open(FFile) where would local:=true fit into this?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1534338692, "post_id": 51857079, "comment_id": 90670878, "body": "Like this: <code>Set wb1 = Workbooks.Open(filename:=FFile, local:=true)</code>"}], "owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 584, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534329062, "creation_date": 1534329062, "question_id": 51857079, "link": "https://stackoverflow.com/questions/51857079/forcing-uk-date-format-excel-vba", "title": "Forcing UK date Format Excel VBA", "body": "<p>All I have the below code which essentially formats Col J:J of the transaction lines. To DD-MM-YY however the date format is appearing as MM-DD-YY American format is there a better way to ensure it is always DD-MM-YY</p>\n\n<pre><code>Sub Formatdate()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nDim sPath As String, sFile As String\nDim wb As Workbook\nDim wbname As String\nwbname = \"Transactions.csv\"\nsPath = \"\\\\Csdatg04\\psproject\\Robot\\Project Preload\\Transactions\\Robot WIP\\\"\nsFile = sPath &amp; \"Transactions.csv\"\nSet wb = Workbooks.Open(sFile)\n\n\nWorkbooks(wbname).Worksheets(1).Range(\"J:J\").EntireColumn.NumberFormat = \"DD-MM-YYYY\"\nWorkbooks(wbname).Close True\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1534329347, "post_id": 51857062, "comment_id": 90666440, "body": "If I add a hyperlink to a cell and then hide the column that cells resides in, I don&#39;t get a hand appearing. You say the hyperlink is in a text box? How is the text box hidden? Also, welcome to SO... it is customary to include your first coding/formula attempts at this to show your research effort and avoid closure on grounds of too broad."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 1, "creation_date": 1534330197, "post_id": 51857062, "comment_id": 90666751, "body": "Please show us <a href=\"https://mattgemmell.com/what-have-you-tried/\" rel=\"nofollow noreferrer\">what you have tried</a>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1534330222, "post_id": 51857062, "comment_id": 90666764, "body": "@divindunk: Welcome to Stack Overflow: Please <a href=\"https://stackoverflow.com/tour\">take the tour</a> and read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>, then edit your question and be sure to ask a <a href=\"http://idownvotedbecau.se/unclearquestion\" rel=\"nofollow noreferrer\">good, clear, concise question</a>,  include the code, expected  behaviour, and what is wrong... then we can try to help"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 2, "creation_date": 1534330257, "post_id": 51857062, "comment_id": 90666783, "body": "@divindunk: I Downvoted/voted to close because you didn&#39;t include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> , it looks like <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">no attempt was made</a>, and it looks like <a href=\"http://idownvotedbecau.se/noresearch/\" rel=\"nofollow noreferrer\">no research</a> was done."}, {"owner": {"reputation": 11, "user_id": 10228719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d11fb8dd6a4cdd8a8bd3fb4ebbc0d1?s=128&d=identicon&r=PG&f=1", "display_name": "DivinDunk", "link": "https://stackoverflow.com/users/10228719/divindunk"}, "edited": false, "score": 0, "creation_date": 1534335587, "post_id": 51857062, "comment_id": 90669183, "body": "I&#39;ve edited my question hope I have got it right this time"}], "owner": {"reputation": 11, "user_id": 10228719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d11fb8dd6a4cdd8a8bd3fb4ebbc0d1?s=128&d=identicon&r=PG&f=1", "display_name": "DivinDunk", "link": "https://stackoverflow.com/users/10228719/divindunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534335460, "creation_date": 1534328940, "last_edit_date": 1534335460, "question_id": 51857062, "link": "https://stackoverflow.com/questions/51857062/activate-deactivate-hyperlinks", "title": "Activate/Deactivate Hyperlinks", "body": "<p>This is my first go at asking a question so apologies to all if I haven't given enough info or messed up in some other way!</p>\n\n<p>I have a sheet with areas which are hidden until required by the user. These are called for with a button and another button to hide them all again when creating a new workbook. The hidden areas each contain a hyperlink (these take the user to other sheets in the workbook) in a text box (this allows the hyperlink to work when the sheet is protected). My problem is that the hyperlinks are still active and the cursor shows a hand when over these hyperlinks even when they are hidden. How can I deactivate a hyperlink while it is hidden using VBA or a macro? Any assistance will be very welcome. Thanks</p>\n\n<p>The sections on the sheet are hidden/shown by code which changes the color to the same as the background I didn't want to close columns or rows as I wanted to maintain the header and size of the sheet. </p>\n\n<p>All the coding works for what I have done but have spent a long time trying to find an answer to my question without success. The hidden sections are up to 12 blocks of data entry cells which will be used dependant on the users project requirements. </p>\n\n<p>A sections of the code I have placed below are for making block 12 appear and then next routine is for hiding all the blocks except number 1. The next is a sub routine that I have for hiding the text box of block number 2. I decided to change from having the hyperlink in a cell to a text box to allow the sheet to be protected but still use the hyperlinks for view only purposes. I have added the code for the routine for hiding the text box and it was this I was experimenting with to disable the hyperlink. However the only bit of code I could find that looked like it might do the job was EnableEvents but I couldn't achieve what I wanted with that, so here I am.</p>\n\n<p>I'm sure you can see that I am note a programmer I borrow bits of code and stick them together and play with it until it works but I've run out of bits to stick and time to play. </p>\n\n<pre><code>Sub AppearCompOp12()\n'\n' AppearCompOp12 Macro\n'\n\n'\n    Range(\"ar22:bd28\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    With Selection.Font\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n    End With\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    Range(\"AR22\").Select\n    Selection.Font.Size = 16\n    With Selection.Font\n        .Color = -65536\n        .TintAndShade = 0\n    End With\nEnd Sub\n\nSub ResetCapMSADashboard()\n'\n' ResetCapMSADashboard Macro\n'\n\n'\n    Range( _\n        \"P6:AB12,AD6:AP12,AR6:BD12,AR14:BD20,AR22:BD28,AD14:AP20,AD22:AP28,P14:AB20,B14:N20,B22:N28,P22:AB28\" _\n        ).Select\n    With Selection.Font\n        .Color = RGB(217, 217, 217)\n    End With\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = -0.149998474074526\n        .PatternTintAndShade = 0\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ThemeColor = 1\n        .TintAndShade = -0.14996795556505\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ThemeColor = 1\n        .TintAndShade = -0.14996795556505\n        .Weight = xlThin\n    End With\nWith Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ThemeColor = 1\n        .TintAndShade = -0.14996795556505\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ThemeColor = 1\n        .TintAndShade = -0.14996795556505\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ThemeColor = 1\n        .TintAndShade = -0.14996795556505\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ThemeColor = 1\n        .TintAndShade = -0.14996795556505\n        .Weight = xlThin\n    End With\n    Range(\"BG2:BG26\").Select\n    Selection.ClearContents\n    Range(\"J7\").Select\n\nEnd Sub\n\nSub RecolourTB2()\n'\n' Change text box &amp; text to background colourbox\n\n'\n    ActiveSheet.Shapes.Range(Array(\"TextBox 9\")).Select\n\n    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill\n        .Visible = msoTrue\n        .ForeColor.ObjectThemeColor = msoThemeColorBackground1\n        .ForeColor.TintAndShade = 0\n        .ForeColor.Brightness = -0.25\n        .Transparency = 0\n        .Solid\n    End With\n    Range(\"P10:W10\").Select\n    ActiveSheet.Shapes.Range(Array(\"TextBox 9\")).Select\n    EnableEvents = False\n    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill\n\n        .Visible = msoTrue\n        .ForeColor.ObjectThemeColor = msoThemeColorBackground1\n        .ForeColor.TintAndShade = 0\n        .ForeColor.Brightness = -0.150000006\n        .Transparency = 0\n        .Solid\n    End With\n    Range(\"P9:W9\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "hide"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5182705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mJFxg.jpg?s=128&g=1", "display_name": "StMatthias", "link": "https://stackoverflow.com/users/5182705/stmatthias"}, "edited": false, "score": 0, "creation_date": 1534334164, "post_id": 51857271, "comment_id": 90668532, "body": "Thanks for that! Worked perfectly!"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1534331689, "last_edit_date": 1534331689, "creation_date": 1534329941, "answer_id": 51857271, "question_id": 51856810, "link": "https://stackoverflow.com/questions/51856810/hiding-columns-containing-errors-macro/51857271#51857271", "title": "Hiding columns containing errors macro", "body": "<p>The Text <code>#Value!</code> is  not the <em>value</em> of the cell, it is just the way Excel tells you that there is something wrong - maybe an invalid formula.</p>\n\n<p>To check this in VBA, use the function <code>isError</code>:</p>\n\n<pre><code>if isError(c.Value) then\n</code></pre>\n\n<p>An <em>error</em> is handled as special type in VBA, and if you compare an error with a string (or any other data type), you get an error 13 (\"Type mismatch\"). </p>\n"}], "owner": {"reputation": 13, "user_id": 5182705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mJFxg.jpg?s=128&g=1", "display_name": "StMatthias", "link": "https://stackoverflow.com/users/5182705/stmatthias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 51857271, "answer_count": 1, "score": 0, "last_activity_date": 1534331689, "creation_date": 1534327845, "question_id": 51856810, "link": "https://stackoverflow.com/questions/51856810/hiding-columns-containing-errors-macro", "title": "Hiding columns containing errors macro", "body": "<p>new to VBA and building a macro such that when cells contain an error it when hide the column. I tried this after looking around a bit and it doesn't work for me at all - \"error 13\"?</p>\n\n<pre><code>`Sub Hide_error()\n'hides errors in the price tab\n\nSheets(\"blah\").Select\n\nDim c As Range\nFor Each c In Range(\"B1:JQ262\")\nIf c.Value = \"#Value!\" Then\nc.EntireColumn.Hidden = True\n\nEnd If\nNext c\n\nEnd Sub`\n</code></pre>\n\n<p>Really struggling to find a way of getting a solution to this.</p>\n\n<p>Thanks,</p>\n\n<p>Matt.</p>\n"}, {"tags": ["mysql", "sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 680, "user_id": 6368134, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1538400889803206/picture?type=large", "display_name": "Ines Tlili", "link": "https://stackoverflow.com/users/6368134/ines-tlili"}, "edited": false, "score": 0, "creation_date": 1534327260, "post_id": 51856631, "comment_id": 90665505, "body": "Post the error please"}, {"owner": {"reputation": 3, "user_id": 10132423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8LvEOCO_mKk/AAAAAAAAAAI/AAAAAAAAAFY/YCExA0pmcpc/photo.jpg?sz=128", "display_name": "Samuel Bland", "link": "https://stackoverflow.com/users/10132423/samuel-bland"}, "reply_to_user": {"reputation": 680, "user_id": 6368134, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1538400889803206/picture?type=large", "display_name": "Ines Tlili", "link": "https://stackoverflow.com/users/6368134/ines-tlili"}, "edited": false, "score": 0, "creation_date": 1534327392, "post_id": 51856631, "comment_id": 90665580, "body": "<a href=\"http://prntscr.com/kiue0s\" rel=\"nofollow noreferrer\">prntscr.com/kiue0s</a>"}, {"owner": {"reputation": 253873, "user_id": 9515207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34932d3e923ffad9a4a1423e30b1d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "CertainPerformance", "link": "https://stackoverflow.com/users/9515207/certainperformance"}, "edited": false, "score": 0, "creation_date": 1534328349, "post_id": 51856631, "comment_id": 90666031, "body": "Don&#39;t paste pictures of error messages, put the actual error message into your question"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10132423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8LvEOCO_mKk/AAAAAAAAAAI/AAAAAAAAAFY/YCExA0pmcpc/photo.jpg?sz=128", "display_name": "Samuel Bland", "link": "https://stackoverflow.com/users/10132423/samuel-bland"}, "edited": false, "score": 0, "creation_date": 1534327716, "post_id": 51856714, "comment_id": 90665744, "body": "Ok thankyou, I will try that. Though the confusing thing is that I have the same query working elsewhere in Access, but it&#39;s just inputting different values into a different table."}, {"owner": {"reputation": 3, "user_id": 10132423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8LvEOCO_mKk/AAAAAAAAAAI/AAAAAAAAAFY/YCExA0pmcpc/photo.jpg?sz=128", "display_name": "Samuel Bland", "link": "https://stackoverflow.com/users/10132423/samuel-bland"}, "edited": false, "score": 0, "creation_date": 1534328614, "post_id": 51856714, "comment_id": 90666154, "body": "This hasn&#39;t worked. But as a general note. The correct concatenated code was <code>VALUES (&quot; &amp; recordDate &amp; &quot;,&#39;&quot; &amp; recordType &amp; &quot;&#39;,&#39;&quot; &amp; recordNotes &amp; &quot;&#39;,&quot; &amp; paymentValue &amp; &quot;,&quot; &amp; clientID &amp; &quot;,&quot; &amp; jobID &amp; &quot;)&quot;</code>  - Different delimiters for string variables and anything else (integer, date) Thanks anyway"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3, "user_id": 10132423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8LvEOCO_mKk/AAAAAAAAAAI/AAAAAAAAAFY/YCExA0pmcpc/photo.jpg?sz=128", "display_name": "Samuel Bland", "link": "https://stackoverflow.com/users/10132423/samuel-bland"}, "edited": false, "score": 0, "creation_date": 1534331478, "post_id": 51856714, "comment_id": 90667282, "body": "OK, but the date must be formatted and delimited as well. See how in my link above."}, {"owner": {"reputation": 3, "user_id": 10132423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8LvEOCO_mKk/AAAAAAAAAAI/AAAAAAAAAFY/YCExA0pmcpc/photo.jpg?sz=128", "display_name": "Samuel Bland", "link": "https://stackoverflow.com/users/10132423/samuel-bland"}, "edited": false, "score": 0, "creation_date": 1534331628, "post_id": 51856714, "comment_id": 90667357, "body": "Yeah. My code and your code are both same for parsing the date variable, I was saying that we&#39;d need different formatting for sending string variables. With an apostrophe."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1534327463, "creation_date": 1534327463, "answer_id": 51856714, "question_id": 51856631, "link": "https://stackoverflow.com/questions/51856631/whats-wrong-with-this-sql-code-vba-ms-access/51856714#51856714", "title": "What&#39;s wrong with this SQL code? (VBA MS Access)", "body": "<p>You must concatenate the values:</p>\n\n<pre><code>\" .. VALUES (\" &amp; recordDate &amp; \",\" &amp; recordType &amp; \",\" &amp; recordNotes &amp; \",\" &amp; paymentValue &amp; \",\" &amp; clientID &amp; \",\" &amp; jobID)\"\n</code></pre>\n\n<p>Also, the values must be formatted and delimited correctly, for example by using my function <a href=\"https://stackoverflow.com/questions/43589800/syntax-error-in-insert-into-statement-whats-the-error/43591778#43591778\">CSql</a>.</p>\n\n<p>Even better, use parameters.</p>\n"}], "owner": {"reputation": 3, "user_id": 10132423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8LvEOCO_mKk/AAAAAAAAAAI/AAAAAAAAAFY/YCExA0pmcpc/photo.jpg?sz=128", "display_name": "Samuel Bland", "link": "https://stackoverflow.com/users/10132423/samuel-bland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 51856714, "answer_count": 1, "score": -1, "last_activity_date": 1534328317, "creation_date": 1534327086, "last_edit_date": 1534328317, "question_id": 51856631, "link": "https://stackoverflow.com/questions/51856631/whats-wrong-with-this-sql-code-vba-ms-access", "title": "What&#39;s wrong with this SQL code? (VBA MS Access)", "body": "<pre><code>insertString = \"INSERT INTO paymentRecord(paymentEventDate,paymentType,paymentRecordNotes,value,clientID,jobID) \nVALUES (recordDate,recordType,recordNotes,paymentValue,clientID,jobID);\"\nDoCmd.SetWarnings False\nDoCmd.RunSQL insertString\nDoCmd.SetWarnings True\n</code></pre>\n\n<p>This code returns a syntax error and I don't know why. All insert values and columns are correct.</p>\n\n<p>The code is being used in a MS Access front-end with a MySQL database back-end.</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 3565178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e81a7671c491c5b2016ece07dab316?s=128&d=identicon&r=PG&f=1", "display_name": "user3565178", "link": "https://stackoverflow.com/users/3565178/user3565178"}, "edited": false, "score": 0, "creation_date": 1534327367, "post_id": 51856612, "comment_id": 90665566, "body": "Hi Andre,Thank you, I have tried this but still get #Error. I believe it may be to do with how he has the column heading set up, they are Jan 18, Feb 18 etc etc"}, {"owner": {"reputation": 5, "user_id": 3565178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e81a7671c491c5b2016ece07dab316?s=128&d=identicon&r=PG&f=1", "display_name": "user3565178", "link": "https://stackoverflow.com/users/3565178/user3565178"}, "edited": false, "score": 0, "creation_date": 1534327697, "post_id": 51856612, "comment_id": 90665730, "body": "Sorry that was my fault pressing enter to go to the next line not realizing it would post the comment haha. Do you think the column headers would cause the issue?"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1534327909, "last_edit_date": 1534327909, "creation_date": 1534326998, "answer_id": 51856612, "question_id": 51856232, "link": "https://stackoverflow.com/questions/51856232/access-form-dlookup-using-a-combo-box-for-the-expression-value/51856612#51856612", "title": "Access Form Dlookup - Using a Combo box for the expression value", "body": "<p>Look closely at your code. You are passing the literal string <code>\" &amp; [Combo8] &amp; \"</code> (including spaces and ampersands) as first parameter to <code>DLookup</code>.</p>\n\n<p>Try</p>\n\n<pre><code>=DLookUp([Combo8], \"Product Guidelines\", \"PC = '\" &amp; [Combo2] &amp; \"'\")\n</code></pre>\n\n<p>or if the content of <code>Combo8</code> has spaces,</p>\n\n<pre><code>=DLookUp(\"[\" &amp; [Combo8] &amp; \"]\", \"Product Guidelines\", \"PC = '\" &amp; [Combo2] &amp; \"'\")\n</code></pre>\n\n<p>or maybe even with quotes around it:</p>\n\n<pre><code>=DLookUp(\"\"\"[\" &amp; [Combo8] &amp; \"]\"\"\", \"Product Guidelines\", \"PC = '\" &amp; [Combo2] &amp; \"'\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1534327923, "creation_date": 1534327923, "answer_id": 51856823, "question_id": 51856232, "link": "https://stackoverflow.com/questions/51856232/access-form-dlookup-using-a-combo-box-for-the-expression-value/51856823#51856823", "title": "Access Form Dlookup - Using a Combo box for the expression value", "body": "<p>The syntax would be:</p>\n\n<pre><code>=DLookUp(\"[FieldNameToLookUp]\",\"[Product Guidelines]\",\"PC = '\" &amp; Me![Combo2] &amp; \"'\")\n</code></pre>\n\n<p>as you probably don't have a field named Combo8. </p>\n\n<p>If Combo8 holds that name, it would be:</p>\n\n<pre><code>=DLookUp(\"[\" &amp; Me!Combo8 &amp; \"]\",\"[Product Guidelines]\",\"PC = '\" &amp; Me![Combo2] &amp; \"'\")\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 3565178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e81a7671c491c5b2016ece07dab316?s=128&d=identicon&r=PG&f=1", "display_name": "user3565178", "link": "https://stackoverflow.com/users/3565178/user3565178"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 51856612, "answer_count": 2, "score": 0, "last_activity_date": 1534327923, "creation_date": 1534325498, "last_edit_date": 1534326897, "question_id": 51856232, "link": "https://stackoverflow.com/questions/51856232/access-form-dlookup-using-a-combo-box-for-the-expression-value", "title": "Access Form Dlookup - Using a Combo box for the expression value", "body": "<p>Good Morning,</p>\n\n<p>I am doing some work for a colleague and he wants a form creating where he can change to column that is looked at through a combo box as well as the criteria</p>\n\n<p>I have tried the following </p>\n\n<pre><code>=DLookUp(\" &amp; [Combo8] &amp; \",\"Product Guidelines\",\"PC =  '\" &amp; [Combo2] &amp; \"'\")\n</code></pre>\n\n<p>but get an error, if i hard code the expression to one of the columns it works fine but when it's set to look at the combo box it doesn't work, I have tried several variants of the code but have no ran out of ideas</p>\n\n<p>Please can someone help</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10086705"}, "edited": false, "score": 0, "creation_date": 1534328577, "post_id": 51856376, "comment_id": 90666140, "body": "Discovered one problem,  for some reason range1 goes further then range2/3 and fills in a series of #N/A And in a other instance it does not reach the full range and gives #N/A  instead of the actual value."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1534329015, "post_id": 51856376, "comment_id": 90666313, "body": "Range1 is defined on the size of Range2. If Range2 changes then so will Range1. You might want to add a line to clear column A before adding the formula in case Range2 has shrunk."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1534329066, "post_id": 51856376, "comment_id": 90666334, "body": "Also the code only runs when the file is opened so you might want to reconsider that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10086705"}, "edited": false, "score": 0, "creation_date": 1534331272, "post_id": 51856376, "comment_id": 90667177, "body": "@SRJ  Added it to a button.   First i let columns B and C be filled by the query, in Excel i check the range of Range1 and it goes tot he same row as Columbs B and C.   I press the button with the code you gave me and the range becomes something else. (sometimes smaller sometimes larger then the range should be)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1534339551, "post_id": 51856376, "comment_id": 90671362, "body": "As far as I can see I&#39;ve answered your question and I can&#39;t replicate your problem so I assume it has something to do with your data query. I have added another formulation above which does not rely on your named ranges."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10086705"}, "edited": false, "score": 0, "creation_date": 1534414188, "post_id": 51856376, "comment_id": 90700483, "body": "when i manually do the formula in Excel with the same dataset it does work. So the dataset doesn&#39;t seem to be the problem. The data comes out correct, when i select the range the correct range is given as well. But i gave up on this bit for now, was only meant to make a small part a bit more user friendly.  (being able to see the item and description) but seeing the item alone should be more then enough."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1534339537, "last_edit_date": 1534339537, "creation_date": 1534326104, "answer_id": 51856376, "question_id": 51856178, "link": "https://stackoverflow.com/questions/51856178/name-ranged-value-of-2-named-ranges/51856376#51856376", "title": "Name Ranged = value of 2 named ranges", "body": "<p>Here is one way, the code will run whenever the file is opened. The code needs to go in the ThisWorkbook module.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nRange(\"Range1\").Value = Evaluate(\"=Range2 &amp; \"\"-\"\" &amp; Range3\")\n\n\nWith Sheets(\"Constances\")\n    With .Range(\"B1\", .Range(\"B\" &amp; Rows.Count).End(xlUp)).Offset(, -1)\n        .Clear\n        .Formula = \"= B1 &amp; \"\"-\"\" &amp; C1\"\n        .Value = .Value 'this removes formulae\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10086705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594152718, "creation_date": 1534325334, "last_edit_date": 1594152718, "question_id": 51856178, "link": "https://stackoverflow.com/questions/51856178/name-ranged-value-of-2-named-ranges", "title": "Name Ranged = value of 2 named ranges", "body": "<p>I got a Named range in Column A that is the length of the named range in Column B/C (query result)</p>\n\n<p>Now i want Column A to have the information of both Column B and Column C separated by \" - \" </p>\n\n<p>Range1 = <code>=OFFSET(Sheet1!$A$1, 0, 0, COUNTA(Constances!$B:$B),1)</code></p>\n\n<p>Range2 = <code>=OFFSET(Sheet1!$B$1, 0, 0, COUNTA(Constances!$B:$B),1)</code></p>\n\n<p>Range3 =  <code>=OFFSET(Sheet1!$C$1, 0, 0, COUNTA(Constances!$C:$C),1)</code></p>\n\n<p>What i was thinking off is = <code>Range1=Range2&amp;\"- \"&amp;Range3</code></p>\n\n<p>Anyway to fix this in Excel so it happens automatically every time the Sheet starts? Or Alternatively, can this be solved using VBA code?</p>\n"}, {"tags": ["sql", "sql-server", "excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1534328121, "post_id": 51855889, "comment_id": 90665932, "body": "In what way does it fail? If it doesn&#39;t appear to have any records, please explain how you are observing this. Have you tried in a normal table?"}, {"owner": {"reputation": 177, "user_id": 4399917, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/P53Ya.jpg?s=128&g=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/4399917/aap"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1534330173, "post_id": 51855889, "comment_id": 90666742, "body": "@Nick.McDermaid I can&#39;t add records using record-set method. Looping from excel column to temporary table in sql. However If I write Insert Into query then it works but not through looping."}, {"owner": {"reputation": 13106, "user_id": 3735690, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/fOisS.png?s=128&g=1", "display_name": "Esperento57", "link": "https://stackoverflow.com/users/3735690/esperento57"}, "edited": false, "score": 0, "creation_date": 1534333330, "post_id": 51855889, "comment_id": 90668119, "body": "i think you shoud test if r.Value is not Nothing and if Nothing you should be put DBNull.Value"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1534336613, "post_id": 51855889, "comment_id": 90669693, "body": "Doesn&#39;t work? Can&#39;t? These words are of zero use in solving the problem. How &quot;can&#39;t&quot; you? Do you get an error? If you don&#39;t get an error, how are you observing that no records are inserted. You have not yet described the symptom."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1534336646, "post_id": 51855889, "comment_id": 90669706, "body": "What does <i>Here it fails</i> mean in your code? Is there an error?"}, {"owner": {"reputation": 177, "user_id": 4399917, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/P53Ya.jpg?s=128&g=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/4399917/aap"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1534342125, "post_id": 51855889, "comment_id": 90672849, "body": "@Nick.McDermaid Here it fails is a comment to show that readers understand where the code starts to fail. Error Descp: &quot;Query cannot be updated because the FROM clause is not a single simple table name.&quot;"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1534375429, "post_id": 51855889, "comment_id": 90687232, "body": "I don&#39;t understand why you would not state the error in the original question and why it takes <i>three</i> prompts for you to finally state it"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1534392888, "post_id": 51855889, "comment_id": 90690544, "body": "Can you edit the question and add this error message. Can you also <i>confirm</i> that this error is occurring with the code you posted in the original message (not the code posted in the answer below). Can you also try what I suggested - don&#39;t use a temporary table"}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 4399917, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/P53Ya.jpg?s=128&g=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/4399917/aap"}, "edited": false, "score": 0, "creation_date": 1534336197, "post_id": 51858154, "comment_id": 90669460, "body": "Thanks for your help. Getting error &quot;Query cannot be updated because the FROM clause is not a single simple table name.&quot;"}, {"owner": {"reputation": 362, "user_id": 8787164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2495ce5899e819402eb40a0bb466a5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinh Can Code", "link": "https://stackoverflow.com/users/8787164/vinh-can-code"}, "reply_to_user": {"reputation": 177, "user_id": 4399917, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/P53Ya.jpg?s=128&g=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/4399917/aap"}, "edited": false, "score": 0, "creation_date": 1534382041, "post_id": 51858154, "comment_id": 90688571, "body": "I edit the code again, I don&#39;t have a real enviroment as yours, it is just a prototype. Please test. Hope it works fine."}, {"owner": {"reputation": 177, "user_id": 4399917, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/P53Ya.jpg?s=128&g=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/4399917/aap"}, "edited": false, "score": 0, "creation_date": 1534406372, "post_id": 51858154, "comment_id": 90695880, "body": "Hurrah! Its working. What is Dim SQLInsert$ and how does it work so that I understand. However I am very grateful for your help."}, {"owner": {"reputation": 362, "user_id": 8787164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2495ce5899e819402eb40a0bb466a5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinh Can Code", "link": "https://stackoverflow.com/users/8787164/vinh-can-code"}, "reply_to_user": {"reputation": 177, "user_id": 4399917, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/P53Ya.jpg?s=128&g=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/4399917/aap"}, "edited": false, "score": 0, "creation_date": 1534411111, "post_id": 51858154, "comment_id": 90698627, "body": "I found the declare here: <a href=\"https://bettersolutions.com/vba/variables/abbreviations.htm\" rel=\"nofollow noreferrer\">bettersolutions.com/vba/variables/abbreviations.htm</a>"}], "tags": [], "owner": {"reputation": 362, "user_id": 8787164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2495ce5899e819402eb40a0bb466a5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinh Can Code", "link": "https://stackoverflow.com/users/8787164/vinh-can-code"}, "is_accepted": true, "score": 0, "last_activity_date": 1534381953, "last_edit_date": 1534381953, "creation_date": 1534333868, "answer_id": 51858154, "question_id": 51855889, "link": "https://stackoverflow.com/questions/51855889/adodb-recordset-does-not-add-new-records-in-temporary-table-in-ms-sql/51858154#51858154", "title": "ADODB Recordset Does Not Add New Records In Temporary Table in MS SQL", "body": "<p>Hope this help (I have not tested:</p>\n\n<pre><code>Sub MPNTEST()\n\nDim dbCon As ADODB.Connection, dbt As ADODB.Recordset\nDim dbtf As ADODB.Field, r As Range, SqlQry1 As String\nDim SQLInsert$\n\nSet dbCon = New ADODB.Connection\n'Set dbt = New ADODB.Recordset\n\ndbCon.ConnectionString = SqlConStr\n\nOn Error GoTo CloseConnection\n\n''create table db..table\nSqlQry1 = \"CREATE TABLE tempdb..#TempTbl ( ID INT Primary KEY IDENTITY(1,1),TempData NVARCHAR(255))\"\n\ndbCon.Open   \ndbCon.Execute (SqlQry1)\ndbCon.Execute \"use tempdb\" ' Move to tempdb\n\nWith dbt\n\n    For Each r In ActiveSheet.Range(\"AE2:AE10\")\n        SQLInsert = \"Insert into #TempTbl(TempData) values('\" &amp; Replace(\"\"&amp; r.Value, \"'\", \"''\") &amp;\"')\"\n        dbCon.Execute (SQLInsert)\n    Next r\nEnd With\n'dbt.Close    \ndbCon.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 4399917, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/P53Ya.jpg?s=128&g=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/4399917/aap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 51858154, "answer_count": 1, "score": 0, "last_activity_date": 1594151339, "creation_date": 1534324038, "last_edit_date": 1594151339, "question_id": 51855889, "link": "https://stackoverflow.com/questions/51855889/adodb-recordset-does-not-add-new-records-in-temporary-table-in-ms-sql", "title": "ADODB Recordset Does Not Add New Records In Temporary Table in MS SQL", "body": "<p>I want to create a temporary table with two fields \"ID\" and \"TempData\". Then wants to insert data into that table from an excel sheet through looping. I created temporary table but when I try to add data into that table then it fails. Does anyone have idea to move an excel column values to a temporary table without looping?\nCan anyone please help.</p>\n\n<pre><code>Sub MPNTEST()\n\nDim dbCon As ADODB.Connection, dbt As ADODB.Recordset, dbtf As ADODB.Field, r As Range, SqlQry1 As String\nSet dbCon = New ADODB.Connection\nSet dbt = New ADODB.Recordset\ndbCon.ConnectionString = SqlConStr\nOn Error GoTo CloseConnection\n\nSqlQry1 = \"Use tempdb CREATE TABLE #TempTbl ( ID INT Primary KEY IDENTITY(1,1),TempData NVARCHAR(255))\"\n\ndbCon.Open   \ndbCon.Execute (SqlQry1)\n\nWith dbt\n    .ActiveConnection = dbCon\n    .Source = \"#TempTbl\"\n    .LockType = adLockOptimistic\n    .CursorType = adOpenForwardOnly\n    .Open\n    For Each r In ActiveSheet.Range(\"AE2:AE10\")\n        .AddNew\n        .Fields(\"TempData\").Value = r.Value\n        .Update                                               '###Here it fails\n    Next r\nEnd With\ndbt.Close    \ndbCon.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "events"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534327709, "post_id": 51855653, "comment_id": 90665737, "body": "Where did the notion of a <i>temporary datasheet form</i> come from? As I understand it, after <code>.SourceObject = &quot;Table.Table1&quot;</code> the subform shows a table datasheet, and that simply doesn&#39;t have these properties."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534327823, "post_id": 51855653, "comment_id": 90665803, "body": "@Andre As I understand it, it&#39;s auto created. <code>subformForm.OnCurrent = &quot;[Event Procedure]&quot;</code> doesn&#39;t trigger an error, so that property is present."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534328650, "post_id": 51855653, "comment_id": 90666165, "body": "@Andre Also note that other form properties, such as <code>.AllowAdditions</code>, are also present, can be changed and work fine. It&#39;s just handling events that&#39;s causing problems for me."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534338032, "post_id": 51855653, "comment_id": 90670478, "body": "Hmmm This is a good question. The subform has <a href=\"//msdn.com/library/jj249005.aspx\" rel=\"nofollow noreferrer\">Enter/Exit events</a> and an <code>On Current event that fires for each record in the subform</code> (see <a href=\"//bytes.com/topic/852267-how-detect-sub-form-event-main-form\" rel=\"nofollow noreferrer\">here</a>) but not sure its possible to detect from a class module. More <a href=\"//social.msdn.microsoft.com/Forums/office/a322e4f7-0058-4c63-8473-24600fafba04\" rel=\"nofollow noreferrer\">discussion</a> also <a href=\"//access-programmers.co.uk/forums/showthread.php?t=191507\" rel=\"nofollow noreferrer\">here</a>. This isn&#39;t event-related but a <a href=\"//access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">handy guide</a> for referring to subforms from elsewhere."}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1534338335, "post_id": 51859146, "comment_id": 90670655, "body": "You&#39;re certainly right. I hadn&#39;t realized a form needs a module, even when you&#39;re handling the event from another class module. Apparently, a form with <code>HasModule</code> set to false is a lightweight object, doesn&#39;t support events, and can&#39;t be created using <code>Dim myVar As New Form_Form1</code>. This means I have to rethink my approach, because you can&#39;t add modules to these temporary forms on the fly..."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 3, "last_activity_date": 1534337750, "creation_date": 1534337750, "answer_id": 51859146, "question_id": 51855653, "link": "https://stackoverflow.com/questions/51855653/is-it-possible-to-raise-events-on-a-subforms-form-when-that-subform-is-bound-t/51859146#51859146", "title": "Is it possible to raise events on a subform&#39;s form, when that subform is bound to a table?", "body": "<p>It's because the subform object isn't a form having a code module. Thus, nowhere is the event procedure to run.</p>\n\n<p>So, create a form in datasheetview using the table as source, having no code module, and use that as the subform:</p>\n\n<ul>\n<li>Your code is ignored.</li>\n</ul>\n\n<p>Now, adjust the form to have a code module:</p>\n\n<ul>\n<li>Your code runs as expected.</li>\n</ul>\n\n<p>Anyway, that's how it works for me in Access 2016.</p>\n"}, {"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1534410013, "last_edit_date": 1534410013, "creation_date": 1534406502, "answer_id": 51872306, "question_id": 51855653, "link": "https://stackoverflow.com/questions/51855653/is-it-possible-to-raise-events-on-a-subforms-form-when-that-subform-is-bound-t/51872306#51872306", "title": "Is it possible to raise events on a subform&#39;s form, when that subform is bound to a table?", "body": "<p>As Gustav pointed out to me, a form needs a module to raise events.</p>\n\n<p>This means you can't use the auto-created temporary datasheet form. But you can create your own form to take its place.</p>\n\n<p>To work around the limitation, I created a form named <em>frmDynDS</em>, and set it's default view to datasheet view. Then, I opened the form in design view and added 255 text boxes to the form using the following code:</p>\n\n<pre><code>Public Sub DynDsPopulateControls()\n    Dim i As Long\n    Dim myCtl As Control\n    For i = 0 To 254\n        Set myCtl = Application.CreateControl(\"frmDynDS\", acTextBox, acDetail)\n        myCtl.Name = \"Text\" &amp; i\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I added a module, and added the following code to dynamically load a table into the form:</p>\n\n<pre><code>Public Sub LoadTable(TableName As String)\n    Dim fld As DAO.Field\n    Dim l As Long\n    Me.RecordSource = TableName\n    For Each fld In Me.Recordset.Fields\n        With Me.Controls(\"Text\" &amp; l)\n            .Properties(\"DatasheetCaption\").Value = fld.Name\n            .ControlSource = fld.Name\n            .ColumnHidden = False\n            .columnWidth = -2\n        End With\n        l = l + 1\n    Next\n    For l = l To 254\n        Me.Controls(\"Text\" &amp; l).ColumnHidden = True\n    Next\nEnd Sub\n</code></pre>\n\n<p>Then, I could adjust <em>Class1</em> to the following:</p>\n\n<pre><code>Private WithEvents subformForm As Access.Form\n\nPublic Sub Init(subformControl As Access.SubForm, TableName As String)\n   subformControl.SourceObject = \"Form.frmDynDS\"\n    Set subformForm = subformControl.Form\n    subformForm.LoadTable TableName\n    subformForm.OnCurrent = \"[Event Procedure]\"\nEnd Sub\n\nPrivate Sub subformForm_Current()\n    MsgBox \"Current!\"\nEnd Sub\n</code></pre>\n\n<p>And <em>Form1</em> to the following:</p>\n\n<pre><code>Private c1 As Class1\n\nPrivate Sub Form_Load()\n    Set c1 = New Class1\n    c1.Init sub1, \"Table1\"\nEnd Sub\n</code></pre>\n\n<p>Using this approach, you can have a subform that can display tables created on the fly in datasheet view, and handle events for that subform.</p>\n\n<p>You can have multiple subforms bound to frmDynDS displaying different tables, and handle events in different event handlers, on a single form.</p>\n"}], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1372, "favorite_count": 1, "accepted_answer_id": 51859146, "answer_count": 2, "score": 6, "last_activity_date": 1594215217, "creation_date": 1534323071, "last_edit_date": 1594215217, "question_id": 51855653, "link": "https://stackoverflow.com/questions/51855653/is-it-possible-to-raise-events-on-a-subforms-form-when-that-subform-is-bound-t", "title": "Is it possible to raise events on a subform&#39;s form, when that subform is bound to a table?", "body": "<p>I've got a form with a subform which is bound to a temporary table. The temporary table contains the result of a pivot, but I'd like users to be able to edit that pivot and then push the changes to the source table. </p>\n\n<p>To do this, I'd like to fire events on <code>AfterInsert</code>, <code>AfterUpdate</code> and <code>Delete</code> so I can act on changes. As I understand it, the subform's form property refers to a temporary datasheet form when the subform is bound to a table. However, I can't get this temporary form to raise any events.</p>\n\n<p><strong>MCVE:</strong></p>\n\n<p>I have a database with a single table, <em>Table1</em>, a single form, <em>Form1</em>, and that form has a single subform control which is unbound.</p>\n\n<p>I have a class, <em>Class1</em>, with the following code:</p>\n\n<pre><code>Private WithEvents subformForm As Access.Form\n\nPublic Sub Init(subformControl As Access.SubForm)\n    Set subformForm = subformControl.Form\n    subformForm.OnCurrent = \"[Event Procedure]\"\nEnd Sub\n\nPrivate Sub subformForm_Current()\n    MsgBox \"Current!\"\nEnd Sub\n</code></pre>\n\n<p>The form, <em>Form1</em>, has the following code:</p>\n\n<pre><code>Private c1 As Class1\n\nPrivate Sub Form_Load()\n    sub1.SourceObject = \"Table.Table1\"\n    Set c1 = New Class1\n    c1.Init sub1\nEnd Sub\n</code></pre>\n\n<p>However, when I move about records, add records, and do whatever in that subform, the <code>subformForm_Current</code> event never fires.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534323656, "post_id": 51855587, "comment_id": 90663806, "body": "Does it work if you copy it manually by right clicking on the Sheet tab and copy? Is this code run periodically or only once? If periodically then see: <a href=\"https://support.microsoft.com/en-us/help/210684/copying-worksheet-programmatically-causes-run-time-error-1004-in-excel\" rel=\"nofollow noreferrer\">Copying worksheet programmatically causes run-time error 1004 in Excel</a>. Also try to save the workbook before you copy the sheet."}, {"owner": {"reputation": 101, "user_id": 10117937, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--koEosueyMc/AAAAAAAAAAI/AAAAAAAABCo/-kCncOKdkFg/photo.jpg?sz=128", "display_name": "Terence Zhong", "link": "https://stackoverflow.com/users/10117937/terence-zhong"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534324036, "post_id": 51855587, "comment_id": 90663949, "body": "I cant copy it manually by right clicking on the sheet tab, it come out Path/File access error: &#39;&#39;.\\VBF516.TMP&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534325518, "post_id": 51855587, "comment_id": 90664608, "body": "So then this looks not directly like a VBA issue but more like a permission issue. Where is your workbook saved? Did you open it from an email of from your hard drive?"}, {"owner": {"reputation": 101, "user_id": 10117937, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--koEosueyMc/AAAAAAAAAAI/AAAAAAAABCo/-kCncOKdkFg/photo.jpg?sz=128", "display_name": "Terence Zhong", "link": "https://stackoverflow.com/users/10117937/terence-zhong"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534326272, "post_id": 51855587, "comment_id": 90664985, "body": "This workbook is saved on my desktop, so I open it from my hard drive. I check the file authors is other name. But when check the permission in security tab of properties, it show my account have full controls"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534326592, "post_id": 51855587, "comment_id": 90665144, "body": "Does the problem still occur if you place the file into another directory?"}, {"owner": {"reputation": 101, "user_id": 10117937, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--koEosueyMc/AAAAAAAAAAI/AAAAAAAABCo/-kCncOKdkFg/photo.jpg?sz=128", "display_name": "Terence Zhong", "link": "https://stackoverflow.com/users/10117937/terence-zhong"}, "edited": false, "score": 0, "creation_date": 1534327383, "post_id": 51855587, "comment_id": 90665570, "body": "I copy the file into D drive and the problem still occur"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534328079, "post_id": 51855587, "comment_id": 90665915, "body": "@TerenceZhong Does it also happen with other files that you cannot copy a sheet (eg. if you create a new Excel workbook put some fake data in, save it on disk and then try to copy the sheet)?"}, {"owner": {"reputation": 101, "user_id": 10117937, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--koEosueyMc/AAAAAAAAAAI/AAAAAAAABCo/-kCncOKdkFg/photo.jpg?sz=128", "display_name": "Terence Zhong", "link": "https://stackoverflow.com/users/10117937/terence-zhong"}, "edited": false, "score": 0, "creation_date": 1534329704, "post_id": 51855587, "comment_id": 90666574, "body": "@PEH My other excel files can copy a sheet within same workbook, only this workbook includes macros can&#39;t copy. Also, this workbook is download from outlook attachment. And now I found a odd thing, the sheet can copy only if I save the file as a new file. Then I can run the macro successfully. However, it does not work again if I close the file and open it again."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534332221, "post_id": 51855587, "comment_id": 90667634, "body": "I still think this has to do with the issue described in the link I gave you in my first comment. They say a workaround is to save the workbook before you copy."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534354154, "post_id": 51855587, "comment_id": 90679275, "body": "shooting in the dark, change this line  <code>Environ$(&quot;temp&quot;)</code> and give it a folder address outside your operating system directory and try again"}, {"owner": {"reputation": 101, "user_id": 10117937, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--koEosueyMc/AAAAAAAAAAI/AAAAAAAABCo/-kCncOKdkFg/photo.jpg?sz=128", "display_name": "Terence Zhong", "link": "https://stackoverflow.com/users/10117937/terence-zhong"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534368163, "post_id": 51855587, "comment_id": 90685370, "body": "@Ibo I will give it a try later, Thank you"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534405855, "post_id": 51855587, "comment_id": 90695620, "body": "@Ibo since the <code>ActiveSheet.Copy</code> line where the error actually occurs is a way before using <code>Environ$(&quot;temp&quot;)</code> it cannot be the issue of that error."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534439378, "post_id": 51855587, "comment_id": 90715957, "body": "I had a closer look, I agree with @P\u1d07\u029c this is not a VBA issue and it must be a security issue or sth like that. You need to try the code on a different computer preferably a personal laptop that is not connected to any server etc, and remove the <code>on error resume next</code> to see where the error occurs"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 6933840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d78522c7494a1d83af986502e3eea164?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Paramonov", "link": "https://stackoverflow.com/users/6933840/michael-paramonov"}, "is_accepted": false, "score": 0, "last_activity_date": 1543925269, "last_edit_date": 1543925269, "creation_date": 1543920481, "answer_id": 53611214, "question_id": 51855587, "link": "https://stackoverflow.com/questions/51855587/cant-copy-activesheet-before-send-it/53611214#53611214", "title": "Cant Copy Activesheet before send it", "body": "<p>The differences between <code>.xlsx</code> and <code>.xls</code> extensiond could be the cause. </p>\n\n<ul>\n<li><p><code>.xlsx</code> files can contain <code>1 048 576</code> rows in contrast to <code>.xls</code>, which can contain only <code>65 536</code> rows on a sheet. </p></li>\n<li><p>So VBA tried to copy whole sheet with <code>1 048 576</code> to <code>.xls</code> workbook that can handle only <code>65 536</code> rows and you get an error. </p></li>\n<li><p>As a decision you can copy concrete range <code>A1:A65536</code> from <code>.xlsx</code> book to <code>.xls</code>.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9678274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c12b1139dbf42de73188580e5e49dba7?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Wein", "link": "https://stackoverflow.com/users/9678274/richard-wein"}, "is_accepted": false, "score": 0, "last_activity_date": 1555679803, "creation_date": 1555679803, "answer_id": 55762493, "question_id": 51855587, "link": "https://stackoverflow.com/questions/51855587/cant-copy-activesheet-before-send-it/55762493#55762493", "title": "Cant Copy Activesheet before send it", "body": "<p>I just encountered the same error message. It seems to be rare, as I couldn't find any other mention of it on the web.</p>\n\n<p>The error occurred on a PC of one of my clients, who uses a VBA add-in I developed for him. Since he's in another country I couldn't investigate directly. I suggested he restart his PC (full restart, not just shut down and start up) and that seems to have fixed it. So apparently it was just a temporary glitch in Excel.</p>\n"}, {"tags": [], "owner": {"reputation": 92, "user_id": 811072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164a498df780d106c219cbd5d05a239c?s=128&d=identicon&r=PG", "display_name": "NightFalcon", "link": "https://stackoverflow.com/users/811072/nightfalcon"}, "is_accepted": false, "score": 0, "last_activity_date": 1602539336, "creation_date": 1602539336, "answer_id": 64325745, "question_id": 51855587, "link": "https://stackoverflow.com/questions/51855587/cant-copy-activesheet-before-send-it/64325745#64325745", "title": "Cant Copy Activesheet before send it", "body": "<p>I got this error, and Richard noted, it is rare. As such, I wanted to share my fix for the issue.</p>\n<p>One of the cases that makes this issue appear is if you try to copy a hidden sheet in Excel. To copy it, you need to unhide it first.</p>\n"}], "owner": {"reputation": 101, "user_id": 10117937, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--koEosueyMc/AAAAAAAAAAI/AAAAAAAABCo/-kCncOKdkFg/photo.jpg?sz=128", "display_name": "Terence Zhong", "link": "https://stackoverflow.com/users/10117937/terence-zhong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1872, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1602539336, "creation_date": 1534322804, "last_edit_date": 1534323019, "question_id": 51855587, "link": "https://stackoverflow.com/questions/51855587/cant-copy-activesheet-before-send-it", "title": "Cant Copy Activesheet before send it", "body": "<p>I am going to copy a active worksheet before send it out thought outlook, but it gave me a </p>\n\n<blockquote>\n  <p>\"Run-time error '1004': We couldn't copy this sheet\". </p>\n</blockquote>\n\n<p>I have try few commands in below to copy the sheet just don't work:</p>\n\n<pre><code>ThisWorkSheet.Copy ' fist method \nWorksheets(\"Confirm\").Activate \nActiveSheet.Copy   ' Second mehod\nActiveWorkbook.Sheets(\"Confirm\").Copy ' Third method\n</code></pre>\n\n<p>All this came out error and debug is navigate to online of above code.</p>\n\n<pre><code>Sub Mail_ActiveSheet()\n\nDim FileExtStr As String\nDim FileFormatNum As Long\nDim Sourcewb As Workbook\nDim Destwb As Workbook\nDim TempFilePath As String\nDim TempFileName As String\nDim OutApp As Object\nDim OutMail As Object\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nSet Sourcewb = ActiveWorkbook\n\n'Copy the ActiveSheet to a new workbook\n\nActiveSheet.Copy ' when debug this code come out error\nSet Destwb = ActiveWorkbook\n\n'Determine the Excel version and file extension/format\nWith Destwb\n    If Val(Application.Version) &lt; 12 Then\n        'You use Excel 97-2003\n        FileExtStr = \".xls\": FileFormatNum = -4143\n    Else\n        'You use Excel 2007-2016\n        FileExtStr = \".xlsm\": FileFormatNum = 52\n    End If\nEnd With\n\n'Save the new workbook/Mail it/Delete it\nTempFilePath = Environ$(\"temp\") &amp; \"\\\"\nTempFileName = Range(\"F4\").Value\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nWith Destwb\n    .SaveAs TempFilePath &amp; TempFileName &amp; FileExtStr, FileFormat:=FileFormatNum\n    On Error Resume Next\n    With OutMail\n        .To = Range(\"B12\").Value\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Order From \" &amp; Range(\"E8\").Value\n        .HTMLBody = \"&lt;font face=\"\"calibri\"\" style=\"\"font-size:11pt;\"\"&gt;Dear Collegue, \" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n                \"Please kindly find the attached new order for \" &amp; Range(\"E8\").Value &amp; \" above.\" &amp; _\n                \"&lt;br&gt;&lt;br&gt;\" &amp; \"Regards &lt;br&gt;&lt;br&gt;\" &amp; Range(\"F6\").Value &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n                \"Shop : \" &amp; Range(\"E8\").Value &amp; \"&lt;br&gt;\" &amp; _\n                        Range(\"E9\").Value &amp; \"&lt;br&gt;\" &amp; _\n                        Range(\"E10\").Value &amp; \"&lt;br&gt;\" &amp; _\n                        Range(\"E11\").Value &amp; \"&lt;br&gt;\" &amp; .HTMLBody &amp; \"&lt;/font&gt;\"\n        .Attachments.Add Destwb.FullName\n        'You can add other files also like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n    .Close savechanges:=False\nEnd With\n\n'Delete the file you have send\nKill TempFilePath &amp; TempFileName &amp; FileExtStr\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n\nMsgBox \"Mail has been sent!\"\n\nSet OutApp = Nothing\n'Set OutMail = Nothing End Sub\n</code></pre>\n\n<p>Please helps, thank you</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 3, "creation_date": 1534323219, "post_id": 51855670, "comment_id": 90663585, "body": "That opens up the application to SQL injection, and <code>unique</code> is dimmed as a string, so this&#39;ll likely not work too, because you haven&#39;t used string delimiters."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1534326403, "last_edit_date": 1534326403, "creation_date": 1534323131, "answer_id": 51855670, "question_id": 51855556, "link": "https://stackoverflow.com/questions/51855556/how-to-pass-variables-from-vba-through-sql/51855670#51855670", "title": "How to pass variables from VBA through SQL?", "body": "<p><code>SQL = \"INSERT INTO tab_test (Feld1) VALUES ('\" &amp; Forms!frm_test!PN &amp; \"')\"</code></p>\n"}], "owner": {"reputation": 1085, "user_id": 3027322, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/LAWOO.jpg?s=128&g=1", "display_name": "Hubschr", "link": "https://stackoverflow.com/users/3027322/hubschr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1534323633, "answer_count": 1, "score": 0, "last_activity_date": 1534326403, "creation_date": 1534322677, "last_edit_date": 1534323354, "question_id": 51855556, "link": "https://stackoverflow.com/questions/51855556/how-to-pass-variables-from-vba-through-sql", "closed_reason": "Duplicate", "title": "How to pass variables from VBA through SQL?", "body": "<p>I'm trying to pass values from a Form into my database, via SQL:</p>\n\n<pre><code>Private Sub Befehl4_Click()\n\nDim SQL As String\nDim unique As String\n\nunique = Forms!frm_test!PN\n\nSQL = \"INSERT INTO tab_test (Feld1) VALUES (unique)\"\nDoCmd.RunSQL SQL\n\nEnd Sub\n</code></pre>\n\n<p>When I execute this code from my button in my Form, <code>unique</code> isn't passed to the SQL-command. I have to type it in. When writing the SQL-command this way: </p>\n\n<pre><code>SQL = \"INSERT INTO tab_test (Feld1) VALUES (Forms!frm_test!PN)\"\n</code></pre>\n\n<p>It works how expected.</p>\n\n<p>What am I missing or doing wrong?</p>\n"}, {"tags": ["excel", "vba", "filter", "subtotal"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534496697, "post_id": 51855502, "comment_id": 90734725, "body": "Looking at your screenshot, I believe you made a mistake with the ranges :). Please look carefully! If you can&#39;t find the error than let me know what formula there is currently in your cell C2."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10228364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e8f2cc08425c9b0f48eae86886fa30?s=128&d=identicon&r=PG&f=1", "display_name": "bigbumbly", "link": "https://stackoverflow.com/users/10228364/bigbumbly"}, "edited": false, "score": 0, "creation_date": 1534382278, "post_id": 51855935, "comment_id": 90688629, "body": "Hi JvdV, thank you for your reply! unfortunately, that&#39;s not what i was looking for. Again, apologies for being vague, I&#39;ve updated the question for clarity!"}, {"owner": {"reputation": 33, "user_id": 10228364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e8f2cc08425c9b0f48eae86886fa30?s=128&d=identicon&r=PG&f=1", "display_name": "bigbumbly", "link": "https://stackoverflow.com/users/10228364/bigbumbly"}, "edited": false, "score": 0, "creation_date": 1534742482, "post_id": 51855935, "comment_id": 90798473, "body": "Hi @JvdV, thank you! this works beautifully! I changed the data type to double to allow for decimal points though. Thank you again!"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1534499179, "last_edit_date": 1534499179, "creation_date": 1534324237, "answer_id": 51855935, "question_id": 51855502, "link": "https://stackoverflow.com/questions/51855502/excel-calculate-difference-between-cell-and-cell-above-in-an-auto-filtered-tabl/51855935#51855935", "title": "Excel: Calculate difference between cell and cell above in an auto filtered table", "body": "<p><strong>REVISED ANSWER</strong></p>\n\n<p>So after your explenation I have looked into a formula that will give you the difference of the current row B-value minus the B-value of occurance of the A-value before that.</p>\n\n<pre><code>=IFERROR(B2-LOOKUP(2,1/($A$1:A1=A2),$B$1:B2),0)\n</code></pre>\n\n<p>Taking your sample data, it would look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RkBMf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RkBMf.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then when you apply the filter, it would look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/a5kLm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a5kLm.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So with this workaround you dont have the correct value when no filter is applied, but in this case I assumed you are interested in the difference when it <strong>IS</strong> filtered!</p>\n\n<p>The formula is entered in cell <code>C2</code> and dragged down.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>If this is not the answer you'r after and you <strong>DO</strong> need the values when it is not filtered, make use of a UDF like below:</p>\n\n<pre><code>Public Function LastVisibleCell(CL As Range) As Long\n\nDim RW As Long, X As Long\nRW = CL.Row - 1\nOn Error GoTo 1\n\nIf RW &gt; 1 Then\n    For X = RW To 1 Step -1\n        If ActiveSheet.Rows(X).EntireRow.Hidden Then\n        Else\n            LastVisibleCell = Cells(CL.Row, 2).Value - Cells(X, 2).Value\n            Exit For\n        End If\n    Next X\nElse\n1:    LastVisibleCell = 0\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Call it from cell <code>C2</code> like: <code>=LastVisibleCell(A2)</code> and drag down. When you apply your filter, the cells will update.</p>\n\n<p><strong>Beware, this will take ages to update on large datasets!</strong></p>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534409597, "post_id": 51870218, "comment_id": 90697728, "body": "If all you interested in is to get the difference between the two rows when it&#39;s filtered you could apply a formula like: <code>=IFERROR(B3-LOOKUP(2,1&#47;($A$2:A2=A3),$B$2:B2),&quot;&quot;)</code>. If first row is headers than this goes into cell <code>B3</code>. Just drag down. This doesn&#39;t make much sense when no filter is applied."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534409753, "post_id": 51870218, "comment_id": 90697831, "body": "If you want to stay in the VBA codes, maybe look into using the filtervalue in a <code>.FindNext</code> loop pasting your formula. Also instead of pasting a formula, you could just get your needed value through vba extracting value with last visible cell. Code shouldn&#39;t be hard to put together."}, {"owner": {"reputation": 33, "user_id": 10228364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e8f2cc08425c9b0f48eae86886fa30?s=128&d=identicon&r=PG&f=1", "display_name": "bigbumbly", "link": "https://stackoverflow.com/users/10228364/bigbumbly"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534487814, "post_id": 51870218, "comment_id": 90730165, "body": "Hi @JvdV, your formula doesnt seem to work for me.. ideally i&#39;d stay away from VBA and more to formulas. Thanks anyway! will continue searching"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534488752, "post_id": 51870218, "comment_id": 90730565, "body": "the formula works with the following assumptions: 1) Names are in column A. 2) Numbers are in column B. 3). Headers in row 1. 4) Formula pasted in C3 (not B3, my bad), and need to be dragged down. If it doesnt work, please show me a screenshot of what you did."}, {"owner": {"reputation": 33, "user_id": 10228364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e8f2cc08425c9b0f48eae86886fa30?s=128&d=identicon&r=PG&f=1", "display_name": "bigbumbly", "link": "https://stackoverflow.com/users/10228364/bigbumbly"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534495044, "post_id": 51870218, "comment_id": 90733841, "body": "@JvdV, i attached the screenshot in the question. Also right now im working on a workaround based off some code i found online (cant find the link anymore): <code>Public Function NextVisibleCell(Range As Range) As Range Application.Volatile Dim i As Long Set Range = Range.Cells(Range.Rows.Count, Range.Columns.Count) For i = 1 To Rows.Count - Range.Row     If Not Range.Offset(i).EntireRow.Hidden Then         Set NextVisibleCell = Range.Offset(i)         Exit Function     End If Next i End Function </code> but i cant get it to reference the previous row, only the current..."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534495755, "post_id": 51870218, "comment_id": 90734244, "body": "I have revised my answer to try make it clear what I meant to do."}, {"owner": {"reputation": 33, "user_id": 10228364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e8f2cc08425c9b0f48eae86886fa30?s=128&d=identicon&r=PG&f=1", "display_name": "bigbumbly", "link": "https://stackoverflow.com/users/10228364/bigbumbly"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534496675, "post_id": 51870218, "comment_id": 90734716, "body": "@JvdV, sorry, forgot to update with the filtered table, it seems to leave blanks and the values don&#39;t tally up. Also, i&#39;d like to see the differences when its not filtered too if it&#39;s possible. Could you take a look at the code above and guide me in changing it to reference the previous row? i thought changing the part <code>If Not Range.Offset(i).EntireRow.Hidden</code> to <code>If Not Range.Offset(i-2).EntireRow.Hidden</code> would help but it gave me haywire results. <a href=\"https://stackoverflow.com/questions/21593675/find-the-next-visible-row/21609341#21609341\">link to original question is here</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534498702, "post_id": 51870218, "comment_id": 90735864, "body": "Updated answer."}], "tags": [], "owner": {"reputation": 33, "user_id": 10228364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e8f2cc08425c9b0f48eae86886fa30?s=128&d=identicon&r=PG&f=1", "display_name": "bigbumbly", "link": "https://stackoverflow.com/users/10228364/bigbumbly"}, "is_accepted": false, "score": 0, "last_activity_date": 1534409860, "last_edit_date": 1534409860, "creation_date": 1534397833, "answer_id": 51870218, "question_id": 51855502, "link": "https://stackoverflow.com/questions/51855502/excel-calculate-difference-between-cell-and-cell-above-in-an-auto-filtered-tabl/51870218#51870218", "title": "Excel: Calculate difference between cell and cell above in an auto filtered table", "body": "<p>After 3 days of intense (albeit ineffective) Google-ing, I finally came across this <a href=\"https://stackoverflow.com/questions/29017096/excel-reference-a-cell-in-the-previous-visible-row\">answer</a> also on stack overflow.</p>\n\n<p>However, as I'm working on a large set of data (>150,000 rows), the method in the question uses too much memory. Using VBA to paste the formulas into visible cells only does not seem to alleviate the problem. </p>\n\n<pre><code>Sub CopyPasteFormula()\n    Dim Ws As Worksheet\n    Dim LRow As Long\n    Dim PasteRng As Range\n\n    Set Ws = Worksheets(\"Translated Data\")\n    Ws.Range(\"$D$2:$D$200000\").AutoFilter Field:=4, Criteria1:=\"&lt;&gt;-\", Operator:=xlFilterValues\n    LRow = Ws.Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n    Set PasteRng = Ws.Range(\"A3:A\" &amp; LRow).SpecialCells(xlCellTypeVisible)\n    Ws.Range(\"A3\").Copy\n    PasteRng.PasteSpecial xlPasteFormulas\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Above is my macro code to attempt reduce the memory use... Appreciate any feedback!</p>\n"}], "owner": {"reputation": 33, "user_id": 10228364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e8f2cc08425c9b0f48eae86886fa30?s=128&d=identicon&r=PG&f=1", "display_name": "bigbumbly", "link": "https://stackoverflow.com/users/10228364/bigbumbly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 0, "accepted_answer_id": 51855935, "answer_count": 2, "score": 2, "last_activity_date": 1534499179, "creation_date": 1534322425, "last_edit_date": 1534496494, "question_id": 51855502, "link": "https://stackoverflow.com/questions/51855502/excel-calculate-difference-between-cell-and-cell-above-in-an-auto-filtered-tabl", "title": "Excel: Calculate difference between cell and cell above in an auto filtered table", "body": "<p>I have a table with column A containing incrementing numerical values, and column B being a bunch of names. I need to filter the table according the names, and have column C update with the difference between the value in column A in the current row and the cell above..</p>\n\n<p><a href=\"https://i.stack.imgur.com/2K1o0.png\" rel=\"nofollow noreferrer\">For example, I'd like to have something like this</a>\nwhich, \n<a href=\"https://i.stack.imgur.com/TlQMB.png\" rel=\"nofollow noreferrer\">when filtered according to the Name column, should update the difference like so</a></p>\n\n<p>I have tried to use SUBTOTAL function in a few different ways but to no avail. Ideally it'd update once the filter in the table is changed. I tried to do this in VBA but so far I've gotten macro that only filters with the hard-coded filter criteria.</p>\n\n<p>Solutions in either excel formulas/python/vba are all welcomed and greatly appreciated!</p>\n\n<p>I apologise in advance if this question isn't up to standards as Im new here :) Thank you in advance!</p>\n\n<p>@JvdV: <a href=\"https://i.stack.imgur.com/r86xt.png\" rel=\"nofollow noreferrer\">This</a> is the outcome of me trying to implement your formula, <a href=\"https://i.stack.imgur.com/PcsCr.png\" rel=\"nofollow noreferrer\">This</a> is after filtering.</p>\n"}, {"tags": ["excel", "vba", "copy", "paste"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534322075, "post_id": 51854967, "comment_id": 90663108, "body": "So can these separate ones be combined? Or is there  a reason to keep them separate?"}, {"owner": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "edited": false, "score": 0, "creation_date": 1534322213, "post_id": 51854967, "comment_id": 90663162, "body": "Hello Mariusz and welcome on Stack Overflow, I believe you could use a <code>loop</code> to perform such an operation, with something like a <a href=\"https://www.techonthenet.com/excel/formulas/for_next.php\" rel=\"nofollow noreferrer\">for loop in VBA, here is a tutorial</a>. This can simplify your code and make it easier to read and operate."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534322288, "post_id": 51854967, "comment_id": 90663198, "body": "And is Range(&quot;A5&quot;) in Sheets(&quot;11_POLAND&quot;) ? And what is Range(&quot;A5&quot;) = (&quot;=D1&quot;) supposed to achieve? Is it simply Range(&quot;A5&quot;) = Range(&quot;D1&quot;) ? Or  Range(&quot;A5&quot;).Formula = &quot;=D1&quot; ? Or something else entirely?"}, {"owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "edited": false, "score": 0, "creation_date": 1534322341, "post_id": 51854967, "comment_id": 90663227, "body": "These codes cannot be combined because each cell in rows D and E should be taken separately. I put ranges D and E where a particular values exist to calculate further values."}], "answers": [{"comments": [{"owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "edited": false, "score": 0, "creation_date": 1534323589, "post_id": 51855406, "comment_id": 90663773, "body": "Great! Thanks. It works. However I would like to make for these 366 values 12 separate intervals (months). In that case should I add     While i &gt; 32 and i &lt;60?"}, {"owner": {"reputation": 5010, "user_id": 1666276, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c2ece7e507cc4c22f1a584f135ac660d?s=128&d=identicon&r=PG", "display_name": "Richard Hansell", "link": "https://stackoverflow.com/users/1666276/richard-hansell"}, "reply_to_user": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "edited": false, "score": 0, "creation_date": 1534325629, "post_id": 51855406, "comment_id": 90664666, "body": "The change you propose wouldn&#39;t actually work, as it would start with <code>i = 1</code>, see that <code>i</code> isn&#39;t between 33 and 59, then skip the entire loop.  I&#39;m not actually sure what you mean by <code>12 separate intervals</code> anyway; do you mean you want each month copied to a different worksheet, or a different area, or something completely different?"}, {"owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "edited": false, "score": 0, "creation_date": 1534327812, "post_id": 51855406, "comment_id": 90665796, "body": "Yes exactly. I would like to divide these 366 separate values for 12 months (30-31 values per unit) and then copy the results to another worksheet."}], "tags": [], "owner": {"reputation": 5010, "user_id": 1666276, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c2ece7e507cc4c22f1a584f135ac660d?s=128&d=identicon&r=PG", "display_name": "Richard Hansell", "link": "https://stackoverflow.com/users/1666276/richard-hansell"}, "is_accepted": true, "score": 2, "last_activity_date": 1534321987, "creation_date": 1534321987, "answer_id": 51855406, "question_id": 51854967, "link": "https://stackoverflow.com/questions/51854967/vba-excel-copy-paste-multiple-values-repeatedly/51855406#51855406", "title": "VBA Excel copy &amp; paste multiple values repeatedly", "body": "<p>I'm not 100% sure I am following what you are trying to achieve here, but I wrote this that seems to do the same as your existing code, but in one routine rather than six:</p>\n\n<pre><code>Sub january()\n    Dim i As Integer\n    i = 1\n    While i &lt; 6\n        Range(\"A5\") = (\"=D\" + CStr(i))\n        Range(\"B5\") = (\"=E\" + CStr(i))\n        Sheets(\"11_POLAND\").Range(\"AJ60:BY86\").Copy\n        Sheets(\"13\").Range(\"A\" + CStr(i + ((i - 1) * 30)) + \":AP\" + CStr(i + ((i - 1) * 30) + 26)).PasteSpecial xlPasteValues\n        i = i + 1\n    Wend\nEnd Sub\n</code></pre>\n\n<p>Using that as a starting point, I guess you could just change the <code>i &lt; 6</code> to <code>i &lt; 367</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1534323243, "last_edit_date": 1534323243, "creation_date": 1534322942, "answer_id": 51855621, "question_id": 51854967, "link": "https://stackoverflow.com/questions/51854967/vba-excel-copy-paste-multiple-values-repeatedly/51855621#51855621", "title": "VBA Excel copy &amp; paste multiple values repeatedly", "body": "<p>This is your code written using a For Loop. I still have my questions as posed above and assumptions re which sheet you are working with. This is similar to answer given except using variables to make reading code easier as well as use of Offset (again for ease of reading code).</p>\n\n<pre><code>Option Explicit\nPublic Sub CopyRanges()\n    Application.ScreenUpdating = False\n    Dim sheetFrom As Worksheet, sheetTo As Worksheet, i As Long\n    Set sheetFrom = ThisWorkbook.Worksheets(\"11_POLAND\")\n    Set sheetTo = ThisWorkbook.Worksheets(\"13\")\n    Dim aRange As Range: Set aRange = sheetFrom.Range(\"A5\")\n    Dim bRange As Range: Set bRange = sheetFrom.Range(\"B5\")\n\n    With sheetFrom\n        For i = 1 To 5 '&lt;== 5 for up to jan05\n            aRange = (\"=D\" &amp; i)\n            bRange = (\"=E\" &amp; i)\n            .Range(\"AJ60:BY86\").Copy\n            sheetTo.Range(\"A1:AP27\").Offset((i - 1) * 30, 0).PasteSpecial xlPasteValues\n        Next\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5010, "user_id": 1666276, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c2ece7e507cc4c22f1a584f135ac660d?s=128&d=identicon&r=PG", "display_name": "Richard Hansell", "link": "https://stackoverflow.com/users/1666276/richard-hansell"}, "edited": false, "score": 0, "creation_date": 1534333822, "post_id": 51857039, "comment_id": 90668360, "body": "Great, I was going to try and put together a solution that looped through each month, but this seems like a reasonable solution, so I will leave well alone.  Glad you got to a resolution."}], "tags": [], "owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "is_accepted": false, "score": 0, "last_activity_date": 1534328841, "creation_date": 1534328841, "answer_id": 51857039, "question_id": 51854967, "link": "https://stackoverflow.com/questions/51854967/vba-excel-copy-paste-multiple-values-repeatedly/51857039#51857039", "title": "VBA Excel copy &amp; paste multiple values repeatedly", "body": "<p>Thank you for help guys.</p>\n\n<p>I have put a following code:</p>\n\n<pre><code>Sub january()\nDim i As Integer\nFor i = 1 To 31\nSheets(\"1_GENERAL\").Range(\"A5\") = (\"=D\" + CStr(i))\nSheets(\"1_GENERAL\").Range(\"B5\") = (\"=E\" + CStr(i))\nSheets(\"11_POLAND\").Range(\"AJ60:BY86\").Copy\nSheets(\"13\").Range(\"A\" + CStr(i + ((i - 1) * 29)) + \":AP\" + CStr(i + ((i - 1) * 29))).PasteSpecial xlPasteValues\nNext i\nEnd Sub\n</code></pre>\n\n<p>Where: \n - \"i\" states a particular row. In case of January this is from 1 to 31 (1-31 day of the year)\n - \"29\" means that every consequent top row is going to be pasted roughly 29 rows below.\n- Columns D and E includes the values bounded to certain \"i\" value.</p>\n\n<p>I hope, that it will help for everyone struggling with big data in VBA Excel.</p>\n"}], "owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2457, "favorite_count": 0, "accepted_answer_id": 51855406, "answer_count": 3, "score": 1, "last_activity_date": 1534328841, "creation_date": 1534319954, "question_id": 51854967, "link": "https://stackoverflow.com/questions/51854967/vba-excel-copy-paste-multiple-values-repeatedly", "title": "VBA Excel copy &amp; paste multiple values repeatedly", "body": "<p>I have got an issue with multiple values in VBA excel, that I would like to copy  and paste in another workbook (or also another worksheet, but not necessarily in this topic).</p>\n\n<p>The point is, that I have got columns D and E with values ranged from row 1 to 366 (D1:D366 and E1:E366) and I have to switch them in cells A5 (column D) and B5 9column E). This is straightforward. However when I add up another commands to copy and paste values, whereas the range of copied cells remains constant and range of cells with paste data changes (increases 30 values every step) I don't know how to make this process quicker.\nI have made 5 repeatable combinations but I need still 361 another ones. </p>\n\n<p>Is it some more convenient code for this operation?</p>\n\n<p>My code is available here:</p>\n\n<pre><code>Sub jan01()\nRange(\"A5\") = (\"=D1\")\nRange(\"B5\") = (\"=E1\")\nSheets(\"11_POLAND\").Range(\"AJ60:BY86\").Copy\nSheets(\"13\").Range(\"A1:AP27\").PasteSpecial xlPasteValues\nEnd Sub\n\nSub jan02()\nRange(\"A5\") = (\"=D2\")\nRange(\"B5\") = (\"=E2\")\nSheets(\"11_POLAND\").Range(\"AJ60:BY86\").Copy\nSheets(\"13\").Range(\"A31:AP57\").PasteSpecial xlPasteValues\nEnd Sub\n\nSub jan03()\nRange(\"A5\") = (\"=D3\")\nRange(\"B5\") = (\"=E3\")\nSheets(\"11_POLAND\").Range(\"AJ60:BY86\").Copy\nSheets(\"13\").Range(\"A61:AP87\").PasteSpecial xlPasteValues\nEnd Sub\n\nSub jan04()\nRange(\"A5\") = (\"=D4\")\nRange(\"B5\") = (\"=E4\")\nSheets(\"11_POLAND\").Range(\"AJ60:BY86\").Copy\nSheets(\"13\").Range(\"A91:AP117\").PasteSpecial xlPasteValues\nEnd Sub\n\nSub jan05()\nRange(\"A5\") = (\"=D5\")\nRange(\"B5\") = (\"=E5\")\nSheets(\"11_POLAND\").Range(\"AJ60:BY86\").Copy\nSheets(\"13\").Range(\"A121:AP147\").PasteSpecial xlPasteValues\nEnd Sub\n</code></pre>\n\n<p>As per the description above the Values for cell A5 and B5 changes one by one.\nThe range for sheet 13 increases every 30 cells down for each simple case. Ultimately I would like to have all copied data one by one without overlapping like in the image attached (zoomed out to show the general purpose).<a href=\"https://i.stack.imgur.com/9bmSA.jpg\" rel=\"nofollow noreferrer\"></a>\nenter image description here\nTo bring all together I used one macro:</p>\n\n<pre><code>Sub january()\nCall jan01\nCall jan02\nCall jan03\nCall jan04\nCall jan05\nEnd Sub\n</code></pre>\n\n<p>Anyway the job looks tedious and I believe, that is much quicker solution to solve it?\nHave someone had issue like this?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba"], "owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1534331282, "creation_date": 1534319425, "question_id": 51854837, "link": "https://stackoverflow.com/questions/51854837/loop-and-copy-values-to-specific-tabs-worksheets", "title": "Loop and copy values to specific tabs [worksheets]", "body": "<p>I have a rather complex query, I need a \u201cloop\u201d to go through the list of names in column \u201cA\u201d [tab5] and based on adjacent cells (i.e. col B [col B lists names of other tabs in the workbook: tab1, tab2, tab3, tab4), copy the names from col A, to a specific tab[either 1,2,3 or4] to the bottom of column A[in one of the aforementioned tabs]. I have tried few \u201cloop\u201d codes but they were nowhere near producing what I need. PS. I have no experience with loops. </p>\n\n<p>E.g.</p>\n\n<p>Tab5</p>\n\n<p>Col A   Col B</p>\n\n<p>Nike    Tab2</p>\n\n<p>Puma    Tab3</p>\n\n<p>Adidas  Tab1</p>\n\n<hr>\n\n<p>Appreciate your help. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534339330, "post_id": 51854520, "comment_id": 90671224, "body": "I <i>think</i> your problem is that you&#39;re relying on <code>Select</code> and <code>Activate</code>, which <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">should generally be avoided</a>. I suspect that if you refactor the code to avoid those methods, you won&#39;t see any flickering."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1534339741, "post_id": 51854745, "comment_id": 90671464, "body": "Added some detail as paragraph 2 :)  Cheers."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1534340102, "last_edit_date": 1534340102, "creation_date": 1534318909, "answer_id": 51854745, "question_id": 51854520, "link": "https://stackoverflow.com/questions/51854520/universal-solution-for-excel-2013-2016-screen-flicker-due-to-screenupdating/51854745#51854745", "title": "Universal solution for Excel 2013 &amp; 2016 screen flicker due to ScreenUpdating = FALSE not working", "body": "<p>The flickering comes most likely from using <code>.Select</code> and <code>.Activate</code>:</p>\n\n<p>It's the environment screen that's updating to reflect the <em>activation</em> of the respective workbooks. <code>Application.ScreenUpdating</code> applies only to the application <em>instance</em>, it doesn't disable your entire monitor from refreshing as the various Workbook windows gain/lose focus from the <code>Activate</code> method. As you'll observe, while the screen flickers, you don't see the cell color changes until the procedure has finished. This suggests that <code>Application.ScreenUpdating</code> is working exactly as its intended to work, and that to resolve this, you should read and apply <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. </p>\n\n<p>Using <code>.Activate</code> or <code>.Select</code> is only necessary in very rare cases, so avoid it where ever possible.</p>\n\n<p>I'd also note that if it is a strict requirement to rely on the <code>Selection</code> or <code>ActiveCell</code> as user input, it won't be possible to fully eliminate the window flickering, because <code>Selection</code> or <code>ActiveCell</code> only exist within scope of the <code>ActiveSheet</code> in the <code>ActiveWorkbook</code>.</p>\n\n<p>I recommend to give the worksheet as parameter in <code>Jiggle</code> and then to address the cells absolutely. This makes your code more reliable and it runs in the background without selecting and without activating anything.</p>\n\n<pre><code>Option Explicit \n\nPublic Sub Macro1()\n    Application.ScreenUpdating = False\n\n    ' some flickery code\n    Dim i As Long\n    For i = 1 To 10\n        Call Jiggle(\"Red\", Workbooks(\"Book2\").Worksheets(1))\n        Call Jiggle(\"Yel\", Workbooks(\"Book1\").Worksheets(1))\n    Next i\n\n    ' restore normality\n    Application.ScreenUpdating = True\nEnd Sub\n\nPublic Sub Jiggle(c As Variant, ws As Worksheet)\n    Dim i As Long\n    For i = 1 To 100\n        With ws.Cells(i, 1) 'address your cells absolutely\n            Select Case c\n                Case \"Yel\":\n                    .Interior.Color = 255\n                Case \"Red\":\n                    .Interior.Color = 65535\n            End Select\n        End With\n    Next i\nEnd Sub\n</code></pre>\n\n<p><em>Note that this example is to show how not to use <code>.Select</code> and @DisplayName showed a shorter/faster way to achieve the same.</em></p>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534339146, "post_id": 51855032, "comment_id": 90671124, "body": "It&#39;s not clear how this answers the question, as the question was not &quot;how to optimize my code&quot;, and further while this <i>reduces</i> the flicker, it doesn&#39;t eliminate it :)"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534339887, "post_id": 51855032, "comment_id": 90671546, "body": "@DavidZemens, I showed a way to reduce flickering due to unnecessary workbook/worksheet jumping and cell by cell acting. Furthermore as long as you don&#39;t have any other <code>Range</code> reference than <code>ActiveCell</code>, you <i>have</i> to <code>Activate</code> its <code>Workbook</code> in order to reference it. Finally, in my test my code didn&#39;t flicker at all."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534340230, "post_id": 51855032, "comment_id": 90671761, "body": "In Excel 2016, I do see the windows toggle focus, I edited the other answer with an explanation for this (paragraph 2-4) and why I suspect this isn&#39;t controlled by the <code>ScreenUpdating</code> property of the Application instance. Of course if you&#39;re relying on <code>ActiveCell</code> you must <code>Activate</code>. A good answer ought to include some explanation in addition to &quot;here&#39;s code that works&quot;.  Cheers. (<a href=\"https://meta.stackexchange.com/help/how-to-answer\"><i>do try to mention any limitations, assumptions or simplifications in your answer. Brevity is acceptable, but fuller explanations are better</i></a>)"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534340282, "post_id": 51855032, "comment_id": 90671792, "body": "@DavidZemens, suit yourself"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534340938, "post_id": 51855032, "comment_id": 90672171, "body": "@DavidZemens, BTW, from the Help center: <i>&quot;When should I vote down? Use your downvotes whenever you encounter an answer that is clearly and perhaps dangerously incorrect.&quot;</i>"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1534338874, "last_edit_date": 1534338874, "creation_date": 1534320275, "answer_id": 51855032, "question_id": 51854520, "link": "https://stackoverflow.com/questions/51854520/universal-solution-for-excel-2013-2016-screen-flicker-due-to-screenupdating/51855032#51855032", "title": "Universal solution for Excel 2013 &amp; 2016 screen flicker due to ScreenUpdating = FALSE not working", "body": "<p>it seems to me that your whole code could boil down to:</p>\n\n<pre><code>Public Sub Macro1()\n    Application.ScreenUpdating = False \n    Workbooks(\"Cartel2\").Activate\n    ActiveCell.Offset(1).Resize(1000).Interior.Color = 65535\n    Workbooks(\"Cartel3\").Activate\n    ActiveCell.Offset(1).Resize(1000).Interior.Color = 255\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2405, "user_id": 1095716, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mKtI8.jpg?s=128&g=1", "display_name": "Iain S", "link": "https://stackoverflow.com/users/1095716/iain-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1440, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1534340102, "creation_date": 1534317930, "question_id": 51854520, "link": "https://stackoverflow.com/questions/51854520/universal-solution-for-excel-2013-2016-screen-flicker-due-to-screenupdating", "title": "Universal solution for Excel 2013 &amp; 2016 screen flicker due to ScreenUpdating = FALSE not working", "body": "<p>There have been dozens of questions about screen flickering in Excel 2013 and 2016, as <code>Application.ScreenUpdating = False</code> does not work as it used to.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/31969157/screen-flickering-vba-excel\">Screen Flickering VBA Excel</a><br>\n<a href=\"https://stackoverflow.com/questions/21721513/excel-screenupdating-false-and-still-flickering-screen\">Excel ScreenUpdating False and still flickering screen</a><br>\n<a href=\"https://stackoverflow.com/questions/35301178/screenupdating-false-fails-in-excel-2013-and-2016/44546729#44546729\">ScreenUpdating = False fails in Excel 2013 and 2016</a></p>\n\n<p>One partial solution involves disabling worksheet calculations, but they can be necessary in some models.  Another partial solution involves making workbooks invisible, which is either confusing for the user (if all workbooks disappear), or still sees the screen flickering (if you make all workbooks except one disappear).</p>\n\n<p>Ideally, I am looking for a solution that allows DoEvents to be run (so that it doesn't look like Excel is hanged), the allows the StatusBar to be visible (for reporting on progress), and prevents all other screen flicker.</p>\n\n<p>Why can't Microsoft just sort this out :(</p>\n\n<p>Here is some sample code which requires two blank workbooks (Book1 and Book2) and induces a horrible screen flicker.</p>\n\n<pre><code>Sub Macro1()\n    ' this worked fine in Excel 2010\n    Application.ScreenUpdating = False\n\n    ' this clears all flicker, but the whole of excel disappears\n    ' Application.Visible = False\n    ' this changes the flicker between Book1 and blank white screen\n    ' Application.Workbooks(\"Book2\").Windows(1).Visible = False\n\n    ' some flickery code\n    For i = 1 To 10\n        Windows(\"Book2\").Activate\n        Call Jiggle(\"Red\")\n        Windows(\"Book1\").Activate\n        Call Jiggle(\"Yel\")\n    Next i\n\n    ' restore normality\n    Application.ScreenUpdating = True\n    Application.Visible = True\nEnd Sub\n\n\nSub Jiggle(c As Variant)\n    For i = 1 To 100\n        ActiveCell.Offset(1, 0).Select\n        If (c = \"Yel\") Then Selection.Interior.Color = 255\n        If (c = \"Red\") Then Selection.Interior.Color = 65535\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "named-ranges"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10228012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3gndE.jpg?s=128&g=1", "display_name": "Hooksta_v1", "link": "https://stackoverflow.com/users/10228012/hooksta-v1"}, "edited": false, "score": 0, "creation_date": 1536468915, "post_id": 51854557, "comment_id": 91431446, "body": "Thanks, that put me on the right track. All fixed and running like a steam train."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1534318150, "creation_date": 1534318150, "answer_id": 51854557, "question_id": 51854466, "link": "https://stackoverflow.com/questions/51854466/loop-through-all-cells-in-a-row-and-a-named-range-simultaneously/51854557#51854557", "title": "Loop through all Cells in a Row and a Named Range Simultaneously", "body": "<p>To check if a range is within another range you can use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-intersect-method-excel\" rel=\"nofollow noreferrer\">Application.Intersect Method</a>.</p>\n\n<p>Here is an example that checks if A1 is in the NamedRange:</p>\n\n<pre><code>If Not Intersect(Range(\"A1\"), Range(\"NamedRange\")) Is Nothing Then\n    'A1 is in NamedRange\nElse\n    'A1 is not it NamedRange\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10228012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3gndE.jpg?s=128&g=1", "display_name": "Hooksta_v1", "link": "https://stackoverflow.com/users/10228012/hooksta-v1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 51854557, "answer_count": 1, "score": 2, "last_activity_date": 1549012634, "creation_date": 1534317630, "last_edit_date": 1549012634, "question_id": 51854466, "link": "https://stackoverflow.com/questions/51854466/loop-through-all-cells-in-a-row-and-a-named-range-simultaneously", "title": "Loop through all Cells in a Row and a Named Range Simultaneously", "body": "<p>Apologies up front, I'm a VBA novice.</p>\n\n<p>I'm looking to to find a way where I can loop through all cells in a row and if the cell is a part of a named range \"Targets\", I have the background colour change. </p>\n\n<p>I have originally done this using the code below where I would check all cells in the named range but it is becoming so slow it's not practical. I was hoping to speed the macro up by restricting the function to only the active row.</p>\n\n<p>I have tried various versions of Intersect and whilst I get it to select the cells I want to look at, I'm struggling to be able to use the result.</p>\n\n<pre><code>Dim cell As Range\nFor Each cell In Sheet5.Range(\"Targets\")\n    'Blank cells\n    If Cells(cell.Row, \"JE\").Value = \"\" Then\n        cell.Interior.Color = xlNone\n        cell.Font.Bold = False\n        cell.Font.Color = vbBlack\n    ElseIf cell.Value = \"\" And Month(Cells(cell.Row, \"\").Value) Mod 2 = 0 Then 'Odd\n        cell.Interior.Color = RGB(221, 221, 221)\n        cell.Font.Bold = False\n        cell.Font.Color = vbBlack\n    ElseIf cell.Value = \"\" And Month(Cells(cell.Row, \"\").Value) Mod 2 = 1 Then  'Even\n        cell.Interior.Color = xlNone\n        cell.Font.Bold = False\n        cell.Font.Color = vbBlack\n    '1-5 days Early (Green)\n    ElseIf cell.Offset(0, 1).Value = \"\" And cell.Value &gt;= Application.WorksheetFunction.WorkDay(Date, 1, [Support!B4:B100]) And cell.Value &lt;= Application.WorksheetFunction.WorkDay(Date, 5, [Support!B4:B100]) Then\n        cell.Interior.Color = RGB(188, 253, 175)\n        cell.Font.Bold = True\n        cell.Font.Color = RGB(84, 130, 53)\n    '1-3 Days Overdue (Orange)\n    ElseIf cell.Offset(0, 1).Value = \"\" And cell.Value &lt;= Application.WorksheetFunction.WorkDay(Date, -1, [Support!B4:B100]) And cell.Value &gt;= Application.WorksheetFunction.WorkDay(Date, -3, [Support!B4:B100]) Then\n        cell.Interior.Color = RGB(255, 168, 39)\n        cell.Font.Bold = True\n        cell.Font.Color = vbWhite\n    '1-3 Days Overdue (Red)\n    ElseIf cell.Offset(0, 1).Value = \"\" And cell.Value &lt; Application.WorksheetFunction.WorkDay(Date, -3, [Support!B4:B100]) Then\n        cell.Interior.Color = RGB(158, 0, 0)\n        cell.Font.Bold = True\n        cell.Font.Color = vbWhite\n    'Today (Blue)\n    ElseIf cell.Offset(0, 1).Value = \"\" And cell.Value = Application.WorksheetFunction.WorkDay(Date, 0, [Support!B4:B100]) Then\n        cell.Interior.Color = RGB(4, 119, 224)\n        cell.Font.Bold = True\n        cell.Font.Color = vbWhite\n    ElseIf Month(Cells(cell.Row, \"\").Value) Mod 2 = 0 Then 'Odd\n        cell.Interior.Color = RGB(221, 221, 221)\n        cell.Font.Bold = False\n        cell.Font.Color = vbBlack\n    Else: Month (Cells(cell.Row, \"\").Value) Mod 2 = 1 'Even\n        cell.Interior.Color = xlNone\n        cell.Font.Bold = False\n        cell.Font.Color = vbBlack\n    End If\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534317719, "post_id": 51854456, "comment_id": 90661336, "body": "In which line do you get the error and what exactly is the error message?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1534317806, "post_id": 51854456, "comment_id": 90661361, "body": "Note that you must use <code>Long</code> for all variables that handle row counts, because Excel has more rows than <code>Integer</code> can handle. It is recommended <a href=\"https://stackoverflow.com/a/26409520/3219613\">always to use Long instead of Integer</a> because there is no benefit in using <code>Integer</code> in VBA."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534318022, "post_id": 51854456, "comment_id": 90661438, "body": "Also as a sidenote, if your goal is to add a row after the last used row then why are you looping through all rows? + Try to refrain from using <code>.select</code> :)"}, {"owner": {"reputation": 7, "user_id": 10099361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7257a4f64c1282903256d0dd6039702d?s=128&d=identicon&r=PG&f=1", "display_name": "Rishi", "link": "https://stackoverflow.com/users/10099361/rishi"}, "edited": false, "score": 0, "creation_date": 1534318307, "post_id": 51854456, "comment_id": 90661535, "body": "The error is in the following code: &quot;currentRowValue = ws.Range(currentRow, sourceCol).Value&quot;. I also changed the integer to Long, but still getting the same error"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534318387, "post_id": 51854456, "comment_id": 90661571, "body": "What are the values of currentRow, sourceCol when the error occurs? Also, wrap your operations inside a With ws if you intend to work with that sheet otherwise it will use the Activesheet for  Cells(currentRow, sourceCol).Select             Rows(currentRow).Insert shift:=xlShiftDown"}, {"owner": {"reputation": 7, "user_id": 10099361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7257a4f64c1282903256d0dd6039702d?s=128&d=identicon&r=PG&f=1", "display_name": "Rishi", "link": "https://stackoverflow.com/users/10099361/rishi"}, "edited": false, "score": 0, "creation_date": 1534318400, "post_id": 51854456, "comment_id": 90661574, "body": "I commented the code which was using .select, but still getting the same error"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534318401, "post_id": 51854456, "comment_id": 90661575, "body": "What is the rowcount of col C?"}, {"owner": {"reputation": 7, "user_id": 10099361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7257a4f64c1282903256d0dd6039702d?s=128&d=identicon&r=PG&f=1", "display_name": "Rishi", "link": "https://stackoverflow.com/users/10099361/rishi"}, "edited": false, "score": 0, "creation_date": 1534318544, "post_id": 51854456, "comment_id": 90661619, "body": "Sorry I am a bit of beginner in Macro. How can i see the values of currentRow? sourceCol should always be 3 i believe, since I am not changing it at all."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534318616, "post_id": 51854456, "comment_id": 90661658, "body": "Step through your code using <code>F8</code>, then right after your error, hover over the variables to see their value!"}, {"owner": {"reputation": 7, "user_id": 10099361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7257a4f64c1282903256d0dd6039702d?s=128&d=identicon&r=PG&f=1", "display_name": "Rishi", "link": "https://stackoverflow.com/users/10099361/rishi"}, "edited": false, "score": 0, "creation_date": 1534318823, "post_id": 51854456, "comment_id": 90661761, "body": "CurrentRow is 4, rowcount is 85, currentRowValue is &quot;&quot;. Also, it is saying &quot;&lt;Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed&gt;&quot; when I hover over the error line"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1534319211, "post_id": 51854456, "comment_id": 90661899, "body": "If you are doing all that just to get the total rows in your table and then add a row to it, you could get the total rows just by trying something like this: <code>ThisWorkbook.Sheets(&quot;2.Set Up&quot;).ListObjects(&quot;MyTable&quot;).Range.Rows.Count</code>"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1534319501, "last_edit_date": 1534319501, "creation_date": 1534319043, "answer_id": 51854768, "question_id": 51854456, "link": "https://stackoverflow.com/questions/51854456/run-time-error-1004-excel-macro-code-was-running-fine-earlier/51854768#51854768", "title": "Run Time Error 1004 - Excel Macro - Code was running fine earlier", "body": "<p>You are using <code>Index</code> numbers to refer to a cell but on the same time you want to get the value using the <code>Range</code> notation. So change this line:</p>\n\n<pre><code>currentRowValue = ws.Range(currentRow, sourceCol).Value\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>currentRowValue = ws.cells(currentRow, sourceCol).Value\n</code></pre>\n\n<p>Want to know <strong><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/reference-cells-and-ranges\" rel=\"nofollow noreferrer\">more</a></strong>?</p>\n"}], "owner": {"reputation": 7, "user_id": 10099361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7257a4f64c1282903256d0dd6039702d?s=128&d=identicon&r=PG&f=1", "display_name": "Rishi", "link": "https://stackoverflow.com/users/10099361/rishi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 51854768, "answer_count": 1, "score": 0, "last_activity_date": 1534319501, "creation_date": 1534317530, "last_edit_date": 1534317635, "question_id": 51854456, "link": "https://stackoverflow.com/questions/51854456/run-time-error-1004-excel-macro-code-was-running-fine-earlier", "title": "Run Time Error 1004 - Excel Macro - Code was running fine earlier", "body": "<p>I have the following code to insert a new row in a table after the last row having values.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim sourceCol As Integer, rowCount As Integer, currentRow As Integer, additionalRow As Integer, additionalRowCounter As Integer, offsetRowCounter As Integer\n    Dim currentRowValue As String\n    'Dim Step5 As Range\n    Dim ws As Worksheet\n\n    Set ws = ThisWorkbook.Sheets(\"2.Set Up\")\n\n    ws.Activate\n    sourceCol = 3   'Entity Name is column C, which has a value of 6\n    additionalRow = 0\n    offsetRowCounter = 0\n    rowCount = ws.Cells(Rows.Count, sourceCol).End(xlUp).Row\n\n    'for every row starting from 4th row, find the first blank cell and select it\n    For currentRow = 4 To rowCount\n        currentRowValue = ws.Range(currentRow, sourceCol).Value\n        If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then\n            Cells(currentRow, sourceCol).Select\n            Rows(currentRow).Insert shift:=xlShiftDown\n            Exit For\n        End If\n        additionalRow = additionalRow + 1\n   Next\nEnd Sub\n</code></pre>\n\n<p>The tables starts from C4.</p>\n\n<p>Earlier it was working fine, but from yesterday I'm getting </p>\n\n<blockquote>\n  <p>Run-Time error 1004 while compiling the code. </p>\n</blockquote>\n\n<p>I haven't made any change in the sheet.</p>\n\n<p>Kindly suggest what can be the issue</p>\n"}, {"tags": ["vba", "excel", "csv", "powerquery"], "comments": [{"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1534315748, "post_id": 51854057, "comment_id": 90660618, "body": "maybe you could add a column which is <code>=mod(row(),7)</code> to identify them."}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1534327237, "post_id": 51854125, "comment_id": 90665498, "body": "Thanks for posting that. I wasn&#39;t aware that PQ could handle data sets that large."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 6, "last_activity_date": 1534315665, "creation_date": 1534315665, "answer_id": 51854125, "question_id": 51854057, "link": "https://stackoverflow.com/questions/51854057/delete-all-rows-in-csvexcel-except-each-nth-row/51854125#51854125", "title": "Delete all rows in CSV(Excel) except each nth row", "body": "<p>Load your source. </p>\n\n<p>Open the Powerquery advanced query editor  > home tab > remove rows > remove alternate rows</p>\n\n<p>Specify pattern as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jhyCG.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jhyCG.png\" alt=\"pattern\"></a></p>\n\n<p>Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pHl5O.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/pHl5O.png\" alt=\"result\"></a></p>\n"}], "owner": {"reputation": 81, "user_id": 4811148, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-R72gM6xGIcQ/AAAAAAAAAAI/AAAAAAAAABQ/cFPb7bufxQI/photo.jpg?sz=128", "display_name": "KARANJ", "link": "https://stackoverflow.com/users/4811148/karanj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 51854125, "answer_count": 1, "score": 2, "last_activity_date": 1537761448, "creation_date": 1534315301, "last_edit_date": 1537761448, "question_id": 51854057, "link": "https://stackoverflow.com/questions/51854057/delete-all-rows-in-csvexcel-except-each-nth-row", "title": "Delete all rows in CSV(Excel) except each nth row", "body": "<p>I have a csv dataset file having more than 3 million entries. \nI would like to delete all entries except every 7th entry (keep only every 7th row).\nHow can i do it using power query OR defining a function while using \"Get Data\" from text/csv functionality in excel?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1534310324, "post_id": 51853275, "comment_id": 90659133, "body": "You can essentially find your answer here <a href=\"https://stackoverflow.com/q/14881032/2727437\">stackoverflow.com/q/14881032/2727437</a>"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1534313110, "post_id": 51853275, "comment_id": 90659754, "body": "get rid of <code>For i = 1 To 1</code> and <code>Next</code> statements since you&#39;d loop once (hence no loop) and you don&#39;t use <code>i</code> anywhere"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534313399, "post_id": 51853275, "comment_id": 90659824, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14881032/copy-excel-sheet-to-another-excel-book-but-just-formats-and-values\">Copy Excel sheet to another excel book but just formats and values</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1534422688, "post_id": 51853727, "comment_id": 90705446, "body": "@OliverCrawford, any feedback?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1534313369, "creation_date": 1534313369, "answer_id": 51853727, "question_id": 51853275, "link": "https://stackoverflow.com/questions/51853275/creating-a-new-tab/51853727#51853727", "title": "Creating a new tab", "body": "<p>you could try this:</p>\n\n<pre><code>Private Sub GENERATE_OP_SHEET_Click()\n    Sheets(\"TEMPLATE\").Copy After:=Sheets(\"TEMPLATE\")\n    With ActiveSheet ' after 'Copy' statemement the copied sheet is the \"active\" one\n        .Name = Range(\"g2\").Text\n        .UsedRange.Value = .UsedRange.Value ' leave values only\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1534325082, "post_id": 51855796, "comment_id": 90664411, "body": "Won&#39;t that change the source TEMPLATE sheet to values?  The OP wants the destination sheet to be converted to values"}], "tags": [], "owner": {"reputation": 208, "user_id": 10062262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41486435301afe7d1ac37b98a2fb4871?s=128&d=identicon&r=PG&f=1", "display_name": "Yuki", "link": "https://stackoverflow.com/users/10062262/yuki"}, "is_accepted": false, "score": 0, "last_activity_date": 1534323658, "creation_date": 1534323658, "answer_id": 51855796, "question_id": 51853275, "link": "https://stackoverflow.com/questions/51853275/creating-a-new-tab/51855796#51855796", "title": "Creating a new tab", "body": "<p>Based on my test, please try the code as below:</p>\n\n<pre><code>Private Sub GENERATE_OP_SHEET_Click()\n    Sheets(\"TEMPLATE\").Copy After:=Sheets(\"TEMPLATE\")\n    ActiveSheet.Name = Range(\"g2\").Text\n    With Sheets(\"TEMPLATE\").UsedRange\n        .Value = .Value 'converts formulas to values\n    End With\nEnd Sub\n</code></pre>\n\n<p>For more information, please see:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/14881032/copy-excel-sheet-to-another-excel-book-but-just-formats-and-values\">Copy Excel sheet to another excel book but just formats and values</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10227696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-udTEQGrY9j4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oof6wa4jLGd9wqEus6cvtSW09_3g/mo/photo.jpg?sz=128", "display_name": "Oliver Crawford", "link": "https://stackoverflow.com/users/10227696/oliver-crawford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534323658, "creation_date": 1534309863, "last_edit_date": 1534310949, "question_id": 51853275, "link": "https://stackoverflow.com/questions/51853275/creating-a-new-tab", "title": "Creating a new tab", "body": "<p>How to I add to this VBA code so it is only copying values and formats </p>\n\n<pre><code>Private Sub GENERATE_OP_SHEET_Click()\n    Dim i As Byte\n    For i = 1 To 1\n        Sheets(\"TEMPLATE\").Copy After:=Sheets(\"TEMPLATE\")\n        Set Sh = ActiveSheet\n        ActiveSheet.Name = Range(\"g2\").Text\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "csv"], "comments": [{"owner": {"reputation": 1678, "user_id": 6750211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tmOvh.gif?s=128&g=1", "display_name": "Kevin Fang", "link": "https://stackoverflow.com/users/6750211/kevin-fang"}, "edited": false, "score": 1, "creation_date": 1534309002, "post_id": 51853149, "comment_id": 90658824, "body": "How do you define &#39;efficient&#39;? Do you want a short programme that uses least human effort, or you want the total processing time as short as possible?"}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 1, "creation_date": 1534309085, "post_id": 51853149, "comment_id": 90658845, "body": "There\u2019s no way to modify a file without opening it. How could that even work?"}, {"owner": {"reputation": 123, "user_id": 7882846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530ef04c809dedeed556712b5fa2365f?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/7882846/todd"}, "reply_to_user": {"reputation": 1678, "user_id": 6750211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tmOvh.gif?s=128&g=1", "display_name": "Kevin Fang", "link": "https://stackoverflow.com/users/6750211/kevin-fang"}, "edited": false, "score": 0, "creation_date": 1534309209, "post_id": 51853149, "comment_id": 90658867, "body": "@Kevin.Fang Hi Kevin, both way would be fine. I guess less human effort also would save some time or either way!"}, {"owner": {"reputation": 1678, "user_id": 6750211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tmOvh.gif?s=128&g=1", "display_name": "Kevin Fang", "link": "https://stackoverflow.com/users/6750211/kevin-fang"}, "reply_to_user": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 0, "creation_date": 1534309461, "post_id": 51853149, "comment_id": 90658917, "body": "Well sometimes it takes more effort to optimise a programme. So by &#39;without opening it&#39; do you mean literally &#39;open the file in Excel&#39;? As @abarnert said you actually cannot modify a file without &#39;open&#39; it in a programme."}, {"owner": {"reputation": 123, "user_id": 7882846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530ef04c809dedeed556712b5fa2365f?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/7882846/todd"}, "reply_to_user": {"reputation": 1678, "user_id": 6750211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tmOvh.gif?s=128&g=1", "display_name": "Kevin Fang", "link": "https://stackoverflow.com/users/6750211/kevin-fang"}, "edited": false, "score": 0, "creation_date": 1534309773, "post_id": 51853149, "comment_id": 90658990, "body": "@Kevin.Fang Yes. I meant &#39;without opening&#39; by literally &#39;opening the file in excel&#39;. If I could import the files on python and run codes that work, then it would be great."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534310478, "post_id": 51853149, "comment_id": 90659167, "body": "Just in case you don\u2019t know, excel can loop through files then open, change, and close them without your input. No need to involve python"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1534316861, "post_id": 51853149, "comment_id": 90661035, "body": "<a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">I downvoted because no attempt was made</a>, <a href=\"http://idownvotedbecau.se/noresearch\" rel=\"nofollow noreferrer\">research must be done to ask a good question</a>. Why is this even tagged with <code>excel-vba</code>? OP clearly states he doesn&#39;t want to open it in excel."}], "answers": [{"tags": [], "owner": {"reputation": 1678, "user_id": 6750211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tmOvh.gif?s=128&g=1", "display_name": "Kevin Fang", "link": "https://stackoverflow.com/users/6750211/kevin-fang"}, "is_accepted": false, "score": 1, "last_activity_date": 1534310694, "creation_date": 1534310694, "answer_id": 51853379, "question_id": 51853149, "link": "https://stackoverflow.com/questions/51853149/how-to-add-a-new-column-without-opening-a-csv-file/51853379#51853379", "title": "how to add a new column without opening a csv file", "body": "<p>My solution using python's <code>pandas</code> package:</p>\n\n<pre><code>import os\nimport re\nimport pandas as pd\n\nFILE_PATTERN = re.compile(r'(.*)_(\\d{8})_result.csv')\n\ndef addDate(file_dir):\n    csv_list = [csvfile for csvfile in os.listdir(file_dir) if re.fullmatch(FILE_PATTERN, csvfile)]\n    for csvname in csv_list:\n        date = re.fullmatch(FILE_PATTERN, csvname).group(2)\n        df = pd.read_csv(os.path.join(file_dir, csvname))\n        df.insert(loc=1, column='date', value=[date]*len(df))\n        df.to_csv(os.path.join(file_dir, csvname), index=False)\n</code></pre>\n\n<p>Sample input: <code>NYC_20180814_result.csv</code> in <code>some_path</code>:</p>\n\n<pre><code>   A  B  C\n0  0  1  2\n1  3  4  5\n2  6  7  8\n</code></pre>\n\n<p>Same csv after executing <code>addDate(some_path)</code>:</p>\n\n<pre><code>   A      date  B  C\n0  0  20180814  1  2\n1  3  20180814  4  5\n2  6  20180814  7  8\n</code></pre>\n\n<p>P.S. You'll not see the index column in your csv file.</p>\n"}], "owner": {"reputation": 123, "user_id": 7882846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530ef04c809dedeed556712b5fa2365f?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/7882846/todd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1594151387, "creation_date": 1534308791, "last_edit_date": 1594151387, "question_id": 51853149, "link": "https://stackoverflow.com/questions/51853149/how-to-add-a-new-column-without-opening-a-csv-file", "title": "how to add a new column without opening a csv file", "body": "<p>I scrapped data and exported as csv files.\nFor simplicity, the data look like below\n(I intentionally put arbitrary variables to just illustrate an example):</p>\n\n<pre><code>id var1 var2 var3 ...\nA  10   14    355 ...\nB  35   56    22  ...\nC  95   22    222 ...\nD  44   55    222 ... \n</code></pre>\n\n<p>Since I collected the data daily, I saved my file name as city_20180814_result.csv\nFor example, if I collected the data in NYC at Aug 14th 2018, the corresponding file name is NYC_20180814_result.csv</p>\n\n<p>Here, I want to add a new column, the date variable, into each csv file.\nThe desired example is going to be like the one below. To be specific, I want to add a date (YYYYMMDD as a format) column to each csv file and the values are going to be the date when the data were collected. For example, the below example csv file was generated on Aug 14th 2018, then the updated data will look like below: </p>\n\n<pre><code>id   date     var1 var2  var3 ...\nA    20180814 10   14    355 ...\nB    20180814 35   56    22  ...\nC    20180814 95   22    222 ...\nD    20180814 44   55    222 ... \n</code></pre>\n\n<p>The conventional way to do this is to open every csv file and manually add a new column, assign a corresponding date to all the rows, and repeat this step for all csv files. But there are too many to get this done. Is there any way to do this efficiently? Since I saved file names including the date, it would be a good idea to use this if it's possible. Any help/codes (by using python again or excel macro) would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534303202, "post_id": 51852456, "comment_id": 90657586, "body": "You&#39;re missing the <code>.Apply</code> within your <code>With...End With</code> block. Also, avoid using <code>On Error Resume Next</code> - handle errors if necessary."}, {"owner": {"reputation": 49, "user_id": 9895501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fe47db67a68d8a5a15426b0eaa5faf?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/9895501/matt"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534303754, "post_id": 51852456, "comment_id": 90657697, "body": "Excellent, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1534303820, "creation_date": 1534303820, "answer_id": 51852557, "question_id": 51852456, "link": "https://stackoverflow.com/questions/51852456/looping-through-all-tables-and-sorting/51852557#51852557", "title": "looping through all tables and sorting", "body": "<p>You need to <code>Apply</code> the sorting after you've specified your sort options. </p>\n\n<hr>\n\n<p>Also, a couple recommendations:</p>\n\n<ul>\n<li>Remove <code>On Error Resume Next</code> - handle any errors that may occur (if necessary); this just ignores them and moves on.</li>\n<li>Only a <code>Worksheet</code> can have a <code>ListObject</code> - a <code>Chart</code> sheet can't, for example. So loop through <code>ThisWorkbook.Worksheets</code>.</li>\n</ul>\n\n<hr>\n\n<pre><code>Private Sub ClearAllFilters()\n\nDim sht As Worksheet\nDim lstobj As ListObject\n\nFor Each sht In ThisWorkbook.Worksheets\n    For Each lstobj In sht.ListObjects\n        lstobj.AutoFilter.ShowAllData\n        With lstobj.Sort\n            .SortFields.Clear\n            .SortFields.Add Key:=lstobj.DataBodyRange.Columns(1), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .Apply\n        End With\n    Next lstobj\nNext sht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9895501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fe47db67a68d8a5a15426b0eaa5faf?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/9895501/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 51852557, "answer_count": 1, "score": 0, "last_activity_date": 1534303820, "creation_date": 1534302793, "question_id": 51852456, "link": "https://stackoverflow.com/questions/51852456/looping-through-all-tables-and-sorting", "title": "looping through all tables and sorting", "body": "<p>I am trying to write a sub to loop through all tables in my workbook and remove any filters then sort the first column alphabetically<br>\nI've come up with the following code but I'm just having some issues with the correct syntax. It will clear the filters but doesn't do the sort.<br>\nI've tried to find other solutions on this and other sites but they all seem to refer to particular named ranges which I want to avoid as I'm dealing with multiple tables. I think it's just a problem with how I've done the \"key\".</p>\n\n<pre><code>Private Sub ClearAllFilters()\n\nDim sht As Excel.Worksheet\nDim lstobj As Excel.ListObject\n\nOn Error Resume Next\nFor Each sht In ThisWorkbook.Sheets\n    For Each lstobj In sht.ListObjects\n        lstobj.AutoFilter.ShowAllData\n        With lstobj.Sort\n            .SortFields.Clear\n            .SortFields.Add Key:=lstobj.DataBodyRange.Columns(1), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        End With\n    Next\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "data-transfer"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534310699, "post_id": 51852354, "comment_id": 90659226, "body": "You\u2019ll need to be a little more specific about what exactly you want, because this could be a rather cumbersome job which is not the intent of this site"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1534313835, "post_id": 51852354, "comment_id": 90659956, "body": "I recommend to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> and apply this to your code first. It will make your code much shorter more reliable and faster and easier to maintain. Did I understand it correctly that you just want to run this code on every worksheet? Then just build a loop around it that loops through your worksheets to run the code in very sheet."}, {"owner": {"reputation": 1676, "user_id": 9992612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef2e5e68dd3a455ba00724f5fdfaf604?s=128&d=identicon&r=PG&f=1", "display_name": "Seiya Su", "link": "https://stackoverflow.com/users/9992612/seiya-su"}, "edited": false, "score": 0, "creation_date": 1534322868, "post_id": 51852354, "comment_id": 90663426, "body": "It seems your data is not very regular. Do you want to just use the Golf:Girls or all data? It better to handle the filter in the data service but not VBA"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534424216, "post_id": 51852354, "comment_id": 90706471, "body": "Is there a web link/URL we can use ? It may be possible to just pull back specific information from the site."}], "owner": {"reputation": 3, "user_id": 9597584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b6468c5fba11414812d743cfc51190c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/9597584/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534302043, "creation_date": 1534301822, "last_edit_date": 1534302043, "question_id": 51852354, "link": "https://stackoverflow.com/questions/51852354/transfer-data-from-a-list-of-data-to-another-worksheet-using-a-macro-in-excel", "title": "transfer data from a list of data to another worksheet using a macro in excel", "body": "<p>I sure hope I can properly explain this... I have a list of data.  The data includes dates, times, and names of schools.  I need this data from the worksheet I currently grabbed from the \"get data\" \"from the web\" function in excel.  Here is an example of what I'm trying to accomplish based on the data I have on these spreadsheets:</p>\n\n<p><strong>Friday, August 17</strong></p>\n\n<p><strong>Boys Soccer</strong></p>\n\n<p>Antioch at Vernon Hills, 4:30 p.m.</p>\n\n<p>Stevenson at Warren, 5 p.m.</p>\n\n<p><strong>Girls Tennis</strong></p>\n\n<p>Vernon Hills at Warren, 6 p.m.</p>\n\n<p>Round Lake at Wauconda, 6 p.m.</p>\n\n<p><strong>Saturday, August 18</strong></p>\n\n<p><strong>Boys Golf</strong></p>\n\n<p>Warren at Antioch, 8:30 a.m.</p>\n\n<p>The list goes on everyday of the week with different schedules and team names as well as the time the game is to be played.</p>\n\n<p>Basically this data exists on the spreadsheet that I currently hold the data, only that the data itself is kind of all over the place.  Granted the comma's before the time aren't on the spreadsheet and the \"p.m.\" and \"a.m.\" don't have periods in between them.  So adding those to the code would be helpful.  I'll share a screenshot of what the data I have looks like so it can be seen for reference.  </p>\n\n<p>Now, I have managed to build a macro that is doing what I technically want it to do, however I haven't been able to figure out the code that says move on to the next line in the range of data.  In addition, I have 4 other tabs (aka; sheets) that have the same formatted data only for a different school.  It would be ideal if one push of a button to organize the data from all spreadsheets in a manner as described in the example above.  However, I'd be happy with just one button right now for one school and then taking that code and changing it up to use on a different school.  </p>\n\n<p>So it's known, what I'm attempting to accomplish overall here is a schedule of games for high school sports by date and type of sport. </p>\n\n<p>Here is the code I am currently using:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Eventname As String, Time As String, Opponent As String, Location As String, dateday As String\nWorksheets(\"Vernon Hills\").Select\nEventname = Range(\"A3\")\nTime = Range(\"B3\")\nOpponent = Range(\"C3\")\nLocation = Range(\"D3\")\ndateday = Range(\"B2\")\nWorksheets(\"Main\").Select\nWorksheets(\"Main\").Range(\"A1\").Select\nIf Worksheets(\"Main\").Range(\"A1\").Offset(1, 0) &lt;&gt; \"\" Then\nWorksheets(\"Main\").Range(\"A1\").End(xlDown).Select\nEnd If\nActiveCell.Offset(1, 0).Select\nActiveCell.Value = dateday\nActiveCell.Offset(1, 0).Select\nActiveCell.Value = Opponent\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = Time\nWorksheets(\"Vernon Hills\").Select\n\n\nEnd Sub\n</code></pre>\n\n<p>Lastly.... Here is a screenshot of the data I'm trying to scrape data from.</p>\n\n<p><img src=\"https://i.stack.imgur.com/KMkZo.jpg\" alt=\"https://i.stack.imgur.com/KMkZo.jpg\"></p>\n\n<p>You'll notice that cell A3 has the words \"Golf:Girls\" located in that particular cell.  Also note that the date is in A2 and the name of the opponent is in C3.  The Location column is just a way for me to reference \"Home\" vs. \"Away\" teams.  </p>\n\n<p>Thank you to anyone that can help me... I will gladly specify more if need be.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534300898, "post_id": 51852154, "comment_id": 90657133, "body": "The <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-newsheet-event-excel\" rel=\"nofollow noreferrer\"><code>Workbook.NewSheet</code> event</a> occurs when a new sheet is added in <code>ThisWorkbook</code> - but it sounds like you want to detect worksheet insertion in any open workbook?"}, {"owner": {"reputation": 75, "user_id": 10189458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbfb99e9cc10c16f4b2f21300b01a34?s=128&d=identicon&r=PG&f=1", "display_name": "Lim", "link": "https://stackoverflow.com/users/10189458/lim"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534301070, "post_id": 51852154, "comment_id": 90657170, "body": "yes, is there any ways i can do that?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534301135, "post_id": 51852154, "comment_id": 90657184, "body": "you can probably do that using Application-level events  - see <a href=\"https://msdn.microsoft.com/en-us/library/office/dn254092.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/dn254092.aspx</a> and <a href=\"http://www.cpearson.com/excel/appevent.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/appevent.aspx</a>  EDIT - if you don&#39;t need to detect &quot;new workbook&quot; events then you can just use a collection of &quot;with events&quot; workbook references"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534301394, "post_id": 51852154, "comment_id": 90657247, "body": "@TimWilliams yeah, the <a href=\"https://msdn.microsoft.com/en-us/VBA/Excel-VBA/articles/application-workbooknewsheet-event-excel\" rel=\"nofollow noreferrer\">Application.WorkbookNewSheet Event</a>"}, {"owner": {"reputation": 75, "user_id": 10189458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbfb99e9cc10c16f4b2f21300b01a34?s=128&d=identicon&r=PG&f=1", "display_name": "Lim", "link": "https://stackoverflow.com/users/10189458/lim"}, "edited": false, "score": 0, "creation_date": 1534301490, "post_id": 51852154, "comment_id": 90657273, "body": "but is it possible for it to run automatically without i manually run it whenever i start a new workbook?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534301621, "post_id": 51852154, "comment_id": 90657304, "body": "Yes - for more detail on Events, read <a href=\"http://www.cpearson.com/excel/Events.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/Events.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 10189458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbfb99e9cc10c16f4b2f21300b01a34?s=128&d=identicon&r=PG&f=1", "display_name": "Lim", "link": "https://stackoverflow.com/users/10189458/lim"}, "edited": false, "score": 0, "creation_date": 1534301900, "post_id": 51852325, "comment_id": 90657340, "body": "Hi, there is a compile error; user define type not defined for Dim oGh As New clsGlobalHandler"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 75, "user_id": 10189458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbfb99e9cc10c16f4b2f21300b01a34?s=128&d=identicon&r=PG&f=1", "display_name": "Lim", "link": "https://stackoverflow.com/users/10189458/lim"}, "edited": false, "score": 0, "creation_date": 1534301960, "post_id": 51852325, "comment_id": 90657352, "body": "read the code comments. don&#39;t copy paste blindly. you need to create a class with the name of clsGlobalHandler ."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1534301558, "creation_date": 1534301558, "answer_id": 51852325, "question_id": 51852154, "link": "https://stackoverflow.com/questions/51852154/automatically-run-macro-if-the-user-inserted-a-new-worksheet/51852325#51852325", "title": "Automatically run macro if the user inserted a new worksheet", "body": "<p>As mentioned in the comments you need to handle <code>WorkbookNewSheet</code> at <code>Application</code> level.</p>\n\n<hr>\n\n<pre><code>'-- Create a new Class.\n'-- Name it clsGlobalHandler.\n'-- Following Code goes in that class\n\n'/ Create a variable to hold Application Object\nPublic WithEvents xlApp As Application\n\n'/ Handle NewSheet event. Invoked whenever a new sheet is added\nPrivate Sub xlApp_WorkbookNewSheet(ByVal Wb As Workbook, ByVal Sh As Object)\n    MsgBox Sh.Name\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>'-- Create a new module\n'-- Following code goes there\n\nOption Explicit\n\n'/ A new instance  for the Class that we created.\nDim oGh As New clsGlobalHandler\n\n'/ To start tracking sheet additions call this method first. Most likely in WorkBook_Open\n'/ Once called any new sheet across the app insatnce will be intercepted.\nSub SetGlobalHandler()\n    Set oGh.xlApp = Application\nEnd Sub\n\n'/ Call this to remove the global handler.\nSub ResetGlobalHandler()\n    Set oGh.xlApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 10189458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbfb99e9cc10c16f4b2f21300b01a34?s=128&d=identicon&r=PG&f=1", "display_name": "Lim", "link": "https://stackoverflow.com/users/10189458/lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 51852325, "answer_count": 1, "score": 0, "last_activity_date": 1568951418, "creation_date": 1534300243, "last_edit_date": 1568951418, "question_id": 51852154, "link": "https://stackoverflow.com/questions/51852154/automatically-run-macro-if-the-user-inserted-a-new-worksheet", "title": "Automatically run macro if the user inserted a new worksheet", "body": "<p>I would like my macro to run automatically if it detects that the user inserted a new worksheet into the workbook (existing &amp; new). </p>\n\n<pre><code> Sub macro_run()\n\n    Dim Newws As Worksheet\n    Dim wb As Excel.Workbook\n    Dim sample1 As Worksheet\n\n    With ThisWorkbook\n        Set sample1 = .Sheets(\"Template\")\n\n        For Each wb In Application.Workbooks\n            If Newws = sample1 Then\n                Application.Run \"PERSONAL.XLSB!Opennew\"\n            End If\n        Next wb\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "edited": false, "score": 0, "creation_date": 1534336729, "post_id": 51851967, "comment_id": 90669748, "body": "That works perfect, thanks! I really do appreciate the clear, concise explanation, as I am very new to VBA. I also appreciate the &quot;OCD&quot; comment... I tend to be that way too, but I am still figuring this out! Thanks!"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1534641332, "last_edit_date": 1534641332, "creation_date": 1534298493, "answer_id": 51851967, "question_id": 51851904, "link": "https://stackoverflow.com/questions/51851904/format-text-as-bold/51851967#51851967", "title": "Format text as bold", "body": "<p>To bold a cell: <code>Range.Font.Bold = True</code>  </p>\n\n<p>Your target cell is in <code>Col Y</code> (Col 25) so to get to <code>Col B</code> (Col 2) you need to go backwards (offset by a value of) 23 columns resulting in:</p>\n\n<p><code>Cell.Offset(0,-23).Font.Bold = True</code></p>\n\n<hr>\n\n<p>The OCD side of me insists on advising you to </p>\n\n<ol>\n<li>Indent Properly</li>\n<li>Modify the loop range (see code)</li>\n<li>Column <code>Y</code> = Column <code>25</code>. No need for <code>.Cells(Cell.Row, 25)</code>. Just analyze the variable, <code>Cell</code></li>\n<li>Last, distinguishing between <code>Cells</code> the <strong>Object</strong> and <code>Cell</code> the <strong>Variable</strong> you declared can be confusing and lead to errors. Change <code>Cell</code> to something like <code>MyCell</code> so the difference is clear.</li>\n</ol>\n\n<hr>\n\n<pre><code>Dim MyCell as Range\n\nWith Sheets(1) 'Some Sheet\n    For Each MyCell In .Range(\"Y5:Y\" &amp; .Range(\"Y\" &amp; .Rows.Count).End(xlUp).Row)\n        If MyCell = \"Super Project\" Then\n            MyCell.EntireRow.Interior.Color = vR(WorksheetFunction.RandBetween(1, n))\n            MyCell.Offset(,-23).Font.Bold = True\n        End If\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 2514430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bc915bac319d8657b4cf467a15e638?s=128&d=identicon&r=PG", "display_name": "sparkynerd", "link": "https://stackoverflow.com/users/2514430/sparkynerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 51851967, "answer_count": 1, "score": 0, "last_activity_date": 1547619189, "creation_date": 1534298030, "last_edit_date": 1547619189, "question_id": 51851904, "link": "https://stackoverflow.com/questions/51851904/format-text-as-bold", "title": "Format text as bold", "body": "<p>This formula colors an entire row based on a cell in that row containing a specific value.</p>\n\n<pre><code>For Each Cell In .Range(\"Y5:\" &amp; .Range(\"Y1500\").End(xlDown).Address)\n    If .Cells(Cell.Row, 25).value = \"Super Project\" Then\n        Cell.EntireRow.Interior.Color = vR(WorksheetFunction.RandBetween(1, n))\n\n    End If\nNext\nEnd With\n</code></pre>\n\n<p>How can I make the cell in column \u201cB\u201d also turn bold?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1534303718, "post_id": 51851772, "comment_id": 90657687, "body": "When I actually try and grab the Selected Row, I am not able to detect the correct one.  How do you  do this?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534310908, "post_id": 51851772, "comment_id": 90659265, "body": "So your goal is to push any updates/new entries made with the form to the access database?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9710116"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534324809, "post_id": 51851772, "comment_id": 90664275, "body": "Yes @Marcucciboy2"}], "owner": {"user_type": "does_not_exist", "display_name": "user9710116"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534296632, "creation_date": 1534296632, "question_id": 51851772, "link": "https://stackoverflow.com/questions/51851772/how-to-delete-update-selected-element-with-cascade-in-form", "title": "How to delete / update selected element with cascade in Form?", "body": "<p>I have a table called Platformer that has data like this:</p>\n\n<pre><code> GameID  Bits    Developer   IsSideScroller\n   1      64      Nintendo      Yes\n   2      64      Sega          Yes\n</code></pre>\n\n<p>I have a Form that holds Game data like this:</p>\n\n<pre><code>GameID  Type\n</code></pre>\n\n<p>The <code>RecordSource</code> for this Form is a <code>SELECT GameID FROM Games</code></p>\n\n<p>In this Form, Type is a Combo Box and the options are <code>Platformer, Shooter, RPG</code></p>\n\n<p>The Game Form, with all data filled out would look like this:</p>\n\n<pre><code>GameID  Type\n  1     Platformer\n  2     Platformer\n  3     RPG\n  4     Shooter\n  5     RPG\n</code></pre>\n\n<p>I have another Form called Platformer that should be linked to the Platformer table. I only want to display data associated with Platformers here.</p>\n\n<p>When I add a Game to the Game Form and assign it as Platformer, the functionality works, but when I actually try and grab the Selected Row, I am not able to detect the correct one.</p>\n\n<p>For example, if I wanted to change the Type to GameID 4 in the Game Form to a Platformer, then it should be logged to the Platformer table. Similarly, if I were to change the Type of GameID 2 to RPG then it should remove this instance from the Platformer table. </p>\n\n<p>I am tinkering with Access but I am not able to grab the whole selected row and make the cascading effect. I have a relationship set-up with GameID. </p>\n\n<p>I hope I am clear with my request and that someone can help me. I would appreciate it.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534298203, "post_id": 51851719, "comment_id": 90656650, "body": "lmk if the below solution works on your end"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10213487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42df5aa2fa235cfdfb9349b3837d9db8?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/10213487/tag"}, "edited": false, "score": 0, "creation_date": 1534306567, "post_id": 51851873, "comment_id": 90658271, "body": "Thank you very much for your reply @urdearboy, I copy pasted your code but it didn&#39;t work I got an error &quot;Range of Object Failed&quot; and it&#39;s highlighting yellow on the &quot;ws.Range(Cells(4, 1), Cells(LRow, LCol)).Copy&quot; I also noticed that &quot;Option Explicit&quot; maybe not in the right place? and yes all your assumptions are correct. Thanks again."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 15, "user_id": 10213487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42df5aa2fa235cfdfb9349b3837d9db8?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/10213487/tag"}, "edited": false, "score": 0, "creation_date": 1534307839, "post_id": 51851873, "comment_id": 90658557, "body": "Did you change the sheet name as mentioned in #3. Option explicit is in the correct place"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 15, "user_id": 10213487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42df5aa2fa235cfdfb9349b3837d9db8?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/10213487/tag"}, "edited": false, "score": 0, "creation_date": 1534308311, "post_id": 51851873, "comment_id": 90658672, "body": "I found the error. Didn\u2019t qualify a cell object. Try again - should work"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1534641388, "last_edit_date": 1534641388, "creation_date": 1534297657, "answer_id": 51851873, "question_id": 51851719, "link": "https://stackoverflow.com/questions/51851719/vba-code-to-copy-non-blank-cells-from-one-sheet-to-another/51851873#51851873", "title": "VBA Code to Copy Non Blank Cells From one Sheet to Another", "body": "<ol>\n<li>I'm assuming that <code>Col A</code> is a good indicator of where to find your last used row </li>\n<li>Also assuming that <code>Row 1</code> is a good indicator of where to find your last used column</li>\n<li>You need to change <code>Sheet1</code> on 3rd line of code to the name of your sheet that has the data to be copied</li>\n<li>You need to declare variables (Use <code>Option Explicit</code>)</li>\n<li>Avoid <code>.Select</code> and <code>.Selection</code> at all costs (none are found in below solution)</li>\n<li>You did not re-enable <code>ScreenUpdating</code> and <code>DisplayAlerts</code></li>\n<li>This is tested and works <strong>A-OK</strong></li>\n</ol>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub Export_Template()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim NewBook As Workbook\nDim LRow As Long, LCol As Long\nDim FileName\n\nFileName = Application.GetSaveAsFilename(InitialFileName:=\"Engineering TPD\", FileFilter:=\"Excel Files (*.xlsx), *.xlsx\")\n\nIf FileName &lt;&gt; False Then\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n        Set NewBook = Workbooks.Add\n            LRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n            LCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column\n\n            ws.Range(ws.Cells(4, 1), ws.Cells(LRow, LCol)).Copy\n            NewBook.Sheets(1).Range(\"A1\").PasteSpecial xlPasteValues\n\n        NewBook.SaveAs FileName:=FileName, FileFormat:=51\n        NewBook.Close False\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1534308531, "last_edit_date": 1534308531, "creation_date": 1534307889, "answer_id": 51853045, "question_id": 51851719, "link": "https://stackoverflow.com/questions/51851719/vba-code-to-copy-non-blank-cells-from-one-sheet-to-another/51853045#51853045", "title": "VBA Code to Copy Non Blank Cells From one Sheet to Another", "body": "<p>The code below will preserve your <code>ActiveSheet</code> range and use <code>SaveAs</code> to save to a new workbook with your specific name, without all the extra crap. It deletes all the sheets except for the <code>ActivSheet</code>, and deletes the first three rows, then using <code>SaveAs</code> to save to <code>ThisWorkbook.Path</code>. Your macro enabled workbook will not be changed. \nI actually don't like to use <code>ActiveSheet</code> due to the obvious problems, but since you were using it i kept it. I would suggest you use the name of the worksheet.</p>\n\n<pre><code>Sub SaveActiveSheetRangeAsNewWorkbook()\nDim ws As Worksheet\n\nApplication.DisplayAlerts = False\n\n    With ThisWorkbook\n        For Each ws In Application.ThisWorkbook.Worksheets\n            If ws.Name &lt;&gt; ActiveSheet.Name Then\n                ws.Delete\n            End If\n        Next\n\n        .Sheets(1).Range(\"A1:A3\").EntireRow.Delete\n        .SaveAs Filename:=\"Engineering TPD\", FileFormat:=xlOpenXMLWorkbook\n    End With\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10213487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42df5aa2fa235cfdfb9349b3837d9db8?s=128&d=identicon&r=PG&f=1", "display_name": "TAG", "link": "https://stackoverflow.com/users/10213487/tag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1041, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1534641388, "creation_date": 1534296167, "last_edit_date": 1534296923, "question_id": 51851719, "link": "https://stackoverflow.com/questions/51851719/vba-code-to-copy-non-blank-cells-from-one-sheet-to-another", "title": "VBA Code to Copy Non Blank Cells From one Sheet to Another", "body": "<p>I'm trying to write a VBA code to copy \"Non-Blank\" cells from one file to another. This code selects the last Non Blank row, but for the column it's copying <code>A4 to AU</code>. I'd like to copy columns <code>A4 to LastcolumnNotblank</code> and also last row. So basically copy <code>A4 to (LastColumn)(LastRow)Not Blank</code></p>\n\n<p>Would be really grateful if someone can help by editing the below code. Many thanks. </p>\n\n<pre><code>Sub Export_Template()\n\n'' TPD\n\nFile_name = Application.GetSaveAsFilename(InitialFileName:=\"Engineering TPD\", FileFilter:=\"Excel Files (*.xlsx), *.xlsx\")\n\nIf File_name &lt;&gt; False Then\n\n Application.ScreenUpdating = False\n Application.DisplayAlerts = False\n\n LastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n For i = 4 To LastRow\n If Left(ActiveSheet.Range(\"A\" &amp; i).Value, 1) &lt;&gt; \"\" Then lastactiverow = i\n Next i\n   'MsgBox (lastactiverow)\n    ActiveSheet.Range(\"A4:AU\" &amp; lastactiverow).Select\n    Selection.Copy\n\nSet NewBook = Workbooks.Add\n\nActiveSheet.Range(\"A1\").PasteSpecial xlPasteValues\n\n    ActiveWorkbook.SaveAs Filename:=File_name, FileFormat:=51\n\n    ActiveWorkbook.Close (False)\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534291113, "post_id": 51851200, "comment_id": 90655468, "body": "Why not just use the <code>.Find</code> function?"}, {"owner": {"reputation": 15, "user_id": 6732604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZUms.jpg?s=128&g=1", "display_name": "j man", "link": "https://stackoverflow.com/users/6732604/j-man"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534291342, "post_id": 51851200, "comment_id": 90655517, "body": "I&#39;m sorry. I am still new to VBA and haven&#39;t learned all the, I&#39;m assuming a method. Could you post an example and will it do the same thing as what I am wanting? Remember the information starts on page 4 and continues on different sheets.Thank you for the quick response."}, {"owner": {"reputation": 15, "user_id": 6732604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZUms.jpg?s=128&g=1", "display_name": "j man", "link": "https://stackoverflow.com/users/6732604/j-man"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534291533, "post_id": 51851200, "comment_id": 90655556, "body": "No, its a combobox"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534291937, "post_id": 51851200, "comment_id": 90655622, "body": "Is there some limit to the range that needs to be searched? Is it just Column B you need to look in?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534292708, "post_id": 51851200, "comment_id": 90655742, "body": "Your error line should be <code>ThisWorkbook.Sheets.Count</code>. However, you are just going to get an error on the next line. You are also not utilizing your <code>i</code> loop and you try to enter an <code>x</code> loop without any instruction. Right now, <code>x = 0</code> which will result in a invalid range / error."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534294951, "post_id": 51851200, "comment_id": 90656086, "body": "Were you by chance looking at <a href=\"https://support.microsoft.com/en-gb/help/142126/macro-to-loop-through-all-worksheets-in-a-workbook\" rel=\"nofollow noreferrer\">this Microsoft website</a>? Note that the original is actually <code>WS_Count = ActiveWorkbook.Worksheets.Count</code>, which would not throw a Type Mismatch error."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6732604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZUms.jpg?s=128&g=1", "display_name": "j man", "link": "https://stackoverflow.com/users/6732604/j-man"}, "edited": false, "score": 0, "creation_date": 1534320258, "post_id": 51851281, "comment_id": 90662378, "body": "But what if more sheets are added. Is there not away to program it to do this for me? i.e. For Each sheet in workbook(ChattemPackaging.xlsm) Find this.... Thank You."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1534296620, "last_edit_date": 1534296620, "creation_date": 1534291886, "answer_id": 51851281, "question_id": 51851200, "link": "https://stackoverflow.com/questions/51851200/loop-through-sheets-and-cells-to-find-value-and-runtime-error-13-type-mismatch/51851281#51851281", "title": "loop through sheets and cells to find value and runtime error 13 Type Mismatch", "body": "<p>You need to change <code>Sheet1</code>, <code>Sheet2</code>, &amp; <code>Sheet3</code> to the names of the sheets that you do not want this code to run on. </p>\n\n<p>It looks like you were trying to loop through <code>Column B</code> so the below code will check for your <code>ComboBox</code> value on all sheets - <em>with exception of 3 above</em> -from <code>B2</code> until last used cell in the column. </p>\n\n<p>Also, it looks like you were testing for your <code>ComboBox.Value &lt;&gt; \" \"</code> which is testing if the value is not equal to a space. Assuming you are looking for blanks, it should be '\"\"', which is what I updated the code to be. </p>\n\n<hr>\n\n<pre><code>Sub Find_Me()\n\nDim ws As Worksheet, i\n\nIf cmbPrdCde.Value &lt;&gt; \"\" Then\n    For Each ws In Worksheets  'Loop through Sheets\n        If ws.Name &lt;&gt; \"Sheet1\" And ws.Name &lt;&gt; \"Sheet2\" And ws.Name &lt;&gt; \"Sheet3\" Then\n            For i = 2 To ws.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Row   'Loop through Rows\n                If ws.Range(\"B\" &amp; i) = cmbPrdCde.Value Then\n                    ws.Range(\"B\" &amp; i).Interior.Color = vbRed\n                End If\n            Next i\n        End If\n    Next ws\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>You can boost run-time by toggling off screen updating before loop and re-enabling before ending the sub with: </p>\n\n<p><code>Application.ScreenUpdating = False</code> then <code>True</code> respectively</p>\n"}], "owner": {"reputation": 15, "user_id": 6732604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZUms.jpg?s=128&g=1", "display_name": "j man", "link": "https://stackoverflow.com/users/6732604/j-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594151380, "creation_date": 1534291002, "last_edit_date": 1594151380, "question_id": 51851200, "link": "https://stackoverflow.com/questions/51851200/loop-through-sheets-and-cells-to-find-value-and-runtime-error-13-type-mismatch", "title": "loop through sheets and cells to find value and runtime error 13 Type Mismatch", "body": "<p>What I would like to achieve is to write some code that will loop through all the sheets and rows of those sheets until it finds value of the combobox(cmbPrdcde.value) and for test purposes only, when found, color that cell Red.\nI found the code below on a Microsoft website. The code loops through all the worksheets.</p>\n\n<pre><code>Dim WS_Count As Integer\nDim i As Integer\n\nWS_Count = Workbooks(ActiveWorkbook).Worksheets.Count\n\n    For i = 1 To WS_Count\n        Code Here\n    Next i\n</code></pre>\n\n<p>I would like to incorporate the code below with it so it would look like the code below:</p>\n\n<pre><code>Dim WS_Count As Integer\nDim i As Integer\n\nIf cmbPrdCde.Value &lt;&gt; \" \" Then\n\nWS_Count = Workbooks(ActiveWorkbook).Worksheets.Count\n\n    For i = 4 To WS_count\n        If Cells(x, 2) = cmbPrdCde.Value Then\n           Cells(x, 2).Interior.ColorIndex = 3\n        End If\n    Next i\n\nEnd If\n</code></pre>\n\n<p>Sheet 4 starts where the information is held.\nHowever when I run the code I get a Run-time error'13' Type mismatch \nand WS_count = Workbooks(ActiveWorkbook).Worksheets.Count is highlighted in yellow.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1534289530, "post_id": 51850987, "comment_id": 90655200, "body": "INDIRECT only works with open workbooks."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1534290063, "post_id": 51850987, "comment_id": 90655296, "body": "@urdearboy <a href=\"https://superuser.com/questions/535871/indirect-gives-a-ref-error-for-reference-to-external-workbook-where-making-a-d\" title=\"indirect gives a ref error for reference to external workbook where making a d\">superuser.com/questions/535871/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 3, "creation_date": 1534290421, "post_id": 51850987, "comment_id": 90655365, "body": "@urdearboy close the target workbook and hit F9 to calculate.  It will turn to <code>@REF!</code>  I have Office 365 Excel and it still does it."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1534300159, "post_id": 51850987, "comment_id": 90657025, "body": "I&#39;m not sure if this will help -see <a href=\"https://stackoverflow.com/q/42799757/4539709\">stackoverflow.com/q/42799757/4539709</a>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1534326818, "post_id": 51850987, "comment_id": 90665261, "body": "@ross-leavitt: you may be able to use <a href=\"https://ccm.net/download/download-24205-morefunc-macro-add-in-for-excel\" rel=\"nofollow noreferrer\">MoreFunc XL Addin</a> which includes an <code>INDIRECT.EXT</code> function that works with closed workbooks..."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 10227181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9fcca9eec4f252ca9a5c92d9902816?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/10227181/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1534295883, "creation_date": 1534295883, "answer_id": 51851692, "question_id": 51850987, "link": "https://stackoverflow.com/questions/51850987/how-to-reference-a-cell-in-another-workbook-that-is-closed-using-indirect-funct/51851692#51851692", "title": "How to reference a cell in another workbook that is closed (using INDIRECT function)?", "body": "<p>Indirect references open workbooks which means you dont need the file reference. rewritten as = INDIRECT(\"'[\"&amp;A1&amp;\"]\" &amp; B3 &amp; \"'!$A$2\")</p>\n\n<p>That being said, you must have the data open so it is available for indirect to call on it. \nIf you're opening the file often or every time you open the workbook containing the INDIRECT function in question, I suggest making a simple batch file to open them both. </p>\n"}], "owner": {"reputation": 91, "user_id": 10146825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a00cc96e6b711f2f70964e75d619eba7?s=128&d=identicon&r=PG&f=1", "display_name": "Ross Leavitt", "link": "https://stackoverflow.com/users/10146825/ross-leavitt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2549, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1534295883, "creation_date": 1534289139, "last_edit_date": 1534293858, "question_id": 51850987, "link": "https://stackoverflow.com/questions/51850987/how-to-reference-a-cell-in-another-workbook-that-is-closed-using-indirect-funct", "title": "How to reference a cell in another workbook that is closed (using INDIRECT function)?", "body": "<p>I am trying to reference a cell in a closed workbook by using the indirect function. I have tried the following:</p>\n\n<pre><code>= INDIRECT(\"'C:\\Users\\Ross\\Desktop\\[\"&amp;A1&amp;\"]\" &amp; B3 &amp; \"'!$A$2\")\n</code></pre>\n\n<p>A1 is my file name, B3 is sheet name, A2 is cell reference. </p>\n\n<p>I tried for awhile to get it to work by using other stackoverflow questions but it keeps throwing a #ref error. </p>\n\n<p>I would like to use the indirect function but if VBA is required I'd love to see what you did to make it work.</p>\n\n<p>Any and all help is appreciated!</p>\n\n<p><img src=\"https://i.stack.imgur.com/q8DZG.png\" alt=\"A picture of my workbook that I am using is attached\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1534282474, "post_id": 51850016, "comment_id": 90653393, "body": "please reformat your question it is hardly readable"}, {"owner": {"reputation": 1, "user_id": 10226488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fae2ae6eb0fd49568245a34cea44fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Burroughs", "link": "https://stackoverflow.com/users/10226488/paul-burroughs"}, "reply_to_user": {"reputation": 19508, "user_id": 3731614, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/PAIKr.jpg?s=128&g=1", "display_name": "Reborn", "link": "https://stackoverflow.com/users/3731614/reborn"}, "edited": false, "score": 0, "creation_date": 1534437244, "post_id": 51850016, "comment_id": 90714789, "body": "Bump, still need help :)"}], "owner": {"reputation": 1, "user_id": 10226488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fae2ae6eb0fd49568245a34cea44fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Burroughs", "link": "https://stackoverflow.com/users/10226488/paul-burroughs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534282949, "creation_date": 1534282133, "last_edit_date": 1534282949, "question_id": 51850016, "link": "https://stackoverflow.com/questions/51850016/excel-vba-updating-sumproduct-and-other-selectors-when-in-solver-loop", "title": "Excel/VBA - Updating SUMPRODUCT (and other) selectors when in Solver Loop", "body": "<p>I am writing a program in Excel that tries to maximize the sum of set of values, constrained by keeping a variable X (whose values are tied to each value being summed), under a specific threshold value.  It has to do this over 66 datasets (across 66 columns).</p>\n\n<p>I don't quite understand how to apply column offset to the <code>SUMPRODUCT</code> I see in the VBA prompt or the Solver selection.  Basically, I need to understand how to code in VBA to offset the selection within the <code>SUMPRODUCT</code> by one row to the right with each iteration <a href=\"https://i.stack.imgur.com/WseQq.png\" rel=\"nofollow noreferrer\">Explanatory pic of what I need VBA to do each iteration</a>.  I also have a similar problem iterating the Solver selection cells to the right, I don't quite understand the syntax needed.  Ex: SolverAdd <code>CellRef:=\"$C$28:$C$38\"</code>, whereby the next iteration would be interpreted as <code>SolverAdd CellRed:=\"$D$28:$D$28\"</code>, and so on.</p>\n\n<p>My code so far looks like this!  I know I'll need to add in the iteration using 'i' to the lines containing <code>SUMPRODUCT</code>, but I'm having trouble interpreting what everything within the <code>SUMPRODUCT</code> brackets refers to, and where to add in the \"horizontal by one\" offset.</p>\n\n<p>Let me know if I forgot to include anything obvious here :)</p>\n\n<p>Thanks in advance,</p>\n\n<p>Paul</p>\n\n<pre><code>For i = 0 To 66 ' PesticideMacro Macro '\n\n    SolverReset\n\n    Range(\"N5\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=SUMPRODUCT(RC[-4]:R[10]C[-4],R[23]C[-11]:R[33]C[-11])\"\n    Range(\"O5\").Select\n    ActiveCell.FormulaR1C1 = _\n       \"=SUMPRODUCT(R[41]C[-12]:R[51]C[-12],R[23]C[-12]:R[33]C[-12])/SUMPRODUCT(RC[-5]:R[10]C[-5],R[23]C[-12]:R[33]C[-12])*1000000\"\n    Range(\"C27\").Offset(0, i).Select\n    Selection.Copy\n    Range(\"P5\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    SolverAdd CellRef:=\"$C$28:$C$38\", Relation:=5\n    SolverAdd CellRef:=\"$O$5\", Relation:=1, FormulaText:=\"$P$5\"\n    SolverOk SetCell:=\"$N$5\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$C$28:$C$38\", _\n     Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverSolve (True)\n    SolverSolve userFinish:=True\n    SolverFinish KeepFinal:=1\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1909, "user_id": 2225619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/286a6578091bb7b170a254eb8b5c100d?s=128&d=identicon&r=PG", "display_name": "Capricorn", "link": "https://stackoverflow.com/users/2225619/capricorn"}, "edited": false, "score": 2, "creation_date": 1534282322, "post_id": 51849991, "comment_id": 90653350, "body": "Hi, welcome to SO. Please read <a href=\"https://meta.stackoverflow.com/a/284237/2225619\">Why is \u201cCan someone help me?\u201d not an actual question?</a> and the guide on asking questions: <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534282696, "post_id": 51849991, "comment_id": 90653458, "body": "<i>Where</i> does the error occur?"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1534283725, "post_id": 51849991, "comment_id": 90653766, "body": "<code>Option Explicit</code> and why use <code>&amp;H1F</code> instead of something more descriptive or a vba constant?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534283935, "post_id": 51849991, "comment_id": 90653831, "body": "Comment out your error handlers or make them more selective, and you might find you&#39;re getting errors you didn&#39;t expect.  you should also consider breaking this up into separate methods - eg create a function to return a list/collection of matching files, given a starting folder.  Your locig will then be easier to follow/debug."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534286944, "post_id": 51849991, "comment_id": 90654642, "body": "Comment out your error handlers or make them more selective, and you might find you&#39;re getting errors you didn&#39;t expect. You might also consider breaking this up into separate methods - eg create a function to return a list/collection of matching files, given a starting folder. Your logic will then be easier to follow/debug."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1534297594, "post_id": 51849991, "comment_id": 90656554, "body": "See <a href=\"https://stackoverflow.com/questions/14407061/wheres-the-debug-button-in-excel-vba-error\">Where&#39;s the debug button</a>"}], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 10117882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b0785e48cf991cbdce327c31018405?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom Lord", "link": "https://stackoverflow.com/users/10117882/phantom-lord"}, "is_accepted": false, "score": -1, "last_activity_date": 1534291370, "creation_date": 1534291370, "answer_id": 51851232, "question_id": 51849991, "link": "https://stackoverflow.com/questions/51849991/subscript-out-of-range-error-without-debug-option/51851232#51851232", "title": "Subscript out of range error without debug option", "body": "<p>you can debug on your own without the debugger of the IDE.\nSimply put <code>On Error Resume Next</code>/<code>On Error Goto 0</code> very close to each other in order to restrict the statements which can raise errors. ie the second <code>On Error Goto 0</code> is too far.</p>\n\n<p>I can debug more effectively simply putting between statements something like that: </p>\n\n<pre><code>a = a + 1\ndebug.print \"I am here\"\nb = b -5\ndebug.print \"I am there\"\nc = 5 / 0\ndebug.print \"You can't see me\"\n</code></pre>\n\n<p>So you can find when the error is raised</p>\n"}], "owner": {"reputation": 1, "user_id": 10226718, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F4DycSYuiu8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o8iN3ImAY-OH0q1h0TyLvKuwHvjw/mo/photo.jpg?sz=128", "display_name": "Tommy", "link": "https://stackoverflow.com/users/10226718/tommy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 421, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1568953654, "creation_date": 1534282010, "last_edit_date": 1568953654, "question_id": 51849991, "link": "https://stackoverflow.com/questions/51849991/subscript-out-of-range-error-without-debug-option", "title": "Subscript out of range error without debug option", "body": "<p>I get this error:</p>\n\n<blockquote>\n  <p>subscript out of range.</p>\n</blockquote>\n\n<p>I do not have the debug option, only OK and HELP.</p>\n\n<p>One time on 20 the macro works. The rest of time I'm getting this error.</p>\n\n<p>The code makes you choose the path you want to search and next the text you want to find in the workbook in the path chosen. It searches in sub folders too. After that it sends back the file name, sheet name, which cell and what text is in the cell.</p>\n\n<p>The macro runs but pops that error after searching 4 to 5 different files.</p>\n\n<pre><code>Dim AppObject As New Class1\nPublic WS As Worksheet\nSub SearchWKBooksSubFolders(Optional Folderpath As Variant, Optional Str As Variant)\nDim myfolder As String\nDim a As Single\nDim sht As Worksheet\nDim Lrow As Single\nDim Folders() As String\nDim Folder As Variant\nReDim Folders(0)\nDim wbk As Workbook\n\nIf IsMissing(Folderpath) Then\n    Set WS = Sheets.Add\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Show\n        myfolder = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n    Str = Application.InputBox(prompt:=\"Nom de la Personne:\", Title:=\"Personne a chercher\", Type:=2)\n\n    If Str = \"\" Then Exit Sub\n\n    WS.Range(\"A1\") = \"Semaine\"\n    WS.Range(\"B1\") = \"Journ\u00e9e\"\n    WS.Range(\"C1\") = \"Cellule\"\n    WS.Range(\"D1\") = \"Nom\"\n\n    Folderpath = myfolder\n\n    Value = Dir(myfolder, &amp;H1F)\nElse\n    If Right(Folderpath, 2) = \"\\\\\" Then\n        Exit Sub\n    End If\n    Value = Dir(Folderpath, &amp;H1F)\nEnd If\n\nDo Until Value = \"\"\n    If Value = \".\" Or Value = \"..\" Then\n    Else\n        If GetAttr(Folderpath &amp; Value) = 16 Then\n            Folders(UBound(Folders)) = Value\n            ReDim Preserve Folders(UBound(Folders) + 1)\n\n        ElseIf Right(Value, 3) = \"xls\" Or Right(Value, 4) = \"xlsx\" Or Right(Value, 4) = \"xlsm\" Then\n            On Error Resume Next\n            Workbooks.Open Filename:=Folderpath &amp; Value, Password:=\"zzzzzzzzzzzz\"\n            If Err.Number &lt;&gt; 0 Then\n                WS.Range(\"A4\").Offset(a, 0).Value = Value\n                WS.Range(\"B4\").Offset(a, 0).Value = \"Password protected\"\n                a = a + 1\n                On Error GoTo 0\n            Else\n                For Each sht In ActiveWorkbook.Worksheets\n                    'Expand all groups in sheet\n                    sht.Outline.ShowLevels RowLevels:=8, ColumnLevels:=8\n                    Set c = sht.Cells.Find(Str)\n                    If Not c Is Nothing Then\n                        firstAddress = c.Address\n                        Do\n                            Lrow = WS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n                            WS.Range(\"A1\").Offset(Lrow, 0).Value = Value\n                            WS.Range(\"B1\").Offset(Lrow, 0).Value = sht.Name\n                            WS.Range(\"C1\").Offset(Lrow, 0).Value = c.Address\n                            WS.Range(\"D1\").Offset(Lrow, 0).Value = c.Value\n                            Set c = sht.Cells.FindNext(c)\n                        Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n                    End If\n                Next sht\n            End If\n            Workbooks(Value).Close False\n            On Error GoTo 0\n        End If\n    End If\n    Value = Dir\nLoop\nFor Each Folder In Folders\n    SearchWKBooksSubFolders (Folderpath &amp; Folder &amp; \"\\\")\nNext Folder\nCells.EntireColumn.AutoFit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "frequency"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534283199, "post_id": 51849983, "comment_id": 90653606, "body": "Hungry and intrigued"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534283240, "post_id": 51849983, "comment_id": 90653626, "body": "Now this is a fun little problem"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534283302, "post_id": 51849983, "comment_id": 90653639, "body": "@urdearboy I\u2019ll go get some cheese if you bring apples"}, {"owner": {"reputation": 65, "user_id": 3088527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/350da97299aaec9f39dc3981d64d3426?s=128&d=identicon&r=PG&f=1", "display_name": "user3088527", "link": "https://stackoverflow.com/users/3088527/user3088527"}, "edited": false, "score": 0, "creation_date": 1534284082, "post_id": 51849983, "comment_id": 90653873, "body": "I wish I could treat you all to drinks and snacks just for taking a look and trying to help in solving this... it&#39;s driving me nuts."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1534284193, "post_id": 51849983, "comment_id": 90653907, "body": "@user3088527 this is a big ask.  And usually, questions without code and specific error resulting from that code get closed and down voted.  Do you have any code you have tried?  If so could you post it in your original post using <a href=\"https://stackoverflow.com/posts/51849983/edit\">edit</a>?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1534284335, "post_id": 51849983, "comment_id": 90653949, "body": "I kind of hope it doesn&#39;t get closed, I want to take a stab at it although my solution will probably be bloated"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1534284573, "post_id": 51849983, "comment_id": 90654018, "body": "@Marcucciboy2 it is late in the afternoon in the U.S. so site traffic is down at the moment so you probably will have time.  I would approach it by creating a dictionary of all the unique products.  Then double loop through that to get the unique combos.  then I would use countifs to return the counts.  but that is just me."}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 4, "creation_date": 1534284882, "post_id": 51849983, "comment_id": 90654123, "body": "possible duplicate: <a href=\"https://stackoverflow.com/questions/18817714/finding-combinations-and-counting-them-in-excel\" title=\"finding combinations and counting them in excel\">stackoverflow.com/questions/18817714/&hellip;</a>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1534285251, "post_id": 51849983, "comment_id": 90654246, "body": "@ArnovanBoven whelp, thats disappointing lol. and it&#39;s even dead simple"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1534285331, "post_id": 51849983, "comment_id": 90654269, "body": "with the link just change the formula for combination column to: <code>=IF(B2&gt;A2,A2,B2) &amp; &quot; and &quot; &amp; IF(B2&gt;A2,B2,A2)</code> this will match regardless of order."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1534285667, "post_id": 51849983, "comment_id": 90654347, "body": "I think you owe @ArnovanBoven some cheese"}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1534285682, "post_id": 51849983, "comment_id": 90654349, "body": "It is dead simple once you reach advanced Excel skills like array formulas. I never got to that level of wizardry :)"}, {"owner": {"reputation": 65, "user_id": 3088527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/350da97299aaec9f39dc3981d64d3426?s=128&d=identicon&r=PG&f=1", "display_name": "user3088527", "link": "https://stackoverflow.com/users/3088527/user3088527"}, "edited": false, "score": 1, "creation_date": 1534293016, "post_id": 51849983, "comment_id": 90655791, "body": "Thanks everyone! You&#39;re all amazing.  Sorry for not providing attempted code, I really wasn&#39;t sure where to start.  Although admittedly I had thought of the PivotTable solution after I posted this.  But I prefer the Array solution and it gets my toes wet in the world of Arrays, which is a plus!"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "reply_to_user": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1534364933, "post_id": 51849983, "comment_id": 90684131, "body": "@ArnovanBoven I could be mistaken, but I don&#39;t think pivot tables would group &quot;Apples and Oranges&quot; with &quot;Oranges and Apples&quot;.  The first step in the answer you linked is to create the groups by concatenating two values together."}, {"owner": {"reputation": 65, "user_id": 3088527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/350da97299aaec9f39dc3981d64d3426?s=128&d=identicon&r=PG&f=1", "display_name": "user3088527", "link": "https://stackoverflow.com/users/3088527/user3088527"}, "reply_to_user": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 2, "creation_date": 1534365109, "post_id": 51849983, "comment_id": 90684195, "body": "@JosephC it works with the modification provided by Scott Craner by alphabetizing in the formula in the combination column"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1534365791, "post_id": 51849983, "comment_id": 90684444, "body": "Ahh yup, that would do it.  :)"}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "reply_to_user": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1534365798, "post_id": 51849983, "comment_id": 90684446, "body": "@JosephC that may well be, all I did was provide the possible duplicate link as the q was the same (and tested the array formula part just for fun)"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "reply_to_user": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1534366058, "post_id": 51849983, "comment_id": 90684575, "body": "@ArnovanBoven Good stuff.  :)"}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1534340538, "post_id": 51852069, "comment_id": 90671941, "body": "It might be a bit cleaner if you store A and B into separate variables but alphabetically. As in the first variable is always the \u201cfirst\u201d alphabetically so that you don\u2019t have to check multiple times"}], "tags": [], "owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "is_accepted": false, "score": 2, "last_activity_date": 1534366339, "last_edit_date": 1592644375, "creation_date": 1534299464, "answer_id": 51852069, "question_id": 51849983, "link": "https://stackoverflow.com/questions/51849983/frequency-of-occurence-for-every-possible-combination-of-values-in-two-columns-o/51852069#51852069", "title": "Frequency of occurence for every possible combination of values in two columns on the same row", "body": "<p>Just in case some poor soul will need this in VBA:</p>\n<pre><code>Option Explicit\nSub ComboOccurences()\n\n    ' Remember to check Microsoft Scripting Runtime in References!\n    Dim dict As Scripting.Dictionary\n    Dim i As Integer, r As Integer, LastRow As Integer\n    Dim ColAB As String, ColBA As String\n\n    Set dict = New Scripting.Dictionary\n    LastRow = Sheets(&quot;Sheet1&quot;).Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row\n\n    For i = 2 To LastRow\n        ColAB = Range(&quot;A&quot; &amp; i).Value &amp; &quot; and &quot; &amp; Range(&quot;B&quot; &amp; i).Value\n        ColBA = Range(&quot;B&quot; &amp; i).Value &amp; &quot; and &quot; &amp; Range(&quot;A&quot; &amp; i).Value\n        If Not dict.Exists(ColAB) And Not dict.Exists(ColBA) Then\n            dict.Add (ColAB), 1\n        ElseIf dict.Exists(ColAB) Then\n            dict(ColAB) = dict(ColAB) + 1\n        ElseIf dict.Exists(ColBA) Then\n            dict(ColBA) = dict(ColBA) + 1\n        End If\n    Next\n\n    r = 2\n    For i = 0 To dict.Count - 1\n        Range(&quot;D&quot; &amp; r).Value = dict.Keys(i)\n        Range(&quot;E&quot; &amp; r).Value = dict.Items(i)\n        r = r + 1\n    Next\n\nEnd Sub\n</code></pre>\n<p>Result:</p>\n<p><a href=\"https://i.stack.imgur.com/btOJB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/btOJB.jpg\" alt=\"Final Result\" /></a></p>\n<p>Hope this will help somebody!</p>\n"}, {"tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": false, "score": 2, "last_activity_date": 1534354106, "creation_date": 1534354106, "answer_id": 51863575, "question_id": 51849983, "link": "https://stackoverflow.com/questions/51849983/frequency-of-occurence-for-every-possible-combination-of-values-in-two-columns-o/51863575#51863575", "title": "Frequency of occurence for every possible combination of values in two columns on the same row", "body": "<p>Late to the party but your question seemed like a fun exercise.  For kicks I decided to add an extra layer of complexity by writing it to use any size range &amp; outputting the results to a specified range (or sheet).</p>\n\n<p><a href=\"https://i.stack.imgur.com/Yx6SL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yx6SL.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Test()\n    Call CountUniqueCombinations(Range(\"A2:D7\"), Range(\"F2\"))\nEnd Sub\n\nPrivate Sub CountUniqueCombinations(ByVal SourceRange As Range, ByVal DestinationRange As Range)\n    Dim oRowIndex As Long\n    Dim oColIndex As Long\n    Dim oRow As New Collection\n\n    For oRowIndex = 0 To SourceRange.Rows.Count - 1\n        oValue = \"\"\n        Set oRow = Nothing\n\n        ' Sort Current Row (Output to String)\n        For oColIndex = 1 To SourceRange.Columns.Count\n            oRow.Add SourceRange(oRowIndex + 1, oColIndex).Value\n        Next\n        oValue = SortCollection(oRow)\n\n        ' See if Sorted row already Exists if so +1\n        Dim oDestRowIndex As Long\n        Dim oFound As Boolean\n        oFound = False\n        For oDestRowIndex = 1 To DestinationRange.Rows.Count\n            If DestinationRange(oDestRowIndex, 1).Value = oValue Then\n                DestinationRange(oDestRowIndex, 2).Value = CInt(DestinationRange(oDestRowIndex, 2).Value) + 1\n                oFound = True\n                Exit For\n            End If\n        Next\n\n        ' if Sorted row doesn't exist add it\n        If Not oFound Then\n            DestinationRange(DestinationRange.Rows.Count, 1) = oValue\n            DestinationRange(DestinationRange.Rows.Count, 1).Offset(0, 1) = 1\n            Set DestinationRange = DestinationRange.Resize(DestinationRange.Rows.Count + 1, 1)\n        End If\n\n    Next\n\nEnd Sub\n\nPrivate Function SortCollection(ByVal oCollection As Collection) As String\n    Dim oX As Long, oY As Long\n    Dim oTempValue As String\n\n    For oX = 1 To oCollection.Count - 1\n        For oY = oX + 1 To oCollection.Count\n            If oCollection(oX) &gt; oCollection(oY) Then\n                oTempValue = oCollection(oY)\n                oCollection.Remove (oY)\n                oCollection.Add oTempValue, oTempValue, oX\n            End If\n        Next\n    Next\n\n    For oX = 1 To oCollection.Count\n        If oCollection.Item(oX) &lt;&gt; \"\" Then\n            SortCollection = SortCollection &amp; oCollection.Item(oX) &amp; \" &amp; \"\n        End If\n    Next\n\n    SortCollection = Left(SortCollection, Len(SortCollection) - 3)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 3088527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/350da97299aaec9f39dc3981d64d3426?s=128&d=identicon&r=PG&f=1", "display_name": "user3088527", "link": "https://stackoverflow.com/users/3088527/user3088527"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534366339, "creation_date": 1534281970, "last_edit_date": 1534312783, "question_id": 51849983, "link": "https://stackoverflow.com/questions/51849983/frequency-of-occurence-for-every-possible-combination-of-values-in-two-columns-o", "title": "Frequency of occurence for every possible combination of values in two columns on the same row", "body": "<p>I have a data-set with Product 1 in Column A and Product 2 in Column B.</p>\n\n<p>I would like to build a new table which counts the number of rows on which every possible combination of Product 1 and Product 2 occur. (Preferably regardless of the order in which they occur, but I can clean that up after if needed)</p>\n\n<p>I can build this manually, however I am dealing with hundreds of possible combinations and would like to automate the process with a macro or any other recommendations anyone has.</p>\n\n<p>Example of raw data:</p>\n\n<pre><code>Product 1   Product 2\nCheese          Apple\nCrackers    Sausage\nCheese          Sausage\nCrackers    Sausage\nApple           Crackers\nApple           Cheese\nCheese          Apple\nCherry          Apple\n</code></pre>\n\n<p>Example of new summarized table:</p>\n\n<pre><code>Combo               | Count of Combo Occurrences\nCheese and Apple    | 3\nCheese and Sausage  | 1\nCherry and Apple    | 1\nCrackers and Sausage| 2\nApple and Crackers  | 1\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1534284261, "post_id": 51849859, "comment_id": 90653925, "body": "Exchange account?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10226712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a6290c51ede92563a36b769f3ed8a1?s=128&d=identicon&r=PG&f=1", "display_name": "Larcen60", "link": "https://stackoverflow.com/users/10226712/larcen60"}, "edited": false, "score": 0, "creation_date": 1534283303, "post_id": 51850131, "comment_id": 90653640, "body": "I ordinarily do have a semicolon in the code and it cc&#39;s my personal box.  However,  it doesn&#39;t cc the shared mailbox as well.  I might not have been specific enough originally, but I&#39;m working in a shared mailbox.  So I&#39;m looking to have it CC &quot;Shared mailbox 1&quot; and &quot;personal mailbox&quot;.  Thanks for the help!"}], "tags": [], "owner": {"reputation": 519, "user_id": 1598814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72de01a7db2e106f25aca111c4f1dc66?s=128&d=identicon&r=PG", "display_name": "user1598814", "link": "https://stackoverflow.com/users/1598814/user1598814"}, "is_accepted": false, "score": 0, "last_activity_date": 1534282740, "creation_date": 1534282740, "answer_id": 51850131, "question_id": 51849859, "link": "https://stackoverflow.com/questions/51849859/vba-macro-in-outlook-to-cc-a-specific-mailbox/51850131#51850131", "title": "VBA Macro in Outlook to CC a specific mailbox", "body": "<p>Just add the \";\" symbol</p>\n\n<p>Assume your email is : \"your@email.com\"</p>\n\n<p>So your code after small change will look like this : </p>\n\n<pre><code>Public Sub SendAll()\nDim mail As Outlook.MailItem\nSet mail = Application.ActiveInspector.CurrentItem\nmail.CC = mail.CC &amp; \";your@email.com\"\nmail.Send\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 10226712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a6290c51ede92563a36b769f3ed8a1?s=128&d=identicon&r=PG&f=1", "display_name": "Larcen60", "link": "https://stackoverflow.com/users/10226712/larcen60"}, "edited": false, "score": 0, "creation_date": 1534286414, "post_id": 51850514, "comment_id": 90654522, "body": "It is an exchange account.   However, when I use the code you provided it CC&#39;s my personal mailbox.  That could be because even though the sent field says &quot;shared mailbox&quot; when I mouse over the shared mailbox address, it says &quot;send using <i>personal account</i>&quot; so it is likely recognizing that as the primary user."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1534285225, "creation_date": 1534285225, "answer_id": 51850514, "question_id": 51849859, "link": "https://stackoverflow.com/questions/51849859/vba-macro-in-outlook-to-cc-a-specific-mailbox/51850514#51850514", "title": "VBA Macro in Outlook to CC a specific mailbox", "body": "<p><em>Try this</em></p>\n\n<p><strong><em>Exchange account</em></strong></p>\n\n<pre><code>Mail.CC = Application.Session.CurrentUser.AddressEntry.GetExchangeUser().PrimarySmtpAddress\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1727575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3017491fce69372eeb0ff3d093429dd0?s=128&d=identicon&r=PG", "display_name": "Kairu", "link": "https://stackoverflow.com/users/1727575/kairu"}, "is_accepted": false, "score": 0, "last_activity_date": 1534467739, "creation_date": 1534467739, "answer_id": 51887115, "question_id": 51849859, "link": "https://stackoverflow.com/questions/51849859/vba-macro-in-outlook-to-cc-a-specific-mailbox/51887115#51887115", "title": "VBA Macro in Outlook to CC a specific mailbox", "body": "<p>I am assuming you're sending the email with the sender address being the shared mailbox you're working from</p>\n\n<pre><code>Public Sub SendAll()\nDim mail As Outlook.MailItem\nSet mail = Application.ActiveInspector.CurrentItem\nmail.CC = mail.Sender &amp; \";your@email.com\"\nmail.Send\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10226712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a6290c51ede92563a36b769f3ed8a1?s=128&d=identicon&r=PG&f=1", "display_name": "Larcen60", "link": "https://stackoverflow.com/users/10226712/larcen60"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1592947126, "creation_date": 1534281320, "last_edit_date": 1592947126, "question_id": 51849859, "link": "https://stackoverflow.com/questions/51849859/vba-macro-in-outlook-to-cc-a-specific-mailbox", "title": "VBA Macro in Outlook to CC a specific mailbox", "body": "<p>I currently work in multiple mailboxes throughout the day, and I was looking to create a macro to send a CC to my personal box and also to the mailbox I was working in at the time.  </p>\n\n<p>I was able to make a macro to send a CC to my personal box, but I'm stumped as to how I would get it to CC the box I was working in at the time.  </p>\n\n<p>Below is the code I currently have for my macro, does anyone have any ideas how I could alter it to also CC the box I was currently working in as well?</p>\n\n<pre><code>Public Sub SendAll()\nDim mail As Outlook.MailItem\nSet mail = Application.ActiveInspector.CurrentItem\nmail.CC = mail.CC &amp; \"*Personal E-mail here*\"\nmail.Send\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1534280358, "post_id": 51849603, "comment_id": 90652597, "body": "look at using ADO and <code>www.connectionstrings.com</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1534337714, "post_id": 51849603, "comment_id": 90670299, "body": "That code for worked for me in Excel 2010 with my &quot;access database path&quot; and &quot;query name&quot;.  Please show us the SQL from your &quot;query name&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 4562, "user_id": 140187, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c625e8cc951231fc15116b3214fe24e?s=128&d=identicon&r=PG", "display_name": "The King", "link": "https://stackoverflow.com/users/140187/the-king"}, "is_accepted": false, "score": 1, "last_activity_date": 1534281376, "creation_date": 1534281376, "answer_id": 51849868, "question_id": 51849603, "link": "https://stackoverflow.com/questions/51849603/how-to-run-access-query-using-excel-vba/51849868#51849868", "title": "How to run access query using excel VBA?", "body": "<p>I would use ADODB recordset.  Try the below code.  Here I'm connecting to an excel workbook, but you can use the same logic for access database, you just need to change the connection string.</p>\n\n<pre><code>Private con As ADODB.Connection\nPrivate ra As ADODB.Recordset\n\n\n\n' SqlString = SQL Query\n' Sht = Sheet Name, where the output needs to be displayed\n' Rng = Range (\"C5\"), where the output needs to be displayed\n\nSub DoSql(SqlString As String, Sht As String, Rng As String, Optional IncludeHeading As Boolean = False)\n\nDim a As String\n\nDim res As Variant\n\nSet con = New ADODB.Connection\nSet ra = New ADODB.Recordset\n\nres = \"\"\n\n'a = Set the appropriate connection string for your database\n'The below connection is referring to the same excel workbook which contains the macro\n\n\na = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"\"\" &amp; ThisWorkbook.FullName &amp; \"\"\";Extended Properties=\"\"Excel 12.0 Xml;HDR=YES\"\";\"\n\n'MsgBox a\n'MsgBox SqlString\n\nIf Not Left(\"\" &amp; con, 8) = \"Provider\" Then\n    con.Open a\nEnd If\n\nIf Not ra.State = 0 Then\n    ra.Close\nEnd If\n\nra.Open SqlString, con\n\nIf Not (ra.EOF And ra.BOF) Then\n    ra.MoveFirst\n\n    Sheets(Sht).Select\n\n    If IncludeHeading = True Then\n        For intColIndex = 0 To ra.Fields.Count - 1\n            Range(Rng).Offset(0, intColIndex).Value = ra.Fields(intColIndex).Name\n        Next\n        Range(Rng).Offset(1, 0).CopyFromRecordset ra\n    Else\n        Range(Rng).CopyFromRecordset ra\n    End If\n\nEnd If\nra.Close\ncon.Close\n\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1534357147, "post_id": 51859610, "comment_id": 90680685, "body": "I am getting an issue with &quot;Set rs = dbe.OpenDatabase(cstrPath).OpenRecordset(cstrQuery)&quot;. Same run time error as stated in the question. The name of my query is &quot;Perf Sales&quot; and works fine when I run the query manually."}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1534884357, "post_id": 51859610, "comment_id": 90863508, "body": "Hey, sorry for the late response. I got a little busy. I tried another access file and it worked perfectly. Not entirely sure what was wrong with the database but your code worked :)"}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1535597888, "post_id": 51859610, "comment_id": 91127451, "body": "Hey, I just realized that this does not pull the headers of the table. Why would it be doing this?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1535652788, "post_id": 51859610, "comment_id": 91157058, "body": "<code>CopyFromRecordset</code> never imports the headers.  You must separately loop thru the recordset&#39;s <code>Fields</code> collection and write the name of each to your sheet.  Examples abound: <a href=\"https://www.google.com/search?q=copyfromrecordset+with+headers\" rel=\"nofollow noreferrer\">copyfromrecordset with headers</a>"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1534339527, "creation_date": 1534339527, "answer_id": 51859610, "question_id": 51849603, "link": "https://stackoverflow.com/questions/51849603/how-to-run-access-query-using-excel-vba/51859610#51859610", "title": "How to run access query using excel VBA?", "body": "<p>I adapted your code to fetch data from an Access query without needing to create a full <code>Access.Application</code> instance.  Tested and working in Excel 2010.</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Const cstrPath As String = \"C:\\share\\Access\\Database2.accdb\"\nConst cstrQuery As String = \"qryBase\"\nDim dbe As Object 'DAO.DBEngine '\nDim rs As Object 'DAO.Recordset '\nDim ws As Worksheet\n\nApplication.DisplayAlerts = True 'leave alerts on during testing '\nSet dbe = CreateObject(\"DAO.DBEngine.120\")\nSet rs = dbe.OpenDatabase(cstrPath).OpenRecordset(cstrQuery)\n\nIf Not rs.EOF Then\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    ws.Range(\"A1\").CopyFromRecordset rs\nEnd If\n\nrs.Close\nApplication.DisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4155, "favorite_count": 0, "accepted_answer_id": 51859610, "answer_count": 2, "score": 1, "last_activity_date": 1534339527, "creation_date": 1534279905, "last_edit_date": 1534318721, "question_id": 51849603, "link": "https://stackoverflow.com/questions/51849603/how-to-run-access-query-using-excel-vba", "title": "How to run access query using excel VBA?", "body": "<p>I am fairly new to Access and I have been trying for a while to run an Access query and paste the results in Excel using VBA. I have combined some code I found and I think I almost have it but cannot figure out the last step. Here is the code:</p>\n\n<pre><code>Sub test()\n\n\nDim ws As Worksheet\nDim A As Object\nDim rs As Object\n\nApplication.DisplayAlerts = False\n\nSet A = CreateObject(\"Access.Application\")\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\n\nA.Visible = True\nA.OpenCurrentDatabase (\"access database path\")\nA.DoCmd.OpenQuery (\"query name\")\n\nSet rs = A.CurrentDb().QueryDefs(\"query name\").OpenRecordset()\n\nIf Not rs.EOF Then\n    ws.Range(\"A1\").CopyFromRecordset rs\nEnd If\n\nrs.Close\n\n Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>I am trying to run the query and paste the results in cell A1 in sheet 1. </p>\n\n<p>I get a \"run time error 3219\" for the line:</p>\n\n<pre><code>Set rs = A.CurrentDb().QueryDefs(\"query name\").OpenRecordset()\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>G</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 5548, "user_id": 4625526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6378aa788195a771461c5043057e2ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert van Nobelen", "link": "https://stackoverflow.com/users/4625526/norbert-van-nobelen"}, "edited": false, "score": 3, "creation_date": 1534277730, "post_id": 51849081, "comment_id": 90651503, "body": "Cascading inserts do not exist (unlike cascading deletes). You will have to write all the steps in code to manage the IDs. A handy way sometimes is to use a stored procedure so that from you program it is a single call and easily managed transaction"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1534279498, "post_id": 51849081, "comment_id": 90652238, "body": "If your &quot;child&quot; tables all have identical (?) structure, something might be wrong with the modelization. If you ever need similar data for <code>Sociology</code>, do you need to create a new <i>record</i> somewhere, or a whole new <i>table</i>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1534279680, "post_id": 51849081, "comment_id": 90652302, "body": "That said, something like &quot;cascading inserts&quot; <i>can</i> be achieved with <i>triggers</i>, but I don&#39;t think Access supports that... but triggers are generally regarded as sloppy anyway."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1534281841, "creation_date": 1534281841, "answer_id": 51849960, "question_id": 51849081, "link": "https://stackoverflow.com/questions/51849081/how-to-have-cascading-inserts/51849960#51849960", "title": "How to have cascading inserts?", "body": "<p>You use Child tables (and subforms for their presentation), when you have 0..many records that are linked to a master record.</p>\n\n<p>E.g. a student has read n books, or has visited m math courses with m grades.<br>\nThen you insert the child records when there is data, not in every table at once.</p>\n\n<p>If you only want to store <strong>one</strong> favorite book or <strong>one</strong> math level per student, these should be <strong>columns</strong> in your students table. Not separate tables.</p>\n\n<p>If you want to show the favorite of many books (by whatever metric), or the highest math grade, then these are <strong>query results</strong> from the child tables.</p>\n\n<p>In neither of these cases do you need to insert one record into each of the child tables at once.</p>\n\n<hr>\n\n<p>Now if your actual data is much more complex, and there is actual need for a one-to-one relation of master and child table(s), then you must create all these records at once in one function or stored procedure, using multiple insert statements.</p>\n\n<p>But these cases are rare.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9145305"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534281841, "creation_date": 1534277482, "question_id": 51849081, "link": "https://stackoverflow.com/questions/51849081/how-to-have-cascading-inserts", "title": "How to have cascading inserts?", "body": "<p>I hope my request is clear. I will try and be as informative as possible.</p>\n\n<p>I have a form that has a Tabular Form Control</p>\n\n<p>The Parent Form holds Student data. The Record Source is</p>\n\n<pre><code>SELECT * FROM Students WHERE Period = 1\n</code></pre>\n\n<p>This Parent Form holds a Tabular Form Control. The Tabular Form has 3 pages:</p>\n\n<pre><code>Reading Writing Math\n</code></pre>\n\n<p>With each of these pages (Reading, Writing, Math), I want to have a Subform. </p>\n\n<p>So, the data for the Parent form pulls Student data and it looks like this:</p>\n\n<pre><code>Student ID \nName\n</code></pre>\n\n<p>What I want the Subforms to look like is this. For Reading:</p>\n\n<pre><code>Student ID\nFavorite Book\n</code></pre>\n\n<p>Writing</p>\n\n<pre><code>Student ID\nWords Per Minute\n</code></pre>\n\n<p>Math</p>\n\n<pre><code>Student ID\nHighest Level\n</code></pre>\n\n<p>I would like for the Student ID to be automatically populated. So the Student Form will look like</p>\n\n<pre><code> Student ID    Name\n    1          'Mark'\n</code></pre>\n\n<p>And the Reading Form will look like</p>\n\n<pre><code>Student ID     Favorite Book\n    1             Harry Potter\n</code></pre>\n\n<p>I have a Reading table, a Writing one, and a Math table as well. So I would like for these values to populate each table. </p>\n\n<p>I hope this makes sense. I have a relationship between the Student ID from the Student table and the three tables. </p>\n\n<p>In summary, I would like for a child Subform that is hosted in a Tabular Form to access a column from the Root level and bind that column to the child. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 3232047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d43193065e9047a4511b35525050daa?s=128&d=identicon&r=PG&f=1", "display_name": "user3232047", "link": "https://stackoverflow.com/users/3232047/user3232047"}, "edited": false, "score": 0, "creation_date": 1534277044, "post_id": 51848716, "comment_id": 90651223, "body": "I opened and closed Excel and now this code works."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1534277062, "post_id": 51848716, "comment_id": 90651235, "body": "glad i could help    (/s)"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1534277564, "creation_date": 1534277564, "answer_id": 51849096, "question_id": 51848716, "link": "https://stackoverflow.com/questions/51848716/private-sub-worksheet-changebyval-target-as-range-not-working/51849096#51849096", "title": "Private Sub Worksheet_Change(ByVal Target As Range) not working", "body": "<p>Your code works, but if you already using the <code>Target</code>, why not use it full capabilities:</p>\n\n<pre><code>If Target.Address = \"$B$3\" Then\n    If Target.Value2 = \"a\" Then ' &lt;-- use Target.Value2\n        Rows(\"40:43\").EntireRow.Hidden = False ' &lt;-- there's no need to use ActiveSheet\n    ElseIf Target.Value2 = \"b\" Then\n        Rows(\"40:43\").EntireRow.Hidden = True\n    End If\nEnd If\n</code></pre>\n\n<p><strong>Note</strong>: there's no need to use <code>ActiveSheet</code>, as this event is triggered inside the <code>ActiveSheet</code>.</p>\n\n<hr>\n\n<p>You can use <code>Select Case</code> if you will need to add more scenarios in the future:</p>\n\n<pre><code>If Target.Address = \"$B$3\" Then\n    Select Case Target.Value2\n        Case \"a\"\n            Rows(\"40:43\").EntireRow.Hidden = False\n        Case \"b\"\n            Rows(\"40:43\").EntireRow.Hidden = True\n        Case Else ' in case you want add more scenarios in the future\n            ' do something else...\n    End Select\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3232047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d43193065e9047a4511b35525050daa?s=128&d=identicon&r=PG&f=1", "display_name": "user3232047", "link": "https://stackoverflow.com/users/3232047/user3232047"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594030836, "creation_date": 1534275718, "last_edit_date": 1594030836, "question_id": 51848716, "link": "https://stackoverflow.com/questions/51848716/private-sub-worksheet-changebyval-target-as-range-not-working", "title": "Private Sub Worksheet_Change(ByVal Target As Range) not working", "body": "<p>I'm trying to hide rows based on the value in cell B3. This was working for me earlier but I unfortunately can't figure out what I changed. I right clicked on the tab and pasted this in 'View Code'. Here's my code:</p>\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = &quot;$B$3&quot; Then\nIf Range(&quot;B3&quot;) = &quot;a&quot; Then\n    ActiveSheet.Rows(&quot;40:43&quot;).EntireRow.Hidden = False\nElseIf Range(&quot;B3&quot;) = &quot;b&quot; Then\n    ActiveSheet.Rows(&quot;40:43&quot;).EntireRow.Hidden = True\nEnd If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "integer"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1534275141, "post_id": 51848541, "comment_id": 90650398, "body": "You don&#39;t need to <code>.Select</code> anything. <code>ActiveSheet.Rows(...).EntireRow.Hidden = True</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1534275207, "post_id": 51848541, "comment_id": 90650419, "body": "Also don&#39;t use <code>Integer</code> for row numbers (or anything, really). Maximum value is 32,767 (<code>2^15-1</code>) - use a <code>Long</code> instead (max value <code>2^31-1</code> =&gt; fits any worksheet)"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534275296, "post_id": 51848541, "comment_id": 90650462, "body": "<code>Rows(&quot;[i+4]:[i+12]&quot;)</code> &gt;&gt; <code>Rows(i + 4 &amp; &quot;:&quot; &amp; i + 12)</code>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1534276028, "post_id": 51848541, "comment_id": 90650772, "body": "You also don&#39;t need quotation marks around the 1, 2 and 3 in your target values - unless you&#39;re reading actual text and need string literals."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 37, "user_id": 10226353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CVKBqnzy41k/AAAAAAAAAAI/AAAAAAAADeY/h14tSdNeGUE/photo.jpg?sz=128", "display_name": "Paul Baird", "link": "https://stackoverflow.com/users/10226353/paul-baird"}, "edited": false, "score": 1, "creation_date": 1534281272, "post_id": 51848638, "comment_id": 90652970, "body": "@PaulBaird forgot to mention - <code>&amp;</code> also dubs as a <i>type hint</i> specifier for a <code>Long</code>, so <code>4&amp;</code> is equivalent to <code>CLng(4)</code> - the whitespace on either side (but most importantly on the <i>left</i> side) of the <code>&amp;</code> operator is <i>critical</i> ;-)   (edited) - feel free to mark the question as &quot;answered&quot; by ticking the green hollow checkmark underneath either answer&#39;s up/down voting buttons."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 7, "last_activity_date": 1534281449, "last_edit_date": 1534281449, "creation_date": 1534275334, "answer_id": 51848638, "question_id": 51848541, "link": "https://stackoverflow.com/questions/51848541/almost-there-how-to-hide-rows-by-integer/51848638#51848638", "title": "Almost there! How to Hide Rows by Integer?", "body": "<p><code>i</code> means nothing to the Excel calculation engine: it only exists in the VBA runtime context.</p>\n\n<p>So you need to build your string by concatenating <em>the value of</em> <code>i</code> with string literals, using the <em>string concatenation operator</em> <code>&amp;</code>:</p>\n\n<pre><code>ActiveSheet.Rows(i + 4 &amp; \":\" &amp; i + 12).EntireRow.Hidden = True\n</code></pre>\n\n<p>Note the use of an explicit <code>ActiveSheet</code> reference, and no need to <code>.Select</code> anything - 99% of the time, you never need to work off <code>Selection</code>.</p>\n\n<p>Also note, the whitespace between the literal <code>4</code> and the <code>&amp;</code> operator is very important. This would be a syntax error:</p>\n\n<pre><code>ActiveSheet.Rows(i + 4&amp; \":\" &amp; i + 12).EntireRow.Hidden = True\n</code></pre>\n\n<p>Because the <code>&amp;</code> token also happens to be a <em>type hint</em> specifier - an obscure notation that pretty much only exists for backward-compatibility, that you'll want to avoid - but it's good to know that <code>4&amp;</code> essentially means <code>CLng(4)</code> (i.e. convert the literal <code>Integer</code> value <code>4</code> to a <code>Long</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1534277329, "last_edit_date": 1534277329, "creation_date": 1534276281, "answer_id": 51848833, "question_id": 51848541, "link": "https://stackoverflow.com/questions/51848541/almost-there-how-to-hide-rows-by-integer/51848833#51848833", "title": "Almost there! How to Hide Rows by Integer?", "body": "<p>With the above statements on how to concatenate the vba with the string we can shorten the code a little with a Select Case.</p>\n\n<p>we can also remove the loop as we only need to know if target.row is two values.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim i As Long\n    If Target.Column = 9 Then\n        If Target.Row = 2 Or Target.Row = 22 Then\n            Rows(Target.Row + 4 &amp; \":\" &amp; Target.Row + 12).Hidden = False\n            Dim j As Long\n            Select Case Target.Value\n                Case \"\"\n                    j = 4\n                Case \"1\", 1\n                    j = 7\n                Case \"2\",2\n                    j = 10\n                Case Else\n                    Exit Sub\n            End Select\n            Rows(Target.Row + j &amp; \":\" &amp; Target.Row + 12).Hidden = True\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10226353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CVKBqnzy41k/AAAAAAAAAAI/AAAAAAAADeY/h14tSdNeGUE/photo.jpg?sz=128", "display_name": "Paul Baird", "link": "https://stackoverflow.com/users/10226353/paul-baird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 51848638, "answer_count": 2, "score": 3, "last_activity_date": 1534281449, "creation_date": 1534274905, "last_edit_date": 1534275324, "question_id": 51848541, "link": "https://stackoverflow.com/questions/51848541/almost-there-how-to-hide-rows-by-integer", "title": "Almost there! How to Hide Rows by Integer?", "body": "<p>I am trying to hide rows in Excel by integer counting in this simple example based on the input from a cell. I can't seem to get my syntax right for the Application.Rows(\"x:x\")Select command. </p>\n\n<p>Here is my example code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim i As Integer\nDim k As Integer\n\nFor k = 0 To 1\n\n    i = 2 + k * 20\n\n    If Target.Column = 9 And Target.Row = i And Target.Value = \"\" Then\n        Application.Rows(\"[i+4]:[i+12]\").Select\n        Application.Selection.EntireRow.Hidden = True\n    Else\n        Application.Rows(\"[i+4]:[i+12]\").Select\n        Application.Selection.EntireRow.Hidden = False\n    End If\n\n    If Target.Column = 9 And Target.Row = i And Target.Value = \"1\" Then\n        Application.Rows(\"[i+7]:[i+12]\").Select\n        Application.Selection.EntireRow.Hidden = True\n    End If\n\n    If Target.Column = 9 And Target.Row = i And Target.Value = \"2\" Then\n        Application.Rows(\"[i+10]:[i+12]\").Select\n        Application.Selection.EntireRow.Hidden = True\n    End If\n\n    If Target.Column = 9 And Target.Row = i And Target.Value = \"3\" Then\n        Application.Rows(\"[i+4]:[i+12]\").Select\n        Application.Selection.EntireRow.Hidden = False\n    End If\n\nNext k\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "pass-by-reference"], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 10117882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b0785e48cf991cbdce327c31018405?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom Lord", "link": "https://stackoverflow.com/users/10117882/phantom-lord"}, "is_accepted": false, "score": -1, "last_activity_date": 1534292621, "creation_date": 1534292621, "answer_id": 51851357, "question_id": 51848516, "link": "https://stackoverflow.com/questions/51848516/vba-spliting-code-and-passing-arguments/51851357#51851357", "title": "VBA Spliting Code and passing arguments", "body": "<p>I don't have the will to spend time in explain how this works, because these are there very basics of programming, so.... search on google this:</p>\n\n<blockquote>\n  <p>vb function passing parameter difference byref and byval</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 10112611, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213896888831137/picture?type=large", "display_name": "Gustavo Rabino", "link": "https://stackoverflow.com/users/10112611/gustavo-rabino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1534292621, "creation_date": 1534274822, "question_id": 51848516, "link": "https://stackoverflow.com/questions/51848516/vba-spliting-code-and-passing-arguments", "title": "VBA Spliting Code and passing arguments", "body": "<p>I'm quite a beginner at coding and the problem that I'm having is that the procedure is too large. I read that this can be fixed by dividing the code into smaller modules. However I want to know if the values of the variables defined outside the modules can be taken into account when you call the variable inside the modules to modify it. Also, after being modified can you use the new value outside the module and in another module? Can someone explain me how the VBA works in these cases? Thank you so much.</p>\n\n<p>I read the answer you gave me but while i understand the concept there is no example that fit my case. I would really appreciate an example so I can fully understand how to solve my issue. What i have is basically:</p>\n\n<pre><code>sub simulador()\n\nSheets(2).Activate\n\nWith ActiveSheet\n\na=1\nb=1\nc=1\n\nfor t=2 to 20\n\nprocedure using and modifying variables a and c\nb=cells(t,15)\n\nfor a=2 to 20\ncode using variable b\nnext a\n\nd=3\nj=9\n\nprocedure using the variables a b and j\nfor ga=2 to 20\ncode using variable d\nnext ga\n\nnext t\nend with\nend sub\n</code></pre>\n\n<p>And what i need to do is create a sub1 whit:</p>\n\n<pre><code>procedure using and modifying variables a and c\nb=cells(t,15)\n</code></pre>\n\n<p>A sub 2 whit:</p>\n\n<pre><code>for a=2 to 20\ncode using and modifying variable b\nnext a\n</code></pre>\n\n<p>An sub 3 whit:</p>\n\n<pre><code>procedures using the variables a b and j\nfor ga=2 to 20\ncode using variable d\nnext ga\n</code></pre>\n\n<p>So at the end would be like:</p>\n\n<pre><code>sub simulador()\n\nSheets(2).Activate\n\nWith ActiveSheet\n\na=1\nb=1\nc=1\n\nfor t=2 to 20\n\nCall sub 1 \n\nCall sub 2\n\nd=3\nj=9\n\nCall sub 3 \n\nnext t\nend with\nend sub\n</code></pre>\n\n<p>In all the cases i want to call the subroutines passing the variables Byref so once they are modified stay modified so another sub can use them with the new value. Also the active sheet should remain active when the procedures in those subroutines are executed. I can't figure out how everything works exactly. Thanks for your help.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1534275552, "post_id": 51848440, "comment_id": 90650580, "body": "It runs because the code does not exit procedure before that line, the code simply executes every line. Here&#39;s another reference on error handling code <a href=\"http://allenbrowne.com/ser-23a.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-23a.html</a>. However, you could possibly get by with a simple <code>If Then Else</code>; such as <code>If Dir(&lt;path string here&gt;) = &quot;&quot; Then MsgBox &quot;some message&quot; Else &lt;your code to do something&gt; End If</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "is_accepted": true, "score": 0, "last_activity_date": 1534279544, "creation_date": 1534279544, "answer_id": 51849529, "question_id": 51848440, "link": "https://stackoverflow.com/questions/51848440/why-is-error-message-box-occurring-with-no-error/51849529#51849529", "title": "Why is Error Message Box occurring with no error?", "body": "<p>The code is working correctly, the way that it is currently setup. The way that it is setup is to always run in every scenario, since there is no break or exit inbetween the current setup.</p>\n\n<p>However, this would definitely be easier to control with an <code>IF</code> statement for this scenario.</p>\n\n<p>Like so:</p>\n\n<pre><code>...\n\nsPath2 = \"w:\\EDU UNDERGRADRecords\\Cert Majors\\Level 2\\\"\nsPath2 = sPath2 &amp; Screen.ActiveForm![DigitalFile] &amp; \"\\\"\n\nIf Dir(sPath2) = \"\" Then\n    MsgBox \"Student File has not been digitized\"\nElse\n    Application.FollowHyperlink sPath2\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Additionally, if you wanted to do the same to the previous called statement, do it like this:</p>\n\n<pre><code>...\nsPath = \"w:\\EDU UNDERGRADRecords\\Cert Majors\\Level 1\\\"\nsPath = sPath &amp; Screen.ActiveForm![DigitalFile] &amp; \"\\\"\n\nIf Dir(sPath) = \"\" Then\n    MsgBox \"Student File has not been digitized\"\n    'Exit Sub 'An ejection (if required for a single failure)\nElse\n    Application.FollowHyperlink sPath\nEnd If\n</code></pre>\n\n<p>FYI - You only made the declaration of <code>sPath</code>, but not <code>sPath2</code></p>\n"}], "owner": {"reputation": 13, "user_id": 10219635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79956ddd8263fd65400a375e1868bd64?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt", "link": "https://stackoverflow.com/users/10219635/kurt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 51849529, "answer_count": 1, "score": 1, "last_activity_date": 1534279734, "creation_date": 1534274430, "last_edit_date": 1534279734, "question_id": 51848440, "link": "https://stackoverflow.com/questions/51848440/why-is-error-message-box-occurring-with-no-error", "title": "Why is Error Message Box occurring with no error?", "body": "<p>The code I wrote looks in two locations for a specific file folder.  If it cannot find the folder I want the error message to let people know the file has not been digitized.  However, the Error message is displaying even if the folder is found.  How can I get the final error message to only appear when there is an actual error.</p>\n\n<pre><code>Private Sub Command128_Click()\n\n    Dim sPath As String\n\n    sPath = \"w:\\EDU UNDERGRADRecords\\Cert Majors\\Level 1\\\"\n    sPath = sPath &amp; Screen.ActiveForm![DigitalFile] &amp; \"\\\"\n\n    On Error Resume Next\n    Application.FollowHyperlink sPath\n\n    Dim sPath2 As String\n\n    sPath2 = \"w:\\EDU UNDERGRADRecords\\Cert Majors\\Level 2\\\"\n    sPath2 = sPath2 &amp; Screen.ActiveForm![DigitalFile] &amp; \"\\\"\n\n    On Error GoTo Error1\n    Application.FollowHyperlink sPath2\n\nExit_Command128_Click:\n\n    Exit Sub\n\n\nError1:\n     MsgBox \"Student File has not been digitized\"\n     Resume Exit_Command128_Click:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "autocad"], "comments": [{"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 1, "creation_date": 1534278813, "post_id": 51848278, "comment_id": 90651912, "body": "The code is easily readable now. I would not favor any change (such as is suggested) which would make it less readable."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1534279135, "post_id": 51848278, "comment_id": 90652054, "body": "@theMayer I was wondering about that.  Their is something definitely to be said about readability and maintenance.  And in my case performance really is not an issue.  Just something inside me wants to know if there is a better way since I am slowly teaching myself VBA.  I am glad I asked the question so far as I never knew about IIF.  Works just like the IF function in Excel."}, {"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1534279851, "post_id": 51848278, "comment_id": 90652388, "body": "The performance hit of a single if-statement evaluating inequality to zero every time after the first is almost the same as though there were no if statement due to branch prediction."}, {"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 1, "creation_date": 1534279882, "post_id": 51848278, "comment_id": 90652403, "body": "But you never should write code for the compiler. Write code for the humans, the poor souls who have to maintain it after you\u2019re gone."}], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1534278688, "post_id": 51848369, "comment_id": 90651876, "body": "Thank you I have not heard of IIF.  I will have to read up on that one.  Thank you."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 2, "last_activity_date": 1534274154, "creation_date": 1534274154, "answer_id": 51848369, "question_id": 51848278, "link": "https://stackoverflow.com/questions/51848278/is-there-a-better-place-for-the-if-statement-in-the-for-loop/51848369#51848369", "title": "Is there a better place for the IF statement in the for loop", "body": "<p>Your idea was very close.  Try the <code>IIf</code> statement instead:</p>\n\n<pre><code>StartPoint(j) = .Cells(i, 8 + j).Value + IIf(j = 0, k * (.Cells(39, 4).Value + .Cells(31, 4).Value), 0)\n</code></pre>\n"}], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51848369, "answer_count": 1, "score": 0, "last_activity_date": 1594151391, "creation_date": 1534273629, "last_edit_date": 1594151391, "question_id": 51848278, "link": "https://stackoverflow.com/questions/51848278/is-there-a-better-place-for-the-if-statement-in-the-for-loop", "title": "Is there a better place for the IF statement in the for loop", "body": "<pre><code>For k = 0 To (.Cells(38, 4).Value - 1)\n    For i = 70 To 73\n        For j = 0 To 2\n            If j = 0 Then\n                bumpvalue = k * (.Cells(39, 4).Value + .Cells(31, 4).Value)\n            Else\n                bumpvalue = 0\n            End If\n            StartPoint(j) = .Cells(i, 8 + j).Value + bumpvalue\n            EndPoint(j) = .Cells(i + 1, 8 + j).Value + bumpvalue\n        Next j\n\n        Set lineObj = DWGFile.ModelSpace.AddLine(StartPoint, EndPoint)\n    Next i\nNext k\n</code></pre>\n\n<p>Is there a better place or way to implement the \"bumpvalue\" which only applies when j = 0?</p>\n\n<p>something tells me below does not fly.</p>\n\n<pre><code> StartPoint(j) = .Cells(i, 8 + j).Value + if j = 0 then k * (.Cells(39, 4).Value + .Cells(31, 4).Value) else 0\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 7, "creation_date": 1534273728, "post_id": 51848233, "comment_id": 90649825, "body": "Yes that&#39;s totally doable using VBA"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1534274211, "post_id": 51848233, "comment_id": 90650039, "body": "Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>"}, {"owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "edited": false, "score": 0, "creation_date": 1534274312, "post_id": 51848233, "comment_id": 90650072, "body": "Oh okay! sorry about that. Will Delete the question"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1534274370, "post_id": 51848233, "comment_id": 90650099, "body": "@sagittarius_88 You don&#39;t have to delete it - rather, edit your question with the attempt you&#39;ve made to solve the problem (assuming you&#39;ve made one, surely you&#39;ve tried something)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534274836, "post_id": 51848233, "comment_id": 90650295, "body": "Can you possibly paste the table data as text here so it&#39;s easier for others to recreate?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1534275102, "post_id": 51848233, "comment_id": 90650379, "body": "Unrelated to your specific problem, but you should get in the habit of declaring all variables :)"}, {"owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534275449, "post_id": 51848233, "comment_id": 90650528, "body": "@DavidZemens, will do thanks! I just started applying VBA to my work 4 weeks ago or so. I appreciate the advice :)"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1534275807, "post_id": 51848233, "comment_id": 90650676, "body": "Does the number 27 always appear in groups of four, as shown, and 5 minutes apart? Is so, then the duration would always be 15 minutes"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1534275925, "post_id": 51848233, "comment_id": 90650731, "body": "What do you want to show in the duration column, the duration from one row to the next, or the total duration for the consecutive rows?"}, {"owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1534275947, "post_id": 51848233, "comment_id": 90650740, "body": "@GMalc, not necessarily, the real data is about 20000 rows, so I just posted a little sample."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "edited": false, "score": 1, "creation_date": 1534335182, "post_id": 51848737, "comment_id": 90669001, "body": "wow you guys are geniuses over here! thank you.  The code sometimes provides inaccurate minutes, but I can troubleshoot from here. Thanks again!"}, {"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "reply_to_user": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "edited": false, "score": 0, "creation_date": 1534424659, "post_id": 51848737, "comment_id": 90706772, "body": "No problem at all.  If you send me a sample of the data that is inaccurate I can help you trouble shoot as well."}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": true, "score": 2, "last_activity_date": 1534275801, "creation_date": 1534275801, "answer_id": 51848737, "question_id": 51848233, "link": "https://stackoverflow.com/questions/51848233/vba-macro-to-count-minutes/51848737#51848737", "title": "VBA Macro to count minutes", "body": "<p>Here is something that works.  You can update the hard coded column references to named ranges if you'd like</p>\n\n<pre><code>Sub cntDuration()\n\n\n    Dim lRow As Long\n    Dim intFlag As Integer\n    Dim firstDate As Date, secondDate As Date\n    Dim difTime As Long\n\n    'Find the last non-blank cell in column A(1)\n    lRow = Cells(Rows.Count, 1).End(xlUp).Row\n    intFlag = 0\n\n    For i = 2 To lRow\n        If Sheets(\"Sheet1\").Range(\"C\" &amp; i).Value &gt; 26.8 And Sheets(\"Sheet1\").Range(\"C\" &amp; i).Value &lt; 27.1 Then\n            If intFlag = 0 Then\n                firstDate = Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value\n                intFlag = 1\n            Else\n                If Sheets(\"Sheet1\").Range(\"C\" &amp; i + 1).Value &gt; 26.8 And Sheets(\"Sheet1\").Range(\"C\" &amp; i + 1).Value &lt; 27.1 Then\n\n                Else\n                    secondDate = Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value\n                    difTime = DateDiff(\"n\", firstDate, secondDate)\n                    Sheets(\"Sheet1\").Range(\"D\" &amp; i).Value = difTime\n                    intFlag = 0\n                End If\n            End If\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Basically the line of code that does what you are wanting is the <code>difTime = DateDiff(\"n\", firstDate, secondDate)</code></p>\n"}], "owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 51848737, "answer_count": 1, "score": 3, "last_activity_date": 1534275801, "creation_date": 1534273458, "last_edit_date": 1534275043, "question_id": 51848233, "link": "https://stackoverflow.com/questions/51848233/vba-macro-to-count-minutes", "title": "VBA Macro to count minutes", "body": "<p>I was wondering if it would be feasible to do the task I'm about to explain via VBA or not.\nBasically what I'm trying to do is, go through \"DUMMY2\" and once the values are \"27\", I would like to subtract the beginning and end of the \"DATETIME\" in that range to get the minute count</p>\n\n<p>For example: 05/16/2018 11:05 - 05/16/2018 10:50 --> to get 15 minutes.\nAnd then continue to go through the list skipping \"16\" , \"9\", \"4\" and doing the until it hits the second batch of \"27\" and goes through the macro again to calculate the minute count.</p>\n\n<p>Thank you very much!</p>\n\n<pre><code>Sub Test()\n\nCells.Find(\"DUMMY2\").Offset(1, 0).Select\nDo Until ActiveCell.Value = \"\"\n\n\nDo While ActiveCell.Value &gt; 26.8 And ActiveCell.Value &lt; 27.1\nFirst = ActiveCell.Offset(0, -2)\n'maybe that doesn't make sense, but I'm trying to select the cells adjacent to \"27\"\nActiveCell.Offset(0, -2).Select\nLoop\nActiveCell.Offset(1, 0).Select\n\nLoop\nEnd Sub\n</code></pre>\n\n<p>Data:</p>\n\n<pre><code>5/16/2018 10:35 -0.03   0\n5/16/2018 10:40 -0.04   0\n5/16/2018 10:45 -0.04   12\n5/16/2018 10:50 -0.32   27\n5/16/2018 10:55 -0.27   27\n5/16/2018 11:00 -0.23   27\n5/16/2018 11:05 -0.21   27\n5/16/2018 11:10 -0.14   16\n5/16/2018 11:15 -0.01   9\n5/16/2018 11:20 -0.02   4\n5/16/2018 11:25 -0.32   27\n5/16/2018 11:30 -0.31   27\n5/16/2018 11:35 -0.30   27\n5/16/2018 11:40 -0.29   27\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/i6VWY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i6VWY.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "outlook", "runtime-error", "email-attachments"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1534272906, "post_id": 51847979, "comment_id": 90649449, "body": "And where do you set <code>objMsg</code>?"}, {"owner": {"reputation": 31, "user_id": 10226159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a51b802ff2de51f4ee6188a38b51b2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bon", "link": "https://stackoverflow.com/users/10226159/j-bon"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1534273973, "post_id": 51847979, "comment_id": 90649944, "body": "Isn&#39;t the objMsg defined in the Dim statement as the Outlook.MailItem?  As I said, I&#39;m a newbie."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1534274163, "post_id": 51847979, "comment_id": 90650023, "body": "It&#39;s not - you&#39;ve declared in on that <code>Dim</code> line, but now you need to set it. Try putting <code>Set objMsg = individualitem</code> after <code>If TypeName(individualItem) = &quot;MailItem&quot; Then</code>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1534274206, "post_id": 51847979, "comment_id": 90650036, "body": "Or you might just be able to say <code>individualitem.SentOn</code> and forget about <code>objMsg</code> altogether"}, {"owner": {"reputation": 31, "user_id": 10226159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a51b802ff2de51f4ee6188a38b51b2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bon", "link": "https://stackoverflow.com/users/10226159/j-bon"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1534274339, "post_id": 51847979, "comment_id": 90650080, "body": "OMG!  Thanks for making me look at it again.  I understand what I did wrong.  I changed the code to dMsg = individualItem.SentOn and it works perfectly."}], "owner": {"reputation": 31, "user_id": 10226159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a51b802ff2de51f4ee6188a38b51b2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bon", "link": "https://stackoverflow.com/users/10226159/j-bon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 745, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1592695766, "creation_date": 1534272361, "last_edit_date": 1592695766, "question_id": 51847979, "link": "https://stackoverflow.com/questions/51847979/rename-downloaded-attachment-with-date-received", "title": "Rename downloaded attachment with date received", "body": "<p>Every day I receive a report (spreadsheet format) of orders submitted the prior day.</p>\n\n<p>I never bothered with saving on a daily basis and now I've been tasked to perform an analysis on it.</p>\n\n<p>I'm trying to run a macro to download the reports (by selecting the emails) from my archives (specific folder) and save them in a location.</p>\n\n<p>The report has the same name on each email. </p>\n\n<p>I don't want to save it as incremental (i.e. Service Orders - 1, Service Orders - 2, 3, 4, 5, etc.).  I would like to save it based on the date received.</p>\n\n<p>When I run the code, I get an error, </p>\n\n<blockquote>\n  <p>\"Run-time error '91': Object variable or With block variable not set\"</p>\n</blockquote>\n\n<p>for the line <code>dMsg = objMsg.SentOn</code>.</p>\n\n<pre><code>Sub DownloadAttachments()\nDim individualItem As Object\nDim att As Attachment\nDim strPath As String\nDim strFileName As String\nDim strExt As String\nDim dicFileNames As Object\nDim objMsg As Outlook.MailItem\nDim dMsg As Date\nDim strDate As String\n\nstrPath = \"C:\\Users\\User1\\Desktop\\Test2\\\"\n\nSet dicFileNames = CreateObject(\"Scripting.Dictionary\")\n\nFor Each individualItem In Application.ActiveExplorer.Selection\n\n    If TypeName(individualItem) = \"MailItem\" Then\n        For Each att In individualItem.Attachments\n\n            dMsg = objMsg.SentOn\n\n            strDate = Format(dMsg, \"yyyy-mm-dd\")\n\n            If Not dicFileNames.exists(att.FileName) Then\n                dicFileNames.Add att.FileName, 1\n            Else\n                dicFileNames(att.FileName) = dicFileNames(att.FileName) + 1\n            End If\n\n            strFileName = Split(att.FileName, \".\")(0)\n            strExt = Split(att.FileName, \".\")(1)\n\n            att.SaveAsFile strPath &amp; strFileName &amp; strDate &amp; \"-\" &amp; dicFileNames(att.FileName) &amp; \".\" &amp; strExt\n\n        Next att\n    End If\nNext individualItem\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "imacros"], "comments": [{"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1534296510, "post_id": 51847638, "comment_id": 90656364, "body": "is there something preventing you from reading it into a string variable and using that variable to set the tag?   if you posted your code then it may help get a better answer."}], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "edited": false, "score": 0, "creation_date": 1534308534, "post_id": 51852232, "comment_id": 90658714, "body": "Hum, and you&#39;ll get a &#39;+1&#39; from me on your Qt @Shaves once you&#39;ll have posted your FCI a bit more &quot;complete&quot; and more clear, and your complete &#39;TAG&#39; Statement as well, that you&#39;ve half truncated..."}, {"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "reply_to_user": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 0, "creation_date": 1534349040, "post_id": 51852232, "comment_id": 90676856, "body": "Yep I will, waiting for OP to check their Thread again and to open a parallel Thread on the iMacros Forum... There are several Solutions with a lot of IF-IF-IF, I will then post the final &quot;clean&quot; Solution here... Oh, but sorry, you mean the Thread you link to @Naren Murali, hum, yep, I had seen it, but they combine that Functionality with Temp/Fake E-mail Addresses, typical Spam Behaviour, but I don&#39;t help for Spam (nor for Social Media)... [Hum, the &#39;Add Comment&#39; Button doesn&#39;t work...(?)]"}, {"owner": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 1, "creation_date": 1534349300, "post_id": 51852232, "comment_id": 90676990, "body": "Thanks for the response, I have asked the user to raise a question there instead, I hope his intentions are not for spamming, thanks for your time :)"}, {"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "reply_to_user": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 0, "creation_date": 1534350113, "post_id": 51852232, "comment_id": 90677407, "body": "Yeah well, I doubt it, ah-ah...! Oh...!, but good though..., if they (the User about the &#39;gmx&#39; Addresses and fake Names) open a Thread on the iMacros Forum, I&#39;ll be able to check the &quot;Spam Reputation&quot; of their IP-Address,  ah-ah...! Then I&#39;ll see... Yeah, but nope, even if they are not a Spammer, the same Script/Functionality could/would be used by (other) Spammers... (And they could find the Sol by themselves if they searched the iMacros Forum a bit, I&#39;ve already answered that kind of Qt&#39;s many times, ah-ah...!)"}, {"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "reply_to_user": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 0, "creation_date": 1534353778, "post_id": 51852232, "comment_id": 90679124, "body": "Hum, and @Naren Murali, I had seen you were answering regularly a few iMacros Threads since a few weeks, very nice...! (I think I had upvoted a few of your Answers...) You are always welcome on the iMacros Forum as well, ah-ah...! (Like I mentioned, I don&#39;t help for Spam + Social Media + Games/Votes + Captcha, but you are free to still answer those Threads if you want...)"}, {"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "reply_to_user": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 0, "creation_date": 1534360228, "post_id": 51852232, "comment_id": 90682102, "body": "@Naren Murali, I&#39;ve  posted my &quot;Answer&quot; anyway as &#39;OP&#39; was not reacting, with several Solutions... You may want to have a look if you are interested, the &quot;Principle&quot; is not very complicated..."}, {"owner": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 1, "creation_date": 1534365212, "post_id": 51852232, "comment_id": 90684228, "body": "Thanks for checking out my answers :) I&#39;m a big fan of IMacros software for years, will try to get into IMacros Forums :) I read your detailed post, I think OP needs to do some studying and find the solution :) after reading this answer, I was wondering, if we could fill the input elements and submit the form too using this method <a href=\"https://stackoverflow.com/questions/51793237/how-to-extract-javascript-variable-value-using-imacros-browser/51796458#51796458\">here</a>, I got this from the IMacros forums I guess"}, {"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "reply_to_user": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 0, "creation_date": 1534366489, "post_id": 51852232, "comment_id": 90684743, "body": "@Naren Murali, foufff...!, very cumbersome, I would have found some much simpler Solution, ah-ah...! (The &quot;+1&quot; is from me, ah-ah...!) But low Quality Qt, FCI not mentioned, I had seen that Thread indeed, and was waiting if they would open a Thread on the iMacros Forum... &gt;&gt; Then,  yep of course, you could use that Method here as well, but you&#39;ll still need to identify the &#39;INPUT&#39; Element, it doesn&#39;t really solve the &quot;qnyfy&quot; Dynamic Part... &gt;&gt; And I think this &#39;URL GOTO=javascript&#39; Syntax might not be supported anymore in v9.0.3 for FF + v10.x for CR+FF..."}, {"owner": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 1, "creation_date": 1534366856, "post_id": 51852232, "comment_id": 90684884, "body": "Yes, its deprecated, just wanted ur opinion :) seemed like a good hack for extracting data, anyway thanks for all your contributions in the forums :) I&#39;m sure I would have referenced those answers multiple times :)"}, {"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "reply_to_user": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 0, "creation_date": 1534367098, "post_id": 51852232, "comment_id": 90684977, "body": "@Naren Murali... or it solves it (the Dynamic Part) just in the same way like &quot;my&quot; Sol_1 and Sol_2 by simply ignoring the &#39;FORM&#39; Parameter... Then I prefer my Sol_[1-2], ah-ah...!, much simpler... &gt;&gt; I think I only know of 2 or 3 very specific (and pretty &quot;High Level&quot;) &quot;Cases&quot; where this Method/Syntax can indeed be useful as Workaround on the &#39;TAG&#39; or &#39;EVENT&#39; Modes, Advanced Users &#39;iimfun&#39; and &#39;thecoder2012&#39; on the iMacros Forum have used it a few times in some &quot;Legit&quot; Cases..."}, {"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "reply_to_user": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 0, "creation_date": 1534367429, "post_id": 51852232, "comment_id": 90685103, "body": "I wouldn&#39;t qualify it as a &quot;good Hack&quot;, especially for Extracting, as &quot;communicating&quot; between the &#39;URL GOTO&#39; and the rest of the (&#39;.iim&#39;) Script is a complete Hassle, you need to create on the fly some custom HTML Element or some Attribute on the &#39;TITLE&#39; for example to then later re-extract it from the &#39;.iim&#39; Script, very cumbersome... &gt;&gt; If it&#39;s already in the Source, some straightforward &#39;EXTRACT=HTM&#39; on some High Level Element on the Page will contain it as well..."}, {"owner": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 1, "creation_date": 1534367558, "post_id": 51852232, "comment_id": 90685158, "body": "oh ok, it wont be the best method, will checkout the forums and also your comments, still have a long way to go :D"}, {"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "reply_to_user": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 0, "creation_date": 1534367868, "post_id": 51852232, "comment_id": 90685273, "body": "Oh, and @Naren Murali, some (Off-Topic) &quot;stupid&quot; Qt, do you know what the &#39;community wiki&#39; CB (CheckBox) means, just below the Edit/Input Field when posting an Answer...? There is no Alt/Title Info on it, I&#39;m too lazy to &quot;investigate&quot;...!"}, {"owner": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 1, "creation_date": 1534368079, "post_id": 51852232, "comment_id": 90685343, "body": "Appologies, I am not sure about that checkbox, sorry :("}], "tags": [], "owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "is_accepted": true, "score": 1, "last_activity_date": 1534392768, "last_edit_date": 1534392768, "creation_date": 1534300903, "answer_id": 51852232, "question_id": 51847638, "link": "https://stackoverflow.com/questions/51847638/imacros-tag-line-properties/51852232#51852232", "title": "iMacros Tag Line properties", "body": "<p>OK, @OP opened some parallel Thread on the iMacros Forum (<a href=\"https://forum.imacros.net/viewtopic.php?f=8&amp;t=29692\" rel=\"nofollow noreferrer\">iMacros Tag Line Properties</a>), which allows me to simplify a bit this Answer and to remove a few of the original IF-IF-IF...\n(The parallel Thread contains a bit more (Background) Info and more precise Sols/Scripts applied to this specific Script, for those interested...)</p>\n\n<p>First, FCI (Full Config Info) was originally not completely clear, now it is:<br>\n=> iMB v10.3, 'Scripting Interface' v10.3, Win7.<br>\n(\"iMacros v10.3\" could have meant 'v10.3 for CR 'Free'/'PE'' also...)</p>\n\n<p>(The 'TAG' Statement is truncated is this Thread, it is complete + complete Script in the parallel Thread...)</p>\n\n<p>Several Solutions, I'll go from \"simplest\" to \"more complex\":</p>\n\n<p>1- The 'FORM' Parameter can probably simply completely be removed. It is usually not needed, unless there are several Forms on the Page with similar HTML Elements, here the 'INPUT' Field.</p>\n\n<p>2- Same like '1', but using for example the 'CLASS' Attribute or any Attr(s) that might identify this 'INPUT' Field uniquely if there are several Forms on the Page with similar (but not identical) 'INPUT' Fields. (Or by adjusting the 'POS=n' if they are identical...)</p>\n\n<p>3- Same like '1' or '2', but combined with 'Relative Positioning', on some HTML Element that can be identified \"easily\" and uniquely to be used as the Anchor, either inside ('3a') the same 'FORM' or 'DIV' (=> this 'INPUT' probably has some 'Label' next to it like some \"Login:\" for example), or just outside ('3b') if that Form has some Name/Title for that \"Section\", usually in 'H2' or 'H3' Type.</p>\n\n<p>4- Simply replace the dynamic part (\"qnyfy\") with a Wildcard:  </p>\n\n<pre><code>TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:/pdp/*/resumeSAML50/pdp/startSSO.ping \n</code></pre>\n\n<p>Sols [1-4] probably provide a \"Shortcut\" to probably achieve the desired Result, but they actually don't really answer @OP's Qt which was \"How to identify/extract/isolate this \"qnyfy\" 5 Letter String...?\"</p>\n\n<p>5- Using first one of [1-4] Methods, manage to tag some Element that will be inside that 'FORM', either the 'INPUT' Field itself or one Element that could be used  as Anchor in '3a' (with Anchor Inside the Form), and then use 'Double Relative Positioning' (more Info on the iMacros Forum where I've several times already completely explained the Principle) to identify and tag and extract (=HTM) the complete 'Containing 'DIV'' (or could be 'SPAN', but there will very probably be some (outer) 'DIV' also) containing the 'FORM' to then isolate the \"qnyfy\" part using 'EVAL', stg like...: </p>\n\n<pre><code>SET !EXTRACT_TEST_POPUP NO\nTAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:/pdp/*/resumeSAML50/pdp/startSSO.ping ATTR=CLASS:* EXTRACT=TXT\nTAG POS=R-1 TYPE=DIV ATTR=TXT:* EXTRACT=TXT\nSET !EXTRACT NULL\nTAG POS=R1 TYPE=DIV ATTR=TXT:*&amp;&amp;CLASS:* EXTRACT=HTM\nSET Form_ID EVAL(\"var s='{{!EXTRACT}}'; var x,y,z; x=s.split('ACTION:/pdp/'); y=x[1].split('/'); z=y[0]; z;\")\nPROMPT EXTRACT:&lt;BR&gt;&lt;BR&gt;{{!EXTRACT}}&lt;BR&gt;&lt;BR&gt;Form_ID:&lt;SP&gt;_{{Form_ID}}_\n</code></pre>\n\n<p>6- This one actually comes between '4' and '5', it would be by using '3b' to first locate some Anchor <em>outside</em> the 'FORM' and its 'Containing 'DIV'', then only one Level of 'Relative Positioning' would be needed... (And the 'EVAL()' Statement remains the same...)</p>\n\n<p>That's it...! It would help / add some \"Reliability\" if for example the Class of the Containing 'DIV' can be identified/added.</p>\n\n<p>Not relevant for iMB v10.3 anymore:<br>\nAnd if \"iMacros v10.3\" meant \"iMacros for CR v10.3 'Free'\", you'll need to use ['!VAR1'-'!VAR3'] instead of 'Form_ID' as User Defined Vars are not supported in the 'Free' Version...</p>\n\n<p>[All Solutions/Scripts not tested of course...! Hum, I had previously mentioned that I could directly think of 3 or 4 Solutions, here are already 6, ah-ah...!, and there are also different possible Variants on all 6 of them...]</p>\n\n<p>7- In the parallel Thread on the iMacros Forum, I also mentioned and explained about a Sol_7 using the 'EVENT' Mode with or without ID, which wouldn't be of use for this User as the 'EVENT' Mode was not supported in iMB v10.3.</p>\n\n<p>Rmk:<br>\nSol_5 and Sol_6 can actually be used to deal with Dynamic ID's, same Principle...!</p>\n\n<blockquote>\n  <p>></p>\n</blockquote>\n\n<p>I might one day have to delete this Answer as I am currently (re)using each time my last 5/5 'Answer_Credit', I each time have to delete some previous Answer, to be able to post a 5th one, as most Users on the 'iMacros' Tag-Channel usually never follow up on their Threads and don't do \"+1\" or \"Accept Solution\"..., and all my previous Answers also usually all get downvoted anyway by some \"angry\" User(s), so I never manage to pass the Threshold for more than 5 Answers, ah-ah...!, tja...!<br>\n(No big deal probably as I actually never or very-very rarely answer Threads on SOF as I don't like the Rep-Pts System, I only answered this one because @OP is a \"nice User\" that I knew from the iMacros Forum, ah-ah...!)</p>\n\n<p>(I still don't know what the 'community wiki' CB means below posting an Answer...?)</p>\n"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 1, "accepted_answer_id": 51852232, "answer_count": 1, "score": 2, "last_activity_date": 1534392768, "creation_date": 1534270979, "question_id": 51847638, "link": "https://stackoverflow.com/questions/51847638/imacros-tag-line-properties", "title": "iMacros Tag Line properties", "body": "<p>I'm trying to create a macro to log in to a company owned web page.  When I record putting the cursor into the User Name text box, the following command is recorded:</p>\n\n<p>TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:/pdp/qnyfy/resumeSAML50/pdp/startSSO.ping </p>\n\n<p>The problem is that the \"qnyfy\" part of the tag line changes.  The next time I try to record this tag line, every thing is the same except that \"qnyfy\" changes to something else; which renders my VBA code useless for logging into this web page.</p>\n\n<p>Is there a way to extract this information first, find out what that 5 characters should be and then re-build a string to use the correct tag line?</p>\n\n<p>Windows 7\nExcel 2016\niMacros 10.3</p>\n\n<p>Thanks for the help........</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1534271540, "post_id": 51847593, "comment_id": 90648852, "body": "Consider the <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/form-current-event-access\" rel=\"nofollow noreferrer\">Form.Current Event</a>.  It fires each time a new row becomes the current record."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1534271609, "post_id": 51847593, "comment_id": 90648882, "body": "Not exactly related, but you may find <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/select-case-statement\" rel=\"nofollow noreferrer\">Select Case Statement</a> useful."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7466341, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jBUbvnOhb8U/AAAAAAAAAAI/AAAAAAAADk0/Vts00goHQaQ/photo.jpg?sz=128", "display_name": "Jon Jaques", "link": "https://stackoverflow.com/users/7466341/jon-jaques"}, "is_accepted": false, "score": 1, "last_activity_date": 1534294972, "creation_date": 1534294972, "answer_id": 51851594, "question_id": 51847593, "link": "https://stackoverflow.com/questions/51847593/vba-access-textbox-populate-without-clicking/51851594#51851594", "title": "VBA Access Textbox populate without clicking", "body": "<p>It all depends on whether you want to populate that text only the first time the form loads, or every time a new record is loaded, in which case you'd want to use the Form_current() event.</p>\n\n<p>To run the code only the first time, you might use something like this:</p>\n\n<pre><code>Private Sub Form_Load()\n   Text1106_Click()\nEnd Sub\n</code></pre>\n\n<p>Or to run it for every record, like this:</p>\n\n<pre><code>Private Sub Form_Current()\n   Text1106_Click()\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10220346, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-noWE9kKpYB0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p6NyA9QTnFLgEiBH5Gok3zN9-MAA/mo/photo.jpg?sz=128", "display_name": "RenMcD", "link": "https://stackoverflow.com/users/10220346/renmcd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594630807, "creation_date": 1534270812, "last_edit_date": 1594630807, "question_id": 51847593, "link": "https://stackoverflow.com/questions/51847593/vba-access-textbox-populate-without-clicking", "title": "VBA Access Textbox populate without clicking", "body": "<p>I have my textbox populating correctly with the below code. The only problem is, I need the textbox to populate on its own without the user clicking, entering or doing anything.</p>\n\n<pre><code>Private Sub Text1106_Click()\n\nDim Chip As Variant\n\n Chip = DLookup(\"ExtMaintChip\", \"TableDataPave\", \"[YrRated] = Forms![FormsFormattedPave]![YrRated] And [RdSecNo] = Forms![FormsFormattedPave]![TextRdSecNo]\")\n\nIf Chip = 0 Then\n    Me.Text1106 = 0\nElseIf Chip = 1 Then\n    Me.Text1106 = \"&lt;10\"\nElseIf Chip = 2 Then\n    Me.Text1106 = \"10-20\"\nElseIf Chip = 3 Then\n    Me.Text1106 = \"20-50\"\nElseIf Chip = 4 Then\n    Me.Text1106 = \"50-80\"\nElseIf Chip = 5 Then\n    Me.Text1106 = \"&gt;80\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1534271016, "post_id": 51847522, "comment_id": 90648641, "body": "see the second example -  <a href=\"https://stackoverflow.com/a/41801050/4539709\">stackoverflow.com/a/41801050/4539709</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1534272128, "post_id": 51847522, "comment_id": 90649128, "body": "If your code errors with the workbook open, it will not be closed and the Excel instance will remain open.  Check your Task Manager for Excel instances still running."}, {"owner": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534280025, "post_id": 51847522, "comment_id": 90652460, "body": "@TimWilliams I have checked my Task Manager a couple times before writing this to make sure nothing was running and it still threw the error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534281219, "post_id": 51847522, "comment_id": 90652948, "body": "If the workbook isn&#39;t already open then you need to open it: <code>Set wkb = Excel.Workbooks.Open(&quot;T:\\Capstone Proj\\TimeStampsOnly.xlsx&quot;)</code>"}, {"owner": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534335880, "post_id": 51847522, "comment_id": 90669311, "body": "@TimWilliams This got rid of my &#39;subscript out of range&#39; error, although I dislike spending the computer resources to open and then close the workbook just to capture a cell value it does seem like it&#39;s the only way.  -Is there anything in the outlook VBA that is causing a &quot;locked for editing by &#39;another user&#39;&quot; when the timestamps workbook is called on? It seems like excel is treating the outlook macro as a person and locking the file after it runs"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 9921702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YH93y.png?s=128&g=1", "display_name": "AlwaysBeProgramming", "link": "https://stackoverflow.com/users/9921702/alwaysbeprogramming"}, "is_accepted": false, "score": 0, "last_activity_date": 1545948037, "creation_date": 1545948037, "answer_id": 53951292, "question_id": 51847522, "link": "https://stackoverflow.com/questions/51847522/excel-doc-locked-for-read-only-after-outlook-vba-code-updates-worksheet/53951292#53951292", "title": "Excel doc locked for read only after Outlook VBA code updates worksheet", "body": "<p>Wagner Braga!</p>\n\n<p>I have had a similar problem in the past. In my case, I was not looking for subjects <em>containing</em> certain characters but rather subjects <em>equal to</em> a string. Either way, that is irrelevant to your issue.</p>\n\n<p>I found that, like yours, my code errored when trying to put info from the email into Excel. I did read the comments on your question and know that you don't want to use unneccessary computing power. My method is not the most efficient way to accomplish what you want to do, but it was the only way I could do it.</p>\n\n<p>First of all, I did not edit the Excel workbook from the Outlook VBA. I tried to do it, but this is where <em>my</em> code errored. Instead, I set the email object as a variable's value (to make it easier to reference). Then I read the information from the email I wanted into an array by using the <code>Split(...)</code> function. The code created a text file and wrote the data to it so that it would be accessible by Excel. Before writing the data from the email, I also wrote the text \"<code>!NEWDATA!</code>\" on the first line. You could use any string you want, as long as there is a unique identifier at the top so that Excel recognizes that it should get data from the file. I then opened the workbook, just like I would open any other file using VBA.</p>\n\n<p>Now, the Excel workboook requires some VBA code as well for my method to work. In the <code>Workbook_Open()</code> VBA sub in the workbook code, Excel should read the first line or first <code>x</code> number of characters. You can use either method, but this is should point to the part of the file that has your \"<code>!NEWDATA!</code>\" or other string. If this string is the one you wrote from Outlook, continue reading the file. If it's not, <code>Exit Sub</code>. From here you can have Excel read the rest of the file (which you separated by a delimeter of your choice via Outlook VBA) and put the data into the corresponding cells. Then change the \"<code>!NEWDATA!</code>\" and the rest of the file so that if you start Excel manually (and you don't want to import any data) the <code>Workbook_Open()</code> sub will stop and not error. You can change it to anything like a blank file, \"<code>No new data</code>\", or any other string you like. After this, use VBA to save the workbook and close it.</p>\n\n<p>As you probably know, you could set the Excel window's <code>Visible</code> property to <code>False</code> if you don't want the user seeing the workbook.</p>\n\n<p>If you have any questions or comments, let me know. I'll be happy to answer any questions you may have.</p>\n"}], "owner": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1592947156, "creation_date": 1534270524, "last_edit_date": 1592947156, "question_id": 51847522, "link": "https://stackoverflow.com/questions/51847522/excel-doc-locked-for-read-only-after-outlook-vba-code-updates-worksheet", "title": "Excel doc locked for read only after Outlook VBA code updates worksheet", "body": "<p>I have adapted code that checks the subject line of new Outlook emails for a keyword, opens a workbook and pastes certain information into this workbook:</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\n\n  Dim olApp As Outlook.Application\n  Dim objNS As Outlook.NameSpace\n  Set olApp = Outlook.Application\n  Set objNS = olApp.GetNamespace(\"MAPI\")\n\n  ' default local Inbox\n  Set Items = objNS.GetDefaultFolder(olFolderInbox).Items\n\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal item As Object)\n\n  On Error GoTo ErrorHandler\n\n  Dim Msg As Outlook.MailItem\n\n  If TypeName(item) = \"MailItem\" Then\n    Set Msg = item\n    If InStr(Msg.Subject, \"Re:\") &gt; 0 Then\n        Exit Sub\n    ElseIf InStr(Msg.Subject, \"MDI Board\") &gt; 0 Then '// Keyword goes here\n\n        '// Declare all variables needed for excel functionality and open appropriate document\n        Dim oXL As Object\n        Dim oWS As Object\n        Dim lngRow As Long\n\n        Set oXL = CreateObject(\"Excel.Application\")\n        oXL.Workbooks.Open FileName:=\"T:\\Capstone Proj\\TimeStampsOnly.xlsx\", AddTOMRU:=False, UpdateLinks:=False\n\n        '// Change sheet name to suit\n        Set oWS = oXL.Sheets(\"TimeStamps\")\n        lngRow = oWS.Range(\"A\" &amp; oXL.Rows.Count).End(-4162).Offset(1).Row '// -4162 = xlUp. not available late bound\n\n        With oWS\n            .cells(lngRow, 1).Value = Msg.SenderName\n            .cells(lngRow, 2).Value = Msg.ReceivedTime\n            .cells(lngRow, 3).Value = Msg.ReceivedByName\n            .cells(lngRow, 4).Value = Msg.Subject\n            .cells(lngRow, 5).Value = Msg.Body\n\n        '// And others as needed - you will have Intellisense\n\n        End With\n\n        With oXL\n            .activeworkbook.Save\n            .activeworkbook.Close SaveChanges:=2   '// 2 = xlDoNotSaveChanges but not availabe late bound\n            .Application.Quit\n        End With\n\n        Set oXL = Nothing\n        Set oWS = Nothing\n\n    End If\n  Else\n    Exit Sub\n  End If\n\nExitPoint:\n\n  Exit Sub\n\nErrorHandler:\n  MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n  Resume ExitPoint\n\n  '// Debug only\n  Resume\n\nEnd Sub\n</code></pre>\n\n<p>I was having issues with being able to access the workbook after the Outlook VBA code ran. It would give multiple errors such as 'the workbook is already open' even though I had no instance of Excel running on my machine or 'this file is read-only' etc. </p>\n\n<p>I tried to circumvent this issue by using another workbook with an update macro that would update a dashboard using the information in the problematic workbook however I am getting a 'subscript out of range' error when I try to set a variable to the workbook with the Outlook data.</p>\n\n<pre><code>Dim wkb As Excel.Workbook\nDim wks As Excel.Worksheet\nSet wkb = Excel.Workbooks(\"T:\\Capstone Proj\\TimeStampsOnly.xlsx\")\nSet wks = wkb.Worksheets(\"Timestamps\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 1, "last_activity_date": 1534271699, "creation_date": 1534271699, "answer_id": 51847817, "question_id": 51847329, "link": "https://stackoverflow.com/questions/51847329/excel-vba-copy-paste-range-in-column-if-date-matches/51847817#51847817", "title": "Excel VBA - Copy Paste Range in column if Date matches", "body": "<p>This should match what you're asking for. In the future, you should share the code that you've attempted so far.</p>\n\n<pre><code>Dim cell As Range\nFor Each cell In Range(\"G6:R6\")\n    If cell.value = Range(\"T6\").value Then\n        Range(Cells(10, cell.Column), Cells(30, cell.Column)).value = Range(\"T10:T30\").value\n    End If\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10226036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3Nv4O6ih8PM/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ql3FmAPA09GAo2QnD3XrTgSVd0Kw/mo/photo.jpg?sz=128", "display_name": "Walther Schultzendorff", "link": "https://stackoverflow.com/users/10226036/walther-schultzendorff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 0, "accepted_answer_id": 51847817, "answer_count": 1, "score": -1, "last_activity_date": 1534317608, "creation_date": 1534269690, "last_edit_date": 1534317608, "question_id": 51847329, "link": "https://stackoverflow.com/questions/51847329/excel-vba-copy-paste-range-in-column-if-date-matches", "title": "Excel VBA - Copy Paste Range in column if Date matches", "body": "<p>My macro is used to copy/paste live data to overwrite an old budget.</p>\n\n<p><strong>Essentially I want to do the following:</strong></p>\n\n<p>If the date in <code>T6</code> = date in <code>Range(G6:R6)</code> then copy <code>Range(T10:T30)</code> to <code>Range(?10:?30)</code>, where <code>?</code> is the column of the cell that matched the date.</p>\n"}]