[{"tags": ["excel", "vba", "merge", "sum", "duplicates"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503536827, "post_id": 45850813, "comment_id": 78661007, "body": "use an array as the dictionary value"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8508727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347e2eff1532ecfddbf626efb4fc2dc7?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Maley", "link": "https://stackoverflow.com/users/8508727/dylan-maley"}, "edited": false, "score": 0, "creation_date": 1503547026, "post_id": 45851727, "comment_id": 78663326, "body": "Hey Jsotola, Thanks for getting back to me, the code allows the second row to be kept when merging though the sum of the merged quantities in column three is not occurring.   The line: dic(arr(i, 1)) = Array(arr(i, 2), dic(arr(i, 1))(1) + arr(i, 3)) is causing Run time error &#39;13&#39; Type mismatch."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1503539357, "creation_date": 1503539357, "answer_id": 45851727, "question_id": 45850813, "link": "https://stackoverflow.com/questions/45850813/merg-duplicate-in-column1-while-summing-their-values-in-column-3-though-keep-th/45851727#45851727", "title": "Merg duplicate in Column1 while summing their values in column 3, though keep the values in column 2 (which are also duplicate) I have this code", "body": "<p>try this ..... please re-enable WorkRng.ClearContents and set the destination ranges to desired values after testing</p>\n\n<pre><code>Sub CombineRows()\n\n'    On Error Resume Next\n\n    Dim WorkRng As Range\n    Set WorkRng = Application.Worksheets(\"Shopping List\").Range(\"A2:C1000\")\n\n    Dim dic As Object\n    Set dic = CreateObject(\"Scripting.Dictionary\")\n\n    Dim arr As Variant\n    arr = WorkRng.Value\n\n    For i = 1 To UBound(arr, 1)\n\n        dic(arr(i, 1)) = Array(0, 0)    ' init dictionary items array (needed because of the math in next instruction)\n        dic(arr(i, 1)) = Array(arr(i, 2), dic(arr(i, 1))(1) + arr(i, 3))\n\n    Next\n\n    Application.ScreenUpdating = False\n'    WorkRng.ClearContents\n\n    Dim aaaa As Variant\n    aaaa = dic.items\n    aaaa = Application.WorksheetFunction.Transpose(aaaa)\n\n    WorkRng.Range(\"e1\").Resize(dic.Count, 1) = Application.WorksheetFunction.Transpose(dic.Keys)\n\n    WorkRng.Range(\"f1\").Resize(dic.Count, 2) = Application.WorksheetFunction.Transpose(aaaa)\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8508727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347e2eff1532ecfddbf626efb4fc2dc7?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Maley", "link": "https://stackoverflow.com/users/8508727/dylan-maley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503539357, "creation_date": 1503531632, "last_edit_date": 1503531652, "question_id": 45850813, "link": "https://stackoverflow.com/questions/45850813/merg-duplicate-in-column1-while-summing-their-values-in-column-3-though-keep-th", "title": "Merg duplicate in Column1 while summing their values in column 3, though keep the values in column 2 (which are also duplicate) I have this code", "body": "<p>I am trying to merge duplicates in column A (which I can do), keep the value in column B (which I can't do) and sum values from duplicated in column A in column C (which I can do) - So, in essence, the question is how do I change the following code to include keeping the duplicate value in column B. </p>\n\n<p>Thanks Dylan</p>\n\n<pre><code>Sub CombineRows()\n\n\nDim WorkRng As Range\n\nDim Dic As Variant\n\nDim arr As Variant\nDim arr2 As Variant\nOn Error Resume Next\n\nSet WorkRng = Application.Worksheets(\"Shopping List\").Range(\"A2:C1000\")\nSet Dic = CreateObject(\"Scripting.Dictionary\")\n\narr = WorkRng.Value\n\nFor i = 1 To UBound(arr, 1)\n\n    Dic(arr(i, 1)) = Dic(arr(i, 1)) + arr(i, 3)\n\n\nNext\n\nApplication.ScreenUpdating = False\nWorkRng.ClearContents\nWorkRng.Range(\"A1\").Resize(Dic.Count, 1) = Application.WorksheetFunction.Transpose(Dic.keys)\n\nWorkRng.Range(\"C1\").Resize(Dic.Count, 1) = Application.WorksheetFunction.Transpose(Dic.items)\n\nApplication.ScreenUpdating = True\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "concatenation", "ms-access-2013"], "comments": [{"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1503531911, "post_id": 45850782, "comment_id": 78659882, "body": "Use one DLookup and combine the criteria. I think the following might give you the answer: <a href=\"https://stackoverflow.com/questions/18378081/access-dlookup-multiple-criteria\" title=\"access dlookup multiple criteria\">stackoverflow.com/questions/18378081/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 8508715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e41db867b5311b9de294a9f64097f27?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8508715/matt"}, "reply_to_user": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1503532621, "post_id": 45850782, "comment_id": 78660042, "body": "Don&#39;t see the connection how that would be used to compare the values from the current record to prevent a save. @PKatona"}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1503610215, "post_id": 45850782, "comment_id": 78701268, "body": "I was hoping you&#39;d look at the Cell DLookup macro where it combined multiple criteria and extrapolate into VBA as I&#39;ve done for the answer."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8508715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e41db867b5311b9de294a9f64097f27?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8508715/matt"}, "edited": false, "score": 0, "creation_date": 1504053636, "post_id": 45871029, "comment_id": 78859158, "body": "<code>If DLookup(&quot;[VisitorID]&quot;, &quot;VisitorInfo&quot;, &quot;[LastName] = &#39;&quot; &amp; LName &amp; &quot;&#39; AND [FirstName] = &#39;&quot; &amp; FName &amp; &quot;&#39; AND [Company] = &#39;&quot; &amp; CName &amp; &quot;&#39;&quot;) Is Nothing Then</code>  I tried yours and it had a compile error. Tried this approach and have a 424 Error."}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 3, "user_id": 8508715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e41db867b5311b9de294a9f64097f27?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8508715/matt"}, "edited": false, "score": 0, "creation_date": 1504116777, "post_id": 45871029, "comment_id": 78893325, "body": "Do you have a primary key in your table? You would need to replace &quot;VisitorId&quot; with the name of your primary key."}, {"owner": {"reputation": 3, "user_id": 8508715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e41db867b5311b9de294a9f64097f27?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8508715/matt"}, "edited": false, "score": 0, "creation_date": 1504140241, "post_id": 45871029, "comment_id": 78902175, "body": "Yes I do and it is VisitorID."}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 3, "user_id": 8508715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e41db867b5311b9de294a9f64097f27?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8508715/matt"}, "edited": false, "score": 0, "creation_date": 1504201109, "post_id": 45871029, "comment_id": 78934468, "body": "An error 424 happens when you refer to an object property or method that is not defined. Do you know which line the error occurs on? If not, can you run debug and note which line it occurs on?"}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 3, "user_id": 8508715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e41db867b5311b9de294a9f64097f27?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8508715/matt"}, "edited": false, "score": 0, "creation_date": 1504203018, "post_id": 45871029, "comment_id": 78935371, "body": "Fixed the answer."}], "tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": true, "score": 0, "last_activity_date": 1504202985, "last_edit_date": 1504202985, "creation_date": 1503609476, "answer_id": 45871029, "question_id": 45850782, "link": "https://stackoverflow.com/questions/45850782/access-2013-prevent-duplicate-record-on-save/45871029#45871029", "title": "Access 2013 Prevent Duplicate Record on Save", "body": "<p>Assuming you have some sort of primary key in the VisitorInfo table, you combine the criteria and examine the DLookup results something like this:</p>\n\n<pre><code>If IsNull(DLookup(\"[VisitorID]\", \"VisitorInfo\", \"[LastName] = '\" &amp; LName &amp; \"' AND [FirstName] = '\" &amp; FName &amp; \"' AND [Company] = '\" &amp; CName &amp; \"'\") Then\n    Dim f As Form\n    DoCmd.RunCommand acCmdSaveRecord\n    For Each f In Access.Forms\n        f.Requery\n    Next\n    DoCmd.RunCommand acCmdClose\nElse\n    MsgBox \"Visitor Already Added\", vbOKOnly\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8508715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e41db867b5311b9de294a9f64097f27?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8508715/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 45871029, "answer_count": 1, "score": 0, "last_activity_date": 1594639198, "creation_date": 1503531391, "last_edit_date": 1594639198, "question_id": 45850782, "link": "https://stackoverflow.com/questions/45850782/access-2013-prevent-duplicate-record-on-save", "title": "Access 2013 Prevent Duplicate Record on Save", "body": "<p>So I have an entry form like so, <a href=\"https://i.stack.imgur.com/v10Y8.png\" rel=\"nofollow noreferrer\">New Visitor Form</a></p>\n\n<p>I am trying to prevent it from saving a record if visitor is already in the table. This is what I have tried, but not having much luck. It will match from different records. I am open to any suggestions.</p>\n\n<pre><code>Dim FName As String\nDim LName As String\nDim CName As String\nDim stLinkCriteriaFN As String\nDim stLinkCriteriaLN As String\nDim stLinkCriteriaCN As String\n\nIf IsNull(Me.tbFirstName.Value) Or IsNull(Me.tbLastName.Value) Or IsNull(Me.cbCompany.Value) Then\nMsgBox \"Not all information has been entered, visitor was not added.\", vbOKOnly, \"Data Entry Error\"\nElse\n\nLName = Me.tbLastName.Value\nFName = Me.tbFirstName.Value\nCName = Me.cbCompany.Value\n\n\n\nstLinkCriteriaLN = \"[LastName] = \" &amp; \"'\" &amp; LName &amp; \"'\"\nstLinkCriteriaFN = \"[FirstName] = \" &amp; \"'\" &amp; FName &amp; \"'\"\nstLinkCriteriaCN = \"[Company] = \" &amp; \"'\" &amp; CName &amp; \"'\"\n\n\n If Me.tbLastName = DLookup(\"[LastName]\", \"VisitorInfo\", stLinkCriteriaLN) And Me.tbFirstName = DLookup(\"[FirstName]\", \"VisitorInfo\", stLinkCriteriaFN) And Me.cbCompany = DLookup(\"[Company]\", \"VisitorInfo\", stLinkCriteriaCN) Then\n    MsgBox \"Visitor Already Added\", vbOKOnly\n Else\n    Dim f As Form\n    DoCmd.RunCommand acCmdSaveRecord\n    For Each f In Access.Forms\n    f.Requery\n    Next\n    DoCmd.RunCommand acCmdClose\n End If\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "paste"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503530158, "post_id": 45850596, "comment_id": 78659489, "body": "did you see this ?  <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/84628eed-a242-42db-8dd9-19c40c10969f/word-2013-vba-runtime-error-4198?forum=worddev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "edited": false, "score": 0, "creation_date": 1503533402, "post_id": 45850903, "comment_id": 78660227, "body": "I have tested and it worked. But the problem is that I need the table to stay in the text because I use it to locate the content in the columns. Your code removed the table."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "edited": false, "score": 0, "creation_date": 1503533642, "post_id": 45850903, "comment_id": 78660269, "body": "is the table in the clipboard?"}, {"owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "edited": false, "score": 0, "creation_date": 1503562474, "post_id": 45850903, "comment_id": 78670571, "body": "Yes. It is table from the web page. Post edited. I found I cannot paste the data from clipboard even with ctrl+v when makro stopped."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1503532440, "creation_date": 1503532440, "answer_id": 45850903, "question_id": 45850596, "link": "https://stackoverflow.com/questions/45850596/documents-add-content-paste-error-4198-in-vba/45850903#45850903", "title": "Documents.Add.Content.Paste - error 4198 in VBA", "body": "<p>try this test code. it inserts text from a clipboard 100 times.</p>\n\n<p>no paste function is used, so repagination should not affect it  (i am guessing)</p>\n\n<pre><code>Sub appendFromClip()\n\n    Dim BufObj As MSForms.DataObject\n    Set BufObj = New MSForms.DataObject   ' clipboard object\n\n    Dim doc As Document\n    Set doc = Documents.Add(DocumentType:=wdNewBlankDocument)\n\n    Dim rng As Range\n    Set rng = doc.Range                   ' whole document\n\n    Dim i As Integer\n    For i = 1 To 100                      ' test: repeat a bunch of text appends\n\n        rng.Collapse wdCollapseEnd        ' collapse range into an insert point at end of document\n\n        BufObj.GetFromClipboard\n        rng = BufObj.GetText              ' note: rng becomes the range of the added text, so you have to collapse rng before adding more text\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "is_accepted": false, "score": 0, "last_activity_date": 1503533011, "creation_date": 1503533011, "answer_id": 45850974, "question_id": 45850596, "link": "https://stackoverflow.com/questions/45850596/documents-add-content-paste-error-4198-in-vba/45850974#45850974", "title": "Documents.Add.Content.Paste - error 4198 in VBA", "body": "<p>I found that simple removing of the first command </p>\n\n<pre><code>Documents.Add DocumentType:=wdNewBlankDocument\n</code></pre>\n\n<p>Have fixed the problem. I have had two windows opened when I have pasted the clipboard. After removing the program runs faster and error no happens.</p>\n"}], "owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1503562397, "creation_date": 1503529798, "last_edit_date": 1503562397, "question_id": 45850596, "link": "https://stackoverflow.com/questions/45850596/documents-add-content-paste-error-4198-in-vba", "title": "Documents.Add.Content.Paste - error 4198 in VBA", "body": "<p>I have written application which copies all text from this <a href=\"http://biblehub.com/text/genesis/3-15.htm\" rel=\"nofollow noreferrer\">web page</a>, </p>\n\n<p>I check the content of the clipboard twice. First in the external program, which copied the webpage, then in Word when pasting the text from the clipboard and the error happens.</p>\n\n<p>For any case, I have added timer to wait, but it is not neccessary because the text is in the clipboard - I am sure.</p>\n\n<pre><code> Dim BufObj As MSForms.DataObject, BufTxt As String\n Set BufObj = New MSForms.DataObject\n BufObj.GetFromClipboard\n BufTxt = BufObj.GetText ' I added BufTxt to watch panel\n\n Dim tmpStart\n tmpStart = Timer\n Do\n    DoEvents\n Loop While (tmpStart + 1) &gt; Timer\n\n Documents.Add.Content.Paste\n</code></pre>\n\n<p>On some page, it works and pasted the text. But on this one it does not. The debugger stopped on the line <code>Documents.Add.Content.Paste</code></p>\n\n<p>Do you have some idea how to fix the problem? I have seen this <a href=\"https://stackoverflow.com/questions/25247849/vba-error-4198-runtime-error-with-paste\">link</a>. where is one answer suggestion to remove links but I cannot find any code there how to do it.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Code updated, but the error still happens. I found that when the debugger break, after I stop the macro, then I cannot paste the data from clipboard (ctrl+v). But the <code>BufTxt</code> contained text when I checked it in the debugger.</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 2306927, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b9916bed031b2c3c67b1e355e94df02a?s=128&d=identicon&r=PG", "display_name": "Ankit", "link": "https://stackoverflow.com/users/2306927/ankit"}, "edited": false, "score": 0, "creation_date": 1503531481, "post_id": 45850362, "comment_id": 78659783, "body": "Thank you. If the same data in column B was replaced by dates, and I wanted a counted of all dates before 8/25/2017, how would I do that?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 105, "user_id": 2306927, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b9916bed031b2c3c67b1e355e94df02a?s=128&d=identicon&r=PG", "display_name": "Ankit", "link": "https://stackoverflow.com/users/2306927/ankit"}, "edited": false, "score": 0, "creation_date": 1503532239, "post_id": 45850362, "comment_id": 78659949, "body": "@Ankit <code>=COUNTIFS(A:A,&quot;Apple&quot;,B:B,&quot;&lt;&quot;&amp;DATE(2016,8,25))</code>"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 3, "last_activity_date": 1503528161, "creation_date": 1503528161, "answer_id": 45850362, "question_id": 45850261, "link": "https://stackoverflow.com/questions/45850261/extract-value-from-column-a-and-then-get-the-count-for-certain-values-from-colum/45850362#45850362", "title": "Extract Value from Column A and then get the count for certain values from Column B for the value in Column A", "body": "<p>As far as I can tell, you are just after the formula</p>\n\n<pre><code>=COUNTIFS(A:A,\"Apple\",B:B,1)\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 2306927, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b9916bed031b2c3c67b1e355e94df02a?s=128&d=identicon&r=PG", "display_name": "Ankit", "link": "https://stackoverflow.com/users/2306927/ankit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 45850362, "answer_count": 1, "score": 0, "last_activity_date": 1503528161, "creation_date": 1503527525, "last_edit_date": 1531161705, "question_id": 45850261, "link": "https://stackoverflow.com/questions/45850261/extract-value-from-column-a-and-then-get-the-count-for-certain-values-from-colum", "title": "Extract Value from Column A and then get the count for certain values from Column B for the value in Column A", "body": "<p>The table structure that I have right now is as below:</p>\n\n<pre><code>Column A  Column B          \n\nApple     1\nApple     2 \nApple     1\nOrange    1\nOrange    2\n</code></pre>\n\n<p>I am trying to write a formula where, for all the cells with the value of Apple in column A, I get the total count for values in column B equal to 1.</p>\n\n<p>Please help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "edited": false, "score": 0, "creation_date": 1503525623, "post_id": 45849635, "comment_id": 78658065, "body": "Is there a pattern to your renumbering scheme?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "edited": false, "score": 0, "creation_date": 1503525827, "post_id": 45849635, "comment_id": 78658134, "body": "@BobtimusPrime - I believe it just looks at the text left of `\\`, and numbers from 0 when it&#39;s the same, restarting at a new value."}, {"owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1503526018, "post_id": 45849635, "comment_id": 78658200, "body": "@BruceWayne Thanks. Alternatively it looks like it could be when the pattern in column B restarts, but I&#39;m guessing Column A will be what they&#39;re going off of."}, {"owner": {"reputation": 107, "user_id": 2355498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ceaa8442795c3206ec7d5f524f182a1?s=128&d=identicon&r=PG", "display_name": "newbie_146", "link": "https://stackoverflow.com/users/2355498/newbie-146"}, "edited": false, "score": 0, "creation_date": 1503526593, "post_id": 45849635, "comment_id": 78658407, "body": "It is column A..group would be CAT and DOG in this example.  The number scheme is just starts at 0 and goes until the group ends."}, {"owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "edited": false, "score": 0, "creation_date": 1503528605, "post_id": 45849635, "comment_id": 78659075, "body": "As a note - Criteria is spelled incorrectly in your sub&#39;s title."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1503528577, "post_id": 45850309, "comment_id": 78659066, "body": "D&#39;oh! I forgot about using <code>Instr()</code>. Much nicer than what I was doing originally, which was a mix of <code>left()</code>, and <code>mid()</code> to parse that out. Good thinking."}, {"owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503529747, "post_id": 45850309, "comment_id": 78659401, "body": "@jsotola If that&#39;s the case, the individual loops can have separate steps. See Edit++"}], "tags": [], "owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "is_accepted": true, "score": 1, "last_activity_date": 1503529900, "last_edit_date": 1503529900, "creation_date": 1503527796, "answer_id": 45850309, "question_id": 45849635, "link": "https://stackoverflow.com/questions/45849635/excel-macro-remove-rows-and-then-relabel-a-cell-value/45850309#45850309", "title": "Excel Macro - Remove rows and then relabel a cell value", "body": "<p>This will be easier to do looping from the top down (using step 1 instead of step -1). I've tried to stay true to your original coding and made this:</p>\n\n<pre><code>Sub DeleteRowBasedOnCriteriga()\nDim RowToTest As Long\nDim startRow As Long\nDim i As Integer\n\nstartRow = 2\n\n'Clear the rows that have \"A\" or \"C\" in column B\nFor RowToTest =  Cells(Rows.Count, 1).End(xlUp).Row to startRow To Step -1\n\n    With Cells(RowToTest, 2)\n       If .Value = \"A\" Or .Value = \"C\" _\n        Then _\n        Rows(RowToTest).EntireRow.Delete\n    End With\n\nNext RowToTest\n\n'If the left 3 characters of the cell above it are the same,_\n'then increment the renumbering scheme\nFor RowToTest = startRow To Cells(Rows.Count, 1).End(xlUp).Row\n    If Left(Cells(RowToTest, 1).Value, InStr(1, Cells(RowToTest, 1), \"\\\")) = Left(Cells(RowToTest, 1).Offset(-1, 0).Value, InStr(1, Cells(RowToTest, 1), \"\\\")) Then\n        i = i + 1\n        Cells(RowToTest, 1).Value = Left(Cells(RowToTest, 1).Value, InStr(1, Cells(RowToTest, 1), \".\")) &amp; i\n    Else\n        i = 0\n        Cells(RowToTest, 1).Value = Left(Cells(RowToTest, 1).Value, InStr(1, Cells(RowToTest, 1), \".\")) &amp; i\n    End If\nNext RowToTest\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: I've updated it to compare all of the string before the backslash and compare using that.\nEDIT++: It has been brought to my attention that when deleting rows it is better to work from the bottom up (step -1) to ensure every row is accounted for. I've re-implemented the original steps in the first code.</p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1503528522, "creation_date": 1503528522, "answer_id": 45850439, "question_id": 45849635, "link": "https://stackoverflow.com/questions/45849635/excel-macro-remove-rows-and-then-relabel-a-cell-value/45850439#45850439", "title": "Excel Macro - Remove rows and then relabel a cell value", "body": "<p>Admittedly, this isn't probably the most efficient, but it should work.</p>\n\n<pre><code>Sub DeleteRowBasedOnCriteriga()\nDim RowToTest As Long, i As Long\nApplication.ScreenUpdating = False\nFor RowToTest = Cells(Rows.Count, 2).End(xlUp).Row To 2 Step -1\n    With Cells(RowToTest, 2)\n        If .Value = \"A\" Or .Value = \"C\" Then Rows(RowToTest).EntireRow.Delete\n    End With\nNext RowToTest\n\nDim totalRows As Long\ntotalRows = Cells(Rows.Count, 1).End(xlUp).Row\nDim curCelTxt As String, aboveCelTxt As String\nFor i = totalRows To i Step -1\n    If i = 1 Then Exit For\n    curCelTxt = Left(Cells(i, 1), WorksheetFunction.Search(\"\\\", Cells(i, 1)))\n    aboveCelTxt = Left(Cells(i - 1, 1), WorksheetFunction.Search(\"\\\", Cells(i - 1, 1)))\n    If curCelTxt = aboveCelTxt Then\n        Cells(i, 1).Value = \"\"\n    Else\n        Cells(i, 1).Value = WorksheetFunction.Substitute(Cells(i, 1), Right(Cells(i, 1), Len(Cells(i, 1)) - WorksheetFunction.Search(\".\", Cells(i, 1))), \"0\")\n    End If\nNext i\n\nDim rng As Range, cel As Range\nDim tempLastRow As Long\nSet rng = Range(\"A1:A\" &amp; Cells(Rows.Count, 2).End(xlUp).Row)\nFor Each cel In rng\n    If cel.Offset(1, 0).Value = \"\" Then\n        tempLastRow = cel.End(xlDown).Offset(-1, 0).Row\n        If tempLastRow = Rows.Count - 1 Then\n            tempLastRow = Cells(Rows.Count, 2).End(xlUp).Row\n            cel.AutoFill Destination:=Range(cel, Cells(tempLastRow, 1))\n            Exit For\n        Else\n            cel.AutoFill Destination:=Range(cel, Cells(tempLastRow, 1))\n        End If\n    End If\nNext cel\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Mainly, I discovered that you can use <code>AutoFill</code> to fix the last number in the string. Meaning if you <code>AutoFill</code> this text, <code>CAT\\Definitions.0</code> down, you get the number updating as you drag/fill.</p>\n"}], "owner": {"reputation": 107, "user_id": 2355498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ceaa8442795c3206ec7d5f524f182a1?s=128&d=identicon&r=PG", "display_name": "newbie_146", "link": "https://stackoverflow.com/users/2355498/newbie-146"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 45850309, "answer_count": 2, "score": 1, "last_activity_date": 1503529900, "creation_date": 1503524081, "last_edit_date": 1503525186, "question_id": 45849635, "link": "https://stackoverflow.com/questions/45849635/excel-macro-remove-rows-and-then-relabel-a-cell-value", "title": "Excel Macro - Remove rows and then relabel a cell value", "body": "<p>What I'm trying to do is remove any rows where a cell value in a specific column matches what is defined to remove.  After that is done re-sequence the value in another column by group.  </p>\n\n<p>Using the example below:<br>\nI want to look at column B and remove any rows that have a value of A or C.  Then I want to basically renumber after the dot (.) in column A to reset itself.</p>\n\n<p><strong>Before Macro Code Fig. 1</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/RSvPP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RSvPP.png\" alt=\"Before macro code\"></a></p>\n\n<p><strong>After value A and C are removed Fig. 2</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/qCh4Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qCh4Q.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Final list after column A is renumbered Fig. 3</strong>\n<a href=\"https://i.stack.imgur.com/FudbE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FudbE.png\" alt=\"After macro code\"></a></p>\n\n<p>I figured out how to remove the rows using this code, but stuck on what to do next:</p>\n\n<pre><code>Sub DeleteRowBasedOnCriteriga()\nDim RowToTest As Long\n\nFor RowToTest = Cells(Rows.Count, 2).End(xlUp).Row To 2 Step -1\n\n    With Cells(RowToTest, 2)\n        If .Value = \"A\" Or .Value = \"C\" _\n        Then _\n        Rows(RowToTest).EntireRow.Delete\n    End With\n\nNext RowToTest\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1503524279, "post_id": 45849626, "comment_id": 78657502, "body": "unless your <code>maxValue</code> = the row in which it is found your Delete will delete the wrong rows."}, {"owner": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1503524352, "post_id": 45849626, "comment_id": 78657532, "body": "what do you mean? e.g for the following data in column A: 1,3,4,5,6,8,3,2,3,2,1 the code should locate the cell where &quot;8&quot; is and delete all of the rows below them (&quot;3,2,3,2,1&quot;)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1503524570, "post_id": 45849626, "comment_id": 78657618, "body": "nope, the Max function returns the value not the row in which it is found.  so it will delete all rows after and including row 8"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1503524644, "post_id": 45849626, "comment_id": 78657661, "body": "You are getting the error because you are trying to set the variable as a range, but the max returns a number, not a range.  If you delete the <code>set</code> you will notice that it will work, but will only return the max number, no information about where that is found as Scott Craner said."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503527078, "post_id": 45849626, "comment_id": 78658574, "body": "is there any reason that you do not delete the rows before the &quot;max&quot; row?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "edited": false, "score": 0, "creation_date": 1503572876, "post_id": 45849777, "comment_id": 78677804, "body": "Hi Scott. I tried running your code, but now I see Compile Error: argument not optional"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "edited": false, "score": 0, "creation_date": 1503578021, "post_id": 45849777, "comment_id": 78681609, "body": "On which line??"}, {"owner": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "edited": false, "score": 0, "creation_date": 1503613353, "post_id": 45849777, "comment_id": 78702430, "body": "my apologies for the late response. The error is in this line:     maxValue  =       Application.WorksheetFunction.Match(Application.WorksheetFun&zwnj;&#8203;ction.M     ax(.Range(&quot;A:A&quot;)), .Range(&quot;A:A&quot;), 0)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "edited": false, "score": 0, "creation_date": 1503616366, "post_id": 45849777, "comment_id": 78703257, "body": "I am not getting any error, but it looks like you have a space in the word <code>Max</code>"}, {"owner": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "edited": false, "score": 0, "creation_date": 1503658757, "post_id": 45849777, "comment_id": 78718027, "body": "Sorry, I just typed it wrong. There is no space. I&#39;m not sure why I&#39;m still getting an error, would this code work on excel 2010 and newer?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1503525036, "last_edit_date": 1503525036, "creation_date": 1503524736, "answer_id": 45849777, "question_id": 45849626, "link": "https://stackoverflow.com/questions/45849626/excel-vba-code-to-find-max-cell-value-in-column-and-delete-all-rows-below-it/45849777#45849777", "title": "Excel VBA code to find max cell value in column and delete all rows below it", "body": "<p>You do not <code>Set</code> a Long, it is not an object.</p>\n\n<p>The Max function does not return the location but the actual number.</p>\n\n<p>We can use Match on the number to return the row.</p>\n\n<pre><code>Sub DeleteRowAfterRange()\n\nDim maxValue As Long\n\nWith Sheets(\"Sheet1\")\n    maxValue  = Application.WorksheetFunction.Match(Application.WorksheetFunction.Max(.Range(\"A:A\")), .Range(\"A:A\"), 0)\n    .Rows(maxValue  &amp; \":\" &amp; .UsedRange.Rows.Count).Delete\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2706, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1503539818, "creation_date": 1503524042, "last_edit_date": 1503539818, "question_id": 45849626, "link": "https://stackoverflow.com/questions/45849626/excel-vba-code-to-find-max-cell-value-in-column-and-delete-all-rows-below-it", "title": "Excel VBA code to find max cell value in column and delete all rows below it", "body": "<p>I have hundreds of .csv files (with data in columns A and B) to clean up and I think a macro would be useful to process this data quickly.</p>\n\n<p>The goal of the code is to locate the cell with the maximum value in Column A and delete all of the rows below it</p>\n\n<p>So far, my code is</p>\n\n<pre><code>Sub DeleteRowAfterRange()\n\n    Dim maxValue As Long\n    Set maxValue = Application.WorksheetFunction.Max(Columns(\"A\"))\n\n    With Sheets(\"Sheet1\")\n        .Rows(maxValue &amp; \":\" &amp; UsedRange.Rows.Count).Delete\n    End With\n\n End Sub\n</code></pre>\n\n<p>I run the macro in the VB editor and see Compile Error: Object Required while this portion of code is highlighted</p>\n\n<pre><code>maxValue =\n</code></pre>\n\n<p>in the line</p>\n\n<pre><code>Set maxValue = Application.WorksheetFunction.Max(Columns(\"A\"))\n</code></pre>\n\n<p>I have searched through various forums and found questions that are similar to mine, but I am not familiar enough with the syntax to figure out what the issue is in my code. I would greatly appreciate any assistance and am looking to learn how to correctly revise this code</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "edited": false, "score": 0, "creation_date": 1503524604, "post_id": 45849594, "comment_id": 78657633, "body": "Huh... that&#39;s... that&#39;s a neat trick. I didn&#39;t know about that. So, it&#39;s stating that one is a Double and the other is a String. Do I just need to use a CLng to fix that?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1503525040, "post_id": 45849594, "comment_id": 78657830, "body": "You need to find out where string type comes from while numeric type expected."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1503525217, "post_id": 45849594, "comment_id": 78657916, "body": "And could you please simplify the variable names in the code? <a href=\"https://pastebin.com/uwjYC340\" rel=\"nofollow noreferrer\">Just a, b, i, j ..</a> instead of that awkward."}, {"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1503525365, "post_id": 45849594, "comment_id": 78657977, "body": "I&#39;d simplify it, but I&#39;m passing this code off later, and I need the variables to be descriptive enough to follow along for people less adept."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1503525836, "post_id": 45849594, "comment_id": 78658139, "body": "Check <code>Debug.Print TypeName(RemWS.Cells(RemAmtMatchLoop, RemAmtMatchColFill).Value)</code>, if it&#39;s a numeric then implicit type conversion might be the reason."}, {"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1503526244, "post_id": 45849594, "comment_id": 78658271, "body": "I checked the type on the data for both arrays, just to be sure. The input data type for both is &quot;Currency&quot;. Sorry, but I&#39;m not sure where to go from here..."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1503526806, "post_id": 45849594, "comment_id": 78658484, "body": "I suppose you may try to convert each value from sheet with <code>CDbl()</code> before putting it into array."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503527507, "post_id": 45849594, "comment_id": 78658709, "body": "your code would be more readable if you get rid of all the leading capitals. reserved words tend to be capitalized .... use <code>mmCustomerCol</code> instead of <code>MMCustomerCol</code>  ..... <code>mmAmtMatchArray</code> instead of <code>MMAmtMatchArray</code> ... maybe even drop the <i>Array</i> from the name, since it is clear that it is an array"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503528082, "post_id": 45849594, "comment_id": 78658890, "body": "drop the text <i>Match</i> from all the variable names (i think it is in almost all of them) ... what is the point of having the same text in all your variable names, it does not differentiate them."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503528625, "post_id": 45849594, "comment_id": 78659081, "body": "do <b>not</b> use <b>nested</b> <code>If</code> statements. .... set a counter to zero .... each if statement increments the counter when match is found  .... at end if <i>counter = 3</i> then --- perfect match  ...... and so on"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1503540263, "post_id": 45849594, "comment_id": 78661769, "body": "Why don&#39;t you join the arrays and check them against each other? Iterating through the values of the array is extremely slow <code>If join(MMAmtMatchArray,&quot;|&quot;) = join(RemAmtMatchArray,&quot;|&quot;) then msgbox &quot;They match&quot; &#39;We know it&#39;s a match if this is true</code> You can off course do this to the debug window with <code>debug.print join(MMAmtMatchArray,&quot;|&quot;)</code> and <code>debug.print join(RemAmtMatchArray,&quot;|&quot;)</code> This will match because they will both be strings"}, {"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1503571533, "post_id": 45849594, "comment_id": 78676834, "body": "@DanDonoghue Joining them is a good idea to make sure they&#39;re both the same Type. I don&#39;t think I can just check if the whole arrays are equal to each other. There are three common columns between the two that may or may not be equal. I need to check that in a given dimension, three values in a second dimension are equal in both arrays. Is there a faster way to do this other than iterating through all values of the array?"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1503572003, "post_id": 45849594, "comment_id": 78677180, "body": "My apologies, I thought you wanted to compare the whole array. Convert your elements when comparing, CSTR() will convert to a string, CDBL to a double etc, that way you know you are comparing like types"}, {"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1503577580, "post_id": 45849594, "comment_id": 78681245, "body": "@DanDonoghue Thanks Dan. I wasn&#39;t sure if I could convert the elements at that stage, but it worked. Thank you!"}], "owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 518, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1503577740, "creation_date": 1503523879, "last_edit_date": 1503577740, "question_id": 45849594, "link": "https://stackoverflow.com/questions/45849594/checking-if-values-from-two-arrays-are-equal-they-are-but-vba-thinks-theyre-no", "title": "Checking if values from two arrays are equal. They are but VBA thinks they&#39;re not (UPDATE: Resolution at bottom)", "body": "<p>I've run into a strange problem:\nI have two separate arrays with 3 attributes I'm trying to match to determine if all three attributes match, partial matches, or no matches.</p>\n\n<p>I have a loop to loop through the values in the first array and a second nested loop within that loop to loop through the second array for each line of the first array.</p>\n\n<p>Here's where it get's weird: I have three If-statement gates that check if the first attribute (amount) is equal in each of the arrays, then the second attribute (trace), and finally the last attribute (customer).\nI have a line item in one array that matches on the amount (as it should), but then fails on the trace check (where it shouldn't).</p>\n\n<p>I've used Debug.Print to see if the values are the same. They are. I checked that the format from the original data is the same (i.e. no spaces/hidden characters etc.). I made sure that when the array is populated from the cells, it uses the .Value method.</p>\n\n<p>Even though I've checked all these, and the Debug.Print shows they are the same, it fails the check when comparing the two values.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>For RemMatchLoop = LBound(RemAmtMatchArray, 2) To UBound(RemAmtMatchArray, 2) Step 1\n    PerfectMatchFound = False\n    For MMMatchLoop = LBound(MMAmtMatchArray, 2) To UBound(MMAmtMatchArray, 2) Step 1\n        If MMAmtMatchArray(MMAmountCol, MMMatchLoop) = RemAmtMatchArray(RemAmountCol, RemMatchLoop) Then\n            Debug.Print \"MM Trace: \" &amp; MMAmtMatchArray(MMTraceCol, MMMatchLoop)\n            Debug.Print \"Rem Trace: \" &amp; RemAmtMatchArray(RemTraceCol, RemMatchLoop)\n            If MMAmtMatchArray(MMTraceCol, MMMatchLoop) = RemAmtMatchArray(RemTraceCol, RemMatchLoop) Then\n                If MMAmtMatchArray(MMCustomerCol, MMMatchLoop) = RemAmtMatchArray(RemCustomerCol, RemMatchLoop) Then\n                    ReDim Preserve RemPerfectMatchArray(1 To RemLastCol, 1 To RemPerfectMatchCount) As Variant\n                    For RemPerfectMatchColFill = 1 To RemInBalanceCol Step 1\n                        RemPerfectMatchArray(RemPerfectMatchColFill, RemPerfectMatchCount) = RemAmtMatchArray(RemPerfectMatchColFill, RemMatchLoop)\n                        If RemPerfectMatchColFill = RemAmountCol Then\n                            Debug.Print \"Perfect Match Amount: \" &amp; RemPerfectMatchArray(RemPerfectMatchColFill, RemPerfectMatchCount)\n                        End If\n                    Next RemPerfectMatchColFill\n                    RemPerfectMatchCount = RemPerfectMatchCount + 1\n                    PerfectMatchFound = True\n                End If\n            End If\n        End If\n    Next MMMatchLoop\n</code></pre>\n\n<p>Here's what the Debug.Print has spit out regarding the line item in question:</p>\n\n<pre><code>MM Trace: 1234\nRem Trace: 1234\n</code></pre>\n\n<p>So, both traces are the same, but when it passes the line:</p>\n\n<pre><code>If MMAmtMatchArray(MMTraceCol, MMMatchLoop) = RemAmtMatchArray(RemTraceCol, RemMatchLoop) Then\n</code></pre>\n\n<p>It detects them as not-equal.</p>\n\n<p>UPDATE: One type is Double and the other is String. Not sure why, because the data the array resulting in a String value pulls from is not Text format and is a number.</p>\n\n<p>Additionally, when the data is populated into the array, it uses the .Value method, as seen below:</p>\n\n<pre><code>For RemAmtMatchColFill = 1 To RemLastCol Step 1\n            RemAmtMatchArray(RemAmtMatchColFill, RemAmtMatchCount) = RemWS.Cells(RemAmtMatchLoop, RemAmtMatchColFill).Value\n        Next RemAmtMatchColFill\n</code></pre>\n\n<p>Not sure why then it's detecting a string...</p>\n\n<p>Any help would be appreciated, as I'm completely baffled.</p>\n\n<p><strong><em>RESOLUTION</em></strong>\nAfter using Typename() suggested in the comments to identify what types are being compared, it was determined that the Variant array was converting Currency data types in both source data into Double type in one array and String type in another. While it's strange that it's doing this, by using CStr() to convert both values to strings while comparing fixed the issue.</p>\n\n<p>Thanks!\nJoe</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1503531405, "post_id": 45849591, "comment_id": 78659764, "body": "Can you post an example of your work so far ? ie: a picture of the page itself with the button options etc. Anything is possible."}, {"owner": {"reputation": 43, "user_id": 8508478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ed95104e8d10e4f673fcf89e19c6f2?s=128&d=identicon&r=PG&f=1", "display_name": "user8508478", "link": "https://stackoverflow.com/users/8508478/user8508478"}, "reply_to_user": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1503541840, "post_id": 45849591, "comment_id": 78662115, "body": "Hi - unfortunately I have not made any headway. I&#39;m not here to look for someone to code for me, moreso looking for someone who may have approached a project like this and can point me to some syntax that may help. I am just breaking ground on this and I scrubbed the internet with no luck on discussing methods to import worksheets from another workbook based on an input response."}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1503579514, "post_id": 45849591, "comment_id": 78682711, "body": "I would start by creating a page with the checkboxes and information you want to gather, then work on the code a piece at a time until you get the desired results (using If -Then statements). Then work on streamlining your code, and putting it in modules."}], "owner": {"reputation": 43, "user_id": 8508478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ed95104e8d10e4f673fcf89e19c6f2?s=128&d=identicon&r=PG&f=1", "display_name": "user8508478", "link": "https://stackoverflow.com/users/8508478/user8508478"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503524435, "creation_date": 1503523862, "last_edit_date": 1503524435, "question_id": 45849591, "link": "https://stackoverflow.com/questions/45849591/vba-to-create-custom-excel-workbook-based-on-input", "title": "VBA to Create Custom Excel Workbook Based on Input", "body": "<p>I have a particularly unique question that likely requires an advanced level of VBA. I have some basic experience in VBA (just takes some time looking for correct syntax). My goal is to have a macro-enabled workbook where I list certain questions on a cover page with buttons for answers. After all questions have been answered (almost like a webform), there will be a submit button that will then generate a custom excel workbook.</p>\n\n<p>To further explain, I have an existing financial model framework that has modular business units A, B, and C. In some cases, I'm looking to picture the consolidated business as only modules A and B. In that event, I'd like a workbook that pulls in the worksheets for modules A and B into the workbook and the associated assumptions page.</p>\n\n<p>Questions I have: \n1. Is this possible to anyone's knowledge?\n2. Where would you suggest starting as far as the VBA is concerned? As mentioned, the goal would be to have these modules saved down in the same folder as this excel-based \"webform\" and allowing me to create a custom workbook that imports certain modules based on the questionnaire.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1503523611, "post_id": 45849288, "comment_id": 78657229, "body": "Create a new array (1 to 10001, 1 to 26) - populate that from your array of arrays., then put the new array on the sheet.  I think that would be faster than putting each separate sub-array to the sheet."}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 3, "last_activity_date": 1503523266, "last_edit_date": 1503523266, "creation_date": 1503522784, "answer_id": 45849362, "question_id": 45849288, "link": "https://stackoverflow.com/questions/45849288/working-with-an-array-of-variants/45849362#45849362", "title": "Working with an array of variants", "body": "<p>To return C1 on the 27th iteration, it will be something like</p>\n\n<pre><code>OutputArray(26)(1,3)\n</code></pre>\n\n<p>I think you will have to paste each iteration separately</p>\n\n<ul>\n<li>Set the first cell of the range (upper left corner)</li>\n<li>Resize the range to include the size of your iteration.\n\n<ul>\n<li>If they are all the same size, you can use a constant; if not, you will have to compute it.</li>\n</ul></li>\n<li><code>R = outputArray(iteration_num)</code></li>\n<li>Increment FirstCell depending on where you want the next iteration</li>\n<li>Repeat</li>\n</ul>\n"}], "owner": {"reputation": 39, "user_id": 5831395, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/962f806553a854c167033b33586cb5e8?s=128&d=identicon&r=PG&f=1", "display_name": "KMLN", "link": "https://stackoverflow.com/users/5831395/kmln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 45849362, "answer_count": 1, "score": 0, "last_activity_date": 1503523266, "creation_date": 1503522456, "last_edit_date": 1531161705, "question_id": 45849288, "link": "https://stackoverflow.com/questions/45849288/working-with-an-array-of-variants", "title": "Working with an array of variants", "body": "<p>I have declared a variant variable in my VBA code, which takes on values from a range. E.g.</p>\n\n<pre><code>Dim Output as variant\nOutput = Range(\"A1:Z1\").value\n</code></pre>\n\n<p>I have declared another array of variants.</p>\n\n<pre><code>Dim OutputArray(10000) as variant\n</code></pre>\n\n<p>Each item in this array is an iteration of Output; i.e. OutputArray(0) is the value of Output in the first iteration, OutputArray(1) is the value of Output in the second iteration and so on.</p>\n\n<p>I have two questions:</p>\n\n<ol>\n<li><p>How can I extract individual items from OutputArray; e.g. I want to know the value of cell C1 in 27th iteration?</p></li>\n<li><p>How can I paste the entire array OutputArray on a worksheet in one go? If it is not possible to do so in one go, what's the best option I have?</p></li>\n</ol>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1503524888, "post_id": 45849250, "comment_id": 78657769, "body": "Just a hunch: step through the code line by line using F8, and check that  sht_Num_Breaks_Pvt is being set to the sheet you think it is."}, {"owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1503592775, "post_id": 45849250, "comment_id": 78692336, "body": "Already checked by printing the name of the sheet, and it&#39;s correct."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1503612149, "post_id": 45849250, "comment_id": 78702001, "body": "Okay. Can you add this to end of the routine, and post back about what comes up? msgbox pvt.parent.name &amp; &quot; &quot; &amp; pvt.name"}, {"owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1504019360, "post_id": 45849250, "comment_id": 78843494, "body": "Nothing will print since the PvtCache isn&#39;t being set (for whatever reason). I gave in and eventually just modified output from the macro recorder to get it to work. See my answer for that."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1504041718, "post_id": 45849250, "comment_id": 78855687, "body": "I hadn&#39;t noticed until now that you have an On Error Resume Next statement. It&#39;s not generally good practice to have this without a closing On Error Goto 0 as any subsequest errors will be masked, which is what is happening here. Can you elaborate why you need the On Error Resume Next statement at all? What happens if you comment it out?"}, {"owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1504095549, "post_id": 45849250, "comment_id": 78878440, "body": "I have it because trying to <code>.ShowAllData</code> will result in an error if there&#39;s no active filter on the data. But you&#39;re right, I overlooked adding an <code>On Error Go To 0</code> after that line."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1504176924, "post_id": 45849250, "comment_id": 78918247, "body": "So if you put an On Error Go To 0 in, what line is the original code throwing an error on?"}], "answers": [{"tags": [], "owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "is_accepted": false, "score": 0, "last_activity_date": 1504019466, "creation_date": 1504019466, "answer_id": 45942642, "question_id": 45849250, "link": "https://stackoverflow.com/questions/45849250/how-to-ensure-pivotcache-is-working-properly/45942642#45942642", "title": "How to ensure PivotCache is working properly?", "body": "<p>I couldn't get the above code to work, no matter how much sense it makes. So, I just decided to use the recorder and modify the output. Here's some working code:</p>\n\n<pre><code>    'Create pivot for Breaks w/o Remedies &gt;30 days\n    .PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        rng_rmdy_GT30.Address(, , xlR1C1, True), Version:=xlPivotTableVersion14). _\n        CreatePivotTable TableDestination:=sht_rmdyGT30_Pivot.Cells(2, 1), _\n        TableName:=\"PivotTable1\", DefaultVersion:=xlPivotTableVersion14\n    sht_rmdyGT30_Pivot.Activate\n    Set Pvt = ActiveSheet.PivotTables(\"PivotTable1\")\n</code></pre>\n\n<p>Oddly enough, not having the source data range in R1C1 format broke this code as well.</p>\n"}], "owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504019466, "creation_date": 1503522249, "question_id": 45849250, "link": "https://stackoverflow.com/questions/45849250/how-to-ensure-pivotcache-is-working-properly", "title": "How to ensure PivotCache is working properly?", "body": "<p>I'm trying to create a pivot in Excel via VBA, but I can't for the life of me figure out why this code isn't working. It's not throwing any errors - there just isn't a pivot table being created. I've used this exact same code in other programs without issue (obviously replacing the local variables). I've already confirmed that my source data is correctly defined. My only lead is that after executing the creation of the pivot cache, it's showing that PvtCache = Nothing.</p>\n\n<pre><code>Option Explicit\nSub Create_Report()\n\nDim sht_Break_Data As Worksheet\nDim sht_Num_Breaks_Pvt As Worksheet\n\nDim tab_name As String\nDim lrow_Src As Long\nDim lcol_Src As Long\n\nDim rng_Pvt_Source As Range\nDim PvtStart As Range\nDim PvtCache As PivotCache\nDim Pvt As PivotTable\nDim PvtField As PivotField\nDim PvtName As String\n\n    Set_Global_Variables\n\n    'Get last row and column of Source Data Tab\n    With sht_Source_Data\n        lrow_Src = .Cells(Cells.Rows.Count, 1).End(xlUp).Row\n        lcol_Src = .Cells(1, Cells.Columns.Count).End(xlToLeft).Column\n\n    'Set source data range for pivots\n        Set rng_Pvt_Source = .Range(.Cells(1, 1), .Cells(lrow_Src, lcol_Src))\n    End With\n\n'=======================================Create Pivot for Number of Breaks==========================================='\n    'Create sheet for Number of Breaks Pivot\n    'If the given tab name already exists, contents are deleted. If not, it is created\n    With ThisWorkbook\n        tab_name = \"Num of Breaks Pivot\"\n        If SheetExists(tab_name, ThisWorkbook) = True Then\n            Set sht_Num_Breaks_Pvt = .Sheets(tab_name)\n            On Error Resume Next\n            sht_Num_Breaks_Pvt.ShowAllData 'clear any active filter\n            sht_Num_Breaks_Pvt.Cells.Delete 'delete content\n            Else\n            .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = tab_name 'add new tab to the end\n            Set sht_Num_Breaks_Pvt = .Sheets(tab_name)\n        End If\n\n        'Define pivot start location\n        Set PvtStart = sht_Num_Breaks_Pvt.Cells(2, 1)\n\n        'Create Pivot Cache from Source Data\n        Set PvtCache = .PivotCaches.Create( _\n            SourceType:=xlDatabase, _\n            SourceData:=rng_Pvt_Source)\n\n        'Create Pivot table from Pivot cache\n        Set Pvt = PvtCache.CreatePivotTable( _\n            TableDestination:=PvtStart, _\n            TableName:=\"test\")\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "windows-10", "serverxmlhttp"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1503522278, "post_id": 45848564, "comment_id": 78656665, "body": "Problem may be in your <code>EncodeBase64</code> function?  Or your <code>URLEncode</code> function ?  Ore you have a different firewall on your Win10 boxes."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503525416, "post_id": 45848564, "comment_id": 78657995, "body": "test on win10 using the actual string that is returned by the encodeBase64 function"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1503546319, "post_id": 45848564, "comment_id": 78663154, "body": "Set all timeouts the same, and check if there is a timeout delay before error occurs? Try <code>MSXML2.XMLHTTP</code> and <code>WinHttp.WinHttpRequest.5.1</code>, also try to change URL and to remove headers - just to see any changes."}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 2558929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d3d0aadc37091c3e37e4d9d9ff1584f?s=128&d=identicon&r=PG", "display_name": "Tomas F.", "link": "https://stackoverflow.com/users/2558929/tomas-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1554480869, "creation_date": 1554480869, "answer_id": 55539566, "question_id": 45848564, "link": "https://stackoverflow.com/questions/45848564/vba-serverxmlhttp-code-works-in-windows-7-but-fails-in-windows-10/55539566#55539566", "title": "VBA ServerXMLHTTP code works in Windows 7 but fails in Windows 10", "body": "<p>I had a similar problem. Haven't tested your code but it appears similar to mine, it also works in Windows7 but not on Windows10. I found out that it was  the Windows10 firewall who blocked it. Yours probably works if you turn off the firewall. I tried different approaches to make an exception to my firewall but never succeded. So the few times I have to run my code I have to shut the firewall down.</p>\n"}], "owner": {"reputation": 31, "user_id": 5636337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54694a13b5c431c6d170b15c5f2ca4d6?s=128&d=identicon&r=PG&f=1", "display_name": "av155", "link": "https://stackoverflow.com/users/5636337/av155"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 900, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1554480869, "creation_date": 1503519304, "question_id": 45848564, "link": "https://stackoverflow.com/questions/45848564/vba-serverxmlhttp-code-works-in-windows-7-but-fails-in-windows-10", "title": "VBA ServerXMLHTTP code works in Windows 7 but fails in Windows 10", "body": "<p>Using VBA in Microsoft Access, I am sending XML to a server to get a response string.  It works fine in Windows 7.  Recently, some users have upgraded to Windows 10, and this no longers works (all users on Office 16).  The specific error is:\n-2147012867 - A connection with the server could not be established.</p>\n\n<p>The error occurs on the xsite.send line</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Dim xsite As ServerXMLHTTP60\nSet xsite = New ServerXMLHTTP60\n\nOn Error Resume Next\n\nxsite.setTimeouts 0, 60000, 30000, 600000\n\nxsite.Open \"POST\", pServerURL &amp; func, False\naErr = Array(Err.Number, Err.Description)\nOn Error GoTo 0\nIf 0 = aErr(0) Then 'No error creating the link\n    xsite.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n    'Set request header with Base64-encoded username/password\n    xsite.setRequestHeader \"Authorization\", \"Basic \" &amp; EncodeBase64(UserName &amp; \":\" &amp; Password)\n    On Error Resume Next\n    xsite.send \"xmlData=\" &amp; URLEncode(xmldata)\n    aErr = Array(Err.Number, Err.Description)\n    On Error GoTo 0\n\n    Debug.Print aErr(0)\n    Debug.Print aErr(1)\nEnd If\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 2, "creation_date": 1503518726, "post_id": 45848390, "comment_id": 78655017, "body": "I haven&#39;t grokked the whole thing, but if you&#39;re looking in D for &quot;01/31/1950&quot;, you&#39;re not going to find it.  They&#39;re all 01/03/1950...or am I missing something?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1503518922, "post_id": 45848390, "comment_id": 78655106, "body": "Also, NB that I don&#39;t think you will find a date value using a string literal, you need to be looking for a date value, not a string."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1503574694, "post_id": 45848390, "comment_id": 78679067, "body": "@Hrothgar totally right. I have the wrong date in there. After updating it to the correct date <i>01/03/1950</i> then it finds them. But If I use the <code>a.Value</code> it does not because <code>a.Value</code> = <i>1/3/1950</i>."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1503574739, "post_id": 45848390, "comment_id": 78679096, "body": "@DavidZemens I&#39;m not sure what the difference is, but I&#39;ll see if I can figure it out and make a change."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1503575133, "post_id": 45848390, "comment_id": 78679369, "body": "does the cell contain text which looks like a date, or does it contain an actual date value (which is actually a long numeric, formatted as a date)? look. at other questions here on the topic of using Find with date values might offer some info for you."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1503575390, "post_id": 45848390, "comment_id": 78679545, "body": "@DavidZemens It does contain a date. The date is entered as <i>1/3/1950</i>, but shows as <i>01/03/1950</i>. I&#39;ll see about finding other questions using .Find on a date."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1503575471, "post_id": 45848390, "comment_id": 78679613, "body": "instead of <code>.Find(&quot;01&#47;03&#47;1950&quot;,</code> try this: <code>.Find(#01&#47;03&#47;1950#,...</code>"}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1503575881, "post_id": 45848390, "comment_id": 78679901, "body": "@DavidZemens searching for <code>01&#47;03&#47;1950</code> works fine. It&#39;s when I search for <code>a.Value</code> which = <code>1&#47;3&#47;1950</code> that it doesn&#39;t find anything."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1503576227, "post_id": 45848390, "comment_id": 78680135, "body": "try either <code>Cdate(a.Value)</code> or <code>Cstr(Format(a.Value, &quot;m&#47;d&#47;yyyy&quot;))</code>"}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1503576301, "post_id": 45848390, "comment_id": 78680190, "body": "I finally found it in a comment on this question: <a href=\"https://stackoverflow.com/questions/38852887/find-date-value-in-a-column-vba\" title=\"find date value in a column vba\">stackoverflow.com/questions/38852887/&hellip;</a>.  I had to change the <code>LookIn</code> to <code>xlFormulas</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "is_accepted": true, "score": 1, "last_activity_date": 1503581926, "last_edit_date": 1503581926, "creation_date": 1503576711, "answer_id": 45861309, "question_id": 45848390, "link": "https://stackoverflow.com/questions/45848390/why-is-my-vba-find-not-finding-anything/45861309#45861309", "title": "Why is my VBA .Find not finding anything?", "body": "<p>I finally figured it out through some more searching as per a comment from David Zemens on making my search more specific.</p>\n\n<p>Here is what worked:</p>\n\n<pre><code>For Each a In wsFound.Range(wsFound.Range(\"D2\"), wsFound.Range(\"D\" &amp; Rows.count).End(xlUp))\n    With SearchRange\n        Set c = SearchRange.Find(a.Value, LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n        If Not c Is Nothing Then\n            Firstfind = a.Address\n            Do\n                wsFound.Range(\"A\" &amp; a.Row &amp; \":U\" &amp; a.Row).Copy\n                LastRow = ActiveWorkbook.Sheets(\"Duplicates\").Range(\"A\" &amp; Rows.count).End(xlUp).Row + 1\n                ActiveWorkbook.Sheets(\"Duplicates\").Range(\"A\" &amp; LastRow).PasteSpecial\n                Set c = .FindNext(c)\n                If c Is Nothing Then\n                    GoTo DoneFinding\n                End If\n            Loop While a.Address &lt;&gt; Firstfind\n        End If\nDoneFinding:\n    End With\nNext a\n</code></pre>\n\n<p>I had to change the <code>LookIn</code> value from <code>xlValues</code> to <code>xlformulas</code> and now it is finding the dates that I'm looking for even without using <code>CDate</code>.</p>\n\n<p>I found this in a comment from another question. <a href=\"https://stackoverflow.com/questions/38852887/find-date-value-in-a-column-vba\">Find date value in a column VBA</a>, the comment was by Eric K</p>\n"}], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 45861309, "answer_count": 1, "score": 1, "last_activity_date": 1503581926, "creation_date": 1503518508, "last_edit_date": 1503574757, "question_id": 45848390, "link": "https://stackoverflow.com/questions/45848390/why-is-my-vba-find-not-finding-anything", "title": "Why is my VBA .Find not finding anything?", "body": "<p>I have what I thought was a pretty simple <code>.Find</code>, but it isn't working.</p>\n\n<pre><code>lngLastRow = wsFound.Range(\"D\" &amp; Rows.count).End(xlUp).Row\nSet SearchRange = wsFound.Range(\"D1:D\" &amp; lngLastRow)\nFor Each a In wsFound.Range(wsFound.Range(\"D2\"), wsFound.Range(\"D\" &amp; Rows.count).End(xlUp))\n    With SearchRange\n        Set c = .Find(\"01/03/1950\", LookIn:=xlValues) 'a.Value, LookIn:=xlValues)\n        If Not c Is Nothing Then\n            Firstfind = a.Address\n            Do\n                wsFound.Range(\"A\" &amp; a.Row &amp; \":U\" &amp; a.Row).Copy\n                LastRow = ActiveWorkbook.Sheets(\"Duplicates\").Range(\"A\" &amp; Rows.count).End(xlUp).Row + 1\n                ActiveWorkbook.Sheets(\"Duplicates\").Range(\"A\" &amp; LastRow).PasteSpecial\n                Set c = .FindNext(c)\n                If c Is Nothing Then\n                    GoTo DoneFinding\n                End If\n            Loop While a.Address &lt;&gt; Firstfind\n        End If\n</code></pre>\n\n<p>DoneFinding:\n        End With\n    Next a</p>\n\n<p>I'm pretty sure that I've got this correct I used info from <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">MSDN</a> to get it this far. </p>\n\n<p>But it isn't finding anything!</p>\n\n<p>My data looks like this:</p>\n\n<pre><code>+--------------+---------+-----------+---------------+--------------+\n|     A        |    B    |     C     |       D       |       E      |\n+--------------+---------+-----------+---------------+--------------+\n| Staff Number | Surname | Forenames | Date of Birth |  Address 1   |\n+--------------+---------+-----------+---------------+--------------+\n|   1000064036 | Farrell | Margaret  | 01/03/1950    | 11 The Close |\n|   1000064036 | Farrell | Margaret  | 01/03/1950    | 11 The Close |\n|   1000064036 | Farrell | Margaret  | 01/03/1950    | 11 The Close |\n+--------------+---------+-----------+---------------+--------------+\n</code></pre>\n\n<p>So I know that there are 3 duplicates in the DOB <code>D</code> column that should be found.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8508179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6be8fc1ca9e6a1a6007b2f61a36f9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Asad", "link": "https://stackoverflow.com/users/8508179/asad"}, "is_accepted": false, "score": 0, "last_activity_date": 1503518793, "creation_date": 1503518793, "answer_id": 45848450, "question_id": 45848303, "link": "https://stackoverflow.com/questions/45848303/how-to-use-sumproduct-with-binary-values-as-string-in-cell/45848450#45848450", "title": "How to use SUMPRODUCT with binary values as string in cell?", "body": "<p>Using the curly brace syntax for arrays, the example looks like this after coercion:\n=SUMPRODUCT({0,1,1,0,0,1},{1,2,3,4,5.6}) </p>\n"}, {"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1503524090, "post_id": 45848481, "comment_id": 78657412, "body": "LOVE THAT COUNTER METHOD FOR STEPPING THROUGH THE DIGITS"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1503523399, "last_edit_date": 1503523399, "creation_date": 1503518953, "answer_id": 45848481, "question_id": 45848303, "link": "https://stackoverflow.com/questions/45848303/how-to-use-sumproduct-with-binary-values-as-string-in-cell/45848481#45848481", "title": "How to use SUMPRODUCT with binary values as string in cell?", "body": "<p>This will do what you want:</p>\n\n<pre><code> =SUMPRODUCT(MID(A1,ROW(1:6),1)*MID(B1,ROW(1:6),1))/SUMPRODUCT(--MID(B1,ROW(1:6),1))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pGnDK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pGnDK.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you want to make it more dynamic, if your numbers are not always 6 digits:</p>\n\n<pre><code>=SUMPRODUCT(MID(A1,ROW(INDIRECT(\"1:\" &amp; MIN(LEN(A1),LEN(B1)))),1)*MID(B1,ROW(INDIRECT(\"1:\" &amp; MIN(LEN(A1),LEN(B1)))),1))/SUMPRODUCT(--MID(B1,ROW(INDIRECT(\"1:\" &amp; MIN(LEN(A1),LEN(B1)))),1))\n</code></pre>\n\n<p>This will now take the shortest of the two numbers and use that as the number length.  So if A1 only has 5 digits and B1 has 6 it will only use the first five.</p>\n\n<p>If B1 is five and A1 is six it will only use the first five of both.</p>\n\n<p>As the number length grows or shrinks the formula will adapt.</p>\n\n<p><a href=\"https://i.stack.imgur.com/p5FPY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p5FPY.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1503523063, "post_id": 45848796, "comment_id": 78657005, "body": "FYI using <code>ROW(1:6)</code> in the sumproduct produces the array <code>{1,2,3,4,5,6}</code> With less typing."}], "tags": [], "owner": {"reputation": 934, "user_id": 2946006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79ab52aa469c475f27ae6b16d5b87b8?s=128&d=identicon&r=PG&f=1", "display_name": "DMM", "link": "https://stackoverflow.com/users/2946006/dmm"}, "is_accepted": false, "score": 0, "last_activity_date": 1503520296, "creation_date": 1503520296, "answer_id": 45848796, "question_id": 45848303, "link": "https://stackoverflow.com/questions/45848303/how-to-use-sumproduct-with-binary-values-as-string-in-cell/45848796#45848796", "title": "How to use SUMPRODUCT with binary values as string in cell?", "body": "<p>If the weights are always 1,2,3,4,5,6 in that order then use</p>\n\n<pre><code>=SUMPRODUCT(VALUE(MID(A1,{1,2,3,4,5,6},1)),{1,2,3,4,5,6})/21\n</code></pre>\n\n<p>If the 6 weights can be different from this then use</p>\n\n<pre><code>=SUMPRODUCT(VALUE(MID(A1,{1,2,3,4,5,6},1)),VALUE(MID(B1,{1,2,3,4,5,6},1)))/SUM(VALUE(MID(B1,{1,2,3,4,5,6},1)))\n</code></pre>\n\n<p>If there are greater or fewer than 6 weights adjust the array <code>{1,2,3,4,5,6}</code> accordingly.</p>\n\n<p>If binary string in <code>A1</code> is shorter in length than the array size you will get a <code>#VALUE!</code> error in both cases. If the weights string in <code>B1</code> is shorter than the array size you will get the same error in the second case (<code>B1</code> is not used in the first case). If either string has more characters than the size of the array only the leftmost characters up to the size of the array will be used. </p>\n"}], "owner": {"reputation": 45, "user_id": 7346463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0478d1818384f46b4422ee04d3d8cd1f?s=128&d=identicon&r=PG&f=1", "display_name": "BBXAXX", "link": "https://stackoverflow.com/users/7346463/bbxaxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "accepted_answer_id": 45848481, "answer_count": 3, "score": 0, "last_activity_date": 1503523399, "creation_date": 1503518195, "last_edit_date": 1531161705, "question_id": 45848303, "link": "https://stackoverflow.com/questions/45848303/how-to-use-sumproduct-with-binary-values-as-string-in-cell", "title": "How to use SUMPRODUCT with binary values as string in cell?", "body": "<p>I want to use SUMPRODUCT so that it will work inside cell that contains string of binary numbers for example:</p>\n\n<p>Cell A1 = \"011001\"\nCell B1 = \"123456\"</p>\n\n<p>Now I want to use SUMPRODUCT to perform weighted average, cell A1 contain numbers and cell B1 contain weights, proper formula should work like this:</p>\n\n<pre><code>1st element (0) = weight (1)\n\n2nd element (1) = weight (2)\n\n3rd element (1) = weight (3)\n\n4th element (0) = weight (4)\n\n5th element (0) = weight (5)\n\n6th element (1) = weight (6)\n</code></pre>\n\n<p>This imaginary formula SUMPRODUCT(A1;B1)/SUM(B1) should be equal =~52%\nIf someone know any solution for that problem thank you very much in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503518032, "post_id": 45848153, "comment_id": 78654663, "body": "you are copying from wbkNew to wbkCur"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1503518043, "post_id": 45848153, "comment_id": 78654670, "body": "What is the name of the workbook with your code? Is it &quot;tracker&quot;? or something else? Is the workbook with your code wbkCur or wbkNew?  You are setting 2 workbooks to the name &quot;tracker&quot;, wbkCur and wbkNew.  Is that what you want? If so, it&#39;s a confusing way to do things."}, {"owner": {"reputation": 23, "user_id": 8508101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64e6164ed5c7ee69e34b20fce37d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandra", "link": "https://stackoverflow.com/users/8508101/alexandra"}, "edited": false, "score": 0, "creation_date": 1503518475, "post_id": 45848153, "comment_id": 78654909, "body": "yes, the code is stored in &quot;tracker&quot;, aka wbkCur. I do not know how to write the code for the other one."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8508101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64e6164ed5c7ee69e34b20fce37d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandra", "link": "https://stackoverflow.com/users/8508101/alexandra"}, "edited": false, "score": 0, "creation_date": 1503520144, "post_id": 45848584, "comment_id": 78655690, "body": "Thanks Bobtimus! Sadly i get a syntax error with this line : Set wbkCur as ThisWorkbook. Also, when i run the code, i get a &quot;file open&quot; window  ."}, {"owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "reply_to_user": {"reputation": 23, "user_id": 8508101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64e6164ed5c7ee69e34b20fce37d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandra", "link": "https://stackoverflow.com/users/8508101/alexandra"}, "edited": false, "score": 0, "creation_date": 1503520558, "post_id": 45848584, "comment_id": 78655890, "body": "@Alexandra Sorry, the &quot;Set&quot; action requires a &quot;=&quot; operator. I&#39;ve updated it.   With the File Open window, I think this will be the easiest way to reference a file that will never be in the same place nor have the same name. You can have some place on your computer that you designate to save the file and overwrite it each day that you receive it.  If this isn&#39;t satisfactory, you will need to add some more information regarding where you get the second file from."}, {"owner": {"reputation": 23, "user_id": 8508101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64e6164ed5c7ee69e34b20fce37d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandra", "link": "https://stackoverflow.com/users/8508101/alexandra"}, "edited": false, "score": 0, "creation_date": 1503521512, "post_id": 45848584, "comment_id": 78656345, "body": "I get that second file from my e-mail, i just open it and copy the information i needed (from 8-10 different cells). I get the same type of e-mail maybe 10 times a day (from here my despair :) )"}, {"owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "reply_to_user": {"reputation": 23, "user_id": 8508101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64e6164ed5c7ee69e34b20fce37d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandra", "link": "https://stackoverflow.com/users/8508101/alexandra"}, "edited": false, "score": 0, "creation_date": 1503522119, "post_id": 45848584, "comment_id": 78656599, "body": "Automating the opening of a spreadsheet from your email is a little more complex, though possible, particularly with Outlook. See <a href=\"https://stackoverflow.com/questions/11781320/download-attachment-from-outlook-and-open-in-excel\">this answer</a>  from Siddharth Rout for a tutorial. I think you&#39;ll find if you just right-click and &quot;Save As&quot; to a particular spot, it will be much simpler --- Additionally, if you do this, you can hardcode in the file path."}], "tags": [], "owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "is_accepted": false, "score": 0, "last_activity_date": 1503520365, "last_edit_date": 1503520365, "creation_date": 1503519374, "answer_id": 45848584, "question_id": 45848153, "link": "https://stackoverflow.com/questions/45848153/vba-copy-from-an-open-workbook/45848584#45848584", "title": "VBA copy from an open workbook", "body": "<p>The easiest thing is probably going to be using a file picker from FileDialog, especially if your second workbook is not consistent.</p>\n\n<pre><code>Sub OpenClose_Click()\n\n'Create a variable to hold the path\nDim wbkNewPath As String\n\n'Select the file\nMsgBox (\"Please choose location of file to be imported:\")\n\nWith Application.FileDialog(msoFileDialogOpen)\n    .Show\n        If .SelectedItems.Count = 1 Then\n        wbkNewPath = .SelectedItems(1)\n    End If\nEnd With\n\n'Cancel will return vbNullString, so end the procedure\nIf wbkNewPath = vbNullString Then End\n\n'New workbook variables\nDim wbkNew As Workbook\nSet wbkNew = Workbooks.Open(wbkNewPath)\nDim wbkNewInfo As Worksheet\nSet wbkNewInfo = wbkNew.Sheets(\"Info\")\n\n'Create variables for current workbook\nDim wbkCur As Workbook\nSet wbkCur = ThisWorkbook\nDim wbkCurData as worksheet\nSet wbkCurData = wbkCur.Sheets(\"Data\")\n\n'Copy Data\nwbkNewInfo.Range(\"D8\").Value = wbkCurData.Range(\"A2\").Value \nwbkNew.Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 8508101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64e6164ed5c7ee69e34b20fce37d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandra", "link": "https://stackoverflow.com/users/8508101/alexandra"}, "edited": false, "score": 0, "creation_date": 1503521635, "post_id": 45848877, "comment_id": 78656403, "body": "Thank you Dennis, i will copy this and try to adjust it to my file, fingers crossed :D"}, {"owner": {"reputation": 1, "user_id": 8507585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8bced4c1c793b043bf0c603bd5aa25?s=128&d=identicon&r=PG", "display_name": "Dennis", "link": "https://stackoverflow.com/users/8507585/dennis"}, "reply_to_user": {"reputation": 23, "user_id": 8508101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64e6164ed5c7ee69e34b20fce37d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandra", "link": "https://stackoverflow.com/users/8508101/alexandra"}, "edited": false, "score": 0, "creation_date": 1503523110, "post_id": 45848877, "comment_id": 78657033, "body": "Please note I made a change to the code.  Check the StripPath() function and see if you need to copy that part again."}], "tags": [], "owner": {"reputation": 1, "user_id": 8507585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8bced4c1c793b043bf0c603bd5aa25?s=128&d=identicon&r=PG", "display_name": "Dennis", "link": "https://stackoverflow.com/users/8507585/dennis"}, "is_accepted": false, "score": 0, "last_activity_date": 1503523036, "last_edit_date": 1503523036, "creation_date": 1503520620, "answer_id": 45848877, "question_id": 45848153, "link": "https://stackoverflow.com/questions/45848153/vba-copy-from-an-open-workbook/45848877#45848877", "title": "VBA copy from an open workbook", "body": "<p>I copied this from one of my projects that does something close.  I'm capturing orders from a CSV file daily and keeping a list of those orders in the master spreadsheet until the processing is completed for those orders.  This might be a little overkill, but it should do everything you need and help you make the process more robust.  You can add a line into your command button click event:</p>\n\n<pre><code>Global Const AppName = \"DailyMacro.xlsm\"\n\nSub Command1_Click()\n    call ImportOrders\nEnd Sub\n\nPublic Sub ImportOrders()\n\n    Dim iFile As String, WorkbookName As String, ValidFile As Boolean, Path As String\n    Application.ScreenUpdating = False\n    '--dialog box to select today's file\n    iFile = ImportFilename()\n    ValidFile = True\n    If iFile &lt;&gt; \"\" Then\n        WorkbookName = StripPath(iFile)\n        If ConfirmExcelFile(WorkbookName) Then \n            Workbooks(WorkbookName).Activate\n            With Worksheets(1)\n                .Activate\n                '--verify correct file type (depends on your needs)\n                If Not (.Range(\"A1\").Text = \"H\" And .Range(\"B1\").Text = \"PO\") Then\n                    ValidFile = False  'not a valid file\n                Else\n                    '--last row in column 'c'\n                    LR = LastRow(Worksheets(1).Name, \"C\")\n                    If LR &lt; 2 Then ValidFile = False\n                End If\n                '--copy over today's data\n                If ValidFile = True Then .Range(\"A2:AE\" &amp; LR - 1).Copy\n            End With\n            If ValidFile = True Then\n                Workbooks(AppName).Activate\n                With Worksheets(oFile)\n                    .Activate\n                    '--last row of existing data\n                    LR = LastRow(oFile, \"C\")\n                    '--append new rows to end \n                    .Range(\"A\" &amp; LR + 1).Select\n                    ActiveSheet.Paste\n                    Application.CutCopyMode = False\n                End With\n            Else\n                MsgBox \"Import file wrong format or empty. Please check and try again.\", vbCritical, \"ERROR\"\n            End If\n        End If\n        Workbooks(WorkbookName).Close\n    End If\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nPrivate Function ImportFilename() As String\n\n    Dim fName As String, fTitle As String, fFilter As String, LR As Long\n    fTitle = \"Please choose a file to open\"\n    fFilter = \"Comma Separated Value *.csv* (*.csv*),\"\n    fName = Application.GetOpenFilename(Title:=fTitle, fileFilter:=fFilter)\n    If fName = \"False\" Then\n        MsgBox \"No file selected.\", vbExclamation, \"Sorry!\"\n        Exit Function\n    Else\n        Workbooks.Open Filename:=fName\n        ImportFilename = fName\n    End If\n\nEnd Function\n\nFunction StripPath(Filename) As String\n    Dim X As Integer, NewName As String, saveName As String\n    X = InStrRev(Filename, \"\\\")\n    If X &lt;&gt; 0 Then\n        saveName = Mid(Filename, X + 1, Len(FileName))\n    End If\n    StripPath = saveName\nEnd Function\n\nFunction ConfirmExcelFile(Filename As String) As Boolean\n    On Error GoTo BadFile\n    'confirm that we have valid excel file\n    If Workbooks(Filename).Worksheets.Count &gt; 0 Then\n        'now check to see if there is any data contained\n        With Workbooks(Filename).Worksheets(1)\n            If LastRow(.Name, \"C\") &gt; 2 Then\n                ConfirmExcelFile = True\n                Exit Function\n            Else\n                MsgBox \"Selected file does not contain data.\", vbExclamation, \"Error!\"\n                Exit Function\n            End If\n        End With\n    End If\nBadFile:\n    MsgBox \"Selected file is not compatible.\", vbExclamation, \"Error!\"\nEnd Function\n\nFunction LastRow(Tabname As String, Col As String) As Long\n   With Worksheets(Tabname)\n       LastRow = .Cells(Rows.Count, Col).End(xlUp).Row\n   End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8508101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64e6164ed5c7ee69e34b20fce37d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandra", "link": "https://stackoverflow.com/users/8508101/alexandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1503523036, "creation_date": 1503517537, "last_edit_date": 1503518297, "question_id": 45848153, "link": "https://stackoverflow.com/questions/45848153/vba-copy-from-an-open-workbook", "title": "VBA copy from an open workbook", "body": "<p>I have a small big problem with a very simple thing to do (apparently) in VBA. \nI have two workbooks. The first one is a tracker, saved on my computer. \nThe second one is a file I receive daily, which I never save. This second excel file can have different names, therefore I cannot have a name in my code. \nI need to copy a range of cells from the second excel to my tracker. \nThis is what I have and doesn't work (nothing happens when I action the command button): </p>\n\n<pre><code>  Sub OpenClose_Click()\n    Dim i As Long\n    Dim Filename As String\n    Dim CellRange As String\n    Dim wbkCur As Workbook\n    Dim wbkNew As Workbook\n    Set wbkCur = Workbooks(\"tracker\")\n\n        Filename = \"C:\\Users\\tracker.xlsm\"\n        Set wbkNew = Workbooks.Open(Filename:=Filename)\n\n        wbkNew.Worksheets(\"Info\").Range(\"D8\").Value=wbkCur.Worksheets(\"Data\").Range(\"A2\").Value \n        wbkNew.Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1503517559, "post_id": 45848053, "comment_id": 78654424, "body": "Put &quot;1&quot; on <code>O1</code>, then &quot;2&quot; on <code>O2</code> then highlight both cells and drag down to row 3450. Excel will autoincrement the number. You can also use the formula <code>=Row()</code> to populate the cell with the row number. VBA would be overkill I think."}], "answers": [{"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 1, "last_activity_date": 1503517812, "creation_date": 1503517812, "answer_id": 45848206, "question_id": 45848053, "link": "https://stackoverflow.com/questions/45848053/how-do-i-use-vba-to-append-an-id-number-to-the-end-of-each-row/45848206#45848206", "title": "How do I use VBA to append an ID number to the end of each row?", "body": "<p>This is set to work on Sheet number 1, you can change that to whichever sheet you need it on.  It also starts on row one for column O.</p>\n\n<pre><code>Sub Add_to_O()\nLRow = Sheets(1).Range(\"O\" &amp; Rows.Count).End(xlUp).Row\n\nFor I = 1 to LRow\n  Sheets(1).Range(\"O\" &amp; I).value = Sheets(1).Range(\"O\" &amp; I).value &amp; I\nNext I\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7998060"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 45848206, "answer_count": 1, "score": 0, "last_activity_date": 1503517812, "creation_date": 1503517065, "last_edit_date": 1531164843, "question_id": 45848053, "link": "https://stackoverflow.com/questions/45848053/how-do-i-use-vba-to-append-an-id-number-to-the-end-of-each-row", "title": "How do I use VBA to append an ID number to the end of each row?", "body": "<p>I have a worksheet with about 3450 items on it. I use a pivot table to show a chart of this information using a filter. The problem is that there are duplicate values in the 'results' section. I want these to be included in the chart so I need to apply an ID to each row. Is there a script to add a sequential number (1,2,3,...) to column O?</p>\n"}, {"tags": ["python", "excel", "vba", "autocad", "comtypes"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 8070933, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6c35604db01051ff0c97249caa97613b?s=128&d=identicon&r=PG&f=1", "display_name": "Serag Hassouna", "link": "https://stackoverflow.com/users/8070933/serag-hassouna"}, "is_accepted": false, "score": 0, "last_activity_date": 1503571679, "last_edit_date": 1592644375, "creation_date": 1503571679, "answer_id": 45859607, "question_id": 45847990, "link": "https://stackoverflow.com/questions/45847990/autocad-handle-and-handeltoobject-contradiction-in-python-and-vba-macro/45859607#45859607", "title": "AutoCAD Handle and HandelToObject contradiction in python and VBA macro", "body": "<h1>NOTE: THIS IS NOT A SOLUTION, IT'S ANOTHER WAY TO REFERENCE XRECORDS</h1>\n<p>I've replaced dealing with object's <em>handle</em> to object's <em>object ID</em>, then I've taken a copy of the vba macro, renamed the copied macro to <em>&quot;getfromid&quot;</em>, taken a copy of <code>XRecord_return</code>, renamed the copy to <code>XRecord_return_1</code>, then made minor changes as following:-</p>\n<p><strong>At the vba macro <code>getfromid</code></strong></p>\n<p>1- Go to line <code>Set myXRecord = mydoc.HandleToObject(handler)</code> and replace <code>HandleToObject</code> with <code>ObjectIDToObject</code></p>\n<p>2- Change <code>Dim name2 As String</code> to <code>Dim name2 As String, handler As LongPtr</code></p>\n<p><strong>At the python function <code>XRecord_return_1</code></strong></p>\n<p>1- Change the line <code>xl.Application.Run(&quot;facilitator.xlsm!mod_facilitate.getxrecord&quot;)</code> to <code>xl.Application.Run(&quot;facilitator.xlsm!mod_facilitate.getfromid&quot;)</code></p>\n<hr />\n<p>This should avoid the source of <strong>Unknown handle</strong> error.</p>\n"}], "owner": {"reputation": 63, "user_id": 8070933, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6c35604db01051ff0c97249caa97613b?s=128&d=identicon&r=PG&f=1", "display_name": "Serag Hassouna", "link": "https://stackoverflow.com/users/8070933/serag-hassouna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594153933, "creation_date": 1503516801, "last_edit_date": 1594153933, "question_id": 45847990, "link": "https://stackoverflow.com/questions/45847990/autocad-handle-and-handeltoobject-contradiction-in-python-and-vba-macro", "title": "AutoCAD Handle and HandelToObject contradiction in python and VBA macro", "body": "<p>I'm trying to get XRecords' data [DXF group codes + values] in a python script with the help of the VBA macro and the python function provided in this <a href=\"https://stackoverflow.com/a/45773515/8070933\">answer</a>.</p>\n\n<p>In python, I get the handle of the XRecord using the <code>Handle</code> property, however, not all XRecords does return successfully their data, and an <strong>Unknown handle</strong> error is thrown at the line <code>Set myXRecord = mydoc.HandleToObject(handler)</code> at the VBA macro.</p>\n\n<p>I've looked for an explanation, one of them is <a href=\"https://groups.google.com/forum/#!topic/autodesk.autocad.customization.vba/HoVKkndgMYU\" rel=\"nofollow noreferrer\">this one</a>, but my case is different in that it <em>takes the XRecord's handle at first</em> then supply it, so, no assumptions are made on how handles are created at the AutoCAD drawing.</p>\n\n<p>So, <strong>how can an XRecord return its handle, then <code>HandleToObject</code> method can't find that XRecord from its <code>Handle</code> property's value?!</strong></p>\n\n<p><strong>Edit:-</strong></p>\n\n<p>I guess the problem is with <code>HandleToObject</code> itself, I get python to preview the handle which invokes the error (say \"3E7\") then I open the drawing and get the XRecord's data from the ordinary  <code>entget</code> preview using <code>(entget (handent \"3E7\"))</code> in AutoCAD's command line, and the result is successful.</p>\n\n<pre><code>((-1 . &lt;Entity name: 7ff649f06e70&gt;) (0 . \"XRECORD\") (5 . \"3E7\") (102 . \"{ACAD_REACTORS\") (330 . &lt;Entity name: 7ff649f06e20&gt;) (102 . \"}\") (330 . &lt;Entity name: 7ff649f06e20&gt;) (100 . \"AcDbXrecord\") (280 . 1) (1 . \"Wall1\"))\n</code></pre>\n\n<p>Can there be any workaround to this issue?!!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503516218, "post_id": 45847719, "comment_id": 78653832, "body": "in excel, this is a valid reference <code>range(Cells(3, &quot;b&quot;)</code> or <code>columns(&quot;b&quot;).select</code>  ... so this would work <code>columns(colletter).select</code>   .... it may carry over to access"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503516509, "post_id": 45847719, "comment_id": 78653976, "body": "you could open excel from access and ask excel for column number .... <code>debug.Print columns(&quot;abc&quot;).column</code>  returns 731"}], "answers": [{"tags": [], "owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "is_accepted": true, "score": 2, "last_activity_date": 1503517323, "last_edit_date": 1503517323, "creation_date": 1503515920, "answer_id": 45847779, "question_id": 45847719, "link": "https://stackoverflow.com/questions/45847719/convert-column-to-field-order/45847779#45847779", "title": "Convert Column To Field Order", "body": "<p>You are really close. You are going to want to use the ASC() function which returns the ASCII value of a character. When you subtract 64, it will get you the correct column index.</p>\n\n<pre><code>Sub Test()\nDim colletter As String\n    colletter = \"C\"\n    Debug.Print Asc(colletter) - 64\nEnd Sub\n</code></pre>\n\n<p>*EDIT: I've added some controls for multiple letters and to make sure that the letters are upper case. This does, however, limit it to only having two letters, meaning column \"ZZ\" is your last column, but hopefully your user doesn't have more than 702 columns. :)</p>\n\n<pre><code>Sub Test()\nDim colLetter As String\nDim colNumber As Integer\nDim multiplier As Integer\n\ncolLetter = \"AB\"\nmultiplier = 0\n\n'If there is more than one letter, that means it's gone through the whole alphabet\nIf Len(colLetter) &gt; 1 Then\n    multiplier = Asc(Left(UCase(colLetter), 1)) - 64\nEnd If\n\ncolNumber = (multiplier * 26) + Asc(Right(UCase(colLetter), 1)) - 64\nDebug.Print colNumber\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 2, "last_activity_date": 1503518830, "creation_date": 1503518830, "answer_id": 45848460, "question_id": 45847719, "link": "https://stackoverflow.com/questions/45847719/convert-column-to-field-order/45848460#45848460", "title": "Convert Column To Field Order", "body": "<p>Here's another solution that allows any number of letters, such as \"ZZZZ\".  As you can tell, it is quite similar to the post by @BobtimusPrime.</p>\n\n<pre><code>Public Function RowLetterToNumber(ByVal RowLetter As String) As Integer\n   If Len(RowLetter) &gt; 1 Then\n      RowLetterToNumber = RowLetterToNumber(Mid(RowLetter, 2))\n      RowLetterToNumber = RowLetterToNumber + 26\n   Else\n      RowLetterToNumber = Asc(RowLetter) - 64\n   End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1512685218, "creation_date": 1512685218, "answer_id": 47704795, "question_id": 45847719, "link": "https://stackoverflow.com/questions/45847719/convert-column-to-field-order/47704795#47704795", "title": "Convert Column To Field Order", "body": "<p>Sorry, but can't you simply use: <code>=COLUMN()</code></p>\n"}], "owner": {"reputation": 313, "user_id": 7554944, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/86cb2e523c06d16d1e582ec7f05f7bd5?s=128&d=identicon&r=PG&f=1", "display_name": "Yohan Greenburg", "link": "https://stackoverflow.com/users/7554944/yohan-greenburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 45847779, "answer_count": 3, "score": 1, "last_activity_date": 1512685218, "creation_date": 1503515620, "last_edit_date": 1503519167, "question_id": 45847719, "link": "https://stackoverflow.com/questions/45847719/convert-column-to-field-order", "title": "Convert Column To Field Order", "body": "<p>I am importing an excel spreadsheet into access, and requesting the user to input wchich column holds a userid and phone.  Now on the access form, they will be string values, like A &amp; R</p>\n\n<p>I am trying to then convert the alpha value to a number value, but when I use this syntax it is not giving appropriate results.  Such as the below produces <code>@</code> when I would want it to produce <code>3</code> - what is the appropriate way in Access to convert Letters to Column Numbers</p>\n\n<pre><code>Sub Test()\nDim colletter As String\n    colletter = \"C\"\n    Debug.Print Chr(Val(colletter) + 64)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vbscript", "outlook", "outlook-2010"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6722611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ad3bdb1e4cd2aa1e1238a21a9830927?s=128&d=identicon&r=PG&f=1", "display_name": "Rami ", "link": "https://stackoverflow.com/users/6722611/rami"}, "edited": false, "score": 0, "creation_date": 1503519550, "post_id": 45847968, "comment_id": 78655410, "body": "Hey Peter, thanks for posting all that information. I actually should&#39;ve mentioned this in my original post but I was able to create a VBscript code that would add meeting to the default calendar. The portion I could not get was to edit that code and get it to add meetings to a specific calendar. I will however replace the code I managed to put together with the one you posted. This one is much cleaner! Any advice for getting it to post to a different calendar though?"}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 1, "user_id": 6722611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ad3bdb1e4cd2aa1e1238a21a9830927?s=128&d=identicon&r=PG&f=1", "display_name": "Rami ", "link": "https://stackoverflow.com/users/6722611/rami"}, "edited": false, "score": 0, "creation_date": 1503521987, "post_id": 45847968, "comment_id": 78656549, "body": "yes, should be something like &#39;Set objCalendar = objNamespace.GetDefaultFolder(olFolderCalendar).Parent.Folde&zwnj;&#8203;rs(&quot;otherCalendar&quot;)&#39; where otherCalendar would be the name of that other Calendar Folder"}, {"owner": {"reputation": 1, "user_id": 6722611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ad3bdb1e4cd2aa1e1238a21a9830927?s=128&d=identicon&r=PG&f=1", "display_name": "Rami ", "link": "https://stackoverflow.com/users/6722611/rami"}, "edited": false, "score": 0, "creation_date": 1503522552, "post_id": 45847968, "comment_id": 78656790, "body": "Hmm I gave it a shot and was given the following error: &quot;The attempted operation failed. An object could not be found.&quot; I also tried &#39;Set objCalendar = objNamespace.GetDefaultFolder(olFolderCalendar).Folders(&quot;Tes&zwnj;&#8203;t&quot;)&#39; This code ran through but it still added the meeting to the default calendar."}, {"owner": {"reputation": 322, "user_id": 3330093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0C2vx.jpg?s=128&g=1", "display_name": "KS7X", "link": "https://stackoverflow.com/users/3330093/ks7x"}, "edited": false, "score": 0, "creation_date": 1503523246, "post_id": 45847968, "comment_id": 78657083, "body": "Set objCalendar = objNamespace.GetDefaultFolder(test)"}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1503516722, "creation_date": 1503516722, "answer_id": 45847968, "question_id": 45847479, "link": "https://stackoverflow.com/questions/45847479/how-can-i-run-an-outlook-vba-module-in-a-vbscript/45847968#45847968", "title": "How can I run an Outlook VBA module in a VBscript?", "body": "<p>Converting this VBA to VBS shouldn't be that difficult with an example.\nTake a look at <a href=\"http://www.techsupportforum.com/forums/f128/solved-script-to-delete-outlook-calendar-entries-542865.html\" rel=\"nofollow noreferrer\">http://www.techsupportforum.com/forums/f128/solved-script-to-delete-outlook-calendar-entries-542865.html</a>\nUnlike the url suggests there is an example of how to add appointments (holidays in this case) to a Outlook calendart using plain Vbscript.\nI publish the code here in case it vanishes.</p>\n\n<p>You should save your code with the .vbs extension (eg add_calendar_item.vbs) and declare outlook constants in advance. Declaring variables with \"as\" some type isn't possible in vbscript.\nRun the .vbs file in a CMD console using <code>cscript.exe add_calendar_item.vbs</code></p>\n\n<p>To make it easier drop the dictionary and seachAppts part and use only one appointment like in your VBA sample.</p>\n\n<p>Try with this code</p>\n\n<pre><code>Const olFolderCalendar = 9\nConst olAppointmentItem = 1\nConst olOutOfOffice = 3\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objNamespace = objOutlook.GetNamespace(\"MAPI\")\nSet objCalendar = objNamespace.GetDefaultFolder(olFolderCalendar) \nSet objApptItems = objCalendar.Items\n\nobjApptItems.IncludeRecurrences = True\nobjApptItems.Sort \"[Start]\"\n\nSet objHoliday = objOutlook.CreateItem(olAppointmentItem)  \nobjHoliday.Subject = \"Boxing Day\"\nobjHoliday.Start = \"December 26, 2017\" &amp; \" 9:00 AM\"\nobjHoliday.End = \"December 26, 2017\" &amp; \" 10:00 AM\"\nobjHoliday.AllDayEvent = True\nobjHoliday.ReminderSet = False\nobjHoliday.BusyStatus = olOutOfOffice\nobjHoliday.Save\n</code></pre>\n\n<p>For reference here the original code</p>\n\n<pre><code>Const olFolderCalendar = 9\nConst olAppointmentItem = 1\nConst olOutOfOffice = 3\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objNamespace = objOutlook.GetNamespace(\"MAPI\")\nSet objCalendar = objNamespace.GetDefaultFolder(olFolderCalendar) \nSet objApptItems = objCalendar.Items\n\nobjApptItems.IncludeRecurrences = True\nobjApptItems.Sort \"[Start]\"\n\n'' List Appointments to add\nSet objDictionary = CreateObject(\"Scripting.Dictionary\")\nobjDictionary.Add \"November 24, 2010\", \"Thanksgiving\"    \nobjDictionary.Add \"November 25, 2010\", \"Thanksgiving\"    \nobjDictionary.Add \"December 25, 2010\", \"Christmas Day\"\nobjDictionary.Add \"December 26, 2010\", \"Boxing Day\"\nobjDictionary.Add \"November 24, 2011\", \"Thanksgiving\"    \nobjDictionary.Add \"November 25, 2011\", \"Thanksgiving\"    \nobjDictionary.Add \"December 25, 2011\", \"Christmas Day\"\nobjDictionary.Add \"December 26, 2011\", \"Boxing Day\"\n\ncolKeys = objDictionary.Keys\n\nFor Each strKey in colKeys\n  dtmHolidayDate = strKey\n  strHolidayName = objDictionary.Item(strKey)\n  '' Check if it already is on the Calendar\n  Return = SearchAppts(strHolidayName, FormatDateTime(dtmHolidayDate, vbShortDate))\n  If Return = False Then \n    Set objHoliday = objOutlook.CreateItem(olAppointmentItem)  \n    objHoliday.Subject = strHolidayName\n    objHoliday.Start = dtmHolidayDate &amp; \" 9:00 AM\"\n    objHoliday.End = dtmHolidayDate &amp; \" 10:00 AM\"\n    objHoliday.AllDayEvent = True\n    objHoliday.ReminderSet = False\n    objHoliday.BusyStatus = olOutOfOffice\n    objHoliday.Save\n  End If\nNext\n\n'' Search Function\nFunction SearchAppts(ByVal strName, strDate)\n  SearchAppts = False\n  Set objAppointment = objApptItems.GetFirst\n  While TypeName(objAppointment) &lt;&gt; \"Nothing\"\n    If TypeName(objAppointment) = \"AppointmentItem\" then\n      If StrComp(objAppointment, strName,1) = 0 Then\n        If DateDiff(\"D\", objAppointment.Start, strDate) = 0 Then \n          SearchAppts = True\n          Exit Function\n        End If  \n      End If  \n    End If\n    Set objAppointment = objApptItems.GetNext\n  Wend\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6722611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ad3bdb1e4cd2aa1e1238a21a9830927?s=128&d=identicon&r=PG&f=1", "display_name": "Rami ", "link": "https://stackoverflow.com/users/6722611/rami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 979, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593342140, "creation_date": 1503514668, "last_edit_date": 1593342140, "question_id": 45847479, "link": "https://stackoverflow.com/questions/45847479/how-can-i-run-an-outlook-vba-module-in-a-vbscript", "title": "How can I run an Outlook VBA module in a VBscript?", "body": "<p>I've been working on this issue for a couple of hours now. I have a VBA code, and initially I was trying to convert it to a VBscript and just can't seem to do it. \nMy VBA code creates a meeting in outlook in a specific calendar (named Test). This code works perfectly. Now I need the code to run when a command button is clicked in an Outlook Form. VBA modules cant be assigned to buttons in Outlook Forms. So what I would like to do is have a VBscript and call this module. \nI've saved the module in a file path (G:\\3500 EDMFO\\Script). The file is saved as Module3_Working.bas and I'm not sure if the file extension should be something different. I've tried numerous methods that from othe forums with no success. Please advise as to how I can get this macro to work within a VBscript. Thank you.</p>\n\n<pre><code>Sub AddContactsFolder()\n\n\nIf CommandButton1 = False Then\n\nDim myNameSpace As Outlook.NameSpace\nDim myFolder As Outlook.Folder\nDim myNewFolder As Outlook.AppointmentItem\nSet myNameSpace = Application.GetNamespace(\"MAPI\")\nSet myFolder =myNameSpace.GetDefaultFolder(olFolderCalendar).Folders(\"Test\")\nMsgBox myFolder\nSet myNewFolder = myFolder.Items.Add(olAppointmentItem)\n'Set myNewFolder = myFolder.Items.Add(\"Test\")\nWith myNewFolder\n.Subject = \"Time Off\"\n.Start = \"8/23/2017\"\n.AllDayEvent = True\n.ReminderMinutesBeforeStart = \"20\"\n.Save\nEnd With\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1503515540, "post_id": 45847417, "comment_id": 78653463, "body": "Occasionally the VB Project for a worksheet can become corrupted and you may see sheets which are not part of the workbook.  At that point it&#39;s a good idea to copy all your objects (worksheets/modules/forms etc) into a new workbook and use that going forward.  Or maybe try the Rob Bovey&#39;s code cleaner addin.    <a href=\"http://www.appspro.com/Utilities/CodeCleaner.htm\" rel=\"nofollow noreferrer\">appspro.com/Utilities/CodeCleaner.htm</a>"}, {"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1503517188, "post_id": 45847417, "comment_id": 78654266, "body": "Does it show up with <code>Dim ws as Worksheet: For each ws in ActiveWorkbook: Debug.Print ws.Name: Next ws</code>?"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1503518469, "post_id": 45847417, "comment_id": 78654904, "body": "@J.Fox Nope. Looping through each Worksheet in the ThisWorkbook.sheets collection only prints out the name of the other 9 sheets. Looking at the properties dropdown of the ThisWorkbook object does not list Sheet7 as a worksheet object in ThisWorkbook. When I open the Sheet7 codepane and click the Objects dropdown, it shows &quot;Workbook&quot;, and the 2nd drop down shows all the standard workbook events (eg, Workbook_Open, Workbook_SheetChange, etc). Its like Excel thinks Sheet7 is a workbook object."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1503518753, "post_id": 45847417, "comment_id": 78655030, "body": "@TimWilliams Good thought but sadly it didn&#39;t help. I exported all the modules, and it exported code from Sheet7 (which is the code I just created to see WB_Open and WB_Sheetchange). All the hidden header info (as viewed from notepad) for it is just the same as sheet1. I&#39;ll just delete Sheet7.cls and copy/move my sheets to another book as you suggest."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1503519335, "post_id": 45847417, "comment_id": 78655312, "body": "Not sure how it happened but I remember seeing this once.  Here is what I did: Saved modules externally, saved file as <code>.xlsx</code>, closed, opened the new file, saved-as <code>.xlsm</code>, imported modules."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1503533807, "post_id": 45847417, "comment_id": 78660310, "body": "u can clic sheet7 in vbe, unhide it, double clic, it should show in excel as activesheet."}], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503514681, "creation_date": 1503514476, "question_id": 45847417, "link": "https://stackoverflow.com/questions/45847417/sheet7-is-an-excel-object-but-i-have-no-worksheet7", "title": "Sheet7 is an Excel Object, but I have no Worksheet7", "body": "<p>I have a workbook with 9 worksheets, but 10 sheet object in VBA. Somehow, Sheet7 was created in the IDE but not removed when the worksheet was deleted (I think). That is, the tabs at the bottom of my workbook show:</p>\n\n<pre><code>Sheet1\nSheet2\nSheet3\nSheet4\nSheet5\nSheet6\nSheet8\nSheet9\nSheet10\n</code></pre>\n\n<p>However, the Project window of the VBA IDE shows a Microsoft Excel Object for all of those plus <code>Sheet7</code>. I cannot remove the Sheet7 object, and trying to <code>.Activate</code> it gets error 429: ActiveX can't create object. Adding a new worksheet results in Sheet11 being created. Deleting worksheets 6, 8, 9, and 10 leaves Sheet7. Creating new worksheets after that results in worksheets 6, 8, and 9 being created, skipping Sheet7. The list of Methods and Properties as suggested by Intellisense is much shorter than the methods and properties available to a \"real\" worksheet. For example, there is no <code>.Visible</code> property, so <code>Sheet7.Visible = xlSheetVisible</code> returns an error that Method or data member not found.</p>\n\n<p>How do I fix this? </p>\n"}, {"tags": ["vba", "excel", "pdf"], "answers": [{"comments": [{"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1503557910, "post_id": 45848840, "comment_id": 78667500, "body": "Perfect, that does the job. Where there are two PDFs files, only the one that I have open previously in PDFExtract is closed. But this is actually perfect. Thanks very much."}], "tags": [], "owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "is_accepted": true, "score": 1, "last_activity_date": 1503520463, "creation_date": 1503520463, "answer_id": 45848840, "question_id": 45847415, "link": "https://stackoverflow.com/questions/45847415/pdf-to-excel-error-when-closing-pdf-file/45848840#45848840", "title": "PDF to Excel error when closing PDF file", "body": "<p>Under your <code>Function ShellExecute</code>, add these two:</p>\n\n<pre><code>Private Declare Function FindWindow Lib \"user32.dll\" Alias \"FindWindowA\" _\n        (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nPrivate Declare Function SendMessage Lib \"user32.dll\" Alias \"SendMessageA\" _\n        (ByVal hWnd As Long, ByVal Msg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long\n</code></pre>\n\n<p>And then here is the <code>TerminateApp</code> code:</p>\n\n<pre><code>Dim hWnd As Long\nDim nRet As Long\n\nConst WM_CLOSE As Long = &amp;H10\n\nhWnd = FindWindow(\"AcrobatSDIWindow\", vbNullString)\n\nIf hWnd &lt;&gt; 0 Then\n    nRet = SendMessage(hWnd, WM_CLOSE, 0, 0)\nEnd If\n</code></pre>\n\n<p>Try and let me know if this works or not.</p>\n\n<p>P.S. I only tested with one PDF open and close.</p>\n"}], "owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 45848840, "answer_count": 1, "score": 1, "last_activity_date": 1503520463, "creation_date": 1503514473, "last_edit_date": 1503519418, "question_id": 45847415, "link": "https://stackoverflow.com/questions/45847415/pdf-to-excel-error-when-closing-pdf-file", "title": "PDF to Excel error when closing PDF file", "body": "<p>I have a code to transfer PDF files to Excel but I'm getting an error message in one of the lines and I don't know why.</p>\n\n<p>I'm able to extract and paste the data from the PDF correctly, the problem is when trying to close the PDF file.</p>\n\n<p>The code I'm using is as follows:</p>\n\n<pre><code>Private Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" _\n (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, _\n ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long\n\nSub PDFExtract()\n\n' Get name of Excel file\nTemplateName = ThisWorkbook.Name\n\nDim oW As Worksheet: Set oW = ThisWorkbook.Worksheets(\"Temp\")\nFileToOpen = \"c:\\text.pdf\"\nShellExecute 0, \"Open\", FileToOpen, \"\", \"\", vbNormalNoFocus\nnum = ShellExecute(0, \"Open\", FileToOpen, \"\", \"\", vbNormalNoFocus)\n\n' wait 2 secs\nApplication.Wait Now + TimeValue(\"00:00:2\")\n\n' select all using ctrl a\nSendKeys \"^a\", True\n\n' wait 2 secs\nApplication.Wait Now + TimeValue(\"00:00:2\")\n\n' copy all using ctrl c\nSendKeys \"^c\"\n\n' wait 2 secs\nApplication.Wait Now + TimeValue(\"00:00:2\")\n\n' activate this wokbook\nWindows(TemplateName).Activate\nSheets(\"Temp\").Select\nRange(\"B7\").Select\nActiveSheet.Paste\n\nCall TerminateApp ' The problem in the code for TerminateApp\nEnd sub\n</code></pre>\n\n<p>So far so good. Now the TerminateApp code where I have the problem</p>\n\n<pre><code>Sub TerminateApp()\n\nDim strTerminateThis As String\n\nDim objWMIcimv2 As Object, objProcess As Object, objList As Object\nDim intError As Integer\n\nstrTerminateThis = \"AcroRd32.exe\"\n\nSet objWMIcimv2 = GetObject(\"winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\cimv2\")\nSet objList = objWMIcimv2.ExecQuery(\"select * from win32_process where name='\" &amp; strTerminateThis &amp; \"'\")\nFor Each objProcess In objList\n    intError = objProcess.Terminate '&lt;&lt;&lt; Here is where I get the error message\n    If intError &lt;&gt; 0 Then Exit For\nNext\n\n'ALL instances of exe (strTerminateThis) have been terminated\nSet objWMIcimv2 = Nothing\nSet objList = Nothing\nSet objProcess = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I've highlighted above where I'm getting the error message. The error message I'm getting is: Run-time error '-2147217406 (80041002): Not found</p>\n\n<p>What I found strange is that:</p>\n\n<ul>\n<li>The PDF file has been closed  </li>\n<li>If I step over the line, the program\ncontinues with no error </li>\n<li>If I have another PDF file open, it closes\nboth and does not give an error message</li>\n</ul>\n\n<p>It looks like it closes the PDF file and then tries to look for it but does not find it. Any ideas why the error appears and how to resolve the problem?</p>\n\n<p>I tried to modify the code as per example <a href=\"https://stackoverflow.com/questions/44167647/terminating-all-explorer-instances-via-vba-excel\">here</a> from <a href=\"https://stackoverflow.com/users/7047935/smartobelix\">smartbelix</a> but it didn't work:</p>\n\n<pre><code>Do\n    Set objWMIcimv2 = GetObject(\"winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\cimv2\")\n    Set objList = objWMIcimv2.ExecQuery(\"select * from win32_process where name='\" &amp; strTerminateThis &amp; \"'\")\n    If objList.Count &gt; 0 Then\n        For Each objProcess In objList\n            intError = objProcess.Terminate 'Terminates a process and all of its threads.\n            'Return value is 0 for success. Any other number is an error.\n            If intError &lt;&gt; 0 Then Exit For\n        Next\n    End If\nLoop While objList.Count &gt; 0\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503514331, "post_id": 45847302, "comment_id": 78652845, "body": "Im assuming it has to be something with how the path to the file is written because The error message reads:  <code>Run-Time error &#39;5152&#39;: This is not a valid file name. Try one or more of the following: *Check the path to make sure it was typed coerrectly. *Select a file from the list of files and folders.</code>"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 1, "creation_date": 1503516668, "post_id": 45847302, "comment_id": 78654052, "body": "First of all, is <code>assessment rubrics</code> a folder name or first words of your file name? If it is a folder name, then you should change it to <code>&quot;E:\\assessment rubrics\\&quot;</code>. Also change fileformat to <code>fileformat:=wdFormatXMLDocument</code> since it has a <code>docx</code> extension."}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1503517744, "post_id": 45847302, "comment_id": 78654527, "body": "@Tehscript I did what you said, but it is still giving the 5152 error"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1503518320, "post_id": 45847302, "comment_id": 78654829, "body": "Can you debug.print Fullname and share with us? It might still have restricted characters in it even if you think you replaced all of them."}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1503518699, "post_id": 45847302, "comment_id": 78655004, "body": "When I do that it puts out:             E:\\assessment_rubrics\\Templates\\Program: Art-Studio Art BFA - Academic Program Review - 8/23/2017 3:04:28 PM.docx"}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1503518779, "post_id": 45847302, "comment_id": 78655036, "body": "Could the : after the word &quot;Program be causing it?"}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503519301, "post_id": 45848504, "comment_id": 78655289, "body": "I&#39;ve never used a function before, so would I add the function into my code or would I create a new module, add it there, and then call it using the second part you posted?"}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503519397, "post_id": 45848504, "comment_id": 78655339, "body": "Thank you! Ill get to work on getting it put in there and hopefully everything runs smooth!"}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503519816, "post_id": 45848504, "comment_id": 78655530, "body": "I believe the 5152 error is resolved but now it says i cannot save because of a file permission error."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503520025, "post_id": 45848504, "comment_id": 78655637, "body": "@Cocoberry2526 It should be also related to an illegal character. Can you debug.print Fullname again?"}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503520139, "post_id": 45848504, "comment_id": 78655686, "body": "This is what it puts out: E  assessment rubrics Program  Art-Teaching Certif BA BS  - Academic Program Review - 8 23 2017 3 28 38 PM.docx"}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503520192, "post_id": 45848504, "comment_id": 78655713, "body": "It doesn&#39;t show it in the comment but there is also some kind of little black bullet point after the BA BS part. I didn&#39;t know if that meant anything"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503520364, "post_id": 45848504, "comment_id": 78655809, "body": "@Cocoberry2526 yeah sure I did not pay attention to that. Please try the updated code. If you still have the same permission error I can think of a solution."}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503520829, "post_id": 45848504, "comment_id": 78656005, "body": "I replaced the code and now its giving the 5152 error again. The debug.print Fullname is putting out E:\\assessment rubrics\\Program  Art-Studio Art BA BS  - Academic Program Review - 8 23 2017 3 39 48 PM.docx    with a bullet point after the BA BS"}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503521276, "post_id": 45848504, "comment_id": 78656221, "body": "I tried the new code and the file permission error is back, the debug.print Fullname shows E:\\assessment_rubrics\\Program  Creative Writing BFA  - Academic Program Review - 8 23 2017 3 45 47 PM.docx  with no bullet point."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503521590, "post_id": 45848504, "comment_id": 78656380, "body": "@Cocoberry2526 I see where the problem is. You are declaring your filename with folder names. You should avoid this.If the folder name is dynamic then declare it separately and filename separately as well. I will update my code, and you can change it according to your needs."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503522476, "post_id": 45848504, "comment_id": 78656755, "body": "@Cocoberry2526 I updated the code. Well I did it supposing the <code>ActiveDocument.Paragraphs(1).Range.Text</code> is <code>Templates\\Program: Art-Studio Art BFA</code>. I can see you have other dynamic folders like <code>Program</code>. The best practice is separating folderpath and filename. But if you cannot do that, a workaround might be to change the Const str in the function like this <code>Const str = &quot;&#47;|?*&lt;&gt;&quot;&quot;:&quot;</code>"}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503522509, "post_id": 45848504, "comment_id": 78656772, "body": "it is still giving the permission error, was I supposed to change anything in the code? It all looked right to me for how I had things named."}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503522588, "post_id": 45848504, "comment_id": 78656812, "body": "I just saw your other comment, Program actually isn&#39;t a folder name but its apart of the text where the next part comes from."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1503522658, "post_id": 45848504, "comment_id": 78656840, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/152680/discussion-between-tehscript-and-cocoberry2526\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 0, "last_activity_date": 1503523292, "last_edit_date": 1503523292, "creation_date": 1503519054, "answer_id": 45848504, "question_id": 45847302, "link": "https://stackoverflow.com/questions/45847302/ms-word-vba-saving-file-runtime-error-5152/45848504#45848504", "title": "MS Word VBA: Saving File, runtime error 5152", "body": "<p>cvtstr(These characters /|?*&lt;>:\"\\ are not allowed in your filename. Use the function below:</p>\n\n<pre><code>Function cvtstr(strIn As String) As String\n    Dim i As Integer\n\n    Const str = \"\\/|?*&lt;&gt;\"\":\"\n    cvtstr = strIn\n    For i = 1 To Len(str)\n        cvtstr = Replace(cvtstr, Mid$(str, i, 1), \" \")\n    Next i\nEnd Function\n</code></pre>\n\n<p>and then your code should be:</p>\n\n<pre><code>    Dim filename As String, Fullname As String, Mask As String, filepath As String\n    .\n    .\n    .\n    filename = cvtstr(Replace(ActiveDocument.Paragraphs(1).Range.Text, \"Templates\\\", \"\")) 'this part is temporary solution. You actually need to distinguish filepath and filename in ActiveDocument.Paragraphs(1).Range.Text    \n    filename = Left(filename, Len(filename) - 1) &amp; \" - Academic Program Review - \" &amp; cvtstr(Format(Now(), Mask)))\n\n    filepath = \"E:\\assessment_rubrics\\Templates\\\"\n\n    FullName = filepath &amp; filename &amp; \".docx\"\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>It is not a good practice to combine filepath and filename, but since you extract it from the paragraph, until you find a better solution to improve your code, you can do the following:</p>\n\n<p>Use the function below:</p>\n\n<pre><code>Function cvtstr(strIn As String) As String\n    Dim i As Integer\n\n    Const str = \"/|?*&lt;&gt;\"\":\"\n    cvtstr = strIn\n    For i = 1 To Len(str)\n        cvtstr = Replace(cvtstr, Mid$(str, i, 1), \" \")\n    Next i\nEnd Function\n</code></pre>\n\n<p>and use the following lines in your code</p>\n\n<pre><code>Filename = cvtstr(ActiveDocument.Paragraphs(1).Range.Text)\nFilename = Left(Filename, Len(Filename) - 1)\nextension = \".docx\"\nDocName = \"E:\\assessment rubrics\\\" &amp; Filename &amp; \" - Academic Program Review - \" &amp; cvtstr(Format(Now(), Mask)))\nFullName = DocName &amp; extension\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "is_accepted": false, "score": 0, "last_activity_date": 1503666565, "last_edit_date": 1503666565, "creation_date": 1503523663, "answer_id": 45849549, "question_id": 45847302, "link": "https://stackoverflow.com/questions/45847302/ms-word-vba-saving-file-runtime-error-5152/45849549#45849549", "title": "MS Word VBA: Saving File, runtime error 5152", "body": "<p>This is what my code looks like right now </p>\n\n<pre><code>Function cvtstr(strIn As String) As String\n    Dim i As Integer\n\n    Const str = \"/|?*&lt;&gt;\"\":\"\n    cvtstr = strIn\n    For i = 1 To Len(str)\n        cvtstr = Replace(cvtstr, Mid$(str, i, 1), \" \")\n    Next i\nEnd Function\n\n\nSub Splitter()\n\n' splitter Macro\n\n' Macro created by Doug Robbins to save each letter created by a mailmergeas a separate file.\nApplication.ScreenUpdating = False\nDim Program As String\nDim DocName As String\nDim Letters As Integer, Counter As Integer\nDim filename, extension, Fullname, filepath, Mask As String\n\nLetters = ActiveDocument.Sections.Count\nSelection.HomeKey Unit:=wdStory\nCounter = 1\nWhile Counter &lt; Letters\n'program =  ActiveDocument.MailMerge.DataSource.DataFields(\"Program_Outcomes_PlanReport_Name\").Value\nDocName = \"Reports\" &amp; LTrim$(str$(Counter))  'Generic name of document\nActiveDocument.Sections.First.Range.Cut\nDocuments.Add\nSelection.Paste\n'ActiveDocument.Sections(2).PageSetup.SectionStart = wdSectionContinuous\n\nFilename = cvtstr(ActiveDocument.Paragraphs(1).Range.Text)\nFilename = Left(Filename, Len(Filename) - 1)\nextension = \".docx\"\nDocName = \"E:\\assessment rubrics\\\" &amp; Filename &amp; \" - Academic Program Review - \" &amp; cvtstr(Format(Now(), Mask)))\nFullName = DocName &amp; extension\n\nActiveDocument.SaveAs filename:=Fullname, fileformat:=wdFormatXMLDocument, AddToRecentFiles:=False\n\nActiveWindow.Close\nCounter = Counter + 1\nWend\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3931, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1503666565, "creation_date": 1503514052, "question_id": 45847302, "link": "https://stackoverflow.com/questions/45847302/ms-word-vba-saving-file-runtime-error-5152", "title": "MS Word VBA: Saving File, runtime error 5152", "body": "<p>I posted a question recently about getting my mail merge document to split and save. After finding some code online, I was able to combine it with my own code to get the document to split and create a name that I wanted. However, now when the code goes to save the document, it puts out a 5152 error, and I have no clue on how to go about it. This is what my code looks like and the error occurs at the ActiveDocument.SaveAs filename:=Fullname, fileformat:=wdFormatDocumentDefault, AddToRecentFiles:=False</p>\n\n<pre><code>Option Explicit\n\nSub Splitter()\n\n' splitter Macro\n\n' Macro created by Doug Robbins to save each letter created by a mailmergeas a separate file.\nApplication.ScreenUpdating = False\nDim Program As String\nDim DocName As String\nDim Letters As Integer, Counter As Integer\nDim filename, extension, Fullname, Mask As String\n\nLetters = ActiveDocument.Sections.Count\nSelection.HomeKey Unit:=wdStory\nCounter = 1\nWhile Counter &lt; Letters\n'program = ActiveDocument.MailMerge.DataSource.DataFields(\"Program_Outcomes_PlanReport_Name\").Value\nDocName = \"Reports\" &amp; LTrim$(Str$(Counter))  'Generic name of document\nActiveDocument.Sections.First.Range.Cut\nDocuments.Add\nSelection.Paste\nActiveDocument.Sections(2).PageSetup.SectionStart = wdSectionContinuous\n\nfilename = ActiveDocument.Paragraphs(1).Range.Text\n            filename = Replace(filename, Chr$(13), \"\")\n            filename = Replace(filename, Chr$(10), \"\")\n            filename = Replace(filename, \"/\", \"_\")\n            filename = Replace(filename, \"&amp;\", \"_\")\n            extension = \".docx\"\n            DocName = \"E:\\assessment rubrics\" &amp; filename &amp; \" - Academic Program Review - \" &amp; Format(Now(), Mask)\n            Fullname = DocName &amp; extension\n\nActiveDocument.SaveAs filename:=Fullname, fileformat:=wdFormatDocumentDefault, AddToRecentFiles:=False\nActiveWindow.Close\nCounter = Counter + 1\nWend\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "is_accepted": false, "score": 0, "last_activity_date": 1503514490, "creation_date": 1503514490, "answer_id": 45847419, "question_id": 45847253, "link": "https://stackoverflow.com/questions/45847253/how-to-auto-sort-multiple-sheets-using-vba-in-excel/45847419#45847419", "title": "How to Auto Sort Multiple Sheets Using VBA in excel", "body": "<p>Im assuming you have a basic understanding of macros and subs....</p>\n\n<ul>\n<li>Add the Develeper Tab:<a href=\"https://support.office.com/en-us/article/Show-the-Developer-tab-e1192344-5e56-4d45-931b-e5fd9bea2d45\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Show-the-Developer-tab-e1192344-5e56-4d45-931b-e5fd9bea2d45</a></li>\n<li><p>Open Visual Basic</p></li>\n<li><p>Insert a combo box on your excel document anywhere you want</p></li>\n<li>Title your sub or function <strong><em>comboboxname</em>_change</strong></li>\n</ul>\n\n<p>Your sub will run whenever an option is selected.</p>\n"}], "owner": {"reputation": 1, "user_id": 8507891, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--CkRvcamxbc/AAAAAAAAAAI/AAAAAAAAAJA/3Q-_NlFIrp4/photo.jpg?sz=128", "display_name": "Wade Adeogun", "link": "https://stackoverflow.com/users/8507891/wade-adeogun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503519239, "creation_date": 1503513891, "last_edit_date": 1503519239, "question_id": 45847253, "link": "https://stackoverflow.com/questions/45847253/how-to-auto-sort-multiple-sheets-using-vba-in-excel", "title": "How to Auto Sort Multiple Sheets Using VBA in excel", "body": "<p>I am trying to sort multiple sheets in excel using a Macro or VBA in excel. In addition I want a drop down menu to trigger the search. anyone know how to set this up?</p>\n"}, {"tags": ["vba", "image", "excel", "transparency", "userform"], "answers": [{"tags": [], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "is_accepted": false, "score": 0, "last_activity_date": 1503513743, "creation_date": 1503513743, "answer_id": 45847206, "question_id": 45847205, "link": "https://stackoverflow.com/questions/45847205/load-image-with-alpha-transparency-onto-a-userform-from-a-filepath/45847206#45847206", "title": "Load image with alpha transparency onto a userform from a filepath", "body": "<p>For reference, in case there isn't a copy on SO somewhere else: here is a function which can be used in place of LoadPicture to apply an image to an Image Control on a userform. It supports 1 bit transparency only (I.e. pixel is visible or it isn't)</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\n''' User-Defined Types for API Calls\n\n'Declare a UDT to store a GUID for the IPicture OLE Interface\nPrivate Type GUID\n    Data1 As Long\n    Data2 As Integer\n    Data3 As Integer\n    Data4(0 To 7) As Byte\nEnd Type\n\n'Declare a UDT to store the bitmap information\nPrivate Type uPicDesc\n    Size As Long\n    Type As Long\n    hPic As Long\n    hPal As Long\nEnd Type\n\n'''Windows API Function Declarations\n\n'Does the clipboard contain a bitmap/metafile?\nPrivate Declare Function IsClipboardFormatAvailable Lib \"user32\" ( _\n                         ByVal wFormat As Integer) As Long\n\n'Open the clipboard to read\nPrivate Declare Function OpenClipboard Lib \"user32\" ( _\n                         ByVal hwnd As Long) As Long\n\n'Get a pointer to the bitmap/metafile\nPrivate Declare Function GetClipboardData Lib \"user32\" ( _\n                         ByVal wFormat As Integer) As Long\n\n'Close the clipboard\nPrivate Declare Function CloseClipboard Lib \"user32\" () As Long\n\n'Convert the handle into an OLE IPicture interface.\nPrivate Declare Function OleCreatePictureIndirect Lib \"olepro32.dll\" ( _\n                         PicDesc As uPicDesc, RefIID As GUID, _\n                         ByVal fPictureOwnsHandle As Long, IPic As IPicture) As Long\n\n'Create our own copy of the metafile, so it doesn't get _\n'wiped out by subsequent clipboard updates.\nDeclare Function CopyEnhMetaFile Lib \"gdi32\" Alias \"CopyEnhMetaFileA\" ( _\n        ByVal hemfSrc As Long, ByVal lpszFile As String) As Long\n\n'Create our own copy of the bitmap, so it doesn't get wiped out by\n'subsequent\n'clipboard updates.\nDeclare Function CopyImage Lib \"user32\" (ByVal handle As Long, _\n                                         ByVal un1 As Long, ByVal n1 As Long, ByVal n2 As Long, _\n                                         ByVal un2 As Long) As Long\n\n'The API format types we're interested in\nConst CF_BITMAP = 2\nConst CF_PALETTE = 9\nConst CF_ENHMETAFILE = 14\nConst IMAGE_BITMAP = 0\nConst LR_COPYRETURNORG = &amp;H4\n\nFunction PastePicture(Optional lXlPicType As Long = xlPicture) As IPicture\n    'Some pointers\n    Dim h As Long, hPicAvail As Long, hPtr As Long, hPal As Long\n    Dim lPicType As Long, hCopy As Long\n\n    'Convert xl piture-type constant to the API constant equivalent\n    lPicType = IIf(lXlPicType = xlBitmap, CF_BITMAP, CF_ENHMETAFILE)\n\n    'Check if the clipboard contains the required format\n    hPicAvail = IsClipboardFormatAvailable(lPicType)\n\n    If hPicAvail &lt;&gt; 0 Then\n        'Get access to the clipboard\n        h = OpenClipboard(0&amp;)\n\n        If h &gt; 0 Then\n            'Get a handle to the image data\n            hPtr = GetClipboardData(lPicType)\n\n            'Create our own copy of the image on the clipboard, in the appropriate format.\n            If lPicType = CF_BITMAP Then\n                hCopy = CopyImage(hPtr, IMAGE_BITMAP, 0, 0, LR_COPYRETURNORG)\n            Else\n                hCopy = CopyEnhMetaFile(hPtr, vbNullString)\n            End If\n\n            'Release the clipboard to other programs\n            h = CloseClipboard\n\n            'If we got a handle to the image, convert it into a Picture object and return it\n            If hPtr &lt;&gt; 0 Then Set PastePicture = CreatePicture(hCopy, 0, lPicType)\n        End If\n    End If\n\nEnd Function\n\nPrivate Function CreatePicture(ByVal hPic As Long, ByVal hPal As Long, _\n                               ByVal lPicType) As IPicture\n\n    ' IPicture requires a reference to \"OLE Automation\"\n    Dim r As Long, uPicInfo As uPicDesc, IID_IDispatch As GUID, IPic As IPicture\n\n    'OLE Picture types\n    Const PICTYPE_BITMAP = 1\n    Const PICTYPE_ENHMETAFILE = 4\n\n    ' Create the Interface GUID (for the IPicture interface)\n    With IID_IDispatch\n        .Data1 = &amp;H7BF80980\n        .Data2 = &amp;HBF32\n        .Data3 = &amp;H101A\n        .Data4(0) = &amp;H8B\n        .Data4(1) = &amp;HBB\n        .Data4(2) = &amp;H0\n        .Data4(3) = &amp;HAA\n        .Data4(4) = &amp;H0\n        .Data4(5) = &amp;H30\n        .Data4(6) = &amp;HC\n        .Data4(7) = &amp;HAB\n    End With\n\n    ' Fill uPicInfo with necessary parts.\n    With uPicInfo\n        .Size = Len(uPicInfo)\n        .Type = IIf(lPicType = CF_BITMAP, PICTYPE_BITMAP, PICTYPE_ENHMETAFILE)\n        .hPic = hPic\n        .hPal = IIf(lPicType = CF_BITMAP, hPal, 0)\n    End With\n\n    ' Create the Picture object.\n    r = OleCreatePictureIndirect(uPicInfo, IID_IDispatch, True, IPic)\n\n    ' If an error occured, show the description\n    If r &lt;&gt; 0 Then\n        'Debug.Print \"Create Picture: \" &amp; fnOLEError(r)\nDebug.Print \"Error, call fnOLEError(r) here\"\n        ' fnOLEError from modPastePicture not posted\n    End If\n\n    ' Return the new Picture object.\n    Set CreatePicture = IPic\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://www.pcreview.co.uk/threads/putting-a-picture-onto-a-userform-without-using-the-vba-window.3930506/\" rel=\"nofollow noreferrer\">Source with minor edits</a></p>\n\n<p><a href=\"http://www.oaltd.co.uk/excel/\" rel=\"nofollow noreferrer\">Original source</a> is Stephen Bullen's pastePicture.zip</p>\n\n<p>use like:</p>\n\n<pre><code>Set myImageControl.Picture = PastePicture\n</code></pre>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2414, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503513743, "creation_date": 1503513743, "question_id": 45847205, "link": "https://stackoverflow.com/questions/45847205/load-image-with-alpha-transparency-onto-a-userform-from-a-filepath", "title": "Load image with alpha transparency onto a userform from a filepath", "body": "<p>I would like to place an image into a VBA UserForm image control, and preserve its transparency (either 1-bit on-off transparency like an ico file has, or better; full alpha channel transparency like a png can have).</p>\n\n<p>That is, portions of the image which are transparent in the original file are also see-through on my userform, so I can overlay images for example.</p>\n\n<hr>\n\n<p>First of all, I couldn't find an answer on SO, so I had to look on <em>other</em> forums. I found 1 method which supports 1-bit on/off transparency, I'll post it as an answer so now it can be found more easily here.</p>\n\n<p>But the method I've found loads pictures from the clipboard, meaning to load from a filepath I have to</p>\n\n<pre><code>ActiveSheet.Pictures.Insert(\"[filepath]\").Cut\nmyUserform.someImageControl.Picture = PastePicture\n</code></pre>\n\n<p>Which seems slow and convoluted, and also wipes the clipboard, so I'm wondering if there's a good way to load transparent pictures to a userform from a filepath (without using clipboard)?</p>\n\n<hr>\n\n<p>The second point is that the current code I have looks awful (the results that is, although the code itself is a bit messy). To get better results, I'm surprised there's not some framework I can reference which returns an <code>IPictureDisp</code> with transparency.</p>\n\n<p>The <em>Windows Image Aquisition Library v2.0</em> (<code>wiaaut.dll</code>) can be used to load pngs to a control - e.g.</p>\n\n<pre><code>Function loadImg(fileLocation As String) As IPictureDisp\nDim imgctrl As New WIA.ImageFile         'can handle more extensions than built in LoadPicture function\nWith imgctrl\n    .LoadFile fileLocation\n    Set loadImg = .fileData.Picture\nEnd With\nSet imgctrl = Nothing\nEnd Function\n</code></pre>\n\n<p>However it removes the transparency which is no good. So I'm asking this question to pool resources on what alternate methods people are aware of (if any), and which provide the best results?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1503511733, "post_id": 45846607, "comment_id": 78651380, "body": "You cannot do that with Type:=8, it will display the address.  Also consider what happens if a user selects more than 1 cell."}, {"owner": {"reputation": 245, "user_id": 5531672, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2425e2c5670e7bc1f4d5de41d33292c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5531672/jack"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1503512072, "post_id": 45846607, "comment_id": 78651575, "body": "I&#39;m just trying to select 1 cell no more. I understand I did range but how is it reworked to single cell? and does Type:=2 display that after I switch to single cell?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503515121, "post_id": 45846607, "comment_id": 78653248, "body": "why did you omit the sub name from your code?"}], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 5531672, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2425e2c5670e7bc1f4d5de41d33292c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5531672/jack"}, "edited": false, "score": 0, "creation_date": 1503513418, "post_id": 45846984, "comment_id": 78652318, "body": "I don&#39;t really want to ouput a message box I just want to display what they clicked on inside the input box. I understand what you explained though and makes sense for anyone trying to do it that way."}, {"owner": {"reputation": 1822, "user_id": 624292, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4fd8cadbf9c2cf573b13c7f53fc5fd43?s=128&d=identicon&r=PG", "display_name": "M_Idrees", "link": "https://stackoverflow.com/users/624292/m-idrees"}, "reply_to_user": {"reputation": 245, "user_id": 5531672, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2425e2c5670e7bc1f4d5de41d33292c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5531672/jack"}, "edited": false, "score": 0, "creation_date": 1503513563, "post_id": 45846984, "comment_id": 78652414, "body": "OK, then whats the problem. By using MsgBox I just tried to show, how you can get value from cell, i.e. <code>sDate.Value</code>."}], "tags": [], "owner": {"reputation": 1822, "user_id": 624292, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4fd8cadbf9c2cf573b13c7f53fc5fd43?s=128&d=identicon&r=PG", "display_name": "M_Idrees", "link": "https://stackoverflow.com/users/624292/m-idrees"}, "is_accepted": false, "score": 0, "last_activity_date": 1503512862, "creation_date": 1503512862, "answer_id": 45846984, "question_id": 45846607, "link": "https://stackoverflow.com/questions/45846607/input-box-vba-displaying-cell-number-instead-of-value/45846984#45846984", "title": "Input box vba displaying cell number instead of value", "body": "<p>What I understand that you need to take input from user, and assuming that only single cell will be provided. And you need to retrieve selected cell's value and set it's font style to bold. </p>\n\n<p>You can achieve this by first get selected cell reference, use <code>Font</code> property to set any font styles and read its <code>Value</code> property to get its content.</p>\n\n<pre><code> Set sDate = Application.InputBox(Prompt:= _\n            \"Please select start date.\", _\n                Title:=\"Start Date\", Type:=8)\n\n    sDate.Font.Bold = True\n    MsgBox (\"Selected cell's value is: \" &amp; sDate.Value)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 245, "user_id": 5531672, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2425e2c5670e7bc1f4d5de41d33292c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5531672/jack"}, "edited": false, "score": 0, "creation_date": 1503513508, "post_id": 45846993, "comment_id": 78652371, "body": "Thank You, but I am just trying to put what the user clicked on inside the input box, it already does that but what it puts inside the input box the format is wrong."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 245, "user_id": 5531672, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2425e2c5670e7bc1f4d5de41d33292c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5531672/jack"}, "edited": false, "score": 1, "creation_date": 1503513775, "post_id": 45846993, "comment_id": 78652531, "body": "@AngatvirSanghera - AFAIK that&#39;s not possible with <code>InputBox</code>.  You might be able to do that with a userform."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1503512894, "creation_date": 1503512894, "answer_id": 45846993, "question_id": 45846607, "link": "https://stackoverflow.com/questions/45846607/input-box-vba-displaying-cell-number-instead-of-value/45846993#45846993", "title": "Input box vba displaying cell number instead of value", "body": "<p>How does this work for you?</p>\n\n<pre><code>Sub bold_Date()\nDim sDate   As Range\nOn Error Resume Next\nApplication.DisplayAlerts = False\nSet sDate = Application.InputBox(Prompt:=\"Please select start date.\", Title:=\"Start Date\", Type:=8)\n\nIf sDate.Cells.Count &gt; 1 Then Set sDate = sDate.Cells(1, 1)\nMsgBox (\"Date is: \" &amp; sDate.Text)\n\nApplication.DisplayAlerts = True\n\nIf sDate Is Nothing Then\n    Exit Sub\nElse\n    sDate.Font.Bold = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>It will put a messagebox with the date, after selecting a range.  Also, it has a check for multiple cells. If multiple cells are selected, it uses the first cell in that range as your new <code>sDate</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1503514432, "creation_date": 1503514432, "answer_id": 45847401, "question_id": 45846607, "link": "https://stackoverflow.com/questions/45846607/input-box-vba-displaying-cell-number-instead-of-value/45847401#45847401", "title": "Input box vba displaying cell number instead of value", "body": "<p>Another answer is to use a UserForm.</p>\n\n<p>Create a userform, such as this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lKEKZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lKEKZ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Notes: The \"Ok\" button is named \"Ok\", and the white text box is \"dateBox\"</p>\n\n<p>For the Form Code, use:</p>\n\n<pre><code>Private Sub Ok_Click()\nActiveCell.Font.Bold = True\nUserForm1.Hide\nEnd Sub\n</code></pre>\n\n<p>Then in the <em>Worksheet</em> module, put this:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Cells.Count = 1 Then UserForm1.dateBox.Value = Target.Value\nEnd Sub\nSub bold_Date2()\nUserForm1.Show vbModeless\nEnd Sub\n</code></pre>\n\n<p>Then run the <code>bold_date2()</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uDEAM.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uDEAM.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 245, "user_id": 5531672, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2425e2c5670e7bc1f4d5de41d33292c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5531672/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 0, "accepted_answer_id": 45847401, "answer_count": 3, "score": 0, "last_activity_date": 1503514432, "creation_date": 1503511484, "question_id": 45846607, "link": "https://stackoverflow.com/questions/45846607/input-box-vba-displaying-cell-number-instead-of-value", "title": "Input box vba displaying cell number instead of value", "body": "<p>I have the following code which prompts the user to click on a cell value.</p>\n\n<pre><code>Dim sDate As Range\nOn Error Resume Next\n    Application.DisplayAlerts = False\n        Set sDate = Application.InputBox(Prompt:= _\n            \"Please select start date.\", _\n                Title:=\"Start Date\", Type:=8)\nOn Error GoTo 0\n    Application.DisplayAlerts = True\n    If sDate Is Nothing Then\n        Exit Sub\n    Else\n        sDate.Font.Bold = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>The input box however once a value is selected lets say for example I click on b3 displays $b$3. I want to display the value that's inside $b$3. For example if 17-Jun was inside $b$3 it should display 17-Jun and not $b$3 in the input box.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8507585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8bced4c1c793b043bf0c603bd5aa25?s=128&d=identicon&r=PG", "display_name": "Dennis", "link": "https://stackoverflow.com/users/8507585/dennis"}, "is_accepted": false, "score": 0, "last_activity_date": 1503512984, "creation_date": 1503512984, "answer_id": 45847014, "question_id": 45846559, "link": "https://stackoverflow.com/questions/45846559/vba-dynamic-range-for-formulas/45847014#45847014", "title": "VBA dynamic range for formulas", "body": "<p>Sounds like you are refreshing data monthly and need to have formulas in the columns to the right of the data.  The issue is how to determine which rows to put formulas in.  Short answer is put code into the ThisWorkBook!Workbook_Open() sub to delete the range from row BF2 to BG500 (since that's the max range), then copy the formula from row 2 to the number of rows that you have data in.  You mentioned LastRow so I assume you know how to do this.  Do you need sample code or is this enough to get you started?</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8138935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9efc3be76a92df2a3f126ca90ec66924?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/8138935/brian"}, "edited": false, "score": 0, "creation_date": 1503602415, "post_id": 45847018, "comment_id": 78697629, "body": "This is great - thanks! One more question for you, how do I make it so I can use &quot;Dim lastRow As Long Dim ws As WorksheetSet ws = ActiveSheet Worksheets(&quot;Sheet1&quot;) lastRow = ws.Cells(ws.Rows.Count, &quot;A&quot;).End(xlUp).Row&quot; across other modules? Is there a way to set this to public? If it can&#39;t be used in other modules, I can just move formulas all into one module. Right now my formulas with range X2:XX500 are in multiple modules."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 27, "user_id": 8138935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9efc3be76a92df2a3f126ca90ec66924?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/8138935/brian"}, "edited": false, "score": 0, "creation_date": 1503603165, "post_id": 45847018, "comment_id": 78697978, "body": "just make a public variable.  On top of one the module put <code>Public lastrow as Long</code>  Then in the sub remove the <code>Dim lastrow as Long</code>.  Then you set it once and while Excel is open and you do not use <code>End</code> by itself in any code.  It will maintain the value and can be called and used by other modules."}, {"owner": {"reputation": 27, "user_id": 8138935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9efc3be76a92df2a3f126ca90ec66924?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/8138935/brian"}, "edited": false, "score": 0, "creation_date": 1503604188, "post_id": 45847018, "comment_id": 78698448, "body": "This is what I have now and it&#39;s not picking up in other modules. <code>&#39;On Top of Module 1 Public LastRow As Long &#39;In Module 1 where variable is defined Sub VariableTest()</code>  Dim ws As Worksheet  Set ws = Worksheets(&quot;Test&quot;)  LastRow = ws.Cells(ws.Rows.Count, &quot;A&quot;).End(xlUp).Row  And then I have the calculations in the second module. <code>&#39;Calculation in Module 2 Sub Test()  &#39;New Nov Rem Est ws.Range(&quot;D2:D&quot; &amp; LastRow).FormulaR1C1 = &quot;=RC[-2]-RC[1]&quot;  End Sub</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 27, "user_id": 8138935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9efc3be76a92df2a3f126ca90ec66924?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/8138935/brian"}, "edited": false, "score": 0, "creation_date": 1503604424, "post_id": 45847018, "comment_id": 78698565, "body": "At this point since it is hard to format code in comments, please ask a new question, with what you have tried."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1503513004, "creation_date": 1503513004, "answer_id": 45847018, "question_id": 45846559, "link": "https://stackoverflow.com/questions/45846559/vba-dynamic-range-for-formulas/45847018#45847018", "title": "VBA dynamic range for formulas", "body": "<pre><code>Dim lastRow As Long\nDim ws As Worksheet\n'Always set the parent of all Range Objects\nSet ws = ActiveSheet 'This should be called by name: Worksheets(\"Sheet1\")\n\n' this assumes column \"A\" is the column which sets the lastrow.\n'If a different column sets the end of the dataset change \"A\" to that column\nlastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n'do not use .Select or .Activate it slows the code\n'You do not need autofill just put it in all the cells at once\n\n\n'November Remaining Spending Plan\n ws.Range(\"BF2:BF\" &amp; lastRow).FormulaR1C1 = \"=RC[-43]+RC[-40]+RC[-37]+RC[-34]+RC[-31]+RC[-28]+RC[-25]+RC[-22]\"\n\n'December Remaining Spending Plan\n ws.Range(\"BG2:BG\" &amp; lastRow).FormulaR1C1 = \"RC[-41]+RC[-38]+RC[-35]+RC[-32]+RC[-29]+RC[-26]+RC[-23]\"\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8138935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9efc3be76a92df2a3f126ca90ec66924?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/8138935/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "accepted_answer_id": 45847018, "answer_count": 2, "score": 0, "last_activity_date": 1503513004, "creation_date": 1503511284, "question_id": 45846559, "link": "https://stackoverflow.com/questions/45846559/vba-dynamic-range-for-formulas", "title": "VBA dynamic range for formulas", "body": "<p>I've posted a snippet of my code below. My actual workbook has a lot more formulas, but they are all structured like the formulas below. The amount of data I'm working with can change on a month to month basis, so I never know how many rows I will need the formulas to carry down. My little cheat for this was to make the destination range for all the formulas <strong>\"XX2:XX500\"</strong>, because there will never be more than 500 rows. </p>\n\n<pre><code>'November Remaining Spending Plan\n Range(\"BF2\").Select\n ActiveCell.FormulaR1C1 = \"=IF(RC[-1]=\"\"\"\",\"\"\"\",RC[-43]+RC[-40]+RC[-37]+RC[-34]+RC[-31]+RC[-28]+RC[-25]+RC[-22])\"\n Selection.AutoFill Destination:=Range(\"BF2:BF500\")\n\n'December Remaining Spending Plan\n Range(\"BG2\").Select\n ActiveCell.FormulaR1C1 = \"=IF(RC[-1]=\"\"\"\",\"\"\"\",RC[-41]+RC[-38]+RC[-35]+RC[-32]+RC[-29]+RC[-26]+RC[-23])\"\n Selection.AutoFill Destination:=Range(\"BG2:BG500\")\n</code></pre>\n\n<p>I would like to make the range dynamic so I can remove the </p>\n\n<pre><code>\"IF(RC[-1]=\"\"\"\",\"\"\"\",\"\n</code></pre>\n\n<p>part of the formula and having the extra formulas in the workbook isn't ideal for pivot tables and other users.</p>\n\n<p>I've tried playing with the ranges using combinations of LastRow, FillDown, CurrentRegion, but I haven't had any luck. </p>\n\n<p>Each formula should have the same amount of rows as all other formulas and the amount of formulas should always equal the number of rows in column A minus 1 (the minus 1 is for the header). </p>\n\n<p>Is there a way to clean this up?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 2, "creation_date": 1503510633, "post_id": 45846146, "comment_id": 78650717, "body": "You can use <code>ThisDocument.Tables(1).Columns(1).Cells</code>."}, {"owner": {"reputation": 1, "user_id": 6037865, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154587279279502/picture?type=large", "display_name": "chicken_milk", "link": "https://stackoverflow.com/users/6037865/chicken-milk"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1503510968, "post_id": 45846146, "comment_id": 78650929, "body": "@ Domenic Perfect thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6037865, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154587279279502/picture?type=large", "display_name": "chicken_milk", "link": "https://stackoverflow.com/users/6037865/chicken-milk"}, "edited": false, "score": 0, "creation_date": 1503510563, "post_id": 45846310, "comment_id": 78650666, "body": "I&#39;m for asking you to hold my hand, but how would it look in its entirety"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1503510653, "last_edit_date": 1503510653, "creation_date": 1503510425, "answer_id": 45846310, "question_id": 45846146, "link": "https://stackoverflow.com/questions/45846146/vba-words-table-how-do-i-only-reference-the-first-column/45846310#45846310", "title": "VBA Words table; How do I only reference the first column?", "body": "<p>You would want to use an indexed loop instead of a <code>For Each</code> loop and then address the cell like this</p>\n\n<pre><code>.Cell(lRow, lCol).Range.Text\n\nThisDocument.Tables(1).Range.Cells(1, 2).Range.Text\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6037865, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154587279279502/picture?type=large", "display_name": "chicken_milk", "link": "https://stackoverflow.com/users/6037865/chicken-milk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503519191, "creation_date": 1503509897, "last_edit_date": 1503519191, "question_id": 45846146, "link": "https://stackoverflow.com/questions/45846146/vba-words-table-how-do-i-only-reference-the-first-column", "title": "VBA Words table; How do I only reference the first column?", "body": "<p>Sorry everyone I'm still very new to VBA. I'm trying to fill text only in the first column but it goes over to the next column, how do I only reference the first column so that it prints going down the column, also how do I break the loop?</p>\n\n<p>thanks</p>\n\n<pre><code>       For Each c In ThisDocument.Tables(1).Range.Cells\n\n           c.Range.Text = (\"Description\" &amp; x)\n        x = x + 1\n    Next c\n\n   End With\n\nEnd With\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "variables"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1503508006, "post_id": 45845594, "comment_id": 78649275, "body": "What is it doing that is wrong?"}, {"owner": {"reputation": 3, "user_id": 8506742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e157adcdeab97f79cfda78ffefc9b58c?s=128&d=identicon&r=PG&f=1", "display_name": "rmunch123", "link": "https://stackoverflow.com/users/8506742/rmunch123"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1503508108, "post_id": 45845594, "comment_id": 78649327, "body": "Sorry Scott...I&#39;ll add that.  I&#39;m getting a Run-time error &#39;1004&#39;:  Application-defined or object-defined error"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8506742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e157adcdeab97f79cfda78ffefc9b58c?s=128&d=identicon&r=PG&f=1", "display_name": "rmunch123", "link": "https://stackoverflow.com/users/8506742/rmunch123"}, "edited": false, "score": 0, "creation_date": 1503508217, "post_id": 45845664, "comment_id": 78649389, "body": "Ahhh I see.  Is there a way to do this for an entire workbook?  Or what is the best way to qualify this across all of the worksheets?  Thank you sir!"}, {"owner": {"reputation": 3, "user_id": 8506742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e157adcdeab97f79cfda78ffefc9b58c?s=128&d=identicon&r=PG&f=1", "display_name": "rmunch123", "link": "https://stackoverflow.com/users/8506742/rmunch123"}, "edited": false, "score": 0, "creation_date": 1503508677, "post_id": 45845664, "comment_id": 78649664, "body": "Scott...You are a genius.  Thank you SO much for this!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 8506742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e157adcdeab97f79cfda78ffefc9b58c?s=128&d=identicon&r=PG&f=1", "display_name": "rmunch123", "link": "https://stackoverflow.com/users/8506742/rmunch123"}, "edited": false, "score": 0, "creation_date": 1503508844, "post_id": 45845664, "comment_id": 78649757, "body": "@rmunch123 Please remember to mark as correct by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1503508348, "last_edit_date": 1503508348, "creation_date": 1503508148, "answer_id": 45845664, "question_id": 45845594, "link": "https://stackoverflow.com/questions/45845594/parsing-an-array-over-multiple-worksheets/45845664#45845664", "title": "Parsing an array over multiple worksheets", "body": "<p>you need to qualify <strong>ALL</strong> Range object with their parent sheet.  That includes the <code>Cells()</code> inside the Range():</p>\n\n<pre><code>For i = 1 To BreakdownCount  \n    UpperRange = 8 + (i - 1) * 200\n    LowerRange = 8 + i * 200\n    MsgBox UpperRange\n    MsgBox LowerRange\n\n    Worksheets(\"Data \" &amp; i).Range(Worksheets(\"Data \" &amp; i).Cells(8, 2), Worksheets(\"Data \" &amp; i).Cells(207, 2)).Value = Worksheets(\"Scanner - ALL\").Range(Worksheets(\"Scanner - ALL\").Cells(UpperRange, 2), Worksheets(\"Scanner - ALL\").Cells(LowerRange, 2)).Value  \nNext\n</code></pre>\n\n<p>A Little short hand:</p>\n\n<pre><code>Dim wsOut as Worksheet\nWith Worksheets(\"Scanner - ALL\")\n    For i = 1 To BreakdownCount \n        Set wsOut =  Worksheets(\"Data \" &amp; i)\n        UpperRange = 8 + (i - 1) * 200\n        LowerRange = 8 + i * 200\n        MsgBox UpperRange\n        MsgBox LowerRange\n\n        wsOut.Range(wsOut.Cells(8, 2), wsOut.Cells(207, 2)).Value = .Range(.Cells(UpperRange, 2), .Cells(LowerRange, 2)).Value  \n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8506742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e157adcdeab97f79cfda78ffefc9b58c?s=128&d=identicon&r=PG&f=1", "display_name": "rmunch123", "link": "https://stackoverflow.com/users/8506742/rmunch123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 45845664, "answer_count": 1, "score": 0, "last_activity_date": 1503508348, "creation_date": 1503507940, "last_edit_date": 1503508000, "question_id": 45845594, "link": "https://stackoverflow.com/questions/45845594/parsing-an-array-over-multiple-worksheets", "title": "Parsing an array over multiple worksheets", "body": "<p>I am trying to breakdown an array of tickers on one sheet into multiple sheets.  I basically am trying to for loop through multiple sheets using the \"i\" variable as both a worksheet identifier and also a multiplier for how many tickers go on each sheet.</p>\n\n<p>Can anyone spot the error I'm making here?  Or any other ways that you'd recommend to attack this?</p>\n\n<p>\"BreakdownCount\" = the user inputted grouping size...in this case 200 as a test.</p>\n\n<p>Thanks!</p>\n\n<pre><code>For i = 1 To BreakdownCount  \n    UpperRange = 8 + (i - 1) * 200\n    LowerRange = 8 + i * 200\n    MsgBox UpperRange\n    MsgBox LowerRange\n\n    Worksheets(\"Data \" &amp; i).Range(Cells(8, 2), Cells(207, 2)).Value = Worksheets(\"Scanner - ALL\").Range(Cells(UpperRange, 2), Cells(LowerRange, 2)).Value  \nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1503506518, "post_id": 45845177, "comment_id": 78648460, "body": "You are testing to see if the color is <code>True</code>?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1503506773, "post_id": 45845177, "comment_id": 78648606, "body": "I am trying to get the tab to be colored red if the interior of the range is colored itself"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1503506805, "post_id": 45845177, "comment_id": 78648620, "body": "I would make three binary variables that are 0 if the cell is not colored and 1 if the cell is colored.  Then you can test on If the summation of the variables is 1 or 2. This avoids having the create <code>if</code> statements that look through the possible combinations of coloring in the three cells."}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "edited": false, "score": 0, "creation_date": 1503506954, "post_id": 45845177, "comment_id": 78648706, "body": "You can test if <code>.Range(&quot;B7&quot;).Interior.color &lt;&gt; 16777215</code>, which <code>16777215</code> is the null color. Or, you could test for <code>.Range(&quot;B7&quot;).Interior.ColorIndex &lt;&gt; -4142</code>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1503506981, "post_id": 45845177, "comment_id": 78648720, "body": "The default value for <code>Cell.Interior.Color</code> is <code>16777215</code>."}], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 2, "creation_date": 1503507972, "post_id": 45845534, "comment_id": 78649262, "body": "You could narrow this down to one variable (just &#39;a&#39;) and just use <code>a = a + 1</code> for each <code>True</code>, a la <code>If .Range(&quot;B7&quot;).Interior.ColorIndex &gt; 0 Then a = a + 1</code>. Then <code>If a = 2 Then</code>, etc."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1503508041, "post_id": 45845534, "comment_id": 78649295, "body": "@J.Fox That&#39;s a great point, I&#39;ll edit the answer.  Thank you!"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503509400, "post_id": 45845534, "comment_id": 78650017, "body": "@Jarom the code is turning all of my tabs green, when I know that some should be turning red"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503509987, "post_id": 45845534, "comment_id": 78650306, "body": "@ACohen. Did you debug, line-by-line to see where it fails?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503510055, "post_id": 45845534, "comment_id": 78650356, "body": "@Jarom Yes, it runs through the first time fine and then it runs through the rest automatically"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503510267, "post_id": 45845534, "comment_id": 78650478, "body": "@ACohen - I am not Jarom :). Can you be more specific. I don&#39;t what exactly you are trying to say with that comment. Maybe also edit your post to include the code block that houses the lines as currently seen in question. I suspect you are looping which may be causing an issue. (Not loop itself, but how code is written in loop)."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503510692, "post_id": 45845534, "comment_id": 78650751, "body": "@ACohen I&#39;d have to see more of your code to see what is causing the problem.  You can edit the post to include the loop like Scott suggested."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1503511728, "post_id": 45845534, "comment_id": 78651376, "body": "@ScottHoltzman  I edited my data. Hope its not too confusing/poorly put together"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 1, "creation_date": 1503512760, "post_id": 45845534, "comment_id": 78651953, "body": "@ACohen I see what is likely the problem.  <code>a</code> needs to be reset for each loop.  The only time <code>a</code> is reset is when <code>.Range(&quot;B7&quot;).Interior.ColorIndex &gt; 0</code> evaluates to true.  Try putting <code>a = 0</code> before the  <code>IF</code> statement for cell <code>B7</code>.  I edited my answer to include it.  See if that gets the expected results."}, {"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1503513313, "post_id": 45845534, "comment_id": 78652257, "body": "Came back when I remembered using an additive method would require a reset. My bad!"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1503513435, "post_id": 45845534, "comment_id": 78652329, "body": "@J.Fox yeah, I didn&#39;t really think about it either.  I wasn&#39;t really in the loop mindset I guess...."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503515631, "post_id": 45845534, "comment_id": 78653507, "body": "@Jarom For some reason, it is still not working properly"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503516008, "post_id": 45845534, "comment_id": 78653702, "body": "@ACohen Hmmm....  Ok, at this point you should find a page that the code is not working properly on and F8 thru each line checking which <code>If</code> statements fire and the value of <code>a</code> at every point.  That might help you catch exactly what is going on.  From just looking at the code, I&#39;m not sure what it would be."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503516239, "post_id": 45845534, "comment_id": 78653853, "body": "@ACohen maybe the <code>.ColorIndex &gt; 0</code> isn&#39;t working correctly.  Try what Rafael Matos said in his comment <code>.Range(&quot;B7&quot;).Interior.ColorIndex &lt;&gt; -4142</code>  I&#39;m not familiar with that method, but it&#39;s definitely worth a shot."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503518066, "post_id": 45845534, "comment_id": 78654691, "body": "@Jarom I set each range equal to their respective color, i.e. <code>RGB(255, 0, 0)</code>.  However, even if the statement is true, the code will think that it is false"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503518432, "post_id": 45845534, "comment_id": 78654886, "body": "@ACohen Ok, so you have isolated the problem to the condition of the <code>if</code> statement then correct?  That&#39;s progress.  Let me look a little more into that.  Are all of the cells that are highlighted colored <code>RGB(255,0,0)</code>?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1503518507, "post_id": 45845534, "comment_id": 78654924, "body": "<code>.Range(&quot;B7&quot;).Interior.color = RGB(255, 0, 0)</code> <code>.Range(&quot;B8&quot;).Interior.color = RGB(255, 165, 0)</code> <code>.Range(&quot;B9&quot;).Interior.color = RGB(255, 255, 0)</code>"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1503520285, "post_id": 45845534, "comment_id": 78655761, "body": "I&#39;ve tested all of this on my machine and it is working.  My last piece of advice is to do something like <code>.Range(&quot;B7&quot;).Select</code> before the <code>if</code> statement to make sure it is talking about the cell you think it is.  Outside of that, I don&#39;t know what the problem would be."}], "tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": true, "score": 4, "last_activity_date": 1503512643, "last_edit_date": 1503512643, "creation_date": 1503507759, "answer_id": 45845534, "question_id": 45845177, "link": "https://stackoverflow.com/questions/45845177/vba-if-two-of-three-cells-are-true/45845534#45845534", "title": "VBA - If two of three cells are true", "body": "<p>Something like this may help you.  It still has multiple if statements.  But the statements are simple and don't have to deal with how the combinations of different cells being colored.  </p>\n\n<p>Also, I used <code>colorindex &gt; 0</code> as the condition for having color filling. </p>\n\n<pre><code>a = 0\n\nIf .Range(\"B7\").Interior.ColorIndex &gt; 0 Then\n    a = 1\nEnd If\n\nIf .Range(\"B8\").Interior.ColorIndex &gt; 0 Then\n    a = a + 1\nEnd If\n\nIf .Range(\"B9\").Interior.ColorIndex &gt; 0 Then\n    a = a + 1\nEnd If\n\n\nIf a = 2 Then\n    .Range(\"B10\").Interior.ColorIndex = 3\nElseIf a = 1 Then\n    .Range(\"B10\").Interior.ColorIndex = 43\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 45845534, "answer_count": 1, "score": 0, "last_activity_date": 1503512643, "creation_date": 1503506403, "last_edit_date": 1503511894, "question_id": 45845177, "link": "https://stackoverflow.com/questions/45845177/vba-if-two-of-three-cells-are-true", "title": "VBA - If two of three cells are true", "body": "<p>I am trying to construct and If statement that turns a tab Red if two of three cells are colored, or Turns green if only on is colored.  I was hoping that there would be an easier way to right it than three if statements like this.  </p>\n\n<pre><code>Dim dateRng As String, num As Integer, j As Integer, irng As Range, frng As Range\ndateRng = Sheets(\"Input Raw Data\").Range(\"B\" &amp; counter + 2).Value\nnum = Sheets(\"Tool Setup\").Range(\"C18\").Value\nNumPts = num * 3\n\nFor s = 1 To Sheets.Count\n    With Sheets(s)\n    For j = 1 To num\n        If .Name = j Then\n            .Range(\"A1:C1\").Merge\n            .Range(\"A1\") = dateRng\n            .Name = Sheets(\"Point Names\").Range(\"B\" &amp; (3 * j - 1))\n        End If\n    Next j\n    End With\nNext s\nFor s = 1 to Sheets.Count\n    With Sheets(s)\n    For y = 1 To NumPts\n        If .Name = Sheets(\"Reporting\").Range(\"B\" &amp; (12 * y - 5)) Then\n            For k = 6 To -1\n                Set irng = Sheets(\"Reporting\").Range(\"A\" &amp; (12 * y - k))\n                Set irng = Sheets(\"Reporting\").Range(irng, irng.End(xlToRight).End(xlToRight))\n            irng.Copy (.Range(\"A2\"))\n            Next k\n            .Columns(\"A:A\").ColumnWidth = 12\n            .Columns(\"B:B\").EntireColumn.AutoFit\n            If .Range(\"B7\").Interior.ColorIndex &gt; 0 Then\n                a = 1\n            End If\n\n            If .Range(\"B8\").Interior.ColorIndex &gt; 0 Then\n                a = a + 1\n            End If\n\n            If .Range(\"B9\").Interior.ColorIndex &gt; 0 Then\n                a = a + 1\n            End If\n\n            If a &gt;= 2 Then\n                .Tab.ColorIndex = 3\n            ElseIf a &lt;= 1 Then\n                .Tab.ColorIndex = 4\n            End If\n        End If\n       y = y + 2\n    Next y\n    End With\nNext s\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1503505438, "post_id": 45844771, "comment_id": 78647821, "body": "Have you tried <code>Workbooks.Open(&quot;https:&#47;&#47;app1.intra.corp&#47;A997&#47;EnCours&#47;Configs&zwnj;&#8203;?Download=Exporter&quot;)</code> instead?"}, {"owner": {"reputation": 306, "user_id": 8132666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/152cb2ab0fb1d1f8f81ecf1842ad26cb?s=128&d=identicon&r=PG&f=1", "display_name": "J. Lavoie", "link": "https://stackoverflow.com/users/8132666/j-lavoie"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1503505660, "post_id": 45844771, "comment_id": 78647949, "body": "You are the savior I needed! Thank you so much. I wasn&#39;t able to find this anywhere else on google. I&#39;ll let you make the answer and I&#39;ll accept it. Thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1503506070, "creation_date": 1503506070, "answer_id": 45845097, "question_id": 45844771, "link": "https://stackoverflow.com/questions/45844771/workbook-followhyperlink-opens-an-ok-cancel-dialog-window/45845097#45845097", "title": "Workbook.FollowHyperlink opens an ok/cancel dialog window", "body": "<p>Have you tried</p>\n\n<pre><code>Workbooks.Open(\"https://app1.intra.corp/A997/EnCours/Configs\u200c\u200b?Download=Exporter\")\n</code></pre>\n\n<p>instead? That should work.</p>\n"}], "owner": {"reputation": 306, "user_id": 8132666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/152cb2ab0fb1d1f8f81ecf1842ad26cb?s=128&d=identicon&r=PG&f=1", "display_name": "J. Lavoie", "link": "https://stackoverflow.com/users/8132666/j-lavoie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 0, "accepted_answer_id": 45845097, "answer_count": 1, "score": 0, "last_activity_date": 1503506070, "creation_date": 1503504928, "question_id": 45844771, "link": "https://stackoverflow.com/questions/45844771/workbook-followhyperlink-opens-an-ok-cancel-dialog-window", "title": "Workbook.FollowHyperlink opens an ok/cancel dialog window", "body": "<p>I am downloading/opening an excel file with the Workbook.FollowHyperlink method. </p>\n\n<p>The problem is that I want to automatize the process but the method opens a dialog ok/cancel telling me that this file might harm my computer and if I really want to open it. </p>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>Dim strURL As String\nstrURL = \"https://app1.intra.corp/A997/EnCours/Configs?Download=Exporter\"\nThisWorkbook.FollowHyperlink (strURL)\n</code></pre>\n\n<p>I searched and tried a lot of things to get around without any success.</p>\n\n<p>I tried:</p>\n\n<ol>\n<li><p>Adding the registry entry to disable hyperlink warning for office.</p></li>\n<li><p>Going in excel options, privacy setting and disabling the entrusted website protection or whatever it is called.</p></li>\n<li><p>Using Application.SendKeys and trying to send \"enter\" to answer the dialog.</p></li>\n<li><p><code>Application.EnableEvents = False</code> and <code>Application.DisplayAlerts = False</code>. (It works for every other dialog box except this one)</p></li>\n<li><p>Adding the website to my trusted website list in Internet Explorer options (Note: I wasn't able to do this because these settings are locked by my company)</p></li>\n</ol>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2013"], "comments": [{"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1503502519, "post_id": 45843881, "comment_id": 78645836, "body": "may be the problem would be with the index formula"}, {"owner": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1503504078, "post_id": 45843881, "comment_id": 78646940, "body": "@GowthamShiva - any suggestions on how to remedy?  I am scratching my head on this one."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1503504150, "post_id": 45843881, "comment_id": 78646992, "body": "am not entirely sure. But i do have a different answer which you may modify. Let me know if i can post that for you"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1503504246, "post_id": 45843881, "comment_id": 78647061, "body": "can you also make your function accept ranges, as well as arrays?"}, {"owner": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1503504398, "post_id": 45843881, "comment_id": 78647169, "body": "@GowthamShiva - yes a diff solution is feasible.  I was just attempting to do this on my own but have hit a brick wall :)"}, {"owner": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1503504419, "post_id": 45843881, "comment_id": 78647186, "body": "@MacroMarc - yes, I should be able to adapt the function to accept ranges and/or arrays."}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "edited": false, "score": 0, "creation_date": 1503505017, "post_id": 45844701, "comment_id": 78647559, "body": "I must be missing something here.  I changed it to a Public Function TextJoin() and in cell D2 I input TextJoin() but it always returns 0?  What I see in the code is you are comparing the value of i,1 and i+1, 1 (so example would be A2, and B2) and if the values match then append then with a comma between them."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "edited": false, "score": 1, "creation_date": 1503505240, "post_id": 45844701, "comment_id": 78647704, "body": "@SmithStanley if you use it as a UDF, you may need to return the values to corresponding range. Not just by entering the UDF in <code>one cell</code>. You may use it as it is as i posted"}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": true, "score": 2, "last_activity_date": 1503504666, "creation_date": 1503504666, "answer_id": 45844701, "question_id": 45843881, "link": "https://stackoverflow.com/questions/45843881/textjoin-udf-for-excel-2013/45844701#45844701", "title": "TextJoin UDF For Excel 2013", "body": "<p>If your data is in columns A and B, this code should work. </p>\n\n<pre><code>Sub TEXTJOIN()\nDim i As Long, str As String, k As Long\nColumns(\"A:B\").Sort key1:=Range(\"A2\"), order1:=xlAscending, Header:=xlYes\nstr = Cells(2, 2)\nk = 2\nFor i = 2 To Cells(Rows.Count, 1).End(xlUp).Row\n    If Cells(i, 1) = Cells(i + 1, 1) Then\n        str = str &amp; \",\" &amp; Cells(i + 1, 2)\n    Else\n        Cells(k, 4) = Cells(i, 1)\n        Cells(k, 5) = str\n        k = k + 1\n        str = Cells(i + 1, 2)\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/W5vov.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W5vov.png\" alt=\"enter image description here\"></a></p>\n\n<p>I leave the part to you to convert this to an UDF.</p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 2, "last_activity_date": 1503505622, "creation_date": 1503505622, "answer_id": 45844966, "question_id": 45843881, "link": "https://stackoverflow.com/questions/45843881/textjoin-udf-for-excel-2013/45844966#45844966", "title": "TextJoin UDF For Excel 2013", "body": "<p>You may try something like this...</p>\n\n<pre><code>Function TEXTJOIN(delimiter As String, lookup_id As Range, arr_rng As Range, Optional ignore_empty As Boolean = True) As String\nDim x, dict\nDim i As Long\nx = arr_rng.Value\nSet dict = CreateObject(\"Scripting.Dictionary\")\nFor i = 1 To UBound(x, 1)\n    If x(i, 1) = lookup_id Then\n        If Not dict.exists(x(i, 1)) Then\n            dict.Item(x(i, 1)) = x(i, 2)\n        Else\n            dict.Item(x(i, 1)) = dict.Item(x(i, 1)) &amp; IIf(x(i, 2) = \"\", IIf(ignore_empty, \"\", delimiter), delimiter &amp; x(i, 2))\n        End If\n    End If\nNext i\nIf dict.Count &gt; 0 Then\n    TEXTJOIN = dict.Item(IIf(IsNumeric(lookup_id), lookup_id + 0, lookup_id))\nElse\n    TEXTJOIN = \"\"\nEnd If\nEnd Function\n</code></pre>\n\n<p>Then considering your data is in range A2:B7, try this like below...</p>\n\n<p>In C2</p>\n\n<pre><code>=TEXTJOIN(\",\",A2,$A$2:$B$7)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qzAwS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qzAwS.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 6, "last_activity_date": 1503506632, "creation_date": 1503506632, "answer_id": 45845229, "question_id": 45843881, "link": "https://stackoverflow.com/questions/45843881/textjoin-udf-for-excel-2013/45845229#45845229", "title": "TextJoin UDF For Excel 2013", "body": "<p>This function accepts both ranges and arrays, both horizontal and vertical</p>\n\n<pre><code>Function TEXTJOIN(delim As String, skipblank As Boolean, arr)\n    Dim d As Long\n    Dim c As Long\n    Dim arr2()\n    Dim t As Long, y As Long\n    t = -1\n    y = -1\n    If TypeName(arr) = \"Range\" Then\n        arr2 = arr.Value\n    Else\n        arr2 = arr\n    End If\n    On Error Resume Next\n    t = UBound(arr2, 2)\n    y = UBound(arr2, 1)\n    On Error GoTo 0\n\n    If t &gt;= 0 And y &gt;= 0 Then\n        For c = LBound(arr2, 1) To UBound(arr2, 1)\n            For d = LBound(arr2, 1) To UBound(arr2, 2)\n                If arr2(c, d) &lt;&gt; \"\" Or Not skipblank Then\n                    TEXTJOIN = TEXTJOIN &amp; arr2(c, d) &amp; delim\n                End If\n            Next d\n        Next c\n    Else\n        For c = LBound(arr2) To UBound(arr2)\n            If arr2(c) &lt;&gt; \"\" Or Not skipblank Then\n                TEXTJOIN = TEXTJOIN &amp; arr2(c) &amp; delim\n            End If\n        Next c\n    End If\n    TEXTJOIN = Left(TEXTJOIN, Len(TEXTJOIN) - Len(delim))\nEnd Function\n</code></pre>\n\n<p>In this instance you would use it as an array formula:</p>\n\n<pre><code>=TEXTJOIN(\", \",TRUE,IF($A$2:$A$10=D2,$B$2:$B$10,\"\"))\n</code></pre>\n\n<p>Being an array formula it would need to be confirmed with Ctrl-Shift-Enter instead of Enter when exiting edit mode.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1wdjv.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/1wdjv.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1520402500, "post_id": 49144868, "comment_id": 85295160, "body": "Welcome to StackOverflow.  Answers with only code in them tend to get flagged for deletion as they are &quot;low quality&quot;.  Please read the help section on answering questions then consider adding some commentary to your Answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 3286721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDr7sddQOHiYTKid5mC4QZ-iXr1Bdkyml08lzkmV8g=k-s128", "display_name": "HUMENTH", "link": "https://stackoverflow.com/users/3286721/humenth"}, "is_accepted": false, "score": 0, "last_activity_date": 1520401151, "creation_date": 1520401151, "answer_id": 49144868, "question_id": 45843881, "link": "https://stackoverflow.com/questions/45843881/textjoin-udf-for-excel-2013/49144868#49144868", "title": "TextJoin UDF For Excel 2013", "body": "<p>Try this....!</p>\n\n<pre><code>Function TEXTJOIN(delimiter As String, ignore_empty As Boolean, ParamArray \ncell_ar() As Variant)\n2\nFor Each cellrng In cell_ar\n3\nFor Each cell In cellrng\n4\nIf ignore_empty = False Then\n5\nresult = result &amp; cell &amp; delimiter\n6\nElse\n7\nIf cell &lt;&gt; \"\" Then\n8\nresult = result &amp; cell &amp; delimiter\n9\nEnd If\n10\nEnd If\n11\nNext cell\n12\nNext cellrng\n13\nTEXTJOIN = Left(result, Len(result) - Len(delimiter))\n14\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 7963473, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3fd1e96bc3defa52696fd50fad2fdc27?s=128&d=identicon&r=PG&f=1", "display_name": "Smith Stanley", "link": "https://stackoverflow.com/users/7963473/smith-stanley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3501, "favorite_count": 2, "accepted_answer_id": 45844701, "answer_count": 4, "score": 3, "last_activity_date": 1520401151, "creation_date": 1503502193, "last_edit_date": 1503502451, "question_id": 45843881, "link": "https://stackoverflow.com/questions/45843881/textjoin-udf-for-excel-2013", "title": "TextJoin UDF For Excel 2013", "body": "<p>I am trying to utilize a UDF version of TextJoin since I am using Excel 2013 - but this function is not properly returning the accurate data.</p>\n\n<p>My data-set in Excel looks like this</p>\n\n<pre><code>saleID      Item\n5           PRE2323\n6           Pre2323223\n6           OX12321\n6           RI132\n9           TN23\n9           LSR12\n</code></pre>\n\n<p>And my desired output is</p>\n\n<pre><code>saleID     Items\n5          Pre2323\n6          Pre2323223, OX12321, RI132\n9          TN23, LSR12\n</code></pre>\n\n<p>And this is the UDF I Have that is not functioning as it should</p>\n\n<pre><code>    Option Explicit\nFunction TEXTJOIN(delimiter As String, ignore_empty As String, ParamArray textn() As Variant) As String\n    Dim i As Long\n    For i = LBound(textn) To UBound(textn) - 1\n        If Len(textn(i)) = 0 Then\n            If Not ignore_empty = True Then\n                TEXTJOIN = TEXTJOIN &amp; textn(i) &amp; delimiter\n            End If\n        Else\n            TEXTJOIN = TEXTJOIN &amp; textn(i) &amp; delimiter\n        End If\n    Next\n    TEXTJOIN = TEXTJOIN &amp; textn(UBound(textn))\nEnd Function\n</code></pre>\n\n<p>And I am calling it in the cell like this</p>\n\n<pre><code>=TEXTJOIN(\", \",1,INDEX(REPT(B$2:B$100,A$2:A$100=ROWS(C$2:C2)),0))\n</code></pre>\n\n<p>And I get an error of #VALUE!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1503505016, "post_id": 45843751, "comment_id": 78647558, "body": "<a href=\"http://www.vbaexpress.com/forum/showthread.php?53174-VBA-to-expand-Outlook-Distribution-Group-before-send\" rel=\"nofollow noreferrer\">vbaexpress.com/forum/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1503507029, "creation_date": 1503507029, "answer_id": 45845346, "question_id": 45843751, "link": "https://stackoverflow.com/questions/45843751/scanning-email-recipients-for-outside-domains/45845346#45845346", "title": "Scanning email recipients for outside domains", "body": "<p>Yes, if the given property is not present, <code>PropertyAccessor.GetProperty</code> will raise an exception. This is by design. You must expect and trap that exception. </p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1506358324, "last_edit_date": 1506358324, "creation_date": 1506358022, "answer_id": 46410239, "question_id": 45843751, "link": "https://stackoverflow.com/questions/45843751/scanning-email-recipients-for-outside-domains/46410239#46410239", "title": "Scanning email recipients for outside domains", "body": "<p>As described here <a href=\"http://www.vbaexpress.com/forum/showthread.php?53174-VBA-to-expand-Outlook-Distribution-Group-before-send\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/showthread.php?53174-VBA-to-expand-Outlook-Distribution-Group-before-send</a></p>\n\n<p>This expands Distribution lists and nested Distribution Lists.</p>\n\n<p>Just before <code>Set recips = Item.Recipients</code></p>\n\n<pre><code>Sub DLExpand()\n\n    ' http://www.vbaexpress.com/forum/showthread.php?53174-VBA-to-expand-Outlook-Distribution-Group-before-send\n\n    Dim currItem As mailitem\n    Dim recips As Recipients\n\n    Dim innerDistListFound As Boolean\n\n    Dim i As Long\n    Dim j As Long\n\n    Set currItem = ActiveInspector.currentItem\n    innerDistListFound = True\n\n    Do Until innerDistListFound = False\n\n        Set recips = currItem.Recipients\n        innerDistListFound = False\n\n        If recips.count = 0 Then GoTo ExitRoutine\n\n        For j = recips.count To 1 Step -1\n\n             'Debug.Print recips(j)\n\n            If recips(j).AddressEntry.DisplayType &lt;&gt; olUser Then\n\n                 ' Expand the dist list\n                For i = 1 To recips(j).AddressEntry.Members.count\n\n                    If recips(j).AddressEntry.Members.Item(i).DisplayType = olUser Then\n                        currItem.Recipients.Add (recips(j).AddressEntry.Members.Item(i).Address)\n                    Else\n                        currItem.Recipients.Add (recips(j).AddressEntry.Members.Item(i).name)\n                        innerDistListFound = True\n                         'Debug.Print \" innerDistListFound: \" &amp; innerDistListFound\n                    End If\n\n                    Debug.Print \"- \" &amp; recips(j).AddressEntry.Members.Item(i).name\n\n                Next\n\n                recips(j).Delete\n                recips.ResolveAll\n                DoEvents\n\n            End If\n\n        Next j\n\n        recips.ResolveAll\n\n    Loop\n\nExitRoutine:\n    Set currItem = Nothing\n    Set recips = Nothing\n\n     'Debug.Print \"Done.\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8507034, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--AMkeLyj4Hs/AAAAAAAAAAI/AAAAAAAACmU/80dJT4ZLla0/photo.jpg?sz=128", "display_name": "Joshua Farina", "link": "https://stackoverflow.com/users/8507034/joshua-farina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 46410239, "answer_count": 2, "score": 0, "last_activity_date": 1593072178, "creation_date": 1503501833, "last_edit_date": 1593072178, "question_id": 45843751, "link": "https://stackoverflow.com/questions/45843751/scanning-email-recipients-for-outside-domains", "title": "Scanning email recipients for outside domains", "body": "<p>I wrote some code to scan through the recipients of a sent email, and edit the subject line for outside domains. However, if there is an email distribution list included, it throws an error. How can I process members of the distribution list in my search for outside domains?</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, cancel As Boolean)\n\nDim strSubject As String\nDim recips As Outlook.Recipients\nDim recip As Outlook.Recipient\nDim pa As Outlook.PropertyAccessor\nDim outsideEmails() As String\nDim includesOutsideDomain As Boolean\nDim i As Integer\nDim userChoice As Integer\n\nConst PR_SMTP_ADDRESS As String = \"http://schemas.microsoft.com/mapi/proptag/0x39FE001E\"\n\nSet recips = Item.Recipients\nReDim outsideEmails(recips.Count)\n\nstrSubject = Item.Subject\nincludesOutsideDomain = False\n\ni = 0\n\nFor Each recip In recips\n    Debug.Print recip\n    Set pa = recip.PropertyAccessor\n    If InStr(LCase(pa.GetProperty(PR_SMTP_ADDRESS)), \"@example.com\") = 0 Then\n       outsideEmails(i) = pa.GetProperty(PR_SMTP_ADDRESS)\n        'On Error Resume Next\n       includesOutsideDomain = True\n    End If\nNext\nIf includesOutsideDomain Then\n    If InStr(LCase(strSubject), \"encrypt:\") = 0 Then\n        userChoice = MsgBox(\"You may be sending this email to an outside domain without encryption. Would you like to encrypt this message?\" _\n            , vbYesNoCancel + vbCritical + vbMsgBoxSetForeground, \"Encryption Warning\")\n\n        Select Case userChoice\n            Case 6: 'yes\n                strSubject = \"Encrypt:\" &amp; strSubject\n                Item.Subject = strSubject\n            Case 7: 'no\n            Case 2: 'cancel\n                cancel = True\n        End Select\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Here is the Error: \n<a href=\"https://i.stack.imgur.com/hMtEp.png\" rel=\"nofollow noreferrer\">Error Message</a></p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1503503287, "post_id": 45843963, "comment_id": 78646369, "body": "Thank you Rory, that was the problem. I am going to read about this."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1503502400, "creation_date": 1503502400, "answer_id": 45843963, "question_id": 45843740, "link": "https://stackoverflow.com/questions/45843740/vba-get-back-to-a-sub-after-opening-a-userform/45843963#45843963", "title": "VBA - Get back to a sub after opening a userform", "body": "<p>You need to show the form modelessly. Either set its <code>ShowModal</code> property to <code>False</code>, or use:</p>\n\n<pre><code>Userform1.Show False\n</code></pre>\n"}], "owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1031, "favorite_count": 0, "accepted_answer_id": 45843963, "answer_count": 1, "score": 0, "last_activity_date": 1503502400, "creation_date": 1503501810, "last_edit_date": 1531161705, "question_id": 45843740, "link": "https://stackoverflow.com/questions/45843740/vba-get-back-to-a-sub-after-opening-a-userform", "title": "VBA - Get back to a sub after opening a userform", "body": "<p>I am struggling with a basic problem I don't find the answer online... I am trying to get back to my original sub after loading a userform (progressbar I created without using an Excel library).</p>\n\n<p>The code looks like this :</p>\n\n<p><strong>MODULE CODE :</strong></p>\n\n<pre><code> Sub Original_Sub()\n\n 'Some code here\n     Userform1.Show\n 'Some code here I can't reach\n\n End sub\n</code></pre>\n\n<p><strong>USERFORM CODE :</strong></p>\n\n<pre><code> Private Sub UserForm_Initialize()\n\n With UserForm1\n\n  .StartUpPosition = 0\n  .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n  .Top = Application.Top + (0.5 * Application.Height) - (0.35 * .Height)\n\n End With\n End Sub\n</code></pre>\n\n<p>The first part of the code is running properly, but it stops right after running the userform code... Why would not it continue like when I call a macro ? i.e :</p>\n\n<pre><code> Call MyMacro\n 'Rest of the code\n</code></pre>\n\n<p>Is there any way I can solve my problem?</p>\n\n<p>Thank you in advance for your help and have a great day</p>\n\n<p>Jean</p>\n"}, {"tags": ["vba", "excel", "for-loop", "union"], "comments": [{"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1503502496, "post_id": 45843450, "comment_id": 78645818, "body": "have you check <code>uni.address</code> prior to <code>uni.entirerow.delete</code> to see whether there are anything bind to <code>uni</code>?"}, {"owner": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1503502676, "post_id": 45843450, "comment_id": 78645945, "body": "@Rosetta I added an <code>If Not uni Is Nothing Then</code> around the <code>uni.delete</code> to do what I believe you are suggesting, still Error 1004"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1503502785, "post_id": 45843450, "comment_id": 78646023, "body": "can you give the full description of the error 1004?"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1503503147, "post_id": 45843450, "comment_id": 78646281, "body": "i&#39;m taking a wild guess here, try not to delete but instead do <code>uni.select</code>, then go back to the worksheet and delete the rows manually to see whether it is &#39;too complex for Excel to perform the operation&#39;."}, {"owner": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1503503236, "post_id": 45843450, "comment_id": 78646335, "body": "It selected them, but won&#39;t let me delete manually. Any idea why? Or how to fix? In the sample range I made, it has selected 3.6k rows."}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1503503841, "post_id": 45843450, "comment_id": 78646783, "body": "any merged cells? array formula? protected sheet? that could prevent the deletion?"}, {"owner": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1503504088, "post_id": 45843450, "comment_id": 78646949, "body": "I think it&#39;s really just the volume. see my original post, I made an edit with a &#39;working&#39; code. EDIT: A sort of working code. It still gives me the 1004 error and I need to restart it."}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1503504604, "post_id": 45843450, "comment_id": 78647301, "body": "nice! i used this method to delete many rows before. i believe it could work as well for <code>count &gt; 10000</code> to speed up the process"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503506078, "post_id": 45843450, "comment_id": 78648203, "body": "<code>uni</code> should be set to <code>Nothing</code> after <code>uni.Delete</code> and <code>count = 0</code> run."}, {"owner": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503507828, "post_id": 45843450, "comment_id": 78649184, "body": "@Mat&#39;sMug You are correct. I edited my original post with what I &#39;think&#39; is the most optimal solution to my problem."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1503508130, "post_id": 45843450, "comment_id": 78649337, "body": "ugh, that&#39;s messy. please keep the &quot;question&quot; for &quot;question&quot;, and post answers as an &quot;answer&quot; - don&#39;t edit the question to include solutions, that&#39;s not how Q&amp;A works"}], "answers": [{"comments": [{"owner": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "edited": false, "score": 0, "creation_date": 1503503692, "post_id": 45844338, "comment_id": 78646658, "body": "Is there a better way to do this then?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "edited": false, "score": 0, "creation_date": 1503503836, "post_id": 45844338, "comment_id": 78646776, "body": "@MattCottrill - you can give it a try, by recording the rows in a list instead of making a union. Then turn off the animations and delete these rows. It could be that it is faster, but I am not sure."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503506143, "post_id": 45844338, "comment_id": 78648241, "body": "Seems an autofilter and a selection of visible cells could do this without any loops."}, {"owner": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503507039, "post_id": 45844338, "comment_id": 78648764, "body": "@Mat&#39;sMug you are correct that I could eliminate the values from the filter, but I need to comb the data with sumifs for the actual report I&#39;m building, and I don&#39;t believe I can incorporate sumif(ONLY VISIBLE)?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1503503895, "last_edit_date": 1503503895, "creation_date": 1503503529, "answer_id": 45844338, "question_id": 45843450, "link": "https://stackoverflow.com/questions/45843450/vba-union-not-working-as-desired/45844338#45844338", "title": "VBA Union Not Working As Desired", "body": "<p>I have just run your code and it seems that the slowness is not in the deletion, but in the nested loops. You iterate more than 1.4 million times ((610197-591043)*(82-8)) and each time you are probably changing a range. That is usually slow. Think of another way to do it, e.g. record the data in array or list and then try further.</p>\n\n<p>To see yourself, write <code>Stop</code> on the line after <code>Next i</code> and see how quick it reaches it. Then the deletion is quite fast.</p>\n"}, {"tags": [], "owner": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "is_accepted": false, "score": 0, "last_activity_date": 1503509387, "last_edit_date": 1503509387, "creation_date": 1503508766, "answer_id": 45845826, "question_id": 45843450, "link": "https://stackoverflow.com/questions/45843450/vba-union-not-working-as-desired/45845826#45845826", "title": "VBA Union Not Working As Desired", "body": "<p>I've been running the below code successfully. I need to look at some metrics excluding 'top 5', 'top 10', etc for <code>p = 1 to 958</code> for some different reports. Thank you all for your help.</p>\n\n<p>It appears the \"real\" issue was that excel doesn't want to delete groups of rows that aren't grouped, and throws an absolute hissy-fit.</p>\n\n<p>It might be optimal to move the count loop before p, but whatever.</p>\n\n<pre><code>Option Explicit\nSub TrimOut()\nDim wb As Workbook\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim i As Long, p As Long\nDim uni As Range\nDim count As Long\nDim lrow As Long\n\n\nApplication.Calculation = xlCalculationManual\n\n\nSet wb = ThisWorkbook\nSet ws1 = wb.Sheets(1)\nSet ws2 = wb.Sheets(2)\n\nlrow = ws1.Range(\"A\" &amp; ws1.Rows.count).End(xlUp).Row\n\nFor i = lrow To 1 Step -1\n    For p = 1 To 82\n        If Not uni Is Nothing Then\n            If count &gt; i + 1 Then\n                uni.Delete\n                Set uni = Nothing\n            End If\n        End If\n\n        If ws1.Range(\"B\" &amp; i).Value = ws2.Range(\"A\" &amp; p).Value Then\n            If uni Is Nothing Then\n                Set uni = ws1.Rows(i)\n            Else\n                Set uni = Excel.Union(uni, ws1.Rows(i))\n            End If\n            count = i\n        End If\n    Next p\nNext i\n\nIf Not uni Is Nothing Then\n    uni.Delete\nEnd If\n\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518801194, "creation_date": 1503501008, "last_edit_date": 1531164843, "question_id": 45843450, "link": "https://stackoverflow.com/questions/45843450/vba-union-not-working-as-desired", "title": "VBA Union Not Working As Desired", "body": "<p>My code is not working. It breaks on the <code>uni.entirerow.delete</code> line, with error 1004. That indicates that it is building the array, but I must be referencing something wrong? I originally was just having it delete line=by=line, but it takes too long, and there are about 600k rows to go through.</p>\n\n<p>The macro is supposed to reference if the value of Column B equals any of the values of <code>p</code> from <code>ws2</code>. If it does, add it to <code>uni</code> and then delete after the range is fully reviewed. Union is supposed to work much faster than deleting line by line.</p>\n\n<p>Any ideas? Full code below:</p>\n\n<pre><code>Option Explicit\nSub TrimOut()\nDim wb As Workbook\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim i As Long, p As Long\nDim uni As Range\n\nApplication.Calculation = xlCalculationManual\n\n\nSet wb = ThisWorkbook\nSet ws1 = wb.Sheets(1)\nSet ws2 = wb.Sheets(2)\n\nFor i = 610197 To 591043 Step -1\n    For p = 8 To 82\n        If ws1.Range(\"B\" &amp; i).Value = ws2.Range(\"A\" &amp; p).Value Then\n            'ws1.Rows(i).Delete old snippet, works fine\n            If uni Is Nothing Then\n                Set uni = ws1.Cells(i, 1).EntireRow\n            Else\n                Set uni = Application.Union(uni, ws1.Cells(i, 1).EntireRow)\n            End If\n        End If\n    Next p\nNext i\n\nIf Not uni Is Nothing Then\nuni.EntireRow.Delete\nEnd If\n\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>EDIT: Here is a 'working' code, though not optimal.</p>\n\n<pre><code>Option Explicit\nSub TrimOut()\nDim wb As Workbook\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim i As Long, p As Long\nDim uni As Range\nDim count As Long\n\nApplication.Calculation = xlCalculationManual\n\n\nSet wb = ThisWorkbook\nSet ws1 = wb.Sheets(1)\nSet ws2 = wb.Sheets(2)\n\ncount = 0\n\nFor i = 607257 To 1 Step -1\n    For p = 8 To 82\n        If ws1.Range(\"B\" &amp; i).Value = ws2.Range(\"A\" &amp; p).Value Then\n            'ws1.Rows(i).Delete\n            If uni Is Nothing Then\n                Set uni = ws1.Rows(i)\n            Else\n                Set uni = Excel.Union(uni, ws1.Rows(i))\n                count = count + 1\n            End If\n        End If\n\n        If count &gt; 1000 Then\n            uni.Delete\n            count = 0\n        End If\n    Next p\nNext i\n\nIf Not uni Is Nothing Then\n    uni.Delete\nEnd If\n\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1503501088, "post_id": 45843419, "comment_id": 78644821, "body": "You are not <b>putting values into</b> cells; you are <b>getting values from</b> cells."}, {"owner": {"reputation": 328, "user_id": 4665692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BXJxN.jpg?s=128&g=1", "display_name": "sourceCode", "link": "https://stackoverflow.com/users/4665692/sourcecode"}, "edited": false, "score": 0, "creation_date": 1503501097, "post_id": 45843419, "comment_id": 78644827, "body": "You are just overriding the variables with a new value. You never actually update the values"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 2410533, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38e6aa033f737375949f049f6002fd2d?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2410533/harry"}, "edited": false, "score": 0, "creation_date": 1503501896, "post_id": 45843512, "comment_id": 78645376, "body": "thanks! just mixing up my left and right over here, don&#39;t mind me"}], "tags": [], "owner": {"reputation": 559, "user_id": 8478550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blgG0.png?s=128&g=1", "display_name": "Vico", "link": "https://stackoverflow.com/users/8478550/vico"}, "is_accepted": true, "score": 5, "last_activity_date": 1503501158, "creation_date": 1503501158, "answer_id": 45843512, "question_id": 45843419, "link": "https://stackoverflow.com/questions/45843419/excel-will-not-input-value-into-cell/45843512#45843512", "title": "Excel will not input value into cell", "body": "<p>Your assignments are not done correctly. What I would do is:</p>\n\n<pre><code>Dim deut As Double\ndeut = 2\nWorksheets(\"Material PEC\").Cells(2, 2).Value = deut\n</code></pre>\n\n<p>and so on...</p>\n"}, {"tags": [], "owner": {"reputation": 328, "user_id": 4665692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BXJxN.jpg?s=128&g=1", "display_name": "sourceCode", "link": "https://stackoverflow.com/users/4665692/sourcecode"}, "is_accepted": false, "score": 1, "last_activity_date": 1503501251, "creation_date": 1503501251, "answer_id": 45843541, "question_id": 45843419, "link": "https://stackoverflow.com/questions/45843419/excel-will-not-input-value-into-cell/45843541#45843541", "title": "Excel will not input value into cell", "body": "<p>This should work</p>\n\n<pre><code>Sub MaterialSort()\n\nDim deut As Double\nDim am241 As Double\nDim pu238 As Double\nDim pu239 As Double\nDim pu240 As Double\nDim pu241 As Double\nDim np237 As Double\nDim u238 As Double\nDim u235 As Double\nDim u233 As Double\nDim am243 As Double\n\ndeut = 2\nam241 = 2\npu238 = 1\npu239 = 3\npu240 = 3\npu241 = 4\nnp237 = 5\nu238 = 12\nu235 = 4\nu233 = 4\nam243 = 5\n\nWorksheets(\"Material PEC\").Cells(2, 2).Value = deut\nWorksheets(\"Material PEC\").Cells(3, 2).Value = am241\nWorksheets(\"Material PEC\").Cells(4, 2).Value = pu238 \nWorksheets(\"Material PEC\").Cells(5, 2).Value = pu239\nWorksheets(\"Material PEC\").Cells(6, 2).Value = pu240\nWorksheets(\"Material PEC\").Cells(7, 2).Value = pu241 \nWorksheets(\"Material PEC\").Cells(8, 2).Value = np237\nWorksheets(\"Material PEC\").Cells(9, 2).Value = u238\nWorksheets(\"Material PEC\").Cells(10, 2).Value = u235\nWorksheets(\"Material PEC\").Cells(11, 2).Value = u233\nWorksheets(\"Material PEC\").Cells(12, 2).Value = am243\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8452081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a284f53c052aa1e64149bf9645b9de?s=128&d=identicon&r=PG&f=1", "display_name": "Benny0407", "link": "https://stackoverflow.com/users/8452081/benny0407"}, "is_accepted": false, "score": 0, "last_activity_date": 1503501306, "creation_date": 1503501306, "answer_id": 45843560, "question_id": 45843419, "link": "https://stackoverflow.com/questions/45843419/excel-will-not-input-value-into-cell/45843560#45843560", "title": "Excel will not input value into cell", "body": "<p>Looks like you are setting the current value to a variable then setting a new value to that variable and never actually updating the cell itself.</p>\n\n<p>To put code into the cell it should look something like this</p>\n\n<pre><code>duet = 2\nWorksheets(\"Material PEC\").Cells(2, 2).Value = deut\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": false, "score": 0, "last_activity_date": 1503501429, "creation_date": 1503501429, "answer_id": 45843606, "question_id": 45843419, "link": "https://stackoverflow.com/questions/45843419/excel-will-not-input-value-into-cell/45843606#45843606", "title": "Excel will not input value into cell", "body": "<p>The code that you have posted in your question is not assigning a cell a value.  In the first block you are assigning the variables values from the cells and in the second block you are reassigning them.</p>\n\n<p>You will need to have range and double variables instead of just double variables in order to do what I think you want to do.  </p>\n\n<pre><code>Sub MaterialSort()\n\nDim deut As Double\nDim am241 As Double\nDim pu238 As Double\nDim pu239 As Double\nDim pu240 As Double\nDim pu241 As Double\nDim np237 As Double\nDim u238 As Double\nDim u235 As Double\nDim u233 As Double\nDim am243 As Double\n\nDim deut_rng As Range\nDim am241_rng As Range\nDim pu238_rng As Range\nDim pu239_rng As Range\nDim pu240_rng As Range\nDim pu241_rng As Range\nDim np237_rng As Range\nDim u238_rng As Range\nDim u235_rng As Range\nDim u233_rng As Range\nDim am243_rng As Range\n\nset deut_rng = Worksheets(\"Material PEC\").Cells(2, 2)\nset am241_rng = Worksheets(\"Material PEC\").Cells(3, 2)\nset pu238_rng = Worksheets(\"Material PEC\").Cells(4, 2)\nset pu239_rng = Worksheets(\"Material PEC\").Cells(5, 2)\nset pu240_rng = Worksheets(\"Material PEC\").Cells(6, 2)\nset pu241_rng = Worksheets(\"Material PEC\").Cells(7, 2)\nset np237_rng = Worksheets(\"Material PEC\").Cells(8, 2)\nset u238_rng = Worksheets(\"Material PEC\").Cells(9, 2)\nset u235_rng = Worksheets(\"Material PEC\").Cells(10, 2)\nset u233_rng = Worksheets(\"Material PEC\").Cells(11, 2)\nset am243_rng = Worksheets(\"Material PEC\").Cells(12, 2)\n\n\n\ndeut = Worksheets(\"Material PEC\").Cells(2, 2).Value\nam241 = Worksheets(\"Material PEC\").Cells(3, 2).Value\npu238 = Worksheets(\"Material PEC\").Cells(4, 2).Value\npu239 = Worksheets(\"Material PEC\").Cells(5, 2).Value\npu240 = Worksheets(\"Material PEC\").Cells(6, 2).Value\npu241 = Worksheets(\"Material PEC\").Cells(7, 2).Value\nnp237 = Worksheets(\"Material PEC\").Cells(8, 2).Value\nu238 = Worksheets(\"Material PEC\").Cells(9, 2).Value\nu235 = Worksheets(\"Material PEC\").Cells(10, 2).Value\nu233 = Worksheets(\"Material PEC\").Cells(11, 2).Value\nam243 = Worksheets(\"Material PEC\").Cells(12, 2).Value\n\n\ndeut_rng.value = 2\nam241_rng.value = 2\npu238_rng.value = 1\npu239_rng.value = 3\npu240_rng.value = 3\npu241_rng.value = 4\nnp237_rng.value = 5\nu238_rng.value = 12\nu235_rng.value = 4\nu233_rng.value = 4\nam243_rng.value = 5\n\nEnd Sub\n</code></pre>\n\n<p>This saves the original values of the cells into all of the double variables and then allows you to change the values in the cells using the range varaibles.</p>\n"}], "owner": {"reputation": 33, "user_id": 2410533, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38e6aa033f737375949f049f6002fd2d?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2410533/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 45843512, "answer_count": 4, "score": -1, "last_activity_date": 1503501435, "creation_date": 1503500936, "last_edit_date": 1503501435, "question_id": 45843419, "link": "https://stackoverflow.com/questions/45843419/excel-will-not-input-value-into-cell", "title": "Excel will not input value into cell", "body": "<p>I am having an issue updating the value of a cell. Below is a test code I am running to just ensure I can update a cell value. There are no errors but the cells remain empty upon running the code.</p>\n\n<p>Edit: I'm not very versed in the vba syntax so I have updated the code below to show what I am attempting to do. Basically I want to find a value corresponding with a certain material, then sum all values found. I know you say I am not inputting values but instead am pulling them. I believed I was initializing the variable. How do I input the value instead?</p>\n\n<pre><code>Sub MaterialSort()\n\nDim deut As Double\nDim am241 As Double\nDim pu238 As Double\nDim pu239 As Double\nDim pu240 As Double\nDim pu241 As Double\nDim np237 As Double\nDim u238 As Double\nDim u235 As Double\nDim u233 As Double\nDim am243 As Double\n\n\ndeut = Worksheets(\"Material PEC\").Cells(2, 2).Value\nam241 = Worksheets(\"Material PEC\").Cells(3, 2).Value\npu238 = Worksheets(\"Material PEC\").Cells(4, 2).Value\npu239 = Worksheets(\"Material PEC\").Cells(5, 2).Value\npu240 = Worksheets(\"Material PEC\").Cells(6, 2).Value\npu241 = Worksheets(\"Material PEC\").Cells(7, 2).Value\nnp237 = Worksheets(\"Material PEC\").Cells(8, 2).Value\nu238 = Worksheets(\"Material PEC\").Cells(9, 2).Value\nu235 = Worksheets(\"Material PEC\").Cells(10, 2).Value\nu233 = Worksheets(\"Material PEC\").Cells(11, 2).Value\nam243 = Worksheets(\"Material PEC\").Cells(12, 2).Value\n\n\nFor j = 2 To 82 Step 8\nFor i = 3 To 70\n\n    k = j + 5\n\nIf Not IsError(Worksheets(\"Master PEC\").Cells(i, j)) Then\n\n    If Worksheets(\"Master PEC\").Cells(i, j) = \"Deuterium\" Then\n\n        deut = Worksheets(\"Master PEC\").Cells(i, k).Value + deut\n\n    ElseIf Worksheets(\"Master PEC\").Cells(i, j) = \"Am-241\" Then\n\n        am241 = Worksheets(\"Master PEC\").Cells(i, k).Value + am241\n\n    ElseIf Worksheets(\"Master PEC\").Cells(i, j) = \"Pu-238\" Then\n\n        pu238 = Worksheets(\"Master PEC\").Cells(i, k).Value + pu238\n\n    ElseIf Worksheets(\"Master PEC\").Cells(i, j) = \"Pu-239\" Then\n\n        pu239 = Worksheets(\"Master PEC\").Cells(i, k) + pu239\n\n    ElseIf Worksheets(\"Master PEC\").Cells(i, j) = \"Pu-240\" Then\n\n        pu240 = Worksheets(\"Master PEC\").Cells(i, k) + pu240\n\n    ElseIf Worksheets(\"Master PEC\").Cells(i, j) = \"Pu-241\" Then\n\n        pu241 = Worksheets(\"Master PEC\").Cells(i, k) + pu241\n\n    ElseIf Worksheets(\"Master PEC\").Cells(i, j) = \"Np-237\" Then\n\n        np237 = Worksheets(\"Master PEC\").Cells(i, k) + np237\n\n    ElseIf Worksheets(\"Master PEC\").Cells(i, j) = \"Dep. U-238\" Then\n\n        u238 = Worksheets(\"Master PEC\").Cells(i, k) + u238\n\n    ElseIf Worksheets(\"Master PEC\").Cells(i, j) = \"Enr. U-235\" Then\n\n        u235 = Worksheets(\"Master PEC\").Cells(i, k) + u235\n\n    ElseIf Worksheets(\"Master PEC\").Cells(i, j) = \"U-233\" Then\n\n        u233 = Worksheets(\"Master PEC\").Cells(i, k) + u233\n\n    ElseIf Worksheets(\"Master PEC\").Cells(i, j) = \"Am-243\" Then\n\n        am243 = Worksheets(\"Master PEC\").Cells(i, k) + am243\n\n    End If\n\nEnd If\nNext\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "activex"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503501977, "post_id": 45843349, "comment_id": 78645426, "body": "So, what code did you try, and exactly what isn&#39;t working? Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503511647, "post_id": 45843349, "comment_id": 78651316, "body": "examine the <code>fld</code> object in the <i>Watch window</i>. one of the properties may be what you need. ... maybe examine <code>fld.OLEFormat.Object</code>, so that you don&#39;t have to go through the <code>fld</code> object properties tree to get to it"}, {"owner": {"reputation": 287, "user_id": 8472528, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh3.googleusercontent.com/-hDvvLF9xDuQ/AAAAAAAAAAI/AAAAAAAAAAw/Ytzszc3OK8k/photo.jpg?sz=128", "display_name": "Jan Hor\u010di\u010dka", "link": "https://stackoverflow.com/users/8472528/jan-hor%c4%8di%c4%8dka"}, "edited": false, "score": 0, "creation_date": 1503560656, "post_id": 45843349, "comment_id": 78669386, "body": "I did that. You can see that there is nothing in the OLEFormat.Object - <a href=\"http://www.janhorcicka.com/files/object.JPG\" rel=\"nofollow noreferrer\">See here</a>. I also went through the whole fld and didnt find anything there either. That&#39;s why I am asking."}], "owner": {"reputation": 287, "user_id": 8472528, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh3.googleusercontent.com/-hDvvLF9xDuQ/AAAAAAAAAAI/AAAAAAAAAAw/Ytzszc3OK8k/photo.jpg?sz=128", "display_name": "Jan Hor\u010di\u010dka", "link": "https://stackoverflow.com/users/8472528/jan-hor%c4%8di%c4%8dka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1503560753, "creation_date": 1503500734, "last_edit_date": 1503560753, "question_id": 45843349, "link": "https://stackoverflow.com/questions/45843349/position-of-activex-control-in-a-word-table", "title": "Position of ActiveX control in a Word table", "body": "<p>I have a Word document with multiple tables. Inside each table, there are multiple ActiveX controls - labels. </p>\n\n<p>I would like to loop through all the labels and find their position in the table so I can reference the name of the table and the column header to use it in another part of the code.</p>\n\n<p>Other way to do it would be to loop through all the cells in all tables and check if there is a label inside (and check its name).</p>\n\n<p>However I cannot find solution to any of these two options.</p>\n\n<p>This thread unfortunately does not help: <a href=\"https://stackoverflow.com/questions/42934194/word-vba-get-position-of-an-activex-control-within-a-table\">word vba: get position of an ActiveX control within a table</a></p>\n\n<p>The code below gets me the caption of every label.</p>\n\n<pre><code>Dim fld As Field\nFor Each fld In ThisDocument.Fields\n    Debug.Print fld.OLEFormat.Object.Caption\nNext\n</code></pre>\n\n<p>However, I didn't find a way to get its position (ideally the table cell).</p>\n\n<p>EDIT: I went through all properties in fld and fld.OLEFormat.Object, but didn't find anything.</p>\n"}, {"tags": ["macos", "excel", "checkbox", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1503502556, "post_id": 45843234, "comment_id": 78645867, "body": "That code works for me, as does <code>ThisWorkbook.Sheets(&quot;Sheet1&quot;).CheckBoxes(&quot;Check Box 66&quot;).Value = True</code>"}, {"owner": {"reputation": 11, "user_id": 8501966, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gZHWxw812_I/AAAAAAAAAAI/AAAAAAAAAiU/bDaWx4EAYFs/photo.jpg?sz=128", "display_name": "Matthew Jordan", "link": "https://stackoverflow.com/users/8501966/matthew-jordan"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1503517144, "post_id": 45843234, "comment_id": 78654247, "body": "Thanks for the feedback. I think my problem was that the original file was built on a PC and the checkboxes from the PC did not function the same as the checkboxes on the MAC. After adding new checkboxes (from the MAC) the code now works."}], "owner": {"reputation": 11, "user_id": 8501966, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gZHWxw812_I/AAAAAAAAAAI/AAAAAAAAAiU/bDaWx4EAYFs/photo.jpg?sz=128", "display_name": "Matthew Jordan", "link": "https://stackoverflow.com/users/8501966/matthew-jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 597, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1503514632, "creation_date": 1503500369, "last_edit_date": 1531164843, "question_id": 45843234, "link": "https://stackoverflow.com/questions/45843234/excel-2016-vba-on-mac-how-to-set-a-form-control-checkbox-to-true", "title": "Excel 2016 VBA on Mac - How to set a &#39;Form&#39; Control Checkbox to &#39;True&#39;", "body": "<p>I'm attempting to set the status of a <code>Form Control</code> checkbox to <code>True</code> in Excel 2016 on a MAC. I keep getting a run-time error 438 and have tried multiple ways of calling the sheet, the workbook, and the checkboxes but none seem to work. </p>\n\n<p>Here is the code: (Sheet Name: Sheet1)</p>\n\n<pre><code>Sub SetCheckboxes()\n\nThisWorkbook.Sheets(\"Sheet1\").Shapes(\"Check Box 66\").OLEFormat.Object.Value = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1503500409, "post_id": 45843106, "comment_id": 78644331, "body": "It will tend to take time as the data is too large"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1503500411, "post_id": 45843106, "comment_id": 78644333, "body": "Look into <code>Range.Find</code> instead of looping. Get rid of nested loops if at all possible. Don&#39;t leave the loop going unnecessarily after a match has been found. Load your data into an array before making the comparison. Generally, have a look at this <a href=\"http://www.ozgrid.com/VBA/SpeedingUpVBACode.htm\" rel=\"nofollow noreferrer\">ozgrid page</a> for an introduction."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1503502790, "post_id": 45843106, "comment_id": 78646028, "body": "You&#39;re a beginner, so it will be very difficult to properly improve the process. That said, I don&#39;t believe in learning bad habits purely for the sake of not wanting to learn good habits. I strongly recommend learning arrays and dictionaries. It takes a bit at first, but if you can learn them, this will be a breeze. That said, at the very least, put an <code>Exit For</code> in your loops when a <code>Match</code> condition is met. Be sure to qualify your ranges as well (they currently rely on the implicit <code>ActiveWorkbook</code> which is prone to failure)."}, {"owner": {"reputation": 13, "user_id": 8506738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ea639eba18c93d7b61c32449c0ea374?s=128&d=identicon&r=PG&f=1", "display_name": "TheCricket", "link": "https://stackoverflow.com/users/8506738/thecricket"}, "edited": false, "score": 0, "creation_date": 1503910294, "post_id": 45843106, "comment_id": 78788652, "body": "1) I looked into <code>Range.Find</code> and it seems much easier indeed and I will test it as well! For now it works with the lovely solution provided by Mooseman."}, {"owner": {"reputation": 13, "user_id": 8506738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ea639eba18c93d7b61c32449c0ea374?s=128&d=identicon&r=PG&f=1", "display_name": "TheCricket", "link": "https://stackoverflow.com/users/8506738/thecricket"}, "edited": false, "score": 0, "creation_date": 1503910762, "post_id": 45843106, "comment_id": 78788906, "body": "2) I am indeed a more than a beginner at this and thank you for the advice! I do not have a problem with wanting to learn the good habits, though it has been confusing which ones are which, I have start with this a little over two weeks ago with no background whatsoever and had to find a way two make it work in two weeks to have something to show to the management. I do not know if I will be doing more of this in the future, but it has been quite a ride, I felt at times that I should just stop torturing myself but I have really enjoyed it the same time  :)))"}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 8340269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H13Pt.jpg?s=128&g=1", "display_name": "Benjamin Goldwater", "link": "https://stackoverflow.com/users/8340269/benjamin-goldwater"}, "is_accepted": false, "score": 0, "last_activity_date": 1503501403, "creation_date": 1503501403, "answer_id": 45843593, "question_id": 45843106, "link": "https://stackoverflow.com/questions/45843106/excel-vba-compare-two-columns-in-two-different-sheets-then-copy-paste-speed/45843593#45843593", "title": "Excel VBA - Compare two Columns in two different sheets then copy/paste - speed - It takes over an hour", "body": "<p>This is slow because your macro is iterating through 55,000 * 2,500 rows of data, twice. That's 275,000,000 cycles.</p>\n\n<p>I think the solution is to scrap the macro and use <code>VLOOKUP</code> or <code>Index</code> <code>Match</code>.</p>\n\n<p>You could add this formula to cell Q2 of sheet1:</p>\n\n<pre><code>=IFERROR(INDEX(Sheet2!$Q:$Q,MATCH(Sheet1!$K2,Sheet2!$A:$A,0)),\"NO MATCH\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KblV1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KblV1.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/SclNO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SclNO.png\" alt=\"enter image description here\"></a></p>\n\n<p>That is how I would do this. If you need it to be a macro, you can write a macro that just sets Sheet1 K2 to have this formula and drag the formula down.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8506738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ea639eba18c93d7b61c32449c0ea374?s=128&d=identicon&r=PG&f=1", "display_name": "TheCricket", "link": "https://stackoverflow.com/users/8506738/thecricket"}, "edited": false, "score": 0, "creation_date": 1503908772, "post_id": 45846212, "comment_id": 78787860, "body": "Thank you! Your answer was truly enlightening!"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 2, "last_activity_date": 1503510105, "creation_date": 1503510105, "answer_id": 45846212, "question_id": 45843106, "link": "https://stackoverflow.com/questions/45843106/excel-vba-compare-two-columns-in-two-different-sheets-then-copy-paste-speed/45846212#45846212", "title": "Excel VBA - Compare two Columns in two different sheets then copy/paste - speed - It takes over an hour", "body": "<p>This will loop through rows to match column A on Sheet1 with column K on sheet2.  On a non-match \"No Match\" will be put in Sheet1 column Q.\nOn a match Sheet2 columns O,P and Q will be copied to Sheet1 columns O,P and Q.\nThis took about 10 seconds to run for over 12k in column A and over 2500 in column K. </p>\n\n<pre><code>Sub match_columns()\nDim I, total, fRow As Integer\nDim found As Range\n\ntotal = Sheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor I = 1 To total\n    answer1 = Worksheets(1).Range(\"A\" &amp; I).Value\n Set found = Sheets(2).Columns(\"K:K\").Find(what:=answer1) 'finds a match\nIf found Is Nothing Then   \n    Worksheets(1).Range(\"Q\" &amp; I).Value = \"NO MATCH\"\nElse\n    fRow = Sheets(2).Columns(\"K:K\").Find(what:=answer1).Row\n    Worksheets(1).Range(\"O\" &amp; I).Value = Worksheets(2).Range(\"O\" &amp; fRow).Value\n    Worksheets(1).Range(\"P\" &amp; I).Value = Worksheets(2).Range(\"P\" &amp; fRow).Value\n    Worksheets(1).Range(\"Q\" &amp; I).Value = Worksheets(2).Range(\"Q\" &amp; fRow).Value\n End If\nNext I\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8506738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ea639eba18c93d7b61c32449c0ea374?s=128&d=identicon&r=PG&f=1", "display_name": "TheCricket", "link": "https://stackoverflow.com/users/8506738/thecricket"}, "is_accepted": false, "score": 1, "last_activity_date": 1503910959, "last_edit_date": 1503910959, "creation_date": 1503909997, "answer_id": 45915062, "question_id": 45843106, "link": "https://stackoverflow.com/questions/45843106/excel-vba-compare-two-columns-in-two-different-sheets-then-copy-paste-speed/45915062#45915062", "title": "Excel VBA - Compare two Columns in two different sheets then copy/paste - speed - It takes over an hour", "body": "<p>Thank you again @Mooseman for providing the solution! </p>\n\n<p>I only had to change Range A with K, at first even so I was not able to make it work as it copied only the first line. I already had some code which opened the Worksheets and copied them to a new Worksheet/added new columns ..etc., to be SavedAs for later use, and it seems that because of this your code was not able to loop properly (not sure how to explain this) in any case at the end of the open / save workbooks ..etc I have introduced a <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/calling-sub-and-function-procedures\" rel=\"nofollow noreferrer\">Call Sub Procedure</a>  which worked like a charm!  </p>\n\n<p>Also, introduced two extra lines to properly format columns O and P as Date. </p>\n\n<p>I am sure it could have looked better than this, but so far it works! </p>\n\n<p>And thank you to everyone who provided me with suggestions, there is still a lot to learn and I am planning to test other ways just for the sake of learning, but I needed this to work now. </p>\n\n<pre><code>Sub Button1_Click()\n\n   With Application\n        .AskToUpdateLinks = False\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n   End With\n\n'Code to Open / Save / introduce  new columns into Sheet(1)\n\nCall match_columns\nEnd Sub\n\nSub match_columns()\n\nDim I, total, frow As Integer\nDim found As Range\n\ntotal = Sheets(1).Range(\"K\" &amp; Rows.Count).End(xlUp).Row\n 'MsgBox (total) --&gt; used to test if it can count/see the total number of rows\n\nFor I = 2 To total\n    answer1 = Worksheets(1).Range(\"K\" &amp; I).Value\n Set found = Sheets(2).Columns(\"A:A\").Find(what:=answer1) 'finds a match\n\nIf found Is Nothing Then\n    Worksheets(1).Range(\"Q\" &amp; I).Value = \"NO MATCH\"\nElse\n    frow = Sheets(2).Columns(\"A:A\").Find(what:=answer1).Row\n    Worksheets(1).Range(\"O\" &amp; I).Value = Worksheets(2).Range(\"O\" &amp; frow).Value\n    Worksheets(1).Range(\"P\" &amp; I).Value = Worksheets(2).Range(\"P\" &amp; frow).Value\n    Worksheets(1).Range(\"Q\" &amp; I).Value = Worksheets(2).Range(\"Q\" &amp; frow).Value\n\n End If\nNext I\n\nWorksheets(1).Range(\"P2\", \"P\" &amp; total).NumberFormat = \"dd.mm.yyyy\"\nWorksheets(1).Range(\"O2\", \"O\" &amp; total).NumberFormat = \"dd.mm.yyyy\"\n\n\n  With Application\n        .ScreenUpdating = True\n        .DisplayAlerts = True\n        .EnableEvents = True\n        .AskToUpdateLinks = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8506738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ea639eba18c93d7b61c32449c0ea374?s=128&d=identicon&r=PG&f=1", "display_name": "TheCricket", "link": "https://stackoverflow.com/users/8506738/thecricket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11528, "favorite_count": 0, "accepted_answer_id": 45846212, "answer_count": 3, "score": 0, "last_activity_date": 1503910959, "creation_date": 1503500003, "last_edit_date": 1503500830, "question_id": 45843106, "link": "https://stackoverflow.com/questions/45843106/excel-vba-compare-two-columns-in-two-different-sheets-then-copy-paste-speed", "title": "Excel VBA - Compare two Columns in two different sheets then copy/paste - speed - It takes over an hour", "body": "<p>Here an absolute beginner at any form of coding, this is the first time ever I try to use VBA. </p>\n\n<p>I have managed after a week and a half of searching and testing and learning to reach the below posted code and I have hit a WALL (and I'm not even done yet!) </p>\n\n<p>What I am trying to achieve:</p>\n\n<p>Compare the data in sheet1 with the data in sheet2 found in Columns K respectively A (there are ca. 55.000 rows in K and 2500 in A) the data might repeat itself as these are product codes and it's ok as at the end of this I want to be able to see which ones have expired. </p>\n\n<p>so .. If K = A then it has to copy adjacent values found in Sheet2 - columns O, P &amp; Q and Paste them in Sheet2 - Columns O, P &amp; Q and if no match is found then right not found. In the Example below I have only tried to copy Q, it would probably take forever if I tried adding O &amp; P.</p>\n\n<p>(Note: I have found this code in one of the forms here and used it after trying different other ways with select/ Copy/ Paste etc. but none have worked)</p>\n\n<p>Later I would like to try adding another column in Sheet1 and based on the Date which will be copied to Sheet1 and into column P populate it with Expired or Soon to be expired depending on the case, but this is an entire different story and I haven't even begun thinking how to do it. </p>\n\n<p>The problem is that my current code takes over an hour and it's still not finished yet while I am writing this!!! And I do not understand where have I gone wrong ....   </p>\n\n<pre><code>Dim lastRow1 As Long\nDim lastRow2 As Long\nDim tempVal As String\n\n\n\nlastRow1 = Sheets(\"Sheet1\").Range(\"K\" &amp; Rows.Count).End(xlUp).Row\nlastRow2 = Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).Row\n\nFor sRow = 2 To lastRow1\n        tempVal = Sheets(\"MatCode\").Cells(sRow, \"A\").Text\nFor tRow = 2 To lastRow2\n            If Sheets(\"Sheet1\").Cells(tRow, \"K\") = tempVal Then\n            Sheets(\"Sheet1\").Cells(tRow, \"Q\") = Sheets(\"Sheet2\").Cells(sRow, \"Q\")\n            End If\n\n    Next tRow\n    Next sRow\n\nDim match As Boolean\n'now if no match was found, then put NO MATCH in cell\n    For lRow = 2 To lastRow2\n        match = False\n        tempVal = Sheets(\"Sheet1\").Cells(lRow, \"K\").Text\n\nFor sRow = 2 To lastRow1\n            If Sheets(\"Sheet2\").Cells(sRow, \"A\") = tempVal Then\n                match = True\n            End If\n        Next sRow\nIf match = False Then\n            Sheets(\"Sheet1\").Cells(lRow, \"Q\") = \"NO MATCH\"\n        End If\n    Next lRow\nEnd Sub\n</code></pre>\n\n<p>I have also used: </p>\n\n<pre><code>With Application\n    .AskToUpdateLinks = False\n    .ScreenUpdating = False\n    .DisplayAlerts = False\n    .EnableEvents = False\nEnd With\n</code></pre>\n\n<p>To make sure nothing stands in the way. </p>\n\n<p>Please Help! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "edited": false, "score": 1, "creation_date": 1503500099, "post_id": 45842752, "comment_id": 78644098, "body": "Did you try checking the color with the corresponding RGB value? Since SchemeColor depends on the current color scheme it might be looking for a different color than you&#39;d expect."}, {"owner": {"reputation": 33, "user_id": 8360912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0748946b8d0692c0cefc5b63c22778eb?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/8360912/catherine"}, "reply_to_user": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "edited": false, "score": 0, "creation_date": 1503500869, "post_id": 45842752, "comment_id": 78644666, "body": "Oh yes! I changed the color value to a RGB one and it works now. Thank you so much!"}, {"owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "edited": false, "score": 0, "creation_date": 1503501429, "post_id": 45842752, "comment_id": 78645068, "body": "You&#39;re welcome! I&#39;ve posted my comment as an answer so you can accept it and close the question. :)"}], "answers": [{"tags": [], "owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "is_accepted": true, "score": 3, "last_activity_date": 1503501384, "creation_date": 1503501384, "answer_id": 45843585, "question_id": 45842752, "link": "https://stackoverflow.com/questions/45842752/excel-vba-use-the-color-of-a-shape-in-an-if-then-case/45843585#45843585", "title": "Excel VBA : Use the color of a shape in an If/Then case", "body": "<p>Did you try checking the color with the corresponding RGB value? Since SchemeColor depends on the current color scheme it might be looking for a different color than you'd expect </p>\n"}], "owner": {"reputation": 33, "user_id": 8360912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0748946b8d0692c0cefc5b63c22778eb?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/8360912/catherine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 45843585, "answer_count": 1, "score": 0, "last_activity_date": 1503546823, "creation_date": 1503499021, "last_edit_date": 1503546823, "question_id": 45842752, "link": "https://stackoverflow.com/questions/45842752/excel-vba-use-the-color-of-a-shape-in-an-if-then-case", "title": "Excel VBA : Use the color of a shape in an If/Then case", "body": "<p>I have created a chart on Excel using macros. Each of the shapes on the chart is filled with a color according to its category. I was wondering if it is possible to use the color of the shapes in an If/Then case to perform different actions, such as displaying the shapes with specific colors only.\nFor example, something similar to:</p>\n\n<pre><code>If shape.Fill.ForeColor.SchemeColor = 1 Then\n   shape.delete\n</code></pre>\n\n<p>I have tried that, but it doesn't seem to do anything to my chart. Does anyone have an idea of how to do it?</p>\n\n<p>Thank you !!</p>\n"}, {"tags": ["vba", "excel", "internet-explorer-11", "peoplesoft", "office-2010"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 1, "creation_date": 1503499532, "post_id": 45842706, "comment_id": 78643629, "body": "Can you use <code>While ExpApp.Busy Or ExpApp.ReadyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend</code>"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 1, "creation_date": 1503501131, "post_id": 45842706, "comment_id": 78644854, "body": "@nishitdey...........thanks.  that got me past the error until I hit the next ExpApp line.  I&#39;m afraid I&#39;m going to have to re-write this macro.  Thanks for your help"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1503511150, "post_id": 45842706, "comment_id": 78651034, "body": "Try to play with variations of IE <a href=\"https://www.google.ru/search?q=ie+compatibility+mode&amp;tbm=isch\" rel=\"nofollow noreferrer\">compatibility</a>, <a href=\"https://www.google.ru/search?q=ie+browser+mode&amp;tbm=isch\" rel=\"nofollow noreferrer\">browser</a> and <a href=\"https://www.google.ru/search?q=ie+document+mode&amp;tbm=isch\" rel=\"nofollow noreferrer\">document</a> modes. Also take a look at <a href=\"https://stackoverflow.com/a/23232573/2165759\">this</a> and <a href=\"https://stackoverflow.com/a/41595471/2165759\">this</a> answers."}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1503533312, "post_id": 45842706, "comment_id": 78660201, "body": "Something is closing before the script can finish. I run into this occasionally when I close an IE window manually and my script is designed to close the window for me. Sometimes I have to set the delay to 3, 4, or 5 seconds to allow a page to fully load, before moving on."}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1503498930, "creation_date": 1503498930, "question_id": 45842706, "link": "https://stackoverflow.com/questions/45842706/excel-visual-basic-produces-the-object-invoked-as-disconnected-from-its-clients", "title": "Excel Visual Basic produces The object invoked as disconnected from its clients", "body": "<p>My macro uses Internet Explorer to open PeopleSoft Financials and then run a public query.  It has been working for a long time until recently.  I'm aware of an update to Internet Explorer on our machines in early July and am wondering if that has caused this issue.</p>\n\n<p>The macro is throwing an \"Object has disconnected from its  clients\" error message.</p>\n\n<p>Here is how the variable for Internet Explorer is defined:\nPublic ExpApp As InternetExplorer</p>\n\n<p>Here is the code where the error is thown:</p>\n\n<pre><code>Set ExpApp = CreateObject(\"InternetExplorer.Application\")\nExpApp.Visible = True\n\nExpApp.navigate vLogin\n\nDo Until ExpApp.readyState = READYSTATE_COMPLETE   ' ERROR IS THROWN HERE\nMyTimer\nLoop\n\nDo Until ExpApp.document.Title &lt;&gt; \"PeopleSoft 8 Sign-in\"\nMyTimer\nLoop\n\nDo Until ExpApp.readyState = READYSTATE_COMPLETE\nMyTimer\nLoop\n</code></pre>\n\n<p>vLogin is a string with the URL to the PeopleSoft login screen\nMyTimer is a little function that waits 1 second each time it is kicked off</p>\n\n<p>This macro has been around a while so I imagine that this is pretty old code.  I'm hoping there are a few minor changes I could make instead of re-writing this macro.</p>\n\n<p>Any suggestions would be greatly appreciated.  Thanks for the help......</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "is_accepted": true, "score": 2, "last_activity_date": 1503505461, "creation_date": 1503505461, "answer_id": 45844923, "question_id": 45842604, "link": "https://stackoverflow.com/questions/45842604/automation-error-while-generating-the-chart/45844923#45844923", "title": "automation error while generating the chart", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub chart()\n    Dim rng As Range\n    Dim cht As Chart\n    Dim Ws As Worksheet\n\n    Set Ws = ThisWorkbook.Sheets(\"Test\")\n    Set rng = Ws.Range(\"G1:J2\")\n    Set sh = ThisWorkbook.Sheets(\"status\")\n\n    sh.Shapes.AddChart(Left:=400, Top:=100, Width:=390, Height:=250).Select\n    Set cht = ActiveChart\n\n    With cht\n        .SetSourceData Source:=rng\n        .ChartType = xlColumnClustered\n        .SeriesCollection(1).Points(1).Format.Fill.ForeColor.RGB = RGB(255, 0, 0)\n        .SeriesCollection(1).Points(2).Format.Fill.ForeColor.RGB = RGB(0, 255, 0)\n        .SeriesCollection(1).Points(3).Format.Fill.ForeColor.RGB = RGB(0, 0, 255)\n        .SeriesCollection(1).Points(4).Format.Fill.ForeColor.RGB = RGB(80, 100, 10)\n        .ChartTitle.Text = \"Status\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 45844923, "answer_count": 1, "score": 0, "last_activity_date": 1503505461, "creation_date": 1503498642, "last_edit_date": 1503498994, "question_id": 45842604, "link": "https://stackoverflow.com/questions/45842604/automation-error-while-generating-the-chart", "title": "automation error while generating the chart", "body": "<p>I am trying to generate a chart out of a table. </p>\n\n<p>The table is in my sheet \"Test\" and I want my chart in the sheet \"status\". </p>\n\n<p>I am using a code in which I am getting an automation error in the line</p>\n\n<pre><code>.SetSourceData Source:=rng\n</code></pre>\n\n<p>I am not getting the error everytime. for every 30 or more iterations, I get this error. </p>\n\n<p>Could anyone help, how I can rectify this</p>\n\n<pre><code>Sub chart()\nDim rng As Range\nDim cht As Object\nDim Ws As Worksheet\nSet Ws = Sheets(\"Test\")\nSet rng = Ws.Range(\"G1:J2\")\nSet sh = ActiveSheet.ChartObjects.Add(Left:=400, _\n    Width:=390, _\n    Top:=100, _\n    Height:=250)\nsh.Select\nSet cht = ActiveChart\nWith cht\n.SetSourceData Source:=rng\n.ChartType = xlColumnClustered\n ActiveChart.FullSeriesCollection(1).Points(1).Format.Fill.ForeColor.RGB = RGB(255, 0, 0)\n ActiveChart.FullSeriesCollection(1).Points(2).Format.Fill.ForeColor.RGB = RGB(0, 255, 0)\n  ActiveChart.FullSeriesCollection(1).Points(3).Format.Fill.ForeColor.RGB = RGB(0, 0, 255)\n  ActiveChart.FullSeriesCollection(1).Points(4).Format.Fill.ForeColor.RGB = RGB(80, 100, 10)\n'cht.Axes(xlSecondary).TickLabels.NumberFormat = \"0.0%\"\nEnd With\n'cht.SeriesCollection(1).name = \"\"\ncht.SeriesCollection(1).HasDataLabels = True\ncht.HasTitle = True\ncht.ChartTitle.Text = \"Status\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1503498378, "post_id": 45842439, "comment_id": 78642571, "body": "Only by looping and checking the FirstName property of each item."}], "answers": [{"comments": [{"owner": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "edited": false, "score": 0, "creation_date": 1503499666, "post_id": 45842867, "comment_id": 78643729, "body": "Thanks Mat.  Yeah - Linq was kind of what I was envisioning, but was hoping there would be something simpler"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "edited": false, "score": 0, "creation_date": 1503499699, "post_id": 45842867, "comment_id": 78643756, "body": "@keynesiancross remember, LINQ came to .NET in version 3.5. C# 2.0 didn&#39;t even have generics. VBA predates all of that."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1503499337, "creation_date": 1503499337, "answer_id": 45842867, "question_id": 45842439, "link": "https://stackoverflow.com/questions/45842439/vba-query-collection-of-custom-classes/45842867#45842867", "title": "VBA - Query collection of custom classes", "body": "<p>You could go out of your way to implement <a href=\"https://codereview.stackexchange.com/q/66706/23788\">something like this</a> so you could do crazy stuff like:</p>\n\n<pre><code>Dim items As LinqEnumerable\nSet items = LinqEnumerable.FromCollection(myCollection) _\n                          .Where(\"x =&gt; x.FirstName = \"\"Jack\"\"\")\n\nDim p As Person '\"People\" is plural, you don't want a pluralized class name here.\nFor Each p In items\n    Debug.Print p.FirstName\nNext\n</code></pre>\n\n<p>But that is very very much overkill, and inefficient. All you need is one loop, and a condition:</p>\n\n<pre><code>For Each p In myCollection\n    If p.FirstName = \"Jack\" Then\n        'we have a winner\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 2, "accepted_answer_id": 45842867, "answer_count": 1, "score": 1, "last_activity_date": 1503499337, "creation_date": 1503498268, "question_id": 45842439, "link": "https://stackoverflow.com/questions/45842439/vba-query-collection-of-custom-classes", "title": "VBA - Query collection of custom classes", "body": "<p>Is there a way in VBA to query a collection of custom classes named People.  Lets say I have a custom class that has First Name, Last Name, and Title. </p>\n\n<pre><code>\u2018private attributes\nPrivate pFirstName as String\nPrivate pLastName as String\nPrivate pTitle as String\n\n\u2018Get/Let Methods\nPublic Property Get FirstName() as String\nFirstName = pFirstName\nEnd Property\n\nPublic Property Let FirstName (Value as String)\npFirstName = Value\nEnd Property\n\nPublic Property Get LastName() as String\nLastName = pLastName\nEnd Property\n\nPublic Property Let LastName(Value as String)\npLastName = Value\nEnd Property\n\nPublic Property Get Title() as String\nTitle = pTitle\nEnd Property\n\nPublic Property Title Let (Value as String)\npTitle = Value\nEnd Property\n</code></pre>\n\n<p>I then, in my main SUB, create a collection of people.  Is there a way to query that collection, Ie, return me all People with first name == Jack. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "loops", "copy-paste"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 4, "creation_date": 1503498112, "post_id": 45842369, "comment_id": 78642333, "body": "What VBA code have you tried?"}, {"owner": {"reputation": 13, "user_id": 7926773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8455444c9ab50274b33f626f5eba1a9?s=128&d=identicon&r=PG&f=1", "display_name": "roadtoenlightenment", "link": "https://stackoverflow.com/users/7926773/roadtoenlightenment"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1503501142, "post_id": 45842369, "comment_id": 78644862, "body": "I don&#39;t have any experience with VBA.  I saw some things on line but the thing that was missing from most of the code was the ability to choose the array of worksheets.  Most codes were there to choose ALL sheets.  See below as an example."}, {"owner": {"reputation": 13, "user_id": 7926773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8455444c9ab50274b33f626f5eba1a9?s=128&d=identicon&r=PG&f=1", "display_name": "roadtoenlightenment", "link": "https://stackoverflow.com/users/7926773/roadtoenlightenment"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1503501356, "post_id": 45842369, "comment_id": 78645015, "body": "Sub Button4_Click()  Dim WS_Count As Integer Dim I As Integer WS_Count = ActiveWorkbook.Worksheets.Count  Dim Source As Range  Set Source = ThisWorkbook.Worksheets(1).Range(&quot;C10&quot;)  &#39; Begin the loop. For I = 1 To WS_Count      ThisWorkbook.worksheets(i).Select &#39; just select the sheet     Source.Copy         Range(&quot;C11:C300&quot;).Select     ActiveSheet.Paste  Next I  End Sub"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7926773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8455444c9ab50274b33f626f5eba1a9?s=128&d=identicon&r=PG&f=1", "display_name": "roadtoenlightenment", "link": "https://stackoverflow.com/users/7926773/roadtoenlightenment"}, "edited": false, "score": 0, "creation_date": 1503515808, "post_id": 45845516, "comment_id": 78653587, "body": "The problem I&#39;m having with this code is that it is copy and pasting to all the sheets in the workbook.  I would like it to only do a specific amount of tabs i.e. range tabs Test1:Test50 , a total of 50 tabs"}], "tags": [], "owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "is_accepted": true, "score": 1, "last_activity_date": 1503516459, "last_edit_date": 1503516459, "creation_date": 1503507650, "answer_id": 45845516, "question_id": 45842369, "link": "https://stackoverflow.com/questions/45842369/vba-excel-to-copy-formula-from-a-worksheet-and-paste-to-multiple-worksheets/45845516#45845516", "title": "VBA excel to copy formula from a worksheet and paste to multiple worksheets", "body": "<p>Based on the code you posted, you probably want something like this:</p>\n\n<pre><code>Sub Button4_Click()\nDim src As Range, sel As Range\nDim i as long\n\nSet sel = Selection\nSet src = ActiveWorkbook.Sheets(\"Data\").Range(\"C10\")\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nFor i = 1 to 50\n    src.Copy ActiveWorkbook.Sheets(\"Test\" &amp; i).Range(\"C11:C300\")\nNext i\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nApplication.Goto sel, False\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7926773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8455444c9ab50274b33f626f5eba1a9?s=128&d=identicon&r=PG&f=1", "display_name": "roadtoenlightenment", "link": "https://stackoverflow.com/users/7926773/roadtoenlightenment"}, "edited": false, "score": 0, "creation_date": 1503516273, "post_id": 45846737, "comment_id": 78653871, "body": "The test1:test50 was actually just an example, but yes I believe in that situation it would work perfect.  Thanks Mooseman - appreciate your help, I&#39;ll see if I can incorporate your method for another worbook"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 13, "user_id": 7926773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8455444c9ab50274b33f626f5eba1a9?s=128&d=identicon&r=PG&f=1", "display_name": "roadtoenlightenment", "link": "https://stackoverflow.com/users/7926773/roadtoenlightenment"}, "edited": false, "score": 0, "creation_date": 1503517360, "post_id": 45846737, "comment_id": 78654329, "body": "As long as the sheets have a number you can increment or you could use the Sheets number to reference which sheet gets pasted to."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 13, "user_id": 7926773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8455444c9ab50274b33f626f5eba1a9?s=128&d=identicon&r=PG&f=1", "display_name": "roadtoenlightenment", "link": "https://stackoverflow.com/users/7926773/roadtoenlightenment"}, "edited": false, "score": 0, "creation_date": 1503691309, "post_id": 45846737, "comment_id": 78736760, "body": "You are welcome,. Pick an answer and upvote the answers that helped."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 2, "last_activity_date": 1503511939, "creation_date": 1503511939, "answer_id": 45846737, "question_id": 45842369, "link": "https://stackoverflow.com/questions/45842369/vba-excel-to-copy-formula-from-a-worksheet-and-paste-to-multiple-worksheets/45846737#45846737", "title": "VBA excel to copy formula from a worksheet and paste to multiple worksheets", "body": "<p>Is this what you are looking for?  The i = 1 to worksheets count can be changed to what ever you need.  The second part of the copy/paste is the destination.</p>\n\n<pre><code>Sub Button4_Click()\nDim I As Integer\n\n' Begin the loop.\nFor I = 1 To ActiveWorkbook.Worksheets.Count - 1\nWorksheets(1).Range(\"C11:C300\").Copy Worksheets(\"Test\" &amp; I).Range(\"C11:C300\")\nNext I\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7926773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8455444c9ab50274b33f626f5eba1a9?s=128&d=identicon&r=PG&f=1", "display_name": "roadtoenlightenment", "link": "https://stackoverflow.com/users/7926773/roadtoenlightenment"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3425, "favorite_count": 0, "accepted_answer_id": 45845516, "answer_count": 2, "score": 1, "last_activity_date": 1503516459, "creation_date": 1503498017, "last_edit_date": 1503508321, "question_id": 45842369, "link": "https://stackoverflow.com/questions/45842369/vba-excel-to-copy-formula-from-a-worksheet-and-paste-to-multiple-worksheets", "title": "VBA excel to copy formula from a worksheet and paste to multiple worksheets", "body": "<p>VBA excel to copy formula from a sheet and paste to an array of worksheets.  As an example, I want to copy data from worksheet Data!C4:CX204 and paste to worksheets Test1:Test50.  The Worksheets from Test1:Test50 will be right after each other.  I was thinking I can name one cell Test1 and another Test 50 and link to those cells in order to make the array more flexible.  </p>\n\n<pre><code>Sub Button4_Click() \nDim WS_Count As Integer \nDim I As Integer \n\nWS_Count = ActiveWorkbook.Worksheets.Count \n\nDim Source As Range \nSet Source = ThisWorkbook.Worksheets(1).Range(\"C10\") \n\n' Begin the loop. \nFor I = 1 To WS_Count \n    ThisWorkbook.worksheets(i).Select ' just select the sheet \n    Source.Copy Range(\"C11:C300\").Select \n    ActiveSheet.Paste \nNext I \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "rows", "autofilter"], "comments": [{"owner": {"reputation": 808, "user_id": 6532640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-8Uw3zcKUw5c/AAAAAAAAAAI/AAAAAAAAACE/yaXF1QrLkjM/photo.jpg?sz=128", "display_name": "NatNgs", "link": "https://stackoverflow.com/users/6532640/natngs"}, "edited": false, "score": 1, "creation_date": 1503497265, "post_id": 45841934, "comment_id": 78641631, "body": "I understand you need like optimize your code or something like that; I think you should try on <a href=\"https://codereview.stackexchange.com/\">CodeReview</a> || I don&#39;t understand why you use an empty With block (<code>.Range(&quot;F25:FY6000&quot;).SpecialCells(xlCellTypeVisible).Rows.D&zwnj;&#8203;elete</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7786106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9aed7d47205beccda64e2a61ed173f?s=128&d=identicon&r=PG&f=1", "display_name": "Shabbash18", "link": "https://stackoverflow.com/users/7786106/shabbash18"}, "edited": false, "score": 0, "creation_date": 1503499044, "post_id": 45842387, "comment_id": 78643201, "body": "Yeah I had thought about doing this, I&#39;m sure will be able to get this way into the sheet, cheers."}], "tags": [], "owner": {"reputation": 151, "user_id": 8506518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909369b106c099653a532ec25fd96061?s=128&d=identicon&r=PG&f=1", "display_name": "Achim Gmeiner", "link": "https://stackoverflow.com/users/8506518/achim-gmeiner"}, "is_accepted": false, "score": 2, "last_activity_date": 1503498080, "creation_date": 1503498080, "answer_id": 45842387, "question_id": 45841934, "link": "https://stackoverflow.com/questions/45841934/excel-vba-autofilter-delete-empty-rows/45842387#45842387", "title": "Excel VBA Autofilter &gt; Delete Empty Rows", "body": "<p>You could add an additional column with the count of all none empty fields of the row - e.g. =COUNTA(F24:FY24) - and then filter the rows on this column where the value = 0. </p>\n\n<p>I haven't tested this, but as guess it should be way faster...</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 7786106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9aed7d47205beccda64e2a61ed173f?s=128&d=identicon&r=PG&f=1", "display_name": "Shabbash18", "link": "https://stackoverflow.com/users/7786106/shabbash18"}, "edited": false, "score": 0, "creation_date": 1503504571, "post_id": 45843130, "comment_id": 78647279, "body": "Thank you for a detailed response, have taken a couple of points on board. The code is now just about 20 lines in comparison to &gt;180 before hand. Time has reduced by about a minute, not sure we can get it any faster due to the data set, as you mentioned.   This data set is particularly heavy, have tried the code out on set with 2000 less rows and time was approx 3 mins, which is not too bad for our needs.  Many thanks again!"}], "tags": [], "owner": {"reputation": 106, "user_id": 8340269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H13Pt.jpg?s=128&g=1", "display_name": "Benjamin Goldwater", "link": "https://stackoverflow.com/users/8340269/benjamin-goldwater"}, "is_accepted": true, "score": 1, "last_activity_date": 1503500063, "creation_date": 1503500063, "answer_id": 45843130, "question_id": 45841934, "link": "https://stackoverflow.com/questions/45841934/excel-vba-autofilter-delete-empty-rows/45843130#45843130", "title": "Excel VBA Autofilter &gt; Delete Empty Rows", "body": "<p><strong>To make things more elegant</strong></p>\n\n<ol>\n<li><p>Add a column that evaluates to <code>TRUE</code> when cells in columns 1-175 are blank. Filter on this column.</p></li>\n<li><p>To better define the rows you need to delete, use a function to define the bottom row (rather than setting bottom row to 6000.</p></li>\n</ol>\n\n<p>e.g.:</p>\n\n<pre><code>Function LastRowInOneColumn(ws As Worksheet, Optional bool As Boolean) As Long\n\n'Find the last used row in a Column\n'by default, returns row of column A (FLASE)\n'if bool is TRUE then will return row of column B\n\nDim LastRow As Long\nDim col As String\n\nIf bool = True Then\n    col = \"B\"\nElse\n    col = \"A\"\nEnd If\n\nWith ws\n    LastRow = .Cells(.Rows.Count, col).End(xlUp).row\nEnd With\n\nLastRowInOneColumn = LastRow\n\nEnd Function\n</code></pre>\n\n<p><strong>Speed</strong></p>\n\n<p>I recommend that you test to see what part of your code is running so slowly. If it is the filtering, than suggestion 1 (above) should help. If it is the deleting than it may be that other parts of your workbook are linking to this data set and thus deleting data here will be VERY slow. If this is the case, my recommendation is to change your other data sets so that they refer to this worksheet via a named range that you delete as step one of your DeleteEmptyRows macros and then re-create these named ranges at the end of running the macro</p>\n\n<pre><code>Sub set_named_ranges()\n\n'creates named ranges needed for this workbook\n'this code is somewhat crude, you may need to modify based on how your data are laid out\n\nDim found As Range\nDim col_lookup_text As String\ndim wks_name As String\n\nwks_name = \"Detailed Comparison\"\n\nWorksheets(wks_name).Select\nWorksheets(wks_name).Range(\"A1\").Select\nRange(Selection, Selection.End(xlToRight)).Select\n\n'header named range\nActiveWorkbook.Names.Add _\n        Name:=(\"data_Header\"), _\n        RefersTo:=Range(wks_name &amp; \"!\" &amp; RngAddress(Selection))\n\n'main data named range\nRange(Selection, Selection.End(xlDown)).Select\n\nActiveWorkbook.Names.Add _\n        Name:=(\"dataset\"), _\n        RefersTo:=Range(wks_name &amp; \"!\" &amp; RngAddress(Selection))\n\nEnd Sub\n\nFunction RngAddress(rng As Range) As String\nRngAddress = rng.Address\nEnd Function\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>Sub delete_these_named_ranges(ParamArray names_of_named_ranges() As Variant)\n\n'not a very sexy macro\n'feed macro names of named ranges\n'deletes the named range\n'if named range doesn't exist, it creates a named range with\n'that name and deletes it to avoid errors\n\nDim nName As Variant\n\nFor Each nName In names_of_named_ranges\n\n    On Error Resume Next\n    ActiveWorkbook.Names.Add Name:=nName, RefersTo:=\"temp\"\n    ActiveWorkbook.Names(nName).Delete\n\nNext nName\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7786106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9aed7d47205beccda64e2a61ed173f?s=128&d=identicon&r=PG&f=1", "display_name": "Shabbash18", "link": "https://stackoverflow.com/users/7786106/shabbash18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1104, "favorite_count": 0, "accepted_answer_id": 45843130, "answer_count": 2, "score": 1, "last_activity_date": 1503500063, "creation_date": 1503496939, "last_edit_date": 1503497383, "question_id": 45841934, "link": "https://stackoverflow.com/questions/45841934/excel-vba-autofilter-delete-empty-rows", "title": "Excel VBA Autofilter &gt; Delete Empty Rows", "body": "<p>We have a sheet that we use to analyse a detailed tendering process, and want to delete any empty rows.</p>\n\n<p>The range can vary per project, up to maybe 170 columns and 6000 rows. </p>\n\n<p>The code I have tested is working, on a project with approx. 40 columns &amp; 4750 rows, and is taking just shy of 10 mins to run.</p>\n\n<p>Looking for any slightly more elegant solutions to bring this time down. Currently the code will Autofilter every column for blanks, wondering if even empty columns being filtered is slowing the whole thing down?</p>\n\n<p>In below code i removed most of the autofilter fields for viewing ease, but it filters every field from 1-175.</p>\n\n<pre><code>Sub DeleteEmptyRows()\n\nWith Sheets(\"Detailed Comparison\")\n    Application.DisplayAlerts = False\n    .AutoFilterMode = False\n    Application.ScreenUpdating = False\n\n    With .Range(\"F24:FY6000\")\n        .AutoFilter\n        .AutoFilter Field:=1, Criteria1:=\"=\"\n        .AutoFilter Field:=2, Criteria1:=\"=\"\n        .AutoFilter Field:=175, Criteria1:=\"=\"\n    End With\n\n    With .Range(\"F25:FY6000\").SpecialCells(xlCellTypeVisible).Rows.Delete\n    End With\n\n    Application.DisplayAlerts = True\n\n    .AutoFilterMode = False\n    Application.ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2016"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1503496691, "post_id": 45841784, "comment_id": 78641160, "body": "What if there is only <code>Yes&gt;No</code> or <code>No&gt;Yes</code>?"}, {"owner": {"reputation": 35, "user_id": 8502764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b0456e7707ad73600e84f4137aaabe7?s=128&d=identicon&r=PG&f=1", "display_name": "E. Williamson", "link": "https://stackoverflow.com/users/8502764/e-williamson"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1503497488, "post_id": 45841784, "comment_id": 78641827, "body": "Good question--There can only be one pair of &quot;Yes&gt;No,&quot; and &quot;No&gt;Yes,&quot; or just all &quot;No,&quot; or &quot;Yes,&quot; which would produce &quot;Same.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1503497004, "creation_date": 1503497004, "answer_id": 45841960, "question_id": 45841784, "link": "https://stackoverflow.com/questions/45841784/excel-2016-if-function-using-position-of-cell-relative-to-another-cell/45841960#45841960", "title": "Excel 2016: IF function using position of cell relative to another cell", "body": "<p>MATCH will return the relative row number.  This assumes the first column of data is in E2:E8.  </p>\n\n<pre><code>=IFERROR(IF(MATCH(\"Yes&gt;No\",E2:E8,0)&gt;MATCH(\"No&gt;Yes\",E2:E8,0),\"Less Frequently\",\"More Frequently\"),\"Same\") \n</code></pre>\n\n<p>It is looking for exact matches, so if you have typos, it will always default to <code>Same</code>.  If only one is found then it will still produce <code>Same</code></p>\n\n<p>You would put int he first cell and copy/drag over, the references will change automatically.</p>\n"}], "owner": {"reputation": 35, "user_id": 8502764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b0456e7707ad73600e84f4137aaabe7?s=128&d=identicon&r=PG&f=1", "display_name": "E. Williamson", "link": "https://stackoverflow.com/users/8502764/e-williamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 45841960, "answer_count": 1, "score": 1, "last_activity_date": 1503497004, "creation_date": 1503496568, "last_edit_date": 1592644375, "question_id": 45841784, "link": "https://stackoverflow.com/questions/45841784/excel-2016-if-function-using-position-of-cell-relative-to-another-cell", "title": "Excel 2016: IF function using position of cell relative to another cell", "body": "<p>I'm trying to use IF to return a value that depends on the position of one cell relative to another in the same column.</p>\n<p><a href=\"https://i.stack.imgur.com/4wGeF.png\" rel=\"nofollow noreferrer\">Spreadsheet Example</a></p>\n<p>If you click the above image, you'll see a number of columns with the possible values of &quot;No,&quot; &quot;Yes,&quot; &quot;Yes&gt;No,&quot; and &quot;No&gt;Yes.&quot;</p>\n<p>The equation will go in the &quot;Category of Change,&quot; row, one equation for each column. If the &quot;Yes&gt;No,&quot; is lower in the column than the &quot;No&gt;Yes,&quot; I want to return &quot;Less Frequently,&quot; and if the opposite is true, I want to return &quot;More Frequently&quot; (&quot;Same,&quot; if there is no &quot;Yes&gt;No,&quot; or &quot;No&gt;Yes&quot;).</p>\n<p>I've tried using ARRAY and INDEX functions, but I'm not sure how to get Excel to &quot;look&quot; for each of those values, and then compare their ranking in the column.</p>\n<p>Thank you in advance for your help!</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 4391, "user_id": 8506548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yW1F3.jpg?s=128&g=1", "display_name": "niko", "link": "https://stackoverflow.com/users/8506548/niko"}, "edited": false, "score": 0, "creation_date": 1503497324, "post_id": 45841747, "comment_id": 78641680, "body": "Thanks, this works indeed. As for <code>IsEmptyorNothing</code>, oddly enpough it was on my Excel already, or at least I didn&#39;t define it."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1503496489, "creation_date": 1503496489, "answer_id": 45841747, "question_id": 45841619, "link": "https://stackoverflow.com/questions/45841619/implementing-excel-formula-in-vba/45841747#45841747", "title": "Implementing Excel formula in VBA", "body": "<p><code>\"\"</code> needs to be <code>\"\"\"\"</code></p>\n\n<p>Also the formula you show would need to be array entered, but you can simple do this:</p>\n\n<pre><code>Range(\"B1:B50\").Formula = _\n  \"=IF(IsEmptyorNothing(A1), \"\"\"\", IF(ISNUMBER(VALUE(A1)), VALUE(A1), A1))\"\n</code></pre>\n\n<p>And Excel will put adjust the A1 as the formula is copied down, automatically.</p>\n\n<p>This assumes that <code>IsEmptyorNothing</code> is a UDF, because no such formula exists in standard Excel.</p>\n"}], "owner": {"reputation": 4391, "user_id": 8506548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yW1F3.jpg?s=128&g=1", "display_name": "niko", "link": "https://stackoverflow.com/users/8506548/niko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 45841747, "answer_count": 1, "score": 0, "last_activity_date": 1503496489, "creation_date": 1503496157, "question_id": 45841619, "link": "https://stackoverflow.com/questions/45841619/implementing-excel-formula-in-vba", "title": "Implementing Excel formula in VBA", "body": "<p>I have this Excel formula which I would like to implement via VBA, unfortunately it keeps yielding an error.</p>\n\n<p>My Excel formula:</p>\n\n<pre><code>      IF(isemptyornothing(A1:A50); \"\"; IF(ISNUMBER(VALUE(A1:A50)); VALUE(A1:A50); A1:A50))\n</code></pre>\n\n<p>My VBA attempt:</p>\n\n<pre><code>    Range(\"B1:B50\").Formula = _\n  \"=IF(IsEmptyorNothing(A1:A50), \"\", IF(ISNUMBER(VALUE(A1:A50)), VALUE(A1:A50), A1:A50))\"\n</code></pre>\n\n<p>This yields the following error: </p>\n\n<p>\"Run-time error '1004': Application-defined or object-defined error\"</p>\n\n<p>Being a novice in VBA, I am not sure what to do with this.</p>\n"}, {"tags": ["vba", "excel", "command-prompt"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1503496139, "post_id": 45841532, "comment_id": 78640697, "body": "What VBA code have you tried?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1503497314, "post_id": 45841532, "comment_id": 78641672, "body": "&quot;<i>Access denied</i>&quot; means access denied! Either to your <code>[Folderpath]</code> or to <code>[PathtoFile]</code>. And in your screenshot <code>[PathtoFile]</code> is a folder not a file so maybe that&#39;s the issue. Also your screenshot looks more like <code>dir [Folderpath] &#47;b &gt; [PathtoFile]</code> than like you said above <code>dir &#47;b [Folderpath] &gt; [PathtoFile]</code>"}, {"owner": {"reputation": 5, "user_id": 4417702, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-hZCYMcGbc9Y/AAAAAAAAAAI/AAAAAAAAABQ/dQs4wOhwFIQ/photo.jpg?sz=128", "display_name": "Liam", "link": "https://stackoverflow.com/users/4417702/liam"}, "edited": false, "score": 0, "creation_date": 1503511653, "post_id": 45841532, "comment_id": 78651318, "body": "Thank you for the comment. I did the code again as I wrote it previously and still got the access denied error."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1503497487, "creation_date": 1503497487, "answer_id": 45842165, "question_id": 45841532, "link": "https://stackoverflow.com/questions/45841532/command-prompt-access-denied-when-trying-to-create-dir-b-file-csv/45842165#45842165", "title": "command prompt &quot;Access Denied&quot; when trying to create &quot;dir /b file.csv&quot;", "body": "<p>Not sure why you would need a CSV file when there is only 1 column of information, but this should do the trick if you want it done with VBA. Adjust <code>sFolder</code> to be the folder you want to look in.</p>\n\n<pre><code>Public Sub MakeFileCSV()\n  Dim sFiles() As String\n  ReDim sFiles(0)\n  Const sFolder = \"C:\\\"\n  Dim sOutput As String\n  sOutput = \"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Desktop\\Output.csv\"\n  Dim sFilename As String\n  Dim nIndex As Integer\n\n  ' read the files\n  sFilename = Dir(sFolder)\n  Do Until sFilename = \"\"\n    ReDim Preserve sFiles(UBound(sFiles) + 1)\n    sFiles(UBound(sFiles)) = sFilename\n    sFilename = Dir()\n  Loop\n\n  ' output data\n  Open sOutput For Output As #1\n  For nIndex = 1 To UBound(sFiles)\n    Print #1, sFiles(nIndex)\n  Next\n  Close #1\n\n  MsgBox \"done\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4417702, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-hZCYMcGbc9Y/AAAAAAAAAAI/AAAAAAAAABQ/dQs4wOhwFIQ/photo.jpg?sz=128", "display_name": "Liam", "link": "https://stackoverflow.com/users/4417702/liam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 588, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1614903555, "creation_date": 1503495955, "last_edit_date": 1503497061, "question_id": 45841532, "link": "https://stackoverflow.com/questions/45841532/command-prompt-access-denied-when-trying-to-create-dir-b-file-csv", "title": "command prompt &quot;Access Denied&quot; when trying to create &quot;dir /b file.csv&quot;", "body": "<p>I am trying to create a VBA script which locates a directory and creates a .csv containing the names of all files in that directory. </p>\n\n<p>I can successfully do this manually by shift + right clicking the folder > open command prompt > \"dir /b > file.csv\"</p>\n\n<p>However, when I try to implement in my script using the below command line I get an access denied error. Any help on identifying this error is appreciated.</p>\n\n<p>command is: <code>dir /b [Folderpath] &gt; [PathtoFile]</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/TziN9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TziN9.png\" alt=\"Access Denied Error\"></a></p>\n\n<p>Thank you,</p>\n"}, {"tags": ["excel", "vba", "variants"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1503495532, "post_id": 45841243, "comment_id": 78640166, "body": "Can you give an example where the compare fails? Are you sure you deal with integers or do you (sometimes) deal with strings looking like an integer?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1503495535, "post_id": 45841243, "comment_id": 78640170, "body": "If it is random, look at the false positives/negatives in the data and see why they are wrong.  The error is in the data.  As a side note <code>Dim i, j As Integer</code> i is being declared as a variant not an Integer. <code>Dim i As Integer, j As Integer</code>"}, {"owner": {"reputation": 2855, "user_id": 8513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fcffc30cefd7a6870fb97c4ddee01227?s=128&d=identicon&r=PG", "display_name": "Peter T. LaComb Jr.", "link": "https://stackoverflow.com/users/8513/peter-t-lacomb-jr"}, "edited": false, "score": 0, "creation_date": 1503495629, "post_id": 45841243, "comment_id": 78640256, "body": "It might be helpful to someone attempting to answer this if a sample spreadsheet that reproduces the problem, or description of data to reproduce, were provided."}, {"owner": {"reputation": 61, "user_id": 8309064, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b149cf2fdca4662e306853b17b260c98?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock", "link": "https://stackoverflow.com/users/8309064/sherlock"}, "edited": false, "score": 0, "creation_date": 1503495776, "post_id": 45841243, "comment_id": 78640385, "body": "FunThomas: For example, when I run the program, the cell containing &quot;104875&quot; is not colored red, indicating that there is a match in the comparison column. But when I do a ctrl+F search for that number in the other file, nothing is found. I&#39;m dealing with about 9000 rows, so it isn&#39;t practical for me to do a manual search."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1503496552, "post_id": 45841243, "comment_id": 78641055, "body": "You might want to look into how <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">Rubberduck</a> can help you properly indent your code. Also work with <code>Long</code>, not a 16-bit <code>Integer</code> - otherwise you&#39;re <i>asking</i> for overflow errors to happen, sooner or later. Lastly note that <code>= True</code> or <code>= False</code> in a conditional is always redundant when you&#39;re comparing a <code>Boolean</code> - <code>If Not flag Then wb1.Cells(...)</code> gets you where you need to be, without being redundant. Can you please clarify what &quot;errors&quot; mean? &quot;It&#39;s not working&quot; isn&#39;t a useful problem description."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503496672, "post_id": 45841243, "comment_id": 78641143, "body": "Also that inner condition could be removed an use explicit type conversions - it&#39;s never crystal-clear exactly what&#39;s going on when you compare two <code>Variant</code> values. <code>flag = CDbl(array1(i, 1)) = CDbl(array2(j, 1))</code>."}, {"owner": {"reputation": 61, "user_id": 8309064, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b149cf2fdca4662e306853b17b260c98?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock", "link": "https://stackoverflow.com/users/8309064/sherlock"}, "edited": false, "score": 0, "creation_date": 1503496736, "post_id": 45841243, "comment_id": 78641211, "body": "Matt&#39;s Mug: Thanks. See my comment to FunThomas for an example."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503496915, "post_id": 45841243, "comment_id": 78641343, "body": "@Sherlock 104,875 is larger than 32,768, it is not an <code>Integer</code>. Numeric cell values are always <code>Double</code>, but could be a <code>String</code> if you&#39;ve formatted the cell as text. Avoid problems, avoid <code>Variant</code> comparisons, and use explicit type conversions. Also your code will blow up if any cell value contains an error, e.g. <code>#VALUE!</code> or <code>#DIV&#47;0!</code> or whatever."}, {"owner": {"reputation": 61, "user_id": 8309064, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b149cf2fdca4662e306853b17b260c98?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock", "link": "https://stackoverflow.com/users/8309064/sherlock"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503500396, "post_id": 45841243, "comment_id": 78644324, "body": "@Mat&#39;s Mug: I tried using CDbl(array1(i,1)) = CDbl(array1(j, 1)) and it gave me a type mismatch error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503500481, "post_id": 45841243, "comment_id": 78644388, "body": "Bingo. One of your values contains an error value, or a value that otherwise cannot be converted to a numeric value."}, {"owner": {"reputation": 61, "user_id": 8309064, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b149cf2fdca4662e306853b17b260c98?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock", "link": "https://stackoverflow.com/users/8309064/sherlock"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503502184, "post_id": 45841243, "comment_id": 78645596, "body": "@Mat&#39;s Mug: I modified the code slightly to skip over non-numeric values (in which case any non-numeric should automatically be colored red), and 104875 is still not red. (By the way, I changed i and j to Long.) So it seems the type mismatch is not the problem here. This is really baffling."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503502379, "post_id": 45841243, "comment_id": 78645738, "body": "You know how to use step-through (F8) and the immediate pane (Ctrl+G) [and breakpoints (F9)]? Insert a <code>Stop</code> statement inside the inner loop, e.g. <code>If array1(i, 1) = 104875 Then Stop</code>, and then confirm whether <code>array2(j, 1)</code> contains the value you think it contains. We can&#39;t help you much further than that."}, {"owner": {"reputation": 61, "user_id": 8309064, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b149cf2fdca4662e306853b17b260c98?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock", "link": "https://stackoverflow.com/users/8309064/sherlock"}, "edited": false, "score": 0, "creation_date": 1503503669, "post_id": 45841243, "comment_id": 78646632, "body": "Ok I did this and it turns out that array2(j,1) = 101048. But why is it returning true???"}, {"owner": {"reputation": 61, "user_id": 8309064, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b149cf2fdca4662e306853b17b260c98?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock", "link": "https://stackoverflow.com/users/8309064/sherlock"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503505122, "post_id": 45841243, "comment_id": 78647624, "body": "@Mat&#39;s Mug: Actually, I did it again, and it appears array2(j,1) really does equal 104857. I just noticed that some rows in the second spreadsheet are hidden. I think this might explain why ctrl+F doesn&#39;t find the value? I have barely ever used Excel  and never used VB before so I&#39;m really just crash coursing through all this stuff."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503505628, "post_id": 45841243, "comment_id": 78647928, "body": "I think at this point your question needs an <a href=\"https://stackoverflow.com/posts/45841243/edit\">edit</a> with clarifications."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1503496363, "last_edit_date": 1503496363, "creation_date": 1503495705, "answer_id": 45841439, "question_id": 45841243, "link": "https://stackoverflow.com/questions/45841243/vba-comparison-anomalies-using-variant/45841439#45841439", "title": "VBA - Comparison anomalies using variant", "body": "<p>Try to simplify your code, to something easily reproductible. E.g., lets say that you want to compare the first 50 cells in columns <strong>A</strong> and <strong>B</strong> in the activesheet. Put some values and it will look like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim array1      As Variant\n    Dim array2      As Variant\n    Dim i           As Long\n    Dim j           As Long\n    Dim flag        As Boolean\n\n    With ActiveSheet\n        array1 = .Range(\"A1:A50\")\n        array2 = .Range(\"B1:B50\")\n        .Range(\"A1:A10\").Interior.Color = vbWhite\n\n        For i = LBound(array1) To UBound(array1)\n            flag = False\n\n            For j = LBound(array2) To UBound(array2)\n                If array1(i, 1) = array2(j, 1) Then flag = True\n            Next j\n\n            If Not flag Then .Cells(i, 1).Interior.Color = vbRed\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Then try to adapt the solution to yours. It should work.</p>\n"}], "owner": {"reputation": 61, "user_id": 8309064, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b149cf2fdca4662e306853b17b260c98?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock", "link": "https://stackoverflow.com/users/8309064/sherlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503513242, "creation_date": 1503495175, "last_edit_date": 1503513242, "question_id": 45841243, "link": "https://stackoverflow.com/questions/45841243/vba-comparison-anomalies-using-variant", "title": "VBA - Comparison anomalies using variant", "body": "<p>I have found a couple of other questions dealing with variants but none of them seem to address my issue.</p>\n\n<p>I have very simple for loops doing comparisons. The purpose is to color the Excel cell red if there isn't a match. The results are 99% accurate, but I have noticed a couple of seemingly random errors. For example, a cell containing the number 104875 is not colored red, which indicates that there should be a matching cell in the comparison column. But there isn't. It seems like they should all be wrong or all be correct. Some of the other threads about variants have mentioned that the comparisons have to be of the same type or you will get weird errors. In my case, they are of the same type (both integers), so this isn't the problem.</p>\n\n<p>I am brand new to VBA and still trying to understand how it works.</p>\n\n<p>This is the relevant part of the code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim i As Long, j As Long\nDim flag As Boolean\nDim array1() As Variant, array2() As Variant\nDim column1 As Double\nDim column2 As Double\n\ncolumn1 = convertColumn(TextBox1.Text)\ncolumn2 = convertColumn(TextBox2.Text)\n\nSet wb1 = Workbooks(\"Advocate July 2017 Data.xlsm\").Sheets(1)\nSet wb2 = Workbooks(\"BI Report 8-18-17.xlsm\").Sheets(1)\n\narray1 = Intersect(wb1.Columns(column1), wb1.UsedRange)\narray2 = Intersect(wb2.Columns(column2), wb2.UsedRange)\n\n\nFor i = 2 To UBound(array1)\n    flag = False\n    For j = 2 To UBound(array2)\n        If IsNumeric(array1(i, 1)) And IsNumeric(array2(j, 1)) Then If CDbl(array1(i, 1)) = CDbl(array2(j, 1)) Then flag = True\n        Next j\n    If Not flag Then wb1.Cells(i, column1).Interior.Color = vbRed\nNext i\nEnd Sub\n</code></pre>\n\n<p>EDIT: Turns out that my code works fine. The problem was simply that some of the cells on one of the sheets were hidden and I didn't realize it. ~facepalm~ that's what I get for being inexperienced in excell</p>\n"}, {"tags": ["vba", "powerpoint"], "owner": {"reputation": 31, "user_id": 6445391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3010f6d8557d5ea23988d6d7a5564c21?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/6445391/manoj-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1503522896, "creation_date": 1503494584, "last_edit_date": 1503522896, "question_id": 45841002, "link": "https://stackoverflow.com/questions/45841002/how-to-distribute-rows-in-a-table-in-powerpoint-slide-using-vba", "title": "How to &quot;Distribute Rows&quot; in a table in PowerPoint slide using VBA?", "body": "<p>I have a table in <code>PowerPoint</code> which I need to \"Distribute Rows\" evenly. Manually, I could go to \"layout\" and click on the \"Distribute Rows\" option. </p>\n\n<p>But what is the <code>VBA</code> code to do it using a macro? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "object", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8282848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74085d59dd156ffa217599fb65fd3689?s=128&d=identicon&r=PG&f=1", "display_name": "jareckii", "link": "https://stackoverflow.com/users/8282848/jareckii"}, "edited": false, "score": 0, "creation_date": 1503566091, "post_id": 45843191, "comment_id": 78672900, "body": "Thanks, now it&#39;s obvious.  I had some brain fade:/ Solution works perfectly."}], "tags": [], "owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "is_accepted": false, "score": 1, "last_activity_date": 1503500247, "creation_date": 1503500247, "answer_id": 45843191, "question_id": 45840702, "link": "https://stackoverflow.com/questions/45840702/vba-passing-word-table-to-subroutine-using-object-variable/45843191#45843191", "title": "VBA passing word.table to subroutine using object variable", "body": "<p>The point is that you call the Sub as a Function (by adding () around the parameter). This apparently returns the 'default member' i.e. Range.</p>\n\n<p>Call the sub like a Sub by removing the () around the parameter and it will both return Table:</p>\n\n<pre><code>Sub test()\n\n   GetWobjectAttributes ThisDocument.Tables(1)\n\n   MsgBox (TypeName(ThisDocument.Range.Tables(1)))\n\nEnd Sub\n\n\nPublic Sub GetWobjectAttributes(ByRef WObject As Variant)\n\n   MsgBox (TypeName(WObject))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8282848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74085d59dd156ffa217599fb65fd3689?s=128&d=identicon&r=PG&f=1", "display_name": "jareckii", "link": "https://stackoverflow.com/users/8282848/jareckii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1593902839, "creation_date": 1503493799, "last_edit_date": 1593902839, "question_id": 45840702, "link": "https://stackoverflow.com/questions/45840702/vba-passing-word-table-to-subroutine-using-object-variable", "title": "VBA passing word.table to subroutine using object variable", "body": "<p>I've stuck with something I cannot understand (but I' aware that it might be quite simple). I try some general-use routine to collect attributes of typical word objects such as tables, textboxes, ranges etc. Here goes the idea:</p>\n\n<pre><code>Sub GetWobjectAttributes(ByRef WObject As Object)\n\n    If TypeOf WObject Is Word.Table Then\n            'grab table attributes\n        ElseIf TypeOf WObject Is Word.Range Then\n            'grab range attributes\n        ...\n\n        End If\n    End Sub\n</code></pre>\n\n<p>Unfortunately, passing object using generic object type seems to change the type of passed object. For example executing sub test:</p>\n\n<pre><code>Sub test()\n\n\nGetWobjectAttributes (ThisDocument.Tables(1))\n\n'MsgBox (TypeName(ThisDocument.Range.Tables(1)))\n\nEnd Sub\n\n\nPublic Sub GetWobjectAttributes(ByRef WObject As Variant)\n\n    MsgBox (TypeName(WObject))\n\nEnd Sub\n</code></pre>\n\n<p>displaying message: </p>\n\n<blockquote>\n  <p>Range instead of \"Table\" (but executing MsgBox (TypeName(ThisDocument.Range.Tables(1))) directly in test sub (commented in example) displaying: Table. </p>\n</blockquote>\n\n<p>Any ideas how to pass object of unkown type to subroutine without type changing?</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1503534810, "post_id": 45840689, "comment_id": 78660554, "body": "When intellisense is inexistent, hit F2 in vbe. Have you tried to compile your code with option explicit?"}], "answers": [{"tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1503494986, "creation_date": 1503494986, "answer_id": 45841162, "question_id": 45840689, "link": "https://stackoverflow.com/questions/45840689/cannot-add-values-to-combobox-in-vba/45841162#45841162", "title": "Cannot add values to Combobox in VBA", "body": "<p>Instead of :</p>\n\n<pre><code>With sComboBox\n    .Name = cBoxName\n    .List = Array(\"Apple\", \"Orange\")\nEnd With \n</code></pre>\n\n<p>Use :</p>\n\n<pre><code>        With sComboBox\n            .Name = cBoxName\n            .ControlFormat.List = Array(\"Apple\", \"Orange\")\n        End With\n</code></pre>\n\n<p>or :</p>\n\n<pre><code>        With sComboBox\n            .Name = cBoxName\n            .ControlFormat.AddItem \"Apple\"\n            .ControlFormat.AddItem \"Orange\"\n            .ControlFormat.AddItem \"Peach\"\n        End With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8411863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a76d96762bdc739925aca86f5415243?s=128&d=identicon&r=PG&f=1", "display_name": "I E", "link": "https://stackoverflow.com/users/8411863/i-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503494986, "creation_date": 1503493781, "last_edit_date": 1503494740, "question_id": 45840689, "link": "https://stackoverflow.com/questions/45840689/cannot-add-values-to-combobox-in-vba", "title": "Cannot add values to Combobox in VBA", "body": "<p>I am trying to add values to Comboboxes which are created by a macro on a worksheet. The comboboxes are created but I'm unable to populate data in them. </p>\n\n<p>I get </p>\n\n<blockquote>\n  <p>runtime error 438: Object doesn't support this property...</p>\n</blockquote>\n\n<p>I tried to declare sComboBox as Shape/Object/left it blank also but to no avail. Code errors out on <code>.list</code> property. VBA intellisense also doesn't pick up the <code>.list</code> property. I tried using OLEObjects also but I get different compiler errors. </p>\n\n<p>The other question is: How do I create comboboxes in specific cells so they are not floating around or overlapping each other?</p>\n\n<pre><code>Dim sComboBox\nIf (wsTO.Cells(intLoopCounter, 5).Value &lt;&gt; \"\") Then\n    cBoxName = \"cBox\" &amp; wsTO.Cells(intLoopCounter, 5).Value\n    Set sComboBox = wsTO.Shapes.AddFormControl(xlDropDown, Left:=Cells(intLoopCounter, 12).Left, _\n        Top:=Cells(intLoopCounter + 1, 12).Top, Width:=250, Height:=25)\n\n    With sComboBox\n        .Name = cBoxName\n        .List = Array(\"Apple\", \"Orange\")\n    End With \nEnd If\n</code></pre>\n"}, {"tags": ["vba", "button", "outlook", "userform"], "answers": [{"comments": [{"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1503579215, "post_id": 45861752, "comment_id": 78682497, "body": "Hi @Mitch thank you for putting this together.  I&#39;ve put all the code in the Userform module, but unfortunately the problem still occurs.  Many thanks and regards"}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "reply_to_user": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1503579998, "post_id": 45861752, "comment_id": 78683035, "body": "@IRHM the only other thing I can think of is, in the properties of the userform buttons (Cancel button), Set the &quot;Cancel&quot; field to &quot;True&quot;"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1503642458, "post_id": 45861752, "comment_id": 78709367, "body": "Hi @Mitch, thank you for coming back to me with this. Unfortunately when I do this, the OK button no longer functions.  Kind Regards"}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "reply_to_user": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1503699979, "post_id": 45861752, "comment_id": 78739823, "body": "@IRHM I&#39;ve been working on this all day. I&#39;ve tried your code, modified it, still getting the same results. It has something to do with calling the userform and then returning to the script. Cancelling the userform just closes the form and returns to the script, Select Case lstNum picks up at that point with a value of 0, that&#39;s why it keeps choosing the first option."}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "reply_to_user": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1503755503, "post_id": 45861752, "comment_id": 78751067, "body": "@IRHM I&#39;ve got a working example posted. Please test. I think you&#39;ll be happy. Well, no one else had responded when i went to post this, then I see 2 other really good answers."}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "edited": false, "score": 0, "creation_date": 1503755764, "post_id": 45861752, "comment_id": 78751146, "body": "While this does work, the <code>This should exit</code> string is a bit ugly. I would suggest <code>None</code> as a better alternative. Or even <code>Please select a template</code>."}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "reply_to_user": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "edited": false, "score": 0, "creation_date": 1503764593, "post_id": 45861752, "comment_id": 78753702, "body": "@robinCTS No argument here. It was just something I used while testing to make sure it was doing what I wanted it to. Actually the whole damn thing is pretty ugly, but works. Pretty much most of my stuff is that way. I would not say I&#39;m a programmer, and certainly not a hacker, but more of a hack than anything. At 62, functionality overrides aesthetics. (Grin). I actually voted for your solution. Regards. -mm"}], "tags": [], "owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1503754840, "last_edit_date": 1503754840, "creation_date": 1503577934, "answer_id": 45861752, "question_id": 45839883, "link": "https://stackoverflow.com/questions/45839883/cancel-button-makes-a-selection-rather-than-cancelling/45861752#45861752", "title": "Cancel Button makes a selection rather than cancelling", "body": "<p>@IRHM I've got the following to work correctly. I've used MsgBoxes to test with, and tested each option. Try it. Once it looks like it's working for you, comment out or delete the unnecessary stuff, change the variable names and you should be good to go.  </p>\n\n<pre><code>Sub Email_Templates()\nDim ComboBox1\nDim intCount As Integer\nDim intSelectedIndex As Integer\nDim myNum As Integer\n\n'Dim outMail As Outlook.MailItem\n\nUserform1.Show\n\nmyNum = Userform1.ComboBox1.ListIndex\n\nIf myNum = 0 Then\n  Goto Abort\nElse\n\nMsgBox (\"Back to the main module\")\n\n Select Case myNum\n\n Case 1\n    'Using MsgBox to test and make sure it's working\n    MsgBox \"You selected Account Amendment Non SC - Option 1\"\n    'Set outMail = CreateItemFromTemplate(\"TemplatePath\\Account Amendment Non SC.oft\")\n\nCase 2\n    MsgBox \"You selected Account Amendment SC Application Received - Option 2\"\n    'Set outMail = CreateItemFromTemplate(\"TemplatePath\\Account Amendment SC Application Received.oft\")\n\nCase 3\n    MsgBox \"You Selected Account Amendment SC - Option 3\"\n    'Set outMail = CreateItemFromTemplate(\"TemplatePath\\Account Amendment SC.oft\")\nEnd Select\nAbort:\n End If\n Unload UserForm1\nEnd Sub\n</code></pre>\n\n<p>Put the following lines in the UserForm code module:</p>\n\n<pre><code>Sub btnCancel_Click()\n  MsgBox (\"Cancel button selected\")\n  Unload Me\nEnd Sub\n\nSub btnOK_Click()\n  MsgBox (\"OK Selected\")\n  Me.Hide\nEnd Sub\n\nSub UserForm_Initialize()\n'Put all your AddItems here\n  With ComboBox1\n    .Clear\n    .AddItem \"This should exit\", 0\n    .AddItem \"Selection 1\", 1\n    .AddItem \"Selection 2\", 2\n    .AddItem \"Selection 3\", 3\n  End With\nEnd Sub    \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 2, "last_activity_date": 1503751463, "creation_date": 1503751463, "answer_id": 45895511, "question_id": 45839883, "link": "https://stackoverflow.com/questions/45839883/cancel-button-makes-a-selection-rather-than-cancelling/45895511#45895511", "title": "Cancel Button makes a selection rather than cancelling", "body": "<p>The global variable lstnum is initially 0. Since you are using lstnum as the Select trigger make it -1, to conform to the norm.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/45322263/outlook-form-to-select-email-template\">Outlook Form To Select Email Template</a></p>\n\n<pre><code>Case -1\n'  -1 is what you want to use if nothing is selected\n</code></pre>\n\n<p>Following the method you are using to return the choice from the userform.</p>\n\n<pre><code>Private Sub btnCancel_Click()\n    lstNum = -1\n    Unload Select_Email_Template\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1503753786, "post_id": 45895545, "comment_id": 78750535, "body": "Hi @robinCTS, thank you so much for putting this together and for the explanation. It works perfectly.  Many thanks and kind regards"}], "tags": [], "owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "is_accepted": true, "score": 3, "last_activity_date": 1503991394, "last_edit_date": 1503991394, "creation_date": 1503751735, "answer_id": 45895545, "question_id": 45839883, "link": "https://stackoverflow.com/questions/45839883/cancel-button-makes-a-selection-rather-than-cancelling/45895545#45895545", "title": "Cancel Button makes a selection rather than cancelling", "body": "<p>Whilst it <em>is</em> possible to solve the issue by using a global variable, a much neater solution is use the <code>UserForm.Tag</code> property to pass a result back to the main procedure.</p>\n\n<p>Be aware that unloading the UserForm also removes the tag value, so you need to <em>hide</em> the UserForm in the click handlers, use the tag value in the main procedure, and <em>then</em> unload the UserForm.</p>\n\n<p><code>Select_Email_Template</code> UserForm code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n  Dim varTemplateName As Variant\n\n  With ComboBox1\n    For Each varTemplateName In Templates(NameOnly:=True) ' Templates() also works\n      .AddItem varTemplateName\n    Next\n  End With\n\nEnd Sub\n\nPrivate Sub btnOK_Click()\n  Me.Tag = Me.ComboBox1.ListIndex\n  Me.Hide\nEnd Sub\n\nPrivate Sub btnCancel_Click()\n  Me.Tag = -1\n  Me.Hide\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n  If CloseMode = VBA.VbQueryClose.vbFormControlMenu Then\n    Cancel = True\n    btnCancel_Click\n  End If\nEnd Sub\n</code></pre>\n\n<p>Non-Class Module code:</p>\n\n<pre><code>Public Sub Email_Templates()\n  With Select_Email_Template\n    .Show\n    If .Tag &lt;&gt; -1 Then\n      CreateItemFromTemplate(Templates(.Tag, FullPath:=True)).Display ' Templates(.Tag) also works\n    End If\n  End With\n  Unload Select_Email_Template\nEnd Sub\n\nPublic Function Templates _\n                ( _\n                  Optional ByVal plngIndex As Long = -1 _\n                , Optional ByVal NameOnly As Boolean = False _\n                , Optional ByVal FullPath As Boolean = False _\n                ) _\n       As Variant\n\n  Const strcTemplatesDir As String = \"&lt;TemplatesPath&gt;\\\"\n  Const strcTemplateExtension As String = \".oft\"\n\n  Static avarTemplateNames As Variant\n\n  If IsEmpty(avarTemplateNames) Then\n    avarTemplateNames = Array _\n    ( _\n      \"Account Amendment Non SC\" _\n    , \"Account Amendment SC Application Received\" _\n    , \"Account Amendment SC\" _\n    , \"Account Creation Non SC\" _\n    , \"Account Creation SC Application Received\" _\n    , \"Account Creation SC\" _\n    , \"Export Function\" _\n    , \"Export Function\" _\n    )\n  End If\n  If plngIndex &lt;&gt; -1 Then\n    If NameOnly = True And FullPath = False Then\n      Templates = avarTemplateNames(plngIndex)\n    Else\n      Templates = strcTemplatesDir &amp; avarTemplateNames(plngIndex) &amp; strcTemplateExtension\n    End If\n  Else\n    Templates = avarTemplateNames\n  End If\n\nEnd Function\n</code></pre>\n\n<p><strong>Explanation:</strong></p>\n\n<p>The main idea here is to return, via the <code>Select_Email_Template.Tag</code> property, a -1 when the user clicks <kbd>Cancel</kbd> and a valid index (0 to 7 in your example) when the user clicks <kbd>OK</kbd>.</p>\n\n<p>The code also redirects <kbd>ALT</kbd>+<kbd>F4</kbd>, clicking the close box (and its keyboard shortcut equivalent <kbd>ALT</kbd>+<kbd>SPC</kbd>;<kbd>C</kbd>), and any other method of closing the UserForm, to the cancel button's click handler.</p>\n\n<p>I've also taken the liberty of refactoring your code so all the template data is declared once only and in one place only, i.e., in the <code>Templates()</code> function.</p>\n\n<p>I've used a static variable in this function so that the array is only ever initialized once. You could just declare it with <code>Dim</code> and skip the empty check and it would still work just fine.</p>\n\n<hr>\n\n<blockquote class=\"spoiler\">\n  <p> Note: If you are curious about my variable naming convention, it is based on <a href=\"http://www.xoc.net/standards/rvbanc.asp\" rel=\"nofollow noreferrer\">RVBA</a>.</p>\n</blockquote>\n"}], "owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 1, "accepted_answer_id": 45895545, "answer_count": 3, "score": 4, "last_activity_date": 1592896265, "creation_date": 1503491642, "last_edit_date": 1592896265, "question_id": 45839883, "link": "https://stackoverflow.com/questions/45839883/cancel-button-makes-a-selection-rather-than-cancelling", "title": "Cancel Button makes a selection rather than cancelling", "body": "<p>I'm using the following code behind an Outlook UserForm called Select_Email_Template.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n  With ComboBox1\n    .AddItem \"Account Amendment Non SC\"\n    .AddItem \"Account Amendment SC Application Received\"\n    .AddItem \"Account Amendment SC\"\n    .AddItem \"Account Creation Non SC\"\n    .AddItem \"Account Creation SC Application Received\"\n    .AddItem \"Account Creation SC\"\n    .AddItem \"Export Function\"\n    .AddItem \"Password Reset\"\n  End With\nEnd Sub\n\nPrivate Sub btnOK_Click()\n    lstNum = ComboBox1.ListIndex\n    Unload Me\nEnd Sub\n\nPrivate Sub btnCancel_Click()\n    Unload Select_Email_Template\nEnd Sub\n</code></pre>\n\n<p>The ComboBox allows the user to select an email template. When one is selected and <kbd>OK</kbd> clicked, the template is opened in Outlook.</p>\n\n<p>This is the code which opens the templates:</p>\n\n<pre><code>Public lstNum As Long\n\nPublic Sub Email_Templates()\n\n    Dim outMail As Outlook.MailItem\n\n    Select_Email_Template.Show\n\n    Select Case lstNum\n\n    ' Following the listbox entries\n\n\n    Case 0\n        Set outMail = CreateItemFromTemplate(\"TemplatePath\\Account Amendment Non SC.oft\")\n\n    Case 1\n        Set outMail = CreateItemFromTemplate(\"TemplatePath\\Account Amendment SC Application Received.oft\")\n\n    Case 2\n        Set outMail = CreateItemFromTemplate(\"TemplatePath\\Account Amendment SC.oft\")\n\n    Case 3\n        Set outMail = CreateItemFromTemplate(\"TemplatePath\\Account Creation Non SC.oft\")\n\n    Case 4\n        Set outMail = CreateItemFromTemplate(\"TemplatePath\\Account Creation SC Application Received.oft\")\n\n    Case 5\n        Set outMail = CreateItemFromTemplate(\"TemplatePath\\Account Creation SC.oft\")\n\n    Case 6\n        Set outMail = CreateItemFromTemplate(\"TemplatePath\\Export Function.oft\")\n\n    Case 7\n        Set outMail = CreateItemFromTemplate(\"TemplatePath\\Export Function.oft\")\n\n    End Select\n\n    ' Use for a specific purpose not randomly\n    ' On Error Resume Next\n\n    With outMail\n        .Display\n    End With\n\n    ' On Error GoTo 0\n\ncleanup:\n        Set outMail = Nothing\n\n  End Sub\n</code></pre>\n\n<p>When the user clicks <kbd>Cancel</kbd>, the form closes but the first template from the list opens in Outlook.</p>\n\n<p>How can I close the form without this first template opening at the same time?</p>\n"}, {"tags": ["vba", "excel", "countif"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 7999819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212986117993465/picture?type=large", "display_name": "muahahahh", "link": "https://stackoverflow.com/users/7999819/muahahahh"}, "edited": false, "score": 0, "creation_date": 1503491096, "post_id": 45839480, "comment_id": 78636507, "body": "thanks, the macro itself works properly, the problem appears on the step with mp3 and mp4 calculation. it calculates the proper range, where let&#39;s say 250 cells with value 3, and 500 with number 4, but countif for nr 3 returns me result of 750 and countif of nr 4 returns value 0, what is absolutely wrong. even when I&#39;ve updated the code a/t your recommendations, it still doesn&#39;t count properly:("}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 49, "user_id": 7999819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212986117993465/picture?type=large", "display_name": "muahahahh", "link": "https://stackoverflow.com/users/7999819/muahahahh"}, "edited": false, "score": 0, "creation_date": 1503491236, "post_id": 45839480, "comment_id": 78636628, "body": "@muahahahh - did you change it, adding the <code>.</code> and the <code>With</code>?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 4, "last_activity_date": 1503491272, "last_edit_date": 1503491272, "creation_date": 1503490567, "answer_id": 45839480, "question_id": 45839358, "link": "https://stackoverflow.com/questions/45839358/vba-countif-issue/45839480#45839480", "title": "VBA CountIf issue", "body": "<p>Change the end of the code to this:</p>\n\n<pre><code>with xWs\n    mp3 = WorksheetFunction.CountIf(.Range(.Cells(2, 4), .Cells((lastrow + 1), 4)), 3)\n    mp4 = WorksheetFunction.CountIf(.Range(.Cells(2, 4), .Cells((lastrow + 1), 4)), 4)\nend with\n</code></pre>\n\n<p>Wtihout the With and the <code>.</code>, the <code>Cells</code> and <code>Range</code> refer to the activesheet. Thus, it is a good idea to refer it yourself.</p>\n\n<p>Then if you feel like it, refactor your code like this:</p>\n\n<ul>\n<li>Change <code>\"\"</code> to <code>vbNullString</code> <a href=\"https://stackoverflow.com/questions/32435320/is-there-any-difference-between-vbnullstring-and\">Is there any difference between vbNullString and &quot;&quot;?</a></li>\n<li>Change <code>Integer</code> to <code>Long</code> everywhere <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\">Why Use Integer Instead of Long?</a></li>\n<li>Make sure that you always refer to the worksheet you are working with and avoid <code>ActiveSheet</code> and <code>Select</code>. <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></li>\n<li>Think of a solution for autoindent - <a href=\"http://rubberduckvba.com/\" rel=\"nofollow noreferrer\">RubberDuck</a> or <a href=\"https://www.add-ins.com/macro-products-for-Microsoft-Excel/how-to-indent-vba-code/how-to-indent-vba-code.htm\" rel=\"nofollow noreferrer\">SmartIndenter</a></li>\n</ul>\n"}], "owner": {"reputation": 49, "user_id": 7999819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212986117993465/picture?type=large", "display_name": "muahahahh", "link": "https://stackoverflow.com/users/7999819/muahahahh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 45839480, "answer_count": 1, "score": 1, "last_activity_date": 1518630482, "creation_date": 1503490240, "last_edit_date": 1518630482, "question_id": 45839358, "link": "https://stackoverflow.com/questions/45839358/vba-countif-issue", "title": "VBA CountIf issue", "body": "<p>I have a problem with countif function in vba(last two rows of code). The it has to calculate certain values in certain range, however it counts absolutely every value as mp3 and nothing as mp4. </p>\n\n<p>The weirdest is that when I copy the procedure into a new separate module, without passing variables, everything works correctly, returning me the right values. What is wrong here? Thanks</p>\n\n<pre><code>Private Sub FindValue(ByVal fileno As String, ByVal deadline As String)\n\nDim i As Integer\nDim xWs As Worksheet\nDim rng As Range\nDim olApp As Object\nDim olMail As Object\nDim var As Integer\nDim user As String\nDim uplDate As String\nConst olMailItem = 0\nDim lastrow As Long\nDim mp3 As Long\nDim mp4 As Long\n\nSheets(\"Add_User_ID\").Select\nvar = Sheets(\"Add_User_ID\").Range((\"A2\"), Sheets(\"Add_User_ID\").Range(\"A2\").End(xlDown)).Rows.Count\nIf fileno = \"\" Then\nfileno = InputBox(\"File number\")\nEnd If\nIf deadline = \"\" Then\ndeadline = InputBox(\"Deadline, any format(e.g. 27th of August EOD)\")\nEnd If\nuplDate = Format(Date, \"YYYYMMDD\")\n\nFor i = 2 To var + 1\nuser = Sheets(\"Add_User_ID\").Cells(i, \"A\").Value\nSheets(\"allocation\").Select\nWith ActiveSheet\n    .AutoFilterMode = False\n    .Range(\"A:I\").AutoFilter\n    .Range(\"A:A\").AutoFilter field:=1, Criteria1:=user\nEnd With\n\nSheets(\"allocation\").Range(\"A1\").Select\nSet rng = ActiveCell.CurrentRegion\nApplication.Workbooks.Add\nSet xWs = Application.ActiveSheet\nrng.Copy Destination:=xWs.Range(\"A1\")\nlastrow = xWs.Cells(Rows.Count, 2).End(xlUp).Row - 1\nmp3 = WorksheetFunction.CountIf(Range(Cells(2, 4), Cells((lastrow + 1), 4)), 3)\nmp4 = WorksheetFunction.CountIf(Range(Cells(2, 4), Cells((lastrow + 1), 4)), 4)\n</code></pre>\n"}, {"tags": ["vba", "excel", "memory", "userform"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1503489260, "post_id": 45838982, "comment_id": 78635088, "body": "If you need to keep your filters, it would be better to save them in an INI file of some sort."}, {"owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1503489416, "post_id": 45838982, "comment_id": 78635196, "body": "@braX Sorry I haven&#39;t been precise enough. I don&#39;t need to keep the filters forever but only until the user close the Excel file (I edited my post). My question is more about how to manage the form than how to manage filters."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1503489482, "post_id": 45838982, "comment_id": 78635256, "body": "In that case, just hiding the form is good enough."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 2, "creation_date": 1503490595, "post_id": 45838982, "comment_id": 78636111, "body": "If you use multiple forms it is better to use <code>Unload Me</code> because, as far as I remember, with use of <code>UserForm.Hide</code> project persists in Run mode which can lead to unpredictable circumstances."}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1574268054, "post_id": 46068369, "comment_id": 104173947, "body": "Consider reading <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show?</a> where you might get some ideas why one should avoid <code>Unload Me</code> :-)"}], "tags": [], "owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "is_accepted": true, "score": 0, "last_activity_date": 1504679779, "creation_date": 1504679779, "answer_id": 46068369, "question_id": 45838982, "link": "https://stackoverflow.com/questions/45838982/close-userform-using-myform-hide-or-unload-me/46068369#46068369", "title": "Close userform using myForm.Hide or Unload Me", "body": "<p>I found an interesting answer to my question I thought it would be useful to post it here.</p>\n\n<p><strong>Unload me</strong></p>\n\n<pre><code>Unload me\n</code></pre>\n\n<p>Removes the form from the memory and stop the application if you do so on the main form of your project. Every modification that you did in your form will be lost.</p>\n\n<p><strong>Hide</strong></p>\n\n<pre><code>myForm.Hide\n</code></pre>\n\n<p>Only hide the form. If you do so on the main form of your application, this will not end the program (the debug mode would still be running for example). Every modification that you do in your form will be kept for the next time you show your form.</p>\n\n<p><strong>Which one to use?</strong></p>\n\n<p>Depends of the situation I believe. In my project, my form was made to be open/close multiple times so I chose to only hide it to avoid having to allow memory for my form every time.</p>\n"}], "owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2298, "favorite_count": 0, "accepted_answer_id": 46068369, "answer_count": 1, "score": 0, "last_activity_date": 1504680911, "creation_date": 1503489127, "last_edit_date": 1504680911, "question_id": 45838982, "link": "https://stackoverflow.com/questions/45838982/close-userform-using-myform-hide-or-unload-me", "title": "Close userform using myForm.Hide or Unload Me", "body": "<p>Before I start let me give you the background. I am working on a VBA project with Excel and the computer I am using has limited resources (and I have been asked to do as light as possible for fast execution time). \nIn my project I open multiple userform at different times, to apply filters on my sheet for example.</p>\n\n<p>As I just said resources are limited and I want to know if <code>frmFilters.Hide</code> is enough to close the userform or if there is a better way to do so ?</p>\n\n<p><a href=\"https://www.mrexcel.com/forum/excel-questions/336931-unload-vs-hide.html\" rel=\"nofollow noreferrer\">I've read about</a> <code>Unload Me</code> but I'm not sure how it's working because I'll apply filters from my form and I need to keep them once the form is closed until the user totally close the Excel file.</p>\n\n<p>Is there a situation where <code>Unload Me</code> is better than <code>frmFilters.Hide</code> ?</p>\n\n<p>Regards,\nTeasel</p>\n"}, {"tags": ["vba", "date", "ms-access", "login", "comparison"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1503488623, "last_edit_date": 1503488623, "creation_date": 1503488311, "answer_id": 45838674, "question_id": 45838603, "link": "https://stackoverflow.com/questions/45838603/how-to-compare-a-record-date-with-current-date/45838674#45838674", "title": "How to compare a record date with current date?", "body": "<p>Your approach looks pretty valid, but you've got numerous syntax errors in your <code>DLookUp</code> statement. It should be:</p>\n\n<pre><code>If CDate(DLookup(\"[Finish Date]\", \"Employee\", \"Userlogin = \"\"\" &amp; Me.TxtUserName.Value &amp; \"\"\"\")) &gt;= Date() Then\n</code></pre>\n\n<p>Assuming Finish Date is a valid date field. \nNote that this doesn't handles <code>Null</code> and invalid dates properly. For a more robust approach: </p>\n\n<pre><code>Dim MyDate As Variant\nMyDate = DLookup(\"[Finish Date]\", \"Employee\", \"Userlogin = \"\"\" &amp; Me.TxtUserName.Value &amp; \"\"\"\")\nIf IsDate(MyDate) Then\n    If CDate(MyDate) &gt;= Date() Then\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8443203, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4b254cfcd0e1a8aabb059fb12d4d6217?s=128&d=identicon&r=PG&f=1", "display_name": "Everton", "link": "https://stackoverflow.com/users/8443203/everton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 45838674, "answer_count": 1, "score": 0, "last_activity_date": 1503488623, "creation_date": 1503488100, "question_id": 45838603, "link": "https://stackoverflow.com/questions/45838603/how-to-compare-a-record-date-with-current-date", "title": "How to compare a record date with current date?", "body": "<p>In my login form, I am trying to compare the user's finish date with the current date to determine if they should be allowed into the system or not. Unfortunately my code isn't working.</p>\n\n<p>My work is as follows;</p>\n\n<pre><code>If Cdate(DLookup(\"[FInish Date]\", \"Employee\", \"Userlogin = Me.TxtUserName.Value)) &gt;= Date() then\n</code></pre>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1503494217, "last_edit_date": 1503494217, "creation_date": 1503488195, "answer_id": 45838629, "question_id": 45838527, "link": "https://stackoverflow.com/questions/45838527/using-array-instead-of-different-subs-in-vba/45838629#45838629", "title": "Using array instead of different subs in vba", "body": "<p>Try to add the system as a parameter. In the example below it is an optional one:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Macro1(Optional strParam As String = \"System1\")\n\n    Set x = Workbooks.Open(\"C:\\Users\\****\\Desktop\\New folder\\\" &amp; strParam &amp; \".xls\")\n\n    With x.Sheets(strParam)\n\n        Set aCell1 = .Range(\"A1:X1000\").Find(What:=\"User\", LookIn:=xlValues,\n        LookAt:=xlWhole, _MatchCase:=False, SearchFormat:=False)\n\n        .Range(aCell1,\n        .Cells(.Rows.Count,aCell1.Column).End(xlUp)).Offset(2,0).Copy_\n        ThisWorkbook.Sheets(strParam).Range (\"A2\")\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>And this is how you call it:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Macro1 'same as Macro1 \"System1\"\n    Macro1 \"System1\"\n    Macro1 \"System2\"\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong> As far as you want array in the original, here is a possible solution, that you can fix using the Macro1 sub from above:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim myArr           As Variant\n    Dim lngCounter      As Long\n\n    myArr = Array(\"System1\", \"System2\", \"System3\")\n\n    For lngCounter = LBound(myArr) To UBound(myArr)\n        Macro1 myArr(lngCounter)\n    Next lngCounter\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1503488257, "creation_date": 1503488257, "answer_id": 45838658, "question_id": 45838527, "link": "https://stackoverflow.com/questions/45838527/using-array-instead-of-different-subs-in-vba/45838658#45838658", "title": "Using array instead of different subs in vba", "body": "<p>You just need to refactor your code:</p>\n\n<pre><code>Private Sub Macro1()\n\nGetData 1\nEnd Sub\n\nPrivate Sub Macro2()\n\nGetData 2\nEnd Sub\n\nSub GetData(systemNum as long)\nSet x = Workbooks.Open(\"C:\\Users\\****\\Desktop\\New folder\\System\" &amp; systemNum &amp; \".xls\")\n\nWith x.Sheets(\"System\" &amp; systemNum)\n\nSet aCell1 = .Range(\"A1:X1000\").Find(What:=\"User\", LookIn:=xlValues, \nLookAt:=xlWhole, _MatchCase:=False, SearchFormat:=False)\n\n.Range(aCell1, \n.Cells(.Rows.Count,aCell1.Column).End(xlUp)).Offset(2,0).Copy_\nThisWorkbook.Sheets(\"System1\").Range(\"A2\")\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 45838658, "answer_count": 2, "score": 0, "last_activity_date": 1503494217, "creation_date": 1503487859, "question_id": 45838527, "link": "https://stackoverflow.com/questions/45838527/using-array-instead-of-different-subs-in-vba", "title": "Using array instead of different subs in vba", "body": "<p>I have developed a vba for many systems. I am giving examples for 2 systems here:</p>\n\n<pre><code>Private Sub Macro1()\n\nSet x = Workbooks.Open(\"C:\\Users\\****\\Desktop\\New folder\\System1.xls\")\n\nWith x.Sheets(\"System1\")\n\nSet aCell1 = .Range(\"A1:X1000\").Find(What:=\"User\", LookIn:=xlValues, \nLookAt:=xlWhole, _MatchCase:=False, SearchFormat:=False)\n\n.Range(aCell1, \n.Cells(.Rows.Count,aCell1.Column).End(xlUp)).Offset(2,0).Copy_\nThisWorkbook.Sheets(\"System1\").Range(\"A2\")\nEnd With\n\nPrivate Sub Macro2()\n\nSet x = Workbooks.Open(\"C:\\Users\\****\\Desktop\\New folder\\System2.xls\")\n\nWith x.Sheets(\"System2\")\n\nSet aCell1 = .Range(\"A1:X1000\").Find(What:=\"User\", LookIn:=xlValues, \nLookAt:=xlWhole, _MatchCase:=False, SearchFormat:=False)\n\n.Range(aCell1, \n.Cells(.Rows.Count,aCell1.Column).End(xlUp)).Offset(2,0).Copy_\nThisWorkbook.Sheets(\"System1\").Range(\"A2\")\nEnd With\n</code></pre>\n\n<p>Is there a way through which I can mention all the system name in an array or list instead of writing different subs for different systems?\nSince the only thing that is getting changed is the system number</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 1, "creation_date": 1503518102, "post_id": 45838958, "comment_id": 78654710, "body": "The above approach will only work on PageFields i.e. fields that appear in the &#39;Filters&#39; area of the PivotTable Fields Dialog. But on the upside, it is fast: much faster to use the .CurrentPage method like you are doing than to change the .visible status of each .PivotItem, as I&#39;ve outlined at <a href=\"http://dailydoseofexcel.com/archives/2013/11/14/filtering-pivots-based-on-external-ranges/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2013/11/14/&hellip;</a>. If you want a solution that works just as quickly on non page fields, check out <a href=\"https://stackoverflow.com/questions/39004607/filtering-pivot-table-with-vba\" title=\"filtering pivot table with vba\">stackoverflow.com/questions/39004607/&hellip;</a> (That approach also lets you define date periods)."}, {"owner": {"reputation": 154, "user_id": 4623971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/523772b8d9c855c0694d9fe33921442b?s=128&d=identicon&r=PG&f=1", "display_name": "GCJ", "link": "https://stackoverflow.com/users/4623971/gcj"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1503587438, "post_id": 45838958, "comment_id": 78688771, "body": "Thanks for the suggestion - I&#39;ve been looking into the non-filter options so this will be useful going forward.  Many thanks :-)"}], "tags": [], "owner": {"reputation": 154, "user_id": 4623971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/523772b8d9c855c0694d9fe33921442b?s=128&d=identicon&r=PG&f=1", "display_name": "GCJ", "link": "https://stackoverflow.com/users/4623971/gcj"}, "is_accepted": true, "score": 1, "last_activity_date": 1503489081, "creation_date": 1503489081, "answer_id": 45838958, "question_id": 45838354, "link": "https://stackoverflow.com/questions/45838354/macro-to-automatically-select-the-most-recent-date-in-a-pivot-table-filter-drop/45838958#45838958", "title": "Macro to automatically select the most recent date in a pivot table filter drop down", "body": "<p>For anybody that is interested or may need to do this in future, here is the solution that I came up with:</p>\n\n<pre><code>Sub RefreshPivot()\n'\n' RefreshPivot Macro\n'\n\n'\n    Sheets(\"Pivot\").Select\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotCache.Refresh\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"ExtractDate\"). _\n        ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"ExtractDate\").CurrentPage _\n        = ThisWorkbook.Worksheets(\"Pivot\").Range(\"C4\").Value\nEnd Sub\n</code></pre>\n\n<p>The value in cell C4 is simply the most recent date.  This works perfectly now.</p>\n"}, {"comments": [{"owner": {"reputation": 154, "user_id": 4623971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/523772b8d9c855c0694d9fe33921442b?s=128&d=identicon&r=PG&f=1", "display_name": "GCJ", "link": "https://stackoverflow.com/users/4623971/gcj"}, "edited": false, "score": 0, "creation_date": 1503494934, "post_id": 45839362, "comment_id": 78639641, "body": "I didn&#39;t actually end up needing the code you wrote as my small code worked fine.  I appreciate the help though."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 2, "last_activity_date": 1503490253, "creation_date": 1503490253, "answer_id": 45839362, "question_id": 45838354, "link": "https://stackoverflow.com/questions/45838354/macro-to-automatically-select-the-most-recent-date-in-a-pivot-table-filter-drop/45839362#45839362", "title": "Macro to automatically select the most recent date in a pivot table filter drop down", "body": "<p>Please give this a try...</p>\n\n<pre><code>Sub Filter_PivotField()\n'Description: Filter a pivot table for a specific date or period\nDim sSheetName As String\nDim sPivotName As String\nDim sFieldName As String\nDim sFilterCrit As Double\nDim pt As PivotTable\nDim pf As PivotField\nDim pi As PivotItem\n\n'Set the variables\nsSheetName = \"Pivot\"\nsPivotName = \"PivotTable1\"\nsFieldName = \"ExtractDate\"\n'sFilterCrit = \"22/08/2017\" --most recent date\nsFilterCrit = ThisWorkbook.Worksheets(\"Pivot\").Range(\"C4\").Value\n\nSet pt = ThisWorkbook.Worksheets(\"Pivot\").PivotTables(sPivotName)\nSet pf = pt.PivotFields(sFieldName)\npf.ClearAllFilters\n\n\nFor Each pi In pf.PivotItems\n    If CDbl(DateValue(pi)) = sFilterCrit Then\n        pi.Visible = True\n    Else\n        pi.Visible = False\n    End If\nNext pi\nEnd Sub\n</code></pre>\n\n<p>If you are not sure whether your criteria date is available in pivot filter items or not, you may try something like this.</p>\n\n<pre><code>Sub Filter_PivotField()\n'Description: Filter a pivot table for a specific date or period\nDim sSheetName As String\nDim sPivotName As String\nDim sFieldName As String\nDim sFilterCrit As Double\nDim pt As PivotTable\nDim pf As PivotField\nDim pi As PivotItem\nDim dict\n'Set the variables\nsSheetName = \"Pivot\"\nsPivotName = \"PivotTable1\"\nsFieldName = \"ExtractDate\"\n'sFilterCrit = \"22/08/2017\" --most recent date\nsFilterCrit = ThisWorkbook.Worksheets(\"Pivot\").Range(\"C4\").Value\n\nSet pt = ThisWorkbook.Worksheets(\"Pivot\").PivotTables(sPivotName)\nSet pf = pt.PivotFields(sFieldName)\npf.ClearAllFilters\n\nSet dict = CreateObject(\"Scripting.Dictionary\")\nFor Each pi In pf.PivotItems\n    dict.Item(CDbl(DateValue(pi))) = \"\"\nNext pi\n\nIf Not dict.exists(sFilterCrit) Then\n    MsgBox \"The criteria date is missing in Pivot Filter Items.\", vbExclamation\n    Exit Sub\nEnd If\n\nFor Each pi In pf.PivotItems\n    If CDbl(DateValue(pi)) = sFilterCrit Then\n        pi.Visible = True\n    Else\n        pi.Visible = False\n    End If\nNext pi\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 4623971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/523772b8d9c855c0694d9fe33921442b?s=128&d=identicon&r=PG&f=1", "display_name": "GCJ", "link": "https://stackoverflow.com/users/4623971/gcj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3425, "favorite_count": 1, "accepted_answer_id": 45838958, "answer_count": 2, "score": 0, "last_activity_date": 1579606826, "creation_date": 1503487308, "last_edit_date": 1579606826, "question_id": 45838354, "link": "https://stackoverflow.com/questions/45838354/macro-to-automatically-select-the-most-recent-date-in-a-pivot-table-filter-drop", "title": "Macro to automatically select the most recent date in a pivot table filter drop down", "body": "<p>I have a report that is refreshed each week automatically, and then I have a number of macros that run that do various things. Everything currently works fine, however, I want to write a macro that automatically selects the most recent date in a pivot table. At present, I have the following code:</p>\n\n<pre><code>Sub RefreshPivot()\n'\n' RefreshPivot Macro\n'\n\n'\n    Sheets(\"Pivot\").Select\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotCache.Refresh\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"ExtractDate\"). _\n        ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"ExtractDate\").CurrentPage _\n        = \"22/08/2017\"\nEnd Sub\n</code></pre>\n\n<p>The date \"22/08/2017\" is currently the most recent date, but if I run the report next week, the above macro is going to select the 22/08/2017 every time. Is there a quick piece of code that always selects the most recent date in the pivot filter?</p>\n\n<p>Any help would be most welcome.</p>\n\n<p><strong>edit:</strong></p>\n\n<p>So, I've attempted a different solution, that uses a cell reference in my report that contains the most recent date.  I use this date to set the filter criteria, and then the for loop goes through the pivot data and sets each value to blank until it finds a match:</p>\n\n<pre><code>Sub Filter_PivotField()\n'Description: Filter a pivot table for a specific date or period\n\n\nDim sSheetName As String\nDim sPivotName As String\nDim sFieldName As String\nDim sFilterCrit As String\nDim pi As PivotItem\n\n    'Set the variables\n    sSheetName = \"Pivot\"\n    sPivotName = \"PivotTable1\"\n    sFieldName = \"ExtractDate\"\n    'sFilterCrit = \"22/08/2017\" --most recent date\n    sFilterCrit = ThisWorkbook.Worksheets(\"Pivot\").Range(\"C4\").Value\n\n    With ThisWorkbook.Worksheets(sSheetName).PivotTables(sPivotName).PivotFields(sFieldName)\n        'Clear all filter of the pivotfield\n        .ClearAllFilters\n\n        'Loop through pivot items of the pivot field\n        'Hide or filter out items that do not match the criteria\n        For Each pi In .PivotItems\n            If pi.Name &lt;&gt; sFilterCrit Then\n                pi.Visible = False\n            End If\n        Next pi\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>However, when I run this, I get the following error:</p>\n\n<blockquote>\n  <p>Run-time error '1004': Unable to set the Visible property of the PivotItem class.</p>\n</blockquote>\n\n<p>Is anyone able to assist me?  </p>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8505701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa38d0411f1a8e4a5070f14831cfdcc9?s=128&d=identicon&r=PG&f=1", "display_name": "Snowgun", "link": "https://stackoverflow.com/users/8505701/snowgun"}, "edited": false, "score": 0, "creation_date": 1503487835, "post_id": 45838301, "comment_id": 78634048, "body": "you are the mvp!"}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 1, "last_activity_date": 1503487145, "creation_date": 1503487145, "answer_id": 45838301, "question_id": 45838039, "link": "https://stackoverflow.com/questions/45838039/how-do-i-open-a-textfile-in-access-and-load-it-in-vba-excel-with-the-filepath-st/45838301#45838301", "title": "How do I open a textfile in access and load it in vba excel with the filepath stored in a variable?", "body": "<p>Simply do it like this:</p>\n\n<pre><code>TextFileConn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; objectname\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 491, "user_id": 6515164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b69ead9bbbe78614bba7cee52d027fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Maksim", "link": "https://stackoverflow.com/users/6515164/maksim"}, "is_accepted": false, "score": 0, "last_activity_date": 1503487386, "creation_date": 1503487386, "answer_id": 45838375, "question_id": 45838039, "link": "https://stackoverflow.com/questions/45838039/how-do-i-open-a-textfile-in-access-and-load-it-in-vba-excel-with-the-filepath-st/45838375#45838375", "title": "How do I open a textfile in access and load it in vba excel with the filepath stored in a variable?", "body": "<p>Are you just asking for string concatenation?\n    TextFileConn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; objectname </p>\n"}], "owner": {"reputation": 3, "user_id": 8505701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa38d0411f1a8e4a5070f14831cfdcc9?s=128&d=identicon&r=PG&f=1", "display_name": "Snowgun", "link": "https://stackoverflow.com/users/8505701/snowgun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 45838301, "answer_count": 2, "score": 0, "last_activity_date": 1503499554, "creation_date": 1503486471, "last_edit_date": 1503499554, "question_id": 45838039, "link": "https://stackoverflow.com/questions/45838039/how-do-i-open-a-textfile-in-access-and-load-it-in-vba-excel-with-the-filepath-st", "title": "How do I open a textfile in access and load it in vba excel with the filepath stored in a variable?", "body": "<p>cracks:)</p>\n\n<p>I have following code:</p>\n\n<pre><code>Dim TextFileConn As ADODB.Connection\nDim TextFileData As ADODB.Recordset\nDim TextFileField As ADODB.Field\n\nSet TextFileConn = CreateObject(\"ADODB.Connection\")\nSet TextFileData = CreateObject(\"ADODB.Recordset\")\n\nTextFileConn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Users\\A7P2AZZ\\Desktop\\IBP DP Tool\\High_Level_Data_BG.accdb\"\n\nTextFileConn.Open\n\nWith TextFileData\n.ActiveConnection = TextFileConn\n.Source = \"FinalTable\"\n.LockType = adLockReadOnly\n.CursorType = adOpenForwardOnly\n.Open\n\nEnd With\n</code></pre>\n\n<p>Now I want to use a variable, which I can control from excel without going into the vba-code and adjust my filepath. For this purpose I created the variable \"objectname\" which stores my filepath.</p>\n\n<pre><code>objectname = \"C:\\Users\\A7P2AZZ\\Desktop\\IBP DP Tool\\High_Level_Data_BG.accdb\"\n</code></pre>\n\n<p>So my question is, how do I include the \"objectname\" into this</p>\n\n<pre><code>TextFileConn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Users\\A7P2AZZ\\Desktop\\IBP DP Tool\\High_Level_Data_BG.accdb\"\n</code></pre>\n\n<p>Any help is highly appreciated since I really searched in the whole world but didn't find it.</p>\n\n<p>Thank you!\nBest snowgun</p>\n"}, {"tags": ["vba", "excel", "charts", "gantt-chart"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1503486201, "post_id": 45837681, "comment_id": 78632815, "body": "Please share us the code that you have tried. Thanks"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1503486627, "post_id": 45837681, "comment_id": 78633157, "body": "Private Sub Worksheet_Change(ByVal Target As Range)   With ActiveSheet.ChartObjects(&quot;Chart 2&quot;).Chart     Select Case Target.Address       Case &quot;$G$161&quot;         .Axes(xlCategory).MaximumScale = Target.Value       Case &quot;$F$163&quot;         .Axes(xlCategory).MinimumScale = Target.Value       Case &quot;$G$161&quot;         .Axes(xlValue).MaximumScale = Target.Value       Case &quot;$F$163&quot;         .Axes(xlValue).MinimumScale = Target.Value     End Select   End With End Sub"}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1503486652, "post_id": 45837681, "comment_id": 78633174, "body": "just like from the site"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1503491335, "post_id": 45837681, "comment_id": 78636719, "body": "It is possible In scatter chart  to set Axes(xlCategory).  And it is applied to Axes only."}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1503493946, "post_id": 45837681, "comment_id": 78638820, "body": "Well, im not using a scatter chart. is there a macro for a bar chart?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1503494340, "post_id": 45837681, "comment_id": 78639149, "body": "You probably can&#39;t effectively use <b>two</b> <code>case</code> statements for a given value. Can you be more specific about what you mean by &quot;doesn&#39;t work&quot; and give more detail about the structure of your worksheet, in particular, are those cells G161 and F163 value literals, or are they containing a formula (which doesn&#39;t trigger the <code>Worksheet_Change</code> event."}, {"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1503495636, "post_id": 45837681, "comment_id": 78640264, "body": "yes, they are Vlookup formulas. the chart is a simple Gantt chart with cycle time and dates. but because i compare actual vs planned i show two Gantt charts in one chart."}], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1503555519, "post_id": 45845882, "comment_id": 78666276, "body": "ok, thank you. i did what you said. changed a bit here and there."}], "tags": [], "owner": {"reputation": 934, "user_id": 2946006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79ab52aa469c475f27ae6b16d5b87b8?s=128&d=identicon&r=PG&f=1", "display_name": "DMM", "link": "https://stackoverflow.com/users/2946006/dmm"}, "is_accepted": false, "score": 1, "last_activity_date": 1503509019, "creation_date": 1503509019, "answer_id": 45845882, "question_id": 45837681, "link": "https://stackoverflow.com/questions/45837681/link-excel-chart-axis-scale-to-values-in-cells/45845882#45845882", "title": "Link Excel Chart Axis Scale to Values in Cells", "body": "<p>The code you have re-used is a simple demonstration program which allows the axes of a chart to be manipulated when one of 6 specific cells on the worksheet is changed. However, these changes are intended to be made by the user through the keyboard. Making a change in this way triggers the <code>Worksheet_Change</code> event and allows the changed cell to be identified. The code within the event routine modifies the chart's axes according to which specific worksheet cell has been changed.</p>\n\n<p>Your issue, as David Ziemens noted in his comment, is that if a cell changes value because it is recalculated through a formula then this change does not trigger a <code>Worksheet_Change</code> event. (Of course, it is entirely possible that a manually entered change elsewhere on the worksheet will have triggered both a <code>Worksheet_Change</code> event and a recalculation causing a cell of interest to change its value via a formula. In this case, however, the <code>Target</code> argument will identify the cell that was manually changed rather than the one recalculated through a formula.)</p>\n\n<p>Throw away the <code>Select ... Case</code> structure, that is really only useful in the context of the demonstration program you are trying to re-use. Instead, change the code so that it unconditionally updates all 4 of your chart properties directly from cells <code>G161</code> and <code>F163</code> (so use <code>ws.Range(\"G161\").Value</code> and <code>ws.Range(\"F163\").Value</code> instead of <code>Target.Value</code> for assigning the chart properties, where <code>ws</code> represents whichever worksheet these cells are located on - eg <code>ActiveSheet</code> or <code>Worksheets(\"Sheet1\")</code> or whatever the worksheet is called). Wrap the assignment of the chart properties inside a <code>Workbook_SheetChange</code> sub rather than <code>Worksheet_Change</code> and your chart will update whenever the workbook recalculates.</p>\n\n<p>This is not a very pure solution in that it does not detect whether cells <code>F163</code> and <code>G161</code> actually change when recalculation takes place. So it runs the risk that the 4 properties are being unnecessarily assigned with values that are unchanged. However, unless you have a very large workbook and you are pushing the limits of what your computer can handle, this won't matter from a practical point of view.      </p>\n"}, {"tags": [], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "is_accepted": false, "score": 0, "last_activity_date": 1503555615, "creation_date": 1503555615, "answer_id": 45854300, "question_id": 45837681, "link": "https://stackoverflow.com/questions/45837681/link-excel-chart-axis-scale-to-values-in-cells/45854300#45854300", "title": "Link Excel Chart Axis Scale to Values in Cells", "body": "<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nWith ActiveSheet.ChartObjects(\"Chart 2\").Chart\nActiveSheet.ChartObjects(\"Chart 2\").Activate\n' for main axes\nActiveChart.Axes(xlValue).MaximumScale = Worksheets(\"Single \nTool\").Range(\"$G$161\").Value\nActiveChart.Axes(xlValue).MinimumScale = Worksheets(\"Single \nTool\").Range(\"$F$163\").Value\n\n'for secondary axes\nActiveChart.Axes(xlValue, xlSecondary).MaximumScale = Worksheets(\"Single \nTool\").Range(\"$G$161\").Value\nActiveChart.Axes(xlValue, xlSecondary).MinimumScale = Worksheets(\"Single \nTool\").Range(\"$F$163\").Value\n\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>i found that this works best. thank you all</p>\n"}], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4653, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1503555615, "creation_date": 1503485565, "last_edit_date": 1503493988, "question_id": 45837681, "link": "https://stackoverflow.com/questions/45837681/link-excel-chart-axis-scale-to-values-in-cells", "title": "Link Excel Chart Axis Scale to Values in Cells", "body": "<p>I have this Gantt Chart and i'm looking at Planned Vs Actual dates.\nthe problem is that the chart wont sync the start/end date.</p>\n\n<p>i'm trying to link the max/min values to the cell with VBA but it wont to it.</p>\n\n<p>I tried to use this site:\n<a href=\"https://peltiertech.com/link-excel-chart-axis-scale-to-values-in-cells/\" rel=\"nofollow noreferrer\">https://peltiertech.com/link-excel-chart-axis-scale-to-values-in-cells/</a></p>\n\n<p>but his code doesn't work for my chart. </p>\n\n<p>here is a picture:\n<a href=\"https://i.stack.imgur.com/R51fz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R51fz.png\" alt=\"enter image description here\"></a></p>\n\n<p>the dates MUST be the same, and change together if i change some values in the table on the right\nany ideas?\nthanks</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nWith ActiveSheet.ChartObjects(\"Chart 2\").Chart \nSelect Case Target.Address \n\nCase \"$G$161\" \n.Axes(xlCategory).MaximumScale = Target.Value \n\nCase \"$F$163\" \n.Axes(xlCategory).MinimumScale = Target.Value \n\nCase \"$G$161\" \n.Axes(xlValue).MaximumScale = Target.Value \n\nCase \"$F$163\" \n.Axes(xlValue).MinimumScale = Target.Value \n\nEnd Select \nEnd With \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "currency"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8505510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eacde2da3d5794548eae68c732857aff?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/8505510/damian"}, "edited": false, "score": 0, "creation_date": 1503485780, "post_id": 45837462, "comment_id": 78632527, "body": "Sorry I should have mentioned, I have tried this via a recorded macro, setting the drop-down to &quot;Currency&quot;, however when run through VBA, the drop-down is set as &quot;Custom&quot; .  I have been able to set the drop-down for other number format categories: Text = formatRange.NumberFormat = &quot;@&quot; Number = formatRange.NumberFormat = &quot;0.00&quot;"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1503484867, "creation_date": 1503484867, "answer_id": 45837462, "question_id": 45837291, "link": "https://stackoverflow.com/questions/45837291/excel-vba-number-format-category/45837462#45837462", "title": "Excel VBA Number Format Category", "body": "<p>Hint: Record a macro while formatting the cells shows you how to do it. Just replace the <code>Selection</code> the Macro recorder issues by the range you are dealing with.</p>\n\n<p>Assuming r to be your range:</p>\n\n<pre><code>with r\n  .NumberFormat = \"$ #,##0.00\"\nend with\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8505510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eacde2da3d5794548eae68c732857aff?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/8505510/damian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503484867, "creation_date": 1503484354, "question_id": 45837291, "link": "https://stackoverflow.com/questions/45837291/excel-vba-number-format-category", "title": "Excel VBA Number Format Category", "body": "<p>I have an Excel worksheet populated with data and I need to use VBA to format the cells, which isn't an issue in itself - getting the cells to show the correct format.  However I am having difficulty setting the number format category to \"Currency\", is there a way to set this using VBA.  Currently I see the correct format in the cells but the format category is set to \"Custom\".</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "cmd", "visio"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 1, "creation_date": 1503483741, "post_id": 45836985, "comment_id": 78631085, "body": "Changing the visio code to appropriately terminate is not an option?"}, {"owner": {"reputation": 104, "user_id": 6174826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc9c00862d09a4bd8ad70f56798dff90?s=128&d=identicon&r=PG&f=1", "display_name": "PythonParka", "link": "https://stackoverflow.com/users/6174826/pythonparka"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1503491348, "post_id": 45836985, "comment_id": 78636732, "body": "I&#39;m not very experienced with VBA so I wasn&#39;t sure how I would go about this. Is there a built in Kill method or something similar in VBA?"}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1503492017, "post_id": 45836985, "comment_id": 78637264, "body": "are you talking about &quot;visio&quot; processes or &quot;VBA&quot; processes?"}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1503495708, "post_id": 45836985, "comment_id": 78640323, "body": "Can you share your code please?"}, {"owner": {"reputation": 687, "user_id": 7990528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWVHp.png?s=128&g=1", "display_name": "Surrogate", "link": "https://stackoverflow.com/users/7990528/surrogate"}, "edited": false, "score": 0, "creation_date": 1503497731, "post_id": 45836985, "comment_id": 78642047, "body": "@Cormac, do you create 3000 visio application sessions ? Best practise create visio session one time, and open there documents. Make some changes, save and close this document !"}], "answers": [{"comments": [{"owner": {"reputation": 104, "user_id": 6174826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc9c00862d09a4bd8ad70f56798dff90?s=128&d=identicon&r=PG&f=1", "display_name": "PythonParka", "link": "https://stackoverflow.com/users/6174826/pythonparka"}, "edited": false, "score": 0, "creation_date": 1503564499, "post_id": 45840509, "comment_id": 78671786, "body": "Exactly, I have been using CreateObject. If I use GetObject, will this create 3000 separate Visio documents, or will it create 3000 sheets in the same document? Unfortunately they have to be 3000 separate ones. Thanks for your hep!"}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "reply_to_user": {"reputation": 104, "user_id": 6174826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc9c00862d09a4bd8ad70f56798dff90?s=128&d=identicon&r=PG&f=1", "display_name": "PythonParka", "link": "https://stackoverflow.com/users/6174826/pythonparka"}, "edited": false, "score": 0, "creation_date": 1503571833, "post_id": 45840509, "comment_id": 78677040, "body": "@Cormac <code>GetObject</code> will only effect application processes. in your application you can control the documents created and sheets thought the appropriate methods i.e in Excel you can use <code>appExcel.Workbooks.Add(fn)</code> and <code>wkb.Sheets.Add()</code> and similar methods in Visio"}], "tags": [], "owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "is_accepted": false, "score": 0, "last_activity_date": 1503493272, "creation_date": 1503493272, "answer_id": 45840509, "question_id": 45836985, "link": "https://stackoverflow.com/questions/45836985/automating-the-killing-of-visio-processes-taking-up-0-cpu/45840509#45840509", "title": "Automating the killing of Visio processes taking up 0% CPU", "body": "<p>I suppose you have in your code something like this :<br />\n    <code>Dim appVisio</code> <br />\n    <code>Set appVisio = CreateObject(\"Visio.Aplication\")</code><br />\n    <code>... your code ...</code><br />\nSo you can instead use <br />\n    <code>Set appVisio = GetObject(,\"Visio.Aplication\")</code><br />\nThis will use the same application instance instead of creating new ones<br />\nThen in the end of your script try <br />\n<code>appVisio.Quit</code> </p>\n"}], "owner": {"reputation": 104, "user_id": 6174826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc9c00862d09a4bd8ad70f56798dff90?s=128&d=identicon&r=PG&f=1", "display_name": "PythonParka", "link": "https://stackoverflow.com/users/6174826/pythonparka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1503493272, "creation_date": 1503483495, "question_id": 45836985, "link": "https://stackoverflow.com/questions/45836985/automating-the-killing-of-visio-processes-taking-up-0-cpu", "title": "Automating the killing of Visio processes taking up 0% CPU", "body": "<p>I have some VBA code taking data from an excel file and turning this data into Visio diagrams. There are over 3000 Visios to be made, so the code is just running in the background.\nThe issue is that each Visio process stays running in the background stays running until I manually kill it through Task Manager. This will lead to memory issues if I don't manually kill them.\nIs there a cmd command or script that I can run which will kill all Visio processes that are taking up 0% CPU? Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1503483522, "post_id": 45836860, "comment_id": 78630911, "body": "What is the intention behind <code>.Value = .Value</code>?"}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1503483776, "post_id": 45836860, "comment_id": 78631115, "body": "@DavidG  to hide the formula and give it as value"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1503484979, "post_id": 45836860, "comment_id": 78631934, "body": "Try swapping <code>.AutoFilter 26, True</code> and <code>.Formula = sformula</code> (Formula first, filter second). Also, notice, you have a header."}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1503485929, "post_id": 45836860, "comment_id": 78632640, "body": "@AntiDrondert it works :) You can post and I would mark it as answer. But I would like to know the reason behind swapping. could you explain"}], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1503486334, "post_id": 45837912, "comment_id": 78632925, "body": "@could you please explain the reson behind swapping the lines. It would be helpful for me in future &#180;"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "reply_to_user": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1503486460, "post_id": 45837912, "comment_id": 78633028, "body": "Edited the answer, explanation below"}], "tags": [], "owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "is_accepted": true, "score": 3, "last_activity_date": 1503486432, "last_edit_date": 1503486432, "creation_date": 1503486159, "answer_id": 45837912, "question_id": 45836860, "link": "https://stackoverflow.com/questions/45836860/error-while-using-the-autofilter-condition/45837912#45837912", "title": "Error while using the autofilter condition", "body": "<p><strong>Try this:</strong>  </p>\n\n<pre><code>Sub fc()\n    Dim totalrows As Long\n    Dim FC as Worksheet: Set FC=ThisWorkbook.Worksheets(\"FC\")\n    totalrows = FC.Range(\"A\" &amp; FC.Rows.Count).End(xlUp).Row\n    sformula = \"=AND(S6&lt;&gt;\"\"Invalid\"\",OR(ISBLANK(T6),ISBLANK(U6)))\"\n    FC.Range(\"Z6:Z\" &amp; totalrows).Formula = sformula\n    With FC.Range(\"Z5:Z\" &amp; totalrows)\n        .AutoFilter 26, True\n        .Value=.Value2\n    End With\nEnd Sub\n</code></pre>\n\n<p>I assume you have a header in line 5.<br>\nYou had to swap lines because before inputing formula cells have no value at all, after <code>.AutoFilter</code> they were, well, filtered (vbNullString, \"\", 0 etc. &lt;> True).<br>\nYou could see the correct result on second iteration because cells asquired value (became True) and since <code>.AutoFilter</code> simply changes filter criteria he RE-filtered the column and got the result you needed.</p>\n"}], "owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 45837912, "answer_count": 1, "score": 0, "last_activity_date": 1503486432, "creation_date": 1503483174, "question_id": 45836860, "link": "https://stackoverflow.com/questions/45836860/error-while-using-the-autofilter-condition", "title": "Error while using the autofilter condition", "body": "<p>I have an sheet FC. With this Sheet, I always check for the column S, T and U. </p>\n\n<p>The first case is. </p>\n\n<p>I column S has \"invalid\", then I want the whole row to be hidden. </p>\n\n<p>In addition if the column T and U both are filled, then also, I want the row to be hidden. </p>\n\n<p>I executed the below code. </p>\n\n<pre><code>Sub fc()\nDim totalrows As Long\ntotalrows = Range(\"A5\").End(xlDown).Row\n  With Sheets(\"FC\").Range(\"Z5:Z\" &amp; totalrows)\n    sformula = \"=AND(S5&lt;&gt;\"\"Invalid\"\",OR(ISBLANK(T5),ISBLANK(U5)))\"\n    .AutoFilter 26, True\n    .Formula = sformula\n    .Value = .Value\n  End With\nEnd Sub\n</code></pre>\n\n<p>with this code, I have an additional column Z used as an helper column. So if the column S is invalid, also if both the columns T and 5 are not blank, then I state them as \"True\" in column Z. </p>\n\n<p>The problem here is, in the first iteration, it shows the perfect result. (It filters true and just shows False). With second iteration, the whole data is hidden. </p>\n\n<p>I have this function calling with a button. inorder to unfilter, I am using the below code.</p>\n\n<pre><code>Sub UnfilterColumn()\n\n    With Worksheets(\"FC\")\n        If Not Worksheets(\"FC\").AutoFilter Is Nothing Then\n                ThisWorkbook.Sheets(\"FC\").Range(\"A4\").AutoFilter Field:=26\n        End If\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>The issue again is even after unsing the unfilter code, with the first press, I get the result and with second step, all my data are hidden and in the third press, I could see the result. </p>\n\n<p>Could some one help me to solve this issue. I believe the problem is in my FC code. </p>\n\n<p>Is there anyother way to execute my requirement  ? Any lead would be helpful</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1503483334, "post_id": 45836809, "comment_id": 78630792, "body": "maybe <code>Cancel = Response=vbYes</code> instead of <code>Cancel = True And Response</code> the AND with a true, means that cancel will be the same as the other side of the AND.  <code>TRUE and today=Wednesday</code>, only ever need to check the day for example.  Looking at your if, it doesn&#39;t seem logical, you set the Cancel, try to, then base it on the msgbox decision.  Before end sub, just put <code>cancel=response=vbYes</code> or which ever way you want the decision"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1503483420, "post_id": 45836809, "comment_id": 78630852, "body": "That&#39;s one weird piece of code. Of course it always shows the message box, the first thing you do in that sub is show the message box and assign it&#39;s result to <code>Response</code>. That&#39;s not nested in an <code>If</code> statement. What exactly is the line <code>Cancel = True And Response</code> supposed to do? Do you have <code>Option Explicit</code> on?"}, {"owner": {"reputation": 19, "user_id": 7967862, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a008858618a85a9926dc1f83d9a0bdc?s=128&d=identicon&r=PG&f=1", "display_name": "aran0ia", "link": "https://stackoverflow.com/users/7967862/aran0ia"}, "edited": false, "score": 0, "creation_date": 1503483780, "post_id": 45836809, "comment_id": 78631117, "body": "Hi again Erik..I&#39;ve just started learning VBA on my own so pls be patient. The line you&#39;re referring to is supposed to cancel the unload and pop up the msgbox if the conditions are met. Worked fine until I defined the response. I don&#39;t know what &quot;Option Explicit&quot; is. What is the proper way to check the response of the msgbox?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1503486372, "post_id": 45836809, "comment_id": 78632962, "body": "The answer Sergey provided is correct. If you want to continue VBA development, you can read into <code>Option Explicit</code> <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement\" rel=\"nofollow noreferrer\">here</a>, <a href=\"http://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">this page</a> gives a quick explanation why you would want to use it. If you&#39;re having troubles with something, turning <code>Option Explicit</code> on often helps."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7967862, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a008858618a85a9926dc1f83d9a0bdc?s=128&d=identicon&r=PG&f=1", "display_name": "aran0ia", "link": "https://stackoverflow.com/users/7967862/aran0ia"}, "edited": false, "score": 0, "creation_date": 1503483966, "post_id": 45837043, "comment_id": 78631253, "body": "Thank you very much for your response. The message box now appears correctly but again the form closes anyway. Still, progress :)"}, {"owner": {"reputation": 19, "user_id": 7967862, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a008858618a85a9926dc1f83d9a0bdc?s=128&d=identicon&r=PG&f=1", "display_name": "aran0ia", "link": "https://stackoverflow.com/users/7967862/aran0ia"}, "edited": false, "score": 0, "creation_date": 1503484985, "post_id": 45837043, "comment_id": 78631939, "body": "Edit: Problem solved. Your code worked perfectly when I closed the form normally but closed no matter the response when I used the command button(with a &quot;close window&quot; macro&quot;). I put your code on the OnClick event of the button and replaced  Cancel=true with DoCmd.Close. Again, thank you for your time."}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1503483655, "creation_date": 1503483655, "answer_id": 45837043, "question_id": 45836809, "link": "https://stackoverflow.com/questions/45836809/msgbox-to-confirm-exit-from-form-in-access/45837043#45837043", "title": "MsgBox to confirm exit from form in Access", "body": "<p>I believe it should be something like this:</p>\n\n<pre><code>Private Sub Form_Unload(Cancel As Integer)\nIf Me![fixed price] = 0 And Me![Fixation Orders Subform1].Form!Text38 = \"Final Fixed Price\" Then\n    If MsgBox(\"It looks like this contract is fixed. Would you like to edit the final price?\", vbYesNo, \"Database Information\") = vbYes Then\n        Cancel = True\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7967862, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a008858618a85a9926dc1f83d9a0bdc?s=128&d=identicon&r=PG&f=1", "display_name": "aran0ia", "link": "https://stackoverflow.com/users/7967862/aran0ia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1384, "favorite_count": 0, "accepted_answer_id": 45837043, "answer_count": 1, "score": 0, "last_activity_date": 1503483655, "creation_date": 1503483045, "question_id": 45836809, "link": "https://stackoverflow.com/questions/45836809/msgbox-to-confirm-exit-from-form-in-access", "title": "MsgBox to confirm exit from form in Access", "body": "<p>I have a single record form with contract details and a subform where I enter some additional information. The main form has a command button to close it.</p>\n\n<p>I need to check 2 controls on closing(one in main form and one in subform) and if some conditions are met a Yes/No MsgBox should appear. If the user presses \"Yes\", the form closes, if he presses \"No\" the form remains open.</p>\n\n<p>So far I have this:</p>\n\n<pre><code>Private Sub Form_Unload(Cancel As Integer)\nDim Response As Integer\n\nResponse = MsgBox(\"It looks like this contract is fixed. Would you like to edit the final price?\", vbYesNo, \"Database Information\")\n\nIf Me![fixed price] = 0 And Me![Fixation Orders Subform1].Form!Text38 = \"Final Fixed Price\" Then\n    Cancel = True And Response\n        If Response = vbYes Then\n            Cancel = True\n         Else\n            Cancel = False\n         End If\n\nElse\n    Cancel = False\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Problems: Before I defined \"response\" the MsgBox appeared correctly but the form closed anyway. After I defined it to use it in the second \"If\":</p>\n\n<ol>\n<li>The message box appears no matter what </li>\n<li>The form closes either I press \"Yes\" or \"No\"</li>\n</ol>\n\n<p>Additionally, after I solve this, on which event should I put this code to chack the conditions also when I go to next record? Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 3, "last_activity_date": 1503498607, "last_edit_date": 1503498607, "creation_date": 1503482956, "answer_id": 45836772, "question_id": 45836745, "link": "https://stackoverflow.com/questions/45836745/excel-vba-object-variable-or-with-block-variable-not-set-error-when-returning-o/45836772#45836772", "title": "Excel vba: object variable or with block variable not set error when returning Object from function", "body": "<p><code>Set</code> for objects, so <code>set getExcelApp = ExcelApp</code></p>\n\n<p>Also, If you are calling this from Excel, then you'll already have the correct class library available, so I'd use </p>\n\n<pre><code>Function Get_Excel() As Excel.Application\n\nSet Get_Excel = New Excel.Application\nGet_Excel.Visible = True\n'     etc, etc\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1503482980, "creation_date": 1503482980, "answer_id": 45836783, "question_id": 45836745, "link": "https://stackoverflow.com/questions/45836745/excel-vba-object-variable-or-with-block-variable-not-set-error-when-returning-o/45836783#45836783", "title": "Excel vba: object variable or with block variable not set error when returning Object from function", "body": "<p>Try like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim ExcelApp As Object\n    Set ExcelApp = getExcelApp()\n    Debug.Print ExcelApp.Name\n\nEnd Sub\n\nFunction getExcelApp() As Object\n\n    Dim ExcelApp As Object\n    Set ExcelApp = CreateObject(\"Excel.Application\")\n    ExcelApp.Visible = True\n    ExcelApp.ScreenUpdating = False\n    ExcelApp.DisplayAlerts = False\n    ExcelApp.EnableEvents = False\n\n    Set getExcelApp = ExcelApp\n\nEnd Function\n</code></pre>\n\n<p>It would print the name of the new ExcelApp. In this case <code>Microsoft Excel</code>. I have also changed <code>ExcelApp.Visible</code> to <code>True</code> and the function, returning an object should be with a <code>Set</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 3, "last_activity_date": 1503483243, "creation_date": 1503483243, "answer_id": 45836892, "question_id": 45836745, "link": "https://stackoverflow.com/questions/45836745/excel-vba-object-variable-or-with-block-variable-not-set-error-when-returning-o/45836892#45836892", "title": "Excel vba: object variable or with block variable not set error when returning Object from function", "body": "<p>The error is because you're missing the <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/set-statement\" rel=\"nofollow noreferrer\"><code>Set</code> command</a> (which is needed because you're assigning an <em>object</em>).</p>\n\n<p>But you're creating one object, setting it up, then assigning it to a different object for returning. You could instead assign everything directly to the return variable. <br>\n<strong>A more concise function would be:</strong></p>\n\n<pre><code>Function getExcelApp() As Object\n    Set getExcelApp = CreateObject(\"Excel.Application\")\n    With getExcelApp\n        .Visible = False\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n        .EnableEvents = False\n   End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 45836892, "answer_count": 3, "score": 1, "last_activity_date": 1503498607, "creation_date": 1503482876, "question_id": 45836745, "link": "https://stackoverflow.com/questions/45836745/excel-vba-object-variable-or-with-block-variable-not-set-error-when-returning-o", "title": "Excel vba: object variable or with block variable not set error when returning Object from function", "body": "<p>I want to use a function that should return an <code>Excel.Application</code> Object:</p>\n\n<pre><code> Dim ExcelApp As Object\n Set ExcelApp = getExcelApp()\n\n\n\nFunction getExcelApp() As Object\n        Dim ExcelApp As Object\n        Set ExcelApp = CreateObject(\"Excel.Application\")\n        ExcelApp.Visible = False\n        ExcelApp.ScreenUpdating = False\n        ExcelApp.DisplayAlerts = False\n        ExcelApp.EnableEvents = False\n\n        getExcelApp = ExcelApp\nEnd Function\n</code></pre>\n\n<p>But I get a <code>object variable or with block variable not set</code> error. What is wrong and how to accomplish what I want?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 3, "creation_date": 1503482737, "post_id": 45836223, "comment_id": 78630351, "body": "They really <a href=\"https://stackoverflow.com/questions/45803485/ms-access-2016-treeview-error-no-object-in-this-control-element-runtime-error\">botched</a> this update, didn&#39;t they? See <a href=\"https://social.msdn.microsoft.com/Forums/en-US/bd27a445-7335-45ab-99e8-46fa04cff960/mouse-scroll-not-working-in-access-2016-form-view?forum=accessdev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a>"}], "owner": {"reputation": 145, "user_id": 5974075, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a602a3792da84eb828ff22a4450ee180?s=128&d=identicon&r=PG&f=1", "display_name": "TCassa", "link": "https://stackoverflow.com/users/5974075/tcassa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1503481493, "creation_date": 1503481493, "question_id": 45836223, "link": "https://stackoverflow.com/questions/45836223/mouse-scrolling-disabled-in-latest-office-2016-update", "title": "Mouse scrolling disabled in latest Office 2016 update", "body": "<p>I maintain a campaign scheduling database in MS Access, built from scratch. It's been running for two years with few problems. It has a userbase of around 50 account managers.</p>\n\n<p>This week, there was a Microsoft Office update which has disabled mouse scrolling on ALL forms within the database. As the forms are almost all continuous forms containing campaign scheduling details split into days, weeks and months, being able to scroll through is important. Mouse scrolling has always worked before.</p>\n\n<p>Does anyone have a fix for this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "edited": false, "score": 0, "creation_date": 1503489021, "post_id": 45836307, "comment_id": 78634914, "body": "That was it. Thanks. Is there a way to prevent data duplication? I.e. not record more than one data for a single day?"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "edited": false, "score": 0, "creation_date": 1503489855, "post_id": 45836307, "comment_id": 78635541, "body": "@aab - That&#39;s completely different question all together. I suggest you to kindly close the question by accepting answer that helped you and then ask a new question. New question will also attract more people rather than just two of us here."}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "edited": false, "score": 0, "creation_date": 1503490136, "post_id": 45836307, "comment_id": 78635777, "body": "Okay. Thank you."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "edited": false, "score": 0, "creation_date": 1503490193, "post_id": 45836307, "comment_id": 78635824, "body": "@aab - Kindly mention the link of your new question here so that I can have a look too."}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "edited": false, "score": 0, "creation_date": 1503494329, "post_id": 45836307, "comment_id": 78639141, "body": "here&#39;s a link to my new question <a href=\"https://stackoverflow.com/questions/45840040/prevent-data-duplication-in-excel-vba-code-that-copies-data-from-one-sheet-into?noredirect=1#comment78637880_45840040\" title=\"prevent data duplication in excel vba code that copies data from one sheet into\">stackoverflow.com/questions/45840040/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 4, "last_activity_date": 1503481713, "creation_date": 1503481713, "answer_id": 45836307, "question_id": 45836038, "link": "https://stackoverflow.com/questions/45836038/excel-vba-code-that-copies-data-from-one-sheet-into-another/45836307#45836307", "title": "Excel VBA code that copies data from one sheet into another", "body": "<p>Instead of </p>\n\n<pre><code>.Range(Cells(2, 1), Cells(2, lColDaily)) \n</code></pre>\n\n<p>try </p>\n\n<pre><code>.Range(.Cells(2, 1), .Cells(2, lColDaily))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "edited": false, "score": 0, "creation_date": 1503490011, "post_id": 45836532, "comment_id": 78635665, "body": "I didn&#39;t know that. Thanks for the explanation."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1503482305, "creation_date": 1503482305, "answer_id": 45836532, "question_id": 45836038, "link": "https://stackoverflow.com/questions/45836038/excel-vba-code-that-copies-data-from-one-sheet-into-another/45836532#45836532", "title": "Excel VBA code that copies data from one sheet into another", "body": "<p>Mrigs comment is right, use <code>.Range(.Cells(2, 1), .Cells(2, lColDaily))</code> </p>\n\n<p>Just as explanation (as the error is so common): <code>cells</code> (without leading dot) refers to the active sheet. <code>.cells</code> (with dot) in your case refers to the sheet of the <code>with</code>-statement, you could write <code>dailySht.cells</code> instead.</p>\n\n<p>So in your statement, you ask for a Range of the worksheet <code>dailySht</code> that is defined by cells from the active sheet (which is very likely a different sheet), which is not possible and raises the error you see.</p>\n"}], "owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 45836307, "answer_count": 2, "score": 0, "last_activity_date": 1503482305, "creation_date": 1503481042, "last_edit_date": 1503481209, "question_id": 45836038, "link": "https://stackoverflow.com/questions/45836038/excel-vba-code-that-copies-data-from-one-sheet-into-another", "title": "Excel VBA code that copies data from one sheet into another", "body": "<p>I'm trying to achieve the following: </p>\n\n<ul>\n<li>Take a record of the busiest hour of each day, (i.e highest number of customers) and record its details (number of customers, amount spent, average time spent) into the second spreadsheet. </li>\n<li><p>On the second spreadsheet, a new column will be added everytime. It will have records of only the busiest hour of each day.</p>\n\n<pre><code>Sub DailySales()\n    Dim dailySht As Worksheet 'worksheet storing latest store activity\n    Dim recordSht As Worksheet 'worksheet to store the highest period of each Day\n    Dim lColDaily As Integer ' Last column of data in the store activity sheet\n    Dim lCol As Integer ' Last column of data in the record sheet\n    Dim maxCustomerRng As Range ' Cell containing the highest number of customers\n    Dim maxCustomerCnt As Long ' value of highest customer count\n\n    Set dailySht = ThisWorkbook.Sheets(\"Supermarket Data\")\n\n    Set recordSht = ThisWorkbook.Sheets(\"Record Data\")\n    With recordSht\n        lCol = .Cells(1, .Columns.Count).End(xlToLeft).column\n    End With\n    With dailySht\n        lColDaily = .Cells(1, .Columns.Count).End(xlToLeft).column\n        maxCustomerCnt = Application.Max(.Range(Cells(2, 1), Cells(2, lColDaily)))\n        Set maxCustomerRng = .Range(.Cells(2, 1), .Cells(2, lColDaily)).Find(What:=maxCustomerCnt, LookIn:=xlValues)\n        If Not maxCustomerRng Is Nothing Then\n            maxCustomerRng.EntireColumn.Copy recordSht.Cells(1, lCol + 1)\n        End If\n    End With\n\n    Set maxCustomerRng = Nothing\n    Set dailySht = Nothing\n    Set recordSht = Nothing\nEnd Sub\n</code></pre></li>\n</ul>\n\n<p>I get a \"run-time error '1004': Method 'Range' of object'_Worksheet failed\" on the following line everytime I run the code (it is attached to a button on the second worksheet).</p>\n\n<pre><code>maxCustomerCnt = Application.Max(.Range(Cells(2, 1), Cells(2, lColDaily)))\n</code></pre>\n\n<p>This is the table:</p>\n\n<pre><code>Customer data   7:00:00 AM  7:30:00 AM  8:00:00 AM  8:30:00 AM  9:00:00 AM  \nNumber of customers 33         37         110          250        84\nAmount spent        65         50          70           85        60\nAverage time spent  12         10           8           17        10\n</code></pre>\n\n<p>Can someone please help me figure out whats wrong with the code?</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1503479493, "post_id": 45835105, "comment_id": 78627851, "body": "Remove the <code>Len(c)</code>"}, {"owner": {"reputation": 105, "user_id": 8462092, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d93071bb706e1aa4ba4465597de5a8d?s=128&d=identicon&r=PG&f=1", "display_name": "ShieldData", "link": "https://stackoverflow.com/users/8462092/shielddata"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1503479829, "post_id": 45835105, "comment_id": 78628128, "body": "@nishitdey I will. I see that it is also superfluous."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1503482870, "post_id": 45835105, "comment_id": 78630454, "body": "I was running through your code it was getting in Loop. Also help me understand your code please what is the objective. Thanks"}, {"owner": {"reputation": 105, "user_id": 8462092, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d93071bb706e1aa4ba4465597de5a8d?s=128&d=identicon&r=PG&f=1", "display_name": "ShieldData", "link": "https://stackoverflow.com/users/8462092/shielddata"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1503483288, "post_id": 45835105, "comment_id": 78630757, "body": "@nishitdey I think I figured out why my code has been so mind numbingly slow. The &quot;Set copyRng = xSheet.Cells&quot; seems to make it very difficult for the For Loop to ever get anywhere. I am currently working on creating better range parameters which will speed up the code dramatically. As for the objective: The code should eventually summarize data from different worksheets. Since the data in these worksheets is very badly organized and contains lots of duplicates I need to try to get the data through a serious of different targeted for loops."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1503483666, "post_id": 45835105, "comment_id": 78631026, "body": "Cool, you need to <code>SET</code> each and every sheet and loop them instead. Thanks"}], "owner": {"reputation": 105, "user_id": 8462092, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d93071bb706e1aa4ba4465597de5a8d?s=128&d=identicon&r=PG&f=1", "display_name": "ShieldData", "link": "https://stackoverflow.com/users/8462092/shielddata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503478723, "creation_date": 1503478723, "question_id": 45835105, "link": "https://stackoverflow.com/questions/45835105/default-range-not-applicable-error-at-second-sheet-vba", "title": "&quot;Default range not applicable&quot; error at second sheet / VBA", "body": "<p>The concept is pretty basic, go create a summary sheet and start filling in data, and it does work on the first sheet (even though it takes an unreasonable amount of time), but then it then it throws the error \"default range not applicable\" at this line: </p>\n\n<pre><code>  If Len(c) &lt;&gt; 0 And InStr(1, c.Value, \"C-\") Then _\n</code></pre>\n\n<p>I am not sure what could change from one sheet to the next since they have the exact same structure.</p>\n\n<pre><code>'Add a worksheet with the name \"Summary\"\nSet DestSh = ActiveWorkbook.Worksheets.Add\nDestSh.Name = \"Summary\"\nDestSh.Range(\"A1\").Value = \"Account\"\nDestSh.Range(\"B1\").Value = \"Exchange\"\nDestSh.Range(\"C1\").Value = \"Quarter\"\nDestSh.Range(\"D1\").Value = \"Year\"\nSet destRng = DestSh.Range(\"A2\")\n\n\n'Loop through all worksheets and copy the data to the\n'summary worksheet.\nFor Each xSheet In ActiveWorkbook.Worksheets\n\n    If InStr(1, xSheet.Name, \"ACCOUNT\") And xSheet.Range(\"B1\") &lt;&gt; \"No Summary Available\" Then _\n\n        Set copyRng = xSheet.Cells\n\n        For Each c In copyRng.SpecialCells(xlCellTypeVisible)\n\n            If Len(c) &lt;&gt; 0 And InStr(1, c.Value, \"C-\") Then _\n\n\n                'Copy to destination Range\n                c.Copy destRng\n\n                'Set destination\n                Set destRng = destRng.Offset(1, 0)\n\n\n            End If\n\n        Next c\n\n    End If\n\nNext xSheet\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1503478920, "post_id": 45835064, "comment_id": 78627407, "body": "It&#39;s possible but it doesn&#39;t make sense. The way to go is to have one sheet which has all the data and all the updates, and create different views of that same sheet showing only some data, for example the orders of one particular client. The normal way of creating the sub-views would be to use a filter. You might use VBA to apply the filter. If you must, you can save the filtered result to a separate worksheet but you shouldn&#39;t think of updating that sheet. Instead, create a new one whenever you need an update."}], "owner": {"reputation": 11, "user_id": 8504913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e07451503baaf14c785ac0c020e832c?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter Vink", "link": "https://stackoverflow.com/users/8504913/wouter-vink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1503482851, "creation_date": 1503478597, "last_edit_date": 1531161705, "question_id": 45835064, "link": "https://stackoverflow.com/questions/45835064/vba-excel-copy-certain-values-to-designated-tabs-when-changes-in-document-occu", "title": "VBA Excel - copy certain values to designated tabs when changes in document occur", "body": "<p>Good day,</p>\n\n<p>After much trial and error I hope that someone can maybe help me with the following.</p>\n\n<p>I have a document with a number of sheets. 'Sheet1' is an overview of all sales orders (displaying both open and closed ones) that are entered through a userform. \nThe other sheets are customer specific sheets that only list the sales order for that specific client (also displaying both open and closed orders).</p>\n\n<p>Now I would like to have a 'Worksheet Change Event' that automatically updates the client specific sheet when data is entered in \"Sheet1\". And when you change data in 'Sheet 1' at a later stage again (for example you set the customer order from \"open\" to \"closed\" then it should update the matching cell or row for that customer in their respective sheet.</p>\n\n<p>I am not sure if this is possible or if it should be a 'Button_Click' macro?</p>\n\n<p>Here are some pictures of what it should look like:<br/>\nSheet1<br/>\n<a href=\"https://i.stack.imgur.com/AEFSo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AEFSo.jpg\" alt=\"Sheet1\"></a><br/><br/>\nCustomer ABC<br/>\n<a href=\"https://i.stack.imgur.com/78nbN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/78nbN.jpg\" alt=\"Customer ABC\"></a></p>\n"}, {"tags": ["vba", "dll", "com", "activex", "32bit-64bit"], "comments": [{"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1503477362, "post_id": 45834233, "comment_id": 78626386, "body": "Chances are actxserver is doing exactly the same thing but the context is different. If your app was written using VB6, then you must have MSVBVM60.dll somewhere. Run this: <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=24417\" rel=\"nofollow noreferrer\">microsoft.com/en-us/download/details.aspx?id=24417</a> also check this <a href=\"https://blogs.msdn.microsoft.com/deva/2009/12/30/development-is-visual-basic-6-0-runtime-still-supported/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/deva/2009/12/30/&hellip;</a> and if your app was built using a localized version of VB6, make sure you install localized VB6 support binaries"}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "reply_to_user": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1503479819, "post_id": 45834233, "comment_id": 78628114, "body": "<i>I installed the service pack from Microsoft, where this file was contained</i> &lt;- I already ran the file you linked me to. I cannot be sure that <code>X2000</code> was made with localized VB6, but it it were, I&#39;d guess that&#39;d be the standard version, that comes with every VB6, since the company providing <code>X2000</code> is from U.S.A."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1503482809, "post_id": 45834233, "comment_id": 78630409, "body": "if it&#39;s from USA, I don&#39;t think you&#39;d need anything localized indeed. What I would do is use sysinternal&#39;s procmon tool and monitor files (filter by your program&#39;s exe name). This could help you determine the missing ones. It may be a satellite file, or one you didn&#39;t think of."}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "reply_to_user": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1503485601, "post_id": 45834233, "comment_id": 78632389, "body": "I&#39;m not familiar with it, but I guess I could try... if I only were an admin -_-"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1503497868, "post_id": 45834233, "comment_id": 78642145, "body": "@Noldor130884 I guess you are testing with 64-bit Office version, while MATLAB is 32-bit version, and ActiveX is written for 32-bit applications only, so it&#39;s working in MATLAB on x64 OS via WoW64. You may try late binding using <a href=\"https://stackoverflow.com/a/38134477/2165759\">this method</a>."}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1503555274, "post_id": 45834233, "comment_id": 78666155, "body": "@omegastripes I am not really sure (right now I cannot check), but I think MATLAB too should be 64bit. Anyway, could you elaborate on that solution? I don&#39;t think I understood how to create a <code>X2000.Server</code> with that late binding..."}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1503917189, "post_id": 45834233, "comment_id": 78792706, "body": "Checked: MATLAB too is 64bit"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "edited": false, "score": 0, "creation_date": 1504065086, "post_id": 45834233, "comment_id": 78861514, "body": "I&#39;m aware you&#39;ve found a workaround. I <i>think</i> I know what the issue is. But first, three questions in order to check. 1) Is a UAC prompt displayed when you run the first version of your code? 2) Does copying <code>MSVBVM60.DLL</code> from <code>sysWoW64</code> to <code>system32</code> enable the code to run correctly? 3)  Does your workaround still work using <code>Dim XApp As X2000.Application</code>?"}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1504070800, "post_id": 45834233, "comment_id": 78863049, "body": "Well, I&#39;m all ears :) I always appreciate someone who can teach me something. About your questions: 1) No UAC prompt is displayed. 2) No. I tried that before already. Dependancy Walker highlighted several DLL not found at that point. 3) No it doesn&#39;t"}], "answers": [{"tags": [], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "is_accepted": true, "score": 1, "last_activity_date": 1504007403, "creation_date": 1504007403, "answer_id": 45938384, "question_id": 45834233, "link": "https://stackoverflow.com/questions/45834233/vba-createobject-can-t-create-activex-component-on-64bit-windows/45938384#45938384", "title": "VBA CreateObject can\u2019t create ActiveX component on 64Bit Windows", "body": "<p>I apparently solved the issue. Inspired by Hans Passant, I <code>Dim</code>ed the <code>XServer</code> as the only object depending on the reference to X2000.exe:</p>\n\n<pre><code>Dim XServer As X2000.Server\nDim XApp As Object\nDim XSR As Object\n\nSet XServer = New X2000.Server\nSet XApp = XServer.AppConnection\nXApp.Visible = True\nSet XSR = XApp.ScriptCommands\n\nXSR.DATA_FILENAME = \"C:\\foo.x\" \n</code></pre>\n\n<p><code>DATA_FILENAME</code> is actually a \"ScriptCommand\" that gets executed.</p>\n\n<p>Simple as that. Yet I have no idea why this works.</p>\n"}], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2374, "favorite_count": 1, "accepted_answer_id": 45938384, "answer_count": 1, "score": 3, "last_activity_date": 1504518521, "creation_date": 1503476048, "last_edit_date": 1504518521, "question_id": 45834233, "link": "https://stackoverflow.com/questions/45834233/vba-createobject-can-t-create-activex-component-on-64bit-windows", "title": "VBA CreateObject can\u2019t create ActiveX component on 64Bit Windows", "body": "<p>I have to write a program in Visual Studio 2013, but it doesn't work, so I started testing all the possibilities with Microsoft Excel and its developement playground. I started with the following version (provided by the company supplying the program I need to use):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Main()\n\n    Dim XServer As X2000.Server\n    Dim XApp As X2000.Application\n    Dim XSR As X2000.ScriptRoutines\n\n    Set XServer = New X2000.Server\n    Set XApp = XServer.AppConnection()    '&lt;- This actually fires the application\n    XApp.Visible = True\n\n    Set XSR = XApp.ScriptCommands\n    XSR.DATA_FILENAME = \"C:\\X2000\\myFile.x\"    ' &lt;- Code blocks here\n\nEnd Sub\n</code></pre>\n\n<p>This basically starts the application X2000.exe, connects my code to it, and then executes the <code>DATA_FILENAME</code> assignation routine, by loading  <code>myFile.x</code> in the program. I need to start the application, because at that point its license is checked, and I don't have any other option to work with.</p>\n\n<p>Now, in this version, the code was blocking at the last line by saying \"A dll is missing\" without any other information. I tried late-binding the <code>ScriptRoutines</code> object by doing the following:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim XServer As X2000.Server\nDim XApp As X2000.Application\nDim XSR As Object\n\nSet XServer = New X2000.Server\nSet XApp = XServer.AppConnection()\nXApp.Visible = True\n\nXSR = CreateObject(\"XApp.ScriptCommands\")\n</code></pre>\n\n<p>This doesn't work as well, but did give me a piece of information more: \"ActiveX control couldn\u2019t load the object\". I did a little research, and found out, through \"Dependancy Walker\", that <code>X2000.exe</code> was depending on <code>MSVBVM60.DLL</code>, which was missing in the <code>system32</code> folder. Curious though, because my system is 64bit, Excel is too, and I tried the code on VS2013 by using a 32bit compatibility and still the code didn't work.<br>\nI installed <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=24417\" rel=\"nofollow noreferrer\">the service pack from Microsoft</a>, where this file was contained, only to find out, that <code>system32</code> was left untouched... \n<code>sysWoW64</code> instead had already a <code>MSVBVM60.DLL</code>, therefore I suspected that <code>X2000.exe</code> was written only to work with 32bit systems: I was wrong.</p>\n\n<p>A colleague of mine could execute the same program written in MATLAB code:</p>\n\n<pre class=\"lang-matlab prettyprint-override\"><code>function [Data,eng_or_met] = Read_X2000_File_BB_2(sFileName)\n\nXServer = actxserver('X2000.server');\nXApp = XServer.AppConnection;\nXApp.Visible = 1;\nobjX2000 = XApp.ScriptCommands;\nobjX2000.data_filename = \"C:\\X2000\\myFile.x\";\n\ndelete(XServer);\n</code></pre>\n\n<p>This code works thanks to the <a href=\"https://de.mathworks.com/help/matlab/ref/actxserver.html?requestedDomain=www.mathworks.com\" rel=\"nofollow noreferrer\"><code>actxserver</code> function</a>, which I believe to handle this compatibility problem.</p>\n\n<p>How can I do the same with Excel/VS2013?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I tried with the code suggested by omegastripes:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim XSR As Object\nSet XSR = CreateObjectx86(\"XApp.ScriptCommands\") ' create ActiveX via x86 mshta host\n</code></pre>\n\n<p>being <code>CreateObjectx86</code> the function <a href=\"https://stackoverflow.com/questions/9725882/getting-scriptcontrol-to-work-with-excel-2010-x64/38134477#38134477\">linked here</a>. I tried both the <code>If / Else</code> conditions and at the end the object is not created anyway, both with:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set CreateObjectx86 = oWnd.CreateObjectx86(sProgID)\n</code></pre>\n\n<p>and</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set CreateObjectx86 = CreateObject(sProgID)\n</code></pre>\n\n<p>The last line is what gets executed if I don't change the code (therefore not <code>#If Win64</code>).</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>As per the first answer to this question, I also tried:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim XServer As Object\nDim XApp As X2000.Application\nDim XSR As X2000.Script\n\nSet XServer = CreateObject(\"X2000.Server\")\nSet XApp = XServer.AppConnection()\nXApp.Visible = True\nSet XSR = X2000.ScriptCommands\n</code></pre>\n\n<p>Only to find out I get the same error.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1503475846, "post_id": 45834071, "comment_id": 78625359, "body": "The first <code>Characters</code> you are changing is character 5, but the text only has 4 characters.  Something makes me think your use of specific characters is not what you intended and you wanted to change the font of the whole cell.  If so, get rid of <code>.Characters(....)</code> and see if that does what you want."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503509810, "post_id": 45834071, "comment_id": 78650218, "body": "you can use this form:  <code>Cells(x, &quot;J&quot;)</code>  ... makes it easier to keep track of columns"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1503476643, "post_id": 45834336, "comment_id": 78625909, "body": "@YowE3K - :). Btw, what is <code>Active.Sheet11</code>?"}, {"owner": {"reputation": 23, "user_id": 8457178, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EXFSOgX2DoY/AAAAAAAAAAI/AAAAAAAAKfw/8I5SbWIo9Q0/photo.jpg?sz=128", "display_name": "khalid al-ghamdi", "link": "https://stackoverflow.com/users/8457178/khalid-al-ghamdi"}, "edited": false, "score": 0, "creation_date": 1503480277, "post_id": 45834336, "comment_id": 78628507, "body": "thx vityata try one: I change the finalrow location (out of the loop) and remove Characters but it colors every thing. (you are right about the finalrow place)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1503476497, "last_edit_date": 1503476497, "creation_date": 1503476390, "answer_id": 45834336, "question_id": 45834071, "link": "https://stackoverflow.com/questions/45834071/mark-number-by-changing-the-number-color-if-found/45834336#45834336", "title": "mark number by changing the number color if found", "body": "<p>You are not setting finalrow, thus you do not enter in the loop <code>For x = 2 to finalrow</code>. Thus nothing happens. Put <code>finalrow = Range(\"A1000000\").End(xlUp).Row</code> outside the loop, thus it enters it.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 8457178, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EXFSOgX2DoY/AAAAAAAAAAI/AAAAAAAAKfw/8I5SbWIo9Q0/photo.jpg?sz=128", "display_name": "khalid al-ghamdi", "link": "https://stackoverflow.com/users/8457178/khalid-al-ghamdi"}, "edited": false, "score": 0, "creation_date": 1503574998, "post_id": 45846350, "comment_id": 78679271, "body": "THANK YOU jsotola , I fixed the code and it is working .. I  used your code as well and it worked also"}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1503510592, "creation_date": 1503510592, "answer_id": 45846350, "question_id": 45834071, "link": "https://stackoverflow.com/questions/45834071/mark-number-by-changing-the-number-color-if-found/45846350#45846350", "title": "mark number by changing the number color if found", "body": "<p>you can use this instead of the four <code>If ...</code> statements</p>\n\n<p>makes it easier to add/change columns and change starting row</p>\n\n<pre><code>Dim cel As Range\nFor Each cel In Sheet11.Range(\"h3,j3,l3,n3\").Offset(x)\n    If cel.Value = ContainWord1 Then cel.Font.Color = vbRed\nNext cel\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8457178, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EXFSOgX2DoY/AAAAAAAAAAI/AAAAAAAAKfw/8I5SbWIo9Q0/photo.jpg?sz=128", "display_name": "khalid al-ghamdi", "link": "https://stackoverflow.com/users/8457178/khalid-al-ghamdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 45834336, "answer_count": 2, "score": 0, "last_activity_date": 1503575234, "creation_date": 1503475595, "last_edit_date": 1503575234, "question_id": 45834071, "link": "https://stackoverflow.com/questions/45834071/mark-number-by-changing-the-number-color-if-found", "title": "mark number by changing the number color if found", "body": "<p>I have a problem in making my code work I will start to explain:</p>\n\n<p>1- the code will look to this sheet and take the loco number <a href=\"https://i.stack.imgur.com/1IaQQ.png\" rel=\"nofollow noreferrer\">sheet1</a></p>\n\n<p>2- It will change the color if the number matches the one in the other sheet the color for that value will change to red <a href=\"https://i.stack.imgur.com/CdQBx.png\" rel=\"nofollow noreferrer\">sheet 2</a></p>\n\n<p>3-the code should do it by row so if the number exists in other rows it will not change their colors (only the row it self will change).</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim ContainWord1 As String\nDim finalrow As Integer\nDim x As Integer\n\n   Active.Sheet11\nActive.Sheet14\n\nfinalrow = Range(\"A1000000\").End(xlUp).Row\n\nFor x = 2 To finalrow\n\n\n\nContainWord1 = Sheet15.Cells(x, 10).Value\n\n  If Sheet11.Cells(x + 3, 8).Value = ContainWord1 Then Sheet11.Cells(x + 3, 8).Font.Color = vbRed\n   If Sheet11.Cells(x + 3, 10).Value = ContainWord1 Then Sheet11.Cells(x + 3, 10).Font.Color = vbRed\n    If Sheet11.Cells(x + 3, 12).Value = ContainWord1 Then Sheet11.Cells(x + 3, 12).Font.Color = vbRed\n     If Sheet11.Cells(x + 3, 14).Value = ContainWord1 Then Sheet11.Cells(x + 3, 14).Font.Color = vbRed\n\n\n\n  Next x\n\n\nEnd Sub\n</code></pre>\n\n<p>When I use the code nothing happened</p>\n\n<p>thank you :)</p>\n\n<p>try one: I change the finalrow out of the loop and remove Characters</p>\n\n<p><strong>the code after it works now:</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim ContainWord1 As String\nDim finalrow As Integer\nDim x As Integer\n\nRange(\"H5:M100\").Font.Color = vbBlack\n\nfinalrow = Range(\"A1000000\").End(xlUp).Row\n\nFor x = 2 To finalrow\n\nContainWord1 = Cells(x + 3, 25).Value\n\n  If Sheet11.Cells(x + 3, 8).Value2 = ContainWord1 Then Sheet11.Cells(x + 3, 8).Font.Color = vbRed\n   If Sheet11.Cells(x + 3, 10).Value2 = ContainWord1 Then Sheet11.Cells(x + 3, 10).Font.Color = vbRed\n    If Sheet11.Cells(x + 3, 12).Value2 = ContainWord1 Then Sheet11.Cells(x + 3, 12).Font.Color = vbRed\n     If Sheet11.Cells(x + 3, 14).Value2 = ContainWord1 Then Sheet11.Cells(x + 3, 14).Font.Color = vbRed\n\n\n\n  Next x\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 178, "user_id": 8013180, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee29fffd3a2bfac21056f92777cd5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Clement B", "link": "https://stackoverflow.com/users/8013180/clement-b"}, "edited": false, "score": 0, "creation_date": 1503474149, "post_id": 45833491, "comment_id": 78624254, "body": "You can loop through your lines&amp;columns thanks to two for statements... Or you can also use one for to loop through the lines and use the method &quot;find&quot; to find the &quot;YES&quot; on each lines"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 4, "creation_date": 1503474266, "post_id": 45833491, "comment_id": 78624321, "body": "Because you only have about 2000 rows, you could just use the <code>MATCH</code> and <code>INDEX</code> Excel functions and thus avoid VBA."}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 3, "last_activity_date": 1503475455, "creation_date": 1503475455, "answer_id": 45834023, "question_id": 45833491, "link": "https://stackoverflow.com/questions/45833491/organize-a-excel-sheet-with-a-macro/45834023#45834023", "title": "Organize a excel sheet with a macro", "body": "<p>Try this:</p>\n\n<pre><code>Sub Demo()\n    Dim srcSht As Worksheet, destSht As Worksheet\n    Dim lastRow As Long, i As Long\n\n    Set srcSht = ThisWorkbook.Sheets(\"Sheet3\")  'change Sheet3 to your data sheet\n    Set destSht = ThisWorkbook.Sheets(\"Sheet4\") 'change Sheet4 to your output sheet\n\n    With srcSht\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).row    'last row in source sheet using column A\n        destSht.Cells(1, 1) = \"Name\"\n        destSht.Cells(1, 2) = \"Column\"\n        For i = 2 To lastRow\n            destSht.Cells(i, 1) = .Cells(i, 1)      'enter name in output sheet\n            destSht.Cells(i, 2) = .Evaluate(\"=INDEX($B$1:$E$1,1,MATCH(\"\"YES\"\",B\" &amp; i &amp; \":E\" &amp; i &amp; \",0))\")   'enter column name in output sheet\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>You can do this easily using formula as below.<br>\nEnter the following formula in <code>Cell G2</code></p>\n\n<pre><code>=INDEX($B$1:$E$1,1,MATCH(\"YES\",B2:E2,0))\n</code></pre>\n\n<p>Drag/Copy down as required. See image for reference.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SKi1I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SKi1I.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 8404333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c36fd140a46ff9922f3a395d80c1bd3?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Louis", "link": "https://stackoverflow.com/users/8404333/thomas-louis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503475455, "creation_date": 1503473909, "last_edit_date": 1503474993, "question_id": 45833491, "link": "https://stackoverflow.com/questions/45833491/organize-a-excel-sheet-with-a-macro", "title": "Organize a excel sheet with a macro", "body": "<p>I have a really big Excel sheet with 2000 rows.</p>\n\n<p>In the sheet I have names and next to the name a lot of \"NO\" and one \"YES\".</p>\n\n<p>Each column has a different name.</p>\n\n<p>I want to have a macro which automatically give me a sheet with the name and next to the name the name of the columns in which I have a \"YES\".</p>\n\n<p>For example:</p>\n\n<pre><code>Name     A    B    C    D\nGod      NO   NO   YES  NO\nGosch    YES  NO   NO   NO\nJosch    NO   YES  NO   NO\nME       NO   NO   YES  NO\n</code></pre>\n\n<p>Should look like:</p>\n\n<p>Name </p>\n\n<pre><code>God    C\nGosch  A\nJosch  B\nME     C\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1503474929, "post_id": 45833395, "comment_id": 78624741, "body": "Fields of a query object cannot be dynamic. What you describe seems to be you want to change the fields in a query. Doing that would require VBA code manipulating QueryDefs collection to modify a query object. If instead you want to apply filter criteria with the &#39;checked&#39; fields, that also will require VBA code. Are these fields yes/no type?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1503475362, "post_id": 45833395, "comment_id": 78625049, "body": "Review <a href=\"http://allenbrowne.com/ser-62.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-62.html</a> and <a href=\"http://allenbrowne.com/NoYesNo.html\" rel=\"nofollow noreferrer\">allenbrowne.com/NoYesNo.html</a>"}, {"owner": {"reputation": 11, "user_id": 8504657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc10fbfb823d13ac447582703fe283a9?s=128&d=identicon&r=PG&f=1", "display_name": "Marta Szmit", "link": "https://stackoverflow.com/users/8504657/marta-szmit"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1503476287, "post_id": 45833395, "comment_id": 78625669, "body": "I have this form: <a href=\"http://zapisz.net/images/706_untitled.jpg\" rel=\"nofollow noreferrer\">zapisz.net/images/706_untitled.jpg</a> The effect which I want to gain is: i have all records, then i filter records from e.g Location, the program found all records where location = e.g London, and then i click button print/export which forward me to form where I can checked columns i would like to print e.g, department, location, PCNumber"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1503511495, "post_id": 45833395, "comment_id": 78651241, "body": "So you do want to specify the fields to include in query object. As I said, requires VBA code. I already mentioned using QueryDefs collection to modify query structure. Or could run MakeTable query every time you want to export. I really don&#39;t recommend doing either because these are database design changes."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8504657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc10fbfb823d13ac447582703fe283a9?s=128&d=identicon&r=PG&f=1", "display_name": "Marta Szmit", "link": "https://stackoverflow.com/users/8504657/marta-szmit"}, "edited": false, "score": 0, "creation_date": 1503476005, "post_id": 45833778, "comment_id": 78625467, "body": "Thanks, but I forgot mentioned that this checkboxes I have in separate form which will be connected with form used for filter records. I will use it to print checked, filtered columns. The effect which I want to gain is: i have all records, then i filter records from e.g Location, the program found all records where location = e.g London, and then i click button print/export which forward me to form where I can checked columns i would like to print e.g, department, location, PCNumber."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1503645410, "post_id": 45833778, "comment_id": 78710693, "body": "You print forms? Use reports!"}], "tags": [], "owner": {"reputation": 80, "user_id": 8073496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6e92fe5649aa7fc0cf63d3b596ce124?s=128&d=identicon&r=PG&f=1", "display_name": "user49828", "link": "https://stackoverflow.com/users/8073496/user49828"}, "is_accepted": false, "score": 0, "last_activity_date": 1503474716, "creation_date": 1503474716, "answer_id": 45833778, "question_id": 45833395, "link": "https://stackoverflow.com/questions/45833395/how-to-connect-checkboxes-in-ms-access-with-specific-columns/45833778#45833778", "title": "How to connect checkboxes in MS-ACCESS with specific columns", "body": "<p>There is very simple in MS-Office 2016 to add Check Box. Open Ms Access, Locate your Table, Select Column where you want to add heck Box, Locate Field tab in Ribbon where you will find Yes/No under add &amp; Delete Section. For reference screenshot is attached.<a href=\"https://i.stack.imgur.com/LAj8v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LAj8v.png\" alt=\"enter image description here\"></a> </p>\n"}, {"tags": [], "owner": {"reputation": 80, "user_id": 8073496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6e92fe5649aa7fc0cf63d3b596ce124?s=128&d=identicon&r=PG&f=1", "display_name": "user49828", "link": "https://stackoverflow.com/users/8073496/user49828"}, "is_accepted": false, "score": 0, "last_activity_date": 1503647466, "creation_date": 1503647466, "answer_id": 45876709, "question_id": 45833395, "link": "https://stackoverflow.com/questions/45833395/how-to-connect-checkboxes-in-ms-access-with-specific-columns/45876709#45876709", "title": "How to connect checkboxes in MS-ACCESS with specific columns", "body": "<p>Yeah I have checked it is fine working here is entry table\n <a href=\"https://i.stack.imgur.com/mmZHR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mmZHR.png\" alt=\"This image is shows entry of data\"></a>\n Here is Report Print Preview\n<a href=\"https://i.stack.imgur.com/AfDNL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AfDNL.png\" alt=\"Here is print preview of Form\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 8504657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc10fbfb823d13ac447582703fe283a9?s=128&d=identicon&r=PG&f=1", "display_name": "Marta Szmit", "link": "https://stackoverflow.com/users/8504657/marta-szmit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 853, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1503647466, "creation_date": 1503473637, "question_id": 45833395, "link": "https://stackoverflow.com/questions/45833395/how-to-connect-checkboxes-in-ms-access-with-specific-columns", "title": "How to connect checkboxes in MS-ACCESS with specific columns", "body": "<p>I'm a beginner developer and I need your help. I have Access database ( records were imported form Excel) and I made a form with checkboxes which names are the same like name of columns in database. I would like to connect them(I mean checkboxes) with this columns(from database) and make a button for printing only checked columns. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 2, "creation_date": 1503473008, "post_id": 45833149, "comment_id": 78623435, "body": "You should show your effort: what code have you tried?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1503473563, "post_id": 45833149, "comment_id": 78623822, "body": "<code>Select case...</code> statement, or <code>if...elseif...elseif...else...end if</code> - you can make use of these, combined with a loop. But you might be better off with a formula, if you odn&#39;t know VBA."}], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1503473766, "creation_date": 1503473766, "answer_id": 45833433, "question_id": 45833149, "link": "https://stackoverflow.com/questions/45833149/find-out-the-cases-having-discrepancies/45833433#45833433", "title": "Find out the cases having discrepancies", "body": "<p>Here's simple code which you should try:</p>\n\n<pre><code>Sub FindDiscrepancies()\nDim lastRow, i, j As Long\nDim discrepancies As String: discrepancies = \"\"\n'find number of last row\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To lastRow\n    For j = 1 To 6\n        If LCase(Cells(i, j).Value) = \"false\" Then\n            discrepancies = discrepancies &amp; Cells(1, j).Value &amp; \", \"\n        End If\n    Next j\n    If discrepancies = \"\" Then\n        Cells(i, 7).Value = \"No discrepancies found\"\n    Else\n        Cells(i, 7).Value = \"Mismatch found in \" &amp; discrepancies\n    End If\n    discrepancies = \"\"\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7968690, "user_type": "registered", "profile_image": "https://graph.facebook.com/1334978733254776/picture?type=large", "display_name": "Kirti Pal", "link": "https://stackoverflow.com/users/7968690/kirti-pal"}, "edited": false, "score": 1, "creation_date": 1503563313, "post_id": 45844977, "comment_id": 78671068, "body": "Thankyou @Gowtham Shiva... I am new to VBA..still in learning phase...Thanks :)"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 3, "user_id": 7968690, "user_type": "registered", "profile_image": "https://graph.facebook.com/1334978733254776/picture?type=large", "display_name": "Kirti Pal", "link": "https://stackoverflow.com/users/7968690/kirti-pal"}, "edited": false, "score": 0, "creation_date": 1503563556, "post_id": 45844977, "comment_id": 78671210, "body": "@KirtiPal Please mark the answer as correct to make the question resolved. You can do that by clicking the tick mark near the answer"}, {"owner": {"reputation": 3, "user_id": 7968690, "user_type": "registered", "profile_image": "https://graph.facebook.com/1334978733254776/picture?type=large", "display_name": "Kirti Pal", "link": "https://stackoverflow.com/users/7968690/kirti-pal"}, "edited": false, "score": 0, "creation_date": 1503571773, "post_id": 45844977, "comment_id": 78677001, "body": "I understood the logic but can we do the same for varying columns..like if these 6 columns keep on changing there place like instead of A to F sometimes they are present from F to K..."}, {"owner": {"reputation": 3, "user_id": 7968690, "user_type": "registered", "profile_image": "https://graph.facebook.com/1334978733254776/picture?type=large", "display_name": "Kirti Pal", "link": "https://stackoverflow.com/users/7968690/kirti-pal"}, "edited": false, "score": 0, "creation_date": 1503577413, "post_id": 45844977, "comment_id": 78681082, "body": "Actually the sheets I am working upon are having varying columns sometimes.... can you plz suggest me for that @gowtham shiva"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 3, "user_id": 7968690, "user_type": "registered", "profile_image": "https://graph.facebook.com/1334978733254776/picture?type=large", "display_name": "Kirti Pal", "link": "https://stackoverflow.com/users/7968690/kirti-pal"}, "edited": false, "score": 0, "creation_date": 1503578350, "post_id": 45844977, "comment_id": 78681838, "body": "@KirtiPal you should be changing that in the code based on your columns. especially in the <code>Countif</code> function and the for loop for <code>k</code>"}, {"owner": {"reputation": 3, "user_id": 7968690, "user_type": "registered", "profile_image": "https://graph.facebook.com/1334978733254776/picture?type=large", "display_name": "Kirti Pal", "link": "https://stackoverflow.com/users/7968690/kirti-pal"}, "edited": false, "score": 0, "creation_date": 1503600425, "post_id": 45844977, "comment_id": 78696605, "body": "I want to write a single code which will search the first data which is &quot;Name&quot; here and will start check the next columns also and then give discrepancies. For finding first column I have used:Cells.Find(What:=&quot;Name&quot;, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _         xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _         , SearchFormat:=False).Activate"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 3, "user_id": 7968690, "user_type": "registered", "profile_image": "https://graph.facebook.com/1334978733254776/picture?type=large", "display_name": "Kirti Pal", "link": "https://stackoverflow.com/users/7968690/kirti-pal"}, "edited": false, "score": 0, "creation_date": 1503639101, "post_id": 45844977, "comment_id": 78708220, "body": "@KirtiPal you are in the right direction. From there you can loop the K variable"}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": true, "score": 0, "last_activity_date": 1503505655, "creation_date": 1503505655, "answer_id": 45844977, "question_id": 45833149, "link": "https://stackoverflow.com/questions/45833149/find-out-the-cases-having-discrepancies/45844977#45844977", "title": "Find out the cases having discrepancies", "body": "<p>Try this simple vba code,</p>\n\n<pre><code>Sub TEXTJOIN()\nDim i As Long, str As String, k As Long, j As Long\nstr = \"\"\nj = 0\nFor i = 2 To Cells(Rows.Count, 1).End(xlUp).Row\nIf Application.WorksheetFunction.CountIf(Range(\"A\" &amp; i &amp; \":F\" &amp; i), True) = 6 Then\n    Cells(i, 7) = \"No Discrepancy Found\"\nElse\n    For k = 1 To 6\n        If Cells(i, k) = False Then\n            str = str &amp; Cells(1, k) &amp; \",\"\n            j = j + 1\n        End If\n    Next k\n    str = Left(str, Len(str) - 1) &amp; \" mismatch found\"\n    Cells(i, 7) = Application.WorksheetFunction.Substitute(str, \",\", \" and \", j - 1)\n    str = \"\"\n    j = 0\nEnd If\nNext i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/WDMLW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WDMLW.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 7968690, "user_type": "registered", "profile_image": "https://graph.facebook.com/1334978733254776/picture?type=large", "display_name": "Kirti Pal", "link": "https://stackoverflow.com/users/7968690/kirti-pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 45844977, "answer_count": 2, "score": -3, "last_activity_date": 1503505655, "creation_date": 1503472932, "question_id": 45833149, "link": "https://stackoverflow.com/questions/45833149/find-out-the-cases-having-discrepancies", "title": "Find out the cases having discrepancies", "body": "<p>I am having a sheet having seven cloumns. First six  columns having either true or false and in last column I have to mention the heading of false cases in one statement. Below is the excel.\n<a href=\"https://i.stack.imgur.com/UPUrd.png\" rel=\"nofollow noreferrer\">Excel sheet</a></p>\n\n<p>I have tried if else statement but there are too many possibilities. Since I am new to VBA i don't know any shortcut to that.Any suggestions?.... Thanks</p>\n"}, {"tags": ["vba", "pdf-generation", "ms-word", "file-rename", "export-to-pdf"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1503473726, "post_id": 45833009, "comment_id": 78623958, "body": "I&#39;m not sure I understand, why don&#39;t you just open them one by one in the code and do the same for all of them? Or use a loop?"}, {"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1503474219, "post_id": 45833009, "comment_id": 78624295, "body": "@vacip it take time to open and print and i want to save it. as files in question are just example there are lot of files to rename and convert."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503504918, "post_id": 45833009, "comment_id": 78647486, "body": "why don&#39;t you do <code>EMEA.doc  -convert-&gt; EMEA 082317.PDF</code> ?"}, {"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503556944, "post_id": 45833009, "comment_id": 78666966, "body": "@jsotola actually I need both files with date <code>EMEA 082317.doc</code> and <code>EMEA 082317.pdf</code>, and file without date <code>EMEA.doc</code> is no use for me."}], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1503478607, "last_edit_date": 1503478607, "creation_date": 1503475632, "answer_id": 45834087, "question_id": 45833009, "link": "https://stackoverflow.com/questions/45833009/saving-and-renaming-multiple-files-as-pdf-without-asking-for-location-at-the-sam/45834087#45834087", "title": "Saving and renaming multiple files as PDF without asking for location at the same time", "body": "<p>General direction:</p>\n\n<ol>\n<li>You need to tell the program which files you want to manipulate (e.g. \"<a href=\"https://stackoverflow.com/questions/11526577/loop-through-all-word-files-in-directory\">all word files in folder x</a>\")</li>\n<li>You seem to already have a rule for renaming (file name &amp; \" \" &amp; date), just loop through all files in question; a <a href=\"https://stackoverflow.com/questions/14013145/windows-batch-file-rename\">batch file</a> might be a good alternative solution to vba for renaming files</li>\n<li><a href=\"https://stackoverflow.com/questions/34042575/multiple-word-doc-to-pdf-convert\">Open and save each document to PDF</a> (can be done in background, no need to actually open the document)</li>\n</ol>\n\n<p><strong>Note</strong>: You never actually \"convert\" a word file, only save an additional (PDF) file. To make it look like a \"conversion\", you need to save the PDF in the same location and delete the original word file.</p>\n\n<p>If you need help with a specifc problem in your program, update your post with the lines of code in question along with a descritpion of the error/wrong behaviour, desired behaviour and what you have tried so far to fix it.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 8640475, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o6Ic_uLdmg4/AAAAAAAAAAI/AAAAAAAAAjI/Nuvg0kY84Z4/photo.jpg?sz=128", "display_name": "Muhammad Bilal", "link": "https://stackoverflow.com/users/8640475/muhammad-bilal"}, "is_accepted": true, "score": 1, "last_activity_date": 1507281723, "creation_date": 1507281723, "answer_id": 46602475, "question_id": 45833009, "link": "https://stackoverflow.com/questions/45833009/saving-and-renaming-multiple-files-as-pdf-without-asking-for-location-at-the-sam/46602475#46602475", "title": "Saving and renaming multiple files as PDF without asking for location at the same time", "body": "<p>Create <a href=\"https://i.stack.imgur.com/XcTwa.png\" rel=\"nofollow noreferrer\">UserForm</a> for three files and copy the code (Given below) in <code>PDF_Click</code>.</p>\n\n<p>code will Open all three of them one by one  and do <code>SAVEAS</code> with <code>Now()</code> date and create <strong>PDF</strong> for check-marked files using <code>For loop</code>.</p>\n\n<pre><code>Private Sub PDF_Click()\n\nDim d As String\n\nFinalize.hide\nDim C As MSForms.Control\nFor Each C In Me.Controls\n    If TypeName(C) = \"CheckBox\" Then\n    If C.Value = True Then\n    If C.Caption = \"Select All\" Then\n    Else\n\nVD = \"C:\\Documents and Settings\\Administrator\\Desktop\\EMEA CEEMEA\\\"\n\nDocuments.Open FileName:=VD &amp; C.Caption &amp; \".doc\"\n\nd = Format(Now(), \"mmddyy\")\nf = VD &amp; Ctl.Caption &amp; \" \" &amp; d\nActiveDocument.SaveAs2 f &amp; \".doc\"\n\nActiveDocument.ExportAsFixedFormat OutputFileName:= _\n        f &amp; \".pdf\", ExportFormat _\n        :=wdExportFormatPDF, OpenAfterExport:=False, OptimizeFor:= _\n        wdExportOptimizeForPrint, Range:=wdExportAllDocument, From:=1, TO:=1, _\n        Item:=wdExportDocumentContent, IncludeDocProps:=True, KeepIRM:=True, _\n        CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _\n        BitmapMissingFonts:=True, UseISO19005_1:=False\n\nActiveDocument.Close\n\n    End If\n    End If\n    End If\n\nNext\nEnd Sub\n</code></pre>\n\n<p>This answer is open for critics, To improve.</p>\n"}], "owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "accepted_answer_id": 46602475, "answer_count": 2, "score": 0, "last_activity_date": 1507281723, "creation_date": 1503472512, "last_edit_date": 1504175504, "question_id": 45833009, "link": "https://stackoverflow.com/questions/45833009/saving-and-renaming-multiple-files-as-pdf-without-asking-for-location-at-the-sam", "title": "Saving and renaming multiple files as PDF without asking for location at the same time", "body": "<p>I have three word doc files and I want to rename them with <code>Now()</code> date. Three files are as</p>\n\n<p><strong>1.</strong> EMEA.doc   <strong>--rename-></strong> EMEA 083117.doc <strong>-convert-></strong> EMEA 082317.PDF</p>\n\n<p><strong>2.</strong> CEEMEA.doc <strong>--rename-></strong> CEEMEA 083117.doc <strong>-convert-></strong> CEEMEA 082317.PDF</p>\n\n<p><strong>3.</strong> LATAM.doc  <strong>--rename-></strong> LATAM 083117.doc <strong>-convert-></strong> LATAM 082317.PDF</p>\n\n<p>I need to <code>ExportAsFixedFormat</code>(PDF) these <code>.Doc</code> files. Following code do the job for <code>ActiveDocument</code> only. I want to save files in specific location without VBA asking for location.</p>\n\n<pre><code>ActiveDocument.ExportAsFixedFormat OutputFileName:= _\n    \"C:\\Documents and Settings\\Administrator\\Desktop\\EMEA CEEMEA\\LATAM.pdf\", ExportFormat _\n    :=wdExportFormatPDF, OpenAfterExport:=False, OptimizeFor:= _\n    wdExportOptimizeForPrint, Range:=wdExportAllDocument, From:=1, To:=1, _\n    Item:=wdExportDocumentContent, IncludeDocProps:=True, KeepIRM:=True, _\n    CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _\n    BitmapMissingFonts:=True, UseISO19005_1:=False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1503477816, "post_id": 45832840, "comment_id": 78626687, "body": "which one is the textbox that has the full userentered string?"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1503477900, "post_id": 45832840, "comment_id": 78626745, "body": "And if I&#39;m not totally wrong, you&#39;re missing something like .value after .Cells(myRow, X)"}, {"owner": {"reputation": 71, "user_id": 7725549, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8456e08de2335eb14c308017d61d226d?s=128&d=identicon&r=PG&f=1", "display_name": "sayjon", "link": "https://stackoverflow.com/users/7725549/sayjon"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1503478295, "post_id": 45832840, "comment_id": 78627022, "body": "Hi Kathara . thanks for your reply . Actually its in Do all replacement comment but I cannot figure out what should be the syntax i will be using . I just tried to search and created the sample program. Actually that program is working if i will use cell to input or key in values but what I want is to use textbox instead of cell for input and any replacement will be done in textbox itself."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1503478651, "post_id": 45832840, "comment_id": 78627254, "body": "What kind of textbox? Active-x or Form controls?"}, {"owner": {"reputation": 71, "user_id": 7725549, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8456e08de2335eb14c308017d61d226d?s=128&d=identicon&r=PG&f=1", "display_name": "sayjon", "link": "https://stackoverflow.com/users/7725549/sayjon"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1503478934, "post_id": 45832840, "comment_id": 78627421, "body": "the textbox should be in the userform and it will be a multiline textbox."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1503480879, "post_id": 45832840, "comment_id": 78628960, "body": "multiline? How long will the string be that has to be replaced? Do all occurances of the replacements have to be eliminated in the entered string?"}, {"owner": {"reputation": 71, "user_id": 7725549, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8456e08de2335eb14c308017d61d226d?s=128&d=identicon&r=PG&f=1", "display_name": "sayjon", "link": "https://stackoverflow.com/users/7725549/sayjon"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1503532788, "post_id": 45832840, "comment_id": 78660081, "body": "Hi Kathara . The length of string vary and not the same in every input . it Can be example abc123cd, abcd23456def or cd3456ab."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1503556297, "post_id": 45832840, "comment_id": 78666655, "body": "But why would you use a multiline textbox then?"}, {"owner": {"reputation": 71, "user_id": 7725549, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8456e08de2335eb14c308017d61d226d?s=128&d=identicon&r=PG&f=1", "display_name": "sayjon", "link": "https://stackoverflow.com/users/7725549/sayjon"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 1, "creation_date": 1503648016, "post_id": 45832840, "comment_id": 78712050, "body": "its a multiple entry of values."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7725549, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8456e08de2335eb14c308017d61d226d?s=128&d=identicon&r=PG&f=1", "display_name": "sayjon", "link": "https://stackoverflow.com/users/7725549/sayjon"}, "edited": false, "score": 0, "creation_date": 1503533042, "post_id": 45838766, "comment_id": 78660137, "body": "Hi Slaqr. Thanks for this I will test the code and let you know . Thank you."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1503556406, "post_id": 45838766, "comment_id": 78666722, "body": "The .Replace method is correct but if I understood right it would be VBA.Replace(TextBox1.Value, myReplace1, &quot;&quot;)"}, {"owner": {"reputation": 71, "user_id": 7725549, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8456e08de2335eb14c308017d61d226d?s=128&d=identicon&r=PG&f=1", "display_name": "sayjon", "link": "https://stackoverflow.com/users/7725549/sayjon"}, "edited": false, "score": 0, "creation_date": 1503647934, "post_id": 45838766, "comment_id": 78712010, "body": "Hi Slaqr your code is working . really thanks for the help."}], "tags": [], "owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "is_accepted": true, "score": 0, "last_activity_date": 1503488567, "creation_date": 1503488567, "answer_id": 45838766, "question_id": 45832840, "link": "https://stackoverflow.com/questions/45832840/replace-string-part-only-in-textbox-vba-excel/45838766#45838766", "title": "replace string part only in textbox vba excel", "body": "<p>How about just changing the value inside the textbox? For example:</p>\n\n<pre><code>TextBox1.Value = VBA.Replace(TextBox1.Value, myFind, myReplace1)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7725549, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8456e08de2335eb14c308017d61d226d?s=128&d=identicon&r=PG&f=1", "display_name": "sayjon", "link": "https://stackoverflow.com/users/7725549/sayjon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1488, "favorite_count": 0, "accepted_answer_id": 45838766, "answer_count": 1, "score": 0, "last_activity_date": 1503488567, "creation_date": 1503471940, "last_edit_date": 1531161705, "question_id": 45832840, "link": "https://stackoverflow.com/questions/45832840/replace-string-part-only-in-textbox-vba-excel", "title": "replace string part only in textbox vba excel", "body": "<p>Hi all just want to ask if it is possible to replace or delete a part of string in textbox? instead of replacing or removing the whole string it will just remove part of it only . The program will be as below procedure.</p>\n\n<ol>\n<li>A user will key in string or text in a textbox example abc123cd</li>\n<li>in an excel cells have a default value of abc and cd . Let we say abc is in A1 and cd in A2.</li>\n<li>Then those default value in A1 and A2 will remove abc and cd in abc123cd. The output will be 123 in the same textbox. it means before it is abc123cd , after clicking commnad button the result will be 123 only in the same textbox.</li>\n</ol>\n\n<p>Below is my sample vba program. But obviously I cannot find the way to fix the issue just to suit my requirements. Hopefully someone can help. Thank you. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim myLastRow As Long\n    Dim myRow As Long\n    Dim myFind As String\n    Dim myReplace1 As String\n    Dim myReplace2 As String\n    Dim sExportFolder, sFN\n    Dim rArticleName As Range\n    Dim rDisclaimer As Range\n    Dim oSh As Worksheet\n    Dim oFS As Object\n    Dim oTxt As Object\n\n    'Specify name of Sheet with list of replacements\n    Set myReplaceSheet = Sheets(\"Sheet2\")\n\n    'Assuming list of replacement start in column A on row 2, find last entry in list\n    myLastRow = myReplaceSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Application.ScreenUpdating = False\n\n    'Loop through all list of replacments\n    For myRow = 2 To myLastRow\n        'Get find and replace values (from columns A and B)\n        myFind = myReplaceSheet.Cells(myRow, \"A\")\n        myReplace1 = myReplaceSheet.Cells(myRow, \"B\")\n\n        'Start at top of data sheet and do replacements\n        myDataSheet.Activate\n        Range(\"A2\").Select\n\n        'Ignore errors that result from finding no matches\n        On Error Resume Next\n\n        'Do all replacements \n        With TextBox1\n            .Replace What:=myFind, Replacement:=myReplace1, LookAt:=xlPart, _\n              SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n              ReplaceFormat:=False\n        End With\n    Next myRow\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1503471988, "post_id": 45832710, "comment_id": 78622831, "body": "<code>Application.Run</code> is expected to return the value returned by the called macro (here <code>subscribeToPorts</code>), so it is not an asynchronous call by itself. Is there any asynchronous calls inside the macro?"}, {"owner": {"reputation": 1, "user_id": 8504437, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213589483389111/picture?type=large", "display_name": "Matteo Busetti", "link": "https://stackoverflow.com/users/8504437/matteo-busetti"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1503558692, "post_id": 45832710, "comment_id": 78667972, "body": "The macro that is called is developed by the a broker and all it does is get the data from my portfolio into Excel. Do you have any suggestions on how this could be solved?"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1503474737, "post_id": 45832857, "comment_id": 78624627, "body": "There is another issue: It refers to <code>StartCell.Column</code> which refers to <code>Set StartCell = Range(&quot;A8&quot;)</code> which is exactly the same as <code>Set StartCell = ActiveSheet.Range(&quot;A8&quot;)</code> and which should be <code>Set StartCell = ws2.Range(&quot;A8&quot;)</code> to work safe and without issues. It&#39;s a good practice to <i>never</i> assume the worksheet, and reference to a specific worksheet with every <code>.Range</code>, <code>.Rows</code>, <code>.Columns</code>, <code>.Cells</code> etc."}, {"owner": {"reputation": 1, "user_id": 8504437, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213589483389111/picture?type=large", "display_name": "Matteo Busetti", "link": "https://stackoverflow.com/users/8504437/matteo-busetti"}, "edited": false, "score": 0, "creation_date": 1503558577, "post_id": 45832857, "comment_id": 78667903, "body": "I have used xlDown because I want to select and copy everything from A8 downwards - is it wrong?  I have tried to change the StartCell.Column, but this does not solve the problem"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1503559197, "post_id": 45832857, "comment_id": 78668363, "body": "Yes, then you made a mistake. To achieve what you said you should do <code>LastRow = StartCell.End(xlDown).Row</code> (which means &quot;from <code>StartCell</code> go down to the end of block of data and take the row number from that cell&quot;)."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1503559342, "post_id": 45832857, "comment_id": 78668470, "body": "What you have now means &quot;in sheet <code>ws2</code> from cell that has row number equal to the number of all rows in sheet and column number equal to the column number of <code>StartCell</code>, go down and take row number of that cell&quot;."}, {"owner": {"reputation": 1, "user_id": 8504437, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213589483389111/picture?type=large", "display_name": "Matteo Busetti", "link": "https://stackoverflow.com/users/8504437/matteo-busetti"}, "edited": false, "score": 0, "creation_date": 1503602979, "post_id": 45832857, "comment_id": 78697888, "body": "Many thanks!  Do you know what could be causing the other error? i.e. the macro run with application.run takes a few seconds to fill in the data in the sheet, but the selection process happens before the data is filled in. Therefore I have all cells from A8 onwards selected..."}], "tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 2, "last_activity_date": 1503471989, "creation_date": 1503471989, "answer_id": 45832857, "question_id": 45832710, "link": "https://stackoverflow.com/questions/45832710/wait-until-application-run-is-completed/45832857#45832857", "title": "Wait until application.run is completed", "body": "<p>Your calculation of <code>LastRow</code> is wrong. It should be <code>xlUp</code> instead of <code>xlDown</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8504437, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213589483389111/picture?type=large", "display_name": "Matteo Busetti", "link": "https://stackoverflow.com/users/8504437/matteo-busetti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503475001, "creation_date": 1503471551, "last_edit_date": 1503475001, "question_id": 45832710, "link": "https://stackoverflow.com/questions/45832710/wait-until-application-run-is-completed", "title": "Wait until application.run is completed", "body": "<p>I'm trying to write a macro on one file that opens another workbook, runs a macro to get some data, copies the data into the first workbook and closes the second workbook.</p>\n\n<p>I have however encountered a problem because it seems like the selection of the range is executed while the macro in the second workbook is still running and therefore selects the entire column:</p>\n\n<p>i.e. the <code>ws2.Range(StartCell, ws2.Cells(LastRow, \"A\")).Select</code> string in the code below selects the whole column, and not just the cells where there is data.</p>\n\n<pre><code>'run macro in IB API file to get portfolio data\nApplication.Run \"TwsDde.xls!Sheet15.subscribeToPorts\"\n\n'select data in column A from IB API file\nDim LastRow As Long\nDim StartCell As Range\nSet StartCell = Range(\"A8\")\nLastRow = ws2.Cells(ws2.Rows.Count, StartCell.Column).End(xlDown).Row\nws2.Range(StartCell, ws2.Cells(LastRow, \"A\")).Select\n</code></pre>\n\n<p>Has anyone encountered this problem before or has any ideas on how to solve it?</p>\n"}, {"tags": ["excel", "vba", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 1110, "user_id": 2913267, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-GdsRGM0D490/AAAAAAAAAAI/AAAAAAAAAwg/dA-JDsZpis0/photo.jpg?sz=128", "display_name": "l.g.karolos", "link": "https://stackoverflow.com/users/2913267/l-g-karolos"}, "edited": false, "score": 0, "creation_date": 1503470712, "post_id": 45832429, "comment_id": 78622044, "body": "Check this it might help you <a href=\"https://msdn.microsoft.com/VBA/Access-VBA/articles/combobox-boundcolumn-property-access\" rel=\"nofollow noreferrer\">msdn.microsoft.com/VBA/Access-VBA/articles/&hellip;</a>"}], "tags": [], "owner": {"reputation": 101, "user_id": 1934124, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9f638bc35d86096139908caef240bbd2?s=128&d=identicon&r=PG", "display_name": "dkero", "link": "https://stackoverflow.com/users/1934124/dkero"}, "is_accepted": false, "score": 0, "last_activity_date": 1503470674, "creation_date": 1503470674, "answer_id": 45832429, "question_id": 45832331, "link": "https://stackoverflow.com/questions/45832331/retain-combobox-value-when-wb-closes/45832429#45832429", "title": "Retain combobox value when wb closes", "body": "<p>You can create hidden field on your form and store combo box value into field when you close workbook.</p>\n"}, {"comments": [{"owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 0, "creation_date": 1503661363, "post_id": 45832555, "comment_id": 78719466, "body": "Thanks! I don&#39;t know why, but the <code>CustomDocumentProperty</code>   doesn&#39;t work, probably because of the system restrictions imposed by the IT admins, but I did find a workaround with the <code>Workbook.BeforeClose </code> <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-beforeclose-event-excel\" rel=\"nofollow noreferrer\">Event</a> Function."}], "tags": [], "owner": {"reputation": 1110, "user_id": 2913267, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-GdsRGM0D490/AAAAAAAAAAI/AAAAAAAAAwg/dA-JDsZpis0/photo.jpg?sz=128", "display_name": "l.g.karolos", "link": "https://stackoverflow.com/users/2913267/l-g-karolos"}, "is_accepted": false, "score": 1, "last_activity_date": 1503471058, "creation_date": 1503471058, "answer_id": 45832555, "question_id": 45832331, "link": "https://stackoverflow.com/questions/45832331/retain-combobox-value-when-wb-closes/45832555#45832555", "title": "Retain combobox value when wb closes", "body": "<p>However, you can store data in a workbook in an Excel Name object, and you can also store data in a <code>CustomDocumentProperty</code> object. Say the value you want to store is a number, like 7. To store the data in a Name object:</p>\n\n<pre><code>Names.Add Name:=\"VersionNumber\", RefersTo:=7\n</code></pre>\n\n<p>and to change it:</p>\n\n<pre><code>Names(\"VersionNumber\").Value = 8\n</code></pre>\n\n<p>This has the advantage that the name can be referred to in a cell formula (i.e., <code>=VersionNumber</code> will yield 8 in the cell)</p>\n\n<p>Similarly, to create a new <code>CustomDocumentProperty</code>:</p>\n\n<pre><code>ThisWorkbook.CustomDocumentProperties.Add _\nName:=\"Version Number\", _\nLinkToContent:=False, _\nType:=msoPropertyTypeNumber, _\nValue:=7\n</code></pre>\n\n<p>and to change it:</p>\n\n<pre><code>ThisWorkbook.CustomDocumentProperties(\"Version Number\").Value = 12\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "is_accepted": false, "score": 0, "last_activity_date": 1503661533, "creation_date": 1503661533, "answer_id": 45880682, "question_id": 45832331, "link": "https://stackoverflow.com/questions/45832331/retain-combobox-value-when-wb-closes/45880682#45880682", "title": "Retain combobox value when wb closes", "body": "<p>I have found and used the <code>Workbook.BeforeClose</code> Event Function to solve the problem.</p>\n"}], "owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1503661533, "creation_date": 1503470382, "question_id": 45832331, "link": "https://stackoverflow.com/questions/45832331/retain-combobox-value-when-wb-closes", "title": "Retain combobox value when wb closes", "body": "<p>In continuation to the following <a href=\"https://stackoverflow.com/questions/21180858/combobox-retain-last-selected-values-vba\">question</a> how do I easily store the combobox value after the workbook closes ? For example, if the last combobox value was may when I closed the workbook, next time I open it againg, I would like the combobox list value to be set to may.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1503472121, "post_id": 45832098, "comment_id": 78622906, "body": "Try: <code>SELECT TOP 3 ...</code> - no parens around 3."}, {"owner": {"reputation": 49, "user_id": 7603357, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210879023624862/picture?type=large", "display_name": "Nick Mackenzie", "link": "https://stackoverflow.com/users/7603357/nick-mackenzie"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1503473088, "post_id": 45832098, "comment_id": 78623484, "body": "Thanks it worked fine"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1503476640, "post_id": 45832098, "comment_id": 78625908, "body": "Then please mark as answered."}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 7603357, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210879023624862/picture?type=large", "display_name": "Nick Mackenzie", "link": "https://stackoverflow.com/users/7603357/nick-mackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1503486980, "creation_date": 1503486980, "answer_id": 45838219, "question_id": 45832098, "link": "https://stackoverflow.com/questions/45832098/query-to-get-highest-sum-of-products/45838219#45838219", "title": "Query to get highest Sum Of Products", "body": "<pre><code>'SELECT TO(3 productname, SUM(dailysale) As SumOfSales \n</code></pre>\n\n<p>FROM tblsales\nGROUP BY productname\nORDER BY Sum(dailysale) DESC;'</p>\n"}], "owner": {"reputation": 49, "user_id": 7603357, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210879023624862/picture?type=large", "display_name": "Nick Mackenzie", "link": "https://stackoverflow.com/users/7603357/nick-mackenzie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594639271, "creation_date": 1503469558, "last_edit_date": 1594639271, "question_id": 45832098, "link": "https://stackoverflow.com/questions/45832098/query-to-get-highest-sum-of-products", "title": "Query to get highest Sum Of Products", "body": "<p>I have a table that captures sales for different product. What query would i use if i wanted to get the top three products with the highest sales? Am using MS Access as my database.I have used the query below but it doesn't work.</p>\n\n<p><code>SELECT TOP(3) productname, SUM(dailysale) As SumOfSales \nFROM tblsales\nGROUP BY productname\nORDER BY Sum(dailysale) DESC;</code></p>\n"}, {"tags": ["vba", "outlook", "email-attachments"], "comments": [{"owner": {"reputation": 6597, "user_id": 2967965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxcI6.png?s=128&g=1", "display_name": "MatSnow", "link": "https://stackoverflow.com/users/2967965/matsnow"}, "edited": false, "score": 1, "creation_date": 1503471167, "post_id": 45831871, "comment_id": 78622316, "body": "Even &quot;big&quot; softwares, for example Outlook, are saving PDF-files to a local drive (temp-Folder) to open them in another program. The problem here is that the PDF-reader needs a reference/path to the file you want to open. Why not just delete the file from the drive after it is printed?"}, {"owner": {"reputation": 521, "user_id": 2011985, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e3411d35d0b322922639a9c545f78571?s=128&d=identicon&r=PG", "display_name": "ChrisC", "link": "https://stackoverflow.com/users/2011985/chrisc"}, "reply_to_user": {"reputation": 6597, "user_id": 2967965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxcI6.png?s=128&g=1", "display_name": "MatSnow", "link": "https://stackoverflow.com/users/2967965/matsnow"}, "edited": false, "score": 0, "creation_date": 1503480431, "post_id": 45831871, "comment_id": 78628629, "body": "I was having troubles deleting the folder and its files in VBA, which is why I was looking for a solution without explicit saving of the file to the HDD. However, I got the file and folder deleting within VBA to work, so your advice did work out in the end for me! :) Is it possible to set this question to solved/answered?"}], "answers": [{"tags": [], "owner": {"reputation": 6597, "user_id": 2967965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxcI6.png?s=128&g=1", "display_name": "MatSnow", "link": "https://stackoverflow.com/users/2967965/matsnow"}, "is_accepted": false, "score": 0, "last_activity_date": 1503481602, "last_edit_date": 1503481602, "creation_date": 1503480920, "answer_id": 45835991, "question_id": 45831871, "link": "https://stackoverflow.com/questions/45831871/print-outlook-attachments-without-saving-on-hard-drive/45835991#45835991", "title": "Print Outlook attachments without saving on hard drive", "body": "<p>Even \"big\" softwares, for example Outlook, are saving PDF-files to a local drive (temp-Folder) to open them in another program.\n<br>The problem here is that the PDF-reader needs a reference/path to the file you want to open.</p>\n\n<p>I would suggest to delete the file from the drive after it is printed.</p>\n"}], "owner": {"reputation": 521, "user_id": 2011985, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e3411d35d0b322922639a9c545f78571?s=128&d=identicon&r=PG", "display_name": "ChrisC", "link": "https://stackoverflow.com/users/2011985/chrisc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 909, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593156178, "creation_date": 1503468620, "last_edit_date": 1593156178, "question_id": 45831871, "link": "https://stackoverflow.com/questions/45831871/print-outlook-attachments-without-saving-on-hard-drive", "title": "Print Outlook attachments without saving on hard drive", "body": "<p>I have a VBA script which cycles through selected emails and prints all PDF attachments in said emails.</p>\n\n<p>Currently, the script saves the PDF files to the hard drive and then opens and prints them.</p>\n\n<pre><code>Sub BatchPrintAllAttachmentsinMultipleEmails()\n   Dim objFileSystem As Object\n   Dim strTempFolder As String\n   Dim objSelection As Outlook.Selection\n   Dim objItem As Object\n   Dim objMail As Outlook.MailItem\n   Dim objAttachments As Outlook.Attachments\n   Dim objAttachment As Outlook.Attachment\n   Dim objShell As Object\n   Dim objTempFolder As Object\n   Dim objTempFolderItem As Object\n   Dim strFilePath As String\n\n\n\n\n   Set objFileSystem = CreateObject(\"Scripting.FileSystemObject\")\n   strTempFolder = objFileSystem.GetSpecialFolder(2).Path &amp; \"\\Temp for Attachments \" &amp; Format(Now, \"YYYY-MM-DD_hh-mm-ss\")\n   strTempFolder = \"W:\\my documents\\test\"\n\n   MkDir (strTempFolder)\n\n   Set objSelection = Outlook.Application.ActiveExplorer.Selection\n\n   For Each objItem In objSelection\n       If TypeOf objItem Is MailItem Then\n          Set objMail = objItem\n          Set objAttachments = objMail.Attachments\n\n          'Save all the attachments in the temp folder\n          For Each objAttachment In objAttachments\n               strFilePath = strTempFolder &amp; \"\\\" &amp; objAttachment.FileName\n               If InStr(strFilePath, \".pdf\") &lt;&gt; 0 Or InStr(strFilePath, \".PDF\") &lt;&gt; 0 Then\n                   objAttachment.SaveAsFile (strFilePath)\n                   Set objShell = CreateObject(\"Shell.Application\")\n                   Set objTempFolder = objShell.NameSpace(0)\n                   Set objTempFolderItem = objTempFolder.ParseName(strFilePath)\n                   objTempFolderItem.InvokeVerbEx (\"print\") 'try now\n               End If\n\n\n\n          Next objAttachment\n       End If\n   Next\n\nEnd Sub\n</code></pre>\n\n<p>I am wondering if it is possible to execute this code without saving the files to the hard drive, i.e. just opening them from memory in VBA, print them, and have no trace of them on the hard drive?</p>\n"}, {"tags": ["excel", "vba", "validation", "colors", "combobox"], "comments": [{"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1503467710, "post_id": 45831502, "comment_id": 78620479, "body": "See if <a href=\"https://stackoverflow.com/questions/29465932/excel-data-validation-change-fill-color-without-changing-text\">this</a> helps."}, {"owner": {"reputation": 95, "user_id": 8218639, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8766fe708ad55ba2d3c131116a40e58?s=128&d=identicon&r=PG&f=1", "display_name": "Antti", "link": "https://stackoverflow.com/users/8218639/antti"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1503468334, "post_id": 45831502, "comment_id": 78620797, "body": "I don&#39;t want to use ComboBox and I would prefer that solution is off-line, without pressing any update buttons which goes through some range."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1503468452, "post_id": 45831502, "comment_id": 78620854, "body": "Use conditional formatting as suggested."}, {"owner": {"reputation": 95, "user_id": 8218639, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8766fe708ad55ba2d3c131116a40e58?s=128&d=identicon&r=PG&f=1", "display_name": "Antti", "link": "https://stackoverflow.com/users/8218639/antti"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1503468753, "post_id": 45831502, "comment_id": 78620987, "body": "please share an example"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1503468870, "post_id": 45831502, "comment_id": 78621043, "body": "Its there in the link in my comment. <a href=\"https://stackoverflow.com/a/29467110/6075259\">stackoverflow.com/a/29467110/6075259</a>"}, {"owner": {"reputation": 95, "user_id": 8218639, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8766fe708ad55ba2d3c131116a40e58?s=128&d=identicon&r=PG&f=1", "display_name": "Antti", "link": "https://stackoverflow.com/users/8218639/antti"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1503469334, "post_id": 45831502, "comment_id": 78621310, "body": "I want to solve the challenge programmatically, that I do something inside my Function addDataValidation"}, {"owner": {"reputation": 95, "user_id": 8218639, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8766fe708ad55ba2d3c131116a40e58?s=128&d=identicon&r=PG&f=1", "display_name": "Antti", "link": "https://stackoverflow.com/users/8218639/antti"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1503469893, "post_id": 45831502, "comment_id": 78621564, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/152593/discussion-between-aratiod-and-mrig\">continue this discussion in chat</a>."}], "owner": {"reputation": 95, "user_id": 8218639, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8766fe708ad55ba2d3c131116a40e58?s=128&d=identicon&r=PG&f=1", "display_name": "Antti", "link": "https://stackoverflow.com/users/8218639/antti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 982, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503659236, "creation_date": 1503467137, "last_edit_date": 1503659236, "question_id": 45831502, "link": "https://stackoverflow.com/questions/45831502/excel-vba-data-validations-background-color-coding-programmatically-in-a-drop", "title": "EXCEL VBA: Data Validation&#39;s background color coding programmatically in a drop-down list and inserting in a Cell", "body": "<p>A code sample below makes perfectly nice drop-down list in a certain row and column, but I need to insert also color backgrounds programmatically inside cells.</p>\n\n<p>This defines values and colors.</p>\n\n<blockquote>\n<pre><code>optionList(0) = \"Not started\" --&gt; RED\noptionList(1) = \"Planned\" --&gt; YELLOW\noptionList(2) = \"Started\"  --&gt; YELLOW\noptionList(3) = \"Failed\" --&gt; RED\noptionList(4) = \"Passed / Done\" --&gt; GREEN\noptionList(5) = \"Not applicable\" --&gt; GREY\n</code></pre>\n</blockquote>\n\n<p>--> Code below works, but I need instructions how to add colors.</p>\n\n<pre><code>Public Function addDataValidation(row As Long, column As Long)\n\nDim optionList(5) As String\n\noptionList(0) = \"Not started\"\noptionList(1) = \"Planned\"\noptionList(2) = \"Started\"\noptionList(3) = \"Failed\"\noptionList(4) = \"Passed / Done\"\noptionList(5) = \"Not applicable\"\n\n    With mySheet.Cells(row, column).Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n             Operator:=xlBetween, Formula1:=Join(optionList, \",\")\n    End With\n\nEnd Function\n</code></pre>\n\n<p>My tested and final solution for this challenge is following like</p>\n\n<pre><code>    Public Function addDataValidation(row As Long, column As Long)\n\nDim optionList(5) As String\n\noptionList(0) = \"Not started\"\noptionList(1) = \"Planned\"\noptionList(2) = \"Started\"\noptionList(3) = \"Failed\"\noptionList(4) = \"Passed / Done\"\noptionList(5) = \"Not applicable\"\n\n    With mySheet.Cells(row, column).Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n             Operator:=xlBetween, Formula1:=Join(optionList, \",\")\n    End With\n\n    With mySheet.Cells(row, column).FormatConditions.Add(xlCellValue, xlEqual, \"=\"\"Not started\"\"\")\n        .Font.Bold = True\n        .Interior.colorIndex = 3\n        .StopIfTrue = False\n    End With\n\n    With mySheet.Cells(row, column).FormatConditions.Add(xlCellValue, xlEqual, \"=\"\"Planned\"\"\")\n        .Font.Bold = True\n        .Interior.colorIndex = 6\n        .StopIfTrue = False\n    End With\n\n    With mySheet.Cells(row, column).FormatConditions.Add(xlCellValue, xlEqual, \"=\"\"Started\"\"\")\n        .Font.Bold = True\n        .Interior.colorIndex = 6\n        .StopIfTrue = False\n    End With\n\n    With mySheet.Cells(row, column).FormatConditions.Add(xlCellValue, xlEqual, \"=\"\"Failed\"\"\")\n        .Font.Bold = True\n        .Interior.colorIndex = 3\n        .StopIfTrue = False\n    End With\n\n    With mySheet.Cells(row, column).FormatConditions.Add(xlCellValue, xlEqual, \"=\"\"Passed / Done\"\"\")\n        .Font.Bold = True\n        .Interior.colorIndex = 4\n        .StopIfTrue = False\n    End With\n\n    With mySheet.Cells(row, column).FormatConditions.Add(xlCellValue, xlEqual, \"=\"\"Not applicable\"\"\")\n        .Font.Bold = True\n        .Interior.colorIndex = 15\n        .StopIfTrue = False\n    End With\n\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1503464254, "post_id": 45830380, "comment_id": 78619167, "body": "You should watch this series on YouTube:<a href=\"https://www.youtube.com/watch?v=KHO5NIcZAc4&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Tutorial</a> . Episodes 5 and 25 are relevant."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1503467096, "post_id": 45830380, "comment_id": 78620253, "body": "Would you mind sharing the screenshots of what you have and what should be your expected output to visualize your goal?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1503486177, "post_id": 45830380, "comment_id": 78632803, "body": "<code>Dim i, z, u As Integer</code> only declares <code>u</code> as integer.  The others will be declared as variants.  Also, there&#39;s almost never a need for the integer type.  Use <code>long</code> instead.  See discussions in SO and on the &#39;net for explanations."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1503534061, "post_id": 45830380, "comment_id": 78660379, "body": "dont mistake a range for an array. The later is faster, but needs more coding."}, {"owner": {"reputation": 13, "user_id": 5892899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b622c5d47cd147b3b628baab531b6e?s=128&d=identicon&r=PG&f=1", "display_name": "vbderr", "link": "https://stackoverflow.com/users/5892899/vbderr"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1503534640, "post_id": 45830380, "comment_id": 78660522, "body": "Thank you for the input. @sktneer the screen shots don&#39;t explain the goal well, but the gist is just to identify a number of consecutive negative values in a column of data with the number of consecutive negative values pulled in as an input from the user. Once that criteria is met, the first value in the data set would be displayed in the next column."}], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1503464219, "post_id": 45830488, "comment_id": 78619155, "body": "you have to also do <code>Arr = Application.Transpose(Arr)</code> to convert from 2D array into a 1D array"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1503486375, "post_id": 45830488, "comment_id": 78632969, "body": "@jsotola I&#39;ve never done any speed test, but consider: would it be faster to just iterate through the first dimension of the 2D array?  Or to do the transpose and then iterate through the 1D array?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503508755, "post_id": 45830488, "comment_id": 78649703, "body": "i do not know if it is faster or slower. just one less thing to cause issue  eg <i>is it arr(1,x) or arr(x,1)</i>"}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1503508764, "post_id": 45830488, "comment_id": 78649710, "body": "@RonRosenfeld The answer will depend on the size of array: apparently, Transpose() function overhead increases the overall time complexity, but it could be justified in case of processing a large array. As a general rule, just iterating through the first dimension probably will suffice the case. Best regards,"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503508850, "post_id": 45830488, "comment_id": 78649761, "body": "@jsotola  Now you&#39;ve got me curious.  I&#39;ll have to test it."}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503508965, "post_id": 45830488, "comment_id": 78649820, "body": "@jsotola Sure, that would be interesting algo efficiency comparison test. Best regards,"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1503510462, "post_id": 45830488, "comment_id": 78650602, "body": "@jsotola OK there are two problems with <code>Worksheetfunction.Transpose</code>.  With an array of 32,000 rows, it took 3 times as long to sum the values as using the original 2D array.  But also, it was somewhat erratic in dealing with large arrays.  I initially tried an array of 100,000 rows, but transpose --&gt; ubound of 34464.  Some testing reveals that Transpose will only return a maximum of <code>num_rows MOD 65536</code>."}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1503511231, "post_id": 45830488, "comment_id": 78651093, "body": "@RonRosenfeld Interesting findings, thanks for sharing. In the light of this finding, the best practice will be looping through the first dimension, as stated above."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1503512432, "post_id": 45830488, "comment_id": 78651795, "body": "That was my &quot;gut&quot; impression, but hard data is always better."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1503526298, "post_id": 45830488, "comment_id": 78658286, "body": "@RonRosenfeld, i just posted another answer using the worksheet function. your thoughts on execution speed would be welcome."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503531795, "post_id": 45830488, "comment_id": 78659852, "body": "@jsotola There&#39;s no real way to know without testing.  But on a range of 100 cells, I would think the differences to be insignificant."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1503533114, "post_id": 45830488, "comment_id": 78660154, "body": "@RonRosenfeld from your earlier comments, i gathered that you ran some kind of an execution time test on the array, and i thought that you could also run a test on this also, for maybe <code>Application.WorksheetFunction.Max(Range(&quot;a1:a100000&quot;))</code>, if you have the time"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503533751, "post_id": 45830488, "comment_id": 78660289, "body": "@jsotola the <code>MAX</code> function is significantly (12-15 x) faster than looping through an array to find the highest value."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1503534582, "post_id": 45830488, "comment_id": 78660508, "body": "@RonRosenfeld, thanks for checking that. i guess that, if there is a worksheet function available, use it because it has been optimized all the way to the bone."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503535974, "post_id": 45830488, "comment_id": 78660814, "body": "@jsotola That has not always been the case, in my experience.  Best to test optimal VBA code against the equivalent worksheet function if speed is the goal."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503576755, "post_id": 45830488, "comment_id": 78680549, "body": "@jsotola To expand, my &quot;gut feeling&quot; would be that worksheet functions like <code>SUM</code>, <code>MAX</code> and the like, which can operate on a large range of cells in a single operation, would be more efficient than equivalent VBA routines, especially on larger ranges.  But with the various <code>LOOKUP</code> functions, <code>MATCH</code> and maybe some others, especially when working with unsorted data, optimized VBA routines might be better.  Again, this should be tested for the scenarios involved.  And anything that involves repeated access to the worksheet will almost always be slower than using VBA arrays."}], "tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1503461212, "creation_date": 1503461212, "answer_id": 45830488, "question_id": 45830380, "link": "https://stackoverflow.com/questions/45830380/check-if-any-value-in-array-is-greater-than-zero-efficiently-in-excel-using-vb/45830488#45830488", "title": "Check if any value in array is greater than zero (efficiently) in Excel using vba", "body": "<p>In order to speed up the processing you may consider converting Excel <code>Range</code> (for example <code>A1:A100</code>) into array <code>Arr</code> and then iterating through array:</p>\n\n<pre><code>Dim Arr() As Variant\nArr = Range(\"A1:A100\")\n</code></pre>\n\n<p>Also, you may consider setting property <code>Application.ScreenUpdating = False</code> prior to starting the iterations (in case you change the cells' values during iteration as per your example) and resetting it to <code>True</code> afterwards.</p>\n\n<p>Hope this may help.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5892899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b622c5d47cd147b3b628baab531b6e?s=128&d=identicon&r=PG&f=1", "display_name": "vbderr", "link": "https://stackoverflow.com/users/5892899/vbderr"}, "edited": false, "score": 0, "creation_date": 1503534460, "post_id": 45849998, "comment_id": 78660471, "body": "Thanks, this worked great and eliminated the need for any element by element check of the array."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 13, "user_id": 5892899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b622c5d47cd147b3b628baab531b6e?s=128&d=identicon&r=PG&f=1", "display_name": "vbderr", "link": "https://stackoverflow.com/users/5892899/vbderr"}, "edited": false, "score": 0, "creation_date": 1503534875, "post_id": 45849998, "comment_id": 78660566, "body": "you can just do <code>Application.WorksheetFunction.Max(columns(&quot;a&quot;))</code> and not worry about finding the last populated row. it still works if there is text in the column"}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": true, "score": 0, "last_activity_date": 1503526032, "creation_date": 1503526032, "answer_id": 45849998, "question_id": 45830380, "link": "https://stackoverflow.com/questions/45830380/check-if-any-value-in-array-is-greater-than-zero-efficiently-in-excel-using-vb/45849998#45849998", "title": "Check if any value in array is greater than zero (efficiently) in Excel using vba", "body": "<p>use worksheet function</p>\n\n<pre><code>If Application.WorksheetFunction.Max(Range(\"a1:a100\")) &gt; 0 Then\n    MsgBox \"value higher than zero\"\nend if\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5892899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b622c5d47cd147b3b628baab531b6e?s=128&d=identicon&r=PG&f=1", "display_name": "vbderr", "link": "https://stackoverflow.com/users/5892899/vbderr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2558, "favorite_count": 0, "accepted_answer_id": 45849998, "answer_count": 2, "score": 1, "last_activity_date": 1503526032, "creation_date": 1503460443, "question_id": 45830380, "link": "https://stackoverflow.com/questions/45830380/check-if-any-value-in-array-is-greater-than-zero-efficiently-in-excel-using-vb", "title": "Check if any value in array is greater than zero (efficiently) in Excel using vba", "body": "<p>I am attempting to check if any value in a dynamic array of size \"i\" by one is greater than zero where \"i\" is a user input. If false, the value of the first element in the array would show in the next column. If true, the values of the array update by essentially moving down one element. I believe I have found answers for this question in java <a href=\"https://stackoverflow.com/questions/19737105/how-to-check-if-all-values-in-an-array-are-higher-than-a-specific-amount\">here</a>, but haven't had any luck finding it in vba. I believe this could be done with a for loop as done <a href=\"https://stackoverflow.com/questions/4228137/vba-for-each-on-an-array\">here</a>, but would like something more efficient if it exists. Since I do not know any syntax which may work the code hangs at \"If any x > 0 Then\"</p>\n\n<pre><code>Dim i, z, u As Integer\nDim fir As Integer\nDim las As Integer\nDim n As Long\nDim x As Variant\n\n'SET VALUE OF ROWS FOR ARRAY\ni = Worksheets(\"INPUTS\").Range(\"C6\").Value\n\nSet s = Worksheets(\"DATA\")\n\n'FIND LAST VALUE IN DATA\nn = s.Cells(s.Rows.Count, \"A\").End(xlUp).Row\n\n'BEGIN LOOP THROUGH DATA SET\nFor z = 1 To n\n\n    'SET/RESET RANGE TO CHECK FOR CONSECUTIVE VALUES LESS THAN ZERO\n    fir = z\n    las = i + z - 1\n    x = (s.Range(\"C\" &amp; fir, \"C\" &amp; las).Value)\n    u = s.Range(\"C\" &amp; UBound(x)).Value\n\n    If any x &gt; 0 Then\n    Else: s.Cells(4, z) = x(1, 1).Value\n    End If\n\nNext z\n</code></pre>\n\n<p>I'm a beginner and new to the forum so feel free to tear me a new one on anything against best practices relating to the code or the question, thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1503460027, "post_id": 45830302, "comment_id": 78618092, "body": "Yes, if you open VBE (Visual Basic Editor) window (perhaps using Alt-F11) then you can start writing a script there.  Once written, you will be able to invoke that script whenever you like."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1503460410, "post_id": 45830302, "comment_id": 78618188, "body": "OK, that was a bit tongue-in-cheek, but you really need to show what code you are having trouble with if you expect us to be able to assist you to get it working."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1503464650, "post_id": 45830302, "comment_id": 78619307, "body": "start by recording a macro"}], "owner": {"reputation": 1, "user_id": 8503682, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e2cfed33a4c8296400965e4d6652ee10?s=128&d=identicon&r=PG&f=1", "display_name": "user8503682", "link": "https://stackoverflow.com/users/8503682/user8503682"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503459928, "creation_date": 1503459928, "question_id": 45830302, "link": "https://stackoverflow.com/questions/45830302/copy-range-of-multiple-colums-and-post-into-another-worksheet-within-same-docume", "title": "Copy Range of Multiple Colums and post into another worksheet within same document in VBA script", "body": "<p>What Im trying to to is take information from row C,D,E,F,F,AL,AM from Sheet Add all the at information starts on Row 3 and put it into Sheet Final Data and start on Row 3.\nIs there a way to write a VBA script for it?</p>\n"}, {"tags": ["excel", "powerpoint", "vba"], "answers": [{"tags": [], "owner": {"reputation": 908, "user_id": 2322977, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/49c196ad6e4365c8f219c89030597728?s=128&d=identicon&r=PG", "display_name": "ainwood", "link": "https://stackoverflow.com/users/2322977/ainwood"}, "is_accepted": false, "score": 0, "last_activity_date": 1503464244, "creation_date": 1503464244, "answer_id": 45830921, "question_id": 45830266, "link": "https://stackoverflow.com/questions/45830266/excel-vba-excel-range-to-just-opened-powerpoint/45830921#45830921", "title": "Excel VBA: Excel range to just opened powerpoint", "body": "<p>You can paste the data in various formats.  There is a good article <a href=\"https://www.thespreadsheetguru.com/blog/2014/3/17/copy-paste-an-excel-range-into-powerpoint-with-vba\" rel=\"nofollow noreferrer\">here</a> on how to do this, in particular the bit about the different file formats that you can paste the data via.</p>\n\n<p>The method pastes it as a <code>shape</code>. Here is some code I use that is similar to the article:</p>\n\n<pre><code>'//Create and open powerpoint\nDim ppt As PowerPoint.Application\nSet ppt = New PowerPoint.Application\n\n'//Set objects and open powerpoint\nDim oPresentation As PowerPoint.Presentation\nDim oTargetSlide As PowerPoint.Slide\nDim oSelect As PowerPoint.ShapeRange\n\nSet oPresentation = ppt.Presentations.Open(sFileName)\n\n'//Copy the data\nThisWorkbook.Sheets(\"Sheet1\").Range(\"B4:B8\").Select\nSelection.Copy\n\n'//Paste it into powerpoint\nWith ppt\n    Set oTargetSlide = oPresentation.Slides(1)\n    oTargetSlide.Select\n    ppt.ActiveWindow.View.GotoSlide oTargetSlide.SlideIndex\n    Set oSelect = \n    oTargetSlide.Shapes.PasteSpecial(DataType:=ppPasteOLEObject)\n    '//You can now change the .Left, .Top etc of oShape to place it where you want it.\nEnd With\n\n'//Get the save file name....\n'... your code here\noPresentation.SaveAs (SaveAsName)\noPresentation.Close\nppt.Quit\n</code></pre>\n\n<p>I either paste as a ppPasteEnhancedMetafile, ppPastePNG or ppPasteOLEObject.</p>\n\n<p>One key difference with what I am doing is that I am using the PowerPoint 16 object library, rather than just declaring my PowerPoint \"as Object\".</p>\n"}], "owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503464244, "creation_date": 1503459686, "last_edit_date": 1531164843, "question_id": 45830266, "link": "https://stackoverflow.com/questions/45830266/excel-vba-excel-range-to-just-opened-powerpoint", "title": "Excel VBA: Excel range to just opened powerpoint", "body": "<p>I have already the code to open a specific powerpoint template from a sharepoint. It already works. What I want next is to copy multiple ranges from different sheets to the first slide of the template of the newly opened powerpoint.  By the way, my sheets are 4 and each has defined ranges to copy. I would like it to paste on the same slide with different positions.</p>\n\n<p>Currently I only have this code to open the powerpoint template: </p>\n\n<pre><code>Sub SPPPT()\n\n'*************Open template in sharepoint*****************************\n\nDim FullTemplatePath As String\nSet PPApp = New PowerPoint.Application\nDim OperationalKPI As Worksheet\nSet OperationalKPI = Sheets(\"OperationalKPI\")\nDim mySlide As Object\nDim myShape As Object\nDim PowerPointApp As Object\nDim myPresentation As Object\n\nFullTemplatePath = \"FilePathofPowerpointTemplate/PPT Template.pptx\"\n\n'Open the PowerPoint template\nPPApp.Presentations.Open (FullTemplatePath)\n\nDim OperationalKPI As Worksheet\nSet OperationalKPI = Sheets(\"OperationalKPI\")\n\nSet rng = OperationalKPI.Range(\"KPIRange\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1503460805, "post_id": 45830228, "comment_id": 78618284, "body": "Show us the VBA code you made so far."}, {"owner": {"reputation": 47, "user_id": 8503540, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f5315eed215d767e9aab6cf9388ecde7?s=128&d=identicon&r=PG&f=1", "display_name": "ili_sophia", "link": "https://stackoverflow.com/users/8503540/ili-sophia"}, "reply_to_user": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1503461130, "post_id": 45830228, "comment_id": 78618347, "body": "Private Sub btnBrowse_Click()     Dim diag As Office.FileDialog     Dim item As Variant              Set diag = Application.FileDialog(msoFileDialogFilePicker)     diag.AllowMultiSelect = False     diag.Title = &quot;Please select an Excel Spreadsheet&quot;     diag.Filters.Clear     diag.Filters.Add &quot;Excel Spreadsheet&quot;, &quot;*.xls, *.xlsx&quot;          If diag.Show Then      For Each item In diag.SelectedItems             Me.txtFileName = item     Next     End If     End Sub"}, {"owner": {"reputation": 47, "user_id": 8503540, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f5315eed215d767e9aab6cf9388ecde7?s=128&d=identicon&r=PG&f=1", "display_name": "ili_sophia", "link": "https://stackoverflow.com/users/8503540/ili-sophia"}, "reply_to_user": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1503461179, "post_id": 45830228, "comment_id": 78618362, "body": "Private Sub btnImportSpreadsheet_Click()     Dim FSO As New FileSystemObject              If Nz(Me.txtFileName, &quot;&quot;) = &quot;&quot; Then         MsgBox &quot;Please select a file!&quot;         Exit Sub     End If          If FSO.FileExists(Nz(Me.txtFileName, &quot;&quot;)) Then          If MsgBox(&quot;Do you want to import this file?&quot;, vbYesNo) = vbYes Then      DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, &quot;Dyeing&quot;, Me.txtFileName, True     MsgBox &quot;File Imported&quot;          Else         MsgBox &quot;Please select file again&quot;          End If     End If                End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1503463646, "last_edit_date": 1503463646, "creation_date": 1503463208, "answer_id": 45830760, "question_id": 45830228, "link": "https://stackoverflow.com/questions/45830228/how-to-allow-users-to-select-excel-worksheet-they-wish-to-import-into-access-usi/45830760#45830760", "title": "How to allow users to select excel worksheet they wish to import into access using combo box?", "body": "<p>When user selected xls file, you need to read the list of worksheet names as described, for instance, <a href=\"https://stackoverflow.com/a/18413048/5339178\">here</a> and add those names to combobox: create a combobox with Row Source Type = <code>Value List</code> and add the list of names as string separated by coma to combobox <code>RowSource</code> property. In <code>AfterUpdate</code> combobox event import selected worksheet. Use Range parameter of TransferSpreadsheet function for worksheet selecting. Don't forget to add <code>!</code> to the end of worksheet name:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"Dyeing\", Me.txtFileName, True, strSelectedWorksheetName &amp; \"!\"\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8503540, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f5315eed215d767e9aab6cf9388ecde7?s=128&d=identicon&r=PG&f=1", "display_name": "ili_sophia", "link": "https://stackoverflow.com/users/8503540/ili-sophia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 45830760, "answer_count": 1, "score": -1, "last_activity_date": 1503463646, "creation_date": 1503459424, "last_edit_date": 1503462303, "question_id": 45830228, "link": "https://stackoverflow.com/questions/45830228/how-to-allow-users-to-select-excel-worksheet-they-wish-to-import-into-access-usi", "title": "How to allow users to select excel worksheet they wish to import into access using combo box?", "body": "<p>I have created a userform to import a single excel worksheet to a specific excel table. However, the workbook that i need to import contains multiple worksheets which are the 31 days of the month on each sheet. Is there a way to create a combo box on the user form to allow the user to select the worksheet they wish to import into the access table using VBA?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub btnBrowse_Click()\n    Dim diag As Office.FileDialog\n    Dim item As Variant\n\n    Set diag = Application.FileDialog(msoFileDialogFilePicker)\n    diag.AllowMultiSelect = False\n    diag.Title = \"Please select an Excel Spreadsheet\"\n    diag.Filters.Clear\n    diag.Filters.Add \"Excel Spreadsheet\", \"*.xls, *.xlsx\"\n    If diag.Show Then\n        For Each item In diag.SelectedItems\n            Me.txtFileName = item\n        Next\n    End If\nEnd Sub\n\nPrivate Sub btnImportSpreadsheet_Click()\n    Dim FSO As New FileSystemObject\n\n    If Nz(Me.txtFileName, \"\") = \"\" Then\n        MsgBox \"Please select a file!\"\n        Exit Sub\n    End If\n    If FSO.FileExists(Nz(Me.txtFileName, \"\")) Then\n        If MsgBox(\"Do you want to import this file?\", vbYesNo) = vbYes Then\n            DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"Dyeing\", Me.txtFileName, True\n            MsgBox \"File Imported\"\n        Else\n            MsgBox \"Please select file again\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "captcha"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503455744, "post_id": 45829347, "comment_id": 78617151, "body": "the web server probably serves up a different captcha each time there is a request for it. once by page load and the second time by the <code>.Insert</code> command. .... you could verify that by putting the captcha url in the web browser address bar and doing a refresh several times"}, {"owner": {"reputation": 1, "user_id": 8503231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X3rQOcIShAg/AAAAAAAAAAI/AAAAAAAAAQU/hgP7JDOJzjM/photo.jpg?sz=128", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/8503231/tomasz"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503570811, "post_id": 45829347, "comment_id": 78676320, "body": "Captcha url refreshed in new browser window changes picture text. So is there a way to write this code diffrently, that both requests to page are done from the same instance of IE ?"}, {"owner": {"reputation": 1, "user_id": 8503231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X3rQOcIShAg/AAAAAAAAAAI/AAAAAAAAAQU/hgP7JDOJzjM/photo.jpg?sz=128", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/8503231/tomasz"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503576175, "post_id": 45829347, "comment_id": 78680096, "body": "screen capture then crop it will be the only solution ?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503692428, "post_id": 45829347, "comment_id": 78737198, "body": "depends on what you are using it for. here is a direct way to get web data  .... may or may not work for you   .... you would have to find the captcha url in the html, download it, then formulate a response. (if the web page is built by java scripts, then it will not work)  <a href=\"https://stackoverflow.com/questions/45200247/web-scraping-across-multipages-without-even-knowing-the-last-page-number\" title=\"web scraping across multipages without even knowing the last page number\">stackoverflow.com/questions/45200247/&hellip;</a>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503692475, "post_id": 45829347, "comment_id": 78737216, "body": "are you able to share the URL to the web page that you are trying to reach?"}, {"owner": {"reputation": 1, "user_id": 8503231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X3rQOcIShAg/AAAAAAAAAAI/AAAAAAAAAQU/hgP7JDOJzjM/photo.jpg?sz=128", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/8503231/tomasz"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503714451, "post_id": 45829347, "comment_id": 78742076, "body": "i added url. As i sad code is working, so this code grab captcha url and captcha img. But img is diffrent on opened IE window."}, {"owner": {"reputation": 1, "user_id": 8503231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X3rQOcIShAg/AAAAAAAAAAI/AAAAAAAAAQU/hgP7JDOJzjM/photo.jpg?sz=128", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/8503231/tomasz"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503746061, "post_id": 45829347, "comment_id": 78748328, "body": "I added another code with different approach. I&#39;m doing here print screen then cropping image and pasting to range. It&#39;s ok not perfect but do the work. Not perfect is how image is pasted after cropping. It looks like paste location is calculated according to image size before cropping."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503791265, "post_id": 45829347, "comment_id": 78760100, "body": "i just checked the website. i right clicked the captcha and opened in new tab (using chrome browser). the captcha in the new tab was a different picture of the <b>same</b> captcha.. you can just download the captcha image from the image link. the text will be the same."}, {"owner": {"reputation": 1, "user_id": 8503231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X3rQOcIShAg/AAAAAAAAAAI/AAAAAAAAAQU/hgP7JDOJzjM/photo.jpg?sz=128", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/8503231/tomasz"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503889323, "post_id": 45829347, "comment_id": 78781226, "body": "In new tab yes, but in new window not anymore. I&#39;m telling you from the beginning that it looks like navigate to web address is done on diffrent instance of IE and .insert command is done on another instance of IE (new window). I dont know why is that, im not that good with vba excel, but anyway, i manage to do this with screenshot method."}], "owner": {"reputation": 1, "user_id": 8503231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X3rQOcIShAg/AAAAAAAAAAI/AAAAAAAAAQU/hgP7JDOJzjM/photo.jpg?sz=128", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/8503231/tomasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2041, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503888056, "creation_date": 1503452382, "last_edit_date": 1503888056, "question_id": 45829347, "link": "https://stackoverflow.com/questions/45829347/excel-vba-getting-captcha-bad-version-of-image", "title": "Excel VBA getting captcha - bad version of image", "body": "<p>i'm getting captcha image from webpage and inserting it to excel cell, then manually proceding this captcha by writing it to inputbox in excel, then excel pass this captcha text back to opened IE window. </p>\n\n<p>So every element of code works fine, but i'm getting one version of captcha image on opened IE window and diffrent one inserted to excel. </p>\n\n<p>Why is that ? It looks like diffrent instance of IE is opened and diffrent instance of IE was used for inserting captcha image to excel.</p>\n\n<pre><code>Sub Get_captcha()\nDim ie As New InternetExplorer\n\nie.Visible = True\nie.Navigate ActiveCell\n\nDo\nDoEvents\nLoop Until (ie.ReadyState = 4 And Not ie.Busy)\n\nDim doc As HTMLDocument\nSet doc = ie.Document\nDim MyInput As String\n\ncaptcha = doc.getElementById(\"MainContent_ctrlCaptcha\").getAttribute(\"src\")\nActiveCell.Offset(0, 2).Value = captcha\n\nWith ActiveSheet.Pictures\n .Insert (doc.getElementById(\"MainContent_ctrlCaptcha\").getAttribute(\"src\"))\nEnd With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Diffrent approach with screen capturing</p>\n\n<pre><code>Sub Get_captcha()\n Application.DisplayAlerts = False: Application.ScreenUpdating = False: Application.EnableEvents = False\n    On Error GoTo Cleanup\n\nDim clipboard As MSForms.DataObject\nSet clipboard = New MSForms.DataObject\nclipboard.Clear\n\nDim ie As New InternetExplorer\nie.Visible = True\nie.Navigate ActiveCell.Value\n\nDo\nDoEvents\nLoop Until ie.ReadyState = READYSTATE_COMPLETE\n\nDim doc As HTMLDocument\nSet doc = ie.Document\nDim MyInput As String\n\ncaptcha = doc.getElementById(\"MainContent_ctrlCaptcha\").getAttribute(\"src\")\nActiveCell.Offset(0, 2).Value = captcha\n\nSleep (500)\nApplication.SendKeys \"(%{1068})\"\nSleep (500)\nie.Quit\n\nDim shp As Shape\n\nActiveSheet.Paste Destination:=ActiveSheet.Range(ActiveCell.Offset(0, 0), ActiveCell.Offset(-12, -8)), link:=False\nWith ActiveSheet\nSet shp = .Shapes(.Shapes.Count)\n    shp.PictureFormat.CropRight = 500\n    shp.PictureFormat.CropBottom = 330\n    shp.PictureFormat.CropTop = 150\n    shp.PictureFormat.CropLeft = 278\nEnd With\n\nActiveCell.Offset(1).Select\n\nCleanup:\n    Application.DisplayAlerts = True: Application.ScreenUpdating = True: Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1503452871, "post_id": 45829305, "comment_id": 78616419, "body": "Instead of too many <code>If</code>&#39;s, consider that you don&#39;t have enough <code>End If</code>&#39;s. Each multiline <code>If</code> statement needs to terminate with <code>End If</code>.  I count 6 <code>If</code>&#39;s and only 4 <code>End If</code>&#39;s"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1503453979, "post_id": 45829305, "comment_id": 78616720, "body": "VBA will treat Next, Loop, End If, End With and End Select as one group when finding any of them missing. This frequently results in incorrect error messages, such as you have where the message says that the &quot;Next&quot; is missing whereas, in fact, it is an &quot;End If&quot;."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1503454199, "post_id": 45829305, "comment_id": 78616771, "body": "I think you wanted to use <code>ElseIf</code> statements, rather than an <code>Else</code> statement followed by an inner <code>If</code> statement.  (And, FWIW, your code inside each of the legs of the outer <code>If</code> seems to be identical, so I&#39;m not sure why you are using it.)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1503454866, "post_id": 45829305, "comment_id": 78616954, "body": "Why not indent your code logically? As illustrated by your question, failure to indent code properly, especially when the code involves nested control structures, is a recipe for disaster."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503456018, "post_id": 45829305, "comment_id": 78617207, "body": "clean up the code formatting (it is horrendous), and you will probably see the problem"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 5, "last_activity_date": 1503454979, "creation_date": 1503454979, "answer_id": 45829655, "question_id": 45829305, "link": "https://stackoverflow.com/questions/45829305/excel-vba-error-next-without-for-because-of-many-ifs/45829655#45829655", "title": "Excel VBA Error &quot;Next Without For&quot; Because Of Many IFs", "body": "<p>VBA intends to help avoid such errors as you have by supporting indenting. The logic you should try to implement would look like this:-</p>\n\n<pre><code>For n = 1 to 10\n    If 1 &lt;&gt; 2 Then\n        'enter code here\n    Else\n        Do\n            ' enter code here\n        Loop While 0 &lt;&gt; 0\n    End If\nNext n\n</code></pre>\n\n<p>I have rearranged your code according to the above principle. This is the result.</p>\n\n<pre><code>Private Sub FormattedCode()\n\n    Dim i As Integer\n    Dim RowTable As Integer\n\n    RowTable = Sheets(3).Range(\"A1\", (Range(\"A1\").End(xlDown))).Rows.Count\n\n\n    'loop\n\n\n    For i = 2 To RowTable\n\n        'SORTING DATA TO WORKBOOKS\n        'Oren, Karin, Noam\n        If Selection.Value = 1 Then             ' Oren\n\n            Selection.EntireRow.Cut\n            WB1.Activate\n            WB1.Sheets(1).Range(\"A1\").Offset(1, 0).Select\n\n            If Selection.Value = \"\" Then\n                Selection.PasteSpecial (xlPasteValues)\n            End If                      ' this I inserted\n        Else\n            Range(\"A1\").End(xlDown).Offset(1, 0).PasteSpecial (xlPasteValues)\n        End If\n'            Else                       ' this is illegal here\n\n        If Selection.Value = 2 Then             'Karin\n\n            Selection.EntireRow.Cut\n            WB1.Activate\n            WB1.Sheets(1).Range(\"A1\").Offset(1, 0).Select\n\n            If Selection.Value = \"\" Then\n                Selection.PasteSpecial (xlPasteValues)\n            End If                      ' this I inserted\n        Else\n            Range(\"A1\").End(xlDown).Offset(1, 0).PasteSpecial (xlPasteValues)\n        End If\n'            Else                       ' this is illegal here\n\n        If Selection.Value = 3 Then             ' Noam\n\n            Selection.EntireRow.Cut\n            WB1.Activate\n            WB1.Sheets(1).Range(\"A1\").Offset(1, 0).Select\n\n            If Selection.Value = \"\" Then\n                Selection.PasteSpecial (xlPasteValues)\n            End If                      ' this I inserted\n        Else\n            Range(\"A1\").End(xlDown).Offset(1, 0).PasteSpecial (xlPasteValues)\n        End If\n\n'        End If                         ' superfluous\n\n        'next row\n\n        mainWB.Activate\n        Sheets(3).Range(\"I2\").End(xlDown).Select\n\n        'i do the same procedure in the indirect manager workbooks as i did in the first workbook\n        'i will copy the names to a differen range and then remove duplicates\n        'then i will have a list of direct managers in each wb\n        'and i will name ech direct manager as a number and open a worksheet based on his name\n\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506185471, "creation_date": 1503452166, "last_edit_date": 1506185471, "question_id": 45829305, "link": "https://stackoverflow.com/questions/45829305/excel-vba-error-next-without-for-because-of-many-ifs", "title": "Excel VBA Error &quot;Next Without For&quot; Because Of Many IFs", "body": "<p>I have the following code and VBA is giving me a \"Next Without For\" Error when I definitely have both. I checked on the internet and understand that it is because of many ifs, can someone tell me where is my problem?</p>\n\n<p>i have 3 workbboks and I want that each row will be cut and copied into the right workbook acording to the nimber in column I.</p>\n\n<pre><code>     Dim i As Integer\n    Dim RowTable As Integer\n\nRowTable = Sheets(3).Range(\"A1\", (Range(\"A1\").End(xlDown))).Rows.count\n\n\n'loop\n\n\nFor i = 2 To RowTable\n\n'SORTING DATA TO WORKBOOKS\n\n\n\n'Oren, Karin, Noam\n\n'Oren\nIf Selection.Value = 1 Then\n\nSelection.EntireRow.Cut\nWB1.Activate\nWB1.Sheets(1).Range(\"A1\").Offset(1, 0).Select\n\n        If Selection.Value = \"\" Then\n        Selection.PasteSpecial (xlPasteValues)\n    Else\n        Range(\"A1\").End(xlDown).Offset(1, 0).PasteSpecial (xlPasteValues)\n        End If\n\n\n    Else\n\n'Karin\nIf Selection.Value = 2 Then\n\nSelection.EntireRow.Cut\nWB1.Activate\nWB1.Sheets(1).Range(\"A1\").Offset(1, 0).Select\n\n        If Selection.Value = \"\" Then\n        Selection.PasteSpecial (xlPasteValues)\n    Else\n        Range(\"A1\").End(xlDown).Offset(1, 0).PasteSpecial (xlPasteValues)\n        End If\n\n\n    Else\n\n'Noam\nIf Selection.Value = 3 Then\n\nSelection.EntireRow.Cut\nWB1.Activate\nWB1.Sheets(1).Range(\"A1\").Offset(1, 0).Select\n\n        If Selection.Value = \"\" Then\n        Selection.PasteSpecial (xlPasteValues)\n    Else\n        Range(\"A1\").End(xlDown).Offset(1, 0).PasteSpecial (xlPasteValues)\n        End If\n\n\n\n\nEnd If\n\n'next row\n\n  mainWB.Activate\n  Sheets(3).Range(\"I2\").End(xlDown).Select\n\n\n\n\n\n'i do the same procedure in the indirect manager workbooks as i did in the first workbook\n'i will copy the names to a differen range and then remove duplicates\n'then i will have a list of direct managers in each wb\n'and i will name ech direct manager as a number and open a worksheet based on his name\n\n\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6339257, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10153885120337562/picture?type=large", "display_name": "Alexander Song", "link": "https://stackoverflow.com/users/6339257/alexander-song"}, "edited": false, "score": 0, "creation_date": 1503453965, "post_id": 45829439, "comment_id": 78616716, "body": "you sir. are a legend."}], "tags": [], "owner": {"reputation": 88, "user_id": 6592447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6a44215d9ba1a35be221d775840033?s=128&d=identicon&r=PG&f=1", "display_name": "avplol", "link": "https://stackoverflow.com/users/6592447/avplol"}, "is_accepted": true, "score": 1, "last_activity_date": 1503453183, "creation_date": 1503453183, "answer_id": 45829439, "question_id": 45829152, "link": "https://stackoverflow.com/questions/45829152/would-like-to-adjust-the-shape-of-the-graph-and-positioning-when-copying-and-pas/45829439#45829439", "title": "Would like to adjust the shape of the graph and positioning when copying and pasting from excel to powerpoint", "body": "<p>Here we go, this should get you going. I've commented with \"-CHANGES MADE\" where I've made some changes. You can adjust the size in the code, and it will automatically centre.</p>\n\n<pre><code>Sub CreatePowerPoint()\n\n'Add a reference to the Microsoft PowerPoint Library by:\n'1. Go to Tools in the VBA menu\n'2. Click on Reference\n'3. Scroll down to Microsoft PowerPoint X.0 Object Library, check the box, and press Okay\n\n'First we declare the variables we will be using\n    Dim newPowerPoint As PowerPoint.Application\n    Dim activeSlide As PowerPoint.slide\n    Dim cht As Excel.ChartObject\n\n 'Look for existing instance\n    On Error Resume Next\n    Set newPowerPoint = GetObject(, \"PowerPoint.Application\")\n    On Error GoTo 0\n\n'Let's create a new PowerPoint\n    If newPowerPoint Is Nothing Then\n        Set newPowerPoint = New PowerPoint.Application\n    End If\n'Make a presentation in PowerPoint\n    If newPowerPoint.Presentations.Count = 0 Then\n        newPowerPoint.Presentations.Add\n    End If\n\n'Show the PowerPoint\n    newPowerPoint.Visible = True\n\n'Loop through each chart in the Excel worksheet and paste them into the PowerPoint\n    For Each cht In ActiveSheet.ChartObjects\n\n    'Add a new slide where we will paste the chart\n        newPowerPoint.ActivePresentation.Slides.Add newPowerPoint.ActivePresentation.Slides.Count + 1, ppLayoutText\n        newPowerPoint.ActiveWindow.View.GotoSlide newPowerPoint.ActivePresentation.Slides.Count\n        Set activeSlide = newPowerPoint.ActivePresentation.Slides(newPowerPoint.ActivePresentation.Slides.Count)\n\n    'Copy the chart and paste it into the PowerPoint as a Metafile Picture -CHANGES MADE\n        cht.Select\n        ActiveChart.ChartArea.Copy\n\n    'CHANGES MADE\n        Dim obj As Object\n        Set obj = activeSlide.Shapes.Paste\n\n   'Set the title of the slide the same as the title of the chart\n        activeSlide.Shapes(1).TextFrame.TextRange.Text = cht.Chart.ChartTitle.Text\n\n    'Adjust the positioning of the Chart on Powerpoint Slide -CHANGES MADE\n        obj.Width = 500 'Adjust width and height here\n        obj.Height = 300\n        With newPowerPoint.ActiveWindow.Presentation.PageSetup\n            obj.Left = (.SlideWidth \\ 2) - (obj.Width \\ 2)\n            obj.Top = (.SlideHeight \\ 2) - (obj.Height \\ 2)\n        End With\n\n    Next\n\nAppActivate (\"Microsoft PowerPoint\")\nSet activeSlide = Nothing\nSet newPowerPoint = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6339257, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10153885120337562/picture?type=large", "display_name": "Alexander Song", "link": "https://stackoverflow.com/users/6339257/alexander-song"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 45829439, "answer_count": 1, "score": 0, "last_activity_date": 1503453183, "creation_date": 1503450868, "question_id": 45829152, "link": "https://stackoverflow.com/questions/45829152/would-like-to-adjust-the-shape-of-the-graph-and-positioning-when-copying-and-pas", "title": "Would like to adjust the shape of the graph and positioning when copying and pasting from excel to powerpoint", "body": "<p>I am copying and pasting graphs from excel to powerpoint through a macro in VBA, however I'm not sure what the syntax for adjusting the shape and positioning the graphs in powerpoint is. I want to move the graph into the middle of the page and i need the shape smaller than what its pasted as. </p>\n\n<p>The code im using is: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub CreatePowerPoint()\r\n\r\n 'Add a reference to the Microsoft PowerPoint Library by:\r\n    '1. Go to Tools in the VBA menu\r\n    '2. Click on Reference\r\n    '3. Scroll down to Microsoft PowerPoint X.0 Object Library, check the box, and press Okay\r\n \r\n    'First we declare the variables we will be using\r\n        Dim newPowerPoint As PowerPoint.Application\r\n        Dim activeSlide As PowerPoint.slide\r\n        Dim cht As Excel.ChartObject\r\n     \r\n     'Look for existing instance\r\n        On Error Resume Next\r\n        Set newPowerPoint = GetObject(, \"PowerPoint.Application\")\r\n        On Error GoTo 0\r\n     \r\n    'Let's create a new PowerPoint\r\n        If newPowerPoint Is Nothing Then\r\n            Set newPowerPoint = New PowerPoint.Application\r\n        End If\r\n    'Make a presentation in PowerPoint\r\n        If newPowerPoint.Presentations.Count = 0 Then\r\n            newPowerPoint.Presentations.Add\r\n        End If\r\n     \r\n    'Show the PowerPoint\r\n        newPowerPoint.Visible = True\r\n    \r\n    'Loop through each chart in the Excel worksheet and paste them into the PowerPoint\r\n        For Each cht In ActiveSheet.ChartObjects\r\n        \r\n        'Add a new slide where we will paste the chart\r\n            newPowerPoint.ActivePresentation.Slides.Add newPowerPoint.ActivePresentation.Slides.Count + 1, ppLayoutText\r\n            newPowerPoint.ActiveWindow.View.GotoSlide newPowerPoint.ActivePresentation.Slides.Count\r\n            Set activeSlide = newPowerPoint.ActivePresentation.Slides(newPowerPoint.ActivePresentation.Slides.Count)\r\n                \r\n        'Copy the chart and paste it into the PowerPoint as a Metafile Picture\r\n            cht.Select\r\n            ActiveChart.ChartArea.Copy\r\n            activeSlide.Shapes.PasteSpecial(DataType:=ppPasteMetafilePicture).Select\r\n            \r\n    '   'Set the title of the slide the same as the title of the chart\r\n            activeSlide.Shapes(1).TextFrame.TextRange.Text = cht.Chart.ChartTitle.Text\r\n        \r\n            \r\n        'Adjust the positioning of the Chart on Powerpoint Slide\r\n            newPowerPoint.ActiveWindow.Selection.ShapeRange.Left = 15\r\n            newPowerPoint.ActiveWindow.Selection.ShapeRange.Top = 125\r\n        \r\n            activeSlide.Shapes(2).Width = 200\r\n            activeSlide.Shapes(2).Left = 505\r\n            \r\n        Next\r\n     \r\n    AppActivate (\"Microsoft PowerPoint\")\r\n    Set activeSlide = Nothing\r\n    Set newPowerPoint = Nothing\r\n     \r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "save"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1503449621, "post_id": 45828924, "comment_id": 78615790, "body": "Your question has nothing to do with <i>networking</i> or <i>directory</i>. It has to do with using <code>GetSaveAsFilename</code>. Please <a href=\"https://stackoverflow.com/posts/45828924/edit\">edit</a> to remove the non-applicable tags and add one for the language you&#39;re using (VBA?); it will vastly improve your chances of getting help if you tag it properly. Read the descriptions of tags before just randomly adding those that sound familiar - tags have specific meanings here."}, {"owner": {"reputation": 269, "user_id": 8256025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69c80e3d017854fbc9d4449f49d95fd?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/8256025/kevin"}, "edited": false, "score": 0, "creation_date": 1503450718, "post_id": 45828924, "comment_id": 78615998, "body": "You could try mapping the path to a drive letter."}, {"owner": {"reputation": 31, "user_id": 8218632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a77bfcc06584e793d7941cc54bf3c1?s=128&d=identicon&r=PG&f=1", "display_name": "Sergiy Mykhaylenko", "link": "https://stackoverflow.com/users/8218632/sergiy-mykhaylenko"}, "edited": false, "score": 0, "creation_date": 1503470305, "post_id": 45828924, "comment_id": 78621805, "body": "Unfortunately I am trying to avoid mapping to a drive and using ChDr function so this is not a solution... I am trying to figure out why my network path isn&#39;t parsing."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8218632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a77bfcc06584e793d7941cc54bf3c1?s=128&d=identicon&r=PG&f=1", "display_name": "Sergiy Mykhaylenko", "link": "https://stackoverflow.com/users/8218632/sergiy-mykhaylenko"}, "edited": false, "score": 0, "creation_date": 1503484848, "post_id": 45833601, "comment_id": 78631852, "body": "The funny thing is, GetSaveAsFilename opens the right network path on my PC but goes to My Documents on my users&#39; PC. But they can open/access the path manually in Windows Explorer..."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1503474229, "creation_date": 1503474229, "answer_id": 45833601, "question_id": 45828924, "link": "https://stackoverflow.com/questions/45828924/getsaveasfilename-always-opens-in-my-documents/45833601#45833601", "title": "GetSaveAsFilename() ALWAYS opens in My Documents", "body": "<p>Some remarks:</p>\n\n<ul>\n<li>There is no need to do a Change Dir before calling  </li>\n<li>I just did some\ntests and <code>GetSaveAsFilename</code> works perfectly when you pass a valid\nfolder or file in UNC notation. </li>\n<li>I have the suspicion that your\nnetwork path is invalid. Are you sure that the network path is\ncorrect (can you open the explorer with this path) ?</li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 8218632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a77bfcc06584e793d7941cc54bf3c1?s=128&d=identicon&r=PG&f=1", "display_name": "Sergiy Mykhaylenko", "link": "https://stackoverflow.com/users/8218632/sergiy-mykhaylenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503474229, "creation_date": 1503448983, "last_edit_date": 1503470188, "question_id": 45828924, "link": "https://stackoverflow.com/questions/45828924/getsaveasfilename-always-opens-in-my-documents", "title": "GetSaveAsFilename() ALWAYS opens in My Documents", "body": "<p>I have a problem with getting GetSaveAsFileName() function to open Save dialogue box in a Network drive instead of always opening in my documents.\n Basically, I have implemented a workaround to change path to a network drive via:</p>\n\n<p>Top of my working module:</p>\n\n<pre><code> Private Declare Function SetCurrentDirectoryA Lib _\n \"kernel32\" (ByVal lpPathName As String) As Long\n\n Sub ChDirNet(szPath As String)\n Dim lReturn As Long\n lReturn = SetCurrentDirectoryA(szPath)\n If lReturn = 0 Then Err.Raise vbObjectError + 1, \"Error setting path.\"\n End Sub\n</code></pre>\n\n<p>In my SaveAs() module the following code:</p>\n\n<pre><code> ChDirNet \"\\\\test\\input\"\n xFileName = Application.GetSaveAsFilename(\"\\\\test\\input\\filename.xls\")\n</code></pre>\n\n<p>However, I STILL can not get the save as dialogue box to open in the \\test\\input network path.</p>\n\n<p>Can someone please advice?</p>\n\n<p>Any help would be appreciated!</p>\n\n<p>Thank you kindly. </p>\n"}, {"tags": ["vba", "excel", "compilation", "basic"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1503450819, "post_id": 45828904, "comment_id": 78616013, "body": "you probably want <code>Range(&quot;C10:C19, D10:D19, E10:E19&quot;)</code> which is same as <code>Range(&quot;C10:E19&quot;)</code>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1503451946, "post_id": 45828904, "comment_id": 78616222, "body": "the <code>range</code> object expects one or two <i>arguments</i> (input values). you had three."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503452299, "post_id": 45828904, "comment_id": 78616290, "body": "one way to learn which cells a range object covers, is to use the <i>immediate window</i>  .... in VBE editor press ctrl-G and it should show up .... now resize the VBE editor so that you can see the worksheet and the immediate window .... then type into immediate window <code>range(&quot;b3&quot;).select</code> and press enter ... you should see cell B3 selected .... try others ... <code>range(&quot;b5:d7&quot;).select</code> ... <code>range(&quot;b5:d7, a1:a3, a6&quot;).select</code>  ... <code>range(&quot;b5:d7, a1:a3, a6&quot;).Offset(1).select </code> ... <code>range(&quot;b5:d7, a1:a3, a6&quot;).Offset(2,3).select</code>  and so on"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503452579, "post_id": 45828904, "comment_id": 78616348, "body": "you can double-click the titlebar of the immediate window (where it says &quot;immediate&quot;) and it will detach from the VBA editor. doubleclick again to reattach"}, {"owner": {"reputation": 13, "user_id": 8503164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a3a005c2c1758a50d4a321ea8ba4ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/8503164/joel"}, "edited": false, "score": 0, "creation_date": 1503454225, "post_id": 45828904, "comment_id": 78616777, "body": "Thank you guys for your help, helped clarify things very easily!"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1503452037, "last_edit_date": 1503452037, "creation_date": 1503451460, "answer_id": 45829220, "question_id": 45828904, "link": "https://stackoverflow.com/questions/45828904/compile-error-saying-wrong-number-of-arguments-or-invalid-property-assignment/45829220#45829220", "title": "Compile error saying &quot;wrong number of arguments or invalid property assignment&quot;", "body": "<p><em>Try this</em></p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    If Not Intersect(Target, [C10:C19, D10:D19, E10:E19]) Is Nothing Then\n        Cancel = True\n        Target.Formula = Date\n    End If\nEnd Sub\n</code></pre>\n\n<p><em><code>\"C10:C19\", \"D10:D19\", \"E10:E19\"</code> Range should be one string not multiple strings</em> <br> <em>Examnple</em> <code>\"C10:C19, D10:D19, E10:E19\"</code></p>\n"}], "owner": {"reputation": 13, "user_id": 8503164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a3a005c2c1758a50d4a321ea8ba4ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/8503164/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2049, "favorite_count": 0, "accepted_answer_id": 45829220, "answer_count": 1, "score": 1, "last_activity_date": 1503452037, "creation_date": 1503448751, "last_edit_date": 1503451430, "question_id": 45828904, "link": "https://stackoverflow.com/questions/45828904/compile-error-saying-wrong-number-of-arguments-or-invalid-property-assignment", "title": "Compile error saying &quot;wrong number of arguments or invalid property assignment&quot;", "body": "<p>I have code that populates cells when double clicked on the cell. Here it is:  </p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)  \n    If Not Intersect(Target, Range(\"C10:C19\", \"D10:D19\", \"E10:E19\")) Is Nothing Then  \n        Cancel = True  \n        Target.Formula = Date  \n    End If  \nEnd Sub  \n</code></pre>\n\n<p>The code was working fine until I added <code>\"E10:E19\"</code> then it gives me a compile error saying <code>wrong number of arguments or invalid property assignments</code> and then it highlights the first line of code <code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)</code></p>\n\n<p>Full disclosure: I am a total noob at this so any fixes or advice please explain like I am 5 years old.</p>\n"}, {"tags": ["vba", "excel", "loops", "range"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1503447229, "post_id": 45828572, "comment_id": 78615286, "body": "&quot;I have failed miserably so far.. to find answers to my question on SO&quot;. Looking at your profile, you hardly ever accept any answer."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1503450499, "post_id": 45828572, "comment_id": 78615949, "body": "I see that you are using my answer in this code.  Yet you did not accept my answer."}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1503467223, "post_id": 45828572, "comment_id": 78620304, "body": "@ScottCraner I upvoted the comment :) its was really helpful! how can I accept it besides upvoting?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1503491123, "post_id": 45828572, "comment_id": 78636535, "body": "@PericlesFaliagas on your last question since you obviosly think I gave the correct answer you would click the check mark by the answer accepting it as correct.  You should go back through all your questions and mark the correct answer.  People will stop helping without that feedback."}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1503518063, "post_id": 45828572, "comment_id": 78654686, "body": "I am sorry my friend! I didnt do it on purpose.. I didnt even know that there was such thing besides upvoting for something! I might have done what you said but definitely by mistake, so I wasnt aware of this thing existing. I willl give you feedback right away!.. sorry!"}], "answers": [{"tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1503454976, "last_edit_date": 1503454976, "creation_date": 1503451630, "answer_id": 45829246, "question_id": 45828572, "link": "https://stackoverflow.com/questions/45828572/creating-a-loop-for-a-range-of-rows-for-a-code-that-runs-for-a-single-row/45829246#45829246", "title": "Creating a loop for a range of rows for a code that runs for a single row", "body": "<p>In order to generalize your code you need to move away from absolute addresses somehow.  One way is to assign ranges and then offset them as needed to get to the positions you need. The code below runs through <code>numNeeded</code> number of times and keeps adding directly below as you mention.  I don't know anything about the source data after the first time through so it just repeats the first set of data right now.  But you can draw new data from different sheets or use offsets on the source sheet to grab new data for each time through. I've put many <code>r.select</code> statements in the code so that you can step through and easily see what the code is doing, but these should be removed once you understand.</p>\n\n<pre><code>Sub reportGen()\n  Dim destSh As Worksheet, sourceSh As Worksheet\n  Dim sourceR1 As Range, sourceR2 As Range\n  Dim r As Range, pasteR As Range\n  Const numNeeded = 10\n  Set sourceSh = Worksheets(\"CW33 17\")\n  Set sourceR1 = sourceSh.Range(\"D2:E2\")\n  Set sourceR2 = sourceSh.Range(\"G2:L2\")\n  Set destSh = Worksheets(\"RCCP INPUT\")\n  Set r = destSh.Range(\"A1\").Offset(7 * j, 0)\n  r.Select\n  r.Offset(0, 2) = \"T-Lane ID\"\n  r.Offset(0, 3) = \"Week of RCCP\"\n  r.Offset(0, 4) = \"Forecast\"\n  r.Offset(0, 5) = \"Forecast Quantity\"\n  For j = 0 To numNeeded\n    Set r = destSh.Range(\"A2\").Offset(j * 6, 0)\n    r.Select\n    sourceR1.Copy\n    destSh.Paste\n    Set pasteR = Selection\n    pasteR.AutoFill destSh.Range(pasteR, pasteR.Offset(5, 0))\n    Set r = r.Offset(0, 2)\n    r.Select\n    r.FormulaR1C1 = \"=CONCATENATE(RC[-2],RC[-1])\"\n    r = r.Value\n    r.AutoFill destSh.Range(r, r.Offset(5, 0))\n    Set r = r.Offset(0, 3)\n    r.Select\n    sourceR2.Copy\n    r.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\n    Set r = r.Offset(0, -1)\n    r.Select\n    For i = 1 To 6\n      r.Offset(i - 1, 0) = \"Week +\" &amp; i\n    Next i\n    r = sourceR2(1) - 1\n    r.AutoFill destSh.Range(r, r.Offset(5, 0))\n    r.Select\n  Next j\nEnd Sub\n</code></pre>\n\n<p>(By the way, I think there might be a mistake starting after your <code>For Each cell...</code> loop since it writes over data, but I wasn't sure so just kept it the way you have it)</p>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1503454976, "creation_date": 1503446050, "question_id": 45828572, "link": "https://stackoverflow.com/questions/45828572/creating-a-loop-for-a-range-of-rows-for-a-code-that-runs-for-a-single-row", "title": "Creating a loop for a range of rows for a code that runs for a single row", "body": "<p>I am building a macro which will create an automatic report (the name of the report sheet is \"RCCP INPUT\"), by extracting data from another worksheet (source which is named \"CW33 17\"). I have build the code that runs for a single row of the source sheet, so it creates the report for only one row (every row represents an order). I want to have a report for a range of rows so I need to extend my code to apply for a range of rows. So, lets say that this range is called myRange and it includes rows 2 to 70. So, my report must have all these rows. My code is provided below. I have included the headers too, so the report starts from row 2. The row that the macro runs for, for now is row 2. Just to clarify it more, the report must have each row that is selected from the source  multiplied by 6 (6 copies, one below the other) as it can be seen from the macro below, because in the Forecast column and Forecast Quantity column, each order(row) must have values for 6 weeks. I hope I have clarified it well! Any ideas how to make it work?.. I have failed miserably so far.. Much appreciated!</p>\n\n<p>The report looks like this (for one row - as it is multiplied by 6) and the other rows should be placed in the same way underneath.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kBkJu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kBkJu.png\" alt=\"Report interface for one row\"></a></p>\n\n<pre><code>Sub RCCP_INPUT()\n\nSheets(\"RCCP INPUT\").Select\n\n    range(\"C1\").Value = \"T-Lane ID\"                    'Column C\n    range(\"D1\").Value = \"Week of RCCP\"                 'Column D\n    range(\"E1\").Value = \"Forecast\"                     'Column E\n    range(\"F1\").Value = \"Forecast Quantity\"            'Column F\n\n    Sheets(\"CW33 17\").Select\n    range(\"D2:E2\").Copy\n    Sheets(\"RCCP INPUT\").Select\n    range(\"A2\").Select\n    ActiveSheet.Paste\n    Dim rws As Long\n    With range(\"A2:B2\")\n    rws = .Rows.Count\n    .Resize(rws).Copy Destination:=.Offset(rws).Resize(rws * 5)\n    End With\n    range(\"C2\").Select\n    ActiveCell.FormulaR1C1 = \"=CONCATENATE(RC[-2],RC[-1])\"\n    ActiveCell.Value = ActiveCell.Value\n    With range(\"C2\")\n    rws = .Rows.Count\n    .Resize(rws).Copy Destination:=.Offset(rws).Resize(rws * 5)\n    End With\n    Sheets(\"CW33 17\").Select\n    range(\"G2:L2\").Select\n    Selection.Copy\n    Sheets(\"RCCP INPUT\").Select\n    range(\"F2:F7\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone,   SkipBlanks:=False, Transpose:=True\n    Sheets(\"RCCP INPUT\").Select\n    i = 1\n    For Each cell In range(\"E2:E7\")\n        cell.Value = \"Week +\" &amp; i\n        i = i + 1\n    Next cell\n    Sheets(\"RCCP INPUT\").Select\n    range(\"E2\").Value = Sheets(\"CW33 17\").range(\"G2\").Value - 1\n    With range(\"E2\")\n    rws = .Rows.Count\n    .Resize(rws).Copy Destination:=.Offset(rws).Resize(rws * 5)\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "csv", "ms-access", "import"], "comments": [{"owner": {"reputation": 5714, "user_id": 342669, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5LVIK.jpg?s=128&g=1", "display_name": "Mick", "link": "https://stackoverflow.com/users/342669/mick"}, "edited": false, "score": 1, "creation_date": 1503449671, "post_id": 45828323, "comment_id": 78615797, "body": "I&#39;d say unless you are going to consider switching to SQL Server or SQL Server Express, you probably don&#39;t have many options other than to get a coffee whilst you wait.  If you were using SQL Server you could use Bulk Insert which is very fast."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1503470085, "post_id": 45828323, "comment_id": 78621666, "body": "What other methods have you tried? There is <code>DoCmd.TransferSpreadsheet</code> and <code>DoCmd.RunSavedImportExport</code>, the latter should be equivalent to doing the import manually."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8502796, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q2Hxwvx8ZWo/AAAAAAAAAAI/AAAAAAAAszw/6peLWnewFso/photo.jpg?sz=128", "display_name": "Eugene B", "link": "https://stackoverflow.com/users/8502796/eugene-b"}, "edited": false, "score": 0, "creation_date": 1503549432, "post_id": 45831089, "comment_id": 78663948, "body": "i tried this code but i am getting error 128 and vba simply skips the line of import"}, {"owner": {"reputation": 33, "user_id": 8502796, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q2Hxwvx8ZWo/AAAAAAAAAAI/AAAAAAAAszw/6peLWnewFso/photo.jpg?sz=128", "display_name": "Eugene B", "link": "https://stackoverflow.com/users/8502796/eugene-b"}, "edited": false, "score": 0, "creation_date": 1503549532, "post_id": 45831089, "comment_id": 78663978, "body": "compactfile = &quot;filepath\\Backend\\MOAQ2017_be.accdb&quot; moaqdate = &quot;8/22/2017&quot; On Error Resume Next &#39;removing older tab files accesspath = &quot;filepath\\Backend\\&quot; filenametotab = &quot;MOAQ_2017_REPORT_20170725.txt&quot; Strfilename = accesspath &amp; filenametotab   Set db = OpenDatabase(compactfile) db.Execute &quot;DELETE * FROM [MOAQ]&quot;   db.Execute (&quot;insert INTO [MOAQ] select #&quot; &amp; moaqdate &amp; &quot;# as importdate, * &quot; &amp; _     &quot;FROM [Text;HDR=YES,FMT=TabDelimited;Database=&quot; &amp; accesspath &amp; &quot;].[&quot; &amp; filenametotab &amp; &quot;]&quot;), dbFailOnError db.Close"}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 33, "user_id": 8502796, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q2Hxwvx8ZWo/AAAAAAAAAAI/AAAAAAAAszw/6peLWnewFso/photo.jpg?sz=128", "display_name": "Eugene B", "link": "https://stackoverflow.com/users/8502796/eugene-b"}, "edited": false, "score": 0, "creation_date": 1503553250, "post_id": 45831089, "comment_id": 78665269, "body": "Remove <code>On Error Resume Next</code>, provide full text of error. Looks like text file has invalid column names. Also there may be a problem with SQL text. Dump SQL text to Immediate window using Debug.Pring and try to &quot;run&quot; it query builder"}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1503465207, "creation_date": 1503465207, "answer_id": 45831089, "question_id": 45828323, "link": "https://stackoverflow.com/questions/45828323/faster-tab-delimited-import-of-large-file-access-vba/45831089#45831089", "title": "faster tab delimited import of large file access vba", "body": "<p>I would do something like this:</p>\n\n<pre><code>compactfile = accdbfilepath\nsrcfile = \"filepath\\empty_MOAQ_table_only_be.accdb\"\ndestinationfile = \"filepath\\MOAQ_table_be.accdb\"\nmoaqdate = \"8/22/2017\"\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nFSO.CopyFile srcfile, destinationfile, True\nSet db = OpenDatabase(destinationfile)\ndb.Execute (\"insert INTO [MOAQ] select #\" &amp; moaqdate &amp; \"# as importdate, * \" &amp; _\n    \"FROM [Text;HDR=YES,FMT=TabDelimited;Database=\" &amp; accesspath &amp; \"].[\" &amp; filenametotab &amp; \"]\"), dbFailOnError\ndb.Close\nSet FSO = Nothing\n</code></pre>\n\n<p>In this case you won't need to copy file with data twice, delete the data, do compact &amp; repair and update the date.</p>\n\n<p>Separate your big table into dedicated backend with just one table, create a copy of this file with empty table (empty_MOAQ_table_only_be.accdb) and copy it over existing dedicated backend instead of double coping big files, deleting and c&amp;r.</p>\n\n<p>You can insert update date at the same time with file data, no need to update. </p>\n\n<p>It should work much faster.</p>\n"}], "owner": {"reputation": 33, "user_id": 8502796, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q2Hxwvx8ZWo/AAAAAAAAAAI/AAAAAAAAszw/6peLWnewFso/photo.jpg?sz=128", "display_name": "Eugene B", "link": "https://stackoverflow.com/users/8502796/eugene-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1503672751, "creation_date": 1503443691, "last_edit_date": 1503453610, "question_id": 45828323, "link": "https://stackoverflow.com/questions/45828323/faster-tab-delimited-import-of-large-file-access-vba", "title": "faster tab delimited import of large file access vba", "body": "<p>I have a .tab file which is 176mb with 780k records which I have to load to Access every day and delete old data. I also want to have ImportDate in the same table.</p>\n\n<p>I've tried different methods of importing and it's been really slow. With DAO it took about 14 minutes to import and insert date. I tried with DoCmd but it took just as slow, if not more. I can't delete the table but need to insert into it because access does not set the properties for the fields accurately. I also figured out that I need to compact database every time or it's getting big.</p>\n\n<p>What can I do to import the file faster? Doing it manually doesn't take that long.</p>\n\n<p>Here is what I've tried:</p>\n\n<pre><code>compactfile = accdbfilepath\nsrcfile = \"filepath\\filename2017_be.accdb\"\nmoaqdate = \"8/22/2017\"\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nfso.CopyFile srcfile, compactfile\nSet db = OpenDatabase(compactfile)\ndb.Execute \"DELETE * FROM [MOAQ]\"\ndb.Execute (\"insert INTO [MOAQ] select * FROM \n[Text;HDR=YES,FMT=TabDelimited;Database=\" &amp; accesspath &amp; \"].[\" &amp; \nfilenametotab &amp; \"]\"), dbFailOnError\ndb.Execute \"update [MOAQ] set importdate =(\"\"\" &amp; moaqdate &amp; \"\"\")\"\ndb.Close\n\ndestinationfile = \"filepath\\filename2017_be.accdb\"\nApplication.CompactRepair compactfile, destinationfile\n\n\nfso.CopyFile destinationfile, srcfile\nKill destinationfile\nSet fso = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1503446036, "creation_date": 1503446036, "answer_id": 45828569, "question_id": 45828215, "link": "https://stackoverflow.com/questions/45828215/convert-an-embedded-excel-picture-into-an-object/45828569#45828569", "title": "Convert an embedded Excel Picture into an Object", "body": "<p>maybe use base64 </p>\n\n<p><a href=\"https://stackoverflow.com/questions/39126617/inserting-an-image-into-a-sheet-using-base64-in-vba#39222080\">Inserting an Image into a sheet using Base64 in VBA?</a></p>\n\n<p><a href=\"https://www.base64-image.de/\" rel=\"nofollow noreferrer\">https://www.base64-image.de/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8213156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4f22850cc96692664b2d91799499690?s=128&d=identicon&r=PG&f=1", "display_name": "BruceBadeau", "link": "https://stackoverflow.com/users/8213156/brucebadeau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 549, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503446036, "creation_date": 1503442971, "last_edit_date": 1503445017, "question_id": 45828215, "link": "https://stackoverflow.com/questions/45828215/convert-an-embedded-excel-picture-into-an-object", "title": "Convert an embedded Excel Picture into an Object", "body": "<p>I created a logo in Publisher.\nUsing TechSmith Snagit, I captured the image and saved as a JPEG.\nI fetched the image inside of Excel and placed it in a properly sized cell(s)</p>\n\n<p>I don't want to have a file that has the image (have seen in researching some solutions) -- Nevertheless, everything must be self-contained in my Excel vba Application.</p>\n\n<p>Excel (2013) has a tendency to either erase the image or it creeps when the app is opened on other displays. (And it does this with ActiveX Controls, too)</p>\n\n<p>So... a friend wrote code that stretches or centers ActiveX Controls inside cells.  Works brilliantly, except I want to apply the code to the Picture (say Picture 12) ... the Logo ... </p>\n\n<p>If I could convert the Picture into an Object (similar to a CommandButton or a SpinButton, I think the code would work.</p>\n\n<p>My work around had been to insert the logo as a BitMap into a CommandButton, and then apply the stretching code to the button... BUT I have image size limitations and the Bitmap is of low resolution, which makes my beautiful logo look terrible.  </p>\n\n<p>Any suggestions would be very much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1503442536, "post_id": 45828123, "comment_id": 78614245, "body": "Just add a hyperlink on that name."}], "owner": {"reputation": 11, "user_id": 8502935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1bc4eed89e0d2af7e6986a877873c5?s=128&d=identicon&r=PG&f=1", "display_name": "ggggg", "link": "https://stackoverflow.com/users/8502935/ggggg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1503453767, "creation_date": 1503442104, "last_edit_date": 1531164843, "question_id": 45828123, "link": "https://stackoverflow.com/questions/45828123/navigation-buttons-within-other-subs", "title": "Navigation Buttons within Other Subs", "body": "<p>I have built a macro that does the following: My first sheet contains a list of names. Every time I run the macro, a name is added to the list and a new sheet is created. I would now like to, in the same macro, be able to create a button next to each new name every time I add a name that will allow me to navigate to the new sheet since I will be adding many of these. Do you have a suggestion for how I should do this?</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 908, "user_id": 2322977, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/49c196ad6e4365c8f219c89030597728?s=128&d=identicon&r=PG", "display_name": "ainwood", "link": "https://stackoverflow.com/users/2322977/ainwood"}, "edited": false, "score": 0, "creation_date": 1503442025, "post_id": 45827510, "comment_id": 78614136, "body": "The answer below obviously gives you the code you need.  But purely as a FYI, the problem with your code above is that you don&#39;t need the <code>i=i+1</code>.  The incrementing is managed by the `For i = 1 to 6&#39; and &#39;next i&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1503439007, "post_id": 45827539, "comment_id": 78613242, "body": "i starts counting from 0.. can I make it start from 1 because first week appears as Week + (empty)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1503439122, "last_edit_date": 1503439122, "creation_date": 1503438650, "answer_id": 45827539, "question_id": 45827510, "link": "https://stackoverflow.com/questions/45827510/how-to-create-a-loop-inside-a-loop-vba/45827539#45827539", "title": "How to create a loop inside a loop vba", "body": "<p>You only need the one loop:</p>\n\n<pre><code>Sub INPT()\n    With Sheets(\"1\")\n        i = 1\n        For Each cell In .Range(\"D2:D7\")\n            cell.Value = \"Week +\" &amp; i\n            i = i + 1\n        Next cell\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 45827539, "answer_count": 1, "score": 1, "last_activity_date": 1503439434, "creation_date": 1503438505, "last_edit_date": 1503439434, "question_id": 45827510, "link": "https://stackoverflow.com/questions/45827510/how-to-create-a-loop-inside-a-loop-vba", "title": "How to create a loop inside a loop vba", "body": "<p>I am trying to create this loop inside the loop so as to print inside the cells in the below range -> Week <code>i</code> where <code>i</code> is from 1 to 6 and it raises by one each time we move to a cell down... </p>\n\n<p>So, in this case, for <code>D2</code> I want Week 1, For <code>D3</code> Week 2 etc.. Any ideas? I appreciate your time!</p>\n\n<pre><code> Sub INPUT()\n        Sheets(\"1\").Select \n        For Each cell In range(\"D2:D7\")\n        For i = 1 To 6\n        cell.Value = \"Week +\" &amp; i\n        i = i + 1\n        Next i\n        Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "excel", "variables", "excel-r1c1-notation"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8502703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0589b5283f832a9d2dd95b5967b10fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Campbesj", "link": "https://stackoverflow.com/users/8502703/campbesj"}, "edited": false, "score": 0, "creation_date": 1503488225, "post_id": 45827459, "comment_id": 78634337, "body": "Thank you Scott! The second option you suggested worked perfectly!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1503438702, "last_edit_date": 1503438702, "creation_date": 1503438340, "answer_id": 45827459, "question_id": 45827235, "link": "https://stackoverflow.com/questions/45827235/variable-string-in-formula-r1c1/45827459#45827459", "title": "Variable String in Formula R1C1", "body": "<p><code>CEText</code> is not need when you are equating and since CE is a number, we only need to worry about removing from formula string and concatenating:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n\"=SUMIFS(R[-209]C8:R[1]C8,R[-209]C1:R[1]C1,\" &amp; CE &amp; \",R[-209]C2:R[1]C2,\"\"&lt;&gt;Summary\"\")*(1+R1C16)\"\n</code></pre>\n\n<p>If you want <code>CEText</code> then we do the extra quotes in the formula:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n\"=SUMIFS(R[-209]C8:R[1]C8,R[-209]C1:R[1]C1,\"\"\" &amp; CEText &amp; \"\"\",R[-209]C2:R[1]C2,\"\"&lt;&gt;Summary\"\")*(1+R1C16)\"\n</code></pre>\n\n<p>The main issue is that any vba variable must be outside the quotes and concatenated with <code>&amp;</code></p>\n"}], "owner": {"reputation": 3, "user_id": 8502703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0589b5283f832a9d2dd95b5967b10fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Campbesj", "link": "https://stackoverflow.com/users/8502703/campbesj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1658, "favorite_count": 0, "accepted_answer_id": 45827459, "answer_count": 1, "score": 0, "last_activity_date": 1503438702, "creation_date": 1503437227, "question_id": 45827235, "link": "https://stackoverflow.com/questions/45827235/variable-string-in-formula-r1c1", "title": "Variable String in Formula R1C1", "body": "<p>I am trying to create a formula using R1C1 format that will change based on a string containing a variable. I have tried creating the string and inputting it in the formula, as well as creating the string in the formula and none seems to work. Below is my code:</p>\n\n<pre><code>Dim NewXX As Integer\nDim NewXX1 As Integer\nDim CE As Integer\nDim PrevCE As Integer\nDim CEText As String\n\nCE = Cells(NewXX - 1, 1).Value + 1\nCEText = \"=\" &amp; CE\n\nActiveCell.FormulaR1C1 = _\n\"=SUMIFS(R[-209]C8:R[1]C8,R[-209]C1:R[1]C1,CEText,R[-209]C2:R[1]C2,\"\"&lt;&gt;Summary\"\")*(1+R1C16)\"\n</code></pre>\n\n<p>CEText is the variable that will change every time the macro is run. A few things I have tried:\nCEText\n\"\"CEText\"\",\n'\"&amp;CEText&amp;\"',\n\"CEText\",\n\"\"=\"\"\"&amp;CE&amp;\",\n\"\"=\"\"CE,</p>\n\n<p>All of these trials either give me an 'Expected: end of statement' error, or the formula displayed in the cells matches the text (not value) found in the code.</p>\n\n<p>Any help would be greatly appreciated! I am fairly new to VBA and am always up for learning a better way to do things!\nThanks!</p>\n"}, {"tags": ["vba", "vbscript", "outlook", "outlook-form"], "comments": [{"owner": {"reputation": 1, "user_id": 6722611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ad3bdb1e4cd2aa1e1238a21a9830927?s=128&d=identicon&r=PG&f=1", "display_name": "Rami ", "link": "https://stackoverflow.com/users/6722611/rami"}, "edited": false, "score": 0, "creation_date": 1503437941, "post_id": 45827136, "comment_id": 78612844, "body": "On an off note - I&#39;m under the impression that a VBA code cannot be executed in outlook through a command button. If I&#39;m wrong please let me know as I prefer using VBA much more. Thanks!"}, {"owner": {"reputation": 322, "user_id": 3330093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0C2vx.jpg?s=128&g=1", "display_name": "KS7X", "link": "https://stackoverflow.com/users/3330093/ks7x"}, "edited": false, "score": 1, "creation_date": 1503443591, "post_id": 45827136, "comment_id": 78614514, "body": "Which part of your code specifies the location of where the meeting will go?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1503459314, "post_id": 45827136, "comment_id": 78617923, "body": "Is it shared calendar? you need to specify the calendar name-"}, {"owner": {"reputation": 1, "user_id": 6722611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ad3bdb1e4cd2aa1e1238a21a9830927?s=128&d=identicon&r=PG&f=1", "display_name": "Rami ", "link": "https://stackoverflow.com/users/6722611/rami"}, "edited": false, "score": 0, "creation_date": 1503500904, "post_id": 45827136, "comment_id": 78644689, "body": "As of now it is not a shared calendar. Currently it is just a calendar I created under My Calendars named Test"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6722611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ad3bdb1e4cd2aa1e1238a21a9830927?s=128&d=identicon&r=PG&f=1", "display_name": "Rami ", "link": "https://stackoverflow.com/users/6722611/rami"}, "edited": false, "score": 1, "creation_date": 1503439215, "post_id": 45827551, "comment_id": 78613329, "body": "Just gave it a shot. I&#39;m given an error : Invalid procedure call or argument: &#39;objNamespace.GetDefaultFolder&#39;"}, {"owner": {"reputation": 92, "user_id": 4175628, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-30KEKYmlZGQ/AAAAAAAAAAI/AAAAAAAAAJA/n0I_QqYOicY/photo.jpg?sz=128", "display_name": "Malbordio", "link": "https://stackoverflow.com/users/4175628/malbordio"}, "reply_to_user": {"reputation": 1, "user_id": 6722611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ad3bdb1e4cd2aa1e1238a21a9830927?s=128&d=identicon&r=PG&f=1", "display_name": "Rami ", "link": "https://stackoverflow.com/users/6722611/rami"}, "edited": false, "score": 1, "creation_date": 1503439478, "post_id": 45827551, "comment_id": 78613426, "body": "Remove the  Set objCalendar = objNamespace.GetDefaultFolder(olFolderCalendar)   and try again  Odd, but with me nothing bad happened.  I&#39;ve edited the original script. Also included End if and End sub strings"}, {"owner": {"reputation": 1, "user_id": 6722611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ad3bdb1e4cd2aa1e1238a21a9830927?s=128&d=identicon&r=PG&f=1", "display_name": "Rami ", "link": "https://stackoverflow.com/users/6722611/rami"}, "edited": false, "score": 1, "creation_date": 1503501017, "post_id": 45827551, "comment_id": 78644775, "body": "Okay the code executes, however we&#39;re back in the same position. A meeting will be created but it is created in the default calendar. I need it to be made in the calendar that I&#39;ve created named Test."}], "tags": [], "owner": {"reputation": 92, "user_id": 4175628, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-30KEKYmlZGQ/AAAAAAAAAAI/AAAAAAAAAJA/n0I_QqYOicY/photo.jpg?sz=128", "display_name": "Malbordio", "link": "https://stackoverflow.com/users/4175628/malbordio"}, "is_accepted": false, "score": 0, "last_activity_date": 1503439494, "last_edit_date": 1503439494, "creation_date": 1503438717, "answer_id": 45827551, "question_id": 45827136, "link": "https://stackoverflow.com/questions/45827136/outlook-2010-vbs-how-to-add-meeting-to-specific-calendar/45827551#45827551", "title": "Outlook 2010 VBS how to add meeting to specific calendar", "body": "<p>Try this:</p>\n\n<pre><code>Sub commandbutton1_Click()\n\nIf CommandButton1 = False Then\n\nConst olAppointmentItem = 1\nConst olMeeting = 1\nConst olFree = 0\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objNamespace = objOutlook.GetNamespace(\"MAPI\")\n\nSet objDictionary = CreateObject(\"Scripting.Dictionary\")\n\nobjDictionary.Add \"August 24, 2017\", \"My Test Appointment\"\n\n\ncolKeys = objDictionary.Keys\n\nFor Each strKey in colKeys\ndtmApptDate = strKey\nstrApptName = objDictionary.Item(strKey)\n\nSet objAppt = objOutlook.CreateItem(olAppointmentItem) \nobjAppt.Subject = strApptName\nobjAppt.Start = dtmApptDate &amp; \" 3:50 PM\"\nobjAppt.Duration = 1\nobjAppt.Location = \"Followup\"\nobjAppt.Body = \"Test Verbiage\"\nobjAppt.ReminderSet = True\nobjAppt.ReminderMinutesBeforeStart = 1\nobjAppt.AllDayEvent = True\nobjAppt.BusyStatus = olFree\nobjAppt.Save\nNext\n\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6722611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7ad3bdb1e4cd2aa1e1238a21a9830927?s=128&d=identicon&r=PG&f=1", "display_name": "Rami ", "link": "https://stackoverflow.com/users/6722611/rami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 412, "favorite_count": 0, "closed_date": 1503939401, "answer_count": 1, "score": 1, "last_activity_date": 1593342172, "creation_date": 1503436798, "last_edit_date": 1593342172, "question_id": 45827136, "link": "https://stackoverflow.com/questions/45827136/outlook-2010-vbs-how-to-add-meeting-to-specific-calendar", "closed_reason": "Duplicate", "title": "Outlook 2010 VBS how to add meeting to specific calendar", "body": "<p>I'm trying to set up a VBS to create a meeting in a specific calendar (not default) when a command button is pressed. The code I have works but creates the meeting in the default calendar. I've tried fooling around with it but I am new to VBS (mainly used VBA). I know VBA and VBS are similar so im sure something small has to be tweaked. I want the meetings to be placed in a calendar named Test, which is under My Calendars. </p>\n\n<pre><code>Sub commandbutton1_Click()\n\nIf CommandButton1 = False Then\nDim objOL 'As Outlook.Application\nDim objAppt 'As Outlook.AppointmentItem\n\nConst olAppointmentItem = 1\nConst olMeeting = 1\nConst olFree = 0\n\n\nSet objOL = CreateObject(\"Outlook.Application\")\nSet objAppt = objOL.CreateItem(olAppointmentItem)\n\nobjAppt.Subject = \"My Test Appointment\"\nobjAppt.Start = #8/24/17 3:50:00 PM#\nobjAppt.Duration = 1\nobjAppt.Location = \"Followup\"\nobjAppt.Body = \"Test Verbiage\"\nobjAppt.ReminderMinutesBeforeStart = 1\nobjAppt.BusyStatus = olFree\nobjAppt.Save()\nSet objAppt = Nothing\nSet objOL = Nothing\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1503436565, "post_id": 45826936, "comment_id": 78612253, "body": "If the random number was greater than 0.5, then 2 * that number will be greater than 1, and 1 - a number greater than 1 is negative.  What are you trying to do?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503446592, "post_id": 45826936, "comment_id": 78615151, "body": "the number that is multiplying the <i>Rnd</i> is positive (+2). it is the same as <code>1 - ( 2 * Rnd )</code>"}, {"owner": {"reputation": 1, "user_id": 8502631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ead20467180bf383ada56ea1616f18?s=128&d=identicon&r=PG&f=1", "display_name": "Tracy Le", "link": "https://stackoverflow.com/users/8502631/tracy-le"}, "edited": false, "score": 0, "creation_date": 1503607570, "post_id": 45826936, "comment_id": 78700168, "body": "Right, i got it now. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8502631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ead20467180bf383ada56ea1616f18?s=128&d=identicon&r=PG&f=1", "display_name": "Tracy Le", "link": "https://stackoverflow.com/users/8502631/tracy-le"}, "edited": false, "score": 0, "creation_date": 1503607601, "post_id": 45827234, "comment_id": 78700190, "body": "Thanks, that is really useful"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1503437224, "creation_date": 1503437224, "answer_id": 45827234, "question_id": 45826936, "link": "https://stackoverflow.com/questions/45826936/vba-excel-rnd-syntax/45827234#45827234", "title": "VBA excel Rnd syntax", "body": "<p>It is not always negative. But in general, when you are wondering about something in VBA, make a small sampe and print it. Like this:</p>\n\n<pre><code>Option Explicit\nSub TestMe()\n\n    Dim lngCount    As Long\n\n    For lngCount = 1 To 5\n        Debug.Print \"----------------\"\n        Debug.Print Rnd\n        Debug.Print 1 - 2 * Rnd\n        Debug.Print \"----------------\"\n    Next lngCount\n\nEnd Sub\n</code></pre>\n\n<p>It shows randomly the following:</p>\n\n<pre><code>----------------\n 0.5137375 \n 7.403994E-02 \n----------------\n----------------\n 0.3534727 \n 0.1903317 \n----------------\n----------------\n 0.2697316 \n 0.888813 \n----------------\n----------------\n 0.2438452 \n-0.9581559 \n----------------\n----------------\n 6.091624E-02 \n 0.2194171 \n----------------\n</code></pre>\n\n<p>Thus, you can trace it to check the reason for the negativity. And stay positive :)</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 8327311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01b953f8e34c37657a32aed443a976d?s=128&d=identicon&r=PG&f=1", "display_name": "user8327311", "link": "https://stackoverflow.com/users/8327311/user8327311"}, "is_accepted": false, "score": 0, "last_activity_date": 1503440836, "creation_date": 1503440836, "answer_id": 45827937, "question_id": 45826936, "link": "https://stackoverflow.com/questions/45826936/vba-excel-rnd-syntax/45827937#45827937", "title": "VBA excel Rnd syntax", "body": "<p>(1-(2*rnd),2) I think this is an order of operations issue you get rand value multiple it by 2 then subtract it from one.</p>\n\n<p>the value will not always be less than 0 but has a good chance of it.</p>\n\n<p>Might be able to help you accomplish your task if you're more specific as to what you're trying to do.</p>\n"}], "owner": {"reputation": 1, "user_id": 8502631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ead20467180bf383ada56ea1616f18?s=128&d=identicon&r=PG&f=1", "display_name": "Tracy Le", "link": "https://stackoverflow.com/users/8502631/tracy-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1503440836, "creation_date": 1503435832, "last_edit_date": 1503436442, "question_id": 45826936, "link": "https://stackoverflow.com/questions/45826936/vba-excel-rnd-syntax", "title": "VBA excel Rnd syntax", "body": "<p>I understand the basis of Rnd function but don't understand here why the number that times Rnd is negative. Could anyone help please</p>\n\n<pre><code>Range(\"A1\")=Formatcurrency(1-2*Rnd,2)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 8452619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_uMStKMCNag/AAAAAAAAAAI/AAAAAAAAB1g/WvUlUJhB8EA/photo.jpg?sz=128", "display_name": "Pslice", "link": "https://stackoverflow.com/users/8452619/pslice"}, "is_accepted": false, "score": 0, "last_activity_date": 1503438902, "creation_date": 1503438902, "answer_id": 45827583, "question_id": 45826801, "link": "https://stackoverflow.com/questions/45826801/excel-vba-copy-and-paste-tab-and-by-auto-filter-and-delete-hidden-rows-error-mes/45827583#45827583", "title": "Excel VBA copy and paste tab and by auto filter and delete hidden rows error message out of memory", "body": "<p>I would remove the \"On Error Resume Next\" statements and put</p>\n\n<pre><code>msgbox(Err.Description)\n</code></pre>\n\n<p>under the exit_Proc: handler to see what is going on.</p>\n"}], "owner": {"reputation": 1, "user_id": 8219712, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/99a631a22d25aede6f621cc31c5421d1?s=128&d=identicon&r=PG&f=1", "display_name": "Zack Carter", "link": "https://stackoverflow.com/users/8219712/zack-carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503438902, "creation_date": 1503435240, "last_edit_date": 1531164843, "question_id": 45826801, "link": "https://stackoverflow.com/questions/45826801/excel-vba-copy-and-paste-tab-and-by-auto-filter-and-delete-hidden-rows-error-mes", "title": "Excel VBA copy and paste tab and by auto filter and delete hidden rows error message out of memory", "body": "<p>I was wondering if i could get your advice.</p>\n\n<p>I have the below code which works for copying and creating additional tabs by splitting values from a column into 2 tabs and on each tab it applies an autofilter. </p>\n\n<p>However when it creates the 3rd tab it shows an error message that there is not enough memory to continue. </p>\n\n<p>I think that the deleting hidden rows as part of the auto-filter is causing the code to fall down but i have tried to amend the code to clear memory etc but it keeps failing.</p>\n\n<p>Can i please get your help!!</p>\n\n<pre><code>Option Explicit\n\n\n'---------------------------------------------------------------------------------------\n' Module    : Module1\n' DateTime  : 24/09/2006 22:48\n' Updated   : 2014\n' Author    : Roy Cox (royUK)\n' Website   :  more examples\n' Purpose   :  Create a sheet for each unique name in data\n' Disclaimer; This code is offered as is with no guarantees. You may use it in your\n'             projects but please leave this header intact.\n'---------------------------------------------------------------------------------------\n\n\nSub ExtractToSheets()\n    Dim ws As Worksheet\n    Dim wsNew As Worksheet\n    Dim rData As Range, rList As Range, rDelete As Range\n    Dim rCl As Range\n    Dim sNm As String\n\n\n    Const Crit1 As String = \"Category\"\n    Const Crit2 As String = \"Store\"\n\n\n    Set ws = Sheets(\"sheet1\")\n    On Error GoTo exit_Proc\n    'extract a list of unique names\n    'first clear existing list\n    With ws\n        Set rData = .Range(\"A1\").CurrentRegion\n        .Columns(.Columns.Count).Clear\n        rData.Columns(4).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=.Cells(1, .Columns.Count), Unique:=True\n\n\n        Set rList = .Cells(1, .Columns.Count).CurrentRegion\n        Set rList = rList.Offset(1, 0).Resize(rList.Rows.Count - 1, _\n                                              rList.Columns.Count)\n\n\n        For Each rCl In rList\n            sNm = rCl.Text\n\n\n            ''///delete any previously created sheets(only if required-NB uses UDF)\n            If WksExists(sNm) Then\n                Application.DisplayAlerts = False\n                Sheets(sNm).Delete\n                Application.DisplayAlerts = True\n            End If\n            Select Case sNm\n            Case \"Store\", \"Category\"\n                ''/// ignore these names\n            Case Else\n                Sheets(\"sheet1\").Copy After:=Worksheets(Worksheets.Count)\n                With ActiveSheet\n                    .Name = sNm\n\n\n                    If Not .AutoFilterMode Then .Range(\"A1\").AutoFilter\n                    ActiveSheet.Range(\"$A$1:$L$206\").AutoFilter Field:=4, Criteria1:=\"&lt;&gt;Store\" _\n                                                              , Operator:=xlAnd, Criteria2:=\"&lt;&gt;Category\"\n                    ActiveSheet.Range(\"$A$1:$L$206\").AutoFilter Field:=4, Criteria1:=sNm\n\n\n                    With Sheets(sNm).AutoFilter.Range\n                        On Error Resume Next\n                        Set rDelete = .Offset(1, 0).Resize(.Rows.Count - 1, 1) _\n                                      .SpecialCells(xlCellTypeVisible)\n                        On Error GoTo 0\n                        If Not rDelete Is Nothing Then rDelete.EntireRow.Delete\n                    End With\n                    ''/// Remove the AutoFilter\n                    .AutoFilterMode = False\n                    .Range(\"A1\").Select\n                End With\n\n\n            End Select\n\n\n        Next rCl\n    End With\n\n\n    MsgBox \"Report completed\", vbInformation, \"Done\"\nclean_up:\n    ws.Columns(Columns.Count).ClearContents        'remove temporary list\n    rData.AutoFilter        ''///switch off AutoFilter\n    Exit Sub\nexit_Proc:\n    Application.ScreenUpdating = True\n    Resume clean_up\nEnd Sub\n\n\n\n\n\n\n\n\nFunction WksExists(wksName As String) As Boolean\n    On Error Resume Next\n    WksExists = CBool(Len(Worksheets(wksName).Name) &gt; 0)\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1503445145, "post_id": 45826722, "comment_id": 78614860, "body": "Can you post your current code?"}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1503515059, "post_id": 45826722, "comment_id": 78653217, "body": "I added a separate post to this, I figured out how to get my file to be named what I want it to be, now the trouble is saving it. This is the title of the question: MS Word VBA: Saving File, runtime error 5152"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 1, "last_activity_date": 1503453616, "creation_date": 1503453616, "answer_id": 45829493, "question_id": 45826722, "link": "https://stackoverflow.com/questions/45826722/ms-word-vba-saving-a-document-using-the-header/45829493#45829493", "title": "MS Word VBA: Saving a document using the header", "body": "<p>Since you already separated the documents, the code below might give them names using their first sentence.</p>\n\n<pre><code>Private Function DocName(Doc As Document) As String\n    ' 23 Aug 2017\n\n    Const Illegals As String = \"\\:/;?*|&gt;\"\"\"\n    Static FaultCounter As Integer\n    Dim Fun As String\n    Dim Title As String\n    Dim Ch As String\n    Dim i As Integer\n\n    Title = Trim(Doc.Sentences(1))\n    For i = 1 To Len(Title)\n        Ch = Mid(Title, i, 1)\n        If (Asc(Ch) &gt; 31) And (Asc(Ch) &lt; 129) Then\n            If InStr(Illegals, Ch) = 0 Then Fun = Fun &amp; Ch\n        End If\n    Next i\n\n    If Len(Fun) = 0 Then\n        FaultCounter = FaultCounter + 1\n        Fun = Format(FaultCounter, \"\"\"Default File Name (\"\"0\"\")\"\"\")\n    End If\n\n    DocName = Fun\nEnd Function\n</code></pre>\n\n<p>Before saving the file you might want to check for duplicates. Use the Dir() function for that and add a number to duplicate names using the system I included above to name files where the first sentence might be empty.</p>\n\n<p>You may also have to review the characters which aren't permitted in file names. I have simply excluded all below ASCII(32) and above ASCII(128), and then the known ones Windows doesn't like. You might want to modify that range further.</p>\n\n<p>To call the above function use code like this:-</p>\n\n<pre><code>Private Sub GetName()\n    Debug.Print DocName(ActiveDocument)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "is_accepted": false, "score": 0, "last_activity_date": 1503512704, "creation_date": 1503512704, "answer_id": 45846949, "question_id": 45826722, "link": "https://stackoverflow.com/questions/45826722/ms-word-vba-saving-a-document-using-the-header/45846949#45846949", "title": "MS Word VBA: Saving a document using the header", "body": "<p>This is the code I have so far, I was able to find it off of a very helpful website, but the code saves as the word \"report\" which I set it to right now while I'm trying to figure it out, and then the number of the document.  </p>\n\n<pre><code>Option Explicit\n\nSub splitter()\n\n' splitter Macro\n\n' Macro created by Doug Robbins to save each letter created by a mailmergeas \na separate file.\nApplication.ScreenUpdating = False\nDim Program As String\nDim DocName As String\nDim Letters As Integer, Counter As Integer\n\nLetters = ActiveDocument.Sections.Count\nSelection.HomeKey Unit:=wdStory\nCounter = 1\nWhile Counter &lt; Letters\n'program = ActiveDocument.MailMerge.DataSource.DataFields(\"Program_Outcomes_PlanReport_Name\").Value\nDocName = \"Reports\" &amp; LTrim$(Str$(Counter))  'Generic name of document\nActiveDocument.Sections.First.Range.Cut\nDocuments.Add\nSelection.Paste\nActiveDocument.Sections(2).PageSetup.SectionStart = wdSectionContinuous\n\n\nActiveDocument.SaveAs filename:=\"E:\\assessment rubrics\\Templates\" &amp; \"\\\" &amp; DocName, FileFormat:=wdFormatDocument, LockComments:=False, Password:=\"\", \nAddToRecentFiles:=False, WritePassword:=\"\", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData:=False,         SaveAsAOCELetter:=False\nActiveWindow.Close\nCounter = Counter + 1\nWend\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1503512704, "creation_date": 1503434976, "question_id": 45826722, "link": "https://stackoverflow.com/questions/45826722/ms-word-vba-saving-a-document-using-the-header", "title": "MS Word VBA: Saving a document using the header", "body": "<p>I have been trying to figure out a way to, after performing a mail merge, separate the documents into individual ones and name them after a specific item, preferably the first line of the header. I have only been able to find ways to split the document, but cannot figure out how to name it. Any help with how to write the VBA code to save a document as the header would be very much appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 5, "creation_date": 1503434551, "post_id": 45826604, "comment_id": 78611295, "body": "<code>Dim pu238 As 123.231</code> (assuming the cell contained 123.231) makes no sense - try <code>Dim pu238 As Double : pu238 = Worksheets(&quot;PEC Conversion&quot;).Cells(4, 6).Value</code>"}, {"owner": {"reputation": 33, "user_id": 2410533, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38e6aa033f737375949f049f6002fd2d?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2410533/harry"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1503435264, "post_id": 45826604, "comment_id": 78611648, "body": "That fixes the first 3 but the following line   <code>Dim pu238PEC As Double: pu238PEC [Worksheets(&quot;PEC Conversion&quot;).Cells(2, 2).Value] </code>  gives me the error &quot;Complile error: Expected Sub, Function, or Property&quot;"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1503435775, "post_id": 45826604, "comment_id": 78611900, "body": "<code>Dim pu238PEC As Double: pu238PEC [Worksheets(&quot;PEC Conversion&quot;).Cells(2, 2).Value]</code> should have been written in a similar way to the first three - i.e. <code>Dim pu238PEC As Double: pu238PEC = Worksheets(&quot;PEC Conversion&quot;).Cells(2, 2).Value</code>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1503435725, "post_id": 45826844, "comment_id": 78611871, "body": "Please do away with the square brackets and benefit from compile-time validation of whatever you put between <code>[</code> and <code>]</code>. Square-bracketed expressions are just shorthand for <code>Application.Evaluate</code>. Systematically using them is outright dangerous, someone should point it out."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1503435727, "post_id": 45826844, "comment_id": 78611872, "body": "Do the values need to be in brackets as well? Edit: Was gonna say... what&#39;s the purpose of the brackets??"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 33, "user_id": 2410533, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38e6aa033f737375949f049f6002fd2d?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2410533/harry"}, "edited": false, "score": 0, "creation_date": 1503435806, "post_id": 45826844, "comment_id": 78611919, "body": "@Harry if any of these cells contains an error value (e.g. <code>#VALUE!</code> or <code>#REF!</code>), that&#39;s the error you&#39;ll get, yes. Error values can&#39;t be assigned to a <code>Double</code>. Or anything other than a <code>Variant</code> for that matter. Use the <code>IsError</code> function to determine if it&#39;s legal to assign it to a <code>Double</code>."}, {"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "reply_to_user": {"reputation": 33, "user_id": 2410533, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38e6aa033f737375949f049f6002fd2d?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2410533/harry"}, "edited": false, "score": 1, "creation_date": 1503435851, "post_id": 45826844, "comment_id": 78611942, "body": "@Harry \u2013 square brackets removed, code works well for me."}, {"owner": {"reputation": 33, "user_id": 2410533, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38e6aa033f737375949f049f6002fd2d?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2410533/harry"}, "edited": false, "score": 0, "creation_date": 1503435882, "post_id": 45826844, "comment_id": 78611955, "body": "I&#39;m very new to the syntax of vba. I was not sure about the brackets but it solved an error I had the other day. thank you for the heads up!"}, {"owner": {"reputation": 33, "user_id": 2410533, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38e6aa033f737375949f049f6002fd2d?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2410533/harry"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1503436153, "post_id": 45826844, "comment_id": 78612053, "body": "Also @Mat&#39;sMug I currently have an IsError but no until later in my code. Removing brackets fixed this issue. Running into some more issues but I want to give them a go myself. Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 33, "user_id": 2410533, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38e6aa033f737375949f049f6002fd2d?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2410533/harry"}, "edited": false, "score": 0, "creation_date": 1503439662, "post_id": 45826844, "comment_id": 78613497, "body": "@Harry get your code to work as intended, then put it up for peer review on <a href=\"https://codereview.stackexchange.com\">Code Review</a> - you&#39;ll learn a TON! (you&#39;ll probably want to run your code through <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>&#39;s inspections first though)"}], "tags": [], "owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "is_accepted": false, "score": 1, "last_activity_date": 1503435814, "last_edit_date": 1503435814, "creation_date": 1503435410, "answer_id": 45826844, "question_id": 45826604, "link": "https://stackoverflow.com/questions/45826604/i-am-receiving-a-user-type-not-defined-error-when-defining-variables/45826844#45826844", "title": "I am receiving a &quot;user-type not defined&quot; error when defining variables", "body": "<pre><code>Sub PECcalc()\n\n    Dim pu238 As Double\n    pu238 = Worksheets(\"PEC Conversion\").Cells(4, 6).Value\n\n    Dim pu241 As Double\n    pu241 = Worksheets(\"PEC Conversion\").Cells(5, 6).Value\n\n    Dim am241 As Double\n    am241 = Worksheets(\"PEC Conversion\").Cells(6, 6).Value\n\n    Dim pu238PEC As Double\n    pu238PEC = Worksheets(\"PEC Conversion\").Cells(2, 2).Value\n\n    Dim pu239PEC As Double\n    pu239PEC = Worksheets(\"PEC Conversion\").Cells(3, 2).Value\n\n    Dim pu240PEC As Double\n    pu240PEC = Worksheets(\"PEC Conversion\").Cells(4, 2).Value\n\n    Dim pu241PEC As Double\n    pu241PEC = Worksheets(\"PEC Conversion\").Cells(5, 2).Value\n\n    Dim am241PEC As Double\n    am241PEC = Worksheets(\"PEC Conversion\").Cells(6, 2).Value\n\n    Dim np237PEC As  Double\n    np237PEC = Worksheets(\"PEC Conversion\").Cells(7, 2).Value\n\n    Dim u328PEC As Double\n    u328PEC = Worksheets(\"PEC Conversion\").Cells(8, 2).Value\n\n    Dim u235PEC As Double\n    u235PEC =  Worksheets(\"PEC Conversion\").Cells(9, 2).Value\n    '...etc\n</code></pre>\n\n<p>or the other style:</p>\n\n<pre><code>Sub PECcalc()\n\n    Dim pu238 As Double\n    Dim pu241 As Double\n    Dim am241 As Double\n    Dim pu238PEC As Double\n    Dim pu239PEC As Double\n    Dim pu240PEC As Double\n    Dim pu241PEC As Double\n    Dim am241PEC As Double\n    Dim np237PEC As  Double\n    Dim u328PEC As Double\n    Dim u235PEC As Double\n\n    pu238 = Worksheets(\"PEC Conversion\").Cells(4, 6).Value\n    pu241 = Worksheets(\"PEC Conversion\").Cells(5, 6).Value\n    am241 = Worksheets(\"PEC Conversion\").Cells(6, 6).Value\n    pu238PEC = Worksheets(\"PEC Conversion\").Cells(2, 2).Value\n    pu239PEC = Worksheets(\"PEC Conversion\").Cells(3, 2).Value\n    pu240PEC = Worksheets(\"PEC Conversion\").Cells(4, 2).Value\n    pu241PEC = Worksheets(\"PEC Conversion\").Cells(5, 2).Value\n    am241PEC = Worksheets(\"PEC Conversion\").Cells(6, 2).Value\n    np237PEC = Worksheets(\"PEC Conversion\").Cells(7, 2).Value\n    u328PEC = Worksheets(\"PEC Conversion\").Cells(8, 2).Value\n    u235PEC =  Worksheets(\"PEC Conversion\").Cells(9, 2).Value\n    '...etc\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 2410533, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38e6aa033f737375949f049f6002fd2d?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2410533/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503435814, "creation_date": 1503434421, "question_id": 45826604, "link": "https://stackoverflow.com/questions/45826604/i-am-receiving-a-user-type-not-defined-error-when-defining-variables", "title": "I am receiving a &quot;user-type not defined&quot; error when defining variables", "body": "<p>The code below is used at the beginning of my function. I am merely defining a cell containing a number as a variable in order to reduce the amount of typing later in my code. I'm confused as my variable type is nothing special, just a good ole number..</p>\n\n<pre><code>Sub PECcalc()\n\nDim pu238 As [Worksheets(\"PEC Conversion\").Cells(4, 6).Value]\nDim pu241 As [Worksheets(\"PEC Conversion\").Cells(5, 6).Value]\nDim am241 As [Worksheets(\"PEC Conversion\").Cells(6, 6).Value]\nDim pu238PEC As [Worksheets(\"PEC Conversion\").Cells(2, 2).Value]\nDim pu239PEC As [Worksheets(\"PEC Conversion\").Cells(3, 2).Value]\nDim pu240PEC As [Worksheets(\"PEC Conversion\").Cells(4, 2).Value]\nDim pu241PEC As [Worksheets(\"PEC Conversion\").Cells(5, 2).Value]\nDim am241PEC As [Worksheets(\"PEC Conversion\").Cells(6, 2).Value]\nDim np237PEC As [Worksheets(\"PEC Conversion\").Cells(7, 2).Value]\nDim u328PEC As [Worksheets(\"PEC Conversion\").Cells(8, 2).Value]\nDim u235PEC As [Worksheets(\"PEC Conversion\").Cells(9, 2).Value]\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 1, "creation_date": 1503434914, "post_id": 45826525, "comment_id": 78611484, "body": "Could you include the code you are using?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1503435047, "post_id": 45826525, "comment_id": 78611548, "body": "I have always found that executing a <code>Workbooks.Open</code> statement immediately jumps out of single-step mode in VBE - it&#39;s as if I had pressed F5.  But that doesn&#39;t mean the macro stops.  Rather it means that the macro runs to the end.  (I usually just include a breakpoint after the <code>Open</code> statement so that I get control back.)"}, {"owner": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "edited": false, "score": 0, "creation_date": 1503499140, "post_id": 45826525, "comment_id": 78643277, "body": "Sub Openfile()     Workbooks.Open (FilePath), UpdateLinks:=False End Sub"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "edited": false, "score": 0, "creation_date": 1503499161, "post_id": 45827644, "comment_id": 78643297, "body": "Yes... I use the below code to open the workbook Sub Openfile()     Workbooks.Open (FilePath), UpdateLinks:=False End Sub"}, {"owner": {"reputation": 56, "user_id": 8452619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_uMStKMCNag/AAAAAAAAAAI/AAAAAAAAB1g/WvUlUJhB8EA/photo.jpg?sz=128", "display_name": "Pslice", "link": "https://stackoverflow.com/users/8452619/pslice"}, "reply_to_user": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "edited": false, "score": 0, "creation_date": 1503510014, "post_id": 45827644, "comment_id": 78650330, "body": "I made edits to my answer. Let me know if it works out."}], "tags": [], "owner": {"reputation": 56, "user_id": 8452619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_uMStKMCNag/AAAAAAAAAAI/AAAAAAAAB1g/WvUlUJhB8EA/photo.jpg?sz=128", "display_name": "Pslice", "link": "https://stackoverflow.com/users/8452619/pslice"}, "is_accepted": false, "score": 0, "last_activity_date": 1503510692, "last_edit_date": 1503510692, "creation_date": 1503439195, "answer_id": 45827644, "question_id": 45826525, "link": "https://stackoverflow.com/questions/45826525/macro-stops-running-on-opening-a-new-workbook-xlsm-format/45827644#45827644", "title": "Macro stops running on opening a new workbook (xlsm format)", "body": "<p>The following will work if you have a folder with all the workbooks.\nThis code will iterate through a series of excel files in a given folder:</p>\n\n<pre><code>Dim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim strPath As String\nDim intLen As Integer\nDim strName As String\nDim wsSheet As Worksheet\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\nstrPath = \"C:\\Users\\username\\Desktop\\FolderName\" 'Set path of folder with excel files\nSet objFolder = objFSO.GetFolder(strPath) 'Get the folder object associated with the directory\nFor Each objFile In objFolder.Files 'Loop through the files in the folder\n    Workbooks.Open (strPath &amp; \"\\\" &amp; objFile.Name)\n  Set wsSheet = Worksheets(\"Sheet1\") 'Name of sheet in excel file\n\n  ActiveWorkbook.CheckCompatibility = False 'Skip compatibility check\n</code></pre>\n\n<p>This code will printout a pdf of the specified range on each sheet to a given path:</p>\n\n<pre><code>intLen = Len(objFile.Name) - 5 'Remove .xlsx characters from name\nstrName = Left(objFile.Name, intLen)\nwsSheet.Range(\"A1:P58\").ExportAsFixedFormat xlTypePDF, \"C:\\Users\\username\\Desktop\\\" &amp; strName &amp; \".pdf\", , , , , , False\n</code></pre>\n\n<p>This code will close each file without saving and continue the loop through the folder:</p>\n\n<pre><code>    Workbooks(strName).Close SaveChanges:=False 'Close excel file without saving\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550870934, "creation_date": 1503434154, "last_edit_date": 1531164843, "question_id": 45826525, "link": "https://stackoverflow.com/questions/45826525/macro-stops-running-on-opening-a-new-workbook-xlsm-format", "title": "Macro stops running on opening a new workbook (xlsm format)", "body": "<p>The VBA macro stops running on opening certain workbooks. When I run the code in break mode, it seems like control goes over to the newly opened workbook and there it has no instructions to follow.</p>\n\n<p>I am trying to open a lot of workbooks, take a printout and close them. </p>\n\n<p>I have also tried opening them in Read only mode, setting the calculation mode to manual but nothing has worked so far.</p>\n"}]