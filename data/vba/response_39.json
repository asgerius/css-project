[{"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1444259294, "post_id": 33003867, "comment_id": 53832697, "body": "If you&#39;re a novice with VBA might i suggest SSIS. It&#39;s a more visual system and it is good at doing things like looping through files and moving them into folders. <a href=\"http://stackoverflow.com/questions/6190578/how-to-import-excel-files-with-different-names-and-same-schema-into-database\" title=\"how to import excel files with different names and same schema into database\">stackoverflow.com/questions/6190578/&hellip;</a>. You can use it to load into MS Access but I suggest you go all the way and load into SQL Server. Unfortunately with excel as a source you are always going to have data quality problems. People adding columns, rows, and typing nonsense in."}], "answers": [{"tags": [], "owner": {"reputation": 8131, "user_id": 4459617, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9cebe9a45f0438824814ce252c6b0a74?s=128&d=identicon&r=PG&f=1", "display_name": "Hannover Fist", "link": "https://stackoverflow.com/users/4459617/hannover-fist"}, "is_accepted": true, "score": 0, "last_activity_date": 1444260536, "creation_date": 1444260536, "answer_id": 33004127, "question_id": 33003867, "link": "https://stackoverflow.com/questions/33003867/importing-thousands-of-spreadsheets-into-access-database-table-using-vba/33004127#33004127", "title": "Importing thousands of spreadsheets into Access Database table using VBA", "body": "<p>This is off the top of my head (so there may be sytax errors) but the idea is to set the error handling to jump to code that saves the filename and then jump back into the process:</p>\n\n<pre><code>  ON ERROR GOTO IMPORT_ERROR \n\nFor intWorksheets = 1 To 1\n\n      strFile = Dir(strPath &amp; \"*.xlsm\")\n      Do While Len(strFile) &gt; 0\n            strPathFile = strPath &amp; strFile\n            'MsgBox strPathFile\n            DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12Xml, strTables(intWorksheets), strPathFile, blnHasFieldNames, strWorksheets(intWorksheets) &amp; \"$\"\n\n            strFile = Dir()\nGetNextFile:\n\n      Loop\n\nNext intWorksheets\n\nEXIT FUNCTION\n\nIMPORT_ERROR:\n'ADD CODE HERE TO HANDLE ERROR\n\nON ERROR GOTO IMPORT_ERROR \n\nGOTO GetNextFile\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5199678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf2fcacd5af9250014f27e1ea6c8d63d?s=128&d=identicon&r=PG&f=1", "display_name": "Uogele", "link": "https://stackoverflow.com/users/5199678/uogele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 33004127, "answer_count": 1, "score": 1, "last_activity_date": 1444260536, "creation_date": 1444258880, "question_id": 33003867, "link": "https://stackoverflow.com/questions/33003867/importing-thousands-of-spreadsheets-into-access-database-table-using-vba", "title": "Importing thousands of spreadsheets into Access Database table using VBA", "body": "<p>I have created this process by lifting code from this (and some other) sites, and it worked like a charm when I tested it, but when I deployed it, it crashed hard... <em>I am novice when it come to VBA</em> and having trouble finding appropriate solution so thought I will ask for help. </p>\n\n<p><strong>Use Case</strong><br/>\nAccountant receives 100+ spreadsheets per day(!) from employees in the field as a form of required reporting. Before I got involved, 3 accountants would open each spreadsheet received via e-mail and copy/paste certain cell contents into a \"master\" spreadsheet that will be used for reconciliation at the end of the month. Needless to say, this has become, let's say, inefficient. <br/>\n<strong>What I did</strong><br/>\nI created an Access DB and used TransferSpreadsheet method to import data. There are only 11 cells that we need imported from each spreadsheet, so I modified spreadsheets that field employees use to pull all this data into a hidden tab, where all data is in one row and all row goes into one table in Access. As I mentioned, when I and accountants tested the solution, it worked beautifully. <br/>\n<strong>What Broke</strong><br/>\nFirst issue was that people in a field did not have same versions MS Office, and some used OpenOffice instead and we would get errors when trying to import some spreadsheets. However, since my simple solution was built for \"prefect path\" only, it was impossible to identify which spreadsheets failed, especially, when there are 2000+ of them sitting in a folder. <br/>\n<strong>What I would like to be able to do</strong>\nShort-term, until I have time to master VBA, I would love to add some sort of error handler. Or even if after import, \"good\" spreadsheets would be sent to one folder, and \"bad\" ones to another. From my experience,about 80% of reports import fine. Once it loops through the whole folder, accountants can check \"failed imports\" folder and enter these manually. My questions to you, Access VBA experts, is this doable and would be a reasonable solution? If so, can you please direct me to it?\nBelow is my current code that I adapted from the internets. Thank you for all your help!</p>\n\n<pre><code>Function DoImport()\n\nDim strPathFile As String\nDim strFile As String\nDim strPath As String\nDim blnHasFieldNames As Boolean\nDim intWorksheets As Integer\nDim strWorksheets(1 To 1) As String\n\n\n' the number of worksheets to be imported\n' from each EXCEL file (this code assumes that each worksheet\n' with the same name is being imported into a separate table\n' for that specific worksheet name)\nDim strTables(1 To 1) As String\n\n' worksheet names ;\n' add / delete code lines so that there is one code line for\n' each worksheet that is to be imported from each workbook file\nstrWorksheets(1) = \"Data\"\n\nstrTables(1) = \"my_table\"\n\n' Change this next line to True if the first row in EXCEL worksheet\n' has field names\nblnHasFieldNames = True\n\n'update the path to where the Excel files to be imported are\nstrPath = \"\\mypathhere\\\"\n\n' the number of worksheets to be imported\n' from each EXCEL file\nFor intWorksheets = 1 To 1\n\n      strFile = Dir(strPath &amp; \"*.xlsm\")\n      Do While Len(strFile) &gt; 0\n            strPathFile = strPath &amp; strFile\n            'MsgBox strPathFile\n            DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12Xml, strTables(intWorksheets), strPathFile, blnHasFieldNames, strWorksheets(intWorksheets) &amp; \"$\"\n\n            strFile = Dir()\n      Loop\n\nNext intWorksheets\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "api", "excel", "winapi"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1444260276, "post_id": 33003766, "comment_id": 53832981, "body": "Please don&#39;t ask us to do your testing for you. Install 64 bit Excel yourself."}, {"owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "edited": false, "score": 0, "creation_date": 1478145038, "post_id": 33003766, "comment_id": 68038299, "body": "&quot;Testing&quot; is not a reliable method of determining API declarations in Excel. Firstly, Excel does stack correction after API calls: that hides declaration errors: in this case it would hide an error in the bit length of the return value. Secondly, testing the API requires a known valid testing framework, which is almost never the case. And thirdly - some of the API has optional terms which are almost never used, leading to hidden errors."}], "answers": [{"tags": [], "owner": {"reputation": 5685, "user_id": 5240004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j8eFV.jpg?s=128&g=1", "display_name": "theB", "link": "https://stackoverflow.com/users/5240004/theb"}, "is_accepted": true, "score": 2, "last_activity_date": 1444268674, "creation_date": 1444268674, "answer_id": 33005256, "question_id": 33003766, "link": "https://stackoverflow.com/questions/33003766/convert-windows-api-call-to-64-bit-in-excel-vba/33005256#33005256", "title": "Convert Windows API call to 64-bit in Excel VBA", "body": "<blockquote>\n  <p>But is that correct? </p>\n</blockquote>\n\n<p>Yes. But don't take my word for it. Get a copy of Office and test it.</p>\n\n<blockquote>\n  <p>The only difference is adding PtrSafe. Should it point to a different, 64-bit version of MPR.DLL? </p>\n</blockquote>\n\n<p>No. Windows chooses the appropriate DLL for the bitness of your process.  For standard WinAPI components, you should only use the DLL name, and never a full path.  Windows will pick the correct one.</p>\n\n<blockquote>\n  <p>Also, should lSize be LongLong rather than Long?</p>\n</blockquote>\n\n<p>It should be <code>ByRef Long</code>.  The <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa385453.aspx\" rel=\"nofollow\"><code>WNetGetConnection</code></a> documentation shows the function prototype:</p>\n\n<pre><code>DWORD WNetGetConnection(\n  _In_    LPCTSTR lpLocalName,\n  _Out_   LPTSTR  lpRemoteName,\n  _Inout_ LPDWORD lpnLength\n);\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383751.aspx\" rel=\"nofollow\"><code>DWORD</code></a> is a 32 bit unsigned integer.<sup>1</sup> <code>LPDWORD</code> is a pointer to a <code>DWORD</code>, which in VB(6/A) is <code>ByRef lpnLength As Long</code>.</p>\n\n<p>As a bonus:</p>\n\n<ul>\n<li>In the Windows API <code>LONG</code> is also 32 bit. This does not change whether you're running 32 or 64 bit. (<code>sizeof(DWORD) == sizeof(LONG) == sizeof(INT)</code>)</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa263420.aspx\" rel=\"nofollow\">VBA Data Types</a></li>\n</ul>\n\n<hr>\n\n<p><em><sup>1</sup>Fun Fact: VBA doesn't have unsigned integer types, since VB6 didn't have them. VB6 came out in '98.</em></p>\n\n<p><em>A brand-new never-before-used single user license for Office 2016 is running about $150 as of 7-Oct-15.  It's also available through the MSDN subscription programs.  It's also available at many fine retailers. (I'm intentionally not posting links.)</em></p>\n"}], "owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3267, "favorite_count": 0, "accepted_answer_id": 33005256, "answer_count": 1, "score": 0, "last_activity_date": 1444268674, "creation_date": 1444258363, "question_id": 33003766, "link": "https://stackoverflow.com/questions/33003766/convert-windows-api-call-to-64-bit-in-excel-vba", "title": "Convert Windows API call to 64-bit in Excel VBA", "body": "<p>I'm using this Windows API call in 32-bit Excel, and it's working fine:</p>\n\n<pre><code>Declare Function WNetGetConnection Lib \"MPR.DLL\" _\n    Alias \"WNetGetConnectionA\" ( _\n        ByVal lpszLocalName As String, _\n        ByVal lpszRemoteName As String, _\n        lSize As Long) As Long\n</code></pre>\n\n<p>I'm told that a small percentage of our corporate users will soon be going to 64-bit Excel. I don't have access to 64-bit Excel and I haven't been able to find any coworkers nearby who do.</p>\n\n<p>According to this file, if I'm reading it correctly...</p>\n\n<p><a href=\"http://www.cadsharp.com/docs/Win32API_PtrSafe.txt\" rel=\"nofollow\">http://www.cadsharp.com/docs/Win32API_PtrSafe.txt</a></p>\n\n<p>...this is the correct syntax of that function for 64-bit Excel:</p>\n\n<pre><code>Declare PtrSafe Function WNetGetConnection Lib \"MPR.DLL\" _\n    Alias \"WNetGetConnectionA\" ( _\n        ByVal lpszLocalName As String, _\n        ByVal lpszRemoteName As String, _\n        lSize As Long) As Long\n</code></pre>\n\n<p>But is that correct? The only difference is adding PtrSafe. Should it point to a different, 64-bit version of MPR.DLL? Also, should lSize be LongLong rather than Long?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444324631, "post_id": 33022033, "comment_id": 53866740, "body": "&quot;Workbook is for Excel...&quot;, d&#39;oh! I don&#39;t know how I didn&#39;t realize that. Thanks for the advice!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1444324299, "creation_date": 1444324299, "answer_id": 33022033, "question_id": 33002510, "link": "https://stackoverflow.com/questions/33002510/prevent-save-in-word-save-as-is-okay/33022033#33022033", "title": "Prevent &quot;Save&quot; in Word (Save As is okay)", "body": "<p>Yes, your users should be creating new documents from a template. Save the template in the users' Templates folder so that they can access it via File/New when they want to create a new document...</p>\n\n<p>Concerning the code you show: Workbook is for Excel and won't trigger in Word. In Word the event is Document_BeforeSave and you'd want to set the SaveAsUI parameter to True to force the dialog box to show.</p>\n"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1983, "favorite_count": 0, "accepted_answer_id": 33022033, "answer_count": 1, "score": 0, "last_activity_date": 1594054639, "creation_date": 1444252416, "last_edit_date": 1594054639, "question_id": 33002510, "link": "https://stackoverflow.com/questions/33002510/prevent-save-in-word-save-as-is-okay", "title": "Prevent &quot;Save&quot; in Word (Save As is okay)", "body": "<p>I'm just wondering how to prevent (stop) a user from saving a document (just \"Save\", \"Save As\" is okay).  I have a .docm that I'm using as a template, where the user just fills in three fields.  I don't want them to accidentally fill it in, then save over the template.</p>\n\n<p>I've seen a <a href=\"https://stackoverflow.com/questions/16977599/how-to-disable-save-saveas-button-in-ms-word-2010-2013-using-vba\">few SO threads</a> that give code, but when I put the following in \"ThisDocument\" under \"Microsoft Word Objects\", nothing happens when I hit save:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    MsgBox (\"Please 'Save As' instead.\")\n    Debug.Print \"Someone tried to save.\"\n    Cancel = True\nEnd Sub\n</code></pre>\n\n<p>I'm expecting when I hit the save icon (or CTRL+S) the messagebox to pop up.  ..that doesn't happen (nor does the <code>debug.print</code> line work).  What am I overlooking?</p>\n\n<p>Related question: Should I just forget doing the above, and just create a true template document (.dotm)?</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5420294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dd278623d52e4a937311254eb3e4e2?s=128&d=identicon&r=PG&f=1", "display_name": "Vyshnav B C", "link": "https://stackoverflow.com/users/5420294/vyshnav-b-c"}, "edited": false, "score": 0, "creation_date": 1444257566, "post_id": 33002985, "comment_id": 53832118, "body": "So when i do execute the code, The structure works as follows :   If the recipient is ABC@gmail.com and XYZ@gmail.com then Check if The attachment has ENG. If its anything other than ENG -&gt; Execute MsgBox.  What i found is that the Code does not allow me to send a mail anymore. I tried varying the structure but it seems that whatever the recepient is, and whatever the attachment is ( Conforming or not ), it does not allow to send the mail."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 83, "user_id": 5420294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dd278623d52e4a937311254eb3e4e2?s=128&d=identicon&r=PG&f=1", "display_name": "Vyshnav B C", "link": "https://stackoverflow.com/users/5420294/vyshnav-b-c"}, "edited": false, "score": 0, "creation_date": 1444262731, "post_id": 33002985, "comment_id": 53833610, "body": "Cancel should start as False but you could try Cancel = False before the If statement so the default behavior is to Send. If both addresses have to be present change Or to And. Follow the path while debugging. You may find this useful cpearson.com/excel/DebuggingVBA.aspx"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1445987169, "last_edit_date": 1445987169, "creation_date": 1444254513, "answer_id": 33002985, "question_id": 33002064, "link": "https://stackoverflow.com/questions/33002064/validating-outlook-email-attachment-name-through-vb-macro/33002985#33002985", "title": "Validating Outlook Email Attachment Name through VB Macro", "body": "<p>Try testing within ItemSend. </p>\n\n<p>Something like this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\nDim att As attachment\nDim Attach_Name_Pass1 As String\nDim Region_Ext As String\nDim Region  As String\n\nCancel = False\n\nIf Item.Attachments.count = 0 Then\n    If MsgBox(\"There's no attachment, send anyway?\", vbYesNo) = vbNo Then Cancel = True\n\nElse\n    Debug.Print Item.To\n    If InStr(Item.To, \"ABC@gmail.com\") &gt; 0 Or InStr(Item.To, \"XYZ@gmail.com\") &gt; 0 Then\n\n        For Each att In Item.Attachments\n            Attach_Name_Pass1 = att.DisplayName\n            Region_Ext = Right(Attach_Name_Pass1, 7)\n            Region = Left(Region_Ext, 3)\n            'MsgBox region\n            Debug.Print Region\n\n            If Region &lt;&gt; \"ENG\" Then\n                Cancel = True\n                MsgBox \" Not an Acceptable Attachment. Send cancelled.\"\n                Exit For\n            End If\n        Next\n    End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5420294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04dd278623d52e4a937311254eb3e4e2?s=128&d=identicon&r=PG&f=1", "display_name": "Vyshnav B C", "link": "https://stackoverflow.com/users/5420294/vyshnav-b-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1540, "favorite_count": 0, "accepted_answer_id": 33002985, "answer_count": 1, "score": 0, "last_activity_date": 1593518374, "creation_date": 1444250537, "last_edit_date": 1593518374, "question_id": 33002064, "link": "https://stackoverflow.com/questions/33002064/validating-outlook-email-attachment-name-through-vb-macro", "title": "Validating Outlook Email Attachment Name through VB Macro", "body": "<p>Im creating an outlook Macro to validate an Email attachment and recipient name before sending the mail. </p>\n\n<p>The recipient name can be easily validated through the ItemSend Function on the Outlook session. </p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)   \nDim Recipients As Outlook.Recipients\nDim recip As Outlook.Recipient\nDim i\nDim prompt As String\n\nSet Recipients = Item.Recipients\nFor i = Recipients.Count To 1 Step -1\nSet recip = Recipients.Item(i)\n\nIf InStr(LCase(recip), \"bad@address.com\") Then\n  prompt$ = \"You sending this to this to \" &amp; Item.To &amp; \". Are you sure you want to send it?\"\n   If MsgBox(prompt$, vbYesNo + vbQuestion + vbMsgBoxSetForeground, \"Check Address\") = vbNo Then\n     Cancel = True\n   End If\nEnd If\n\nNext i  \nEnd Sub\n</code></pre>\n\n<p>While this helps with recipients, it does not allow to validate the attachment name before sending the mail. i.e Validate the Mail Draft. The code below helps to check for attachments present on the draft but does not help validate it.</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\nIf InStr(1, Item.Body, \"attach\", vbTextCompare) &gt; 0 Then\nIf Item.Attachments.Count = 0 Then\n    answer = MsgBox(\"There's no attachment, send anyway?\", vbYesNo)\nIf answer = vbNo Then Cancel = True\nEnd If\n</code></pre>\n\n<p>So i tried to add item.Attachment. Name \\ item.attachment.FileName but this works only if i attribute it to a outlook MailItem instead of a normal object. </p>\n\n<p>Is it possible to create code to validate the attachment name for certain criteria ( name should conform to certain naming constraints ). The code has already been created and works as a normal macro and not as a session Macro.</p>\n\n<pre><code>Function Segregate_Function(Attach_Name_Pass1 As String)\n\nDim FullName As String\nDim Recepients As String\n\nRegion_Ext = Right(Attach_Name_Pass1, 7)\nregion = Left(Region_Ext, 3)\n'MsgBox region\n\nIf region = \"ENG\" Then\nRecepients = \"ABC@gmail.com;XYZ@gmail.com\"\nCall Send_Function(Attach_Name_Pass1, Recepients)\nElse\nMsgBox \" Not an Acceptable Attachment. Mail Could not be Generated \"\nEnd If\nEnd Function\n</code></pre>\n\n<p>I would like the above code to execute when clicking on send to validate an attachment name directly, instead of having a procedural Macro running. </p>\n\n<p>Do advice.</p>\n"}, {"tags": ["excel", "image", "vba", "outlook"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1444277956, "post_id": 33001995, "comment_id": 53837486, "body": "Have a read on this <a href=\"http://excel-macro.tutorialhorizon.com/excel-vba-send-unique-images-embedded-to-mail-body-with-every-mail-from-ms-outlook-using-excel/\" rel=\"nofollow noreferrer\">http://excel-macro.tutorialhorizon.com/excel-vba-send-unique&zwnj;&#8203;-images-embedded-to-&zwnj;&#8203;mail-body-with-every&zwnj;&#8203;-mail-from-ms-outloo&zwnj;&#8203;k-using-excel/</a>"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1444496274, "creation_date": 1444496274, "answer_id": 33056550, "question_id": 33001995, "link": "https://stackoverflow.com/questions/33001995/copy-picture-in-excel-to-outlook-body/33056550#33056550", "title": "Copy picture in Excel to Outlook body", "body": "<p>By calling the following line of code:</p>\n\n<pre><code> ActiveSheet.Paste\n</code></pre>\n\n<p>you paste images on the Excel sheet, not in Outlook. </p>\n\n<p>You may try to use the Word object model to get images pasted into the mail item. The Outlook object model provides three main ways for working item bodies:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow\">Body</a> -  a string representing the clear-text body of the Outlook item. </li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow\">HTMLBody</a> - a string representing the HTML body of the specified item.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow\">Word editor</a> - the Microsoft Word Document Object Model of the message being displayed. The WordEditor property of the Inspector class returns an instance of the Document class from the Word object model which you can use to set up the message body.</li>\n</ol>\n\n<p>You can read more about all these ways in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a>. </p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840284.aspx\" rel=\"nofollow\">Paste</a> method of the Selection class inserts the contents of the Clipboard at the specified selection. </p>\n\n<p>Also you can attach images to the mail item, mark them as hidden setting an appropriate low-level property and mention them in the HTML markup of the body. </p>\n\n<pre><code>  Attachment attachment = newMail.Attachments.Add(\n @\"E:\\Pictures\\image001.jpg\"\n, OlAttachmentType.olEmbeddeditem\n, null\n, \"Some image display name\"\n);\n\nstring imageCid = \"image001.jpg@123\";\n\nattachment.PropertyAccessor.SetProperty(\n \"http://schemas.microsoft.com/mapi/proptag/0x3712001E\"\n, imageCid\n);\n\nnewMail.HTMLBody = String.Format(\n \"&lt;body&gt;&lt;img src=\\\"cid:{0}\\\"&gt;&lt;/body&gt;\"\n, imageCid\n);\n</code></pre>\n\n<p>See <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/6c063b27-7e8a-4963-ad5f-ce7e5ffb2c64/how-to-embed-image-in-html-body-in-c-into-outlook-mail?forum=vsto\" rel=\"nofollow\">how to embed image in html body in c# into outlook mail</a> for more information. </p>\n"}], "owner": {"reputation": 1, "user_id": 5420306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe993bf4438e35aefa920d7b0d56818?s=128&d=identicon&r=PG&f=1", "display_name": "Cs1422", "link": "https://stackoverflow.com/users/5420306/cs1422"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10994, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1601654635, "creation_date": 1444250189, "last_edit_date": 1444251343, "question_id": 33001995, "link": "https://stackoverflow.com/questions/33001995/copy-picture-in-excel-to-outlook-body", "title": "Copy picture in Excel to Outlook body", "body": "<p>I am trying to figure out how to get a picture from a spreadsheet in Excel into the body of an Outlook message. Here's what I have so far:  </p>\n\n<p>It creates the picture from the grouping of data that I need,<br>\ncopies it below, and<br>\nopens the mail with the initial message that I need  </p>\n\n<p>but I can't figure out how to link the two created images into the body of the email. As of now, I've been cutting them from each tab once created and just pasting them into the body.</p>\n\n<pre><code>Sub EmailDashboards()\n\nDim OutApp As Object\nDim outMail As Object\nSheets(\"CAM Dashboard Burdened\").Select\nRange(\"C1:J47\").Select\nSelection.CopyPicture Appearance:=xlScreen, Format:=xlPicture\nRange(\"K36\").Select\nActiveSheet.Paste\n\nSheets(\"CAM Dashboard Direct\").Select\nRange(\"C1:J47\").Select\nSelection.CopyPicture Appearance:=xlScreen, Format:=xlPicture\nRange(\"K36\").Select\nActiveSheet.Paste\n\nSheets(\"CAM Dashboard Burdened\").Select\nRange(\"K36\").Select\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet outMail = OutApp.CreateItem(0)\n\nWith outMail\n    .To = \"\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"CCM EV Dashboard\"\n    .Body = \"Here are the latest Burdened and Direct EV Dashboards for your area: \"\n    .Display\nEnd With\n\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet outMail = Nothing\nSet OutApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "if-statement"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1444248671, "post_id": 33001548, "comment_id": 53828023, "body": "Not familiar? Get familiar. Google <code>for</code> loop."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444255570, "post_id": 33001548, "comment_id": 53831373, "body": "You dont need vba to do this. You can generate the desired result in column C with a <code>=IF</code> formula, then copy C and paste values into A."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 5, "last_activity_date": 1444249306, "creation_date": 1444249306, "answer_id": 33001752, "question_id": 33001548, "link": "https://stackoverflow.com/questions/33001548/if-then-statement-with-loop/33001752#33001752", "title": "&#39;If ... Then&#39; statement with loop", "body": "<p>There are many ways, here is a typical one:</p>\n\n<pre><code>Sub dural()\n   Dim i As Long\n\n   i = 1\n   Do While Cells(i, \"B\").Value &lt;&gt; \"\"\n      If Cells(i, \"B\").Value = \"PM\" Then\n            Cells(i, \"A\").Value = Cells(i, \"A\").Value + 12\n      End If\n      i = i + 1\n   Loop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "is_accepted": false, "score": 0, "last_activity_date": 1444249526, "creation_date": 1444249526, "answer_id": 33001824, "question_id": 33001548, "link": "https://stackoverflow.com/questions/33001548/if-then-statement-with-loop/33001824#33001824", "title": "&#39;If ... Then&#39; statement with loop", "body": "<p>you can set it with For next loop and 2 variables. one for last row and the 2nd for the row count:</p>\n\n<pre><code>   Sub Macro1()\n\n        Dim LastRow As String\n        Dim i As Integer\n        LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n        For i = 1 To LastRow\n        If Cells(i, 2).Value = \"PM\" Then Cells(i, 1).vlaue = Cells(i, 1).vlaue + 10\n        Next i\n        End\n\n        '\n        End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444253365, "post_id": 33002444, "comment_id": 53830383, "body": "Does <code>UCase$(r.Value)</code> take <code>r.Value</code> and force it into a string? (In other words, what&#39;s the <code>$</code> doing in there)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1444276519, "post_id": 33002444, "comment_id": 53837119, "body": "UCase is a function that will turn a value into Upper Case. This is the generic type if you add the $ (UCase$) then it means that&#39;s optimized for string values and the code runs faster."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "is_accepted": false, "score": 0, "last_activity_date": 1444252099, "creation_date": 1444252099, "answer_id": 33002444, "question_id": 33001548, "link": "https://stackoverflow.com/questions/33001548/if-then-statement-with-loop/33002444#33002444", "title": "&#39;If ... Then&#39; statement with loop", "body": "<p>This is another way to do this. </p>\n\n<pre><code>Option Explicit\n\nSub Add()\n    Dim rData As Range\n    Dim r As Range\n\n    Set rData = Cells(1, 1).CurrentRegion.Columns(\"B\").Cells\n\n    For Each r In rData\n        If UCase$(r.Value) = \"PM\" Then\n            r.Offset(, -1).Value = r.Offset(, -1).Value + 12\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5372693, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/83845c68d36b6364e6657294fcb5f899?s=128&d=identicon&r=PG&f=1", "display_name": "Willarci3", "link": "https://stackoverflow.com/users/5372693/willarci3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36583, "favorite_count": 1, "accepted_answer_id": 33001752, "answer_count": 3, "score": 0, "last_activity_date": 1444252099, "creation_date": 1444248566, "last_edit_date": 1444249857, "question_id": 33001548, "link": "https://stackoverflow.com/questions/33001548/if-then-statement-with-loop", "title": "&#39;If ... Then&#39; statement with loop", "body": "<p>I've what seems like a pretty simple application with looping and 'If..Then' statements but need some help on structuring it. </p>\n\n<p>In very a basic example, I have a list numbers in column A and the values <code>PM</code> or <code>AM</code> listed in column B.  I want to write a loop that will search every value in column B until the end of the data set, and add <code>12</code> to each value in column A each time column B has a value of <code>PM</code>.  In a nutshell, it would look like this: </p>\n\n<ul>\n<li>If column B = <code>PM</code>  </li>\n<li>then add <code>12</code> to its corresponding cell in column A  </li>\n<li>else move down to the next row and do the same thing until you reach an empty cell</li>\n</ul>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 1806671, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496b2d17e3c896a47db0ff2c51cc2444?s=128&d=identicon&r=PG", "display_name": "wayfarer", "link": "https://stackoverflow.com/users/1806671/wayfarer"}, "is_accepted": false, "score": 0, "last_activity_date": 1444256981, "creation_date": 1444256981, "answer_id": 33003504, "question_id": 33001258, "link": "https://stackoverflow.com/questions/33001258/ms-project-vba-not-changing-cell-color/33003504#33003504", "title": "ms project vba not changing cell color", "body": "<p>This does it:</p>\n\n<p>Add this to the start of the subroutine</p>\n\n<pre><code>Dim wrkCHFlag As Boolean\nwrkCHFlag = False\nIf EnableChangeHighlighting Then\n   ToggleChangeHighlighting\n   wrkCHFlag = True\nEnd If`\n</code></pre>\n\n<p>and this to the end</p>\n\n<pre><code>If wrkCHFlag Then\n    ToggleChangeHighlighting\nEnd If\n</code></pre>\n\n<p>This <a href=\"http://epmainc.com/blog/disable-change-highlighting-microsoft-project-2010-and-2013\" rel=\"nofollow\">link</a> explains Change Highlighting.  I discovered the VBA ToggleChangeHighlighting instruction via a macro, which led to the EnableChangeHighlighting property.</p>\n"}], "owner": {"reputation": 686, "user_id": 1806671, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496b2d17e3c896a47db0ff2c51cc2444?s=128&d=identicon&r=PG", "display_name": "wayfarer", "link": "https://stackoverflow.com/users/1806671/wayfarer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1051, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444914113, "creation_date": 1444247626, "last_edit_date": 1444914113, "question_id": 33001258, "link": "https://stackoverflow.com/questions/33001258/ms-project-vba-not-changing-cell-color", "title": "ms project vba not changing cell color", "body": "<p>UPDATE:  Answered below</p>\n\n<p>In MS Project 2013 Pro, I created a custom field \"Pri\" (for priority) from the  \"Number10\" field.   Then I wrote the VBA routine below, which is activated from a button on a VBA form, to check the value of Pri and set the cell color accordingly.  It works, except...</p>\n\n<p>When I set the value of Pri, and run the routine, and then reset the value of Pri, and re-run the routine, it doesn't \"take\".  I can tell in watch that it has found the field, detected a \"Select Case\" value, and executed the CellColor assignment statement.  But the color of the cell doesn't change in the Gantt Chart view.</p>\n\n<p>I'm looking for a pattern here, and what I can see is:<br/>\n1) If I update Pri the field (i.e. change the value after the first add), and then update <strong>another</strong> task Pri field, it immediately applies the background to the one I wanted first wanted to change.<br/>\n2)  the newly updated Pri cell has a faint blue background;  is that some sort of \"tentative\" status?  Which might not be read by VBA?  If so, how to \"refresh\" or whatever to get the app to accept the value?<br/>\n=> this appears to be \"Change Highlighting\" described <a href=\"http://zo-d.com/blog/archives/project-2007/ms-project-2007-change-highlighting-and-the-interim-plan.html\" rel=\"nofollow\">here</a>;  what might be done with that?<br/>\n3) if I open and close the Outline section that contains the task, it sets the color correctly. Again, some kind of refresh?  More Change Highlighting?</p>\n\n<p>I added the ScreenUpdating = False/True lines at the beginning, in response to a bug report, however, no joy.</p>\n\n<p>==> Any suggestions?</p>\n\n<pre><code>Sub SetPriorityColors()\n\nScreenUpdating = False\nScreenUpdating = True\n\nSet ts = ActiveProject.Tasks\nFor n = 1 To ts.Count\nIf Not ts(n) Is Nothing Then\n    ts(n).OutlineShowAllTasks\nEnd If\nNext n\n\nFor n = 1 To ts.Count\nIf Not ts(n) Is Nothing Then\n    Set tsk = ts(n)\n    wrkName = tsk.Name\n    wrkID = tsk.ID\n    SelectTaskField Row:=wrkID, Column:=\"Number10\", RowRelative:=False\n    If wrkID = 23 Then\n        a = 1\n    End If\n\n    Select Case tsk.Number10\n        Case Is &gt;= 9\n            Font32Ex CellColor:=&amp;HFF99CC\n        Case Is &gt;= 8\n            Font32Ex CellColor:=&amp;H66CCFF\n        Case Is &gt;= 7\n            Font32Ex CellColor:=&amp;H66FFFF\n         Case Is = 0\n             Font32Ex CellColor:=&amp;HFFFFFF\n    End Select\n\nEnd If\n\nNext n\n\nSelectTaskField Row:=\"1\", Column:=\"Number10\", RowRelative:=False\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vb6", "vba", "migrate"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1444248273, "post_id": 33001205, "comment_id": 53827786, "body": "VBA files make no sense on their own. They must be inside a hosting application. If it happens so that you have a VBA file that does not refer to any features of the hosting app and is simply an abstract library, then you can paste it into a VB6 form as is. Otherwise it will fail anyway because it needs the host app running."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1444248414, "post_id": 33001205, "comment_id": 53827875, "body": "What application is your VBA code for?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1444251467, "post_id": 33001205, "comment_id": 53829489, "body": "VBA and VB6 use the same runtime, so as @GSerg points out you shouldn&#39;t need to &quot;rewrite&quot;, at least from the perspective of the core language."}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444256598, "post_id": 33001205, "comment_id": 53831798, "body": "@TimWilliams - exactly; it&#39;ll depend on what features of the host application (Excel, Word, etc) you make use of."}, {"owner": {"reputation": 7223, "user_id": 426, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IOSXQ.jpg?s=128&g=1", "display_name": "bugmagnet", "link": "https://stackoverflow.com/users/426/bugmagnet"}, "edited": false, "score": 0, "creation_date": 1444271598, "post_id": 33001205, "comment_id": 53835918, "body": "So take a meaningful slab of the VBA and drop it into the VB6 IDE and see what happens."}, {"owner": {"reputation": 125, "user_id": 4590265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5bb758766aa1e254b81b888e316b05?s=128&d=identicon&r=PG&f=1", "display_name": "AndroWeed", "link": "https://stackoverflow.com/users/4590265/androweed"}, "edited": false, "score": 0, "creation_date": 1444306803, "post_id": 33001205, "comment_id": 53854121, "body": "I&#39;ll explain; I have VBA files (.mdb files). Each one of them is actually a full VB project that contains forms and connects to an Access data base. I want to build a VB6 form with buttons, that would allow users to launch each one of these VBA modules, via a simple click on its corresponding button. So, what line of code in VB6, allows to launch a VBA file?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1444324432, "post_id": 33001205, "comment_id": 53866634, "body": "MDB is not a VBA file. MDB is a MS Access database which contains data and (optionally) a VBA project. If you manage to rewrite all your code into VB6 (you will have to approach it seriously because data access mechanisms are different when you&#39;re inside of a database and when you&#39;re outside), then you will still have to carry the original mdb file around, because it is the database with the data. At which point you might just not touch the mdb file and use it as is. If you want to use it on computers that don&#39;t have Office installed, there&#39;s a free MS Access Viewer available from Microsoft."}, {"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1444403479, "post_id": 33001205, "comment_id": 53904075, "body": "VBA and VB6 <b>do not</b> use the same runtime."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1444449270, "post_id": 33001205, "comment_id": 53920865, "body": "@Bob77 - I don&#39;t know about VBA7, but I believe it to be the case for VB6 and VBA6   For example see answers and comments here: <a href=\"http://stackoverflow.com/questions/993300/difference-between-visual-basic-and-vba\" title=\"difference between visual basic and vba\">stackoverflow.com/questions/993300/&hellip;</a>"}, {"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1444478221, "post_id": 33001205, "comment_id": 53927495, "body": "I&#39;m sure there was a ton of code sharing at the source level but they don&#39;t use the same runtime DLLs.  The linked question was about source-level compatibility between VB6 and VBA source and says nothing of significance about the runtime components.  Even with a version of Office installed VB6 programs won&#39;t run without the VB6 runtimes - though unlike the Office runtimes the VB6 runtimes come preinstalled as part of Windows these days."}, {"owner": {"reputation": 7658, "user_id": 3195477, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/PK4P1.jpg?s=128&g=1", "display_name": "StayOnTarget", "link": "https://stackoverflow.com/users/3195477/stayontarget"}, "edited": false, "score": 0, "creation_date": 1534161353, "post_id": 33001205, "comment_id": 90597396, "body": "Re: the update - the error is that it can&#39;t find &quot;db.mdb&quot; but your code is looking for &quot;presto.mdb&quot;. Confused."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 4590265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5bb758766aa1e254b81b888e316b05?s=128&d=identicon&r=PG&f=1", "display_name": "AndroWeed", "link": "https://stackoverflow.com/users/4590265/androweed"}, "edited": false, "score": 0, "creation_date": 1444310718, "post_id": 33016564, "comment_id": 53857294, "body": "I appreciate your suggestion. But it&#39;s impossible to make. As I said, each VBA file is a full project apart. We don&#39;t have time to re-write a 10 years of work in VB6. So what we need is simply call those VBA files from a VB6 form buttons each."}], "tags": [], "owner": {"reputation": 431, "user_id": 4464987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1f0298854d39dafa98957a352f63b8a5?s=128&d=identicon&r=PG&f=1", "display_name": "Fab", "link": "https://stackoverflow.com/users/4464987/fab"}, "is_accepted": false, "score": 0, "last_activity_date": 1444314471, "last_edit_date": 1444314471, "creation_date": 1444309101, "answer_id": 33016564, "question_id": 33001205, "link": "https://stackoverflow.com/questions/33001205/is-it-possible-to-run-a-vba-file-from-a-vb6-application/33016564#33016564", "title": "Is it possible to run a VBA file from a VB6 application?", "body": "<p>It would be better to design a new form in VB6 with button as you said but also with some text(s)/list(s)/whatever(s) you want to display the results, then you copy/paste VBA code into button_click(s) event(s) to execute it and add to that vba code some output to the text(s)/list(s)/whatever(s) you decided to put on the VB6 form.</p>\n\n<p>Edit : Ok, so taking your comment in consideration perhaps that trick could help avoiding re-write thousands of line code : add in the VBA code a while loop that trigger some Sub or Function on the presence of a flag on the system (a specific c:\\temp\\fileFlag.txt for example) so as soon as it appear the VBA code is called... if the VB6 control the flag would it do the job ? :)</p>\n"}, {"comments": [{"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1444403726, "post_id": 33020994, "comment_id": 53904227, "body": "VB.Net mutates rapidly though so you might have to resign yourself to a far more costly cycle of ongoing maintenance."}], "tags": [], "owner": {"reputation": 10544, "user_id": 6244, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1e037aa722c82abdf479a505a36bf1ed?s=128&d=identicon&r=PG", "display_name": "Toby Allen", "link": "https://stackoverflow.com/users/6244/toby-allen"}, "is_accepted": true, "score": 1, "last_activity_date": 1444320957, "creation_date": 1444320957, "answer_id": 33020994, "question_id": 33001205, "link": "https://stackoverflow.com/questions/33001205/is-it-possible-to-run-a-vba-file-from-a-vb6-application/33020994#33020994", "title": "Is it possible to run a VBA file from a VB6 application?", "body": "<p>Without knowing the structure of your VB6 application and your access files and what they do, it is virtually impossible to give any sort of useful answer.  </p>\n\n<p>What you want to do is not easily possible, as stated in comments VBA projects are not designed to work in this way.</p>\n\n<p>However here are some suggestions.</p>\n\n<ol>\n<li>Investigate the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192075.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">RunMacro</a> command and see if this is of use to you. </li>\n<li>You could try to use a tool like <a href=\"http://www.autohotkey.com/\" rel=\"nofollow\">autohotkey</a> to record mouse clicks where you want them and replay from your VB6 app.</li>\n<li>Look at pulling out sections of VBA that are business logic and directly copy and paste code into your VB6 app.  This may or may not work depending on the code.</li>\n<li>Begin the slow process of rewriting (but don't rewrite in VB6, use VB.Net, C# or do  a web app or something at least resembling a 2015 application).</li>\n</ol>\n\n<p>If you want my honest advice begin to migrate to a more modern solution such as VB.NET so you won't have an even worse problem in 2020.</p>\n\n<p>There is <strong>NO</strong> silver bullet for your problem.</p>\n"}], "owner": {"reputation": 125, "user_id": 4590265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5bb758766aa1e254b81b888e316b05?s=128&d=identicon&r=PG&f=1", "display_name": "AndroWeed", "link": "https://stackoverflow.com/users/4590265/androweed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 33020994, "answer_count": 2, "score": 3, "last_activity_date": 1445066130, "creation_date": 1444247426, "last_edit_date": 1444503566, "question_id": 33001205, "link": "https://stackoverflow.com/questions/33001205/is-it-possible-to-run-a-vba-file-from-a-vb6-application", "title": "Is it possible to run a VBA file from a VB6 application?", "body": "<p>I have a very large amount of code written in VBA in Access .mdb files, containing forms and connecting to an Access data base. I need to migrate this code to a VB6 application. It isn't practical to rewrite all of it as there is just too much. </p>\n\n<p>Is there a way to call that VBA file from a VB6 form with buttons, that would allow users to launch each one of these VBA modules, via a simple click on its corresponding button? What line of code in VB6, allows to launch a VBA file?</p>\n\n<p><strong>Update</strong></p>\n\n<p>I finally succeeded to figure out how to launch a VBA mdb file from my VB6 form using this instruction :</p>\n\n<pre><code>Call Shell(\"C:\\Program Files (x86)\\Microsoft Office\\OFFICE11\\MSACCESS.EXE C:\\presto.mdb /runtime /cmd\", 1)\n</code></pre>\n\n<p>So the VBA project is now launched from the VB6 form, but it crashes, at start up, showing this error \"Runtime error \u20183024\u2019 Could not find file \u2018C:\\db.mdb\u2019\". \nI feel like I'm half way to thee solution. But I don't know what am I missing here?</p>\n"}, {"tags": ["excel", "vba", "date"], "answers": [{"comments": [{"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "reply_to_user": {"reputation": 21, "user_id": 5416058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc7bc50940d2b299f23ca23212c8a27?s=128&d=identicon&r=PG&f=1", "display_name": "snm", "link": "https://stackoverflow.com/users/5416058/snm"}, "edited": false, "score": 0, "creation_date": 1444617677, "post_id": 33001488, "comment_id": 53962841, "body": "Please mark as the answer if this solved you question."}], "tags": [], "owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "is_accepted": false, "score": 1, "last_activity_date": 1444248319, "creation_date": 1444248319, "answer_id": 33001488, "question_id": 33001199, "link": "https://stackoverflow.com/questions/33001199/calculate-weekdays-with-date-functions/33001488#33001488", "title": "Calculate weekdays with Date functions", "body": "<p>I was able to get the same output if i added parenthesis after <code>Now</code> and remove the quotes from the last input of the <code>DateAdd</code> function and the endDate variable. The quotes make the code think you are passing in a string instead of a function or variable.</p>\n\n<p>So your VBA would look like:</p>\n\n<p><code>endDate = DateAdd(\"D\", -DatePart(\"W\", DateValue(Now())) + 1, DateValue(Now()))</code></p>\n\n<p><code>startDate = DateAdd(\"D\", -6, endDate)</code></p>\n"}], "owner": {"reputation": 21, "user_id": 5416058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc7bc50940d2b299f23ca23212c8a27?s=128&d=identicon&r=PG&f=1", "display_name": "snm", "link": "https://stackoverflow.com/users/5416058/snm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444251011, "creation_date": 1444247406, "last_edit_date": 1444251011, "question_id": 33001199, "link": "https://stackoverflow.com/questions/33001199/calculate-weekdays-with-date-functions", "title": "Calculate weekdays with Date functions", "body": "<p>Below is my SQL code to calculate the weekdays for the report. I am trying to get the same result with VBA Excel.</p>\n\n<pre><code>set @end_date = DATEADD(DD,-DATEPART(dw,GETDATE())+1,GETDATE())\nset @begin_date = DATEADD(DD,-6,@end_date)\n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code>endDate = DateAdd(\"D\", -DatePart(\"W\", DateValue(Now)) + 1, \"DateValue(Now)\")\nstartDate = DateAdd(\"D\", -6, \"endDate\")\n</code></pre>\n\n<p>However I can't get the result!</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 921, "user_id": 5203628, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GwHC7.png?s=128&g=1", "display_name": "Rob S.", "link": "https://stackoverflow.com/users/5203628/rob-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1444248018, "last_edit_date": 1444248018, "creation_date": 1444247658, "answer_id": 33001271, "question_id": 33001108, "link": "https://stackoverflow.com/questions/33001108/using-vba-to-email-a-file-without-using-outlook/33001271#33001271", "title": "Using VBA to email a file without using outlook", "body": "<p>The best way to do this is to use an SMTP (Simple Mail Transfer Protocol) Server.  Luckily Gmail is set up to do this easily.  There is a tutorial here that will walk you through step-by-step.  I have used this method many times and it works very well.</p>\n\n<p><a href=\"http://www.blueclaw-db.com/access_email_gmail.htm\" rel=\"nofollow\">VBA Email with Gmail</a></p>\n\n<p>Edit to add link on File Attachment:</p>\n\n<p><a href=\"http://blogs.technet.com/b/heyscriptingguy/archive/2004/11/29/how-can-i-attach-a-file-to-an-email-sent-using-cdo.aspx\" rel=\"nofollow\">File Attachment using CDO</a></p>\n"}], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 0, "accepted_answer_id": 33001271, "answer_count": 1, "score": 1, "last_activity_date": 1444248018, "creation_date": 1444247090, "question_id": 33001108, "link": "https://stackoverflow.com/questions/33001108/using-vba-to-email-a-file-without-using-outlook", "title": "Using VBA to email a file without using outlook", "body": "<p>If outlook is not installed on a computer, is there anyway of using another mail client to send emails eg \"Windows live 2012\", \"Thunderbird\" or another?</p>\n\n<p>If outlook is needed, then is there a free version that can be used ( can it be used on windows 10 and 7?)</p>\n\n<p>Also related, is that when I use word on window 10, the default windows 10 mail client will not let me mail merge from word to an email.  I installed Windows live 2012 to get around this.   I though this was a bit rubbish that windows 10 behaved in this way by default.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1444247470, "creation_date": 1444247470, "answer_id": 33001220, "question_id": 33001048, "link": "https://stackoverflow.com/questions/33001048/cant-set-up-mail-with-vba-when-changed-to-windows-10/33001220#33001220", "title": "Can&#39;t set up mail with VBA when changed to Windows 10", "body": "<p>To/CC/BCC properties are recipient names. These properties are updated when the item is saved. Are you seeing empty To/CC in the Sent Items folder in Outlook?</p>\n\n<p>You can also use <code>OutMail.Recpients.Add</code> for each recipient.</p>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 5112449, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLhPsCK2oQg/AAAAAAAAAAI/AAAAAAAAABs/CYy3w4tb5FI/photo.jpg?sz=128", "display_name": "David Con", "link": "https://stackoverflow.com/users/5112449/david-con"}, "is_accepted": false, "score": 0, "last_activity_date": 1461853909, "last_edit_date": 1461853909, "creation_date": 1461852463, "answer_id": 36917160, "question_id": 33001048, "link": "https://stackoverflow.com/questions/33001048/cant-set-up-mail-with-vba-when-changed-to-windows-10/36917160#36917160", "title": "Can&#39;t set up mail with VBA when changed to Windows 10", "body": "<p>You can use for \"To\":</p>\n\n<pre><code>Set _To = OutMail.Recipient.Add(Range(\"A1\"))\n_To.Type = olTo\n</code></pre>\n\n<p>You can use for \"CC\":</p>\n\n<pre><code>Set _To = OutMail.Recipient.Add(Range(\"A2\"))\n_To.Type = olCC\n</code></pre>\n\n<p>My problem now is how to fix the other propieties, Subject and SentOnBehalfOnName</p>\n"}, {"comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498161802, "post_id": 44707318, "comment_id": 76399749, "body": "Welcome to S.O., <code>Set rngTo = .Range(&quot;B1&quot;).Value</code> is a type mismatch."}], "tags": [], "owner": {"reputation": 1, "user_id": 8201628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede3cbe1278d73c95be1e4d3b1b3ebc6?s=128&d=identicon&r=PG&f=1", "display_name": "Jaccobk", "link": "https://stackoverflow.com/users/8201628/jaccobk"}, "is_accepted": false, "score": -1, "last_activity_date": 1498157686, "creation_date": 1498157686, "answer_id": 44707318, "question_id": 33001048, "link": "https://stackoverflow.com/questions/33001048/cant-set-up-mail-with-vba-when-changed-to-windows-10/44707318#44707318", "title": "Can&#39;t set up mail with VBA when changed to Windows 10", "body": "<p>Tomas</p>\n\n<p>I just went to Windows 10 from 7. For some reason you have to add .Value.</p>\n\n<p>Example 1.</p>\n\n<pre><code>With ActiveSheet\n    Set rngTo = .Range(\"B1\").Value\n    Set rngCc = .Range(\"B3\").Value\n    Set rngSubject = .Range(\"B2\").Value\n    Set rngBody = .Range(\"B2\").Value\nEnd With\nWith OutMail\n    .To = rngTo\n    .CC = rngCc\n    .BCC = \"\"\n    .Subject = rngSubject\nEnd With\n</code></pre>\n\n<p>I wrote mine a little different. See example 2.</p>\n\n<p>Example 2</p>\n\n<pre><code> With OutMail\n        .To = Range(\"AA22\").Value\n        .CC = Range(\"AB22\").Value\n        .Subject = Range(\"AA21\").Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5420116, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bps9HCMQKcA/AAAAAAAAAAI/AAAAAAAAAAA/3l-pW1v6i74/photo.jpg?sz=128", "display_name": "Tomas Icaza", "link": "https://stackoverflow.com/users/5420116/tomas-icaza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2693, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1591200598, "creation_date": 1444246905, "last_edit_date": 1444250849, "question_id": 33001048, "link": "https://stackoverflow.com/questions/33001048/cant-set-up-mail-with-vba-when-changed-to-windows-10", "title": "Can&#39;t set up mail with VBA when changed to Windows 10", "body": "<p>For long time I have used a macro to send an Excel worksheet via mail but when I updated to Windows 10 everything failed and I cannot understand why. This is the code:</p>\n\n<pre><code>TempFilePath = Environ$(\"temp\") &amp; \"\\\"\nTempFileName = Range(\"B2\") &amp; \" \" &amp; Format(Now, \"dd-mmm-yy\")\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nSet OutMail = OutApp.CreateItem(0)\n\nWith Destwb\n    .SaveAs TempFilePath &amp; TempFileName &amp; FileExtStr, _\n            FileFormat:=FileFormatNum\n    On Error Resume Next\n   ' Change the mail address and subject in the macro before\n   ' running the procedure.\n    With ActiveSheet\n        Set rngTo = .Range(\"B1\")\n        Set rngCc = .Range(\"B3\")\n        Set rngSubject = .Range(\"B2\")\n        Set rngBody = .Range(\"B2\")\n    End With\n\n    With OutMail\n        .To = rngTo\n        .CC = rngCc\n        .BCC = \"\"\n        .Subject = rngSubject\n        .Body = \"Adjunto para tu revisi\u00f3n y comentarios\"\n        .Attachments.Add Destwb.FullName\n        ' You can add other files by uncommenting the following statement.\n        '.Attachments.Add (\"C:\\test.txt\")\n        ' In place of the following statement, you can use \".Display\" to\n        ' display the mail.\n        .Send\n    End With\n    On Error GoTo 0\n    .Close SaveChanges:=False\nEnd With\n\n' Delete the file after sending.\nKill TempFilePath &amp; TempFileName &amp; FileExtStr\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n</code></pre>\n\n<p>The problem is in the <code>.to, .cc, .subject</code> part.</p>\n\n<p>If I debug the code I can see that the variables are filled, for example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5tygv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5tygv.png\" alt=\"The .toMail\"></a></p>\n\n<p>But when it sends or displays the fields they are empty. Also, if  manually fill the <code>.to=\"a@a.com\"</code> it works.</p>\n\n<p>Do you know what can it be?</p>\n"}, {"tags": ["excel", "oracle", "vba", "ms-access"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444245753, "post_id": 33000603, "comment_id": 53826209, "body": "If <code>_GET_ITEM_INFO</code> is the name of the linked table from Access&#39; point of view, can you use just this? <code>DoCmd.TransferSpreadsheet acExport, 8, &quot;_GET_ITEM_INFO&quot;, path, True</code>"}, {"owner": {"reputation": 1, "user_id": 4435282, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000036850767/picture?type=large", "display_name": "Jan Hejda", "link": "https://stackoverflow.com/users/4435282/jan-hejda"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444250671, "post_id": 33000603, "comment_id": 53829053, "body": "It is just query (_GET_ITEM_INFO ).  It does not work because access can not handle query which connect to other database (for this case its oracle DB) - maybe I read it bad?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444251023, "post_id": 33000603, "comment_id": 53829242, "body": "That surprises me.  When error message do you get when you try exporting that <code>_GET_ITEM_INFO</code> query to Excel?"}, {"owner": {"reputation": 1, "user_id": 4435282, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000036850767/picture?type=large", "display_name": "Jan Hejda", "link": "https://stackoverflow.com/users/4435282/jan-hejda"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444252290, "post_id": 33000603, "comment_id": 53829852, "body": "Object is not supported. (its type of query which connect to oracle), others queries work fine (insert, update, select just from access table) thats why I copy query to table in method 2 but this take lots of time I guess."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444252602, "post_id": 33000603, "comment_id": 53830008, "body": "Sorry, I&#39;m stumped.  Since you can&#39;t export the query, I&#39;m curious to see whether anyone else can offer a faster alternative than those two you have now.  Good luck."}], "answers": [{"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 1, "last_activity_date": 1444261602, "creation_date": 1444261602, "answer_id": 33004271, "question_id": 33000603, "link": "https://stackoverflow.com/questions/33000603/export-query-from-oracle-through-ms-access-2003-to-ms-excel/33004271#33004271", "title": "Export query from Oracle through MS Access 2003 to MS Excel", "body": "<p>Do it directly from Excel.  From the data tab in Excel, click \"From Access,\" pick your database and query, and it will return the query directly into Excel.</p>\n\n<p>Of course, my addendum to this would be to bypass Access entirely.  Decompose your _GET_ITEM_INFO query into actual SQL (assuming all of the data resides natively in Oracle) and run it directly in Excel, via MS Query.</p>\n\n<p>Both of these methods have the added advantage of single-click refreshing of the data.</p>\n"}], "owner": {"reputation": 1, "user_id": 4435282, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000036850767/picture?type=large", "display_name": "Jan Hejda", "link": "https://stackoverflow.com/users/4435282/jan-hejda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444294088, "creation_date": 1444245265, "last_edit_date": 1444248397, "question_id": 33000603, "link": "https://stackoverflow.com/questions/33000603/export-query-from-oracle-through-ms-access-2003-to-ms-excel", "title": "Export query from Oracle through MS Access 2003 to MS Excel", "body": "<p>I need find the fastest method for exporting a query from Oracle through MS Access 2003 to MS Excel. The row count is about 34,000.</p>\n\n<p>Method 1</p>\n\n<pre><code>CopyFromRecordset MyRecordset\n</code></pre>\n\n<p>TIME: <strong>9 minutes</strong></p>\n\n<p>Method 2</p>\n\n<pre><code>DoCmd.RunSQL \"SELECT * INTO TBL_GET_ITEM_INFO FROM _GET_ITEM_INFO\" \nDoCmd.TransferSpreadsheet acExport, 8, \"TBL_GET_ITEM_INFO\", path, True\n</code></pre>\n\n<p>TIME: <strong>9 minutes</strong></p>\n\n<p>Is there a faster way?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444246435, "post_id": 33000533, "comment_id": 53826609, "body": "If you make <code>col a string</code> then use this <code>i = Range(col &amp; 1).Column</code> then you can use <code>Field:=i,</code>"}, {"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444247185, "post_id": 33000533, "comment_id": 53827085, "body": "Thanks. It works for my 3rd question. Do u know the solution to the 1st and 2nd question.Is it possible?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444247283, "post_id": 33000533, "comment_id": 53827143, "body": "Usually one would filter color that they want, not what they don&#39;t want. You may have to loop through the cells."}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1444249336, "post_id": 33001473, "comment_id": 53828373, "body": "Thanks, but I am getting error at                                                            .AutoFilter Field:=iFLD, Criteria1:=dNOTBLUs.Keys, Operator:=xlFilterValues       Type mismatch error on this statement. Is it because I have sentences in it, where few words are blue and not all?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1444249500, "post_id": 33001473, "comment_id": 53828454, "body": "Well, I assure you that I do not photoshop sample images. Perhaps you could add some sample data and detail the error you are receiving. Off-hand, you might try changing the <code>.Cells(r, iFLD).Text</code> to <code>.Cells(r, iFLD).Value</code>."}, {"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1444406869, "post_id": 33001473, "comment_id": 53906241, "body": "It worked when I just had blue font used.I have shown the eg in my actual question where it did not completely work. An another issue that I am having is when I shift the titles to start from 3rd row leaving first two lines empty. I changed                  For r =4 but it throws an error saying &quot;AutoFilter method of Range class failed&quot;. Is there something that I need to change for this code not to throw error."}, {"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1444661718, "post_id": 33001473, "comment_id": 53984668, "body": "please see @Jeeped the eg in my actual question where it failed. does the code not work for this. But this helped answer my 2nd question. Is there any change which will do the trick and also how do I change when the headers start from 3rd Row"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1444248276, "last_edit_date": 1592644375, "creation_date": 1444248276, "answer_id": 33001473, "question_id": 33000533, "link": "https://stackoverflow.com/questions/33000533/vba-to-autofilter-using-for-criteria-to-filter-on-fontcolor/33001473#33001473", "title": "vba to Autofilter using &quot;&lt;&gt;&quot; for criteria to filter on fontcolor", "body": "<p>In the past, I've used a method of collecting all non-conforming (i.e. <em>non-blue</em>) values from the filter field into an array and then filtering on the array. Your problem seemed similar so I adapted the procedure for the filter field's font color.</p>\n<pre><code>Sub Not_Blue()\n    Dim r As Long, iFLD  As Long\n    Dim dNOTBLUs As Object    'New Scripting.Dictionary\n    \n    Set dNOTBLUs = CreateObject(&quot;Scripting.Dictionary&quot;)\n    dNOTBLUs.CompareMode = vbTextCompare\n    \n    With ActiveSheet.Cells(1, 1).CurrentRegion\n        If .Parent.AutoFilterMode Then .Parent.AutoFilterMode = False\n    \n        iFLD = 3   ' get your filter column here\n        For r = 2 To .Cells(Rows.Count, iFLD).End(xlUp).Row\n            '~~&gt; collect unique non-blue values\n            If .Cells(r, iFLD).Font.Color &lt;&gt; RGB(0, 0, 255) Then _\n                dNOTBLUs.Add Key:=.Cells(r, iFLD).Text, Item:=.Cells(r, iFLD).Value2\n        Next r\n    \n        .AutoFilter Field:=iFLD, Criteria1:=dNOTBLUs.Keys, Operator:=xlFilterValues\n        \n        'column iFLD is filtered for all non-blur fonts\n        'do something with the filtered results here\n        \n    End With\n    \n    dNOTBLUs.RemoveAll: Set dNOTBLUs = Nothing\nEnd Sub\n</code></pre>\n<p>That collects a unique list of all non-blue values into a scripting dictionary. It uses the unique <strong>key</strong> list as the array to filter on. Essentially, you are abandoning the <code>xlFilterFontColor</code> but achieving the same results.</p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/18iul.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/18iul.png\" alt=\"AutoFilter by not color\" /></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>Before</sup></p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/KkkMO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KkkMO.png\" alt=\"AutoFilter by not color results\" /></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>After</sup></p>\n<hr />\n<p><sub>If you can convert the late binding of the Scripting.Dictionary to early binding, you must add <strong>Microsoft Scripting Runtime</strong> to the VBE's Tools \u25ba References.</sub></p>\n"}], "owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2087, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444404873, "creation_date": 1444245064, "last_edit_date": 1531164843, "question_id": 33000533, "link": "https://stackoverflow.com/questions/33000533/vba-to-autofilter-using-for-criteria-to-filter-on-fontcolor", "title": "vba to Autofilter using &quot;&lt;&gt;&quot; for criteria to filter on fontcolor", "body": "<p>This is snippet of my code:</p>\n\n<pre><code>Dim col As Integer\ncol = InputBox(\"Please enter column number to search\", \"Need Input\", 0)\nActiveSheet.AutoFilterMode = False\n\nWith ActiveSheet\nSet rnData = .UsedRange\n    With rnData\n        .AutoFilter Field:=col, Criteria1:=\"&lt;&gt;RGB(0, 0, 255)\", Operator:=xlFilterFontColor      \n    End With\nEnd With\n</code></pre>\n\n<p>This throws an error but works when I remove  &lt;> and \"\" to select blue font but I want non blue font. \nQuestions:\n The col that I want to filter has some sentences in which few words have different font Colors(red,blue,green...) or all just black \n1) I want to filter on non blue color.\n2) Filter on only black fontcolor with no words being of different color.how do I achieve that?\n3) Is there a way to give the colummn as alphabets instead of column number- basically does the field accept alphabets instead of numbers to indicate column.</p>\n\n<p>When i used @jeeped code for an eg<a href=\"https://i.stack.imgur.com/hffhz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hffhz.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>after running the code then it gives this<a href=\"https://i.stack.imgur.com/7vWgp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7vWgp.png\" alt=\"enter image description here\"></a></p>\n\n<p>which is what I am not clear why it is not able  find non blue.</p>\n"}, {"tags": ["html", "vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 55, "user_id": 2943382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjemO.jpg?s=128&g=1", "display_name": "lasoon", "link": "https://stackoverflow.com/users/2943382/lasoon"}, "edited": false, "score": 0, "creation_date": 1444271559, "post_id": 33000409, "comment_id": 53835910, "body": "Do you guys have any insights?"}, {"owner": {"reputation": 55, "user_id": 2943382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjemO.jpg?s=128&g=1", "display_name": "lasoon", "link": "https://stackoverflow.com/users/2943382/lasoon"}, "edited": false, "score": 0, "creation_date": 1444755684, "post_id": 33000409, "comment_id": 54031438, "body": "I am bumping this question. I would really find it helpful if you could take a look. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 5436521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494fc09a69813b9070410e527ee70dca?s=128&d=identicon&r=PG&f=1", "display_name": "rookiedee", "link": "https://stackoverflow.com/users/5436521/rookiedee"}, "is_accepted": false, "score": 0, "last_activity_date": 1444833712, "last_edit_date": 1444833712, "creation_date": 1444832960, "answer_id": 33128151, "question_id": 33000409, "link": "https://stackoverflow.com/questions/33000409/vba-randomly-stops-executing-loop-due-to-internet-break-how-to-resume-when-inte/33128151#33128151", "title": "VBA randomly stops executing loop due to internet break. How to resume when Internet comes back on?", "body": "<p>I am not sure if this will work. But did you try using the <code>Sleep</code> function? I would try insering it like this:</p>\n\n<p>With <code>.document</code></p>\n\n<pre><code>Sheets(\"Data Pull Adj Close Yahoo\").Cells(3, 7 * i) =\n    .getElementById(\"yfs_l84_\" &amp; Arrays(i)).innerText\nSleep 10000\n...\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 2943382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjemO.jpg?s=128&g=1", "display_name": "lasoon", "link": "https://stackoverflow.com/users/2943382/lasoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1444833712, "creation_date": 1444244693, "last_edit_date": 1444244845, "question_id": 33000409, "link": "https://stackoverflow.com/questions/33000409/vba-randomly-stops-executing-loop-due-to-internet-break-how-to-resume-when-inte", "title": "VBA randomly stops executing loop due to internet break. How to resume when Internet comes back on?", "body": "<p>I have written VBA code to extract data from Yahoo Finance. For the most part, the code is doing its job and extracting what I want it to. However, every so often, it gets stuck while it loops through different companies and the whole code stops working. I suspect that this might be occurring due to the internet connection momentarily breaking when it is looping through a particular company. To be specific, I think this is occurring in the following block of my code:</p>\n\n<pre><code>For i = 1 To 14\n   .navigate \"http://finance.yahoo.com/q/hp?s=\" &amp; Arrays(i) &amp; \"+Historical+Prices\"\n   Do While .busy: DoEvents: Loop\n   Do While .ReadyState &lt;&gt; 4: DoEvents: Loop here\n</code></pre>\n\n<p>Where the internet most likely breaks as it is trying to navigate the ith company (Arrays(i)) and causes the code to loop infinitely at <code>Do While .ReadyState &lt;&gt; 4: DoEvents: Loop.ReadyState &lt;&gt;4</code>. For some reason, the code doesn't work even after the internet switches back on and just keeps getting stuck trying to execute navigation to this ith Arrays. Why might this be? Is there a way to correct this? </p>\n\n<p>Note: It works perfectly if I End the execution of the Macro and restart it. </p>\n\n<p>Here is the full block of code for your reference.</p>\n\n<pre><code>Sub GetYahooFinanceTable()\n    Dim sURL As String, sResult As String\n    Dim oResult As Variant, oData As Variant, R As Long, C As Long, Arrays(30) As String, IE As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    For i = 1 To 14\n        Arrays(i) = Sheets(\"List of Companies\").Cells(i, 1).Value\n    Next i\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    With IE\n       .Visible = False\n       For i = 1 To 14\n           .navigate \"http://finance.yahoo.com/q/hp?s=\" &amp; Arrays(i) &amp; \"+Historical+Prices\"\n           Do While .busy: DoEvents: Loop\n           Do While .ReadyState &lt;&gt; 4: DoEvents: Loop\n           With .document\n              Sheets(\"Data Pull Adj Close Yahoo\").Cells(3, 7 * i) = .getElementById(\"yfs_l84_\" &amp; Arrays(i)).innerText\n           End With\n       Next i\n    End With\nSet IE = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "alert"], "owner": {"reputation": 101, "user_id": 4421736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7620ee5df01f1614bcf9c43a30632631?s=128&d=identicon&r=PG&f=1", "display_name": "Bernat", "link": "https://stackoverflow.com/users/4421736/bernat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1444320614, "creation_date": 1444244487, "last_edit_date": 1444320614, "question_id": 33000352, "link": "https://stackoverflow.com/questions/33000352/obtain-id-or-description-of-bypassed-alert", "title": "Obtain ID or description of bypassed alert", "body": "<p>I'm developing my macro for being able to run fully automated without any issues for a longer time period. But from time to time I get alerts during runtime (for example <em>Excel cannot display more than 1000 labels</em>). I want to be notified about any ongoing issues such as alerts without stopping the macro.</p>\n\n<p>The well known <code>Application.DisplayAlerts = False</code> is not enough for me since I would like to identify any kind of alerts and at least put its ID or description into my log file whenever it is due.</p>\n\n<p>Is there any way to get the ID or any kind of description of the bypassed alert?</p>\n"}, {"tags": ["xml", "vba", "excel", "date", "format"], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 0, "last_activity_date": 1444245844, "creation_date": 1444245844, "answer_id": 33000751, "question_id": 33000202, "link": "https://stackoverflow.com/questions/33000202/excel-sheet-using-xml-as-data-source-and-formatting-of-dates/33000751#33000751", "title": "Excel sheet, using XML as data source and formatting of dates", "body": "<p>You could probably add a column with formula </p>\n\n<p><code>=Text(\"$A$1\",\"mm/dd/yyyy\")</code></p>\n\n<p>where <code>$A$1</code> is a reference to your date value. Your date value can be a real date and easy to type, while the new column is a text representation of the date. </p>\n"}], "owner": {"reputation": 1, "user_id": 5419934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8773f39ae3f786ff575001e11b11efcd?s=128&d=identicon&r=PG&f=1", "display_name": "user5419934", "link": "https://stackoverflow.com/users/5419934/user5419934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508998922, "creation_date": 1444243913, "last_edit_date": 1508998922, "question_id": 33000202, "link": "https://stackoverflow.com/questions/33000202/excel-sheet-using-xml-as-data-source-and-formatting-of-dates", "title": "Excel sheet, using XML as data source and formatting of dates", "body": "<p>VBA and date formatting.  I've looked everywhere I can think, and haven't found a solution yet.  I know it's out there, but am running out of time searching.</p>\n\n<p>I have an Excel sheet that binds to an XML file.  The dates in the XML file start out as mm/dd/yyyy. They import into the Excel sheet fine.  BUT, if I define the cell as a date format, and then export the data back into my XML file, the file is a serial date, and not the formatted mm/dd/yyyy date I need</p>\n\n<pre><code>Sub FormatDateCells()\n      oSh.Cells.Range(\"I8\").NumberFormat = \"mm/dd/yyyy\"\nEnd Sub\n\nSub Export_XML()\n    Set xmap = ThisWorkbook.XmlMaps(\"Data_Map\")\n     If xmap.IsExportable Then\n          fname = xmap.DataBinding.SourceUrl\n          xmap.Export(fname, True)\n     End If\n End Sub\n</code></pre>\n\n<p>The resulting date in the XML file are SERIAL dates, not in the mm/dd/yyyy format I expect them to be in.</p>\n\n<p>I've already tried formatting the fields using .numberformat = \"@\", and it gives me the output in the XML file I expect but the user input isn't easy.  It's formatted as text.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1446734390, "post_id": 32999940, "comment_id": 54874400, "body": "Try not to select cells when working with them - just reference them.  Rather than <code>rng.Offset(1, 0).Select Range(ActiveCell, ActiveCell.Offset(14, 0)).Copy</code> you could use <code>rng.Offset(1).Resize(14).Copy</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1446734489, "post_id": 32999940, "comment_id": 54874477, "body": "<code>Sub Test(): Dim rng As Range: Set rng = ActiveCell: rng.Offset(1).Resize(14).Copy: With ThisWorkbook.Worksheets(&quot;QUOTE MASTER&quot;).Cells(Rows.Count, 3).End(xlUp).Offset(1): .PasteSpecial Paste:=xlPasteFormats: .PasteSpecial Paste:=xlValues: End With: End Sub</code> - not sure of formatting in comments, but this will copy/paste special without selecting the cells.  Have added <b>:</b> so it can be pasted on a single line and still work."}], "owner": {"reputation": 23, "user_id": 5403703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853b74905abf0e1433195c4727845b5f?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek Kuchimanchi", "link": "https://stackoverflow.com/users/5403703/vivek-kuchimanchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1446731020, "creation_date": 1444242970, "last_edit_date": 1531161705, "question_id": 32999940, "link": "https://stackoverflow.com/questions/32999940/run-time-error-1004-in-my-macro-loop", "title": "Run time error 1004, in my macro loop", "body": "<pre><code>'Declare Variables\nDim rng As Range\nDim AmQ As Worksheet, UpIss As Worksheet, QuMa As Worksheet\n\n'Set your sheet names into variables for easier referencing\nSet AmQ = Sheets(\"AMEND QUOTE\")\nSet UpIss = Sheets(\"UPISSUE\")\n\nFor i = 7 To 57 '7 = Column H, 8 = Column G, etc.\n\n'Set the address of the found value to the rng variable\nSet rng = UpIss.Cells.Find(What:=AmQ.Cells(4, i).Value, After:=ActiveCell, LookIn:=xlValues, _\nLookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False, SearchFormat:=False)\n\nIf Not rng Is Nothing Then 'CHECK IF THE SEARCH TERM (FROM QUOTE SHEET) WAS FOUND IN THE TARGET SHEET (ESTIMATE)\n\n    If Not rng = \"\" Then 'CHECK IF THE SEARCH TERM WAS A ZERO LENGTH STRING\n\n    rng.Offset(1, 0).Select\n        Range(ActiveCell, ActiveCell.Offset(14, 0)).Copy 'Copy the cell 41 rows down and 3 columns across\n        'QuMa.Cells(4, i).Offset(14, 0).PasteSpecial Paste:=xlPasteValues 'Paste into the cell 14 rows below the original search term in the QUOTE sheet\n\n        Sheets(\"QUOTE MASTER\").Select\nRange(\"C5000\").End(xlUp).Select\nActiveCell.Offset(1, 0).Select\n\n'Copy Formats\nSelection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=True\n'Copy Values\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=True\n\n'Autofit\nColumns(\"C:Q\").EntireColumn.AutoFit\n\nApplication.CutCopyMode = False\n\n\n\n    ElseIf rng = \"\" Then 'EXIT SUB IF SEARCH TERM WAS A ZERO LENGTH STRING\n        'MsgBox \"Work is Done\"\n        Exit Sub\n    End If\n\nElseIf rng Is Nothing Then 'EXIT SUB IF SEARCH TERM WAS NOT FOUND IN THE TARGET SHEET\n    'MsgBox \"Work is Done\"\n    Exit Sub\n\nEnd If\n\nSet rng = Nothing\n\nNext i 'Move to the next column across and loop\n</code></pre>\n\n<p>This is where I am getting my error:  </p>\n\n<pre><code>rng.Offset(1, 0).Select\nRange(ActiveCell, ActiveCell.Offset(14, 0)).Copy\n</code></pre>\n\n<p>not able to copy in the loop.</p>\n"}, {"tags": ["database", "excel", "vba", "ado"], "answers": [{"comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1444333597, "post_id": 33000437, "comment_id": 53871831, "body": "Thanks, but no.. that&#39;s not the case. As I said, the file immediately reduces in size as soon as it&#39;s opened in Access (not just on exit). Also, I thought that the purpose of compacting was to clean up space used by records that had been deleted (therefore leaving blank space that was still marked out as in use). But in this case, the database is freshly created (by ADO) and nothing has been deleted, so there should be no tidying necessary.  Any more ideas? :)"}], "tags": [], "owner": {"reputation": 8131, "user_id": 4459617, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9cebe9a45f0438824814ce252c6b0a74?s=128&d=identicon&r=PG&f=1", "display_name": "Hannover Fist", "link": "https://stackoverflow.com/users/4459617/hannover-fist"}, "is_accepted": false, "score": 0, "last_activity_date": 1444244808, "creation_date": 1444244808, "answer_id": 33000437, "question_id": 32999627, "link": "https://stackoverflow.com/questions/32999627/database-created-by-ado-from-vba-reduces-file-size-after-opening-in-ms-access/33000437#33000437", "title": "Database created by ADO (from VBA) reduces file size after opening in MS Access. Why?", "body": "<p>Access might be compacting the database when you close it. There is a setting called <strong>Compact on Close</strong> that determines whether the database will automatically be compacted whenever you exit out of it.</p>\n\n<p><a href=\"https://support.office.com/en-in/article/Compact-and-repair-a-database-6ee60f16-aed0-40ac-bf22-85fa9f4005b2#bm3_1\" rel=\"nofollow\">Microsoft Office Support - Compact and repair a database</a></p>\n"}, {"comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1444334120, "post_id": 33005885, "comment_id": 53872122, "body": "Thanks for your answer, Parfait (and thanks also for the tip about commenting on another answer below - I must&#39;ve missed that option. Changed now!)  Anyway - to reiterate, yes I know that I can create and manipulate databases entirely independently of the Access application. In VBA/ADO, I am using the Jet engine to create an .mdb (and the Ace engine to create an .accdb). You asked when I witnessed the change in file size: it is at the very instant I try to open it in Access. Yes, I know I don&#39;t <i>need</i> to use Access, but I want to inspect the tables. No other files do this, Excel or otherwise."}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 1, "creation_date": 1444334440, "post_id": 33005885, "comment_id": 53872298, "body": "Also, I <i>do</i> have to present the user interface in Excel. Not only does Excel do a lot of things that Access doesn&#39;t, but on my office network they don&#39;t have licences for MS Access anyway! The users have MS Word/Excel/Outlook 2007, but Access is not present. Excel is the only front-end interface possible."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1444336674, "post_id": 33005885, "comment_id": 53873405, "body": "I understand. You are basically building a database through code like one would do with the black box MySQL client without phpMyAdmin or SQL Server&#39;s Management Studio, or Postgre&#39;s phpPgAdmin, or other consoles. MS Access would sort of be the console for Jet/ACE showing you all tables, schema, relationships, and stored queries. Just don&#39;t get too caught up with sizes at least during design phase as many things happen under the hood."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 1, "creation_date": 1444336854, "post_id": 33005885, "comment_id": 53873490, "body": "Also, if you as have Access, you can build your app in Access and then have users download the <b>free</b> <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=4438\" rel=\"nofollow noreferrer\">2007 runtime</a> which allows any PC user to use accdb files but cannot design. Also, you can create workbooks, Word docs, PDFs and run entire Excel VBA inside Access VBA. At the end of the day, a spreadsheet is really a flat file end-use document and not a relational database. I worked with many clients who use Excel as an app and eventually it becomes unstable and un-maintainable. I would be remiss if I didn&#39;t warn you. Good luck!"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1444273380, "last_edit_date": 1495541836, "creation_date": 1444273380, "answer_id": 33005885, "question_id": 32999627, "link": "https://stackoverflow.com/questions/32999627/database-created-by-ado-from-vba-reduces-file-size-after-opening-in-ms-access/33005885#33005885", "title": "Database created by ADO (from VBA) reduces file size after opening in MS Access. Why?", "body": "<p>Without knowing specifically how you are creating tables, importing records, structures and schema; or your environment 2000/02/03 mdb or 2007/10/13 accdb version, machine (32-bit/64-bit, laptop/desktop), Windows OS (XP, Vista, 7, 8, 10), single CPU or LAN, one can only speculate. </p>\n\n<p>First it is important to understand the strange, hard to define program that is <a href=\"https://meta.stackexchange.com/questions/33216/ms-access-or-mdb-or-access-database-engine-or-ms-jet-ace\">MS Access</a>. In essence, MS Access is a suite of connected objects: Jet/ACE SQL engine, GUI front-end application, report generator, and IDE coding interface. It is not actually a database but ships by default to the ACE engine which by the way is not restricted to MS Access but is wholly a Windows technology (.dll files) available for all Office and other PC applications. Excel can run accdb/mdb files without Access even installed! When compared to other databases such as another  file-server (popular, open-source) counterpart, SQLite, and client server (SQL Server, MySQL, PostgreSQL) it is really the Jet/ACE component that is the relational engine being compared. Interestingly, Access can connect to all aforementioned RDBMS's by switching out its default.</p>\n\n<p>With that said, the multifaceted nature of MS Access makes use of temporary objects in both SQL backend engine and VBA frontend, interacting with both hard disk and memory, especially in importing records and various queries. Even the MSN website mentions it on its <a href=\"https://support.office.com/en-in/article/Compact-and-repair-a-database-6ee60f16-aed0-40ac-bf22-85fa9f4005b2\" rel=\"nofollow noreferrer\">Compact and repair</a> page. </p>\n\n<blockquote>\n  <p>Access creates temporary, hidden objects to accomplish various tasks.\n  Sometimes, these temporary objects remain in your database after\n  Access no longer needs them.</p>\n</blockquote>\n\n<p>Furthermore, make-table and action queries (append/update/delete) actually copies the entire resultset before committing final changes. Hence, users are prompted about the number of records added before changes are finalized with opportunity to rollback the action. So after migrating data, your database may have returned slightly to former state. Then, there's the <a href=\"https://stackoverflow.com/questions/4106153/vba-garbage-collector-details\">garbage collection in VBA</a> that releases memory when objects are no longer in use and OLEDB driver discontinued connection. It may be you witness some difference in file size as some space was recovered after your VBA processing finalized and went out of scope. I wonder at what instance you viewed the larger sized Access file? Would a refreshed Windows Explorer or CPU restart change the view? Did you read properties of file (from right-click) or details section of Explorer which differ in approximation? Do you witness other file size changes like in Excel workbooks? Is this a regularly occurrence or anomaly?</p>\n\n<p>Managing the database creation process <a href=\"https://stackoverflow.com/questions/1221435/maximum-number-of-rows-in-an-ms-access-database-engine-table\">purely in code</a> may the most efficient way to use the database instead of using Access' graphical user interface as multiple-user access locking and application objects add some overhead. </p>\n\n<p>All in all, it is not likely ADO adds any data or components without your development knowledge. Regularly, <a href=\"http://www.fmsinc.com/microsoftaccess/performance/decompile.asp\" rel=\"nofollow noreferrer\">decompile, compact</a>, and explicitly remove VBA objects (i.e., <code>set obj = Nothing</code>). See helpful <a href=\"https://msdn.microsoft.com/en-us/library/dd942824%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\">performance tips</a>. Also, don't focus too much on file size but performance and integrity as over the course of app, file size will be a fluctuating metric. One final note, though Excel is very popular and easy to use, as mentioned about the powerful native components of MS Access, consider developing your end use needs in Access (free <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=39358\" rel=\"nofollow noreferrer\">runtimes</a> are available via Microsoft, allowable since Jet is a Windows technology). In every aspect, Access provides a more stable multiple user application and automation environment.</p>\n"}, {"tags": [], "owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "is_accepted": false, "score": 1, "last_activity_date": 1476244061, "creation_date": 1476244061, "answer_id": 39990203, "question_id": 32999627, "link": "https://stackoverflow.com/questions/32999627/database-created-by-ado-from-vba-reduces-file-size-after-opening-in-ms-access/39990203#39990203", "title": "Database created by ADO (from VBA) reduces file size after opening in MS Access. Why?", "body": "<p>When you open an \"Access database file\" in Access, it adds/creates/updates a \"Access application project\" inside the database file. It's basically just adding some extra blobs/tables/data inside the database if they are/it is missing. And it checks the file and truncates the file length to the correct file length.</p>\n\n<p>When it does this, it may be correcting a file length error, or discarding some unused cruft, or just adjusting the amount of space that was reserved for just this purpose. But whatever, it is actually doing something that can't be done any other way, and it is using different defaults than you get any other way.</p>\n\n<p>In older versions, when it did this, it always made the file bigger. Now, on your computer, using your versions, it's making the file smaller. This may be because of bugs in the original file creation, or it may be \"behavior is by intent\". You can't change that, so you shouldn't worry about it.</p>\n\n<p>But it's not always a good idea to truncate unused file space: if you are going to add data to the file, you just have to request more file space. And the different version libraries for mdb files had different ideas about what the \"best\" way to compact a database file was, and would give different file lengths.</p>\n\n<p>Having said that, it used to be possible to compact &amp; repair a database file (mdb) using JRO or DAO. That would discard unused objects (compact) and correct the file length and delete hanging references (repair). I'm not aware of any similar functionality for ACE, but I haven't looked.</p>\n"}], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 775, "favorite_count": 1, "accepted_answer_id": 33005885, "answer_count": 3, "score": 1, "last_activity_date": 1476244061, "creation_date": 1444241924, "last_edit_date": 1444242409, "question_id": 32999627, "link": "https://stackoverflow.com/questions/32999627/database-created-by-ado-from-vba-reduces-file-size-after-opening-in-ms-access", "title": "Database created by ADO (from VBA) reduces file size after opening in MS Access. Why?", "body": "<p>I'm currently learning how to create databases &amp; tables using ADO from VBA (running from Excel). I am able to create a database either of format .mdb (using connection \"Microsoft.Jet.OLEDB.4.0;\") or .accdb (using connection \"Microsoft.Ace.OLEDB.12.0;\") - and I am able to create tables and insert records. So far so good.</p>\n\n<p>I notice, however, that after I create such a database via ADO, if I open it in MS Access, the file size reduces dramatically. Note: just the action of opening it in Access has this effect. I'm not making any changes to the data there.</p>\n\n<p>An example: a freshly-created database from ADO is 1304k; then after opening in Access it's 816k.</p>\n\n<p>As far as I can see, no data is being lost when it is opened in Access. I can only guess that Access is somehow automatically optimising the database when it's opened, or otherwise getting rid of unnecessary stuff which was inserted by ADO. Obviously, I would prefer the file size to be as small as possible. So I'm wondering:</p>\n\n<p>1) Does anyone know what's going on here?</p>\n\n<p>2) If ADO is inserting unnecessary data, is there any way I can optimise it programmatically? My end users will be running Excel only, so I can't ask them to periodically open the database in Access just to optimise the data.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1444238937, "post_id": 32998632, "comment_id": 53822112, "body": "Your tag uses <code>excel-vba</code> but this sounds like an Access form listbox with an SQL rowsource."}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1444239148, "post_id": 32998632, "comment_id": 53822249, "body": "I am doing this within Excel. Adding population code to edit"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444243268, "post_id": 32998632, "comment_id": 53824609, "body": "What specifically is the issue with creating the &quot;where&quot; clause?  Note you can simplify your logic by also using <code>IN()</code> for the single selection case."}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444244202, "post_id": 32998632, "comment_id": 53825194, "body": "Ah I was under the impression you couldn&#39;t do a WHERE [col] IN (&#39;1&#39;).  I need to be able to select multiple values, say I have 10 options to choose from but only select 5. How to get that to loop the values in an IN statement."}], "answers": [{"comments": [{"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444313866, "post_id": 33004762, "comment_id": 53859788, "body": "I&#39;m receiving object required on this line - <code>For i = 0 To form_mode.ListCount - 1</code>  I originally had it declared as a value at the top of my sub, so I removed it.. no luck, then added it back in as <code>form_mode = Main_Window.form_mode.List</code>"}, {"owner": {"reputation": 2090, "user_id": 3230456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86b80866ac0d8165eabbf5679353633?s=128&d=identicon&r=PG&f=1", "display_name": "codersl", "link": "https://stackoverflow.com/users/3230456/codersl"}, "reply_to_user": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444314659, "post_id": 33004762, "comment_id": 53860458, "body": "Can you try Me.form_mode.ListCount? And make sure it&#39;s in the same section as the User_Initialize function."}], "tags": [], "owner": {"reputation": 2090, "user_id": 3230456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86b80866ac0d8165eabbf5679353633?s=128&d=identicon&r=PG&f=1", "display_name": "codersl", "link": "https://stackoverflow.com/users/3230456/codersl"}, "is_accepted": true, "score": 1, "last_activity_date": 1444264919, "creation_date": 1444264919, "answer_id": 33004762, "question_id": 32998632, "link": "https://stackoverflow.com/questions/32998632/vba-listbox-and-sql-in-statement/33004762#33004762", "title": "VBA - Listbox and SQL IN Statement", "body": "<p>In your UserForm_Initialize function set <code>Me.form_mode.MultiSelect = fmMultiSelectMulti</code> or <code>fmMultiSelectExtended</code> to allow multi-selects (or set via ListBox properties).</p>\n\n<p>Then in a button click event use the following code to get the selected values:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim i As Integer\n    Dim arr() As String\n    For i = 0 To form_mode.ListCount - 1\n        If form_mode.Selected(i) Then\n            ReDim Preserve arr(i)\n            arr(i) = form_mode.List(i, 1)\n        End If\n    Next i\n    MsgBox \"WHERE [ID] IN ('\" &amp; Join(arr, \"','\") &amp; \"')\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3618, "favorite_count": 0, "accepted_answer_id": 33004762, "answer_count": 1, "score": 0, "last_activity_date": 1444325809, "creation_date": 1444238636, "last_edit_date": 1531164843, "question_id": 32998632, "link": "https://stackoverflow.com/questions/32998632/vba-listbox-and-sql-in-statement", "title": "VBA - Listbox and SQL IN Statement", "body": "<p>I have a listbox that is populated with the following data. I only want to be able to select ( visually ) by the name column.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>id | name\n1  | value1\n2  | value2\n</code></pre>\n\n\n\n<p>I need a few conditions to happen and apply them in a where statement in my SQL.</p>\n\n<ol>\n<li>If nothing is selected, then just omit the where statement all together</li>\n<li>If 1 value is included, place the where id = 1</li>\n<li><p>If both values are selected, then create an IN statement like the following</p>\n\n<p>IN ('1','2')</p></li>\n</ol>\n\n<p>EDIT --//</p>\n\n<p>This is the code that populates the listbox upon initialization</p>\n\n<pre><code>Sub UserForm_Initialize()\n\n    'SQL query that will populate the Mode Box\n    Dim cnn As ADODB.Connection\n    Dim rst As ADODB.Recordset\n    Set cnn = New ADODB.Connection\n    Set rst = New ADODB.Recordset\n\n    cnn.Open \"Provider=SQLOLEDB;Data Source=yadayda;\" &amp; _\n             \"Initial Catalog=db;\" &amp; _\n             \"Integrated Security=SSPI;\"\n\n    Set rst = cnn.Execute(\"SELECT [ID] AS [ID],[Name] AS [Name] FROM [Table]\")\n    rst.MoveFirst\n    i = 0\n\n    With Me.form_mode\n\n        .Clear\n        Do\n            .AddItem\n            .List(i, 0) = rst![Mode]\n            .List(i, 1) = rst![ID]\n            i = i + 1\n            rst.MoveNext\n        Loop Until rst.EOF\n\n    End With\n\n    rst.Close\n    cnn.Close\n    Set rst = Nothing\n    Set cnn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>EDIT -//\nGot it to work using the following</p>\n\n<p>`Dim strFilter As String\n        Dim i As Integer</p>\n\n<pre><code>    For i = 0 To Main_Window.form_mode.ListCount - 1\n        If Main_Window.form_mode.Selected(i) Then\n            If strFilter &lt;&gt; vbNullString Then strFilter = strFilter &amp; \", \"\n            strFilter = strFilter &amp; \"'\"\n            strFilter = strFilter &amp; Main_Window.form_mode.List(i, 1)\n            strFilter = strFilter &amp; \"'\"\n        End If\n    Next i`\n</code></pre>\n\n<p>Thanks to @ralph in this thread - <a href=\"https://stackoverflow.com/questions/32995252/vba-sql-with-optional-joins\">VBA - SQL with optional joins</a></p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "edited": false, "score": 0, "creation_date": 1444239117, "post_id": 32998599, "comment_id": 53822224, "body": "Does this code work? The line with <code>DB_Dir = ThisWorkbook.Path &amp; &quot;\\&quot; &amp; &quot;DB2.accdb&quot;</code> is missing a backslash: &quot;\\\\&quot; (the <a href=\"https://msdn.microsoft.com/en-us/library/h21280bw.aspx\" rel=\"nofollow noreferrer\">escape sequence</a> for a backslash)."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1444239560, "post_id": 32998599, "comment_id": 53822511, "body": "<a href=\"http://www.w3schools.com/asp/prop_comm_commandtext.asp\" rel=\"nofollow noreferrer\">Commandtext</a> should be in quotes."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444243465, "post_id": 32998599, "comment_id": 53824745, "body": "<a href=\"https://support.microsoft.com/en-us/kb/194973\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/194973</a>"}, {"owner": {"reputation": 220, "user_id": 3476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48636cec4394d49f720005d104448a76?s=128&d=identicon&r=PG&f=1", "display_name": "user3476534", "link": "https://stackoverflow.com/users/3476534/user3476534"}, "edited": false, "score": 0, "creation_date": 1449590217, "post_id": 32998599, "comment_id": 56067413, "body": "When the DB doesn&#39;t support the recordcount ability, unless the query is large and complex, try executing a sql just before that counts the records, and use that as the total number of returned records. To be safe, always check if EOF also."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 2, "last_activity_date": 1444243188, "last_edit_date": 1444243188, "creation_date": 1444242849, "answer_id": 32999902, "question_id": 32998599, "link": "https://stackoverflow.com/questions/32998599/when-i-call-a-query-from-access-using-vba-i-cant-know-how-many-records-are-on/32999902#32999902", "title": "When I call a query from Access using VBA, I can&#39;t know how many records are on that query. Why?", "body": "<p><code>RecordCount</code> is tricky.  Depending on the provider, data source type, and options, it may not be reliable.</p>\n\n<p>For an ADO recordset, you are more likely to get a reliable <code>RecordCount</code> with a client-side cursor:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set DB = New ADODB.Connection\nDB.CursorLocation = adUseClient '&lt;- add this\nDB.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; DB_Dir &amp; \";Persist Security Info=False\"\n</code></pre>\n\n<p>I assumed your procedure's <em>consulta</em> argument is a SQL statement.  If that is correct, use <em>adCmdText</em> (instead of <em>adCmdStoredProc</em>) for <code>CommandType</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set Query = New ADODB.Command\n'Set Query.ActiveConnection = DB ' Set not needed here ...\nQuery.ActiveConnection = DB\nQuery.CommandText = consulta\n'Query.CommandType = adCmdStoredProc\nQuery.CommandType = adCmdText\n</code></pre>\n\n<p>If those changes were not sufficient to get you a reliable <code>RecordCount</code>, use <code>MoveLast</code> to ensure the recordset is fully populated before asking for <code>RecordCount</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set RST = Query.Execute\nRST.MoveLast\nMsgBox \"RecordCount: \" &amp; RST.RecordCount\n</code></pre>\n\n<p>Add <code>RST.MoveFirst</code> afterward if you need the recordset pointer to be on the first row in preparation for your remaining operations.</p>\n"}, {"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444251192, "post_id": 33001960, "comment_id": 53829335, "body": "How do you set cursor type to static with an <code>ADODB.Command</code>?  Not saying it can&#39;t be done, just that I don&#39;t see how to do it."}, {"owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444252023, "post_id": 33001960, "comment_id": 53829735, "body": "Good question, I don&#39;t know either.  I&#39;ve always just opened a recordset using the <code>open</code> method.  Is there any disadvantage to this?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444252276, "post_id": 33001960, "comment_id": 53829843, "body": "pedrocsa is using a parameter query.  Seems to me that <code>ADODB.Command</code> is way to go.  If you want to do it via only an <code>ADODB.Recordset</code>, you&#39;d have to supply the parameters somehow or rewrite the SQL statement."}], "tags": [], "owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "is_accepted": false, "score": 0, "last_activity_date": 1444250016, "creation_date": 1444250016, "answer_id": 33001960, "question_id": 32998599, "link": "https://stackoverflow.com/questions/32998599/when-i-call-a-query-from-access-using-vba-i-cant-know-how-many-records-are-on/33001960#33001960", "title": "When I call a query from Access using VBA, I can&#39;t know how many records are on that query. Why?", "body": "<p>When I've had trouble with counting records before, the issue was with the way the recordset was opened, not the connection.  The <a href=\"https://msdn.microsoft.com/en-us/library/ms681771(v=vs.85).aspx\" rel=\"nofollow\">cursor type</a> needs to be static for it to work.  This may be very similar to what HansUp was referring to with the cursorlocation in the connection object, though.</p>\n\n<pre><code>rec.Open querystr, con, 3\nrec.movelast\ncnt = rec.RecordCount\nrec.movefirst\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5419520, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9125629f65fec19f4b5e3dc5ff96d0d1?s=128&d=identicon&r=PG&f=1", "display_name": "pedrocsa", "link": "https://stackoverflow.com/users/5419520/pedrocsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1444250016, "creation_date": 1444238519, "last_edit_date": 1531164843, "question_id": 32998599, "link": "https://stackoverflow.com/questions/32998599/when-i-call-a-query-from-access-using-vba-i-cant-know-how-many-records-are-on", "title": "When I call a query from Access using VBA, I can&#39;t know how many records are on that query. Why?", "body": "<p>I did a query on MS Access 2010, with the Query Builder, now I'm calling it from VBA. But when I try to use the recordcount to know how many records are on this query, the result is -1. </p>\n\n<p>The code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function teste(Optional ByVal consulta As String, Optional ByVal cbAR_valor As String, Optional ByVal cbAR_valor2 As String)\n\nDim DB As ADODB.Connection\nDim RST As ADODB.Recordset\nDim Query As ADODB.Command\nDim parametro1 As ADODB.Parameter\nDim parametro2 As ADODB.Parameter\n\nOn Error GoTo trataErro\n\nDB_Dir = ThisWorkbook.Path &amp; \"\\\" &amp; \"DB2.accdb\"\n\nSet DB = New ADODB.Connection\nDB.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; DB_Dir &amp; \";Persist Security Info=False\"\n\nSet Query = New ADODB.Command\nSet Query.ActiveConnection = DB\nQuery.CommandText = consulta\nQuery.CommandType = adCmdStoredProc\n\n' Pego o valor do param. e adiciono no command\nSet parametro1 = Query.CreateParameter(\"AR1\", adChar, adParamInput, 255)\nQuery.Parameters.Append parametro1\nparametro1.Value = cbAR_valor\n\n' Pego o valor do param. e adiciono no command\nSet parametro2 = Query.CreateParameter(\"AR2\", adChar, adParamInput, 255)\nQuery.Parameters.Append parametro2\nparametro2.Value = cbAR_valor2\n\n\nSet RST = Query.Execute\n\na = RST.RecordCount\n\nlinha = 1\ncoluna = 1\nActiveWorkbook.Sheets(\"Plan2\").Cells(CInt(linha), CInt(coluna)).CopyFromRecordset RST\n\nDB.Close\nSet DB = Nothing\n\nExit Function\n\ntrataErro:\n    MsgBox (\"Erro: \" &amp; Err.Description)\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 2556722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SUVzx.jpg?s=128&g=1", "display_name": "doriansm", "link": "https://stackoverflow.com/users/2556722/doriansm"}, "edited": false, "score": 0, "creation_date": 1444238355, "post_id": 32998445, "comment_id": 53821768, "body": "Makes perfect sense. I was able to successfully save the workbook without error. I need to wait for new data to load in before I will know for sure if this solved. Thank you! Will mark as answered once I confirm.... Also, stupid S...."}, {"owner": {"reputation": 233, "user_id": 2556722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SUVzx.jpg?s=128&g=1", "display_name": "doriansm", "link": "https://stackoverflow.com/users/2556722/doriansm"}, "edited": false, "score": 0, "creation_date": 1444239768, "post_id": 32998445, "comment_id": 53822626, "body": "Well I discovered the big issue is apparently with my autohotkey script. I use a command to close the workbook in AHK, and it seems through doing it this way it doesn&#39;t close the same as if closed by the user.  Your changes work if i manually close the workbook."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 233, "user_id": 2556722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SUVzx.jpg?s=128&g=1", "display_name": "doriansm", "link": "https://stackoverflow.com/users/2556722/doriansm"}, "edited": false, "score": 0, "creation_date": 1444239840, "post_id": 32998445, "comment_id": 53822669, "body": "@Aldentec, You could add the same code to your AHK close commands I&#39;d think, and it&#39;d do what you wanted."}, {"owner": {"reputation": 233, "user_id": 2556722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SUVzx.jpg?s=128&g=1", "display_name": "doriansm", "link": "https://stackoverflow.com/users/2556722/doriansm"}, "edited": false, "score": 0, "creation_date": 1444239847, "post_id": 32998445, "comment_id": 53822673, "body": "Just curious, do you know an easy way to make the workbook close after say 20 seconds of being open? If I can do that, I can remove that part from the AHK script and allow Excel to do it itself, in turn it should be able to apply filter at that point."}, {"owner": {"reputation": 233, "user_id": 2556722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SUVzx.jpg?s=128&g=1", "display_name": "doriansm", "link": "https://stackoverflow.com/users/2556722/doriansm"}, "edited": false, "score": 0, "creation_date": 1444239864, "post_id": 32998445, "comment_id": 53822680, "body": "Interesting idea, will test this out."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 233, "user_id": 2556722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SUVzx.jpg?s=128&g=1", "display_name": "doriansm", "link": "https://stackoverflow.com/users/2556722/doriansm"}, "edited": false, "score": 0, "creation_date": 1444240045, "post_id": 32998445, "comment_id": 53822759, "body": "You could add a timer, sure.  <a href=\"http://www.teachexcel.com/free-excel-macros/m-13,close-workbook-time-limit.html\" rel=\"nofollow noreferrer\">Here&#39;s one page</a> I found that gives some info, and <a href=\"http://www.mrexcel.com/forum/excel-questions/211053-visual-basic-applications-close-file-after-period-time.html\" rel=\"nofollow noreferrer\">another</a> that should guide you in the right direction.  Although from what I understand, using timers in Excel isn&#39;t so straight forward always, so I recommend looking for an alternative first (such as adding the same closing code to your AHK)."}, {"owner": {"reputation": 233, "user_id": 2556722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SUVzx.jpg?s=128&g=1", "display_name": "doriansm", "link": "https://stackoverflow.com/users/2556722/doriansm"}, "edited": false, "score": 0, "creation_date": 1444240105, "post_id": 32998445, "comment_id": 53822792, "body": "Thanks Bruce! Do you have any experience with AHK by chance? I am trying to work this out but struggling."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 233, "user_id": 2556722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SUVzx.jpg?s=128&g=1", "display_name": "doriansm", "link": "https://stackoverflow.com/users/2556722/doriansm"}, "edited": false, "score": 0, "creation_date": 1444242823, "post_id": 32998445, "comment_id": 53824378, "body": "@Aldentec - unfortunately I do not :/  ...but perhaps others on SO do.  You could start a new question and give details on what you&#39;ve tried, what has/hasn&#39;t worked.  The main question I think would be how to run a <code>Workbook_BeforeClose</code> event when not exiting Excel manually (File -&gt; Exit, or clicking &quot;X&quot;)."}, {"owner": {"reputation": 233, "user_id": 2556722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SUVzx.jpg?s=128&g=1", "display_name": "doriansm", "link": "https://stackoverflow.com/users/2556722/doriansm"}, "edited": false, "score": 0, "creation_date": 1444243131, "post_id": 32998445, "comment_id": 53824535, "body": "Thanks for all your help. I will do this."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1444238350, "last_edit_date": 1444238350, "creation_date": 1444238032, "answer_id": 32998445, "question_id": 32998351, "link": "https://stackoverflow.com/questions/32998351/issue-re-applying-a-filter-on-workbook-close/32998445#32998445", "title": "Issue re-applying a filter on workbook close", "body": "<p><code>Sheet(\"Sheet2\").AutoFilter.Applyfilter</code> should be <code>Sheets(\"Sheet2\").AutoFilter.Applyfilter</code> (missing the \"s\").  <code>Sheet</code> isn't something recognized by VBA, so it thinks that's a subroutine or function you defined somewhere else. <code>Sheets()</code> however, is what you're looking for.</p>\n\n<p><code>Sheet2.[whatever]</code> does have applications in VBA, <em>however</em> it's NOT necessarily going to refer to the sheet named <code>\"Sheet2\"</code>.  <code>Sheet2</code> refers to the second worksheet created in the workbook.  If you create three worksheets, and rename them to like \"Fun Page 1\", \"Fun Page 4\", \"Fun Page 8\", <code>Sheet2.AutoFilter...</code> will run on whatever sheet you created second (which could be the one named \"Fun Page 4\".)</p>\n\n<p>By using <code>Sheets(\"Fun Page 4\").AutoFilter...</code>, the code is telling VB to look for the sheet named \"Fun Page 4\", not the one that was created 1st, 2nd, etc...</p>\n\n<p>Does that make sense?</p>\n"}], "owner": {"reputation": 233, "user_id": 2556722, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SUVzx.jpg?s=128&g=1", "display_name": "doriansm", "link": "https://stackoverflow.com/users/2556722/doriansm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 32998445, "answer_count": 1, "score": 1, "last_activity_date": 1444239106, "creation_date": 1444237697, "last_edit_date": 1444239106, "question_id": 32998351, "link": "https://stackoverflow.com/questions/32998351/issue-re-applying-a-filter-on-workbook-close", "title": "Issue re-applying a filter on workbook close", "body": "<p>I have the following code in the ThisWorkbook section:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Sheet(\"Sheet2\").AutoFilter.ApplyFilter\n    ActiveWorkbook.Save\n    ThisWorkbook.Saved = True\nEnd Sub\n</code></pre>\n\n<p>I assumed the second line would re-apply the filter I have set in the AutoFilter on Sheet 2. </p>\n\n<p>I have data feeding in to Sheet 1, and Sheet 2 reads that data and filters it. The document is then working with AutoHotkey to: open, take more data, save and close on a timer. I just need it so that when the document closes it looks at that filter on Sheet2 and re-applies it. </p>\n\n<p>I have tried:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Sheet2.AutoFilter.ApplyFilter\n    ActiveWorkbook.Save\n    ThisWorkbook.Saved = True\nEnd Sub\n</code></pre>\n\n<p>But that did not work. After looking through some VBA stuff, it seemed changing <code>Sheet2.AutoFilter.ApplyFilter</code> to <code>Sheet(\"Sheet2\").AutoFilter.Applyfilter</code> would do the trick. But now I just get <em>Compile Error: sub or function not defined</em>.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 1210, "user_id": 1633618, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/df0aea3445c4e73c8ec6ac6d50d0c5d1?s=128&d=identicon&r=PG", "display_name": "Bmo", "link": "https://stackoverflow.com/users/1633618/bmo"}, "edited": false, "score": 0, "creation_date": 1444236228, "post_id": 32997815, "comment_id": 53820512, "body": "What error are you getting?"}, {"owner": {"reputation": 1, "user_id": 5419398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07a4b57cba5693e5c0b2b57b1fd1b396?s=128&d=identicon&r=PG", "display_name": "Sundevil", "link": "https://stackoverflow.com/users/5419398/sundevil"}, "reply_to_user": {"reputation": 1210, "user_id": 1633618, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/df0aea3445c4e73c8ec6ac6d50d0c5d1?s=128&d=identicon&r=PG", "display_name": "Bmo", "link": "https://stackoverflow.com/users/1633618/bmo"}, "edited": false, "score": 0, "creation_date": 1444241014, "post_id": 32997815, "comment_id": 53823317, "body": "run-time error &#39;9&#39; subscript out of range"}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1444236166, "creation_date": 1444236166, "answer_id": 32997893, "question_id": 32997815, "link": "https://stackoverflow.com/questions/32997815/prevent-printing-for-specific-sheet-if-specific-cell-is-empty/32997893#32997893", "title": "Prevent printing for specific sheet if specific cell is empty", "body": "<p>You can use And to check for both conditions.</p>\n\n<pre><code>If IsEmpty(Range(\"T5\")) And ActiveSheet.Name = \"Sheet 2\" Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5419398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07a4b57cba5693e5c0b2b57b1fd1b396?s=128&d=identicon&r=PG", "display_name": "Sundevil", "link": "https://stackoverflow.com/users/5419398/sundevil"}, "edited": false, "score": 0, "creation_date": 1444240789, "post_id": 32997916, "comment_id": 53823179, "body": "I tried the second code, but for some reason anytime I try to use the ActiveSheet.Name = &quot;Sheet2&quot; command it highlights the code yellow and gives an error."}, {"owner": {"reputation": 1, "user_id": 5419398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07a4b57cba5693e5c0b2b57b1fd1b396?s=128&d=identicon&r=PG", "display_name": "Sundevil", "link": "https://stackoverflow.com/users/5419398/sundevil"}, "edited": false, "score": 0, "creation_date": 1444248190, "post_id": 32997916, "comment_id": 53827740, "body": "I figured it out, googled the error code and all I had to do was use the sheets code name and the code ran. Thanks everyone for the help"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1444236943, "last_edit_date": 1444236943, "creation_date": 1444236214, "answer_id": 32997916, "question_id": 32997815, "link": "https://stackoverflow.com/questions/32997815/prevent-printing-for-specific-sheet-if-specific-cell-is-empty/32997916#32997916", "title": "Prevent printing for specific sheet if specific cell is empty", "body": "<p><code>Range</code> always resolves to the <code>ActiveSheet</code> unless otherwise qualified explicitly.</p>\n\n<p>Try this:</p>\n\n<pre><code>If IsEmpty(Sheets(\"Sheet2\").Range(\"T5\"))\n</code></pre>\n\n<p>Note:  </p>\n\n<blockquote>\n  <p>ActiveSheet.Name = \"Sheet 2\"</p>\n</blockquote>\n\n<p>This most likely raises an error because this is not how you \"activate\" a worksheet, and if another sheet is \"active\" <em>and</em> <code>Sheet2</code> already exists, then you're going to get a Key error.  You could do:</p>\n\n<pre><code>Sheets(\"Sheet2\").Activate\n</code></pre>\n\n<p>And then your original code would work. </p>\n\n<p>My preference would be to use the other method of explicitly qualifying the range to the desired worksheet, and avoid the need to Activate anything :)</p>\n\n<p>If you want to prevent printing <strong>only</strong> for Sheet 2, then do:</p>\n\n<pre><code>Private Sub Workbook_BeforePrint(Cancel As Boolean)\n    If ActiveSheet.Name = \"Sheet2\" And IsEmpty(Sheets(\"Sheet2\").Range(\"T5\").Value) Then\n        Cancel = True\n        MsgBox (\"Insert Employee Number in REPAIR WORKSCOPE tab\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>If you want to prevent <strong>all</strong> printing, based only on the <code>T5</code> value in Sheet2:</p>\n\n<pre><code>Private Sub Workbook_BeforePrint(Cancel As Boolean)\n    If IsEmpty(Sheets(\"Sheet2\").Range(\"T5\").Value) Then\n        Cancel = True\n        MsgBox (\"Insert Employee Number in REPAIR WORKSCOPE tab\")\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5419398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07a4b57cba5693e5c0b2b57b1fd1b396?s=128&d=identicon&r=PG", "display_name": "Sundevil", "link": "https://stackoverflow.com/users/5419398/sundevil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 584, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1444236943, "creation_date": 1444235902, "last_edit_date": 1444236007, "question_id": 32997815, "link": "https://stackoverflow.com/questions/32997815/prevent-printing-for-specific-sheet-if-specific-cell-is-empty", "title": "Prevent printing for specific sheet if specific cell is empty", "body": "<p>I am trying to prevent printing capabilities if my T5 cell on my sheet 2 is empty. My code:</p>\n\n<pre><code>Private Sub Workbook_BeforePrint(Cancel As Boolean)\n    If IsEmpty(Range(\"T5\")) Then\n    Cancel = True\n    MsgBox (\"Insert Employee Number in REPAIR WORKSCOPE tab\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>I have tried doing the ActiveSheet.Name = \"Sheet 2\" before the <code>IsEmpty</code> command, but I only get error when I try to run.</p>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "edited": false, "score": 0, "creation_date": 1444237537, "post_id": 32998247, "comment_id": 53821300, "body": "I tried that too, but it gave me the same result. I tried using NumberFormat, Format and Style on the line below, but it gave me a Invalid Qualifier error.  &quot;total balance due amount on your account is &quot; &amp; <b>LastValue</b>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "edited": false, "score": 0, "creation_date": 1444237770, "post_id": 32998247, "comment_id": 53821420, "body": "Try declaring <code>Dim LastValue As String</code> instead of <code>As Long</code>."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1444237757, "last_edit_date": 1444237757, "creation_date": 1444237291, "answer_id": 32998247, "question_id": 32997731, "link": "https://stackoverflow.com/questions/32997731/format-excel-value-output-to-outlook/32998247#32998247", "title": "Format Excel value output to Outlook", "body": "<p>Try using the cell's <code>.Text</code> property instead of the <code>.Value</code></p>\n\n<p>You will need to change your declaration of <code>Lastvalue</code>, try:</p>\n\n<pre><code>Dim lastValue As String ' or As Variant\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 32998247, "answer_count": 1, "score": 1, "last_activity_date": 1444238833, "creation_date": 1444235651, "last_edit_date": 1444238833, "question_id": 32997731, "link": "https://stackoverflow.com/questions/32997731/format-excel-value-output-to-outlook", "title": "Format Excel value output to Outlook", "body": "<p>I'm trying to create a tool that grabs information from Excel and outputs it to Outlook. </p>\n\n<p>So far so good, but I'm unable to get a numerical value to show up formatted in the email. It shows it as plain numbers, e.g. <code>203486442</code>, but I want it to be <code>$203,486,441.93</code> instead. I get an \"Invalid Qualifier\" error when trying to format it. This number is pulled from the \"Total\" row of a Table in my worksheet. </p>\n\n<pre><code>Sub Test1()\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nDim LastRow As Long\nDim LastValue As Long\nLastRow = Sheets(\"Detail Aging\").Range(\"E\" &amp; Rows.Count).End(xlUp).Row\nLastValue = Sheets(\"Detail Aging\").Range(\"E\" &amp; LastRow).Value\n\nDim strbody As String\nFor Each cell In Worksheets(\"Body\").Range(\"B2:B6\")\n    strbody = strbody &amp; cell.Value &amp; vbNewLine\nNext\n\nOn Error GoTo cleanup\nFor Each cell In Columns(\"D\").Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value Like \"?*@?*.?*\" And _\n       LCase(Cells(cell.Row, \"E\").Value) = \"yes\" Then\n\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n        With OutMail\n            .To = cell.Value\n            .CC = Cells(cell.Row, \"G\").Value\n            .Subject = \"CompuCom Reminder Letter | \" &amp; Cells(cell.Row, \"B\").Value\n            .Body = \"Dear \" &amp; Cells(cell.Row, \"C\").Value &amp; \",\" _\n                &amp; vbNewLine &amp; vbNewLine &amp; _\n                \"This is a friendly reminder that the \" &amp; _\n                \"total balance due amount on your account is \" &amp; LastValue _\n                &amp; vbNewLine &amp; vbNewLine &amp; _\n                \"Here is the list of outstanding transactions:\" _\n                &amp; vbNewLine &amp; vbNewLine &amp; _\n                \"Please let us know what the payment status is and if you require additional \" &amp; _\n                \"information or documentation to process the invoice(s) for payment.\" _\n                &amp; vbNewLine &amp; vbNewLine &amp; _\n                \"Thank you.\" _\n                &amp; vbNewLine &amp; vbNewLine &amp; _\n                Cells(cell.Row, \"F\").Value &amp; vbNewLine &amp; _\n                Cells(cell.Row, \"G\").Value &amp; vbNewLine &amp; _\n                Cells(cell.Row, \"H\").Value &amp; vbNewLine &amp; _\n                \"Regards,\"\n            .Display\n        End With\n\n        On Error GoTo 0\n        Set OutMail = Nothing\n\n    End If\n\nNext cell\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1444237786, "post_id": 32997662, "comment_id": 53821432, "body": "It might help - you can remove the need for <code>.Select</code> completely (which is good practice) by just using the line <code>oWS.Columns(&quot;A:A&quot;).TextToColumn Destination:=oWS.Range(&quot;A1&quot;)...</code>  That change might help fix the issue.  Also, perhaps you could show some sample data from your worksheet that this <i>does</i> work on, and then some sample data for the one that <i>doesn&#39;t</i> work."}, {"owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444239537, "post_id": 32997662, "comment_id": 53822496, "body": "@BruceWayne - thank you. That did the trick. Code works perfectly now."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444239777, "post_id": 32997662, "comment_id": 53822635, "body": "Great! I added as an answer, and included a link on how/why to avoid using <code>.Select</code>, which is worth reading through."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1444239751, "last_edit_date": 1495542145, "creation_date": 1444239751, "answer_id": 32998990, "question_id": 32997662, "link": "https://stackoverflow.com/questions/32997662/code-to-format-excel-works-for-first-file-but-not-for-second/32998990#32998990", "title": "Code to format Excel works for first file but not for second", "body": "<p>It could have something to do with the use of <code>.Select</code> (which is recommended you <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using</a>).</p>\n\n<p>Change your lines</p>\n\n<pre><code>oWS.Columns(\"A:A\").Select\n        Selection.TextToColumns Destination:=oWS.Range(\"A1\"), DataType:=xlDelimited, TextQualifier:=-4142, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar:=\"|\", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True   \n</code></pre>\n\n<p>to </p>\n\n<pre><code>oWS.Columns(\"A:A\").TextToColumns Destination:=oWS.Range(\"A1\"), DataType:=xlDelimited, TextQualifier:=-4142, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar:=\"|\", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True   \n</code></pre>\n\n<p>What could be happening is that somehow the selection becomes unselected, so when going to use the selection, it's not \"there\".</p>\n"}], "owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 32998990, "answer_count": 1, "score": 0, "last_activity_date": 1594643542, "creation_date": 1444235396, "last_edit_date": 1594643542, "question_id": 32997662, "link": "https://stackoverflow.com/questions/32997662/code-to-format-excel-works-for-first-file-but-not-for-second", "title": "Code to format Excel works for first file but not for second", "body": "<p>I have three Excel files that are very similar in content and structure. There are a number of formatting steps that I need to apply to the files before I can work with them. Using Access VBA, I have developed some code to delete certain rows and to perform the <code>TextToColumns</code> function on the data.</p>\n\n<p>This code works fine for the first spreadsheet. However, I see this error for the second:</p>\n\n<blockquote>\n  <p>Run-time error '91': Object Variable or With block variable not set</p>\n</blockquote>\n\n<p>This occurs at the  <code>Selection.TextToColumns ...</code> line of the code (i.e. the actions above it perform ok for the second spreadsheet).</p>\n\n<p>Any ideas as to why this is happening?  </p>\n\n<p>After reviewing <a href=\"https://stackoverflow.com/questions/13519425/vba-program-wont-run-second-time\">this post</a>, I though maybe I need to add <code>With</code> before the <code>TextToColumns</code> or maybe define the range in a different way. But there my lack of VBA knowledge became very apparent!</p>\n\n<pre><code>Private Sub FormatFile(sPath As String)\n\n    Dim oExcel As Excel.Application\n    Dim owb As Workbook\n    Dim oWS As Worksheet\n\n    Dim sFile As String\n    Dim sDirectory As String\n    Dim rng As Range\n\n    Set oExcel = New Excel.Application\n    Set owb = oExcel.Workbooks.Open(sPath)\n    Set oWS = owb.Sheets(1)\n    Debug.Print oWS.Name\n\n    oExcel.Visible = False\n\n    DoCmd.SetWarnings False\n\n    sDirectory = fGetDirectory(sPath)\n    sFile = fGetFileName(sPath)\n\n        oWS.Rows(5).Delete\n        oWS.Rows(3).Delete\n        oWS.Rows(2).Delete\n        oWS.Rows(1).Delete\n        DeleteLastRow oWS.Columns(\"A\")\n\n          oWS.Columns(\"A:A\").Select\n        Selection.TextToColumns Destination:=oWS.Range(\"A1\"), DataType:=xlDelimited, TextQualifier:=-4142, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar:=\"|\", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True                   \n\n\n    owb.Save\n    owb.Close\n    oExcel.Quit\n    Set owb = Nothing\n    Set oWS = Nothing\n    Set rng = Nothing\n\n    Debug.Print \"created file \" &amp; sFile\n\n    DoCmd.SetWarnings True\n\n    Set oExcel = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5419305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d91eae4ac050ee59f70a42e61967da?s=128&d=identicon&r=PG&f=1", "display_name": "Creekmoj", "link": "https://stackoverflow.com/users/5419305/creekmoj"}, "edited": false, "score": 0, "creation_date": 1447787716, "post_id": 32997639, "comment_id": 55297983, "body": "Thanks Scott for your help - sorry it took so long to get back to this - I ran the routine and got a run-time error 1004 at this point: Field.CurrentPage = NewCat Else - any other suggestions?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 5419305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d91eae4ac050ee59f70a42e61967da?s=128&d=identicon&r=PG&f=1", "display_name": "Creekmoj", "link": "https://stackoverflow.com/users/5419305/creekmoj"}, "edited": false, "score": 0, "creation_date": 1447790126, "post_id": 32997639, "comment_id": 55299350, "body": "see my edited code and try again. I adjusted the <code>With Field</code> block."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1447790104, "last_edit_date": 1447790104, "creation_date": 1444235331, "answer_id": 32997639, "question_id": 32997308, "link": "https://stackoverflow.com/questions/32997308/no-criteria-match-with-filtered-pivot-table/32997639#32997639", "title": "No criteria match with filtered pivot table", "body": "<p>Untested because I didn't have any Pivot Table handy, but I think this should work. You may need to double check the syntax for selecting blanks in a pivot field. This should also negate the need for <code>On Error Resume Next</code>. Only use that if you absolutely <strong>HAVE</strong> to ... and even then double check if there is a way to avoid it :). If you do use it, make sure you set <code>On Error GoTo 0</code> right after you want to by-pass errors.</p>\n\n<pre><code>Dim pt As PivotTable, Field As PivotField, NewCat As String, pItem As PivotItem, bFound As Boolean\n\n    Set pt = Worksheets(\"Dbl Chk\").PivotTables(\"PivotTable1\")\n    Set Field = pt.PivotFields(\"iblc_binaisle\")\n    NewCat = Worksheets(\"Dbl Chk\").Range(\"B2\").Value\n\n    bFound = False\n    For Each pItem In Field.PivotItems\n\n        If pItem.Value = NewCat Then\n            bFound = True\n            Exit For\n        End If\n\n    Next\n\n    With Field\n        .ClearAllFilters\n        If bFound Then .CurrentPage = NewCat Else: .CurrentPage = \"&lt;&gt;\" 'i think this is syntax for blanks\n    End With\n\n    pt.RefreshTable\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5419305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d91eae4ac050ee59f70a42e61967da?s=128&d=identicon&r=PG&f=1", "display_name": "Creekmoj", "link": "https://stackoverflow.com/users/5419305/creekmoj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447790104, "creation_date": 1444234253, "last_edit_date": 1531164843, "question_id": 32997308, "link": "https://stackoverflow.com/questions/32997308/no-criteria-match-with-filtered-pivot-table", "title": "No criteria match with filtered pivot table", "body": "<p>I have VBA code to filter two pivot tables during a Physical Inventory count to compare count results with previous inventory data in a specific binaisle location.  It works great except when there is no count data for a specific location.  Then it lists everything in the table.  How do I code it to show no data in the table instead of all the data?</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nIf Intersect(Target, Range(\"B2:B3\")) Is Nothing Then Exit Sub\n\nDim pt As PivotTable\nDim Field As PivotField\nDim NewCat As String\n\nSet pt = Worksheets(\"Dbl Chk\").PivotTables(\"PivotTable1\")\nSet Field = pt.PivotFields(\"iblc_binaisle\")\nNewCat = Worksheets(\"Dbl Chk\").Range(\"B2\").Value\n\nOn Error Resume Next\n\nWith pt\nField.ClearAllFilters\nField.CurrentPage = NewCat\npt.RefreshTable\nEnd With\n\n\nSet pt1 = Worksheets(\"Dbl Chk\").PivotTables(\"PivotTable2\")\nSet Field1 = pt1.PivotFields(\"iblt_binaisle\")\n\nOn Error Resume Next\n\nWith pt1\nField1.ClearAllFilters\nField1.CurrentPage = NewCat\npt.RefreshTable\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444234913, "post_id": 32997228, "comment_id": 53819712, "body": "Just to make sure - you get <i>no</i> border at all, running that first one?  What if you step through the code, with F8? Still nothing happens?  No errors too?  The first code you give worked for me, I got a top border and double bottom border...hm."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444235092, "post_id": 32997228, "comment_id": 53819825, "body": "Hm - Create a new workbook, change the sheet name in your macro to &quot;Sheet1&quot; and run it, see if it works then on the new workbook...  Also, make sure your activeworkbook and worksheet exists (I&#39;m sure you have, but silly oversights certainly happen).  Also, before both <code>With</code> statements, add <code>ws.Range(&quot;Q2:T200&quot;).Select</code> and step through - this will make sure that the range you&#39;re expecting to border is correct..."}, {"owner": {"reputation": 17, "user_id": 5390071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf046d5dac63b483ee7409a60424487?s=128&d=identicon&r=PG&f=1", "display_name": "Ner", "link": "https://stackoverflow.com/users/5390071/ner"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444235307, "post_id": 32997228, "comment_id": 53819960, "body": "Ok i tried that, it seems to only fill the first row(Q2:T2), but nothing after that. I changed the cell reference to (Q2:Q100) to see if it would work, but still only the first row would fill. Added in <code>ws.Range(&quot;Q2:T200&quot;).Select</code> but still same problem, only the first row is being filled. Forgot to mention that only the top border is being filled for the first row, no bottom border"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444235437, "post_id": 32997228, "comment_id": 53820029, "body": "Also, you just want row 2 to have a line, and 200 to have a line - no lines in between?  I&#39;m able to get it to put a top line on T2 and a double bottom line at 200."}, {"owner": {"reputation": 17, "user_id": 5390071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf046d5dac63b483ee7409a60424487?s=128&d=identicon&r=PG&f=1", "display_name": "Ner", "link": "https://stackoverflow.com/users/5390071/ner"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444235525, "post_id": 32997228, "comment_id": 53820092, "body": "I want top/bottom for everything in between Q2:T200. My bad @BruceWayne, I should&#39;ve specified wanting it filled for every cell in between that range"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444235837, "post_id": 32997228, "comment_id": 53820264, "body": "Aha! Now I see (and @Davesexcel got it).  Glad to see you got it worked out.  Just for my curiosity, does your first macro just put a line at row 2, and then at row 200, with nothing in between? Or does it straight up not do anything?"}, {"owner": {"reputation": 17, "user_id": 5390071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf046d5dac63b483ee7409a60424487?s=128&d=identicon&r=PG&f=1", "display_name": "Ner", "link": "https://stackoverflow.com/users/5390071/ner"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1444235931, "post_id": 32997228, "comment_id": 53820327, "body": "Yeah it did do that, but I never bothered checking row 200 until you mentioned it because I thought it simply wasn&#39;t working. Your help was appreciated! :)"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444235514, "post_id": 32997592, "comment_id": 53820087, "body": "This adds a single top line to row 2, then double lines for each cell all the way to 200. I think OP just needed a top line, and a bottom double line, without in between borders.  Although, I&#39;m curious to know if this works for OP like it does for me/us.  If not, there&#39;s something else going on I think..."}, {"owner": {"reputation": 17, "user_id": 5390071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf046d5dac63b483ee7409a60424487?s=128&d=identicon&r=PG&f=1", "display_name": "Ner", "link": "https://stackoverflow.com/users/5390071/ner"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444235681, "post_id": 32997592, "comment_id": 53820180, "body": "@BruceWayne, that&#39;s what i wanted. I thought the range input would automatically loop for each cell but I was wrong.  Davesexcel, thanks a lot, this worked!"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1444235190, "creation_date": 1444235190, "answer_id": 32997592, "question_id": 32997228, "link": "https://stackoverflow.com/questions/32997228/table-borders-arent-being-filled/32997592#32997592", "title": "Table borders aren&#39;t being filled", "body": "<p>I believe you need to loop through each cell, for example:</p>\n\n<pre><code>Sub Button1_Click()\n    For Each cell In Range(\"Q2:T200\")\n        With cell.Borders(xlTop)\n            .LineStyle = xlContinuous\n            .Color = RGB(91, 155, 213)\n            .Weight = xlThin\n        End With\n    Next cell\n    For Each cell In Range(\"Q2:T200\")\n        With cell.Borders(xlBottom)\n            .LineStyle = xlDouble\n            .Color = RGB(91, 155, 213)\n            .Weight = xlThick\n        End With\n    Next cell\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5390071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf046d5dac63b483ee7409a60424487?s=128&d=identicon&r=PG&f=1", "display_name": "Ner", "link": "https://stackoverflow.com/users/5390071/ner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 32997592, "answer_count": 1, "score": 1, "last_activity_date": 1444235190, "creation_date": 1444234042, "last_edit_date": 1444234933, "question_id": 32997228, "link": "https://stackoverflow.com/questions/32997228/table-borders-arent-being-filled", "title": "Table borders aren&#39;t being filled", "body": "<p>I am trying to use the following to autofill top and bottom table borders for cells Q2:T200 : </p>\n\n<pre><code>Sub autofiller()\nDim ws As Worksheet\nDim wb As Workbook\n\nSet wb = ActiveWorkbook\nSet ws = wb.Worksheets(\"Pharmacontacts\")\n\nWith ws.Range(\"Q2:T200\").Borders(xlEdgeTop)\n.LineStyle = xlContinuous\n.Weight = xlThin\n.Color = RGB(91, 155, 213)\nEnd With\nWith ws.Range(\"Q2:T200\").Borders(xlEdgeBottom)\n.LineStyle = xlDouble\n.Weight = xlThick\n.Color = RGB(91, 155, 213)\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The problem is the table borders aren't being filled. I encountered the same problem with: </p>\n\n<pre><code>With Range(\"Q2:T200\").Borders(xlEdgeTop)\n.LineStyle = xlContinuous\n.color = RGB(91,155,213)\n.Weight = xlThin\n\nEnd With\nWith Range(\"Q2:T200\").Borders(xlEdgeBottom)\n.LineStyle = xlDouble\n.color = RGB(91,155,213)\n.Weight = xlThick\nEnd With\n</code></pre>\n\n<p>Also tried this:</p>\n\n<pre><code>With Range(\"Q2:T200\")\n    With .Rows(.Rows.Count)\n        With .Borders(xlEdgeTop)\n            .LineStyle = xlContinuous\n            .Weight = xlThin\n            .Color= RGB(91,155,213)\n        End With\n        With .Borders(xlEdgeBottom)\n            .LineStyle = xlContinuous\n            .Weight = xlThin\n            .Color= RGB(91,155,213)\n        End With\n    End With\nEnd With\n</code></pre>\n\n<p>I've tried other code online that addressed the same objective. None of the code I found online works - but seems to work for everyone else!</p>\n"}, {"tags": ["vba", "excel", "loops", "solver"], "comments": [{"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 0, "creation_date": 1444234912, "post_id": 32997174, "comment_id": 53819707, "body": "&quot;Doesn&#39;t work&quot; should be added to censored list... Can you explain more detailed what result are you getting - is it a compilation error, runtime exception or anything else?"}, {"owner": {"reputation": 45, "user_id": 5419224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c887b2ba072969a2b2116c077ff675?s=128&d=identicon&r=PG&f=1", "display_name": "fdt6243", "link": "https://stackoverflow.com/users/5419224/fdt6243"}, "reply_to_user": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 0, "creation_date": 1444235194, "post_id": 32997174, "comment_id": 53819880, "body": "It worked without the loop so it seems to be a compilation error (I am not sure about the correct syntax of the ByChange function)."}, {"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 0, "creation_date": 1444236719, "post_id": 32997174, "comment_id": 53820814, "body": "so that&#39;s it, you have missed double quotes in that place - ByChange:=&quot;$I$ &amp; i:$J$ &amp; i&quot; and you should use ByChange:=&quot;$I$&quot; &amp; i &amp; &quot;:$J$&quot; &amp; i  Try and let me know if it was an issue."}, {"owner": {"reputation": 45, "user_id": 5419224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c887b2ba072969a2b2116c077ff675?s=128&d=identicon&r=PG&f=1", "display_name": "fdt6243", "link": "https://stackoverflow.com/users/5419224/fdt6243"}, "reply_to_user": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 1, "creation_date": 1444237689, "post_id": 32997174, "comment_id": 53821375, "body": "That was the issue, with your syntax (ByChange:=&quot;$I$&quot; &amp; i &amp; &quot;:$J$&quot; &amp; i) everything works fine"}, {"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 0, "creation_date": 1444237985, "post_id": 32997174, "comment_id": 53821553, "body": "Great news! Glad to help you :)"}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 4275816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/91Zq4.gif?s=128&g=1", "display_name": "shg", "link": "https://stackoverflow.com/users/4275816/shg"}, "is_accepted": true, "score": 1, "last_activity_date": 1444235741, "creation_date": 1444235741, "answer_id": 32997758, "question_id": 32997174, "link": "https://stackoverflow.com/questions/32997174/vba-solver-loop/32997758#32997758", "title": "VBA Solver loop", "body": "<p>Maybe ...</p>\n\n<pre><code>Dim i             As Long\n\nFor i = 7 To 17\n  SolverReset\n\n  With Rows(i)\n    SolverOk SetCell:=.Range(\"K1\").Address, _\n             MaxMinVal:=1, _\n             ByChange:=.Range(\"I1:J1\").Address, _\n             Engine:=1\n    SolverAdd CellRef:=.Range(\"G1\").Address, _\n              Relation:=2, _\n              FormulaText:=.Range(\"H1\").Address\n    SolverAdd CellRef:=.Range(\"K1\").Address, _\n              Relation:=2, _\n              FormulaText:=.Range(\"B1\").Address\n    SolverSolve UserFinish:=True\n  End With\nNext i\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5419224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c887b2ba072969a2b2116c077ff675?s=128&d=identicon&r=PG&f=1", "display_name": "fdt6243", "link": "https://stackoverflow.com/users/5419224/fdt6243"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 32997758, "answer_count": 1, "score": 0, "last_activity_date": 1444235741, "creation_date": 1444233919, "last_edit_date": 1531164843, "question_id": 32997174, "link": "https://stackoverflow.com/questions/32997174/vba-solver-loop", "title": "VBA Solver loop", "body": "<p>I am using Solver with the following code:</p>\n\n<pre><code>Sub Test()\n\n  SolverReset\n\n  SolverOk SetCell:=\"$K$7\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$I$7:$J$7\", _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n\n  SolverAdd CellRef:=\"$G$7\", Relation:=2, FormulaText:=\"$H$7\"\n  SolverAdd CellRef:=\"$K$7\", Relation:=2, FormulaText:=\"$B$7\"\n\n  SolverSolve UserFinish:=False\n\n  SolverFinish KeepFinal:=1\n\nEnd Sub\n</code></pre>\n\n<p>I now need to put it into a loop in order to run Solver from row 7 to row 17. I coded it as per the below but it doesn't work:</p>\n\n<pre><code>Dim i As Long\nFor i = 7 To 17\n  SolverReset\n\n  SolverOk SetCell:=\"$K$\" &amp; i, MaxMinVal:=1, ValueOf:=0, ByChange:=\"$I$ &amp; i:$J$ &amp; i\", _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n\n  SolverAdd CellRef:=\"$G$\" &amp; i, Relation:=2, FormulaText:=\"$H$\" &amp; i\n  SolverAdd CellRef:=\"$K$\" &amp; i, Relation:=2, FormulaText:=\"$B$\" &amp; i\n\n  SolverSolve UserFinish:=False\n\n  SolverFinish KeepFinal:=1\n\nNext i  \n\nEnd sub\n</code></pre>\n"}, {"tags": ["excel", "hyperlink", "vba"], "comments": [{"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1444233736, "post_id": 32997010, "comment_id": 53818921, "body": "Using Excel 2013 on Windows 7, the formula works just fine for me."}, {"owner": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "reply_to_user": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1444233854, "post_id": 32997010, "comment_id": 53819003, "body": "I am using 2016. with windows 8.1 . I dont have excel 2013. is there any way i can test it. Also, did you click on the cell where =hyperlink(&quot;link&quot;,1) is? Did it take you to the browser?"}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1444234015, "post_id": 32997010, "comment_id": 53819128, "body": "If you replace cell A1 with <a href=\"http://google.com\" rel=\"nofollow noreferrer\">google.com</a>, does it function fine? If so, do you have any web-proxy or network monitoring tool that might be an issue?"}, {"owner": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "reply_to_user": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1444234090, "post_id": 32997010, "comment_id": 53819174, "body": "yes, it works fine with google.com or other shorter links. I am wondering is it because, the the bitly link( that I posted above) was formed from link &gt;500 characters?"}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1444234156, "post_id": 32997010, "comment_id": 53819227, "body": "I think something&#39;s going on with the browser. Can you default your browser to firefox, chrome and IE and check if this issue can be isolated to only a specific browser? Then, just copy the text <a href=\"http://bit.ly/1FVcuRx\" rel=\"nofollow noreferrer\">bit.ly/1FVcuRx</a> and paste it in your current default browser and see if that works."}, {"owner": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "reply_to_user": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1444234275, "post_id": 32997010, "comment_id": 53819301, "body": "So, I tried it on chrome and IE, it worked fine. But when I click it from Excel, it doesnt work."}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "reply_to_user": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "edited": false, "score": 0, "creation_date": 1444234342, "post_id": 32997010, "comment_id": 53819340, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/91630/discussion-between-zedfoxus-and-user1631306\">continue this discussion in chat</a>."}, {"owner": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "reply_to_user": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1444237785, "post_id": 32997010, "comment_id": 53821430, "body": "Its seems like there are issue with excel 2013 and excel 2016( from office 365). I tried it with google docs and excel 2013 (regular edition) and it worked fine."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1444384731, "post_id": 32997010, "comment_id": 53891804, "body": "I have tested your code ~=HYPERLINK(A1, 2) ~ on my Office 365 and it works fine. It takes to url&lt;<a href=\"http://www.ncbi.nlm.nih.gov/pubmed/?term=(%22benzo(a)pyrene%22[tiab]%20OR%20%2250-32-8%22[rn]%20OR%20%22b(a)p%22[tiab]%20OR%20%22benzo(d,%20e,%20f)chrysene%22[tiab]%20OR%20%223,4-benzopyrene%22[tiab]%20OR%20%223,4-benzo(a)pyrene%22[tiab]%20OR%20%226,7-benzopyrene%22[tiab]%20OR%20%22benz(a)pyrene%22[tiab]%20OR%20%221,2-benzpyrene%22[tiab]%20OR%20%223,4-benzp\" rel=\"nofollow noreferrer\">ncbi.nlm.nih.gov/pubmed/&hellip;</a>........&gt; Please see my sample file &lt;<a href=\"https://www.dropbox.com/s/06qq5p0dtnj9pdf/test_0910_2015.xlsx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/06qq5p0dtnj9pdf/test_0910_2015.xlsx?dl=0</a>&gt;"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1444384841, "post_id": 32997010, "comment_id": 53891878, "body": "I have excel 2016 from office 365"}, {"owner": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "edited": false, "score": 0, "creation_date": 1444500877, "post_id": 32997010, "comment_id": 53934628, "body": "Then it seems something is wrong with my edition. I downloaded your file and still I got the same error. My friend tried with his 2016 office 365 and he was able to click it, but the link got truncated and he got wrong results on NCBI site"}], "answers": [{"comments": [{"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1444242973, "post_id": 32999919, "comment_id": 53824446, "body": "Great find. Thank you for publishing your findings. If you can, please feel free to mark your answer as accepted to give closure to this question."}], "tags": [], "owner": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "is_accepted": true, "score": 1, "last_activity_date": 1444242902, "creation_date": 1444242902, "answer_id": 32999919, "question_id": 32997010, "link": "https://stackoverflow.com/questions/32997010/hyperlink-cant-find-long-links-even-when-shortened-by-bitly/32999919#32999919", "title": "HYPERLINK can&#39;t find long links even when shortened by Bitly", "body": "<p>Its seems like there are issue with excel 2013 and excel 2016( from office 365). I tried it with google docs and excel 2013 (regular edition) and it worked fine. </p>\n"}, {"comments": [{"owner": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "edited": false, "score": 0, "creation_date": 1444598266, "post_id": 33036003, "comment_id": 53958532, "body": "something is wrong with my excel version. When i downloaded your file and click on the hyperlinks and link, it goes to &quot;file:///C:/Users/arpit/AppData/Local/Microsoft/Windows/INet&zwnj;&#8203;Cache/IE/5G5BWT56/pu&zwnj;&#8203;bmed%5B1%5D.htm&quot; . Does it ring any bell? Instead of going to actual link, it goes to some local file? Its the same problem i had earlier"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "edited": false, "score": 0, "creation_date": 1444598859, "post_id": 33036003, "comment_id": 53958684, "body": "Excel 2013 and later version 2016 should be installed after removing previous versions of Office. I have seen conflict issues reported in various forums."}, {"owner": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "edited": false, "score": 0, "creation_date": 1444615839, "post_id": 33036003, "comment_id": 53962458, "body": "I am using window 8.1 . I am not sure if its excel issue. I tried in my frnds laptops having 2013 edition and windows 10, it had same issue. But frnds with windows 7 with excel 2013 edition, it worked fine there."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "edited": false, "score": 0, "creation_date": 1444632322, "post_id": 33036003, "comment_id": 53966924, "body": "Please raise this issue in ms community forum for better resolution of the problem."}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1444386754, "creation_date": 1444386754, "answer_id": 33036003, "question_id": 32997010, "link": "https://stackoverflow.com/questions/32997010/hyperlink-cant-find-long-links-even-when-shortened-by-bitly/33036003#33036003", "title": "HYPERLINK can&#39;t find long links even when shortened by Bitly", "body": "<p>Your code ~=HYPERLINK(A1, 2) ~ works fine on my excel 2016 from Office 365.\nAlternatively you can turn these tiny urls to clickable hyperlinks with the following code. I have uploaded a sample file to dropbox also.<a href=\"https://www.dropbox.com/s/52vl33rma7468no/test_0910_2015b.xlsm?dl=0\" rel=\"nofollow\">https://www.dropbox.com/s/52vl33rma7468no/test_0910_2015b.xlsm?dl=0</a></p>\n\n<pre><code>Sub ConvertToHyperlinks()\n  Dim Rng As Range\n  Dim WorkRng As Range\n  On Error Resume Next\n  Set WorkRng = Application.Selection\n  Set WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\n  For Each Rng In WorkRng\n    Application.ActiveSheet.Hyperlinks.Add Rng, Rng.Value\n  Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3830, "user_id": 1631306, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e6d069a69ac7ccd935a285be67a70a55?s=128&d=identicon&r=PG", "display_name": "user1631306", "link": "https://stackoverflow.com/users/1631306/user1631306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 32999919, "answer_count": 2, "score": 0, "last_activity_date": 1444386754, "creation_date": 1444233487, "last_edit_date": 1531161705, "question_id": 32997010, "link": "https://stackoverflow.com/questions/32997010/hyperlink-cant-find-long-links-even-when-shortened-by-bitly", "title": "HYPERLINK can&#39;t find long links even when shortened by Bitly", "body": "<p>With Excel VBA I use Bitly API to shorten long links. The macro ran perfectly and I was able to convert all the long links into short ones. Now, when I copy/paste these links to browser, they work fine, example <code>http://bit.ly/1FVcuRx</code> but when I use them with:  </p>\n\n<pre><code> =HYPERLINK(A1, 2)  \n</code></pre>\n\n<p>where A1 = <code>http://bit.ly/1FVcuRx</code>, and then I click on it, it errors: \"cannot find [some file, local directory]\".</p>\n\n<p>I am not sure how can I make it work, as the link works fine but the hyperlink doesn't work with it.</p>\n\n<p>Also, I noticed one thing, for the shorter links (less than 255 characters), when I ran macro, the Bitly link works fine with HYPERLINK function.</p>\n"}, {"tags": ["c#", "c++", "vba", "com", "iconnectionpoint"], "comments": [{"owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 1, "creation_date": 1444405455, "post_id": 32997005, "comment_id": 53905356, "body": "<code>IConnectionPointImpl</code> is about events and your foreach loop is accessing extension property directly, why do you think <code>IConnectionPointImpl</code> is involved here? It would make more sense if your code snippet was C++ code running inside some event handler and that would query external Name property, but this snippet would have to be C++ then and yours in C#."}, {"owner": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "reply_to_user": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 0, "creation_date": 1444405805, "post_id": 32997005, "comment_id": 53905611, "body": "Because I can step through and see that it is. Note that <code>ve</code> is a .NET object in C# which exposes the <code>.Name</code> property; that property is backed in C++ by a method which finds the ICPI interface registered by the VBA macro and <code>Dispatch</code>es the relevant... uh... <i>thing</i>, which makes the VBA call which returns the Name. That is, the call is C#-(.NET)-&gt;C++-(IConnectionPointImp)-&gt;VBA. Not C#-&gt;VBA."}, {"owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 0, "creation_date": 1444406179, "post_id": 32997005, "comment_id": 53905834, "body": "Just to make sure I got this right: <code>ve.Name</code> has C# implementation, then it calls some C++ code (COM interface method?), then C++ code does its things somehow, and as part of it it issues a COM event, which is handled by certain VBA handler and this handler would be the source of the string in question? Then you see that the string is lost (already in C++ code as early as after completion of <code>IDispatch::Invoke</code>) when all this is called in mentioned scenario."}, {"owner": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "reply_to_user": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 0, "creation_date": 1444406649, "post_id": 32997005, "comment_id": 53906139, "body": "Very nearly. <code>ve.Name</code> has no C# imlpementation. <code>VBAExtension</code> is a type from our C++ application&#39;s type library, so <code>ve.Name</code> is directly over COM. Otherwise, yes."}, {"owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 2, "creation_date": 1444406946, "post_id": 32997005, "comment_id": 53906279, "body": "My guess is that it is a threading problem. Your COM object is most likely STA object. Then VBA sink interface is - cutting long story short - restricted to receive calls from the same thread where it connected to connection point. I suppose you some how calling it from another thread afterwards. This is easy to check by tracing thread IDs you have these calls on. Then if you step inside connection point code, there is a chance that you could also see that <code>Invoke</code> call gets you failure <code>HRESULT</code> which might be later ignored. It again might explain the reason (esp. <code>RPC_E_WRONG_THREAD</code>)."}, {"owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 0, "creation_date": 1444407459, "post_id": 32997005, "comment_id": 53906561, "body": "I noticed your mention that you get <code>S_OK</code> from <code>Invoke</code> though. Also, do you have this string filled by the event handler into <code>[in, out] BSTR*</code> parameter? If you left <code>out</code> out there then marshaler would not take VBA&#39;s string back to your C++ code, however with direct no-marshaling call it might work out well."}, {"owner": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "reply_to_user": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 0, "creation_date": 1444638542, "post_id": 32997005, "comment_id": 53970075, "body": "Checking thread IDs, the <code>Invoke</code> call is being made in the same C++ thread as the registration for both the modal and modeless cases. I am indeed getting <code>S_OK</code> from the <code>Invoke</code> - <code>pDispatch-&gt;Invoke(0x1, IID_NULL, LOCALE_USER_DEFAULT, DISPATCH_METHOD, &amp;disp, &amp;varResult, NULL, NULL);</code> returns <code>S_OK</code> but <code>disp.rgvargs</code> is empty. The <code>.idl</code> does indeed have <code>[in, out] BSTR*</code> - are you suggesting it might <i>work</i> if it were just <code>[in] BSTR*</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "edited": false, "score": 0, "creation_date": 1445247150, "post_id": 33185280, "comment_id": 54226291, "body": "Thanks for the pointers. As you may have guessed, I&#39;m not a VBA / COM expert, so your diag suggestions are very welcome. I&#39;ve updated my answer - the main point appears to be the in the failure case the VBA event is not being executed at all."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "reply_to_user": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "edited": false, "score": 0, "creation_date": 1445249032, "post_id": 33185280, "comment_id": 54227402, "body": "Well, you&#39;ve got your smoking gun, binding the VBA event handler just never happened.  An execution order problem is the best theory, you however can&#39;t set a clean breakpoint on the code that is supposed to do the binding.  Focus on the code that loads the VBA module and ensure it runs before the dialog appears.  Call Microsoft Support if necessary, they can set that breakpoint."}, {"owner": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "edited": false, "score": 0, "creation_date": 1445249745, "post_id": 33185280, "comment_id": 54227797, "body": "Hmm, not sold on that. Given a C# assembly with two entry points, one of which displays the dialog as Modal and one as Modeless; and two VBA macros each calling one of those entry points; the event fires in the modeless case and fails in the modal case when performed in either order <i>even within the same application execution</i>. So it&#39;s definitely bound, because the modeless case can call it."}], "tags": [], "owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": false, "score": 4, "last_activity_date": 1445171992, "last_edit_date": 1445171992, "creation_date": 1445076166, "answer_id": 33185280, "question_id": 32997005, "link": "https://stackoverflow.com/questions/32997005/problems-calling-iconnectionpointimpl-interface-from-c-invoked-via-modal-winfo/33185280#33185280", "title": "Problems calling IConnectionPointImpl interface from C++ invoked via modal WinForms", "body": "<p>There are excessively few hard facts in this question to build an answer on.  Could be something very simple, could be a nasty memory corruption problem or an obscure dependency inside the VBA interpreter on the thread state.  The rough diagnostic is that the VBA event handler simply did not run.  That is not an uncommon accident in general, the declarative style used in Basic to declare event handlers leave very few good way to ever diagnose subscription problems.  Many a VBA programmer has lost clumps of hair trying to troubleshoot a \"why did the event handler not run\" problem like this one.</p>\n\n<p>Gather some hard facts first and add them to your question:</p>\n\n<ul>\n<li>First verify that your C++ code can actually see that there is no event handler at all.  Use the good version, rename the event handler.  Expectation is that you don't, raising an event that the sink doesn't subscribe is not an error.</li>\n<li>Verify that the event handler actually executed in the bad version.  Have it do something else than assign the BSTR argument, some you can easily see like a file on disk.</li>\n<li>Verify that you can properly diagnose an exception in the event handler.  Assign the Err object and verify that your C++ code generates a proper diagnostic.  Note that your IDispatch::Invoke() call passes NULL for pExcepInfo, not a good way to generate a diagnostic.</li>\n<li>Check if the event runs the <em>second</em> time you display a window, if it does then you have an execution order problem.</li>\n</ul>\n\n<p>Focusing a bit on ShowDialog().  This method does have plenty of side-effects.  The first thing that no longer works is the message loop in your C++ code.  It is now the .NET message loop that dispatches messages.  Look at yours for side-effects, doing more work than simply GetMessage/DispatchMessage().  That work no longer gets done.  Also search your codebase for PostThreadMessage(), those messages fall on the floor when the .NET code pumps.</p>\n\n<p>And keep in mind that your native C++ code loses control when the C# code calls ShowDialog().  It doesn't regain control until you close the window.  That can trigger a simple order-of-execution problem, your C++ code should not do anything important after does whatever it does to get the C# code running.</p>\n"}], "owner": {"reputation": 42691, "user_id": 93884, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f912a87ba919942acb4048838f6b2572?s=128&d=identicon&r=PG", "display_name": "Chowlett", "link": "https://stackoverflow.com/users/93884/chowlett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1445247087, "creation_date": 1444233464, "last_edit_date": 1445247087, "question_id": 32997005, "link": "https://stackoverflow.com/questions/32997005/problems-calling-iconnectionpointimpl-interface-from-c-invoked-via-modal-winfo", "title": "Problems calling IConnectionPointImpl interface from C++ invoked via modal WinForms", "body": "<p>We have a native C++ application which supports some VBA macros of various types over COM. One of these types, <code>VBAExtension</code>, registers itself with the core C++ application, resulting in an instance of (a class derived from) <code>IConnectionPointImpl&lt;Extension, &amp;DIID_IExtensionEvents, CComDynamicUnkArray&gt;</code>. This works fine; both core and other VBA macros can access the methods on IExtensionEvents, given an appropriate VBAExtension object.</p>\n\n<p>We also have a .NET assembly (written in C#) which is also loaded in to the core application at run-time. For historical reasons, the assembly is loaded in by an auto-running VBA macro; then, when the user presses a particular button, another VBA macro runs the main entry point of the assembly, which brings up a <code>System.Windows.Forms</code> dialog for further interaction.</p>\n\n<p>That\u2019s the setup. I\u2019m seeing some weird behaviour accessing the <code>VBAExtension</code> methods from within the .NET assembly. Specifically, I am running the following code from various locations in the assembly:</p>\n\n<pre><code>foreach (VBAExtension ve in app.Extensions)\n{\n    System.Diagnostics.Debug.Print(\"Ext: \" + ve.Name);\n}\n</code></pre>\n\n<p>If I run it from the constructor of the assembly\u2019s main object; or from the assembly\u2019s main entry point (before the dialog is displayed), everything is fine \u2013 I get the names of the <code>VBAExtension</code>s printed out. </p>\n\n<p>However, if I run the same code from a command kicked off by a button in the assembly\u2019s (<strong>modal</strong> - we're calling <code>form.ShowDialog()</code>) WinForm, the <code>ve.Name</code>s are all blank. The <code>pDispatch-&gt;Invoke</code> call made by the <code>IConnectionPointImpl</code> subclass succeeds (returns S_OK), but does not set any return vars.</p>\n\n<p>If I change the dialog to be <em>non-modal</em> (invoked with <code>form.Show()</code>), then the names work again. The modality (modalness?) of the form appears to affect whether the <code>IConnectionPointImpl</code> calls succeed.</p>\n\n<p>Anyone know what's going on?</p>\n\n<p><strong>Edit:</strong> Since first posting, I've demonstrated that it's not the invoking call stack that matters; instead, it's whether the call is made from a modal dialog. I have updated the main text.</p>\n\n<p><strong>Edit 2:</strong> Per Hans Passant's answer, here are the answers to his diagnostic questions:</p>\n\n<ul>\n<li>As expected, in the good (modeless) case there is no error if I rename the VBA event handler. The call simply returns no data.</li>\n<li>I've put a MsgBox call into the VBA handler; it displays in the modeless case, but does not in the modal case. Ergo, the handler is not executed in the modal case.</li>\n<li>By use of <code>Err</code>, I can tell that if we hit an exception in the VBA handler we get a VBA error dialog. Once clearing that, the C++ <code>Invoke</code> call has 0x80020009 (\"Exception occurred\") as return code, and pExcepInfo filled in with generic failure values (VBA has swallowed the actual details)</li>\n<li>The event does not fire on the second display of the modal dialog, either immediately following the first dialog or during a second invocation of the C# add-in.</li>\n</ul>\n\n<p>I'll try to dig into our message loops as a next step.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1444243536, "post_id": 32996772, "comment_id": 53824783, "body": "I think that it is too strong to say that one &quot;should never depend on default properties&quot;. If I want to reference Sheet2 I see no reason to write <code>Sheets.Item(2)</code> rather than <code>Sheets(2)</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1444244735, "post_id": 32996772, "comment_id": 53825542, "body": "@JohnColeman I believe the OP&#39;s general message was about default properties that don&#39;t have parameters. The ones that do are perfectly fine and where shipped to .NET to live long and well."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1444235433, "post_id": 32996934, "comment_id": 53820026, "body": "It&#39;s also idential to <code>Range(&quot;A1&quot;).Cells(1).Value</code> and <code>Range(&quot;A1&quot;).Cells.Item(1).Value</code>..."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1444240117, "post_id": 32996934, "comment_id": 53822796, "body": "When the <code>Range</code> instance is used outside of a <code>For Each</code> loop I&#39;d say that&#39;s correct."}], "tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": false, "score": -1, "last_activity_date": 1444233285, "creation_date": 1444233285, "answer_id": 32996934, "question_id": 32996772, "link": "https://stackoverflow.com/questions/32996772/is-value-actually-the-default-property-of-the-range-object/32996934#32996934", "title": "Is &quot;Value&quot; actually the default property of the Range object?", "body": "<p>Yes, it appears that Value is default property of Range.</p>\n\n<p>I put a very large number in cell A1.</p>\n\n<pre><code>Sub Test()\n    Debug.Print \"Range default = \" &amp; Range(\"A1\") &amp; vbCrLf _\n        &amp; \"Range Text = \" &amp; Range(\"A1\").Text &amp; vbCrLf _\n        &amp; \"Range Value = \" &amp; Range(\"A1\").Value &amp; vbCrLf _\n        &amp; \"Range Value2 = \" &amp; Range(\"A1\").Value2\nEnd Sub\n\nResults in \n\nRange default = 3.24643541346456E+28\nRange Text = 3.25E+28\nRange Value = 3.24643541346456E+28\nRange Value2 = 3.24643541346456E+28\n</code></pre>\n\n<p>Notice that Range(\"A1\")'s result is identical to Range(\"A1\").Value and Range(\"A1\").Value2</p>\n"}, {"comments": [{"owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "edited": false, "score": 0, "creation_date": 1444234969, "post_id": 32997154, "comment_id": 53819745, "body": "Do you mean the <code>item</code> property instead of the <code>item</code> method?  If I try to explicitly use the <code>item</code> property I get an <code>Argument not Optional</code> message since it requires at least one argument"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "reply_to_user": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "edited": false, "score": 1, "creation_date": 1444239716, "post_id": 32997154, "comment_id": 53822587, "body": "Actually the distinction between <i>property</i> and <i>method</i> is blurrier than one might think. A <i>property</i> consists of two functions, a getter and a setter. Getting a property value means calling the property&#39;s getter function. Especially in this case, where the getter can handle two argumens: <code>.Item(row, col)</code>. If it was called <code>.GetItem(row, col)</code>, everyone would say that&#39;s a <i>method</i>, even if all that had changed was the name. So, yes, technically <code>.Item()</code> is a <i>property</i> of the <code>Range</code> class, but it&#39;s more a concept and less of a substantial difference."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 5, "creation_date": 1444243190, "post_id": 32997154, "comment_id": 53824568, "body": "The <code>_Default</code>&#39;s signature is not exact same signature as the <code>.Item</code> property - the first parameter is optional in <code>_Default</code> and required in <code>Item</code>. The only explanation that I can come up with from the COM point of view is that <code>_Default</code> is the only true default property, and it calls either <code>Item</code> or <code>Value</code> depending on whether or not a parameter was supplied. Note that if a parameter was supplied, <code>_Default</code> will not call <code>Value</code>, even though <code>Value</code> accepts a parameter too."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1444243649, "post_id": 32997154, "comment_id": 53824850, "body": "@GSerg Now that you say it, it makes absolute sense. I have overlooked the difference in the signatures. That&#39;s the explanation. That I can&#39;t say <code>RangeObject(1)</code> in VBA has to do with the fact that <code>_Default</code> is marked as hidden?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1444243965, "post_id": 32997154, "comment_id": 53825057, "body": "@Tomalak it&#39;s <a href=\"http://i.stack.imgur.com/SV1tr.png\" rel=\"nofollow noreferrer\">not that hidden</a> ;) and no, that&#39;s not because you can&#39;t say <code>Range(1)</code>. You can&#39;t say <code>Range(1)</code> because you&#39;re calling the <code>Application.Range</code> method which is not happy with this parameter. This is different to declaring a <code>Range</code> variable, where you certainly can say <code>r(1)</code> to return the first cell."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1444245628, "post_id": 32997154, "comment_id": 53826122, "body": "I tried with <code>ActiveSheet.UsedRange(1)</code> and that doesn&#39;t work either. But where&#39;s the difference?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1444248780, "post_id": 32997154, "comment_id": 53828081, "body": "This has to do something with late binding (weird things may happen with late binding and default properties, there was a link somewhere but I can&#39;t find it). If you declare a <code>Worksheet</code> variable, then <code>w.UsedRange(1)</code> works fine."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1444249373, "post_id": 32997154, "comment_id": 53828393, "body": "Which might actually be seen as a compiler bug to tell you the truth; VB should be able to resolve this at runtime no problem. What happens is that it tries to pass the <code>1</code> parameter to the <code>UsedRange</code> property <i>itself</i>, as opposed to the default property of the object returned by <code>UsedRange</code>. You can work around this by using the function-style syntax: <code>MsgBox ActiveSheet.UsedRange()(1)</code>, even though <code>UsedRange</code> is not a function."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 1, "creation_date": 1444271739, "post_id": 32997154, "comment_id": 53835951, "body": "Well, technically it &quot;is&quot; a function. VB interprets the parameter as an argument for the getter, just as with <code>.Item(1)</code>. The ambiguity arieses when thr getter accepts arguments and the returned object&#39;s default member does the same. IMHO, properties are nothing but syntactic sugar for reducing the funtion count on an object, collapsing getters and setters into one."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1500681825, "post_id": 32997154, "comment_id": 77462677, "body": "@GSerg What&#39;s really strange is that <code>TypeName(sheet1.Cells.[_Default](1,2))</code> returns <code>Range</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1500705936, "post_id": 32997154, "comment_id": 77467620, "body": "@ThunderFrame Why is that strange? With two parameters, <code>_Default</code> apparently <a href=\"https://stackoverflow.com/questions/32996772/is-value-actually-the-default-property-of-the-range-object/32997154?noredirect=1#comment53824568_32997154\">calls <code>Item</code></a> which returns a range."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1500706608, "post_id": 32997154, "comment_id": 77467760, "body": "@GSerg Well, it seems you <i>can</i> call the implicit default member all the way through the returned Ranges: <code>sht.Cells(1, 2)(1, 1)(1, 1)(1, 1)(1, 1)(1, 1)</code> and yet you can&#39;t explicitly use <code>[_Default]</code> beyond the first call, like this: <code>sht.Cells.[_Default](1,2).[_Default](1,1) &#39;Runtime error 438 - Object doesn&#39;t support this property or method</code>. See the RD <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/3153\" rel=\"nofollow noreferrer\">issue</a>"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1500958350, "post_id": 32997154, "comment_id": 77550051, "body": "@GSerg I think this <a href=\"https://blogs.msdn.microsoft.com/ericlippert/2005/08/30/vbscript-default-property-semantics/\" rel=\"nofollow noreferrer\">article by Eric Lippert</a> is the article you couldn&#39;t find. It also links to further information in another blog <a href=\"https://blogs.msdn.microsoft.com/ericlippert/2004/05/04/simplescript-part-seven-binder-skeleton/\" rel=\"nofollow noreferrer\">post</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1500966887, "post_id": 32997154, "comment_id": 77554232, "body": "@ThunderFrame I don&#39;t remember seeing that; great reading though. I was thinking about a question here about weird things which I couldn&#39;t find."}], "tags": [], "owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "is_accepted": false, "score": 8, "last_activity_date": 1444243622, "last_edit_date": 1495541853, "creation_date": 1444233884, "answer_id": 32997154, "question_id": 32996772, "link": "https://stackoverflow.com/questions/32996772/is-value-actually-the-default-property-of-the-range-object/32997154#32997154", "title": "Is &quot;Value&quot; actually the default property of the Range object?", "body": "<p>The default member of the <code>Range</code> class is called <code>_Default</code> and is hidden. When you enable the \"Show Hidden Members\" feature in the Object Browser you can see it:</p>\n\n<p><img src=\"https://i.stack.imgur.com/L4HU2.png\" alt=\"VBA Object Browser\"></p>\n\n<p><strike>It has the exact same signature as the <code>.Item</code> property, so one of them is arguably an alias for the other.</strike><sup>(*)</sup></p>\n\n<p>In any case, <code>Range</code> also implements the collection interface. As such, it can be used in a <code>For Each</code> loop \u2014 and when you do that, the loop will call <code>.Item</code> with each iteration and assign the current item to the loop variable.</p>\n\n<p>When used outside an enumeration, for example with <code>Debug.Print</code>, then <code>.Value</code> will be used, but I can't really explain why. Maybe someone else can come up with a hint.<sup>(*)</sup></p>\n\n<hr>\n\n<p><sup>(*)</sup> As @GSerg <a href=\"https://stackoverflow.com/questions/32996772/#comment53824568_32997154\">points out</a> in the comments, <code>_Default()</code> and <code>_Item()</code> are not exactly equal.</p>\n"}], "owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2813, "favorite_count": 3, "answer_count": 2, "score": 7, "last_activity_date": 1444243622, "creation_date": 1444232847, "question_id": 32996772, "link": "https://stackoverflow.com/questions/32996772/is-value-actually-the-default-property-of-the-range-object", "title": "Is &quot;Value&quot; actually the default property of the Range object?", "body": "<p>Before I begin I want to say that I realize you should never depend on default properties and I won't, but this is curious.  I've always read that <code>value</code> is the default property for the <code>Range</code> Object, hence why this works:</p>\n\n<pre><code>Range(\"A1\") = 2\n</code></pre>\n\n<p>However, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"noreferrer\">this</a> page claims that <code>item</code> is the default property of <code>Range</code>.</p>\n\n<p>Additionally, this sub I made would suggest that <code>cells</code> is the default property instead:</p>\n\n<pre><code>Sub defaultprop()\n\nDim c As Variant\n\n\nFor Each c In Range(\"A1:A2\")\n\n    Debug.Print c.value\n\nNext c\n\nFor Each c In Range(\"A1:A2\").value\n\n    Debug.Print c\n\nNext c\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "mailing-list"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444233998, "post_id": 32996385, "comment_id": 53819117, "body": "You are on the right track. Column A has emails. Column B has file location. Loop through column A to get email and Column B to attach. This link is a great start. <a href=\"http://stackoverflow.com/questions/17883088/excel-vba-sending-mail-using-outlook-send-method-fails\" title=\"excel vba sending mail using outlook send method fails\">stackoverflow.com/questions/17883088/&hellip;</a>. (Not sure why user had issue with <code>.Send</code> but it always work for me.) So, set up a loop in your workbook and apply the <code>To</code> from Column A and <code>Attachment</code> from Column B and fill the rest out as needed."}], "answers": [{"comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1444237194, "post_id": 32997350, "comment_id": 53821109, "body": "What it you don&#39;t have outlook?  Can other email clients be used like &quot;Windows live 2012&quot; or &quot;Thunderbird&quot;."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1444241043, "post_id": 32997350, "comment_id": 53823333, "body": "@HarveyFrench OP didn&#39;t specify."}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": true, "score": 1, "last_activity_date": 1444234398, "creation_date": 1444234398, "answer_id": 32997350, "question_id": 32996385, "link": "https://stackoverflow.com/questions/32996385/attaching-specific-files-to-corresponding-recipients/32997350#32997350", "title": "Attaching Specific files to corresponding recipients", "body": "<p>I assume you have headers in the first row. <strong>Untested.</strong></p>\n\n<pre><code>Sub AntMan()\n\nDim OutLookApp As Object\nDim OutLookMailItem As Object\nDim lastRow As Long\nDim MailDest As String\nDim subj As String\n\nlastRow = ThisWorkbook.WorkSheets(\"Sheet6\").Cells(Rows.Count, \"A\").End(xlUp).Row 'change worksheet\n\nFor i = 2 To lastRow\n\n    Set OutLookApp = CreateObject(\"Outlook.application\")\n    Set OutLookMailItem = OutLookApp.CreateItem(0)\n    Set Attach = OutLookMailItem.Attachments\n\n    With OutLookMailItem\n        .To = Cells(i, 1).Value\n        .SUBJECT = \"Put your subject here\"\n        .Body = \"Put your body here\"\n        Attach.Add \"C:\\your\\file\\path\\here\\\" &amp; Cells(i, 2).Value &amp; \".xlsx\"\n        .Display 'for debugging\n        .Send\n    End With\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5419103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1d381a5fea2c3812a3b74d430043d56?s=128&d=identicon&r=PG&f=1", "display_name": "AntMan", "link": "https://stackoverflow.com/users/5419103/antman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4285, "favorite_count": 2, "accepted_answer_id": 32997350, "answer_count": 1, "score": 0, "last_activity_date": 1593415650, "creation_date": 1444231791, "last_edit_date": 1593415650, "question_id": 32996385, "link": "https://stackoverflow.com/questions/32996385/attaching-specific-files-to-corresponding-recipients", "title": "Attaching Specific files to corresponding recipients", "body": "<p>I have a long list of cost reports to be sent to different recipients. </p>\n\n<p>I was thinking I could have one Excel file with addresses and corresponding Location i.e \nA1 John.smith@com.com A2 0001 \nB1 Jeff.smith@com.com B1 0002</p>\n\n<p>Then using VBA cycle through each row (1) and search a folder for the corresponding (A2) named file and attach it to mail out to cell (A1).</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444240086, "post_id": 32996106, "comment_id": 53822781, "body": "Do you really need to do it character by character?"}, {"owner": {"reputation": 941, "user_id": 438044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/20963d01d23235fbdc16cb705e170f96?s=128&d=identicon&r=PG", "display_name": "pelican_george", "link": "https://stackoverflow.com/users/438044/pelican-george"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444242088, "post_id": 32996106, "comment_id": 53823943, "body": "The goal is to detect portions of text which are highlighted or not,  and perform changes.  The whole cell range can have multiple formating,  and I need to inspect them individually"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444245678, "post_id": 32996106, "comment_id": 53826161, "body": "portions than can be single characters, or whole words for example?"}, {"owner": {"reputation": 941, "user_id": 438044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/20963d01d23235fbdc16cb705e170f96?s=128&d=identicon&r=PG", "display_name": "pelican_george", "link": "https://stackoverflow.com/users/438044/pelican-george"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444247409, "post_id": 32996106, "comment_id": 53827199, "body": "they can be both, since a question mark or a exclamation would count as a single character and have a specific formating that I need to control"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1444579006, "post_id": 32996106, "comment_id": 53952525, "body": "Most efficient might be to work directly with the WordOpenXML rather than going through the object model. Read a Range&#39;s Word.OpenXML, edit it, then write in back using Range.InsertXML. The discussion about working with Office Open XML in-place in this article should help you get started... <a href=\"https://msdn.microsoft.com/en-us/library/office/dn423225.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/dn423225.aspx</a>"}, {"owner": {"reputation": 941, "user_id": 438044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/20963d01d23235fbdc16cb705e170f96?s=128&d=identicon&r=PG", "display_name": "pelican_george", "link": "https://stackoverflow.com/users/438044/pelican-george"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1444633725, "post_id": 32996106, "comment_id": 53967590, "body": "@CindyMeister thanks, I&#39;ll have a look at it."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1444286223, "creation_date": 1444286223, "answer_id": 33008296, "question_id": 32996106, "link": "https://stackoverflow.com/questions/32996106/word-vba-how-to-iterate-through-characters-in-a-table-cell/33008296#33008296", "title": "Word VBA - How to iterate through characters in a Table Cell", "body": "<p>This approach was a little bit faster in my testing (about 2-3x, depending on how many characters get highlighted):</p>\n\n<pre><code>Sub Tester()\n\n    Dim t As Table, oRow, oCell, tm, n, rng As Range\n    Dim sh, i As Long\n\n    Set t = ThisDocument.Tables(1)\n\n    tm = Timer\n    For Each oRow In t.Rows\n        For Each oCell In oRow.Cells\n\n             sh = oCell.Shading.BackgroundPatternColorIndex\n             If sh = wdAuto Or sh = wdWhite Then\n\n                Set rng = oCell.Range\n                n = Len(rng.Text)\n\n                rng.Collapse wdCollapseStart\n                For i = 1 To n\n                    rng.MoveEnd wdCharacter, 1\n                    If rng.HighlightColorIndex = wdAuto Then\n                        rng.HighlightColorIndex = wdPink\n                    End If\n                    rng.Move wdCharacter, 1\n                Next\n\n             End If\n\n        Next oCell\n    Next oRow\n    Debug.Print Timer - tm\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 941, "user_id": 438044, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/20963d01d23235fbdc16cb705e170f96?s=128&d=identicon&r=PG", "display_name": "pelican_george", "link": "https://stackoverflow.com/users/438044/pelican-george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 0, "accepted_answer_id": 33008296, "answer_count": 1, "score": 0, "last_activity_date": 1444286223, "creation_date": 1444231047, "question_id": 32996106, "link": "https://stackoverflow.com/questions/32996106/word-vba-how-to-iterate-through-characters-in-a-table-cell", "title": "Word VBA - How to iterate through characters in a Table Cell", "body": "<p>I'm trying to iterate all characters in a table cell but the performance is incredibly slow. Maybe because using Characters is expensive.</p>\n\n<pre><code>   For Each oRow In t.Rows\n\n      ' Loop through each cell in the current row.\n      For Each oCell In oRow.Cells\n\n         ' If there is no background color in the cell, not worth to check\n         If oCell.Shading.BackgroundPatternColorIndex = wdAuto Or oCell.Shading.BackgroundPatternColorIndex = wdWhite Then\n\n\n            For i = 1 To oCell.Range.Characters.Count\n                If oCell.Range.Characters(i).HighlightColorIndex = wdAuto Then\n                    oCell.Range.Characters(i).HighlightColorIndex = wdPink\n                End If\n            Next\n\n         End If\n\n      Next oCell\n\n   Next oRow\n</code></pre>\n\n<p>Is there a more effective way to iterate the Cell Range ?</p>\n"}, {"tags": ["excel", "vba", "variables"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5393937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cd8fc3a8732fd09b4310d00cc55e3bc?s=128&d=identicon&r=PG&f=1", "display_name": "justinua", "link": "https://stackoverflow.com/users/5393937/justinua"}, "edited": false, "score": 0, "creation_date": 1444235200, "post_id": 32996580, "comment_id": 53819885, "body": "Thanks. This looks like it will work better than what I had. The only issue I&#39;m having is that it is recognizing the file name as &quot;&quot;. In most cases, the referenced folder will only have one file in it; however there might be some instances where there is two files. The differentiation between them is that the file I&#39;m looking to get the data from has &quot;AD&quot; in the middle of the file name, while the other one would not. I would think that have the asterisk before and after AD would allow this to work, but it did not in this case."}, {"owner": {"reputation": 246, "user_id": 5414663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/214907de112aa1bae3ed337a8216c520?s=128&d=identicon&r=PG&f=1", "display_name": "alfromFR29", "link": "https://stackoverflow.com/users/5414663/alfromfr29"}, "reply_to_user": {"reputation": 53, "user_id": 5393937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cd8fc3a8732fd09b4310d00cc55e3bc?s=128&d=identicon&r=PG&f=1", "display_name": "justinua", "link": "https://stackoverflow.com/users/5393937/justinua"}, "edited": false, "score": 0, "creation_date": 1444310403, "post_id": 32996580, "comment_id": 53857024, "body": "I&#39;m surprised as the wildcard * works well on my side. If it doesn&#39;t work, you&#39;ll have to loop and test the output filenames with operator <code>Like</code>."}], "tags": [], "owner": {"reputation": 246, "user_id": 5414663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/214907de112aa1bae3ed337a8216c520?s=128&d=identicon&r=PG&f=1", "display_name": "alfromFR29", "link": "https://stackoverflow.com/users/5414663/alfromfr29"}, "is_accepted": true, "score": 1, "last_activity_date": 1444232313, "creation_date": 1444232313, "answer_id": 32996580, "question_id": 32995979, "link": "https://stackoverflow.com/questions/32995979/find-a-file-name-within-a-folder-and-make-it-a-variable/32996580#32996580", "title": "Find a file name within a folder and make it a variable", "body": "<p>Do you mean something like this ?</p>\n\n<pre><code>Public Function GetFileName() As String\n    Dim sFilePath As String\n    Dim sFileName As String\n    '----------------\n    sFilePath = \"____________________\"\n    sFileName = \"*AD*.xlsm*\"\n    GetFileName = Dir(sFilePath &amp; sFileName, vbNormal)\nEnd Function\n</code></pre>\n\n<p>If you put it a module, you can then call it in a cell using =GetFileName().</p>\n"}], "owner": {"reputation": 53, "user_id": 5393937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cd8fc3a8732fd09b4310d00cc55e3bc?s=128&d=identicon&r=PG&f=1", "display_name": "justinua", "link": "https://stackoverflow.com/users/5393937/justinua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 32996580, "answer_count": 1, "score": 0, "last_activity_date": 1444236247, "creation_date": 1444230696, "last_edit_date": 1444236247, "question_id": 32995979, "link": "https://stackoverflow.com/questions/32995979/find-a-file-name-within-a-folder-and-make-it-a-variable", "title": "Find a file name within a folder and make it a variable", "body": "<p>I'm trying to run a macro that will take a folder path I've provided and then take the file in that folder and make the file name the variable.  That file name variable will then be used as part of a VLookup to get data from a cell within that file. Below is the code I've found so far, but I haven't been able to make it work:</p>\n\n<pre><code>Dim FilePath As String\nFilePath = \"____________________\"\n\nSet wbCodeBook = ThisWorkbook\n    With Application.FileSearch\n    .NewSearch\n    'Change path to suit\n    .LookIn = FilePath\n    .FileType = msoFileTypeExcelWorkbooks\n    'Optional filter with wildcard\n    .filename = \"*AD*.xlsm*\"\n    End With\n</code></pre>\n\n<p>I get <em>Object doesn't support this action</em> at the <code>Application.FileSearch</code> part of the code. I also don't know how I can take that code above and make the output the variable.</p>\n\n<p>Is there any way to do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1444230441, "post_id": 32995252, "comment_id": 53816393, "body": "If you have working code, I&#39;d recommend you take the whole procedure (heck, even the whole module) over to <a href=\"https://codereview.stackexchange.com\">Code Review</a>, where &quot;is this the best/cleanest way of doing this?&quot; is precisely what the entire site addresses."}], "answers": [{"comments": [{"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444229655, "post_id": 32995555, "comment_id": 53815760, "body": "Ah that makes sense, how would I apply the strSQL appendix to my code, included the connect string in my original post in EDIT. I need to change to using htis appendix since my SQL query is super long and is nearly 300 lines long lol."}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444229808, "post_id": 32995555, "comment_id": 53815887, "body": "Never mind I see it as the last statement in your code. Perfect!"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1444230040, "post_id": 32995555, "comment_id": 53816075, "body": "Wouldn&#39;t want to be the person administering this! I would suggest looping through the range checking for null values and a reference next to it for the field name."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1444230555, "post_id": 32995555, "comment_id": 53816476, "body": "@Gareth: Yes, of course, you can make it more dynamic by storing on a sheet in (as an example) column A the SQL name and in column B the search criteria and then loop through this range. I just never did it because of bad experiences in the past. Users kept fiddling around with column A and got errors back. SQL injection comes to mind... So, I like to keep it in the VBA code and do the checking there. More work but slightly more hidden and less prone to user-hazards."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444230662, "post_id": 32995555, "comment_id": 53816547, "body": "@JeffBeagley: Don&#39;t worry. String variables can potentially store up to 2 billion characters according to this article from Microsoft: <a href=\"https://msdn.microsoft.com/en-us/library/aa263420%28v=vs.60%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa263420%28v=vs.60%29.aspx</a> I myself have even used string variables on occasion to move small files as a stream to an SQL server. So, you should be save to have 300+ lines in there."}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444230887, "post_id": 32995555, "comment_id": 53816737, "body": "Good to know! This is my first experience using VBA coming from PHP, so I write all my SQL out as to take up as many rows as possible, so when I copy/pasted that into VBA I had a moment of panic lol."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444293015, "post_id": 32995555, "comment_id": 53844738, "body": "@JeffBeagley: I just appended the requested list box to allow for selecting multiple items. Let me know if this is what you&#39;ve been looking for."}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444315121, "post_id": 32995555, "comment_id": 53860845, "body": "@Ralph Okay I believe it&#39;s nearly working - Currently it&#39;s selecting my first column which is just a description, where I want to use the actual ID.   Looking at my code that populates the form_mode listbox is <code>i = 0         With Main_Window.form_mode         .Clear         Do             .AddItem             .List(i, 0) = rst![Mode]             .List(i, 1) = rst![ID]             i = i + 1             rst.MoveNext         Loop Until rst.EOF</code>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444315849, "post_id": 32995555, "comment_id": 53861373, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/91759/discussion-between-ralph-and-jeff-beagley\">continue this discussion in chat</a>."}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444325503, "post_id": 32995555, "comment_id": 53867200, "body": "Got it to work using the following  <code>Dim strFilter As String         Dim i As Integer                  For i = 0 To Main_Window.form_mode.ListCount - 1             If Main_Window.form_mode.Selected(i) Then                 If strFilter &lt;&gt; vbNullString Then strFilter = strFilter &amp; &quot;, &quot;                 strFilter = strFilter &amp; &quot;&#39;&quot;                 strFilter = strFilter &amp; Main_Window.form_mode.List(i, 1)                 strFilter = strFilter &amp; &quot;&#39;&quot;             End If         Next i</code>"}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444420303, "post_id": 32995555, "comment_id": 53913088, "body": "So now I need to apply this logic to a Textbox.. I am copy/pasting multiple values into the text box then I need to split those values up, and place them inside an SQL IN statement as well."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1444315313, "last_edit_date": 1444315313, "creation_date": 1444229584, "answer_id": 32995555, "question_id": 32995252, "link": "https://stackoverflow.com/questions/32995252/vba-sql-with-optional-joins/32995555#32995555", "title": "VBA - SQL with optional joins", "body": "<p>This is how I normally do it:</p>\n\n<pre><code>Dim strSQL As String\n\nstrSQL = \"set nocount on; \"\nstrSQL = strSQL &amp; \"select * \"\nstrSQL = strSQL &amp; \"from [ModeCat_T] \"\nstrSQL = strSQL &amp; \"     where 1 = 1  \"\n'*******************************************************\n'*  Adding the other where restrictions as necessary\n'*******************************************************\nIf Trim(Sheet1.Range(\"B7\").Value2) &lt;&gt; vbNullString Then\n    strSQL = strSQL &amp; \"     and [ModeCat_ID] = '\" &amp; Sheet1.Range(\"B7\").Value2 &amp; \"' \"\nEnd If\nIf Trim(Sheet1.Range(\"B8\").Value2) &lt;&gt; vbNullString Then\n    strSQL = strSQL &amp; \"     and [ModeCat_Color] = '\" &amp; Sheet1.Range(\"B8\").Value2 &amp; \"' \"\nEnd If\nIf Trim(Sheet1.Range(\"B9\").Value2) &lt;&gt; vbNullString Then\n    strSQL = strSQL &amp; \"     and [ModeCat_Size] = '\" &amp; Sheet1.Range(\"B9\").Value2 &amp; \"' \"\nEnd If\n\nSet rs = conn.Execute(strSQL)\n</code></pre>\n\n<p>Following the continued discussion about \"Filters\" where you can select possibly many different items from a <code>ListBox</code> the following code might be able to help with that:</p>\n\n<pre><code>Dim strFilter As String\nDim lngItem As Long\n\nFor lngItem = 0 To UserForm1.ListBox1.ListCount - 1\n    If UserForm1.ListBox1.Selected(lngItem) = True Then\n        If strFilter &lt;&gt; vbNullString Then strFilter = strFilter &amp; \", \"\n        strFilter = strFilter &amp; \"'\"\n        strFilter = strFilter &amp; UserForm1.ListBox1.List(lngItem, 1)\n        strFilter = strFilter &amp; \"'\"\n    End If\nNext lngItem\n\nIf strFilter &lt;&gt; vbNullString Then\n    strSQL = strSQL &amp; \"and [ModeCat_Form] in (\" &amp; strFilter &amp; \") \"\nEnd If\n</code></pre>\n\n<p>Basically, it is checking which items from the list have been selected and puts them into a string (wrapped in ' and separated by a comma). Afterwards the code checks if anything made it into the \"Filter String\". If the filter is not empty then it should be used. BTW: it does not matter if the string contains one or many items. So, this is also permissible:</p>\n\n<pre><code>   AND [ModeCat_Shape] in ('Oval')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444231501, "post_id": 32996215, "comment_id": 53817239, "body": "Forgot to mention I did indeed change it to a listbox, but the options would need to be in an IN statement and not AND.  AND [s].[ModeCat_ID] IN (&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;)"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "reply_to_user": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444231571, "post_id": 32996215, "comment_id": 53817301, "body": "@JeffBeagley so the values would all be filtering against the same field?"}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444231613, "post_id": 32996215, "comment_id": 53817345, "body": "Correct. It&#39;d basically be an OR"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "reply_to_user": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444233026, "post_id": 32996215, "comment_id": 53818422, "body": "@JeffBeagley <code>OR</code> and <code>IN</code> are two different things"}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "edited": false, "score": 0, "creation_date": 1444234748, "post_id": 32996215, "comment_id": 53819599, "body": "So how would I make a clause that is if null, then exclude that in the WHERE statement, but if it were 1, have it equal that value, but if more than 1, do an in statement and loop the results"}], "tags": [], "owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "is_accepted": false, "score": 0, "last_activity_date": 1444231322, "creation_date": 1444231322, "answer_id": 32996215, "question_id": 32995252, "link": "https://stackoverflow.com/questions/32995252/vba-sql-with-optional-joins/32996215#32996215", "title": "VBA - SQL with optional joins", "body": "<p>I felt I should expand my comment the @Ralphs answer with a more maintainable solution.</p>\n\n<p>As you're using a <code>ComboBox</code> and by the sound of it your wanting the user to be able to select multiple columns, use a <code>ListBox</code> instead. I would hide the reference to the field name in the first column of the <code>ListBox</code> by setting it's column width to 0. Then in the next column, you could add the actual filter in there.</p>\n\n<p>Once this is done, you can iterate through the selected items to apply the filters like so:</p>\n\n<pre><code>For i = 0 To ListBox1.ListCount - 1\n    If ListBox1.Selected(i) Then\n        strSQL = \" AND \" &amp; ListBox1.Column(0, i) &amp; \" = '\" &amp; ListBox1.Column(1, i) &amp; \"'\"\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 32995555, "answer_count": 2, "score": 1, "last_activity_date": 1444315313, "creation_date": 1444228871, "last_edit_date": 1531164843, "question_id": 32995252, "link": "https://stackoverflow.com/questions/32995252/vba-sql-with-optional-joins", "title": "VBA - SQL with optional joins", "body": "<p>I have a combolist where I can select multiple values, but if I leave them all blank then I want to exclude that portion from the query. Here is the current logic I'm using</p>\n\n<pre><code>        If ModeCat_ID = \"\" Then\n            Set rs = conn.Execute(\"SELECT * FROM [ModeCat_T]\")\n        Else\n             Set rs = conn.Execute(\"SELECT * FROM [ModeCat_T] WHERE [ModeCat_ID] = '\" &amp; ModeCat_ID &amp; \"'\")\n        End If\n</code></pre>\n\n<p>My question is, is this the best way to go about this? I'm building a form that has a few more options so I'd rather not have a bunch of tested Ifs to check these form controls. </p>\n\n<p>Second question is, if it's a combo box that can select multiples.. how would I set that up for an SQL IN statement? ie</p>\n\n<pre><code>IN ('1','2','3')\n</code></pre>\n\n<p>Thanks!</p>\n\n<p>EDIT</p>\n\n<pre><code> Set rs = conn.Execute(\"SELECT * FROM [ModeCat_T]\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1444229678, "post_id": 32995189, "comment_id": 53815788, "body": "Learning VBA is a great step - this is a relatively easy thing as well.  I recommend using the Macro Recorder to record a find/replace.  Start the macro recorder, select your range, then do Find/Replace.  You&#39;ll leave the find field blank, and in the &quot;Replace&quot; field, put &quot;UNREPORTED&quot; and hit ENTER or Replace All. That will create a macro that you can look at and see if you understand what it&#39;s doing.  If you still don&#39;t, post what you&#39;ve tried (and any code) in your post. SO isn&#39;t a code writing service, but we&#39;re happy to help guide you if you let us know what you&#39;ve tried, and post any code."}, {"owner": {"reputation": 3, "user_id": 5418929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff1f7bf45fbd475d9cbd31fc6081b44?s=128&d=identicon&r=PG&f=1", "display_name": "churcham32", "link": "https://stackoverflow.com/users/5418929/churcham32"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444394945, "post_id": 32995189, "comment_id": 53898090, "body": "Thanks, @BruceWayne.  I tried recording a Find/Replace, but I couldn&#39;t figure out how to change the code to extend to the last active cell, instead of the specific last cell I selected.  I will run this macro on a weekly report, which has a varying number of rows, so that flexibility is crucial."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444398962, "post_id": 32995189, "comment_id": 53900982, "body": "If you post what the macro recorder did (thus showing us what you&#39;ve tried), we could probably take a look and tweak to do what you are looking for."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 5419100, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GrQIi.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/5419100/drew"}, "is_accepted": true, "score": 0, "last_activity_date": 1444233867, "creation_date": 1444233867, "answer_id": 32997149, "question_id": 32995189, "link": "https://stackoverflow.com/questions/32995189/replacing-blank-cells-with-text-in-a-specific-range/32997149#32997149", "title": "Replacing blank cells with text in a specific range", "body": "<p>I think this could help, remember to change the name of the sheet. And preferably save the macro in a Module</p>\n\n<pre><code>Sub macro()\nDim i As Double\nDim j As Integer\nDim ActiveRows As Double\n\nFor i = 1 To 1000000\n    If Sheets(\"Sheet1\").Cells(i + 1, 3).Value &lt;&gt; \"\" Then\n        ActiveRows = ActiveRows + 1\n    Else\n        Exit For\n    End If\nNext i\n\nFor i = 1 To 10\n    For j = 1 To ActiveRows\n        If Sheets(\"Sheet1\").Cells(j + 1, i + 2) = \"\" Then\n            Sheets(\"Sheet1\").Cells(j + 1, i + 2) = \"UNREPORTED\"\n        End If\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5418929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff1f7bf45fbd475d9cbd31fc6081b44?s=128&d=identicon&r=PG&f=1", "display_name": "churcham32", "link": "https://stackoverflow.com/users/5418929/churcham32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1311, "favorite_count": 0, "accepted_answer_id": 32997149, "answer_count": 1, "score": -1, "last_activity_date": 1444236489, "creation_date": 1444228697, "last_edit_date": 1444236489, "question_id": 32995189, "link": "https://stackoverflow.com/questions/32995189/replacing-blank-cells-with-text-in-a-specific-range", "title": "Replacing blank cells with text in a specific range", "body": "<p>I have been attempting to patch together VBA fragments to create a macro to do the following:</p>\n\n<p>I must replace all blank cells within the active range with the word 'UNREPORTED'.  The range covers Columns C through L. Row 1 is the Column Headers, so it needs to effect Row 2 through the last active row.  The spreadsheet covers columns A to U, so I do not want to define all the way to the left or the right.  Column C will have no blank cells, so it may be useful for defining the active rows.  All other Columns could have a blank row at the bottom.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1444228853, "post_id": 32995144, "comment_id": 53815113, "body": "I don&#39;t know if <i>anyone</i> is going to read through all this code for you. It may help if you can isolate the problem and edit your post with less code for people to assist you with."}, {"owner": {"reputation": 9, "user_id": 5418893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79720d7271c96f62fb038d89c7ee973c?s=128&d=identicon&r=PG&f=1", "display_name": "R Brown", "link": "https://stackoverflow.com/users/5418893/r-brown"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444229961, "post_id": 32995144, "comment_id": 53816009, "body": "Amended as requested"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444233168, "post_id": 32995144, "comment_id": 53818515, "body": "did you test that the fields are indeed coming into the recordset? It&#39;s hard to know if the problem is that they aren&#39;t coming into the recordset or if they just are not being inputted into the Word cell."}, {"owner": {"reputation": 9, "user_id": 5418893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79720d7271c96f62fb038d89c7ee973c?s=128&d=identicon&r=PG&f=1", "display_name": "R Brown", "link": "https://stackoverflow.com/users/5418893/r-brown"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444236154, "post_id": 32995144, "comment_id": 53820474, "body": "I ran the query in SQL and this opened up the data exactly how i wanted it. Unfortunately im more of a fixer than a scripter and wouldnt know how i would visually check that the actual recordset is open and contains the data i want it to.  However i did amend the script to tell me if the number of callouts were greater than zero to play a message and it did so im assuming it has the figures.  if the If int_num_standbys = 0 Or int_num_callouts &gt;= 0 Then. Now the problem with the input into word sequence is that my standby script is configured exactly like the callouts and this inputs into word."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444236679, "post_id": 32995144, "comment_id": 53820794, "body": "You can loop through fields in your recordset via <code>Do Until rst_callouts.EOF debug.print rst_callouts.Fields(i).Name debug.print rst_callouts.Field(i).Value rst_callouts.MoveNext Loop</code> In this way you can see in the Immediate what fields and values are in the recordset. Keep in mind <code>i</code> represents the nth field in the recordset."}, {"owner": {"reputation": 9, "user_id": 5418893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79720d7271c96f62fb038d89c7ee973c?s=128&d=identicon&r=PG&f=1", "display_name": "R Brown", "link": "https://stackoverflow.com/users/5418893/r-brown"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444297748, "post_id": 32995144, "comment_id": 53847991, "body": "Hi Scott, Thank you for the response. We have scripted the debug to run as follows.  Dim i  i = 0 Do Until rst_callouts.EOF Debug.Print rst_callouts.Fields.Item(i).Name Debug.Print rst_callouts.Fields.Item(i).Value rst_callouts.MoveNext  i = i + 1 Loop"}, {"owner": {"reputation": 9, "user_id": 5418893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79720d7271c96f62fb038d89c7ee973c?s=128&d=identicon&r=PG&f=1", "display_name": "R Brown", "link": "https://stackoverflow.com/users/5418893/r-brown"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444297830, "post_id": 32995144, "comment_id": 53848053, "body": "The debug came back with 10 records with field names but the records are blank. This is now even more baffling as before if we run the SELECT query in SQL it runs and shows the records."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444317554, "post_id": 33013593, "comment_id": 53862591, "body": "Great that you got it solved :) Everything is an opportunity to learn in more and more detail ...  Happy coding to you :)"}], "tags": [], "owner": {"reputation": 9, "user_id": 5418893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79720d7271c96f62fb038d89c7ee973c?s=128&d=identicon&r=PG&f=1", "display_name": "R Brown", "link": "https://stackoverflow.com/users/5418893/r-brown"}, "is_accepted": false, "score": 0, "last_activity_date": 1444301169, "creation_date": 1444301169, "answer_id": 33013593, "question_id": 32995144, "link": "https://stackoverflow.com/questions/32995144/vb-in-access-2013-not-returning-the-desired-result/33013593#33013593", "title": "VB in Access 2013 not returning the desired result", "body": "<p>Thanks Scott for you help it was much appreciated and got me on the right track. I resolved this by removing DAO references and making the ADO a priority. I then had to remove my ODBC and drop all SQL tables. I than recreated the ODBC and reimported all my linked tables and its now working. Damn that was one issue that had me on the ropes, again many thanks for helping resolve this.</p>\n"}], "owner": {"reputation": 9, "user_id": 5418893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79720d7271c96f62fb038d89c7ee973c?s=128&d=identicon&r=PG&f=1", "display_name": "R Brown", "link": "https://stackoverflow.com/users/5418893/r-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538945079, "creation_date": 1444228599, "last_edit_date": 1538945079, "question_id": 32995144, "link": "https://stackoverflow.com/questions/32995144/vb-in-access-2013-not-returning-the-desired-result", "title": "VB in Access 2013 not returning the desired result", "body": "<p>I am currently in the process of migrating an ADP 2010 access database to an accdb 2013 and have run into an issue. </p>\n\n<p>One of the functions of the database is that a user can query callouts based on a date period and employee name. This would then export to a word document claim form. </p>\n\n<p>We use two recordsets to obtain this info, one rst_callouts (individual callouts) and the other rst_standby (stand by dates i.e. Monday-Friday). </p>\n\n<p>The word template contains a table which details the following information: Date From and To, Description of call out, Daily Rate, No of Days claimed and the total. </p>\n\n<p>rst_standy inputs the information without issue, however, the rst_callouts only exports the rate, days claims and the total. It misses the dates from and to and the description. </p>\n\n<p>I have reworked the script and it\u2019s identical to the rst_standy yet it\u2019s still not playing ball. I have even run the query in SQL and it returns the results so I know the ADOB.recordset is also working. Any help with this would be appreciated as its driving me around the bend. </p>\n\n<pre><code>    ' Get all newly raised Changes using 'rst_callouts'\n    ' -------------------------------------------------------------\n    rst_callouts.Open \"SELECT * FROM [dbo_qry_callout] \" &amp; _\n                        \"WHERE DateOfCallout &gt;= #\" &amp; Format(StartDate, \"mm/dd/yy#\") &amp; _\n                             \" AND DateOfCallout &lt;= #\" &amp; Format(EndDate, \"mm/dd/yy#\") &amp; _\n                             \" AND fk_StaffID = \" &amp; StaffID &amp; _\n                             \" ORDER BY DateOfCallout;\", con, adOpenKeyset, adLockOptimistic\n    If rst_callouts.RecordCount &gt; 0 Then\n        rst_callouts.MoveFirst\n        rst_callouts.MoveLast\n        int_num_callouts = rst_callouts.RecordCount\n        rst_callouts.MoveFirst\n    End If\n\n\n    ' This loop calculates all of the callouts to be used in the claim form\n    ' ---------------------------------------------------------------------\n    For callout_looper = 1 To int_num_callouts\n        dummy_value = acbUpdateMeter(((int_num_standbys + callout_looper) / (int_num_standbys + int_num_callouts)) * 100)\n\n        With appWord\n            **.Selection.TypeText Text:=Format(rst_callouts!DateOfCallout, \"dd/mm/yy\")\n            .Selection.MoveRight Unit:=wdCell\n            .Selection.TypeText Text:=Format(rst_callouts!DateOfCallout, \"dd/mm/yy\")\n            .Selection.MoveRight Unit:=wdCell\n            .Selection.TypeText Text:=Format(rst_PriceList![PriceListDescription]) &amp; \" - #\" &amp; (rst_callouts!pk_CalloutID)**\n            .Selection.MoveRight Unit:=wdCell\n            .Selection.TypeText Text:=Format(rst_PriceList![DailyRate], \"0.00\")\n            .Selection.MoveRight Unit:=wdCell\n            .Selection.TypeText Text:=\"1\"\n            .Selection.MoveRight Unit:=wdCell\n            .Selection.TypeText Text:=Format(rst_PriceList![TotalRate], \"0.00\")\n            .Selection.InsertRowsBelow 1\n            .Selection.MoveLeft Unit:=wdCell\n        End With\n\n        ClaimTotal = ClaimTotal + rst_PriceList![TotalRate]\n        rst_callouts.MoveNext\n    Next callout_looper\n\n    With appWord\n        .Selection.MoveRight Unit:=wdCell, Count:=5\n        .Selection.MoveDown\n        .Selection.TypeText Text:=Format(ClaimTotal, \"0.00\")\n        .Selection.MoveUp Unit:=wdLine, Count:=1\n        .Selection.Cells.Delete ShiftCells:=wdDeleteCellsEntireRow\n    End With\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2007", "ms-access-2010", "ms-access-2013"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444227564, "post_id": 32994700, "comment_id": 53814119, "body": "What is the datatype of that <code>[ObjectID]</code> field?"}, {"owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444227682, "post_id": 32994700, "comment_id": 53814209, "body": "It&#39;s the name of the column from a table in MSAcces.It&#39;s also the column which gives me the Dropdown list based on which i would like to filter."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444228924, "post_id": 32994700, "comment_id": 53815175, "body": "When you open that table in Design View, what does Access show you in the &quot;Data Type&quot; column for your ObjectID field?"}, {"owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444229481, "post_id": 32994700, "comment_id": 53815642, "body": "Data Type: &quot;Number&quot;.."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1444229657, "post_id": 32994700, "comment_id": 53815762, "body": "Does your &quot;testQueryFilter&quot; query uses any parameters? also you don&#39;t need to requery after assigning a record-source."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444229795, "post_id": 32994700, "comment_id": 53815877, "body": "OK.  The parameter name is displayed in the input dialog just below the &quot;Enter Parameter Value&quot; heading.  What is that name?"}, {"owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "edited": false, "score": 0, "creation_date": 1444231073, "post_id": 32994700, "comment_id": 53816872, "body": "Ha! Thanks HansUp , this brought me on the right tracks , It seams that the problem was not the code but the drop down button (where I selected ID &amp; Key in the same Drop Down). I changed the button only to ID and it worked. However If I change the Drop Down only to Key (&quot;Short Text&quot; Type Field) and replace in my VBA Code <code>[ObjectID]</code> with <code>[Key]</code> it still does not prompt me .The Paramater Displayed in the &quot;Enter Paramater Value&quot; msg box is the same as the value I select from the drop down list."}], "answers": [{"comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 1, "creation_date": 1444229763, "post_id": 32995579, "comment_id": 53815851, "body": "if cboobjectKey combo-box changes its value a refresh is needed either via code or via navigation ^_^"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1444229649, "creation_date": 1444229649, "answer_id": 32995579, "question_id": 32994700, "link": "https://stackoverflow.com/questions/32994700/vba-code-filter-form-in-ms-access/32995579#32995579", "title": "VBA Code : Filter Form in MS Access", "body": "<p>It would be far easier to apply the Master- and ChildLinkFields of the subform control.</p>\n\n<p>The MasterLinkField would be [cboObjectKey]</p>\n\n<p>The ChildLinkField would be [ObjectID]</p>\n\n<p>Zero code is needed for this to work.</p>\n"}, {"comments": [{"owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "edited": false, "score": 0, "creation_date": 1444231745, "post_id": 32996234, "comment_id": 53817458, "body": "Yes! this was the problem.. I mean the problem with the text, Many Thanks."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 2, "last_activity_date": 1444231374, "creation_date": 1444231374, "answer_id": 32996234, "question_id": 32994700, "link": "https://stackoverflow.com/questions/32994700/vba-code-filter-form-in-ms-access/32996234#32996234", "title": "VBA Code : Filter Form in MS Access", "body": "<p>Change </p>\n\n<pre><code> myObjectKey = \"Select * from testQueryFilter where ([ObjectID] = \" &amp; Me.CboObjectKey &amp; \")\"\n</code></pre>\n\n<p>to be </p>\n\n<pre><code>myObjectKey = \"Select * from testQueryFilter \"\n</code></pre>\n\n<p>do you still get prompted?</p>\n\n<p>If so it is a problem with the table or query named testQueryFilter.</p>\n\n<p>If not it is a problem with the text </p>\n\n<pre><code>where ([ObjectID] = \" &amp; Me.CboObjectKey &amp; \")\"\n</code></pre>\n\n<p>change it to</p>\n\n<pre><code>where ([ObjectID] = '\" &amp; Me.CboObjectKey &amp; \"')\"\n</code></pre>\n\n<p>and add this line after the above </p>\n\n<pre><code>msgbox myObjectKey : debug.print myObjectKey \n</code></pre>\n\n<p>This will show you the SQL being generated.</p>\n\n<p>However, frankly you probably need to us the MasterLinkField  and ChildLinkField </p>\n\n<p><a href=\"https://www.youtube.com/watch?v=Yk-OtW4IHNA&amp;list=PLYMOUCVo86jEgD_6ZgePmPOwGixSPr5FZ&amp;index=15\" rel=\"nofollow\">see this video to help you </a></p>\n"}], "owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 32996234, "answer_count": 2, "score": 0, "last_activity_date": 1444231374, "creation_date": 1444227439, "last_edit_date": 1444228492, "question_id": 32994700, "link": "https://stackoverflow.com/questions/32994700/vba-code-filter-form-in-ms-access", "title": "VBA Code : Filter Form in MS Access", "body": "<p>I wrote the following VBA code to help me filter some data using Forms in MS Access but it doesn't work :(\nThis is what I wrote :   </p>\n\n<pre><code>Private Sub cboObjectKey_AfterUpdate() \n    Dim myObjectKey As String \n    myObjectKey = \"Select * from testQueryFilter where ([ObjectID] = \" &amp; Me.CboObjectKey &amp; \")\"\n    Me.subformquery1.Form.RecordSource = myObjectKey\n    Me.subformquery1.Form.Requery  \nEnd Sub\n</code></pre>\n\n<p>I receive no error message, but the problem is that it doesn't work...When I try to filter i get prompted with a msg box \"enter parameter Value\" this shouldn't happen. When I select something from the Drop Down List I would like to see the filter applied. Any Ideas on how I can fix this?</p>\n\n<p>Br,</p>\n"}, {"tags": ["vba", "excel", "nested-loops"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1444227498, "post_id": 32994330, "comment_id": 53814069, "body": "Could you show us an example of the input data, and the desired output for those?"}, {"owner": {"reputation": 13, "user_id": 5418716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kGhKr.jpg?s=128&g=1", "display_name": "HumanoidTyphoon", "link": "https://stackoverflow.com/users/5418716/humanoidtyphoon"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1444237610, "post_id": 32994330, "comment_id": 53821336, "body": "Not without exceeding comment char limit ;-)"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1444286933, "post_id": 32994330, "comment_id": 53841040, "body": "Well, you can always edit your question"}], "answers": [{"tags": [], "owner": {"reputation": 398, "user_id": 4585104, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b5f2850bf3a06b863e3415affa3bdb5d?s=128&d=identicon&r=PG", "display_name": "tbm0115", "link": "https://stackoverflow.com/users/4585104/tbm0115"}, "is_accepted": true, "score": 1, "last_activity_date": 1444226945, "creation_date": 1444226945, "answer_id": 32994517, "question_id": 32994330, "link": "https://stackoverflow.com/questions/32994330/relative-loop-iteration-counting/32994517#32994517", "title": "Relative loop iteration counting", "body": "<p>Check out <a href=\"https://msdn.microsoft.com/en-us/library/5ebk1751.aspx\" rel=\"nofollow\">this</a> page from MSDN's library about the <code>For</code> statement.</p>\n\n<p>You could do something like:</p>\n\n<pre><code>For loop_ctr = 1 To n\n   '' Do stuff here, like nest another For Loop\nNext\n</code></pre>\n\n<p>Let me know if this needs further explanation.</p>\n"}], "owner": {"reputation": 13, "user_id": 5418716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kGhKr.jpg?s=128&g=1", "display_name": "HumanoidTyphoon", "link": "https://stackoverflow.com/users/5418716/humanoidtyphoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 32994517, "answer_count": 1, "score": 1, "last_activity_date": 1444237131, "creation_date": 1444226511, "last_edit_date": 1444237131, "question_id": 32994330, "link": "https://stackoverflow.com/questions/32994330/relative-loop-iteration-counting", "title": "Relative loop iteration counting", "body": "<p>I am using Excel to format the output of a .csv file that creates several 'blocks' of data but all relative to the same timestamp.  In order to use this data, I have to format such that the timestamp is in column B and then data is relocated to the columns to the right of it.</p>\n\n<p>I need to loop the same lines of code a set number of times (n), but I need the nested loop(s) to loop (n+1) times for each loop iteration.</p>\n\n<pre><code>Sub Format Data ()\nDim n as Integer\n\nloop_ctr = 1\nDo\n' Create Header Data For Channel 1\n' Find CH# and use offset commands to select and copy pertinent channel label and data information\n'\n\n' Set cursor to Cell A1\n    Sheets(\"Raw Data Input\").Select\n    Range(\"A1:A1\").Select\n\n'Finds first instance of CH#, which will be used as an anchor cell for      copying and pasting relevant channel information into the formatted data spreadsheet.\n    loop_ctr = 1\n    Do\n        Cells.Find(What:=\"CH#\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n            xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False _\n            , SearchFormat:=False).Activate\n\n            loop_ctr = loop_ctr + 1\n    Loop While loop_ctr &lt; n\n\n'Offset command to select cell containing Channel Name,set the variable type to string (to allow units\n'and measurement type to be appended to the channel name for data table header.\n\n    'Get Channel Name\n    ActiveCell.Offset(1, 1).Select\n    Selection.Copy\n\n    Sheets(\"Formatted Data Output\").Select\n    Sheets(\"Formatted Data Output\").Range(\"1:1\").End(xlToRight).Offset(0, 1).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nLoop_ctr = loop_ctr + 1 = n\nLoop While n &lt;13\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "wildcard"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444227954, "post_id": 32994216, "comment_id": 53814428, "body": "The only wildcards are <code>*</code> and <code>?</code>. You can use Regular Expressions but you&#39;ll need to loop."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5418693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e67c59ca08b5c027dd223ed675514e?s=128&d=identicon&r=PG&f=1", "display_name": "stuffen17", "link": "https://stackoverflow.com/users/5418693/stuffen17"}, "edited": false, "score": 0, "creation_date": 1444234185, "post_id": 32995071, "comment_id": 53819246, "body": "This is not really helping at all. I want to replace the whole string?!"}], "tags": [], "owner": {"reputation": 51, "user_id": 4543830, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb341b906a4e036583bff1b82585bf14?s=128&d=identicon&r=PG&f=1", "display_name": "Dinesh", "link": "https://stackoverflow.com/users/4543830/dinesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1444228390, "creation_date": 1444228390, "answer_id": 32995071, "question_id": 32994216, "link": "https://stackoverflow.com/questions/32994216/wildcard-use-within-replace-specific-number-of-characters/32995071#32995071", "title": "Wildcard use within Replace - Specific number of characters", "body": "<p>If you know the cell numbers you can use the below</p>\n\n<p>Dynamically pass values for the variables Cells1,cells2 and cells3</p>\n\n<p>cells1 = \"110!E10\"</p>\n\n<p>cells2 = \"110!E15\"</p>\n\n<p>Cells3 = \"110!E20\"</p>\n\n<p>str1 = \"=MeasData_\" &amp; cells1 &amp; \"*Measdata_\" &amp; cells2 &amp; \"*MeasData_\" &amp; Cells3</p>\n\n<p>'Debug.Print str1 'Print and verify if you need</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5418693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e67c59ca08b5c027dd223ed675514e?s=128&d=identicon&r=PG&f=1", "display_name": "stuffen17", "link": "https://stackoverflow.com/users/5418693/stuffen17"}, "edited": false, "score": 0, "creation_date": 1444234534, "post_id": 32995352, "comment_id": 53819469, "body": "Will try this tomorrow. Thanks!"}], "tags": [], "owner": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "is_accepted": false, "score": 0, "last_activity_date": 1444265343, "last_edit_date": 1444265343, "creation_date": 1444229074, "answer_id": 32995352, "question_id": 32994216, "link": "https://stackoverflow.com/questions/32994216/wildcard-use-within-replace-specific-number-of-characters/32995352#32995352", "title": "Wildcard use within Replace - Specific number of characters", "body": "<p>Have you tried regular expressions? you need to add reference to Microsoft VBScript regular expressions 5.5 for this</p>\n\n<pre><code>    Sub test()\n    Dim a As String\n    a = \"=MeasData_110!E20*Measdata_110!E10*MeasData_110!E15*Measdata_123!E10\"\n    a = ReplaceNumbers(a, \"MeasData_STRING!E10\")\n    MsgBox a\n    End Sub\n    Private Function ReplaceNumbers(inputString As String, replacement As String) As String\n        Pattern = \"Meas[dD]ata_([0-9]{1,})\\!E10\"\n        output = inputString\n         Dim re As New RegExp\n        re.Pattern = Pattern\n        re.Global = True: re.MultiLine = True\n        If re.test(inputString) Then\n            ReplaceNumbers = re.Replace(inputString, replacement)\n        Else\n            ReplaceNumbers = inputString\n        End If\n    End Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5418693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e67c59ca08b5c027dd223ed675514e?s=128&d=identicon&r=PG&f=1", "display_name": "stuffen17", "link": "https://stackoverflow.com/users/5418693/stuffen17"}, "edited": false, "score": 0, "creation_date": 1444234318, "post_id": 32996025, "comment_id": 53819329, "body": "The second one looks quite interesting. But I want to look for &quot;Measdata!E10&quot; and &quot;Measdata_123!E10&quot; and replace any of the two (if they are used) by cell &quot;AD48&quot;. What you just wrote replaces &quot;MeasData!E10&quot; with &quot;MeasData_123!E10&quot; ?!"}, {"owner": {"reputation": 13, "user_id": 5418693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e67c59ca08b5c027dd223ed675514e?s=128&d=identicon&r=PG&f=1", "display_name": "stuffen17", "link": "https://stackoverflow.com/users/5418693/stuffen17"}, "edited": false, "score": 0, "creation_date": 1444290516, "post_id": 32996025, "comment_id": 53843212, "body": "Works like a charm, RegEx expression for the search term has to be this:  <code>MeasData(_?[\\d]{0,3})!E10</code>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 13, "user_id": 5418693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e67c59ca08b5c027dd223ed675514e?s=128&d=identicon&r=PG&f=1", "display_name": "stuffen17", "link": "https://stackoverflow.com/users/5418693/stuffen17"}, "edited": false, "score": 0, "creation_date": 1444291517, "post_id": 32996025, "comment_id": 53843811, "body": "Shouldn&#39;t it be <code>MeasData(_[\\d]{1,3})?!E10</code> otherwise it would match the underscore without a number. <a href=\"https://regex101.com/r/iD6nX1/2\" rel=\"nofollow noreferrer\">See this example</a>"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1444239244, "last_edit_date": 1444239244, "creation_date": 1444230839, "answer_id": 32996025, "question_id": 32994216, "link": "https://stackoverflow.com/questions/32994216/wildcard-use-within-replace-specific-number-of-characters/32996025#32996025", "title": "Wildcard use within Replace - Specific number of characters", "body": "<p>I think the quickest way is to use <code>Replace()</code> in a loop:</p>\n\n<pre><code>Sub MM()\nDim foundCell       As Excel.Range\nDim foundAddress    As String\nDim findString      As String\nDim replaceString   As String\n\nfindString = \"MeasData!E10\"\nreplaceString = Range(\"AD48\").Value\n\nSet foundCell = Sheets(1).Cells.Find(What:=findString, LookIn:=xlFormulas, LookAt:=xlPart)\n\nIf Not foundCell Is Nothing Then\n\nfoundAddress = foundCell.Address\n    Do\n        With foundCell\n            .Formula = Replace(.Formula, findString, replaceString)\n        End With\n\n        Set foundCell = Sheets(1).Cells.FindNext(foundCell)\n\n    Loop While Not foundCell Is Nothing\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><em>Or</em></strong>  </p>\n\n<p>You can, if you wish, use the <code>VBScript.RexExp</code> object via late binding like so:</p>\n\n<pre><code>Function ReplaceAllWith(old_string As String, pattern As String, new_string As String) As String\n    With CreateObject(\"VBScript.RegExp\")\n        .pattern = pattern\n        .Global = True\n        If .Test(old_string) Then\n            ReplaceAllWith = .Replace(old_string, new_string)\n        Else\n            ReplaceAllWith = old_string\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<p>Insert the above into your module, and use like so:</p>\n\n<pre><code>For Each cell In Sheets(1).UsedRange.Cells\n    If cell.HasFormula Then\n        cell.Formula = ReplaceAllWith(cell.Formula, \"MeasData(_[\\d]{3})?!E10\", Range(\"AD48\").Value)\n    End If\nNext\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 13, "user_id": 5418693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e67c59ca08b5c027dd223ed675514e?s=128&d=identicon&r=PG&f=1", "display_name": "stuffen17", "link": "https://stackoverflow.com/users/5418693/stuffen17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 0, "accepted_answer_id": 32996025, "answer_count": 3, "score": 1, "last_activity_date": 1444265343, "creation_date": 1444226275, "last_edit_date": 1444237150, "question_id": 32994216, "link": "https://stackoverflow.com/questions/32994216/wildcard-use-within-replace-specific-number-of-characters", "title": "Wildcard use within Replace - Specific number of characters", "body": "<p>I have the following problem:</p>\n\n<p>I want to replace a link to another sheet. This link changes during the Macro from \"MeasData!E10\" to \"MeasData_XXX!E10\" (XXX any number) and can be any of these during the Macro. Now I want to replace one of these with a Cell of the current sheet.</p>\n\n<p>The problem is, that my cells contain more than one of the strings like above, e.g.:</p>\n\n<pre><code>=MeasData_110!E10*MeasData_110!E15*MeasData_110!E20\n</code></pre>\n\n<p>When using the Cells.Replace method this will correctly replace MeasData_110!E10 with the set string. However, if the link I am looking for is not in the first position, e.g.:</p>\n\n<pre><code>=MeasData_110!E20*MeasData_110!E10*MeasData_110!E15\n</code></pre>\n\n<p>It will be replaced to:</p>\n\n<pre><code>=STRING*MeasData_110!E15\n</code></pre>\n\n<p>because I am just using a wildcard: </p>\n\n<pre><code>Worksheets(1).Cells.Replace _\nWhat:=\"MeasData*!E10\", Replacement:=STRING\n</code></pre>\n\n<p>I have not yet found out if there is a wildcard for \na) specific letters\nAND\nb) specific/variable number of letters (0-4)</p>\n\n<p>Someone got a solution?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1444371955, "post_id": 32994071, "comment_id": 53884534, "body": "I have submitted an answer, it works in office 365. Please give it a try."}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1444231884, "creation_date": 1444231884, "answer_id": 32996416, "question_id": 32994071, "link": "https://stackoverflow.com/questions/32994071/copy-hyperlink-function-to-include-link-as-well-as-friendly-name/32996416#32996416", "title": "Copy HYPERLINK function to include link as well as friendly name", "body": "<p>Put the text \"<a href=\"http://www.stackoverflow.com\">http://www.stackoverflow.com</a>\" in cell E1</p>\n\n<p>Change A1 of your worksheet</p>\n\n<pre><code>=HYPERLINK(E1,\"Great website\")\n</code></pre>\n\n<p>and B1 to be the similar formula as A1.</p>\n\n<pre><code>=HYPERLINK(E1,A1)\n</code></pre>\n\n<p>I know this is cheat, but it will work!</p>\n\n<p>I think this is a good technique as it makes the maintenance of the URL: easier.</p>\n"}, {"comments": [{"owner": {"reputation": 1400, "user_id": 997907, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c3beef02dd9d90513d55c528c19368a?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/997907/andy"}, "edited": false, "score": 0, "creation_date": 1444245376, "post_id": 32999487, "comment_id": 53825972, "body": "The very latest. I use Office 365 so I&#39;m always up to date. Must be something I&#39;ve not enabled perhaps? It&#39;s a macro enabled worksheet."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1444241449, "creation_date": 1444241449, "answer_id": 32999487, "question_id": 32994071, "link": "https://stackoverflow.com/questions/32994071/copy-hyperlink-function-to-include-link-as-well-as-friendly-name/32999487#32999487", "title": "Copy HYPERLINK function to include link as well as friendly name", "body": "<p>Assuming for Sheet1, please try:  </p>\n\n<pre><code>Sub LinkCopy()\nWorksheets(\"Sheet1\").Range(\"A1\").Copy Destination:=Worksheets(\"Sheet1\").Range(\"B1\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1444372070, "creation_date": 1444372070, "answer_id": 33031335, "question_id": 32994071, "link": "https://stackoverflow.com/questions/32994071/copy-hyperlink-function-to-include-link-as-well-as-friendly-name/33031335#33031335", "title": "Copy HYPERLINK function to include link as well as friendly name", "body": "<p>Please Try This:</p>\n\n<pre><code>Sub CopyValuesAndNumberFormats()\n   Dim CopyRng As Range, PasteRng As Range\n   Set CopyRng = Application.Selection\n   Set CopyRng = Application.InputBox(\"Ranges to be copied :\", xTitleId, CopyRng.Address, Type:=8)\n   Set PasteRng = Application.InputBox(\"Paste to (single cell):\", xTitleId, Type:=8)\n   CopyRng.Copy\n   PasteRng.Parent.Activate\n   PasteRng.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n   Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1400, "user_id": 997907, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c3beef02dd9d90513d55c528c19368a?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/997907/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 519, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1444372070, "creation_date": 1444225926, "last_edit_date": 1531161705, "question_id": 32994071, "link": "https://stackoverflow.com/questions/32994071/copy-hyperlink-function-to-include-link-as-well-as-friendly-name", "title": "Copy HYPERLINK function to include link as well as friendly name", "body": "<p>I have the following in cell A1 of my worksheet:</p>\n\n<pre><code>=HYPERLINK(\"http://www.stackoverflow.com\",\"Great website\")\n</code></pre>\n\n<p>In cell B1, I have: </p>\n\n<pre><code>=A1\n</code></pre>\n\n<p>Unfortunately in B1 it displays just the <code>Great website</code> part of the function in A1 but it isn't hyperlinked.  </p>\n\n<p>How can I copy both the link and the cell contents so that the displayed contents in B1 are correctly linked?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1444231290, "post_id": 32993938, "comment_id": 53817054, "body": "Where is that folder located relative to the Inbox and or/the top folder?"}, {"owner": {"reputation": 75, "user_id": 5409511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de976cd41d20a606a17666333c374594?s=128&d=identicon&r=PG&f=1", "display_name": "IonicBlaze", "link": "https://stackoverflow.com/users/5409511/ionicblaze"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1444280907, "post_id": 32993938, "comment_id": 53838364, "body": "I think it&#39;s just on the same level. I just clicked on the mail account (e.g. me.lastname@de.example.com) on the left (where your default inbox,  outbox, deleted elements, junk mail etc are) and then clicked new folder."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5409511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de976cd41d20a606a17666333c374594?s=128&d=identicon&r=PG&f=1", "display_name": "IonicBlaze", "link": "https://stackoverflow.com/users/5409511/ionicblaze"}, "edited": false, "score": 0, "creation_date": 1444280799, "post_id": 32994048, "comment_id": 53838329, "body": "Thank you for that answer. That PickFolder was really useful but not exactly what I was looking for. I make it clearer: I wrote a script that will be run each time a new mail arrives in that specific folder. I want the script only to run for that folder so it would be okay if I specify the path to that folder right in the code."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1444225859, "creation_date": 1444225859, "answer_id": 32994048, "question_id": 32993938, "link": "https://stackoverflow.com/questions/32993938/how-do-i-loop-through-a-specific-folder-in-outlook/32994048#32994048", "title": "How do I loop through a specific folder in outlook", "body": "<p>Change</p>\n\n<pre><code>Set ns = Session.Application.GetNamespace(\"MAPI\")\n</code></pre>\n\n<p>To</p>\n\n<pre><code>Set ns = Session.Application.GetNamespace(\"MAPI\").PickFolder\n</code></pre>\n\n<p>This will prompt you to select the folder.</p>\n\n<hr>\n\n<p>Here's a full routine that I wrote some time ago that may be of assistance, bear in mind this was written so that it could be run from Excel but should provide you with the syntax that you need:</p>\n\n<pre><code>Sub GetMail()\n\n     '// This sub is designed to be used with a blank worksheet. It will create the header \n     '// fields as required, and continue to populate the email data below the relevant header. \n\n     '// Declare required variables \n     '------------------------------------------------------------- \n    Dim olApp As Object\n    Dim olFolder As Object\n    Dim olMailItem As Object\n\n    Dim strTo As String\n    Dim strFrom As String\n    Dim dateSent As Variant\n    Dim dateReceived As Variant\n    Dim strSubject As String\n    Dim strBody As String\n\n    Dim loopControl As Variant\n    Dim mailCount As Long\n    Dim totalItems As Long\n     '------------------------------------------------------------- \n\n     '//Turn off screen updating \n    Application.ScreenUpdating = False\n\n     '//Setup headers for information \n    Range(\"A1:F1\").Value = Array(\"To\", \"From\", \"Subject\", \"Body\", \"Sent (from Sender)\", \"Received (by Recipient)\")\n\n     '//Format columns E and F to \n    Columns(\"E:F\").EntireColumn.NumberFormat = \"DD/MM/YYYY HH:MM:SS\"\n\n     '//Create instance of Outlook \n    Set olApp = CreateObject(\"Outlook.Application\")\n\n     '//Select folder to extract mail from \n    Set olFolder = olApp.GetNamespace(\"MAPI\").PickFolder\n\n     '//Get count of mail items \n    totalItems = olFolder.items.Count\n    mailCount = 0\n\n     '//Loop through mail items in folder \n    For Each loopControl In olFolder.items\n\n         '//If loopControl is a mail item then continue \n        If TypeName(loopControl) = \"MailItem\" Then\n\n             '//Increase mailCount \n            mailCount = mailCount + 1\n\n             '//Inform user of item count in status bar \n            Application.StatusBar = \"Reading email no. \" &amp; mailCount &amp; \" of \" &amp; totalItems\n\n             '//Get mail item \n            Set olMailItem = loopControl\n\n             '//Get Details \n            With olMailItem\n                strTo = .To\n                 '//If strTo begins with \"=\" then place an apostrophe in front to denote text format \n                If Left(strTo, 1) = \"=\" Then strTo = \"'\" &amp; strTo \n                strFrom = .Sender\n                 '//If sender displays name only, show name followed by email address e.g.(Bloggs, Joe &lt; j.bloggs@mail.com &gt;) \n                If InStr(1, strFrom, \"@\") &lt; 1 Then strFrom = strFrom &amp; \" - &lt; \" &amp; .SenderEmailAddress &amp; \" &gt;\"\n                dateSent = .SentOn\n                dateReceived = .ReceivedTime\n                strSubject = .Subject\n                strBody = .Body\n            End With\n\n             '//Place information into spreadsheet \n             '//import information starting from last blank row in column A \n            With Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n                .Value = strTo\n                .Offset(0, 1).Value = strFrom\n                .Offset(0, 2).Value = strSubject\n\n                 '//Check for previous replies by looking for \"From:\" in the body text \n                 '//Check for the word \"From:\" \n                If InStr(0, strBody, \"From:\") &gt; 0 Then\n                     '//If exists, copy start of email body, up to the position of \"From:\" \n                    .Offset(0, 3).Value = Mid(strBody, 1, InStr(1, strBody, \"From:\") - 1)\n                Else\n                     '//If doesn't exist, copy entire mail body \n                    .Offset(0, 3).Value = strBody\n                End If\n\n                .Offset(0, 4).Value = dateSent\n                .Offset(0, 5).Value = dateReceived\n\n            End With\n\n             '//Release item from memory \n            Set olMailItem = Nothing\n\n        End If\n\n         '//Next Item \n    Next loopControl\n\n     '//Release items from memory \n    Set olFolder = Nothing\n    Set olApp = Nothing\n\n     '//Resume screen updating \n    Application.ScreenUpdating = True\n\n     '//reset status bar \n    Application.StatusBar = False\n\n     '//Inform user that code has finished \n    MsgBox mailCount &amp; \" messages copied successfully.\", vbInformation, \"Complete\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 5409511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de976cd41d20a606a17666333c374594?s=128&d=identicon&r=PG&f=1", "display_name": "IonicBlaze", "link": "https://stackoverflow.com/users/5409511/ionicblaze"}, "is_accepted": true, "score": 0, "last_activity_date": 1444282483, "creation_date": 1444282483, "answer_id": 33007379, "question_id": 32993938, "link": "https://stackoverflow.com/questions/32993938/how-do-i-loop-through-a-specific-folder-in-outlook/33007379#33007379", "title": "How do I loop through a specific folder in outlook", "body": "<p>Okay, I've found it myself.</p>\n\n<pre><code>    Set folder = ns.GetDefaultFolder(olFolderInbox).Parent.Folders(NAME OF THE FOLDER)\n</code></pre>\n\n<p>Than you for your help guys !</p>\n"}], "owner": {"reputation": 75, "user_id": 5409511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de976cd41d20a606a17666333c374594?s=128&d=identicon&r=PG&f=1", "display_name": "IonicBlaze", "link": "https://stackoverflow.com/users/5409511/ionicblaze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3812, "favorite_count": 0, "accepted_answer_id": 33007379, "answer_count": 2, "score": 0, "last_activity_date": 1593518027, "creation_date": 1444225589, "last_edit_date": 1593518027, "question_id": 32993938, "link": "https://stackoverflow.com/questions/32993938/how-do-i-loop-through-a-specific-folder-in-outlook", "title": "How do I loop through a specific folder in outlook", "body": "<p>What would be the VBA code for looping through a specific folder in outlook 2010 that is NOT the default inbox nor a subfolder of the inbox? </p>\n\n<pre><code>    Dim ns As Outlook.NameSpace\n    Dim folder As MAPIFolder\n\n    Set ns = Session.Application.GetNamespace(\"MAPI\")\n    Set folder = Please help me :-)\n</code></pre>\n\n<p>Thank you for any hint and help, greetings Ionic</p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1444225756, "post_id": 32993848, "comment_id": 53812707, "body": "-4142 is the value for xlColorIndexNone, one of the values of xlColorIndex enum."}, {"owner": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "edited": false, "score": 1, "creation_date": 1444229352, "post_id": 32993848, "comment_id": 53815536, "body": "If you are not sure of the number you can always Msgbox the range&#39;s interior.colorindex"}], "tags": [], "owner": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "is_accepted": true, "score": 3, "last_activity_date": 1444225375, "creation_date": 1444225375, "answer_id": 32993848, "question_id": 32993650, "link": "https://stackoverflow.com/questions/32993650/delete-all-no-fill-rows/32993848#32993848", "title": "Delete all &quot;No Fill&quot; rows", "body": "<p>How about trying</p>\n\n<pre><code>.Cells(i, j).Interior.ColorIndex = -4142\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 2122872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/defb5e70af940c37da7ee94f6739b604?s=128&d=identicon&r=PG", "display_name": "Herman", "link": "https://stackoverflow.com/users/2122872/herman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 32993848, "answer_count": 1, "score": 2, "last_activity_date": 1444241664, "creation_date": 1444224877, "last_edit_date": 1444241664, "question_id": 32993650, "link": "https://stackoverflow.com/questions/32993650/delete-all-no-fill-rows", "title": "Delete all &quot;No Fill&quot; rows", "body": "<p>This works to delete Yellow (index 6), but <code>0</code> does not clear the \"NO Fill\" rows, any ideas?</p>\n\n<pre><code>Sub deleterow()\nDim i As Long, j As Long\nDim delRange As Range\n\nWith ActiveSheet\n    For i = 7 To 1200 '&lt;~~ Row 7 to 1200\n        For j = 1 To 180 '&lt;~~ Col A to end of last dealer\n            If .Cells(i, j).Interior.ColorIndex = 0 Then '0=No Fill\n                If delRange Is Nothing Then\n                    Set delRange = .Cells(i, j)\n                Else\n                    Set delRange = Union(delRange, .Cells(i, j))\n                End If\n                Exit For\n            End If\n        Next j\n    Next i\nEnd With\n\nIf Not delRange Is Nothing Then delRange.EntireRow.Delete\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444225905, "post_id": 32993616, "comment_id": 53812809, "body": "Are you trying to only copy the populated cells, or the entire row (for those columns) if any of the cells is populated?"}, {"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444226092, "post_id": 32993616, "comment_id": 53812953, "body": "That&#39;s actually a good question. Initially, I&#39;d like to copy the given cells from the entire row. I guess I&#39;ll do the sorting later."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1444226256, "post_id": 32993616, "comment_id": 53813071, "body": "Your If statement seems wrong. There should not be a <code>.Value</code> inside?"}, {"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1444226682, "post_id": 32993616, "comment_id": 53813415, "body": "Good point. Though it doesn&#39;t solve the problem :p See edit"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1444226953, "post_id": 32993616, "comment_id": 53813639, "body": "yeah, because as i see, you wanted to check the entire row. Use <code>countA(Intersect(SearchCells, Rows(i)))</code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1444227334, "post_id": 32993616, "comment_id": 53813927, "body": "The compiler error is due to the wrong use of <code>.Value</code> mentionned above, I guess"}], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1444287181, "post_id": 32994430, "comment_id": 53841215, "body": "Thank you! <code>rRow</code> doesn&#39;t seem to get any values from the <code>Set</code> code, but the solution was to add <code>Worksheets(&quot;Sheet0&quot;).Range(...)</code> to the code. Works like a charm! :-D"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1444226741, "creation_date": 1444226741, "answer_id": 32994430, "question_id": 32993616, "link": "https://stackoverflow.com/questions/32993616/copy-values-from-multiple-columns-in-same-row-vba/32994430#32994430", "title": "Copy values from multiple columns in same row VBA", "body": "<p>To copy the relevant rows (for those columns only) where there is data in at least one cell, you could use:</p>\n\n<pre><code>Dim searchCells           As Range\nDim masterTable           As Range\nDim rRow                  As Range\n\nSet searchCells = Range(\"R:T,X:X,Z:Z,AF:Af,AQ:Aq,AT:AT,AV:AV,AY:AY,BB:BB,BD:BD,BG:BG\")\nSet masterTable = Worksheets(\"Sheet0\").Range(\"A3:BG2022\")\n\na = 1\nFor i = 1 To masterTable.Rows.Count\n    Set rRow = Intersect(searchCells, searchCells.Cells(i, 1).EntireRow)\n    If Application.WorksheetFunction.CountA(rRow) &lt;&gt; 0 Then    ' look for values among the relevant columns in row(i).\n        Debug.Print \"Found data at \"; i\n        rRow.Copy Worksheets(\"Results\").Range(\"C1\").offset(a, 0)    ' paste data to destination\n        a = a + 1    ' increment destination row offset\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2729, "favorite_count": 0, "accepted_answer_id": 32994430, "answer_count": 1, "score": 1, "last_activity_date": 1596109695, "creation_date": 1444224776, "last_edit_date": 1531164843, "question_id": 32993616, "link": "https://stackoverflow.com/questions/32993616/copy-values-from-multiple-columns-in-same-row-vba", "title": "Copy values from multiple columns in same row VBA", "body": "<p>I'm a VBA noob with a massive table of analysis results where each row is containing results from a different date. I'm looking for values in certain columns, and they are some times empty. When they are, I'm not interested in them. The values I want are supposed to be copied to a new sheet to be collected in a smaller table. </p>\n\n<p>I have written a script where I loop through the rows in the <code>masterTable</code>, and I am able to identify the rows with the values I'm interested in. However, I am not able to copy the value from the different cells in the identified row to a new sheet. </p>\n\n<p>I've tried using <code>Union</code> to make a <code>range</code> inlcuding the columns that are relevant for copying. </p>\n\n<pre><code>Dim searchCells As Range\nDim masterTable As Range\n\nSet searchCells = Union(Columns(\"R\"), Columns(\"S\"), Columns(\"T\"), Columns(\"X\"), Columns(\"Z\"), Columns(\"AF\"), Columns(\"AQ\"), Columns(\"AT\"), Columns(\"AY\"), Columns(\"AV\"), Columns(\"BB\"), Columns(\"BD\"), Columns(\"BG\"))\nSet masterTable = Worksheets(\"Sheet0\").Range(\"A3:BG2022\")\n\na = 1\nFor i = 1 To masterTable.Rows.Count\n  If Application.WorksheetFunction.CountA(searchCells(i).Value) &lt;&gt; 0 Then ' look for values among the relevant columns in row(i).\n    Debug.Print \"Found data at \"; i\n    Worksheets(\"Sheet0\").searchCells.Rows(i).Copy ' copy data from searchCells\n    Worksheets(\"Results\").Range(\"C1\").Offset(a, 0).paste ' paste data to destination\n    a = a + 1 ' increment destination row offset\n  End If\nNext\n</code></pre>\n\n<p>My idea of the <code>searchCells</code> are not working, as I \"find data\" in all rows, and I'm not able to run the <code>.Copy</code> and the <code>.Paste</code> methods. All help is appreaciated!</p>\n\n<p>EDIT: upon compilation VBA throws the following error on the copy-line:</p>\n\n<blockquote>\n  <p>Run-time error '438':</p>\n  \n  <p>Object doesn't support this property or method</p>\n</blockquote>\n"}, {"tags": ["vba", "email", "outlook", "outlook-2013"], "answers": [{"comments": [{"owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "edited": false, "score": 0, "creation_date": 1444637447, "post_id": 33028366, "comment_id": 53969505, "body": "thanks! I have changed some statements:  in <code>If TypeName(o) = &quot;MailItem&quot; Then MailRules o</code>  <code>MailRules</code> needs to be changed to <code>RulesForFolders</code>.  Moreover, in <code>If m.Subject Like &quot;*&quot; &amp; fldr.Name &amp; &quot;*&quot; Then</code> I have added <code>LCase</code> functions for more general template processing.  One thing that doesn&#39;t suit me is that I have subfolders (all needed project folders are subfolders), while the loop takes into accout parent folders. How can the loop be re-written to process subfolders? thanks How"}, {"owner": {"reputation": 71, "user_id": 4879840, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zd1__CsMTwc/AAAAAAAAAAI/AAAAAAAAE3I/XAHkzR-KAbs/photo.jpg?sz=128", "display_name": "Vladislav Andreev", "link": "https://stackoverflow.com/users/4879840/vladislav-andreev"}, "reply_to_user": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "edited": false, "score": 0, "creation_date": 1444668188, "post_id": 33028366, "comment_id": 53988600, "body": "@Shurov I see you figured this out. In case you need a more systematic approach (eg., you have many levels of subfolders), you can make this sub call itself. Let me know if you need a code."}], "tags": [], "owner": {"reputation": 71, "user_id": 4879840, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zd1__CsMTwc/AAAAAAAAAAI/AAAAAAAAE3I/XAHkzR-KAbs/photo.jpg?sz=128", "display_name": "Vladislav Andreev", "link": "https://stackoverflow.com/users/4879840/vladislav-andreev"}, "is_accepted": true, "score": 1, "last_activity_date": 1444667902, "last_edit_date": 1444667902, "creation_date": 1444352941, "answer_id": 33028366, "question_id": 32993611, "link": "https://stackoverflow.com/questions/32993611/outlook-template-rule-to-sort-mails-among-directories/33028366#33028366", "title": "Outlook template rule to sort mails among directories", "body": "<p>In order to achieve exactly what you want you can use this macro:</p>\n\n<pre><code>Sub RulesForFolders(m As MailItem)\nDim fldr As Outlook.Folder\nFor Each fldr In GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox).Folders\n    If m.Subject Like \"*\" &amp; fldr.Name &amp; \"*\" Then m.Move fldr\nNext\nSet fldr = Nothing\nEnd Sub\n</code></pre>\n\n<p>This macro can be triggered by arrival of a new email if you add to ThisOutlookSession module these lines:</p>\n\n<pre><code>Private Sub Application_NewMailEx(ByVal EntryIDCollection As String)\nDim o As Object\nSet o = Application.Session.GetItemFromID(EntryIDCollection)\nIf TypeName(o) = \"MailItem\" Then RulesForFolders o\nSet o = Nothing\nEnd Sub\n</code></pre>\n\n<p>Though, I would recommend you get rid of the folders where you move your messages to. Instead, you can use keep all you messages in Inbox and use Search folders to group them in whatever order you want. This way you can quickly search through all your inbox and sort it as well as separate search folders. You can also have the same message in different folders not duplicating it. If you decide to do so, your macro will need to assign categories instead of moving messages:</p>\n\n<pre><code>Sub RulesForFolders(m As MailItem)\nDim fldr As Outlook.Folder, str As Outlook.Store\nFor Each str In Application.Session.Stores\n    For Each fldr In str.GetSearchFolders\n        If m.Subject Like \"*\" &amp; fldr.Name &amp; \"*\" Then\n            m.Categories = m.Categories &amp; \",\" &amp; fldr.Name\n            m.Save\n        End If\n    Next\nNext\nSet fldr = Nothing\nSet str = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "is_accepted": false, "score": 0, "last_activity_date": 1444639623, "creation_date": 1444639623, "answer_id": 33076832, "question_id": 32993611, "link": "https://stackoverflow.com/questions/32993611/outlook-template-rule-to-sort-mails-among-directories/33076832#33076832", "title": "Outlook template rule to sort mails among directories", "body": "<p>I needed the rule to process subfolders, so I have slightly modified the previous answer of @Vladislav Andreev:</p>\n\n<pre><code>Sub RulesForFolders(m As MailItem)\n    Dim fldr As Outlook.Folder\n    For Each fldr In GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox).Folders\n        If LCase(m.Subject) Like \"*\" &amp; LCase(fldr.Name) &amp; \"*\" Then\n            m.Move fldr\n            Exit For\n        End If\n        For Each subFldr In fldr.Folders\n            If LCase(m.Subject) Like \"*\" &amp; LCase(subFldr.Name) &amp; \"*\" Then\n                m.Move subFldr\n                Exit For\n            End If\n        Next\n    Next\n    Set fldr = Nothing\n    Set subFldr = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 33028366, "answer_count": 2, "score": 0, "last_activity_date": 1593518334, "creation_date": 1444224768, "last_edit_date": 1593518334, "question_id": 32993611, "link": "https://stackoverflow.com/questions/32993611/outlook-template-rule-to-sort-mails-among-directories", "title": "Outlook template rule to sort mails among directories", "body": "<p>I have folders created for different projects (e.g. Proj1, Proj2, Proj3, ...).\nIt is general convention in the department to sent emails concerning specific project with its name in the subject (e.g. \"Proj1: project finished!\").</p>\n\n<p>I know that I can create rules for every project to move mails that contain its name to the project folder. However, I would need to create as many rules as the number of folders I have - so its not very convenient and optimal.</p>\n\n<p>Is there any way to create a rule (a single rule) (possibly, with VBA code) that will contain list of all folder names, search for any name from the list among mails' subjucts and automatically move mail to the corresponding folder?</p>\n"}, {"tags": ["excel", "for-loop", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1444229460, "post_id": 32993600, "comment_id": 53815629, "body": "This is a bit hard to follow. Can you include an example of the &quot;aesthetically pleasing format&quot; you wish to achieve?"}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1444231242, "post_id": 32993600, "comment_id": 53817007, "body": "Hi @MatthewD . Please see amended post."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "edited": false, "score": 0, "creation_date": 1444301764, "post_id": 32997725, "comment_id": 53850720, "body": "Perfect thanks. Exactly what i&#39;m looking for, with some minor tweaks I&#39;ve added. Thanks @MatthewD !"}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "edited": false, "score": 0, "creation_date": 1444303235, "post_id": 32997725, "comment_id": 53851616, "body": "Just to let you know I went with the second code because, although it may skew the data (not a problem), it actually keeps all the data being converted, unlike the hybrid of my own code (which I know wasn&#39;t very effective), which missed some parts out. Thanks again!!"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1444237755, "last_edit_date": 1444237755, "creation_date": 1444235637, "answer_id": 32997725, "question_id": 32993600, "link": "https://stackoverflow.com/questions/32993600/multi-loops-for-converting-data-layout/32997725#32997725", "title": "Multi-Loops for Converting Data Layout", "body": "<p>You should just be able to loop through the data and output it based on the value in columnA.</p>\n\n<p>Try something like this.</p>\n\n<pre><code>Private Sub Shift()\n\n    Dim wsSource As Excel.Worksheet\n    Dim wsTarget As Excel.Worksheet\n    Dim lastRow As Long\n    Dim lSourceRow As Long\n    Dim lTargetRow As Long\n    Dim lOffset As Long\n\n    'Define the source and target sheets\n    Set wsSource = ActiveWorkbook.Sheets(\"Sheet1\")\n    Set wsTarget = ActiveWorkbook.Sheets(\"Sheet2\")\n\n    lSourceRow = 1\n    lTargetRow = 0\n\n    lastRow = wsSource.Cells(wsSource.Rows.count, \"A\").End(xlUp).Row\n\n    wsSource.Activate\n    'Loop through the rows\n    Do While lSourceRow &lt;= lastRow\n\n        'Check if we have the beginning of a flow\n        If wsSource.Range(\"A\" &amp; lSourceRow).Value = \"ZHV\" Then\n\n            wsTarget.Range(\"A\" &amp; lTargetRow + 1).Value = wsSource.Range(\"A\" &amp; lSourceRow).Value\n            wsTarget.Range(\"B\" &amp; lTargetRow + 1).Value = wsSource.Range(\"B\" &amp; lSourceRow).Value\n\n        End If\n\n        If wsSource.Range(\"A\" &amp; lSourceRow).Value = \"58C\" Then\n\n            lTargetRow = lTargetRow + 1\n\n            wsTarget.Range(\"C\" &amp; lTargetRow).Value = wsSource.Range(\"A\" &amp; lSourceRow).Value\n            wsTarget.Range(\"D\" &amp; lTargetRow).Value = wsSource.Range(\"B\" &amp; lSourceRow).Value\n            wsTarget.Range(\"E\" &amp; lTargetRow).Value = wsSource.Range(\"C\" &amp; lSourceRow).Value\n            wsTarget.Range(\"F\" &amp; lTargetRow).Value = wsSource.Range(\"D\" &amp; lSourceRow).Value\n            wsTarget.Range(\"G\" &amp; lTargetRow).Value = wsSource.Range(\"E\" &amp; lSourceRow).Value\n\n        ElseIf wsSource.Range(\"A\" &amp; lSourceRow).Value = \"59C\" Then\n\n            lOffset = 0\n            Do While wsSource.Range(\"A\" &amp; lSourceRow).Value = \"59C\"\n                wsTarget.Cells(lTargetRow, 8 + lOffset).Value = wsSource.Range(\"A\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 9 + lOffset).Value = wsSource.Range(\"B\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 10 + lOffset).Value = wsSource.Range(\"C\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 11 + lOffset).Value = wsSource.Range(\"D\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 12 + lOffset).Value = wsSource.Range(\"E\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 13 + lOffset).Value = wsSource.Range(\"F\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 14 + lOffset).Value = wsSource.Range(\"G\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 15 + lOffset).Value = wsSource.Range(\"H\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 16 + lOffset).Value = wsSource.Range(\"I\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 17 + lOffset).Value = wsSource.Range(\"J\" &amp; lSourceRow).Value\n\n                lSourceRow = lSourceRow + 1\n                lOffset = lOffset + 10\n            Loop\n            lSourceRow = lSourceRow - 1\n\n        ElseIf wsSource.Range(\"A\" &amp; lSourceRow).Value = \"60C\" Then\n            lOffset = 0\n            Do While wsSource.Range(\"A\" &amp; lSourceRow).Value = \"60C\"\n                wsTarget.Cells(lTargetRow, 18 + lOffset).Value = wsSource.Range(\"A\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 19 + lOffset).Value = wsSource.Range(\"B\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 20 + lOffset).Value = wsSource.Range(\"C\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 21 + lOffset).Value = wsSource.Range(\"D\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 22 + lOffset).Value = wsSource.Range(\"E\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 23 + lOffset).Value = wsSource.Range(\"F\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, 24 + lOffset).Value = wsSource.Range(\"G\" &amp; lSourceRow).Value\n\n                lSourceRow = lSourceRow + 1\n                lOffset = lOffset + 7\n            Loop\n            lSourceRow = lSourceRow - 1\n\n        End If\n\n        lSourceRow = lSourceRow + 1\n        wsSource.Range(\"A\" &amp; lSourceRow).Activate\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>Here is another version that accounts for the fact that you say 59C and 60C may be repeating.  The only issue with this is that it will skew the output format a bit.</p>\n\n<p>e.g. if there are sometimes multiple 59s\n58 a 59 b<br>\n58 a 59 b 60 c<br>\n58 a 59 b <strong>59 b 60c</strong><br>\n58 a 59 b 60 c  </p>\n\n<p>The 60s don't line up.</p>\n\n<pre><code>Private Sub CommandButton33_Click()\n\n    Dim wsSource As Excel.Worksheet\n    Dim wsTarget As Excel.Worksheet\n    Dim lastRow As Long\n    Dim lSourceRow As Long\n    Dim lTargetRow As Long\n    Dim lOffset As Long\n\n    'Define the source and target sheets\n    Set wsSource = ActiveWorkbook.Sheets(\"Sheet1\")\n    Set wsTarget = ActiveWorkbook.Sheets(\"Sheet2\")\n\n    lSourceRow = 1\n    lTargetRow = 0\n\n    lastRow = wsSource.Cells(wsSource.Rows.count, \"A\").End(xlUp).Row\n\n    wsSource.Activate\n    'Loop through the rows\n    Do While lSourceRow &lt;= lastRow\n\n        'Check if we have the beginning of a flow\n        If wsSource.Range(\"A\" &amp; lSourceRow).Value = \"ZHV\" Then\n            wsTarget.Range(\"A\" &amp; lTargetRow + 1).Value = wsSource.Range(\"A\" &amp; lSourceRow).Value\n            wsTarget.Range(\"B\" &amp; lTargetRow + 1).Value = wsSource.Range(\"B\" &amp; lSourceRow).Value\n        End If\n\n        If wsSource.Range(\"A\" &amp; lSourceRow).Value = \"58C\" Then\n\n            lTargetRow = lTargetRow + 1\n            lOffset = 8\n            wsTarget.Range(\"C\" &amp; lTargetRow).Value = wsSource.Range(\"A\" &amp; lSourceRow).Value\n            wsTarget.Range(\"D\" &amp; lTargetRow).Value = wsSource.Range(\"B\" &amp; lSourceRow).Value\n            wsTarget.Range(\"E\" &amp; lTargetRow).Value = wsSource.Range(\"C\" &amp; lSourceRow).Value\n            wsTarget.Range(\"F\" &amp; lTargetRow).Value = wsSource.Range(\"D\" &amp; lSourceRow).Value\n            wsTarget.Range(\"G\" &amp; lTargetRow).Value = wsSource.Range(\"E\" &amp; lSourceRow).Value\n\n        ElseIf wsSource.Range(\"A\" &amp; lSourceRow).Value = \"59C\" Then\n\n            Do While wsSource.Range(\"A\" &amp; lSourceRow).Value = \"59C\"\n                wsTarget.Cells(lTargetRow, lOffset).Value = wsSource.Range(\"A\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 1).Value = wsSource.Range(\"B\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 2).Value = wsSource.Range(\"C\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 3).Value = wsSource.Range(\"D\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 4).Value = wsSource.Range(\"E\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 5).Value = wsSource.Range(\"F\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 6).Value = wsSource.Range(\"G\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 7).Value = wsSource.Range(\"H\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 8).Value = wsSource.Range(\"I\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 9).Value = wsSource.Range(\"J\" &amp; lSourceRow).Value\n\n                lSourceRow = lSourceRow + 1\n                lOffset = lOffset + 10\n            Loop\n            lSourceRow = lSourceRow - 1\n\n        ElseIf wsSource.Range(\"A\" &amp; lSourceRow).Value = \"60C\" Then\n            Do While wsSource.Range(\"A\" &amp; lSourceRow).Value = \"60C\"\n                wsTarget.Cells(lTargetRow, lOffset).Value = wsSource.Range(\"A\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 1).Value = wsSource.Range(\"B\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 2).Value = wsSource.Range(\"C\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 3).Value = wsSource.Range(\"D\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 4).Value = wsSource.Range(\"E\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 5).Value = wsSource.Range(\"F\" &amp; lSourceRow).Value\n                wsTarget.Cells(lTargetRow, lOffset + 6).Value = wsSource.Range(\"G\" &amp; lSourceRow).Value\n\n                lSourceRow = lSourceRow + 1\n                lOffset = lOffset + 7\n            Loop\n            lSourceRow = lSourceRow - 1\n\n        End If\n\n        lSourceRow = lSourceRow + 1\n        wsSource.Range(\"A\" &amp; lSourceRow).Activate\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 32997725, "answer_count": 1, "score": 1, "last_activity_date": 1444237755, "creation_date": 1444224747, "last_edit_date": 1531164843, "question_id": 32993600, "link": "https://stackoverflow.com/questions/32993600/multi-loops-for-converting-data-layout", "title": "Multi-Loops for Converting Data Layout", "body": "<p>I'm not very experienced with loops, but this is how far I got. I'm trying to convert data I get into an aesthetically pleasing format. I have the basic loop which can pull info into some form of structure, but it misses some of the data because I cannot write the loop properly. </p>\n\n<p>My data is imported as multiple flows which have a start (ZHV) and an end (ZPT) row, and contain multiple records, each records may contain multiple parts. Ideally I want each individual record, with it's constituent parts, on one row, and that's what I'm trying to convert to.</p>\n\n<p>Below is an example table of data:</p>\n\n<pre><code>ZHV 1001                                \n58C A   B   C   D                   \n59C E   F   G   H   I   J   K   L   M\n60C N   O   P   Q   R   S           \nZPT 20151002                                \nZHV 1002                                \n58C A   B   C   D                   \n59C E   F   G   H   I   J   K   L   M\n60C N   O   P   Q   R   S           \nZPT 20151003                                \nZHV 1003                                \n58C A   B   C   D                   \n59C E   F   G   H   I   J   K   L   M\n60C N   O   P   Q   R   S           \nZPT 20151004                                \nZHV 1004                                \n58C A   B   C   D                   \n59C E   F   G   H   I   J   K   L   M\n60C N   O   P   Q   R   S           \n60C N   O   P   Q   R   S           \n58C A   B   C   D                   \n59C E   F   G   H   I   J   K   L   M\n60C N   O   P   Q   R   S           \n60C N   O   P   Q   R   S           \n58C A   B   C   D                   \n59C E   F   G   H   I   J   K   L   M\n60C N   O   P   Q   R   S           \n60C N   O   P   Q   R   S           \nZPT 20151005        \n</code></pre>\n\n<p>Each flow can have multiple records ()58C and each record can have multiple parts (59C and 60C).</p>\n\n<p>Hopefully after conversion the data should look like this:</p>\n\n<pre><code>ZHV 1001    58C A   B   C   D   59C E   F   G   H   I   J   K   L   M   60C N   O   P   Q   R   S                           \nZHV 1002    58C A   B   C   D   59C E   F   G   H   I   J   K   L   M   60C N   O   P   Q   R   S                           \nZHV 1003    58C A   B   C   D   59C E   F   G   H   I   J   K   L   M   60C N   O   P   Q   R   S                           \nZHV 1004    58C A   B   C   D   59C E   F   G   H   I   J   K   L   M   60C N   O   P   Q   R   S   60C N   O   P   Q   R   S\n            58C A   B   C   D   59C E   F   G   H   I   J   K   L   M   60C N   O   P   Q   R   S   60C N   O   P   Q   R   S\n            58C A   B   C   D   59C E   F   G   H   I   J   K   L   M   60C N   O   P   Q   R   S   60C N   O   P   Q   R   S\nZHV 1004    58C A   B   C   D   59C E   F   G   H   I   J   K   L   M   60C N   O   P   Q   R   S       \n</code></pre>\n\n<p>Here is the code i'm currently using but it only pulls the first 58C, 59C and 60C it find for each Flow (ZHV).</p>\n\n<p>Can you anyone suggest how to modify it to add in the extra fields per record per flow?</p>\n\n<pre><code>Public Sub Shift()\n\nDim Master As Worksheet\nDim Slave As Worksheet\n\nSet Master = Worksheets(\"Sheet2\")\nSet Slave = Worksheets(\"Sheet1\")\n\n\nFor j = 2 To 2000 'Master\n\nFor i = 2 To 2000 'Slave\n\n    If Trim(Slave.Cells(j, 3).Value2) = vbNullString Then Exit For\n    If Slave.Cells(i, 1) = \"ZHV\" Then\n        k = i + 1\n        l = k + 1\n        m = l + 1\n            Master.Cells(j, 2).Value2 = Slave.Cells(i, \"B\").Value2\n            Master.Cells(j, 3).Value2 = Slave.Cells(i, \"C\").Value2\n            Master.Cells(j, 4).Value2 = Slave.Cells(i, \"D\").Value2\n            Master.Cells(j, 5).Value2 = Slave.Cells(i, \"E\").Value2\n            Master.Cells(j, 6).Value2 = Slave.Cells(i, \"F\").Value2\n            Master.Cells(j, 7).Value2 = Slave.Cells(i, \"G\").Value2\n            Master.Cells(j, 8).Value2 = Slave.Cells(i, \"H\").Value2\n            Master.Cells(j, 9).Value2 = Slave.Cells(i, \"L\").Value2\n\n            If Slave.Cells(k, 1) = \"58C\" Then\n                Master.Cells(j, 12).Value2 = Slave.Cells(k, 2).Value2\n                Master.Cells(j, 13).Value2 = Slave.Cells(k, 3).Value2\n                Master.Cells(j, 14).Value2 = Slave.Cells(k, 4).Value2\n                Master.Cells(j, 15).Value2 = Slave.Cells(k, 5).Value2\n                Master.Cells(j, 16).Value2 = Slave.Cells(k, 6).Value2\n                Master.Cells(j, 17).Value2 = Slave.Cells(k, 7).Value2\n                Master.Cells(j, 18).Value2 = Slave.Cells(k, 8).Value2\n                Master.Cells(j, 19).Value2 = Slave.Cells(k, 9).Value2\n                Master.Cells(j, 20).Value2 = Slave.Cells(k, 10).Value2\n                Master.Cells(j, 21).Value2 = Slave.Cells(k, 11).Value2\n                Master.Cells(j, 22).Value2 = Slave.Cells(k, 12).Value2\n                Master.Cells(j, 23).Value2 = Slave.Cells(k, 13).Value2\n                Master.Cells(j, 24).Value2 = Slave.Cells(k, 14).Value2\n                Master.Cells(j, 25).Value2 = Slave.Cells(k, 15).Value2\n                Master.Cells(j, 26).Value2 = Slave.Cells(k, 16).Value2\n            End If\n\n            If Slave.Cells(l, 1) = \"59C\" Then\n                Master.Cells(j, 27).Value2 = Slave.Cells(l, 2).Value2\n                Master.Cells(j, 28).Value2 = Slave.Cells(l, 3).Value2\n\n            End If\n\n            If Slave.Cells(m, 1) = \"60C\" Then\n                Master.Cells(j, 29).Value2 = Slave.Cells(m, 2).Value2\n                Master.Cells(j, 30).Value2 = Slave.Cells(m, 3).Value2\n                Master.Cells(j, 31).Value2 = Slave.Cells(m, 4).Value2\n                Master.Cells(j, 32).Value2 = Slave.Cells(m, 5).Value2\n                Master.Cells(j, 33).Value2 = Slave.Cells(m, 6).Value2\n                Master.Cells(j, 34).Value2 = Slave.Cells(m, 7).Value2\n\n            End If\n\n            i = i + 1\n            j = j + 1\n    End If\nNext\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "spreadsheet", "password-protection"], "comments": [{"owner": {"reputation": 13, "user_id": 5394766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hzJXa.jpg?s=128&g=1", "display_name": "SirKit", "link": "https://stackoverflow.com/users/5394766/sirkit"}, "edited": false, "score": 0, "creation_date": 1457075227, "post_id": 32992912, "comment_id": 59250259, "body": "Sorry for the late reply. Thanks to all of you skillful code examples!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5394766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hzJXa.jpg?s=128&g=1", "display_name": "SirKit", "link": "https://stackoverflow.com/users/5394766/sirkit"}, "edited": false, "score": 0, "creation_date": 1444238991, "post_id": 32993230, "comment_id": 53822149, "body": "Using more than one sheet name within the   <code>For Each sh In ActiveWorkbook.Sheets(&quot;CustomerList&quot;, &quot;SiteNames&quot;)</code> is causing a <b>MS VB - Compile Error: Wrong number of arguments or invalid property assignment.</b>  When I changed it to just one sheet for testing <code>For Each sh In ActiveWorkbook.Sheets(&quot;CustomerList&quot;)</code> I don&#39;t get any errors, but it also does not lock the cells and protect the sheet."}, {"owner": {"reputation": 13, "user_id": 5394766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hzJXa.jpg?s=128&g=1", "display_name": "SirKit", "link": "https://stackoverflow.com/users/5394766/sirkit"}, "edited": false, "score": 0, "creation_date": 1444240643, "post_id": 32993230, "comment_id": 53823082, "body": "+1 Thank you Macro Man!  Adding the Array resolved the error.  The script will now only be applied to the specified worksheet name, if one of the listed worksheets is active when saved.  This is an excellent solution!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 13, "user_id": 5394766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hzJXa.jpg?s=128&g=1", "display_name": "SirKit", "link": "https://stackoverflow.com/users/5394766/sirkit"}, "edited": false, "score": 0, "creation_date": 1444250485, "post_id": 32993230, "comment_id": 53828969, "body": "Not a problem, don&#39;t forget to mark as the answer if it solved your problem."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1444239088, "last_edit_date": 1444239088, "creation_date": 1444223718, "answer_id": 32993230, "question_id": 32992912, "link": "https://stackoverflow.com/questions/32992912/isolate-excel-vba-script-to-run-aginst-specific-worksheets/32993230#32993230", "title": "Isolate Excel VBA script to run aginst specific worksheets?", "body": "<p>Change the <code>ActiveSheet</code> and use a <code>For Each</code> loop like so:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    On Error Resume Next\n    Dim Cell As Range\n    For Each sh In Array(\"Sheet1\", \"AnotherSheet\", \"OtherSheet\")   \n        With Sheets(sh)\n            .Unprotect Password:=\"\"\n            .Cells.Locked = False\n                For Each Cell In Application.ActiveSheet.UsedRange\n                    If Cell.Value = \"\" Then\n                        Cell.Locked = False\n                    Else\n                        Cell.Locked = True\n                    End If\n                Next\n            .Protect Password:=\"\"\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1444224077, "creation_date": 1444224077, "answer_id": 32993354, "question_id": 32992912, "link": "https://stackoverflow.com/questions/32992912/isolate-excel-vba-script-to-run-aginst-specific-worksheets/32993354#32993354", "title": "Isolate Excel VBA script to run aginst specific worksheets?", "body": "<p>This should help you (you'll have messages to let you know when you are in the event and when it's started and over) :</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nDim Cell As Range\nMsgBox \"Event Workbook_BeforeSave Launched\", vbInformation + vbOKOnly, \"Started\"\n\nOn Error GoTo ErrHandler\n\nReTry:\n    With Sheet6\n        .Unprotect Password:=\"\"\n        .Cells.Locked = False\n        For Each Cell In .UsedRange\n            If Cell.Value = \"\" Then\n                Cell.Locked = False\n            Else\n                Cell.Locked = True\n            End If\n        Next Cell\n        .Protect Password:=\"\"\n        'Protect with blank password, you can change it\n    End With\n    With Sheet7\n        .Unprotect Password:=\"\"\n        .Cells.Locked = False\n        For Each Cell In .UsedRange\n            If Cell.Value = \"\" Then\n                Cell.Locked = False\n            Else\n                Cell.Locked = True\n            End If\n        Next Cell\n        .Protect Password:=\"\"\n        'Protect with blank password, you can change it\n    End With\n\nMsgBox \"Event Workbook_BeforeSave Over\", vbInformation + vbOKOnly, \"Finished\"\n    Exit Sub\nErrHandler:\n    MsgBox \"Error \" &amp; Err.Number &amp; \" :\" &amp; vbCrLf &amp; _\n        Err.Description\n    Resume ReTry\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1444272663, "creation_date": 1444272663, "answer_id": 33005776, "question_id": 32992912, "link": "https://stackoverflow.com/questions/32992912/isolate-excel-vba-script-to-run-aginst-specific-worksheets/33005776#33005776", "title": "Isolate Excel VBA script to run aginst specific worksheets?", "body": "<p>The code can be significantly shorted (run time wise) by </p>\n\n<ul>\n<li>Using <code>SpecialCells</code> rather than looping through each cell</li>\n<li>avoiding setting blank cells as being locked twice (minor compared to first point).</li>\n</ul>\n\n<p><em>updated</em></p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nFor Each sh In Array(\"Sheet1\", \"AnotherSheet\", \"OtherSheet\")\n        With Sheets(sh)\n            .Unprotect\n            .Cells.Locked = True\n                On Error Resume Next\n                .Cells.SpecialCells(xlBlanks).Locked = False\n                On Error GoTo 0\n            .Protect\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5394766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hzJXa.jpg?s=128&g=1", "display_name": "SirKit", "link": "https://stackoverflow.com/users/5394766/sirkit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 32993230, "answer_count": 3, "score": 1, "last_activity_date": 1444272757, "creation_date": 1444222819, "last_edit_date": 1444272757, "question_id": 32992912, "link": "https://stackoverflow.com/questions/32992912/isolate-excel-vba-script-to-run-aginst-specific-worksheets", "title": "Isolate Excel VBA script to run aginst specific worksheets?", "body": "<ul>\n<li>I have an Excel spreadsheet that contains 7 worksheets.  </li>\n<li>I need the <strong>script below to be applied to only some of the worksheets</strong> (<em>Sheet6</em> &amp; <em>Sheet7</em>) whenever the document is saved.</li>\n</ul>\n\n<p>I've spent several hours trying different modifications, must of which simply did not work.  The VBA debugger does not throw any errors, and when I test the script it never appears to run.</p>\n\n<p>How can the script below be modified to run against specific worksheets, whenever I save the document from any of the worksheet tabs?</p>\n\n<p>Thank you</p>\n\n<hr>\n\n<h2>VBA - Lock Cells &amp; Protect Sheet On Save</h2>\n\n<p>The script below will lock cells that contain values, and then password protect the sheet before saving.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    On Error Resume Next\n    Dim Cell As Range\n    With ActiveSheet\n        .Unprotect Password:=\"\"\n        .Cells.Locked = False\n        For Each Cell In Application.ActiveSheet.UsedRange\n            If Cell.Value = \"\" Then\n                Cell.Locked = False\n            Else\n                Cell.Locked = True\n            End If\n        Next Cell\n        .Protect Password:=\"\"\n         'Protect with blank password, you can change it\n    End With\n    Exit Sub\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://www.ozgrid.com/forum/showthread.php?t=161591\" rel=\"nofollow\">Script Source</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1444223057, "post_id": 32992832, "comment_id": 53810579, "body": "You don&#39;t have any reference (at least something that look like) for any controls or activeX in your code, so no wonder why it can&#39;t find the textbox..."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1444223399, "post_id": 32992832, "comment_id": 53810836, "body": "Try to use <code>ActiveSheet.OLEObjects(&quot;TextBox_Name&quot;).Object.Text</code> or <code>ActiveSheet.TextBox_Name.Text</code>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444223470, "post_id": 32992832, "comment_id": 53810905, "body": "<code>Sheets(&quot;SheetName&quot;).textbox1</code> Is the normal code, but if you are using a Command Button, why not put the code in the command button?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1444223651, "post_id": 32992832, "comment_id": 53811054, "body": "Is the value (in the TextBox) only to be found in that TextBox or did you link that TextBox to any cell and you are referencing that cell in the above code?"}, {"owner": {"reputation": 21, "user_id": 5397924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3b6f2b2e579f96a6a95a1d049c27b0?s=128&d=identicon&r=PG&f=1", "display_name": "user5397924", "link": "https://stackoverflow.com/users/5397924/user5397924"}, "edited": false, "score": 0, "creation_date": 1444223849, "post_id": 32992832, "comment_id": 53811199, "body": "i did not linked it to any cell"}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "is_accepted": false, "score": 1, "last_activity_date": 1445323648, "creation_date": 1445323648, "answer_id": 33229788, "question_id": 32992832, "link": "https://stackoverflow.com/questions/32992832/how-to-check-for-data-in-textbox/33229788#33229788", "title": "How to check for data in TextBox", "body": "<p>If the values are still inside the textBox then you have to reference the object or the control. you can do it like this:</p>\n\n<pre><code>textBox.value = worksheet.cells(1,1)\n</code></pre>\n\n<p>What this will do is display the value of <code>textBox</code> form control to cell <strong>A1.</strong> I know this is not what you are looking for but this is the simplest way of showing you how to reference userform objects or controls. You can find the name of a textBox control on a window like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/z7YPe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z7YPe.png\" alt=\"Properties window of a TextBox in VBA Excel\"></a></p>\n\n<p>You need to use the <strong>(Name)</strong> when referencing textboxes</p>\n"}], "owner": {"reputation": 21, "user_id": 5397924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3b6f2b2e579f96a6a95a1d049c27b0?s=128&d=identicon&r=PG&f=1", "display_name": "user5397924", "link": "https://stackoverflow.com/users/5397924/user5397924"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1445323648, "creation_date": 1444222587, "last_edit_date": 1444222840, "question_id": 32992832, "link": "https://stackoverflow.com/questions/32992832/how-to-check-for-data-in-textbox", "title": "How to check for data in TextBox", "body": "<p>I have a worksheet named \"Input\" with a Button (ActiveX) and a TextBox (ActiveX). I used VBA to check value of the TextBox when a user clicks the button, but the code cant find the textbox. </p>\n\n<p>My code for the button:</p>\n\n<pre><code>Sub Toevoegen()\nDim invoerenws As Worksheet\nDim overzichtws As Worksheet\n\nDim nextRow As Long\nDim oCol As Long\n\nDim myRng As Range\nDim myCopy As String\nDim myCell As Range\n\n'cells to copy from Input sheet - some contain formulas\nmyCopy = \"TextBox1\"\n\nSet invoerenws = Worksheets(\"invoeren\")\nSet overzichtws = Worksheets(\"overzicht\")\n\nWith overzichtws\n    nextRow = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Row\nEnd With\n\nWith invoerenws\n    Set myRng = .Range(myCopy)\n\n    If Application.CountA(myRng) &lt;&gt; myRng.Cells.Count Then\n        MsgBox \"Please fill in all the cells!\"\n        Exit Sub\n    End If\nEnd With\n\nWith overzichtws\n    With .Cells(nextRow, \"A\")\n        .Value = Now\n        .NumberFormat = \"mm/dd/yyyy hh:mm:ss\"\n    End With\n    .Cells(nextRow, \"B\").Value = Application.UserName\n    oCol = 3\n    For Each myCell In myRng.Cells\n        overzichtws.Cells(nextRow, oCol).Value = myCell.Value\n        oCol = oCol + 1\n    Next myCell\nEnd With\n\n'clear input cells that contain constants\nWith invoerenws\n  On Error Resume Next\n     With .Range(myCopy).Cells.SpecialCells(xlCellTypeConstants)\n          .ClearContents\n          Application.GoTo .Cells(1) ', Scroll:=True\n     End With\n  On Error GoTo 0\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1444321765, "creation_date": 1444321765, "answer_id": 33021252, "question_id": 32992739, "link": "https://stackoverflow.com/questions/32992739/add-and-delete-heading-between-existing-headings/33021252#33021252", "title": "Add and delete heading between existing headings", "body": "<p>In that case, record a macro in Word for the following steps:\nIn the Find dialog enter the text for \"Heading-3\" then click \"find\". The selection should jump to Heading-3</p>\n\n<p>This will give you the basic syntax for going to Heading 3. You can edit it to remove parameters you don't want/need (you only need the text search, really).</p>\n\n<p>Following the Find you insert code that will create a new paragraph with the text you want. There are a number of ways this can be done, my preference:</p>\n\n<pre><code>Dim rng as Word.Range\nSet rng = Selection.Range\nrng.InsertBefore vbCr 'paragraph mark\nrng.Collapse wdCollapseStart\nrng.Text = \"NEW STUFF\"\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 3867603, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a57672c9fd70c01104262013f60e350b?s=128&d=identicon&r=PG&f=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/3867603/rocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 33021252, "answer_count": 1, "score": 0, "last_activity_date": 1519675372, "creation_date": 1444222379, "last_edit_date": 1519675372, "question_id": 32992739, "link": "https://stackoverflow.com/questions/32992739/add-and-delete-heading-between-existing-headings", "title": "Add and delete heading between existing headings", "body": "<p>I need to loop through all the headings in the document and need to add new heading between Heading-2 and Heading-3. All existing headings are Heading 1 and I know the text.</p>\n\n<p>I need to delete Heading-5.</p>\n\n<p>The original file has 30000 more paragraphs; using old method takes too much time   </p>\n\n<p><pre>for example here are the headings \n     1. Heading-1 \n     2. Heading-2\n     3. Heading-3\n     4. Heading-4\n     5. Heading-5\n     6. Heading-6\n    </pre></p>\n\n<pre><code> For P = 1 To ActiveDocument.Paragraphs.Count - 1\n   ptext=ActiveDocument.Paragraphs(p).text\nIf Left(ActiveDocument.Paragraphs(P).Style, 9) = \"Heading 1\" Then\n            If InStr(1, ptext, \"Heading-2\") &gt; 0 Then\n                ActiveDocument.Paragraphs.Add _\n                Range:=ActiveDocument.Paragraphs(P).Range\n                Selection.MoveLeft Unit:=wdCharacter, Count:=1\n                Selection.TypeText Text:=\"Heading New\"                    \n            End If         \n    End If\nNext\n</code></pre>\n"}, {"tags": ["vba", "finance", "bloomberg", "stocks"], "comments": [{"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1444226494, "post_id": 32992666, "comment_id": 53813262, "body": "Do you want to do it in VBA (probably too complicated for the Stackoverflow format) or are you happy with Excel formulae?"}, {"owner": {"reputation": 21, "user_id": 5417338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e761ff8ec23c72a0f2fc15e651d06ec?s=128&d=identicon&r=PG&f=1", "display_name": "S Stephens", "link": "https://stackoverflow.com/users/5417338/s-stephens"}, "reply_to_user": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1444228373, "post_id": 32992666, "comment_id": 53814752, "body": "I am ok with formulae, though the project is at present VBA based (l am restricted to Excel so my less-technical colleagues can run it in a familiar  environment). As long as user-defined criteria can be taken into account it should be fine either way."}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1444229331, "post_id": 32992666, "comment_id": 53815513, "body": "Say you have 10 tickers: put them in B1:K1 on a sheet. In A2 use: <code>=BDH(B1,&quot;PX LAST&quot;,19800101,today(),&quot;Dates=S,Days=W,Fill=n.a.&quot;)</code>. In C2:K2 use: <code>=BDH(C1,&quot;PX LAST&quot;,19800101,today(),&quot;Dates=H,Days=W,Fill=n.a.&quot;)</code>. The cells will contain the data, with empty cells when no price was found, for all working days since January 1980. Note that controlling the data population from VBA can be a bit tricky. You can change Fill to <code>P</code> is you want the previous price to be carried over."}], "answers": [{"tags": [], "owner": {"reputation": 563, "user_id": 5657071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86880273799f87efafd0734118f2d9?s=128&d=identicon&r=PG&f=1", "display_name": "RasikhJ", "link": "https://stackoverflow.com/users/5657071/rasikhj"}, "is_accepted": false, "score": 0, "last_activity_date": 1458675997, "creation_date": 1458675997, "answer_id": 36163795, "question_id": 32992666, "link": "https://stackoverflow.com/questions/32992666/historical-index-performance-in-bloomberg-vba/36163795#36163795", "title": "historical index performance in Bloomberg / VBA", "body": "<p>Using the Bloomberg Excel Add-In, you can automate functions through Historical Data-set Formulas. Once you have the core formula syntax down, you can easily do things like drag cells to update new tickers with similar data-sets. </p>\n\n<p>Your goal appears to be something like a Stock Screener, however. In your example you mentioned that you would like to make it custom and flexible for a user to <strong>screen</strong> stocks based on a particular set of criteria. </p>\n\n<p>Maybe you're trying to do something conceptually like this : <a href=\"https://www.google.com/finance/stockscreener\" rel=\"nofollow\">https://www.google.com/finance/stockscreener</a></p>\n\n<p>But with a wider breadth of data. What you would have to do to avoid the costs of Network Transactions and Data Storage is to be able to quickly eliminate a solid part of the Stock Screen Universe by using some data-sets or indicators that are stronger in filtering out the noise of stocks that may exhibit criteria that the user may not be interested in. </p>\n"}], "owner": {"reputation": 21, "user_id": 5417338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e761ff8ec23c72a0f2fc15e651d06ec?s=128&d=identicon&r=PG&f=1", "display_name": "S Stephens", "link": "https://stackoverflow.com/users/5417338/s-stephens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1458675997, "creation_date": 1444222183, "question_id": 32992666, "link": "https://stackoverflow.com/questions/32992666/historical-index-performance-in-bloomberg-vba", "title": "historical index performance in Bloomberg / VBA", "body": "<p>I am making a tool which plots the historical (12800 dates, 1980-today) stock performance of subsets of 3500 companies based on a set of sustainability rating criteria chosen by the user. For example, one could pick \"worker health and safety\" and then see the stock performances of the companies with the best and worst ratings in that area compared to the average.</p>\n\n<p>After the user inputs constraints, I produce a list of Bloomberg tickers for which I want to analyze performance. Is there a way to upload such a list of tickers to Bloomberg, and have it return the historical performance data? Or even a well-documented source of help / examples? I asked the help desk but they just told me to read their documentation, which didn't prove to be of much use.</p>\n\n<p>I am avoiding at all costs downloading the ~44,000,000 data points I might theoretically need (35 years of daily last price for all 3500 companies) - so any alternative ideas would be very much appreciated.</p>\n"}, {"tags": ["sql", "sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 72439, "user_id": 722783, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9bec34cd959ec42a9207e606ad2bd47f?s=128&d=identicon&r=PG&f=1", "display_name": "Mahmoud Gamal", "link": "https://stackoverflow.com/users/722783/mahmoud-gamal"}, "edited": false, "score": 1, "creation_date": 1444222504, "post_id": 32992626, "comment_id": 53810148, "body": "The only difference is <code>LAST</code>, search how to do what <code>LAST</code> do in ACCESS and how to the same thing in SQL 2012, if you faced any trouble post what you have tried."}], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1444459802, "post_id": 32995687, "comment_id": 53922895, "body": "Hi. Tnx for your reply. But it didn&#39;t work, So I tried to clarify what I want. Thanks"}, {"owner": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1444460359, "post_id": 32995687, "comment_id": 53923028, "body": "<a href=\"http://stackoverflow.com/questions/33051258/sql-query-with-join-and-group-by-and\" title=\"sql query with join and group by and\">stackoverflow.com/questions/33051258/&hellip;</a> Here is the link to the question"}], "tags": [], "owner": {"reputation": 2161, "user_id": 5367486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66dccd02d6f5404de325a25dc5943c79?s=128&d=identicon&r=PG&f=1", "display_name": "toonice", "link": "https://stackoverflow.com/users/5367486/toonice"}, "is_accepted": true, "score": 0, "last_activity_date": 1444229931, "creation_date": 1444229931, "answer_id": 32995687, "question_id": 32992626, "link": "https://stackoverflow.com/questions/32992626/converting-access-query-to-sql-2012/32995687#32995687", "title": "Converting access query to sql 2012", "body": "<p>Go to <a href=\"http://www.w3schools.com/sql/sql_func_last.asp\" rel=\"nofollow\">http://www.w3schools.com/sql/sql_func_last.asp</a> for a good description of LAST and possible workarounds.  Using the information from that page I suggest you try the following code -</p>\n\n<pre><code>SELECT Main.ID,\n       Main.Name,\n       Main.Family,\n       Main.Mobile,\n       Main.[Import Date],\n       Main.Ostan,\n       Main.City,\n       Main.REP,\n       Main.REP1,\n       Main.ostan2,\n       Main.City2,\n       Main.Hospital,\n       Main.Expert,\n       Main.Status,\n       Main.Type,\n       Main.Time,\n       (SELECT TOP 1 Report.Date\n        FROM Report\n        ORDER BY Repoort.Date DESC) AS LastOfDate,\n       (SELECT TOP 1 NameP\n        FROM Report\n        ORDER BY NameP DESC) AS LastOfNameP,\n       (SELECT TOP 1 NextC\n        FROM Report\n        ORDER BY NextC DESC) AS LastOfNextC,\n       Report.Nurse,\n       (SELECT TOP 1 Brand\n        FROM Report\n        ORDER BY Brand DESC) AS LastOfBrand,\n       (SELECT TOP 1 Paste\n        FROM Report\n        ORDER BY Paste DESC) AS LastOfPaste,\n       (SELECT TOP 1 Bag\n        FROM Report\n        ORDER BY Bag DESC) AS LastOfBag,\n       (SELECT TOP 1 ACC\n        FROM Report\n        ORDER BY ACC DESC) AS LastOfACC,\n       (SELECT TOP 1 BM\n        FROM Report\n        ORDER BY BM DESC) AS LastOfBM,\n       (SELECT TOP 1 PM\n        FROM Report\n        ORDER BY PM DESC) AS LastOfPM,\n       (SELECT TOP 1 Bimeh\n        FROM Report\n        ORDER BY Bimeh DESC) AS LastOfBimeh,\n       Main.[Dead/ Heald Date],\n       Main.[Operation Date]\nFROM Main INNER JOIN Report ON Main.ID = Report.ID\nGROUP BY Main.ID,\n         Main.Name,\n         Main.Family,\n         Main.Mobile,\n         Main.[Import Date],\n         Main.Ostan,\n         Main.City,\n         Main.REP,\n         Main.REP1,\n         Main.ostan2,\n         Main.City2,\n         Main.Hospital,\n         Main.Expert,\n         Main.Status,\n         Main.Type,\n         Main.Time,\n         Report.Nurse,\n         Main.[Dead/ Heald Date],\n         Main.[Operation Date];\n</code></pre>\n\n<p>I hope that this proves helpful.</p>\n\n<p>Please feel free to reply if you have any questions.</p>\n"}], "owner": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 32995687, "answer_count": 1, "score": -2, "last_activity_date": 1594643503, "creation_date": 1444222046, "last_edit_date": 1594643503, "question_id": 32992626, "link": "https://stackoverflow.com/questions/32992626/converting-access-query-to-sql-2012", "title": "Converting access query to sql 2012", "body": "<p>Hi i want to have this query in sql how can i change it to sql one.</p>\n\n<pre><code>SELECT Main.ID, Main.Name, Main.Family, Main.Mobile, Main.[Import Date],\n Main.Ostan, Main.City, Main.REP, Main.REP1, Main.ostan2, Main.City2, Main.Hospital,\n  Main.Expert, Main.Status, Main.Type, Main.Time, Last(Report.Date) AS LastOfDate, \n  Last(Report.NameP) AS LastOfNameP, Last(Report.NEXTC) AS LastOfNEXTC, Report.Nurse, \n  Last(Report.Brand) AS LastOfBrand, Last(Report.Paste) AS LastOfPaste,\n   Last(Report.Bag) AS LastOfBag, Last(Report.ACC) AS LastOfACC, Last(Report.BM) AS LastOfBM,\n    Last(Report.PM) AS LastOfPM, Last(Report.Bimeh) AS LastOfBimeh, Main.[Dead/ Heald Date], Main.[Operation Date]\nFROM Main INNER JOIN Report ON Main.ID = Report.ID\nGROUP BY Main.ID, Main.Name, Main.Family, Main.Mobile, Main.[Import Date], Main.Ostan, Main.City, Main.REP,\n Main.REP1, Main.ostan2, Main.City2, Main.Hospital, Main.Expert, Main.Status, Main.Type, Main.Time, Report.Nurse, Main.[Dead/ Heald Date], Main.[Operation Date];\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1444221171, "post_id": 32992278, "comment_id": 53809129, "body": "which part &quot;creates a new file&quot; (the <code>wbCopy.SaveAs</code> line?) and what does &quot;breaking all the time&quot; actually mean?  IOW, can you describe your <i>actual</i> problem?  Should be pretty easy to diagnose if you can tell us what the problem is..."}, {"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1444222010, "post_id": 32992278, "comment_id": 53809768, "body": "I want that my `xlsm&#180; only creates folders, with names from my list. It&#39;s not working how i do it... and i don&#39;t know how i could loop through..  In the end i want to paste my list in and it should create my folders when i press a button"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1444223067, "post_id": 32992278, "comment_id": 53810590, "body": "&quot;Not working&quot; and &quot;breaking all the time&quot; don&#39;t tell us anything about your actual problem. Where is your &quot;list&quot;? What errors do you get in the code?  How do the output differ from your expectations?  <b>DO NOT</b> respond in the comments, EDIT your original question to include these details and then maybe someone can help you..."}, {"owner": {"reputation": 142, "user_id": 4971631, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yv7lbt8gO-0/AAAAAAAAAAI/AAAAAAAAABk/6dOnX_lw3D8/photo.jpg?sz=128", "display_name": "Josh Fierro", "link": "https://stackoverflow.com/users/4971631/josh-fierro"}, "edited": false, "score": 0, "creation_date": 1444223291, "post_id": 32992278, "comment_id": 53810762, "body": "You say &quot;I want that my `xlsm&#180; only creates folders&quot;, but in your code you&#39;re creating workbooks and saving them in new folders.  Which is it?"}, {"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1444224346, "post_id": 32992278, "comment_id": 53811530, "body": "yes, but i want that it only creates folders. I tried to remove the file creating stuff but its not working then.... and i don&#39;T know how to loop through cells when i need folders with the names in A50:A200"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1444223742, "post_id": 32993008, "comment_id": 53811127, "body": "The code in my question was from an other project of mine....  I only need folders no files.... only folders.. :/"}, {"owner": {"reputation": 142, "user_id": 4971631, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yv7lbt8gO-0/AAAAAAAAAAI/AAAAAAAAABk/6dOnX_lw3D8/photo.jpg?sz=128", "display_name": "Josh Fierro", "link": "https://stackoverflow.com/users/4971631/josh-fierro"}, "reply_to_user": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1444224394, "post_id": 32993008, "comment_id": 53811569, "body": "That&#39;s even easier then.  All you have to do is take out the parts of this code that actually create and save a new workbook and replace them with code that creates your folders.  You still haven&#39;t answered the question of where exactly your list of folder names is within your workbook though.  That&#39;s an important one..."}, {"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1444224525, "post_id": 32993008, "comment_id": 53811687, "body": "Lets take A50:A100 how does this matter? you always can change this...  I&#39;m not good at programming... but i&#39;ll try. i bet it doesn&#39;T work after.."}, {"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1444224647, "post_id": 32993008, "comment_id": 53811787, "body": "and it&#39;s not working anymore... i only removed the  file saving stuff.. ):"}, {"owner": {"reputation": 142, "user_id": 4971631, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yv7lbt8gO-0/AAAAAAAAAAI/AAAAAAAAABk/6dOnX_lw3D8/photo.jpg?sz=128", "display_name": "Josh Fierro", "link": "https://stackoverflow.com/users/4971631/josh-fierro"}, "reply_to_user": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1444225081, "post_id": 32993008, "comment_id": 53812140, "body": "Well, the code is looking at a specific set of cells.  I set it up to cycle through D75:D100 (because the code you posted showed it looking at D81 a single time...)  Try my edit.  This should just create folders for you if your list of folder names is in D75 to D100, and you want them to be created in the workbook&#39;s path."}, {"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1444225322, "post_id": 32993008, "comment_id": 53812358, "body": "thanks, i changed that places where the names where often ^^...  Thanks you very much!"}], "tags": [], "owner": {"reputation": 142, "user_id": 4971631, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yv7lbt8gO-0/AAAAAAAAAAI/AAAAAAAAABk/6dOnX_lw3D8/photo.jpg?sz=128", "display_name": "Josh Fierro", "link": "https://stackoverflow.com/users/4971631/josh-fierro"}, "is_accepted": true, "score": 2, "last_activity_date": 1444229654, "last_edit_date": 1444229654, "creation_date": 1444223096, "answer_id": 32993008, "question_id": 32992278, "link": "https://stackoverflow.com/questions/32992278/create-folders-in-the-active-workbooks-path-from-a-list-of-folder-names-on-the/32993008#32993008", "title": "Create folders in the active workbook&#39;s path from a list of folder names on the active sheet", "body": "<p>Your code doesn't contain a loop.  Depending on where in your workbook this list of folder names is contained, and how static the size of that list is (based on your code I'm assuming that it is contained within a set of cells in column D, but there is also other stuff in that column so you wouldn't be able to use any standard method of handling a variable list size), you would need a loop that looks through that list.  </p>\n\n<p>Also, you intend to create all these folders in the path of the workbook containing this code, otherwise you would need to set your path name to something else...</p>\n\n<p>Let's say your list is of variable size, doesn't contain any blanks, and is contained in some unknown number of cells starting in A50 but never any farther than A100. Then your loop could look like this:</p>\n\n<pre><code>    Dim strDirname As String, _\n    strPathname As String, _\n    strDefpath As String, _\n    WbMaster As Workbook\n\n    For i = 1 to WorksheetFunction.Counta(Range(\"A50:A100\"))\n        strDirname = Range(\"A\" &amp; i).Value ' New directory name\n        Set WbMaster = Application.ActiveWorkbook\n        strDefpath = WbMaster.Path 'Default path name\n        If Dir(strDefpath &amp; \"\\\" &amp; strDirname) = \"\" Then\n            MkDir strDefpath &amp; \"\\\" &amp; strDirname\n        End If\n    Next i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1444228121, "creation_date": 1444228121, "answer_id": 32994967, "question_id": 32992278, "link": "https://stackoverflow.com/questions/32992278/create-folders-in-the-active-workbooks-path-from-a-list-of-folder-names-on-the/32994967#32994967", "title": "Create folders in the active workbook&#39;s path from a list of folder names on the active sheet", "body": "<p>Maybe a little late to jump in with an answer....</p>\n\n<p>If your folder names (full paths) are on Sheet1 range C1:C4.<br>\nThe Main procedure will step through each cell in the range, calling the CreateFolder procedure to create all folders/subfolders as required in the path string.</p>\n\n<pre><code>Sub Main()\n    Dim rCell As Range\n    For Each rCell In ThisWorkbook.Worksheets(\"Sheet1\").Range(\"C1:C4\")\n        CreateFolder rCell.Value\n    Next rCell \nEnd Sub\n\n\nSub CreateFolder(Folder)\nOn Error Resume Next\nDim objFSO As Object: Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    If Folder &lt;&gt; \"\" Then\n        If Not objFSO.FileExists(objFSO.GetParentFolderName(Folder)) Then\n            Call CreateFolder(objFSO.GetParentFolderName(Folder))\n        End If\n        objFSO.CreateFolder (Folder)\n    End If\nEnd Sub\n</code></pre>\n\n<p>So, for example, I have set up a dynamic folder name:<br>\nIn cell A1 enter the formula <code>=TODAY()</code><br>\nin cell C1 enter the formula: <code>=\"C:\\Test\\\" &amp; TEXT($A$1+ROW(),\"mm mmm yyyy\\\\dd (ddd)\")</code> and drag down to row 4.<br>\nThis will turn the date into a folder name, using the row number to increment the date.<br>\nYou'll get four folders named <code>C:\\Test\\10 Oct 2015\\08 (Thu)</code> to <code>C:\\Test\\10 Oct 2015\\11 (Sun)</code></p>\n"}], "owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 32993008, "answer_count": 2, "score": 0, "last_activity_date": 1444237805, "creation_date": 1444221033, "last_edit_date": 1531161705, "question_id": 32992278, "link": "https://stackoverflow.com/questions/32992278/create-folders-in-the-active-workbooks-path-from-a-list-of-folder-names-on-the", "title": "Create folders in the active workbook&#39;s path from a list of folder names on the active sheet", "body": "<p>I need several folders. I have a list with their names and have code but don't know how to loop it through my list. A few days ago I asked about fixing code that exports a file in a newly created folder. Now I am trying to modify that code, but it is not working:</p>\n\n<pre><code>Dim strFilename As String, _\nstrDirname As String, _\nstrPathname As String, _\nstrDefpath As String, _\nSheetToExport As String, _\nWbMaster As Workbook, _\nWbCopy As Workbook\n\n\nOn Error Resume Next ' If directory exist goto next line\nstrDirname = Range(\"D81\").Value ' New directory name\nstrFilename = Range(\"D8\").Value 'New file name\n\nSet WbMaster = Application.ActiveWorkbook\nSheetToExport = Range(\"A1\").Value 'Or specify UserForm output\n\nstrDefpath = WbMaster.Path 'Default path name\n\nIf IsEmpty(strDirname) Then Exit Sub\nIf IsEmpty(strFilename) Then Exit Sub\n\nMkDir strDefpath &amp; \"\\\" &amp; strDirname\nstrPathname = strDefpath &amp; \"\\\" &amp; strDirname &amp; \"\\\" &amp; strFilename 'create total string\n\nWbMaster.Sheets(SheetToExport).Copy\nSet WbCopy = Application.ActiveWorkbook\n\nWbCopy.SaveAs Filename:=strPathname &amp; \".xlsx\", _\n            FileFormat:=xlOpenXMLWorkbook, Password:=\"\", WriteResPassword:=\"\", _\n            ReadOnlyRecommended:=False, CreateBackup:=False\n\nClosingWb = MsgBox(\"Do you wish to close the exported file?\",vbYesNo,\"Close exported file\")\nIf ClosingWb &lt;&gt; vbNo Then WbCopy.Close\n</code></pre>\n\n<p>I tried to remove the part where it creates a new file but it starts breaking all the time.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5114941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe460cc8c70d4f6c7ef6e15f1908d853?s=128&d=identicon&r=PG&f=1", "display_name": "MarkDownMark", "link": "https://stackoverflow.com/users/5114941/markdownmark"}, "edited": false, "score": 0, "creation_date": 1444235058, "post_id": 32997463, "comment_id": 53819796, "body": "I just came back here to delete the post because I realized that I was not saving the .dotm in the STARTUP folder but in the Templates folder.  Once I did that, I was able to see the macro show up on the other computer on all documents.  Is it easy to create the customized Ribbon on the new template?  I created customized ribbons but I&#39;m not sure where they&#39;re being pulled from.  I will have to go back and do some more testing."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 45, "user_id": 5114941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe460cc8c70d4f6c7ef6e15f1908d853?s=128&d=identicon&r=PG&f=1", "display_name": "MarkDownMark", "link": "https://stackoverflow.com/users/5114941/markdownmark"}, "edited": false, "score": 0, "creation_date": 1444322149, "post_id": 32997463, "comment_id": 53865423, "body": "Hi Mark Take a look at the discussion in the link I provided, that gives fairly detailed information. In a nutshell, all Ribbon customizations provided by templates plus any COM add-ins will be displayed &quot;in parallel&quot;. Ribbon customizations in templates attached to docs will display only for those docs. If you hover the mouse pointer over a custom control you&#39;ll see the name of the template/add-in providing it."}, {"owner": {"reputation": 45, "user_id": 5114941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe460cc8c70d4f6c7ef6e15f1908d853?s=128&d=identicon&r=PG&f=1", "display_name": "MarkDownMark", "link": "https://stackoverflow.com/users/5114941/markdownmark"}, "edited": false, "score": 0, "creation_date": 1444339362, "post_id": 32997463, "comment_id": 53874660, "body": "Thank you Cindy.  I am going to investigate that a little further on my home computer since my company does not allow me to download the file.  You have been helpful in pointing me in the right direction.  Thanks again!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1444234776, "last_edit_date": 1495535228, "creation_date": 1444234776, "answer_id": 32997463, "question_id": 32992231, "link": "https://stackoverflow.com/questions/32992231/copy-word-macro-to-multiple-computers-using-template/32997463#32997463", "title": "Copy Word Macro to Multiple Computers using Template", "body": "<p>It would be useful to know which version of Word is involved in your company?</p>\n\n<p>Should the users be using the template to create new documents? Or should the macro be available for \"all\" documents? </p>\n\n<p>The approach you describe is for the first scenario and the macro will only be accessible when a document created from the template has the focus. For the other scenario the template should be placed in the user's STARTUP folder so that it loads automatically when Word starts.</p>\n\n<p>You might also consider adding a Ribbon customization to the template that runs the macro. (EDIT: See this discussion <a href=\"https://stackoverflow.com/questions/32988202/word-2010-how-do-i-attach-a-ribbon-button-to-a-template-using-vba/32989549#32989549\">Word 2010: How do I attach a ribbon button to a template using VBA</a>)</p>\n\n<p>When you say the users cannot \"see\" the macro: where are they looking? Is it possible that their security settings are blocking macros? Have you checked in File/Options/Trust Center/Trust Center Settings/Macros Settings?</p>\n"}], "owner": {"reputation": 45, "user_id": 5114941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe460cc8c70d4f6c7ef6e15f1908d853?s=128&d=identicon&r=PG&f=1", "display_name": "MarkDownMark", "link": "https://stackoverflow.com/users/5114941/markdownmark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 32997463, "answer_count": 1, "score": 0, "last_activity_date": 1594054643, "creation_date": 1444220912, "last_edit_date": 1594054643, "question_id": 32992231, "link": "https://stackoverflow.com/questions/32992231/copy-word-macro-to-multiple-computers-using-template", "title": "Copy Word Macro to Multiple Computers using Template", "body": "<p>I have created a custom Macro for our organization that I'm trying to share with other users.  I figured the easiest way to do this for the non-power users was to copy the macro to another template (other than normal.dotm) and place that file in their template directory.  I have created the new template, saved it and then copied it to another computer however when the user opens it up, they cannot see the macro.  Does the user have to copy the macro from the new template to their normal.dotm template before they can use it?  </p>\n\n<p>Is there another or easier way to share the macro with multiple users?  Any help/suggestions are appreciated.  </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ms-access", "vba", "shift"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1444304927, "post_id": 33001623, "comment_id": 53852772, "body": "I have added the code I have to bypass the shift how do I add the password part to this code?"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1444307873, "post_id": 33001623, "comment_id": 53854899, "body": "Ok well... I thought the code about worked but it does not, do you have a code to disable the shift button?"}, {"owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1444313891, "post_id": 33001623, "comment_id": 53859809, "body": "You&#39;d best search for <code>AllowBypassKey</code>. there are numerous post about it. If it works then we can look at the password part of your query."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1444322419, "post_id": 33001623, "comment_id": 53865569, "body": "I keep searching and trying all types of codes and none work... is it because I have my database as an .accdb?"}, {"owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1444398218, "post_id": 33001623, "comment_id": 53900449, "body": "I added information about <code>AllowBypassKey</code> the my answer"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1444412515, "post_id": 33001623, "comment_id": 53909217, "body": "Ok so I should add all this to a new module and then just set the allowbypasskey option to true if the password is correct behind the text box?"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1444413421, "post_id": 33001623, "comment_id": 53909646, "body": "Ahh ok I finally have a code that shuts off the shift but now I need to figure out the code to add to the password text box"}], "tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 2, "last_activity_date": 1444396001, "last_edit_date": 1444396001, "creation_date": 1444248800, "answer_id": 33001623, "question_id": 32991071, "link": "https://stackoverflow.com/questions/32991071/bypass-shift-with-pop-up-password-box/33001623#33001623", "title": "Bypass shift with pop up password box", "body": "<p>I don't think it is possible to catch the startup event while shift is disabled. What I always do is to add a hidden password text box on the startup form. The password text box can be activated by a 'hidden button'. The effect only applies to the next startup event (and on), so it is not as direct as you'd like it, but it is reliable.</p>\n\n<ol>\n<li>Add a rectangle to the startup form that will act as a mouse catcher. Make sure that <code>Back Style</code> is set to <code>Normal</code>, but with the same color as the form's <code>BackColor</code>so it is invisible.</li>\n<li>Add a hidden text box to startup form. Set <code>Input Mask</code> as <code>Password</code> </li>\n<li>Add a Double_Click event to the rectangle, that will unhide the password text box</li>\n<li>Add an <code>AfterUpdate</code> event to the password text box, that will enable the shift key (<code>AllowBypassKey</code>) if the password is correct. You can enter the access interface at the next startup. </li>\n</ol>\n\n<p>To use the AllowBypassKey:</p>\n\n<pre><code>Public Sub CreateLockProperty()\n\n    CurrentDb.Properties.Append CurrentDb.CreateProperty(\"AllowBypassKey\", dbBoolean, True)\n\nEnd Sub\n\nPublic Sub SetToolLock(bLocked As Boolean)\n\n    CurrentDb.Properties(\"AllowBypassKey\") = Not bLocked\n\nEnd Sub\n\nPublic Function ToolLocked() As Boolean\n\n    ToolLocked = Not CurrentDb.Properties(\"AllowBypassKey\")\n\nEnd Function\n</code></pre>\n\n<p>First you have to create the property by running the first procedure. After that you can use the other two.</p>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1594643530, "creation_date": 1444217470, "last_edit_date": 1594643530, "question_id": 32991071, "link": "https://stackoverflow.com/questions/32991071/bypass-shift-with-pop-up-password-box", "title": "Bypass shift with pop up password box", "body": "<p>I am trying to create an access database that is shut off from the users even the bypass shift option. I have done a code that does this but what I want to add is a pop up box when the shift key is pressed that allows a user to enter a password and the bypass shift option will work again. Does anybody know if this is possible?</p>\n\n<p>Thanks!</p>\n\n<pre><code>Function ap_DisableShift()\n\nOn Error GoTo errDisableShift\n\nDim db As DAO.Database\nDim prop As DAO.Property\nConst conPropNotFound = 3270\n\nSet db = CurrentDb()\n\ndb.Properties(\"AllowByPassKey\") = False\n\nExit Function\n\nerrDisableShift:\n\nIf Err = conPropNotFound Then\nSet prop = db.CreateProperty(\"AllowByPassKey\", _\ndbBoolean, False)\ndb.Properties.Append prop\nResume Next\nElse\nMsgBox \"Function 'ap_DisableShift' did not complete successfully.\"\nExit Function\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "sublimetext"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1444217597, "post_id": 32991011, "comment_id": 53806630, "body": "That add-in is for <a href=\"https://stackoverflow.com/questions/tagged/vbscript\">vbscript</a> not VBA. They are very different things. VBA can only be compiled and executed in it&#39;s own IDE which can only be used in Office."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1444217728, "post_id": 32991011, "comment_id": 53806704, "body": "Why do you think the VBA Editor is inefficient? It&#39;s based around the same principles of a proper IDE and allows <a href=\"https://stackoverflow.com/questions/tagged/intellisense\">intellisense</a> which is one of the biggest advantages of VBA. Sublime text and NotePad++ are just advanced text editors with syntax highlighting, not IDEs."}, {"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1444217758, "post_id": 32991011, "comment_id": 53806718, "body": "@MacroMan Ooo, should&#39;ve caught that the plug-in is for vbscript. I guess I expected it to exist, and didn&#39;t check it thoroughly. You&#39;re positive VBA can only be compiled and executed in the native IDE?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1444217925, "post_id": 32991011, "comment_id": 53806827, "body": "VBA is exclusive to MS Office, <a href=\"http://stackoverflow.com/questions/4228061/recommended-ide-for-vba\">Have a look at this question</a> - you can only execute VBA in the native IDE. Why don&#39;t you like the IDE though?"}, {"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1444217983, "post_id": 32991011, "comment_id": 53806869, "body": "@MacroMan Well, you just pointed it out: Sublime Text and Notepad++ are (effective) advanced text editors. Sublime has stuff as Multiple Cursors and shortcuts for about anything, while my experience with the VBA IDE for now is basically &quot;a button for everything&quot; and limited shortcuts. And of course - <i>I</i> know Sublime, I&#39;m not that interested in learning how to use the VBA IDE, just the language. I&#39;m used to way more flexibility when writing."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1444218127, "post_id": 32991011, "comment_id": 53806954, "body": "There are shortcuts for most things in the VBA IDE, just a case of learning them. I understand your point about what you&#39;re used to, but if you&#39;re serious about learning VBA then the IDE comes part and parcel. That being said, there&#39;s nothing to stop you <i>writing</i> your code in N++ or sublime, then simply paste it into a module so that you can debug it."}, {"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1444218433, "post_id": 32991011, "comment_id": 53807164, "body": "&quot;Most things&quot; (i.e. <a href=\"https://msdn.microsoft.com/en-us/library/bb531266(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb531266(v=vs.90).aspx</a>) is a higly relative term. This is becoming a chat :p Thanks for your input. I guess my question is a massive duplicate (though it was difficult to find relevant answers with Google). Maybe VSTO is worth a try."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1444218522, "post_id": 32991011, "comment_id": 53807225, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/91596/discussion-between-macro-man-and-holene\">continue this discussion in chat</a>."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1444221959, "post_id": 32991011, "comment_id": 53809732, "body": "VBA is not exclusive to MS Office, you can find it e.g. in ArcGIS, AutoCAD, CATIA, Corel Draw, WordPerfect and others."}, {"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 8, "creation_date": 1480503387, "post_id": 32991011, "comment_id": 68986968, "body": "I am surprised at those asking what is wrong with VBA IDE!!! Just copy a VBA program to notepad with Language VBA or use VS to see the difference. The IDE was good in 1990."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 1682443, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rRtx8.png?s=128&g=1", "display_name": "Gaudi", "link": "https://stackoverflow.com/users/1682443/gaudi"}, "is_accepted": false, "score": 4, "last_activity_date": 1497630226, "last_edit_date": 1497630226, "creation_date": 1497620100, "answer_id": 44590627, "question_id": 32991011, "link": "https://stackoverflow.com/questions/32991011/using-sublime-text-or-notepad-as-editor-and-builder-for-vba/44590627#44590627", "title": "Using Sublime Text or Notepad++ as Editor and Builder for VBA", "body": "<p>The problem with VBA code and writing it in Sublime is that VBA is embedded into Excel, so you cannot just build the macros you write in Sublime </p>\n\n<hr>\n\n<ul>\n<li>One solution to this is writing your VBA code and copying-pasting into VBA Editor (mentioned above). This is not manageable when you start working with multiple modules, classes, etc.</li>\n</ul>\n\n<hr>\n\n<ul>\n<li>Second approach is to use Import/Export functionality of VBA. You can export your modules and classes into <code>*.bas</code> and <code>*.cls</code> files and edit them directly in Sublime Text. For that you can use macros from <a href=\"https://www.rondebruin.nl/win/s9/win002.htm\" rel=\"nofollow noreferrer\">Ron De Bruin</a> website. Just copy the code into seperate module and it will export all code you have in the currect project into seperate files, which you can edit in Sublime Text. After you make changes in Sublime just import all files back again into VBA editor with the macro. You might want to change the VBA code slightly as well by commenting out</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<pre><code>If wkbSource.VBProject.Protection = 1 Then\n    MsgBox \"The VBA in this workbook is protected,\" &amp; _\n        \"not possible to export the code\"\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>... otherwise it won't import back to the same spreadsheet.</p>\n"}], "owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24060, "favorite_count": 3, "answer_count": 1, "score": 10, "last_activity_date": 1537784177, "creation_date": 1444217293, "last_edit_date": 1537784177, "question_id": 32991011, "link": "https://stackoverflow.com/questions/32991011/using-sublime-text-or-notepad-as-editor-and-builder-for-vba", "title": "Using Sublime Text or Notepad++ as Editor and Builder for VBA", "body": "<p>OK, so I have to learn VBA in my new line of work as we use Excel to more or less anything. The built-in VBA editor in Excel drives me absolutely bonkers - it feels like it's not made for writing code in an efficient way. </p>\n\n<p>I have been using Sublime Text for all coding purposes recent years. <a href=\"https://github.com/SublimeText/VBScript\" rel=\"nofollow noreferrer\">There's a plug-in for writing <s>VBA</s> <strong><em>vbScript</em></strong> in Sublime</a>, but I don't understand how to link my Sublime written code to my Excel documents. Say I try to run the following file</p>\n\n<pre><code>Sub test()\n  Debug.Print \"Hello, World\"\nEnd Sub\n</code></pre>\n\n<p>from Sublime Text, I get the following out from the console <code>[Finished in 0.1s]</code>, but no printout. </p>\n\n<p>My question is this: does anyone have a solution for how to run VBA in Excel from Sublime Text or Notepad++? I'm still a massive noob in VBA, therefore it would be nice to be able to actually see the effects on the Excel Workbook next to testing the code. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1444218218, "post_id": 32990972, "comment_id": 53807018, "body": "How are you calling these functions? By default, functions are not directly accessible between workbooks unless you use <code>Application.Run</code> or call them from a cell and explicitly include the workbook name."}, {"owner": {"reputation": 1, "user_id": 5390239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e95f43143184bbeb9b3b7a1fbf4085?s=128&d=identicon&r=PG&f=1", "display_name": "Mtulio", "link": "https://stackoverflow.com/users/5390239/mtulio"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444221886, "post_id": 32990972, "comment_id": 53809671, "body": "Ohh ok... Now I understand well... I thought that function could be called for all workbooks without any specifc code."}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 1, "last_activity_date": 1444227851, "last_edit_date": 1525816098, "creation_date": 1444227851, "answer_id": 32994857, "question_id": 32990972, "link": "https://stackoverflow.com/questions/32990972/make-function-private-for-another-workbook-in-excel-vba/32994857#32994857", "title": "Make function private for another workbook in excel vba", "body": "<p>See here for an answer <a href=\"http://www.cpearson.com/excel/scope.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/scope.aspx</a></p>\n\n<p>Here's a copied summary:</p>\n\n<p>If you want a variable to be accessible from anywhere within the project, but not accessible from another project, you need to use Option Private Module as the first line in the module (above and outside of any variable declaration or procedure). This option makes everything in the module accessible only from within the project. This means also that if you do want some project variables to be accessible from other projects and other project variables to be inaccessible from other projects, you need to declare them in separate modules.</p>\n"}], "owner": {"reputation": 1, "user_id": 5390239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e95f43143184bbeb9b3b7a1fbf4085?s=128&d=identicon&r=PG&f=1", "display_name": "Mtulio", "link": "https://stackoverflow.com/users/5390239/mtulio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444227851, "creation_date": 1444217203, "question_id": 32990972, "link": "https://stackoverflow.com/questions/32990972/make-function-private-for-another-workbook-in-excel-vba", "title": "Make function private for another workbook in excel vba", "body": "<p>First of all, sorry about my English. I'm still learning....\nI wanna know how can I make some function or modulus inaccessible for another workbook. In contrast I need these function public for all modulus inside workbook. I make myself clear?\nFor example:\nI need to open two workbook that contains function with the same name but these functions perform things a little bit different.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444216791, "post_id": 32990696, "comment_id": 53806033, "body": "<code>MsgBox &quot;Dear user, you will now be prompted to open the monthly report&quot;</code>, then <code>Application.FileDialog.Show(msoFileDialogOpen)</code>... ?"}, {"owner": {"reputation": 1240, "user_id": 5127164, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TQdRY.gif?s=128&g=1", "display_name": "outofmind", "link": "https://stackoverflow.com/users/5127164/outofmind"}, "edited": false, "score": 0, "creation_date": 1444217546, "post_id": 32990696, "comment_id": 53806582, "body": "No need to prompt the user when you know the filename, see <a href=\"http://stackoverflow.com/questions/1801598/how-do-i-reference-to-another-open-or-closed-workbook-and-pull-values-back-i\" title=\"how do i reference to another open or closed workbook and pull values back i\">stackoverflow.com/questions/1801598/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1444286731, "last_edit_date": 1444286731, "creation_date": 1444217575, "answer_id": 32991106, "question_id": 32990696, "link": "https://stackoverflow.com/questions/32990696/prompt-user-to-open-another-workbook/32991106#32991106", "title": "Prompt User to open another workbook", "body": "<pre><code>Function openMontlyReport() as Workbook\n   MsgBox \"Please select the monthly report in the next file dialog\"\n   With Application.FileDialog(msoFileDialogOpen)\n     .Title = \"Select Monthly Report\"\n     .Filters.Add \"Excel Files\", \"*.*\"\n     .AllowMultiSelect = False\n     If .Show Then Set openMontlyReport = Application.Workbooks.Open .SelectedItems(1)\n   End With\nEnd Function\n</code></pre>\n\n<p>Now you have at hand the monthly workbook that the user just opened.</p>\n"}], "owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1415, "favorite_count": 0, "accepted_answer_id": 32991106, "answer_count": 1, "score": 0, "last_activity_date": 1444286731, "creation_date": 1444216312, "last_edit_date": 1444270787, "question_id": 32990696, "link": "https://stackoverflow.com/questions/32990696/prompt-user-to-open-another-workbook", "title": "Prompt User to open another workbook", "body": "<p>I am writing a sub, where I need the user to open a specific workbook, because I need to copy data from the workbook that will be opened, to the workbook that is running the sub. \nSince the file that will be opened is a monthly report, it is difficult for the user to always save it in the same location with the same file name.\nTherefore it would be great if the user is asked to open the workbook (monthly report).</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1444216754, "post_id": 32990585, "comment_id": 53806011, "body": "I am getting on that line an error &#39;1004&#39; - ZOrder method of  Picture class failed."}, {"owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1444217989, "post_id": 32990585, "comment_id": 53806871, "body": "the code is working! But I dont know is it the right thing that I want. [link] (<a href=\"https://www.dropbox.com/s/taww6emaadrl663/send%20to%20back.jpg?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/taww6emaadrl663/send%20to%20back.jpg?dl=0</a>) I want just to text can be typed over the image. Is that possible? I&#39;ve heard that excel not support that as MS Word does? Thanks!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 1, "creation_date": 1444218054, "post_id": 32990585, "comment_id": 53806905, "body": "No, you can&#39;t put pictures behind cells. The closest you can do is to put a sheet background in, which will repeat one picture as required."}, {"owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1444218222, "post_id": 32990585, "comment_id": 53807023, "body": "Just one question more - Can I &quot;resize&quot; background, not to be streched across all sheet, just from cell e.g. C6:N20 ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1444218289, "post_id": 32990585, "comment_id": 53807074, "body": "Nope, afraid not. You could alter your image to include a lot of white space (it would still repeat but probably off screen) but that&#39;s it."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1444217474, "last_edit_date": 1444217474, "creation_date": 1444215958, "answer_id": 32990585, "question_id": 32990440, "link": "https://stackoverflow.com/questions/32990440/after-insertion-sendtoback-image/32990585#32990585", "title": "After insertion sendToBack image", "body": "<p><code>p</code> is a <code>Picture</code> so you can use <code>ZOrder</code> on it directly:</p>\n\n<pre><code>p.ZOrder msoSendToBack\n</code></pre>\n\n<p>Edit: my mistake. <code>Zorder</code> is a property for Pictures and is read-only. You need:</p>\n\n<pre><code>p.ShapeRange.ZOrder msoSendToBack\n</code></pre>\n"}], "owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444217474, "creation_date": 1444215484, "last_edit_date": 1592644375, "question_id": 32990440, "link": "https://stackoverflow.com/questions/32990440/after-insertion-sendtoback-image", "title": "After insertion sendToBack image", "body": "<p>I have a code that is working regarding insertion of a photo, but I can't send it to back.</p>\n<p>I've tried from <a href=\"https://stackoverflow.com/questions/12782065/excel-2007-image-doesnt-go-to-back\">this post</a> to copy line .ZOrder, but I am operating with object not shape..</p>\n<p>Here is mine code:</p>\n<pre><code>Private Sub CommandButton13_Click()\nDim p As Object\nDim rng0 As Range\nDim sh As Worksheet: Set sh = ActiveSheet\nSet rng0 = Range(&quot;Q3:S5&quot;)\nApplication.ScreenUpdating = False\nIf UserForm1.txtImage = &quot;&quot; Then\n\n\nrng0.Borders(xlEdgeBottom).LineStyle = xlContinuous\n\n \nExit Sub\nElse\nsh.Range(&quot;Q3:S5&quot;).Merge\nSet p = sh.Pictures.Insert(UserForm1.txtImageBackground)\nsh.Shapes(p.name).LockAspectRatio = False\n\nIf rng0.Cells.Count = 1 Then Set rng0 = rng0.MergeArea\nWith rng0\n    p.Top = .Top\n    p.Left = .Left\n    p.Width = .Width\n    p.Height = .Height\nEnd With\nApplication.ScreenUpdating = True\nEnd If\n\n\nSelection.ShapeRange.ZOrder msoSendToBack\nApplication.ScreenUpdating = True\n\n\n\n\n'        shp.ScaleHeight Factor:=1, RelativeToOriginalSize:=msoTrue\n'        shp.ScaleWidth Factor:=1, RelativeToOriginalSize:=msoTrue\n'        shp.ZOrder msoSendToBack\nEnd Sub\n</code></pre>\n<p>Thanks!</p>\n"}, {"tags": ["excel", "c#-4.0", "openxml-sdk", "vba"], "comments": [{"owner": {"reputation": 631, "user_id": 1947767, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91c1c9bff2e68a12e6d1c8317a7545fc?s=128&d=identicon&r=PG", "display_name": "DL Narasimhan", "link": "https://stackoverflow.com/users/1947767/dl-narasimhan"}, "edited": false, "score": 0, "creation_date": 1444216556, "post_id": 32989610, "comment_id": 53805882, "body": "do you want to get the background color or set it?"}, {"owner": {"reputation": 631, "user_id": 1947767, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91c1c9bff2e68a12e6d1c8317a7545fc?s=128&d=identicon&r=PG", "display_name": "DL Narasimhan", "link": "https://stackoverflow.com/users/1947767/dl-narasimhan"}, "edited": false, "score": 0, "creation_date": 1444216917, "post_id": 32989610, "comment_id": 53806121, "body": "then I think your question mark has to be in the LHS"}, {"owner": {"reputation": 229, "user_id": 4962191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BcZZs.jpg?s=128&g=1", "display_name": "Dev D", "link": "https://stackoverflow.com/users/4962191/dev-d"}, "reply_to_user": {"reputation": 631, "user_id": 1947767, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91c1c9bff2e68a12e6d1c8317a7545fc?s=128&d=identicon&r=PG", "display_name": "DL Narasimhan", "link": "https://stackoverflow.com/users/1947767/dl-narasimhan"}, "edited": false, "score": 0, "creation_date": 1444219403, "post_id": 32989610, "comment_id": 53807825, "body": "Do u know how to set it?"}, {"owner": {"reputation": 631, "user_id": 1947767, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91c1c9bff2e68a12e6d1c8317a7545fc?s=128&d=identicon&r=PG", "display_name": "DL Narasimhan", "link": "https://stackoverflow.com/users/1947767/dl-narasimhan"}, "edited": false, "score": 0, "creation_date": 1444220580, "post_id": 32989610, "comment_id": 53808674, "body": "for you to set the color into the PatternFill Class, You could try to get it from Color.FromArgb Method from the System.Drawing Namespace"}, {"owner": {"reputation": 4760, "user_id": 819019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiYfP.jpg?s=128&g=1", "display_name": "Taterhead", "link": "https://stackoverflow.com/users/819019/taterhead"}, "edited": false, "score": 0, "creation_date": 1474639822, "post_id": 32989610, "comment_id": 66627566, "body": "are you still trying to solve this?  Would getting the background color of any cell in an excel worksheet be acceptable?"}, {"owner": {"reputation": 5631, "user_id": 1487529, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/w6ior.jpg?s=128&g=1", "display_name": "Elmue", "link": "https://stackoverflow.com/users/1487529/elmue"}, "edited": false, "score": 0, "creation_date": 1495149458, "post_id": 32989610, "comment_id": 75143369, "body": "You find the solution here: <a href=\"http://stackoverflow.com/questions/10756206/getting-cell-backgroundcolor-in-excel-with-open-xml-2-0\" title=\"getting cell backgroundcolor in excel with open xml 2 0\">stackoverflow.com/questions/10756206/&hellip;</a>"}], "owner": {"reputation": 229, "user_id": 4962191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BcZZs.jpg?s=128&g=1", "display_name": "Dev D", "link": "https://stackoverflow.com/users/4962191/dev-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1672, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1444214626, "creation_date": 1444212910, "last_edit_date": 1531161705, "question_id": 32989610, "link": "https://stackoverflow.com/questions/32989610/how-to-get-cell-background-color-using-openxml-sdk-in-c", "title": "How to get Cell background color using OpenXML SDK in c#", "body": "<p>I want to get cell background color using OpenXML SDK in c#. Things I have done yet:</p>\n\n<pre><code>WorkbookStylesPart styles = document.WorkbookPart.WorkbookStylesPart;\nStylesheet stylesheet = styles.Stylesheet;\nCellFormats cellformats = stylesheet.CellFormats;\n//Fonts fonts = stylesheet.Fonts;\n\nCellFormat f = (CellFormat)cellformats.ElementAt((int)cell.StyleIndex.Value);\nFill fill = (Fill)styles.Stylesheet.Fills.ChildElements[(int)f.FillId.Value];\nfill.PatternFill.BackgroundColor = ???\n</code></pre>\n\n<p>what to put in RHS in above statement?</p>\n"}, {"tags": ["vba", "dictionary", "ontime"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444216184, "post_id": 32989591, "comment_id": 53805641, "body": "It is usually recommended to keep global variables to minimum use, but, why not try it: make the dictionary objects &#39;orderBookIndex&#39; and `contractIndex&#39; global variables?"}], "answers": [{"tags": [], "owner": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "is_accepted": false, "score": 0, "last_activity_date": 1444214388, "creation_date": 1444214388, "answer_id": 32990062, "question_id": 32989591, "link": "https://stackoverflow.com/questions/32989591/pass-a-dictionary-to-application-ontime/32990062#32990062", "title": "Pass a dictionary to Application.OnTime", "body": "<p>Try having the orderBookIndex and contractIndex as global variables instead like below and see if that works for you:</p>\n\n<pre><code>Public orderBookIndex As Scripting.Dictionary\nPublic contractIndex As Scripting.Dictionary\n\nPublic Sub mainSub()\n\nSet orderBookIndex = New Scripting.Dictionary\nSet contractIndex = New Scripting.Dictionary\n\nCall computeStuff(0, orderBookIndex, contractIndex)\n\nEnd Sub\nPublic Sub computeStuff(index As Integer, Optional orderBookIndex As Scripting.Dictionary, Optional contractIndex As Scripting.Dictionary)\n\n' Do stuff\n\nIf index = 0 Then\n    Set orderBookIndex = New Scripting.Dictionary\n    Set contractIndex = New Scripting.Dictionary\nEnd If\n\nIf index = 1 Then\n\n   Set orderBookIndex = New Scripting.Dictionary\n   Set contractIndex = New Scripting.Dictionary\n\n   orderBookIndex.Add \"a\", \"b\" ' add random stuff\n\n   contractIndex.Add \"c\", \"d\" ' add random stuff\n\nEnd If\n\nCall callLive(index, orderBookIndex, contractIndex)\n\nEnd Sub\n\nPublic Sub callLive(index As Integer, orderBookIndex As Scripting.Dictionary, contractIndex As Scripting.Dictionary)\n\nDim SchTime As Double\n\nSchTime = Now + TimeSerial(0, 0, 1)\nindex = index + 1\nApplication.OnTime SchTime, \"'computeStuff \" &amp; index &amp; \" , orderBookIndex, contractIndex'\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 2732174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107ea87d38ccf786a1334ba60f3cece?s=128&d=identicon&r=PG&f=1", "display_name": "ArtMgn", "link": "https://stackoverflow.com/users/2732174/artmgn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444215091, "creation_date": 1444212852, "last_edit_date": 1444215091, "question_id": 32989591, "link": "https://stackoverflow.com/questions/32989591/pass-a-dictionary-to-application-ontime", "title": "Pass a dictionary to Application.OnTime", "body": "<p>I would like to pass a Scripting.Dictionary object to Application.OnTime.\nThe problem is that I keep getting a 'Compile error : Argument not optional'.</p>\n\n<p>The structure of the code is the following :</p>\n\n<pre><code>Public Sub mainSub()\n\n    Dim orderBookIndex As New Scripting.Dictionary\n    Dim contractIndex As New Scripting.Dictionary\n\n    Call computeStuff(0, orderBookIndex, contractIndex)\n\nEnd Sub\n</code></pre>\n\n<p>mainSub calls computeStuff, then computeStuff calls 'callLive' to launch itself each second after having been incremented.</p>\n\n<pre><code>Public Sub computeStuff(index As Integer, Optional orderBookIndex As Scripting.Dictionary, Optional contractIndex As Scripting.Dictionary)\n\n    ' Do stuff\n\n    If index = 0 Then\n        Set orderBookIndex = New Scripting.Dictionary\n        Set contractIndex = New Scripting.Dictionary\n    End If\n\n    If index = 1 Then\n\n       Set orderBookIndex = New Scripting.Dictionary\n       Set contractIndex = New Scripting.Dictionary\n\n       orderBookIndex.add \"a\", \"b\" ' add random stuff\n\n       contractIndex.add \"c\", \"d\" ' add random stuff\n\n    End If\n\n    Call callLive(index, orderBookIndex, contractIndex)\n\nEnd Sub\n</code></pre>\n\n<p>Then callLive is called and refuses to compile :</p>\n\n<pre><code>Public Sub callLive(index As Integer, Optional orderBookIndex As Scripting.Dictionary, Optional contractIndex As Scripting.Dictionary)\n\n    Dim SchTime As Double\n\n    SchTime = Now + TimeSerial(0, 0, 1)\n    index = index + 1\n    Application.OnTime SchTime, \"'computeStuff \"\"\" &amp; index &amp; \"\"\" ,\"\"\" &amp; orderBookIndex &amp; \"\"\" ,\"\"\" &amp; contractIndex &amp; \"\"\"'\", , False\n\nEnd Sub\n</code></pre>\n\n<p>Any help or guidance to achieve this task (or solve this issue) will be highly appreciated.</p>\n"}, {"tags": ["vba", "excel", "date", "datetime"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444212100, "post_id": 32989239, "comment_id": 53803201, "body": "Have a look at the VBA <a href=\"https://msdn.microsoft.com/en-us/library/82yfs2zh%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">Weekday function</a> function."}, {"owner": {"reputation": 13, "user_id": 5417764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4eb3e423fcc35c017393c2b848f8386?s=128&d=identicon&r=PG&f=1", "display_name": "JP-J", "link": "https://stackoverflow.com/users/5417764/jp-j"}, "edited": false, "score": 0, "creation_date": 1444212945, "post_id": 32989239, "comment_id": 53803717, "body": "Cheers, I can see how this can be helpful in determining how many days to add on etc. Any ideas about cutting off the Time part though? Adding days will just add 24 hours to the current variable and keep the time will it not?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444214593, "post_id": 32989239, "comment_id": 53804708, "body": "The <a href=\"https://support.office.com/en-us/article/TRUNC-function-8B86A64C-3127-43DB-BA14-AA5CEB292721\" rel=\"nofollow noreferrer\">TRUNC</a>, <a href=\"https://support.office.com/en-us/article/ROUND-function-C018C5D8-40FB-4053-90B1-B3E7F61A213C\" rel=\"nofollow noreferrer\">ROUND</a>, <a href=\"https://support.office.com/en-us/article/ROUNDDOWN-function-2EC94C73-241F-4B01-8C6F-17E6D7968F53\" rel=\"nofollow noreferrer\">ROUNDDOWN</a>, <a href=\"https://support.office.com/en-us/article/FLOOR-function-14BB497C-24F2-4E04-B327-B0B4DE5A8886\" rel=\"nofollow noreferrer\">FLOOR</a> and/or <a href=\"https://support.office.com/en-us/article/INT-function-4D0598D4-FAC0-4ED3-BFBC-BE6DC8544183\" rel=\"nofollow noreferrer\">INT</a> worksheet functions come to mind."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444214801, "post_id": 32989239, "comment_id": 53804826, "body": "For VBA, there&#39;s the <code>Int(...)</code> function. Stay away from the <code>CLng</code> conversion as this can round up to the next day after noon."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444214401, "post_id": 32989865, "comment_id": 53804588, "body": "There is a worksheet <a href=\"https://support.office.com/en-us/article/Weekday-Function-05D360D7-2C3F-4691-9448-C96EA0351940\" rel=\"nofollow noreferrer\">WEEKDAY function</a> as well as a VBA <a href=\"https://msdn.microsoft.com/en-us/library/82yfs2zh%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">Weekday function</a>."}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "edited": false, "score": 0, "creation_date": 1444215060, "post_id": 32989865, "comment_id": 53804965, "body": "oh, yes. I didn&#39;t know that function. Then you can use <code>=WENN(WOCHENTAG(A1)=3;GANZZAHL(A1);GANZZAHL(A1+8-WOCHENTAG(A&zwnj;&#8203;1;12)))</code> (that&#39;s the german version. For English Excel it should be something like this: <code>=IF(WEEKDAY(A1)=3,INT(A1),INT(A1+8-WEEKDAY(A1,12)))</code>. )"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444216057, "post_id": 32989865, "comment_id": 53805571, "body": "There are a number of possibilities. <code>=A1+(8-WEEKDAY(A1,12))*(WEEKDAY(A1,12)&gt;1)</code> and <code>=A1+(7-MOD(B1-3, 7))*(MOD(B1, 7)&lt;&gt;3)</code> also work."}, {"owner": {"reputation": 13, "user_id": 5417764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4eb3e423fcc35c017393c2b848f8386?s=128&d=identicon&r=PG&f=1", "display_name": "JP-J", "link": "https://stackoverflow.com/users/5417764/jp-j"}, "edited": false, "score": 0, "creation_date": 1444226927, "post_id": 32989865, "comment_id": 53813619, "body": "Thanks a bunch jeeped. That formula was close but if I inputted a Tuesday date with a time, It seemed to treat it as a wednesday and bump the date to the following tuesday... BUT by playing with it, I got the following which works great now :)                                                                         =A1+(8-WEEKDAY(A1,12))*(WEEKDAY(A1,12)&gt;1)-MOD(A1+(8-WEEKDAY(&zwnj;&#8203;A1,12))*(WEEKDAY(A1,&zwnj;&#8203;12)&gt;1)-3,7)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 13, "user_id": 5417764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4eb3e423fcc35c017393c2b848f8386?s=128&d=identicon&r=PG&f=1", "display_name": "JP-J", "link": "https://stackoverflow.com/users/5417764/jp-j"}, "edited": false, "score": 0, "creation_date": 1444231357, "post_id": 32989865, "comment_id": 53817116, "body": "@JP-J If you want to use a worksheet formula, and the original is a &quot;real date&quot;, then merely:  <code>=INT(A1+7-WEEKDAY(A1-3))</code> should do what you want."}], "tags": [], "owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "is_accepted": true, "score": 0, "last_activity_date": 1444213783, "creation_date": 1444213783, "answer_id": 32989865, "question_id": 32989239, "link": "https://stackoverflow.com/questions/32989239/complex-date-manipulation/32989865#32989865", "title": "Complex date manipulation", "body": "<p>I tried to do solve this by the Excel function <code>TEXT</code>, but unlike the VBA function <code>Format</code>, it can't return the number of the current weekday. So the best solution seems to be using VBA.</p>\n\n<p>This function should solve your problem:</p>\n\n<pre><code>Public Function getTuesday(inputDate As Date)\nIf Format(inputDate, \"w\", vbTuesday) = 1 Then\n    getTuesday = CDate(Int(inputDate))\nElse\n    getTuesday = CDate(Int(inputDate) + 8 - Format(inputDate, \"w\", vbTuesday))\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1444225101, "creation_date": 1444225101, "answer_id": 32993729, "question_id": 32989239, "link": "https://stackoverflow.com/questions/32989239/complex-date-manipulation/32993729#32993729", "title": "Complex date manipulation", "body": "<p>I am not certain if your date string is a string or a \"real date\" merely formatted in Excel to what you show.  The following VBA function should handle both instances.</p>\n\n<p>The main part of the function is this line:</p>\n\n<pre><code>Tuesday = Dt + 7 - Weekday(Dt - 3)\n</code></pre>\n\n<p>where Dt is merely the relevant date, as a date only (no time).  This can also be used as a worksheet function.</p>\n\n<hr>\n\n<pre><code>Function Tuesday(ByVal Dt) As Date\n\n'not sure if date is a string or a \"real date\"\n'   so will test\n\nSelect Case VarType(Dt)\n    Case vbString\n        Dt = DateSerial(Mid(Dt, 7, 4), Mid(Dt, 4, 2), Left(Dt, 2))\n    Case vbDate\n        Dt = Int(Dt)\n    Case Else\n        MsgBox \"Date is unknown\"\n        Exit Function\nEnd Select\n\nTuesday = Dt + 7 - Weekday(Dt - 3)\n\nEnd Function\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 13, "user_id": 5417764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4eb3e423fcc35c017393c2b848f8386?s=128&d=identicon&r=PG&f=1", "display_name": "JP-J", "link": "https://stackoverflow.com/users/5417764/jp-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 32989865, "answer_count": 2, "score": 1, "last_activity_date": 1444271231, "creation_date": 1444211816, "last_edit_date": 1444271231, "question_id": 32989239, "link": "https://stackoverflow.com/questions/32989239/complex-date-manipulation", "title": "Complex date manipulation", "body": "<p>I currently have to manipulate a varying amount of dates every day (anywhere from 200 to 1Mil plus), which I currently do with a rather long-winded AHK script that uses the COM interface to read the dates, and write back the new ones. My script is fine for the smaller amounts (anything up to 5,000) but due to the inherently slow nature of COM it takes a looong time to process the large quantities. </p>\n\n<p>I've had some success in other tasks where using VBA or even a nested if-statement has provided me with much faster results, but my VBA knowledge is rather lacking.</p>\n\n<p><strong>My Goal:</strong></p>\n\n<p>To check a date that's currently in the format <code>dd/mm/yyyy ss/mm/hh</code>, for example <code>22/09/2015 45:12:23</code> and perform one of the following two tasks:</p>\n\n<ul>\n<li><p>If the input date is a Tuesday like in the example above to change the cell to just <code>22/09/2015</code> (cutting off the time section)</p></li>\n<li><p>If the input date is any other day of the week, it needs to be changed to the date of the following Tuesday (still cutting off the time section). For example, if the input date is <code>23/09/2015</code> or <code>25/09/2015</code>, it would need to be changed to <code>29/09/2015</code>.</p></li>\n</ul>\n\n<p>I can make it loop through the column, but in VBA, that's about the extent of my skills.</p>\n\n<p><strong>Answer</strong></p>\n\n<p>Thanks to all of you for the speedy answers. I've managed to tweak one offered below to get something that suits my situation now. End result was (A1 being the input date):  </p>\n\n<pre><code>=A1+(8-WEEKDAY(A1,12))*(WEEKDAY(A1,12)&gt;1)-MOD(A1+(8-WEEKDAY(A1,12))*(WEEKDAY(A1,12)&gt;1)-3,7)\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "ribbon"], "answers": [{"tags": [], "owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "is_accepted": false, "score": 1, "last_activity_date": 1444212704, "creation_date": 1444212704, "answer_id": 32989549, "question_id": 32988202, "link": "https://stackoverflow.com/questions/32988202/word-2010-how-do-i-attach-a-ribbon-button-to-a-template-using-vba/32989549#32989549", "title": "Word 2010: How do I attach a ribbon button to a template using VBA", "body": "<ol>\n<li><p>Create a macro-enabled template file (with the .dotm extension).</p></li>\n<li><p>Add the XML for the ribbon button you want to the template with the <a href=\"http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2009/08/06/7293.aspx\" rel=\"nofollow\">Custom UI Editor</a> and assign a callback function:</p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\" &gt;\n    &lt;ribbon startFromScratch=\"false\" &gt;\n        &lt;tabs&gt;\n            &lt;tab id=\"myTab1\" label=\"Tab #1\"&gt;\n                &lt;group id=\"myGrp1\" label=\"Group #1\"&gt;\n                    &lt;button id=\"myBtn1\" label=\"Button #1\" imageMso=\"HappyFace\" size=\"large\" onAction=\"Callback\" /&gt;\n                &lt;/group&gt;\n            &lt;/tab&gt;\n        &lt;/tabs&gt;\n    &lt;/ribbon&gt;\n&lt;/customUI&gt;\n</code></pre></li>\n<li><p>Add the code for the callback function in the template file:</p>\n\n<pre><code>Option Explicit\n\n'Callback for button onAction\nSub Callback(control As IRibbonControl)\n    MsgBox \"Gentlemen, we have a macro!\"\nEnd Sub\n</code></pre></li>\n<li><p>Create a new document based on the template.</p></li>\n</ol>\n\n<p>You should have access to the button and macro even if the template file is not opened.</p>\n"}], "owner": {"reputation": 31, "user_id": 4507832, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0ff188d8f80b688dc4500f7b04ec0f9?s=128&d=identicon&r=PG&f=1", "display_name": "HelenT", "link": "https://stackoverflow.com/users/4507832/helent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2074, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444836835, "creation_date": 1444208983, "last_edit_date": 1444836835, "question_id": 32988202, "link": "https://stackoverflow.com/questions/32988202/word-2010-how-do-i-attach-a-ribbon-button-to-a-template-using-vba", "title": "Word 2010: How do I attach a ribbon button to a template using VBA", "body": "<p>I want to assign a macro to a custom ribbon button on Word 2010 BUT ONLY FOR A PARTICULAR TEMPLATE FILE so that the button only appears when that template has been attached to the file I'm working on.</p>\n\n<p>There will be about 30 users using this over the network in my office, so the idea is that storing the button on the template file will allow the button to be portable to other users without me having to manually install it on each user's PC.</p>\n"}, {"tags": ["excel", "powerpivot", "vba"], "comments": [{"owner": {"reputation": 7713, "user_id": 970616, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ef63109e6e0a0122eece9e5059024e5?s=128&d=identicon&r=PG", "display_name": "Xavjer", "link": "https://stackoverflow.com/users/970616/xavjer"}, "edited": false, "score": 0, "creation_date": 1444209123, "post_id": 32988114, "comment_id": 53801150, "body": "Could it be that Powerpivot does not recognize . as a decimal separator?, did you try to replace a .(dot) with a ,(comma) to see if it would work then and if so do a mass replace before transfering the data"}, {"owner": {"reputation": 33, "user_id": 5011757, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4tC6TkTVhHY/AAAAAAAAAAI/AAAAAAAAAOI/KrYwAZTO7_I/photo.jpg?sz=128", "display_name": "Charlotte", "link": "https://stackoverflow.com/users/5011757/charlotte"}, "reply_to_user": {"reputation": 7713, "user_id": 970616, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ef63109e6e0a0122eece9e5059024e5?s=128&d=identicon&r=PG", "display_name": "Xavjer", "link": "https://stackoverflow.com/users/970616/xavjer"}, "edited": false, "score": 0, "creation_date": 1444209408, "post_id": 32988114, "comment_id": 53801367, "body": "I did try that. I replaced the . with a , before copying the data, but it would paste the data as text instead of numbers. If I manually create a new column in the powerpivot that I assign the value: <code>=[Revenue]&#47;10</code> it returns numbers that use a period/dot (.) as a separator, so the dot is the right separator."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444213623, "post_id": 32988114, "comment_id": 53804122, "body": "What are the language settings for Power Pivot?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1444214253, "post_id": 32988114, "comment_id": 53804494, "body": "Why don&#39;t you use a DB server instead such as <a href=\"http://dev.mysql.com/downloads/windows/\" rel=\"nofollow noreferrer\">MySQL</a>, <a href=\"https://www.microsoft.com/en-gb/download/details.aspx?id=42299\" rel=\"nofollow noreferrer\">MS SQL</a>, <a href=\"http://downloads.teradata.com/download/database\" rel=\"nofollow noreferrer\">Teradata</a>, or any other free DB server. All of them can easily cope with several million rows. Transferring data to and from Excel is quite easy with ADO and VBA. Just do a <a href=\"https://www.google.co.uk/#q=excel+vba+ado+update+sql\" rel=\"nofollow noreferrer\">Google search</a>."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1444215255, "post_id": 32988114, "comment_id": 53805074, "body": "As far as I can tell there is no row limit in Office 365. There is merely a file size limit for Office 365 which you will probably (depending on how many columns you have) hit before exceeding any row limits: <a href=\"https://support.office.com/en-gb/article/Data-Model-specification-and-limits-19aa79f8-e6e8-45a8-9be2-b58778fd68ef?CorrelationId=05df35c5-30d5-447f-82dd-40f72f84e482&amp;ui=en-US&amp;rs=en-GB&amp;ad=GB\" rel=\"nofollow noreferrer\">support.office.com/en-gb/article/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 5011757, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4tC6TkTVhHY/AAAAAAAAAAI/AAAAAAAAAOI/KrYwAZTO7_I/photo.jpg?sz=128", "display_name": "Charlotte", "link": "https://stackoverflow.com/users/5011757/charlotte"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1444216302, "post_id": 32988114, "comment_id": 53805713, "body": "@Ralph I have tested and there is a row limit. I cannot have more than 1,048,576 rows.   I cannot run free databases, because I am using a work computer and don&#39;t have administrator rights. I have tried in the past to get this, but I wasn&#39;t granted permission. In the long run, the data will be entered in a data cube, but it is currently not the top priority of our Business Intelligence department."}, {"owner": {"reputation": 33, "user_id": 5011757, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4tC6TkTVhHY/AAAAAAAAAAI/AAAAAAAAAOI/KrYwAZTO7_I/photo.jpg?sz=128", "display_name": "Charlotte", "link": "https://stackoverflow.com/users/5011757/charlotte"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444216526, "post_id": 32988114, "comment_id": 53805858, "body": "@Rory: The language settings for Powerpivot are as follows: <code>Language Options: Match Excel Language, Current Language: English (United States), Model Language: Dutch (Netherlands)</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444217230, "post_id": 32988114, "comment_id": 53806364, "body": "I think that last one is the cause of your problems. Does your computer have its Regional settings (not just keyboard) set to Dutch, or US, locale?"}, {"owner": {"reputation": 33, "user_id": 5011757, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4tC6TkTVhHY/AAAAAAAAAAI/AAAAAAAAAOI/KrYwAZTO7_I/photo.jpg?sz=128", "display_name": "Charlotte", "link": "https://stackoverflow.com/users/5011757/charlotte"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444225670, "post_id": 32988114, "comment_id": 53812635, "body": "@Rory I went to language and region setting. I changed format from Dutch (in the additional settings I had specified the dot as a decimal separator) to English (United Stated). I set the current location to the US instead of NL. And I changed keyboard settings from <code>Dutch (United States International)</code> to <code>English (United States International)</code>. Somehow, one of these changes solved the problem. It&#39;s weird that this is the first time Excel made a problem out of this. Still, it works now. Thanks for the help!"}, {"owner": {"reputation": 3513, "user_id": 4382919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvBse.jpg?s=128&g=1", "display_name": "greggyb", "link": "https://stackoverflow.com/users/4382919/greggyb"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1447087685, "post_id": 32988114, "comment_id": 55002242, "body": "@Ralph, the linked article is discussing limitations on the amount of data in the Excel Data Model, which is an alternate name for Power Pivot. The number of rows in a worksheet page is still limited to ~1M."}], "answers": [{"tags": [], "owner": {"reputation": 24, "user_id": 2863283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f74036e1d729720b2d24fd411a10135?s=128&d=identicon&r=PG&f=1", "display_name": "26itha", "link": "https://stackoverflow.com/users/2863283/26itha"}, "is_accepted": false, "score": -1, "last_activity_date": 1450447251, "creation_date": 1450447251, "answer_id": 34357387, "question_id": 32988114, "link": "https://stackoverflow.com/questions/32988114/when-copying-data-to-excel-powerpivot-the-decimal-separators-disappear/34357387#34357387", "title": "When copying data to Excel Powerpivot, the decimal separators disappear", "body": "<p>Go to control panel, click on <strong>Region</strong>, go to <strong>Additional settings</strong> and change your digit grouping and decimal symbol.</p>\n"}], "owner": {"reputation": 33, "user_id": 5011757, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4tC6TkTVhHY/AAAAAAAAAAI/AAAAAAAAAOI/KrYwAZTO7_I/photo.jpg?sz=128", "display_name": "Charlotte", "link": "https://stackoverflow.com/users/5011757/charlotte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1402, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450447251, "creation_date": 1444208752, "last_edit_date": 1531161705, "question_id": 32988114, "link": "https://stackoverflow.com/questions/32988114/when-copying-data-to-excel-powerpivot-the-decimal-separators-disappear", "title": "When copying data to Excel Powerpivot, the decimal separators disappear", "body": "<p>I am using Microsoft Office 2013, version 15.0.4753.1003 (it's on my work computer) and I have a problem with Excel. I have a large dataset in an Excel worksheet with sales data that I manually update every month. However, I am almost at the limit of the sheet (a little over 1 million rows). </p>\n\n<p>That is why I have decided to copy the data to Powerpivot, since that tool does not have row limits. I have copied the data to the powerpivot in chunks of 100.000 rows, using Paste and Paste Append. That works fine, except that my decimal seperator vanishes in thin air.</p>\n\n<p>This is a very simplified version of what the data looks like:</p>\n\n<pre><code>Product  |   Revenue\nCamera   |   299.99\nBattery  |   30.00\n</code></pre>\n\n<p>After copying the data to powerpivot it looks like this:</p>\n\n<pre><code>Product  |   Revenue\nCamera   |   29999\nBattery  |   30\n</code></pre>\n\n<p>Something goes wrong with the decimal seperator. My keyboard settings are set on Unites Stated, so a period is the right seperator. I have tried replacing the period by a comma, but then it pastes the data as text instead of numbers. I am, however, in the Netherlands, so officially we use comma seperators. However, since I use many csv reports that use commas as delimiters, I have switched to US settings. </p>\n\n<p>What am I doing wrong with the powerpivot? I don't think it's the location settings, because it does see that <code>30.00</code> is 30 and not 3000. Is this a bug in Excel?</p>\n\n<p>Thanks in advance for thinking along!</p>\n\n<p>PS. I know using an actual database serverwould be better, but I don't have the resources to do that in the near future and I just need a quick fix for this specific problem. </p>\n\n<p>PPS. I don't know VBA, so if the solution requires this, I would need very specific instructions. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444210864, "post_id": 32988043, "comment_id": 53802376, "body": "What do you want to happen if one of them fails the test? Just ignore that value, or not write any values, or something else?"}], "answers": [{"tags": [], "owner": {"reputation": 514, "user_id": 1897196, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18422e7406729d5832fe8ae725fddfed?s=128&d=identicon&r=PG", "display_name": "Donald", "link": "https://stackoverflow.com/users/1897196/donald"}, "is_accepted": true, "score": 1, "last_activity_date": 1444211832, "last_edit_date": 1444211832, "creation_date": 1444209783, "answer_id": 32988526, "question_id": 32988043, "link": "https://stackoverflow.com/questions/32988043/check-if-isnumeric-using-me-controls/32988526#32988526", "title": "check if IsNumeric using Me.Controls()", "body": "<p>You could attach dynamically an event handler on form load or you could create a custom control with an event.\nPersonally I prefer use custom control and KeyPressEventHandler to refuse all not allowed chars.</p>\n\n<p>You may create a class to handle the event :</p>\n\n<pre><code>Private WithEvents m_oTextBox as TextBox\n\nPublic Property Set TextBox(ByVal oTextBox as TextBox)\nSet m_oTextBox = oTextBox\nEnd Property\n\nPrivate Sub m_oTextBox_Change()\n' Do something\nEnd Sub\n</code></pre>\n\n<p>then, for each control:</p>\n\n<pre><code>Dim myEventHandler As TextBoxEventHandler\n        Set myEventHandler = New TextBoxEventHandler\n\n        Set myEventHandler.TextBox = oControl\n\n        m_oCollectionOfEventHandlers.Add myEventHandler \n</code></pre>\n"}], "owner": {"reputation": 3510, "user_id": 969400, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23a0c8dd29dc3a5975d5acb4cff362c2?s=128&d=identicon&r=PG", "display_name": "Nicero", "link": "https://stackoverflow.com/users/969400/nicero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 1, "accepted_answer_id": 32988526, "answer_count": 1, "score": 0, "last_activity_date": 1444211832, "creation_date": 1444208567, "last_edit_date": 1531164843, "question_id": 32988043, "link": "https://stackoverflow.com/questions/32988043/check-if-isnumeric-using-me-controls", "title": "check if IsNumeric using Me.Controls()", "body": "<p>I have a userform with dozens of text boxes where the user should input only numbers from 1 to 6. When the form is completed the user clicks Save and the numbers are added to an Excel table.</p>\n\n<p>As the text boxes are quite a lot I used the following code to read their value:</p>\n\n<pre><code>' Text boxes name are: txt_a01, txt_a02, txt_a03...\nFor i = 1 To 5\n    ws.Cells(iRow, i).Value = Me.Controls(\"txt_a0\" &amp; i).Value\nNext\n\n' Here text boxes name are: txt_b01, txt_b02, txt_b03...\nFor i = 6 To 10\n    ws.Cells(iRow, i).Value = Me.Controls(\"txt_b0\" &amp; i - 5).Value\nNext\n\netc.\n</code></pre>\n\n<p>rather than write dozens of times:</p>\n\n<pre><code>ws.Cells(iRow, 1).Value = Me.txt_a01.Value\nws.Cells(iRow, 2).Value = Me.txt_a02.Value\nws.Cells(iRow, 3).Value = Me.txt_a03.Value\nws.Cells(iRow, 4).Value = Me.txt_a04.Value\nws.Cells(iRow, 5).Value = Me.txt_a05.Value\n</code></pre>\n\n<p>Now I would like to check - during input - if the user has really added a number and if its between 1 and 6. Normally I would do it like this:</p>\n\n<pre><code>Private Sub txt_a01_AfterUpdate()\n    If Not IsNumeric(txt_a01.Value) Then\n        MsgBox (\"Only numbers accepted\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>But as I use a FOR - LOOP and Me.Controls() to read the text box values I don't understand how to write down the _AfterUpdate Sub.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1444208971, "post_id": 32987928, "comment_id": 53801055, "body": "Of course the data will still be there after saving, why wouldn&#39;t it? Is this a bound or unbound form?"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1444211730, "post_id": 32987928, "comment_id": 53802960, "body": "I suspect you are quite new to access and may benefit from this resource: <a href=\"https://www.youtube.com/channel/UCHt5Fz7cYrQIIw4EyXkkqPQ\" rel=\"nofollow noreferrer\">youtube.com/channel/UCHt5Fz7cYrQIIw4EyXkkqPQ</a>"}, {"owner": {"reputation": 61, "user_id": 1790175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652af69fca4ff96b322522b2932703b7?s=128&d=identicon&r=PG", "display_name": "makoz", "link": "https://stackoverflow.com/users/1790175/makoz"}, "edited": false, "score": 0, "creation_date": 1444214673, "post_id": 32987928, "comment_id": 53804756, "body": "thanks Harvey..currently i am using access 2007,i hope  2013 will help myself"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 5, "last_activity_date": 1444211720, "creation_date": 1444211720, "answer_id": 32989205, "question_id": 32987928, "link": "https://stackoverflow.com/questions/32987928/clear-all-fields-after-hit-the-save-button/32989205#32989205", "title": "Clear All fields after Hit the Save button", "body": "<p>Go to a new record:</p>\n\n<pre><code>DoCmd.GoToRecord , , acNewRec \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 1790175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652af69fca4ff96b322522b2932703b7?s=128&d=identicon&r=PG", "display_name": "makoz", "link": "https://stackoverflow.com/users/1790175/makoz"}, "edited": false, "score": 0, "creation_date": 1444302294, "post_id": 33006504, "comment_id": 53851059, "body": "thanks Emi..it works for all fields for me except on Date of Birth fields i got an error..."}, {"owner": {"reputation": 61, "user_id": 1790175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652af69fca4ff96b322522b2932703b7?s=128&d=identicon&r=PG", "display_name": "makoz", "link": "https://stackoverflow.com/users/1790175/makoz"}, "edited": false, "score": 0, "creation_date": 1444368758, "post_id": 33006504, "comment_id": 53883184, "body": "my Date of Birth look like this &#39;Me.DOB.Value = &quot;&quot; which same to all fields but when i save the form it pointing to this fields as an error. the error shown as <b>Run time errror 3314: You must enter a value in the tblename.DOB fields</b>"}, {"owner": {"reputation": 474, "user_id": 5060720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/56fc8ec996b9fe62716185a2ba353693?s=128&d=identicon&r=PG&f=1", "display_name": "Emi", "link": "https://stackoverflow.com/users/5060720/emi"}, "reply_to_user": {"reputation": 61, "user_id": 1790175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652af69fca4ff96b322522b2932703b7?s=128&d=identicon&r=PG", "display_name": "makoz", "link": "https://stackoverflow.com/users/1790175/makoz"}, "edited": false, "score": 0, "creation_date": 1444381315, "post_id": 33006504, "comment_id": 53889599, "body": "Is the field&#39;s required property set to true? And where are you writing the code Me.DOB.Value = Null? Write it after your code for saving the values in the text boxes to the table."}], "tags": [], "owner": {"reputation": 474, "user_id": 5060720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/56fc8ec996b9fe62716185a2ba353693?s=128&d=identicon&r=PG&f=1", "display_name": "Emi", "link": "https://stackoverflow.com/users/5060720/emi"}, "is_accepted": false, "score": 2, "last_activity_date": 1444277733, "creation_date": 1444277733, "answer_id": 33006504, "question_id": 32987928, "link": "https://stackoverflow.com/questions/32987928/clear-all-fields-after-hit-the-save-button/33006504#33006504", "title": "Clear All fields after Hit the Save button", "body": "<p>May be you would like to add the following in the click on save button event before \"End Sub\"</p>\n\n<pre><code>Me.TextboxName.Value = Null\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 4879840, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zd1__CsMTwc/AAAAAAAAAAI/AAAAAAAAE3I/XAHkzR-KAbs/photo.jpg?sz=128", "display_name": "Vladislav Andreev", "link": "https://stackoverflow.com/users/4879840/vladislav-andreev"}, "is_accepted": false, "score": 1, "last_activity_date": 1444351487, "creation_date": 1444351487, "answer_id": 33028184, "question_id": 32987928, "link": "https://stackoverflow.com/questions/32987928/clear-all-fields-after-hit-the-save-button/33028184#33028184", "title": "Clear All fields after Hit the Save button", "body": "<p>Try this routine linked to a button you want to click to clear all textboxes in an unbound form:</p>\n\n<pre><code>Private Sub CleanAllFieldsButton_Click()\nDim ctl As Control\nFor Each ctl In Me.Controls\n    If ctl.ControlType = acTextBox Then ctl = Null\nNext\nSet ctl = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "is_accepted": false, "score": 0, "last_activity_date": 1553270556, "creation_date": 1553270556, "answer_id": 55303574, "question_id": 32987928, "link": "https://stackoverflow.com/questions/32987928/clear-all-fields-after-hit-the-save-button/55303574#55303574", "title": "Clear All fields after Hit the Save button", "body": "<pre><code>Private Sub Command47_Click()\nOn Error Resume Next\nMe.Dirty = False 'Attempt to save the record\nIf Err.Number = 0 Then\n'Only enter a new record, leaving other newly-added record accessible\nDoCmd.GoToRecord , , acNewRec\nElse MsgBox Err.DESCRIPTION, vbCritical, \"Error\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Try this is in your save records click event.</p>\n"}], "owner": {"reputation": 61, "user_id": 1790175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652af69fca4ff96b322522b2932703b7?s=128&d=identicon&r=PG", "display_name": "makoz", "link": "https://stackoverflow.com/users/1790175/makoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27376, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1553270556, "creation_date": 1444208201, "question_id": 32987928, "link": "https://stackoverflow.com/questions/32987928/clear-all-fields-after-hit-the-save-button", "title": "Clear All fields after Hit the Save button", "body": "<p>I  have working on forms, after i filled all the fields  and Click on Save button, all fields have been saved but the text fields was not empty, all entered text still present, How do removed those text after hit on the save button</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 546, "user_id": 2819134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73c576016b3a8fb462b71b87ffc4648?s=128&d=identicon&r=PG&f=1", "display_name": "Raugmor", "link": "https://stackoverflow.com/users/2819134/raugmor"}, "edited": false, "score": 0, "creation_date": 1444207684, "post_id": 32987569, "comment_id": 53800135, "body": "actually other way around... <code>Dim i, id as Integer</code> will dim <code>i</code> as <code>Variant</code> and <code>id</code> as <code>Integer</code>"}], "tags": [], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "is_accepted": false, "score": 0, "last_activity_date": 1444207222, "creation_date": 1444207222, "answer_id": 32987569, "question_id": 32987484, "link": "https://stackoverflow.com/questions/32987484/the-way-to-declare-variables/32987569#32987569", "title": "The way to declare variables", "body": "<p>When you Dim more than one variable in a line separated by a comma </p>\n\n<p>e.g.</p>\n\n<pre><code>Dim i, id as Integer\n</code></pre>\n\n<p>..only the first variable (<code>i</code>)  will be dimensioned correctly. The second variable (<code>id</code>) will be a variant.</p>\n"}, {"tags": [], "owner": {"reputation": 23769, "user_id": 98422, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/fGGLP.jpg?s=128&g=1", "display_name": "Gary McGill", "link": "https://stackoverflow.com/users/98422/gary-mcgill"}, "is_accepted": false, "score": 0, "last_activity_date": 1444207687, "last_edit_date": 1525816189, "creation_date": 1444207687, "answer_id": 32987732, "question_id": 32987484, "link": "https://stackoverflow.com/questions/32987484/the-way-to-declare-variables/32987732#32987732", "title": "The way to declare variables", "body": "<p>See <a href=\"http://www.cpearson.com/excel/declaringvariables.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/declaringvariables.aspx</a> (especially the section \"Pay Attention To Variables Declared With One Dim Statement\") for a good discussion of how variables are declared. In your case, only <code>id</code> will have an explicit type (<code>Integer</code>). Variable <code>i</code> will be of the default type, <code>Variant</code>.</p>\n\n<p>Note that this differs from VB.NET, where both variables would have <code>Integer</code> type.</p>\n"}], "owner": {"reputation": 1, "user_id": 5414498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d44c814c7bac782f9507405e8271546?s=128&d=identicon&r=PG&f=1", "display_name": "frugo", "link": "https://stackoverflow.com/users/5414498/frugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1444208770, "answer_count": 2, "score": 0, "last_activity_date": 1444208118, "creation_date": 1444206941, "last_edit_date": 1531164843, "question_id": 32987484, "link": "https://stackoverflow.com/questions/32987484/the-way-to-declare-variables", "closed_reason": "Duplicate", "title": "The way to declare variables", "body": "<p>I have a problem in vba.</p>\n\n<p>Here is the <strong>Code:</strong></p>\n\n<pre><code>Sub GetData()\nIf IsNumeric(UserForm1.TextBox1.Value) Then\nflag = False\ni = 0\nid = UserForm1.TextBox1.Value\nDo While Cells(i + 1, 1).Value &lt;&gt; \"\"\n\n    If Cells(i + 1, 1).Value = id Then\n        flag = True\n        For j = 2 To 3\n            UserForm1.Controls(\"TextBox\" &amp; j).Value = Cells(i + 1, j).Value\n        Next j\n    End If\n\n    i = i + 1\n\nLoop\n\nIf flag = False Then\n    For j = 2 To 3\n        UserForm1.Controls(\"TextBox\" &amp; j).Value = \"\"\n    Next j\nEnd If\n\nElse\nClearForm\nEnd If\nEnd Sub\n</code></pre>\n\n<p>My problem is with first If statement. It only works when i declare variables like:</p>\n\n<pre><code>Dim id As Integer\nDim i As Integer\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Dim i, id As Integer\n</code></pre>\n\n<p>But it <strong>doesn't</strong> work when i declare them like:</p>\n\n<pre><code>Dim id, i As Integer\n</code></pre>\n\n<p>It acts like when condition is false.</p>\n\n<p>What is the difference?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444192855, "post_id": 32983854, "comment_id": 53792929, "body": "&quot; loop through the third column of each row &quot;, would that be the same as looping through Column &quot;C&quot;?"}, {"owner": {"reputation": 1, "user_id": 5360177, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001541686552119/picture?type=large", "display_name": "Kevin Spring", "link": "https://stackoverflow.com/users/5360177/kevin-spring"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444192991, "post_id": 32983854, "comment_id": 53792979, "body": "yes, looping through column c of &quot;QuoteTable&quot; I&#39;m not sure if it&#39;s best to refer to it as &quot;C&quot; or &quot;Model #&quot; I had a macro that worked fine when it was in a range, but would shade empty rows after the last used row, so I decided to use a table instead of a range, and now have to re-write the macro as it no longer works properly"}], "answers": [{"comments": [{"owner": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "edited": false, "score": 0, "creation_date": 1444195836, "post_id": 32984366, "comment_id": 53793936, "body": "like your use of Application.Trim but would it work if the value is &quot;123     abc      &quot; instead?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "edited": false, "score": 0, "creation_date": 1444196858, "post_id": 32984366, "comment_id": 53794308, "body": "The VBA <a href=\"https://msdn.microsoft.com/en-us/library/h9wz3dez%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">Trim function</a> removes leading/trailing spaces but the worksheet&#39;s <a href=\"https://support.office.com/en-us/article/TRIM-function-410388FA-C5DF-49C6-B16C-9E5630B479F9\" rel=\"nofollow noreferrer\">TRIM function</a> removes leading/trailing spaces as well as inline double spaces. Of course, you could just try it and report back."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1444195260, "creation_date": 1444195260, "answer_id": 32984366, "question_id": 32983854, "link": "https://stackoverflow.com/questions/32983854/loop-through-table-shading-empty-rows-and-deleting-spaces-in-occupied-cells/32984366#32984366", "title": "Loop through table, shading empty rows and deleting spaces in occupied cells", "body": "<p>VBA coding for a structured table can be a pain. You can either deal with the table as a <a href=\"https://msdn.microsoft.com/en-us/library/office/aa174247(v=office.11).aspx\" rel=\"nofollow noreferrer\">ListObject object</a> or <code>Set</code> a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range object</a> variable to the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa214261%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">.DataBodyRange property</a> and deal with the cell addresses as you would with any other worksheet reference.</p>\n\n<pre><code>Sub fix_model_no()\n    Dim mn As Range\n\n    With Worksheets(\"Sheet1\")    '&lt;~~ set this properly!\n        With .ListObjects(\"QuoteTable\")\n            For Each mn In Range(\"QuoteTable[Model '#]\")\n                If Len(Trim(mn.Value2)) Then\n                    Intersect(.DataBodyRange, Rows(mn.Row)).Interior.ColorIndex = xlColorIndexNone\n                    mn = Replace(Application.Trim(mn.Value2), Chr(32), Chr(35))\n                Else\n                    mn.ClearContents\n                    Intersect(.DataBodyRange, Rows(mn.Row)).Interior.ColorIndex = 3  'red\n                End If\n            Next mn\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>The single tick in <code>QuoteTable[Model '#]</code> is necessary to reference the <code>Model #</code> column. Any reference to a ListObject table likes to know which worksheet the table resides on.</p>\n\n<p>You may wish to consider Conditional Formatting for the row highlighting based upon the blank cells in column C.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/rIlJ0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rIlJ0.png\" alt=\"Table VBA Code ListObject\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": -1, "last_activity_date": 1444195260, "creation_date": 1444195260, "answer_id": 32984367, "question_id": 32983854, "link": "https://stackoverflow.com/questions/32983854/loop-through-table-shading-empty-rows-and-deleting-spaces-in-occupied-cells/32984367#32984367", "title": "Loop through table, shading empty rows and deleting spaces in occupied cells", "body": "<p>Change \"Z\" to whatever column you require</p>\n\n<pre><code>Sub Oh_Ya()\n    Dim sh As Worksheet\n    Dim rng As Range, c As Range\n    Dim rws As Long, r\n\n    Set sh = Sheets(\"Quote\")\n    With sh\n        rws = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Set rng = .Range(\"C2:C\" &amp; rws)\n        For Each c In rng.Cells\n            c = Replace(c, \" \", \"#\")\n            If c = \"\" Then\n                r = c.Row\n                Range(\"A\" &amp; r &amp; \":Z\" &amp; r).Interior.Color = RGB(255, 248, 220)\n            End If\n        Next c\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5360177, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001541686552119/picture?type=large", "display_name": "Kevin Spring", "link": "https://stackoverflow.com/users/5360177/kevin-spring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1444196896, "creation_date": 1444192268, "last_edit_date": 1444196896, "question_id": 32983854, "link": "https://stackoverflow.com/questions/32983854/loop-through-table-shading-empty-rows-and-deleting-spaces-in-occupied-cells", "title": "Loop through table, shading empty rows and deleting spaces in occupied cells", "body": "<p>I'm looking for a way to loop through the third column of each row of a table.\nIf that cell is blank, it should shade the entire row \nIf that cell is occupied, it should look for any spaces and replace all spaces with a single <code>#</code> (for example <code>123    abc</code> becomes <code>123#abc</code>).\nIt should not run on the header row of the table.</p>\n\n<p>Some random items-<br>\nthe worksheet name is <code>Quote</code><br>\ntable name is <code>QuoteTable</code><br>\nshading should be RGB(255, 248, 220)<br>\nThe number of rows in the table will always vary, but the macro will always be checking the contents of the third column of the table which is named <code>Model #</code>.</p>\n\n<p>Thanks for the responses, I will try each one, and in the meantime I came up with this--- which does everything except it highlights every single row from A-N not just the correct ones.</p>\n\n<pre><code>Public Sub ValidateSKUs()\nDim sMfrPN As String\nDim tbl1 As Range\nDim myCell As Range\nSet tbl1 = Sheets(\"Quote\").Range(\"QuoteTable\")\n    For Each myCell In tbl1.Columns(3).Cells\n    If myCell.Value = \"\" Then\n            Sheets(\"Quote\").Range(\"A\" &amp; myCell &amp; \":N\" &amp; myCell).Interior.Color = RGB(255, 248, 220)\n            Sheets(\"Quote\").Range(\"A\" &amp; myCell &amp; \":N\" &amp; myCell).Interior.Pattern = xlSolid\n    Else\n        sMfrPN = CleanUpPN(myCell)\n            myCell = sMfrPN\n    End If\n    Next\n\nEnd Sub\n\nPublic Function CleanUpPN(ByVal sMfrPN As String) As String\nDim sPN As String\n'Trim trailing spaces\nsPN = Trim(sMfrPN)\n'Replace space with #\nsPN = Replace(sPN, \" \", \"#\")\n'remove multiple # (e.g. ##)\nDo Until InStr(1, sPN, \"##\") = 0\n    sPN = Replace(sPN, \"##\", \"#\")\nLoop\nCleanUpPN = sPN\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "object", "paste"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5319870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-a6r6fG_3CmQ/AAAAAAAAAAI/AAAAAAAAAJI/c_6KZR7CCJg/photo.jpg?sz=128", "display_name": "IlhamideaZ", "link": "https://stackoverflow.com/users/5319870/ilhamideaz"}, "edited": false, "score": 0, "creation_date": 1444194374, "post_id": 32983598, "comment_id": 53793446, "body": "Thanks! It does remove the error but I dont know how to paste the value to my first-opened Workbook. Is it my coding (as above) correct?"}], "tags": [], "owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "is_accepted": true, "score": 0, "last_activity_date": 1444190515, "creation_date": 1444190515, "answer_id": 32983598, "question_id": 32983395, "link": "https://stackoverflow.com/questions/32983395/copy-data-from-one-workbook-to-another-object-required/32983598#32983598", "title": "Copy data from one workbook to another &quot;Object Required&quot;", "body": "<p>The issue is that <code>rngCopy</code> is of type range and you can't set it equal to a method (copy). Remove the <code>.Copy</code> and you should be fine. You also don't need to set the worksheet out range to a variable. You could just do one line that says <code>WBookCopy.SheetName.Range(\"A:AA\").Copy</code>and then another line to paste.</p>\n"}, {"comments": [{"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "edited": false, "score": 0, "creation_date": 1444233861, "post_id": 32991945, "comment_id": 53819015, "body": "The answer from @paul answers your question about how to paste the data. Feel free to mark whichever answer is appropriate"}, {"owner": {"reputation": 103, "user_id": 5319870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-a6r6fG_3CmQ/AAAAAAAAAAI/AAAAAAAAAJI/c_6KZR7CCJg/photo.jpg?sz=128", "display_name": "IlhamideaZ", "link": "https://stackoverflow.com/users/5319870/ilhamideaz"}, "reply_to_user": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "edited": false, "score": 0, "creation_date": 1444263643, "post_id": 32991945, "comment_id": 53833883, "body": "@wyatt did solve the error! And thanks Paul for helping! :)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1444220137, "creation_date": 1444220137, "answer_id": 32991945, "question_id": 32983395, "link": "https://stackoverflow.com/questions/32983395/copy-data-from-one-workbook-to-another-object-required/32991945#32991945", "title": "Copy data from one workbook to another &quot;Object Required&quot;", "body": "<p>As @Wyatt mentioned - your copy\\paste syntax is incorrect</p>\n\n<p>Here are 2 ways to do it:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"A:AA\").Copy\nWorksheets(\"Sheet2\").Range(\"A1\").PasteSpecial xlPasteAll\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"A:AA\").Copy Destination:=Worksheets(\"Sheet2\").Range(\"A1\")\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 5319870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-a6r6fG_3CmQ/AAAAAAAAAAI/AAAAAAAAAJI/c_6KZR7CCJg/photo.jpg?sz=128", "display_name": "IlhamideaZ", "link": "https://stackoverflow.com/users/5319870/ilhamideaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "accepted_answer_id": 32983598, "answer_count": 2, "score": 0, "last_activity_date": 1444220137, "creation_date": 1444189054, "last_edit_date": 1444189252, "question_id": 32983395, "link": "https://stackoverflow.com/questions/32983395/copy-data-from-one-workbook-to-another-object-required", "title": "Copy data from one workbook to another &quot;Object Required&quot;", "body": "<p>I'm currently doing VBA project which need to copy from a workbook to another, which the <code>WBookPst</code> is the workbook I firstly open (use) meanwhile <code>WBookCopy</code> is the workbook where I open based on the links where I got by listing all \".xslt\" format in a File into my Sheet1 of my first workbook. Here is my code :</p>\n\n<pre><code>Sub SortFiles()\n    'Set up your variables and turn off screen updating.\n    'Dim iCounter As Integer\n     Application.ScreenUpdating = False\n\n    'Sort the rows based on the data in column C\n    Columns(\"A:C\").Sort key1:=Range(\"C2\"), _\n    order1:=xlDescending, Header:=xlYes\n\n    Application.ScreenUpdating = True\n\n    Dim WBookCopy As Workbook\n    Dim WBookPst As Workbook\n    Dim filePath As String\n    Dim sheetName As String\n    Dim sheetCopy As Worksheet\n    Dim sheetPate As Worksheet\n    Dim rngCopy As Range\n    Dim rngPst As Range\n\n    filePath = Range(\"B2\").Value\n    Set WBookCopy = Workbooks.Open(filePath)\n\n    Columns(30).Insert\n    For i = 1 To Sheets.count\n        Cells(i, 30) = Sheets(i).Name\n    Next i\n\n    sheetName = Range(\"AD1\").Value\n    Set sheetCopy = WBookCopy.Worksheets(sheetName)\n    Set rngCopy = sheetCopy.Range(\"A:AA\").Copy\n\n    Set WBookPst = ThisWorkbook\n    Set sheetPaste = WBookPst.Worksheets(\"Sheet1\").Activate\n    Set rngCopy = sheetPaste.Range(\"A:AA\").Select\n    ActiveSheet.Paste\n\nEnd Sub \n</code></pre>\n\n<p>At <code>Set rngCopy = sheetCopy.Range(\"A:AA\").Copy</code> there's error \"Objects required\".  </p>\n\n<p>What does that mean?<br>\nBy the way, is how I copy and paste the data between sheets correct?</p>\n"}, {"tags": ["html", "excel", "vba", "getelementbyid", "innertext"], "comments": [{"owner": {"reputation": 55, "user_id": 2943382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjemO.jpg?s=128&g=1", "display_name": "lasoon", "link": "https://stackoverflow.com/users/2943382/lasoon"}, "edited": false, "score": 0, "creation_date": 1444185048, "post_id": 32982686, "comment_id": 53790887, "body": "That doesn&#39;t solve the problem unfortunately. I still get the same &quot;Object doesn&#39;t support this property or method&quot; error."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 2943382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjemO.jpg?s=128&g=1", "display_name": "lasoon", "link": "https://stackoverflow.com/users/2943382/lasoon"}, "edited": false, "score": 0, "creation_date": 1444185576, "post_id": 32982845, "comment_id": 53791042, "body": "That worked great! Thanks so much for your help. Do you know of a good way in which I can learn about extracting data from the Internet using VBA? So far, I have been using google to find code that has already been written and trying to adapt that to suit my needs. However, that leads to problems because I do not really know what is going on. Is there a primer or book that covers the topic of extracting data from Internet using VBA?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 55, "user_id": 2943382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjemO.jpg?s=128&g=1", "display_name": "lasoon", "link": "https://stackoverflow.com/users/2943382/lasoon"}, "edited": false, "score": 0, "creation_date": 1444186199, "post_id": 32982845, "comment_id": 53791182, "body": "Sorry but I don&#39;t know of any off the top of my head. There are tons of good code examples here that cover a wide range of situations. Keep in mind that sooner or later you will want to graduate to xmlHTTP objects and throw the Internet.Explorer object away."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1444186273, "last_edit_date": 1444186273, "creation_date": 1444185016, "answer_id": 32982845, "question_id": 32982686, "link": "https://stackoverflow.com/questions/32982686/cant-get-specific-data-point-to-pull-from-yahoo-finance-into-excel/32982845#32982845", "title": "Can&#39;t get specific data-point to pull from Yahoo Finance into Excel?", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/ff975198(v=vs.85).aspx\" rel=\"nofollow\">getElementsByClassName method</a> returns a <strong>collection</strong> of one or more objects. You need to supply the index (i.e. <em>position</em>) of the element in the collection. Try,</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"A3\") = .getElementsByClass(\"time_rtq_ticker\")(0).getElementById(\"yfs_184_aapl\").innerText\n</code></pre>\n\n<p>In fact, the <code>yfs_184_aapl</code> id is unique on that page. You only need,</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"A3\") = .getElementById(\"yfs_184_aapl\").innerText\n</code></pre>\n\n<p>Note that the <a href=\"https://msdn.microsoft.com/en-us/library/ms536437%28v=vs.85%29.aspx\" rel=\"nofollow\">getElementById method</a> is singular, not <code>getElementsById</code>.</p>\n"}], "owner": {"reputation": 55, "user_id": 2943382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjemO.jpg?s=128&g=1", "display_name": "lasoon", "link": "https://stackoverflow.com/users/2943382/lasoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 1, "accepted_answer_id": 32982845, "answer_count": 1, "score": 1, "last_activity_date": 1444186273, "creation_date": 1444183877, "last_edit_date": 1444186145, "question_id": 32982686, "link": "https://stackoverflow.com/questions/32982686/cant-get-specific-data-point-to-pull-from-yahoo-finance-into-excel", "title": "Can&#39;t get specific data-point to pull from Yahoo Finance into Excel?", "body": "<p>I am trying to pull a very specific number from the Yahoo Finance page but am getting stuck. The link where I am trying to pull this information from is:</p>\n\n<blockquote>\n  <p><a href=\"http://finance.yahoo.com/q/hp?s=AAPL+Historical+Prices\" rel=\"nofollow\">http://finance.yahoo.com/q/hp?s=AAPL+Historical+Prices</a></p>\n</blockquote>\n\n<p>I am interested in getting the <strong>111.31</strong> number that is listed near the top of that page in bold. I have written the following code to extract this information but every time I run it, it says \"Object doesn't support this property or method\". I suspect the error lies in the line where I use <code>getElementsByClass</code> and <code>getElementsById</code> to extract that data.</p>\n\n<pre><code>    Sub GetQuote()\n    Dim IE As Object\n\n     Set IE = CreateObject(\"InternetExplorer.Application\")\n\n     With IE\n        .Visible = True\n        .navigate \"http://finance.yahoo.com/q/hp?s=AAPL+Historical+Prices\"\n        Do While .busy: DoEvents: Loop\n        Do While .ReadyState &lt;&gt; 4: DoEvents: Loop\n        With .document\n            Application.Wait (Now + #12:00:05 AM#)\n            Sheets(\"Sheet1\").Range(\"A3\") = .getElementsByClass(\"time_rtq_ticker\").getElementsById(\"yfs_184_aapl\").innerText\n\n        End With\n\n    End With\n\n    Set IE = Nothing\n    End Sub\n</code></pre>\n\n<p>Can you all please take a look and let me know where I went wrong and how I can fix this? </p>\n"}, {"tags": ["excel", "vba", "loops", "find"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1444191324, "post_id": 32982505, "comment_id": 53792476, "body": "I may be going blind (your indentation does not help either) but I can&#39;t seem to find a <code>Next</code> for the end of your loop"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444196533, "post_id": 32982505, "comment_id": 53794183, "body": "why all the error checking, selecting and activating?"}], "answers": [{"tags": [], "owner": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "is_accepted": false, "score": 0, "last_activity_date": 1444192232, "creation_date": 1444192232, "answer_id": 32983849, "question_id": 32982505, "link": "https://stackoverflow.com/questions/32982505/problems-with-a-myrange-loop-continuing-to-process-beyond-the-end-of-the-range/32983849#32983849", "title": "Problems with a &#39;myrange&#39; loop continuing to process beyond the end of the range", "body": "<p>Do you know that your code will run ErrorHandlerMyCell at the end irregardless of whether there's an error or not? It's not a separate module that is called only when there's error but part of the main program which gets triggered. Perhaps you can add a Exit Sub before ErrorHandlerMyCell</p>\n\n<pre><code>Exit Sub\nErrorHandlerMyCell:\nResume NextCode1\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1444254997, "creation_date": 1444254997, "answer_id": 33003081, "question_id": 32982505, "link": "https://stackoverflow.com/questions/32982505/problems-with-a-myrange-loop-continuing-to-process-beyond-the-end-of-the-range/33003081#33003081", "title": "Problems with a &#39;myrange&#39; loop continuing to process beyond the end of the range", "body": "<p>The code have plenty of redundancies and it seems to be overwriting records copied in <code>Row 3</code> when cell <code>A2</code> in <code>wbProjectJournal</code> is empty.</p>\n\n<p>I also suggest to set the worksheets as <code>objects</code> instead of the workbooks. Actually the code ends up working with whatever is the active sheet in the workbooks after they are activated. It could be working now if there is only one sheet or if the one active is the one required, but it\u2019s just a coincidence, not a good practice. </p>\n\n<p>One point to highlight is the excessive and incorrect use of what is intended to act as <code>Error Handlers</code> <em>(see this page <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251688.aspx\" rel=\"nofollow\">On Error Statement</a> for a better understanding)</em>, also to improve use of objects see this <em><a href=\"https://msdn.microsoft.com/en-us/library/office/gg264723(v=office.15).aspx\" rel=\"nofollow\">With Statement</a></em></p>\n\n<p>The code below should solve the issue, <em>(have inserted comments to explain the changes)</em>:</p>\n\n<pre><code>Option Explicit\n\nSub TEST_Solution()\nDim wbProjects As Workbook, wbGL As Workbook, wbProjectJournal As Workbook\nDim rTrg As Range, rCll As Range, rCllTrg As Range\nDim rFnd As Range, vWhat As Variant\n\n    Set wbProjects = Workbooks(\"Expense Project Jobs.xlsx\")\n    Set wbGL = Workbooks(\"GL.xml\")\n    Set wbProjectJournal = Workbooks(\"Expense Project Journal.xlsx\")\n    wbProjects.Activate\n\n    Rem Set Range from wbProjects\\Project_Costs\\Column F\n    'use [With] to perform several statements on the same object\n    'see https://msdn.microsoft.com/en-us/library/office/gg264723(v=office.15).aspx\n    With wbProjects.Sheets(\"Project_Costs\").Columns(6)\n        Set rTrg = Range(.Cells(2), .Cells(Rows.Count).End(xlUp))\n    End With\n\n    Rem Search for the value of each cell in the no-empty cells of\n    For Each rCll In rTrg\n\n        Rem Set &amp; Validate cell value\n        vWhat = rCll.Value2\n        If vWhat &lt;&gt; Empty Then\n\n            Rem Activate range to apply the FIND method\n            'Replace [1] with the name of the worksheet where the search is run\n            With wbGL.Sheets(1)\n                .Application.Goto .Cells(1), 1\n\n                Rem Set cell with found value\n                Set rFnd = .Cells.Find(What:=vWhat, After:=ActiveCell, _\n                    LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\n                If Not (rFnd Is Nothing) Then\n\n                    Rem Activate range to apply the FIND method\n                    'Replace [1] with the name of the worksheet where the search is performed\n                    With wbProjectJournal.Sheets(1).Cells(2, 1)\n                        If .Value2 = Empty Then\n                            Rem A2 = Blank then Paste in row 2 only\n                            rFnd.EntireRow.Copy\n                            .PasteSpecial\n                            Application.CutCopyMode = False\n\n                        ElseIf .Offset(1).Value2 = Empty Then\n                            Rem A3 = Blank then Paste in row 3 &amp; delete record found\n                            rFnd.EntireRow.Copy\n                            .Offset(1).PasteSpecial\n                            Application.CutCopyMode = False\n                            rFnd.EntireRow.Delete\n\n                        Else\n                            Rem Paste below last row &amp; delete record found\n                            rFnd.EntireRow.Copy\n                            .End(xlDown).Offset(1).PasteSpecial\n                            Application.CutCopyMode = False\n                            rFnd.EntireRow.Delete\n\n        End If: End With: End If: End With: End If: Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 5416380, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/52861a17076d915bdb4d2915cc4e6ec9?s=128&d=identicon&r=PG&f=1", "display_name": "JDT", "link": "https://stackoverflow.com/users/5416380/jdt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1444254997, "creation_date": 1444182653, "last_edit_date": 1444182939, "question_id": 32982505, "link": "https://stackoverflow.com/questions/32982505/problems-with-a-myrange-loop-continuing-to-process-beyond-the-end-of-the-range", "title": "Problems with a &#39;myrange&#39; loop continuing to process beyond the end of the range", "body": "<p>I am having problems with a macro which should search for each <code>mycell</code> of <code>myrange</code> in turn and copy it to another sheet if it is found in the GL sheet. However it continues to run after the cells in <code>myrange</code> (i.e. it continues to run on all the blank rows under <code>myrange</code>). <code>myrange</code> is just 10 rows of data.  Here is the code:</p>\n\n<pre><code>Dim myrange As Range\nDim mycell As Range\n\n   Set wbProjects = Workbooks(\"Expense Project Jobs.xlsx\")\n   Set wbGL = Workbooks(\"GL.xml\")\n   Set wbProjectJournal = Workbooks(\"Expense Project Journal.xlsx\")\n\nwbProjects.Activate\nLastrowJob1 = Sheets(\"Project_Costs\").Range(\"F\" &amp; Rows.Count).End(xlUp).Row\nSet myrange = Range(\"F2:F\" &amp; LastrowJob1)\n\n'LOOP START\n\nFor Each mycell In myrange\nIf mycell = \"\" Then\nGoTo ErrorHandlerMyCell\nEnd If\n\nmycell.Copy\nwbGL.Activate\n\nOn Error GoTo ErrorHandlerMyCell\n\nRange(\"A1\").Activate\nCells.Find(What:=mycell, After:=ActiveCell, LookIn:=xlValues, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).Activate\n\n   On Error GoTo 0\n\n    ActiveCell.EntireRow.Cut\n    wbProjectJournal.Activate\n    Range(\"A1\").Activate\n    If Range(\"A2\") &lt;&gt; \"\" Then\n    GoTo NextCode2\n\nNextCode2:\n     Selection.End(xlDown).Select\n    ActiveCell.Offset(1, 0).Select\n    Activesheet.Paste\n    wbGL.Activate\n    ActiveCell.EntireRow.Delete\n\n    Else\n    Range(\"A2\").Select\n    Activesheet.Paste\n\n    End If\n\nNextCode1:\n    Next mycell\n\nErrorHandlerMyCell:\n    Resume NextCode1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "unpivot"], "answers": [{"comments": [{"owner": {"reputation": 2232, "user_id": 1467996, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3ea656ac527946ec790dd0d92a1450c?s=128&d=identicon&r=PG", "display_name": "AAA", "link": "https://stackoverflow.com/users/1467996/aaa"}, "edited": false, "score": 1, "creation_date": 1444251381, "post_id": 32983314, "comment_id": 53829442, "body": "This does it! Thank you for the very detailed response!"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1444252699, "post_id": 32983314, "comment_id": 53830072, "body": "@pnuts if <i>this</i> is more or less a copy of <i>that</i> then shouldn&#39;t this be closed as a duplicate?"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 2, "last_activity_date": 1444188851, "last_edit_date": 1444188851, "creation_date": 1444188516, "answer_id": 32983314, "question_id": 32982294, "link": "https://stackoverflow.com/questions/32982294/macro-or-method-to-pivot-data-in-excel/32983314#32983314", "title": "Macro or method to pivot data in Excel?", "body": "<p>Assumes labels/data is in Sheet1 starting A1. </p>\n\n<ol>\n<li><p>Insert a new ColumnA.</p></li>\n<li><p>For Excel 2003: Activate any cell in your summary table and choose Data - PivotTable and PivotChart Report:</p>\n\n<p><img src=\"https://i.stack.imgur.com/JEIMk.gif\" alt=\"SO20541905 first example\"></p></li>\n<li><p>For later versions access the Wizard with <kbd>Alt</kbd>+<kbd>D</kbd>, P:</p></li>\n<li><p>Select <em>Multiple consolidation ranges</em> and <em>PivotTable</em> and click <kbd>Next ></kbd>.</p>\n\n<p><img src=\"https://i.stack.imgur.com/cDWJB.gif\" alt=\"SO20541905 second example\"> </p></li>\n<li><p>In \u201cStep 2a of 3\u201d, choose <em>I will create the page fields</em> and click <kbd>Next ></kbd>.  </p>\n\n<p><img src=\"https://i.stack.imgur.com/GNIfN.gif\" alt=\"SO20541905 third example\"></p></li>\n<li><p>In \u201cStep 2b of 3\u201d (not shown in the modal!) specify your summary table range in the <strong>Range:</strong> field (A2:E6 for the sample data) and click <kbd>Add</kbd>, then <kbd>Next ></kbd>.</p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/YHNMQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YHNMQ.jpg\" alt=\"SO32982294 fourth example\"></a>  </p>\n\n<ol start=\"7\">\n<li>In \u201cStep 3 of 3\u201d, select a location for the PivotTable (the existing sheet should serve, as the PT is only required temporarily):  </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/VMqYV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VMqYV.jpg\" alt=\"SO32982294 fifth example\"></a>  </p>\n\n<ol start=\"8\">\n<li>Click <kbd>Finish</kbd> to create the PivotTable:  </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/m5UOp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m5UOp.jpg\" alt=\"SO32982294 sixth example\"></a>  </p>\n\n<ol start=\"9\">\n<li>Drill down (ie double-click) on the intersect of the Grand Totals (here Cell L4 or <code>16</code>):  </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/H1gMM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H1gMM.jpg\" alt=\"SO32982294 seventh example\"></a>  </p>\n\n<ol start=\"10\">\n<li><p>The PT may now be deleted.  </p></li>\n<li><p>In A2 of Table:  </p>\n\n<p><code>=\"Summary\"&amp;RIGHT(B2)</code>  </p></li>\n<li><p>Convert the resulting Table into a conventional array of cells by selecting <strong>Table</strong> in the Quick Menu (right-click in the Table) and <strong>Convert to Range</strong>. </p></li>\n<li><p>In a spare column starting in Row2 series fill integers down, from <code>1</code> to however many rows of data you started with (<code>4</code>, in the example). Then series fill that series to suit.  </p></li>\n<li><p>Sort sheet by that (spare) column, Smallest to Largest, with <em>My data has headers</em> checked.  </p></li>\n<li><p>Delete Row1 and spare column and hopefully you will end up with:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/SoJpS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SoJpS.jpg\" alt=\"SO32982294 eighth example\"></a></p></li>\n</ol>\n"}], "owner": {"reputation": 2232, "user_id": 1467996, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3ea656ac527946ec790dd0d92a1450c?s=128&d=identicon&r=PG", "display_name": "AAA", "link": "https://stackoverflow.com/users/1467996/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 32983314, "answer_count": 1, "score": 2, "last_activity_date": 1444252260, "creation_date": 1444181005, "last_edit_date": 1444252260, "question_id": 32982294, "link": "https://stackoverflow.com/questions/32982294/macro-or-method-to-pivot-data-in-excel", "title": "Macro or method to pivot data in Excel?", "body": "<p>I am looking for a way to dynamically pivot data in an Excel sheet to put the data in a universal format no matter how wide the data set is.</p>\n\n<p>For example: I want to be able to take a spreadsheet that could have 5 columns, 30 columns, or x number of columns to make it pivot to a universal format that is only three columns wide.</p>\n\n<p>Here is a sample of how the original data could look:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1wie4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1wie4.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want it to look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LkBET.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LkBET.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there a way to do it, either by macro or using any other Excel functions?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 89, "user_id": 2292941, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a17e06c5878603b7b7e9567769e64ebb?s=128&d=identicon&r=PG", "display_name": "user2292941", "link": "https://stackoverflow.com/users/2292941/user2292941"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1444182429, "post_id": 32982213, "comment_id": 53790275, "body": "At some point, I&#39;ll need to build reporting functionality into the databse to identify which users have viewed which materials by a given date(as there will be numerous powerpoints that this functionality will need to be incorporated into."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2292941, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a17e06c5878603b7b7e9567769e64ebb?s=128&d=identicon&r=PG", "display_name": "user2292941", "link": "https://stackoverflow.com/users/2292941/user2292941"}, "edited": false, "score": 0, "creation_date": 1444183863, "post_id": 32982450, "comment_id": 53790612, "body": "I&#39;m getting a runtime error 429 activex component can&#39;t create object...might have something to do with windows 10 and regsvr32 dao360.dll ? At any rate, I appreciate your input and I&#39;ll give it a shot on another system in the meantime."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "reply_to_user": {"reputation": 89, "user_id": 2292941, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a17e06c5878603b7b7e9567769e64ebb?s=128&d=identicon&r=PG", "display_name": "user2292941", "link": "https://stackoverflow.com/users/2292941/user2292941"}, "edited": false, "score": 1, "creation_date": 1444191870, "post_id": 32982450, "comment_id": 53792650, "body": "Ok, let me know how it goes. I&#39;m not yet familiar with win10. Is it this line where the error stops you: <code>Set con = CreateObject(&quot;ADODB.connection&quot;)</code> ?"}, {"owner": {"reputation": 89, "user_id": 2292941, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a17e06c5878603b7b7e9567769e64ebb?s=128&d=identicon&r=PG", "display_name": "user2292941", "link": "https://stackoverflow.com/users/2292941/user2292941"}, "edited": false, "score": 0, "creation_date": 1444254789, "post_id": 32982450, "comment_id": 53831052, "body": "Based on what you provided, I was able to get it working! Thanks again for the direction! I learned something!"}], "tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": true, "score": 2, "last_activity_date": 1444182270, "creation_date": 1444182270, "answer_id": 32982450, "question_id": 32982213, "link": "https://stackoverflow.com/questions/32982213/how-can-i-use-vba-to-insert-a-new-record-into-an-access-2007-database/32982450#32982450", "title": "How can I use VBA to insert a new record into an Access 2007 database?", "body": "<p>I tested this on Office 2013, hope it would work for you too. These lines open connection, insert new entries and close the connection.</p>\n\n<pre><code>Dim Path As String\nDim strCon As String\nDim con As Object\n\nPath = \"C:\\TestDatabase.accdb\"\nstrCon = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; Path\nSet con = CreateObject(\"ADODB.connection\")\n\ncon.Open strCon\ncon.Execute \"INSERT INTO Table1 (Field1, Field2) VALUES (\"\"\" &amp; empUserName &amp; \"\"\", \"\"\" &amp; Completed &amp; \"\"\")\"\n\ncon.Close\nSet con = Nothing\n</code></pre>\n\n<p>Table1 - your table name<br>\nField1 - name of the column where you want to put <code>empUserName</code><br>\nField2 - name of the column where you want to put <code>Completed</code></p>\n"}, {"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1444194807, "creation_date": 1444194807, "answer_id": 32984267, "question_id": 32982213, "link": "https://stackoverflow.com/questions/32982213/how-can-i-use-vba-to-insert-a-new-record-into-an-access-2007-database/32984267#32984267", "title": "How can I use VBA to insert a new record into an Access 2007 database?", "body": "<p>It can be done by one command:</p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO C:\\TestDatabase.accdb.Table1 ( Field1, Field2 ) VALUES (\"\"\" &amp; empUserName &amp; \"\"\", \"\"\" &amp; Completed &amp; \"\"\");\"\n</code></pre>\n\n<p>You can add</p>\n\n<pre><code>DoCmd.SetWarnings False\n</code></pre>\n\n<p>before inserting in order to suppress warning.</p>\n"}], "owner": {"reputation": 89, "user_id": 2292941, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a17e06c5878603b7b7e9567769e64ebb?s=128&d=identicon&r=PG", "display_name": "user2292941", "link": "https://stackoverflow.com/users/2292941/user2292941"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 32982450, "answer_count": 2, "score": 2, "last_activity_date": 1594651673, "creation_date": 1444180378, "last_edit_date": 1594651673, "question_id": 32982213, "link": "https://stackoverflow.com/questions/32982213/how-can-i-use-vba-to-insert-a-new-record-into-an-access-2007-database", "title": "How can I use VBA to insert a new record into an Access 2007 database?", "body": "<p>I am still trying to learn, so please be gentle.\nMy goal is to track users who've completed viewing a standalone MS PowerPoint by having them click a button on the last slide.</p>\n\n<p>When the completeButton is clicked, it captures the Windows username and date. How can I have the event also insert both the variables as a new record into an existing MS Access 2007 database (behind the scenes)?</p>\n\n<pre><code>'Click button\nPrivate Sub completeButton_Click()\n'Get Windows user\nDim empUserName As String\nempUserName = Environ(\"UserName\")\n'Get Date\nDim Completed As Date\nCompleted = Date\n'Set Path to database\nDim Path As String\nPath = \"C:\\TestDatabase.accdb\"\n\n'Open connection to database\n'Insert empUserName and Completed variables as new record\n'Close connection to database\n'Display message\nMsgbox(\"Thank you for viewing the material\")\n'Close presentation\nWith Application.Presentations\nFor i = .Count To 1 Step -1\n    .Item(i).Close\nNext\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "email", "outlook", "gal"], "answers": [{"comments": [{"owner": {"reputation": 388, "user_id": 5416229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/860076956b11e5862e0a521af20f4722?s=128&d=identicon&r=PG&f=1", "display_name": "MWsan", "link": "https://stackoverflow.com/users/5416229/mwsan"}, "edited": false, "score": 0, "creation_date": 1444237787, "post_id": 32984191, "comment_id": 53821433, "body": "Yes. You right. Using &quot;oContact.AddressEntryUserType = 0 or oContact.AddressEntryUserType = 5&quot; it returned the same previous result  + another 7k contacts. Including e-mails out of my domain. But I still see some addresses in the GAL inside the Outlook and they&#39;re not being returned in the sheet using that code."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 0, "last_activity_date": 1444259733, "last_edit_date": 1444259733, "creation_date": 1444194414, "answer_id": 32984191, "question_id": 32981976, "link": "https://stackoverflow.com/questions/32981976/copying-global-address-list-contacts-including-external-contacts/32984191#32984191", "title": "Copying Global Address List contacts including &quot;External Contacts&quot;", "body": "<p>According to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868214(v=office.14).aspx\" rel=\"nofollow\">this documentation</a>, the <code>oContact.AddressEntryUserType</code> value should include <code>olExchangeRemoteUserAddressEntry</code> (5) for External Users.</p>\n\n<p>What's in your code is just to list Exchange Users, so it also skips mail-enabled PublicFolders, Distribution Lists, etc.\n<hr>\n<strong>EDIT</strong><br>\nFound a better way to extract name and email address (if any):<br>\nReference: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868695.aspx\" rel=\"nofollow\">Obtain the E-mail Address of a Recipient</a><br></p>\n\n<pre><code>Option Explicit\n\nSub tgr()\n    Const PR_SMTP_ADDRESS = \"http://schemas.microsoft.com/mapi/proptag/0x39FE001E\"\n    Dim appOL As Object\n    Dim oGAL As Object\n    Dim arrUsers() As String\n    Dim UserIndex As Long\n    Dim i As Long\n    Dim sEmail As String\n\n    Set appOL = GetObject(, \"Outlook.Application\")\n    If appOL Is Nothing Then Set appOL = CreateObject(\"Outlook.Application\")\n\n    Set oGAL = appOL.GetNameSpace(\"MAPI\").AddressLists(\"Global Address List\").AddressEntries\n    Debug.Print oGAL.Parent.Name &amp; \" has \" &amp; oGAL.Count &amp; \" entries\"\n    ReDim arrUsers(1 To oGAL.Count, 1 To 2)\n    On Error Resume Next\n    For i = 1 To oGAL.Count\n        With oGAL.Item(i)\n            Application.StatusBar = \"Processing GAL entry #\" &amp; i &amp; \" (\" &amp; .Name &amp; \")\"\n            sEmail = \"\" ' Not all entries has email address\n            sEmail = .PropertyAccessor.GetProperty(PR_SMTP_ADDRESS)\n            If Len(sEmail) = 0 Then Debug.Print \"No Email address configured for \" &amp; .Name &amp; \" (#\" &amp; i &amp; \")\"\n            UserIndex = UserIndex + 1\n            arrUsers(UserIndex, 1) = .Name\n            arrUsers(UserIndex, 2) = sEmail\n        End With\n    Next\n    On Error GoTo 0\n    Application.StatusBar = False\n    appOL.Quit\n\n    If UserIndex &gt; 0 Then\n        Range(\"A2\").Resize(UserIndex, UBound(arrUsers, 2)).Value = arrUsers\n    End If\n\n    Set appOL = Nothing\n    Set oGAL = Nothing\n    Erase arrUsers\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 388, "user_id": 5416229, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/860076956b11e5862e0a521af20f4722?s=128&d=identicon&r=PG&f=1", "display_name": "MWsan", "link": "https://stackoverflow.com/users/5416229/mwsan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 2, "accepted_answer_id": 32984191, "answer_count": 1, "score": 3, "last_activity_date": 1444259733, "creation_date": 1444178614, "last_edit_date": 1444187070, "question_id": 32981976, "link": "https://stackoverflow.com/questions/32981976/copying-global-address-list-contacts-including-external-contacts", "title": "Copying Global Address List contacts including &quot;External Contacts&quot;", "body": "<p>I have a VBA code to get whole Global Address List from Outlook 2013 and place the values <code>Name</code> and <code>E-mail Address</code> in an Excel sheet. </p>\n\n<p>The problem is it's only returning e-mails/users from my SMTP (I guess).</p>\n\n<p><a href=\"https://i.stack.imgur.com/YtPOm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YtPOm.jpg\" alt=\"http://i.stack.imgur.com/YtPOm.jpg\"></a>  </p>\n\n<p>In this image, we can see the users from the SMTP as mine covered in black and an external user covered in red. My code:</p>\n\n<pre><code>Sub tgr()\n\n    Dim appOL As Object\n    Dim oGAL As Object\n    Dim oContact As Object\n    Dim oUser As Object\n    Dim arrUsers(1 To 75000, 1 To 2) As String\n    Dim UserIndex As Long\n    Dim i As Long\n\n    Set appOL = CreateObject(\"Outlook.Application\")\n\n    Set oGAL = appOL.GetNameSpace(\"MAPI\").AddressLists(\"Global Address List\").AddressEntries\n\n    For i = 1 To oGAL.Count\n        Set oContact = oGAL.Item(i)\n        If oContact.AddressEntryUserType = 0 Then\n            Set oUser = oContact.GetExchangeUser\n            If Len(oUser.lastname) &gt; 0 Then\n                UserIndex = UserIndex + 1\n                arrUsers(UserIndex, 1) = oUser.Name\n                arrUsers(UserIndex, 2) = oUser.PrimarySMTPAddress\n            End If\n        End If\n    Next i\n\n    appOL.Quit\n\n    If UserIndex &gt; 0 Then\n        Range(\"A2\").Resize(UserIndex, UBound(arrUsers, 2)).Value = arrUsers\n    End If\n\n    Set appOL = Nothing\n    Set oGAL = Nothing\n    Set oContact = Nothing\n    Set oUser = Nothing\n    Erase arrUsers\n\nEnd Sub\n</code></pre>\n\n<p>So, am I doing something wrong?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1444200950, "post_id": 32981839, "comment_id": 53796130, "body": "Have you tried to replace <code>Me.Dirty = False</code> to <code>DoCmd.RunCommand acCmdSaveRecord</code>? I never got it work to change the Dirty-Attribute by myself in code. There was always an error. But it should work according to the web. BTW <code>DoCmd.Save acForm, formName</code> should save the form design, not the recordset."}, {"owner": {"reputation": 3502, "user_id": 1378888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/ECGgg.jpg?s=128&g=1", "display_name": "eddyparkinson", "link": "https://stackoverflow.com/users/1378888/eddyparkinson"}, "reply_to_user": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1444201216, "post_id": 32981839, "comment_id": 53796273, "body": "@asdev yes. For some reason saving the record is not releasing the lock."}, {"owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1444201366, "post_id": 32981839, "comment_id": 53796365, "body": "Maybe the lock is configured in database options or in the form properties."}, {"owner": {"reputation": 3502, "user_id": 1378888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/ECGgg.jpg?s=128&g=1", "display_name": "eddyparkinson", "link": "https://stackoverflow.com/users/1378888/eddyparkinson"}, "reply_to_user": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1444201781, "post_id": 32981839, "comment_id": 53796614, "body": "Form -&gt; Record Lock = No Locks  ... Yes, re-creating the form from scratch looks like the next thing to try."}, {"owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1444202751, "post_id": 32981839, "comment_id": 53797196, "body": "I meant:  <i>I have also tried &quot;DoCmd.Save acForm, formName&quot;, but that did not help.</i> This command is NOT meant for saving a recordset, but the form-object itself (it will probably save the recordset anyway in the background by Access itself).   It would be helpful if you would give the whole (abstracted with dummy variables) code of the sub"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1444211984, "post_id": 32981839, "comment_id": 53803120, "body": "What is <code>ItemRecordSet</code>?"}, {"owner": {"reputation": 3502, "user_id": 1378888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/ECGgg.jpg?s=128&g=1", "display_name": "eddyparkinson", "link": "https://stackoverflow.com/users/1378888/eddyparkinson"}, "reply_to_user": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1444261874, "post_id": 32981839, "comment_id": 53833375, "body": "@asdev thanks. The form &quot;Record Source&quot; is a table and I can confirm  DoCmd.Save acForm saves the record, but for some strange reason it is not dropping the lock. Locking looks complex, there looks to be many options for changing how locking is done. So far I have just used default options for record locks."}, {"owner": {"reputation": 3502, "user_id": 1378888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/ECGgg.jpg?s=128&g=1", "display_name": "eddyparkinson", "link": "https://stackoverflow.com/users/1378888/eddyparkinson"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1444266498, "post_id": 32981839, "comment_id": 53834682, "body": "@Gustav thanks. photoItemRecordSet is the DAO.Recordset2 of a master form, a master form that contains 3 subforms."}, {"owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1444291805, "post_id": 32981839, "comment_id": 53843994, "body": "Does one of your subforms hold a reference to the parent-table? Another workaround: Instead of using a reference to the recordset and with edit command: Just do your operations on the form controls."}, {"owner": {"reputation": 3502, "user_id": 1378888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/ECGgg.jpg?s=128&g=1", "display_name": "eddyparkinson", "link": "https://stackoverflow.com/users/1378888/eddyparkinson"}, "reply_to_user": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1444442193, "post_id": 32981839, "comment_id": 53919718, "body": "@asdev &gt;do your operbutations on the form controls .... I looked at doing that, but I could not see any way to do it with attachment style fields."}], "answers": [{"tags": [], "owner": {"reputation": 3502, "user_id": 1378888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/ECGgg.jpg?s=128&g=1", "display_name": "eddyparkinson", "link": "https://stackoverflow.com/users/1378888/eddyparkinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1444272455, "creation_date": 1444272455, "answer_id": 33005753, "question_id": 32981839, "link": "https://stackoverflow.com/questions/32981839/how-to-fix-could-not-update-currently-locked-caused-by-using-dao-recordset2-e/33005753#33005753", "title": "How to fix \u201cCould not update; currently locked\u201d caused by using DAO.Recordset2.Edit while a form is being edited", "body": "<p>Workaround: close the form. Update the record. Reopen the form.</p>\n\n<p>This works but is less than ideal.</p>\n"}, {"comments": [{"owner": {"reputation": 3502, "user_id": 1378888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/ECGgg.jpg?s=128&g=1", "display_name": "eddyparkinson", "link": "https://stackoverflow.com/users/1378888/eddyparkinson"}, "edited": false, "score": 0, "creation_date": 1444609444, "post_id": 33010380, "comment_id": 53961174, "body": "Does not work. ..... Does not clear the lock...... I also tried creating the record set using CurrentDb.OpenRecordset and that did not help either."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1444292563, "creation_date": 1444292563, "answer_id": 33010380, "question_id": 32981839, "link": "https://stackoverflow.com/questions/32981839/how-to-fix-could-not-update-currently-locked-caused-by-using-dao-recordset2-e/33010380#33010380", "title": "How to fix \u201cCould not update; currently locked\u201d caused by using DAO.Recordset2.Edit while a form is being edited", "body": "<p>Use the <code>RecordsetClone</code>:</p>\n\n<pre><code>Set photoItemRecordSet = .RecordsetClone\nphotoItemRecordSet.Bookmark = .Bookmark\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8053877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2696ff19f35f6b4e28b4f8c3b6ff3109?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/8053877/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1533307515, "creation_date": 1533307515, "answer_id": 51675125, "question_id": 32981839, "link": "https://stackoverflow.com/questions/32981839/how-to-fix-could-not-update-currently-locked-caused-by-using-dao-recordset2-e/51675125#51675125", "title": "How to fix \u201cCould not update; currently locked\u201d caused by using DAO.Recordset2.Edit while a form is being edited", "body": "<p>I was having a similar problem, the record was saved and a requery didn't help. I was finally able to set the form RecordSource to the recordsource that I originally had it set to again, navigate to the record I was on and then the add photo worked.\nI put this code in the Error Handler;</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>If Err.Number = 3218 Then\r\n    rstEmployee.Close\r\n    Set rstEmployee = Nothing\r\n    Me.RecordSource = \"qryPersonnelData\"\r\n    Set rstEmployee = db.OpenRecordset(strSQL)\r\n    DoCmd.SearchForRecord , \"\", acFirst, \"[ID] = \" &amp; thisID\r\n    Resume</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I hope this helps someone.</p>\n"}], "owner": {"reputation": 3502, "user_id": 1378888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/ECGgg.jpg?s=128&g=1", "display_name": "eddyparkinson", "link": "https://stackoverflow.com/users/1378888/eddyparkinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2715, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1533307515, "creation_date": 1444177525, "last_edit_date": 1444269198, "question_id": 32981839, "link": "https://stackoverflow.com/questions/32981839/how-to-fix-could-not-update-currently-locked-caused-by-using-dao-recordset2-e", "title": "How to fix \u201cCould not update; currently locked\u201d caused by using DAO.Recordset2.Edit while a form is being edited", "body": "<p>DAO.Recordset2.Edit is causing a \u201cCould not update; currently locked\u201d error.</p>\n\n<p>I want to save the edited form, update the record and refresh the form.</p>\n\n<p>But all attempts to save the form fail to fix the error. They fail to clear the record lock. Closing the form clears the lock, but that is messy, looking for a better way.</p>\n\n<p>Steps:</p>\n\n<ul>\n<li><p>typed data into a form.</p></li>\n<li><p>Clicked a button that triggers:</p>\n\n<pre><code>' saves the form but does not clear the record lock\nIf Me.Dirty Then\n    Me.Dirty = False\nEnd If\n</code></pre></li>\n<li><p>click another button that triggers adding a photo:</p>\n\n<pre><code>Private Sub EndPhotoTaking_Click()\n  Dim attachmentField As DAO.Field2\n  Dim photoItemRecordSet As DAO.Recordset2\n  With [Forms]![Inspection - All sub sections].Form\n      Set photoItemRecordSet = .Recordset\n  End With\n  Set attachmentField = photoItemRecordSet(\"Photo\")\n  Set photoItemAttachment = attachmentField.Value\n  '---- error \u201cCould not update; currently locked\u201d on line below \n  photoItemRecordSet.Edit\n</code></pre></li>\n</ul>\n\n<p>Then I get the error \u201cCould not update; currently locked\u201d.</p>\n\n<p>I am using VBA to add a picture into the record, but it is not working. It does not work if the record has been changed in any way. </p>\n\n<p>It is running the Line of code \"Me.Dirty = False\", so this saves the record. But then I get the error. I only get the error if I enter data into the from.</p>\n\n<p>The form that I enter data into contains a subform, would that have an impact? I suspect it does because I have another form that does not have a subform and it works just fine with the same code. Is there anything that would cause \"Me.Dirty = False\" to fail to clear the lock. </p>\n\n<p>I have also tried \"DoCmd.Save acForm, formName\", but that did not help.</p>\n\n<p>The table is sharepoint list style. </p>\n\n<p><em>Edit</em></p>\n\n<ul>\n<li>Added extra code to show origin of photoItemRecordSet.Edit</li>\n<li>updated title and description. Added details to say saving the form is not clearing the record lock.</li>\n</ul>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1444179437, "post_id": 32981796, "comment_id": 53789581, "body": "Add a helper column with something like  <code>=IF(ISERROR(FIND(&quot;#&quot;,C3)),1,2)</code>   Sort on that column and then your data in ColC."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5416222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a40650df7614d8f060fdf9659736da5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Vos", "link": "https://stackoverflow.com/users/5416222/tim-vos"}, "edited": false, "score": 0, "creation_date": 1444186629, "post_id": 32982165, "comment_id": 53791287, "body": "Hi @Jeeped, Thanks for the solution!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1444179988, "creation_date": 1444179988, "answer_id": 32982165, "question_id": 32981796, "link": "https://stackoverflow.com/questions/32981796/sort-column-based-on-values-in-column/32982165#32982165", "title": "Sort column based on values in column", "body": "<p>You can run a custom <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow noreferrer\">Range.Sort method</a> on your data by adding a helper column that determines whether the hashmark character exists in the description. Use that as the primary sort key and column C as a secondary sort key.</p>\n\n<pre><code>Sub hash_sort()\n    With Worksheets(\"Sheet1\")    '&lt;~~ set this properly\n        With .Cells(1, 1).CurrentRegion\n            With .Resize(.Rows.Count - 1, .Columns.Count + 1).Offset(1, 0)\n                .Columns(.Columns.Count).Cells.Formula = \"=isnumber(find(char(35), C2))\"\n                .Cells.Sort Key1:=.Columns(.Columns.Count), Order1:=xlAscending, _\n                            Key2:=.Columns(3), Order2:=xlAscending, _\n                            Orientation:=xlTopToBottom, Header:=xlYes\n                .Columns(.Columns.Count).EntireColumn.Delete\n            End With\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>The 'helper' column is immediately deleted once its purpose has been fulfilled.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/5xUrM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5xUrM.png\" alt=\"Custom Sort on Hashmark with helper column\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 5416222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a40650df7614d8f060fdf9659736da5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Vos", "link": "https://stackoverflow.com/users/5416222/tim-vos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1444179988, "creation_date": 1444177116, "last_edit_date": 1444178044, "question_id": 32981796, "link": "https://stackoverflow.com/questions/32981796/sort-column-based-on-values-in-column", "title": "Sort column based on values in column", "body": "<p>I'm trying to work out a seemingly easy task and, if I had the time and dedication to really get to it, I would probably be able to solve it myself. </p>\n\n<p>However, due to time constraints and lack of thorough VBA and/or Excel knowledge, I am stuck with the following:</p>\n\n<p>An excel spread sheet with 1 column (C in my case) with data. Row 1 contains a header, row 2 as well. Row 3 through 655 contain data with the following format:</p>\n\n<pre><code>1.25L Soft Drinks - 7 Up\n1.25L Soft Drinks - Coke\n1.25L Soft Drinks# - 7 Up\n1.25L Soft Drinks# - Coke\n</code></pre>\n\n<p>Basically all the data in column C contains a duplicate, being the only difference the # tag. I would very much like to sort column C in such a way that the products w/o # appear on tab, alphabetically sorted and the products with # appear at the bottom, also alphabetically sorted. A nice to have would be an empty row between the set of data with # and set of data w/o #. </p>\n\n<p>I am pretty sure that similar codes or other methods have been worked out before but after 3 pretty annoying and time-wasting hours searching the internet my boss really doesn't want me to get on with it :( I do however HAVE to sort the data. I would have to this multiple times so I am eagerly looking for VBA code. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1444176459, "post_id": 32981661, "comment_id": 53788896, "body": "Without analyzing too much <code>Cells(i, 8) = Cells(i - 18, j) And Cells(i, 9) = Cells(k2, j)</code> is a Boolean expression.  It will not assign the desired values to any cells"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1444176729, "post_id": 32981661, "comment_id": 53788958, "body": "Why not use <code>If InStr(1,Cells(k, j).Value,&quot;T1&quot;,vbTextCompare) &gt; 0 Then : Cells(i, 8).Value = Cells(i - 18, j).Value : Cells(i, 9).Value = Cells(k2, j).Value : End If</code>?"}, {"owner": {"reputation": 53, "user_id": 5380661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17c36aa45a0a711bb16e2f63300382fe?s=128&d=identicon&r=PG&f=1", "display_name": "RG1of2", "link": "https://stackoverflow.com/users/5380661/rg1of2"}, "edited": false, "score": 0, "creation_date": 1444181490, "post_id": 32981661, "comment_id": 53790041, "body": "all i had to do was take out the And ... I keep forgetting about boolean operators -_- , anyways, thanks!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1444176607, "creation_date": 1444176607, "answer_id": 32981753, "question_id": 32981661, "link": "https://stackoverflow.com/questions/32981661/go-through-a-table-to-check-if-any-of-its-cells-contain-t1/32981753#32981753", "title": "Go through a table to check if any of its cells contain &quot;T1&quot;", "body": "<p>You are essentially putting the result of a boolean comparison into <code>Cells(i, 8)</code>; e.g. <em>is Cells(i, 8) equal to Cells(i - 18, j) and is Cells(i, 9) equal to Cells(k2, j)</em>.</p>\n\n<pre><code>Select Case Cells(k, j).Value\n    Case \"T1\", \"T1, T2\", \"T2, T1\", \"T1, T3\", \"T3, T1\", \"T1, T2, T3\", \"T1, T3, T2\", \"T2, T1, T3\", \"T2, T3, T1\", \"T3, T1, T2\", \"T3, T2, T1\"\n        Cells(i, 8) = Cells(i - 18, j)\n        Cells(i, 9) = Cells(k2, j)\nEnd Select\n</code></pre>\n\n<p>If you feel that you absolutely <em>must</em> put both cell value assignments on the same line (you don't for any reason other than cosmetic) then separate with a colon.</p>\n\n<pre><code>Select Case Cells(k, j).Value\n    Case \"T1\", \"T1, T2\", \"T2, T1\", \"T1, T3\", \"T3, T1\", \"T1, T2, T3\", \"T1, T3, T2\", \"T2, T1, T3\", \"T2, T3, T1\", \"T3, T1, T2\", \"T3, T2, T1\"\n        Cells(i, 8) = Cells(i - 18, j): Cells(i, 9) = Cells(k2, j)\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5380661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17c36aa45a0a711bb16e2f63300382fe?s=128&d=identicon&r=PG&f=1", "display_name": "RG1of2", "link": "https://stackoverflow.com/users/5380661/rg1of2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 32981753, "answer_count": 1, "score": 0, "last_activity_date": 1444179522, "creation_date": 1444175912, "last_edit_date": 1444179522, "question_id": 32981661, "link": "https://stackoverflow.com/questions/32981661/go-through-a-table-to-check-if-any-of-its-cells-contain-t1", "title": "Go through a table to check if any of its cells contain &quot;T1&quot;", "body": "<p>My code is supposed to go through a table to check if any of its cells contain \"T1\". The format of all the cells in this table is text. </p>\n\n<p>If it finds a cell with \"T1\" in it, it will do stuff to cells in other tables. In particular, it assigns <code>cells(i, 8)</code> with the value of <code>cells(i-18, j)</code>, both of which are in number format, and assign <code>cells(i,9)</code> with the value of <code>cells(k2, j)</code>, both of which are dates. </p>\n\n<p>When I execute the code, it makes <code>cells(i,8)</code> equal to <code>0</code> and doesn't do anything to <code>cells(i,9)</code>.</p>\n\n<p>Can someone correct this code? </p>\n\n<pre><code>Sub TestSub2()\n\nDim i As Integer, j As Integer, k As Integer, k2 As Integer\n\n'i -&gt;tier table row counter\n'j -&gt;column counter\n'k -&gt;\"Reading Date\" and \"PM Executed?\" table row counter\n\n'---TIER 1 TABLE---\nk = 102\nk2 = 84\n\nFor i = 21 To 35\n\n    k = k + 1\n    k2 = k2 + 1\n\n    For j = 27 To 149\n    Select Case Cells(k, j).Value\n    Case \"T1\", \"T1, T2\", \"T2, T1\", \"T1, T3\", \"T3, T1\", \"T1, T2, T3\", \"T1, T3, T2\", \"T2, T1, T3\", \"T2, T3, T1\", \"T3, T1, T2\", \"T3, T2, T1\"\n    Cells(i, 8) = Cells(i - 18, j) And Cells(i, 9) = Cells(k2, j)\n    End Select\n\n    Next j\n\nNext i\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007", "html-email"], "comments": [{"owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1444205642, "post_id": 32981589, "comment_id": 53798881, "body": "Why not just concatenating a string? <code>strVariable = strVariable &amp; &quot; , &quot; &amp; serialRowNum</code> You can insert a Linefeed with vbNewLine or vbCRLF I think"}, {"owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "reply_to_user": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1444223412, "post_id": 32981589, "comment_id": 53810854, "body": "Can you show me a brief example of that?"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "edited": false, "score": 0, "creation_date": 1444324883, "post_id": 32993725, "comment_id": 53866890, "body": "Thanks for looking at this for me. The string seems to be mostly working. At the moment when there are 2 rows of results serialVar it prints the first row twice rather than the two separate rows."}, {"owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "edited": false, "score": 0, "creation_date": 1444324948, "post_id": 32993725, "comment_id": 53866927, "body": "Also in the email body strResult prints as one long line of text, no line breaks. Any ideas on those?"}, {"owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "reply_to_user": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "edited": false, "score": 0, "creation_date": 1444340863, "post_id": 32993725, "comment_id": 53875299, "body": "I would recommend to remove this For loop. Just use the method in the comments with serialRS(0) and serialRS(1) Maybe the html body needs a tagged linebreak like &lt;br/&gt;"}], "tags": [], "owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "is_accepted": true, "score": 1, "last_activity_date": 1444225441, "last_edit_date": 1444225441, "creation_date": 1444225097, "answer_id": 32993725, "question_id": 32981589, "link": "https://stackoverflow.com/questions/32981589/in-access-2007-how-to-print-results-of-sql-query-into-the-body-of-an-email-messa/32993725#32993725", "title": "In Access 2007 how to print results of sql query into the body of an email message", "body": "<p>This is a possible way with concatenated strings. Also I used standard \"RecordSetPointers\" (I do not know the name). But you can adapt it to your for-loops</p>\n\n<pre><code>'Select which serial numbers to display\nsqlSerialNumbers = \"SELECT serialNumber, [Item Number] FROM [Equipment on loan] WHERE Evaluation = \" &amp; MailList![ID]\n\nSet serialDB = CurrentDb\nSet serialRS = serialDB.OpenRecordset(sqlSerialNumbers)\n\nDim strResult as String\n'initialize strResult empty    \nstrResult = \"\"\n\nserialVar = serialRS.GetRows(serialRS.RecordCount)\n\nIf not serialRS is Nothing then 'Check null\n    If not (serialRS.EOF and seriaRS.BOF) then'Check Empty\n        serialRS.MoveFirst 'not neccessary but still good habit\n        Do While Not serialRS.EOF\n            'I use your loop here\n            'You could refer to the columns by serialRS(0), serialRS(1),... \n            'or serialRS(COLUMNNAME)...\n            For serialColNum = 0 To UBound(serialVar, 1) 'Loop through each Column\n                strResult = strResult &amp; serialVar(serialColNum, serialRowNum) &amp; vbCrLf \n                'separated by linefeed\n            Next\n            serialRS.MoveNext 'next RS\n        Loop\n    End if  \nEnd If\n\n'Clean Up   \nserialRS.Close: set serialRS = nothing\nserialDB.Close: set serialDB = nothing\n\n'Open Outlook\nSet MyOutlook = New Outlook.Application\n\n'This creates the e-mail\nSet MyMail = MyOutlook.CreateItem(olMailItem)\n\n'This populates the fields \nMyMail.To = emailAddress\nMyMail.Subject = Subjectline\nMyMail.HTMLBody =  strResult'\"I want the results of GetRows here.\"\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 32993725, "answer_count": 1, "score": 0, "last_activity_date": 1594643546, "creation_date": 1444175479, "last_edit_date": 1594643546, "question_id": 32981589, "link": "https://stackoverflow.com/questions/32981589/in-access-2007-how-to-print-results-of-sql-query-into-the-body-of-an-email-messa", "title": "In Access 2007 how to print results of sql query into the body of an email message", "body": "<p>I have an access database that sends an email out with some reminder information. I\u2019d like to use the results of a sql query to populate the body of the email. Right now I am using GetRows() and am able to debug.print the data that I want, however, I am not familiar with how to get this into the email. Should I be trying to save it as an array or something like that?</p>\n\n<p>My current code looks like this:</p>\n\n<pre><code>'Select which serial numbers to display\nsqlSerialNumbers = \"SELECT serialNumber, [Item Number] FROM [Equipment on loan] WHERE Evaluation = \" &amp; MailList![ID]\n\nSet serialDB = CurrentDb\nSet serialRS = serialDB.OpenRecordset(sqlSerialNumbers)\n\nserialVar = serialRS.GetRows(serialRS.RecordCount)\nDebug.Print \"Serial Number\", \"Part Number\"\n    For serialRowNum = 0 To UBound(serialVar, 2) 'Loop through each Row\n        For serialColNum = 0 To UBound(serialVar, 1) 'Loop through each Column\n            Debug.Print serialVar(serialColNum, serialRowNum),\n        Next\n    Debug.Print vbCrLf\n   Next\n\nserialRS.Close\n\n\n'Open Outlook\nSet MyOutlook = New Outlook.Application\n\n'This creates the e-mail\nSet MyMail = MyOutlook.CreateItem(olMailItem)\n\n'This populates the fields \nMyMail.To = emailAddress\nMyMail.Subject = Subjectline\nMyMail.HTMLBody =  \"I want the results of GetRows here.\"\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1444172551, "post_id": 32981162, "comment_id": 53787826, "body": "Did you test the actual performance of looping over the array?  Should be pretty fast."}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1444173970, "post_id": 32981162, "comment_id": 53788196, "body": "Looping through that array should not take more than a few minutes..."}, {"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444174177, "post_id": 32981162, "comment_id": 53788240, "body": "@tim-williams - i have not tried looping, but it seems to be quite inefficient.   even at that, i&#39;m not sure i know how to &quot;remove&quot; one row from an array like this.  any example would be helpful."}, {"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1444174264, "post_id": 32981162, "comment_id": 53788267, "body": "@pnuts - not sure how to do this in VBA.  do you have an example?"}, {"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "reply_to_user": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1444174490, "post_id": 32981162, "comment_id": 53788347, "body": "@emihir0 - MINUTES?  that sounds like an eternity.  getting all the data from an external XML file doesn&#39;t take but 20 seconds if i write it in small chunks and go to the spreadsheet every time."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1444174507, "post_id": 32981162, "comment_id": 53788353, "body": "When you say &#39;array&#39;, are you talking about rows of a worksheet that you want to remove? Or do you simply have an array variable that you want to reduce?"}, {"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1444174615, "post_id": 32981162, "comment_id": 53788378, "body": "@pnuts - ah, for sure if it&#39;s already written to the spreadsheet.  i was hoping to do this BEFORE writing to the spreadsheet.  in other words, store the data in an array, run the filter, then save the results to the spreadsheet.  all off-sheet in VBA."}, {"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 1, "creation_date": 1444174636, "post_id": 32981162, "comment_id": 53788385, "body": "@Ambie - an array variable."}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1444174764, "post_id": 32981162, "comment_id": 53788416, "body": "@gotmike I said minutes because it depends on what else you might want to do in the loops. Also, what you described sounds like a task that needs not to be done frequently (ie. once a week to clean up the data) and so whether it takes 10 seconds or 10 minutes does not really matter, as long as it is done correctly. If you need to process 100k of rows of data frequently, VBA, nor Excel are not the right tools."}, {"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "reply_to_user": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1444174974, "post_id": 32981162, "comment_id": 53788469, "body": "@emihir0 - this is part of an import process.  so it&#39;s not done &quot;regularly&quot; but speed is a concern.  i concur that VBA is not the best avenue and we may re-write this in C# as an XLL but we are stuck with Excel due to restrictions beyond my control.  thanks for the clarification."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1444175469, "post_id": 32981162, "comment_id": 53788595, "body": "Perhaps write the array to spare sheet, use autofilter to remove rows of zero then reload the visible cells to that array variable? Turn calculation to manual then do above, and restore it&#39;s mode afterward."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444175597, "post_id": 32981162, "comment_id": 53788640, "body": "The biggest slowdown you will experience is deleting a large number of non-contiguous rows from a worksheet. Conditionally rewrite the array to a new (smaller) array and then dump the data onto the worksheet."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1444185168, "post_id": 32981162, "comment_id": 53790925, "body": "The assumption <i>I assume iterating through every entry will prove very time-consuming</i> is quite wrong.  I ran a quick test on just the array handling part (generating a new array minus the <code>0</code> rows), it ran for &gt;100,000 rows in less than 50ms.  In my experience a well designed loop is often faster than other non-loopy ways of doing things. Getting data on and off a sheet can be quite fast too, when done properly.  So the answer to your question <i>Is there another way that is faster?</i> is: Probably not!"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1444190725, "post_id": 32981162, "comment_id": 53792307, "body": "Arrays are extremely fast, but you may find the Autofilter acceptable (and easier to implement) as in <b><a href=\"http://stackoverflow.com/questions/30959315/excel-vba-performance-1-million-rows-delete-rows-containing-a-value-in-less/30959316#30959316\">this answer</a></b> - Out of 1 million records it removes 100,000 rows in an average of 33 seconds. Let me know if you&#39;re interested and I can easily adjust it for your requirements"}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1444179616, "post_id": 32981863, "comment_id": 53789611, "body": "If I then want to write the entire Collection to a range, is that an easy process?  I understood that the &quot;pro&quot; of using an array was that writing the data out to the spreadsheet was a one-step process.  How does this work with a Collection?"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1444182122, "post_id": 32981863, "comment_id": 53790198, "body": "@gotmike, you can iterate a collection with a <code>For Each</code> loop, but you&#39;d be right in thinking that writing an array is far quicker. That&#39;s why I&#39;ve put the second piece of code in for you. I&#39;ve tested it and it&#39;s still pretty quick, so that would be the option I&#39;d take if you need to then write the output to a worksheet."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1444187405, "post_id": 32981863, "comment_id": 53791488, "body": "FYI, I just tested the Option 1 code on 100,000 rows, reducing to 20,000 rows and it took 62ms."}, {"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1444944030, "post_id": 32981863, "comment_id": 54126329, "body": "I went this route, iterating, and the speed was acceptable.  Thanks!"}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 3, "last_activity_date": 1444177707, "creation_date": 1444177707, "answer_id": 32981863, "question_id": 32981162, "link": "https://stackoverflow.com/questions/32981162/cleaning-up-an-array/32981863#32981863", "title": "Cleaning up an array", "body": "<p>I'm not aware of any other way in VBA than to loop through the array and write another array/list.</p>\n\n<p>What makes it trickier is that your array looks to be two-dimensional and VBA will only allow you to redim the last dimension. From the look of your data, you'd want to redim the first dimension as you iterate through your array.</p>\n\n<p>There are several solutions:</p>\n\n<ol>\n<li><p>Iterate your data twice - once to get the array size (and probably to store the relevant row numbers) and a second time to transfer the raw data into your new data.</p></li>\n<li><p>Iterate once and just reverse your dimensions (ie row is last).</p></li>\n<li><p>Use an array of arrays, so that each array only has one dimension).</p></li>\n<li><p>Use a <code>Collection</code> which doesn't need to be dimensioned - this would be my preferred option.</p></li>\n</ol>\n\n<p>Option 4 would look like this (I've assumed your array is zero based):</p>\n\n<pre><code>Dim resultList As Collection\nDim r As Long\n\nSet resultList = New Collection\nFor r = 0 To UBound(raw, 1)\n    If raw(r, 3) &lt;&gt; 0 Then\n        resultList.Add Array(raw(r, 0), raw(r, 1), raw(r, 2), raw(r, 3))\n    End If\nNext\n</code></pre>\n\n<p>If you have to write to a new array, then here's an example of Option 1:</p>\n\n<pre><code>Dim rowList As Collection\nDim result() As Variant\nDim r As Long\nDim c As Long\nDim v As Variant\n\nSet rowList = New Collection\nFor r = 0 To UBound(raw, 1)\n    If raw(r, 3) &lt;&gt; 0 Then\n        rowList.Add r\n    End If\nNext\n\nReDim result(rowList.Count - 1, 3) As Variant\nc = 0\nFor Each v In rowList\n    result(c, 0) = raw(v, 0)\n    result(c, 1) = raw(v, 1)\n    result(c, 2) = raw(v, 2)\n    result(c, 3) = raw(v, 3)\n    c = c + 1\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1444184986, "post_id": 32982243, "comment_id": 53790873, "body": "Your test timing includes reading data from a dissk (as you said) and splitting it into an array (<code>Split</code> is a slowish function) - two things the OP doesn&#39;t talk about, he already has the data in an array.  I ran a quick test on just the array handling part, it ran for &gt;100,000 rows in less than 50ms"}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 1, "last_activity_date": 1444180524, "creation_date": 1444180524, "answer_id": 32982243, "question_id": 32981162, "link": "https://stackoverflow.com/questions/32981162/cleaning-up-an-array/32982243#32982243", "title": "Cleaning up an array", "body": "<p>Okay, it's all off-sheet, so all the arrays are zero-based.  To test this set-up, I created a worksheet with four columns, as per your data and using random numbers in the fourth column.  I saved this to a text file (TestFile.txt), then read it in to be able to get a zero-based array (Excel ranges are 1-based when you take them into an array).  I saved 150000 rows to the text file to properly stress the routine.  Yes, I have an SSD and that would affect the 2s run time, but I'd still expect it to run in &lt;10s on a spinning HDD, I think.</p>\n\n<p>Anyway, here's the code (requires a VBA reference to Microsoft Scripting Runtime purely to read in the file):</p>\n\n<pre><code>Public Function ReturnFilteredArray(arrSource As Variant, _\n                                strValueToFilterOut As String) As Variant\nDim arrDestination      As Variant\nDim lngSrcCounter       As Long\nDim lngDestCounter      As Long\n\nReDim arrDestination(UBound(arrSource, 1) + 1, UBound(arrSource, 2) + 1)\n\nlngDestCounter = 1\nFor lngSrcCounter = LBound(arrSource, 1) To UBound(arrSource, 1)\n    ' Assuming the array dimensions are (100000, 3)\n    If CStr(arrSource(lngSrcCounter, 3)) &lt;&gt; strValueToFilterOut Then\n        ' Hit an element we want to include\n        arrDestination(lngDestCounter, 1) = arrSource(lngSrcCounter, 0)\n        arrDestination(lngDestCounter, 2) = arrSource(lngSrcCounter, 1)\n        arrDestination(lngDestCounter, 3) = arrSource(lngSrcCounter, 2)\n        arrDestination(lngDestCounter, 4) = arrSource(lngSrcCounter, 3)\n\n        lngDestCounter = lngDestCounter + 1\n    End If\nNext\n\nReturnFilteredArray = arrDestination\nEnd Function\n\nSub TestRun()\nDim fso As FileSystemObject\nDim txs As TextStream\nDim arr As Variant\nDim arr2 As Variant\nDim lngCounter As Long\n\nDebug.Print Now()\nSet fso = New FileSystemObject\nSet txs = fso.OpenTextFile(\"E:\\Users\\Thingy\\Desktop\\TestFile.txt\", ForReading)\narr = Split(txs.ReadAll, vbNewLine)\nReDim arr2(UBound(arr), 3)\n\nFor lngCounter = 0 To UBound(arr) - 1\n    arr2(lngCounter, 0) = Split(arr(lngCounter), vbTab)(0)\n    arr2(lngCounter, 1) = Split(arr(lngCounter), vbTab)(1)\n    arr2(lngCounter, 2) = Split(arr(lngCounter), vbTab)(2)\n    arr2(lngCounter, 3) = Split(arr(lngCounter), vbTab)(3)\nNext\n\narr2 = ReturnFilteredArray(arr2, \"0\")\nRange(\"L2\").Resize(UBound(arr2, 1), 5) = arr2\n\nDebug.Print Now()\nEnd Sub\n</code></pre>\n\n<p>There are a number of assumptions in there, not least the dimensions.  Note the difference in the second dimension counter between arrDestination and arrSource.  That's to do with Excel being 1-based and normal arrays being 0-based.</p>\n\n<p>Also, when I'm writing out the array, I needed to bump up the second dimension to 5 in order to get all of the array out to the sheet.  I wasn't able to trim off the empty elements since ReDim Preserve only works on the uppermost dimension (columns) and it's the first dimension (rows) that's changing here.</p>\n\n<p>Anywho, this should serve as a reminder that despite its faults Excel is pretty amazing.</p>\n"}], "owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 32981863, "answer_count": 2, "score": 0, "last_activity_date": 1444180524, "creation_date": 1444172381, "last_edit_date": 1444172584, "question_id": 32981162, "link": "https://stackoverflow.com/questions/32981162/cleaning-up-an-array", "title": "Cleaning up an array", "body": "<p>I have a very large array in VBA which includes a lot of <code>0</code> values that I'd like to remove. Something like this:</p>\n\n<pre><code>A    B    C    12345\nD    E    F    848349\nG    H    I    0\nJ    K    L    0\nM    N    O    0\nP    Q    R    4352\nS    T    U    0\nV    W    X    0\n</code></pre>\n\n<p>I would like to be able to quickly/easily strip out all rows from this array that have a zero in the 4th column, resulting in something like this:</p>\n\n<pre><code>A    B    C    12345\nD    E    F    848349\nP    Q    R    4352\n</code></pre>\n\n<p>This array has 100,000 or so rows, that hopefully gets  down to a number closer to 20,000 or 30,000 rows instead after processing.</p>\n\n<p>I assume iterating through every entry will prove very time-consuming.</p>\n\n<p>Is there another way that is faster?</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444172686, "post_id": 32981035, "comment_id": 53787868, "body": "Have you added a reference to the Word object library?  Excel doesn&#39;t know what the value of (eg) <code>wdFormatOriginalFormatting</code> is..."}, {"owner": {"reputation": 173, "user_id": 4665272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e435614d2e914554c79538746637d01?s=128&d=identicon&r=PG&f=1", "display_name": "strahanstoothgap", "link": "https://stackoverflow.com/users/4665272/strahanstoothgap"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444173020, "post_id": 32981035, "comment_id": 53787955, "body": "Yes.  Reference is there and the code runs fine.  It just doesn&#39;t do anything.  My hunch is that it&#39;s around the selection stuff.  I don&#39;t think that the program is passing over the &quot;active&quot; to Word and allowing it to take control and find the question text and then act upon it.  But, obviously I am not sure.  When I step through the code, nothing happens, for example, at the movedown or moveleft, which I wanted to see the cursor actually move."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1444174570, "post_id": 32981035, "comment_id": 53788369, "body": "The code <code>Selection.movedown</code> (and similar things) will manipulate Excel&#39;s Selection, not Word&#39;s. You can possibly fix this by using <code>wdApp.Selection</code> or <code>wdDoc.ActiveWindow.Selection</code> or something similar."}, {"owner": {"reputation": 173, "user_id": 4665272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e435614d2e914554c79538746637d01?s=128&d=identicon&r=PG&f=1", "display_name": "strahanstoothgap", "link": "https://stackoverflow.com/users/4665272/strahanstoothgap"}, "edited": false, "score": 0, "creation_date": 1444175227, "post_id": 32981035, "comment_id": 53788527, "body": "Thanks for your comment.  I&#39;ve tried adding wdDoc and wdApp in front of them, and even changing that for oSearchRange, but nothing happens.  After the find method, I feel that the Word cursor should move, but nothing is happening in the Word window."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444178614, "post_id": 32981035, "comment_id": 53789393, "body": "Remove the <code>On Error Resume Next</code>  -you can&#39;t really do any meaningful debugging with that there.  I suspect the problem line is  <code>Set blabla = oSearchRange.Find.Execute.Text = questiontext</code>     <code>Execute</code> returns True/False, neither of which have a <code>Text</code> property.   <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193977.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff193977.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 4665272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e435614d2e914554c79538746637d01?s=128&d=identicon&r=PG&f=1", "display_name": "strahanstoothgap", "link": "https://stackoverflow.com/users/4665272/strahanstoothgap"}, "edited": false, "score": 0, "creation_date": 1444244336, "post_id": 32982070, "comment_id": 53825278, "body": "This is great!  Thanks so much for your help on this, it works perfectly.  Though, one minor thing that happens is the program &#39;hangs&#39; if the document is already open.  I found a work around if you do this instead:      <code>Set wdDoc = CreateObject(&quot;C:\\mydoc.docx&quot;)</code>     <code>Set wdApp = wdDoc.Application</code>"}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 0, "last_activity_date": 1444179626, "last_edit_date": 1444179626, "creation_date": 1444179248, "answer_id": 32982070, "question_id": 32981035, "link": "https://stackoverflow.com/questions/32981035/loop-through-excel-rows-key-in-on-value-in-word-paste-excel-string/32982070#32982070", "title": "Loop through Excel rows, key in on value in Word, paste Excel string", "body": "<p>I think this code does what you're after. I made a number of small changes to the code in the original post, some important, some not so much. Hopefully the comments help explain why I did what I did:</p>\n\n<pre><code>Sub UpdateWordDoc1()\n    ' REQUIRES A REFERENCE TO:\n    ' Microsoft Word ##.# Object Library\n\n    Dim myws As Excel.Worksheet     ' Changed wb to ws to better abbreviate worksheet\n    Dim wdDoc As Word.Document      ' No longer a generic object\n    Dim wdApp As Word.Application   ' No longer a generic object\n    Dim questiontext As String\n    Dim oSearchRange As Word.Range  ' Word range is what will be searched\n    Dim i As Long                   ' Loop through rows by count (Long)\n\n    Set myws = ActiveWorkbook.ActiveSheet\n\n    ' On Error Resume Next          ' Can't find bugs if they're supressed!!!\n    Set wdApp = CreateObject(\"Word.Application\")    ' Create app before opening doc\n                                                    ' Need to explore what happens\n                                                    ' if Word is already running\n    wdApp.Visible = True            ' Make it visible so we can watch it work\n    Set wdDoc = wdApp.Documents.Open(\"C:\\mydoc.docx\")   ' Open the doc\n\n    With myws\n        For i = 2 To .Range(\"A6000\").End(xlUp).Row\n            ' Word's Find function is tricky to program, because\n            ' when Find succeeds, the range is moved! (Find has many\n            ' other odd behaviors). Assuming you want to search the entire doc\n            ' for each search term, we reset the range every time through the\n            ' loop.\n            Set oSearchRange = wdDoc.Content\n\n            questiontext = .Range(\"A\" &amp; i).Value\n            .Range(\"B\" &amp; i).Copy\n\n            ' Set blabla = oSearchRange.Find.Execute.Text = questiontext\n            With oSearchRange.Find\n                ' Note that Word's Find settings are \"sticky\". For example, if\n                ' you were previously searching for (say) italic text before\n                ' running this Sub, Word may still search for italic, and your\n                ' search could fail. To kill such bugs, explicitly set all of\n                ' Word's Find parameters, not just .Text\n                .Text = questiontext    ' This is what you're searching for\n                If .Execute Then    ' Found it.\n                                    ' NOTE: This is only gonna make a change\n                                    ' at the first occurence of questiontext\n                    ' When find is successful, oSearchRange will move\n                    ' to the found text. But not the selection, so do Select.\n                    oSearchRange.Select\n\n                    ' Now move to where the new text is to be pasted\n                    wdDoc.ActiveWindow.Selection.movedown unit:=wdparagraph\n                    wdDoc.ActiveWindow.Selection.moveleft unit:=wdcharacter\n\n                    ' While debugging, the next statement through me out of single\n                    ' step mode (don't know why) but execution continued \n                    ' and the remaining words in my list we're found and text\n                    ' pasted in as expected.\n                    wdDoc.ActiveWindow.Selection.PasteAndFormat (wdFormatOriginalFormatting)\n                End If\n            End With\n        Next i\n\n    End With\n\n    ' Clean up and close down\n    wdDoc.Close savechanges:=True\n    Set oSearchRange = Nothing\n    Set wdDoc = Nothing\n    wdApp.Quit\n    Set wdApp = Nothing\n    Set myws = Nothing\nEnd Sub\n</code></pre>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 173, "user_id": 4665272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e435614d2e914554c79538746637d01?s=128&d=identicon&r=PG&f=1", "display_name": "strahanstoothgap", "link": "https://stackoverflow.com/users/4665272/strahanstoothgap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 32982070, "answer_count": 1, "score": 0, "last_activity_date": 1444179626, "creation_date": 1444171665, "last_edit_date": 1444172020, "question_id": 32981035, "link": "https://stackoverflow.com/questions/32981035/loop-through-excel-rows-key-in-on-value-in-word-paste-excel-string", "title": "Loop through Excel rows, key in on value in Word, paste Excel string", "body": "<p>I am trying to loop through Excel rows, where column A holds text that I want to find in Word.  Column B holds what I want to paste in Word after the end of the paragraph in which the text is found. </p>\n\n<p>When working in Word VBA, the find text is working and moving to the end of the paragraph works.  But when I move to Excel VBA, the find method doesn't seem to be doing anything.  </p>\n\n<pre><code>Sub UpdateWordDoc1()\n\nDim mywb As Excel.Worksheet\nSet mywb = ActiveWorkbook.ActiveSheet\nDim wdDoc As Object, wdApp As Object\nDim questiontext As String\nDim oSearchRange\n\n\nOn Error Resume Next\nSet wdDoc = CreateObject(\"C:\\mydoc.docx\")\nSet wdApp = wdDoc.Application\nSet oSearchRange = wdDoc.Content\n\nWith mywb\n  For i = 2 To .Range(\"A6000\").End(xlUp).Row\n    questiontext = .Range(\"A\" &amp; i).Value\n    .Range(\"B\" &amp; i).Copy\n\n    Set blabla = oSearchRange.Find.Execute.Text = questiontext\n    blabla.Select\n\n    Selection.movedown unit:=wdparagraph\n    Selection.moveleft unit:=wdcharacter\n    Selection.PasteAndFormat (wdFormatOriginalFormatting)\n\n  Next i\n\nEnd With\n'wdDoc.Close savechanges:=True\nSet wdDoc = Nothing\nSet wdApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2479, "user_id": 3178426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/786493b0364f7e8106e9695cdad88f9d?s=128&d=identicon&r=PG&f=1", "display_name": "zzevannn", "link": "https://stackoverflow.com/users/3178426/zzevannn"}, "edited": false, "score": 0, "creation_date": 1444169989, "post_id": 32980750, "comment_id": 53786929, "body": "Isn&#39;t this saying if the length -2 is ) then run the rest of the code? <code>Len(ActiveCell) - 2) = &quot;(&quot;</code>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1444170115, "post_id": 32980750, "comment_id": 53786978, "body": "How is the cell <a href=\"http://stackoverflow.com/questions/32892403/excel-vba-font-superscript-code-does-not-work/32893111#32893111\">formatted</a>?"}, {"owner": {"reputation": 11, "user_id": 5415934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/710095ee6d6e170709a582ba4c476e73?s=128&d=identicon&r=PG&f=1", "display_name": "user5415934", "link": "https://stackoverflow.com/users/5415934/user5415934"}, "edited": false, "score": 0, "creation_date": 1444170181, "post_id": 32980750, "comment_id": 53787004, "body": "I thought Len(ActiveCell) would find the end of the cell, but could be wrong"}], "answers": [{"comments": [{"owner": {"reputation": 12472, "user_id": 4850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GOfnj.jpg?s=128&g=1", "display_name": "Andr&#233; Chalella", "link": "https://stackoverflow.com/users/4850/andr%c3%a9-chalella"}, "reply_to_user": {"reputation": 11, "user_id": 5415934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/710095ee6d6e170709a582ba4c476e73?s=128&d=identicon&r=PG&f=1", "display_name": "user5415934", "link": "https://stackoverflow.com/users/5415934/user5415934"}, "edited": false, "score": 0, "creation_date": 1444432913, "post_id": 32980832, "comment_id": 53917879, "body": "@user5415934 you&#39;re welcome, but you should accept the answer if it helped you by clicking on the \u2714 check sign on the left."}], "tags": [], "owner": {"reputation": 12472, "user_id": 4850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GOfnj.jpg?s=128&g=1", "display_name": "Andr&#233; Chalella", "link": "https://stackoverflow.com/users/4850/andr%c3%a9-chalella"}, "is_accepted": false, "score": 0, "last_activity_date": 1444170322, "creation_date": 1444170322, "answer_id": 32980832, "question_id": 32980750, "link": "https://stackoverflow.com/questions/32980750/conditionally-formatting-part-of-string/32980832#32980832", "title": "Conditionally formatting part of string", "body": "<p>What you want in this conditional is</p>\n\n<pre><code>If Mid(ActiveCell, Len(ActiveCell) - 2, 1) = \"(\" Then\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5415934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/710095ee6d6e170709a582ba4c476e73?s=128&d=identicon&r=PG&f=1", "display_name": "user5415934", "link": "https://stackoverflow.com/users/5415934/user5415934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444170322, "creation_date": 1444169904, "last_edit_date": 1444169957, "question_id": 32980750, "link": "https://stackoverflow.com/questions/32980750/conditionally-formatting-part-of-string", "title": "Conditionally formatting part of string", "body": "<p>I am attempting to use the following to make the last bit of a cell smaller and superscript (for footnotes). I'm trying to test if the third-to-last character in the cell is an open parenthesis (and therefore the footnote is one digit) and format accordingly, but the following doesn't seem to be working:</p>\n\n<pre><code>Sub Footnoter()\n'\n' Footnote Macro\n' Keyboard Shortcut = Ctrl + Shift + Q\n'\n    If (Len(ActiveCell) - 2) = \"(\" Then\n    With ActiveCell.Characters(Start:=Len(ActiveCell) - 2, Length:=3).Font\n        .Size = (ActiveCell.Characters(Start:=Len(ActiveCell) - 3, Length:=1).Font.Size - 2)\n        .Superscript = True\n    End With\n    Else\n    With ActiveCell.Characters(Start:=Len(ActiveCell) - 3, Length:=4).Font\n    .Size = (ActiveCell.Characters(Start:=Len(ActiveCell) - 3, Length:=1).Font.Size - 2)\n    .Superscript = True\n    End With\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "edited": false, "score": 1, "creation_date": 1444168981, "post_id": 32980425, "comment_id": 53786554, "body": "I&#39;m unable to replicate your issue.  Have you tried perhaps using <code>Chr(10)</code> instead of <code>vbCrLf</code>?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1444169423, "post_id": 32980425, "comment_id": 53786718, "body": "Couldn&#39;t replicate your issue. Post code where you actually create the comment?"}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "edited": false, "score": 0, "creation_date": 1444170912, "post_id": 32980425, "comment_id": 53787256, "body": "EntryLevel, that did the trick. Thanks! I forgot to mention that this issue has only occurred for me in Excel 2010, not 2013. If you put your comment as the answer, I&#39;ll mark it as accepted."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1444171144, "post_id": 32980425, "comment_id": 53787350, "body": "Does it happen in all fonts?"}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "edited": false, "score": 0, "creation_date": 1444171822, "post_id": 32980425, "comment_id": 53787571, "body": "John, the default comment font in both the 2010 and 2013 installs that I&#39;m using is Tahoma and I didn&#39;t change the font on either."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1444174263, "post_id": 32980425, "comment_id": 53788266, "body": "Normally within a comment box, the newline is just <code>vbLf</code>, not <code>vbCrLf</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1444175376, "post_id": 32980425, "comment_id": 53788567, "body": "<code>Chr(10)</code> is <code>vbLf</code>. <code>vbLf</code> works better in Excel because it happens to be the new line character picked by the developers."}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "edited": false, "score": 0, "creation_date": 1444249747, "post_id": 32981488, "comment_id": 53828579, "body": "Thanks. I did already change my code to use Chr(10) instead of vbCrLF Chr(10), but vbLf is a still better choice."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "edited": false, "score": 0, "creation_date": 1444259136, "post_id": 32981488, "comment_id": 53832644, "body": "<code>vbLf</code> is same as <code>Chr(10)</code>, but it&#39;s less typing and more neat. <code>?Asc(vbLf)</code> does give you <code>10</code>."}, {"owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "edited": false, "score": 0, "creation_date": 1444404441, "post_id": 32981488, "comment_id": 53904712, "body": "Yes, hence &#39;is a still better choice&#39; even though their values are identical. Also, vbLf is a constant rather than a function of a constant, so there is that, too."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 1, "last_activity_date": 1444174662, "creation_date": 1444174662, "answer_id": 32981488, "question_id": 32980425, "link": "https://stackoverflow.com/questions/32980425/vbcrlf-creates-unwanted-box-character-in-comment/32981488#32981488", "title": "vbCrLf creates unwanted &quot;box&quot; character in comment", "body": "<p>You should use <strong><code>vbLf</code></strong> instead of <code>vbCrLf</code>, see screencap:</p>\n\n<p>The <code>vbCrLf</code> has a block within the comment:<BR>\n<a href=\"https://i.stack.imgur.com/3WA0g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3WA0g.png\" alt=\"sample_vbcrlf\"></a></p>\n\n<p>But if you use <strong><code>vbLf</code></strong> then:<br>\n<a href=\"https://i.stack.imgur.com/ORHGf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ORHGf.png\" alt=\"sample_vblf\"></a></p>\n"}], "owner": {"reputation": 163, "user_id": 2168224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5miBv.png?s=128&g=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/2168224/ilan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 32981488, "answer_count": 1, "score": 1, "last_activity_date": 1444199803, "creation_date": 1444168455, "last_edit_date": 1444199803, "question_id": 32980425, "link": "https://stackoverflow.com/questions/32980425/vbcrlf-creates-unwanted-box-character-in-comment", "title": "vbCrLf creates unwanted &quot;box&quot; character in comment", "body": "<p>Note: The following issue occurred in Excel 2010 but not in Excel 2013.</p>\n\n<p>Using the VBA constant <code>vbCrLf</code> (ASCII code 10 and 13) to implement carriage return &amp; line feed in VBA-generated worksheet comments produces an unwanted 'box' character at the end of every line in the resulting worksheet comments which are followed by another line (that is, the boxes are on every line of the comment except the last one).</p>\n\n<p>Here is a sample of the VBA code that I'm using to create the text for the comment:</p>\n\n<pre><code>                    strCmnt = \"Text for line 1 of comment\"\n                    strCmnt = strCmnt &amp; vbCrLf &amp; \"Text for line 2 of comment\"\n                    strCmnt = strCmnt &amp; vbCrLf &amp; \"Text for line 3 of comment\"\n</code></pre>\n\n<p>The result is a line break after lines 1 and 2 in the comment box, as there should be, but a little box appears after the word \"comment\" on line 1 and line 2.</p>\n\n<p>How do I retain the line breaks without producing the boxes?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444166230, "post_id": 32979838, "comment_id": 53785295, "body": "I think I&#39;m misunderstanding &quot;array&quot;.  You can store all of those values into an array, then display them in Excel however you want...you can go three columns over, then down a row, repeat.  Or you can go six columns over, and down a row.  My point is that (AFAIK) Excel array&#39;s aren&#39;t stored in some physical way ...it&#39;s just a list of items.  How you display them in Excel is up to you 100%.  Does that make sense?"}, {"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444166620, "post_id": 32979838, "comment_id": 53785489, "body": "i clarified my question a bit.  this is in relation to VBA that ultimately writes to an excel sheet.  if i hit the sheet to update every value or even in big chunks of values at a time, it takes forever.  when i moved from storing every value individually to placing them on the sheet in blocks, the performance increased substantially.  i&#39;m hoping to find a way to do the same thing but combining the arrays even further in VBA."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444166823, "post_id": 32979838, "comment_id": 53785591, "body": "The <code>Redim PRESERVE</code> command can only expand the last <i>rank</i>. You are probably better to create a new array dimmed with the addition of the UBounds and populating then from there. Stay away from <code>.Transpose</code> to accomplish a redim. Your 100K &#39;rows&#39; of data exceeds its limitations."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1444166954, "post_id": 32979838, "comment_id": 53785658, "body": "@BruceWayne Arrays, even in VBA, can have multiple dimensions. This is a 2-dimensional array which visually would look like a group of cells. <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">See this</a> for more information"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1444172702, "post_id": 32979838, "comment_id": 53787874, "body": "@BruceWayne Holy cow, Batman. Arrays in VBA are absolutely stored as an OLE construct known as the SAFEARRAY. Read this: <a href=\"http://www.roblocher.com/whitepapers/oletypes.html\" rel=\"nofollow noreferrer\">roblocher.com/whitepapers/oletypes.html</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444227544, "post_id": 32979838, "comment_id": 53814101, "body": "@ExcelHero and Jeeped - well thanks a lot for those links, I had no idea!"}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1444171937, "post_id": 32980171, "comment_id": 53787607, "body": "this works by placing the data on a worksheet in the proper locations.  i&#39;m already doing something like this and it takes a long time to place all the data.  i&#39;d like to do exactly this in the VBA code (ie - memory) and then dump it all onto the sheet in one shot.  i&#39;m adding another clarification above to demonstrate."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1444167347, "creation_date": 1444167347, "answer_id": 32980171, "question_id": 32979838, "link": "https://stackoverflow.com/questions/32979838/combining-2d-2-dimensional-arrays/32980171#32980171", "title": "Combining 2D (2-dimensional) arrays", "body": "<p>You could try re-sizing the destination to match the array's dimensions. Something along the lines of:</p>\n\n<p><em>(assuming your arrays are called 'Array1' and 'Array2')...</em></p>\n\n<pre><code>With Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(IIf(IsEmpty([A1]), 0, 1), 0)\n    .Resize(UBound(Array1, 1) - LBound(Array1, 1) + 1, _\n            UBound(Array1, 2) - LBound(Array1, 2) + 1).Value = Array1\nEnd With\n\nWith Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(IIf(IsEmpty([A1]), 0, 1), 0)\n    .Resize(UBound(Array2, 1) - LBound(Array2, 1) + 1, _\n            UBound(Array2, 2) - LBound(Array2, 2) + 1).Value = Array2\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1444173561, "post_id": 32980900, "comment_id": 53788089, "body": "that works perfectly for this example.  great answer."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 8, "last_activity_date": 1444170800, "creation_date": 1444170800, "answer_id": 32980900, "question_id": 32979838, "link": "https://stackoverflow.com/questions/32979838/combining-2d-2-dimensional-arrays/32980900#32980900", "title": "Combining 2D (2-dimensional) arrays", "body": "<p>Here is a VBA function that can combine two 2-dimensional arrays into a single 2-dimensional array. It can be used either from VBA or as an array-formula directly in Excel. Iteration is unavoidable here in VBA since the language doesn't have primitives for things like concatenating arrays:</p>\n\n<pre><code>Function Combine(A As Variant, B As Variant, Optional stacked As Boolean = True) As Variant\n    'assumes that A and B are 2-dimensional variant arrays\n    'if stacked is true then A is placed on top of B\n    'in this case the number of rows must be the same,\n    'otherwise they are placed side by side A|B\n    'in which case the number of columns are the same\n    'LBound can be anything but is assumed to be\n    'the same for A and B (in both dimensions)\n    'False is returned if a clash\n\n    Dim lb As Long, m_A As Long, n_A As Long\n    Dim m_B As Long, n_B As Long\n    Dim m As Long, n As Long\n    Dim i As Long, j As Long, k As Long\n    Dim C As Variant\n\n    If TypeName(A) = \"Range\" Then A = A.Value\n    If TypeName(B) = \"Range\" Then B = B.Value\n\n    lb = LBound(A, 1)\n    m_A = UBound(A, 1)\n    n_A = UBound(A, 2)\n    m_B = UBound(B, 1)\n    n_B = UBound(B, 2)\n\n    If stacked Then\n        m = m_A + m_B + 1 - lb\n        n = n_A\n        If n_B &lt;&gt; n Then\n            Combine = False\n            Exit Function\n        End If\n    Else\n        m = m_A\n        If m_B &lt;&gt; m Then\n            Combine = False\n            Exit Function\n        End If\n        n = n_A + n_B + 1 - lb\n    End If\n    ReDim C(lb To m, lb To n)\n    For i = lb To m\n        For j = lb To n\n            If stacked Then\n                If i &lt;= m_A Then\n                    C(i, j) = A(i, j)\n                Else\n                    C(i, j) = B(lb + i - m_A - 1, j)\n                End If\n            Else\n                If j &lt;= n_A Then\n                    C(i, j) = A(i, j)\n                Else\n                    C(i, j) = B(i, lb + j - n_A - 1)\n                End If\n            End If\n        Next j\n    Next i\n    Combine = C\nEnd Function\n</code></pre>\n\n<p>I tested it in 4 different ways. First I entered your two example arrays in the spreadsheets and used <code>Combine</code> directly in excel as an array formula:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PMjz9.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/PMjz9.gif\" alt=\"enter image description here\"></a>    </p>\n\n<p>Here A7:C10 contains the array formula </p>\n\n<pre><code>{=combine(A1:C2,A4:C5)}\n</code></pre>\n\n<p>and A12:F13 contains the array formula</p>\n\n<pre><code>{=combine(A1:C2,A4:C5,FALSE)}\n</code></pre>\n\n<p>Then, I ran the following sub:</p>\n\n<pre><code>Sub test()\n    Dim A As Variant, B As Variant\n    ReDim A(0 To 1, 0 To 1)\n    ReDim B(0 To 1, 0 To 1)\n    A(0, 0) = 1\n    A(0, 1) = 2\n    A(1, 0) = 3\n    A(1, 1) = 4\n    B(0, 0) = 5\n    B(0, 1) = 6\n    B(1, 0) = 7\n    B(1, 1) = 8    \n    Range(\"A15:B18\").Value = Combine(A, B)\n    Range(\"C15:F16\").Value = Combine(A, B, False)    \nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jw1S7.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jw1S7.gif\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1444176548, "post_id": 32981621, "comment_id": 53788915, "body": "Interesting approach. I&#39;ve done this sort of thing (add and then delete a sheet to process an array) for sorting an array. It would be interesting to do some timing tests to see how the speed compares with the VBA-only approach."}, {"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1444180206, "post_id": 32981621, "comment_id": 53789740, "body": "good point.  i suppose shutting off the screen updating (and any calculation) would really speed things up as well.  kindof a unique solution   also this helps prevent (or workaround) any sort of issues related to type mismatches with different types of data in arrays."}, {"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "edited": false, "score": 0, "creation_date": 1475847527, "post_id": 32981621, "comment_id": 67121126, "body": "Compiling the code gives an error because the variable <code>b</code> is not declared. <code>.[a1].Resize(n1, n2).Offset(m1) = b</code> is incorrect. Please replace the <code>b</code> at the end of the line 7 by <code>n</code>"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "edited": false, "score": 0, "creation_date": 1475859421, "post_id": 32981621, "comment_id": 67128407, "body": "@OscarAnthony Good catch. Fixed it."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 2, "last_activity_date": 1475859404, "last_edit_date": 1475859404, "creation_date": 1444175674, "answer_id": 32981621, "question_id": 32979838, "link": "https://stackoverflow.com/questions/32979838/combining-2d-2-dimensional-arrays/32981621#32981621", "title": "Combining 2D (2-dimensional) arrays", "body": "<blockquote>\n  <p>If possible, I'd prefer a solution that does not require iteration.</p>\n</blockquote>\n\n<p>Try this:</p>\n\n<pre><code>Function Combine(m, n)\n    Dim m1&amp;, m2&amp;, n1&amp;, n2&amp;\n    m1 = UBound(m, 1): m2 = UBound(m, 2)\n    n1 = UBound(n, 1): n2 = UBound(n, 2)\n    With Worksheets.Add\n        .[a1].Resize(m1, m2) = m\n        .[a1].Resize(n1, n2).Offset(m1) = n\n        Combine = .[a1].Resize(m1 + n1, m2)\n        Application.DisplayAlerts = False\n        Application.ScreenUpdating = False\n        .Delete\n        Application.DisplayAlerts = True\n        Application.ScreenUpdating = True\n    End With\nEnd Function\n</code></pre>\n\n<p>Note: this is just a demo to show proof of concept. Currently it does vertical stacking of two 2d arrays. Simple to modify to also do horizontal stacking.</p>\n\n<p>Note: I'm typically opposed to this sort of thing, but if you think about it, an Excel sheet is analogous to a really big 2d array and while this is indeed a sleghammer approach, it is quick and there is no iteration!</p>\n"}], "owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7229, "favorite_count": 8, "accepted_answer_id": 32980900, "answer_count": 3, "score": 4, "last_activity_date": 1475859404, "creation_date": 1444165892, "last_edit_date": 1444173785, "question_id": 32979838, "link": "https://stackoverflow.com/questions/32979838/combining-2d-2-dimensional-arrays", "title": "Combining 2D (2-dimensional) arrays", "body": "<p>I am using VBA in Excel to consume an XML file and dump specific information into individual tabs.  I want to be able to combine 2-dimensional arrays.  The arrays have a \"known\" number of columns but an \"unknown\" number of rows. Consider the following two arrays:</p>\n\n<p>array1:</p>\n\n<pre><code>a    b    c\nd    e    f\n</code></pre>\n\n<p>array2:</p>\n\n<pre><code>1    2    3\n4    5    6\n</code></pre>\n\n<p>How do I combine these to arrays if I want the following result:</p>\n\n<p>array3:</p>\n\n<pre><code>a    b    c\nd    e    f\n1    2    3\n4    5    6\n</code></pre>\n\n<p>And just out of curiosity, how would I code if instead I wanted to add to the right instead of the bottom, like this:</p>\n\n<p>array4:</p>\n\n<pre><code>a    b    c    1    2    3\nd    e    f    4    5    6\n</code></pre>\n\n<p>I can't seem to find the answer to this anywhere.</p>\n\n<p>Please keep in mind my example above is rather small, but in reality, I'm trying to do this with approx 100,000 rows of data at once.  There are only six columns of data, if that matters.</p>\n\n<p>The goal here is to assemble a large array and then write it to an Excel sheet all in one step because when I do it in pieces the performance is really poor.</p>\n\n<p>If possible, I'd prefer a solution that does not require iteration.</p>\n\n<p>The reason I ask about both ways is that in reality I want to add kind of sequentially.  For instance, assume I have four arrays, A, B, C, D.</p>\n\n<p>First, add array A:</p>\n\n<pre><code>A\n</code></pre>\n\n<p>Then, add array B:</p>\n\n<pre><code>A    B\n</code></pre>\n\n<p>Then, add array C:</p>\n\n<pre><code>A    B\nC\n</code></pre>\n\n<p>Then, add array D:</p>\n\n<pre><code>A    B\nC    D\n</code></pre>\n\n<p>and so forth...</p>\n\n<p>Keep in mind that each of the above arrays would be sized such that they \"fit\" correctly meaning A and B have the same number of rows, but different number of columns.  A and C on the other hand have the same number of columns but a different number of rows.  And so on...</p>\n\n<p>I wanted to add a demonstration using Macro Man's code from below. Here is what he provided (I added a bit so readers can just copy/paste):</p>\n\n<pre><code>Option Explicit\n\nSub Testing()\n\n    Dim Array1(0 To 1, 0 To 2) As String\n    Array1(0, 0) = \"a\"\n    Array1(0, 1) = \"b\"\n    Array1(0, 2) = \"c\"\n    Array1(1, 0) = \"d\"\n    Array1(1, 1) = \"e\"\n    Array1(1, 2) = \"f\"\n\n    Dim Array2(0 To 1, 0 To 2) As String\n    Array2(0, 0) = \"1\"\n    Array2(0, 1) = \"2\"\n    Array2(0, 2) = \"3\"\n    Array2(1, 0) = \"4\"\n    Array2(1, 1) = \"5\"\n    Array2(1, 2) = \"6\"\n\n    Dim i As Long\n    For i = 1 To 25000\n\n        With Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(IIf(IsEmpty([A1]), 0, 1), 0)\n            .Resize(UBound(Array1, 1) - LBound(Array1, 1) + 1, _\n                    UBound(Array1, 2) - LBound(Array1, 2) + 1).Value = Array1\n        End With\n\n        With Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(IIf(IsEmpty([A1]), 0, 1), 0)\n            .Resize(UBound(Array2, 1) - LBound(Array2, 1) + 1, _\n                    UBound(Array2, 2) - LBound(Array2, 2) + 1).Value = Array2\n        End With\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>When you run the above code, which goes back to the spreadsheet each time to write the small amount of data, this takes a long time to run.  On my dual Xeon machine, like 25-30 seconds.</p>\n\n<p>However, if you rewrite and populate the array FIRST, then write to the spreadsheet ONCE, it runs in about one second.</p>\n\n<pre><code>Option Explicit\n\nSub Testing()\n\n    Dim Array1(0 To 99999, 0 To 2) As String\n    Array1(0, 0) = \"a\"\n    Array1(0, 1) = \"b\"\n    Array1(0, 2) = \"c\"\n    Array1(1, 0) = \"d\"\n    Array1(1, 1) = \"e\"\n    Array1(1, 2) = \"f\"\n\n    Dim i As Long\n    For i = 0 To 99999\n\n        Array1(i, 0) = \"a\"\n        Array1(i, 1) = \"b\"\n        Array1(i, 2) = \"c\"\n\n    Next i\n\n    With Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(IIf(IsEmpty([A1]), 0, 1), 0)\n        .Resize(UBound(Array1, 1) - LBound(Array1, 1) + 1, _\n                UBound(Array1, 2) - LBound(Array1, 2) + 1).Value = Array1\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I would like to see a solution which does the same thing, except being able to add \"chunks\" of data instead of individual items.  Adding arrays to bigger arrays, ideally.  Even better would be if the \"parent\" array somehow dynamically resized itself.</p>\n\n<p>John Coleman's answer below worked great.</p>\n\n<p>I actually combined a bit of Macro Man's with John's test() subroutine and this dynamically re-sizes the range:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim A As Variant, B As Variant\n    ReDim A(0 To 1, 0 To 1)\n    ReDim B(0 To 1, 0 To 1)\n    A(0, 0) = 1\n    A(0, 1) = 2\n    A(1, 0) = 3\n    A(1, 1) = 4\n    B(0, 0) = 5\n    B(0, 1) = 6\n    B(1, 0) = 7\n    B(1, 1) = 8\n\n    Dim Array1 As Variant\n    Array1 = Combine(A, B)\n\n    With Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(IIf(IsEmpty([A1]), 0, 1), 0)\n    .Resize(UBound(Array1, 1) - LBound(Array1, 1) + 1, _\n            UBound(Array1, 2) - LBound(Array1, 2) + 1).Value = Array1\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444166042, "post_id": 32979601, "comment_id": 53785177, "body": "It only happens when a filter is left on... What should I do?"}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1444166371, "post_id": 32979601, "comment_id": 53785369, "body": "if I remove the filter manually or with code before I click on Exit file it works fine...but I can&#39;t rely on the user to remember to remove the filter because I know they will forget and I will be in trouble."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444166601, "post_id": 32979601, "comment_id": 53785479, "body": "Ah, I see, I was filtering then turning off the filter and the darn things disappear."}, {"owner": {"reputation": 171, "user_id": 1731551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d680690f1e99f62be249c270f588c?s=128&d=identicon&r=PG", "display_name": "therak", "link": "https://stackoverflow.com/users/1731551/therak"}, "edited": false, "score": 0, "creation_date": 1444203740, "post_id": 32979601, "comment_id": 53797749, "body": "@user3781528 had a similar problem with checkboxes and Dropdownlists: Those Controls aren&#39;t deleted - they still exist - but their dimensions are 0 when the control is on a cell which is hidden. As soon as you close the workbook the control will save those dimension and won&#39;t be relocated when opening the workbook again. my workaround was to unfilter the data before close and save the filter information. On the Workbook open event i set the filter again, everything worked fine afterwards - no problems since then."}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1444265285, "post_id": 32979601, "comment_id": 53834315, "body": "It&#39;s starting to make sense. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1444171413, "post_id": 32980054, "comment_id": 53787440, "body": "How is it different from <code>If (ActiveSheet.AutoFilterMode And</code> <code>ActiveSheet.FilterMode) Or ActiveSheet.FilterMode Then</code>   <code>ActiveSheet.ShowAllData</code> ?"}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1444171666, "post_id": 32980054, "comment_id": 53787514, "body": "Did you call this code from Workbook_BeforeClose?  Thanks"}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1444172922, "post_id": 32980054, "comment_id": 53787935, "body": "Sorry, I&#39;ve tried calling your code from Workbook_BeforeClose without any luck."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1444166847, "creation_date": 1444166847, "answer_id": 32980054, "question_id": 32979601, "link": "https://stackoverflow.com/questions/32979601/check-boxes-are-deleted-when-a-workbook-is-saved/32980054#32980054", "title": "Check boxes are deleted when a workbook is saved", "body": "<p>When I Showed all data, then Turn off autofilter the textboxes seem to go back into place, I do see this has been an issue for a while. This worked for me Showing all data then Turning off filter. There may have to be some error checking as well.</p>\n\n<pre><code>With ActiveSheet\n    If .AutoFilterMode = True Then\n        .ShowAllData\n        .AutoFilterMode = False\n    End If\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1444228061, "post_id": 32982288, "comment_id": 53814505, "body": "Thanks, I get an error (Run-time error &#39;1004&#39; Select Method of Range Class failed) on line <code>ws.Cells(1, 1).Select</code> of removeAutoFilter sub."}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1444228724, "post_id": 32982288, "comment_id": 53815025, "body": "Paul, If you remove all checkboxes and add them back before the Workbook closes what will happen to the True/False designation in column B?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1444257393, "post_id": 32982288, "comment_id": 53832068, "body": "I updated it with a new solution that preserves the True\\False values of all check boxes"}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1444264710, "post_id": 32982288, "comment_id": 53834169, "body": "which version of addAllCheckboxes should I use old/new?  I don&#39;t think I need removeAllCheckboxes sub any longer, correct? Thanks, I will test tomorrow morning."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1444266846, "post_id": 32982288, "comment_id": 53834755, "body": "The addAllCheckboxes and removeAllCheckboxes are not needed anymore (there are no significant changes between old and new other than calling them for cleanup). You can still call them individually if you need to reset all objects"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 3, "last_activity_date": 1444440035, "last_edit_date": 1495542579, "creation_date": 1444180965, "answer_id": 32982288, "question_id": 32979601, "link": "https://stackoverflow.com/questions/32979601/check-boxes-are-deleted-when-a-workbook-is-saved/32982288#32982288", "title": "Check boxes are deleted when a workbook is saved", "body": "<p>Being related to <a href=\"https://stackoverflow.com/a/31374719/4914662\">this solution</a>, the check boxes are not deleted when you close the file:</p>\n\n<ul>\n<li>when using the Autofilter the boxes are moved with the hidden rows (on top of each other)</li>\n</ul>\n\n<p>To solve the issue make the following changes:</p>\n\n<p>.</p>\n\n<p>Replace the code in <strong>ThisWorkbook</strong> with this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n    Application.OnKey \"^m\", \"LoadForm\"\n    setSheets\nEnd Sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Application.OnKey \"^m\"\n    removeAutoFilter\n    ThisWorkbook.Save\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>.</p>\n\n<p>In VBA module <strong>modReport</strong> add 2 Subs:</p>\n\n<pre><code>Public Sub removeAutoFilter()\n    Dim ws As Worksheet, lRow As Range, cRow As Long, thisWs As Worksheet, cbN As String\n    Dim l As Double, r As Double, aSet As Byte, s1 As Boolean, s2 As Boolean\n    Dim tbl As ListObject, done As Boolean, isUsed As Boolean\n\n    Application.ScreenUpdating = False: setSheets\n\n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Name = wsColon.Name Or ws.Name = wsLung.Name Or ws.Name = wsMela.Name Then\n            If Not ws.AutoFilter Is Nothing Then\n                For Each tbl In ws.ListObjects\n                    tbl.Range.AutoFilter: tbl.Range.AutoFilter: done = True\n                Next\n                If Not done Then ws.UsedRange.AutoFilter: ws.UsedRange.AutoFilter\n            End If\n            For Each lRow In ws.UsedRange.Rows\n                With lRow\n                    cRow = .Row:  isUsed = Len(.Cells(1, EMPTY_ROW_CHECK_3).Value2) &gt; 0\n                    If (cRow &gt; 2 And isUsed) Or (cRow &gt; 2 And .Cells(1, 3).Value &gt; 0) Then\n                        getAlignment .Cells(1, 2), l, r\n                        cbN = IIf(cRow &lt; 10, \"_0\" &amp; cRow, \"_\" &amp; cRow)\n                        If cRow = 3 Then\n                            s1 = ws.CheckBoxes(\"cb\" &amp; SET_Name1 &amp; 1 &amp; cbN).Visible\n                            s2 = ws.CheckBoxes(\"cb\" &amp; SET_Name1 &amp; 2 &amp; cbN).Visible\n                            aSet = IIf(s1, IIf(s2, 3, 1), 2)\n                        End If\n                        restCB ws, \"cb\" &amp; SET_Name1 &amp; 1 &amp; cbN, .Top, l - 1\n                        restCB ws, \"cb\" &amp; SET_Name1 &amp; 2 &amp; cbN, .Top, r + 7\n                    End If\n                End With\n            Next\n        End If\n    Next\n    Application.ScreenUpdating = True\n    updateSet aSet\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub restCB(ByRef ws As Worksheet, cbN As String, t As Double, l As Double)\n    Dim cb As Shape\n    For Each cb In ws.Shapes\n        With cb\n            If .Name = cbN Then\n                .Visible = True\n                .Top = t\n                .Left = l\n                Exit For\n            End If\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<ul>\n<li>It removes any filter on all sheets, and resets data to AutoFiltered</li>\n<li>Determines the active set (1, 2, or 3)</li>\n<li>Un-hides all check boxes (both sets)</li>\n<li>Realigns them vertically, and horizontally based on current row</li>\n<li>Re-initializes active set</li>\n<li>Saves file before closing</li>\n</ul>\n"}], "owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 32982288, "answer_count": 2, "score": 1, "last_activity_date": 1444440035, "creation_date": 1444165035, "last_edit_date": 1531164843, "question_id": 32979601, "link": "https://stackoverflow.com/questions/32979601/check-boxes-are-deleted-when-a-workbook-is-saved", "title": "Check boxes are deleted when a workbook is saved", "body": "<p>Column B contains checkboxes.  My data organized in table format.  I've noticed if I filter the data and then close and save the file, the checkboxes from rows that were hidden are deleted.  I've added a routine that removes the filters from all worksheets before the workbook is closed but it still deletes the checkboxes. It appears that the checkboxes are deleted when the workbook is saved.  Please help fix this problem.</p>\n\n<p>Thank you</p>\n\n<p>Code I used to remove the filter (removeAllFilters)</p>\n\n<pre><code>If (ActiveSheet.AutoFilterMode And ActiveSheet.FilterMode) Or ActiveSheet.FilterMode Then\n  ActiveSheet.ShowAllData  \n</code></pre>\n\n<p>The sub is called in the Workbook_beforeClose </p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    Call removeAllFilters\n    Application.OnKey \"^m\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1444163842, "creation_date": 1444163842, "answer_id": 32979289, "question_id": 32979039, "link": "https://stackoverflow.com/questions/32979039/loop-through-cells-and-copy-data-to-the-next-5-cells-if-there-is-data/32979289#32979289", "title": "loop through cells and copy data to the next 5 cells if there is data", "body": "<p>I would do this by using RC notation and looping something like this:</p>\n\n<pre><code>dim myValue\ndim c as integer\ndim x as integer\n\nc=4 'Start in column D\nmyValue = cells(1,c).value 'Row 1 of column D\nwhile myValue &lt;&gt; \"\"\n    for x = 1 to 5\n        cells(1,c+x).value=myValue\n    next x\n    c=c+x+1 'To give us the 10th column: J\n    myValue = cells(1,c).value\nwend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1444164054, "creation_date": 1444164054, "answer_id": 32979347, "question_id": 32979039, "link": "https://stackoverflow.com/questions/32979039/loop-through-cells-and-copy-data-to-the-next-5-cells-if-there-is-data/32979347#32979347", "title": "loop through cells and copy data to the next 5 cells if there is data", "body": "<p>Consider the following to first find the last column in spreadsheet and iterate every 5 columns using <code>Cells(r, c)</code> reference for numbering:</p>\n\n<pre><code>Sub CopyNextFive()\n\n    LastColumn = ActiveSheet.UsedRange.Columns(ActiveSheet.UsedRange.Columns.Count).Column\n\n    For i = 4 To LastColumn Step 6\n        Cells(1, i).Copy\n        Range(Cells(1, i + 1), Cells(1, i + 5)).PasteSpecial xlPasteAll            \n    Next i        \n    Application.CutCopyMode = False       \n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 3214725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66299c5e690345a3ddacefc4f2c60b80?s=128&d=identicon&r=PG&f=1", "display_name": "user3214725", "link": "https://stackoverflow.com/users/3214725/user3214725"}, "edited": false, "score": 0, "creation_date": 1444166767, "post_id": 32979360, "comment_id": 53785560, "body": "thank you very much ASH your code works perfect as well"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1444164093, "creation_date": 1444164093, "answer_id": 32979360, "question_id": 32979039, "link": "https://stackoverflow.com/questions/32979039/loop-through-cells-and-copy-data-to-the-next-5-cells-if-there-is-data/32979360#32979360", "title": "loop through cells and copy data to the next 5 cells if there is data", "body": "<pre><code>Sub mySub()\n    Dim src As Range: Set src = ActiveSheet.Range(\"D1\")\n    Dim dest As Range: Set dest = ActiveSheet.Range(\"E1:I1\")\n    Do Until Trim(src.Text) = vbNullString\n        src.Copy dest\n        Set src = src.Offset(, 6): Set dest = dest.Offset(, 6)\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 1, "last_activity_date": 1444167122, "creation_date": 1444167122, "answer_id": 32980127, "question_id": 32979039, "link": "https://stackoverflow.com/questions/32979039/loop-through-cells-and-copy-data-to-the-next-5-cells-if-there-is-data/32980127#32980127", "title": "loop through cells and copy data to the next 5 cells if there is data", "body": "<p>You'd need to run some form of loop. There are several kinds: <code>For ... Next</code>, <code>Do Until ...</code>, etc. Have a read about them (<a href=\"http://www.excelfunctions.net/VBA-Loops.html\" rel=\"nofollow\">http://www.excelfunctions.net/VBA-Loops.html</a>) and you'll see they give you great versatility.</p>\n\n<p>In your case, one of many solutions could be as follows:</p>\n\n<pre><code>' Adjust these values to suit\nConst SHEET_NAME As String = \"Sheet1\" 'name of sheet\nConst START_COLUMN As String = \"D\" 'column letter where routine starts\nConst ROW_NUM As Long = 1 'row number of your data\nConst COPY_SIZE As Integer = 5 'number of columns to copy the data\nDim rng As Range\n\n' The looping routine\nSet rng = ThisWorkbook.Worksheets(SHEET_NAME).Cells(ROW_NUM, START_COLUMN)\nDo Until IsEmpty(rng)\n    rng.Offset(, 1).Resize(, COPY_SIZE) = rng.Value2\n    Set rng = rng.Offset(, COPY_SIZE + 1)\nLoop\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 3214725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66299c5e690345a3ddacefc4f2c60b80?s=128&d=identicon&r=PG&f=1", "display_name": "user3214725", "link": "https://stackoverflow.com/users/3214725/user3214725"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1706, "favorite_count": 0, "accepted_answer_id": 32979347, "answer_count": 4, "score": 0, "last_activity_date": 1444167122, "creation_date": 1444163007, "last_edit_date": 1531164843, "question_id": 32979039, "link": "https://stackoverflow.com/questions/32979039/loop-through-cells-and-copy-data-to-the-next-5-cells-if-there-is-data", "title": "loop through cells and copy data to the next 5 cells if there is data", "body": "<p>good afternoon, </p>\n\n<p>I have a worksheet where I need a macro to copy the value from D1 and paste it to the next 5 cells (paste it to E1:I1), then if the next cell has data (J1) copy it and paste it to the next five cells etc. until the next cell is blank (the  problem is that every time this spreadsheet has a different number of columns). I did try to do this with macro recorder but I have to set every time the cells that I want to copy the data from and the cells that I will paste them to. There must be an easier way than this, any help would be appreciated.\n<code>Range(\"D1\").Select\n    Selection.Copy\n    Range(\"E1:I1\").Select\n    ActiveSheet.Paste\n    Range(\"J1\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"K1\").Select\n    ActiveWindow.SmallScroll ToRight:=10\n    Range(\"K1:O1\").Select\n    ActiveSheet.Paste\n    Range(\"P1\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"Q1:U1\").Select\n    ActiveSheet.Paste\n    Range(\"V1\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    ActiveWindow.SmallScroll ToRight:=12\n    Range(\"W1\").Select\n    ActiveSheet.Paste\n    Range(\"X1:AA1\").Select\n    ActiveSheet.Paste\n    Range(\"AB1\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"AC1:AG1\").Select\n    ActiveSheet.Paste\n    ActiveWindow.SmallScroll ToRight:=8\n    Range(\"AH1\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"AI1:AM1\").Select\n    ActiveSheet.Paste\n    Range(\"AN1\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"AO1:AS1\").Select\n    ActiveSheet.Paste</code></p>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1444164136, "post_id": 32979019, "comment_id": 53784105, "body": "Have you tried any code? If not, try recording a macro and see how it does it. That should give you an indication of what to do in your code. Then if you get stuck come back with the code you made and we&#39;ll help you fix it (because SO is not a code request site)."}, {"owner": {"reputation": 47, "user_id": 4462013, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6Zh9p.jpg?s=128&g=1", "display_name": "Miksoko", "link": "https://stackoverflow.com/users/4462013/miksoko"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1444164382, "post_id": 32979019, "comment_id": 53784229, "body": "I&#39;d like to clarify that I&#39;m in no means looking for someone to write this for me- rather, I&#39;d like direction in methods you&#39;ve used before, commands that have worked well. For example, I didn&#39;t even know you could record a macro- the avenues I&#39;ve taken before never made me realize I could. I&#39;m looking in to that now"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1444165720, "last_edit_date": 1444165720, "creation_date": 1444165149, "answer_id": 32979636, "question_id": 32979019, "link": "https://stackoverflow.com/questions/32979019/sort-multiple-columns-by-one-column/32979636#32979636", "title": "Sort multiple columns by one column", "body": "<p>The code produce by the recorder on a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow\">Range.Sort method</a> is very verbose and can be chopped down quite a bit to what is essential.</p>\n\n<p>If columns A:C were <em>Name, Email, Date Added</em> then this will sort by <em>Name</em> first, then <em>Date Added</em>.</p>\n\n<pre><code>with worksheets(\"sheet1\")    '&lt;~~ set this properly!\n    with .cells(1, 1).currentregion    '&lt;~~ assumes data starts in A2 with a header row in A1:C1\n        .Cells.Sort Key1:=.Columns(1), Order1:=xlAscending, _\n                    Key2:=.Columns(3), Order2:=xlAscending, _\n                    Orientation:=xlTopToBottom, Header:=xlYes\n    end with\nend with\n</code></pre>\n\n<p>This will sort by <em>Date Added</em> first, then <em>Name</em>.</p>\n\n<pre><code>with worksheets(\"sheet1\")    '&lt;~~ set this properly!\n    with .cells(1, 1).currentregion    '&lt;~~ assumes data starts in A2 with a header row in A1:C1\n        .Cells.Sort Key1:=.Columns(3), Order1:=xlAscending, _\n                    Key2:=.Columns(1), Order2:=xlAscending, _\n                    Orientation:=xlTopToBottom, Header:=xlYes\n    end with\nend with\n</code></pre>\n\n<p>You can have up to 3 <em>keys</em>. Any more than that and you have to run the routine twice. The opposite of <code>xlAscending</code> is of course <code>xlDescending</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 5405585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156020710130411/picture?type=large", "display_name": "siegeMind", "link": "https://stackoverflow.com/users/5405585/siegemind"}, "is_accepted": false, "score": 0, "last_activity_date": 1444165223, "creation_date": 1444165223, "answer_id": 32979656, "question_id": 32979019, "link": "https://stackoverflow.com/questions/32979019/sort-multiple-columns-by-one-column/32979656#32979656", "title": "Sort multiple columns by one column", "body": "<p>The best way I've found to find something that's already on the toolbar is to use the \"Macro Recorder\" in a blank/new workbook, and then look at the code. </p>\n\n<p>Are the columns adjacent to each other? Because if so you can use something like this;</p>\n\n<pre><code>//Alright, so this is if you wanted each of the columns to have their\n//own values that you are sorting by, if you just want one criteria, \n//just use one of the lines\nDim varName as String\nDim varDate as String\nDim varExtra as String\n\nActiveSheet.Range(\"A:C\").AutoFilter Field:=1, Criteria1:=varName\nActiveSheet.Range(\"A:C\").AutoFilter Field:=2, Criteria1:=varDate\nActiveSheet.Range(\"A:C\").AutoFilter Field:=3, Criteria1:=varExtra\n</code></pre>\n\n<p>Basically, it's saying for the three columns given, go find the field (which will correspond to a column) indicated and filter by the criteria. You can also use a string value in the Criteria spot instead of a variable.</p>\n"}], "owner": {"reputation": 47, "user_id": 4462013, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6Zh9p.jpg?s=128&g=1", "display_name": "Miksoko", "link": "https://stackoverflow.com/users/4462013/miksoko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2999, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1444179709, "creation_date": 1444162959, "last_edit_date": 1444179709, "question_id": 32979019, "link": "https://stackoverflow.com/questions/32979019/sort-multiple-columns-by-one-column", "title": "Sort multiple columns by one column", "body": "<p>I'm making an email list in Excel with three columns. On the worksheet, I have two buttons, \"sort by Name\" and \"sort by Date added\". I would like to sort all three columns by the button chosen so I can find entries faster (I am also entering a separate lookup function later).</p>\n\n<p>Basically, I want the sort function that's already on the toolbar in the worksheet where you can just press it and it knows which column to sort by already. I've seen things for macros and for VBA but all of them are sorting columns by separate parameters, whereas I need these columns linked.</p>\n"}, {"tags": ["arrays", "vba", "excel", "printing"], "comments": [{"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1444163319, "post_id": 32978964, "comment_id": 53783595, "body": "You could write a general sub that let you pass in worksheets, then loop through them, looking up the correct print area etc from somewhere else (or a collection defined in the sub).  But given the small number of sheets involved and the fact that the print areas and setup is hard coded separately for each of them anyway, I think your approach is fine.  Unless it may need to be extended in future?"}, {"owner": {"reputation": 27, "user_id": 4670912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ebd6f197bda3fc60f7add80a47b6cf3?s=128&d=identicon&r=PG&f=1", "display_name": "ken.b89", "link": "https://stackoverflow.com/users/4670912/ken-b89"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1444290184, "post_id": 32978964, "comment_id": 53842992, "body": "Thanks @aucuparia Yeah I agree, for the amount of tabs i think I will just proceed with the above code. Thanks for giving it a look over!"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4670912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ebd6f197bda3fc60f7add80a47b6cf3?s=128&d=identicon&r=PG&f=1", "display_name": "ken.b89", "link": "https://stackoverflow.com/users/4670912/ken-b89"}, "edited": false, "score": 0, "creation_date": 1444290567, "post_id": 32981987, "comment_id": 53843237, "body": "Thanks @paul bica, I&#39;m really interested to get this work. When I ran it through it through the VBA and got back the Compile error: ByRef argument type mismatch for the Public Sub setPrintInfo (). Is there something I should do prior running the code? Thanks"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 27, "user_id": 4670912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ebd6f197bda3fc60f7add80a47b6cf3?s=128&d=identicon&r=PG&f=1", "display_name": "ken.b89", "link": "https://stackoverflow.com/users/4670912/ken-b89"}, "edited": false, "score": 0, "creation_date": 1444307404, "post_id": 32981987, "comment_id": 53854527, "body": "I fixed the type mismatch issue - changed r1 and r2 to Variants, and added Val() for  wsSz to send it as long. I tested and it seems to work but I don&#39;t have a printer setup (I&#39;m not sure about <code>.PrintOut</code> and <code>.PaperSize = sz</code>)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1444307126, "last_edit_date": 1444307126, "creation_date": 1444178662, "answer_id": 32981987, "question_id": 32978964, "link": "https://stackoverflow.com/questions/32978964/print-specific-worksheets-in-excel-with-different-print-areas-and-print-setup-u/32981987#32981987", "title": "Print specific worksheets in Excel, with different print areas and print setup using VBA", "body": "<p>I'd make separate subs for each functionality, and place \"magic\" numbers at the top, as constants, for easier maintenance</p>\n\n<pre><code>Option Explicit\n\nPrivate Const WS_NAME   As String = \"Dataset\"\nPrivate Const WS_ID     As String = \"1 2 3 4 5 6\"           'Dataset &amp; #\nPrivate Const WS_RANGE1 As String = \"A1 A1 A1 A1 A1 A1\"     'First print Cell\nPrivate Const WS_RANGE2 As String = \"C5 X1 S5 X1 AA7 X1\"    'Last print Cell\nPrivate Const WS_SIZE   As String = \"9 9 9 9 8 9\"           'xlPaperA4=9, xlPaperA3=8\n\nPublic Sub printWSset()\n\n    setPrintInfo        'main setup and config\n\n    printSet \"1 3 5\"    'easy to change, independent of Worksheet setup\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub printSet(ByRef wsIDs As String)\n    Dim wsID As Variant\n\n    If Len(wsIDs) &gt; 0 Then\n        For Each wsID In Split(wsIDs)\n            ThisWorkbook.Worksheets(wsID).PrintOut Copies:=1\n        Next\n    End If\nEnd Sub\n\nPublic Sub setPrintInfo()\n    Dim wsName As Variant, wsR1 As Variant, wsR2 As Variant, wsSz As Variant, i As Long\n\n    wsName = Split(WS_ID)       'split string by default char (space); array base at 0\n    wsR1 = Split(WS_RANGE1)\n    wsR2 = Split(WS_RANGE2)\n    wsSz = Split(WS_SIZE)\n\n    For i = 0 To UBound(wsName)\n        setInfo WS_NAME &amp; wsName(i), wsR1(i), wsR2(i), Val(wsSz(i))\n    Next\nEnd Sub\n\nPrivate Sub setInfo(ByVal x As String, r1 As Variant, r2 As Variant, sz As Long)\n\n    With ActiveWorkbook.Worksheets(x).PageSetup\n        .PrintArea = r1 &amp; \":\" &amp; r2\n        .PaperSize = sz\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4670912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ebd6f197bda3fc60f7add80a47b6cf3?s=128&d=identicon&r=PG&f=1", "display_name": "ken.b89", "link": "https://stackoverflow.com/users/4670912/ken-b89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1842, "favorite_count": 0, "accepted_answer_id": 32981987, "answer_count": 1, "score": 2, "last_activity_date": 1444307126, "creation_date": 1444162743, "last_edit_date": 1531164843, "question_id": 32978964, "link": "https://stackoverflow.com/questions/32978964/print-specific-worksheets-in-excel-with-different-print-areas-and-print-setup-u", "title": "Print specific worksheets in Excel, with different print areas and print setup using VBA", "body": "<p>I have a workbook with 6 different worksheets. This workbook needs to give the user the option to print 2 different sets of reports. Option 1 will print worksheets 1, 3 and 5 and Option 2 will print worksheets 2, 4 and 6. Each worksheet will require a different print range and print set up. I have approached it like this and wanted to know if this is best way to approach it (I'm sure there is a better/correct way of doing it).</p>\n\n<pre><code>Sub printingSheets()\n\nDim Sh1 As Worksheet\nDim Sh3 As Worksheet\nDim Sh5 As Worksheet\n\nWith ThisWorkbook\n\nSet Sh1 = .Sheets(\u201cDataset1\u201d)\nSet Sh3 = .Sheets(\u201cDataset2\u201d)\nSet Sh5 = .Sheets(\u201cDataset3\u201d)\n\n\u2018Setting the print area\n\nSh1.PageSetup.PrintArea = \"$A$1:$C$5\"\nSh3.PageSetup.PrintArea = \"$A$1:$S$5\"\nSh5.PageSetup.PrintArea = \"$A$1:$AA$7\"\n\n\u2018Setting up the print setup\n\nSh1.PageSetup.PaperSize = xlPaperA4\nSh3.PageSetup.PaperSize = xlPaperA4\nSh5.PageSetup.PaperSize = xlPaperA3\n\n\u2018Print\n\nArray(Sh1, Sh3, Sh5).PrintOut Copies:=1\n\nEnd Sub\n</code></pre>\n\n<p>And then I would write a separate macro for the other sheets.</p>\n\n<p>Thanks to anyone willing to help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1444162600, "post_id": 32978800, "comment_id": 53783147, "body": "Is there a reason you cannot work with <code>arr2D</code> as a 2D array specifying <b>1</b> in the first rank? <code>arr2D(1, v)</code> would be equal to <code>arr1D(v)</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444163126, "post_id": 32978800, "comment_id": 53783502, "body": "btw, that would be <code>LBound(arr2D , 2)</code> and <code>UBound(arr2D , 2)</code> for the extents."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1444166006, "post_id": 32978800, "comment_id": 53785153, "body": "Looping will be about twice as fast as using INDEX() here"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1444223667, "post_id": 32978800, "comment_id": 53811063, "body": "Why bother converting? As @Jeeped pointed out, you don&#39;t need to, and any conversion/copy wastes time and space."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1446765946, "post_id": 32978800, "comment_id": 54893121, "body": "HAHA... tried it with <code>Application.Transpose(Application.Transpose(Rows(1)))</code> =&gt; same behavior... <code>=REPT(&quot;x&quot;,256)</code> pops up an error :D"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1446766403, "post_id": 32978800, "comment_id": 54893270, "body": "@Jeeped as shown in the link, he is giong to do use <code>Join</code>... knowing he&#39;ll do that =&gt; <code>For Each ...</code> &amp; <code>string = string &amp; [delimeter] &amp; [Each]</code> will be much faster... however... at least, it doesn&#39;t answer the question..."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 4629993, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153082965096469/picture?type=large", "display_name": "Keith Whatling", "link": "https://stackoverflow.com/users/4629993/keith-whatling"}, "is_accepted": false, "score": 0, "last_activity_date": 1446812088, "creation_date": 1446812088, "answer_id": 33566591, "question_id": 32978800, "link": "https://stackoverflow.com/questions/32978800/convert-a-2d-array-to-a-1d-array/33566591#33566591", "title": "Convert a 2D array to a 1D array", "body": "<p>by far the best way of getting anything from a cells into memory (an array) is to use an array variant. I think the problem you are having is with index not with your method.</p>\n\n<p>Hopefully this code should explain it.</p>\n\n<pre><code>Dim v_data As Variant\nDim rw As Long, cl As Long ' for row and column\nDim arr1d() As Variant\nDim count As Long\n\n' I'm going to use UsedRange to get the whole sheet  .UsedSheet\n' If you just want things from one row or column then just spec\n' activesheet.range(\"A1:A100\") or use cells()\nWith ActiveSheet.UsedRange\n  ReDim v_data(1 To .Rows.count, 1 To .Columns.count)\n  v_data = .Value\nEnd With\n\n'now we have all the things from that sheet.\n'so to convert to 1d array where the cell value is say = 1\nFor rw = LBound(v_data) To UBound(v_data)\n   For cl = LBound(v_data, 2) To UBound(v_data, 2) ' note the comma 2 for the second dimension bounds.\n       If v_data(rw, cl) = 1 Then\n           count = count + 1\n           ReDim Preserve arr1d(1 To count)\n           arr1d(count) = v_data(rw, cl)\n       End If\n   Next cl\nNext rw\n\nFor count = LBound(arr1d) To UBound(arr1d)\n    Debug.Print arr1d(count)\nNext count\n</code></pre>\n\n<p>now the trick is to farm this off to a function that takes a few args( a 2d range, what you are looking for in that range) and returns your list.</p>\n\n<p>To get your data back into a workbook</p>\n\n<pre><code>ActiveSheet.Cells(1, 1).Resize(UBound(arr1d), 1).Value = arr1d\n</code></pre>\n\n<p>make a range of the exact same size in terms of the bounds of your array and then ensuring you use <code>.value</code> just pop in the variant array.</p>\n"}], "owner": {"reputation": 2196, "user_id": 935614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ce6267e312f30fc7e7daaf0f16673911?s=128&d=identicon&r=PG", "display_name": "nixda", "link": "https://stackoverflow.com/users/935614/nixda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4359, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1446812088, "creation_date": 1444162219, "last_edit_date": 1490005093, "question_id": 32978800, "link": "https://stackoverflow.com/questions/32978800/convert-a-2d-array-to-a-1d-array", "title": "Convert a 2D array to a 1D array", "body": "<p>How do I work around the <em>255 characters per cell</em> limit when converting a range (= multidimensional array) to single dimensional array with the use of <code>Application.Index(array, row, column)</code>? </p>\n\n<p>The following truncated example reproduces the error: </p>\n\n<blockquote>\n  <p>Error 13. Type mismatch</p>\n</blockquote>\n\n<p>(The complete code is on <a href=\"https://superuser.com/a/978282/50173\">superuser where I tried to help another user</a>).</p>\n\n<h3>How to reproduce</h3>\n\n<ul>\n<li><p>Open a new Excel sheet and insert the formula <code>=REPT(\"x\",256)</code> to cell A1<br>\nThis creates a 256 characters long string which is just 1 character too long for the last step</p></li>\n<li><p>Open the VBA editor (<kbd>Alt</kbd>+<kbd>F11</kbd>) and paste the below code somewhere</p></li>\n<li><p>Execute the code line by line with <kbd>F8</kbd></p>\n\n<pre><code>Function StringLengthTest()       \n    Dim arr2D As Variant\n    Dim arr1D As Variant        \n    arr2D = Rows(1)\n    arr1D = Application.Index(arr2D, 1, 0)        \nEnd Function\n</code></pre></li>\n<li><p>You'll see the same error at the last line when Excel tries to convert a range (2D) to a 1D array while one of its cells has more than 255 characters.</p></li>\n</ul>\n\n<p>To prove this, change <code>=REPT(\"x\",256)</code> to <code>=REPT(\"x\",255)</code> and run the code again. This time it will work.</p>\n\n<p><strong>Question:</strong> Should I declare my variables in another way? Is there a better way to convert a range (which is always a 2D object at first) to a single dimensional array? </p>\n\n<p>I know I could use a loop to iterate through the arrays and save all 2D array values one by one to a 1D array. But that's not efficient. Imagine really large sheets. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5415564, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dKRMgUGBJFs/AAAAAAAAAAI/AAAAAAAAABQ/2UJJuTHMsI4/photo.jpg?sz=128", "display_name": "Scott Feldman", "link": "https://stackoverflow.com/users/5415564/scott-feldman"}, "edited": false, "score": 0, "creation_date": 1444317091, "post_id": 32978606, "comment_id": 53862257, "body": "Thanks Scott. I am not a coder, so this is over my head. I will try to figure it out."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 5415564, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dKRMgUGBJFs/AAAAAAAAAAI/AAAAAAAAABQ/2UJJuTHMsI4/photo.jpg?sz=128", "display_name": "Scott Feldman", "link": "https://stackoverflow.com/users/5415564/scott-feldman"}, "edited": false, "score": 0, "creation_date": 1444317380, "post_id": 32978606, "comment_id": 53862454, "body": "Did this code work for you? If you still have issues, feel to free to ask, or post another question if its vastly different than this one."}, {"owner": {"reputation": 1, "user_id": 5415564, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dKRMgUGBJFs/AAAAAAAAAAI/AAAAAAAAABQ/2UJJuTHMsI4/photo.jpg?sz=128", "display_name": "Scott Feldman", "link": "https://stackoverflow.com/users/5415564/scott-feldman"}, "edited": false, "score": 0, "creation_date": 1444448082, "post_id": 32978606, "comment_id": 53920676, "body": "No. Unfortunately it did not. Is there a way to send you an sample spreadsheet?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 5415564, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dKRMgUGBJFs/AAAAAAAAAAI/AAAAAAAAABQ/2UJJuTHMsI4/photo.jpg?sz=128", "display_name": "Scott Feldman", "link": "https://stackoverflow.com/users/5415564/scott-feldman"}, "edited": false, "score": 0, "creation_date": 1444740744, "post_id": 32978606, "comment_id": 54021162, "body": "You can post one to a file sharing drive (ie. - google docs, drop box, etc)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1444161494, "creation_date": 1444161494, "answer_id": 32978606, "question_id": 32978390, "link": "https://stackoverflow.com/questions/32978390/macro-with-text-variables-changing-columns/32978606#32978606", "title": "Macro with text variables changing columns", "body": "<pre><code>Dim wks As Worksheet\nDim rngFound as Range\n\nSet wks = Sheets(\"Sheet1\") ' adjust for your sheet name\nSet rngFound = wks.Cells.Find(What:=\"reg\", After:=Range(\"A1\"), LookIn:=xlFormulas, LookAt:= _\nxlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n, SearchFormat:=False)\n\nIf Not rngFound is Nothing Then rngFound.Offset(2,1).Copy Sheets(\"Sheet2\").Range(\"A1\") 'adjust the destination to fit what you need\n</code></pre>\n\n<p>No need to select anything. You can work directly with the cells. Also, not sure where in your other sheet you want to copy to, but you can adjust the copy destination as need be.</p>\n"}], "owner": {"reputation": 1, "user_id": 5415564, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dKRMgUGBJFs/AAAAAAAAAAI/AAAAAAAAABQ/2UJJuTHMsI4/photo.jpg?sz=128", "display_name": "Scott Feldman", "link": "https://stackoverflow.com/users/5415564/scott-feldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444161494, "creation_date": 1444160731, "last_edit_date": 1531161705, "question_id": 32978390, "link": "https://stackoverflow.com/questions/32978390/macro-with-text-variables-changing-columns", "title": "Macro with text variables changing columns", "body": "<p>Macro works great until the position of text changes columns. I'm using \"find\" textstring, then want to move cursor right and down2, then copy data to another sheet. The macro works great until the text string moves in subsequent spreadsheets.  </p>\n\n<p>How do I get the selected range to be variable based on where text string is found?<br>\nIn example below, how do I get <code>Range(\"H7:H180\").Select</code> to be variable?</p>\n\n<pre><code>Range(\"A1\").Select\nCells.Find(What:=\"reg\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\nxlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n, SearchFormat:=False).Activate\nRange(\"H7:H180\").Select\n</code></pre>\n"}, {"tags": ["vba", "vbscript", "jscript", "qlikview"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444160828, "post_id": 32978376, "comment_id": 53782095, "body": "if you want to go backward you need to add <code>step -1</code> to your <code>for</code> line, the second one.  vba asumes <code>step 1</code>"}, {"owner": {"reputation": 41, "user_id": 2703591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161153488af33c5dfb9d071dba727277?s=128&d=identicon&r=PG&f=1", "display_name": "user2703591", "link": "https://stackoverflow.com/users/2703591/user2703591"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444161364, "post_id": 32978376, "comment_id": 53782405, "body": "@ScottCraner.. thanks for replying. As I am really new to vbscript, can you please show how to write this. Thanks for help"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444161433, "post_id": 32978376, "comment_id": 53782436, "body": "<code>for i=ubound(charts) to lbound(charts) Step -1</code>  This will step backward through the array."}, {"owner": {"reputation": 41, "user_id": 2703591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161153488af33c5dfb9d071dba727277?s=128&d=identicon&r=PG&f=1", "display_name": "user2703591", "link": "https://stackoverflow.com/users/2703591/user2703591"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444161943, "post_id": 32978376, "comment_id": 53782740, "body": "@ScottCraner.. thanks. I&#39;ll try it now. May be you can change it to answer by the time I try it, so that I can accept it if it works for me :)"}, {"owner": {"reputation": 41, "user_id": 2703591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161153488af33c5dfb9d071dba727277?s=128&d=identicon&r=PG&f=1", "display_name": "user2703591", "link": "https://stackoverflow.com/users/2703591/user2703591"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444170219, "post_id": 32978376, "comment_id": 53787017, "body": "Thanks and it worked like charm....If u post it as answer, I will accept :)"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1444162571, "last_edit_date": 1495541033, "creation_date": 1444162234, "answer_id": 32978802, "question_id": 32978376, "link": "https://stackoverflow.com/questions/32978376/reversing-an-array-of-objects-in-a-sheet/32978802#32978802", "title": "Reversing an array of objects in a sheet", "body": "<p>As was stated in the comments, vba defaults to a positive step of 1 in a <code>For</code> loop.  To step backwards one must tell vba to step backwards.</p>\n\n<pre><code>for i=ubound(charts) to lbound(charts) Step -1\n</code></pre>\n\n<p>positive integers are forward(1,2,3) and negative is backwards(10,9,8). The steps can be multiples; so <code>Step 2</code> is (1,3,5).  </p>\n\n<p>This does not work for a <code>For Each</code> loop.</p>\n\n<p>A good work around for the <code>For Each</code> loop can be found <a href=\"https://stackoverflow.com/questions/4203329/reversing-the-items-in-a-collection\">here.</a></p>\n"}], "owner": {"reputation": 41, "user_id": 2703591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161153488af33c5dfb9d071dba727277?s=128&d=identicon&r=PG&f=1", "display_name": "user2703591", "link": "https://stackoverflow.com/users/2703591/user2703591"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 652, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444836841, "creation_date": 1444160687, "last_edit_date": 1444836841, "question_id": 32978376, "link": "https://stackoverflow.com/questions/32978376/reversing-an-array-of-objects-in-a-sheet", "title": "Reversing an array of objects in a sheet", "body": "<p>I am writing a macro in vbscript to export objects from sheets in Qlikview to a ppt. In a sheet, I have some objects in a sheet, but when I extract then to ppt, they are coming in reverse order of their id. Suppose the object ids a sheet are CH1, CH2, CH3.. In the code when I read them, they start from backward like CH3, CH2, CH1.. I have to place each object in specific position in ppt, so need to read them in correct order. I am using following code :</p>\n\n<pre><code>set s=ActiveDocument.ActiveSheet\ncharts=s.GetSheetObjects\n\nSet PPSlide = PPPres.Slides(pptiterno)\nfor i=lbound(charts) to ubound(charts)\n    msgbox charts(i).getobjectid\n</code></pre>\n\n<p>If in the sheet the objects are from CH57 - CH67, in the code they come as CH67-CH57. But I want them from CH57 - CH67. I simply tried to reverse the loop like :</p>\n\n<pre><code>for i=ubound(charts) to lbound(charts)\n</code></pre>\n\n<p>but this does not work. Can someone help me to reverse this object array.</p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5306809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb4e82b64c5f956281917cef3159619b?s=128&d=identicon&r=PG&f=1", "display_name": "mishchief", "link": "https://stackoverflow.com/users/5306809/mishchief"}, "edited": false, "score": 0, "creation_date": 1444162683, "post_id": 32978436, "comment_id": 53783211, "body": "Hey @Scott-Holtzman thanks for the imput! I am currently running into the following error &quot;expected variable or procedure, not module&quot; do you have any help for this? I don&#39;t know why it&#39;s not going through."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 23, "user_id": 5306809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb4e82b64c5f956281917cef3159619b?s=128&d=identicon&r=PG&f=1", "display_name": "mishchief", "link": "https://stackoverflow.com/users/5306809/mishchief"}, "edited": false, "score": 0, "creation_date": 1444180988, "post_id": 32978436, "comment_id": 53789924, "body": "Mijail - Glad you got your answer. I totally missed that the <code>GetElementsBy**Class**Name</code>. That is probably why the error appeared. My code works for element names in a webpage, but I would have to test it on class names. Apologies for the wrong direct. I learned something though, so that is good. And you have another solution for another possible need in the future :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1444161231, "last_edit_date": 1444161231, "creation_date": 1444160891, "answer_id": 32978436, "question_id": 32978117, "link": "https://stackoverflow.com/questions/32978117/using-vba-to-retrieve-information-from-google-trying-to-set-up-a-stop-when-goog/32978436#32978436", "title": "Using VBA to retrieve information from google, trying to set up a stop when google doesn&#39;t work as expected", "body": "<p>I just dealt with this problem recently. I wrote a Function to test if the element I wanted was on the screen. The function is below. I am sure you can modify it for your needs.</p>\n\n<pre><code>Function ScreenTest(oDoc as Object, sLookUp As String) As Boolean\n'tests to see if a particular screen is loaded by passing the element name associated with what you would expect to see on the screen\n'pass oDoc has your IE document\n\nDim sTest As String\n\nOn Error Resume Next\n\nsTest = oDoc.getElementsByName(sLookUp).item(0).Value\n\nIf Err.Number &lt;&gt; 0 Then ScreenTest = False Else: ScreenTest = True\n\nOn Error GoTo 0\n\nEnd Function\n</code></pre>\n\n<p>To put this in your code, do this: </p>\n\n<pre><code>If ScreenTest(doc, \"_eF\") Then\n\n    dd = doc.getElementsByClassName(\"_eF\")(0).innerText\n    ' Now, trim the name to take the State out\n    dd = Left(dd, WorksheetFunction.Search(\",\", dd) - 1)\n\n    'set county value\n    Cells(i, 3).Value = dd\n    'MsgBox dd\n    i = i + 1\n\nEnd If\n\n'... continue with rest of code\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5306809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb4e82b64c5f956281917cef3159619b?s=128&d=identicon&r=PG&f=1", "display_name": "mishchief", "link": "https://stackoverflow.com/users/5306809/mishchief"}, "edited": false, "score": 0, "creation_date": 1444162912, "post_id": 32978685, "comment_id": 53783355, "body": "Thank you for the input @Jeeped but I didn&#39;t understand anything you said or how can I apply it to my problem. I am new to running vba with outside applications."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 23, "user_id": 5306809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb4e82b64c5f956281917cef3159619b?s=128&d=identicon&r=PG&f=1", "display_name": "mishchief", "link": "https://stackoverflow.com/users/5306809/mishchief"}, "edited": false, "score": 0, "creation_date": 1444164043, "post_id": 32978685, "comment_id": 53784048, "body": "If there is at least <b>1</b> <code>doc.getElementsByClassName(&quot;_eF&quot;)</code> then <code>doc.getElementsByClassName(&quot;_eF&quot;).LENGTH</code> will be greater than <b>0</b>. In the above, <code>dd</code> only gets the <code>.innerText</code> if it exists."}, {"owner": {"reputation": 23, "user_id": 5306809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb4e82b64c5f956281917cef3159619b?s=128&d=identicon&r=PG&f=1", "display_name": "mishchief", "link": "https://stackoverflow.com/users/5306809/mishchief"}, "edited": false, "score": 0, "creation_date": 1444165087, "post_id": 32978685, "comment_id": 53784655, "body": "oooo I understand now! Thanks! You are the man! This is exactly what I needed! Thank you so much"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1444161837, "creation_date": 1444161837, "answer_id": 32978685, "question_id": 32978117, "link": "https://stackoverflow.com/questions/32978117/using-vba-to-retrieve-information-from-google-trying-to-set-up-a-stop-when-goog/32978685#32978685", "title": "Using VBA to retrieve information from google, trying to set up a stop when google doesn&#39;t work as expected", "body": "<p>The methods of retrieving elements from a collection is a zero based index but the <code>.Length</code> property is one based. In other words, the first in the collection of a single element is at position <code>0</code> but the length is <code>1</code>.</p>\n\n<pre><code>if cbool(doc.getElementsByClassName(\"_eF\").LENGTH) then _\n    dd = doc.getElementsByClassName(\"_eF\")(0).innerText\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5306809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb4e82b64c5f956281917cef3159619b?s=128&d=identicon&r=PG&f=1", "display_name": "mishchief", "link": "https://stackoverflow.com/users/5306809/mishchief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 32978685, "answer_count": 2, "score": 0, "last_activity_date": 1444161837, "creation_date": 1444159768, "last_edit_date": 1444160098, "question_id": 32978117, "link": "https://stackoverflow.com/questions/32978117/using-vba-to-retrieve-information-from-google-trying-to-set-up-a-stop-when-goog", "title": "Using VBA to retrieve information from google, trying to set up a stop when google doesn&#39;t work as expected", "body": "<pre><code>Sub test()\n    Dim IE      As New InternetExplorer\n    Dim city$, state$\n    Dim i       As Integer\n    Dim dd      As Variant\n\n    Dim doc     As HTMLDocument  'variable for document or data which need to be extracted out of webpage\n    Set doc = IE.document\n\n    i = 2 'start row\n\n    'Setting the variables\n    city = Cells(i, 1).Value 'City variable for search\n    state = Cells(i, 2).Value 'State variable for search\n\n    Do Until city = \"\"\n\n        city = Cells(i, 1).Value 'City variable for search\n        state = Cells(i, 2).Value 'State variable for search\n\n         'Search google for state and county\n        URL = \"www.google.com/?safe=active&amp;ssui=on#q=\" + city + \"+\" + state + \"+county&amp;safe=active&amp;ssui=on\"\n\n        IE.navigate URL\n        IE.Visible = False\n\n        Do\n            DoEvents\n        Loop Until IE.readyState = READYSTATE_COMPLETE\n\n        Application.Wait (Now() + TimeValue(\"00:00:005\")) ' For internal page refresh or loading\n\n        dd = doc.getElementsByClassName(\"_eF\")(0).innerText\n        ' Now, trim the name to take the State out\n        dd = Left(dd, WorksheetFunction.Search(\",\", dd) - 1)        \n\n        'set county value\n        Cells(i, 3).Value = dd\n        'MsgBox dd\n        i = i + 1\n\n        'Setting the next variables\n        city = Cells(i, 1).Value 'City variable for search\n        state = Cells(i, 2).Value 'State variable for search\n    Loop\n\n    MsgBox \"The macro has finished running\"\n\nEnd Sub\n</code></pre>\n\n<p>So far this is what I've got thanks to the help of user @BruceWayne</p>\n\n<p>However sometimes google doesn't prompt up the necessary information if the town doesn't have a county or if it is too obscure. I need the macro to record this and keep going. However, every time I try to make an if statement or a fail check the macro stops and prompts the debug window because it is trying to retrieve <code>doc.getElementsByClassName(\"_eF\")(0).innerText</code>. </p>\n\n<p>What can I do to check if <code>doc.getElementsByClassName(\"_eF\")(0).innerText</code> is there and if it is not to record this and keep going?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1444158652, "post_id": 32977723, "comment_id": 53780725, "body": "Pull your variable out of the sub variable.  Just place them by themselves.  A Quick search found <a href=\"http://stackoverflow.com/questions/2722146/how-do-i-declare-a-global-variable-in-vba\">this</a>."}, {"owner": {"reputation": 31, "user_id": 5415472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ecd8424c2d4e4a3c896ab64def7858c?s=128&d=identicon&r=PG&f=1", "display_name": "neofini", "link": "https://stackoverflow.com/users/5415472/neofini"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444158903, "post_id": 32977723, "comment_id": 53780863, "body": "Thanks. Your solution was good."}], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 1, "last_activity_date": 1444166229, "creation_date": 1444166229, "answer_id": 32979909, "question_id": 32977723, "link": "https://stackoverflow.com/questions/32977723/whats-wrong-with-this-vba-code/32979909#32979909", "title": "What&#39;s wrong with this VBA code?", "body": "<p>There are two problems with the code: You don't require variable declaration and you your variables are scoped differently than you expect.</p>\n\n<p>In the Visual Basic Editor, choose Tools - Options and check Require Variable Declaration. This will automatically include <code>Option Explicit</code> at the top of any new modules. Unfortunately for existing modules, you'll have to type <code>Option Explicit</code> at the top yourself.</p>\n\n<p>If you require variable declaration, the compiler will tell you when you're using a variable that's not in scope. It would have told you (in your example) <code>Variable not defined</code> and highlighted <code>num</code> (because it's the first one). That will help you identify these types of problems in the future. </p>\n\n<p>Clearly you intended to declare your variables, you just didn't declare them in the right place. Your variable can have three scopes: local, module, global. You always want to use the smallest scope that suits your code. So use local, unless you need to use module. And use module unless global is absolutely necessary.  Here's how the scopes work out:</p>\n\n<p><strong>Local</strong> - Use <code>Dim</code> inside a procedure (between <code>Sub</code> and <code>End Sub</code> or equivalent). Nothing outside of that procedure can see or change the variable.</p>\n\n<p><strong>Module</strong> - Use <code>Private</code> (<code>Dim</code> also works) at the top of the module, outside of any procedures. Now all the procedures in that module can see and use the variable. Procedures in other modules cannot.</p>\n\n<p><strong>Global</strong> - Use <code>Public</code> (<code>Global</code> also works) at the top of a standard module (not a class module, like ThisWorkbook, Sheet1, Userform1, or Class1). Every procedure in your project can see and set this variable. </p>\n\n<p>For your case, you should use a module scoped variable. Your event subs are in the same module and they are the only subs using these variables. If a procedure outside of the module needs to use the variable, you may need to move it to a standard module and declare it with <code>Public</code>. But do that as a last resort. There are other options, like passing variables as a arguments, that are better than using global scoped variables.</p>\n\n<p>Two more things: If you use <code>Application.InputBox()</code> you can specify a Type that will ensure the user enters a number. If you want to continue to use the <code>InputBox()</code> function, then <code>CInt</code> will error when the user types anything that can't be coerced to a number. In that case, consider using the <code>Val</code> function.</p>\n"}], "owner": {"reputation": 31, "user_id": 5415472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ecd8424c2d4e4a3c896ab64def7858c?s=128&d=identicon&r=PG&f=1", "display_name": "neofini", "link": "https://stackoverflow.com/users/5415472/neofini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444166229, "creation_date": 1444158440, "last_edit_date": 1444158757, "question_id": 32977723, "link": "https://stackoverflow.com/questions/32977723/whats-wrong-with-this-vba-code", "title": "What&#39;s wrong with this VBA code?", "body": "<pre><code>Sub variable()\nDim data As Integer\nDim square As Integer\nDim num As String\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nnum = InputBox(\"Give me the number!\", \"Your number\")\ndata = CInt(num)\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\nsquare = (data ^ 2)\nMsgBox (\"The result: \" &amp; square)\nEnd Sub\n</code></pre>\n\n<p>Could anyone help me? Thanks.\nThe result isn't the right number. That is 0 all the time.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1444157779, "last_edit_date": 1444157779, "creation_date": 1444156522, "answer_id": 32977171, "question_id": 32976982, "link": "https://stackoverflow.com/questions/32976982/excel-automate-copying-a-value-a-number-of-times-equivalent-to-the-count-of-non/32977171#32977171", "title": "Excel: Automate copying a value a number of times equivalent to the Count of non-zero cells in the same row", "body": "<p>This will do what you want.</p>\n\n<p>Change the sheet names to match the sheet names you have.</p>\n\n<pre><code>Sub Sortstuff()\n\nDim ows As Worksheet\nDim tws As Worksheet\nDim trw&amp;\nDim cel as range\n\nSet ows = Worksheets(\"Sheet1\") 'original sheet\nSet tws = Worksheets(\"Sheet2\") 'target sheet\n\nFor Each cel In ows.Range(ows.Range(\"B2\"), ows.Range(\"B2\").End(xlDown).End(xltoRight))\n    If cel &lt;&gt; 0 Then\n        trw = tws.Range(\"A\" &amp; tws.Rows.count).End(xlUp).Offset(1).Row\n        tws.Cells(trw, 2) = ows.Cells(cel.Row, 1)\n        tws.Cells(trw, 1) = cel.value\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5120885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6b3ebde5d2ea92a9a625f562661705?s=128&d=identicon&r=PG", "display_name": "Nicolas Benjamin", "link": "https://stackoverflow.com/users/5120885/nicolas-benjamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "accepted_answer_id": 32977171, "answer_count": 1, "score": 0, "last_activity_date": 1444159709, "creation_date": 1444155801, "last_edit_date": 1444159709, "question_id": 32976982, "link": "https://stackoverflow.com/questions/32976982/excel-automate-copying-a-value-a-number-of-times-equivalent-to-the-count-of-non", "title": "Excel: Automate copying a value a number of times equivalent to the Count of non-zero cells in the same row", "body": "<p>As my dataset is quite large (thousands of rows and dozens of columns), I would like to automate the process of:</p>\n\n<ol>\n<li>copying a given ID# a number of times equivalent to the Count of non-zero cells (parents) in its row (excluding the ID# itself), and </li>\n<li>adding the parent# in question to a cell adjacent to the copied ID#. </li>\n<li>Ignore all parents with cells equal to zero.</li>\n</ol>\n\n<p><strong>Example:</strong> </p>\n\n<p>My dataset possesses ID numbers in Column A. Each ID# possesses multiple parents in its own row. ID# 1 in Cell A2 possesses 4x nonzero parent numbers 265, 266, 32 and 7, in B2, C2, D2 and E2 respectively. Cell F2 = zero, and should be ignored. </p>\n\n<p><a href=\"https://i.stack.imgur.com/VtsQS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VtsQS.png\" alt=\"Current data format: Parents per ID#\"></a></p>\n\n<p><strong>Desired output in another sheet:</strong> </p>\n\n<p><a href=\"https://i.stack.imgur.com/Xfpb4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xfpb4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any help would be greatly appreciated. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 1, "creation_date": 1444154992, "post_id": 32976559, "comment_id": 53778521, "body": "First of all - you should debug your code and find out what&#39;s going wrong. There might be totally different error with it and you look for it in the other place."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1444155138, "post_id": 32976559, "comment_id": 53778602, "body": "It is never recommended to perform a Do While loop until cell = &quot;&quot;.  That type of programming is almost always error prone and inefficient compared to alternatives, such as a For Each loop which I can see you are using in your code.  Based on what your Do Loop is actually doing, it looks like you want the first unused column in that row.  Why not use <code>NewBook.Sheets(1).Cells(Cell.Row, Columns.Count).End(xlToLeft).Column + 1</code>?  As a side note, it is also never recommended to use the exact work <code>cell</code> as a variable, since it is already a keyword in VBA."}, {"owner": {"reputation": 197, "user_id": 3990867, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c617bcf0efc9784244cd8abf0631044?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Dorsey", "link": "https://stackoverflow.com/users/3990867/jacob-dorsey"}, "edited": false, "score": 0, "creation_date": 1444157567, "post_id": 32976559, "comment_id": 53780143, "body": "Love the suggestions.  Even though the error was resolved you guys went ahead and gave me some pointers.  I really appreciate it."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1444154977, "last_edit_date": 1444154977, "creation_date": 1444154618, "answer_id": 32976603, "question_id": 32976559, "link": "https://stackoverflow.com/questions/32976559/loop-and-check-to-see-if-a-cell-is-blank-not-registering-that-a-cell-is-blank/32976603#32976603", "title": "Loop and check to see if a cell is blank - Not registering that a cell is blank", "body": "<p>It may have something to do with your <code>Cell</code> variable.  It is highly recommended to not use that word as a variable, since it's used in VB.  Also, use <code>With</code> to cut down a little on the length:</p>\n\n<pre><code>For Each cel In NewBook.Sheets(1).Range(\"T2:T\" &amp; lastRow)\nIf cel.Value = 76 Or cel.Value = 69 Then\n    MsgBox Cells(cel.Row, 8).Value\n    With NewBook.Sheets(1)\n    If IsEmpty(.Cells(cel.Row, 8).Value) = True Then\n            Do Until IsEmpty(.Cells(cel.Row, col).Value)\n                If Not .Cells(cel.Row, col).Value = \"\" Then\n                col = col + 1\n                End If\n            Loop\n            .Cells(cel.Row, col) = \"Codes 69 or 76 Reported w/ No applicable Bankrupcty Rptd\"\n    End If\n    End With\nEnd If\ncol = 50\nNext cel\n\nEnd Sub\n</code></pre>\n\n<p>Mainly, try changing your <code>Cell</code> variable to just <code>cel</code> (or anything you like) and see if it works.  The <code>With</code> part is just personal preference.</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1444155110, "post_id": 32976730, "comment_id": 53778585, "body": "Ah there you go!  But I would note my comment about using <code>Cell</code> as a variable...it can get confusing using that variable."}], "tags": [], "owner": {"reputation": 197, "user_id": 3990867, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c617bcf0efc9784244cd8abf0631044?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Dorsey", "link": "https://stackoverflow.com/users/3990867/jacob-dorsey"}, "is_accepted": false, "score": 1, "last_activity_date": 1444155034, "creation_date": 1444155034, "answer_id": 32976730, "question_id": 32976559, "link": "https://stackoverflow.com/questions/32976559/loop-and-check-to-see-if-a-cell-is-blank-not-registering-that-a-cell-is-blank/32976730#32976730", "title": "Loop and check to see if a cell is blank - Not registering that a cell is blank", "body": "<p>The problem was with the original data.  It comes from a CSV file and the cell.value is not \"\".  It is \" \".  Pesky spaces.</p>\n"}], "owner": {"reputation": 197, "user_id": 3990867, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c617bcf0efc9784244cd8abf0631044?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Dorsey", "link": "https://stackoverflow.com/users/3990867/jacob-dorsey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1444155034, "creation_date": 1444154506, "last_edit_date": 1444154812, "question_id": 32976559, "link": "https://stackoverflow.com/questions/32976559/loop-and-check-to-see-if-a-cell-is-blank-not-registering-that-a-cell-is-blank", "title": "Loop and check to see if a cell is blank - Not registering that a cell is blank", "body": "<p>Here is my code:  </p>\n\n<pre><code>For Each Cell In NewBook.Sheets(1).Range(\"T2:T\" &amp; lastRow)\nIf Cell.Value = 76 Or Cell.Value = 69 Then\n    MsgBox Cells(Cell.Row, 8).Value\n    If NewBook.Sheets(1).Cells(Cell.Row, 8).Value = \"\" Then\n            Do Until IsEmpty(NewBook.Sheets(1).Cells(Cell.Row, col).Value)\n                If Not NewBook.Sheets(1).Cells(Cell.Row, col).Value = \"\" Then\n                col = col + 1\n                End If\n            Loop\n            NewBook.Sheets(1).Cells(Cell.Row, col) = \"Codes 69 or 76 Reported w/ No applicable Bankrupcty Rptd\"\n    End If\nEnd If\ncol = 50\nNext Cell\n</code></pre>\n\n<p>I've also tried:</p>\n\n<pre><code>For Each Cell In NewBook.Sheets(1).Range(\"T2:T\" &amp; lastRow)\nIf Cell.Value = 76 Or Cell.Value = 69 Then\n    MsgBox Cells(Cell.Row, 8).Value\n    If IsEmpty(NewBook.Sheets(1).Cells(Cell.Row, 8).Value) = True Then\n            Do Until IsEmpty(NewBook.Sheets(1).Cells(Cell.Row, col).Value)\n                If Not NewBook.Sheets(1).Cells(Cell.Row, col).Value = \"\" Then\n                col = col + 1\n                End If\n            Loop\n            NewBook.Sheets(1).Cells(Cell.Row, col) = \"Codes 69 or 76 Reported w/ No applicable Bankrupcty Rptd\"\n    End If\nEnd If\ncol = 50\nNext Cell\n</code></pre>\n\n<p>Both don't register when <code>cells(cell.row, 8).value</code> is indeed \"\".  Not sure what to do.</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1444153831, "post_id": 32976265, "comment_id": 53777882, "body": "Your columns and rows are backwards in your <code>cells</code> reference.  It should be <code>Cells(2,3), Cells(3000,3)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1444154134, "last_edit_date": 1444154134, "creation_date": 1444153829, "answer_id": 32976375, "question_id": 32976265, "link": "https://stackoverflow.com/questions/32976265/sum-specific-values-in-excel-and-display-in-message-box/32976375#32976375", "title": "Sum specific values in Excel and display in Message Box?", "body": "<p>What if you do </p>\n\n<pre><code>If answer = vbYes Then\n  msgbox(Application.Sum(Range(Cells(2,3), Cells(3000,3)))\nEnd If\n</code></pre>\n\n<p>(I switched your <code>Cells()</code> numbers around, since you want Column C, not row 3.)</p>\n"}], "owner": {"reputation": 15, "user_id": 5334608, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-fg3RQDdlKHA/AAAAAAAAAAI/AAAAAAAAAPo/bIDghLNTFds/photo.jpg?sz=128", "display_name": "Mohammed Sajjad", "link": "https://stackoverflow.com/users/5334608/mohammed-sajjad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3942, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1444154733, "creation_date": 1444153461, "last_edit_date": 1444154733, "question_id": 32976265, "link": "https://stackoverflow.com/questions/32976265/sum-specific-values-in-excel-and-display-in-message-box", "title": "Sum specific values in Excel and display in Message Box?", "body": "<p>I have an Excel which has all list of marks in C Column.\nI need a message box which should calculate sum of those marks and should display me while closing Excel (or) it's ok if it shows me when I click any shortcut key.\nI have tried using below code but it does not work:</p>\n\n<pre><code> Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Dim answer As Integer\n    answer = MsgBox(\"Do want to see the total?\", vbYesNo + vbQuestion, \"Total\")\n\n        If answer = vbYes Then\n          Range(\"G1\").Value = Application.Sum(Range(Cells(3, 2), Cells(3, 3000)))\n    Else\n        'do nothing\n    End If\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4055939, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh6.googleusercontent.com/-gUezj4Ye3UQ/AAAAAAAAAAI/AAAAAAAAA7U/4vl3XcZ4sJg/photo.jpg?sz=128", "display_name": "Logan Lower", "link": "https://stackoverflow.com/users/4055939/logan-lower"}, "edited": false, "score": 0, "creation_date": 1444160941, "post_id": 32976168, "comment_id": 53782157, "body": "Bare with me i&#39;m not the best with VB, I used your code and got an Error: &quot;User-defined type not defined&quot; on the function"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 69, "user_id": 4055939, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh6.googleusercontent.com/-gUezj4Ye3UQ/AAAAAAAAAAI/AAAAAAAAA7U/4vl3XcZ4sJg/photo.jpg?sz=128", "display_name": "Logan Lower", "link": "https://stackoverflow.com/users/4055939/logan-lower"}, "edited": false, "score": 0, "creation_date": 1444161050, "post_id": 32976168, "comment_id": 53782220, "body": "@LoganLower you need to set the return value of the Function to an Excel Range object.  I made the adjustment above"}, {"owner": {"reputation": 69, "user_id": 4055939, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh6.googleusercontent.com/-gUezj4Ye3UQ/AAAAAAAAAAI/AAAAAAAAA7U/4vl3XcZ4sJg/photo.jpg?sz=128", "display_name": "Logan Lower", "link": "https://stackoverflow.com/users/4055939/logan-lower"}, "edited": false, "score": 0, "creation_date": 1444161169, "post_id": 32976168, "comment_id": 53782294, "body": "hmm ok. I really don&#39;tneed to return anything however, I just need to clear the field contents before writing to it each time"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 69, "user_id": 4055939, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh6.googleusercontent.com/-gUezj4Ye3UQ/AAAAAAAAAAI/AAAAAAAAA7U/4vl3XcZ4sJg/photo.jpg?sz=128", "display_name": "Logan Lower", "link": "https://stackoverflow.com/users/4055939/logan-lower"}, "edited": false, "score": 0, "creation_date": 1444161254, "post_id": 32976168, "comment_id": 53782340, "body": "the return value is so you can assign the value to it instead of two lines of code it is now one."}, {"owner": {"reputation": 69, "user_id": 4055939, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh6.googleusercontent.com/-gUezj4Ye3UQ/AAAAAAAAAAI/AAAAAAAAA7U/4vl3XcZ4sJg/photo.jpg?sz=128", "display_name": "Logan Lower", "link": "https://stackoverflow.com/users/4055939/logan-lower"}, "edited": false, "score": 0, "creation_date": 1444162083, "post_id": 32976168, "comment_id": 53782829, "body": "Sorry that&#39;s just not making sense to me for what I want to do. The way I&#39;m thinking is IF &quot;Field1&quot; is Null Then ClearContents in xlSheet.Range(&quot;B&quot; &amp; rCount) = Trim(vItem(1)). Field1 is in the Email"}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1444161380, "last_edit_date": 1444161380, "creation_date": 1444153108, "answer_id": 32976168, "question_id": 32975956, "link": "https://stackoverflow.com/questions/32975956/clear-cell-if-contains-data/32976168#32976168", "title": "Clear cell if contains data", "body": "<p>you could write a function that returns the range object after clearing it out.</p>\n\n<pre><code>Function ClearMyRange(r as Range) as Excel.Range\n    r.ClearContents\n    set ClearMyRange = r\nEnd Function\n</code></pre>\n\n<p>then just call it </p>\n\n<pre><code>ClearMyRange(xlSheet.Range(\"D\" &amp; rCount)) = Trim(vItem(1))\n</code></pre>\n\n<p>The reason I suggested the function is so you don't have to call it like so</p>\n\n<pre><code>ClearMyRange(xlSheet.Range(\"D\" &amp; rCount))\nxlSheet.Range(\"D\" &amp; rCount) = Trim(vItem(1))\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4055939, "user_type": "registered", "accept_rate": 15, "profile_image": "https://lh6.googleusercontent.com/-gUezj4Ye3UQ/AAAAAAAAAAI/AAAAAAAAA7U/4vl3XcZ4sJg/photo.jpg?sz=128", "display_name": "Logan Lower", "link": "https://stackoverflow.com/users/4055939/logan-lower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444383842, "creation_date": 1444152371, "last_edit_date": 1444383842, "question_id": 32975956, "link": "https://stackoverflow.com/questions/32975956/clear-cell-if-contains-data", "title": "Clear cell if contains data", "body": "<p>I am exporting information from emails into a spreadsheet using the following:</p>\n\n<pre><code>Sub CopyToExcel()\nDim xlApp As Object\nDim xlWB As Object\nDim xlSheet As Object\nDim olItem As Outlook.MailItem\nDim vText As Variant\nDim sText As String\nDim vItem As Variant\nDim i As Long\nDim rCount As Long\nDim bXStarted As Boolean\nConst strPath As String = \"C:\\Users\\username\\Desktop\\Spreadsheet.xlsx\" 'the path of the workbook\n\nIf Application.ActiveExplorer.Selection.Count = 0 Then\n    MsgBox \"No Items selected!\", vbCritical, \"Error\"\n    Exit Sub\nEnd If\nOn Error Resume Next\nSet xlApp = GetObject(, \"Excel.Application\")\nIf Err &lt;&gt; 0 Then\n    Application.StatusBar = \"Please wait while Excel source is opened ... \"\n    Set xlApp = CreateObject(\"Excel.Application\")\n    bXStarted = True\nEnd If\nOn Error GoTo 0\n'Open the workbook to input the data\nSet xlWB = xlApp.Workbooks.Open(strPath)\nSet xlSheet = xlWB.Sheets(\"Sheet1\")\n\n'Process each selected record\n rCount = xlSheet.UsedRange.Rows.Count\n  For Each olItem In Application.ActiveExplorer.Selection\n    sText = olItem.Body\n    vText = Split(sText, Chr(13))\n    'Find the next empty line of the worksheet\n     rCount = rCount + 1\n\n    'Check each line of text in the message body\n    For i = UBound(vText) To 0 Step -1\n\n        If InStr(1, vText(i), \"Cell0:\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(58))\n            xlSheet.Range(\"B\" &amp; rCount) = Trim(vItem(1))\n            Else\n            ActiveCell = Null\n        End If\n\n        If InStr(1, vText(i), \"Field1:\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(58))\n            xlSheet.Range(\"D\" &amp; rCount) = Trim(vItem(1))\n        End If\n\n        If InStr(1, vText(i), \"Field2:\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(58))\n            xlSheet.Range(\"E\" &amp; rCount) = Trim(vItem(1))\n        End If\n\n        If InStr(1, vText(i), \"Field3:\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(58))\n            xlSheet.Range(\"F\" &amp; rCount) = Trim(vItem(1))\n        End If\n\n        If InStr(1, vText(i), \"Field4:\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(58))\n            xlSheet.Range(\"H\" &amp; rCount) = Trim(vItem(1))\n        End If\n\n        If InStr(1, vText(i), \"Field5:\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(58))\n            xlSheet.Range(\"I\" &amp; rCount) = Trim(vItem(1))\n        End If\n\n        If InStr(1, vText(i), \"Field6:\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(58))\n            xlSheet.Range(\"J\" &amp; rCount) = Trim(vItem(1))\n        End If\n\n\n    Next i\n    xlWB.Save\nNext olItem\n\n\nSet xlApp = Nothing\nSet xlWB = Nothing\nSet xlSheet = Nothing\nSet olItem = Nothing\nEnd Sub\n</code></pre>\n\n<p>The problem is if this is run on an email that does not contain data for a certain Field, it leaves the previous email's data. I would like to have the macro clear the cell if it contains information OR just input null into the cell if nothing is found in the Field. </p>\n\n<p>I know it must be something like <code>ActiveCell.clear</code> or <code>ActiveCell = Null</code> but i'm just not sure where to put it in the If statements.</p>\n\n<p>I tried this but it does not work:</p>\n\n<pre><code>If InStr(1, vText(i), \"Activity Number:\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(58))\n            xlSheet.Range(\"B\" &amp; rCount) = Trim(vItem(1))\n            ElseIf InStr(1, vText(i), \"Activity Number:\") = 0 Then\n            xlSheet.Range(\"B\" &amp; rCount) = Null\n        End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2430, "user_id": 1330328, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0AoZO.jpg?s=128&g=1", "display_name": "Olivier De Meulder", "link": "https://stackoverflow.com/users/1330328/olivier-de-meulder"}, "edited": false, "score": 0, "creation_date": 1444152410, "post_id": 32975824, "comment_id": 53777090, "body": "Welcome to Stackoverflow. This is probably not the answer you want to see, but why don&#39;t you try it first. And then, come to this board with a specific question. Ideally, you could paste some code and / or error messages."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1444152293, "creation_date": 1444152293, "answer_id": 32975931, "question_id": 32975824, "link": "https://stackoverflow.com/questions/32975824/run-vba-module-with-specify-of-username/32975931#32975931", "title": "Run vba module with specify of username", "body": "<p>I'm not sure how \"secure\" this is, but it worked for me.  Note that you need to put this in the \"ThisWorkbook\" Object (not a Module):</p>\n\n<pre><code>Private Sub Workbook_Open()\nIf Environ$(\"Username\") = \"bWayne\" Then\n    MsgBox (\"Hi Bruce\")\n   ' Do whatever\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Save as <code>.xlsm</code> and when you open it, if the username is <code>bWayne</code>, the message box will show...otherwise, nothing happens.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5407221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61dd85e8dfdf05df796c766899c0f309?s=128&d=identicon&r=PG", "display_name": "Sergius", "link": "https://stackoverflow.com/users/5407221/sergius"}, "is_accepted": false, "score": 0, "last_activity_date": 1444210290, "creation_date": 1444210290, "answer_id": 32988717, "question_id": 32975824, "link": "https://stackoverflow.com/questions/32975824/run-vba-module-with-specify-of-username/32988717#32988717", "title": "Run vba module with specify of username", "body": "<p>Also it is possible to check Excel user's name by using </p>\n\n<pre><code>If Application.UserName = \u201cbWayne\u201d Then\n\u2026\nEnd If\n</code></pre>\n\n<p>in Workbook_Open() procedure.</p>\n"}], "owner": {"reputation": 83, "user_id": 5415134, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-4fIcjOvo5Xg/AAAAAAAAAAI/AAAAAAAAAIQ/E3QeRStmlJ4/photo.jpg?sz=128", "display_name": "Dmitriy Kravchuk", "link": "https://stackoverflow.com/users/5415134/dmitriy-kravchuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 32975931, "answer_count": 2, "score": 0, "last_activity_date": 1444210290, "creation_date": 1444151911, "question_id": 32975824, "link": "https://stackoverflow.com/questions/32975824/run-vba-module-with-specify-of-username", "title": "Run vba module with specify of username", "body": "<p>is it possible to run excel module when workbook opened by certain user?\nThe idea is very simple - refreshing all data source when excel workbook opened by certain user, save and close. Another way it just opens.</p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 2612, "user_id": 1158842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7e5a3eb863b8e0bea33fee1fa6257?s=128&d=identicon&r=PG", "display_name": "hubson bropa", "link": "https://stackoverflow.com/users/1158842/hubson-bropa"}, "edited": false, "score": 1, "creation_date": 1444150885, "post_id": 32975510, "comment_id": 53776213, "body": "i&#39;m not sure there is a rule about this, but i can definitely say I&#39;m not going to click on an unknown external site as a resource needed to understand your problem. put the parts that are important in your question as code snippets."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444152028, "post_id": 32975510, "comment_id": 53776845, "body": "What is your question? What code do you have that&#39;s not working? Why do you include some tag elements, what do they have to do with anything?  What&#39;s the end goal?  We&#39;ll need a bit more information before we can help."}, {"owner": {"reputation": 3, "user_id": 5415079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153701203411060/picture?type=large", "display_name": "Sweta Jain", "link": "https://stackoverflow.com/users/5415079/sweta-jain"}, "edited": false, "score": 0, "creation_date": 1444154070, "post_id": 32975510, "comment_id": 53778006, "body": "I am writing a code for web scraping. I want to extract some data from a website. The website has a drop down &quot;Choose payment mode&quot; containing three values. I want to select &quot;Yearly&quot; using VBA. However, I am unable to do so. I want to know the VBA code for doing so."}, {"owner": {"reputation": 3, "user_id": 5415079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153701203411060/picture?type=large", "display_name": "Sweta Jain", "link": "https://stackoverflow.com/users/5415079/sweta-jain"}, "edited": false, "score": 0, "creation_date": 1444154148, "post_id": 32975510, "comment_id": 53778052, "body": "This is the page source: &gt;&lt;div class=dropDivCon&gt;&lt;select id=paymentFrequency class=&quot;custom-class1 custom-class2&quot; style=position:relative;border:none;top:9px;left:9px;width:1&zwnj;&#8203;67px&gt;&lt;option value=MONTHLY-ECS selected&gt;Monthly&lt;option value=HALF-YEARLY&gt;Half Yearly&lt;option value=YEARLY&gt;Yearly&lt;/select&gt;&lt;/div&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5415079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153701203411060/picture?type=large", "display_name": "Sweta Jain", "link": "https://stackoverflow.com/users/5415079/sweta-jain"}, "edited": false, "score": 0, "creation_date": 1444217682, "post_id": 32977466, "comment_id": 53806678, "body": "Hi, I tried using ie.document.Body.getElementsByTagName(&quot;SELECT&quot;).Item(0).Valu&zwnj;&#8203;e = &quot;YEARLY&quot; in VBA. However, there is no change on the website. I have tried it on both IE 10 and IE8."}, {"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "reply_to_user": {"reputation": 3, "user_id": 5415079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153701203411060/picture?type=large", "display_name": "Sweta Jain", "link": "https://stackoverflow.com/users/5415079/sweta-jain"}, "edited": false, "score": 1, "creation_date": 1444224625, "post_id": 32977466, "comment_id": 53811769, "body": "Are you limited to use only VBScript for scripting? I would advice you to go with JavaScript instead. I really could not make any VBScript run onto the page, I know that&#39;s probably my fault, but there also are almost no resources online and the examples I took from MSDN still do NOT work :) So I strongly advice you to change to JavaScript if you are not limited to VBScript."}, {"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "reply_to_user": {"reputation": 3, "user_id": 5415079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153701203411060/picture?type=large", "display_name": "Sweta Jain", "link": "https://stackoverflow.com/users/5415079/sweta-jain"}, "edited": false, "score": 0, "creation_date": 1444224785, "post_id": 32977466, "comment_id": 53811910, "body": "And please stop calling that VBA, VBA is Visual Basic for Applications which is totally different technology from the one you are using. Here is Wiki page about what VBA is: <a href=\"https://en.wikipedia.org/wiki/Visual_Basic_for_Applications\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Visual_Basic_for_Applications</a>"}, {"owner": {"reputation": 3, "user_id": 5415079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153701203411060/picture?type=large", "display_name": "Sweta Jain", "link": "https://stackoverflow.com/users/5415079/sweta-jain"}, "edited": false, "score": 0, "creation_date": 1444237193, "post_id": 32977466, "comment_id": 53821107, "body": "Thanks GSazheniuk. The problem is donot know how to use JavaScript. I have also learned VB recently and hence was trying my luck on it. However it did not work. Anyways thanks for your help."}, {"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "reply_to_user": {"reputation": 3, "user_id": 5415079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153701203411060/picture?type=large", "display_name": "Sweta Jain", "link": "https://stackoverflow.com/users/5415079/sweta-jain"}, "edited": false, "score": 1, "creation_date": 1444237917, "post_id": 32977466, "comment_id": 53821511, "body": "So while you have not gone to far it is better to stop with VBScript and re-start with Javascript. And here is the Javascript solution to your question: <a href=\"https://jsfiddle.net/qmcqjnoa/\" rel=\"nofollow noreferrer\">jsfiddle.net/qmcqjnoa</a>"}], "tags": [], "owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1444157435, "creation_date": 1444157435, "answer_id": 32977466, "question_id": 32975510, "link": "https://stackoverflow.com/questions/32975510/selecting-value-from-drop-down-vba-scraping/32977466#32977466", "title": "Selecting value from drop down vba scraping", "body": "<p>You did almost all the job by yourself, just a little note - string values are CASE SENSITIVE. Therefore you are using upper case values in options and should assign upper case values in the script:</p>\n\n<pre><code>ie.document.Body.getElementsByTagName(\"SELECT\").Item(0).Value = \"YEARLY\"\n</code></pre>\n\n<p>this one should work!</p>\n\n<p>P.S. Just for any case I add JavaScript code too, as it slightly differs from VB and it works, I've just checked:</p>\n\n<pre><code>document.getElementsByTagName(\"SELECT\").item(0).value = \"YEARLY\"\n</code></pre>\n\n<p>Good luck with that :)</p>\n"}], "owner": {"reputation": 3, "user_id": 5415079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153701203411060/picture?type=large", "display_name": "Sweta Jain", "link": "https://stackoverflow.com/users/5415079/sweta-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1349, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1444157435, "creation_date": 1444150680, "last_edit_date": 1444155841, "question_id": 32975510, "link": "https://stackoverflow.com/questions/32975510/selecting-value-from-drop-down-vba-scraping", "title": "Selecting value from drop down vba scraping", "body": "<p>I am trying to select a name from a dropdown using Vba. However it is unable to do so. </p>\n\n<p><strong>VBA:</strong></p>\n\n<pre><code>ie.document.Body.getElementsByTagName(\"SELECT\").Item(0).selectedIndex = \"2\"\nie.document.Body.getElementsByTagName(\"SELECT\").Item(0).Value = \"Yearly\"\n</code></pre>\n\n<p>Page Source:</p>\n\n<blockquote>\n  MonthlyHalf YearlyYearly\n</blockquote>\n\n<p>Also, I am using IE10</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1444149912, "post_id": 32974961, "comment_id": 53775609, "body": "Have you tried <code>Tableau(i) = Sh.Name</code> instead?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444151817, "post_id": 32974961, "comment_id": 53776735, "body": "do you have <code>Option Base 1</code> set? Otherwise, your counting on <code>I</code> and your <code>ReDim Preserve ...</code> look off."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444152306, "post_id": 32974961, "comment_id": 53777027, "body": "I also just tested it with <code>Sh.Name</code> and it worked."}, {"owner": {"reputation": 11, "user_id": 5414921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/415c5a3205a6a535d20a0f2297317e3a?s=128&d=identicon&r=PG&f=1", "display_name": "Ced", "link": "https://stackoverflow.com/users/5414921/ced"}, "edited": false, "score": 0, "creation_date": 1444206412, "post_id": 32974961, "comment_id": 53799370, "body": "I&#39;ve tryed with the name instead. And I&#39;ve set up the array on Tableau(0 to i)."}, {"owner": {"reputation": 11, "user_id": 5414921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/415c5a3205a6a535d20a0f2297317e3a?s=128&d=identicon&r=PG&f=1", "display_name": "Ced", "link": "https://stackoverflow.com/users/5414921/ced"}, "edited": false, "score": 0, "creation_date": 1444207440, "post_id": 32974961, "comment_id": 53799990, "body": "And I&#39;ve set up the array on Tableau(0 to i). It is working but sometimes an error occur with Sh.Copy : &quot;&#39;1004&#39;: Application-defined or object-defined error&quot; But it is working anyway : My shape is Copied"}, {"owner": {"reputation": 11, "user_id": 5414921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/415c5a3205a6a535d20a0f2297317e3a?s=128&d=identicon&r=PG&f=1", "display_name": "Ced", "link": "https://stackoverflow.com/users/5414921/ced"}, "edited": false, "score": 0, "creation_date": 1444211740, "post_id": 32974961, "comment_id": 53802965, "body": "OK I finally got it; Error 400 is when you did not selected the Sheet whom you are talking about in the code. I was asking : For Each Sh In ActiveSheet.Shapes so I had to select this sheet before. Thx all !!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "is_accepted": false, "score": 0, "last_activity_date": 1444153945, "creation_date": 1444153945, "answer_id": 32976401, "question_id": 32974961, "link": "https://stackoverflow.com/questions/32974961/error-400-error-returned-by-the-application-of-the-object-tableaurange-gro/32976401#32976401", "title": "Error 400 - Error returned by the application of the object - Tableau(Range).Group", "body": "<pre><code>Sub SelectA()\n\nDim Sh As Object\nDim Tableau()\nDim i As Integer\n\n'Loop on the ActiveSheet Shapes\nFor Each Sh In ActiveSheet.Shapes\n    If Sh.Type &lt;&gt; msoFormControl Then\n\n        ReDim Preserve Tableau(i)\n        Tableau(i) = Sh.Name\n        i = i + 1\n    End If\nNext Sh\n\nOn Error GoTo Errorcatch\n\n'Group shapes whom the ID is in the array\nSet Sh = ActiveSheet.Shapes.Range(Tableau).Group\n\n'Rename the group\nSh.Name = \"Group\" &amp; CStr(Rnd)\n\nSh.Copy\n\nExit Sub\n</code></pre>\n\n<p>Errorcatch:\n    MsgBox Err.Description</p>\n\n<p>End Sub</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 11, "user_id": 5414921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/415c5a3205a6a535d20a0f2297317e3a?s=128&d=identicon&r=PG&f=1", "display_name": "Ced", "link": "https://stackoverflow.com/users/5414921/ced"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444153945, "creation_date": 1444148733, "last_edit_date": 1444151887, "question_id": 32974961, "link": "https://stackoverflow.com/questions/32974961/error-400-error-returned-by-the-application-of-the-object-tableaurange-gro", "title": "Error 400 - Error returned by the application of the object - Tableau(Range).Group", "body": "<p>I'm actually having difficulties with the code below. </p>\n\n<p>It browses each Shapes of my worksheet and once he've checked the type of the shape he adds its ID in the array Tableau(). </p>\n\n<p>The line returning the error is the following : </p>\n\n<pre><code>Set Sh = ActiveSheet.Shapes.Range(Tableau).group &lt;== it might be a detail but VBA Editor doesn't change group by Group.\n</code></pre>\n\n<p>This is the complete code below:</p>\n\n<pre><code>Sub Select()\n\n    Dim Sh As Object\n    Dim Tableau()\n    Dim i As Integer\n\n    'Loop on the ActiveSheet Shapes\n    For Each Sh In ActiveSheet.Shapes\n\n        If Sh.Type &lt;&gt; msoFormControl Then\n            i = i + 1\n            ReDim Preserve Tableau(1 To i)\n            Tableau(i) = Sh.ID\n        End If\n    Next Sh\n\n    On Error GoTo Errorcatch\n\n    'Group shapes whom the ID is in the array\n    Set Sh = ActiveSheet.Shapes.Range(Tableau).group '&lt;== Error 400\n\n    'Rename the group\n    Sh.name = \"Group\" &amp; CStr(Rnd)\n\n    Sh.Copy\n\nExit Sub\n\nErrorcatch:\nMsgBox Err.Description\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5414943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b395ca0d96cb2772f88700408dee66c?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirB", "link": "https://stackoverflow.com/users/5414943/vladimirb"}, "edited": false, "score": 0, "creation_date": 1444149649, "post_id": 32975094, "comment_id": 53775459, "body": "HI, Tnx for such a quick answer, could i ask you one more question? If i wanted to put information from cell C in to the file so it would be cell A and cell B would be name of the file, and cell C would be content of the file. Is that possible? Thank you so much!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 5414943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b395ca0d96cb2772f88700408dee66c?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirB", "link": "https://stackoverflow.com/users/5414943/vladimirb"}, "edited": false, "score": 0, "creation_date": 1444150440, "post_id": 32975094, "comment_id": 53775946, "body": "@VladimirB - that&#39;s definitely possible, but it gets a little more technical.  If there&#39;s info. in cell C, where do you want that to go in your new file? Cell A1? Cell C1? etc..."}, {"owner": {"reputation": 3, "user_id": 5414943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b395ca0d96cb2772f88700408dee66c?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirB", "link": "https://stackoverflow.com/users/5414943/vladimirb"}, "edited": false, "score": 0, "creation_date": 1444150830, "post_id": 32975094, "comment_id": 53776192, "body": "Hi, sorry for not making clear with my question, is it possible that file is .doc or .txt so that content of cell C can go as content. I understand that is technical and difficult. Thank you so much for your help!!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 5414943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b395ca0d96cb2772f88700408dee66c?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirB", "link": "https://stackoverflow.com/users/5414943/vladimirb"}, "edited": false, "score": 0, "creation_date": 1444151627, "post_id": 32975094, "comment_id": 53776625, "body": "@VladimirB - I have updated the post with the new code that would create a .txt file (just change to .doc if you want a word document)."}, {"owner": {"reputation": 3, "user_id": 5414943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b395ca0d96cb2772f88700408dee66c?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirB", "link": "https://stackoverflow.com/users/5414943/vladimirb"}, "edited": false, "score": 0, "creation_date": 1444152541, "post_id": 32975094, "comment_id": 53777167, "body": "Thank you so much worked perfectly. You just saved me of 2-3 days of work :)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 5414943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b395ca0d96cb2772f88700408dee66c?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirB", "link": "https://stackoverflow.com/users/5414943/vladimirb"}, "edited": false, "score": 0, "creation_date": 1444152593, "post_id": 32975094, "comment_id": 53777192, "body": "@VladimirB - glad to have helped! Do you mind marking as the answer?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1444151572, "last_edit_date": 1495541197, "creation_date": 1444149181, "answer_id": 32975094, "question_id": 32974882, "link": "https://stackoverflow.com/questions/32974882/how-to-create-new-files-from-excel-each-line-in-a-cell-where-file-name-is-comin/32975094#32975094", "title": "How to create new files from excel, each line in a cell where file name is comination of 2 cells", "body": "<p>If the first name is in column A, and the last name is in column B, you can use this:</p>\n\n<pre><code>Sub test2()\nDim i&amp;, lastRow&amp;\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To lastRow\n    Workbooks.Add\n    ActiveWorkbook.SaveAs (\"C:\\Users\\[user name]\\Desktop\\\" &amp; Cells(i, 1) &amp; \" \" &amp; Cells(i, 2) &amp; \".xls\")\n    ActiveWorkbook.Close\nNext i\nEnd Sub\n</code></pre>\n\n<p>Change the file path and extension as needed.  It will save with the name <code>FirstName LastName.xls</code> as I have it.</p>\n\n<p>Edit per comments below:</p>\n\n<p>To make a new text file, and fill with the contents in column C, use the below <a href=\"https://stackoverflow.com/questions/11503174/how-to-create-and-write-to-a-txt-file-using-vba\">(thanks to @Ben)</a></p>\n\n<pre><code>Sub create_TXT()\nDim fso As Object\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nDim oFile As Object\n\nDim i&amp;, lastRow&amp;\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To lastRow\n    Set oFile = fso.CreateTextFile(\"C:\\Users\\[user name]\\Desktop\\\" &amp; Cells(i, 1) &amp; \" \" &amp; Cells(i, 2) &amp; \".txt\")\n    oFile.WriteLine Cells(i, 3).Value\n    oFile.Close\nNext i\nSet fso = Nothing\nSet oFile = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5414943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b395ca0d96cb2772f88700408dee66c?s=128&d=identicon&r=PG&f=1", "display_name": "VladimirB", "link": "https://stackoverflow.com/users/5414943/vladimirb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2362, "favorite_count": 0, "accepted_answer_id": 32975094, "answer_count": 1, "score": -1, "last_activity_date": 1444151572, "creation_date": 1444148513, "question_id": 32974882, "link": "https://stackoverflow.com/questions/32974882/how-to-create-new-files-from-excel-each-line-in-a-cell-where-file-name-is-comin", "title": "How to create new files from excel, each line in a cell where file name is comination of 2 cells", "body": "<p>I need to create multiple files from my spreadsheet. Spread sheet contain First Name, Last Name and some info in third cell. My question is how can i create file for each line where file would be named First Name + Last Name.</p>\n\n<p>Thank you so much in advance!</p>\n"}, {"tags": ["excel", "vba", "web-services", "events", "event-handling"], "answers": [{"tags": [], "owner": {"reputation": 3161, "user_id": 3782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e03e40bc4e21b52e9da599c0ce0f261?s=128&d=identicon&r=PG", "display_name": "mcw", "link": "https://stackoverflow.com/users/3782/mcw"}, "is_accepted": false, "score": 1, "last_activity_date": 1444147467, "creation_date": 1444147467, "answer_id": 32974554, "question_id": 32974553, "link": "https://stackoverflow.com/questions/32974553/how-can-i-post-process-the-data-from-an-excel-web-query-when-the-query-is-comple/32974554#32974554", "title": "How can I post-process the data from an Excel web query when the query is complete?", "body": "<p>Excel supports the ability to open a URL as another Excel workbook, via the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff194819.aspx\" rel=\"nofollow noreferrer\">Workbooks.Open method</a>:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/aa203721(v=office.11).aspx\" rel=\"nofollow noreferrer\">From MSDN:</a></p>\n\n<pre><code>Sub OpenUSDRatesPage()\n   Dim objBK As Workbook\n   Dim objRng As Range\n\n   'Open the page as a workbook.\n   Set objBK = Workbooks.Open(\"http://www.x-rates.com/tables/USD.HTML\")\n\n   'Find the Canadian Dollar cell.\n   Set objRng = objBK.Worksheets(1).Cells.Find(\"Canadian Dollar\")\n\n   'Retrieve the exchange rate.\n   MsgBox \"The CAD/USD exchange rate is \" &amp; objRng.Offset(-6, -1).Value\nEnd Sub\n</code></pre>\n\n<p>The call is synchronous, so you can operate on the resulting data in the new workbook immediately after the Open call.</p>\n\n<p>While the workbook is loading, Excel will display a progress bar.  When you're done, you can call .Close to close the web data workbook.  (e.g., for the MSDN example, you'd call <code>objBK.Close</code> when you're done.)</p>\n\n<p><a href=\"https://i.stack.imgur.com/BFibe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BFibe.png\" alt=\"enter image description here\"></a></p>\n\n<p>The caveats of using this approach: </p>\n\n<ol>\n<li>You're on the hook to migrate the data from the web workbook to your own (<code>ThisWorkbook</code>) yourself, unlike a refreshable Excel Web Query that has a set destination.</li>\n<li>If your web endpoint has a document name that matches the name of a document open in Excel, the user will get a warning that a document with the same name is open.  </li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 3161, "user_id": 3782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e03e40bc4e21b52e9da599c0ce0f261?s=128&d=identicon&r=PG", "display_name": "mcw", "link": "https://stackoverflow.com/users/3782/mcw"}, "edited": false, "score": 0, "creation_date": 1444160195, "post_id": 32975304, "comment_id": 53781706, "body": "I got this to work, but only after adding in some wire up code.  Following the guidance from this forum thread: <a href=\"http://www.mrexcel.com/forum/excel-questions/331550-afterrefresh-help-where-does-code-go.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>, I needed to add a sub to the class module to hook the event capture on the QueryTable of interest.  Then I needed to make sure I called that hookup routine before kicking off a refresh.  That works ok for me because we trigger the refresh by a form button, but I can&#39;t figure out how to guarantee the AfterRefresh fires if I instead click Excel&#39;s Refresh All in the ribbon?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 3161, "user_id": 3782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e03e40bc4e21b52e9da599c0ce0f261?s=128&d=identicon&r=PG", "display_name": "mcw", "link": "https://stackoverflow.com/users/3782/mcw"}, "edited": false, "score": 0, "creation_date": 1444160667, "post_id": 32975304, "comment_id": 53781999, "body": "Yes, those are things you would do when working with a class module the purpose of which is to trap object events with the WithEvents keyword. The AfterRefresh() event procedure should fire whenever the table is refreshed... no matter how that occurs. It can be from Excel&#39;s user interface or from code."}, {"owner": {"reputation": 3161, "user_id": 3782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e03e40bc4e21b52e9da599c0ce0f261?s=128&d=identicon&r=PG", "display_name": "mcw", "link": "https://stackoverflow.com/users/3782/mcw"}, "edited": false, "score": 0, "creation_date": 1444163143, "post_id": 32975304, "comment_id": 53783508, "body": "I&#39;m not seeing that.  Here&#39;s <a href=\"https://github.com/mcw0933/StackOverflowQuestion32974553\" rel=\"nofollow noreferrer\">a github repo</a> where I try it both ways.  I only see that the _AfterRefresh event is being fired when I specifically hook it up first."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 3161, "user_id": 3782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e03e40bc4e21b52e9da599c0ce0f261?s=128&d=identicon&r=PG", "display_name": "mcw", "link": "https://stackoverflow.com/users/3782/mcw"}, "edited": false, "score": 0, "creation_date": 1444170797, "post_id": 32975304, "comment_id": 53787215, "body": "You need to make a change. Place <code>Dim c As Class1</code> at the very top of the standard code module, instead of inside a procedure. This keeps it in scope. In addition you should reconfigure your code so that <code>c</code> is instantiated when the workbook opens. But yes, you will need <code>c</code> alive in order for the class to do anything."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1444149909, "creation_date": 1444149909, "answer_id": 32975304, "question_id": 32974553, "link": "https://stackoverflow.com/questions/32974553/how-can-i-post-process-the-data-from-an-excel-web-query-when-the-query-is-comple/32975304#32975304", "title": "How can I post-process the data from an Excel web query when the query is complete?", "body": "<p>An Excel web query utilizes an object called a QueryTable to carry out the business of retrieving and displaying the data.</p>\n\n<p>A QueryTable can be accessed by VBA.</p>\n\n<p>And just like the chart object a querytable object has events that can only be responded to by using the <code>WithEvents</code> keyword from a <strong>class module</strong>, like so:</p>\n\n<pre><code>Private WithEvents MyQueryTable As QueryTable\n\nPrivate Sub MyQueryTable_AfterRefresh(ByVal Success As Boolean)\n    'Do your post processing here...\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3161, "user_id": 3782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e03e40bc4e21b52e9da599c0ce0f261?s=128&d=identicon&r=PG", "display_name": "mcw", "link": "https://stackoverflow.com/users/3782/mcw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2865, "favorite_count": 2, "accepted_answer_id": 32975304, "answer_count": 2, "score": 0, "last_activity_date": 1444149909, "creation_date": 1444147467, "question_id": 32974553, "link": "https://stackoverflow.com/questions/32974553/how-can-i-post-process-the-data-from-an-excel-web-query-when-the-query-is-comple", "title": "How can I post-process the data from an Excel web query when the query is complete?", "body": "<p>As a spreadsheet developer, I am trying to stitch together two sets of rows: one from a web query to a web service I own, and the other a set of manual rows added by the spreadsheet's user (not me).</p>\n\n<p>Excel's built in Web Query / Connections object only provides two modes: I can turn on \"Enable background refresh\" which makes the web query asynchronous, or uncheck it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/no7us.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/no7us.png\" alt=\"Excel web query properties dialog\"></a></p>\n\n<p>With it unchecked, Excel freezes up while the query executes, which is undesireable.  With it checked, there doesn't seem to be any kind of callback or event hook available to be notified, so that I can operate against the refreshed web data.</p>\n\n<p>Is there another way to do this?  </p>\n"}, {"tags": ["vba", "formatting", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "is_accepted": true, "score": 0, "last_activity_date": 1444153552, "creation_date": 1444153552, "answer_id": 32976288, "question_id": 32974504, "link": "https://stackoverflow.com/questions/32974504/display-glitch-extra-space-after-apostrophe-when-creating-word-documents-vba/32976288#32976288", "title": "Display glitch. Extra space after apostrophe when creating word documents VBA", "body": "<p>Found an answer to my own question. I had to disable the \"Asian Text Font\" in the Font Pane. This can be done by going into the Microsoft Language Register and disabling various languages. <a href=\"http://answers.microsoft.com/en-us/mac/forum/macoffice2011-macword/disabling-asian-text-font-in-the-font-pane/2599da8c-fefe-4905-ad24-cae877dbdc69\" rel=\"nofollow\">Source</a></p>\n"}], "owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 32976288, "answer_count": 1, "score": 0, "last_activity_date": 1444153552, "creation_date": 1444147288, "question_id": 32974504, "link": "https://stackoverflow.com/questions/32974504/display-glitch-extra-space-after-apostrophe-when-creating-word-documents-vba", "title": "Display glitch. Extra space after apostrophe when creating word documents VBA", "body": "<p>I have this VBA code that takes two documents (one original document and one revision document with blue text to be added) and creates a third document with the revisions.It mostly works, but when the third copy is created, there is extra space after apostrophes. It isn't actually an extra space though. Upon selecting the \"Hidden Formatting\" button in Word, it shows that there isn't actually a space at all. The character is just being displayed on the monitor incorrectly. I have tried a few things such as changing the font during the file creation and using the REPLACE function to no avail. This is not an isolated incident, <a href=\"http://answers.microsoft.com/en-us/mac/forum/macoffice2011-macword/why-does-word-2011-add-a-space-when-i-use/7e71bf0d-526f-4cfd-8764-4f44b327e18e\" rel=\"nofollow\">I found this documentation on the problem, unfortunately it does not pertain to VBA</a>. Looking for some ideas on how to fix the problem. </p>\n\n<pre><code>Sub WordReplaceSentence()\n\nMsgBox \"Welcome to the word document automatic modifier\", vbInformation + vbOKOnly\n\nMsgBox \"Please open the revision file\", vbInformation + vbOKOnly\n\n    Dim strfilename1 As String\n    Dim fd1 As Office.FileDialog\n\n   ''''''Browsing/Opening the change request'''''''\n\n    Set fd1 = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fd1\n\n      .AllowMultiSelect = False\n      .Title = \"Open the modified word document.\"\n      .Filters.Clear\n      .Filters.Add \"Word 2010\", \"*.docx\"\n      .Filters.Add \"All Files\", \"*.*\"\n\n      If .Show = True Then\n        strfilename1 = .SelectedItems(1) 'replace txtFileName with your textbox\n      Else\n      Exit Sub\n      End If\n   End With\n\n\n\nMsgBox \"Open the orginal document\", vbInformation + vbOKOnly\n\n\nDim strfilename2 As String\n\n    Dim fd2 As Office.FileDialog\n\n    Set fd2 = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fd2\n\n      .AllowMultiSelect = False\n      .Title = \"Please select the original file.\"\n      .Filters.Clear\n      .Filters.Add \"Word 2010\", \"*.docx\"\n      .Filters.Add \"All Files\", \"*.*\"\n\n      If .Show = True Then\n        strfilename2 = .SelectedItems(1) 'replace txtFileName with your textbox\n      Else\n      Exit Sub\n      End If\n   End With\n\n\nMsgBox \"Please enter the file name with which you want to store the new updated file\", vbInformation + vbOKOnly\n\n\n''''''''''''''''''Asking user to input name to the new revised document'''''''''''''''''''''''''''''''''''''\n\n    Dim strfilename3 As String\n\n    Dim fd3 As Office.FileDialog\n\n    Set fd3 = Application.FileDialog(msoFileDialogSaveAs)\n\n   With fd3\n      .AllowMultiSelect = False\n      .Title = \"Please select the name to be given to the new file.\"\n      If .Show = True Then\n        strfilename3 = .SelectedItems(1) 'replace txtFileName with your textbox\n      Else\n      Exit Sub\n      End If\n   End With\n\n\n\n    FileCopy strfilename2, strfilename3\n\n    Set objWordChange = CreateObject(\"Word.Application\")\n    Set objWordorig = CreateObject(\"Word.Application\")\n\n    objWordChange.Visible = False\n    objWordorig.Visible = False\n\n    Set objDocChange = objWordChange.Documents.Open(strfilename1)\n    Set objSelectionChange = objWordChange.Selection\n    Set objDocOrig = objWordorig.Documents.Open(strfilename3)\n    Set objSelectionOrig = objWordorig.Selection\n\n    Dim rSearch As Range\n    Dim dict As Scripting.Dictionary\n    Dim i As Long\n\n\n    'We'll store the sentences here\n    Set dict = New Scripting.Dictionary\n\n    Set rSearch = objDocChange.Range\n    With rSearch\n        .Find.Forward = True\n        .Find.Format = True\n        .Find.Font.Color = wdColorBlue\n        .Find.Execute\n\n        Do While .Find.Found\n            'key = revised sentence, item = original sentence\n            'if the revised sentence already exists in the dictionary, replace the found word in the entry\n            If dict.Exists(.Sentences(1).Text) Then\n                dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), Space(2), Space(1))\n                dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), \" ,\", \",\")\n                dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), \" .\", \".\")\n                dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), \" '\", \"'\")\n                 For Each Key In dict\n                        Debug.Print \"KEY: \" &amp; Key\n                        Debug.Print \"Item: \" &amp; Item\n                    Next\n\n            Else\n            'if the revised sentence isn't in the dict, then this is the first found word, so add it and replace the word\n                dict.Add .Sentences(1).Text, Replace$(Replace$(.Sentences(1).Text, .Text, vbNullString), Space(2), Space(1))\n                dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), \" ,\", \",\")\n                dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), \" .\", \".\")\n                dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), \" '\", \"'\")\n            End If\n            .Find.Execute\n        Loop\n    End With\n\n    'Loop through all the dictionary entries and find the origial (item) and replace With\n    'the revised (key)\n    For i = 1 To dict.Count\n        Set rSearch = objDocOrig.Range\n        With rSearch.Find\n            .MatchWholeWord = False\n            .MatchCase = False\n            .MatchPhrase = True\n            .IgnoreSpace = True\n            .IgnorePunct = True\n            .Wrap = wdFindContinue\n            .Text = dict.Items(i - 1)\n            .Replacement.Text = dict.Keys(i - 1)\n            .Execute Replace:=wdReplaceOne\n\n        End With\n        With objDocOrig.Range\n            .Font.Name = \"Calibri\"\n        End With\n    Next i\n\nobjDocChange.Close\nobjDocOrig.Save\nobjDocOrig.Close\n\nobjWordChange.Quit\nobjWordorig.Quit\n\nEnd Sub\n</code></pre>\n\n<p>If you need / want to test my code, you will have to create two word documents. Each document will need a common sentence containing an apostrophe (obviously). The second document would require a few blue words in addition to the original sentence in RGB 0,0,225.</p>\n"}]