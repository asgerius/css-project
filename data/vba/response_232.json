[{"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1561005964, "post_id": 56677332, "comment_id": 99924434, "body": "Including a UNION query in a query results in non-updatable dataset. Period."}, {"owner": {"reputation": 1, "user_id": 11673095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214297922149261/picture?type=large", "display_name": "Mark W", "link": "https://stackoverflow.com/users/11673095/mark-w"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1561095655, "post_id": 56677332, "comment_id": 99959219, "body": "Hmm. Ok. I would still like to know how to dynamically assign a key to a union query either way. Can alter table or some command create the key at creation of the union query? Since its a virtual object, I can think of how else it would be possible"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1561097665, "post_id": 56677332, "comment_id": 99959842, "body": "Cannot assign a PK in UNION query. I don&#39;t understand why you want to. Can still use UNION in another query and join on the common ProdID fields. ProdID is FK in UNION and it would join to PK in other table. Can use the UNION as source for INSERT to another table or MAKE TABLE."}, {"owner": {"reputation": 1, "user_id": 11673095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214297922149261/picture?type=large", "display_name": "Mark W", "link": "https://stackoverflow.com/users/11673095/mark-w"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1561102254, "post_id": 56677332, "comment_id": 99961750, "body": "Cool, thanks for the info...thats how I was using the union but when I looked deeper (in access) its main complaint for no update was that the linked table was not update able without PK join. I ended up just running INSERT and add columns to reset the table, works ok but now its static ie not linked dynamically as I make updates to the members of the union etc. Cheers"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11673095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214297922149261/picture?type=large", "display_name": "Mark W", "link": "https://stackoverflow.com/users/11673095/mark-w"}, "edited": false, "score": 0, "creation_date": 1561093772, "post_id": 56684803, "comment_id": 99958771, "body": "Thanks Siyon. Not sure if I was clear: At no time would a user enter any of the Cat_family etc: they are read only dynamic list. What I  would like to do is have a user fill out Obj_GlobID, Storey etc which is a related table. The AC_BOQ_AddDel table is completely empty at the beginning."}], "tags": [], "owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "is_accepted": false, "score": 1, "last_activity_date": 1561097207, "last_edit_date": 1561097207, "creation_date": 1561029367, "answer_id": 56684803, "question_id": 56677332, "link": "https://stackoverflow.com/questions/56677332/dynamic-union-query-with-primary-key/56684803#56684803", "title": "Dynamic Union Query with Primary Key", "body": "<p>You can't Insert a new row directly to UNION query<br>\nSo You will show the UNION on a subform <br>\nThen put Text controls below to enter the new row <br>\n<strong>Table Name</strong>, Cat_Family, Cat_Code, Cat_Name, ProdID, Item_Code, Item_Desc, Unit<br>\nAdd a button to Insert the new row <br>\nRequery the subform to view it</p>\n"}], "owner": {"reputation": 1, "user_id": 11673095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214297922149261/picture?type=large", "display_name": "Mark W", "link": "https://stackoverflow.com/users/11673095/mark-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594715434, "creation_date": 1560988618, "last_edit_date": 1594715434, "question_id": 56677332, "link": "https://stackoverflow.com/questions/56677332/dynamic-union-query-with-primary-key", "title": "Dynamic Union Query with Primary Key", "body": "<p>I have a union query that is a dynamic reference to a group of tables covering varying types of items. I want to create a linked table (via query)that will have manual entry that will use the union query as a contributing reference list. Now of course without a primary key, the recordset will not be updateable. I would like the union query to remain a dynamic list of items but without having a primary key to link the secondary table, there is no chance of updating ie allowing data entry on the second table. </p>\n\n<p>It works with static created table ie generated by the union but would be nice and clean and my OCD would be eased by simply keeping it live and I think parametric management is always better.</p>\n\n<p>The union query is of course simple...cut can the primary key be allocated here? ProdID is unique across all tables. Currently Cat_Code and Item_Code are a composite primary key in supporting tables</p>\n\n<pre><code>SELECT DataSheet_Products_NBC.Cat_Family, DataSheet_Products_NBC.Cat_Code, DataSheet_Products_NBC.Cat_Name, DataSheet_Products_NBC.ProdID, DataSheet_Products_NBC.Item_Code, DataSheet_Products_NBC.Item_Desc, DataSheet_Products_NBC.Unit\nFROM DataSheet_Products_NBC\nUNION \nSELECT DataSheet_Estimating_Statistics.Cat_Family, DataSheet_Estimating_Statistics.Cat_Code, DataSheet_Estimating_Statistics.Cat_Name, DataSheet_Estimating_Statistics.ProdID, DataSheet_Estimating_Statistics.Item_Code, DataSheet_Estimating_Statistics.Item_Desc, DataSheet_Estimating_Statistics.Unit\nFROM DataSheet_Estimating_Statistics\nUNION SELECT  DataSheet_Products_Other.Cat_Family, DataSheet_Products_Other.Cat_Code, DataSheet_Products_Other.Cat_Name, DataSheet_Products_Other.ProdID, DataSheet_Products_Other.Item_Code, DataSheet_Products_Other.Item_Desc, DataSheet_Products_Other.Unit\nFROM DataSheet_Products_Other;\n</code></pre>\n\n<p>I need to end up with a query, containing the union query, with primary key and a data table that can accept data ie be updateable.</p>\n\n<p><img src=\"https://i.stack.imgur.com/o7PmM.png\" alt=\"fDatasheet view\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/C9VMv.png\" alt=\"Design\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "edited": false, "score": 0, "creation_date": 1560992276, "post_id": 56677589, "comment_id": 99922045, "body": "I tried this code and when I ran it, nothing happened. Maybe I&#39;m doing something wrong? I&#39;m very new to macros."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "edited": false, "score": 0, "creation_date": 1560992878, "post_id": 56677589, "comment_id": 99922136, "body": "Pl check if <code>ThisWorkbook.ActiveSheet</code> column AF has data started from row 2"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "edited": false, "score": 0, "creation_date": 1560993451, "post_id": 56677589, "comment_id": 99922234, "body": "Also it assumed that Col AF has non zero positive whole numbers. Zero at any row will end the loop."}, {"owner": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "edited": false, "score": 0, "creation_date": 1560993515, "post_id": 56677589, "comment_id": 99922241, "body": "It does. Should i change &quot;ActiveSheet&quot; to the name of the actual sheet?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "edited": false, "score": 0, "creation_date": 1560993644, "post_id": 56677589, "comment_id": 99922269, "body": "Yes obviously.Pl change similar   Range &amp; sheets related parameters to your requirement. add a line <code>Msgbox ActNum</code> after line <code>ActNum = .Cells(R, Col).Value</code> and feedback."}, {"owner": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "edited": false, "score": 0, "creation_date": 1560993715, "post_id": 56677589, "comment_id": 99922279, "body": "Col AF does have a few numbers that fall between 0 and 1, like 0.5. How should i change the code to accomodate that"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "edited": false, "score": 0, "creation_date": 1560994213, "post_id": 56677589, "comment_id": 99922359, "body": "Just change <code>Dim ActNum As Double, Balance As Double</code> (tested again with changed declaration and found working correct)  instead of Long.that will accommodate fraction but certainly 0 would end the loop."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "edited": false, "score": 0, "creation_date": 1560994378, "post_id": 56677589, "comment_id": 99922381, "body": "Welcome,  you made my day."}, {"owner": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "edited": false, "score": 0, "creation_date": 1561149132, "post_id": 56677589, "comment_id": 99983392, "body": "So i need to make a change. Instead of adding rows when the quantity in column 32&gt;575, i need the code to add rows when the value in column 45&gt;0, and whatever that value is, thats how many rows i want to add. the majority of the values in column 45 are zeros, so i want the code to pick out the non-zero values and add that many rows beneath the row that contains that value. And i still want the date to go down by one week on every new row created. However, i now want column 32 in every new row to be blank and i want everything else from the row above copied down into the new row. Can you help?"}, {"owner": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "edited": false, "score": 0, "creation_date": 1561500274, "post_id": 56677589, "comment_id": 100082355, "body": "Would you be willing to take a look at the new question I posted today? You seem to really know what you are doing"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 1, "last_activity_date": 1561162472, "last_edit_date": 1561162472, "creation_date": 1560991452, "answer_id": 56677589, "question_id": 56676959, "link": "https://stackoverflow.com/questions/56676959/is-there-a-way-to-insert-a-certain-amount-of-rows-below-a-row-that-contains-cert/56677589#56677589", "title": "Is there a way to insert a certain amount of rows below a row that contains certain criteria?", "body": "<p>There are numerous way to achieve the objective. One is instead of reverse loop, you go down inserting balance amount and again on next row recalculated and so on till blank is encounters. May try the code tested with makeshift data</p>\n\n<pre><code>Option Explicit\nSub addLine()\nDim Col As Variant\n'Dim BlankRows As Long\n'Dim LastRow As Long\nDim R As Long\nDim StartRow As Long\nDim LargeOrder As Integer\n\nDim Ws As Worksheet\nDim ActNum As Double, Balance As Double\nSet Ws = ThisWorkbook.ActiveSheet\nCol = \"AF\"\nStartRow = 2\n'BlankRows = 1\nLargeOrder = 575\n\nR = StartRow\n  With Ws\n  ActNum = .Cells(R, Col).Value\n    Do While ActNum &lt;&gt; 0\n        If ActNum &gt; LargeOrder Then\n        .Cells(R + 1, Col).EntireRow.Insert Shift:=xlDown\n        .Range(.Cells(R, 1), .Cells(R, 42)).Copy Destination:=.Cells(R + 1, 1)\n        .Cells(R + 1, 1).Value = .Cells(R + 1, 1).Value - 7\n         'simpler calculation \n         Balance = IIf(ActNum Mod LargeOrder &gt; 0, Int(ActNum / LargeOrder) * LargeOrder, ActNum - LargeOrder)\n        'Balance = IIf(ActNum Mod LargeOrder &gt; 0, Int(ActNum / LargeOrder) * LargeOrder, Int(ActNum / LargeOrder) * LargeOrder - LargeOrder)\n        .Cells(R + 1, Col).Value = Balance\n        .Cells(R, Col).Value = ActNum - Balance\n        End If\n    R = R + 1\n    ActNum = .Cells(R, Col).Value\n    Loop\n  End With\nEnd Sub\n</code></pre>\n\n<p>Edit: may try the modified code below for the variance in requirement</p>\n\n<pre><code>Option Explicit\nSub addLine2()\nDim Col As Variant\nDim LastRow As Long\nDim R As Long, i As Long\nDim StartRow As Long\nDim RowtoAdd As Long\n\nDim Ws As Worksheet\nDim ActNum As Double, Balance As Double\nSet Ws = ThisWorkbook.ActiveSheet\nCol = \"AS\"\nStartRow = 2\nLastRow = Ws.Cells(Rows.Count, Col).End(xlUp).Row\n\nR = StartRow\n  With Ws\n\n    Do\n    RowtoAdd = .Cells(R, Col).Value\n    LastRow = LastRow + RowtoAdd\n        For i = 1 To RowtoAdd\n        .Cells(R + 1, Col).EntireRow.Insert Shift:=xlDown\n        .Cells(R, 1).EntireRow.Copy Destination:=.Cells(R + 1, 1)\n        .Cells(R + 1, 1).Value = .Cells(R + 1, 1).Value - 7\n        .Cells(R + 1, 32).Value = \"\"\n        R = R + 1\n        Next i\n    R = R + 1\n    Loop Until R &gt; LastRow\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11672976, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470433999686122/picture?type=large", "display_name": "Jake Udy", "link": "https://stackoverflow.com/users/11672976/jake-udy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 56677589, "answer_count": 1, "score": 1, "last_activity_date": 1564394263, "creation_date": 1560985385, "last_edit_date": 1564394263, "question_id": 56676959, "link": "https://stackoverflow.com/questions/56676959/is-there-a-way-to-insert-a-certain-amount-of-rows-below-a-row-that-contains-cert", "title": "Is there a way to insert a certain amount of rows below a row that contains certain criteria?", "body": "<p>I have a spreadsheet that contains data starting in row 2 column 1 and has 42 columns. I am trying to write a VBA code that will search all rows of my data starting with row 2 and if the value in column 32 is greater than 575, I need the code to insert enough rows below that row so that whatever the value was (whether it be 600 or 2,000) can be split into increments of 575. So for example, if row 5 column 32's value is 800, i want the code to add a row below row 5, and i want it to autofill the new row with the value of 575 in column 32 and replace the value in the original row with whatever it was minus 575. Also, in the first column of my data I have dates. For each new row that is created, I want it to be a week earlier than the date in the original row. Here is an example of what my data looks like:</p>\n\n<p>Column1 ...Column 32.......Column 42</p>\n\n<p>8/15/2019 // 3873                  </p>\n\n<p>Here is what i want it to look like after I run the code.</p>\n\n<p>Column1 ...Column 32......Column 42</p>\n\n<p>8/15/2019 //  423</p>\n\n<p>8/8/2019  //  575 </p>\n\n<p>8/1/2019 //   575</p>\n\n<p>7/25/2019  // 575</p>\n\n<p>7/18/2019  // 575</p>\n\n<p>7/11/2019  // 575</p>\n\n<p>7/4/2019   // 575</p>\n\n<p>The slash marks are just there to show the separation in columns. And I want the data from all the other columns to stay the same as the row above. Is there a good way to do this?</p>\n\n<p>This is the code I've come up with so far. However, the problem with it is I can't seem to figure out how to program it so that it know how many rows to add based on how large the quantity is. As of now, it just adds a row below any row that the value of column 32 is greater than 575. Also, it just adds blank rows. I don't have anything in my code that says what values to put in the newly created rows</p>\n\n<pre><code>Sub BlankLine()\n\nDim Col As Variant\nDim BlankRows As Long\nDim LastRow As Long\nDim R As Long\nDim StartRow As Long\nDim LargeOrder As Integer\n\n    Col = \"AF\"\n    StartRow = 1\n    BlankRows = 1\n    LargeOrder = 575\n\n        LastRow = Cells(Rows.Count, Col).End(xlUp).Row\n        Application.ScreenUpdating = False\n\n        With ActiveSheet\n        For R = LastRow To StartRow + 1 Step -1\n        If .Cells(R, Col).Value &gt; LargeOrder Then\n        .Cells(R + 1, Col).EntireRow.Insert Shift:=xlDown\n        End If\n        Next R\n        End With\n        Application.ScreenUpdating = True\n\n        End Sub\n</code></pre>\n\n<p>As I mentioned before, I need the code to add however many rows needed to accommodate the original quantity to be broken into increments of 575, and also subtract a week with every row created. Thank you in advance for your help.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1561003889, "post_id": 56676948, "comment_id": 99924032, "body": "Just two ideas: 1. Is there any code being executed on startup? 2. Take a look in the references of the database. Maybe there is something orphaned?"}, {"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 1, "creation_date": 1561007986, "post_id": 56676948, "comment_id": 99924938, "body": "May be there is redefenition of <code>Shell</code> function in the second database. Try to press <code>Ctrl + F2</code> at &#39;Shell&#39; in Immediate window to jump to definition."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1561022197, "post_id": 56676948, "comment_id": 99931212, "body": "Or be explicit and try <code>VBA.Shell</code> which will force the VBA library to be used."}, {"owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "reply_to_user": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1561046364, "post_id": 56676948, "comment_id": 99945095, "body": "@UnhandledException There&#39;s no Autoexec macro defined - if that&#39;s what you mean.  See my edit regarding the references."}, {"owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "reply_to_user": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 0, "creation_date": 1561046444, "post_id": 56676948, "comment_id": 99945136, "body": "@4dmonster When I go to the definition of <code>Shell</code> in the malfunctioning database, it goes to <code>VBA.Interaction.Shell</code>."}, {"owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "edited": false, "score": 0, "creation_date": 1561046480, "post_id": 56676948, "comment_id": 99945163, "body": "@Gareth I tried <code>VBA.Shell &quot;notepad.exe&quot;</code> and <code>VBA.Interaction.Shell &quot;notepad.exe&quot;</code> without success (same error)."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1561046745, "post_id": 56676948, "comment_id": 99945308, "body": "You could try a full <a href=\"https://stackoverflow.com/a/3268188/3820271\">Decompile</a>. -- Also, if you type <code>Shell </code> in the faulty db, does it show the correct Intellisense tooltip?"}, {"owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1561048549, "post_id": 56676948, "comment_id": 99946256, "body": "@Andre I just tried decompiling per the instructions in that link.  I still get the same error afterward.  IntelliSense works as expected now and did before as well."}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "is_accepted": false, "score": 2, "last_activity_date": 1561053515, "creation_date": 1561053515, "answer_id": 56691523, "question_id": 56676948, "link": "https://stackoverflow.com/questions/56676948/access-vba-shell-command-broken-in-one-particular-database/56691523#56691523", "title": "Access VBA: Shell command broken in one particular database", "body": "<p>The culprit was our anti-virus software!  <strong>UGH!</strong></p>\n\n<p>Why did it work in one database and not the other then?  I'm told that years ago, anti-virus exceptions were made for my computer for the one database but not the other.</p>\n\n<p>I recommend that any others who encounter this problem check their anti-virus logs/policies.  Also, running the database from another computer with different policies in place might shed some light on the issue faster.  In this case, when I used remote desktop to log into a server, I was able to call shell successfully.</p>\n"}], "owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594715444, "creation_date": 1560985317, "last_edit_date": 1594715444, "question_id": 56676948, "link": "https://stackoverflow.com/questions/56676948/access-vba-shell-command-broken-in-one-particular-database", "title": "Access VBA: Shell command broken in one particular database", "body": "<p>I have two Access databases that I'm opening on the same computer.  In one, running this in the immediate window works as expected (opens Notepad):</p>\n\n<pre><code>Shell \"notepad.exe\"\n</code></pre>\n\n<p>In the other, I get this error instead:</p>\n\n<blockquote>\n  <p>Run-time error '5': Invalid procedure call or argument</p>\n</blockquote>\n\n<p>I have not been able to come up with any shell command that will run successfully in that second database. No matter what, I get that error.  </p>\n\n<p>What is going on here?  Could there be a security setting coming into play?  Or perhaps one is an older version?</p>\n\n<h2>Edit - More Info</h2>\n\n<ul>\n<li><p>When I go to the definition of <code>Shell</code> in the malfunctioning database, it goes to <code>VBA.Interaction.Shell</code>.</p></li>\n<li><p>I get the correct IntelliSense tooltip for <code>Shell</code>.</p></li>\n<li><p>I tried <code>VBA.Shell \"notepad.exe\"</code> and <code>VBA.Interaction.Shell \"notepad.exe\"</code> without success (same error).</p></li>\n<li><p>Here are the references that are checked in both databases:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VEjVT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VEjVT.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Decompiling did not help.</p></li>\n</ul>\n"}, {"tags": ["vba", "ms-access", "decimal", "modulus"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560983855, "post_id": 56676654, "comment_id": 99920470, "body": "Difficult to see how this is happening if lblPU is really 10.45 and quantity is really 1"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 1, "creation_date": 1560984198, "post_id": 56676654, "comment_id": 99920541, "body": "If you are using dot as thousands separator then normally 10.45 would mean 1045. Instead of strings work with numerics or use correct decimal separator based on regional settings."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1560984364, "post_id": 56676654, "comment_id": 99920575, "body": "if the regional settings used the comma then his label would display 10,45 but it displays 10.45 so the comma is probably not the issue."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560987230, "post_id": 56676654, "comment_id": 99921169, "body": "Check value of Excel Options-&gt;Advanced-&gt;Use system separators.. Seems unticked."}, {"owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561010352, "post_id": 56676654, "comment_id": 99925628, "body": "Hi @TimWilliams, The variable <code>rs!Price = 11</code>. The field <code>lblPU</code> value is ibtained by getting 5% off of  <code>rs!Price</code>. In this case, a whole number (11) is mulplied by a decimal (5%) and the result is correct with the decimal (10.45). But when the same type of calculation happens on the line below (<code>10.45*1</code>), then the resul is coming out without the decimal point. Sorry for the late reply, time difference"}, {"owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "reply_to_user": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 0, "creation_date": 1561011532, "post_id": 56676654, "comment_id": 99926088, "body": "Hi @CetinBasoz, I haven&#39;t set any particular properties regarding the 1000s. I have read somewhere that VBA does use the <code>.</code> as a default decimal indicator so it should interpret it as such I guess. the thing, the first calculation is done with <code>5&#47;100</code> and the output is <code>10.45</code>. So VBA itself is considering the <code>.</code>  as decimal. I don&#39;t know if it would change something to check for @computerVersteher&#39;s suggestion but I will try it out anyway"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 0, "creation_date": 1561043078, "post_id": 56676654, "comment_id": 99943174, "body": "I didn&#39;t say you did something (actually you did indirectly). Check your computer&#39;s settings for decimal separator and such. In VBA and other languages 10.45 means 10 and 45/100, that is true. But here you are not using 10.45 as a literal but parsing a string (lblPU) to a numeric value. As a string &quot;10.45&quot; means 1045 if in your regional settings thousands separator is a dot and a decimal separator is a comma. Those settings are common in European windows installations for example. Please first check your regional settings."}], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1560984144, "post_id": 56676789, "comment_id": 99920535, "body": "can you provide a solution too? I know if he changes his formatting it will work, but I am curious to know how he can do that without doing mathematical manipulation etc?"}, {"owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "edited": false, "score": 0, "creation_date": 1561011667, "post_id": 56676789, "comment_id": 99926143, "body": "Hi Lee, the thing is I don&#39;t have any control over the value of <code>lblPU</code>. It is a variable so I can&#39;t hardcode it in my program"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "edited": false, "score": 0, "creation_date": 1561056713, "post_id": 56676789, "comment_id": 99949741, "body": "@BrunoBukavuThai Cetin&#39;s answer is essentially the same as mine."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1560984349, "last_edit_date": 1560984349, "creation_date": 1560984031, "answer_id": 56676789, "question_id": 56676654, "link": "https://stackoverflow.com/questions/56676654/vba-drops-the-decimal-point-when-multiplying-decimal-with-whole-number/56676789#56676789", "title": "VBA drops the decimal point when multiplying decimal with whole number", "body": "<p>If <code>Me.lblPU</code> is returning a string representation of the numerical value in which the decimal point is represented using a comma (perhaps due to regional settings), then <code>CDec</code> will return <code>1045</code> instead of <code>10.45</code>, observe:</p>\n\n<pre><code>?CDec(\"10.45\")\n 10.45 \n?CDec(\"10,45\")\n 1045 \n</code></pre>\n\n<p>I would suggest avoiding any potential string conversion and work with the numerical value directly, e.g.:</p>\n\n<pre><code>Me.lblPriceTot = 0.95 * rs!price * CDec(Me.Qty)\n</code></pre>\n\n<p>Similarly with the quantity field, use <code>rs!quantity</code> (if it exists).</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1561016484, "creation_date": 1561016484, "answer_id": 56681266, "question_id": 56676654, "link": "https://stackoverflow.com/questions/56676654/vba-drops-the-decimal-point-when-multiplying-decimal-with-whole-number/56681266#56681266", "title": "VBA drops the decimal point when multiplying decimal with whole number", "body": "<p>First, it is very confusing that fields are named as labels.</p>\n\n<p>Then, use a <em>variable</em> to cut it short:</p>\n\n<pre><code>Dim TruePrice As Currency\n\nTruePrice = price * (1 - 5 / 100)\nMe!lblPU.Value = TruePrice\nMe!lblPriceTot.Value = TruePrice * Me!Qty.Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "edited": false, "score": 0, "creation_date": 1561053414, "post_id": 56688947, "comment_id": 99948398, "body": "Wow great! Thanks a lot Cetin! The first option worked fine"}], "tags": [], "owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "is_accepted": true, "score": 0, "last_activity_date": 1561043326, "creation_date": 1561043326, "answer_id": 56688947, "question_id": 56676654, "link": "https://stackoverflow.com/questions/56676654/vba-drops-the-decimal-point-when-multiplying-decimal-with-whole-number/56688947#56688947", "title": "VBA drops the decimal point when multiplying decimal with whole number", "body": "<p>Writing this in comments would be a mess. Instead of parsing a string to a decimal, directly use the decimal value:</p>\n\n<pre><code>Me.lblPU = (rs!price - (rs!price  * (5 / 100)))\nMe.lblPriceTot = ((rs!price - (rs!price  * (5 / 100))) * CDec(Me.Qty))\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>dim price as decimal = (rs!price - (rs!price  * (5 / 100)))\nMe.lblPU = price\nMe.lblPriceTot = (price * CDec(Me.Qty))\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 56688947, "answer_count": 3, "score": 1, "last_activity_date": 1594715456, "creation_date": 1560983061, "last_edit_date": 1594715456, "question_id": 56676654, "link": "https://stackoverflow.com/questions/56676654/vba-drops-the-decimal-point-when-multiplying-decimal-with-whole-number", "title": "VBA drops the decimal point when multiplying decimal with whole number", "body": "<p>I have a userform that retrieves price amount from an Access table. Prices can be decimals. To compute the total prices of a line, I have to multiply it by the quantity. </p>\n\n<p>A typical example is: </p>\n\n<ul>\n<li><code>Price = 10.45</code></li>\n<li><code>Quantity = 1</code> </li>\n</ul>\n\n<p>Logically, what I want is <code>Tot = 10.45*1 = 10.45</code>. But VBA gives me <code>1045</code> without the decimal point.</p>\n\n<p>I have scrolled through the forum and seen some suggestions (converting to decimals, using modulus, declaring double, single, float,...) but the result does not change. </p>\n\n<p>The code that I am using goes like this:</p>\n\n<pre><code>Me.lblPU = (rs!price - (rs!price  * (5 / 100)))\nMe.lblPriceTot = (CDec(Me.lblPU) * CDec(Me.Qty))\n</code></pre>\n\n<p>The field <code>lblPU</code> is giving the correct number: <code>10.45</code>\nBut the field <code>lblPriceTot</code> is giving <code>1045</code> as a result.</p>\n\n<p>I didn't declare any variable regarding this fields because they are actually retrieved from Access and therefore are not encoded by a user.</p>\n\n<p>Thanks in advance for any help!</p>\n"}, {"tags": ["excel", "vba", "boolean-expression"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 4, "creation_date": 1560982257, "post_id": 56676495, "comment_id": 99920106, "body": "I believe these are treated as <code>Boolean</code> values ( <code>True</code> or <code>False</code>). I believe <code>True</code> is -1 while <code>False</code> is 0."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1560982684, "last_edit_date": 1560982684, "creation_date": 1560982372, "answer_id": 56676557, "question_id": 56676495, "link": "https://stackoverflow.com/questions/56676495/what-does-a-second-equals-within-vba-variable-assignment-do/56676557#56676557", "title": "What does a second equals = within vba variable assignment do?", "body": "<pre><code>(s = n)\n</code></pre>\n\n<p>If both s and n have the same value then this evaluates to <code>True</code>, which can be coerced to its underlying value of -1 by other arithmetic operations.</p>\n\n<p>Eg:</p>\n\n<pre><code>? True * 1   '&gt;&gt; -1\n? False * 1   '&gt;&gt; 0\n</code></pre>\n\n<p>So this: </p>\n\n<pre><code>s = Int(xVal) + (xVal = n + 1)\n</code></pre>\n\n<p>is like writing:</p>\n\n<pre><code>If xVal = n + 1 Then\n    s = Int(xVal) + -1\nelse\n    s = Int(xVal) + 0\nend if\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>s = Int(xVal) + IIf(xVal = n + 1, -1, 0)\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10670479, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JiY83_Uq2sQ/AAAAAAAAAAI/AAAAAAAAAO0/KKSCseEgPZU/photo.jpg?sz=128", "display_name": "ShaunMc", "link": "https://stackoverflow.com/users/10670479/shaunmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 56676557, "answer_count": 1, "score": 3, "last_activity_date": 1560982748, "creation_date": 1560981960, "last_edit_date": 1560982748, "question_id": 56676495, "link": "https://stackoverflow.com/questions/56676495/what-does-a-second-equals-within-vba-variable-assignment-do", "title": "What does a second equals = within vba variable assignment do?", "body": "<p>Perplexed by the function of using a second = sign in vba. eg. s = Int(xVal) + (xVal = n + 1)</p>\n\n<p>I had been deciphering some code and came across the following line which is perplexing me somewhat and despite some extensive research and debugging I seem to be struggling to find the answer:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>s = Int(xVal) + (xVal = n + 1)\n</code></pre>\n\n<p>and</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>p(i, 3) = A(i)(s + 3 + (s = n)) + (s = n) * (p(i, 1) - p(i, 2))\n</code></pre>\n\n<p>My question is what is the function of the comparisons within the parentheses after the first assignment = sign?</p>\n\n<p>TIA</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "automation", "onclick"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1560982489, "creation_date": 1560982489, "answer_id": 56676575, "question_id": 56676359, "link": "https://stackoverflow.com/questions/56676359/excel-vba-internet-explorer-onclick-to-click-drop-down-menu/56676575#56676575", "title": "Excel VBA Internet Explorer Onclick to click drop down menu", "body": "<p>I am going to assume you want to expand the folder but it would help to indicate which element needs to receive the click.</p>\n\n<p>To do this I use a css attribute = value selector with * contains operator to target the onclick attribute by the part of its value</p>\n\n<pre><code>ie.document.querySelector(\"[onclick*=FolderExpand]\").click\n</code></pre>\n\n<p>If the event needs triggering then</p>\n\n<pre><code>ie.document.querySelector(\"[onclick*=FolderExpand]\").FireEvent \"onclick\"\n</code></pre>\n\n<p>Similar principles can be applied to target the other elements which have <code>onclick</code> or <code>ondblclick</code> attributes.</p>\n\n<p>The finance element can be targeted by its title attribute</p>\n\n<pre><code>ie.document.querySelector(\"[title=Finance]\")\n</code></pre>\n\n<p>I'm not sure this is a target for a click however.</p>\n"}, {"tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1560994291, "creation_date": 1560994291, "answer_id": 56677871, "question_id": 56676359, "link": "https://stackoverflow.com/questions/56676359/excel-vba-internet-explorer-onclick-to-click-drop-down-menu/56677871#56677871", "title": "Excel VBA Internet Explorer Onclick to click drop down menu", "body": "<p>From your HTML code it looks like <strong>Finance</strong> div is inside a parent div which has class name as <strong>treeSelectorStyle</strong> and it has the onclick event.</p>\n\n<p>So you can try to click on parent div using its class name may help to solve the issue.</p>\n\n<p>Sample code:</p>\n\n<pre><code>Sub demo()\n\n    Dim URL As String\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    URL = \"C:\\Users\\Administrator\\Desktop\\152.html\"   'chnage the URL here...\n    IE.Navigate URL\n\n    Do While IE.ReadyState = 4: DoEvents: Loop\n    Do Until IE.ReadyState = 4: DoEvents: Loop\n\n    IE.document.getelementsbyclassname(\"treeSelectorStyle\").Item(0).Click\n    Set IE = Nothing\nEnd Sub\n</code></pre>\n\n<p>Here based on sample code I click on Item(0) but you need to change the index number of element which has <strong>treeSelectorStyle</strong> class to click the correct element.</p>\n"}], "owner": {"reputation": 17, "user_id": 8100287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9192cab537dc19626bdf519f28c508f?s=128&d=identicon&r=PG&f=1", "display_name": "chappemo", "link": "https://stackoverflow.com/users/8100287/chappemo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 568, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1560994291, "creation_date": 1560981001, "question_id": 56676359, "link": "https://stackoverflow.com/questions/56676359/excel-vba-internet-explorer-onclick-to-click-drop-down-menu", "title": "Excel VBA Internet Explorer Onclick to click drop down menu", "body": "<p>I am attempting to click a drop down type menu in Internet Explorer using Excel VBA code. </p>\n\n<p>Here is the HTML code:</p>\n\n<pre><code>&lt;div class=\"treeNodeStyle\" id=\"trMenu_14\" nowrap=\"\" style=\"visibility: visible;\"&gt;\n&lt;div class=\"treeNodeWrapperStyle\" nowrap=\"\"&gt;\n&lt;a class=\"treeInlineStyle\" onclick=\"FolderExpand('trMenu','14');return false;\" href=\"\"&gt;\n&lt;img align=\"top\" class=\"treeInlineStyle\" src=\"/visimages/tree/plus.gif\" border=\"0\"&gt;\n&lt;/a&gt; \n&lt;div class=\"treeSelectorStyle\" onclick=\"selectNode('trMenu','14',false)\" ondblclick=\"dblselectNode('trMenu','14')\"&gt;\n&lt;img align=\"absmiddle\" class=\"treeInlineStyleImg\" src=\"/visimages/tree/folder.gif\" border=\"0\"&gt;\n&lt;div title=\"Finance\" class=\"treeNodeTextStyle\" nowrap=\"true\"&gt; Finance&lt;/div&gt;\n</code></pre>\n\n<p>Here is the VBA code I am attempting to use. Trying to understand if I should be referencing the ID or the class.</p>\n\n<pre><code>Dim btn as Object\n\nFor Each btn In IE.Document.getElementsByClassName(\"treeNodeStyle\")\n    If btn.innerText = \"Finance\" Then\n        btn.Click\n        Exit For\n    End If\nNext btn\n</code></pre>\n\n<p>I cannot get the code to find any kind of element within the HTML.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1560982615, "post_id": 56676337, "comment_id": 99920190, "body": "Have you tried: <code>ws.Range(&quot;B&quot;).Formula = &quot;=AVERAGE(&quot; &amp; range2.address &amp; &quot;)&quot;</code>?"}, {"owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1560983694, "post_id": 56676337, "comment_id": 99920439, "body": "Hi, This now works thanks for this... made some slight changes see code above. Now running into the problem where the formulas are not being pasted into the repairer.range. also the selection range is locked $c$6:$e$6 rather than $c6:$E6"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "is_accepted": true, "score": 0, "last_activity_date": 1560984782, "creation_date": 1560984782, "answer_id": 56676880, "question_id": 56676337, "link": "https://stackoverflow.com/questions/56676337/using-selection-stored-as-variable-in-a-vba-cell-formula/56676880#56676880", "title": "Using selection stored as variable in a VBA cell formula", "body": "<p>Fixed my problem.</p>\n\n<p>Probably not the best solution but it works. Amending the formula afterwards to remove the cell locking feature. Then used a different method to copy into the cells in the repairer range.</p>\n\n<pre><code>Sub Calculate_Average()\n\nDim ws As Worksheet\nDim sSheet As String\nDim Year As Range\nDim myCells As Range\nDim Repairer As Range\nDim range2 As Range\nDim FindRng As Range\n\nSet ws = ActiveWorkbook.Sheets(\"Sheet1\")\nSet Year = ws.Range(\"$c$5:$s$5\")\nSet Repairer = ws.Range(\"b8:b52\")\n\n\nsSheet = InputBox( _\nPrompt:=\"Enter current month in format mmm-yy\", _\nTitle:=\"Input Month\")\n\n        If sSheet = \"May-19\" Then GoTo loopexit ''debug\n        If sSheet = \"Jun-19\" Then GoTo loopexit ''debug\n\n\n'' loop through cells in Year range to find matching date\n\nSet FindRng = Year.Find(What:=sSheet, LookIn:=xlValues, lookat:=xlWhole)\n\nIf Not FindRng Is Nothing Then ' see that find was successful\n    FindRng.Select\n\n        If ActiveCell.Value = sSheet Then\n            ActiveCell.Offset(1, -2).Select\n            Selection.Resize(Selection.Rows.Count, Selection.Columns.Count + 2).Select\n            Set myCells = Selection\n            MsgBox (myCells.Address)\n            ws.Range(\"B6\").Formula = \"=AVERAGE(\" &amp; myCells.Address &amp; \")\"\n            Range(\"B6\").Select\n            ActiveCell.FormulaR1C1 = \"=AVERAGE(RC4:RC6)\"\n            Range(\"B6\").Select\n            Selection.AutoFill Destination:=Range(\"B6:B52\")\n            Range(\"B6:B52\").Select\n\n            GoTo loopexit\n        Else\n    MsgBox \"Error, unable to match\", vbCritical\n        End If\n        End If\n\nloopexit: ''debug\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1560985669, "creation_date": 1560985669, "answer_id": 56677002, "question_id": 56676337, "link": "https://stackoverflow.com/questions/56676337/using-selection-stored-as-variable-in-a-vba-cell-formula/56677002#56677002", "title": "Using selection stored as variable in a VBA cell formula", "body": "<p>Not sure if I am missing something here but you don't need to loop. You can do the formula in one go then copy and paste as values:</p>\n\n<pre><code>With Range(\"B6:B52\")\n    .Formula = \"=average(C6:E6)\" 'Excel is smart enough to increase this per row\n    .Copy\n    .PasteSpecial xlPasteValues\nend with\n</code></pre>\n\n<p>No selecting and no looping.</p>\n"}], "owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 56676880, "answer_count": 2, "score": -1, "last_activity_date": 1560985669, "creation_date": 1560980859, "last_edit_date": 1560983783, "question_id": 56676337, "link": "https://stackoverflow.com/questions/56676337/using-selection-stored-as-variable-in-a-vba-cell-formula", "title": "Using selection stored as variable in a VBA cell formula", "body": "<p>I am trying to use a selected range (which is conditional based on the user input) which is stored as a variable in a VBA generated cell formula.</p>\n\n<p>When using the myCells.Address value in a message box, I can see the variable is correctly storing the selected range. however, when I am trying to insert this into a cell formula created through VBA code I either get a type mismatch error (when storing as a range) or an object required error when storing as a string.</p>\n\n<p>I have tried converting the stored range in myCells variable into either a string or range to be used in the .formula but neither seems to be acceptable,</p>\n\n<pre><code>Sub Calculate_Average()\n\nDim ws As Worksheet\nDim sSheet As String\nDim Year As Range\nDim myCells As Range\nDim Repairer As Range\nDim range2 As Range\n\nSet ws = ActiveWorkbook.Sheets(\"Sheet1\")\nSet Year = ws.Range(\"$c$5:$s$5\")\nSet Repairer = ws.Range(\"$b$8:$b$52\")\n\n\nsSheet = InputBox( _\nPrompt:=\"Enter current month in format mmm-yy\", _\nTitle:=\"Input Month\")\n\n        If sSheet = \"May-19\" Then GoTo loopexit ''debug\n        If sSheet = \"Jun-19\" Then GoTo loopexit ''debug\n\n\n'' loop through cells in Year range to find matching date\n\nFor Each Cell In Year\n\n        Cell.Select ''debug\n\n        If ActiveCell.Value = sSheet Then\n            ActiveCell.Offset(1, -2).Select\n            Selection.Resize(Selection.Rows.Count, Selection.Columns.Count + 2).Select\n            Set myCells = Selection\n            MsgBox (myCells.Address)\n            ws.Range(\"B6\").Formula = \"=AVERAGE(\" &amp; myCells.Address &amp; \")\"\n            ActiveCell.Copy\n            Repairer.Select\n            PasteSpecial xlPasteFormulas\n            GoTo loopexit\n        Else\n            MsgBox (\"error\") ''debug\n        End If\nNext Cell\nloopexit: ''debug\n\nEnd Sub\n</code></pre>\n\n<p>The formula is entered into cell b6 and should look like =average($c6:$E6) and then be copied into the range b$8:$b$53 adjusting to reflect the change in row.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1560980179, "post_id": 56676181, "comment_id": 99919503, "body": "<code>Dim numCol as Long</code>, then <code>Cells(4, numCol)</code>. But you probably don&#39;t need to use <code>Activate</code> or <code>Select</code>. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select</a>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1560980288, "post_id": 56676181, "comment_id": 99919549, "body": "<code>numCol</code> is an integer. casting it to string will give you something like <code>Range(&quot;14&quot;).Select</code>, and that&#39;s not a valid range identifier. BigBen has the solution, this is just mis-using or misunderstanding how <code>Range</code> arguments work. Cheers."}], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1560991335, "last_edit_date": 1560991335, "creation_date": 1560981119, "answer_id": 56676376, "question_id": 56676181, "link": "https://stackoverflow.com/questions/56676181/trying-to-select-a-cell-with-a-variable-as-a-column-number/56676376#56676376", "title": "Trying to select a cell with a variable as a column number", "body": "<p>Here's some modified code from your query that might be useful. You want to try to use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range(object)\" rel=\"nofollow noreferrer\">properties of the range</a>. In the below example I've defined a range that is the found cell <code>fcell</code>. A couple examples of what you can do ar there.</p>\n\n<pre><code>Dim numCol As Long\nDim fcell As Range\n\n'this will find the cell and set it as a variable of fcell\nSet fcell = Cells.Find(what:=\"e\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\n'you can select it\nfcell.Select\n\n'you can select the whole column\nfcell.EntireColumn.Select\n\n 'you can select the column number (if one column)\n numCol = fcell.Column\n\n'you can return the address\nMsgBox \"the address is \" &amp; fcell.Address\n</code></pre>\n\n<p>Good luck.</p>\n"}], "owner": {"reputation": 21, "user_id": 11672827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a28ea32c8277131b08b5cefe7b4e4bef?s=128&d=identicon&r=PG&f=1", "display_name": "user11672827", "link": "https://stackoverflow.com/users/11672827/user11672827"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560991335, "creation_date": 1560980090, "question_id": 56676181, "link": "https://stackoverflow.com/questions/56676181/trying-to-select-a-cell-with-a-variable-as-a-column-number", "title": "Trying to select a cell with a variable as a column number", "body": "<p>I'm trying to set up a code that will find a cell using the find function and then select a different cell in that column.  I store the column number as a variable, and then try to move to a cell in the same column using the variable, but its not working.</p>\n\n<p>I've tried changing it so that the column is stored as a string instead of an integer and tried using the .Cells method instead, neither have worked.  </p>\n\n<pre><code>Dim numCol As String\n\nCells.Find(what:=\"e\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= \n_\n    False, SearchFormat:=False).Activate\n\nnumCol = ActiveCell.Column\n\nRange(numCol &amp; \"4\").Select\n</code></pre>\n\n<p>Getting a 1004 \"method range of object global failed\" error from that last line of code.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560977999, "post_id": 56675584, "comment_id": 99918761, "body": "Why does <code>rngFirstRow</code> have two rows? That means you do the sort twice on each column."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1561000952, "post_id": 56675584, "comment_id": 99923513, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17530785/sorting-alphabetically-and-by-cell-color\">Sorting Alphabetically and by Cell Color</a>"}, {"owner": {"reputation": 93, "user_id": 11666863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f13589cd21afc761e3b81e6fa294460?s=128&d=identicon&r=PG&f=1", "display_name": "Starbucks", "link": "https://stackoverflow.com/users/11666863/starbucks"}, "edited": false, "score": 0, "creation_date": 1561345794, "post_id": 56675584, "comment_id": 100018301, "body": "I still can&#39;t figure this one out, any help?"}], "owner": {"reputation": 93, "user_id": 11666863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f13589cd21afc761e3b81e6fa294460?s=128&d=identicon&r=PG&f=1", "display_name": "Starbucks", "link": "https://stackoverflow.com/users/11666863/starbucks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561048690, "creation_date": 1560977119, "last_edit_date": 1561048690, "question_id": 56675584, "link": "https://stackoverflow.com/questions/56675584/using-vba-to-sort-highlighted-cells", "title": "Using VBA to sort highlighted cells", "body": "<p>I am trying to sort the cells by whether they are highlighted or not. If they are I am looking for those rows to be at the top. </p>\n\n<p>Have tried some code from another question but can't figure it out. </p>\n\n<pre><code>'sort highlighted and alphabetical\nSub SortColor()\n\n    Dim rngFirstRow As Range\n    Dim rng As Range, rngSort As Range\n    Dim ws As Worksheet\n\n    Application.ScreenUpdating = False\n    Set ws = Sheets(\"modified_report\")\n    Set rngFirstRow = ws.Range(\"K2:M2\")\n    For Each rng In rngFirstRow.Cells\n        With ws.Sort\n\n            Set rngSort = rng.Resize(150, 1)\n\n            .SortFields.Clear\n            .SortFields.Add(rng, xlSortOnCellColor, xlDescending, , xlSortNormal). _\n                            SortOnValue.Color = RGB(198, 239, 206)\n            .SetRange rngSort\n            .Header = xlNo\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n\n        End With\n    Next rng\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>If there are highlighted cells in columns K:M, I was those row at the top.</p>\n\n<p>I can't get the whole row to move to the top. This code seems to just move those cells and therefore messes with the rest of the row. </p>\n"}, {"tags": ["vba", "shell", "ms-access"], "comments": [{"owner": {"reputation": 23, "user_id": 11672558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c987614765f5f36d3c381cf7bfd340c4?s=128&d=identicon&r=PG&f=1", "display_name": "goldgerm", "link": "https://stackoverflow.com/users/11672558/goldgerm"}, "edited": false, "score": 0, "creation_date": 1560976701, "post_id": 56675309, "comment_id": 99918283, "body": "It is just a string to a folder. I have literally set it to just &quot;S:\\Supply Chain\\Freight&quot; for testing purposes. I dont really want to open a specific file like a pdf or an excel document because there will be multiple in this folder.  I have also tried using the full server path and that didnt work either"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560976756, "post_id": 56675309, "comment_id": 99918311, "body": "The code in the top snippet works perfectly fine here, ...given a valid path, with or without spaces in it. Is the <code>S</code> drive a mapped network drive? (should work fine too) - I can&#39;t repro the error 5 you&#39;re getting, even with an invalid path (it opens &quot;my documents&quot;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560977080, "post_id": 56675309, "comment_id": 99918411, "body": "FWIW the <code>Shell</code> function is defined in the <code>VBA.Interaction</code> module; it&#39;s in the VBA standard library, just like <code>MsgBox</code>. No &quot;special references&quot; are needed."}, {"owner": {"reputation": 23, "user_id": 11672558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c987614765f5f36d3c381cf7bfd340c4?s=128&d=identicon&r=PG&f=1", "display_name": "goldgerm", "link": "https://stackoverflow.com/users/11672558/goldgerm"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560977113, "post_id": 56675309, "comment_id": 99918424, "body": "I realize it is very strange. I have another database on the same computer that the same exact code works perfectly fine. I am just wondering if I dont have a setting activated or something that is preventing it from working"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560977532, "post_id": 56675309, "comment_id": 99918576, "body": "Stupid question: does the project compile? Debug ~&gt; Compile VBAProject"}, {"owner": {"reputation": 23, "user_id": 11672558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c987614765f5f36d3c381cf7bfd340c4?s=128&d=identicon&r=PG&f=1", "display_name": "goldgerm", "link": "https://stackoverflow.com/users/11672558/goldgerm"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560977606, "post_id": 56675309, "comment_id": 99918608, "body": "Yep, everything is compiled. Here is a photo of the code side by side. If you just look at the highlighted areas that is what is running (Rest of stuff would work if I wasnt testing). But it works on one and not the other  <a href=\"https://imgur.com/YUpVQAW\" rel=\"nofollow noreferrer\">imgur.com/YUpVQAW</a>  Saw i had the call shell not commented out, but still - commented out that line and same result"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 1, "creation_date": 1560983067, "post_id": 56675309, "comment_id": 99920302, "body": "Is it possible that the symbol <code>Shell</code> has been redefined elsewhere in the database?"}, {"owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "edited": false, "score": 0, "creation_date": 1560992859, "post_id": 56675309, "comment_id": 99922134, "body": "For what it&#39;s worth, I&#39;m having the exact same problem: <code>Shell</code> works in one database but not another.  My test is as simple as it gets: <code>Shell &quot;notepad.exe&quot;</code>.  The question is here: <a href=\"https://stackoverflow.com/questions/56676948/access-vba-shell-command-broken-in-one-particular-database\" title=\"access vba shell command broken in one particular database\">stackoverflow.com/questions/56676948/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 11672558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c987614765f5f36d3c381cf7bfd340c4?s=128&d=identicon&r=PG&f=1", "display_name": "goldgerm", "link": "https://stackoverflow.com/users/11672558/goldgerm"}, "edited": false, "score": 0, "creation_date": 1561036393, "post_id": 56675309, "comment_id": 99939085, "body": "Only instance of <code>Shell</code> is the single time i use it"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1561037753, "post_id": 56675309, "comment_id": 99939873, "body": "Ok I&#39;m curious now - if you parse the code with <a href=\"http://www.rubberduckvba.com/\" rel=\"nofollow noreferrer\">Rubberduck</a>, and then select the <code>Shell</code> function call, does the Rubberduck toolbar say <code>VBE7.DLL;VBA.Interaction.Shell (function:Double)</code> or something else?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11672558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c987614765f5f36d3c381cf7bfd340c4?s=128&d=identicon&r=PG&f=1", "display_name": "goldgerm", "link": "https://stackoverflow.com/users/11672558/goldgerm"}, "edited": false, "score": 0, "creation_date": 1560977958, "post_id": 56675712, "comment_id": 99918744, "body": "Thanks for the answer, unfortunately no dice. Still got the error 5  What&#39;s strange is I paste that into a different database and it works just fine, I wonder if i just have a corrupt access file..."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1560977743, "creation_date": 1560977743, "answer_id": 56675712, "question_id": 56675309, "link": "https://stackoverflow.com/questions/56675309/apply-working-shell-code-in-a-different-database/56675712#56675712", "title": "Apply working Shell code in a different database", "body": "<p>Try this:  </p>\n\n<pre><code>FreightFile_Path = \"S:\\Supply Chain\\Freight\"\nShell \"cmd /c start explorer.exe \"\"\" &amp; FreightFile_Path &amp; \"\"\"\"\n</code></pre>\n\n<p>It is a bit of a workaround, but it works...</p>\n"}, {"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1560978460, "creation_date": 1560978460, "answer_id": 56675854, "question_id": 56675309, "link": "https://stackoverflow.com/questions/56675309/apply-working-shell-code-in-a-different-database/56675854#56675854", "title": "Apply working Shell code in a different database", "body": "<p>New try. Use a WinAPI call  </p>\n\n<pre><code>Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" (ByVal hwnd As Long, _\n    ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, _\n    ByVal lpDirectory As String, ByVal lpnShowCmd As Long) As Long\n\nPublic Sub ShellEx(ByVal Path As String, Optional ByVal Parameters As String, Optional ByVal HideWindow As Boolean)\n    If Dir(Path) &gt; \"\" Then\n        ShellExecute 0, \"open\", Path, Parameters, \"\", IIf(HideWindow, 0, 1)\n    End If\nEnd Sub\n\nSub Test()\n    FreightFile_Path = \"S:\\Supply Chain\\Freight\"\n    ShellEx \"c:\\windows\\explorer.exe\", \"\"\"\" &amp; FreightFile_Path &amp; \"\"\"\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 11672558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c987614765f5f36d3c381cf7bfd340c4?s=128&d=identicon&r=PG&f=1", "display_name": "goldgerm", "link": "https://stackoverflow.com/users/11672558/goldgerm"}, "is_accepted": false, "score": 0, "last_activity_date": 1561046624, "last_edit_date": 1561046624, "creation_date": 1561037587, "answer_id": 56687165, "question_id": 56675309, "link": "https://stackoverflow.com/questions/56675309/apply-working-shell-code-in-a-different-database/56687165#56687165", "title": "Apply working Shell code in a different database", "body": "<p>Thank you everybody for the help. This might not really be an answer to the <code>Shell</code> problem, but it will work for opening a file path.</p>\n\n<pre><code>Dim FreightFilePath As String\nFreightFilePath = \"S:\\Supply Chain\\Freight\"\nApplication.FollowHyperLink FreightFilePath\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 11672558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c987614765f5f36d3c381cf7bfd340c4?s=128&d=identicon&r=PG&f=1", "display_name": "goldgerm", "link": "https://stackoverflow.com/users/11672558/goldgerm"}, "edited": false, "score": 0, "creation_date": 1561061745, "post_id": 56691611, "comment_id": 99951791, "body": "This is the answer. Thank you"}, {"owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "reply_to_user": {"reputation": 23, "user_id": 11672558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c987614765f5f36d3c381cf7bfd340c4?s=128&d=identicon&r=PG&f=1", "display_name": "goldgerm", "link": "https://stackoverflow.com/users/11672558/goldgerm"}, "edited": false, "score": 0, "creation_date": 1561062129, "post_id": 56691611, "comment_id": 99951930, "body": "@goldgerm Sweet!  It&#39;s so weird how we both had the same strange problem on the same day.  Glad it worked out :)"}, {"owner": {"reputation": 23, "user_id": 11672558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c987614765f5f36d3c381cf7bfd340c4?s=128&d=identicon&r=PG&f=1", "display_name": "goldgerm", "link": "https://stackoverflow.com/users/11672558/goldgerm"}, "edited": false, "score": 0, "creation_date": 1561063123, "post_id": 56691611, "comment_id": 99952336, "body": "Very much so. It was driving me nuts! Between the 2 databases it was literally THE. SAME. CODE. and still not working"}], "tags": [], "owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "is_accepted": true, "score": 1, "last_activity_date": 1561053916, "creation_date": 1561053916, "answer_id": 56691611, "question_id": 56675309, "link": "https://stackoverflow.com/questions/56675309/apply-working-shell-code-in-a-different-database/56691611#56691611", "title": "Apply working Shell code in a different database", "body": "<p>I just had the same problem.  In my case, it turned out to be anti-virus that was blocking <code>Shell</code>.  It just so happened that IT had put exceptions in place for my computer for one database but not the other.  See <a href=\"https://stackoverflow.com/a/56691523/5405967\">my question and answer</a> for more detail.</p>\n"}], "owner": {"reputation": 23, "user_id": 11672558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c987614765f5f36d3c381cf7bfd340c4?s=128&d=identicon&r=PG&f=1", "display_name": "goldgerm", "link": "https://stackoverflow.com/users/11672558/goldgerm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "accepted_answer_id": 56691611, "answer_count": 4, "score": 2, "last_activity_date": 1607870779, "creation_date": 1560975736, "last_edit_date": 1607870779, "question_id": 56675309, "link": "https://stackoverflow.com/questions/56675309/apply-working-shell-code-in-a-different-database", "title": "Apply working Shell code in a different database", "body": "<p>I have used the &quot;Shell&quot; function, in other Access databases, to open folders.<br />\nWith the same code structure I get the</p>\n<blockquote>\n<p>5 error code of &quot;Invalid procedure call or argument&quot;</p>\n</blockquote>\n<p>Using shell function as follows:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim FreightFile_Path As String\n    FreightFile_Path = &quot;S:\\Supply Chain\\Freight&quot;\n    Shell &quot;explorer.exe&quot; &amp; &quot; &quot; &amp; FreightFile_Path, vbNormalFocus\n</code></pre>\n<p>I tried the double quotes and Chr(34)'s around them.<br />\nI copied the code from one database (that it worked in) to another and it error-ed.</p>\n<p>Am I missing something I need to activate in MS Access? I checked the references in VBA and made sure they match.</p>\n<p>Things I tried:</p>\n<pre><code>Call Shell(&quot;explorer.exe&quot; &amp; &quot; &quot; &amp; Chr(34) &amp; &quot;S:\\Shared&quot; &amp; Chr(34), \nvbNormalFocus)\n</code></pre>\n\n<pre><code>Shell &quot;explorer.exe &quot; &amp; Chr(34) &amp; FreightFile_Path &amp; Chr(34), vbNormalFocus\n</code></pre>\n\n<pre><code>Shell &quot;explorer.exe&quot; &amp; &quot; &quot; &amp; FreightFile_Path, vbNormalFocus\n</code></pre>\n\n<pre><code>Dim retVal\nretVal = Shell(&quot;explorer.exe&quot; &amp; &quot; &quot; &amp; FreightFile_Path, vbNormalNoFocus)\n</code></pre>\n\n<pre><code>Dim i As String\ni = &quot;explorer.exe&quot; &amp; &quot; &quot; &amp; FreightFile_Path\nShell i, vbNormalFocus\n</code></pre>\n\n<pre><code>FreightFile_Path = &quot;S:\\Supply Chain\\Freight&quot;\nShell &quot;explorer.exe &quot; &amp; FreightFile_Path, vbNormalFocus\n</code></pre>\n\n<p>Restarted the application, restarted the computer.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "edited": false, "score": 0, "creation_date": 1560976786, "post_id": 56675474, "comment_id": 99918329, "body": "Making progress. Once the file is selected, I get an error popup, but the error message is blank. I will post the error message. @Sam"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "edited": false, "score": 0, "creation_date": 1560979947, "post_id": 56675474, "comment_id": 99919447, "body": "Remove the entire  <code>With</code> block temporarily and hardcode <code>StrFlNm</code>. That will help you find out where the problem lies"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 1, "creation_date": 1560990401, "post_id": 56675474, "comment_id": 99921759, "body": "For some fully-fledged code, see: <a href=\"http://www.msofficeforums.com/word-vba/19914-how-transferring-word-data-excel-sheet.html#post59665\" rel=\"nofollow noreferrer\">msofficeforums.com/word-vba/&hellip;</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "edited": false, "score": 0, "creation_date": 1561028626, "post_id": 56675474, "comment_id": 99934758, "body": "Sam, I don&#39;t see anywhere in the code where you instantiate the Word application. I expect that&#39;s why @LOZ is getting an error. The code in the question is running in Excel, so there&#39;s no Word application to open a Word document..."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1561029801, "post_id": 56675474, "comment_id": 99935314, "body": "@CindyMeister - I tried just now. It works without explicit instantiation."}, {"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1561726664, "post_id": 56675474, "comment_id": 100168711, "body": "@macropod Hi Macropad, I used the code you had provided and it is working well, just need a few adjustments. For example, in each of the questions there are two checkboxes (Labeled as Yes or no). Regardless of which checkbox is clicked, in excel it creates two columns for each checkbox (Each column will represent True or False depending which one is checked). I want one single column showing only the checkbox that was selected."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1560976523, "creation_date": 1560976523, "answer_id": 56675474, "question_id": 56675192, "link": "https://stackoverflow.com/questions/56675192/extract-data-controls-from-word-to-excel/56675474#56675474", "title": "Extract Data/controls from Word to Excel", "body": "<p>The first half of your code does nothing more than give you a file name. At that moment, Excel knows nothing about the content of the document.<br>\nHere, you will need to open the document, and for that you need a reference to Word's object model. \nIn Tools - References, select <em>Microsoft Word nn Object Library</em>.<br>\nNow, Excel can work with Word documents.</p>\n\n<p>Do something like this:  </p>\n\n<pre><code>Sub Macro1()\n    Dim lRow As Long, i As Long, j As Long, iCtr As Long, cBox As ContentControl, StrFlNm As String\n\n    With Application.FileDialog(FileDialogType:=msoFileDialogFilePicker)\n        SendKeys \"%n *.doc ~\"\n        If .Show = True Then\n            StrFlNm = .SelectedItems(1)\n        Else\n            Exit Sub\n        End If\n    End With\n\n    Application.Volatile\n\n    Dim Doc As Word.Document\n    Set Doc = Word.Documents.Open(StrFlNm)\n    Debug.Print Doc.Range.ContentControls.Count\n\n    For Each cBox In Doc.Range.ContentControls\n        If cBox.Checked Then\n            iCtr = iCtr + 1\n        End If\n    Next cBox\n    CheckedCount = iCtr\n    Doc.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56675474, "answer_count": 1, "score": 0, "last_activity_date": 1560976846, "creation_date": 1560975158, "last_edit_date": 1560976846, "question_id": 56675192, "link": "https://stackoverflow.com/questions/56675192/extract-data-controls-from-word-to-excel", "title": "Extract Data/controls from Word to Excel", "body": "<p>Currently I have a word document that is a questionnaire.</p>\n\n<p>Format (Total of 30 questions): </p>\n\n<p>Name:</p>\n\n<pre><code>1. Question\nYES checkbox\nNO checkbox\nComments\n\n2. Question\nYES checkbox\nNO checkbox\nComments\n</code></pre>\n\n<p>The check boxes and comments are controls.</p>\n\n<p>What I am trying to do is extract the checkbox and comment data into excel. For example,</p>\n\n<pre><code>1. Do you spend time under the sun?\nYES checkbox is selected\nComments: I spend 2 days out of the week in the sun.\n</code></pre>\n\n<p>What I want it to display in excel would be.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lwbyQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lwbyQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Every time the macro is run, it should add the new information below an existing record (row).</p>\n\n<p>I usually use Word and extract data from excel into word, but I have never tried this one.</p>\n\n<p>This is what I came up with so far:</p>\n\n<pre><code>Sub Macro1()\n    Application.ScreenUpdating = False\n    Dim lRow As Long, i As Long, j As Long, iCtr As Long, cBox As CheckBox, StrFlNm As String\n    With Application.FileDialog(FileDialogType:=msoFileDialogFilePicker)\n        SendKeys \"%n *.doc ~\"\n        If .Show = True Then\n            StrFlNm = .SelectedItems(1)\n        Else\n            Exit Sub\n        End If\n    End With\n    Application.Volatile\n\n    For Each cBox In ActiveSheet.CheckBoxes\n        If cBox.Value = 1 Then\n            iCtr = iCtr + 1\n        End If\n    Next cBox\n    CheckedCount = iCtr\nEnd Sub\n</code></pre>\n\n<p>It goes as far as selecting the file, but nothing happens. If i can identify how to apply it to one checkbox, I should be able to figure out how to do the rest. I will be updating the code as we go on, I have changed it numerous times.</p>\n\n<p>Activated Microsoft Object and ran the new code. Once the file is selected, I am prompted with this message.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7xkHH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7xkHH.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1560974375, "post_id": 56674993, "comment_id": 99917341, "body": "The exact error number, as well as the line that throws the error, would be helpful to debug this."}, {"owner": {"reputation": 113, "user_id": 9388881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65721017825b5307e6c843a814d06a10?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/9388881/rob"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560974659, "post_id": 56674993, "comment_id": 99917461, "body": "The line that throws the error is <code>.chartTitle.Text = chartTitle</code> in the createCharts function"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560974761, "post_id": 56674993, "comment_id": 99917502, "body": "And what&#39;s the specific value in the array when adding the title fails?"}], "owner": {"reputation": 113, "user_id": 9388881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65721017825b5307e6c843a814d06a10?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/9388881/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560974206, "creation_date": 1560974206, "question_id": 56674993, "link": "https://stackoverflow.com/questions/56674993/copied-workbook-with-macro-to-another-computer-and-does-not-work-on-recieving-co", "title": "Copied workbook with macro to another computer and does not work on recieving computer", "body": "<p>As the question say I made a simple macro that takes a couple sheets of data and turns it into charts. The marco works perfectly on my laptop however, when I email my boss the workbook containing the macro it does not work. If i remember correctly it threw error 42 or something. </p>\n\n<p>The line in my code it highlighted was the line that set the title of the graph. I feed a function that creates my graphs titles from an array that gets looped through via For loop. Once i changed it to a different text value and took out the array it worked.</p>\n\n<p>Button that controls macro</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim selectedWorksheet As Worksheet\nDim numItems As Integer\nDim numOfIdentifiers As Integer\nDim identArray() As String\nDim itemsFoundL() As String\nDim itemsSoldL() As Integer\nDim identifiers As Range\nDim ident As Range\nDim upperBound As String\nDim lowerBound As String\nDim foodLBound As String\nDim foodUBound As String\nDim nonFoodLBound As String\nDim nonFoodUBound As String\nDim foodNameColumn As String\nDim foodSoldColumn As String\nDim nonFoodNameColumn As String\nDim nonFoodSoldColumn As String\n\nDim sheetName As Range\nDim i As Integer\n\nupperBound = Range(\"J1\").Value\nlowerBound = Range(\"I1\").Value\n\nfoodLBound = Range(\"I3\").Value\nfoodUBound = Range(\"J3\").Value\n\nnonFoodLBound = Range(\"I4\").Value\nnonFoodUBound = Range(\"J4\").Value\n\nfoodNameColumn = Range(\"I5\").Value\nfoodSoldColumn = Range(\"I6\").Value\n\nnonFoodNameColumn = Range(\"I8\").Value\nnonFoodSoldColumn = Range(\"I9\").Value\n\nSet sheetName = Range(\"I2\")\nSet identifiers = Range(lowerBound, upperBound)\nSet selectedWorksheet = ActiveWorkbook.Worksheets(CStr(sheetName))\n\n\nnumOfIdentifiers = identifiers.Count\nReDim identArray(0 To numOfIdentifiers - 1)\n\n\ni = 0\nFor Each ident In identifiers\n\nidentArray(i) = ident.Value\ni = i + 1\nNext ident\n\nFor i = 0 To numOfIdentifiers - 1\n\nnumItems = CInt(numberOfItems(selectedWorksheet, identArray(i),  foodLBound, foodUBound))\nIf numItems = 0 Then\n\nnumItems = CInt(numberOfItems(selectedWorksheet, identArray(i),    nonFoodLBound, nonFoodUBound))\nnumItems = numItems - 1\nReDim itemsFoundL(0 To numItems)\nReDim itemsSoldL(0 To numItems)\n\nitemsFoundL = itemsFound(selectedWorksheet, identArray(i), nonFoodLBound,    nonFoodUBound, numItems, nonFoodNameColumn)\nitemsSoldL = itemsSoldFound(selectedWorksheet, identArray(i), nonFoodLBound, nonFoodUBound, numItems, nonFoodSoldColumn)\n\n\nElse\n\nnumItems = numItems - 1\nReDim itemsFoundL(0 To numItems)\nReDim itemsSoldL(0 To numItems)\n\n itemsFoundL = itemsFound(selectedWorksheet, identArray(i), foodLBound,    foodUBound, numItems, foodNameColumn)\n itemsSoldL = itemsSoldFound(selectedWorksheet, identArray(i), foodLBound, foodUBound, numItems, foodSoldColumn)\n\n End If\n\n Call CreateCharts(itemsFoundL, itemsSoldL, identArray(i), numItems)\n\nNext i\n\nEnd Sub \n</code></pre>\n\n<p>Chart creating helper function</p>\n\n<pre><code> Function CreateCharts(items As Variant, itemsSold As Variant, chartTitle As String, itemCount As Integer)\n\n If itemCount &gt; 0 Then\n\nCharts.Add\nActiveChart.ChartType = xlBarStacked\nActiveChart.SeriesCollection.NewSeries\nActiveChart.SeriesCollection(1).XValues = items\nActiveChart.SeriesCollection(1).Values = itemsSold\nActiveChart.ChartArea.Format.TextFrame2.TextRange.Font.Name = \"Arial\"\nWith ActiveChart\n\n.HasLegend = False\n.HasTitle = True\n.chartTitle.Text = chartTitle\n\nEnd With\n\n\nElse\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "web-scraping", "queryselector"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 2, "creation_date": 1560975320, "post_id": 56674921, "comment_id": 99917736, "body": "Why don&#39;t just use a link for <a href=\"https://clinicaltrials.gov/ct2/results/download_fields?down_count=10000&amp;down_flds=all&amp;down_fmt=xml&amp;term=Medpace\" rel=\"nofollow noreferrer\">xml</a> or <a href=\"https://clinicaltrials.gov/ct2/results/download_fields?down_count=10000&amp;down_flds=all&amp;down_fmt=csv&amp;term=Medpace\" rel=\"nofollow noreferrer\">csv</a> data download?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1560976499, "creation_date": 1560976499, "answer_id": 56675468, "question_id": 56674921, "link": "https://stackoverflow.com/questions/56674921/how-to-click-a-button-in-vba/56675468#56675468", "title": "How to click a &lt;button&gt; in VBA", "body": "<p>Have your additional desired options in an array then loop all buttons checking if the innerText for button is in the array. If it is then set the class name so the button is active</p>\n\n<pre><code>Option Explicit\nPublic Sub MakeSelections()\n    Dim ie As Object, options()\n    options = Array(\"Study Type\", \"Phase\", \"Sponsor/Collaborators\", \"Number Enrolled\", \"NCT Number\", \"Study Start\", \"Study Completion\", \"Last Update Posted\")\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = True\n        .Navigate2 \"https://clinicaltrials.gov/ct2/results?cond=&amp;term=Medpace&amp;cntry=&amp;state=&amp;city=&amp;dist=\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n           .querySelector(\".buttons-collection\").Click 'show/hide\n           Dim buttons As Object, i As Long\n           Set buttons = .querySelectorAll(\".two-column button\")\n           For i = 0 To buttons.Length - 1\n               If Not IsError(Application.Match(Trim$(buttons.item(i).innerText), options, 0)) Then\n                   buttons.item(i).className = \"dt-button buttons-columnVisibility active\"\n               End If\n           Next\n        End With\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11671959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc6f2ff1cd4b7afb4578d6f5e6be181?s=128&d=identicon&r=PG&f=1", "display_name": "ab1225", "link": "https://stackoverflow.com/users/11671959/ab1225"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 56675468, "answer_count": 1, "score": 1, "last_activity_date": 1571862101, "creation_date": 1560973862, "last_edit_date": 1571862101, "question_id": 56674921, "link": "https://stackoverflow.com/questions/56674921/how-to-click-a-button-in-vba", "title": "How to click a &lt;button&gt; in VBA", "body": "<p>I need help clicking a button and then selecting options on a webpage using VBA.</p>\n\n<p>Webpage Link: <a href=\"https://clinicaltrials.gov/ct2/results?cond=&amp;term=Medpace&amp;cntry=&amp;state=&amp;city=&amp;dist=\" rel=\"nofollow noreferrer\">https://clinicaltrials.gov/ct2/results?cond=&amp;term=Medpace&amp;cntry=&amp;state=&amp;city=&amp;dist=</a></p>\n\n<p>I need to click \"Show/Hide Columns\" then select \"Study Type\", \"Phase\", \"Sponsor/Collaborators\", \"Number Enrolled\", \"NCT Number\", \"Study Start\", \"Study Completion\" and \"Last Update Posted\".</p>\n\n<p>The class for the \"Show/Hide Columns\" button: <code>.getElementsByClassName(\"dt-button buttons-collection buttons-colvis\").click</code></p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    With IE\n        .Visible = True\n        .Navigate (\"https://clinicaltrials.gov/ct2/results?cond=&amp;term=Medpace&amp;cntry=&amp;state=&amp;city=&amp;dist=\")\n        While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n\n        With IE.document\n            IE.Refresh\n            .getElementsByClassName(\"dt-button buttons-collection buttons-colvis\").click\n            .querySelector(\"#save-list-link\").click\n            .querySelector(\"#number-of-studies option:last-child\").Selected = True\n            ' .querySelector(\"#which-format option:fourth-child\").Selected = True\n            ' .querySelector(\"#which-format\").selectedIndex = 3\n            ' .querySelector (\"#number-of-studies\").selectedIndex = 1\n            ' .querySelector(\"[value=csv]\").click\n            .querySelector(\"#submit-download-list\").click\n\n        ' Set div = IE.document.getElementById(\"save-list-link\")\n        ' div.FireEvent \"onclick\"\n        End With\n        Application.Wait Now + TimeSerial(0, 0, 10)\n        Application.SendKeys \"%+s\", True\n        Application.Wait Now + TimeSerial(0, 0, 10)\n        .Quit\n\n    ' For Each elt In IE.document.getElementById(\"number-of-studies\")\n        ' If InStr(elt.innerText, \"Found\") &gt; 0 Then elt.click: Exit For\n    ' Next elt\n\n    ' Set div4 = IE.document.getElementById(\"submit-download-list\")\n    ' div4.click\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560971649, "post_id": 56674423, "comment_id": 99916218, "body": "Take a look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.open\" rel=\"nofollow noreferrer\">Workbook Open</a> event maybe. That should be what you&#39;re looking for."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11529670, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156195449196027/picture?type=large", "display_name": "Bakagami", "link": "https://stackoverflow.com/users/11529670/bakagami"}, "is_accepted": false, "score": 0, "last_activity_date": 1560979420, "creation_date": 1560979420, "answer_id": 56676048, "question_id": 56674423, "link": "https://stackoverflow.com/questions/56674423/send-email-from-todays-date/56676048#56676048", "title": "Send email from today&#39;s date", "body": "<p>It appears that you have not dimmed OutApp as an object.</p>\n\n<p>Once that is done add a loop examining the expiration dates and adding the specific cells to a dynamic array, re-dimming the array with each iteration. Finally each license on the array will need to be added to a text string that can then be added to the body of the email you are creating above....</p>\n\n<p>Once you have all the above working as you would like, you will want to tie the whole operation to the Workbook Open event.</p>\n"}, {"tags": [], "owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "is_accepted": false, "score": 0, "last_activity_date": 1561003191, "creation_date": 1561003191, "answer_id": 56678797, "question_id": 56674423, "link": "https://stackoverflow.com/questions/56674423/send-email-from-todays-date/56678797#56678797", "title": "Send email from today&#39;s date", "body": "<p>In the VBE, open This Workbook...</p>\n\n<p>Then use the drop-down menus to select the Workbook and Open Event and add your code and save.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ddLJZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ddLJZ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11672326, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bJcqS_fIJxA/AAAAAAAAAAI/AAAAAAAAAaA/8612P3AERKE/photo.jpg?sz=128", "display_name": "CJ E", "link": "https://stackoverflow.com/users/11672326/cj-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561003191, "creation_date": 1560971603, "last_edit_date": 1560973346, "question_id": 56674423, "link": "https://stackoverflow.com/questions/56674423/send-email-from-todays-date", "title": "Send email from today&#39;s date", "body": "<p>I have an excel spreadsheet for permits, and one column is their expiration dates. My boss wants to be emailed about the permits that expire in the next 2 weeks. How can I use visual basic to tell Outlook to send an email each time he opens the excel spreadsheet? </p>\n\n<p>This is for a spreadsheet I set up, permit names are in column A, dates are in column J. </p>\n\n<pre><code>Sub Mail_small_Text_Outlook()\nDim OutMail As Object\nDim strbody As String\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nstrbody = \"Hi there\" &amp; vbNewLine &amp; vbNewLine &amp; _\n          \"Cell A1 is changed\" &amp; vbNewLine &amp; _\n          \"This is line 2\" &amp; vbNewLine &amp; _\n          \"This is line 3\" &amp; vbNewLine &amp; _\n          \"This is line 4\"\n\nOn Error Resume Next\nWith OutMail\n    .To = \"ron@debruin.nl\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"This is the Subject line\"\n    .Body = strbody\n    'You can add a file like this\n    '.Attachments.Add (\"C:\\test.txt\")\n    .Display   'or use .Send\nEnd With\nOn Error GoTo 0\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>I may have to use a button to run the program, but I'm not sure if it is possible to schedule emails.</p>\n"}, {"tags": ["excel", "vba", "bloomberg"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11465057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60749ceff07574c2c2a0953e7a309f6b?s=128&d=identicon&r=PG&f=1", "display_name": "chutch", "link": "https://stackoverflow.com/users/11465057/chutch"}, "is_accepted": false, "score": 0, "last_activity_date": 1561121523, "creation_date": 1561121523, "answer_id": 56703838, "question_id": 56674406, "link": "https://stackoverflow.com/questions/56674406/distribution-issues-on-bloomberg-enabled-spreadsheet/56703838#56703838", "title": "Distribution issues on Bloomberg-enabled spreadsheet", "body": "<p>Here was my solution for my own problem:</p>\n\n<p>I had two functions with inputs that used library-specific types. I converted those to generic objects (using late binding on the session and refdataservice was not enough). Then, I unselected the bbcom library, and added a dynamic reference to the dll file in Workbook_Open(). Even if the load fails, the error is able to be caught, whereas before excel would have to be killed. This is still a problem if the user tries to use part of the workbook that uses the BB-related code, but this can be mitigated in a few different ways.</p>\n"}], "owner": {"reputation": 1, "user_id": 11465057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60749ceff07574c2c2a0953e7a309f6b?s=128&d=identicon&r=PG&f=1", "display_name": "chutch", "link": "https://stackoverflow.com/users/11465057/chutch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561121523, "creation_date": 1560971534, "last_edit_date": 1560971888, "question_id": 56674406, "link": "https://stackoverflow.com/questions/56674406/distribution-issues-on-bloomberg-enabled-spreadsheet", "title": "Distribution issues on Bloomberg-enabled spreadsheet", "body": "<p>I've created a spreadsheet which <em>optionally</em> uses Bloomberg data pulled using the API COM 3.5 Type Library. I want to be able to distribute that spreadsheet to non-Bloomberg users, but they can't run it since they don't have the right libraries.</p>\n\n<p>All blpapi-related code besides what's in the Class Module is behind if statements that should not be entered by the non-BB users. In the class module, I lazily define the session and Service so that the blpapi-specific definitions are delayed until the class initializes (see below):</p>\n\n<pre><code>Option Explicit\nPrivate session As Object\nDim refdataservice As Object\n\nPrivate Sub Class_Initialize()\n\n   ' First create session.\n   Set session = New blpapicomLib2.session\n   session.QueueEvents = True\n   session.Start\n\n   ' Then open service.\n   ' A service provides the schemas needed to make requests.\n   session.OpenService \"//blp/refdata\"\n   Set refdataservice = session.GetService(\"//blp/refdata\")\n\nEnd Sub\n</code></pre>\n\n<p>In short - the code which appears to be causing the issues never runs. My (very limited) understanding of VBA is mostly functional, so I'm probably missing something obvious. Is this a compilation-related error? Is there a way for me to precompile the VBA so users don't experience this issue? Maybe some type of error handling method so the workbook doesn't hang?</p>\n"}, {"tags": ["excel", "vba", "webbrowser-control", "userform"], "owner": {"reputation": 21, "user_id": 5994222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c55c50936b5a17bef0385e4b69b01927?s=128&d=identicon&r=PG", "display_name": "KingYak", "link": "https://stackoverflow.com/users/5994222/kingyak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1563904533, "creation_date": 1560971238, "last_edit_date": 1563904533, "question_id": 56674345, "link": "https://stackoverflow.com/questions/56674345/excel-vba-userform-containing-webbrowsers-on-initialisation-closes-excel-without", "title": "Excel vba userform containing WebBrowsers on initialisation closes excel without error message, and recovers the file. Why?", "body": "<p>This works on my normal laptop 16Gb ram and excel office 365, but when I am using my tablet pc with 4Gb ram and excel office 365. When I initialise a particular userform that contains two webbrowsers, it causes excel to crash, I do not receive any error messages, it looks like its thinking about it and then excel just closes and re-opens with a recovered version. All my other code works fine.</p>\n\n<p>This works ok on my laptop with 16Gb ram the version of windows and excel are the same, the only difference is the 4Gb. I was expecting it to only take longer with the difference in ram, is it a memory issue?</p>\n\n<p>When I blanked out the following lines the userform loads fine (just obviously without the webpages being navigated to)</p>\n\n<pre><code>Me.WebBrowser1.Silent = True\n\nMe.WebBrowser1.Navigate \"https://www.nutracheck.co.uk/CaloriesIn/\"\n\nMe.WebBrowser2.Navigate \"about:blank\"\n\nMe.WebBrowser2.Document.Write \"&lt;img style=\"\"width:100%;\"\"\n\nsrc=\"\"https://media.giphy.com/media/MIY4jpusckRmU/giphy.gif\"\"&gt;\"\n\nWebBrowser2.Document.Body.Style.Border = \"none\"\n\nWebBrowser2.Document.Body.Scroll = \"no\"*\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nWith Application\n' here I have code to format and position labels and command buttons on \n'userform according to screen size\nEnd With\n\n\n'next line suppresses script errors in the web browser window\nMe.WebBrowser1.Silent = True\n\nMe.WebBrowser1.Navigate \"https://www.nutracheck.co.uk/CaloriesIn/\"\n\nMe.WebBrowser2.Navigate \"about:blank\"\nMe.WebBrowser2.Document.Write \"&lt;img style=\"\"width:100%;\"\"\nsrc=\"\"https://media.giphy.com/media/MIY4jpusckRmU/giphy.gif\"\"&gt;\"\n\nWith Application\nWebBrowser1.Top = .Top + 40\nWebBrowser1.Left = AddARecipe.Left + (AddARecipe.Width * 0.48)\nWebBrowser1.Height = .Height - 40\nWebBrowser1.Width = AddARecipe.Width * 0.5\n\nEnd With\n\nWith Application\nWebBrowser2.Top = .Top + 60\nWebBrowser2.Left = 0 '10\nWebBrowser2.Height = (AddARecipe.Width * 0.243) \nWebBrowser2.Width = (AddARecipe.Width * 0.45) \nWebBrowser2.Visible = False\nWebBrowser2.Document.Body.Style.Border = \"none\"\nWebBrowser2.Document.Body.Scroll = \"no\"\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>When the code is run unaltered, and I step through the code no error messages come up, its just at \"end sub\" excel closes.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560974654, "post_id": 56674333, "comment_id": 99917458, "body": "What is <code>q</code> for here?  What is <code>ac</code> ?  please add <code>Option explicit</code> at the top of your code module, fix any errors, then re-post your code."}, {"owner": {"reputation": 3, "user_id": 11473187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df5aa1b63c57333b06d54ea8c668a984?s=128&d=identicon&r=PG&f=1", "display_name": "Adge", "link": "https://stackoverflow.com/users/11473187/adge"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560975248, "post_id": 56674333, "comment_id": 99917700, "body": "@TimWilliams q is the variable used to search for the project ID in &quot;Open Projects No SLA - Log.&quot; AC is supposed to be AB (fixed) which is referring to &quot;Project Log&quot; Code should be good now."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1560976171, "creation_date": 1560976171, "answer_id": 56675412, "question_id": 56674333, "link": "https://stackoverflow.com/questions/56674333/moving-records-between-worksheets-when-input-form-value-updates/56675412#56675412", "title": "Moving records between worksheets when input form value updates", "body": "<p>Try something like this:</p>\n\n<pre><code>Option explicit    \n\nPrivate Sub CommandButton1_Click()\n\n 'Searches for record, and cuts/ pastes records into Project Log \n '     when Project Status is set to Closed\n\n    Dim ab As Worksheet, q As variant, m As Long\n    Dim aa As Worksheet\n\n    Set ab = ThisWorkbook.Sheets(\"Open Projects No SLA - Log\")\n    Set aa = ThisWorkbook.Sheets(\"Project Log\")\n\n    If Me.proj_stat_combo.Value = \"OPEN PROJECTS (No Current Open SLA)\" Then\n\n       q = Application.Match(VBA.CLng(Me.srnew_combo.Value), ab.Range(\"C:C\"), 0)\n       'check we got a match\n       If not iserror(q) then\n           'adjust next line to fit your # of columns and exact paste destination...\n           ab.Cells(q,\"A\").Resize(1,30).cut aa.Cells(rows.count,\"C\").End(xlUp).Offset(1,0)\n       Else\n           Msgbox \"No match for project id!\"\n       End if\n\n\n  End If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11473187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df5aa1b63c57333b06d54ea8c668a984?s=128&d=identicon&r=PG&f=1", "display_name": "Adge", "link": "https://stackoverflow.com/users/11473187/adge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563964749, "creation_date": 1560971198, "last_edit_date": 1563964749, "question_id": 56674333, "link": "https://stackoverflow.com/questions/56674333/moving-records-between-worksheets-when-input-form-value-updates", "title": "Moving records between worksheets when input form value updates", "body": "<p>I am unable to figure out how to cut and paste records between two worksheets when a value from the input form is changed from \"Open Project\" to \"Closed Project.\" </p>\n\n<p>This is for a project management database I am creating to to cut down the time spent adding new data. So far this is my only time working with VBA.  </p>\n\n<pre><code>Option explicit    \nPrivate Sub CommandButton1_Click()\n\n 'Searches for record, and cuts/ pastes records into Project Log when Project Status is set to Closed\n\nDim ab As Worksheet\nDim aa As Worksheet\n  Set ab = ThisWorkbook.Sheets(\"Open Projects No SLA - Log\")\n  Set aa = ThisWorkbook.Sheets(\"Project Log\")\n  Dim q As Long\n  Dim m As Long\n\n    If Me.proj_stat_combo.Value = \"OPEN PROJECTS (No Current Open SLA)\" Then\n       q = Application.Match(VBA.CLng(Me.srnew_combo.Value), ab.Range(\"C:C\"), 0)\n       m = ab.Range(\"C\" &amp; Application.Rows.Count).End(xlUp).Row        \n\n    Worksheets(\"Open Projects No SLA - Log\").Range(1).Cut Worksheets(\"Project Log\").Range(m + 1)\n\n  End If\n</code></pre>\n\n<p>Hoping to get the records from \"Open Projects No SLA - Log\" to be cut out of the worksheet and pasted into the \"Project Log\" worksheet\" when the input form data for Project Status has changed from \"OPEN PROJECTS (No Current Open SLA)\" to closed.</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560970144, "post_id": 56674061, "comment_id": 99915546, "body": "What is <code>Target.Value</code> in this case? Also it&#39;s not robust to assume that you&#39;ll only ever select a string, I&#39;d declare that <code>As Variant</code> and then test its type."}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1560970207, "post_id": 56674061, "comment_id": 99915578, "body": "are you changing more than one cell at a time? If so, <code>Target</code> will be a range containing more than one cell, and you won&#39;t be able to get a <code>value</code> from it"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1560970271, "post_id": 56674061, "comment_id": 99915602, "body": "@GregViers well you will be able to get a <code>value</code>, but it will <i>not</i> be a string, but an array."}, {"owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "edited": false, "score": 0, "creation_date": 1560970500, "post_id": 56674061, "comment_id": 99915697, "body": "No, it&#39;s a single cell. I changed the string to a variant and added a Msgbox and it shows the correct, old, value. But when in the rest of the code I go to paste it, it changes to a different value.  When I select another value in the drop-down, the run-time error pops back up"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560970765, "post_id": 56674061, "comment_id": 99915818, "body": "Maybe share the rest of your code, what are you actually doing with <code>oldValue</code>?"}, {"owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "edited": false, "score": 0, "creation_date": 1560970917, "post_id": 56674061, "comment_id": 99915884, "body": "I updated the question with the entire code, maybe I&#39;m overlooking something silly here."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560971120, "post_id": 56674061, "comment_id": 99915963, "body": "You&#39;re <code>Select</code>ing within the <code>Worksheet_Change</code> event. That fires the selection change event again. You need to disable events within the worksheet_change. Or even better, don&#39;t <code>Select</code>."}, {"owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "edited": false, "score": 0, "creation_date": 1560971214, "post_id": 56674061, "comment_id": 99916000, "body": "Makes sense... what was that syntax again? Application.EnableEvents = False?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1560971241, "post_id": 56674061, "comment_id": 99916015, "body": "<code>Application.EnableEvents = False</code>, and then <code>= True</code> at the end. But you don&#39;t need to <code>Select</code> at all: <code>Range(&quot;C&quot; &amp; cRow &amp; &quot;:O&quot; &amp; cRow).Copy</code>."}, {"owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "edited": false, "score": 0, "creation_date": 1560971408, "post_id": 56674061, "comment_id": 99916094, "body": "Thank you BigBen. I tried that and it&#39;s working like a charm now... Thank you very much!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560975515, "post_id": 56674061, "comment_id": 99917822, "body": "@BigBen you should post an answer =)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560978165, "post_id": 56674061, "comment_id": 99918824, "body": "@MathieuGuindon added..."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560970632, "post_id": 56674190, "comment_id": 99915752, "body": "This will still throw a type mismatch error if <code>Target</code> does not contain a string or something that can be coerced to a string. E.g. if the cell contains an error."}, {"owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "edited": false, "score": 0, "creation_date": 1560970719, "post_id": 56674190, "comment_id": 99915796, "body": "That gives me the 1st row/ column value in the paste... However clicking the cell still does show the old value. So not sure why it&#39;s not saving correctly."}, {"owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "edited": false, "score": 0, "creation_date": 1560970912, "post_id": 56674190, "comment_id": 99915881, "body": "I updated the question with the entire code, maybe I&#39;m overlooking something silly here."}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1560970571, "creation_date": 1560970571, "answer_id": 56674190, "question_id": 56674061, "link": "https://stackoverflow.com/questions/56674061/excel-vba-error-while-capturing-old-value/56674190#56674190", "title": "Excel vba error while capturing old value", "body": "<p>Try identifying a single cell withing <code>Target</code>:</p>\n\n<pre><code>oldValue = Target(1,1).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1560978723, "last_edit_date": 1560978723, "creation_date": 1560976686, "answer_id": 56675504, "question_id": 56674061, "link": "https://stackoverflow.com/questions/56674061/excel-vba-error-while-capturing-old-value/56675504#56675504", "title": "Excel vba error while capturing old value", "body": "<p><strong>The main issue:</strong></p>\n\n<p>You're <code>Select</code>ing within the <code>Worksheet_Change</code> event. </p>\n\n<pre><code>Range(\"C\" &amp; cRow &amp; \":O\" &amp; cRow).Select\nSelection.Copy\n</code></pre>\n\n<p>That fires the <code>Selection_Change</code> event again, overwriting <code>oldValue</code>.</p>\n\n<p>No need to <code>Select</code> here. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>.</p>\n\n<pre><code>Range(\"C\" &amp; cRow &amp; \":O\" &amp; cRow).Copy\n</code></pre>\n\n<hr>\n\n<p><strong>The secondary (yet still very important issue):</strong></p>\n\n<p>In your original version of the selection change:</p>\n\n<pre><code>Dim oldValue As String\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    oldValue = Target.Value\nEnd Sub\n</code></pre>\n\n<p>This will throw a type mismatch error if <code>Target</code> doesn't contain a <code>String</code> or something that can be coerced to a <code>String</code>.</p>\n\n<p>In your instance, that was because <code>Target</code> actually was multiple cells: <code>Range(\"C\" &amp; cRow &amp; \":O\" &amp; cRow)</code>.\nBut your code would also throw an error if you selected a cell with an error value (<code>#N/A</code>, <code>#DIV/0</code>, etc.).</p>\n\n<hr>\n\n<p><strong>The fix:</strong></p>\n\n<p>First of all, avoid using <code>Select</code>, as already noted.</p>\n\n<p>If for some (rare) reason you absolutely need to <code>Select</code>, then toggle events off and on:</p>\n\n<pre><code>Private Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n    ... do your stuff\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Lastly, within the selection change, instead of assuming that you'll only select a string, or only select one cell, add some validation.</p>\n\n<pre><code>Dim oldValue As Variant\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.CountLarge &lt;&gt; 1 Then Exit Sub ' ignore a multi-cell selection\n    If IsError(Target.Value) Then Exit Sub ' ignore selection of errors\n\n    oldValue = Target.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1560978723, "creation_date": 1560970022, "last_edit_date": 1560970874, "question_id": 56674061, "link": "https://stackoverflow.com/questions/56674061/excel-vba-error-while-capturing-old-value", "title": "Excel vba error while capturing old value", "body": "<p>I am getting an error when I am trying to capture an old value from a cell: \nrun-time error '13' Type mismatch. </p>\n\n<p>This is the code I am using:</p>\n\n<pre><code>Dim oldValue As Variant\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\noldValue = Target(1, 1).Value\nMsgBox oldValue\n\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n'check if one of the target columns is changed\nIf Target.Cells.Column = 6 Or Target.Cells.Column = 9 Or Target.Cells.Column = 10 Or Target.Cells.Column = 11 Then\n\n'Set variables\n    Dim LogActivity As String\n    Dim cRow As Integer\n    Dim pRowCount As Integer\n\n    Dim wsPBS As Worksheet\n    Dim wsHistoric As Worksheet\n\n    Set wsPBS = Sheets(\"PBS\")\n    Set wsHistoric = Sheets(\"Historic\")\n    cRow = Target.Cells.Row\n    pRowCount = wsHistoric.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n'Check for blanks on PBS sheet and exit if entry is not complete\n    Dim BlankCount As Integer\n    BlankCount = 0\n\n    If wsPBS.Range(\"D\" &amp; cRow).Value = \"\" Then BlankCount = BlankCount + 1\n    If wsPBS.Range(\"E\" &amp; cRow).Value = \"\" Then BlankCount = BlankCount + 1\n    If wsPBS.Range(\"F\" &amp; cRow).Value = \"\" Then BlankCount = BlankCount + 1\n    If wsPBS.Range(\"H\" &amp; cRow).Value = \"\" Then BlankCount = BlankCount + 1\n    If wsPBS.Range(\"I\" &amp; cRow).Value = \"\" Then BlankCount = BlankCount + 1\n    If wsPBS.Range(\"J\" &amp; cRow).Value = \"\" Then BlankCount = BlankCount + 1\n\n    If BlankCount &gt;= 1 Then Exit Sub\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n        If Target.Cells.Column = 6 Then LogActivity = \"Owner change\"\n        If Target.Cells.Column = 9 Then LogActivity = \"Status change\"\n        If Target.Cells.Column = 10 Then LogActivity = \"Priority change\"\n        If Target.Cells.Column = 11 Then LogActivity = \"Completion rate\"\n\n    Range(\"C\" &amp; cRow &amp; \":O\" &amp; cRow).Select\n        Selection.Copy\n\n    wsHistoric.Select\n    wsHistoric.Range(\"F\" &amp; pRowCount).Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n        Application.CutCopyMode = False\n\n    wsHistoric.Range(\"A\" &amp; pRowCount).Value = Date\n    wsHistoric.Range(\"B\" &amp; pRowCount).Value = Time\n    wsHistoric.Range(\"C\" &amp; pRowCount).Value = Application.UserName\n    wsHistoric.Range(\"D\" &amp; pRowCount).Value = LogActivity\n    wsHistoric.Range(\"E\" &amp; pRowCount).Value = oldValue\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The value is supposed to be stored in a global dim called 'oldValue' so I can use it later on in my code. \nThe cell I am clicking does contain a string. </p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560970202, "post_id": 56674055, "comment_id": 99915576, "body": "Where does this input data come from? How can you have a macro but not have any code?"}, {"owner": {"reputation": 33, "user_id": 11318067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e91d45dabd86cf1693f140c9ac373285?s=128&d=identicon&r=PG&f=1", "display_name": "Stomper", "link": "https://stackoverflow.com/users/11318067/stomper"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560972852, "post_id": 56674055, "comment_id": 99916709, "body": "The data is input by the user into a form. I have code for the macro, but no code specifically relating to the issue that I posted about."}, {"owner": {"reputation": 33, "user_id": 11318067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e91d45dabd86cf1693f140c9ac373285?s=128&d=identicon&r=PG&f=1", "display_name": "Stomper", "link": "https://stackoverflow.com/users/11318067/stomper"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560973591, "post_id": 56674055, "comment_id": 99917022, "body": "The macro is about 3100 lines of code so I didn&#39;t want to post it to SO"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560974511, "post_id": 56674055, "comment_id": 99917400, "body": "Can you reduce it or produce instead a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? For example, a form that only has one input field like a text box?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560974898, "post_id": 56674055, "comment_id": 99917551, "body": "Or, can you show the code for the subroutine that launches the UserForm?"}, {"owner": {"reputation": 33, "user_id": 11318067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e91d45dabd86cf1693f140c9ac373285?s=128&d=identicon&r=PG&f=1", "display_name": "Stomper", "link": "https://stackoverflow.com/users/11318067/stomper"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560975658, "post_id": 56674055, "comment_id": 99917877, "body": "The form launches from a button in a word document. The code is simply:  &#39;&#39;&#39; Private Sub CommandButton1_Click()  InputForm.Show  End Sub &#39;&#39;&#39;  Once I hit this, I cannot view a word document until the form is closed. There is another button on the Input form that initiates the generation of the documents once the data has been input. How do I post a form to SO?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560975812, "post_id": 56674055, "comment_id": 99917933, "body": "That&#39;s enough. See my suggestion below :)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11318067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e91d45dabd86cf1693f140c9ac373285?s=128&d=identicon&r=PG&f=1", "display_name": "Stomper", "link": "https://stackoverflow.com/users/11318067/stomper"}, "edited": false, "score": 0, "creation_date": 1561478704, "post_id": 56675312, "comment_id": 100073611, "body": "David, Do you know if there is a way for the user to be able to scroll through the document while the macro is paused? Currently, if the macro is in the middle of executing but I have it paused to look at the document for debugging, I cannot scroll through the document. Being able to view the document while the macro is paused would make debugging easier."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 33, "user_id": 11318067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e91d45dabd86cf1693f140c9ac373285?s=128&d=identicon&r=PG&f=1", "display_name": "Stomper", "link": "https://stackoverflow.com/users/11318067/stomper"}, "edited": false, "score": 0, "creation_date": 1561480776, "post_id": 56675312, "comment_id": 100074614, "body": "Needs more detail and should be a separate question. In brief tests, if I pause/interrupt execution of a normal procedure, I can interact with the document. However, this would not be true with a vbModal displayed form, and there may be other cases. it is too much detail to ask for (and respond to) in comments. best to ask a new/separate question detailing the use-scenario."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1560976423, "last_edit_date": 1560976423, "creation_date": 1560975746, "answer_id": 56675312, "question_id": 56674055, "link": "https://stackoverflow.com/questions/56674055/how-can-you-view-word-documents-while-macro-is-running/56675312#56675312", "title": "How can you view Word documents while macro is running?", "body": "<p>Somewhere, you have a subroutine that does something like this:</p>\n\n<pre><code>Sub foo()\nUserForm1.Show\nEnd Sub\n</code></pre>\n\n<p>You will need to change that to display the form <code>vbModeless</code>, in order to allow the user to interact with the Document. Note that this will allow the user to interact with the Document <em>while the form is displayed</em>.</p>\n\n<pre><code>Sub foo()\nDim uf As New UserForm1\nuf.Show vbModeless\n\nEnd Sub\n</code></pre>\n\n<p>If there is any additional executable code after the <code>uf.Show</code>, it may need to be refactored as well, as it will execute <em>immediately</em> after the form is <code>Show</code>n. </p>\n\n<p>If you don't want the user to be able to interact until <em>after</em> the form does whatever it does, then do <em>not</em> use the <code>vbModeless</code> option, and add a <code>QueryClose</code> event handler to the form. This way we ask the user if they want to review; if they say \"Yes\", then we hide &amp; re-display the form with the <code>vbModeless</code> option. Now, they'll have the form open <em>and</em> the document will be editable.</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\nIf MsgBox(\"Review document?\", vbYesNo) = vbYes Then\n    Cancel = 1\n    Me.Hide\n    Me.Show vbModeless\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Of course, that may not be quite what you want, either. But those finer points can be worked out separately. There's a lot of things I don't know about your use-case, which can almost certainly be accommodated with proper use of the <code>UserForm</code>. Do note that I can't entertain too many tangentially related follow-up questions, but this should be enough to get you started.</p>\n\n<p>I'm not sure it's possible to persist values in the form <em>beyond</em> it's <code>Terminate</code> event which will happen when the user closes the form or if any code invokes the <code>Unload &lt;userform object&gt;</code>. It would certainly be possible to serialize that data into a text file, or persist it somehow within the Document's custom properties/customer data properties, but that should probably be a separate question.</p>\n"}], "owner": {"reputation": 33, "user_id": 11318067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e91d45dabd86cf1693f140c9ac373285?s=128&d=identicon&r=PG&f=1", "display_name": "Stomper", "link": "https://stackoverflow.com/users/11318067/stomper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 56675312, "answer_count": 1, "score": 0, "last_activity_date": 1561003663, "creation_date": 1560970008, "last_edit_date": 1561003663, "question_id": 56674055, "link": "https://stackoverflow.com/questions/56674055/how-can-you-view-word-documents-while-macro-is-running", "title": "How can you view Word documents while macro is running?", "body": "<p>I want the user to be able to review the word document that the macro generates before stopping the macro. This way, they don't have to enter all the data again, since, when the macro stops, all the data is erased. There are a lot of fields that I don't want the user to have to re-enter if something is wrong. </p>\n\n<p>I've tried activating the macro in a couple different ways, from a button on a word document to starting it from VBA Alt+F11, but I get the same result: The user cannot edit or view the word document while the macro is running, even though it isn't doing anything.</p>\n\n<p>'''\nPrivate Sub CommandButton1_Click()</p>\n\n<pre><code>InputForm.Show\n</code></pre>\n\n<p>End Sub\n'''</p>\n\n<p>The user is not able to view the word document until the macro is stopped and all the data that was input is erased. Alternatively, if it is possible to save the data that has been input so that it is kept for next time the program runs, that would work since I have a \"Clear All\" button.</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1560969947, "post_id": 56673930, "comment_id": 99915456, "body": "you are expecting to retrieve entire table?"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1560970105, "post_id": 56673930, "comment_id": 99915524, "body": "what gets returned with <code>doc.body.getElementsByClassName(&quot;normal-table data-table&quot;)(0).innertext</code> ?"}, {"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1560971362, "post_id": 56673930, "comment_id": 99916066, "body": "Are you doing any readystate listening?  Your code seems to work for me, but I do notice that there&#39;s a login pop-up that is loading a clear pane over the document and waiting for a user response.  I had to skip over my state check to read the document.  Maybe your credentials need to be supplied again to keep the pop-up from showing?"}, {"owner": {"reputation": 9, "user_id": 11237850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64402e0366896bc84d0df22b641267?s=128&d=identicon&r=PG&f=1", "display_name": "egreg", "link": "https://stackoverflow.com/users/11237850/egreg"}, "edited": false, "score": 0, "creation_date": 1561050142, "post_id": 56673930, "comment_id": 99946978, "body": "Guys, thanks for your help you have led me to find my problem, I have been a doofus. It is not grabbing the table that is the problem it is the pressing of the button just to the top left of the table to get it to show 100/page instead of 10/page because this bit of the code wasn&#39;t working it thought their was no table. I do not know however why this section of the code has stopped working:"}, {"owner": {"reputation": 9, "user_id": 11237850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64402e0366896bc84d0df22b641267?s=128&d=identicon&r=PG&f=1", "display_name": "egreg", "link": "https://stackoverflow.com/users/11237850/egreg"}, "edited": false, "score": 0, "creation_date": 1561050268, "post_id": 56673930, "comment_id": 99947040, "body": "I will post a new question! because I can&#39;t still figure it out. Thanks again."}, {"owner": {"reputation": 9, "user_id": 11237850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64402e0366896bc84d0df22b641267?s=128&d=identicon&r=PG&f=1", "display_name": "egreg", "link": "https://stackoverflow.com/users/11237850/egreg"}, "edited": false, "score": 0, "creation_date": 1561051207, "post_id": 56673930, "comment_id": 99947421, "body": "solved it using QHarr&#39;s code .querySelector(&quot;.el-icon-caret-bottom&quot;). Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1560971109, "post_id": 56674257, "comment_id": 99915959, "body": "this looks like javascript or something else?  OP is working in VBA."}], "tags": [], "owner": {"reputation": 176, "user_id": 8182291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135f6960e27f824a1e79a530815a4562?s=128&d=identicon&r=PG&f=1", "display_name": "Vatsal Jain", "link": "https://stackoverflow.com/users/8182291/vatsal-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1560970873, "creation_date": 1560970873, "answer_id": 56674257, "question_id": 56673930, "link": "https://stackoverflow.com/questions/56673930/cannot-get-a-particular-table-from-a-webpage-code-use-to-work/56674257#56674257", "title": "cannot get a particular table from a webpage, code use to work", "body": "<p>Try</p>\n\n<pre><code>window.addEventListener('load', () =&gt; {\n  let data = document.body.getElementsByClassName(\"normal-table data-table\")[0].getElementsByTagName(\"td\");\n  // do something with data\n})\n</code></pre>\n\n<p>Instead of the round <strong>'('</strong> brackets, it seems fine. But, it could be possible that the data in table is loading after your function runs, so its throwing error.</p>\n\n<p>You can refer to this <a href=\"https://stackoverflow.com/questions/32905183/how-do-you-get-elements-from-a-javascript-htmlcollection\">post</a></p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1560974934, "last_edit_date": 1560974934, "creation_date": 1560973487, "answer_id": 56674826, "question_id": 56673930, "link": "https://stackoverflow.com/questions/56673930/cannot-get-a-particular-table-from-a-webpage-code-use-to-work/56674826#56674826", "title": "cannot get a particular table from a webpage, code use to work", "body": "<p><strong>XMLHTTP:</strong></p>\n\n<p>Faster than a browser and providing more info is xhr.</p>\n\n<p>The data is provided from an API call. You can scrape the token for this and pass in a subsequent request. A few helper functions to get the token and handle results as well as a json parser to handle json response from API.</p>\n\n<p>This requires installing code for jsonparser from <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">jsonconverter.bas</a> in a standard module called JsonConverter and then going VBE>Tools>References>Add a reference to Microsoft Scripting Runtime.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetInfo()\n    Dim json As Object, headers(), ws As Worksheet, i As Long, results()\n    Dim re As Object, r As Long, c As Long, dict As Object, p As String, token As String, s As String\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    p = \"password_grant_custom\\.client\"\":\"\"(.*?)\"\"\"\n    Set re = CreateObject(\"VBScript.RegExp\")\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.gurufocus.com/stock/HIL/insider\", False\n        .send\n        token = GetToken(re, .responseText, p)\n        If token = \"Not found\" Then Exit Sub\n        .Open \"GET\", \"https://www.gurufocus.com/reader/_api/stocks/NYSE:HIL/insider?page=1&amp;per_page=1000&amp;sort=date%7Cdesc\", False\n        .setRequestHeader \"authorization\", \"Bearer \" &amp; token\n        .send\n        s = .responseText\n        Set json = JsonConverter.ParseJson(.responseText)(\"data\")\n        headers = json(1).keys\n        ReDim results(1 To json.Count, 1 To UBound(headers) + 1)\n        For Each dict In json\n            r = r + 1: c = 1\n            For i = LBound(headers) To UBound(headers)\n                If headers(i) &lt;&gt; \"ownership_details\" Then\n                    results(r, c) = dict(headers(i))\n                Else\n                    results(r, c) = EmptyDict(dict(headers(i)))\n                End If\n                c = c + 1\n            Next\n        Next\n    End With\n    With ws\n        .Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n        .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n\nPublic Function EmptyDict(ByVal dict As Object, Optional r As String, Optional key As Variant) As String\n    Dim s As String\n    For Each key In dict\n        If TypeName(dict(key)) = \"Dictionary\" Then\n            r = EmptyDict(dict(key), r, key)\n        Else\n            s = IIf(key = \"D\", \"Direct \", key)\n            r = r &amp; s &amp; \" \" &amp; dict(key) &amp; Chr$(10)\n        End If\n    Next\n    EmptyDict = r\nEnd Function\n\nPublic Function GetToken(ByVal re As Object, ByVal inputString As String, ByVal pattern As String) As String\n    With re\n        .Global = True\n        .pattern = pattern\n        If .test(inputString) Then               ' returns True if the regex pattern can be matched agaist the provided string\n            GetToken = .Execute(inputString)(0).SubMatches(0)\n        Else\n            GetToken = \"Not found\"\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Sample of output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Uo5eg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uo5eg.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>Using browser and also setting results to 100 per page:</strong></p>\n\n<p>The following dimisses login message if present.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetData()\n    Dim ie As Object, clipboard As Object, ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.gurufocus.com/stock/HIL/insider\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        With .document\n            If .querySelectorAll(\".login-card\").Length &gt; 0 Then\n                .querySelector(\".login-card .el-icon-close\").Click\n            End If\n            .querySelector(\".el-icon-caret-bottom\").Click\n            .querySelector(\".aio-popover-item:nth-of-type(6)\").Click\n        End With\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        clipboard.SetText .document.querySelector(\".data-table\").outerHTML\n        clipboard.PutInClipboard\n        ws.Range(\"A1\").PasteSpecial\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11237850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64402e0366896bc84d0df22b641267?s=128&d=identicon&r=PG&f=1", "display_name": "egreg", "link": "https://stackoverflow.com/users/11237850/egreg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 56674826, "answer_count": 2, "score": 0, "last_activity_date": 1560974934, "creation_date": 1560969439, "last_edit_date": 1560973961, "question_id": 56673930, "link": "https://stackoverflow.com/questions/56673930/cannot-get-a-particular-table-from-a-webpage-code-use-to-work", "title": "cannot get a particular table from a webpage, code use to work", "body": "<p>I had some code in excel vba that webscraped hundreds of pages by grabbing all the cells from a table called \"Insider Transactions\" on particular urls. The following is an example url: <a href=\"https://www.gurufocus.com/stock/HIL/insider\" rel=\"nofollow noreferrer\">https://www.gurufocus.com/stock/HIL/insider</a></p>\n\n<p>For some reason my code below no longer works. I cannot for the life of me work out why. The class I am trying to grab still seems to be called \"normal-table data-table\"</p>\n\n<p>I have tried getting rid of the (0) as there appears to be only one table with the class name normal-table data-table now.</p>\n\n<p>Set code is:</p>\n\n<pre><code>Set allCells = doc.body.getElementsByClassName(\"normal-table data-table\")(0).getElementsByTagName(\"td\")\n</code></pre>\n\n<p>no error messages are given when I run my current code, but it is clear that allCells is not being set to anything because my code doesn't work and allCells.length doesn't return anything. Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 915, "user_id": 4367909, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UL3w2Qa6vQE/AAAAAAAAAAI/AAAAAAAAAA0/O5Wc6xYja28/photo.jpg?sz=128", "display_name": "Nathan Sutherland", "link": "https://stackoverflow.com/users/4367909/nathan-sutherland"}, "edited": false, "score": 2, "creation_date": 1560967988, "post_id": 56673249, "comment_id": 99914541, "body": "Could you compare the range.address to avoid the error?"}, {"owner": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "reply_to_user": {"reputation": 915, "user_id": 4367909, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UL3w2Qa6vQE/AAAAAAAAAAI/AAAAAAAAAA0/O5Wc6xYja28/photo.jpg?sz=128", "display_name": "Nathan Sutherland", "link": "https://stackoverflow.com/users/4367909/nathan-sutherland"}, "edited": false, "score": 0, "creation_date": 1560968026, "post_id": 56673249, "comment_id": 99914557, "body": "That&#39;s a good thought. I&#39;ll look into this now and report back."}, {"owner": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "reply_to_user": {"reputation": 915, "user_id": 4367909, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UL3w2Qa6vQE/AAAAAAAAAAI/AAAAAAAAAA0/O5Wc6xYja28/photo.jpg?sz=128", "display_name": "Nathan Sutherland", "link": "https://stackoverflow.com/users/4367909/nathan-sutherland"}, "edited": false, "score": 0, "creation_date": 1560968387, "post_id": 56673249, "comment_id": 99914699, "body": "Update: range.address returns several cells, coinciding with the range returning multiple ranges. This would absolutely work if this wasn&#39;t the case and I appreciate the idea. However I&#39;m still unsure why this particular hyperlink.range is returning a series of cells as opposed to just the one being iterated over."}, {"owner": {"reputation": 915, "user_id": 4367909, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UL3w2Qa6vQE/AAAAAAAAAAI/AAAAAAAAAA0/O5Wc6xYja28/photo.jpg?sz=128", "display_name": "Nathan Sutherland", "link": "https://stackoverflow.com/users/4367909/nathan-sutherland"}, "edited": false, "score": 0, "creation_date": 1560968583, "post_id": 56673249, "comment_id": 99914788, "body": "Are the cells contiguous, can you comment the address?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1560968664, "post_id": 56673249, "comment_id": 99914815, "body": "Can you explain what you mean by &quot;if a Hyperlink&#39;s range is equal to a previously specified range&quot;?  Do you mean that they refer to the same address/location? Or that they contain the same underlying value?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560968712, "post_id": 56673249, "comment_id": 99914839, "body": "Hyperlinks can refer to a contiguous range of cells, e.g., &quot;A1:H16&quot;, etc. So, either you need to alter your existing hyperlinks, or control for that possibility."}, {"owner": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "reply_to_user": {"reputation": 915, "user_id": 4367909, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UL3w2Qa6vQE/AAAAAAAAAAI/AAAAAAAAAA0/O5Wc6xYja28/photo.jpg?sz=128", "display_name": "Nathan Sutherland", "link": "https://stackoverflow.com/users/4367909/nathan-sutherland"}, "edited": false, "score": 0, "creation_date": 1560968742, "post_id": 56673249, "comment_id": 99914857, "body": "@NathanSutherland Yes they are contiguous. The address returned is $D$D:$D$36"}, {"owner": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1560968847, "post_id": 56673249, "comment_id": 99914906, "body": "@JvdV As far as I can tell there are no merged cells on that hyperlink. Is there a specific way you would recommend determining this other than looking at the cell?"}, {"owner": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560969007, "post_id": 56673249, "comment_id": 99914984, "body": "@DavidZemens The macro is given two ranges: the source range and the destination range. For the given sheet the macro iterates through all hyperlinks and compares the range of the current hyperlink to the source range. If they are equal the range is copied. The macro compares the actual range of the hyperlink to the range received by the macro. Hope this clarifies."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1560969010, "post_id": 56673249, "comment_id": 99914985, "body": "<code>$D$D:$D$36</code> isn&#39;t a valid address?"}, {"owner": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "edited": false, "score": 0, "creation_date": 1560969095, "post_id": 56673249, "comment_id": 99915019, "body": "Apologies. It was a typo. the address is $D$6:$D$36"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560969313, "post_id": 56673249, "comment_id": 99915132, "body": "No, you still haven&#39;t explained what you mean by &quot;equal&quot;. Do you mean the same underlying <i>value</i>? Or do you mean the same <i>location</i>?"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1560969550, "post_id": 56673249, "comment_id": 99915257, "body": "From what you are saying, Nathan&#39;s original suggestion should work."}, {"owner": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560969689, "post_id": 56673249, "comment_id": 99915320, "body": "@DavidZemens Sorry, it is comparing the location of the hyperlink. I&#39;ve been doing this by testing the equality of the ranges themselves"}], "answers": [{"comments": [{"owner": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "edited": false, "score": 0, "creation_date": 1560969576, "post_id": 56673900, "comment_id": 99915274, "body": "Thank you for the input. I understand that this is what is causing the error, the problem is that I cannot understand why the hyperlink is referring to multiple cells in this particular instance, since it is the same hyperlink as several of the previous ones that were iterated through. There is nothing about this particular use of the hyperlink that should change the range referred to and this is what I would like to determine. I&#39;ve also attempted to compare the hyperlink.range.address but this is given as a series of cells as I explained in the comments above."}, {"owner": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "edited": false, "score": 1, "creation_date": 1560969774, "post_id": 56673900, "comment_id": 99915365, "body": "Sorry, I just noticed the second option you suggested. I will give that a try and report back."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "edited": false, "score": 0, "creation_date": 1560969790, "post_id": 56673900, "comment_id": 99915374, "body": "The answer to the question &quot;Why does a hyperlink refer to multiple cells?&quot; Is: &quot;because that&#39;s how it was created&quot;. You say you&#39;ve attempted to compare the addresses, but you don&#39;t say what happens when you do this. Of course they will not be equivalent. So what do you want to do in that case?"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1560969872, "last_edit_date": 1560969872, "creation_date": 1560969276, "answer_id": 56673900, "question_id": 56673249, "link": "https://stackoverflow.com/questions/56673249/why-does-worksheet-hyperlink-range-sometimes-return-a-series-of-ranges-as-oppose/56673900#56673900", "title": "Why does Worksheet.Hyperlink.Range sometimes return a series of ranges as opposed to just one when iterating through the Worksheet?", "body": "<p><code>fromRange</code> is always a single cell range, and the <code>hyperlink.Range</code> may refer to multiple cells. The mismatch here is with your comparison:</p>\n\n<pre><code>if hyperlink.range = fromRange\n</code></pre>\n\n<p>When a <code>Range</code> represents a single cell, it will evaluate to its <code>Value</code> property by default (the actual implementation is a little more complicated), and this will return the underlying data (string, numeric, date, etc.). When a <code>Range</code> represents multiple cells, its <code>Value</code> is an <em>array</em> of the individual cell values.</p>\n\n<p>So you can expect a mismatch as a result because you have an array on the left side, and something else on the right. The <code>=</code> comparison operator can't handle an array on either side. Try it:</p>\n\n<pre><code>If Range(\"A1:B1\") = Range(\"C1:D1\") Then \n</code></pre>\n\n<p>The above will also raise a mismatch error, even though both sides of the <code>=</code> are arrays of the same size!</p>\n\n<p>You may want to consider comparing the <code>Address</code> property instead?</p>\n\n<pre><code>hyperlink.range.Address = fromRange.Address\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>' tests the top/left cell\nhyperlink.range(1,1).Address = fromRange.Address\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 4, "last_activity_date": 1560969331, "creation_date": 1560969331, "answer_id": 56673912, "question_id": 56673249, "link": "https://stackoverflow.com/questions/56673249/why-does-worksheet-hyperlink-range-sometimes-return-a-series-of-ranges-as-oppose/56673912#56673912", "title": "Why does Worksheet.Hyperlink.Range sometimes return a series of ranges as opposed to just one when iterating through the Worksheet?", "body": "<p>If you select multiple cells an then add a hyperlink, you only get one link displayed, but all of the selected cells respond as if they are hyperlinked. </p>\n\n<p>The <code>hyperlink.Range.Address</code> property here is <code>$B$2:$B$15</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/0TKXA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0TKXA.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 376, "user_id": 5574891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d599ac673c307066b136fb44780260?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Simmons", "link": "https://stackoverflow.com/users/5574891/blake-simmons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56673900, "answer_count": 2, "score": 2, "last_activity_date": 1560973394, "creation_date": 1560966245, "last_edit_date": 1560973394, "question_id": 56673249, "link": "https://stackoverflow.com/questions/56673249/why-does-worksheet-hyperlink-range-sometimes-return-a-series-of-ranges-as-oppose", "title": "Why does Worksheet.Hyperlink.Range sometimes return a series of ranges as opposed to just one when iterating through the Worksheet?", "body": "<p>I have a macro which iterates through all of the Hyperlinks on all Worksheets in a Workbook, and if a Hyperlink's range is equal to a previously specified range, copies the Hyperlink to the same range on a destination sheet in a new Workbook and then moves onto the next Worksheet. This works flawlessly through the course of about 5 Worksheets, then suddenly throws a mismatch error and the whole process fails.</p>\n\n<p>While debugging I've determined that every time, at the same Hyperlink on the same Worksheet, <code>Worksheet.Hyperlink.Range</code> (<code>hyperlink.range</code> in my code) returns a series of ranges rather than just one (as far as I can tell), and since the loop compares this to a single range, this is where the mismatch is occurring. The problem is that I can not determine why this is happening. I can not find any difference in the properties of this Hyperlink compared to the others that would cause it to be expressed as a series of ranges. </p>\n\n<pre><code>    Public Sub CopyLink(fromRange As range, toRange As range)\n\n        Dim hyperlink As Hyperlink\n        Dim fromSheet As Worksheet\n        Set fromSheet = fromRange.Worksheet\n\n        For Each hyperlink In fromSheet.Hyperlinks\n            If hyperlink.range = fromRange Then 'mismatch happens here after several successful iterations\n                hyperlink.range.Copy\n                toRange.PasteSpecial\n                Exit For\n            End If\n        Next\n\n    End Sub\n</code></pre>\n\n<p>I would like to figure out how to either</p>\n\n<p>A. alter the comparison of the two ranges in such a way that avoids this issue</p>\n\n<p>or</p>\n\n<p>B. understand the cause of the issue so that I can hopefully rectify it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560965702, "post_id": 56673108, "comment_id": 99913486, "body": "Normally you don&#39;t need to <code>Select</code>. You don&#39;t need the <code>Sheets(&quot;modified_report&quot;).Select</code> and <code>Selection.AutoFilter</code>."}], "owner": {"reputation": 93, "user_id": 11666863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f13589cd21afc761e3b81e6fa294460?s=128&d=identicon&r=PG&f=1", "display_name": "Starbucks", "link": "https://stackoverflow.com/users/11666863/starbucks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1560965573, "creation_date": 1560965545, "last_edit_date": 1560965573, "question_id": 56673108, "link": "https://stackoverflow.com/questions/56673108/vba-autofiltering-for-name", "title": "VBA autofiltering for name", "body": "<p>I am getting an error when I am running my selection.autofilter code and cannot figure out the problem.</p>\n\n<p>I am trying to autofilter by name 'JHILL2' in column F of a spreadsheet</p>\n\n<pre><code>Sub filter_jhill2()\n\nSet ws = Worksheets(\"modified_report\")\n\nApplication.ScreenUpdating = False\n\nSheets(\"modified_report\").Select\n\nSelection.AutoFilter\n    Worksheets(\"modified_report\").Range(\"A1\").AutoFilter Field:=6, Criteria1:=\"JHILL2\"\n\nEnd Sub\n</code></pre>\n\n<p>I am trying to have just the rows with JHILL2 be returned</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "dropdown", "queryselector"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11671959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc6f2ff1cd4b7afb4578d6f5e6be181?s=128&d=identicon&r=PG&f=1", "display_name": "ab1225", "link": "https://stackoverflow.com/users/11671959/ab1225"}, "edited": false, "score": 0, "creation_date": 1560971903, "post_id": 56673894, "comment_id": 99916325, "body": "This works great except for the last part regarding selecting as CSV. It does not do anything and the file download type remains PDF. Also is there a way to automatically open up the downloaded file?"}, {"owner": {"reputation": 35, "user_id": 11671959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc6f2ff1cd4b7afb4578d6f5e6be181?s=128&d=identicon&r=PG&f=1", "display_name": "ab1225", "link": "https://stackoverflow.com/users/11671959/ab1225"}, "edited": false, "score": 0, "creation_date": 1560979418, "post_id": 56673894, "comment_id": 99919271, "body": "Thank you so much! Works amazingly!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1560975583, "last_edit_date": 1560975583, "creation_date": 1560969257, "answer_id": 56673894, "question_id": 56673070, "link": "https://stackoverflow.com/questions/56673070/dropdown-menus-with-vba/56673894#56673894", "title": "Dropdown Menus with VBA", "body": "<p>The following shows you how to download</p>\n\n<pre><code>Option Explicit\n\n'VBE &gt; Tools &gt; References: Microsoft Internet Controls\nPublic Sub GetData()\n    Dim ie As Object\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = True\n        .Navigate2 \"https://clinicaltrials.gov/ct2/results?cond=&amp;term=Medpace&amp;cntry=&amp;state=&amp;city=&amp;dist=\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"#save-list-link\").Click\n            .querySelector(\"#number-of-studies option:last-child\").Selected = True 'select last option from that dropdown\n            '.querySelector(\"#number-of-studies\").selectedIndex = 1  ''selects 2nd option\n            .querySelector(\"[value=csv]\").Selected = True 'select csv with attribute = value css selector\n\n            .querySelector(\"#submit-download-list\").Click\n        End With\n        Application.Wait Now + TimeSerial(0, 0, 10)\n        Application.SendKeys \"%+O\", True\n        Application.Wait Now + TimeSerial(0, 0, 10)\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11671959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc6f2ff1cd4b7afb4578d6f5e6be181?s=128&d=identicon&r=PG&f=1", "display_name": "ab1225", "link": "https://stackoverflow.com/users/11671959/ab1225"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56673894, "answer_count": 1, "score": 2, "last_activity_date": 1561527493, "creation_date": 1560965419, "last_edit_date": 1561527493, "question_id": 56673070, "link": "https://stackoverflow.com/questions/56673070/dropdown-menus-with-vba", "title": "Dropdown Menus with VBA", "body": "<p>I need to select a specific option from a dropdown menu using VBA. How can I do this?</p>\n\n<p><a href=\"https://clinicaltrials.gov/ct2/results?cond=&amp;term=Medpace&amp;cntry=&amp;state=&amp;city=&amp;dist=\" rel=\"nofollow noreferrer\">https://clinicaltrials.gov/ct2/results?cond=&amp;term=Medpace&amp;cntry=&amp;state=&amp;city=&amp;dist=</a>\nlink to webpage we are trying to pull from </p>\n\n<p>IE.document.getElementsByName(\"down_count\").click code that I tried</p>\n\n<pre><code>Full Module:\nPrivate Sub Workbook_Open()\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    With IE\n        .Visible = True\n        .Navigate (\"https://clinicaltrials.gov/ct2/results?cond=&amp;term=Medpace&amp;cntry=&amp;state=&amp;city=&amp;dist=\")\n        While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n\n    End With\n\n    With IE.document\n    IE.Refresh\n        Set div = IE.document.getElementById(\"save-list-link\")\n        div.FireEvent \"onclick\"\n    ' Application.SendKeys \"{TAB}\", True\n    ' Application.SendKeys \"{TAB}\", True\n    ' Application.SendKeys \"{SPACE}\", True\n    ' Application.SendKeys \"{DOWN}\", True\n    ' Application.SendKeys \"{ENTER}\", True\n    ' Application.SendKeys \"{TAB}\", True\n    ' Application.SendKeys \"{TAB}\", True\n    ' Application.SendKeys \"{SPACE}\", True\n    ' Application.SendKeys \"{DOWN}\", True\n    ' Application.SendKeys \"{DOWN}\", True\n    ' Application.SendKeys \"{DOWN}\", True\n    ' Application.SendKeys \"{ENTER}\", True\n    IE.document.getElementsByName(\"down_count\").click\n    ' For Each elt In IE.document.getElementById(\"number-of-studies\")\n        ' If InStr(elt.innerText, \"Found\") &gt; 0 Then elt.click: Exit For\n    ' Next elt\n\n    Set div4 = IE.document.getElementById(\"submit-download-list\")\n    div4.click\n    End With\nEnd Sub\n</code></pre>\n\n<p>Would like to have Number of Studies go to All found (this number changes)\nand have select file format be CSV</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1560964437, "post_id": 56672623, "comment_id": 99912924, "body": "<code>Data</code> is not an array, but a <code>Range</code> object. <code>Range.Value</code> is an array only if the range is for more than a single cell."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560967574, "post_id": 56672784, "comment_id": 99914360, "body": "I think that hard-coded comma needs to be <code>Application.International(xlListSeparator)</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1560967613, "post_id": 56672784, "comment_id": 99914377, "body": "@MathieuGuindon I agree, add that to the list of things that &quot;can be made more robust&quot; :)"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 3, "last_activity_date": 1560964082, "creation_date": 1560964082, "answer_id": 56672784, "question_id": 56672623, "link": "https://stackoverflow.com/questions/56672623/pass-excel-array-constant-to-vba-function/56672784#56672784", "title": "pass excel array constant to VBA function", "body": "<p>I'm not sure what your use case is, but I think you can just use <code>Split</code> here.</p>\n\n<pre><code>Function MyFunc(ByVal Data As Range) As Long\n    Dim x\n    x = Split(Data.Formula, \",\")\n    MyFunc = UBound(x) + 1\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/eH6Vc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eH6Vc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Obviously this can be made more robust (e.g. handle a multi-cell input), but I think it gets you going in the right direction.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1560967578, "post_id": 56672804, "comment_id": 99914362, "body": "I think that hard-coded comma needs to be <code>Application.International(xlListSeparator)</code>."}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": false, "score": 3, "last_activity_date": 1560964192, "creation_date": 1560964192, "answer_id": 56672804, "question_id": 56672623, "link": "https://stackoverflow.com/questions/56672623/pass-excel-array-constant-to-vba-function/56672804#56672804", "title": "pass excel array constant to VBA function", "body": "<p>May be</p>\n\n<pre><code>Function MyFunc(data As Range)\nDim x\n\nx = Split(Mid(data.Formula, 3), \",\")\nMyFunc = UBound(x) + 1\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 5, "last_activity_date": 1560969755, "creation_date": 1560969755, "answer_id": 56674004, "question_id": 56672623, "link": "https://stackoverflow.com/questions/56672623/pass-excel-array-constant-to-vba-function/56674004#56674004", "title": "pass excel array constant to VBA function", "body": "<p>And another method:</p>\n\n<pre><code>Function myFunc(Data)\n    myFunc = UBound(Evaluate(Data.Formula))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 923, "user_id": 3582076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0faa71bfbd05449fb38801abe4987594?s=128&d=identicon&r=PG&f=1", "display_name": "user3582076", "link": "https://stackoverflow.com/users/3582076/user3582076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 56674004, "answer_count": 3, "score": 3, "last_activity_date": 1560969755, "creation_date": 1560963428, "question_id": 56672623, "link": "https://stackoverflow.com/questions/56672623/pass-excel-array-constant-to-vba-function", "title": "pass excel array constant to VBA function", "body": "<p>I have a cell whose value is an array constant,\nfor example cell A1 is set to <code>={1,2,3,4,5,6}</code></p>\n\n<p>I then defined a function in VBA:</p>\n\n<pre><code>Function MyFunc(Data)\nMyFunc = Data.Rows.Count\nEnd Function\n</code></pre>\n\n<p>I want the function to return the length of the array (6) when I can <code>=MyFunc(A1)</code>, but using the debugger, I find the 'Data' variable my function receives only contains the first element of this array.\n<code>Data.Rows.Count</code> evaluates to 1 and <code>TypeName(Data)</code> evaluates to 'Range'</p>\n"}, {"tags": ["excel", "vba", "search", "listbox"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1560964189, "post_id": 56672570, "comment_id": 99912796, "body": "Add the values to an array (arr) then set the <code>.List = arr</code>.  Without digging further, I would guess that it&#39;s an issue with the counting in your list."}, {"owner": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1560970313, "post_id": 56672570, "comment_id": 99915618, "body": "Thank you Mathieu. Can you help me merge your idea with what was proposed by A Cohen please?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "edited": false, "score": 0, "creation_date": 1560970136, "post_id": 56672928, "comment_id": 99915542, "body": "Thank you. Your code helped for cleaning it up. But I`m still getting errors. Can you help me on merging yours with what was proposed by @Cyril?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "edited": false, "score": 1, "creation_date": 1560970456, "post_id": 56672928, "comment_id": 99915679, "body": "@FaridFarmani Are you sitll getting error 380 or something different?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1560971456, "post_id": 56672928, "comment_id": 99916120, "body": "I&#39;m a bit confused at how to merge @Cyril&#39;s idea"}, {"owner": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "edited": false, "score": 1, "creation_date": 1560972383, "post_id": 56672928, "comment_id": 99916532, "body": "I<code>m also working on it. If I can figure it out I</code>ll post my solution here."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1560975771, "post_id": 56672928, "comment_id": 99917916, "body": "@ACohen I added mine for this, so hopefully you can make sense of what I did... the explanation is at the bottom of the post."}], "tags": [], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "is_accepted": false, "score": 2, "last_activity_date": 1560965949, "last_edit_date": 1560965949, "creation_date": 1560964750, "answer_id": 56672928, "question_id": 56672570, "link": "https://stackoverflow.com/questions/56672570/how-to-fix-run-time-error-380-in-excel-vba/56672928#56672928", "title": "How to fix &quot; Run-time error &#39;380&#39; in Excel VBA?", "body": "<p>I don't know if this will fix everything, but it will definitely clean it up a bit.  Also, I am not sure what worksheet you are pulling <code>Cells(rw.Row, 2).value</code> from. But they may have something to do with why it stops part way through.  Also, to clean it up a bit, try an additional <code>For Statement</code>.</p>\n\n<pre><code>Private Sub txtSearch_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n\n    Dim rng As Range: Set rng = Range(\"Lookup\")\n    Dim rw\n    Dim strText As String: strText = LCase(txtSearch.Text)\n\n    With ListBox1\n        .RowSource = \"\"\n        .ColumnCount = 21\n\n        For Each rw In rng.Rows\n            If InStr(LCase(Cells(rw.Row, 4)), strText) Then\n                .AddItem Cells(rw.Row, 1).Value\n                For x = 1 To 12  '''Change Worksheet to your Worksheet name\n                    .List(ListBox1.ListCount - 1, x) = Worksheets(\"Sample\").Cells(rw.Row, x + 1).Value2\n                Next x\n            End If\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>If this doesn't help, try what @Cyril said with the array.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "edited": false, "score": 0, "creation_date": 1560976154, "post_id": 56675247, "comment_id": 99918078, "body": "Thank you for your code and the descriptions. I tried the code but I keep getting &#39;run-time error &#39;70&#39;- Permission denied&#39; on &quot;ListBox1.List = brr&quot;. It also takes a while after I type my first letter of the whole searching word. Did you get this error at any time?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "edited": false, "score": 0, "creation_date": 1560981223, "post_id": 56675247, "comment_id": 99919839, "body": "@FaridFarmani I did not; I ensured that I have MSForms 2.0 library turned on in my references, though i don&#39;t think that would deny permission.  Is your listbox locked?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1561038030, "post_id": 56675247, "comment_id": 99940032, "body": "@Cyril - This is well above my expertise, sorry if I don&#39;t follow."}, {"owner": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "edited": false, "score": 0, "creation_date": 1561039100, "post_id": 56675247, "comment_id": 99940661, "body": "@Cyril I checked MSForms and the listbox and everything is normal. Not sure what the issue is here. Is there any chance we can do the job using Autofilter method?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "edited": false, "score": 0, "creation_date": 1561054475, "post_id": 56675247, "comment_id": 99948851, "body": "@FaridFarmani See <a href=\"https://stackoverflow.com/a/43350502/3233363\">stackoverflow.com/a/43350502/3233363</a>  This may be under the same pretense, where you need to <code>ListBox1.RemoveItem</code>.  I apologize for missing that; my ListBox knowledge comes from userForms, where this is generated on Initialize, not being re-written.  This will lead to a solution to removing items: <a href=\"https://stackoverflow.com/a/2998231/3233363\">stackoverflow.com/a/2998231/3233363</a> (says combobox in the title, but the answer is about listbox)"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1560975815, "last_edit_date": 1560975815, "creation_date": 1560975474, "answer_id": 56675247, "question_id": 56672570, "link": "https://stackoverflow.com/questions/56672570/how-to-fix-run-time-error-380-in-excel-vba/56675247#56675247", "title": "How to fix &quot; Run-time error &#39;380&#39; in Excel VBA?", "body": "<p>Just came back to you... a bit long, but here's the general thoughts...</p>\n\n<p>This all goes in the code for the ActiveX Control:</p>\n\n<pre><code>Option Explicit\n\nSub ListBox1_Click()\n    Dim rw As Range, strtext As String\n    Dim arr As Variant, ai As Long, aj As Long \n    Dim brr As Variant, bi As Long, bj As Long\n    strtext = \"a\" 'I used this when i did my testing\n    ReDim arr(11, 0)\n    For Each rw In Range(\"rng\")\n        If InStr(LCase(rw.Value), strtext) Then\n            aj = findaj(arr)\n            If Not IsEmpty(arr(1, aj)) Then\n                aj = aj + 1\n                ReDim Preserve arr(11, aj)\n            End If\n            For ai = 1 To 11\n                arr(ai, aj) = Cells(rw.Row, ai + 1).Value\n            Next ai\n        End If\n    Next rw\n    ReDim brr(aj, 11)\n    For bi = 0 To aj\n        For bj = 1 To 11\n            brr(bi, bj) = arr(bj, bi)\n        Next bj\n    Next bi\n    ListBox1.ColumnCount = 11\n    ListBox1.List = brr\nEnd Sub\n\nPrivate Function findaj(ByVal brr As Variant)\n    Dim j As Long, meow As String\n    j = 0\n    Do While True\n        On Error GoTo toll\n        j = j + 1\n        meow = brr(1, j)\n    Loop\ntoll:\n    findaj = j - 1\nEnd Function\n</code></pre>\n\n<p>So there's a lot going on here... I use two separate arrays, due to how redimming arrays works in VBA.  You can <strong>only</strong> update the second element of the array, so <code>arr(ai,aj)</code> can only have <code>aj</code> updated when I <code>redim preserve</code> while adding a new row to my array.</p>\n\n<p>So we make an array (<code>arr</code>) that captures the data based on VBA's limitations.  Within that array, we use a function, <code>findaj</code>, which intentionally traps an error to determine the appropriate last <em>column</em> in <code>arr</code> (i italicized the use of column, as it's not truly the case, but it makes sense spatially when thinking about it).</p>\n\n<p>You then convert the array <code>arr</code> to <code>brr</code> in the appropriate order of columns/rows.</p>\n\n<p>Afterwards, you make your <code>.list = brr</code>.</p>\n"}], "owner": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1569215892, "creation_date": 1560963252, "last_edit_date": 1561057938, "question_id": 56672570, "link": "https://stackoverflow.com/questions/56672570/how-to-fix-run-time-error-380-in-excel-vba", "title": "How to fix &quot; Run-time error &#39;380&#39; in Excel VBA?", "body": "<p>I am adding more than 10 columns to my listbox in Excel VBA. I keep getting run-time error '380'-Invalid property value. It works properly until column 9 in listbox. I couldn`t find any proper solution for this anywhere else. Does anyone know a workaround for this issue?</p>\n\n<pre><code>Private Sub txtSearch_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal \nShift As Integer)\nDim rng As Range\nSet rng = Range(\"Lookup\")\nDim rw\nDim strText As String\nstrText = LCase(txtSearch.Text)\nWith ListBox1\n.RowSource = \"\"\n.ColumnCount = 12\n\n For Each rw In rng.Rows\n    If InStr(LCase(Cells(rw.Row, 4)), strText) Then\n        .AddItem Cells(rw.Row, 1).Value\n        .List(ListBox1.ListCount - 1, 1) = Cells(rw.Row, 2).Value\n        .List(ListBox1.ListCount - 1, 2) = Cells(rw.Row, 3).Value\n        .List(ListBox1.ListCount - 1, 3) = Cells(rw.Row, 4).Value\n        .List(ListBox1.ListCount - 1, 4) = Cells(rw.Row, 5).Value\n        .List(ListBox1.ListCount - 1, 5) = Cells(rw.Row, 6).Value\n        .List(ListBox1.ListCount - 1, 6) = Cells(rw.Row, 7).Value\n        .List(ListBox1.ListCount - 1, 7) = Cells(rw.Row, 8).Value\n        .List(ListBox1.ListCount - 1, 8) = Cells(rw.Row, 9).Value\n        .List(ListBox1.ListCount - 1, 9) = Cells(rw.Row, 10).Value\n        .List(ListBox1.ListCount - 1, 10) = Cells(rw.Row, 11).Value\n        .List(ListBox1.ListCount - 1, 11) = Cells(rw.Row, 12).Value\n        .List(ListBox1.ListCount - 1, 12) = Cells(rw.Row, 13).Value           \n    End If\nNext    \n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1560962777, "post_id": 56672375, "comment_id": 99912191, "body": "So you don&#39;t want numbers to be allowed at all, is that right?"}, {"owner": {"reputation": 526, "user_id": 11054439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27604a9c671e93fd6dfeff5670fbd370?s=128&d=identicon&r=PG&f=1", "display_name": "jvargas", "link": "https://stackoverflow.com/users/11054439/jvargas"}, "reply_to_user": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1560971067, "post_id": 56672375, "comment_id": 99915944, "body": "if it posible, neither special characters"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1560971099, "post_id": 56672375, "comment_id": 99915956, "body": "In that case, you will be best served by Scott&#39;s answer below."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1560964783, "post_id": 56672546, "comment_id": 99913084, "body": "But this will not stop other non alpha characters."}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1560968279, "post_id": 56672546, "comment_id": 99914664, "body": "You&#39;re right, but I&#39;m not even sure whether that&#39;s the user&#39;s intention from the short question they wrote."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1560969379, "post_id": 56672546, "comment_id": 99915171, "body": "True, you may be correct and the user may want other things besides just alpha.  i was always taught to find what you want not what you don&#39;t want.  Either way the OP is covered."}, {"owner": {"reputation": 526, "user_id": 11054439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27604a9c671e93fd6dfeff5670fbd370?s=128&d=identicon&r=PG&f=1", "display_name": "jvargas", "link": "https://stackoverflow.com/users/11054439/jvargas"}, "edited": false, "score": 0, "creation_date": 1560971109, "post_id": 56672546, "comment_id": 99915960, "body": "Thankls for the reply! I just want letters"}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 3, "last_activity_date": 1560963149, "creation_date": 1560963149, "answer_id": 56672546, "question_id": 56672375, "link": "https://stackoverflow.com/questions/56672375/how-to-set-text-validation/56672546#56672546", "title": "How to set text validation?", "body": "<p>You need a formula that returns false when there are numbers in the cell, you can normally use:</p>\n\n<pre><code>=COUNT(FIND({0,1,2,3,4,5,6,7,8,9},D6))=0\n</code></pre>\n\n<p>But in your case, you must place the formula inside a data validation rule, and those don't allow array constants, so you'll have to use repeated <code>Find</code> statements:</p>\n\n<pre><code>=COUNT(FIND(\"0\",D6),FIND(\"1\",D6),FIND(\"2\",D6),FIND(\"3\",D6),FIND(\"4\",D6),FIND(\"5\",D6),FIND(\"6\",D6),FIND(\"7\",D6),FIND(\"8\",D6),FIND(\"9\",D6))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 526, "user_id": 11054439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27604a9c671e93fd6dfeff5670fbd370?s=128&d=identicon&r=PG&f=1", "display_name": "jvargas", "link": "https://stackoverflow.com/users/11054439/jvargas"}, "edited": false, "score": 0, "creation_date": 1560971167, "post_id": 56672929, "comment_id": 99915978, "body": "I asume A1 is where I would put the validation, right?"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1560971461, "post_id": 56672929, "comment_id": 99916125, "body": "When you select the range to set your data validation, the first cell is highlighted in a different color. Use that cell address in place of A1 in this formula."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1560964756, "creation_date": 1560964756, "answer_id": 56672929, "question_id": 56672375, "link": "https://stackoverflow.com/questions/56672375/how-to-set-text-validation/56672929#56672929", "title": "How to set text validation?", "body": "<p>This formula used in data validation will only allow alpha(a-z) and no others:</p>\n\n<pre><code>=SUMPRODUCT(--ISNUMBER(SEARCH(MID(A1,ROW(INDIRECT(\"1:\" &amp; LEN(A1))),1),\"abcdefghijklmnopqrstuvwxyz\")))=LEN(A1)\n</code></pre>\n"}], "owner": {"reputation": 526, "user_id": 11054439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27604a9c671e93fd6dfeff5670fbd370?s=128&d=identicon&r=PG&f=1", "display_name": "jvargas", "link": "https://stackoverflow.com/users/11054439/jvargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 56672929, "answer_count": 2, "score": 2, "last_activity_date": 1560965424, "creation_date": 1560962469, "last_edit_date": 1560965424, "question_id": 56672375, "link": "https://stackoverflow.com/questions/56672375/how-to-set-text-validation", "title": "How to set text validation?", "body": "<p>I want to only allow text input on some cells. I have tried some code, but it allows to input numbers and letters. Any help would be great, thanks.</p>\n\n<p>I tried the <code>istext</code> function and it works. When the input is all numbers it does not allow, but in number/letter case is does not work</p>\n\n<pre><code>  =ISTEXT(D6)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560962889, "post_id": 56672357, "comment_id": 99912241, "body": "Perhaps consider using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\"><code>Range.Find</code></a> to find the column in the header row by searching for its text."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560963109, "post_id": 56672357, "comment_id": 99912336, "body": "Totally tangential - but is this for <a href=\"https://en.wikipedia.org/wiki/Comprehensive_Capital_Analysis_and_Review\" rel=\"nofollow noreferrer\">CCAR</a>? Because I pity you if it is, hate that stuff."}, {"owner": {"reputation": 23, "user_id": 11671638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38ad9425d4b9ec2ad0e3195498d29ee?s=128&d=identicon&r=PG&f=1", "display_name": "This_is_not_a_test", "link": "https://stackoverflow.com/users/11671638/this-is-not-a-test"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561357432, "post_id": 56672357, "comment_id": 100020887, "body": "Thanks for the response BigBen. No, it&#39;s not for that type of CCAR. This is effectively for collation of issues. I will look into what you&#39;ve suggested and see if I can make it work."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561378033, "post_id": 56672357, "comment_id": 100031103, "body": "Great, please feel free to ask another question as needed if you can&#39;t get it to work."}, {"owner": {"reputation": 1002, "user_id": 1365754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ygw.png?s=128&g=1", "display_name": "Hubisan", "link": "https://stackoverflow.com/users/1365754/hubisan"}, "edited": false, "score": 0, "creation_date": 1561968772, "post_id": 56672357, "comment_id": 100216130, "body": "You could use a named range and get its column with Range(&quot;name&quot;).Column. This would also make it possible to change the heading title without affecting the macro."}, {"owner": {"reputation": 23, "user_id": 11671638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38ad9425d4b9ec2ad0e3195498d29ee?s=128&d=identicon&r=PG&f=1", "display_name": "This_is_not_a_test", "link": "https://stackoverflow.com/users/11671638/this-is-not-a-test"}, "edited": false, "score": 0, "creation_date": 1561978737, "post_id": 56672357, "comment_id": 100221027, "body": "The answer was to use:  datetimecol = Application.WorksheetFunction.Match(&quot;date/time&quot;, ccarWks.Range(&quot;A4:AZ4&quot;), 0)  This worked wonderfully in the:        With ccarWks &#39;*****new version******        With .Cells(nextRow, datetimecol) &#39;was &quot;A&quot;               .Value = Now            .NumberFormat = &quot;dd/mm/yyyy hh:mm:ss&quot; &#39;enter date and time stamp in record         End With"}], "answers": [{"tags": [], "owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "is_accepted": false, "score": 0, "last_activity_date": 1564074481, "creation_date": 1564074481, "answer_id": 57207044, "question_id": 56672357, "link": "https://stackoverflow.com/questions/56672357/code-for-automatically-entering-date-time-stamp-into-cell-based-upon-table-headi/57207044#57207044", "title": "Code for automatically entering date/time stamp into cell based upon table heading", "body": "<p>I've had to deal with this in the past too, where you can't be certain that the field with be in the same column because the source table has changed.\nIf you would always have the same field header (column header) then you can use the code I've used before.</p>\n\n<pre><code>Public Function FindColumn(ws As Worksheet, name As String, Optional headerRow As Integer = 1) As Integer\n\n    On Error GoTo FUNC_ERR\n\n    Dim sRng As Range: Set sRng = ws.Rows(headerRow).Find(what:=name, _\n                                                          LookIn:=xlValues, _\n                                                          lookat:=xlWhole)\n    If sRng Is Nothing Then\n        'Handle if not found\n    Else\n        FindColumn = sRng.Column\n    End If\n\nFUNC_EXIT:\n    Exit Function\n\nFUNC_ERR:\n    'Handle error\n\nEnd Function\n</code></pre>\n\n<p>HeaderRow is optional and assumed to be row 1, but you can also call out a different row if necessary.</p>\n\n<p>Then instead of using the column letter in the <code>.cell()</code> callout, you can use the returned column number.</p>\n\n<pre><code>dim columnNumber as Integer: columnNumber = FindColumn(ccarWks, \"Header Name\")\nWith ccarWks    \n    With .Cells(nextRow, columnNumber) \n        .Value = Now\n        .NumberFormat = \"dd/mm/yyyy hh:mm:ss\" \n    End With\n\n    '...more code...\nEnd With\n</code></pre>\n\n<p>Hope this helps you.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 11671638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38ad9425d4b9ec2ad0e3195498d29ee?s=128&d=identicon&r=PG&f=1", "display_name": "This_is_not_a_test", "link": "https://stackoverflow.com/users/11671638/this-is-not-a-test"}, "is_accepted": true, "score": 0, "last_activity_date": 1565258307, "creation_date": 1565258307, "answer_id": 57409962, "question_id": 56672357, "link": "https://stackoverflow.com/questions/56672357/code-for-automatically-entering-date-time-stamp-into-cell-based-upon-table-headi/57409962#57409962", "title": "Code for automatically entering date/time stamp into cell based upon table heading", "body": "<p>I added this code to ensure it was able to dynamically change the column number it was looking for:</p>\n\n<pre><code>   Datetimecol = Application.WorksheetFunction.Match(\"date/time\", CCARWKS.Range(\"A4:AZ4\"), 0)\n\n   With .Cells(nextRow, datetimecol)\n</code></pre>\n\n<p>This now changes the column value automatically and prevents breaking the code.</p>\n"}], "owner": {"reputation": 23, "user_id": 11671638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38ad9425d4b9ec2ad0e3195498d29ee?s=128&d=identicon&r=PG&f=1", "display_name": "This_is_not_a_test", "link": "https://stackoverflow.com/users/11671638/this-is-not-a-test"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 57409962, "answer_count": 2, "score": 2, "last_activity_date": 1565258307, "creation_date": 1560962413, "last_edit_date": 1564415104, "question_id": 56672357, "link": "https://stackoverflow.com/questions/56672357/code-for-automatically-entering-date-time-stamp-into-cell-based-upon-table-headi", "title": "Code for automatically entering date/time stamp into cell based upon table heading", "body": "<p>I have a excel vba workflow to enter data into a table from a data input sheet (inputwks). This would be as follows:</p>\n\n<ol>\n<li>Press button, adds a new row to table.</li>\n<li>Enters time stamp into specific column header name \"Date/Time\" column. (column M in the code below)</li>\n<li>Enters input data from inputwks into specific table header name \"data record\" column. (shown as column 3 in the code below)</li>\n</ol>\n\n<p>I don't want to use column letters or numbers because I may change the order (e.g. date/time may look better to the user in column A instead of M.).</p>\n\n<p>How do I change the code below so the macro will search for \"date/Time\" columns instead of going to column M and the same for \"data record\"? </p>\n\n<p>Thank you for any help given.</p>\n\n<pre><code>Sub UpdateLogWorksheet()\n\n    'Dim historyWks As Worksheet\n    Dim ccarWks As Worksheet\n    Dim inputWks As Worksheet\n\n    Dim nextRow As Long\n    Dim oCol As Long\n    '======================Named range setup=========================\n    Dim myCopy As Range\n    Dim myTest As Range\n    Dim lRsp As Long\n    '=====================worksheet name setup=======================\n    Set inputWks = Worksheets(\"Input (Modded)\")     \n    Set ccarWks = Worksheets(\"CCAR - VB Template Ver2.0\")     \n    oCol = 3 \n      '===================Copy/paste data commands==================\n\n    Set myCopy = inputWks.Range(\"inputvalue\") \n    With ccarWks \n        nextRow = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Row\n    End With\n\n    With ccarWks \n       With .Cells(nextRow, \"M\") 'was \"A\"\n           .Value = Now\n           .NumberFormat = \"dd/mm/yyyy hh:mm:ss\" 'enter date and time stamp in record\n       End With\n\n       myCopy.Copy\n       .Cells(nextRow, 3).PasteSpecial Paste:=xlPasteValues, Transpose:=True \n       Application.CutCopyMode = False\n\n   End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 3, "last_activity_date": 1560964089, "creation_date": 1560964089, "answer_id": 56672786, "question_id": 56672321, "link": "https://stackoverflow.com/questions/56672321/finding-text-within-a-row-then-finding-text-within-that-column/56672786#56672786", "title": "Finding text within a row, then finding text within that column", "body": "<p>Change</p>\n\n<pre><code>If Not FinalMark.Column\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If Not Columns(FinalMark.Column)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11671707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4pxfz.jpg?s=128&g=1", "display_name": "gbear84", "link": "https://stackoverflow.com/users/11671707/gbear84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56672786, "answer_count": 1, "score": 2, "last_activity_date": 1564434199, "creation_date": 1560962222, "last_edit_date": 1564434199, "question_id": 56672321, "link": "https://stackoverflow.com/questions/56672321/finding-text-within-a-row-then-finding-text-within-that-column", "title": "Finding text within a row, then finding text within that column", "body": "<p>I'm trying to find a cell within a set row with a specific string (\"Final Mark\", then search the cells below that text. If that cell contains a specific piece of text (\"Fail\"), I then need a msgbox to pop-up.</p>\n\n<p>This is for a workbook that collects data on marked assignments. I've tried the below code, but it's not working.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim FinalMark As Range\n    Set FinalMark = Rows(5).Find(what:=\"Final Mark\", LookIn:=xlValues, lookat:=xlWhole)\n    If Not FinalMark Is Nothing Then\n    If Not FinalMark.Column.Find(what:=\"Fail\", LookIn:=xlValues, lookat:=xlWhole, MatchCase:=True) Is Nothing Then\n        MsgBox \"Input reason for fail in Further Notes.\", vbInformation\n    End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>I was hoping it would search the column where I found the text \"Final Mark\", but it doesn't.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1560965310, "post_id": 56672316, "comment_id": 99913324, "body": "yeah, it is possible, if the number of rows in both tables is different that means the formula in table 2 will not be consistent across the entire column, is that fine? which column of table 2 are you inserting the formula?"}, {"owner": {"reputation": 63, "user_id": 9642347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18beac8336e9407538e5eb4a44e50dd9?s=128&d=identicon&r=PG&f=1", "display_name": "chocolatekeyboard", "link": "https://stackoverflow.com/users/9642347/chocolatekeyboard"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1561119396, "post_id": 56672316, "comment_id": 99969802, "body": "So all the  new cells in table2 would require the formula, there are the same amount of columns in both. It would be the last cell reference (&quot;B13&quot;) that should change, e.g. in table 2 column A the formula would be for &quot;A13&quot;, then table2 column N it would be the same formula but &quot;N13&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 0, "last_activity_date": 1560967119, "creation_date": 1560967119, "answer_id": 56673425, "question_id": 56672316, "link": "https://stackoverflow.com/questions/56672316/how-to-use-relative-references-in-active-cell-formula/56673425#56673425", "title": "How to use relative references in active cell formula", "body": "<p>I was not sure about the position of your tables in the sheet and since in the formula you are using absolute addresses so I was able to guess which columns you were using to reference in the formula. As an example, this code will create a formula in the first column and last row of Table2 referencing the first column and last row of Table1 after it creates a new row in Table1 and Table2. You can adjust the formula as you want. There is only one caveat here that Excel will duplicate the formulas when you run the code for the first time since there is no formula in an empty column, if you delete the formula in other rows, it won't do that again when you run it for the second time.</p>\n\n<pre><code>Sub CreateFormula()\n    Dim indx1 As Integer 'index of the row added to table1\n    Dim indx2 As Integer 'index of the row added to table2\n\n    Dim loRow1 As ListRow 'table row that will be added in table1\n    Dim loRow2 As ListRow 'table row that will be added in table2\n\n    Dim tbl1 As ListObject\n    Dim tbl22 As ListObject\n\n    Dim cell1 As Range\n    Dim cell2 As Range\n\n    'define tables first\n    Set tbl1 = ActiveSheet.ListObjects(\"Table1\") 'Activesheet can be thisworkbook.worksheets(\"Sheet2\")\n    Set tbl2 = ActiveSheet.ListObjects(\"Table2\")\n\n    'Insert new rows\n    Set loRow1 = tbl1.ListRows.Add\n    Set loRow2 = tbl2.ListRows.Add\n\n    'get the index of the newly added rows\n    indx1 = loRow1.Index\n    indx2 = loRow2.Index\n\n    'indert the formula\n    Set cell1 = tbl1.DataBodyRange(indx1, 1) 'we will reference this in the formula\n    Set cell2 = tbl2.DataBodyRange(indx2, 1) 'we will put the formula in this cell\n\n    cell2.Formula = \"=if(\" &amp; cell1.Address &amp; \"&gt;0,\" &amp; \"1,0)\"\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9642347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18beac8336e9407538e5eb4a44e50dd9?s=128&d=identicon&r=PG&f=1", "display_name": "chocolatekeyboard", "link": "https://stackoverflow.com/users/9642347/chocolatekeyboard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560967119, "creation_date": 1560962191, "last_edit_date": 1560965742, "question_id": 56672316, "link": "https://stackoverflow.com/questions/56672316/how-to-use-relative-references-in-active-cell-formula", "title": "How to use relative references in active cell formula", "body": "<p>I am inserting a new table row button. It needs to add rows to two seperate tables. The formula in the second row needs to reference the row that was inserted in the other table.</p>\n\n<p>So I have tried the following for the second table row insert:</p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n\n'\n    Range(\"Table2\").Select\n    Selection.End(xlDown).Select\n    Selection.ListObject.ListRows.Add AlwaysInsert:=True\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.FormulaR1C1 = _\n        \"=IF(AND('Sheet2'!R[-452]C[10]&gt;=R1C4,'Sheet2'!R[-452]C[10]&lt;=R1C5),'Sheet2'!R[-452]C[-1],\"\"\"\")\"\n    Range(\"C481\").Select\nEnd Sub\n</code></pre>\n\n<p>So my formula is meant to add a row to table2 row 480, that has the formula referring to the new row added in sheet2 table1, which would be row 13 (currently).</p>\n\n<p>Is there a way to do this?\nCurrently I manually copy and paste the following formula in the cells:</p>\n\n<pre><code>=IF(AND('Sheet2'!$M13&gt;=$D$1,'Sheet2'!$M13&lt;=$E$1),'Sheet2'!B13,\"\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1560960381, "post_id": 56671863, "comment_id": 99911184, "body": "is each number in its own cell?"}, {"owner": {"reputation": 39, "user_id": 11671452, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1DwJkQHWhwg/AAAAAAAAAAI/AAAAAAAAALo/uH-6ab8ppSo/photo.jpg?sz=128", "display_name": "Meiji", "link": "https://stackoverflow.com/users/11671452/meiji"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1560960494, "post_id": 56671863, "comment_id": 99911241, "body": "Yes, also the numbers is on one column"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560960689, "post_id": 56671863, "comment_id": 99911335, "body": "What have you tried so far? Help us help you :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1560960738, "post_id": 56671863, "comment_id": 99911361, "body": "what is the logic behind your groupings? Why are 15 and 17 their own range? why is 11-12 only 2 items, but 1-3 and 5-7 are 3 items?"}, {"owner": {"reputation": 39, "user_id": 11671452, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1DwJkQHWhwg/AAAAAAAAAAI/AAAAAAAAALo/uH-6ab8ppSo/photo.jpg?sz=128", "display_name": "Meiji", "link": "https://stackoverflow.com/users/11671452/meiji"}, "edited": false, "score": 0, "creation_date": 1560961300, "post_id": 56671863, "comment_id": 99911587, "body": "I haven&#39;t tried anything because I can&#39;t think of any :(. The logic for the groupings is to eliminate the numbers that is not in the range. for example I have 10 document numbers that is all different, &quot;1001, 1002, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1019&quot; what I need is the from and to of these numbers so the output will be 1001 - 1002, 1004 - 1010, then 1019 the last number should be 1019 - 1019."}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1560962418, "last_edit_date": 1560962418, "creation_date": 1560962271, "answer_id": 56672335, "question_id": 56671863, "link": "https://stackoverflow.com/questions/56671863/is-there-a-formula-in-excel-or-vba-logic-to-sort-multiple-numbers-for-from-and-t/56672335#56672335", "title": "Is there a formula in excel or VBA logic to sort multiple numbers for from and to?", "body": "<p>There are probably cleaner ways but with this setup:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BDaqR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BDaqR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Formula in cell <code>D2</code>:</p>\n\n<pre><code>=IFERROR(SMALL(INDEX(A:A,MATCH(F1,$A$1:$A$10,0)+1):INDEX(A:A,MATCH(F2,$A$1:$A$10,0)),1),A1)\n</code></pre>\n\n<p>Formula in cell <code>F2</code> (<strong><em>enter through <kbd>Ctrl</kbd><kbd>Shift</kbd><kbd>Enter</kbd></em></strong>):</p>\n\n<pre><code>=INDEX($A$1:$A$10,SMALL(IF($A$2:$A$11-$A$1:$A$10&lt;&gt;1,ROW($A$1:$A$10),\"\"),ROW()-1))\n</code></pre>\n\n<p>Drag down till column F hits an error...</p>\n"}], "owner": {"reputation": 39, "user_id": 11671452, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1DwJkQHWhwg/AAAAAAAAAAI/AAAAAAAAALo/uH-6ab8ppSo/photo.jpg?sz=128", "display_name": "Meiji", "link": "https://stackoverflow.com/users/11671452/meiji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 56672335, "answer_count": 1, "score": -1, "last_activity_date": 1560962418, "creation_date": 1560960282, "last_edit_date": 1560961227, "question_id": 56671863, "link": "https://stackoverflow.com/questions/56671863/is-there-a-formula-in-excel-or-vba-logic-to-sort-multiple-numbers-for-from-and-t", "title": "Is there a formula in excel or VBA logic to sort multiple numbers for from and to?", "body": "<p>I'm trying to sort thousands of document numbers range from and to in excel. It would help me a lot if someone could help me create an excel formula or VBA logic in this problem. </p>\n\n<p>For example I have document numbers 1, 2, 3, 5, 6, 7, 11, 12, 15, 17. I want the output to be:</p>\n\n<p>from 1 to 3</p>\n\n<p>from 5 to 7</p>\n\n<p>from 11 to 12</p>\n\n<p>from 15 to 15</p>\n\n<p>from 17 to 17</p>\n\n<p>Thank you so much in advance!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1560961031, "post_id": 56671798, "comment_id": 99911472, "body": "The <code>If Len(...</code> line is doing too many things for this to be easily debuggable. Pull the <code>String</code> expression building the file name / path into its own local variable, then place a breakpoint (F9) on the <code>If Len(Dir(thatVariable, vbDirectory)) = 0 Then</code> line and validate the contents of that variable when the breakpoint is hit. Is the path on a network drive or a UNC path? Or is it local? I understand you might not want to show us the full path, but the type of path is relevant to the question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11035198"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1561021856, "post_id": 56671798, "comment_id": 99931026, "body": "@MathieuGuindon I created a string where NewString = &quot;file location&quot; &amp; [Combo1199] and then checked it in the VBA IDE, but the same error occurred. I believe it&#39;s a UNC path; the file location is in the form <code>&quot;\\\\networkdrive\\directory\\...\\directory\\&quot;</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11035198"}, "edited": false, "score": 0, "creation_date": 1561013323, "post_id": 56672724, "comment_id": 99926835, "body": "I do have access to the file, however the network drive has a different name. I know that the other computers on the network use the same network drive name as I do, so I don&#39;t know why it would only give an error on my computer. Also, I had been using VBA successfully up until getting this error and I don&#39;t see what would have changed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11035198"}, "edited": false, "score": 0, "creation_date": 1561014450, "post_id": 56672724, "comment_id": 99927350, "body": "I also ran <code>C:\\&gt; net use</code> in command prompt on my computer and another on the same network on which the VBA runs correctly and they show the same mapped network drives"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11035198"}, "edited": false, "score": 0, "creation_date": 1561024682, "post_id": 56672724, "comment_id": 99932578, "body": "Update: I pinged the network drive from the vba code, and it could not find the host. I did the same thing from a computer which was working, and unsurprisingly it worked fine, so I used the ip address and was able to ping that, so now just need to connect to the server"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1561056832, "post_id": 56672724, "comment_id": 99949785, "body": "@JonathanDyke Glad you were able to solve the problem!"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 3, "last_activity_date": 1560966410, "last_edit_date": 1560966410, "creation_date": 1560963855, "answer_id": 56672724, "question_id": 56671798, "link": "https://stackoverflow.com/questions/56671798/run-time-52-bad-file-name-or-number-error-on-one-network-system/56672724#56672724", "title": "Run-time 52 Bad file name or number error on one network system", "body": "<p>Amongst other possible reasons, in my experience, run-time error 52 can arise when a path is valid but inaccessible, for example, a mapped network drive for which the user has insufficient read permissions, or which cannot be accessed due to the target being offline.</p>\n\n<p>I would therefore suggest that you print the path represented by <code>\"file location\" &amp; [Combo1199]</code> to the Immediate Window (view this using <kbd>Ctrl</kbd>+<kbd>G</kbd> in the VBA IDE) using:</p>\n\n<pre><code>Debug.Print \"file location\" &amp; [Combo1199]\n</code></pre>\n\n<p>And then ensure that you can access this location 'manually' through File Explorer from the same PC, using the same user credentials that are active when the code runs.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11035198"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 0, "accepted_answer_id": 56672724, "answer_count": 1, "score": 2, "last_activity_date": 1594715477, "creation_date": 1560960034, "last_edit_date": 1594715477, "question_id": 56671798, "link": "https://stackoverflow.com/questions/56671798/run-time-52-bad-file-name-or-number-error-on-one-network-system", "title": "Run-time 52 Bad file name or number error on one network system", "body": "<p>I am receiving the Run-time error '52' bad file name or number error, however all of the questions which cover this on stackoverflow that I can see have answers which involve changing the code. The problem with this is that the code uses a directory in a network drive, and the error doesn't occur on other computers on the network.</p>\n\n<p>It is perhaps worth noting that my computer until recently did not have an activated version of windows due to a complication, however I assumed that to be the cause of the error but it is still occurring after activation.</p>\n\n<p>I have no experience with Microsoft Visual Basic and did not write the code so if you need any more information just ask.</p>\n\n<pre><code>Private Sub Command1769_Click()\nMe.Refresh\n\nIf Len(Dir(\"file location\" &amp; \n[Combo1199], vbDirectory)) = 0 Then\nMkDir \"file location\" &amp; \n[Combo1199]\nEnd If\n</code></pre>\n\n<p>I have replaced the name of the file location with 'file location' however I have checked and it is correct. The [Combo1199] is the name of a folder which is already present in the directory, and its date modified shows as being when the VBA code was run. The debug shows the problem as occurring on the If Len(... line</p>\n\n<p>EDIT SOLVED: For some reason the DNS servers weren't set to be found automatically so I wasn't connected to the applicable license server.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 11639881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01caa2982f2ba5cbcaea49ff22a2d622?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Data", "link": "https://stackoverflow.com/users/11639881/mr-data"}, "is_accepted": false, "score": 0, "last_activity_date": 1560960578, "creation_date": 1560960578, "answer_id": 56671932, "question_id": 56671768, "link": "https://stackoverflow.com/questions/56671768/how-to-browse-for-a-specific-cell-and-print-data-from-another-workbook-in-the-ce/56671932#56671932", "title": "How to browse for a specific cell and print data from another workbook in the cells below?", "body": "<p>How about:</p>\n\n<pre><code>iter = 1\na = ActiveWorkbook.Name\nYourValues &amp; iter = Workbooks(b).Cells(xxxx) 'Whatever the second workbook reference is and use a do loop to add more 'iter' values\nWorkbooks(a).Activate\nCells.Find(What:=\"2019-04\", After:=ActiveCell, LookIn:=xlFormulas,LookAt:=xlPark, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase = False, SearchFormat:=False).Activate\nn = 1 'or 2 or however far down below the value you want to place the new data\nx = ActiveCell.Column\ny = ActiveCell.Row\ncells(y + n, x) = YourValues(tier)\n</code></pre>\n\n<p>Then perhaps n+1, iter+1 inside a loop.</p>\n"}], "owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564509101, "creation_date": 1560959943, "last_edit_date": 1564509101, "question_id": 56671768, "link": "https://stackoverflow.com/questions/56671768/how-to-browse-for-a-specific-cell-and-print-data-from-another-workbook-in-the-ce", "title": "How to browse for a specific cell and print data from another workbook in the cells below?", "body": "<p>I am working on a VBA code where I input a date in the following form : YYYY-MM.\nI then want to find the cell that has this specific value in the excel sheet and copy data from another workbook in the same column. </p>\n\n<p>For example, if I enter \"2019-04\", I want to find the cell with this value and fill the column under it using data from the files I have specific to this date. </p>\n\n<p>I tried doing this with a for loop but haven't been able to do it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560959707, "post_id": 56671652, "comment_id": 99910858, "body": "I don&#39;t see any reasons why that should work in a version, but not another (thinking at anything 2010 and up). Try the standalone formula in a cell, and see if it works."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1560960077, "post_id": 56671652, "comment_id": 99911035, "body": "What about <code>;</code> =&gt; <code>,</code>? VBA doesn&#39;t know about regional settings. See <a href=\"https://stackoverflow.com/q/16584132/4996248\">this question</a>"}, {"owner": {"reputation": 81, "user_id": 7095552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc9a111db37d9b6ba48db91eb58664b?s=128&d=identicon&r=PG&f=1", "display_name": "K-Laboratory", "link": "https://stackoverflow.com/users/7095552/k-laboratory"}, "edited": false, "score": 0, "creation_date": 1560960561, "post_id": 56671652, "comment_id": 99911270, "body": "John Coleman: you are right, it is about the regional settings. The version 365 I tried use &quot;.&quot; as thousand separator and the version 2016 use &quot;,&quot; as thousand separator. When I change the code above, from &quot;;&quot; =&gt; &quot;,&quot; it works. How to make codes independent of regional settings in this case ?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1560960743, "post_id": 56671652, "comment_id": 99911366, "body": "<a href=\"https://stackoverflow.com/a/35724386/4996248\">This answer</a> provides some more details. Using a comma should be okay. What the end-user sees should reflect their regional settings. That said, this does seem one area where VBA is confusing."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 7095552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc9a111db37d9b6ba48db91eb58664b?s=128&d=identicon&r=PG&f=1", "display_name": "K-Laboratory", "link": "https://stackoverflow.com/users/7095552/k-laboratory"}, "is_accepted": false, "score": 0, "last_activity_date": 1560980240, "creation_date": 1560980240, "answer_id": 56676215, "question_id": 56671652, "link": "https://stackoverflow.com/questions/56671652/what-is-2016-version-of-this-code-run-time-error-5/56676215#56676215", "title": "What is 2016 version of this code ? (run-time error 5)", "body": "<p>I found a solution from another threat that to use FormulaLocal property. The code above to work with any Regional Settings look like this:</p>\n\n<pre><code>Public Sub CF()\n    Dim formula as String \n    formula = \"=ISNUMBER(SEARCH(\" &amp; Chr(34) &amp; \"Project Exec\" &amp; Chr(34) &amp; \",$A$20))\" \n    Range(\"A1\").Formula = formula     \n    formula = Range(\"A1\").FormulaLocal\n    With Range(\"K20:ZH20\").FormatConditions.Add(Type:=xlExpression, Formula1:=formula)\n        .Interior.Pattern = xlPatternLightUp\n    Range(\"A1\").ClearContents\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 7095552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc9a111db37d9b6ba48db91eb58664b?s=128&d=identicon&r=PG&f=1", "display_name": "K-Laboratory", "link": "https://stackoverflow.com/users/7095552/k-laboratory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560980240, "creation_date": 1560959467, "last_edit_date": 1560960906, "question_id": 56671652, "link": "https://stackoverflow.com/questions/56671652/what-is-2016-version-of-this-code-run-time-error-5", "title": "What is 2016 version of this code ? (run-time error 5)", "body": "<p>I have a small VBA code to create Conditional Formatting in Excel, It works well on Excel 365, but it generates \"Run-time error 5\" when trying in earlier versions of excel (eg. 2016). Could you please advise a fix to make it works on most versions ?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub CF()\n\n    With Range(\"K20:ZH20\").FormatConditions.Add(Type:=xlExpression, Formula1:=\"=ISNUMBER(SEARCH(\" &amp; Chr(34) &amp; \"Project Exec\" &amp; Chr(34) &amp; \";$A$20))\")\n        .Interior.Pattern = xlPatternLightUp\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n\n<hr>\n\n<p>After John Coleman comment, I found that it was about regional setting. It raise error because I tested on computer with difference setting. (the code showing above works for computer with \".\" as thousand separator and not work for computer use  \",\" as thousand separator. So the question now is how to make the code independent to regional settings ?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11511850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ee73589506715dca592aeee52a2cb7?s=128&d=identicon&r=PG&f=1", "display_name": "CryingOverVBA", "link": "https://stackoverflow.com/users/11511850/cryingovervba"}, "edited": false, "score": 0, "creation_date": 1560959009, "post_id": 56671456, "comment_id": 99910489, "body": "All this does for me is load a barren excel document. It doesn&#39;t even have a grid."}, {"owner": {"reputation": 35, "user_id": 11511850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ee73589506715dca592aeee52a2cb7?s=128&d=identicon&r=PG&f=1", "display_name": "CryingOverVBA", "link": "https://stackoverflow.com/users/11511850/cryingovervba"}, "edited": false, "score": 0, "creation_date": 1560959176, "post_id": 56671456, "comment_id": 99910581, "body": "I attached an imgur link to the result <a href=\"https://imgur.com/a/0HkeFwU\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 35, "user_id": 11511850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ee73589506715dca592aeee52a2cb7?s=128&d=identicon&r=PG&f=1", "display_name": "CryingOverVBA", "link": "https://stackoverflow.com/users/11511850/cryingovervba"}, "edited": false, "score": 0, "creation_date": 1560959872, "post_id": 56671456, "comment_id": 99910939, "body": "@CryingOverVBA that&#39;s not a &quot;barren excel document&quot;, it&#39;s the Excel application <i>without any document loaded</i>. Use <code>Xl.Workbooks.Open</code> to open a document, or <code>Xl.Workbooks.Add</code> to create one."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "reply_to_user": {"reputation": 35, "user_id": 11511850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ee73589506715dca592aeee52a2cb7?s=128&d=identicon&r=PG&f=1", "display_name": "CryingOverVBA", "link": "https://stackoverflow.com/users/11511850/cryingovervba"}, "edited": false, "score": 0, "creation_date": 1561015504, "post_id": 56671456, "comment_id": 99927836, "body": "@CryingOverVBA So I spend the time to answer your question and rather than given your response politely you moan that it doesn&#39;t do what you think it will do in a rude and aggressive manner.  Not really the way to get people on your side."}, {"owner": {"reputation": 35, "user_id": 11511850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ee73589506715dca592aeee52a2cb7?s=128&d=identicon&r=PG&f=1", "display_name": "CryingOverVBA", "link": "https://stackoverflow.com/users/11511850/cryingovervba"}, "edited": false, "score": 0, "creation_date": 1561034174, "post_id": 56671456, "comment_id": 99937738, "body": "@Gareth I wasn&#39;t trying to be rude or aggressive there, I myself don&#39;t see it phrased like that.   Although, apologies if it was perceived that way."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": false, "score": 1, "last_activity_date": 1560958835, "creation_date": 1560958835, "answer_id": 56671456, "question_id": 56671376, "link": "https://stackoverflow.com/questions/56671376/window-not-visible-despite-running-in-background/56671456#56671456", "title": "Window not visible despite running in background", "body": "<pre><code>Set Xl = CreateObject(\"Excel.Application\")\nXl.Visible=True\n</code></pre>\n\n<p>You don't need to put it immediately after creating the object, just before you set the object to Nothing.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1560960248, "creation_date": 1560960248, "answer_id": 56671854, "question_id": 56671376, "link": "https://stackoverflow.com/questions/56671376/window-not-visible-despite-running-in-background/56671854#56671854", "title": "Window not visible despite running in background", "body": "<pre><code>Set XlBook = GetObject(MySheetPath)\n</code></pre>\n\n<p>This is wrong. Don't use <code>GetObject</code> to open the workbook, use the <code>Excel.Application</code> instance you just created:</p>\n\n<pre><code>Set XlBook = Xl.Workbooks.Open(MySheetPath)\n</code></pre>\n\n<p>Later you iterate all opened workbooks:</p>\n\n<pre><code> For Each oWb In Workbooks\n</code></pre>\n\n<p>But that's not the <code>Workbooks</code> collection from the <code>Xl</code> application instance, it's the <code>Workbooks</code> collection from the instance that's currently running your code - you need to qualify it with the <code>Xl</code> object:</p>\n\n<pre><code>Private Sub ShowaWindow(ByVal app As Excel.Application, ByVal sFileName As String)\n    '...\n    For Each oWb In app.Workbooks\n</code></pre>\n\n<p>Also, <a href=\"https://stackoverflow.com/a/56671456/1188513\">make the app instance visible</a> after you created it, and don't forget to invoke <code>XlBook.Close</code> and <code>Xl.Quit</code> to properly tear down that EXCEL.EXE process when you're done.</p>\n"}], "owner": {"reputation": 35, "user_id": 11511850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ee73589506715dca592aeee52a2cb7?s=128&d=identicon&r=PG&f=1", "display_name": "CryingOverVBA", "link": "https://stackoverflow.com/users/11511850/cryingovervba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 56671854, "answer_count": 2, "score": 0, "last_activity_date": 1594715487, "creation_date": 1560958498, "last_edit_date": 1594715487, "question_id": 56671376, "link": "https://stackoverflow.com/questions/56671376/window-not-visible-despite-running-in-background", "title": "Window not visible despite running in background", "body": "<p>I have a macro that I'm trying to run through Access that will open up an excel sheet, do some actions on it, and then leave the sheet open.</p>\n\n<p>I have most of it working, with the exception of not being able to get my excel document to open visibly. If I check the task manager, an excel process is running in the background so something does happen, just nothing that I can physically see.</p>\n\n<p>I've attempted to sample some code found through stackoverflow and other resources, which I'm sure you'll see some of that in my current code. But I tried for about an hour with no avail. </p>\n\n<pre><code>Private Sub Command1_Click()\n\nDim fd As FileDialog\nDim MySheetPath As String\nDim Xl As Excel.Application\nDim XlBook As Excel.Workbook\nDim XlSheet As Excel.Worksheet\n\nOn Error GoTo ErrorHandler\n'allowing selection of the time\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\n\nfd.AllowMultiSelect = False\n\nIf fd.Show = True Then\n    If fd.SelectedItems(1) &lt;&gt; vbNullString Then\n        MySheetPath = fd.SelectedItems(1)\n    End If\nElse\n    End\nEnd If\n\nSet Xl = CreateObject(\"Excel.Application\")\nSet XlBook = GetObject(MySheetPath)\n\nShowaWindow (MySheetPath)\n\nSet XlSheet = XlBook.Worksheets(1)\n\nXlSheet.Rows(2).EntireRow.Insert\nXlSheet.Range(\"D2\") = \"ABC\"\n\nSet Xl = Nothing\nSet XlBook = Nothing\nSet XlSheet = Nothing\n\nExit Sub\n\nErrorHandler:\nSet fd = Nothing\nMsgBox \"Error \" &amp; Err &amp; \": \" &amp; Error(Err)\n\nEnd Sub\n\nSub ShowaWindow(sFileName As String)\nDim oWb As Workbook\n\nSet oWb = GetObject(sFileName)\n\nFor Each oWb In Workbooks\n    If LCase(oWb.Name) &lt;&gt; LCase(sFileName) Then\n        oWb.Windows(1).Visible = True\n        Exit For\n    End If\nNext\n\nEnd Sub\n\n</code></pre>\n\n<p>Ideally I would like to be able to see the worksheet appear.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560958706, "post_id": 56671311, "comment_id": 99910317, "body": "<code>If Target.Address &lt;&gt; &quot;$A$7&quot; Then Exit Sub</code>"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1560959553, "post_id": 56671311, "comment_id": 99910788, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/33114093/excel-hyperlink-to-nothing\">excel hyperlink to nothing</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11671354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160cdb3853f4485f619fe027fd4fda9d?s=128&d=identicon&r=PG&f=1", "display_name": "DFQuality", "link": "https://stackoverflow.com/users/11671354/dfquality"}, "edited": false, "score": 0, "creation_date": 1560963490, "post_id": 56671664, "comment_id": 99912501, "body": "My issue isn&#39;t with getting excel to recognize a particular cell, which I have been able to do with Worksheet_Change. But I need excel to then grab the contents of that cell which it has now identified."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 9, "user_id": 11671354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160cdb3853f4485f619fe027fd4fda9d?s=128&d=identicon&r=PG&f=1", "display_name": "DFQuality", "link": "https://stackoverflow.com/users/11671354/dfquality"}, "edited": false, "score": 0, "creation_date": 1560964921, "post_id": 56671664, "comment_id": 99913133, "body": "In the code above, the contents of that cell would be given by <code>Target.Value</code>, <code>Target.Value2</code> or <code>Target.Text</code>, depending on what you need."}, {"owner": {"reputation": 9, "user_id": 11671354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160cdb3853f4485f619fe027fd4fda9d?s=128&d=identicon&r=PG&f=1", "display_name": "DFQuality", "link": "https://stackoverflow.com/users/11671354/dfquality"}, "edited": false, "score": 0, "creation_date": 1560966468, "post_id": 56671664, "comment_id": 99913847, "body": "That did it! It&#39;s always something so simple. Thank you!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 9, "user_id": 11671354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160cdb3853f4485f619fe027fd4fda9d?s=128&d=identicon&r=PG&f=1", "display_name": "DFQuality", "link": "https://stackoverflow.com/users/11671354/dfquality"}, "edited": false, "score": 0, "creation_date": 1560967191, "post_id": 56671664, "comment_id": 99914195, "body": "Cheers. If this answers the question, do consider marking it as &quot;Accepted&quot;."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1560959511, "creation_date": 1560959511, "answer_id": 56671664, "question_id": 56671311, "link": "https://stackoverflow.com/questions/56671311/need-to-run-a-macro-based-on-unique-id-in-worksheet-cell/56671664#56671664", "title": "Need to run a macro based on unique ID in worksheet cell", "body": "<p>You can use the <code>BeforeDoubleClick</code> event of the Worksheet:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\nIf Target.Address &lt;&gt; \"$A$7\" Then Exit Sub\n' below, call the functions/subs that produce your output worksheet\nMsgBox \"You clicked on \" &amp; Target.Address\nEnd Sub\n</code></pre>\n\n<p>Above <em>only</em> works on cell A7. If you need this to apply to entire column A, modify slightly:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\nIf Intersect(Target, Range(\"A:A\")) Is Nothing Then Exit Sub\n' below, call the functions/subs that produce your output worksheet\nMsgBox \"You clicked on \" &amp; Target.Address\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11671354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160cdb3853f4485f619fe027fd4fda9d?s=128&d=identicon&r=PG&f=1", "display_name": "DFQuality", "link": "https://stackoverflow.com/users/11671354/dfquality"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560963354, "creation_date": 1560958304, "last_edit_date": 1560963354, "question_id": 56671311, "link": "https://stackoverflow.com/questions/56671311/need-to-run-a-macro-based-on-unique-id-in-worksheet-cell", "title": "Need to run a macro based on unique ID in worksheet cell", "body": "<p>Users will enter new information into a sheet using an userform. This information is tied to a unique ID given at time of entry (i.e. 2019-7 for the 7th item in this year). Currently, each piece of information is placed into separate cells in a row. I want to hide some of these cells but be able to allow users to click on the unique ID at the start of that row, which will run a macro that will create a new sheet to display all information in a user friendly way.</p>\n\n<p>I have tried creating a hyperlink to a run a macro but the code for identifying the hyperlink can't be cell specific. I need a more dynamic way to have excel recognize which ID was clicked and then use that to gather the rest of the information in that row (i.e. the hidden columns). </p>\n\n<p>My best option had been to put a private sub in the worksheet to recognize when a cell was changed/clicked but couldn't get past it just identifying the cell. I need it to then identify the contents of that cell, which would be the unique ID.</p>\n\n<p>I have no issues with creating a hyperlink to nothing, I just need excel to run a macro when a hyperlink is clicked and then within that macro, identify the unique ID and/or row that was clicked. Once I have the ID or Row identified, I then can go from there to grab the rest of the info in the other columns.</p>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560958301, "post_id": 56670970, "comment_id": 99910096, "body": "This might be a better question to ask on <a href=\"https://superuser.com/\">Super User</a> (please verify their posting rules first), since Stack Overflow is more focused on much more tangible programming problems."}], "answers": [{"tags": [], "owner": {"reputation": 7447, "user_id": 929187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F5QPL.png?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/929187/nikolay"}, "is_accepted": false, "score": 0, "last_activity_date": 1562786718, "creation_date": 1562786718, "answer_id": 56977393, "question_id": 56670970, "link": "https://stackoverflow.com/questions/56670970/can-you-limit-the-number-or-type-of-connections-between-shapes-in-visio/56977393#56977393", "title": "Can you limit the number or type of connections between shapes in Visio?", "body": "<p>In Visio, out of the box, generally speaking, you cannot prevent the user from drawing an incorrect diagram. But you can validate it afterward giving meaningful messages. It is pretty complex, you need to use specific formulas and other stuff. There is a good book from David Parker, discussing validation opportunities in Visio, \"Microsoft Visio 2013 Business Process Diagramming and Validation\".</p>\n\n<p>In some cases I think a code solution (such as custom Visio extension) could be easier to implement than some complex validation rules; you could consider going this direction as well. Visio extension has access to the drawing and can validate the diagram user draws in real time, responding to drawing actions and notifying the user on errors. But this basically means that you write a lot of custom code that integrates with Visio.</p>\n"}], "owner": {"reputation": 11, "user_id": 11671285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f98ec7f81212d587ca6db3eef07fb6?s=128&d=identicon&r=PG&f=1", "display_name": "audesapere", "link": "https://stackoverflow.com/users/11671285/audesapere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562786718, "creation_date": 1560957152, "question_id": 56670970, "link": "https://stackoverflow.com/questions/56670970/can-you-limit-the-number-or-type-of-connections-between-shapes-in-visio", "title": "Can you limit the number or type of connections between shapes in Visio?", "body": "<p>I would like to create custom shapes in Visio representing OEM connectors, and create rules about how they can be connected. </p>\n\n<p>For example, make it impossible to draw a male-to-male connection, or make it impossible to draw a connection between a 2-pin and a 4-pin connector. Is that possible in Visio?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1560962936, "creation_date": 1560962936, "answer_id": 56672498, "question_id": 56670866, "link": "https://stackoverflow.com/questions/56670866/how-to-capture-custom-button-click-event-in-outlook-from-excel/56672498#56672498", "title": "How to capture custom button click event in outlook from excel?", "body": "<p>It looks like you need to develop a COM add-in instead of VBA macro. First of all, you can't modify the Ribbon UI in Outlook from VBA macros as you do it in Excel. Second, VBA macros are not designed for distributing them on multiple machines. That is what COM add-ins were invented for. See <a href=\"https://docs.microsoft.com/en-us/visualstudio/vsto/walkthrough-creating-your-first-vsto-add-in-for-outlook?view=vs-2019\" rel=\"nofollow noreferrer\">Walkthrough: Create your first VSTO Add-in for Outlook</a> to get started quickly. </p>\n\n<p>The following articles provide instructions on how to create a custom ribbon UI:</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/visualstudio/vsto/walkthrough-creating-a-custom-tab-by-using-the-ribbon-designer?view=vs-2019\" rel=\"nofollow noreferrer\">Walkthrough: Create a custom tab by using the Ribbon Designer</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/visualstudio/vsto/walkthrough-creating-a-custom-tab-by-using-ribbon-xml?view=vs-2019\" rel=\"nofollow noreferrer\">Walkthrough: Create a custom tab by using Ribbon XML</a></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 11236380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae17d45f3128879c150eb2f7fe3e05c1?s=128&d=identicon&r=PG&f=1", "display_name": "matios94", "link": "https://stackoverflow.com/users/11236380/matios94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560962936, "creation_date": 1560956870, "question_id": 56670866, "link": "https://stackoverflow.com/questions/56670866/how-to-capture-custom-button-click-event-in-outlook-from-excel", "title": "How to capture custom button click event in outlook from excel?", "body": "<p>I'm trying to control Outlook via Excel by VBA ofc.</p>\n\n<p>My Excel code creates and XML that adds button to Message Ribbon.\nThe button's job is to save email to specific location given by Excel.\nI cant run Excel macro from Outlook macro because you cant access VB Project of Outlook. It needs to be provided for couple of persons and this is hard to deploy and control. So I thought maybe I can capture click event of that button from excel. I've seen examples to capture Reply button but nothing else.</p>\n\n<p>I'm looking for place in Outlook object where this information might be stored. And any help with that, different approaches are welcome as well.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1560956831, "post_id": 56670801, "comment_id": 99909075, "body": "Don&#39;t you need to add in the pattern options for this to work? e.g. <code>If ThisWorkbook.name Like &quot;*Export Checksheet*&quot; Then</code>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1560956886, "post_id": 56670801, "comment_id": 99909115, "body": "Yeah @Tom totally forgot about the <code>*</code>, edited the answer."}, {"owner": {"reputation": 61, "user_id": 8722088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c9ef770e41317c4226f284990871b6?s=128&d=identicon&r=PG", "display_name": "Tock", "link": "https://stackoverflow.com/users/8722088/tock"}, "edited": false, "score": 0, "creation_date": 1560957317, "post_id": 56670801, "comment_id": 99909414, "body": "The code&#39;s used in multiple workbooks that are sent to us using a template and (typically) contain this in the title. As a result we have to drop this code in personal.xlsb which makes <code>ThisWorkbook</code> return the title of personal.xlsb instead of the active workbook."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1560957461, "post_id": 56670801, "comment_id": 99909530, "body": "The code <code>Workbook_Open</code> triggers when you open a workbook... So the <code>ActiveWorkbook</code> and <code>ThisWorkbook</code> will be the same (excel focuses on the new workbook). To find out if you really have the workbook you need I&#39;d do a loop through all the workbooks and check if any of them is the one you need. But not on the <code>Workboook_Open</code> event but a normal macro in a button."}, {"owner": {"reputation": 61, "user_id": 8722088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c9ef770e41317c4226f284990871b6?s=128&d=identicon&r=PG", "display_name": "Tock", "link": "https://stackoverflow.com/users/8722088/tock"}, "edited": false, "score": 0, "creation_date": 1560958014, "post_id": 56670801, "comment_id": 99909916, "body": "I&#39;m not sure that&#39;s correct. The code&#39;s being run from personal.xlsb and not from the workbook we&#39;re actually editting, so ThisWorkbook returns information regarding THAT workbook, and not regarding the active one. I&#39;ve verified this several times because being able to use ThisWorkbook would solve my problem. Should the code be run from the same workbook, then yes they&#39;d return the same value."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1560958122, "post_id": 56670801, "comment_id": 99909989, "body": "I agree with you on the last part, but <code>Workbook_Open</code> will trigger ONLY when you open your personal.xlsb, when you open another workbook nothing will happen. That&#39;s what I mean."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1560958468, "post_id": 56670801, "comment_id": 99910198, "body": "<code>ThisWorkbook</code> will ALWAYS only ever refer to the document that&#39;s hosting the VBA project."}, {"owner": {"reputation": 61, "user_id": 8722088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c9ef770e41317c4226f284990871b6?s=128&d=identicon&r=PG", "display_name": "Tock", "link": "https://stackoverflow.com/users/8722088/tock"}, "edited": false, "score": 0, "creation_date": 1560959225, "post_id": 56670801, "comment_id": 99910613, "body": "personal.xlsb is automatically run alongside any other excel document that is opened. Since it&#39;s being opened with every workbook, <code>Workbook_Open</code> in personal.xlsb will run whenever you open any excel file."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 61, "user_id": 8722088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c9ef770e41317c4226f284990871b6?s=128&d=identicon&r=PG", "display_name": "Tock", "link": "https://stackoverflow.com/users/8722088/tock"}, "edited": false, "score": 0, "creation_date": 1560959328, "post_id": 56670801, "comment_id": 99910669, "body": "@Tock I&#39;ve written and used Excel add-ins, but I&#39;m not familiar with personal.xlsb mechanics. Clearly however, <code>ActiveWorkbook</code> is <code>Nothing</code> when it runs, and <code>ThisWorkbook</code> is the wrong object, so another approach is in order."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 61, "user_id": 8722088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c9ef770e41317c4226f284990871b6?s=128&d=identicon&r=PG", "display_name": "Tock", "link": "https://stackoverflow.com/users/8722088/tock"}, "edited": false, "score": 0, "creation_date": 1560959433, "post_id": 56670801, "comment_id": 99910721, "body": "Ooooook now, as Mathieu I had no idea about that. Try my edit @Tock this should work."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560959560, "post_id": 56670801, "comment_id": 99910791, "body": "Handling <code>WorkbookOpen</code> at application level seems a cleaner &amp; safer approach, since it gives you a reference to the <code>Workbook</code> object being opened. The loop will show the form 3 times if 3 workbooks were already opened &amp; matching the criteria, even when only 1 workbook was in the process of opening."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 2, "last_activity_date": 1560959410, "last_edit_date": 1560959410, "creation_date": 1560956665, "answer_id": 56670801, "question_id": 56670727, "link": "https://stackoverflow.com/questions/56670727/how-to-retrieve-filename-on-startup/56670801#56670801", "title": "How to retrieve filename on startup", "body": "<p>This will work:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Workbook_Open()\n\n    Dim wb As Workbook\n\n    For Each wb In Workbooks\n        If wb.name Like \"*Export Checksheet*\" Then\n            wb.Activate\n            Userform1.Show\n        End If\n    Next wb\n\nEnd Sub\n</code></pre>\n\n<p>Though I don't get why do you do this, why don't you write this code and the userform only on the workbook Export checksheet?</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 8722088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c9ef770e41317c4226f284990871b6?s=128&d=identicon&r=PG", "display_name": "Tock", "link": "https://stackoverflow.com/users/8722088/tock"}, "edited": false, "score": 0, "creation_date": 1560960389, "post_id": 56671540, "comment_id": 99911187, "body": "Don&#39;t fully understand that, but it worked. (though you forgot <code>ByVal</code> in <code>Private Sub app_WorkbookOpen(Wb As Workbook)</code> which was causing a problem). Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 61, "user_id": 8722088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c9ef770e41317c4226f284990871b6?s=128&d=identicon&r=PG", "display_name": "Tock", "link": "https://stackoverflow.com/users/8722088/tock"}, "edited": false, "score": 2, "creation_date": 1560960621, "post_id": 56671540, "comment_id": 99911306, "body": "@Tock Press F2 to bring up the <i>Object Browser</i>, then look for the <code>Application</code> class under the <code>Excel</code> library: you&#39;ll see a bunch of members have a little lightning bolt icon - these are <i>events</i> exposed at the <code>Application</code> level, and with a <code>WithEvents app As Excel.Application</code> object you can handle any of them. Now browse again and look for the <code>Workbook</code> class members - you&#39;ll see one of its events is the <code>Open</code> event: when you have a <code>Workbook_Open</code> procedure in a <code>Workbook</code> module, that&#39;s the event you&#39;re handling, and when you&#39;re in a <code>Workbook</code> module you can handle any of them too!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1560963291, "last_edit_date": 1560963291, "creation_date": 1560959067, "answer_id": 56671540, "question_id": 56670727, "link": "https://stackoverflow.com/questions/56670727/how-to-retrieve-filename-on-startup/56671540#56671540", "title": "How to retrieve filename on startup", "body": "<p>Looks like <code>ThisWorkbook</code> is loading <em>before</em> whatever other workbook you're opening, so <code>ActiveWorkbook</code> is <code>Nothing</code> and any member call against it will raise error 91.</p>\n\n<p>The <code>Workbook_Open</code> handler will only ever run for <code>ThisWorkbook</code> (the document that's hosting the VBA project) - what you need is to wire up another handler, at application level, so that you can run code whenever <em>any</em> workbook is opened.</p>\n\n<p>Change your <code>Workbook_Open</code> handler to capture a reference to the <code>Application</code> instance into a module-level <code>WithEvents</code> object variable:</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents app As Excel.Application\n\nPrivate Sub Workbook_Open()\n    Set app = Me.Application\nEnd Sub\n</code></pre>\n\n<p>Now select <code>app</code> from the left-hand dropdown, and create a handler for the <code>WorkbookOpen</code> event - <em>that</em> is where you'll want to verify whether you need to pop up that dialog:</p>\n\n<pre><code>Private Sub app_WorkbookOpen(ByVal Wb As Workbook)\n    If InStr(Wb.FullName, \"Export Checksheet\") &gt; 0 Then\n        With New UserForm1\n            .Show\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note that the application-wide event <em>provides</em> you with the <code>Workook</code> object, so you don't need to care whether it's the <code>ActiveWorkbook</code>.</p>\n"}], "owner": {"reputation": 61, "user_id": 8722088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c9ef770e41317c4226f284990871b6?s=128&d=identicon&r=PG", "display_name": "Tock", "link": "https://stackoverflow.com/users/8722088/tock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 56671540, "answer_count": 2, "score": 2, "last_activity_date": 1560963291, "creation_date": 1560956424, "question_id": 56670727, "link": "https://stackoverflow.com/questions/56670727/how-to-retrieve-filename-on-startup", "title": "How to retrieve filename on startup", "body": "<p>I'm attempting to conditionally launch a user form when excel opens based on the file's name. However, I believe that the code is running before the file fully launches, giving me an error.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim name As String\n    name = ActiveWorkbook.FullName\n    If InStr(name, \"Export Checksheet\") &gt; 0 Then\n        UserForm1.Show\n    End If\nEnd Sub\n</code></pre>\n\n<p>Testing this on a file that's already open runs fine, but trying to let it run naturally as the file opens causes a Run-time error '91' and points me at the line defining the <code>name</code> variable.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 8205652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0176cbc83d75820457addf210b5ebb60?s=128&d=identicon&r=PG&f=1", "display_name": "madmiddle", "link": "https://stackoverflow.com/users/8205652/madmiddle"}, "edited": false, "score": 0, "creation_date": 1560957981, "post_id": 56671120, "comment_id": 99909895, "body": "Can I change it to be dynamic to the selected day ?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 151, "user_id": 8205652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0176cbc83d75820457addf210b5ebb60?s=128&d=identicon&r=PG&f=1", "display_name": "madmiddle", "link": "https://stackoverflow.com/users/8205652/madmiddle"}, "edited": false, "score": 0, "creation_date": 1560958297, "post_id": 56671120, "comment_id": 99910095, "body": "You may check the <code>Explorer.Selection</code> property. But I don&#39;t think it will give you such information. Most probably you will have to use the <code>View</code> object (see the <code>CurrentView</code> property of the <code>Explorer</code> class)."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1560957615, "creation_date": 1560957615, "answer_id": 56671120, "question_id": 56670521, "link": "https://stackoverflow.com/questions/56670521/add-a-out-of-office-appointment-to-selected-day/56671120#56671120", "title": "add a out of office appointment to selected day", "body": "<p>Yes, it is possible. There are three ways of creating a new appointment item in Outlook. Read more about them in the <a href=\"https://www.add-in-express.com/creating-addins-blog/2011/11/04/outlook-create-appointment-item/\" rel=\"nofollow noreferrer\">How To: Create a new Outlook Appointment item</a> article.</p>\n\n<p>Looks like you just need to set the <code>Start</code> and <code>End</code> properties:</p>\n\n<pre><code>oAppt.Start = #7/7/2019 8:00:00 AM# \noAppt.End = #7/7/2019 11:00:00 AM# \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 8205652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0176cbc83d75820457addf210b5ebb60?s=128&d=identicon&r=PG&f=1", "display_name": "madmiddle", "link": "https://stackoverflow.com/users/8205652/madmiddle"}, "is_accepted": false, "score": 0, "last_activity_date": 1561114580, "creation_date": 1561114580, "answer_id": 56702063, "question_id": 56670521, "link": "https://stackoverflow.com/questions/56670521/add-a-out-of-office-appointment-to-selected-day/56702063#56702063", "title": "add a out of office appointment to selected day", "body": "<p>I've done it this way. not sure if it's the best way but it works:</p>\n\n<pre><code>Sub addSchoolRunToCalendar()\n    Dim datStart As Date\n    Dim datEnd As Date\n    Dim oView As Outlook.View\n    Dim oCalView As Outlook.CalendarView\n    Dim oExpl As Outlook.Explorer\n    Dim oFolder As Outlook.folder\n    Dim oAppt As Outlook.AppointmentItem\n    Const datNull As Date = #1/1/4501#\n\n    Set oExpl = Application.ActiveExplorer\n    Set oFolder = Application.ActiveExplorer.CurrentFolder\n    Set oView = oExpl.CurrentView\n\n    ' Check whether the active explorer is displaying a calendar view.\n    If oView.ViewType = olCalendarView Then\n        Set oCalView = oExpl.CurrentView\n\n        datStart = oCalView.SelectedStartTime\n        datStart = Format(datStart, \"dd/mm/yyyy\") &amp; \" \" &amp; Format(\"07:00\", \"hh:mm\")\n\n        Set oAppt = oFolder.Items.Add(\"IPM.Appointment\")\n        If datStart &lt;&gt; datNull And datEnd &lt;&gt; datNull Then\n            oAppt.Subject = \"School Run\"\n            oAppt.Location = \"Home\"\n            oAppt.BusyStatus = olOutOfOffice\n            oAppt.Start = datStart\n            oAppt.Duration = \"150\"\n            oAppt.ReminderSet = False\n        End If\n\n        oAppt.Save\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 8205652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0176cbc83d75820457addf210b5ebb60?s=128&d=identicon&r=PG&f=1", "display_name": "madmiddle", "link": "https://stackoverflow.com/users/8205652/madmiddle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561114580, "creation_date": 1560955757, "last_edit_date": 1560957436, "question_id": 56670521, "link": "https://stackoverflow.com/questions/56670521/add-a-out-of-office-appointment-to-selected-day", "title": "add a out of office appointment to selected day", "body": "<p>I know with VBA you can add appointments to the outlook calendar with a set date and time in the code but all I would like to do is add an appointment to my calendar between 7:00 and 9:30 on the selected day. Is it possible to use VBA for a selected day and make the status out of office as well?</p>\n\n<p>I have found the following code but this adds the event to the selected times and not a specific time on the selected day:</p>\n\n<pre><code>Sub CreateAppointmentUsingSelectedTime() \n    Dim datStart As Date \n    Dim datEnd As Date \n    Dim oView As Outlook.view \n    Dim oCalView As Outlook.CalendarView \n    Dim oExpl As Outlook.Explorer \n    Dim oFolder As Outlook.folder \n    Dim oAppt As Outlook.AppointmentItem \n    Const datNull As Date = #1/1/4501# \n\n    ' Obtain the calendar view using \n    ' Application.ActiveExplorer.CurrentFolder.CurrentView. \n    ' If you use oExpl.CurrentFolder.CurrentView, \n    ' this code will not operate as expected. \n    Set oExpl = Application.ActiveExplorer \n    Set oFolder = Application.ActiveExplorer.CurrentFolder \n    Set oView = oExpl.CurrentView \n\n    ' Check whether the active explorer is displaying a calendar view. \n    If oView.ViewType = olCalendarView Then \n        Set oCalView = oExpl.currentView \n        ' Create the appointment using the values in \n        ' the SelectedStartTime and SelectedEndTime properties as \n        ' appointment start and end times. \n        datStart = oCalView.SelectedStartTime \n        datEnd = oCalView.SelectedEndTime \n        Set oAppt = oFolder.items.Add(\"IPM.Appointment\") \n        If datStart &lt;&gt; datNull And datEnd &lt;&gt; datNull Then \n            oAppt.Start = datStart \n            oAppt.End = datEnd \n        End If \n        oAppt.Display \n    End If \nEnd Sub\n</code></pre>\n\n<p>cheers</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1560956844, "post_id": 56670498, "comment_id": 99909086, "body": "What does <code>Len(.body)</code> return? Shot in the dark, maybe try making that <code>Len(.body) - 1</code> or <code>Len(.body) - 2</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1561565243, "post_id": 56670498, "comment_id": 100109352, "body": "Have you had a chance to try the solutions below?"}, {"owner": {"reputation": 27, "user_id": 10698829, "user_type": "registered", "profile_image": "https://graph.facebook.com/2146242082108545/picture?type=large", "display_name": "Marek Re", "link": "https://stackoverflow.com/users/10698829/marek-re"}, "edited": false, "score": 0, "creation_date": 1561738685, "post_id": 56670498, "comment_id": 100174673, "body": "Thanks a lot for suggestions. I tried, but it gets blocked at a very beggining when declaring variables: &quot;Compile error: User-defined type not defined&quot;. For the first line (&quot;Dim objOutlook as outlook.Application&quot;)."}, {"owner": {"reputation": 27, "user_id": 10698829, "user_type": "registered", "profile_image": "https://graph.facebook.com/2146242082108545/picture?type=large", "display_name": "Marek Re", "link": "https://stackoverflow.com/users/10698829/marek-re"}, "edited": false, "score": 1, "creation_date": 1561746737, "post_id": 56670498, "comment_id": 100177741, "body": "Ok got it - i had to adjust settings. all good - works fantastic. thank you David!"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1560961959, "creation_date": 1560961959, "answer_id": 56672251, "question_id": 56670498, "link": "https://stackoverflow.com/questions/56670498/how-to-insert-a-table-after-body-of-e-mail-and-before-signature/56672251#56672251", "title": "How to insert a table after body of e-mail and before signature?", "body": "<p>You can use the following properties to customize the message body:</p>\n\n<ol>\n<li><p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow noreferrer\">Body</a> - a string representing the clear-text body of the Outlook item.</p></li>\n<li><p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow noreferrer\">HTMLBody</a> - a string representing the HTML body of the specified item.</p></li>\n<li><p>The Word Editor. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow noreferrer\">WordEditor</a> property of the <code>Inspector</code> class returns an instance of the Word Document which represents the message body. You can find all these ways described in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\">Chapter 17: Working with Item Bodies in MSDN</a>.</p></li>\n</ol>\n\n<p>The Outlook object model doesn't provide any property or method for detecting signatures. You parse the message body and try to find such places.</p>\n\n<p>However, when you create a signature in Outlook, three files (HTM, TXT and RTF) are created in the following folders:</p>\n\n<p><strong>Vista and Windows 7/8/10</strong>:</p>\n\n<pre><code> C:\\Users\\&lt;UserName&gt;\\AppData\\Roaming\\Microsoft\\Signatures\n</code></pre>\n\n<p><strong>Windows XP</strong>:</p>\n\n<pre><code>C:\\Documents and Settings\\&lt;UserName&gt;\\Application Data\\Microsoft\\Signatures\n</code></pre>\n\n<p><code>Application Data</code> and <code>AppData</code> are hidden folders, change the view in the Windows explorer so it shows hidden files and folders if you want to see the files.</p>\n\n<p>So, you read the content of these files and try to find the corresponding content in the message body. Note, users may type a custom signature in the end of emails.</p>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1560966315, "creation_date": 1560966315, "answer_id": 56673269, "question_id": 56670498, "link": "https://stackoverflow.com/questions/56670498/how-to-insert-a-table-after-body-of-e-mail-and-before-signature/56673269#56673269", "title": "How to insert a table after body of e-mail and before signature?", "body": "<p>Probably easiest to do this by creating an .oft (Outlook Email Template) with the message body and a placeholder for \"region\" and the table. Create the template without a signature, it will be added automatically per your Outlook user settings, later. I create a template like this, and save as .oft:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IxxWR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IxxWR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then simply create the new mailitem with <code>Set OutlookMailitem = OutlookApp.CreateItemFromTemplate({path to your template.oft})</code>, replace the \"region\" placeholder, and copy/paste the table to the table placeholder's location.</p>\n\n<pre><code>Option Explicit\n\nSub foo()\n\nDim objOutlook As Outlook.Application\nDim objMsg As Outlook.MailItem\nDim wdDoc As Word.Document\nDim tblRange As Word.Range\nDim region As String\n' define your Region, probably this is done in a loop...\nregion = \"Region 1\"\nSet objOutlook = CreateObject(\"Outlook.Application\")\n' Create email from the template file // UPDATE WITH YOUR TEMPLATE PATH\nSet objMsg = objOutlook.CreateItemFromTemplate(\"C:\\path\\to\\your\\template.oft\")\nobjMsg.Display\nSet wdDoc = objOutlook.ActiveInspector.WordEditor\n' replace placeholder with region:\nwdDoc.Range.Find.Execute \"{{REGION PLACEHOLDER}}\", ReplaceWith:=region\n' in my template, paragraph 5 is the table placeholder, modify as needed:\nSet tblRange = wdDoc.Range.Paragraphs(5).Range\ntblRange.Text = \"\"  ' remove the placeholder text\n' copy the Excel table // modify to refer to your correct table/range\nSheet1.ListObjects(1).Range.Copy\n' paste the table into the email\ntblRange.PasteExcelTable False, False, False\n\nEnd Sub\n</code></pre>\n\n<p>As you can see, the final email contains my default signature (which was <strong>not</strong> part of the template.oft file). </p>\n\n<p><a href=\"https://i.stack.imgur.com/wk8sF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wk8sF.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 10698829, "user_type": "registered", "profile_image": "https://graph.facebook.com/2146242082108545/picture?type=large", "display_name": "Marek Re", "link": "https://stackoverflow.com/users/10698829/marek-re"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 1, "accepted_answer_id": 56673269, "answer_count": 2, "score": 1, "last_activity_date": 1560966315, "creation_date": 1560955700, "question_id": 56670498, "link": "https://stackoverflow.com/questions/56670498/how-to-insert-a-table-after-body-of-e-mail-and-before-signature", "title": "How to insert a table after body of e-mail and before signature?", "body": "<p>I am using a below code that is pasting a table from excel to the outlook file. However, right now the table is pasted on the very bottom of the email - after the signature.</p>\n\n<p>What I would like to achieve is to have the table inserted after a word \"region.\" and before \"Regards\" - so before signature.</p>\n\n<pre><code>Dim FileExtStr As String\nDim FileFormatNum As Long\nDim Sourcewb As Workbook\nDim Destwb As Workbook\nDim sh As Worksheet\nDim DateString As String\nDim FolderName As String\nDim myOutlook As Object\nDim myMailItem As Object\nDim mySubject As String\nDim myPath As String\nDim i As Integer\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\n    .Calculation = xlCalculationManual\nEnd With\n\n'Prompt for Email Subject\n\nSet outlApp = CreateObject(\"Outlook.Application\")\nweeknumber = \"Week \" &amp; WorksheetFunction.WeekNum(Now, vbMonday)\n'mySubject = InputBox(\"Subject for Email\")\nFor i = 2 To 3\nregion = Sheets(\"Sheet1\").Cells(i, 5).Value\nmySubject = \"Overdue Milestones | \" &amp; weeknumber &amp; \" | \" &amp; region\n\n'Copy every sheet from the workbook with this macro\nSet Sourcewb = ActiveWorkbook\n'Create new folder to save the new files in\nDateString = Format(Now, \"yyyy-mm-dd hh-mm-ss\")\nFolderName = \"C:\\Users\\mxr0520\\Desktop\\Ignite Reports\\Milestones\\\" &amp; weeknumber\nIf i &lt; 3 Then\nMkDir FolderName\nElse\nEnd If\n'Copy every visible sheet to a new workbook\nSet sh = Sheets(region)\n    'If the sheet is visible then copy it to a new workbook\n    If sh.Visible = -1 Then\n        sh.Copy\n        'Set Destwb to the new workbook\n        Set Destwb = ActiveWorkbook\n        'Determine the Excel version and file extension/format\n        With Destwb\n            If Val(Application.Version) &lt; 12 Then\n                'You use Excel 97-2003\n                FileExtStr = \".xls\": FileFormatNum = -4143\n            Else\n                'You use Excel 2007-2016\n                If Sourcewb.Name = .Name Then\n                    MsgBox \"Your answer is NO in the security dialog\"\n                    GoTo GoToNextSheet\n                Else\n                    FileExtStr = \".xlsx\": FileFormatNum = 51\n                End If\n            End If\n        End With\n        'Change all cells in the worksheet to values if you want\n        If Destwb.Sheets(1).ProtectContents = False Then\n            With Destwb.Sheets(1).UsedRange\n                .Cells.Copy\n                .Cells.PasteSpecial xlPasteValues\n                .Cells(1).Select\n            End With\n            Application.CutCopyMode = False\n        End If\n        'Save the new workbook, email it, and close it\n        'Set otlNewMail = outlApp.CreateItem(myMailItem)\n\n        Set OutLookApp = CreateObject(\"Outlook.application\")\n        Set OutlookMailitem = OutLookApp.CreateItem(0)\n            With OutlookMailitem\n            .display\n            End With\n            Signature = OutlookMailitem.htmlbody\n\n        With Destwb\n            .SaveAs FolderName _\n                  &amp; \"\\\" &amp; Destwb.Sheets(1).Name &amp; FileExtStr, _\n                    FileFormat:=FileFormatNum\n        End With\n        myPath = ActiveWorkbook.path &amp; \"\\\" &amp; ActiveWorkbook.Name\n        With Destwb\n            .Close False\n        End With\n\n        With OutlookMailitem\n            .Subject = mySubject\n            .To = Sheets(\"Sheet1\").Cells(i, 6)\n            .CC = Sheets(\"Sheet1\").Cells(i, 7)\n            .htmlbody = \"Dear All,\" &amp; \"&lt;br&gt;\" _\n            &amp; \"&lt;br&gt;\" _\n            &amp; \"Attached please find the list of milestones that are &lt;b&gt;overdue&lt;/b&gt; and &lt;b&gt;due in 14 days&lt;/b&gt; for \" &amp; region &amp; \".\" &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; \"Regards,\" &amp; \"&lt;br&gt;\" _\n            &amp; \"Marek\" _\n            &amp; Signature\n            .Attachments.Add myPath\n\n    Worksheets(\"Summary\").Range(\"A1:E14\").Copy\n    Set vInspector = OutlookMailitem.GetInspector\n    Set weditor = vInspector.WordEditor\n\n    wEditor.Application.Selection.Start = Len(.body)\n    wEditor.Application.Selection.End = wEditor.Application.Selection.Start\n    wEditor.Application.Selection.Paste\n\n            .display\n\n        End With\n        Set OutlookMailitem = Nothing\n    End If\n</code></pre>\n\n<p>thank you for help in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 1, "creation_date": 1560955853, "post_id": 56669947, "comment_id": 99908497, "body": "Just create a new text file in the same location and close without writing anything.  Far easier."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 11333859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865914dce7401b66e7e458e3b8531181?s=128&d=identicon&r=PG&f=1", "display_name": "XDSSIOP", "link": "https://stackoverflow.com/users/11333859/xdssiop"}, "edited": false, "score": 0, "creation_date": 1560956924, "post_id": 56670545, "comment_id": 99909135, "body": "I don&#39;t want to delete it, I just want to delete the content so it&#39;s empty"}, {"owner": {"reputation": 395, "user_id": 9983057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSGuR.jpg?s=128&g=1", "display_name": "jun", "link": "https://stackoverflow.com/users/9983057/jun"}, "reply_to_user": {"reputation": 91, "user_id": 11333859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865914dce7401b66e7e458e3b8531181?s=128&d=identicon&r=PG&f=1", "display_name": "XDSSIOP", "link": "https://stackoverflow.com/users/11333859/xdssiop"}, "edited": false, "score": 0, "creation_date": 1560959450, "post_id": 56670545, "comment_id": 99910730, "body": "@XDSSIOP This clears the contents of the csv file. It does not delete the csv file itself. It leaves you with a blank csv file is what you are asking for, is it not?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1561047331, "post_id": 56670545, "comment_id": 99945608, "body": "This is the best approach."}], "tags": [], "owner": {"reputation": 395, "user_id": 9983057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSGuR.jpg?s=128&g=1", "display_name": "jun", "link": "https://stackoverflow.com/users/9983057/jun"}, "is_accepted": false, "score": 6, "last_activity_date": 1560955829, "creation_date": 1560955829, "answer_id": 56670545, "question_id": 56669947, "link": "https://stackoverflow.com/questions/56669947/how-to-delete-the-content-of-a-txt-file-with-vba/56670545#56670545", "title": "How to delete the content of a txt file with vba?", "body": "<pre><code>Sub ClearContents()\n\n    Open \"C:\\Users\\Username\\Desktop\\test1.csv\" For Output As #1: Close #1\n    MsgBox \"Clear complete\"\n\nEnd Sub\n</code></pre>\n\n<p>Just change the file path to where your csv file is.</p>\n"}], "owner": {"reputation": 91, "user_id": 11333859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865914dce7401b66e7e458e3b8531181?s=128&d=identicon&r=PG&f=1", "display_name": "XDSSIOP", "link": "https://stackoverflow.com/users/11333859/xdssiop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2733, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1564129918, "creation_date": 1560954034, "last_edit_date": 1564129918, "question_id": 56669947, "link": "https://stackoverflow.com/questions/56669947/how-to-delete-the-content-of-a-txt-file-with-vba", "title": "How to delete the content of a txt file with vba?", "body": "<p>I would like to make transactions with SAP, I use a csv file as an exported file, but in the end I would like to delete the content of this file without deleting the file itself. Just delete the content.</p>\n\n<pre><code>      Sub OpenCSVFile()\n       '\n       ' Load the CSV extract\n       '\n\n       '\n     With ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;\" &amp; fpath &amp; \"\\\" &amp; ffilename, Destination:=Range(\"$A$1\"))\n    .Name = \"text\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 850\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = True\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = False\n    .TextFileOtherDelimiter = \"|\"\n    .TextFileColumnDataTypes = Array(1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\n\n     End With\n\n\n     With ActiveSheet\n    .Columns(1).EntireColumn.Delete 'delete first column\n    .Rows(\"1:7\").EntireRow.Delete 'delete first 7 rows\n     End With\n\n     End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 2, "creation_date": 1560956112, "post_id": 56669809, "comment_id": 99908649, "body": "The first thing that strikes me is <code>Rows</code> will refer to the Active sheet.  Did you meant to use <code>.Rows</code> which will refer to the sheet you reference in with <code>With</code>?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1560962566, "post_id": 56669809, "comment_id": 99912112, "body": "@Gareth - Post it as an answer, I tested it and it seems to have worked."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11067911, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NIK_rwm5vAY/AAAAAAAAAAI/AAAAAAAAAII/GiVmt1JEbn0/photo.jpg?sz=128", "display_name": "Peter Turner", "link": "https://stackoverflow.com/users/11067911/peter-turner"}, "edited": false, "score": 0, "creation_date": 1561110407, "post_id": 56681461, "comment_id": 99965570, "body": "Hi Gareth, thanks very much for the distinction between Rows vs .Rows. Also with nesting the For Each inside the With and passing the sht variable as an argument in the doWork function."}, {"owner": {"reputation": 33, "user_id": 11067911, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NIK_rwm5vAY/AAAAAAAAAAI/AAAAAAAAAII/GiVmt1JEbn0/photo.jpg?sz=128", "display_name": "Peter Turner", "link": "https://stackoverflow.com/users/11067911/peter-turner"}, "edited": false, "score": 0, "creation_date": 1561111698, "post_id": 56681461, "comment_id": 99966220, "body": "Hi @gareth just tested. That works a treat! I get why things work with that code but baffled why when my original code was used it actually did loop over and over using Rows but constructing it a little different and using .Rows the duplication stops. If it was obvious why it looped originally you probably would&#39;ve explained and regardless I am very grateful for the solution."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": true, "score": 0, "last_activity_date": 1561017232, "creation_date": 1561017232, "answer_id": 56681461, "question_id": 56669809, "link": "https://stackoverflow.com/questions/56669809/for-each-next-statement-not-behaving-as-expected/56681461#56681461", "title": "For Each...Next statement not behaving as expected", "body": "<p><code>Rows</code> refers to the ActiveSheet.  To use the \"<code>With</code>\" sheet use <code>.Rows</code></p>\n\n<p>You are also making a bit of extra work for yourself by having the same code four times.  This means you have to make the same change in multiple places running the risk of errors.</p>\n\n<p>There are a few ways to solve this but a simple sub is the easiest in this case.</p>\n\n<pre><code>Private Sub CopyRows()\n    ScreenUpdating = False\n\n    doWork Sheets(\"QChecklist1\")\n    doWork Sheets(\"QChecklist2\")\n    doWork Sheets(\"QChecklist3\")\n    doWork Sheets(\"QChecklist4\")\n\n    Sheets(\"QAnalysisForm\").Activate\n    Cells(1, 1).Select\n\n    On Error Resume Next\n\n    ScreenUpdating = True\nEnd Sub\n\nPrivate Sub doWork(sht As Worksheet)\n    Dim cel2 As Range\n    With sht\n        For Each Cell In .Range(\"E8:E30\")\n            If Cell.Value = \"a\" Then\n                Set cel2 = Sheets(\"QAnalysisForm\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1)\n                .Rows(Cell.Row).Resize(, 10).Offset(, 1).Copy cel2\n                cel2.Value = cel2.Value\n                Set cel2 = Nothing\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11067911, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NIK_rwm5vAY/AAAAAAAAAAI/AAAAAAAAAII/GiVmt1JEbn0/photo.jpg?sz=128", "display_name": "Peter Turner", "link": "https://stackoverflow.com/users/11067911/peter-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56681461, "answer_count": 1, "score": 1, "last_activity_date": 1561017232, "creation_date": 1560953621, "last_edit_date": 1560954636, "question_id": 56669809, "link": "https://stackoverflow.com/questions/56669809/for-each-next-statement-not-behaving-as-expected", "title": "For Each...Next statement not behaving as expected", "body": "<p>I have several worksheets with various financial quotes on certain rows with up to four of these rows containing a tick (Marlett font letter 'a' trick). My VBA code is meant to identify the ticked rows and transfer these rows only to another summary worksheet. </p>\n\n<p>The problem is that my code is looping through the range and copying rows but not always the ticked ones and often duplicating them. It is hard to summarise concisely and is better to open up the excel workbook with some data in place (which I have anonymised so as not to disclose any personal data). </p>\n\n<p>I have been helped with simplifying my original code on this forum and it is that poster's code I have pasted below (which I am very grateful for too btw!).</p>\n\n<pre><code>Private Sub CopyRows()\n\nDim cel2 As Range\n\nScreenUpdating = False\n\nWith Sheets(\"QChecklist1\")\n    For Each Cell In .Range(\"E8:E30\")\n        If Cell.Value = \"a\" Then\n            Set cel2 = Sheets(\"QAnalysisForm\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1)\n            Rows(Cell.Row).Resize(, 10).Offset(, 1).Copy cel2\n            cel2.Value = cel2.Value\n            Set cel2 = Nothing\n        End If\n    Next\nEnd With\n\nWith Sheets(\"QChecklist2\")\n    For Each Cell In .Range(\"E8:E30\")\n        If Cell.Value = \"a\" Then\n            Set cel2 = Sheets(\"QAnalysisForm\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1)\n            Rows(Cell.Row).Resize(, 10).Offset(, 1).Copy cel2\n            cel2.Value = cel2.Value\n            Set cel2 = Nothing\n        End If\n    Next\nEnd With\n\nWith Sheets(\"QChecklist3\")\n    For Each Cell In .Range(\"E8:E30\")\n        If Cell.Value = \"a\" Then\n            Set cel2 = Sheets(\"QAnalysisForm\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1)\n            Rows(Cell.Row).Resize(, 10).Offset(, 1).Copy cel2\n            cel2.Value = cel2.Value\n            Set cel2 = Nothing\n        End If\n    Next\nEnd With\n\nWith Sheets(\"QChecklist4\")\n    For Each Cell In .Range(\"E8:E30\")\n        If Cell.Value = \"a\" Then\n            Set cel2 = Sheets(\"QAnalysisForm\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1)\n            Rows(Cell.Row).Resize(, 10).Offset(, 1).Copy cel2\n            cel2.Value = cel2.Value\n            Set cel2 = Nothing\n        End If\n    Next\nEnd With\n\nSheets(\"QAnalysisForm\").Activate\ncells(1, 1).Select\n\nOn Error Resume Next\n\n\nScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I was expecting this code to search through each range on each \n'QChecklist' worksheet looking for 'ticked' rows (which are Marlett font \na's) and copy and paste it to the QAnalysisForm worksheet. </p>\n\n<p>What actually happens I will upload an image of but essentially:</p>\n\n<p>It finds (in the case of QChecklist1) the four ticked rows, then repeats \nthe second and fourth one, then repeats the entire four rows twice more! \nIn total I get 14 rows instead of the 4 desired! On other QChecklist \nworksheets (i.e. QChecklists 2, 3 &amp; 4 that I have coded for) I get \nsimilar patterns of repeating.</p>\n\n<p>I also expected to have the ticked rows transferred from all QChecklist \nworksheets into the one QAnalysis (summary of best quotes) worksheet but \ninstead the code only lifts the rows from the worksheet that contains the \nmacro command button. I can live with it needing to be fired on each worksheet seperately as mostly there is only one or two worksheets normally but in my sample test case there are four seperate worksheets.</p>\n\n<p>Image of Repeating Rows Link: <a href=\"https://www.dropbox.com/s/rltdbjcui3q6843/Image%20of%20Repeating%20Rows.png?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/rltdbjcui3q6843/Image%20of%20Repeating%20Rows.png?dl=0</a> </p>\n\n<p>Excel Workbook containing Quotation Analysis Worksheets:\n<a href=\"https://www.dropbox.com/s/3bxxxs54cruyqi2/QuotationAnalysisSystemBeta.xlsm?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/3bxxxs54cruyqi2/QuotationAnalysisSystemBeta.xlsm?dl=0</a></p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "edited": false, "score": 0, "creation_date": 1560954687, "post_id": 56669744, "comment_id": 99907728, "body": "Could you <a href=\"https://stackoverflow.com/posts/56669744/edit\">edit</a> your question to include an example of what you have tried so far?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1560955720, "post_id": 56669744, "comment_id": 99908403, "body": "<a href=\"https://stackoverflow.com/questions/47288496/are-there-disadvantages-in-putting-code-into-userforms-instead-of-modules/47291028#47291028\">Relevant</a> - if you separate the <i>data</i> from the form code, and encapsulate this data in its own &quot;model&quot; class, you can have a <code>Public Function Create(ByVal model As ColumnState) As Hider</code> <i>factory method</i> in the form - then instead of <code>Hider.Show</code> you would have <code>With Hider.Create(myModel)</code> ...<code>.Show</code>... <code>End With</code>, where <code>myModel</code> holds the &quot;hidden state&quot; for each column, and the <code>Activate</code> handler can initialize control values from model properties."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1560955793, "post_id": 56669744, "comment_id": 99908452, "body": "Or just treat everything as global, and have the form pull the data where it&#39;s at in the <code>Initialize</code> or <code>Activate</code> handler, like below."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1561033663, "post_id": 56669744, "comment_id": 99937441, "body": "FYI In addition to Mathieu&#39;s valid comment how to professionalize <i>(Userform)</i> coding applying <i>MVP (Model-Viewer-Presenter)</i> pattern logic to VBA, you could find further readings listed at an article how to <a href=\"https://stackoverflow.com/questions/47357708/vba-destroy-a-modeless-userform-instance-properly\">Destroy a modeless Userform instance properly</a>."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1560955828, "post_id": 56670438, "comment_id": 99908480, "body": "Simpler: <code>Me.Week3.Value = ActiveSheet.Range(&quot;N:Q&quot;).Columns.Hidden</code>  - no need to compare a Boolean expression with a Boolean"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560956239, "post_id": 56670438, "comment_id": 99908732, "body": "@MathieuGuindon - Edited answer due to your comment, adding just the negation particle <code>Not</code> :-)"}, {"owner": {"reputation": 13, "user_id": 11670838, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6Et7KyOLOY8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4d5dxHFexumMc1NQX1qtFGTdcsQ/mo/photo.jpg?sz=128", "display_name": "Robin Walter", "link": "https://stackoverflow.com/users/11670838/robin-walter"}, "edited": false, "score": 0, "creation_date": 1561011745, "post_id": 56670438, "comment_id": 99926163, "body": "This answer worked! However it wouldn&#39;t sync automatically when opening the userform for some reason, but after creating an &#39;sync&#39; button it works perfectly."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1561032166, "post_id": 56670438, "comment_id": 99936523, "body": "Glad my answer helped. BTW Suggest to fully qualify your range references as a rule, e.g. via <code>ThisWorkbook.Worksheets(&quot;MySheetName&quot;).Range(&quot;N:Q&quot;).Columns.&zwnj;&#8203;Hidden</code> or via the sheet&#39;s codename (e.g. <code>Sheet1.Range(\u2026)\u2026</code>"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1560956155, "last_edit_date": 1560956155, "creation_date": 1560955523, "answer_id": 56670438, "question_id": 56669744, "link": "https://stackoverflow.com/questions/56669744/excel-vba-userform-read-current-values-when-opening/56670438#56670438", "title": "Excel VBA Userform read current values when opening", "body": "<p>If I understand your question correctly (\"...or an action to read all the current values when opening the userform\") just use the following code within the Userform code module to synchronize your checkbox when opening: </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n'Me.Week3.Value = IIf(ActiveSheet.Range(\"N:Q\").Columns.Hidden = True, False, True)\nMe.Week3.Value = Not ActiveSheet.Range(\"N:Q\").Columns.Hidden  ' simplified due to comment thx Mathieu Guindon\n\n' ...\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11670838, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6Et7KyOLOY8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4d5dxHFexumMc1NQX1qtFGTdcsQ/mo/photo.jpg?sz=128", "display_name": "Robin Walter", "link": "https://stackoverflow.com/users/11670838/robin-walter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 56670438, "answer_count": 1, "score": 1, "last_activity_date": 1560956155, "creation_date": 1560953412, "last_edit_date": 1560953855, "question_id": 56669744, "link": "https://stackoverflow.com/questions/56669744/excel-vba-userform-read-current-values-when-opening", "title": "Excel VBA Userform read current values when opening", "body": "<p>I am trying to make an user form for hiding/showing different columns of the worksheet.</p>\n\n<p>So i've made a button which opens the userform (called 'hider') with the following code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nHider.Show\nEnd Sub\n</code></pre>\n\n<p>The userform than currently contains two checkboxes which hide the selected columns using:</p>\n\n<pre><code>Private Sub Week3_Click()\nRange(\"N:Q\").Columns.Hidden = Not Week3\nEnd Sub\n</code></pre>\n\n<p>So if the checkbox is 'checked' the columns are shown and if  'unchecked' the columns are hidden, this part works, except every time the userform opens it will reset the checkboxes to their native state of 'unchecked' while the columns remain hidden (which is ok).</p>\n\n<p><strong>So my question is:</strong></p>\n\n<p>How can I sync the checkboxes in the userform to the currently active value of the columns? I was thinking about making a sync button on the userform or an action to read all the current values when opening the userform, but i couldn't get that to work.</p>\n"}, {"tags": ["arrays", "excel", "vba", "paste", "transpose"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1560953816, "post_id": 56669593, "comment_id": 99907196, "body": "What are the values of <code>LBound(conceptArray, 1)</code> and <code>LBound(conceptArray, 2)</code> ?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1560953932, "post_id": 56669593, "comment_id": 99907255, "body": "What is type and content of <code>conceptArray</code>?"}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1560954916, "post_id": 56669593, "comment_id": 99907868, "body": "LBound(conceptArray, 1) =1"}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1560954972, "post_id": 56669593, "comment_id": 99907895, "body": "LBound(conceptArray, 2)=0"}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1560954992, "post_id": 56669593, "comment_id": 99907915, "body": "conceptarray contains text"}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1560955108, "post_id": 56669593, "comment_id": 99907983, "body": "tricky that  Lbound(1) &lt;&gt; Lbound(2) so I tried this: ReDim conceptArray(1 To 5, 1 To NumberOfConcepts + 1)     &gt;&gt;&gt;&gt; same error"}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1560955304, "post_id": 56669593, "comment_id": 99908106, "body": "This also works:  firstcellofTbl.Resize(UBound(conceptArray, 2), UBound(conceptArray, 1)).Select"}], "answers": [{"comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1560958967, "post_id": 56671165, "comment_id": 99910454, "body": "This can only be half of the truth, you can use variants to write into cells - except if you put something into one of the members that is somehow not valid. Anyhow, good to know that it works now - but if I where you I would try to figure out which value(s) caused this issue."}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1560974674, "post_id": 56671165, "comment_id": 99917467, "body": "i will try to find out if that is the case with an small example."}], "tags": [], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "is_accepted": true, "score": 0, "last_activity_date": 1560957786, "creation_date": 1560957786, "answer_id": 56671165, "question_id": 56669593, "link": "https://stackoverflow.com/questions/56669593/excel-pasting-array-in-cell-after-resizing-cell-to-array-dimensions/56671165#56671165", "title": "Excel pasting array in cell (after resizing cell to array dimensions)", "body": "<p>The problem was that the array was dimensioned as variant.</p>\n\n<p>original:</p>\n\n<pre><code>dim conceptarray() as variant\n</code></pre>\n\n<p>solution:</p>\n\n<pre><code>dim conceptarray() as string\n</code></pre>\n"}], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56671165, "answer_count": 1, "score": 0, "last_activity_date": 1560957786, "creation_date": 1560953055, "last_edit_date": 1560953662, "question_id": 56669593, "link": "https://stackoverflow.com/questions/56669593/excel-pasting-array-in-cell-after-resizing-cell-to-array-dimensions", "title": "Excel pasting array in cell (after resizing cell to array dimensions)", "body": "<p>I want to paste a two-dimension array from one cell on, extending the range with RESIZE() to the exact size of the array.</p>\n\n<p>I get a \nrun error type 13\ntype mismatch</p>\n\n<pre><code>ReDim conceptArray(1 To 5, NumberOfConcepts + 1)\n\n\nDim firstcellofTbl As range\n    Set firstcellofTbl = qbaTbl.ListColumns(\"name\").range.iTem(1).Offset(1, 0)\n' this is just a test:\n'firstcelloftbl is a single cell\nfirstcellofTbl.Select\n\n\nfirstcellofTbl.Resize(UBound(conceptArray, 2), UBound(conceptArray, 1)) = Application.Transpose(conceptArray)\n</code></pre>\n\n<p>whatever the size of the array is some things I give for granted.\na) firstcellofTbl is just one cell. And exists since the selection works.</p>\n\n<p>the resize size has the same dimensions as the array because it is just resize to the dimensions of the array</p>\n\n<p>c) the resize interchanged both dimensions, therefore the application.transpose</p>\n\n<p>this is the bit of code I added to make tests:</p>\n\n<pre><code> MsgBox UBound(conceptArray, 1)\n MsgBox UBound(conceptArray, 2)\n Dim newrange As range\n    Set newrange = firstcellofTbl.Resize(UBound(conceptArray, 2), UBound(conceptArray, 1))\nMsgBox newrange.address\n</code></pre>\n\n<p>being: \n    UBound(conceptArray, 1)=5\n    UBound(conceptArray, 2)=439</p>\n\n<pre><code>newrange.address =$a$3:$E$441\n</code></pre>\n\n<p>which seems to match since the size of the new range is the same as the transpose array</p>\n\n<p>What I am possibly doing wrong?\nThanks a lot</p>\n\n<p>Note:\nusing this way of pasting data into a listobject (or a sheet) is millions times faster than populating with for-loop, thats the reason for using it.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 0, "last_activity_date": 1560951300, "creation_date": 1560951300, "answer_id": 56668978, "question_id": 56668807, "link": "https://stackoverflow.com/questions/56668807/how-to-launch-a-macro-on-outlook-2-minutes-after-outlook-is-open/56668978#56668978", "title": "how to launch a macro on Outlook, 2 minutes after outlook is open", "body": "<p>You could use this solution from fmsinc. My prefred piece of code to do this.</p>\n\n<pre><code>Public Sub WaitSeconds(intSeconds As Integer)\n  ' Comments: Waits for a specified number of seconds\n  ' Params  : intSeconds      Number of seconds to wait\n  ' Source  : Total Visual SourceBook\n  ' Source  : http://www.fmsinc.com/microsoftaccess/modules/examples/avoiddoevents.asp\nPrivate Declare Sub Sleep Lib \"kernel32\" (ByVal lngMilliSeconds As Long)\n  On Error GoTo PROC_ERR\n\n  Dim datTime As Date\n\n  datTime = DateAdd(\"s\", intSeconds, Now)\n\n  Do\n   ' Yield to other programs (better than using DoEvents which eats up all the CPU cycles)\n    Sleep 100\n    DoEvents\n  Loop Until Now &gt;= datTime\n\nPROC_EXIT:\n  Exit Sub\n\nPROC_ERR:\n  MsgBox \"Error: \" &amp; Err.Number &amp; \". \" &amp; Err.Description, , \"modDateTime.WaitSeconds\"\n  Resume PROC_EXIT\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1560971181, "post_id": 56671237, "comment_id": 99915986, "body": "Please edit your question and put everything there and not as separate answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 10727260, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kS68-pXk2Eo/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jkcl6viw-DM6dEM7rTnJjMh_Q0iQ/mo/photo.jpg?sz=128", "display_name": "Devran", "link": "https://stackoverflow.com/users/10727260/devran"}, "is_accepted": false, "score": -1, "last_activity_date": 1560958075, "creation_date": 1560958075, "answer_id": 56671237, "question_id": 56668807, "link": "https://stackoverflow.com/questions/56668807/how-to-launch-a-macro-on-outlook-2-minutes-after-outlook-is-open/56671237#56671237", "title": "how to launch a macro on Outlook, 2 minutes after outlook is open", "body": "<p>At the opening of Outlook, I have a code that will launch a macro on excel,</p>\n\n<pre><code>  Private Sub Application_Startup()\nDim ExApp As Excel.Application\n Dim ExWbk As Workbook\n Set ExApp = New Excel.Application\n Set ExWbk = ExApp.Workbooks.Open(\"C:\\Users\\z003zj4s\\Desktop\\MICHEL PACQUET\\Nouveau dossier\\MichelPaquet.xlsm\")\n ExApp.Visible = False\n ExWbk.Application.Run \"Module1.TEST1\"\n ExWbk.Close SaveChanges:=True\nEnd Sub\n</code></pre>\n\n<p>the macro that was launched on excel is actually sending mail with outlook </p>\n\n<pre><code>Sub TEST1()\n    Dim Plage_de_recherche As Range ' correspond \u00e0 la plage de recherche\n    Dim Valeur_cherch\u00e9e As String ' correspond \u00e0 ce que l'on cherche\n    Dim Trouv\u00e9 As Range ' c'est le r\u00e9sultat de la recherche\n    Dim La_colonne As Integer ' colonne du mois o\u00f9 il y a \"ok\"\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim strbody As String\n\n\n    Valeur_cherch\u00e9e = \"ORANGE\" 'd\u00e9finition de ce que l'on cherche\n    Set Plage_de_recherche = Sheets(\"Feuil1\").Range(\"J2:J58\") ' d\u00e9finition de la plage de recherche\n    Set Trouv\u00e9 = Plage_de_recherche.Find(what:=Valeur_cherch\u00e9e, LookIn:=xlValues) ' on effectue la recherche : xlvalues car ok est le r\u00e9sultat d'une formule\n    If Trouv\u00e9 Is Nothing Then ' si Trouv\u00e9 = rien c'est qu'on a rien trouv\u00e9...\n        ' ce qu'il y a \u00e0 faire si on ne trouve pas \"OK\"\n    Else\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    strbody = \"Bonjour Michel,\" &amp; vbCrLf &amp; _\n    \" \" &amp; vbCrLf &amp; _\n    \"La date de p\u00e9remption de certain documents approche,\" &amp; vbCrLf &amp; _\n    \"V\u00e9rifiez si une nouvelle version \u00e0 \u00e9t\u00e9 mise en ligne.\" &amp; vbCrLf &amp; \" \" &amp; vbCrLf &amp; _\n    \"Cordialement,\" &amp; vbCrLf &amp; _\n    \"Excel\"\n\n    On Error Resume Next\n    With OutMail\n        .To = \"armand.akdogan@siemens.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"MISE A JOUR DES DOCUMENTS\"\n        .Body = strbody\n        'You can add a file like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Send\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n        ' ce qu'il faut faire si on trouve\n    End If\nEnd Sub\n</code></pre>\n\n<p>Suddenly the macro blocks because Outlook is not open yet and give this</p>\n\n<p>\u201cRun-time error \u2018429\u2019: ActiveX component can\u2019t create object.\u201d</p>\n"}], "owner": {"reputation": 1, "user_id": 10727260, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kS68-pXk2Eo/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jkcl6viw-DM6dEM7rTnJjMh_Q0iQ/mo/photo.jpg?sz=128", "display_name": "Devran", "link": "https://stackoverflow.com/users/10727260/devran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1560958075, "creation_date": 1560950859, "question_id": 56668807, "link": "https://stackoverflow.com/questions/56668807/how-to-launch-a-macro-on-outlook-2-minutes-after-outlook-is-open", "title": "how to launch a macro on Outlook, 2 minutes after outlook is open", "body": "<p>I would like to run my macro 5 minutes after Outlook has been opened</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1560950496, "post_id": 56668627, "comment_id": 99905080, "body": "Please include all the code in this subroutine, not just the line it fails on. It sounds like you are locking the H column and then trying to make a change to it."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1560950562, "post_id": 56668627, "comment_id": 99905112, "body": "You will most likely need to unlock the sheet and then relock it in order to make the change using VBA."}, {"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "edited": false, "score": 0, "creation_date": 1560950651, "post_id": 56668627, "comment_id": 99905165, "body": "Try to use the <code>Autofit</code> method first and <i>then</i> lock the H column. Moreover, the Title of your Q doesn&#39;t reflect on your actual question."}, {"owner": {"reputation": 526, "user_id": 11054439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27604a9c671e93fd6dfeff5670fbd370?s=128&d=identicon&r=PG&f=1", "display_name": "jvargas", "link": "https://stackoverflow.com/users/11054439/jvargas"}, "edited": false, "score": 0, "creation_date": 1560950788, "post_id": 56668627, "comment_id": 99905252, "body": "What I am trying to do is block those columns so the user do not input anything. But the value from those columns change via different formulas"}], "answers": [{"comments": [{"owner": {"reputation": 526, "user_id": 11054439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27604a9c671e93fd6dfeff5670fbd370?s=128&d=identicon&r=PG&f=1", "display_name": "jvargas", "link": "https://stackoverflow.com/users/11054439/jvargas"}, "edited": false, "score": 0, "creation_date": 1560950945, "post_id": 56668740, "comment_id": 99905365, "body": "This worked, thanks. So I have to do that for every column I want to block that gets changed from different formulas results?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 526, "user_id": 11054439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27604a9c671e93fd6dfeff5670fbd370?s=128&d=identicon&r=PG&f=1", "display_name": "jvargas", "link": "https://stackoverflow.com/users/11054439/jvargas"}, "edited": false, "score": 0, "creation_date": 1560951041, "post_id": 56668740, "comment_id": 99905435, "body": "I updated my answer... this might make it easier to implement so you don&#39;t need to do it for each sheet."}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 0, "last_activity_date": 1560951003, "last_edit_date": 1560951003, "creation_date": 1560950697, "answer_id": 56668740, "question_id": 56668627, "link": "https://stackoverflow.com/questions/56668627/how-to-block-cells-when-file-opens/56668740#56668740", "title": "How to block cells when file opens?", "body": "<p>You are trying to change protected cells using VBA while the protection is on. You can work around this various ways, however, the most simple solution is something like the following:</p>\n\n<pre><code>Sub Example()\n\nSheet1.Unprotect \"YOURPASSWORD\" 'if no password was used, you don't need to include it\nSheet1.Range(\"H11:H50\").Rows.EntireRow.AutoFit\nSheet1.Protect \"YOURPASSWORD\"\n\nEnd Sub\n</code></pre>\n\n<p><strong>Alternative solution:</strong></p>\n\n<p>By using this in the on open procedure of your workbook. VBA can make changes on locked cells, but users can not. </p>\n\n<p>One Caveat: if an error occurs in the code, this will reset and you need to close and reopen the worksheet in order for this to function again</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n        ws.Protect UserInterfaceOnly:=True\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 526, "user_id": 11054439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27604a9c671e93fd6dfeff5670fbd370?s=128&d=identicon&r=PG&f=1", "display_name": "jvargas", "link": "https://stackoverflow.com/users/11054439/jvargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 56668740, "answer_count": 1, "score": 0, "last_activity_date": 1560952733, "creation_date": 1560950306, "last_edit_date": 1560952733, "question_id": 56668627, "link": "https://stackoverflow.com/questions/56668627/how-to-block-cells-when-file-opens", "title": "How to block cells when file opens?", "body": "<p>I have some formulas set via vba to change the value in columns H, J, K, L and N. Those changes are based on G column value and a Submit button, this works fine. </p>\n\n<p>When I do the process to lock them to avoid the user from editing, that says to unlock the whole sheet then lock the ones I need, after this I modify the G column and get:</p>\n\n<blockquote>\n  <p>\"Autofit Method of Range Class Failed\". </p>\n</blockquote>\n\n<p>I use it on H column.</p>\n\n<p>This get highlighted:</p>\n\n<pre><code>Sheet1.Range(\"H11:H50\").Rows.EntireRow.AutoFit\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 11670632, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AbP1b-puU34/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPKoXPLBmMHNdsKQGz5Hbuwksnmg/mo/photo.jpg?sz=128", "display_name": "L Macready", "link": "https://stackoverflow.com/users/11670632/l-macready"}, "edited": false, "score": 0, "creation_date": 1560955712, "post_id": 56668624, "comment_id": 99908398, "body": "Brilliant thank you so much.  I used the second option but the first one looks much more elegant.  Much appreciated."}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1560951349, "last_edit_date": 1560951349, "creation_date": 1560950906, "answer_id": 56668837, "question_id": 56668624, "link": "https://stackoverflow.com/questions/56668624/hiding-rows-based-on-cell-value-in-a-loop/56668837#56668837", "title": "Hiding rows based on cell value in a loop", "body": "<p>Actually you are not setting the range in Loop:</p>\n\n<p>This simple loop will do the Job:</p>\n\n<pre><code>Dim Rge As Range\nDim cl As Range\n\nSet Rge = Sheets(\"ForPrint\").Range(\"B:B\").Find(\"Stop\")\n\nFor Each cl In Sheets(\"ForPrint\").Range(\"B24:B\" &amp; Rge.Row).SpecialCells(xlCellTypeBlanks)\n\n    cl.EntireRow.Hidden = True\n\nNext\n</code></pre>\n\n<p>Otherwise in your code Try this:</p>\n\n<pre><code>Dim Count As Integer\nCount = 0\nDim Rge As Range\n\nSet Rge = Sheets(\"ForPrint\").Range(\"b24\").Offset(Count, 0)\n\nDo Until Rge.Value = \"Stop\"\n\nSet Rge = Sheets(\"ForPrint\").Range(\"b24\").Offset(Count, 0)\nIf Rge.Value = \"\" Then\nRge.EntireRow.Hidden = True\n\nEnd If\n\nCount = Count + 1\n\nLoop\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11670632, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AbP1b-puU34/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPKoXPLBmMHNdsKQGz5Hbuwksnmg/mo/photo.jpg?sz=128", "display_name": "L Macready", "link": "https://stackoverflow.com/users/11670632/l-macready"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 56668837, "answer_count": 1, "score": 0, "last_activity_date": 1564187380, "creation_date": 1560950305, "last_edit_date": 1564187380, "question_id": 56668624, "link": "https://stackoverflow.com/questions/56668624/hiding-rows-based-on-cell-value-in-a-loop", "title": "Hiding rows based on cell value in a loop", "body": "<p>I'm trying to hide all blank rows until the value \"stop\" is detected.</p>\n\n<p>I get a Overflow error message when the code reaches <code>Entirerow.hidden = True</code>.</p>\n\n<pre><code>Dim Count as Integer\nCount = 0\nDim Rge as Range\nSet Rge = Sheets(\"ForPrint\").Range(\"b24\").Offset(count,0)\n\nDo Until Rge.Value = \"Stop\"\n\n    If Rge.Value = \"\" Then\n        Rge.EntireRow.Hidden = True\n    End if\n\n    Count = Count + 1\n\nLoop\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1560952425, "post_id": 56668405, "comment_id": 99906294, "body": "This is an excellent first question +"}], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "is_accepted": false, "score": 0, "last_activity_date": 1560951079, "creation_date": 1560951079, "answer_id": 56668898, "question_id": 56668405, "link": "https://stackoverflow.com/questions/56668405/how-to-scrape-a-web-page-with-aspx-code-using-vba/56668898#56668898", "title": "How to scrape a web page with aspx code using VBA?", "body": "<p>You need to fire the onchange event</p>\n\n<pre><code>HTMLSeleccionar.FireEvent \"onchange\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11474126, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YtiRP_IFdDY/AAAAAAAAAAI/AAAAAAAAT2g/LITRkoXQxvw/photo.jpg?sz=128", "display_name": "Santos Eloy Gonzalez", "link": "https://stackoverflow.com/users/11474126/santos-eloy-gonzalez"}, "edited": false, "score": 0, "creation_date": 1561041698, "post_id": 56669300, "comment_id": 99942372, "body": "I&#39;m afraid this code doesn&#39;t change the selected value. This is the result I have ...!<a href=\"https://ibb.co/RpxgG7g\" rel=\"nofollow noreferrer\">code</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 11474126, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YtiRP_IFdDY/AAAAAAAAAAI/AAAAAAAAT2g/LITRkoXQxvw/photo.jpg?sz=128", "display_name": "Santos Eloy Gonzalez", "link": "https://stackoverflow.com/users/11474126/santos-eloy-gonzalez"}, "edited": false, "score": 0, "creation_date": 1561043716, "post_id": 56669300, "comment_id": 99943567, "body": "I tested it and it works. I will have another look."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 11474126, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YtiRP_IFdDY/AAAAAAAAAAI/AAAAAAAAT2g/LITRkoXQxvw/photo.jpg?sz=128", "display_name": "Santos Eloy Gonzalez", "link": "https://stackoverflow.com/users/11474126/santos-eloy-gonzalez"}, "edited": false, "score": 0, "creation_date": 1561044899, "post_id": 56669300, "comment_id": 99944297, "body": "I just ran it again. It works perfectly. Did you run exactly as shown above?"}, {"owner": {"reputation": 11, "user_id": 11474126, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YtiRP_IFdDY/AAAAAAAAAAI/AAAAAAAAT2g/LITRkoXQxvw/photo.jpg?sz=128", "display_name": "Santos Eloy Gonzalez", "link": "https://stackoverflow.com/users/11474126/santos-eloy-gonzalez"}, "edited": false, "score": 0, "creation_date": 1561200658, "post_id": 56669300, "comment_id": 99991816, "body": "i&#39;ve just tested and the result is the same ... it doesn&#39;t work  <a href=\"https://ibb.co/kyhcKw6\" rel=\"nofollow noreferrer\">ibb.co/kyhcKw6</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 11474126, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YtiRP_IFdDY/AAAAAAAAAAI/AAAAAAAAT2g/LITRkoXQxvw/photo.jpg?sz=128", "display_name": "Santos Eloy Gonzalez", "link": "https://stackoverflow.com/users/11474126/santos-eloy-gonzalez"}, "edited": false, "score": 0, "creation_date": 1561200708, "post_id": 56669300, "comment_id": 99991834, "body": "Don\u2019t know why we get different results. I\u2019ll add another solution later."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 11474126, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YtiRP_IFdDY/AAAAAAAAAAI/AAAAAAAAT2g/LITRkoXQxvw/photo.jpg?sz=128", "display_name": "Santos Eloy Gonzalez", "link": "https://stackoverflow.com/users/11474126/santos-eloy-gonzalez"}, "edited": false, "score": 0, "creation_date": 1561201057, "post_id": 56669300, "comment_id": 99991906, "body": "I can send you a gif if it working but it won\u2019t change that it doesn\u2019t work for you for some reason."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1560952926, "last_edit_date": 1560952926, "creation_date": 1560952193, "answer_id": 56669300, "question_id": 56668405, "link": "https://stackoverflow.com/questions/56668405/how-to-scrape-a-web-page-with-aspx-code-using-vba/56669300#56669300", "title": "How to scrape a web page with aspx code using VBA?", "body": "<p>You just need to use a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Attribute_selectors\" rel=\"nofollow noreferrer\">css attribute = value</a> selector to target the right year option. The following includes a check as to whether it is already selected.</p>\n\n<p>You can see the parent <code>select</code> id and the child <code>option</code> tag <code>value</code> attributes here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yE6Bd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yE6Bd.png\" alt=\"enter image description here\"></a></p>\n\n<p>This:</p>\n\n<pre><code>.querySelector(\"#ContentPlaceHolder1_Fecha_ddAnio [selected]\").Value\n</code></pre>\n\n<p>returns the correctly selected year by first finding the parent <code>select</code> element by <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/ID_selectors\" rel=\"nofollow noreferrer\">id</a> <code>#ContentPlaceHolder1_Fecha_ddAnio</code>, then using a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Descendant_combinator\" rel=\"nofollow noreferrer\">descendant combinator</a> <code>\" \"</code> and <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Attribute_selectors\" rel=\"nofollow noreferrer\"><code>\\[\\]</code></a> attribute selector to find the selected option within.</p>\n\n<p>This:</p>\n\n<pre><code>.querySelector(\"[value='\" &amp; CStr(a\u00f1o) &amp; \"']\").Selected = True\n</code></pre>\n\n<p>constructs the desired attribute = value selector e.g. </p>\n\n<pre><code>[value='2018']\n</code></pre>\n\n<hr>\n\n<p>VBA:</p>\n\n<pre><code>Option Explicit\n\n'VBE &gt; Tools &gt; References: Microsoft Internet Controls\nPublic Sub GetData()\n    Dim ie As Object\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = True\n        .Navigate2 \"https://app.cfe.mx/Aplicaciones/CCFE/Tarifas/TarifasCREIndustria/Tarifas/DemandaIndustrialSub.aspx\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim a\u00f1o As Long\n        a\u00f1o = 2018   '&lt;== Year(Fecha)\n        With .document\n            If .querySelector(\"#ContentPlaceHolder1_Fecha_ddAnio [selected]\").Value &lt;&gt; a\u00f1o Then\n                .querySelector(\"[value='\" &amp; CStr(a\u00f1o) &amp; \"']\").Selected = True\n            End If\n            Stop 'delete me later\n\n        End With\n\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11474126, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YtiRP_IFdDY/AAAAAAAAAAI/AAAAAAAAT2g/LITRkoXQxvw/photo.jpg?sz=128", "display_name": "Santos Eloy Gonzalez", "link": "https://stackoverflow.com/users/11474126/santos-eloy-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1565068624, "creation_date": 1560949640, "last_edit_date": 1565068624, "question_id": 56668405, "link": "https://stackoverflow.com/questions/56668405/how-to-scrape-a-web-page-with-aspx-code-using-vba", "title": "How to scrape a web page with aspx code using VBA?", "body": "<p>I'm trying to automate the download of the tarifs of this web page.</p>\n\n<p><a href=\"https://app.cfe.mx/Aplicaciones/CCFE/Tarifas/TarifasCREIndustria/Tarifas/DemandaIndustrialSub.aspx\" rel=\"nofollow noreferrer\">https://app.cfe.mx/Aplicaciones/CCFE/Tarifas/TarifasCREIndustria/Tarifas/DemandaIndustrialSub.aspx</a></p>\n\n<pre><code>Sub DescargarTarifasCFE()\nDim IE As InternetExplorer\nDim HTMLDoc As HTMLDocument\nDim URL As String\nDim FechaINI As Date, FechaFIN As Date, Fecha As Date\nDim HTMLSeleccionar As HTMLSelectElement\n\nApplication.Calculate\n\nApplication.StatusBar = False\n\nFechaINI = Sheets(\"Base\").Range(\"FINI\").Value  'asignamos a las variables los valores de las fechas\nFechaFIN = Sheets(\"Base\").Range(\"FFIN\").Value\n\nFor Fecha = FechaINI To FechaFIN\n\n    If Day(Fecha) = 1 Then 'filtro la acci\u00f3n cuando el dia sea 1 ... de esa manera solo hago una entrada ...    \n\n        URL = \"https://app.cfe.mx/Aplicaciones/CCFE/Tarifas/TarifasCREIndustria/Tarifas/DemandaIndustrialSub.aspx\"\n        Set IE = CreateObject(\"InternetExplorer.Application\")\n        With IE\n            .navigate URL\n            Do Until .readyState = 4: DoEvents: Loop\n        End With\n        IE.Visible = True\n        Set HTMLDoc = IE.Document\n\n        Set HTMLSeleccionar = HTMLDoc.getElementById(\"ContentPlaceHolder1_Fecha_ddAnio\")\n\n        HTMLSeleccionar.Value = Year(Fecha)\n\n    end if\n\nnext fecha \n</code></pre>\n\n<p>I am able to change the year, but this action hasn't got the same result as if I do direclty through the web. I think that in the second case some code is executed. The problem is I don't know how to replicate this action through VBA.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1560949769, "post_id": 56668383, "comment_id": 99904611, "body": "Have you added a reference to the Word VBA library in your excel VBA module?"}, {"owner": {"reputation": 33, "user_id": 11368068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb2ceb48ae369d131b63443494299d1?s=128&d=identicon&r=PG&f=1", "display_name": "OTstand", "link": "https://stackoverflow.com/users/11368068/otstand"}, "reply_to_user": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1560950265, "post_id": 56668383, "comment_id": 99904933, "body": "@Greg Viers ...God. What you said is exactly the cause. Silly newbie mistake"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1560950582, "post_id": 56668383, "comment_id": 99905126, "body": "I&#39;ll submit a proper answer for other newbies that come along. :)"}], "answers": [{"tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": true, "score": 0, "last_activity_date": 1560950785, "creation_date": 1560950785, "answer_id": 56668778, "question_id": 56668383, "link": "https://stackoverflow.com/questions/56668383/having-troubles-creating-and-formatting-word-tables-from-excel-vba/56668778#56668778", "title": "Having troubles creating and formatting Word tables from Excel VBA", "body": "<p>When controlling Microsoft Word from Excel VBA, you need to add a reference to the Microsoft Word Object Library. To do so, make sure you are on your module in the VBA window, and then click <code>Tools</code> then <code>References...</code>. In the popup, scroll down to find \"Microsoft Word XX.X Object Library\". The version # will vary based on what you have installed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7nmR9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7nmR9.png\" alt=\"Add reference to Word object library\"></a></p>\n\n<p>If it doesn't show in the list, you can find it on your hard drive, by clicking \"Browse...\" and navigating to the program files folder where MS Word is installed, then selecting the file called \"MSWORD.OLB\".</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 11368068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb2ceb48ae369d131b63443494299d1?s=128&d=identicon&r=PG&f=1", "display_name": "OTstand", "link": "https://stackoverflow.com/users/11368068/otstand"}, "edited": false, "score": 0, "creation_date": 1561033660, "post_id": 56677476, "comment_id": 99937436, "body": "Thanks for the advise! I realized what you said after I posted the thread, many changes were made and the codes I&#39;m working on are now quite different from the OP :P"}, {"owner": {"reputation": 33, "user_id": 11368068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb2ceb48ae369d131b63443494299d1?s=128&d=identicon&r=PG&f=1", "display_name": "OTstand", "link": "https://stackoverflow.com/users/11368068/otstand"}, "edited": false, "score": 0, "creation_date": 1561033872, "post_id": 56677476, "comment_id": 99937561, "body": "Btw, what&#39;s the difference between declaring MSWordDoc As Word.Document then add one more line to add new doc, and declaring MSWordDoc As New Word.Document so no need for another line? For me they work similarly and I&#39;m not sure which is more preferable."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 33, "user_id": 11368068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb2ceb48ae369d131b63443494299d1?s=128&d=identicon&r=PG&f=1", "display_name": "OTstand", "link": "https://stackoverflow.com/users/11368068/otstand"}, "edited": false, "score": 0, "creation_date": 1561034925, "post_id": 56677476, "comment_id": 99938161, "body": "The code I posted doesn&#39;t declare MSWordDoc As New Word.Document - it declares MSWordApp As New Word.Application. The two are quite different."}, {"owner": {"reputation": 33, "user_id": 11368068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb2ceb48ae369d131b63443494299d1?s=128&d=identicon&r=PG&f=1", "display_name": "OTstand", "link": "https://stackoverflow.com/users/11368068/otstand"}, "edited": false, "score": 0, "creation_date": 1561037581, "post_id": 56677476, "comment_id": 99939778, "body": "Yeah I know that. What I was trying to say is, in the file I&#39;m working on I just declare MSWordDoc As New Word.Document and don&#39;t add the &quot;Set...MSWordApp.Documents.Add&quot; line. It works fine though I&#39;m not sure if there&#39;s any difference between my codes and your example."}, {"owner": {"reputation": 33, "user_id": 11368068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb2ceb48ae369d131b63443494299d1?s=128&d=identicon&r=PG&f=1", "display_name": "OTstand", "link": "https://stackoverflow.com/users/11368068/otstand"}, "edited": false, "score": 0, "creation_date": 1561120107, "post_id": 56677476, "comment_id": 99970091, "body": "The codes posted in the OP has already been modified, a lot :P so what I asked in the previous comments is only about the difference between 1) Declaring MSWordDoc As Word.Document then add one more line to add new doc, and; 2) Declaring MSWordDoc As New Word.Document and don&#39;t add the &quot;Set...MSWordApp.Documents.Add&quot; line."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1560990147, "creation_date": 1560990147, "answer_id": 56677476, "question_id": 56668383, "link": "https://stackoverflow.com/questions/56668383/having-troubles-creating-and-formatting-word-tables-from-excel-vba/56677476#56677476", "title": "Having troubles creating and formatting Word tables from Excel VBA", "body": "<p>Since your code is written for use with late binding, you should NOT be adding a reference to Word. Instead, you need to either define or replace the Word constants you're using. For example, instead of:</p>\n\n<pre><code>.Rows.Alignment = wdAlignRowCenter\n.Rows.HeightRule = wdRowHeightExactly\n</code></pre>\n\n<p>you could use:</p>\n\n<pre><code>.Rows.Alignment = 1  '1=wdAlignRowCenter\n.Rows.HeightRule = 2 '2=wdRowHeightExactly\n</code></pre>\n\n<p>Alternatively, after:</p>\n\n<pre><code>Dim MSWordApp As Object, MSWordDoc As Object\n</code></pre>\n\n<p>you would insert:</p>\n\n<pre><code>Const wdAlignRowCenter as Long = 1: Const wdRowHeightExactly as Long = 2\n</code></pre>\n\n<p>Otherwise, if you're going to set a reference to Word, you should make your code consistent with early binding throughout. For example, instead of:</p>\n\n<pre><code>Dim MSWordApp As Object, MSWordDoc As Object\n\n    Set MSWordApp = CreateObject(\"Word.Application\")\n    Set MSWordDoc = MSWordApp.Documents.Add\n</code></pre>\n\n<p>you might use:</p>\n\n<pre><code>Dim MSWordApp As New Word.Application, MSWordDoc As Word.Document\n\n    Set MSWordDoc = MSWordApp.Documents.Add\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11368068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb2ceb48ae369d131b63443494299d1?s=128&d=identicon&r=PG&f=1", "display_name": "OTstand", "link": "https://stackoverflow.com/users/11368068/otstand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 56668778, "answer_count": 2, "score": 0, "last_activity_date": 1560990147, "creation_date": 1560949582, "last_edit_date": 1560961149, "question_id": 56668383, "link": "https://stackoverflow.com/questions/56668383/having-troubles-creating-and-formatting-word-tables-from-excel-vba", "title": "Having troubles creating and formatting Word tables from Excel VBA", "body": "<p>I'm new to MS Word VBA and am having troubles with manipulating Word documents from Excel.</p>\n\n<p>The Biggest problem so far is: codes that work in Word VBA just don't work in Excel. Very strange and frustrating.</p>\n\n<p>Below are the codes:</p>\n\n<pre><code>Sub abc()\nDim MSWordApp As Object, MSWordDoc As Object\n\n    Set MSWordApp = CreateObject(\"Word.Application\")\n    Set MSWordDoc = MSWordApp.Documents.Add\n    MSWordApp.Visible = True\n    With MSWordDoc\n        With .PageSetup\n            .TopMargin = Application.CentimetersToPoints(0.51)\n            .BottomMargin = Application.CentimetersToPoints(0.51)\n            .LeftMargin = Application.CentimetersToPoints(0.51)\n            .RightMargin = Application.CentimetersToPoints(0.51)\n        End With\n        .Tables.Add Range:=.Range(0, 0), NumRows:=3, NumColumns:=2\n        With .Tables(1)\n            .Rows.Alignment = wdAlignRowCenter\n            .Rows.HeightRule = wdRowHeightExactly\n            .Rows.Height = Application.CentimetersToPoints(9.55)\n            .Columns.PreferredWidthType = wdPreferredWidthPoints\n            .Columns.PreferredWidth = Application.CentimetersToPoints(9.9)\n        End With\n    End With\n\n    MSWordApp.Activate\n    Set MSWordApp = Nothing\n    Set MSWordDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>These codes work perfectly in MS Word (Of course I've changed the names of object etc when I use them in MS Word).</p>\n\n<p>However, weird things happen in Excel:</p>\n\n<p>1) \".Rows.Alignment = wdAlignRowCenter\" just don't work at all. The Rows.Alignment of the Word table just remains as default.</p>\n\n<p>2) \".Columns.PreferredWidthType = wdPreferredWidthPoints\" causes error in Excel. It works fine in Word; though in Excel, an empty error msg will pop up when every time I call this property. Have no idea why...</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1560951181, "post_id": 56668339, "comment_id": 99905516, "body": "Don&#39;t copy to excel. Copy to an array then copy the array in one go to excel.  Do you have any merged cells in your word table?."}, {"owner": {"reputation": 655, "user_id": 2670777, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d69cb2368cc72bf16229fdddf46e557a?s=128&d=identicon&r=PG", "display_name": "joehua", "link": "https://stackoverflow.com/users/2670777/joehua"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1560957263, "post_id": 56668339, "comment_id": 99909377, "body": "@freeflow Good thought. There are no merged cells but there is a split cell. How to handle this?"}, {"owner": {"reputation": 655, "user_id": 2670777, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d69cb2368cc72bf16229fdddf46e557a?s=128&d=identicon&r=PG", "display_name": "joehua", "link": "https://stackoverflow.com/users/2670777/joehua"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1560958145, "post_id": 56668339, "comment_id": 99910007, "body": "By the way, that split cell is on row 3 column 2. I actually don&#39;t use Word so much to tell whether it is really a split cell. I guess it&#39;s a split cell because its row height is half of the other cells. That cell looks like having two half-height cells in it."}], "answers": [{"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 0, "last_activity_date": 1560958963, "creation_date": 1560958963, "answer_id": 56671500, "question_id": 56668339, "link": "https://stackoverflow.com/questions/56668339/ms-word-table-the-requested-member-of-the-collection-does-not-exist/56671500#56671500", "title": "MS Word table - The requested member of the collection does not exist", "body": "<p>You can handle different numbers of cells in each row, say from splits or merges, with something like this:</p>\n\n<pre><code>For m = 1 To wdDoc.Tables(1).Rows.Count\n    For l = 1 To wdDoc.Tables(1).Rows(m).Cells.Count\n        ActiveSheet.Cells(m, l) = wdDoc.Tables(1).Cell(m, l)\n    Next l\nNext m\n</code></pre>\n\n<p>And then to clean things up a little</p>\n\n<pre><code>With wdDoc.Tables(1)\n    For m = 1 To .Rows.Count\n        For l = 1 To .Rows(m).Cells.Count\n            ActiveSheet.Cells(m, l) = .Cell(m, l)\n        Next l\n    Next m\nEnd With\n</code></pre>\n\n<p>Hope that helps</p>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1560989548, "creation_date": 1560989548, "answer_id": 56677427, "question_id": 56668339, "link": "https://stackoverflow.com/questions/56668339/ms-word-table-the-requested-member-of-the-collection-does-not-exist/56677427#56677427", "title": "MS Word table - The requested member of the collection does not exist", "body": "<p>To get the correct results from a Word table with merged or split cells, use code like:</p>\n\n<pre><code>Dim wdCell As Object\nFor Each wdCell In wddoc.Tables(1).Range.Cells\n  With wdCell\n    ActiveSheet.Cells(.RowIndex, .ColumnIndex) = .Range.Text\n  End With\nNext\n</code></pre>\n"}], "owner": {"reputation": 655, "user_id": 2670777, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d69cb2368cc72bf16229fdddf46e557a?s=128&d=identicon&r=PG", "display_name": "joehua", "link": "https://stackoverflow.com/users/2670777/joehua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 56677427, "answer_count": 2, "score": 0, "last_activity_date": 1560989548, "creation_date": 1560949457, "last_edit_date": 1560949673, "question_id": 56668339, "link": "https://stackoverflow.com/questions/56668339/ms-word-table-the-requested-member-of-the-collection-does-not-exist", "title": "MS Word table - The requested member of the collection does not exist", "body": "<p>I have searched this forum and found several articles related to the same error message. Yet, none is related to my problem.</p>\n\n<p>I have a table in Word with the following properties:</p>\n\n<pre><code>wddoc.tables(1).Rows.Count : 15 \nwddoc.tables(1).Columns.Count : 4 \n</code></pre>\n\n<p>I was trying to copy the table to Excel using the following code:</p>\n\n<pre><code>For m = 1 To 15\nFor l = 1 To 4\nActiveSheet.Cells(m, l) = wdDoc.Tables(1).Cell(m, l)\nNext l\nNext m\n</code></pre>\n\n<p>The code worked fine for the first three rows but when it came to the fourth row (m=4, l=1), it threw the titled error message. What gives?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10528835, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pZWsdYj8A-k/AAAAAAAAAAI/AAAAAAAAAAA/X6VsZgK8l4k/photo.jpg?sz=128", "display_name": "Andrei Caba", "link": "https://stackoverflow.com/users/10528835/andrei-caba"}, "edited": false, "score": 0, "creation_date": 1561239333, "post_id": 56670407, "comment_id": 99999988, "body": "That is the exact problem. It displays those question marks for me too (and I do have the language installed. By the way, it&#39;s the Romanian language, not the Turkish language). Also - sometimes the user has to input quotation marks too or brackets etc (just to keep in mind, in case some other method is used, it has to support those too...) So... no, those characters are not recognized nor outputted properly... but thanks for your try."}], "tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": false, "score": 0, "last_activity_date": 1560955428, "creation_date": 1560955428, "answer_id": 56670407, "question_id": 56667930, "link": "https://stackoverflow.com/questions/56667930/how-can-i-use-special-chars-in-vba-of-microsoft-word/56670407#56670407", "title": "How can I use special chars in VBA of Microsoft Word?", "body": "<p>A VBA InputBox will take any character typed or pasted into it. The characters available to type depends on the Language version of Windows and Office that the end user has installed.</p>\n\n<p>Below is a test I just made with your example character string \"\u0103\u00ee\u00e2\u0219\u021b/\u0102\u00ce\u00c2\u0218\u021a\" </p>\n\n<pre><code>SpecialCharInput()\n    Dim str As String\n    str = InputBox(\"Enter you text\", \"Special Test Input Box\")\n    Debug.Print str\nEnd Sub\n</code></pre>\n\n<p>On my English language system, the only trouble it had was with the upper and lower case \"\u0218\u021a\" Turkish characters. By trouble I mean it turned those characters into question marks \"??\" in the result string. I'm sure though, if my system supported the Turkish language that those characters would be recognized and outputted properly.</p>\n"}], "owner": {"reputation": 1, "user_id": 10528835, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pZWsdYj8A-k/AAAAAAAAAAI/AAAAAAAAAAA/X6VsZgK8l4k/photo.jpg?sz=128", "display_name": "Andrei Caba", "link": "https://stackoverflow.com/users/10528835/andrei-caba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560957710, "creation_date": 1560948140, "last_edit_date": 1560957710, "question_id": 56667930, "link": "https://stackoverflow.com/questions/56667930/how-can-i-use-special-chars-in-vba-of-microsoft-word", "title": "How can I use special chars in VBA of Microsoft Word?", "body": "<p>I've created a set of macro files in Microsoft Word's VBA as a sort of a CAT tool (CAT = <a href=\"https://en.wikipedia.org/wiki/Computer-assisted_translation\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Computer-assisted_translation</a>). The problem is that there are cases where I display the text needed to be translated and the user needs to input text in his own language. That might include some special chars, like \"\u0103\u00ee\u00e2\u0219\u021b/\u0102\u00ce\u00c2\u0218\u021a\", or even quotes or brackets. Is there any way to use those in some <code>InputBox</code> function? Or, at least, some way to let the user input the text he needs in some <code>TextBox</code> or something?... Or how should I approach this?... Maybe UTF-8 support would be what I need? Or?... Any help would be appreciated!...</p>\n\n<p>I've tried Microsoft Word's vba function <code>InputBox</code>. I'm also thinking if, maybe, I would be able to create my own <code>InputBox</code>, with my conditions on it, I might be able to have one that accepts those chars too, or all the chars into some string variable... Here is something someone on StackOverflow says:\n<a href=\"https://stackoverflow.com/questions/43345287/is-it-possible-to-create-an-input-box-in-vba-that-can-take-a-text-selection-wi\">Is it possible to create an &#39;input box&#39; in VBA that can take a text selection with multiple lines as an input?</a> (I'm referring to gizlmo's answer...)</p>\n\n<p>Here are 3 lines of code that contain that (although it's more of a how to question, not a debugging question, so those are not really needed...)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>MsgBox (\"Ziua \" &amp; Str(ziua) &amp; \" - \" &amp; titlurien(ziua))\n        titluales = InputBox(\"Titlul original:  \" &amp; titlurien(ziua), \"Ziua: \" &amp; Str(ziua) &amp; \", Rapsodia Realitatilor \" &amp; monthname(lunanecesara) &amp; Str(annecesar))\n        titluriro(ziua) = titluales\n</code></pre>\n\n<p>I expect the output to be exactly what he typed, whether it's quotes, brackets or special characters (like \"\u0103\u00ee\u00e2\u0219\u021b\"/\"\u0102\u00ce\u00c2\u0218\u021a\")...</p>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1560948032, "post_id": 56667753, "comment_id": 99903480, "body": "What have you tried so far? The ComboBox has an <code>AddItem</code> method and a  <code>List</code> property both of which can be used to assign to it. It&#39;s not at all clear what the rest of your question is talking about incrementing dates on a worksheet. Please try to improve this question."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1560948513, "post_id": 56667753, "comment_id": 99903801, "body": "You can also look into the <code>.RowSource</code> property."}], "answers": [{"tags": [], "owner": {"reputation": 164, "user_id": 4414852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805a99052465774c855aacbd2f8e5d84?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Banakar", "link": "https://stackoverflow.com/users/4414852/arun-banakar"}, "is_accepted": false, "score": 0, "last_activity_date": 1560948740, "creation_date": 1560948740, "answer_id": 56668111, "question_id": 56667753, "link": "https://stackoverflow.com/questions/56667753/how-to-populate-vba-combo-box-dropdown-in-user-form-from-excel-data/56668111#56668111", "title": "How to Populate VBA Combo box dropdown in user form from Excel data", "body": "<p>Here is simple solution\nJust add a button, paste this.</p>\n\n<pre><code>Dim i As Long\n\n'Clear existing items\nComboBox1.Clear\n\n'36 (AJ) column to 58 (BF) column\nFor i = 36 To 58\n\n    ComboBox1.AddItem ActiveSheet.Cells(1, i).Value\n\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1560949705, "creation_date": 1560949705, "answer_id": 56668428, "question_id": 56667753, "link": "https://stackoverflow.com/questions/56667753/how-to-populate-vba-combo-box-dropdown-in-user-form-from-excel-data/56668428#56668428", "title": "How to Populate VBA Combo box dropdown in user form from Excel data", "body": "<p>There are different ways. If you have one set range of cells (that's what I assume reading your question) that won't change, you could just set the <code>RowSource</code> property of your combobox.</p>\n\n<p>For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/doVh8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/doVh8.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/lJuTZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lJuTZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Apply to your situation:</p>\n\n<ul>\n<li>Cell <code>AI1</code> holds your date</li>\n<li>Cell <code>AJ1</code> holds formula <code>=AI1+1</code></li>\n<li>Drag formula to cell <code>BF1</code> (assuming you always want to add to the value in <code>AI1</code>, the formula will keep doing this for you)</li>\n<li>Use <code>RowSource</code> property and fill in <code>=Sheet1!AI1:BF1</code></li>\n</ul>\n\n<p>Conclusion, no VBA needed at all! If I understood your question well enough that is.</p>\n"}], "owner": {"reputation": 14, "user_id": 10379082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/291f9439d0c06b2549ac372c487230cf?s=128&d=identicon&r=PG&f=1", "display_name": "Neelavathy", "link": "https://stackoverflow.com/users/10379082/neelavathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1609858418, "creation_date": 1560947643, "last_edit_date": 1560948168, "question_id": 56667753, "link": "https://stackoverflow.com/questions/56667753/how-to-populate-vba-combo-box-dropdown-in-user-form-from-excel-data", "title": "How to Populate VBA Combo box dropdown in user form from Excel data", "body": "<p>I am new to VBA coding. Can some one tell me ,how to populate the combo box in the user form with the values in the excel sheet.</p>\n\n<p>Say sheet name as \"Reg ALL - current\" and I need to populate the value from cell AI(which is a date column). Also I had to increment the date to 1day from AJ to cell BF.</p>\n\n<p>Example : if AI holds value (19/06/2019) then AJ should hold (20/06/2019) and so on until BF.</p>\n\n<p>Can anyone tell me ,how to handle this code in VBA?</p>\n"}, {"tags": ["excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 6, "creation_date": 1560946792, "post_id": 56667379, "comment_id": 99902763, "body": "<i>Yes, there is a way.</i> \u2022 If this is not the answer you expected then you asked the wrong question. Please note that because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560948300, "post_id": 56667379, "comment_id": 99903653, "body": "You should also narrow your scope, to <i>one</i> language. Are you using VB? VBA? Or C#? (Hint: it <i>can&#39;t</i> be done with formula)"}, {"owner": {"reputation": 19, "user_id": 10817032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1165fb029101a78df25f92eaf2812ad0?s=128&d=identicon&r=PG&f=1", "display_name": "mapvis01", "link": "https://stackoverflow.com/users/10817032/mapvis01"}, "edited": false, "score": 0, "creation_date": 1560958308, "post_id": 56667379, "comment_id": 99910102, "body": "i updated the original post with my current code."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1561476121, "creation_date": 1561476121, "answer_id": 56757342, "question_id": 56667379, "link": "https://stackoverflow.com/questions/56667379/is-there-a-way-in-excel-to-add-rows-or-move-a-row-using-a-formula-vb-or-c/56757342#56757342", "title": "Is there a way in excel to add rows or move a row using a formula, vb or c#", "body": "<p>This works fine for me, given the example you posted.</p>\n\n<pre><code>Public Sub ReverseLoop()\n\nDim sht As Worksheet\nDim LastRow As Long\nDim r As String\nDim x As Long\nDim NumList As Variant  'Array\nDim RegExpObj As Object\nDim NumStr As Integer\n\nSet sht = ActiveSheet\n\n'Ctrl + Shift + End\nLastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\n'Loop Through 0-100 in Reverse Order\nFor x = LastRow To 1 Step -1\n\n    strIn = Range(\"A\" &amp; x).Value\n\n        Set RegExpObj = CreateObject(\"vbscript.regexp\")\n        With RegExpObj\n            .Global = True\n            .Pattern = \"[^\\d]+\"\n            NumStr = .Replace(strIn, \" \")\n        End With\n\n    Cells(x, 1).EntireRow.Select\n    Selection.Cut\n    Cells(NumStr, 1).Select\n    ActiveSheet.Paste\n\nNext x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10817032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1165fb029101a78df25f92eaf2812ad0?s=128&d=identicon&r=PG&f=1", "display_name": "mapvis01", "link": "https://stackoverflow.com/users/10817032/mapvis01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1561476121, "creation_date": 1560946428, "last_edit_date": 1560959570, "question_id": 56667379, "link": "https://stackoverflow.com/questions/56667379/is-there-a-way-in-excel-to-add-rows-or-move-a-row-using-a-formula-vb-or-c", "title": "Is there a way in excel to add rows or move a row using a formula, vb or c#", "body": "<p>I have an excel table with an ordered text column and a MoveToRow column. The table is in the right order but I need to space out the rows by adding empty rows between the values using a MoveToRow column.</p>\n\n<p>Ex:</p>\n\n<pre><code>1. cat 2\n2. dog 3\n3. Rat  5\n</code></pre>\n\n<p>Is there a way in excel using a formula or vb or c# code to move or copy the animal field to the desired row listed in the second column?</p>\n\n<p>Results:</p>\n\n<pre><code>1.    \n2.cat    \n3.dog    \n4.\n5.rat\n</code></pre>\n\n<p>or I can change the MoveToRow column into an InsertThisManyRowsAfter column if that is possible. </p>\n\n<p>i would think something like this code the loops through an integer column that contains the number of rows to insert below the current one and if the value is 0 skip it but if the value is >=1 it inserts that number of rows. But this is not working properly its adding too many rows and all in the same range. Where is the logic not correct here?</p>\n\n<pre><code>Sub Test1()\n  Dim x As Integer\n  Dim y As Integer\n  Dim z As Integer\n  ' Set numrows = number of rows of data.\n  ' NumRows = Range(\"A2\", Range(\"A2\").End(xldown)).Rows.Count\n  NumRows = 100\n  ' Select cell a1.\n  Range(\"I1\").Select\n  ' Establish \"For\" loop to loop \"numrows\" number of times.\n  For x = 1 To NumRows\n     ' Insert your code here.\n     ' Selects cell down 1 row from active cell.\n     y = ActiveCell.Row\n     z = ActiveCell.Value\n     If z &gt;= 1 Then\n        Rows(y &amp; \":\" &amp; y + z).Insert Shift:=xlShiftDown\n        ActiveCell.Offset(1, 0).Select\n     Else\n        ActiveCell.Offset(1, 0).Select\n     End If\n  Next\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560947139, "post_id": 56667261, "comment_id": 99902922, "body": "First: have a look at <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Without the formula (how you call the function) and sample data (input/outpit) it is no full example (which we need to help you properly). \u2022 Second: Debug your code. Go through it step by step using F8 (use a test sub to call this function or place a <code>Stop</code> statement as first line in the function to get into debugging)."}, {"owner": {"reputation": 3, "user_id": 11670050, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S8TZi50P1uU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrc_LoA60cJ4hCLiruY53wE_cMzg/mo/photo.jpg?sz=128", "display_name": "J4Y R4R", "link": "https://stackoverflow.com/users/11670050/j4y-r4r"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1561381767, "post_id": 56667261, "comment_id": 100033296, "body": "I hope this helps a little"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11670050, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S8TZi50P1uU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrc_LoA60cJ4hCLiruY53wE_cMzg/mo/photo.jpg?sz=128", "display_name": "J4Y R4R", "link": "https://stackoverflow.com/users/11670050/j4y-r4r"}, "edited": false, "score": 0, "creation_date": 1561539541, "post_id": 56738207, "comment_id": 100093619, "body": "Thanks, works perfectly with the Test sheet!   But I&#39;ve a small problem using the code for the productive workbook. The code runs through without an error but the cells stay empty.  Is there a maximum rangesize for the Match function? I can&#39;t figure out any other problem."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3, "user_id": 11670050, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S8TZi50P1uU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrc_LoA60cJ4hCLiruY53wE_cMzg/mo/photo.jpg?sz=128", "display_name": "J4Y R4R", "link": "https://stackoverflow.com/users/11670050/j4y-r4r"}, "edited": false, "score": 0, "creation_date": 1561541652, "post_id": 56738207, "comment_id": 100094780, "body": "If they stay empty it did not match. I don&#39;t know of any limit. Make sure that the range you give in the formula has the personal id as first column and the headers as first row. Hard to say what is going wrong without seeing the data."}, {"owner": {"reputation": 3, "user_id": 11670050, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S8TZi50P1uU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrc_LoA60cJ4hCLiruY53wE_cMzg/mo/photo.jpg?sz=128", "display_name": "J4Y R4R", "link": "https://stackoverflow.com/users/11670050/j4y-r4r"}, "edited": false, "score": 0, "creation_date": 1561551106, "post_id": 56738207, "comment_id": 100100429, "body": "Don&#39;t ask me why but after reentering every ID Number manually the function works just fine. So thanks a lot it&#39;s working perfectly!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3, "user_id": 11670050, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S8TZi50P1uU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrc_LoA60cJ4hCLiruY53wE_cMzg/mo/photo.jpg?sz=128", "display_name": "J4Y R4R", "link": "https://stackoverflow.com/users/11670050/j4y-r4r"}, "edited": false, "score": 0, "creation_date": 1561551400, "post_id": 56738207, "comment_id": 100100613, "body": "@J4YR4R Either a hidden space or number formatted as text (or other way round) could have caused this."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1561385045, "last_edit_date": 1561385045, "creation_date": 1561384723, "answer_id": 56738207, "question_id": 56667261, "link": "https://stackoverflow.com/questions/56667261/problem-creating-a-dynamic-reverse-lookup-function/56738207#56738207", "title": "Problem creating a dynamic reverse lookup function", "body": "<p>I suggest the following:</p>\n\n<ul>\n<li>Read the data into arrays for faster lookup and processing</li>\n<li>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.WorksheetFunction.Match\" rel=\"nofollow noreferrer\">WorksheetFunction.Match method</a> to get the row number of the matching personal id</li>\n<li><p>Loop through the columns of the matched row to find the <code>x</code> and if we find one add its header (from row 1) to the list.</p>\n\n<p>Note that the <code>x</code> is case sensitive if you want to allow both lower case <code>x</code> and upper case <code>X</code> then use <code>If lCase(Data(FoundRow, iCol)) = \"x\" Then</code> instead.</p></li>\n<li><p>In the last step we remove the line break <code>vbLf</code> in the very end (which is not needed).</p></li>\n</ul>\n\n<p>So this is what you end up with:</p>\n\n<pre><code>Option Explicit\n\nPublic Function GetHeaderList(PersonalID As String, DataRange As Range) As String\n    Dim Data() As Variant\n    Data = DataRange.Value 'read data into array for fast access\n\n    Dim LookupColumn() As Variant\n    LookupColumn = DataRange.Columns(1).Value 'read first column into array for fast access\n\n    'find row of personal id\n    Dim FoundRow As Double\n    On Error Resume Next 'next line errors if nothing matched\n    FoundRow = Application.WorksheetFunction.Match(PersonalID, LookupColumn, 0)\n    On Error GoTo 0 'don't forget to re-activate error reporting!\n\n    'collect header data\n    If FoundRow &gt; 0 Then 'FoundRow is 0 if nothing matched\n        Dim iCol As Long\n        For iCol = 2 To UBound(Data, 2)\n            If Data(FoundRow, iCol) = \"x\" Then 'x is case sensitive\n                GetHeaderList = GetHeaderList &amp; Data(1, iCol) &amp; vbLf\n            End If\n        Next iCol\n    End If\n\n    'remove last vbLf\n    If Right$(GetHeaderList, 1) = vbLf Then\n        GetHeaderList = Left$(GetHeaderList, Len(GetHeaderList) - 1)\n    End If\nEnd Function\n</code></pre>\n\n<p>To get the following result with this formula in C5:</p>\n\n<pre><code>=GetHeaderList(C2;'2019'!B3:G8) 'German Excel\n=GetHeaderList(C2,'2019'!B3:G8) 'English Excel\n</code></pre>\n\n<p>Note that the complete data range is given in the formula including headers and lookup column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/w1ADL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w1ADL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 11670050, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S8TZi50P1uU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrc_LoA60cJ4hCLiruY53wE_cMzg/mo/photo.jpg?sz=128", "display_name": "J4Y R4R", "link": "https://stackoverflow.com/users/11670050/j4y-r4r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56738207, "answer_count": 1, "score": 0, "last_activity_date": 1561385392, "creation_date": 1560945940, "last_edit_date": 1561385392, "question_id": 56667261, "link": "https://stackoverflow.com/questions/56667261/problem-creating-a-dynamic-reverse-lookup-function", "title": "Problem creating a dynamic reverse lookup function", "body": "<p>Background: </p>\n\n<ul>\n<li>multiple sheets filled with employees and possible training sessions</li>\n<li>\"x\" marked trainings are completed by the employee</li>\n</ul>\n\n<p>Goal:</p>\n\n<ul>\n<li>sheet where I can paste the employee number and get a list of completed Trainings for each year</li>\n</ul>\n\n<p>I'm not using VBA very often but I tried my best with this one.</p>\n\n<p>I tired to build a function which (theoretically) should use the given parameters to get the names of the trainings. I can't get it runinng without giving me <code>#VAULE!</code>. </p>\n\n<pre><code>Function TS(PersNum As String, Numbers As Range, Trainings As Range, Optional SearchRow As Range)\n    TrainRow = Trainings.Rows(1)        'all trainings are listed in this row\n    TS = \"\"\n\n    For Each cell In Numbers            'search in column for the employee number            \n        If cell.Value = PersNum Then     \n            cell.Row = SearchRow         'if match -&gt; set row of the cell as range for SearchRow  \n        Else\n            Resume Next\n        End If\n    Next cell\n\n    For Each cell2 In SearchRow         'search every cell in SearchRow for \"x\"   \n        If cell2.Value = \"x\" Then\n            TS = TS &amp; Cells(TrainRow, cell2.Cloumn).Value &amp; Chr(10) 'match -&gt; return trainingsname with a carriage return\n        Else\n            Resume Next\n        End If\n    Next cell2\nEnd Function\n</code></pre>\n\n<p>I expected it to search for the given number in the column given with the parameter. As soon as it founds a match it should paste the row of the column to the \"SearchRow\" variable and exit the search. Afterwards it should look through the row and give me the Title of every Column marked with an \"x\" as text in the cell the function is located.</p>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kpk9t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kpk9t.png\" alt=\"Workbook and search layout\"></a></p>\n\n<p>This is the worksheet I'm working on, a cell where I enter the employee Number and a cell with this function: <code>=TS(C2;'2019'!B:B;'2019'!3:3)</code>\nFor every year I want the list to be collected.</p>\n\n<p>The Data I want to collect looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/f8CTV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f8CTV.png\" alt=\"Test Data\"></a></p>\n\n<p>Every column header marked with an \"x\" in the row of the employee should be added to the list. \nIn the end I would like to have a listing under the year cell in the search sheet with an wordwrap after each training</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1560946754, "post_id": 56667116, "comment_id": 99902738, "body": "Use the <code>Copy</code> method."}], "answers": [{"tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": false, "score": 1, "last_activity_date": 1560955266, "creation_date": 1560955266, "answer_id": 56670349, "question_id": 56667116, "link": "https://stackoverflow.com/questions/56667116/copy-formatted-text-to-clipboard-in-word-vba/56670349#56670349", "title": "Copy Formatted Text To Clipboard in word-vba", "body": "<p><code>ActiveDocument.Content.Text</code> is just a string containing the unformatted text of the document.</p>\n\n<p><code>ActiveDocument.Content.Copy</code> is the only code you need for copying the document. Depending on where you are copying it to you may also need to ensure that you use the correct paste command to get the original formatting.</p>\n"}], "owner": {"reputation": 1, "user_id": 10588153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56927758e4888f2545f35a016751acbe?s=128&d=identicon&r=PG&f=1", "display_name": "philipp_chapo", "link": "https://stackoverflow.com/users/10588153/philipp-chapo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560955266, "creation_date": 1560945397, "last_edit_date": 1560946726, "question_id": 56667116, "link": "https://stackoverflow.com/questions/56667116/copy-formatted-text-to-clipboard-in-word-vba", "title": "Copy Formatted Text To Clipboard in word-vba", "body": "<p>I want to copy all the text in my word doc !!without losing the format! some text is bold, underlined and so on. This is the code i have so far but it just copies plain text.</p>\n\n<pre><code>Sub CopyTextToClipboard()\n    Dim obj As New DataObject\n    Dim mainData As String\n    mainData = ActiveDocument.Content.Text\n    obj.SetText mainData\n    obj.PutInClipboard\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1561100296, "post_id": 56667018, "comment_id": 99960928, "body": "Just to clarify you want to write either &quot;Card&quot;, &quot;Cash&quot; or &quot;EFT&quot; to the Cell Gx depending on the value of optCard.Value? (What is optCard anyway? Is it a userForm that you called earlier?)"}, {"owner": {"reputation": 1, "user_id": 11670065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6df5827e9a11726ed6b1ecbd5fbb1ca0?s=128&d=identicon&r=PG&f=1", "display_name": "Jayc", "link": "https://stackoverflow.com/users/11670065/jayc"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1561441121, "post_id": 56667018, "comment_id": 100052998, "body": "I Came Right I noticed That IIf Would work, its just how you structure it the solution is as per the below,"}, {"owner": {"reputation": 1, "user_id": 11670065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6df5827e9a11726ed6b1ecbd5fbb1ca0?s=128&d=identicon&r=PG&f=1", "display_name": "Jayc", "link": "https://stackoverflow.com/users/11670065/jayc"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1561441127, "post_id": 56667018, "comment_id": 100053001, "body": ".Range(&quot;G&quot; &amp; iRow).Value = IIf(optCard.Value = True, &quot;Card&quot;, IIf(optCash.Value = True, &quot;Cash&quot;, IIf(optDebitOrder.Value = True, &quot;Debit Order&quot;, &quot;EFT&quot;)))"}, {"owner": {"reputation": 1, "user_id": 11670065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6df5827e9a11726ed6b1ecbd5fbb1ca0?s=128&d=identicon&r=PG&f=1", "display_name": "Jayc", "link": "https://stackoverflow.com/users/11670065/jayc"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1561441172, "post_id": 56667018, "comment_id": 100053013, "body": "I also managed to add a forth Selection"}, {"owner": {"reputation": 1, "user_id": 11670065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6df5827e9a11726ed6b1ecbd5fbb1ca0?s=128&d=identicon&r=PG&f=1", "display_name": "Jayc", "link": "https://stackoverflow.com/users/11670065/jayc"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1561441266, "post_id": 56667018, "comment_id": 100053049, "body": "But yes its a form, i designed that carried two simple selections through means of a radio button that you would have to select, but thank you for taking interest, much appreciated."}], "owner": {"reputation": 1, "user_id": 11670065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6df5827e9a11726ed6b1ecbd5fbb1ca0?s=128&d=identicon&r=PG&f=1", "display_name": "Jayc", "link": "https://stackoverflow.com/users/11670065/jayc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560945026, "creation_date": 1560945026, "question_id": 56667018, "link": "https://stackoverflow.com/questions/56667018/returning-3-values-to-post-based-linked-radio-butten", "title": "Returning 3 Values to post based linked radio Butten", "body": "<p>I have Created 3 Radio Buttons Card, Cash, EFT, but the script I write no matter  what i use populates an error I know IIF only returns two values but else does not work aswell.</p>\n\n<p>The issue is here Below</p>\n\n<p>.Range(\"G\" &amp; iRow).Value = IIf(optCard.Value = True, \"Card\", \"EFT\")\n based on the above I need to add a 3rd selection for the two it works fine but what ever i add after seems to be meet with errors\nPlease Help</p>\n\n<p>Please see the script below. </p>\n\n<p>Private Sub cmdSave_Click()</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nDim iRow As Long\n\niRow = Sheets(\"Data\").Range(\"A1048576\").End(xlUp).Row + 1\n\nIf ValidateForm = True Then\n\n    With ThisWorkbook.Sheets(\"Data\")\n\n       .Range(\"A\" &amp; iRow).Value = iRow - 1\n       .Range(\"D\" &amp; iRow).Value = txtValue.Value\n       .Range(\"G\" &amp; iRow).Value = IIf(optCard.Value = True, \"Card\", \"EFT\")\n       .Range(\"B\" &amp; iRow).Value = cmbAccount.Text\n       .Range(\"E\" &amp; iRow).Value = txtWeek.Value\n       .Range(\"F\" &amp; iRow).Value = txtRetailer.Value\n       .Range(\"H\" &amp; iRow).Value = txtDate.Value\n\n    End With\n    Call Reset\nElse\n    Application.ScreenUpdating = True\n    Exit Sub\nEnd If\n\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1573, "user_id": 6038796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tUBN.png?s=128&g=1", "display_name": "DaggeJ", "link": "https://stackoverflow.com/users/6038796/daggej"}, "edited": false, "score": 0, "creation_date": 1560945000, "post_id": 56666909, "comment_id": 99901740, "body": "Probably some problem with state, like ActiveWorkbook isn&#39;t what you expect. Perhaps try some &quot;messagebox debugging&quot;? Add <code>on error goto...</code> and output the error as a messagebox or write it to a file."}, {"owner": {"reputation": 1709, "user_id": 7761488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/269b1437ab589a3528f1dae453c3dd77?s=128&d=identicon&r=PG&f=1", "display_name": "iSpain17", "link": "https://stackoverflow.com/users/7761488/ispain17"}, "edited": false, "score": 0, "creation_date": 1560952070, "post_id": 56666909, "comment_id": 99906056, "body": "I don&#39;t understand your function. You give arguments that you literally never use in your calculations. You could just put these two values manually in the cells where you try to put them programatically."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10690889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f2c2f29c6c170cdeff6fb61c7815571?s=128&d=identicon&r=PG&f=1", "display_name": "Yaurav", "link": "https://stackoverflow.com/users/10690889/yaurav"}, "edited": false, "score": 0, "creation_date": 1560949377, "post_id": 56667034, "comment_id": 99904372, "body": "thanks for the reply. It is working but in that case it won&#39;s perform, what i have wished for."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1560952878, "last_edit_date": 1560952878, "creation_date": 1560945069, "answer_id": 56667034, "question_id": 56666909, "link": "https://stackoverflow.com/questions/56666909/user-defined-function-working-fine-in-vba-while-when-called-from-excel-sheet-sh/56667034#56667034", "title": "User defined function working fine in vba, while when called from excel sheet showing &#39;Value&#39; error", "body": "<p>A UDF <a href=\"https://www.engineerexcel.com/intro-to-excel-vba-user-defined-functions/\" rel=\"nofollow noreferrer\">cannot modify the formatting of a cell or workbook or move values</a> around on a worksheet. \nIf you remove the  lines below, it should work.  </p>\n\n<pre><code>current.Range(\"T2\").Value = name\ncurrent.Range(\"U2\").Value = travelType\n</code></pre>\n\n<p><strong>Edit</strong>:<br>\nFor what you want to do, I think you should explore the sheet events, like <code>Worksheet_Change</code></p>\n"}], "owner": {"reputation": 1, "user_id": 10690889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f2c2f29c6c170cdeff6fb61c7815571?s=128&d=identicon&r=PG&f=1", "display_name": "Yaurav", "link": "https://stackoverflow.com/users/10690889/yaurav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560952878, "creation_date": 1560944622, "last_edit_date": 1560951076, "question_id": 56666909, "link": "https://stackoverflow.com/questions/56666909/user-defined-function-working-fine-in-vba-while-when-called-from-excel-sheet-sh", "title": "User defined function working fine in vba, while when called from excel sheet showing &#39;Value&#39; error", "body": "<p>I have made a function for calling from excel having two arguments of string type and returning integer value after counting numbers present in a particular range of excel sheet.</p>\n\n<p>This function is working properly when called from vba code, but showing 'Value' error when called from excel sheet</p>\n\n<p>I did change the arguments type to range. But it is still showing 'Value error'</p>\n\n<p>It is working in both the cases when i am just returning an integer value just by assigning, without using excel functions. But while using Excel functions in user defined function code, it is again showing 'Value' error.</p>\n\n<pre><code>Public Function countEvent(ByVal name As String, ByVal travelType As String) As Integer\n\n    Dim finalValue, tempValue, i As Integer\n    Dim rng As Range\n\n    Dim current As Worksheet\n    countEvent = 10\n    Set current = ActiveWorkbook.Worksheets(\"Sheet2\")\n    Set rng = current.Range(\"T4:T50000\")\n\n\n    'These two values are pasted in two cells in excel sheet, as these values are further being used by some other formula\n    current.Range(\"T2\").Value = name\n    current.Range(\"U2\").Value = travelType\n\n    countEvent = Application.WorksheetFunction.Count(rng)\n\nEnd Function\n</code></pre>\n\n<p>it has been defined to return the numbers in a particular range of the excel sheet, but showing 'Value error' in excel sheet</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1560948663, "post_id": 56666812, "comment_id": 99903894, "body": "Possibly the wrong website. Try <a href=\"https://codereview.stackexchange.com/\">code review</a> instead. And yes, it is a lot of code to process :)"}, {"owner": {"reputation": 1, "user_id": 11669981, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VV-1FzARLks/AAAAAAAAAAI/AAAAAAAAAEw/KXnDoFg6ZoQ/photo.jpg?sz=128", "display_name": "Wilco van der Helm", "link": "https://stackoverflow.com/users/11669981/wilco-van-der-helm"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1560955363, "post_id": 56666812, "comment_id": 99908162, "body": "Dank... ga ik het daar posten!"}], "owner": {"reputation": 1, "user_id": 11669981, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VV-1FzARLks/AAAAAAAAAAI/AAAAAAAAAEw/KXnDoFg6ZoQ/photo.jpg?sz=128", "display_name": "Wilco van der Helm", "link": "https://stackoverflow.com/users/11669981/wilco-van-der-helm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560955548, "creation_date": 1560944267, "last_edit_date": 1560955548, "question_id": 56666812, "link": "https://stackoverflow.com/questions/56666812/i-was-wondering-if-my-code-could-be-simpelfied", "title": "I was wondering if my code could be simpelfied", "body": "<p>I've created some code to let users fill in a excelsheet with 4 tables. by pressing a button it copies the table data to another workbook. it has to find the last row filled and copy the data below that. Some cells won't get filled so i used .Filldown to get the empty cells filled. In order to make the .Filldown work i had to count the rows in the tables.</p>\n\n<p>It all works but I'm new in VBA so i was wondering if my code can be simpelfied. It looks like a lot of code.</p>\n\n<pre><code>Private Sub CommandButton5_Click()\n\nDim PassWord As Variant\n\nPassWord = InputBox(\"Wachtwoord?\")\n'PassWord = \"Something\"\nIf PassWord = \"Something\" Then\n\nDim nT1 As Integer\nDim nT2 As Integer\nDim nT3 As Integer\nDim nT4 As Integer\n\n\nIf Sheets(\"Variabelen\").Range(\"H2\") = 0 Then\n\nSet Z = ActiveWorkbook.Sheets(1)\nSet T1 = ActiveSheet.ListObjects(\"Tabel1\").DataBodyRange\nSet T1C = ActiveSheet.ListObjects(\"Tabel1\")\n\nSet T2 = ActiveSheet.ListObjects(\"Tabel2\").DataBodyRange\nSet T2C = ActiveSheet.ListObjects(\"Tabel2\")\n\nSet T3 = ActiveSheet.ListObjects(\"Tabel3\").DataBodyRange\nSet T3C = ActiveSheet.ListObjects(\"Tabel3\")\n\nSet T4 = ActiveSheet.ListObjects(\"Tabel4\").DataBodyRange\nSet T4C = ActiveSheet.ListObjects(\"Tabel4\")\n\nnT1 = T1C.Range.Rows.Count - 1\nnT2 = T2C.Range.Rows.Count - 1\nnT3 = T3C.Range.Rows.Count - 1\nnT4 = T4C.Range.Rows.Count - 1\n\n'Test_ verwijderen als bestand actief wordt\nSet Y = Workbooks.Open(\"\\\\Somewhere\\Test_Masterbestand Afdeling.xlsx\")\n\n'Huidige medewerker in opleiding (T1)\n\n    lRow = Y.Worksheets(\"Data\").Cells(Y.Worksheets(\"Data\").Rows.Count, 1).End(xlUp).Row\n    lRow = lRow + 1\n    T1.Copy\n    Y.Worksheets(\"Data\").Range(\"A\" &amp; lRow).PasteSpecial Paste:=xlPasteValues\n    Application.CutCopyMode = False\n\n    Y.Sheets(\"Data\").Range(\"I\" &amp; lRow).Value = \"Huidige medewerker in opleiding\"\n    Y.Sheets(\"Data\").Range(\"J\" &amp; lRow).Value = Z.Range(\"C3\").Value\n    Y.Sheets(\"Data\").Range(\"K\" &amp; lRow).Value = Z.Range(\"C4\").Value\n    Y.Sheets(\"Data\").Range(\"L\" &amp; lRow).Value = Z.Range(\"C6\").Value\n\n        Dim LastRowA As Long\n        Dim LastRowB As Long\n        Dim LastRowC As Long\n        Dim LastRowD As Long\n        Dim LastRowE As Long\n\n        LastRowA = ActiveSheet.Range(\"A:A\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowB = ActiveSheet.Range(\"I:I\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowC = ActiveSheet.Range(\"J:J\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowD = ActiveSheet.Range(\"K:K\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowE = ActiveSheet.Range(\"L:L\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n        CopyrangeB = \"I\" &amp; LastRowB &amp; \":\" &amp; \"I\" &amp; LastRowA\n        CopyrangeC = \"J\" &amp; LastRowC &amp; \":\" &amp; \"J\" &amp; LastRowA\n        CopyrangeD = \"K\" &amp; LastRowD &amp; \":\" &amp; \"K\" &amp; LastRowA\n        CopyrangeE = \"L\" &amp; LastRowE &amp; \":\" &amp; \"L\" &amp; LastRowA\n\n        If nT1 &gt; 1 Then\n\n            ActiveSheet.Range(CopyrangeB).FillDown\n            ActiveSheet.Range(CopyrangeC).FillDown\n            ActiveSheet.Range(CopyrangeD).FillDown\n            ActiveSheet.Range(CopyrangeE).FillDown\n\n        End If\n\n'Nieuwe instroom in opleiding (T2)\n\n    lRow = Y.Worksheets(\"Data\").Cells(Y.Worksheets(\"Data\").Rows.Count, 1).End(xlUp).Row\n    lRow = lRow + 1\n    T2.Copy\n    Y.Worksheets(\"Data\").Range(\"A\" &amp; lRow).PasteSpecial Paste:=xlPasteValues\n    Application.CutCopyMode = False\n    Y.Sheets(\"Data\").Range(\"I\" &amp; lRow).Value = \"Nieuwe instroom in opleiding\"\n    Y.Sheets(\"Data\").Range(\"J\" &amp; lRow).Value = Z.Range(\"C3\").Value\n    Y.Sheets(\"Data\").Range(\"K\" &amp; lRow).Value = Z.Range(\"C4\").Value\n    Y.Sheets(\"Data\").Range(\"L\" &amp; lRow).Value = Z.Range(\"C6\").Value\n\n        Dim LastRowF As Long\n        Dim LastRowG As Long\n        Dim LastRowH As Long\n        Dim LastRowI As Long\n        Dim LastRowJ As Long\n\n        LastRowF = ActiveSheet.Range(\"A:A\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowG = ActiveSheet.Range(\"I:I\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowH = ActiveSheet.Range(\"J:J\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowI = ActiveSheet.Range(\"K:K\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowJ = ActiveSheet.Range(\"L:L\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n        CopyrangeG = \"I\" &amp; LastRowG &amp; \":\" &amp; \"I\" &amp; LastRowF\n        CopyrangeH = \"J\" &amp; LastRowH &amp; \":\" &amp; \"J\" &amp; LastRowF\n        CopyrangeI = \"K\" &amp; LastRowI &amp; \":\" &amp; \"K\" &amp; LastRowF\n        CopyrangeJ = \"L\" &amp; LastRowJ &amp; \":\" &amp; \"L\" &amp; LastRowF\n\n        If nT2 &gt; 1 Then\n\n            ActiveSheet.Range(CopyrangeG).FillDown\n            ActiveSheet.Range(CopyrangeH).FillDown\n            ActiveSheet.Range(CopyrangeI).FillDown\n            ActiveSheet.Range(CopyrangeJ).FillDown\n\n        End If\n\n'Afdelingspecifiek(T3)\n\n\n    lRow = Y.Worksheets(\"Data\").Cells(Y.Worksheets(\"Data\").Rows.Count, 1).End(xlUp).Row\n    lRow = lRow + 1\n    T3.Copy\n    Y.Worksheets(\"Data\").Range(\"A\" &amp; lRow).PasteSpecial Paste:=xlPasteValues\n    Application.CutCopyMode = False\n    Y.Sheets(\"Data\").Range(\"I\" &amp; lRow).Value = \"Afdelingspecifiek\"\n    Y.Sheets(\"Data\").Range(\"J\" &amp; lRow).Value = Z.Range(\"C3\").Value\n    Y.Sheets(\"Data\").Range(\"K\" &amp; lRow).Value = Z.Range(\"C4\").Value\n    Y.Sheets(\"Data\").Range(\"L\" &amp; lRow).Value = Z.Range(\"C6\").Value\n\n        Dim LastRowK As Long\n        Dim LastRowL As Long\n        Dim LastRowM As Long\n        Dim LastRowN As Long\n        Dim LastRowO As Long\n\n        LastRowK = ActiveSheet.Range(\"A:A\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowL = ActiveSheet.Range(\"I:I\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowM = ActiveSheet.Range(\"J:J\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowN = ActiveSheet.Range(\"K:K\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowO = ActiveSheet.Range(\"L:L\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n        CopyrangeL = \"I\" &amp; LastRowL &amp; \":\" &amp; \"I\" &amp; LastRowK\n        CopyrangeM = \"J\" &amp; LastRowM &amp; \":\" &amp; \"J\" &amp; LastRowK\n        CopyrangeN = \"K\" &amp; LastRowN &amp; \":\" &amp; \"K\" &amp; LastRowK\n        CopyrangeO = \"L\" &amp; LastRowO &amp; \":\" &amp; \"L\" &amp; LastRowK\n\n        If nT3 &gt; 1 Then\n\n            ActiveSheet.Range(CopyrangeL).FillDown\n            ActiveSheet.Range(CopyrangeM).FillDown\n            ActiveSheet.Range(CopyrangeN).FillDown\n            ActiveSheet.Range(CopyrangeO).FillDown\n\n        End If\n\n'Individueel (T4)\n\n    lRow = Y.Worksheets(\"Data\").Cells(Y.Worksheets(\"Data\").Rows.Count, 1).End(xlUp).Row\n    lRow = lRow + 1\n    T4.Copy\n    Y.Worksheets(\"Data\").Range(\"A\" &amp; lRow).PasteSpecial Paste:=xlPasteValues\n    Y.Sheets(\"Data\").Range(\"I\" &amp; lRow).Value = \"Individueel\"\n    Y.Sheets(\"Data\").Range(\"J\" &amp; lRow).Value = Z.Range(\"C3\").Value\n    Y.Sheets(\"Data\").Range(\"K\" &amp; lRow).Value = Z.Range(\"C4\").Value\n    Y.Sheets(\"Data\").Range(\"L\" &amp; lRow).Value = Z.Range(\"C6\").Value\n    Application.CutCopyMode = False\n\n        Dim LastRowP As Long\n        Dim LastRowQ As Long\n        Dim LastRowR As Long\n        Dim LastRowS As Long\n        Dim LastRowT As Long\n\n        LastRowP = ActiveSheet.Range(\"A:A\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowQ = ActiveSheet.Range(\"I:I\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowR = ActiveSheet.Range(\"J:J\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowS = ActiveSheet.Range(\"K:K\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowT = ActiveSheet.Range(\"L:L\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        LastRowU = ActiveSheet.Range(\"N:N\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n        CopyrangeQ = \"I\" &amp; LastRowQ &amp; \":\" &amp; \"I\" &amp; LastRowP\n        CopyrangeR = \"J\" &amp; LastRowR &amp; \":\" &amp; \"J\" &amp; LastRowP\n        CopyrangeS = \"K\" &amp; LastRowS &amp; \":\" &amp; \"K\" &amp; LastRowP\n        CopyrangeT = \"L\" &amp; LastRowT &amp; \":\" &amp; \"L\" &amp; LastRowP\n        'Formule in Kolom M\n        CopyrangeU = \"N\" &amp; LastRowU &amp; \":\" &amp; \"N\" &amp; LastRowP\n\n        If nT4 &gt; 1 Then\n\n            ActiveSheet.Range(CopyrangeQ).FillDown\n            ActiveSheet.Range(CopyrangeR).FillDown\n            ActiveSheet.Range(CopyrangeS).FillDown\n            ActiveSheet.Range(CopyrangeT).FillDown\n            ActiveSheet.Range(CopyrangeU).FillDown\n\n        End If\n\n   ' Y.Close (True)\n\n'Quote weghalen bij opleveren\n'Sheets(\"Variabelen\").Range(\"H2\").Value = Sheets(\"Variabelen\").Range(\"H2\").Value + 1\nElse\nMsgBox (\"Niet nog een keer Sylvia!!!!\")\nEnd If\n\nElse\n'Do nothing\nEnd If\nEnd Sub\n</code></pre>\n\n<p>None</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1560942166, "post_id": 56666083, "comment_id": 99900115, "body": "What does the error message say?"}, {"owner": {"reputation": 365, "user_id": 11242931, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8jEB_inuMFE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reEQQudwBIizTlMKFGuOk16ywj7mA/mo/photo.jpg?sz=128", "display_name": "Jj Blevins", "link": "https://stackoverflow.com/users/11242931/jj-blevins"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 1, "creation_date": 1560942335, "post_id": 56666083, "comment_id": 99900204, "body": "@StavrosJon that the element was moved."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1560944746, "post_id": 56666083, "comment_id": 99901586, "body": "This works for me as well... change <code>.send</code> to <code>.display</code> and see what the email you are sending actually contains."}, {"owner": {"reputation": 365, "user_id": 11242931, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8jEB_inuMFE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reEQQudwBIizTlMKFGuOk16ywj7mA/mo/photo.jpg?sz=128", "display_name": "Jj Blevins", "link": "https://stackoverflow.com/users/11242931/jj-blevins"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1560944866, "post_id": 56666083, "comment_id": 99901660, "body": "@rohrl77 Did it and it contains all the thinks I want, exactly as I want them to be. Also, for the first adress it does work and the e-mail is send correctly."}], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 11242931, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8jEB_inuMFE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reEQQudwBIizTlMKFGuOk16ywj7mA/mo/photo.jpg?sz=128", "display_name": "Jj Blevins", "link": "https://stackoverflow.com/users/11242931/jj-blevins"}, "edited": false, "score": 0, "creation_date": 1560945063, "post_id": 56666989, "comment_id": 99901768, "body": "It shows everything correctly but still, your code gives me same error message once I change it to <code>.send</code>"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 365, "user_id": 11242931, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8jEB_inuMFE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reEQQudwBIizTlMKFGuOk16ywj7mA/mo/photo.jpg?sz=128", "display_name": "Jj Blevins", "link": "https://stackoverflow.com/users/11242931/jj-blevins"}, "edited": false, "score": 0, "creation_date": 1560945930, "post_id": 56666989, "comment_id": 99902292, "body": "I updated my answer... try the new code. See explanation in update."}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 2, "last_activity_date": 1560945905, "last_edit_date": 1560945905, "creation_date": 1560944914, "answer_id": 56666989, "question_id": 56666083, "link": "https://stackoverflow.com/questions/56666083/sending-e-mail-with-addresses-in-worksheet-column/56666989#56666989", "title": "Sending e-mail with addresses in worksheet column", "body": "<p>My guess that the second line you are trying to send might have an error. Therefore, use the code below and check what it shows in the Immediate window.</p>\n\n<p>UPDATE:\nI've added the <code>CreateItem</code> line within the <code>For</code> loop and am resetting it for each mail. Possible it is the mail item that the error message is complaining about.</p>\n\n<pre><code>Sub EmailSend()\n\nDim objOutlook As Object\nDim objMail As Object\nDim i As Integer\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\n\nFor i = 1 To 10\nSet objMail = objOutlook.CreateItem(0)\n\nWith objMail\n    Debug.Print Sheets(\"Test\").Range(\"A\" &amp; i).Value\n   .to = Sheets(\"Test\").Range(\"A\" &amp; i).Value\n   .Subject = \"hi\"\n   .body = _\n      \"Hi \" &amp; Sheets(\"Test\").Range(\"B\" &amp; i) &amp; Sheets(\"links\").Range(\"G\" &amp; 1)\n   .display\n   '.send\nEnd With\nSet objMail = Nothing\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 11242931, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8jEB_inuMFE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reEQQudwBIizTlMKFGuOk16ywj7mA/mo/photo.jpg?sz=128", "display_name": "Jj Blevins", "link": "https://stackoverflow.com/users/11242931/jj-blevins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 56666989, "answer_count": 1, "score": 1, "last_activity_date": 1608401058, "creation_date": 1560941905, "last_edit_date": 1608401058, "question_id": 56666083, "link": "https://stackoverflow.com/questions/56666083/sending-e-mail-with-addresses-in-worksheet-column", "title": "Sending e-mail with addresses in worksheet column", "body": "<p>I have a sheet called &quot;Test&quot; where column A is a list of e-mail addresses.<br />\nI want to send an e-mail to all addresses.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub EmailSend()\n    \n    Dim objOutlook As Object\n    Dim objMail As Object\n    Dim i As Integer\n    \n    Set objOutlook = CreateObject(&quot;Outlook.Application&quot;)\n    Set objMail = objOutlook.CreateItem(0)\n    \n    For i = 1 To 10\n        With objMail\n           .to = Sheets(&quot;Test&quot;).Range(&quot;A&quot; &amp; i).Value\n           .Subject = &quot;hi&quot;\n           .body = _ \n              &quot;Hi &quot; &amp; Sheets(&quot;Test&quot;).Range(&quot;B&quot; &amp; i) &amp; Sheets(&quot;links&quot;).Range(&quot;G&quot; &amp; 1)\n           .send\n        End With\n    Next i\n    \nEnd Sub\n</code></pre>\n<p>The macro sends an e-mail to the address in A1 and then an error</p>\n<blockquote>\n<p>element was moved or deleted.</p>\n</blockquote>\n<p>appears in the line</p>\n<pre><code>.to = Sheets(&quot;Test&quot;).Range(&quot;A&quot; &amp; i).Value\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 2, "creation_date": 1560942550, "post_id": 56665979, "comment_id": 99900320, "body": "Would it be possible to share a valid container number?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1560943744, "post_id": 56665979, "comment_id": 99901021, "body": "Yes sure. TCNU4171692"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "edited": false, "score": 0, "creation_date": 1560947519, "post_id": 56667531, "comment_id": 99903178, "body": "Does it work for you? Is the data scrapped on a worksheet?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1560947688, "post_id": 56667531, "comment_id": 99903280, "body": "Yes. I wouldn&#39;t post it otherwise ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "edited": false, "score": 0, "creation_date": 1560947857, "post_id": 56667531, "comment_id": 99903377, "body": "Shows error &#39;91&#39;: Object variable or with block variable not set on  Set table = div.getElementsByTagName(&quot;table&quot;)(0)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "edited": false, "score": 0, "creation_date": 1560947924, "post_id": 56667531, "comment_id": 99903413, "body": "Sorry, I&#39;m a beginner and I don&#39;t know how to figure this out ;) Will try once again"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "edited": false, "score": 0, "creation_date": 1560948708, "post_id": 56667531, "comment_id": 99903925, "body": "Wow, this is exactly what I want. Could you please tell me how you stored the HTML locally?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1560950172, "post_id": 56667531, "comment_id": 99904872, "body": "@RonitAgarwal I thought that getting the HTML was not an issue for you, since as you said you have successfully extracted info. Anyway, I updated the code. It uses a different, more efficient approach, than using IE."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1560952590, "post_id": 56667531, "comment_id": 99906404, "body": "@RonitAgarwal  Glad I could help. Please consider accepting the answer."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1560953108, "post_id": 56667531, "comment_id": 99906758, "body": "You&#39;ve hard coded the event validation and view state as well which will almost certainly change at some point - just so OP is aware."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "edited": false, "score": 0, "creation_date": 1561013013, "post_id": 56667531, "comment_id": 99926686, "body": "@StavrosJon Sure. Thanks again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1561013062, "post_id": 56667531, "comment_id": 99926712, "body": "@QHarr Hi. Is there anything I can do to make this better?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1561013273, "post_id": 56667531, "comment_id": 99926812, "body": "Dimension an array according to the table dimensions and populate that. Then write that out once to the worksheet to reduce i/o with sheet. See if ev and vs can accurately be captured from prior request.  Early bound is quicker but does require, in this instance, for all users to have the ability to check the HTML Object Library in references. The answer above is very good though. +"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "edited": false, "score": 0, "creation_date": 1561017010, "post_id": 56667531, "comment_id": 99928555, "body": "Absolutely. This works perfectly. I just didn&#39;t understand the hard coding of view state, hence asked. Anyway, thanks for your help."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "edited": false, "score": 0, "creation_date": 1562603751, "post_id": 56667531, "comment_id": 100418580, "body": "Hi @StavrosJon. Can we possible bypass captcha when we try to scrape data?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1562649932, "post_id": 56667531, "comment_id": 100431056, "body": "@RonitAgarwal That&#39;s a good one..I suggest you post a new question about it providing more details ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "edited": false, "score": 0, "creation_date": 1562755197, "post_id": 56667531, "comment_id": 100474458, "body": "@StavrosJon I read about it. People have shared major concerns ;) Also the viewstate and eventvalidation changes frequently. Do I just copy the whole viewstate and eventvalidation from the HTML code in the VBA code?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "edited": false, "score": 0, "creation_date": 1564567656, "post_id": 56667531, "comment_id": 101071171, "body": "@StavrosJon I know it&#39;s annoying but this is the last help I seek to run this code. The original lot of 40 containers which also contains the container number I gave as a sample to you runs perfectly. All the 40 containers are updated on one click. The problem arises when I take a different lot which is obviously due to change in event validation and viewstate. I read and tried reading about extracting it but I am a beginner and hence could not execute it. If only you can guide me?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1564570955, "post_id": 56667531, "comment_id": 101073038, "body": "@RonitAgarwal go to your browser&#39;s developer tools and inspect the network traffic (CTRL+ Shift + E if you&#39;re using firefox) when you hit the <code>Submit Query</code> button. The first request that pops up is a POST request. It&#39;s the same request as the one we are sending via VBA in the code above. If you inspect this request you will see its parameters among which are the event validation and viewstate. You can copy the strings from there and update the code."}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 1, "last_activity_date": 1560949776, "last_edit_date": 1592644375, "creation_date": 1560946925, "answer_id": 56667531, "question_id": 56665979, "link": "https://stackoverflow.com/questions/56665979/how-do-i-extract-information-inside-nested-div-from-website-with-vba/56667531#56667531", "title": "How do I extract information inside nested div from website with VBA?", "body": "<p>Here's a general way to printout the entire HTML table into a worksheet:</p>\n<pre><code>Sub ScrapeContainerInfo()\nDim req As New WinHttpRequest\nDim doc As New HTMLDocument\nDim div As HTMLDivElement\nDim table As HTMLTable\nDim tableRow As HTMLTableRow\nDim tableCell As HTMLTableCell\nDim sht As Worksheet\nDim i As Long, j As Long\nDim url As String, containerNumber As String, reqBody As String\n\n\nSet sht = ThisWorkbook.Worksheets(&quot;Sheet2&quot;)\ncontainerNumber = &quot;TCNU4171692&quot;\nurl = &quot;http://www.concorindia.com/containerquery.aspx&quot;\nreqBody = &quot;__VIEWSTATE=%2FwEPDwULLTE1Njk0Mzk4MzkPZBYCAgoPZBYEAgEPDxYCHgdWaXNpYmxlaGRkAgMPZBYEAgMPEGRkFgFmZAIFDw9kFgIeB29uY2xpY2sFIWphdmFzY3JpcHQ6ZXJyPXRlc3QoKTtyZXR1cm4gZXJyO2RkS1KgJsS2Kb22YOy%2FEN0XTBRc8lY%3D&amp;__EVENTVALIDATION=%2FwEWBgKk%2BrO6AwKhk42ICgKmqIGHDAKbyfWzBQLvyamyBQKxlra5AfFIxQQ%2BvdUNsDciaOk4g0LyycSG&amp;contno=&quot; &amp; containerNumber &amp; &quot;&amp;drpimpexp=Any&amp;CONTButton1=Submit+Query&quot;\n\nWith req\n    .Open &quot;POST&quot;, url, False\n    .setRequestHeader &quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;\n    .send reqBody\n    doc.body.innerHTML = .responseText\nEnd With\nSet div = doc.getElementById(&quot;PPosition&quot;)\nSet table = div.getElementsByTagName(&quot;table&quot;)(0)\n\ni = 1\nFor Each tableRow In table.Rows\n    i = i + 1\n    j = 1\n    For Each tableCell In tableRow.Cells\n        j = j + 1\n        sht.Cells(i, j) = tableCell.innerText\n    Next tableCell\n\nNext tableRow\n\nEnd Sub\n</code></pre>\n<p>References used: <code>Microsoft HTML Object Library</code> and <code>Micrsoft WinHTTP Services Version 5.1</code></p>\n<p>The output looks like that:</p>\n<p><a href=\"https://i.stack.imgur.com/E2xMh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E2xMh.jpg\" alt=\"enter image description here\" /></a></p>\n<p>Now, if you want to access the table's info in a more targeted way you ca do it like so:</p>\n<pre><code>Debug.Print table.Rows(1).Cells(0).innerText\n</code></pre>\n<p>The code above prints the first cell of the second row of the table, in the immediate window. You can modify it accordingly to access any cell, keeping in mind that the index starts from <code>0</code>.</p>\n<p><strong>EDIT</strong></p>\n<p>I mistakenly thought that getting the actual HTML response was not an issue, but since it apparently is, I have updated the code to include the HTTP request that needs to be sent. I avoid using IE whenever it's possible.</p>\n<p>I have hardcoded one specific container number. This can easily be modified to loop through multiple container numbers.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11669760"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 56667531, "answer_count": 1, "score": -1, "last_activity_date": 1564188031, "creation_date": 1560941549, "last_edit_date": 1564188031, "question_id": 56665979, "link": "https://stackoverflow.com/questions/56665979/how-do-i-extract-information-inside-nested-div-from-website-with-vba", "title": "How do I extract information inside nested div from website with VBA?", "body": "<p>I would like to scrape information from a table inside a <code>div</code> element. </p>\n\n<pre><code>Sub Test1()\n    Dim IE As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    IE.Visible = True\n    IE.navigate \"http://www.concorindia.com/containerquery.aspx\"\n\n    Do While IE.Busy\n        Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n\n    Set Doc = IE.document\n\n    IE.document.getElementById(\"contno\").Value = ThisWorkbook.Sheets(\"Status\").Range(\"B3\").Value\n    Doc.getElementById(\"CONTButton1\").Click       \n\n    Set Data = Doc.getElementById(\"PPosition\")\n\nEnd Sub\n</code></pre>\n\n<p>I intended to extract the information inside div element by getting all the data inside the div id \"PPosition\" first but the message box shows</p>\n\n<blockquote>\n  <p>error 13: Type Mismatch</p>\n</blockquote>\n\n<p>How can I get information inside the table mentioned in the code like train number, originating status, etc.?</p>\n\n<p>Sample container number - TCNU4171692  </p>\n\n<p>The website from which the data is to be scrapped is also mentioned in the code. (<a href=\"http://www.concorindia.com/containerquery.aspx\" rel=\"nofollow noreferrer\">http://www.concorindia.com/containerquery.aspx</a>)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 11668632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b343b8c4e33f8ee8c5421a908a7f8505?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant", "link": "https://stackoverflow.com/users/11668632/hemant"}, "edited": false, "score": 0, "creation_date": 1560940896, "post_id": 56665689, "comment_id": 99899460, "body": "Dear all please help me to get that this is very important for me to kno :("}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560944219, "post_id": 56665689, "comment_id": 99901281, "body": "This is not possible. VBA has no built in function to do that. You could try to use the acrobat library to control it better. But I think you will need the full Acrobat (not the Reader) for this functionality."}], "owner": {"reputation": 1, "user_id": 11668632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b343b8c4e33f8ee8c5421a908a7f8505?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant", "link": "https://stackoverflow.com/users/11668632/hemant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560941019, "creation_date": 1560940595, "last_edit_date": 1560941019, "question_id": 56665689, "link": "https://stackoverflow.com/questions/56665689/wait-till-pdf-file-open-and-wait-till-pdf-file-close-without-giving-any-specif", "title": "Wait till PDF file Open and Wait till PDF file Close - Without giving any specific time in program to wait", "body": "<p>I have one VBA Code that opens the file copy the data inside it and paste it in excel file and then closes the pdf file....but Many times pdf file couldn't open or close in given specified time in program (i.e Wait Time)</p>\n\n<p>Aim - I want to modify my VBA Code such as macro should wait till pdf file open and till it closes so that no any pdf will skip from opening and no any pdf will remain open on my desktop that is making my Code to misbehave.</p>\n\n<p>Please HELP...</p>\n\n<p>MY CURRENT VBA CODE IS -</p>\n\n<pre><code>Sub Shell_Copy_Paste()\n\nOn Error Resume Next\n\n   Dim o As Variant\n\n   Dim i As Long\n\n   Worksheets(\"sheet1\").Activate\n\n   For i = 2 To Range(\"A1\").End(xlDown).Row\n\n\n   o = Shell(Cells(i, 1), vbNormalFocus)\n\n\n   Application.Wait (Now + TimeSerial(0, 0, 2)) 'Wait for Acrobat to load\n\n\n   SendKeys \"^a\"   'Select All\n\n   SendKeys \"^c\"   'Copy\n\n   SendKeys \"%{F4}\"    'Close shell application\n\n   Application.Wait (Now + TimeSerial(0, 0, 2))\n\n   Worksheets(\"Sheet2\").Activate\n\n    Worksheets(\"Sheet2\").Paste\n\n   SendKeys \"^v\"   'Paste\n\n   Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n\n   Worksheets(\"sheet1\").Activate\n\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560943344, "post_id": 56665269, "comment_id": 99900766, "body": "correct, either update entries or insert the new ones"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560943563, "post_id": 56665269, "comment_id": 99900897, "body": "Then remove the join in update! That causes the read only. Use a sub select."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560943765, "post_id": 56665269, "comment_id": 99901031, "body": "Or import table (not link) , create pk, update."}, {"owner": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560944654, "post_id": 56665269, "comment_id": 99901523, "body": "How can you exchange the inner join for a subselect way? (Would like to stay with the linked table)"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560944745, "post_id": 56665269, "comment_id": 99901585, "body": "Just try, I am noz sure. But at least you can create a recordset and update with its values."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560945060, "post_id": 56665269, "comment_id": 99901767, "body": "OK, maybe not <a href=\"https://stackoverflow.com/questions/1375207/how-do-i-perform-update-query-with-subquery-in-access\" title=\"how do i perform update query with subquery in access\">stackoverflow.com/questions/1375207/&hellip;</a>. but recordset should do it."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560949874, "post_id": 56665269, "comment_id": 99904686, "body": "Answer completed. Maybe parameter type needs to be changed to your needs."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560952618, "post_id": 56665269, "comment_id": 99906421, "body": "Any reason, not to use<code>.Execute</code>for insert query too?<code>DoCmd.SetWarnings False</code> may be surprising ;)"}, {"owner": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560952902, "post_id": 56665269, "comment_id": 99906630, "body": "just put it together &quot;quick and dirty&quot; ... so yeah, might be an improvement to move that stuff inside the &quot;With currentDB&quot; loop too"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1560953992, "post_id": 56665269, "comment_id": 99907301, "body": "Avoid<code>DoCmd</code>especially with<code>SetWarnings False</code> ,ignorance  is not bliss;), Use <a href=\"https://rubberduckvba.wordpress.com/2019/05/22/on-error-resume-next/\" rel=\"nofollow noreferrer\">On Error Resume Next</a> and Err object to decide if warning is important or not."}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "edited": false, "score": 0, "creation_date": 1560940801, "post_id": 56665539, "comment_id": 99899426, "body": "As far as I know there isn&#39;t a primary key within the linked table (it is a really old dbf database but unfortunately we can&#39;t switch to a SQL one before 2020).  My idea was to link the table using VBA, copy / update a local table and unlink the table. I have to avoid any changes to the linked table as it will be accessed and changed by another department."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "edited": false, "score": 1, "creation_date": 1560940899, "post_id": 56665539, "comment_id": 99899462, "body": "Then just start by making a full copy of the table, don&#39;t execute an update with a linked table involved. Simple as that."}, {"owner": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "edited": false, "score": 0, "creation_date": 1560942848, "post_id": 56665539, "comment_id": 99900480, "body": "correct, I&#39;ve got a local table, import 2 columns from the linked table and either update or create the entries inside the local table and disconnect the linked table for safety reasons"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "edited": false, "score": 0, "creation_date": 1560943112, "post_id": 56665539, "comment_id": 99900629, "body": "If the table has only these two columns, an alternate approach might be: use a <code>DELETE</code> query to delete already occurring rows, then use the insert query to insert all rows. If there are additional columns you want to leave unaffected, that&#39;s not an option, of course."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "edited": false, "score": 1, "creation_date": 1560943735, "post_id": 56665539, "comment_id": 99901012, "body": "Btw, I opened up an issue about this <a href=\"https://access.uservoice.com/forums/319956-access-desktop-application/suggestions/37955803\" rel=\"nofollow noreferrer\">on Access UserVoice</a>. It&#39;s a common and restrictive limitation of the Access database engine, and often generates questions."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1560940081, "creation_date": 1560940081, "answer_id": 56665539, "question_id": 56665269, "link": "https://stackoverflow.com/questions/56665269/access-update-local-table-with-linked-table-but-without-primary-key/56665539#56665539", "title": "Access - Update local table with linked table (but without primary key)", "body": "<p>You can't do that.</p>\n\n<p>Linked tables on other data sources than Access itself require a primary key to support updates.</p>\n\n<p>When linking through the GUI, Access does allow you to specify an alternate key that uniquely identifies rows if there is no primary key, but if there is one that should be your primary key.</p>\n"}, {"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "edited": false, "score": 0, "creation_date": 1560952015, "post_id": 56667682, "comment_id": 99906025, "body": "Parameter types match tables fields? BEL_PLZ.Bez has less or equal 255 chars?"}, {"owner": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "edited": false, "score": 0, "creation_date": 1560952264, "post_id": 56667682, "comment_id": 99906188, "body": "yeah, &quot;Bez&quot; has always less than 255 chars due some restrictions in our planing software"}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": true, "score": 1, "last_activity_date": 1560949684, "last_edit_date": 1560949684, "creation_date": 1560947408, "answer_id": 56667682, "question_id": 56665269, "link": "https://stackoverflow.com/questions/56665269/access-update-local-table-with-linked-table-but-without-primary-key/56667682#56667682", "title": "Access - Update local table with linked table (but without primary key)", "body": "<p>Create a recordset from read only table to get values.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim qdf As DAO.QueryDef\nWith CurrentDb\n    With .OpenRecordset(\"SELECT ext_BEL_PLZ.NR, ext_BEL_PLZ.BEZ \" &amp; _\n                        \"FROM ext_BEL_PLZ INNER JOIN BEL_PLZ ON BEL_PLZ.NR = ext_BEL_PLZ.NR\", dbOpenSnapshot)\n        Set qdf = .Parent.CreateQueryDef(vbNullString)\n        qdf.SQL = \"PARAMETERS paraBEZ Text ( 255 ), paraNr Long;\" &amp; _\n                       \"Update BEL_PLZ Set BEL_PLZ.BEZ = [paraBEZ] \" &amp; _\n                       \"Where BEL_PLZ.NR = [paraNr]\"\n        Do Until .EOF\n             qdf.Parameters(\"paraBez\") = .Fields(\"BEZ\").Value\n             qdf.Parameters(\"paraNr\") = .Fields(\"NR\").Value\n             qdf.Execute dbFailOnError\n             .MoveNext\n        Loop\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 2094232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd3a768d96a44c0de34fd1ebe2240038?s=128&d=identicon&r=PG", "display_name": "Moritz", "link": "https://stackoverflow.com/users/2094232/moritz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 56667682, "answer_count": 2, "score": 2, "last_activity_date": 1560951795, "creation_date": 1560939203, "last_edit_date": 1560951795, "question_id": 56665269, "link": "https://stackoverflow.com/questions/56665269/access-update-local-table-with-linked-table-but-without-primary-key", "title": "Access - Update local table with linked table (but without primary key)", "body": "<p>I've got a little ACCESS tool where I want to read a linked table and update the local one. Import new entries works like a charm but when I try to update an existing one it always throws an exception (runtime error 3073).</p>\n\n<p>This is my code</p>\n\n<pre><code>Sub UpdateBLPNR()\nWith CurrentDb\n    Set tdf = .CreateTableDef(\"ext_BEL_PLZ\")\n    tdf.Connect = \"ODBC;DSN=EasyProd PPS;DataDirectory=PATH;SERVER=NotTheServer;Compression= ;DefaultType=FoxPro;Rows=False;Language=OEM;AdvantageLocking=ON;Locking=Record;MemoBlockSize=64;MaxTableCloseCache=5;ServerTypes=6;TrimTrailingSpaces=False;EncryptionType=RC4;FIPS=False\"\n    tdf.SourceTableName = \"BEL_PLZ\"\n    .TableDefs.Append tdf\n    .TableDefs.Refresh\nEnd With\n\nDim SQLUpdate As String\nDim SQLInsert As String\nSQLUpdate = \"UPDATE BEL_PLZ \" &amp; _\n            \"INNER JOIN ext_BEL_PLZ \" &amp; _\n            \"ON(BEL_PLZ.NR = ext_BEL_PLZ.NR) \" &amp; _\n            \"SET BEL_PLZ.BEZ = ext_BEL_PLZ.BEZ \"\nSQLInsert = \"INSERT INTO BEL_PLZ (NR,BEZ) \" &amp; _\n            \"SELECT NR,BEZ FROM ext_BEL_PLZ t \" &amp; _\n            \"WHERE NOT EXISTS(SELECT 1 FROM BEL_PLZ s \" &amp; _\n            \"WHERE t.NR = s.NR) \"\nDoCmd.SetWarnings False\nDoCmd.RunSQL (SQLUpdate)\nDoCmd.RunSQL (SQLInsert)\nDoCmd.SetWarnings True\n\nDoCmd.DeleteObject acTable, \"ext_BEL_PLZ\"\nEnd Sub\n</code></pre>\n\n<p>Already figured out that Access might have some problems using a linked table to update a local one but I can't figure out a workaround.</p>\n\n<p>(SQLInsert is working, SQLUpdate is killing me)</p>\n\n<p>this is my final and working solution (thanks to ComputerVersteher)--></p>\n\n<pre><code>Sub UpdateBLPNR()\n'Define Variables\nDim SQLUpdate As String\nDim SQLInsert As String\nDim qdf As DAO.QueryDef\n'Create temporary table and update entries\nWith CurrentDb\n    Set tdf = .CreateTableDef(\"ext_BEL_PLZ\")\n    tdf.Connect = \"ODBC;DSN=EasyProd PPS;DataDirectory=PATH;SERVER=NotTheServer;Compression= ;DefaultType=FoxPro;Rows=False;Language=OEM;AdvantageLocking=ON;Locking=Record;MemoBlockSize=64;MaxTableCloseCache=5;ServerTypes=6;TrimTrailingSpaces=False;EncryptionType=RC4;FIPS=False\"\n    tdf.SourceTableName = \"BEL_PLZ\"\n    .TableDefs.Append tdf\n    .TableDefs.Refresh\n     With .OpenRecordset(\"SELECT ext_BEL_PLZ.NR, ext_BEL_PLZ.BEZ \" &amp; _\n                        \"FROM ext_BEL_PLZ INNER JOIN BEL_PLZ ON BEL_PLZ.NR = ext_BEL_PLZ.NR\", dbOpenSnapshot)\n        Set qdf = .Parent.CreateQueryDef(\"\")\n        Do Until .EOF\n             qdf.sql = \"PARAMETERS paraBEZ Text ( 255 ), paraNr Text ( 255 );\" &amp; _\n                       \"Update BEL_PLZ Set BEL_PLZ.BEZ = [paraBEZ] \" &amp; _\n                       \"Where BEL_PLZ.NR = [paraNr]\"\n             qdf.Parameters(\"paraBez\") = .Fields(\"BEZ\").Value\n             qdf.Parameters(\"paraNr\") = .Fields(\"NR\").Value\n             qdf.Execute dbFailOnError\n             .MoveNext\n        Loop\n    End With\nEnd With\n'Run SQL Query (Insert)\nSQLInsert = \"INSERT INTO BEL_PLZ (NR,BEZ) \" &amp; _\n            \"SELECT NR,BEZ FROM ext_BEL_PLZ t \" &amp; _\n            \"WHERE NOT EXISTS(SELECT 1 FROM BEL_PLZ s \" &amp; _\n            \"WHERE t.NR = s.NR) \"\nDoCmd.SetWarnings False\nDoCmd.RunSQL (SQLInsert)\nDoCmd.SetWarnings True\n'Drop temporary table\nDoCmd.DeleteObject acTable, \"ext_BEL_PLZ\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560941933, "post_id": 56665229, "comment_id": 99900007, "body": "Why don*t you delete from subforms recoordset? Where is the button (sub or parent)?"}, {"owner": {"reputation": 1, "user_id": 8035636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d147c4eb42f3086e4adfd8d7fc005bf?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Graf", "link": "https://stackoverflow.com/users/8035636/stephan-graf"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560942880, "post_id": 56665229, "comment_id": 99900508, "body": "Its on the subform. But its not strictly speaking a deletion rather i set the record to inactiv and then it gets filtered out by the query which is the datasource of the subform..."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1560943013, "post_id": 56665229, "comment_id": 99900580, "body": "Use<code>Me.Requery</code>after the update of inactive flag at end of button."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8035636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d147c4eb42f3086e4adfd8d7fc005bf?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Graf", "link": "https://stackoverflow.com/users/8035636/stephan-graf"}, "edited": false, "score": 0, "creation_date": 1560958065, "post_id": 56666550, "comment_id": 99909955, "body": "at the time of this event the recordsource is not yet updated it takes some time. Since i didn&#39;t manage to put a delay I ended up using a timer but with a condition as you suggested: ``` Private Sub Form_Timer()     On Error GoTo done         If Me!active.value =False Then             Me.Recalc         End If done:     Exit Sub End Sub ```"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 8035636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d147c4eb42f3086e4adfd8d7fc005bf?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Graf", "link": "https://stackoverflow.com/users/8035636/stephan-graf"}, "edited": false, "score": 0, "creation_date": 1560962291, "post_id": 56666550, "comment_id": 99912002, "body": "Uh, a timer should be avoided. Try the <i>AfterUpdate</i> of the checkbox itself."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1560962289, "last_edit_date": 1560962289, "creation_date": 1560943408, "answer_id": 56666550, "question_id": 56665229, "link": "https://stackoverflow.com/questions/56665229/subform-doesnt-requery/56666550#56666550", "title": "Subform doesn&#39;t requery", "body": "<p>Try using the <em>AfterUpdate</em> event of the subform:</p>\n\n<pre><code>Private Sub Form_AfterUpdate()\n    If Me!Active.Value = False Then\n        Me.Requery\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong>. Or:</p>\n\n<pre><code>Private Sub Active_AfterUpdate()\n    If Me!Active.Value = False Then\n        Me.Dirty = False\n        Me.Requery\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8035636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d147c4eb42f3086e4adfd8d7fc005bf?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Graf", "link": "https://stackoverflow.com/users/8035636/stephan-graf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560962289, "creation_date": 1560939071, "last_edit_date": 1560941869, "question_id": 56665229, "link": "https://stackoverflow.com/questions/56665229/subform-doesnt-requery", "title": "Subform doesn&#39;t requery", "body": "<p>I have a acces Form in which you can select a User with a dropdown\nThen i have a subform with all the licenses of that user.\nThe licenses can be removed from that user with a button.\nAfter a license has ben removed i want to refresh the form, so that it actually disapears.</p>\n\n<p>I think the Form_Dirty Event is the right one to trigger the refresh.\nI tried:</p>\n\n<pre><code>Private Sub Form_Dirty(Cancel As Integer)\n    MsgBox \"deleted a license\"\nEnd Sub\n</code></pre>\n\n<p>and the box shows up on every deletion. so i know that event fires. perfect.\nBuuuut whatever refresh command i put into that function it doesnt refresh.\nI tried:</p>\n\n<pre><code>    Me.requery\n    Me.Recalc\n    Me.refresh\n    Forms.user.Form.requery\n    Forms.user.licenses.Form.requery\n</code></pre>\n\n<p>it just stays the same.\nIf i press F5 then it refreshes.\nHow can that be?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 0, "last_activity_date": 1560941105, "last_edit_date": 1560941105, "creation_date": 1560939656, "answer_id": 56665415, "question_id": 56665100, "link": "https://stackoverflow.com/questions/56665100/count-filtered-rows-using-vba/56665415#56665415", "title": "Count filtered rows using VBA", "body": "<p>To count the rows that are visible after applying a filter you would have to do this:</p>\n\n<pre><code>Sub countNonFiltered()\n\nDim sht As Worksheet\nDim colIndex As Long\nDim firstrow As Long\nDim RowCount As Long\nSet sht = ThisWorkbook.Worksheets(\"worksheet name\")\ncolIndex = 1    'let's assume you're interested in column A\nfirstrow = 2    'Let's assume your header is in row 1 and the data starts from row 2\n\nWith sht\n    RowCount = .Range(.Cells(Rows.Count, 1).End(xlUp), .Cells(firstrow, colIndex)).SpecialCells(xlCellTypeVisible).Count\n    Debug.Print RowCount\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>For demonstration purposes the code above prints the number of the visible rows in the immediate window.</p>\n\n<p>Keep in mind that this:</p>\n\n<pre><code>Cells(Rows.Count, colIndex).End(xlUp)\n</code></pre>\n\n<p>is a range consisting of only one single cell. What you need instead is a range consisting of all the cells that belong to the rows that are still visible after applying the filter.</p>\n\n<p>Also keep in mind that when you're using variables that hold either row or column indexes, they should be declared as <code>Long</code>.</p>\n"}], "owner": {"reputation": 103, "user_id": 10862728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f29a6b59b1344f43d3a688106cf9245?s=128&d=identicon&r=PG&f=1", "display_name": "NordicFox", "link": "https://stackoverflow.com/users/10862728/nordicfox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 56665415, "answer_count": 1, "score": 1, "last_activity_date": 1560948120, "creation_date": 1560938675, "last_edit_date": 1560948120, "question_id": 56665100, "link": "https://stackoverflow.com/questions/56665100/count-filtered-rows-using-vba", "title": "Count filtered rows using VBA", "body": "<p>The problem is that RowCount returns 1 instead of visible rows after filtering.</p>\n\n<p><code>RowCount = Cells(Rows.Count, colIndex).End(xlUp).SpecialCells(xlCellTypeVisible).Row</code></p>\n\n<pre><code>Sub showEightmonth(ws, colName, colIndex)\nDim RowCount As Integer\n    ws.Activate\n    MsgBox ws.Name\n    RowCount = Cells(Rows.Count, colIndex).End(xlUp).Row\n    Set Rng = Range(colName &amp; \"1:\" &amp; colName &amp; RowCount)\n\n    If ws.AutoFilterMode = True Then\n    ws.AutoFilter.ShowAllData\n    End If\n\n    Rng.Select\n    Rng.NumberFormat = \"mm/dd/yyyy hh:mm:ss\"\n    d = Format(DateAdd(\"m\", -8, Date), \"mm/dd/yyyy 07:00:00\")\n    Range(colName &amp; \"1\").AutoFilter Field:=colIndex, Criteria1:=\"&lt;\" &amp; d\n    RowCount = Cells(Rows.Count, colIndex).End(xlUp).SpecialCells(xlCellTypeVisible).Row\n    'Delete filtered row if RowCount &gt; 1, as row 1 is the header row\n    If RowCount &gt; 1 Then\n        delRow = colName &amp; \"2:\" &amp; colName &amp; RowCount\n        ActiveSheet.Range(delRow).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End If\n    If ws.AutoFilterMode = True Then\n    ws.AutoFilter.ShowAllData\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "combobox", "autocomplete"], "answers": [{"comments": [{"owner": {"reputation": 3664, "user_id": 343825, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5wGzF.jpg?s=128&g=1", "display_name": "Henrik Erlandsson", "link": "https://stackoverflow.com/users/343825/henrik-erlandsson"}, "edited": false, "score": 0, "creation_date": 1561014878, "post_id": 56666746, "comment_id": 99927537, "body": "Beautiful! So simple. I should have thought of it. But I stared myself blind on the control&#39;s methods instead."}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "reply_to_user": {"reputation": 3664, "user_id": 343825, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5wGzF.jpg?s=128&g=1", "display_name": "Henrik Erlandsson", "link": "https://stackoverflow.com/users/343825/henrik-erlandsson"}, "edited": false, "score": 0, "creation_date": 1561019187, "post_id": 56666746, "comment_id": 99929687, "body": "Social Media power :)"}], "tags": [], "owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "is_accepted": true, "score": 1, "last_activity_date": 1560944037, "creation_date": 1560944037, "answer_id": 56666746, "question_id": 56665009, "link": "https://stackoverflow.com/questions/56665009/how-to-force-match-combobox-rowsource-row-by-setting-its-text-property/56666746#56666746", "title": "How to force match Combobox RowSource row by setting its Text property?", "body": "<p>Use <code>SendKeys</code> to mimic the normal keyboard beheviour instead of all the above code.<br>\nSo in your <code>btnPressed_Clicked</code> event</p>\n\n<pre><code>Dim ctrlPrevious As Control\nSet ctrlPrevious = Screen.PreviousControl\nctrlPrevious.SetFocus   \nSendKeys btnPressed.caption\n</code></pre>\n"}], "owner": {"reputation": 3664, "user_id": 343825, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5wGzF.jpg?s=128&g=1", "display_name": "Henrik Erlandsson", "link": "https://stackoverflow.com/users/343825/henrik-erlandsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 56666746, "answer_count": 1, "score": 0, "last_activity_date": 1594715501, "creation_date": 1560938413, "last_edit_date": 1594715501, "question_id": 56665009, "link": "https://stackoverflow.com/questions/56665009/how-to-force-match-combobox-rowsource-row-by-setting-its-text-property", "title": "How to force match Combobox RowSource row by setting its Text property?", "body": "<p>On the shop floor, a virtual (touch) keyboard form with larger buttons is used to enter text into TextBoxes and ComboBoxes.</p>\n\n<p>This works fine, and combobox text is set correctly, however the RowSource is not matched as it would be when you type directly into the ComboBox with a physical keyboard. The entire list is displayed as if you had just pressed the dropdown button without typing a character.</p>\n\n<p>In the example below, there is a Stefan in the list, but that row is not looked up.</p>\n\n<p>I've tried <code>SetFocus</code>, <code>Requery</code>, <code>Refresh</code>, <code>Dirty</code>, and calling <code>_AfterUpdate</code>, in combinations and with <code>DoEvents</code>, to no avail.</p>\n\n<p>I've even tried to select, <code>Cut</code>, and <code>Paste</code> the text (but even setting <code>SelStart</code> and <code>SelLength</code> to correct values does <em>not</em> select it, so I'm assuming it cuts and pastes a range of zero characters). If I could make the text-selection work, I could probably get this to work.</p>\n\n<pre><code>Dim ctrlPrevious As Control\nSet ctrlPrevious = Screen.PreviousControl\nctrlPrevious.SetFocus\nctrlPrevious.text = sTemp\nctrlPrevious.SelStart = 0\nctrlPrevious.SelLength = Len(sTemp)\nctrlPrevious.Cut\nctrlPrevious.Paste\n</code></pre>\n\n<p><strong>Is there a way to force the AutoComplete behavior?</strong></p>\n"}, {"tags": ["excel", "vba", "autofilter"], "answers": [{"tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1560940058, "last_edit_date": 1560940058, "creation_date": 1560938697, "answer_id": 56665111, "question_id": 56664949, "link": "https://stackoverflow.com/questions/56664949/autofilter-on-multiple-columns-with-unrelated-criteria/56665111#56665111", "title": "Autofilter on multiple columns with unrelated criteria", "body": "<p>I think something like using <a href=\"https://www.contextures.com/xladvfilter01.html\" rel=\"nofollow noreferrer\">AdvancedFilter</a></p>\n\n<pre><code>Range(\"A1:B4\").AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=Range _\n        (\"D1:E3\"), Unique:=False\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pWIIA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pWIIA.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560944782, "post_id": 56665152, "comment_id": 99901618, "body": "<i>&quot;Filters look like they operate on one column only&quot;</i> no actually filters work on multiple columns too, but their criteria are AND related (not OR as the OP needs). Actually you explained it correctly in your second paragraph already :)"}], "tags": [], "owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "is_accepted": false, "score": 1, "last_activity_date": 1560944822, "last_edit_date": 1560944822, "creation_date": 1560938823, "answer_id": 56665152, "question_id": 56664949, "link": "https://stackoverflow.com/questions/56664949/autofilter-on-multiple-columns-with-unrelated-criteria/56665152#56665152", "title": "Autofilter on multiple columns with unrelated criteria", "body": "<p>I don't think so. Filters look like they operate on one column only. When you use the interface to define a filter it only offers a way to set criteria on a single column.</p>\n\n<p>Filter one will hide all rows that don't have <code>FAIL</code> in the first column, and filter two will hide the ones that don't have <code>FAIL</code> in the second. So unless <code>FAIL</code> is in both columns the row will be hidden.</p>\n\n<p>You could use an additional column to accomplish it. Say you add column C, and the ones above are A &amp; B. A formula <code>=OR(A2=\"FAIL\", B2=\"FAIL\")</code>. Then filter on C = <code>TRUE</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1560938961, "creation_date": 1560938961, "answer_id": 56665193, "question_id": 56664949, "link": "https://stackoverflow.com/questions/56664949/autofilter-on-multiple-columns-with-unrelated-criteria/56665193#56665193", "title": "Autofilter on multiple columns with unrelated criteria", "body": "<p>Filters are using AND related criteria in multiple columns but what you need is an OR related criteria (which is not supported):</p>\n\n<p>So you can use a helper column with COUNTIF</p>\n\n<p><a href=\"https://i.stack.imgur.com/0SiYG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0SiYG.png\" alt=\"enter image description here\"></a></p>\n\n<p>Eg the following formula in C2 (and copy it down):</p>\n\n<pre><code>=COUNTIF(A2:B2,\"FAIL\")\n</code></pre>\n\n<p>And then filter the helper column for <code>&gt;=1</code>.</p>\n"}], "owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 56665193, "answer_count": 3, "score": 4, "last_activity_date": 1561376449, "creation_date": 1560938237, "last_edit_date": 1561376449, "question_id": 56664949, "link": "https://stackoverflow.com/questions/56664949/autofilter-on-multiple-columns-with-unrelated-criteria", "title": "Autofilter on multiple columns with unrelated criteria", "body": "<p>I'm trying to filter my data in VBA. The data looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1CUCX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1CUCX.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to <strong>only display the lines with FAIL</strong> written on it. So I have tried\n<code>\n.ListObjects(\"Table1\").Range.AutoFilter Field:=1, Criteria1:=\"FAIL\"\n.ListObjects(\"Table1\").Range.AutoFilter Field:=2, Criteria1:=\"=FAIL\"\n</code></p>\n\n<p>However it just hides everything. If the data was in the same column I would've used the <code>operator</code> attribute but since it is in different columns I don't really know what to do.</p>\n\n<p>So is it possible to filter unrelated data from different columns?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560937886, "post_id": 56664742, "comment_id": 99897839, "body": "It is impossible without opening the workbook. You need to open a workbook if you want to edit it or add a sheet. But you can do this in the background (so the user does not see it). You need to open a second instance of Excel in the background. Have a look here: <a href=\"https://stackoverflow.com/questions/579797/open-excel-file-for-reading-with-vba-without-display\" title=\"open excel file for reading with vba without display\">stackoverflow.com/questions/579797/&hellip;</a>"}, {"owner": {"reputation": 27, "user_id": 9940967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcba69c80a932e117238ef26a742f92d?s=128&d=identicon&r=PG&f=1", "display_name": "JanAlb", "link": "https://stackoverflow.com/users/9940967/janalb"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560943979, "post_id": 56664742, "comment_id": 99901144, "body": "Several users in the link you posted suggested &quot;Application.screenupdating = False&quot;. However it is not working for me, as stated above. Any ideas?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560944056, "post_id": 56664742, "comment_id": 99901185, "body": "no have a look at the first anwser. It show how to open a new Excel in the background so the user doesn&#39;t see it."}], "answers": [{"tags": [], "owner": {"reputation": 1709, "user_id": 7761488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/269b1437ab589a3528f1dae453c3dd77?s=128&d=identicon&r=PG&f=1", "display_name": "iSpain17", "link": "https://stackoverflow.com/users/7761488/ispain17"}, "is_accepted": true, "score": 0, "last_activity_date": 1560952343, "creation_date": 1560952343, "answer_id": 56669352, "question_id": 56664742, "link": "https://stackoverflow.com/questions/56664742/how-to-add-a-copy-of-a-sheet-in-another-workbook-without-opening-the-workbook/56669352#56669352", "title": "How to add a copy of a sheet in another workbook without opening the workbook", "body": "<p>You cannot achieve this in VBA without opening the file.</p>\n\n<p>But, you can create an Application object, with settings its visibility to false, so the user will not notice this instance running:</p>\n\n<pre><code>Dim app as Excel.Application \napp.Visible = false \n'do stuff\n</code></pre>\n\n<p>As to why <code>ScreenUpdating</code> is not working...\nYou are halting screen update for the application instance you run the code from. Not for the application instance you want to create (to run in background invisibly).</p>\n"}], "owner": {"reputation": 27, "user_id": 9940967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcba69c80a932e117238ef26a742f92d?s=128&d=identicon&r=PG&f=1", "display_name": "JanAlb", "link": "https://stackoverflow.com/users/9940967/janalb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56669352, "answer_count": 1, "score": 0, "last_activity_date": 1560952343, "creation_date": 1560937537, "last_edit_date": 1560937555, "question_id": 56664742, "link": "https://stackoverflow.com/questions/56664742/how-to-add-a-copy-of-a-sheet-in-another-workbook-without-opening-the-workbook", "title": "How to add a copy of a sheet in another workbook without opening the workbook", "body": "<p>Im setting up a code that will copy the last sheet in another workbook and add it to the end of said workbook. However I do not want my code to open the workbook.</p>\n\n<p>I have tried using the application.ScreenUpdating before and after my code, but it do not seem to work. I have also tried putting the screenupdating code at the beginning of the sub and at the end.</p>\n\n<pre><code>With otherwb\n   Application.ScreenUpdating = False\n   .Sheets(.Sheets.count).Copy After:=.Sheets(.Sheets.count)\n   Application.ScreenUpdating = True\nEnd With\n</code></pre>\n\n<p>Am I using the Screenupdating code wrong or is there a reason why the workbook is still opening for me?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1565103973, "post_id": 56664700, "comment_id": 101242560, "body": "<a href=\"https://www.rondebruin.nl/win/s2/win001.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s2/win001.htm</a>"}, {"owner": {"reputation": 35, "user_id": 11552254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hDXTO.jpg?s=128&g=1", "display_name": "rediffusion", "link": "https://stackoverflow.com/users/11552254/rediffusion"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1565105511, "post_id": 56664700, "comment_id": 101243422, "body": "@DavidZemens &#183;&#183;&#183; I know, but this won&#39;t work for me to edit the menu-button. Olso i find that You can create only 1 menu without any additional submenus. With this string <code>msoControlPopup</code>. For picture we can use <code>.Picture = LoadPicture(&quot;C:\\Foto\\TEST.jpg&quot;) </code>"}], "owner": {"reputation": 35, "user_id": 11552254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hDXTO.jpg?s=128&g=1", "display_name": "rediffusion", "link": "https://stackoverflow.com/users/11552254/rediffusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565103663, "creation_date": 1560937384, "last_edit_date": 1565103663, "question_id": 56664700, "link": "https://stackoverflow.com/questions/56664700/i-need-macro-for-editing-menu-in-quick-access-toolbar", "title": "I need macro for editing Menu in Quick Access Toolbar", "body": "<p>I have\u00a0questions about <a href=\"https://www.rondebruin.nl/win/s2/win004.htm\" rel=\"nofollow noreferrer\" title=\"Menu for favorite macros in Quick Access Toolbar in Excel 2007-2016\">QAT</a>.</p>\n\n<ol>\n<li>How do I add my tooltip to a <a href=\"http://dl4.joxi.net/drive/2019/06/18/0002/1030/156678/78/9992366bfc.jpg\" rel=\"nofollow noreferrer\" title=\"Screenshot-1\">button</a>. How do I add a tooltip to any button?</li>\n<li>How to change the icon of the <a href=\"http://dl3.joxi.net/drive/2019/06/19/0002/1030/156678/78/77c4f7c8ec.jpg\" rel=\"nofollow noreferrer\">button</a> White Arrow? </li>\n<li>How to insert my own icons?</li>\n<li>Is it possible to add more <a href=\"http://dl4.joxi.net/drive/2019/06/18/0002/1030/156678/78/80f75986f8.jpg\" rel=\"nofollow noreferrer\" title=\"Screenshot-2\">Submenus</a>. For example Submenus_1; Submenus_2; Submenus_3; Submenus_4; Submenus_5. </li>\n</ol>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 11316927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e6878c9f608b76b3cd4a37d918b47d?s=128&d=identicon&r=PG&f=1", "display_name": "veryBadProgrammer", "link": "https://stackoverflow.com/users/11316927/verybadprogrammer"}, "edited": false, "score": 0, "creation_date": 1560937993, "post_id": 56664707, "comment_id": 99897892, "body": "Correct. I just tried it and the result is the same. Thanks for you contribution"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1560937403, "creation_date": 1560937403, "answer_id": 56664707, "question_id": 56664511, "link": "https://stackoverflow.com/questions/56664511/how-to-populate-a-combobox-with-query-results/56664707#56664707", "title": "How to populate a ComboBox with query results", "body": "<p>Your first attempt is fine, you just need to requery the combo box to actually load in the results of the query.</p>\n\n<pre><code>Dim SQL As String\ncombox.RowSourceType = \"Table/Query\"\ncombox.RowSource = \"\"\n\nSQL = \"SELECT [some_value] FROM [a_table] WHERE [another_value] = '\" &amp; argv(0) &amp; \"'\"\n\ncombox.RowSource = SQL\ncombox.requery 'Clears old data, loads new data\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 11316927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e6878c9f608b76b3cd4a37d918b47d?s=128&d=identicon&r=PG&f=1", "display_name": "veryBadProgrammer", "link": "https://stackoverflow.com/users/11316927/verybadprogrammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1560937706, "creation_date": 1560937706, "answer_id": 56664786, "question_id": 56664511, "link": "https://stackoverflow.com/questions/56664511/how-to-populate-a-combobox-with-query-results/56664786#56664786", "title": "How to populate a ComboBox with query results", "body": "<p>After some refactoring and fixing I came to this result which makes the ComboBox behave as I intend:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>combox.RowSourceType = \"Value List\"\ncombox.RowSource = \"\"\n\n\nSQL = \"SELECT [some_value] FROM [a_table] WHERE [another_value] = '\" &amp; argv(0) &amp; \"'\"\nWith combox\n    .RowSource = kombSQL\n    .ColumnCount = 2\n    .ColumnWidth = 1\n    .ColumnWidths = \"1.5in.\"\nEnd With\n\nSet RS = CurrentDb.OpenRecordset(SQL)\nRS.MoveLast\nRS.MoveFirst\ncombox.RemoveItem 0\n\nDo Until RS.EOF\n    Me.combox.AddItem RS.Fields(\"some_value\")\n    RS.MoveNext\nLoop\n\nRS.Close\nSet RS = Nothing\n\nMe.combox.BoundColumn = 0\nMe.combox.ListIndex = 0\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 11316927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e6878c9f608b76b3cd4a37d918b47d?s=128&d=identicon&r=PG&f=1", "display_name": "veryBadProgrammer", "link": "https://stackoverflow.com/users/11316927/verybadprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 1, "accepted_answer_id": 56664707, "answer_count": 2, "score": 2, "last_activity_date": 1594715511, "creation_date": 1560936829, "last_edit_date": 1594715511, "question_id": 56664511, "link": "https://stackoverflow.com/questions/56664511/how-to-populate-a-combobox-with-query-results", "title": "How to populate a ComboBox with query results", "body": "<p>I had a problem populating a ComboBox from query results in access vba. My goal was to query for one column of a table and use every record from the result as an option for the combobox. </p>\n\n<p>There are some things about the properties of ComboBoxes you need to be aware of and assign properly to make this work. Here's my code that seemed to hold the correct information but did not display anything in the dropdown list:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim RS As DAO.Recordset\nDim SQL As String\n\n'Clean-up. not sure if it's needed but I'm \"clearing\" the old data (if there's any) before putting the new in\ncombox.RowSourceType = \"Table/Query\"\ncombox.RowSource = \"\"\n\nSQL = \"SELECT [some_value] FROM [a_table] WHERE [another_value] = '\" &amp; argv(0) &amp; \"'\"\n\ncombox.RowSource = SQL\n</code></pre>\n\n<p>This was part of <a href=\"https://stackoverflow.com/questions/56579800/is-there-a-way-to-write-to-edit-a-otherwise-read-only-recordset-for-the-context\">another question</a> I asked but for clearer structure I'm moving this question (and it's answer) to this thread.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1560936203, "post_id": 56664201, "comment_id": 99896867, "body": "If the code is extensive, please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You&#39;ve provided very little information we can use to actually get to the root of the problem."}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1560936428, "post_id": 56664201, "comment_id": 99896992, "body": "Thanks Erik, the relevant part is included as far as I can tell. I can add a full (simplified) version of my DB query, but it uses the basic syntax stated above. It falls over at the DB query, everything before this executes without issue. As stated it all works in Excel 2011 and my only clue is that dialogue window."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1560937050, "post_id": 56664201, "comment_id": 99897333, "body": "Eh, no, the relevant part is not included. Think about this from a readers perspective: Do I know all the things I need to know to get the same error, so I can try to fix it?"}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1560937360, "post_id": 56664201, "comment_id": 99897531, "body": "I have modified the entire query that fails in order to remove identifying info and added to the question (along with the location in the main body where it falls over). I figured if somebody knew that pop up window they could provide the insight I needed, apologies."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1560937595, "post_id": 56664201, "comment_id": 99897658, "body": "Does that DSN you&#39;re referring to (<i>MyDept</i>) exist? Does it have the same bitness as your Office installation? This is probably just a mismatch between the DSN bitness and the Office application bitness, which often happens when upgrading from 32-bits to 64-bits Office"}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1560939027, "post_id": 56664201, "comment_id": 99898511, "body": "The change is bitness makes sense - although I don&#39;t know how to rectify this. I wouldn&#39;t know how to begin proving that my DNS &quot;exists&quot;, other than it works elsewhere, and is listed in my connections within Excel. Apologies for being so helpless, I am not very familiar with SQL/Databases (I&#39;m a mechanical engineer - no computing background!)."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1560939554, "post_id": 56664201, "comment_id": 99898816, "body": "You can easily view DSNs using the ODBC data source administrator panel on the control panel under administrative tools. Here, you can also create a DSN with an identical name and identical settings, provided you knew the settings contained in your previous DSN."}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1560941152, "post_id": 56664201, "comment_id": 99899587, "body": "I do not have administrator access on this network unfortunately, so I am a little screwed until I can get an IT person to come over here and give me access. They know less in this area than even me in my past experience, so I will likely need to find a solution to this myself or rewrite my code to no longer use a DSN, e.g.  <a href=\"https://kb.globalscape.com/KnowledgebaseArticle10063.aspx\" rel=\"nofollow noreferrer\">kb.globalscape.com/KnowledgebaseArticle10063.aspx</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1560941487, "post_id": 56664201, "comment_id": 99899777, "body": "Yup, going DSNless is advisable, certainly if you don&#39;t have administrator access but really always. You <i>can</i> create user DSNs without administrative access, though, but I still recommend going DSNless. Good luck, can&#39;t help you without knowing details you&#39;d probably like to keep confidential."}], "owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1594715523, "creation_date": 1560935950, "last_edit_date": 1594715523, "question_id": 56664201, "link": "https://stackoverflow.com/questions/56664201/data-source-cannot-be-shared-following-upgrade-to-o365", "title": "&quot;Data Source Cannot be Shared&quot; following upgrade to O365", "body": "<p>I recently updated to Office 365 and with it a few of my vba tools fell over, but the majority have been easily fixable. This one is confusing me: </p>\n\n<p>My code uses query tables to get some data from an access database (which is where I suspect this is falling over) and then does some calculations before creating an input file for some external software. I then use shell to run that external software with that newly created input file before fetching and processing the results file for visualisation in Excel. The code is extensive so I won't reproduce reams of code here. </p>\n\n<p>For the DB query I am using the syntax (see below for a longer description of the operation of the code): </p>\n\n<blockquote>\n  <p>mydatabase.QueryTables.Add(... etc</p>\n</blockquote>\n\n<p>The window that pops up when I try to run the script is shown below, I used message box flags to prove that this occurs as it tries to look in the access database for the first time. </p>\n\n<p><a href=\"https://i.stack.imgur.com/4ltkt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4ltkt.png\" alt=\"enter image description here\"></a></p>\n\n<p>This worked perfectly on Excel 2011 before I upgraded to O365. Note that access was also updated at the same time. </p>\n\n<p><strong>I am self taught and don't know what this means or how to fix it. Can anybody provide any insight?</strong> </p>\n\n<p>How the code works: </p>\n\n<p>In the main body: </p>\n\n<pre><code>MsgBox \"Starting Query\"\ngtdatabase.Visible = xlSheetHidden 'hide the worksheet\nCreate_DBQuery number\nMsgBox \"Completing Query\"\n</code></pre>\n\n<p>I see \"Starting Query\" but then the \"Select Data Source\" window, without seeing that my query has been completed. The sub \"CreateDBQuery\" works as follows (Modified so identifiers are removed): </p>\n\n<pre><code>Sub Create_DBQuery(ByVal number As String)\n'\nWith mydatabase.QueryTables.Add(Connection:=Array(Array( _\n        \"ODBC;DSN=MyDept;Description= GT Database;UID=Administrator;APP=Microsoft Office 2003;WSID=XXXX111;DATABASE=GTDB;Tr\" _\n        ), Array(\"usted_Connection=Yes\")), Destination:=mydatabase.Range(\"A1\"))\n        .CommandText = Array( _\n        \"SELECT DataSheetSummary.a, DataSheetSummary.b, DataSheetSummary.c, DataSheetSummary.d, DataSheetSummary.e, DataSheetSummary.f, DataSheetSummary.g, DataSheetSummary.h, Data\" _\n        , _\n        \"SheetSummary.j, DataSheetSummary.k, DataSheetSummary.l, DataSheetSummary.m, DataSheetSummary.n, DataSheetSummary.p, DataSheetSummary.q, DataSheetSummary.r, DataSheetSummary.\" _\n        , _\n        \"s, DataSheetSummary.t, DataSheetSummary.u, DataSheetSummary.v, DataSheetSummary.w\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"FROM GT.dbo.DataSheetSummary DataSheetSummary\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"WHERE (DataSheetSummary.DataSheet_Number Like '\" &amp; number &amp; \"')\" _\n        &amp; Chr(13) &amp; \"\" &amp; Chr(10))\n        .Name = \"Query from GT_2\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .Refresh BackgroundQuery:=False\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "excel", "vba", "ado"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1560935993, "post_id": 56663984, "comment_id": 99896759, "body": "There are a number of options.  Don&#39;t think of your Excel rows as something special.  They are just data.  If you have dbo on SQL you could link/import your data there (probably fastest).  If not, can you load Excel and SQL data into memory, process everything and dump it out.  Don&#39;t use manual tint and shade, use conditional formatting.  Looping isn&#39;t what is slowing you, its the constant loops back to SQL and the writing to Excel.  If (with 10k rows) this takes more than about 30 seconds you need to optimise."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560936114, "post_id": 56663984, "comment_id": 99896825, "body": "@Gareth please write an answer, would be helpful. As for the CF, I specifically opted out for that: it needs to be non-dynamic formatting"}, {"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1560940480, "post_id": 56663984, "comment_id": 99899291, "body": "You really need to parametrise that statement. SQL injection is <b><i>still</i></b> a far too large a problem in the industry even now, and it shouldn&#39;t be. Sandboxing, development work, school projects, etc aren&#39;t &quot;immune&quot; to be parametrised; get in the habit now of writing code that isn&#39;t just a huge security flaw and then in the future it won&#39;t be a problem when you&#39;re writing something that will &quot;matter&quot; if it has a giant vulnerability in it."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1561022483, "post_id": 56663984, "comment_id": 99931371, "body": "@Larnu I agree, but have never practised save SQL injection (it so far has not been necessary as the connection is read only and is only used by a small nr. of users within the company). If you show me a save method, I will happily implement it"}, {"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 1, "creation_date": 1561022709, "post_id": 56663984, "comment_id": 99931501, "body": "A quick <a href=\"https://www.google.com/search?q=VBA+parametrise+SQL+query\" rel=\"nofollow noreferrer\">Google</a> led me to <a href=\"https://stackoverflow.com/questions/17678856/querying-a-sql-server-in-excel-with-a-parameterized-query-using-vba\">Querying a SQL Server in Excel with a parameterized query using VBA</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560952613, "post_id": 56664753, "comment_id": 99906417, "body": "As edited.  It won&#39;t fully solve your problem (depends on the size of your SQL data) but should some ideas."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560965011, "post_id": 56664753, "comment_id": 99913174, "body": "<code>If myRange Is Nothing</code> Beg your pardon, but don&#39;t see the assignment to <code>myRange</code> before this line"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1561015723, "post_id": 56664753, "comment_id": 99927951, "body": "@JohnyL Because the range has never initialised it will default to Nothing.  You could set it to Nothing explicitly but it shouldn&#39;t be needed."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": false, "score": 1, "last_activity_date": 1560959824, "last_edit_date": 1560959824, "creation_date": 1560937581, "answer_id": 56664753, "question_id": 56663984, "link": "https://stackoverflow.com/questions/56663984/execute-a-query-once-for-an-entire-column-instead-of-looping-through-all-cells/56664753#56664753", "title": "Execute a query once for an entire column instead of looping through all cells", "body": "<p>Method 1.</p>\n\n<p>If you have dbo on SQL then create a temp table and load the Excel data there.  Do it in a single pass using an efficient string building method (ie use Mid to replace rather than constant concatenating).  Or use Integration to load the data directly.  Run the query and drop the data back.  Work out which cells need to be formatted and do them at once (loop with Union to get one big range).</p>\n\n<p>Method 2.</p>\n\n<p>Use a client-side cursor, load all your data from SQL and use rs.Filter to find the matching record.  You could load your Excel data into an array or disconnected recordset and drop it back in.</p>\n\n<p>The significant thing is not to write back to Excel unnecessarily.  There should be no more than two writes to Excel.</p>\n\n<p>Something like (code not fully tested)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim rsLocal As ADODB.Recordset ' create a local, disconnected recordset\nSet rsLocal = New ADODB.Recordset\nrsLocal.CursorLocation = adUseClient\nrsLocal.Fields.Append \"L\", adVarChar, 1024, adFldIsNullable ' change to suit your data\nrsLocal.Open\n\nDim myRange As Range\n\nrs.CursorLocation = adUseClient\n'bring all the records back into memory\nSet rs = GetData(\"SELECT 'Checked', AT.Code Code FROM astAssetTypes AT JOIN astAssetTypesUDFV UDFV ON UDFV.TableLinkId = AT.Id WHERE UDFV.Userfield13Id = '5029' AND AT.Code = '\")\n\n\nFor Each c In sht.Range(\"J3:J\" &amp; lrow)\n    rsLocal.AddNew\n    If c.Value &lt;&gt; \"\" Then\n        rs.Filter = \"Code='\" &amp; c.Value &amp; \"'\" 'use Filter to prevent lots of round trips\n        If rs.RecordCount &lt;&gt; 0 Then\n            rs.MoveFirst\n            rsLocal(\"L\") = rs(\"Code\")\n\n            'add the cells to the range as we go\n            If myRange Is Nothing Then\n                Set myRange = sht.Range(sht.cells(c.Row, \"A\"), sht.cells(c.Row, LCol))\n            Else\n                Set myRange = Union(sht.Range(sht.cells(c.Row, \"A\"), sht.cells(c.Row, LCol)), myRange)\n            End If\n        End If\n    End If\n    rsLocal.Update\nNext\n\nrsLocal.MoveFirst\nsht.Range(\"L3\").CopyFromRecordset rsLocal 'write all updates at once\n\nWith myRange.Font ' do all formatting at once\n    .ThemeColor = xlThemeColorDark1\n    .TintAndShade = -0.349986266670736\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1561020048, "post_id": 56673239, "comment_id": 99930105, "body": "Looks great Johny. This seems simple and fast. Any thoughts on which of the two methods would be fastest?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1561020407, "post_id": 56673239, "comment_id": 99930295, "body": "I&#39;ll do that once I am back in the office. Need a steadier internet connection to accurately test both methods"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1561021206, "post_id": 56673239, "comment_id": 99930701, "body": "@TimStack Good luck! ;)"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1561021233, "post_id": 56673239, "comment_id": 99930710, "body": "Please don&#39;t reject the edit- it is set to SQL code formatting now, I have changed it to VBA. And thanks! Will pick an answer as soon as I have compared both methods @Gareth"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1561021329, "post_id": 56673239, "comment_id": 99930777, "body": "@TimStack I missed a button) Approved!"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 1, "last_activity_date": 1561021279, "last_edit_date": 1561021279, "creation_date": 1560966206, "answer_id": 56673239, "question_id": 56663984, "link": "https://stackoverflow.com/questions/56663984/execute-a-query-once-for-an-entire-column-instead-of-looping-through-all-cells/56673239#56673239", "title": "Execute a query once for an entire column instead of looping through all cells", "body": "<pre class=\"lang-vb prettyprint-override\"><code>Sub start()\n\n    Dim strCodes$, rng1 As Range, rng2 As Range, cell As Range\n\n    '// Generate \"IN\" clause\n    For Each c In sht.Range(\"J3:J\" &amp; LRow)\n        If Len(c) &gt; 0 Then\n            strCodes = strCodes &amp; \"'\" &amp; c &amp; \"'\" &amp; IIf(c.Row = LRow, \"\", \",\")\n        End If\n    Next\n\n    'Query\n    Set rs = getdata( _\n        \"SELECT 'Checked', AT.Code FROM astAssetTypes AT JOIN astAssetTypesUDFV UDFV ON UDFV.TableLinkId = AT.Id \" &amp; _\n        \"WHERE UDFV.Userfield13Id = '5029' AND AT.Code IN (\" &amp; strCodes &amp; \");\")\n    While Not rs.EOF\n        Set cell = sht.Columns(\"J:J\").Find(rs(\"Code\"), LookAt:=xlWhole)\n        If Not cell Is Nothing Then\n            If rng1 Is Nothing Then\n                Set rng1 = sht.Cells(cell.Row, \"L\")\n            Else\n                Set rng1 = Union(rng1, sht.Cells(cell.Row, \"L\"))\n            End If\n            If rng2 Is Nothing Then\n                Set rng2 = sht.Cells(cell.Row, \"A\").Resize(, LCol)\n            Else\n                Set rng2 = Union(rng2, sht.Cells(cell.Row, \"A\").Resize(, LCol))\n            End If\n        End If\n        rs.MoveNext\n    Wend\n\n    '// Dump result\n    rng1.Value = \"Checked\"\n    With rng2.Font\n            .ThemeColor = xlThemeColorDark1\n            .TintAndShade = -0.349986266670736\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 56673239, "answer_count": 2, "score": 0, "last_activity_date": 1561021279, "creation_date": 1560935307, "question_id": 56663984, "link": "https://stackoverflow.com/questions/56663984/execute-a-query-once-for-an-entire-column-instead-of-looping-through-all-cells", "title": "Execute a query once for an entire column instead of looping through all cells", "body": "<p>I use the loop below to go through a column and perform a query for each cell value. Given the amount of cells in this column can easily exceed 10'000 rows, this is not a very fast method and therefore I am looking into another method for a performance boost.</p>\n\n<p>I am thinking about populating an array with the cells' values, but with this method it would most likely still be necessary to iterate through said array and perform the query for each iteration.</p>\n\n<p>I am not familiar with any method to possibly execute the query once, or at least to significantly boost performance for this procedure. Any ideas?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function getdata(query As String) As ADODB.Recordset\nDim cnn As ADODB.Connection\nDim connstring As String\nSet cnn = New ADODB.Connection\n\nconnstring = \"Provider=SQLOLEDB;Data Source=noneofyourbusiness;Connect Timeout=180\"\ncnn.Open connstring\n\nSet getdata = New ADODB.Recordset\n    getdata.CursorLocation = adUseClient\ngetdata.Open query, connstring, 2, adLockReadOnly\nEnd Function\n\nSub start()\n'code...\n\nFor Each c In sht.Range(\"J3:J\" &amp; LRow)\n    If Not c.Value = \"\" Then\n        'Query\n        Set rs = getdata(\"SELECT 'Checked' FROM astAssetTypes AT JOIN astAssetTypesUDFV UDFV ON UDFV.TableLinkId = AT.Id WHERE UDFV.Userfield13Id = '5029' AND AT.Code = '\" &amp; c.Value &amp; \"'\")\n        If Not rs.EOF Then\n            sht.Cells(c.Row, \"L\").CopyFromRecordset rs\n            With sht.Range(sht.Cells(c.Row, \"A\"), sht.Cells(c.Row, LCol)).Font\n                .ThemeColor = xlThemeColorDark1\n                .TintAndShade = -0.349986266670736\n            End With\n            rs.Close\n        End If\n    End If\nNext c\n\n'code...\nEnd Sub \n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1560935533, "post_id": 56663983, "comment_id": 99896516, "body": "You could also use a lookup table with domain endings"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1560936269, "post_id": 56663983, "comment_id": 99896899, "body": "Check if <a href=\"https://regex101.com/r/mLYk0o/4\" rel=\"nofollow noreferrer\">this updated pattern</a> does what you need"}], "answers": [{"comments": [{"owner": {"reputation": 763, "user_id": 10656609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67a018f0678dafb31664d25e08c716d?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/10656609/alan"}, "edited": false, "score": 1, "creation_date": 1560937857, "post_id": 56664329, "comment_id": 99897821, "body": "upvoted. gonna wait before making this the accepted answer to see if anyone else got a better solution. the funny thing is i was working on a formula based solution aswell, but i thought using REGEX would be a more precise way of solving this problem"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 763, "user_id": 10656609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67a018f0678dafb31664d25e08c716d?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/10656609/alan"}, "edited": false, "score": 0, "creation_date": 1560942474, "post_id": 56664329, "comment_id": 99900280, "body": "@Alan, thanks, I also updated the answer a little to show how you can do this without REGEX"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1560942443, "last_edit_date": 1560942443, "creation_date": 1560936294, "answer_id": 56664329, "question_id": 56663983, "link": "https://stackoverflow.com/questions/56663983/regex-url-regex-specifically-for-excel-vba/56664329#56664329", "title": "Regex - URL Regex SPECIFICALLY for Excel VBA", "body": "<p>I know you are asking about regex, but I am not sure if it would be that userfriendly. Here is an example with a lookup table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/o8Kst.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o8Kst.png\" alt=\"enter image description here\"></a></p>\n\n<p>Formula in <code>B2</code>:</p>\n\n<pre><code>=IF(COUNTIF($E$2:INDEX(E:E,COUNTA(E:E)),MID(A2,SEARCH(\"=\",SUBSTITUTE(A2,\".\",\"=\",LEN(A2)-LEN(SUBSTITUTE(A2,\".\",\"\"))))+1,256))&gt;0,\"Website\",\"Other\")\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>=IF(COUNTIF($E$2:INDEX(E:E,COUNTA(E:E)),TRIM(RIGHT(SUBSTITUTE(A2,\".\",REPT(\" \",LEN(A1))),LEN(A1))))&gt;0,\"Website\",\"Other\")\n</code></pre>\n\n<p>I simply added <code>.com</code> to the list. Add to the list if you like, the range is dynamic. You could also make it a table offcourse and reference that.</p>\n\n<p>If you choose to use VBA, I don't know what the added value of REGEX would be. There are other ways, but indeed REGEX would be one of them. For example you could use:</p>\n\n<pre><code>Function WEBSITE(RNG As Range) As String\n\nSelect Case Evaluate(\"Trim(Right(Substitute(\" &amp; RNG.Address &amp; \", \"\".\"\", Rept(\"\" \"\", Len(\" &amp; RNG.Address &amp; \"))), Len(\" &amp; RNG.Address &amp; \")))\")\nCase \"ac\", \"ad\", \"ae\", \"af\", \"ag\", \"ai\", \"al\", \"am\", \"ao\", \"aq\", \"ar\", _\n    \"as\", \"at\", \"au\", \"aw\", \"ax\", \"az\", \"ba\", \"bb\", \"bd\", \"be\", \"bf\", \"bg\", _\n    \"bh\", \"bi\", \"bj\", \"bm\", \"bn\", \"bo\", \"br\", \"bs\", \"bt\", \"bw\", \"by\", \"bz\", _\n    \"ca\", \"cc\", \"cd\", \"cf\", \"cg\", \"ch\", \"ci\", \"ck\", \"cl\", \"cm\", \"cn\", \"co\", _\n    \"cr\", \"cu\", \"cv\", \"cw\", \"cx\", \"cy\", \"cz\", \"de\", \"dj\", \"dk\", \"dm\", \"do\", _\n    \"dz\", \"ec\", \"ee\", \"eg\", \"es\", \"et\", \"eu\", \"fi\", \"fj\", \"fk\", \"fm\", \"fo\", _\n    \"fr\", \"ga\", \"gd\", \"ge\", \"gf\", \"gg\", \"gh\", \"gi\", \"gl\", \"gm\", \"gn\", \"gp\", _\n    \"gq\", \"gr\", \"gs\", \"gt\", \"gu\", \"gw\", \"gy\", \"hk\", \"hm\", \"hn\", \"hr\", \"ht\", _\n    \"hu\", \"id\", \"ie\", \"il\", \"im\", \"in\", \"io\", \"iq\", \"ir\", \"is\", \"it\", \"je\", _\n    \"jm\", \"jo\", \"jp\", \"ke\", \"kg\", \"kh\", \"ki\", \"km\", \"kn\", \"kp\", \"kr\", \"kw\", _\n    \"ky\", \"kz\", \"la\", \"lb\", \"lc\", \"li\", \"lk\", \"lr\", \"ls\", \"lt\", \"lu\", \"lv\", _\n    \"ly\", \"ma\", \"mc\", \"md\", \"me\", \"mg\", \"mh\", \"mk\", \"ml\", \"mm\", \"mn\", \"mo\", _\n    \"mp\", \"mq\", \"mr\", \"ms\", \"mt\", \"mu\", \"mv\", \"mw\", \"mx\", \"my\", \"mz\", \"na\", _\n    \"nc\", \"ne\", \"nf\", \"ng\", \"ni\", \"nl\", \"no\", \"np\", \"nr\", \"nu\", \"nz\", \"om\", _\n    \"pa\", \"pe\", \"pf\", \"sl\", \"sm\", \"sn\", \"so\", \"sr\", \"ss\", \"st\", \"su\", \"sv\", _\n    \"sx\", \"sy\", \"sz\", \"tc\", \"td\", \"tf\", \"tg\", \"th\", \"tj\", \"tk\", \"tl\", \"tm\", _\n    \"tn\", \"to\", \"tr\", \"tt\", \"tv\", \"tw\", \"tz\", \"ua\", \"ug\", \"uk\", \"us\", \"uy\", _\n    \"uz\", \"va\", \"vc\", \"ve\", \"vg\", \"vi\", \"vn\", \"vu\", \"wf\", \"ws\", \"ye\", \"yt\", _\n    \"za\", \"zm\", \"zw\", \"com\"\n\n    WEBSITE = \"Website\"\nCase Else\n    WEBSITE = \"Other\"\nEnd Select\n\nEnd Function\n</code></pre>\n\n<p>Call like:</p>\n\n<pre><code>=WEBSITE(A2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 763, "user_id": 10656609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67a018f0678dafb31664d25e08c716d?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/10656609/alan"}, "edited": false, "score": 0, "creation_date": 1560939077, "post_id": 56665149, "comment_id": 99898540, "body": "ok thanks, this helped for now. i updated the question, since i feel like my current solution is not effective"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1560938802, "creation_date": 1560938802, "answer_id": 56665149, "question_id": 56663983, "link": "https://stackoverflow.com/questions/56663983/regex-url-regex-specifically-for-excel-vba/56665149#56665149", "title": "Regex - URL Regex SPECIFICALLY for Excel VBA", "body": "<p>Just add to your huge alternation <code>\\.com</code> like <code>(...|\\.com...)</code>, before <code>co</code>, as it will successfully match leaving out <code>m</code> and not checking <code>com</code>.</p>\n"}], "owner": {"reputation": 763, "user_id": 10656609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67a018f0678dafb31664d25e08c716d?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/10656609/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 56665149, "answer_count": 2, "score": 1, "last_activity_date": 1560942443, "creation_date": 1560935299, "last_edit_date": 1560940811, "question_id": 56663983, "link": "https://stackoverflow.com/questions/56663983/regex-url-regex-specifically-for-excel-vba", "title": "Regex - URL Regex SPECIFICALLY for Excel VBA", "body": "<p>Im trying to come up with my own variant of an url regex to use in vba</p>\n\n<p>this is what i currently have:</p>\n\n<pre><code>((https?\\:\\/\\/)?([^\\s\\.\\-]{1,}(?:(?:\\.|\\-)[^\\s\\.\\-]{1,}){0,})(?=\\.(?:[^\\s]{1,}){0,2}\\/|$)(\\.ac|\\.ad|\\.ae|\\.af|\\.ag|\\.ai|\\.al|\\.am|\\.ao|\\.aq|\\.ar|\\.as|\\.at|\\.au|\\.aw|\\.ax|\\.az|\\.ba|\\.bb|\\.bd|\\.be|\\.bf|\\.bg|\\.bh|\\.bi|\\.bj|\\.bm|\\.bn|\\.bo|\\.br|\\.bs|\\.bt|\\.bw|\\.by|\\.bz|\\.ca|\\.cc|\\.cd|\\.cf|\\.cg|\\.ch|\\.ci|\\.ck|\\.cl|\\.cm|\\.cn|\\.co|\\.cr|\\.cu|\\.cv|\\.cw|\\.cx|\\.cy|\\.cz|\\.de|\\.dj|\\.dk|\\.dm|\\.do|\\.dz|\\.ec|\\.ee|\\.eg|\\.es|\\.et|\\.eu|\\.fi|\\.fj|\\.fk|\\.fm|\\.fo|\\.fr|\\.ga|\\.gd|\\.ge|\\.gf|\\.gg|\\.gh|\\.gi|\\.gl|\\.gm|\\.gn|\\.gp|\\.gq|\\.gr|\\.gs|\\.gt|\\.gu|\\.gw|\\.gy|\\.hk|\\.hm|\\.hn|\\.hr|\\.ht|\\.hu|\\.id|\\.ie|\\.il|\\.im|\\.in|\\.io|\\.iq|\\.ir|\\.is|\\.it|\\.je|\\.jm|\\.jo|\\.jp|\\.ke|\\.kg|\\.kh|\\.ki|\\.km|\\.kn|\\.kp|\\.kr|\\.kw|\\.ky|\\.kz|\\.la|\\.lb|\\.lc|\\.li|\\.lk|\\.lr|\\.ls|\\.lt|\\.lu|\\.lv|\\.ly|\\.ma|\\.mc|\\.md|\\.me|\\.mg|\\.mh|\\.mk|\\.ml|\\.mm|\\.mn|\\.mo|\\.mp|\\.mq|\\.mr|\\.ms|\\.mt|\\.mu|\\.mv|\\.mw|\\.mx|\\.my|\\.mz|\\.na|\\.nc|\\.ne|\\.nf|\\.ng|\\.ni|\\.nl|\\.no|\\.np|\\.nr|\\.nu|\\.nz|\\.om|\\.pa|\\.pe|\\.pf|\\.pg|\\.ph|\\.pk|\\.pl|\\.pm|\\.pn|\\.pr|\\.ps|\\.pt|\\.pw|\\.py|\\.qa|\\.re|\\.ro|\\.rs|\\.ru|\\.rw|\\.sa|\\.sb|\\.sc|\\.sd|\\.se|\\.sg|\\.sh|\\.si|\\.sk|\\.sl|\\.sm|\\.sn|\\.so|\\.sr|\\.ss|\\.st|\\.su|\\.sv|\\.sx|\\.sy|\\.sz|\\.tc|\\.td|\\.tf|\\.tg|\\.th|\\.tj|\\.tk|\\.tl|\\.tm|\\.tn|\\.to|\\.tr|\\.tt|\\.tv|\\.tw|\\.tz|\\.ua|\\.ug|\\.uk|\\.us|\\.uy|\\.uz|\\.va|\\.vc|\\.ve|\\.vg|\\.vi|\\.vn|\\.vu|\\.wf|\\.ws|\\.ye|\\.yt|\\.za|\\.zm|\\.zw)(\\/[^\\s]{0,})?)\n</code></pre>\n\n<p>Currently I'm trying to match specific domain endings, because i want to exclude mobile app names (com.king.candycrushsodasaga should NOT be included for instance)\nIt would be very good however, if i could use a more generic regex to achieve this goal since manually putting all those domain endings is not very effective/efficient</p>\n\n<p>If there is a better way of doing so please let me know.</p>\n\n<p>Appreciate any help.</p>\n\n<p>Additional Info:\nI'm trying to use this for a excel, where i can drop a bunch of urls, including mobile apps (like com.king.candycrushsodasaga) into a table and match the actual websites in a different column to exclude non websites like mobile apps.</p>\n\n<p>This is what the table looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cz2Ap.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cz2Ap.png\" alt=\"The table looks something like this\"></a></p>\n\n<p>more background info:</p>\n\n<p>i already have a vba function, which can be used as a formula.\nit takes in 2 arguments, one beeing the cell/range in which the url is and one beeing a range, in which the regex is.\nfor some reason long strings throw \"#value\" so i had to split some regexes.</p>\n\n<p>this is what the formula looks like:</p>\n\n<pre><code>=IF(IsMatch([@Url];RegularExps[URL Regex 1]);\"Website\";\"Other\")\n</code></pre>\n\n<p>I already tried to use regex'es (or regexi, whatever the plural for regex is) from this post: <a href=\"https://stackoverflow.com/questions/161738/what-is-the-best-regular-expression-to-check-if-a-string-is-a-valid-url\">What is the best regular expression to check if a string is a valid URL?</a></p>\n\n<p>But i havent been successful with any of them as they either include the app domains, throw #value or exclude valid urls</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1560935133, "post_id": 56663722, "comment_id": 99896283, "body": "I&#39;m not sure I understand your description fully, but I think you are trying do something that you can solve with ten clicks and a pivot table. Read up on &quot;Report Filter Pages&quot;"}, {"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "edited": false, "score": 0, "creation_date": 1560936350, "post_id": 56663722, "comment_id": 99896954, "body": "Your description is unclear. In one place you write about data, in another you write about number or unique number or unique data. What do you want to filter and what is the filtering based on exactly? What do you need to copy? How many sheets do you have? I would happily help but you should clarify your question first."}], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1560983992, "last_edit_date": 1560983992, "creation_date": 1560938197, "answer_id": 56664938, "question_id": 56663722, "link": "https://stackoverflow.com/questions/56663722/filtering-and-copying-the-filtered-unique-data-to-another-sheet-sheet-name-woul/56664938#56664938", "title": "Filtering and copying the filtered unique data to another sheet; sheet name would be the unique value", "body": "<p>You are essentially trying to do something called <a href=\"https://www.thespreadsheetguru.com/blog/2015/2/16/advanced-filters-with-vba-to-automate-filtering-on-and-out-specific-values\" rel=\"nofollow noreferrer\">Advanced Filter</a>. However your code needs some improvement on all of the select options (as the comments state). Here's a sample macro that has several components you'll need for what you're trying to do such as:</p>\n\n<ul>\n<li>It dynamically captures the range of all to the populated cells to the left and down of cell <code>F6</code>.</li>\n<li>Uses the green range as what to filter (if not just leave F3:H3 blank)</li>\n<li>Inserts values starting in cell <code>A1</code> with a dynamic number of columns based on the number of data columns.</li>\n<li>Excludes duplicates using <code>Unique:=True</code> (only one duplicate in sample)</li>\n</ul>\n\n<h2>Before Macro</h2>\n\n<p><a href=\"https://i.stack.imgur.com/dMzdF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dMzdF.jpg\" alt=\"Before the Macro is Run\"></a></p>\n\n<h2>After Macro</h2>\n\n<p><a href=\"https://i.stack.imgur.com/Cl6zA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cl6zA.jpg\" alt=\"After Macro\"></a></p>\n\n<p>Code used in above illustration.</p>\n\n<pre><code>Sub exampleRefresh()\nDim cRng As Range, WS As Worksheet\nSet WS = ActiveSheet\n\nWith WS\n    Set cRng = Sheet1.Range(\"F6\")\n    Set cRng = Range(cRng, cRng.End(xlToRight))\n    Set cRng = Range(cRng, cRng.End(xlDown))\n\n    Dim fRng As Range\n    Set fRng = WS.Range(\"F2:H3\")\n\n    Dim PRNG As Range\n    Set PRNG = WS.Range(\"A1\")\n    Set PRNG = Range(PRNG, PRNG.Offset(, cRng.Columns.Count - 1))\n\nEnd With\n\n\n  cRng.AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=fRng, CopyToRange:=PRNG, Unique:=True\n\n\nEnd Sub\n</code></pre>\n\n<p>Also, as a teaser, Microsoft is going to be deploying a new <a href=\"https://techcommunity.microsoft.com/t5/Excel-Blog/Preview-of-Dynamic-Arrays-in-Excel/ba-p/252944\" rel=\"nofollow noreferrer\">Spill Feature soon</a>. With this functionality, if you wanted to list the distinct values of a column, you could use a formula such as <code>=Unique(A:A)</code> in any cell and it will create a distinct list. No VBA or excessive clicking needed!</p>\n"}], "owner": {"reputation": 1, "user_id": 8367972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe44005fae57a5a3eb555c0bd5a5c668?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix", "link": "https://stackoverflow.com/users/8367972/phoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560983992, "creation_date": 1560934415, "last_edit_date": 1560934432, "question_id": 56663722, "link": "https://stackoverflow.com/questions/56663722/filtering-and-copying-the-filtered-unique-data-to-another-sheet-sheet-name-woul", "title": "Filtering and copying the filtered unique data to another sheet; sheet name would be the unique value", "body": "<p>'I have a workbook with sheets containing data. I need the unique number to be filtered and copy the filtered data to another sheet, sheet name would be the unique number. </p>\n\n<p>'i have tried to get all the numbers and remove duplicates, the remaining should be the filtered number to be copied.</p>\n\n<p>'the error is i can copy the data to different sheets but not filtered according to their unique number</p>\n\n<pre><code>Sub filter()\n\nDim i As Integer\nDim ST As String\nOn Error Resume Next\ni = 1\nApplication.ScreenUpdating = False\n\nDo\nST = Sheets(\"duplicateshipto\").Range(\"A\" &amp; i).Value\nIf ST &lt;&gt; \"\" Then\nSheets.Add.Name = ST\nWith Sheets(\"Template\")\n.Select\n.Range(\"C1:BQ4\").Select\n\nSelection.Copy\nSheets(ST).Select\nSheets(ST).Range(\"A1\").Select\nSheets(ST).Paste\n\n.Select\nActiveSheet.Range(\"$A$4:$BU$88\").AutoFilter Field:=26, Criteria1:=gsd\n\n\n.Range(\"Z4\", .Range(\"BS\" &amp; .Rows.Count).End(xlUp)).Select\n\nRange(\"Z4\").Select\nSelection.End(xlDown).Select\n.Range(Selection, Selection.End(xlDown)).Select\n.Range(Selection, Selection.End(xlToRight)).Select\n.Range(Selection, Selection.End(xlToRight)).Select\n.Range(Selection, Selection.End(xlToRight)).Select\n.Range(Selection, Selection.End(xlToRight)).Select\nSelection.Copy\nSheets(ST).Select\nSheets(ST).Range(\"x5\").Select\nSheets(ST).Paste\n.Select\nRange(\"BQ4\").Select\nSelection.End(xlDown).Select\n.Range(Selection, Selection.End(xlDown)).Select\n.Range(Selection, Selection.End(xlToRight)).Select\nSelection.Copy\nSheets(ST).Select\nSheets(ST).Range(\"BO6\").Select\nSheets(ST).Paste\n.Select\nRange(\"Y4\").Select\nSelection.End(xlDown).Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlToLeft)).Select\nRange(Selection, Selection.End(xlToLeft)).Select\nRange(Selection, Selection.End(xlToLeft)).Select\nRange(Selection, Selection.End(xlToLeft)).Select\n'Range(Selection, Selection.End(xlToLeft)).Select\nSelection.Copy\nSheets(ST).Select\nSheets(ST).Range(\"a5\").Select\nSheets(ST).Paste\n\nEnd With\ni = i + 1\nEnd If\nLoop Until ST = \"\"\n\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11398376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZxRH8z_1wBg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdm-uhZCORw6fvgyzGfVrgf2Fq6xQ/mo/photo.jpg?sz=128", "display_name": "Jack", "link": "https://stackoverflow.com/users/11398376/jack"}, "edited": false, "score": 0, "creation_date": 1560995800, "post_id": 56665818, "comment_id": 99922625, "body": "Thanks for your answer! It helped me a lot. I have a question, now if i want to add some filters before running through the slicer do i create a new sub and put it before <code>option explicit</code>? And do I replace <code>msgbox</code> with the code for the task which i need to do in between slicers?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 1, "user_id": 11398376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZxRH8z_1wBg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdm-uhZCORw6fvgyzGfVrgf2Fq6xQ/mo/photo.jpg?sz=128", "display_name": "Jack", "link": "https://stackoverflow.com/users/11398376/jack"}, "edited": false, "score": 0, "creation_date": 1561020652, "post_id": 56665818, "comment_id": 99930435, "body": "Yes, replace the MsgBox with the thing you want to do for each slice. Whether you create a new sub for this or if you put inside the loop is up to you. If you create a sub, you have isolated that part, and you can test it separately. The Sub can be placed anywhere, as long as it is between other Subs and Functions - not inside them."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1560941040, "creation_date": 1560941040, "answer_id": 56665818, "question_id": 56663128, "link": "https://stackoverflow.com/questions/56663128/vba-to-move-through-slicer-one-by-one/56665818#56665818", "title": "VBA to move through slicer one by one", "body": "<p>Do something like this</p>\n\n<pre><code>Option Explicit\n\nSub IterateSlices()\n    Dim CurrentSlice As Integer\n    For CurrentSlice = 1 To 3\n        SelectOnly ActiveWorkbook.SlicerCaches(\"Slicer_Engine_S_N.\"), CurrentSlice\n        MsgBox \"Do Something here\"\n    Next\nEnd Sub\n\nSub SelectOnly(Slicer As SlicerCache, SliceNo As Integer)\n    Dim i As Integer\n    ' Force at least one to be selected before start\n    Slicer.SlicerItems(Slicer.SlicerItems.Count).Selected = True\n\n    For i = 1 To Slicer.SlicerItems.Count\n        Debug.Print (SliceNo = i)\n        Slicer.SlicerItems(i).Selected = (SliceNo = i)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>The last method is utility method that selects the nth SliceItem. It is easier to work with index numbers rather than names. They always start with number 1 and end with the number of slices.  </p>\n\n<p>The first method picks one slice at a time.  </p>\n\n<p>SlicerCache is Excel's internal mechanism of keeping track of which data that belongs to which slice.</p>\n"}], "owner": {"reputation": 1, "user_id": 11398376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZxRH8z_1wBg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdm-uhZCORw6fvgyzGfVrgf2Fq6xQ/mo/photo.jpg?sz=128", "display_name": "Jack", "link": "https://stackoverflow.com/users/11398376/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560941040, "creation_date": 1560932487, "last_edit_date": 1560933204, "question_id": 56663128, "link": "https://stackoverflow.com/questions/56663128/vba-to-move-through-slicer-one-by-one", "title": "VBA to move through slicer one by one", "body": "<p>I have a sheet with raw data. I want to code a macro that will create a splicer with the header Engine No., then select slicer #1, and then copy all the data that is visible in the data to another sheet. Consecutively, move to slicer #2 and repeat the steps of copying the filtered data to another sheet. </p>\n\n<p>This is what I got from the macro recorder. This is not what I can use because the numbers will be different in a new data sheet. I was thinking of using a loop. Is there a better way other than a loop? I need to copy what is displayed to another sheet for every slicer item. </p>\n\n<p>I also saw <code>SlicerItems</code> and <code>SlicerCache</code>, but I don't know what they are. Could anybody explain to me what they are?</p>\n\n<pre><code>Sub slicer()\n\nWith ActiveWorkbook.SlicerCaches(\"Slicer_Engine_S_N.\")\n    .SlicerItems(\"123456\").Selected = True\n    .SlicerItems(\"123441\").Selected = False\n    .SlicerItems(\"123123\").Selected = False\n    .SlicerItems(\"235455\").Selected = False\n    .SlicerItems(\"566346\").Selected = False\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1560936467, "post_id": 56662806, "comment_id": 99897010, "body": "Would it not be simpler to put the magic number in an external file rather than attempting to rewrite a VBA module on the fly."}, {"owner": {"reputation": 33, "user_id": 11668333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VoiZ3PuiGSs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recbnRd7o4Yz-97V-ZC11lOddf2-A/mo/photo.jpg?sz=128", "display_name": "starrynightsky", "link": "https://stackoverflow.com/users/11668333/starrynightsky"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1560938232, "post_id": 56662806, "comment_id": 99898042, "body": "@Freeflow The aim of the code is used to patch out-dated macros. It happens that some version of the macros don&#39;t have the specific modules. An external file is not a viable option. It would definitely be simpler and works out of the box but I am looking more of a vba solution."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1560946046, "post_id": 56662806, "comment_id": 99902344, "body": "My guess is that if you are changing the source code then the module will be recompiled, hence any values set in the original code will be lost.  As far as I can see you are not executing the setmagicnumber procedure after patching the code so your getmagicnumber procedure will return the default value for an unitialised integer, which is 0."}, {"owner": {"reputation": 33, "user_id": 11668333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VoiZ3PuiGSs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recbnRd7o4Yz-97V-ZC11lOddf2-A/mo/photo.jpg?sz=128", "display_name": "starrynightsky", "link": "https://stackoverflow.com/users/11668333/starrynightsky"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1560993944, "post_id": 56662806, "comment_id": 99922308, "body": "@Freeflow The setMagicNumber is invoked after the patching the module. I guess what you mentioned makes sense as it is logical for the memory space to be cleared but the fact that I tried to re-assign the global variable after the patch and it still doesn&#39;t register, scratches my head."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11668333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VoiZ3PuiGSs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recbnRd7o4Yz-97V-ZC11lOddf2-A/mo/photo.jpg?sz=128", "display_name": "starrynightsky", "link": "https://stackoverflow.com/users/11668333/starrynightsky"}, "edited": false, "score": 0, "creation_date": 1560998454, "post_id": 56674360, "comment_id": 99923050, "body": "Thank you @Ahmed! I observed an interesting thing! When I modified the code from <code>Application.Run...</code> to <code>Application.OnTime...</code> the magic number was successfully modified. If I switched it back, the magic number was reset to 0 again. Not sure what is the difference between these two APIs; definitely not the time delay because I attempted with an <code>Application.Wait...</code> after the  <code>Call CopyModule</code> but it just worked."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 33, "user_id": 11668333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VoiZ3PuiGSs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recbnRd7o4Yz-97V-ZC11lOddf2-A/mo/photo.jpg?sz=128", "display_name": "starrynightsky", "link": "https://stackoverflow.com/users/11668333/starrynightsky"}, "edited": false, "score": 1, "creation_date": 1561044816, "post_id": 56674360, "comment_id": 99944245, "body": "with <code>Application.wait</code>  application simply wait before progressing to next line of code, whereas <code>Application.OnTime</code> schedule running the targeted macro in a future time and  continue execution of remaining code (in this case it activate <code>File.Xlsm</code> and ends execution of Macro in <code>Patch.xlsm</code>)"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 1, "last_activity_date": 1560973221, "last_edit_date": 1560973221, "creation_date": 1560971294, "answer_id": 56674360, "question_id": 56662806, "link": "https://stackoverflow.com/questions/56662806/how-to-change-a-global-variable-of-a-workbook-by-activating-a-macro-from-another/56674360#56674360", "title": "How to change a global variable of a workbook by activating a macro from another workbook", "body": "<p>Welcome to SO and Congratulation for asking a real good question</p>\n\n<p>This is only a part solution and not at all any where near to satisfaction. However i am posting it, since it would somehow serve your purpose of code to change Magic_Number to some desired integer.</p>\n\n<p>I tried it some different setup with slightly different objective (which could not be achieved). </p>\n\n<p>In <code>File.Xlsm</code> Workbook Open event</p>\n\n<pre><code>Private Sub Workbook_Open()\nSetMagic\nEnd Sub\n</code></pre>\n\n<p>In Module1 of <code>File.Xlsm</code></p>\n\n<pre><code>Global Magic_Number As Integer\nSub Test_Magic()\nMsgBox Magic_Number\nEnd Sub\n\nSub SetMagic()\nMagic_Number = 5\nThisWorkbook.Sheets(1).Range(\"F1\").Value = Magic_Number\nEnd Sub\n</code></pre>\n\n<p>In Sheet1 Change Event of <code>File.Xlsm</code></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Range(\"A1:E20\"), Target) Is Nothing Then\n    Magic_Number = Magic_Number + 1\n    Range(\"F1\").Value = Magic_Number\n    End If\nEnd Sub\n</code></pre>\n\n<p>Finally in <code>Patch.xlsm</code> Module1</p>\n\n<pre><code>Sub ChangeMagic()\nDim wb As Workbook, Opn As Boolean , Ln as Long\n    Onp = False\n    For Each wb In Application.Workbooks\n    If wb.Name = \"File.xlsm\" Then\n    Opn = True\n    Exit For\n    End If\n    Next\n\n    If Opn = False Then\n    Set wb = Workbooks.Open(ThisWorkbook.Path &amp; \"\\File.xlsm\")\n    End If\n\n\n    With wb.VBProject.VBComponents(\"Module1\").CodeModule\n    Ln = .ProcBodyLine(\"SetMagic\", vbext_pk_Proc)\n    .ReplaceLine Ln + 1, \"Magic_number =  100\"\n    End With\n\n    Application.OnTime Now + TimeValue(\"00:00:03\"), \"'File.xlsm'!Module1.SetMagic\"\n    wb.Activate\nEnd Sub\n</code></pre>\n\n<p>The line </p>\n\n<pre><code>Application.OnTime Now + TimeValue(\"00:00:03\"), \"'File.xlsm'!Module1.SetMagic\"\n</code></pre>\n\n<p>do the trick. after replacing the required code line in VBE, macro in <code>Patch.xlsm</code> ends and <code>SetMagic</code> get executed after a delay when <code>File.xlsm</code> activated. Magic_Number will be 100.</p>\n\n<p>But it still not serve my intended purpose as during trials it become evident that Magic_Number is resetting to 0 as soon the VBE code module line is replaced (i.e. before executing <code>Sub SetMagic</code>). But your purpose will be solved and Magic_Number is getting any value we set from <code>Patch.xlsm</code>. </p>\n\n<p>For my objective of dynamically setting <code>Magic_Number = Magic_Number + 100</code> could not be achieved. For achieving that purpose, i have to workaround and keep the latest value of Magic_Number stored in some cell etc and retrieve from there (that will loose real spirit of the code intended)</p>\n"}], "owner": {"reputation": 33, "user_id": 11668333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VoiZ3PuiGSs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recbnRd7o4Yz-97V-ZC11lOddf2-A/mo/photo.jpg?sz=128", "display_name": "starrynightsky", "link": "https://stackoverflow.com/users/11668333/starrynightsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 56674360, "answer_count": 1, "score": 3, "last_activity_date": 1560973221, "creation_date": 1560931299, "last_edit_date": 1560938007, "question_id": 56662806, "link": "https://stackoverflow.com/questions/56662806/how-to-change-a-global-variable-of-a-workbook-by-activating-a-macro-from-another", "title": "How to change a global variable of a workbook by activating a macro from another workbook", "body": "<p>I have two excel files, a <strong>patcher.xlsm</strong> and a <strong>file.xlsm</strong>. There is a button on <strong>file.xlsm</strong>, when it clicks it executes a procedure on Sheet 1 with a message box: <em>The magic number is: 5</em>.</p>\n\n<p>Now, I have a <strong>patcher.xlsm</strong>, that would re-import a patched Sheet 1 and a Standard module with a global variable and run a macro on <strong>file.xlsm</strong> to set this number to 7. The expected result is such that, users clicking on <strong>file.xlsm</strong> would now see <em>The magic number is: 7</em>.</p>\n\n<p>For some reason, whenever I executed <strong>patcher.xlsm</strong>, the magic number is always reset to 0, as though the memory has been cleared or project reset.</p>\n\n<p>Is there a way to assign a global variable from another workbook?</p>\n\n<p>In the past, I have looked at several stackoverflow threads, example, changing the scope of the variable, private, public, global, etc, activating the workbook, looking at Excel's hidden name space at the moment.</p>\n\n<pre><code>Sub Proc()\n  MsgBox \"The magic number is: 5\"\nEnd Sub\n</code></pre>\n\n<p><strong>Sheet1 in file.xlsm</strong></p>\n\n<pre><code>Call CopyModule(\"patcher_b_progress_bar.xlsm\", \"file_b.xlsm\", \"Sheet1\", True)\nCall CopyModule(\"patcher_b_progress_bar.xlsm\", \"file_b.xlsm\", \"GlobalModule\", True)\nApplication.Run (\"'file_b.xlsm'!GlobalModule.setDefaultMagicNumber\")\n</code></pre>\n\n<p><strong>patcher.xlsm \"patching\" the sheet 1 and setting a magic number via a module</strong></p>\n\n<pre><code>CopyModule \n' export \"patched GlobalModule\" from patcher.xlsm as temp.bas\n' remove GlobalModule from file.xlsm\n' re-import \"patched GlobalModule\" to file.xlsm\n(too lengthy to post here, referenced from http://www.cpearson.com/excel/vbe.aspx)\n</code></pre>\n\n<p><strong>CopyModule of patcher.xlsm</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate MAGIC_NUMBER As Integer\n\nPublic Function getMagicNumber() As Integer\n    getMagicNumber = MAGIC_NUMBER \nEnd Function\n\nPublic Function setDefaultMagicNumber() As Integer\n    MAGIC_NUMBER = 7\n    setDefaultMagicNumber= getMagicNumber()\nEnd Function\n</code></pre>\n\n<p><strong>GlobalModule of patcher.xlsm</strong></p>\n\n<pre><code>Sub Proc()\n  If GlobalModule.getMagicNumber= 7 Then\n    MsgBox \"Magic number is correct: \" &amp; GlobalModule.getMagicNumber\n  Else\n    MsgBox \"Magic number is wrong: \" &amp; GlobalModule.getMagicNumber\n  End If\nEnd Sub\n</code></pre>\n\n<p><strong>Sheet1 of patcher.xlsm (to be overwritten to file.xlsm)</strong></p>\n\n<p>EDIT: I have modified the issue. It seems like the variable MAGIC_NUMBER is re-initialise to \"0\" even though the line \"GlobalModule.setDefaultMagicNumber\" is executed successfully.</p>\n"}, {"tags": ["excel", "vba", "ms-access", "pivot-table"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1560931802, "post_id": 56662777, "comment_id": 99894498, "body": "<i>&quot;causes errors&quot;</i> wich error and in which line? \u2022 It is very likely that your issue is because of using <code>ActiveSheet</code> and <code>Select</code>: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1560932265, "post_id": 56662777, "comment_id": 99894724, "body": "Please <a href=\"https://stackoverflow.com/posts/56662777/edit\">edit</a> your question and put all the additional information there. Code in comments is not readable. Also try to accomplish what is suggested in the link I posted. There is a high proability that this fixes your issues alread."}], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 1, "last_activity_date": 1560952629, "last_edit_date": 1560952629, "creation_date": 1560952118, "answer_id": 56669279, "question_id": 56662777, "link": "https://stackoverflow.com/questions/56662777/making-pivots-in-xlsx-files-in-access-vba/56669279#56669279", "title": "Making pivots in xlsx files in Access VBA", "body": "<p>The source range for your pivotcache might be wrong. You use \"filename\" for that (is it a named range corresponding to the file's name, which is valid within each workbook?).</p>\n\n<p>I suggest following:</p>\n\n<ul>\n<li>build your code object by object: workbook, pivotcache, worksheet, pivottable, pivotfields, ...</li>\n<li>as you use two applications: declare almost every variable very clear, like <code>Excel.Workbook</code></li>\n<li><a href=\"https://stackoverflow.com/q/10714251/10908769\">avoid selecting or activating anything</a></li>\n</ul>\n\n<hr>\n\n<pre><code>Sub test()\n    Dim strF As String, strP As String\n    Dim wb As Excel.Workbook\n    Dim ws As Excel.Worksheet\n\n    'Edit this declaration to your folder name\n    strP = \"c:\\users\\...\" 'change for the path of your folder\n\n    strF = Dir(strP &amp; \"\\*.xls*\") 'Change as required\n\n    Do While strF &lt;&gt; vbNullString\n        'MsgBox strP &amp; \"\\\" &amp; strF\n        createPivot strP &amp; \"\\\" &amp; strF, strF\n        strF = Dir()\n    Loop\nEnd Sub\n\n\nSub createPivot(path As String, fileName As String)\n    Dim appExcel As Excel.Application\n    Dim myWorkbook As Excel.Workbook\n    Dim myWorksheet As Excel.Worksheet\n    Dim pc As Excel.PivotCache\n    Dim pt As Excel.PivotTable\n\n    fileName = Replace(fileName, \".xlsx\", \"\")\n\n    On Error Resume Next\n    Set appExcel = GetObject(, \"Excel.Application\")\n    On Error GoTo 0\n    If appExcel Is Nothing Then Set appExcel = CreateObject(\"Excel.Application\")\n    appExcel.Visible = True\n\n    Set myWorkbook = appExcel.Workbooks.Open(path)\n\n    Set pc = myWorkbook.PivotCaches.Create( _\n        SourceType:=xlDatabase, _\n        SourceData:=myWorkbook.Sheets(1).UsedRange) ' this might be adapted\n\n    Set myWorksheet = myWorkbook.Sheets.Add\n    Set pt = pc.CreatePivotTable( _\n        TableDestination:=myWorksheet.Range(\"A3\"), _\n        TableName:=\"PivotTable1\")\n\n    With pt.PivotFields(\"Field1\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n\n    With pt.PivotFields(\"Field2\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n\n    With pt.PivotFields(\"Field3\")\n        .Orientation = xlColumnField\n    End With\n\n    With pt.PivotFields(\"FieldN\")\n        .Orientation = xlDataField\n        .Function = xlSum\n        .Name = \"Sum of FieldN\"\n    End With\n\n    With pt.PivotFields(\"Field+1\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n\n    myWorkbook.Save\n    myWorkbook.Close\n    Set myWorkbook = Nothing\n\n    appExcel.Quit\n    Set appExcel = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1561552887, "creation_date": 1561552887, "answer_id": 56773098, "question_id": 56662777, "link": "https://stackoverflow.com/questions/56662777/making-pivots-in-xlsx-files-in-access-vba/56773098#56773098", "title": "Making pivots in xlsx files in Access VBA", "body": "<p>You can control Excel from Access, using either Early Binding or Late Binding.</p>\n\n<pre><code>' EARLY BINDING\nOption Compare Database\nOption Explicit ' Use this to make sure your variables are defined\n\n' One way to be able to use these objects throughout the Module is to Declare them\n' Here and not in a Sub\n\nPrivate objExcel As Excel.Application\nPrivate xlWB As Excel.Workbook\nPrivate xlWS As Excel.Worksheet\n\nSub Rep()\n\nDim strFile As String\n\nstrFile = \"C:\\Users\\Excel\\Desktop\\YourExcelFile.xls\"\n\n' Opens Excel and makes it Visible\nSet objExcel = New Excel.Application\nobjExcel.Visible = True\n\n'Opens up the Workbook\nSet xlWB = objExcel.Workbooks.Open(strFile)\n\n'Sets the Workseet to the last active sheet - Better to use the commented version and use the name of the sheet.\nSet xlWS = xlWB.ActiveSheet\n'Set xlWS = xlWB(\"Sheet2\")\n\nWith xlWS ' You are now working with the Named file and the named worksheet\n\n\nEnd With\n\n'Do Close and Cleanup\nEnd Sub\n\n\n\u2003\n' LATE BINDING\nSub ControlExcelFromAccess()\n\n' No reference to a type library is needed to use late binding.\n' As long as the object supports IDispatch, the method can\n' be dynamically located and invoked at run-time.\n\n' Declare the object as a late-bound object\n  Dim oExcel As Object\n  Dim strFile As String\n\n  strFile = \"C:\\Users\\Excel\\Desktop\\YourExcelFile.xls\"\n\n  Set oExcel = CreateObject(\"Excel.Application\")\n\n' The Visible property is called via IDispatch\n  oExcel.Visible = True\n\n  Set xlWB = oExcel.Workbooks.Open(strFile)\n\n'Call code here . . .\n\nSet oExcel = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 11668560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add2d558c90cc2f215da9acc20c31f39?s=128&d=identicon&r=PG&f=1", "display_name": "thereal_92", "link": "https://stackoverflow.com/users/11668560/thereal-92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 56669279, "answer_count": 2, "score": 1, "last_activity_date": 1594715535, "creation_date": 1560931200, "last_edit_date": 1594715535, "question_id": 56662777, "link": "https://stackoverflow.com/questions/56662777/making-pivots-in-xlsx-files-in-access-vba", "title": "Making pivots in xlsx files in Access VBA", "body": "<p>There are some xlsx files in \"c:\", exported from Microsoft Access table. There are about 4 files with equal number and names of columns but different data.</p>\n\n<p>When the code starts running, it makes the first xlsx pivot correctly with no problems, but the second iteration causes errors here:</p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    fileName, Version:=6).CreatePivotTable TableDestination:= _\n    \"Sheet1!R3C1\", TableName:=\"PivotTable1\", DefaultVersion:=6\n</code></pre>\n\n<blockquote>\n  <p>Error: Run- time error '91' :  Object Variable or with block variable not set</p>\n</blockquote>\n\n<p>I've already tried to use \"myWorkbook\" before <code>Sheets</code>, <code>ActiveWorkbook</code> etc., but it didn't work or I didn't do it properly.</p>\n\n<p>All Excel files should have pivot tables.</p>\n\n<pre><code>Sub test()\n    Dim strF As String, strP As String\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n\n    'Edit this declaration to your folder name\n    strP = \"c:\\\" 'change for the path of your folder\n\n\n    strF = Dir(strP &amp; \"\\*.xls*\") 'Change as required\n\n\n\n    Do While strF &lt;&gt; vbNullString\n        'MsgBox strP &amp; \"\\\" &amp; strF\n        createPivot strP &amp; \"\\\" &amp; strF, strF\n        strF = Dir()\n    Loop    \nEnd Sub\n\n\nSub createPivot(path As String, fileName As String)\n\n    fileName = Replace(fileName, \".xlsx\", \"\")\n    Dim appExcel As Excel.Application\n    Dim myWorkbook As Excel.Workbook\n\n    Set appExcel = CreateObject(\"Excel.Application\")\n    Set myWorkbook = appExcel.Workbooks.Open(path)\n    appExcel.Visible = True\n\n    Sheets.Add\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        fileName, Version:=6).CreatePivotTable TableDestination:= _\n        \"Sheet1!R3C1\", TableName:=\"PivotTable1\", DefaultVersion:=6\n    Sheets(\"Sheet1\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Field1\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Field2\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Field3\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable1\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable1\").PivotFields(\"FieldN\"), \"Sum of FieldN\", xlSum\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Field+1\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n\n    myWorkbook.Save\n    myWorkbook.Close\n\n    appExcel.Quit\n\n    Set myWorkbook = Nothing\n    Set appExcel = Nothing\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1560931364, "post_id": 56662603, "comment_id": 99894274, "body": "Impossible to say without seeing more of the code.  What is <i>J</i>?"}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1560931737, "creation_date": 1560931737, "answer_id": 56662926, "question_id": 56662603, "link": "https://stackoverflow.com/questions/56662603/how-to-input-validation-message-in-a-cell-from-text-box-in-userform/56662926#56662926", "title": "how to input validation message in a cell from text box in userform?", "body": "<p>You will get this error when you try to set a validation to a cell that has already a validation. </p>\n\n<p>Simply removing the existing validation (with method <code>.Delete</code>) before setting it will prevent the 1004 error:</p>\n\n<pre><code>With ActiveCell.Offset(J, 19).Validation\n    .Delete\n    .Add Type:=xlValidateInputOnly\n    .InputTitle = \"additional info\"\n    .InputMessage = Userform.TextBox9.Text\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11668749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-unG0nbpfutU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf9ArolOPZiOQ3b9BjxLpWIjmoNSQ/mo/photo.jpg?sz=128", "display_name": "Skye Chel", "link": "https://stackoverflow.com/users/11668749/skye-chel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560931737, "creation_date": 1560930548, "question_id": 56662603, "link": "https://stackoverflow.com/questions/56662603/how-to-input-validation-message-in-a-cell-from-text-box-in-userform", "title": "how to input validation message in a cell from text box in userform?", "body": "<p>I'm doing a data entry form for sample analysis.</p>\n\n<p>For 1 test there's several criteria. Thus, I plan to create a validation message pop up for the information keyed in from a text box.</p>\n\n<p>Initially it works but after a while an error message 1004 keep popping up and there's no validation message pop up in the cell selected.</p>\n\n<pre><code>If Userform.CheckBox2.Value = True Then\nActiveCell.Offset(J, 19).Interior.Color = vbYellow\nWith ActiveCell.Offset(J, 19).Validation\n .Add Type:=xlValidateInputOnly\n .InputTitle = \"additional info\"\n .InputMessage = Userform.TextBox9.Text\nEnd With\nEnd If\n</code></pre>\n\n<p>Initially when this code works, when I key in the data in text box 9, the active cell is highlight and there's a validation message pop up when you select the cell.</p>\n\n<p>Now the active cell still highlight but there's no validation message pop up for additional info.</p>\n\n<p>Not sure why last time it works but now it doesn't.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1560967152, "post_id": 56662485, "comment_id": 99914170, "body": "A tab control is irrelevant when referencing controls placed directly on pages and not in subform. Same code should work. Something else is wrong when using tab control. Instead of DLookup, include CID as column in combobox and code can reference column to grab value. Are these comboboxes cascading - is Provider list restricted by Plant choice or vice versa?"}, {"owner": {"reputation": 3, "user_id": 11531616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d517018cba517cfda3b20ebd805347?s=128&d=identicon&r=PG&f=1", "display_name": "cyndy ", "link": "https://stackoverflow.com/users/11531616/cyndy"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1561009224, "post_id": 56662485, "comment_id": 99925290, "body": "I didn&#39;t use combo boxes cascading  for choosing provider&amp; plant yet. when I tested, just choose those have the record in Table Contractor."}], "owner": {"reputation": 3, "user_id": 11531616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d517018cba517cfda3b20ebd805347?s=128&d=identicon&r=PG&f=1", "display_name": "cyndy ", "link": "https://stackoverflow.com/users/11531616/cyndy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560966858, "creation_date": 1560930069, "last_edit_date": 1560966858, "question_id": 56662485, "link": "https://stackoverflow.com/questions/56662485/how-to-use-dlookup-for-1-field-in-tab-control-of-access-form", "title": "How to use Dlookup for 1 field in Tab Control of Access Form", "body": "<p>Still working with Access 365, I have 4 Tables and 1 form </p>\n\n<pre><code>Table Plant {PID(key), Name}\uff1b  \nTable Provider {VID(key), Company}\uff1b \nTable Contractor {CID(key), Plant, Provider}\uff1b  \nTable KPI {KID(key), ServiceID, KPI1, KPI2}. \n</code></pre>\n\n<p>Their relationship: </p>\n\n<pre><code>Plant.PID = Contractor.Plant,  \nProvider.PID = Contractor.Provider,\nContractor.CID= KPI.ServiceID\n</code></pre>\n\n<p>Form KPI bound with Table KPI, to simplify the way to input data, I created a tab control \"TabCtl64\" with 2 pages - \"KPI\" and \"Detail\". In page \"KPI\", there are combobox \"cbxPlantID\", combobox \"cbxProviderID\" and a text field \"ServiceID\". What I want: when user choose the plant from \"cbxPlantID\" and the Provider from \"cbxProviderID\", it will lookup CID from table Contractor then retrieve the value into field \"ServiceID\".</p>\n\n<p>I tried like this :</p>\n\n<pre><code>Private Sub cbxProviderID_AfterUpdate()\nServiceID = DLookup(\"[CID]\", \"Contractor\", \"[Plant]= \" &amp; [Forms]![KPI]![cbxPlantID] &amp; \" And [Provider] =\" &amp; [Forms]![KPI]![cbxProviderID])\nEnd Sub\n</code></pre>\n\n<p>Then error shows: can't find a record in the table Contractor with key matching field ServiceID. But there is the record.\nAnd I created another form without Tab Control, same code can work - so I guess the problem may be linked with naming conversion in Dlookup of comboboxes cbxPlantID and cbxProviderID: [Forms]![KPI]![cbxPlantID] is not correct for a field in Tab control of form. But I can't find how to correct.\nDoes anyone know it?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 4, "creation_date": 1560929969, "post_id": 56662387, "comment_id": 99893616, "body": "For sure, don&#39;t use semicolon in vba, just the comma (except your lookup string offcourse)"}], "answers": [{"tags": [], "owner": {"reputation": 414, "user_id": 11049576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reV7L.jpg?s=128&g=1", "display_name": "Regiz", "link": "https://stackoverflow.com/users/11049576/regiz"}, "is_accepted": false, "score": 0, "last_activity_date": 1562134250, "creation_date": 1562134250, "answer_id": 56863931, "question_id": 56662387, "link": "https://stackoverflow.com/questions/56662387/using-string-elements-in-vba-formula/56863931#56863931", "title": "Using string elements in vba formula", "body": "<p>Refer The below link to know more about <strong>Writing Formulas with VBA Macros in Excel</strong></p>\n\n<p><a href=\"https://www.excelcampus.com/vba/writing-formulas-with-macros/\" rel=\"nofollow noreferrer\">https://www.excelcampus.com/vba/writing-formulas-with-macros/</a></p>\n\n<p>Please refer the below sample, hope which can help u to get an idea for Modifying your code.</p>\n\n<p><strong>Note:</strong> The below is just sample not for your workbook </p>\n\n<pre><code>Option Explicit\n\n    Sub Formula_Property()\n\n      'Formula is a string of text wrapped in quotation marks\n      'Starts with an = sign\n      Range(\"B10\").Formula = \"=SUM(B4:B9)\"\n\n    End Sub\n\n\n    Sub Macro10()\n    '\n    ' Macro10 Macro\n    '\n\n    '\n        Range(\"B14\").Select\n        ActiveCell.FormulaR1C1 = _\n            \"=IFERROR(VLOOKUP(R[-10]C[-1],Table!R2C10:R370C11,2,FALSE),\"\"\"\")\"\n        Range(\"B15\").Select\n        ActiveCell.FormulaR1C1 = \"=\"\"Total Sales: \"\" &amp; TEXT(R[-5]C,\"\"$#,###\"\")\"\n        Range(\"B14\").Select\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 9476917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q5NET.jpg?s=128&g=1", "display_name": "Maeaex1", "link": "https://stackoverflow.com/users/9476917/maeaex1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562134250, "creation_date": 1560929731, "question_id": 56662387, "link": "https://stackoverflow.com/questions/56662387/using-string-elements-in-vba-formula", "title": "Using string elements in vba formula", "body": "<p>I am stuck to write a formula into cells using vba. I double quoted the strings and tried different combinations, but I still get an <code>Application-defined or object-defined error.</code></p>\n\n<p>The formula I am currently using in VBA:</p>\n\n<pre><code>ws_conf.Range(\"A60\").Formula = \"=IF(Veraltete_Ratings!A11=\"\"\"\";\"\"\"\"; \"\"-   \"\" &amp; Veraltete_Ratings!C11 &amp; \"\" (\"\" &amp; Veraltete_Ratings!B11&amp; \"\"):\"\" &amp; Veraltete_Ratings!AD11 &amp; \"\" (vorher \"\" &amp; VLOOKUP(Veraltete_Ratings!B11;Datenbank!B:BC;54;FALSE) &amp; \"\")\"\")\"\n</code></pre>\n\n<p>The original formula in Excel:</p>\n\n<pre><code>=IF(Veraltete_Ratings!A11=\"\";\"\"; \"-   \" &amp; Veraltete_Ratings!C11 &amp; \" (\" &amp; Veraltete_Ratings!B11&amp; \"):\" &amp; Veraltete_Ratings!AD11&amp; \" (vorher \" &amp; VLOOKUP(Veraltete_Ratings!B11;Datenbank!B:BC;54;FALSE) &amp;\")\")\n</code></pre>\n\n<p>Glad for any help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560929466, "post_id": 56662197, "comment_id": 99893360, "body": "You will need a third party tool or library to open each PDF file and process/analyze it. There are no buit in features in VBA to do that. Therefore this question is a way too broad to be answered."}, {"owner": {"reputation": 1, "user_id": 11668632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b343b8c4e33f8ee8c5421a908a7f8505?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant", "link": "https://stackoverflow.com/users/11668632/hemant"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560929612, "post_id": 56662197, "comment_id": 99893439, "body": "But we can search the specific text in folder search box that gives the list of pdf files contents that text...so we can get count of that...is it not possible in VBA ???"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560929672, "post_id": 56662197, "comment_id": 99893464, "body": "Not without using a third party tool or library."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560932317, "post_id": 56662197, "comment_id": 99894756, "body": "Without open the PDF Files you will not be able to count the Words. And how @P\u1d07\u029c said you will need a third Party tool. You can take a look at this Code for Inspiration: <a href=\"https://software-solutions-online.com/how-to-search-a-pdf-for-a-string-using-vba-for-excel/\" rel=\"nofollow noreferrer\">software-solutions-online.com/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 11668632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b343b8c4e33f8ee8c5421a908a7f8505?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant", "link": "https://stackoverflow.com/users/11668632/hemant"}, "edited": false, "score": 0, "creation_date": 1560932930, "post_id": 56662197, "comment_id": 99895025, "body": "Dear Sir, I dont want to open PDF files that takes too much time as pdf files are big....Code you gave is seaching the word after opening the pdf file that will take too much time...."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560932973, "post_id": 56662197, "comment_id": 99895053, "body": "@Hemant You cannot analyze and count words without opening the files. <b>That is impossible.</b> Every program or library will have to do that to analyze the content of the files."}, {"owner": {"reputation": 1, "user_id": 11668632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b343b8c4e33f8ee8c5421a908a7f8505?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant", "link": "https://stackoverflow.com/users/11668632/hemant"}, "edited": false, "score": 0, "creation_date": 1560940673, "post_id": 56662197, "comment_id": 99899373, "body": "Please let me know how to get this by VBA code........&gt;Go to link please....<a href=\"https://stackoverflow.com/questions/56665689/wait-till-pdf-file-open-and-wait-till-pdf-file-close-without-giving-any-specif\" title=\"wait till pdf file open and wait till pdf file close without giving any specif\">stackoverflow.com/questions/56665689/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 11668632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b343b8c4e33f8ee8c5421a908a7f8505?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant", "link": "https://stackoverflow.com/users/11668632/hemant"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561189026, "post_id": 56662197, "comment_id": 99989553, "body": "@P\u1d07\u029c I dont want to count the number of times that word comes in pdf file...i want number of file count that contains that word.....could you please go on below link there people saying grep function can search word in directory and give count of files    please ref <a href=\"https://unix.stackexchange.com/questions/6648/number-of-files-containing-a-given-string\" title=\"number of files containing a given string\">unix.stackexchange.com/questions/6648/&hellip;</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561296008, "post_id": 56662197, "comment_id": 100008573, "body": "Number of words in the file name or number of words in the files text or number of files that contain the word in their file name or number of files that contain that word in their text? Please be clear which of these 4 options you actually mean. And <code>grep</code> is a Linux command line tool and not VBA."}, {"owner": {"reputation": 1, "user_id": 11668632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b343b8c4e33f8ee8c5421a908a7f8505?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant", "link": "https://stackoverflow.com/users/11668632/hemant"}, "edited": false, "score": 0, "creation_date": 1561452752, "post_id": 56662197, "comment_id": 100058229, "body": "last one - &quot;number of files that contain that word in their text&quot; but without opening the pdf file :)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11668632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b343b8c4e33f8ee8c5421a908a7f8505?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant", "link": "https://stackoverflow.com/users/11668632/hemant"}, "edited": false, "score": 0, "creation_date": 1562235321, "post_id": 56776864, "comment_id": 100318613, "body": "Thanks for your efforts...!!!! Bt i am getting stuck at converting pdf to word in &quot;ChangeFileOpenDirectory&quot; &amp; &quot;Format:=wdOpenFormatAuto&quot;.......pleas guide"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 1, "user_id": 11668632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b343b8c4e33f8ee8c5421a908a7f8505?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant", "link": "https://stackoverflow.com/users/11668632/hemant"}, "edited": false, "score": 0, "creation_date": 1562235636, "post_id": 56776864, "comment_id": 100318769, "body": "Everything worked fine for me.  That&#39;s pretty standard VBA.  Are you on a Mac, perhaps?  You may have to modify the code slightly to work on a Mac.  I have never used Mac, so I can&#39;t say for sure what you need to do.  Again, the code worked totally fine for me."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1561564675, "creation_date": 1561564675, "answer_id": 56776864, "question_id": 56662197, "link": "https://stackoverflow.com/questions/56662197/search-some-text-word-in-folder-containing-bunch-of-pdf-files-and-get-count-of-p/56776864#56776864", "title": "Search some text/word in folder containing bunch of PDF files and get count of PDF contains that text/word - Without opening pdf files", "body": "<p>I don't see how you will get the content of the PDF files, or any files for that matter, without opening the files.  Also, you will need Adobe Acrobat installed to scan PDF files using VBA.  I don't know how much it costs, but it's not free.  If you want a free option, convert all PDF files into Word files and then do scans on those.</p>\n\n<pre><code>Sub ConvertToWord()\n   Dim MyObj As Object, MySource As Object, file As Variant\n   file = Dir(\"C:\\Users\\Excel\\Desktop\\test\\\" &amp; \"*.pdf\") 'pdf path\n   Do While (file &lt;&gt; \"\")\n   ChangeFileOpenDirectory \"C:\\Users\\Excel\\Desktop\\test\\\"\n          Documents.Open FileName:=file, ConfirmConversions:=False, ReadOnly:= _\n        False, AddToRecentFiles:=False, PasswordDocument:=\"\", PasswordTemplate:= _\n        \"\", Revert:=False, WritePasswordDocument:=\"\", WritePasswordTemplate:=\"\", _\n        Format:=wdOpenFormatAuto, XMLTransform:=\"\"\n    ChangeFileOpenDirectory \"C:\\Users\\Excel\\Desktop\\test\\\" 'path for saving word\n    ActiveDocument.SaveAs2 FileName:=Replace(file, \".pdf\", \".docx\"), FileFormat:=wdFormatXMLDocument _\n        , LockComments:=False, Password:=\"\", AddToRecentFiles:=True, _\n        WritePassword:=\"\", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:=False, _\n         SaveNativePictureFormat:=False, SaveFormsData:=False, SaveAsAOCELetter:= _\n        False, CompatibilityMode:=15\n    ActiveDocument.Close\n     file = Dir\n   Loop\nEnd Sub\n</code></pre>\n\n<p>Then, run this code below, in Excel.</p>\n\n<pre><code>Sub OpenAndReadWordDoc()\n\nRows(\"2:1000000\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\nRange(\"A1\").Select\n\n    ' assumes that the previous procedure has been executed\n    Dim oWordApp As Word.Application\n    Dim oWordDoc As Word.Document\n    Dim blnStart As Boolean\n    Dim r As Long\n    Dim sFolder As String\n    Dim strFilePattern As String\n    Dim strFileName As String\n    Dim sFileName As String\n    Dim ws As Worksheet\n    Dim c As Long\n    Dim n As Long\n    Dim iCount As Long\n    Dim strSearch As String\n\n    '~~&gt; Establish an Word application object\n    On Error Resume Next\n    Set oWordApp = GetObject(, \"Word.Application\")\n    If Err Then\n        Set oWordApp = CreateObject(\"Word.Application\")\n        ' We started Word for this macro\n        blnStart = True\n    End If\n    On Error GoTo ErrHandler\n\n    Set ws = ActiveSheet\n    r = 1 ' startrow for the copied text from the Word document\n    ' Last column\n    n = ws.Range(\"A1\").End(xlToRight).Column\n\n    sFolder = \"C:\\Users\\Excel\\Desktop\\test\\\"\n\n    '~~&gt; This is the extension you want to go in for\n    strFilePattern = \"*.doc*\"\n    '~~&gt; Loop through the folder to get the word files\n    strFileName = Dir(sFolder &amp; strFilePattern)\n    Do Until strFileName = \"\"\n        sFileName = sFolder &amp; strFileName\n\n        '~~&gt; Open the word doc\n        Set oWordDoc = oWordApp.Documents.Open(sFileName)\n        ' Increase row number\n        r = r + 1\n        ' Enter file name in column A\n        ws.Cells(r, 1).Value = sFileName\n\n        ActiveCell.Offset(1, 0).Select\n        ActiveSheet.Hyperlinks.Add Anchor:=Sheets(\"Sheet1\").Range(\"A\" &amp; r), Address:=sFileName, _\n        SubAddress:=\"A\" &amp; r, TextToDisplay:=sFileName\n\n        ' Loop through the columns\n        For c = 2 To n\n            If oWordDoc.Content.Find.Execute(FindText:=Trim(ws.Cells(1, c).Value), _\n                    MatchWholeWord:=True, MatchCase:=False) Then\n\n                    strSearch = ws.Cells(1, c).Value\n                    iCount = 0\n\n                    With ActiveDocument.Content.Find\n                        .Text = strSearch\n                        .Format = False\n                        .Wrap = wdFindStop\n                        Do While .Execute\n                            iCount = iCount + 1\n                        Loop\n                    End With\n\n            ws.Cells(r, c).Value = iCount\n            End If\n        Next c\n        oWordDoc.Close SaveChanges:=False\n\n        '~~&gt; Find next file\n        strFileName = Dir\n    Loop\n\nExitHandler:\n    On Error Resume Next\n    ' close the Word application\n    Set oWordDoc = Nothing\n    If blnStart Then\n        ' We started Word, so we close it\n        oWordApp.Quit\n    End If\n    Set oWordApp = Nothing\n    Exit Sub\n\nErrHandler:\n    MsgBox Err.Description, vbExclamation\n    Resume ExitHandler\nEnd Sub\n\nFunction GetDirectory(path)\n   GetDirectory = Left(path, InStrRev(path, \"\\\"))\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/YdIW7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YdIW7.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here, the counts are the same because I copied/pasted the same file 4x so I had something to loop over.</p>\n"}], "owner": {"reputation": 1, "user_id": 11668632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b343b8c4e33f8ee8c5421a908a7f8505?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant", "link": "https://stackoverflow.com/users/11668632/hemant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561564675, "creation_date": 1560929020, "last_edit_date": 1560929741, "question_id": 56662197, "link": "https://stackoverflow.com/questions/56662197/search-some-text-word-in-folder-containing-bunch-of-pdf-files-and-get-count-of-p", "title": "Search some text/word in folder containing bunch of PDF files and get count of PDF contains that text/word - Without opening pdf files", "body": "<p>Aim - I want VBA code that should search specific text/word in content inside bunch of pdf files and give me COUNT of PDF contains that word (without opening pdf files)</p>\n\n<p>Currently I have code found on internet giving me count of PDF files that contains specific text in the > Name of pdf files &lt;</p>\n\n<p>But as mentioned I want to modify below code/give me new code that should give me COUNT of pdf files contains that specific word inside the PDF content</p>\n\n<p>Below is the current code I have</p>\n\n<pre><code>Sub PDFCONTENT()\n    Dim i As Long\n    Dim x As Integer\n    Dim Folder As String\n    Dim ExcelFN As String\n    Dim NumFiles As Integer\n    Dim filename As String\n    Dim FinsS As String\n\n    For i = 2 To Range(\"A\" &amp; Rows.count).End(xlDown).Row\n        NumFiles = 0\n\n        Folder = Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value\n        ExcelFN = Sheets(\"Sheet1\").Range(\"B\" &amp; i).Value\n\n        filename = Dir(Folder &amp; \"*\" &amp; ExcelFN &amp; \"*\")\n\n        Do While filename &lt;&gt; \"\"\n            NumFiles = NumFiles + 1\n            filename = Dir()\n        Loop\n\n        Sheets(\"Sheet1\").Range(\"C\" &amp; i) = NumFiles\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "exception"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1560929698, "post_id": 56662191, "comment_id": 99893480, "body": "What is the use of <code>tbAC = tbAC</code>? It&#39;s like saying 1=1, there is no point and nothing changes"}, {"owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560930040, "post_id": 56662191, "comment_id": 99893649, "body": "@TimStack you&#39;re right, I should remove that. For this code, tbAC is numerical, where (example)136 is a criteria that exists. Am trying to input a line of code where the user did input a value, but the value cannot be found in my filter range"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560930198, "post_id": 56662191, "comment_id": 99893719, "body": "A simple <code>.Find</code> to check if the value&#39;s present in the range before you execute the autofilter should do the trick"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "edited": false, "score": 0, "creation_date": 1560930635, "post_id": 56662405, "comment_id": 99893916, "body": "I&#39;ve initially declared this as Long as it&#39;s a numerical column number. As with my existing codes, an error message does not pop out if i key in wrong data, but rather the sheet just displays empty rows"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "edited": false, "score": 0, "creation_date": 1560930758, "post_id": 56662405, "comment_id": 99893962, "body": "@Valwrie empty rows as in, there is no data except for the headers?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "edited": false, "score": 0, "creation_date": 1560931880, "post_id": 56662405, "comment_id": 99894532, "body": "@Valwrie your problem is that you are filtering on the field <code>AGCN</code> and you should filter the field <code>AgentCodeN</code>"}, {"owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "edited": false, "score": 0, "creation_date": 1560932270, "post_id": 56662405, "comment_id": 99894728, "body": "@Damian I&#39;ve noticed, have edited the post again to correct those values and the invalid text still doesn&#39;t pop"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "edited": false, "score": 0, "creation_date": 1560932419, "post_id": 56662405, "comment_id": 99894804, "body": "Your code looks for &quot;AGC&quot;, if AGC is there, it won&#39;t ever show an error message @Valwrie"}, {"owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "edited": false, "score": 0, "creation_date": 1560933092, "post_id": 56662405, "comment_id": 99895111, "body": "@Damian have posted up an update of what I&#39;ve tried again with all the corrections"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1560929801, "creation_date": 1560929801, "answer_id": 56662405, "question_id": 56662191, "link": "https://stackoverflow.com/questions/56662191/filter-function-if-data-does-not-fulfil-criteria-prompt-error/56662405#56662405", "title": "Filter function, if data does not fulfil criteria, prompt error", "body": "<p>Use a <code>Variant</code>Variable for <code>AgentCodeN</code> and use <code>Application.Match</code> like this:</p>\n\n<pre><code>Option Explicit\nSub test()\n\n    Dim AgentCodeN As Variant\n\n    If tbAC.TextLength &gt; 0 Then\n        tbAC = tbAC\n        AgentCodeN = Application.Match(Rows(\"1:1\"), \"AGC\", 0)\n        If Not IsError(AgentCodeN) Then\n            ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter field:=AGCN, Criteria1:=tbAC\n        'Assuming that I'm supposed to add a line of code here, smth along the line of if criteria:=\"\"\n        Else\n            MsgBox \"Invalid Input\"\n        End If\n    ElseIf tbAC.TextLength = 0 Then\n        tbAC = \"\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I don't know if you declared your variables but using <code>Option Explicit</code> will force you to do so.</p>\n"}], "owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56662405, "answer_count": 1, "score": 1, "last_activity_date": 1560933654, "creation_date": 1560929015, "last_edit_date": 1560933654, "question_id": 56662191, "link": "https://stackoverflow.com/questions/56662191/filter-function-if-data-does-not-fulfil-criteria-prompt-error", "title": "Filter function, if data does not fulfil criteria, prompt error", "body": "<p>This is for a textbox after update. It will only filter if there's a value more than 0. However, I can't seem to find out where to add that it prompts an error message if a value is keyed in but cannot be found in the filter range</p>\n\n<pre><code>If tbAC.TextLength &gt; 0 Then\n    AGCN = Rows(\"1:1\").Find(what:=\"AGC\", lookat:=xlWhole).Column\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter field:=AGCN, Criteria1:=tbAC\n    'Assuming that I'm supposed to add a line of code here, smth along the line of if criteria:=\"\" \n    'Msgbox \"Invalid Input\"\nElseIf tbAC.TextLength = 0 Then\n    tbAC = \"\"\nEnd If\n</code></pre>\n\n<p>Success edit! </p>\n\n<pre><code>Private Sub tbAC_AfterUpdate()\nDim AGCN As Long\nDim AGCL As String\nDim Namef As Range\n\nAGCN = Rows(\"1:1\").Find(what:=\"AGC\", lookat:=xlWhole).Column\nAGCL = Split(Cells(1, AGCN).Address, \"$\")(1)\n\n\nIf tbAC.TextLength &gt; 0 Then\n    'Set Namef = Range(AGCL:AGCL).Find(tbAC)\n    Set Namef = Range(AGCL &amp; \":\" &amp; AGCL).Find(tbAC)\n    If Namef Is Nothing Then\n        MsgBox (\"Invalid Input\")\n    Else\n        ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter field:=AGCN, Criteria1:=tbAC\n    End If\nElseIf tbAC.TextLength = 0 Then\n    tbAC = \"\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powershell", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3419830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bad591cadbe82e8945c7e5e6dab9d2a?s=128&d=identicon&r=PG&f=1", "display_name": "cptcherry", "link": "https://stackoverflow.com/users/3419830/cptcherry"}, "edited": false, "score": 0, "creation_date": 1560950683, "post_id": 56662190, "comment_id": 99905190, "body": "A likely silly question - but are these two sections in the one &#39;module&#39; or in two different modules? I tried it both ways, but when I click run, it launches the select macro box, which shows up as empty."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 33, "user_id": 3419830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bad591cadbe82e8945c7e5e6dab9d2a?s=128&d=identicon&r=PG&f=1", "display_name": "cptcherry", "link": "https://stackoverflow.com/users/3419830/cptcherry"}, "edited": false, "score": 0, "creation_date": 1560950969, "post_id": 56662190, "comment_id": 99905380, "body": "Eh... you need to wrap the second piece of code in a sub, e.g. <code>Public Sub SomeName()</code>, then the code, then <code>End Sub</code>. I copied it from the question, I assumed you were already doing that. It doesn&#39;t matter if it&#39;s one or two modules. I do recommend taking a basic VBA tutorial, pasting code without knowledge of what it&#39;s doing is tricky business."}, {"owner": {"reputation": 33, "user_id": 3419830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bad591cadbe82e8945c7e5e6dab9d2a?s=128&d=identicon&r=PG&f=1", "display_name": "cptcherry", "link": "https://stackoverflow.com/users/3419830/cptcherry"}, "edited": false, "score": 0, "creation_date": 1560952352, "post_id": 56662190, "comment_id": 99906244, "body": "Yes, that&#39;s right - it was wrapped in public sub/end sub. I&#39;m getting a bad file name or number error - I suspect it&#39;s due using &#39; * &#39; in some of my query names."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 33, "user_id": 3419830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bad591cadbe82e8945c7e5e6dab9d2a?s=128&d=identicon&r=PG&f=1", "display_name": "cptcherry", "link": "https://stackoverflow.com/users/3419830/cptcherry"}, "edited": false, "score": 0, "creation_date": 1560952428, "post_id": 56662190, "comment_id": 99906297, "body": "Yup, either adjust your query names or write a function to sanitize them. Note that characters like that can cause all kinds of trouble when referring to queries by name in SQL, VBA, etc."}, {"owner": {"reputation": 33, "user_id": 3419830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bad591cadbe82e8945c7e5e6dab9d2a?s=128&d=identicon&r=PG&f=1", "display_name": "cptcherry", "link": "https://stackoverflow.com/users/3419830/cptcherry"}, "edited": false, "score": 0, "creation_date": 1560953388, "post_id": 56662190, "comment_id": 99906918, "body": "Fixed up the names - and works a treat - thanks for your help! Yes, I&#39;ve realised that it causes all sorts of problems, file names, excel sheet names etc."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1560929014, "creation_date": 1560929014, "answer_id": 56662190, "question_id": 56662041, "link": "https://stackoverflow.com/questions/56662041/using-vba-or-powershell-to-export-all-ms-access-sql-queries-to-text-files/56662190#56662190", "title": "Using VBA OR PowerShell to export all MS Access SQL queries to text files", "body": "<p>Let's adjust the VBA solution. Step 1 would be to declare a function that takes input, and writes it to a text file:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Writes content to a text file\n'Note: encoding = UTF-16, overwrites without prompt\nPublic Sub ToTextFile(path As String, content As String)\n    If Dir(path) &lt;&gt; \"\" Then Kill path\n    Dim f As Integer\n    f = FreeFile\n    Open path For Binary Access Write As #f\n    Put #f, , content\n    Close #f\nEnd Sub\n</code></pre>\n\n<p>Then, we can easily adjust your current code to put each query in a separate text file. I'm going to use the path of your database and the name of the query as the location of the text file:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database\nDim qdf As DAO.QueryDef\n\n Set db = CurrentDB()\n For Each qdf In db.QueryDefs\n   If qdf.Name Not Like \"~*\" Then\n       ToTextFile CurrentProject.Path &amp; \"\\\" &amp; qdf.Name &amp; \".txt\", qdf.sql\n   End If\n Next qdf\n Set qdf = Nothing\n Set db = Nothing\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3419830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bad591cadbe82e8945c7e5e6dab9d2a?s=128&d=identicon&r=PG&f=1", "display_name": "cptcherry", "link": "https://stackoverflow.com/users/3419830/cptcherry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 56662190, "answer_count": 1, "score": 0, "last_activity_date": 1612211833, "creation_date": 1560928521, "last_edit_date": 1594715550, "question_id": 56662041, "link": "https://stackoverflow.com/questions/56662041/using-vba-or-powershell-to-export-all-ms-access-sql-queries-to-text-files", "title": "Using VBA OR PowerShell to export all MS Access SQL queries to text files", "body": "<p>Wishing to export the underlying sql of ~200 queries from access 2013 to separate txt/*.sql files - not the data that the queries collect.</p>\n\n<p>This q/a provided a suitable answer: <a href=\"https://stackoverflow.com/questions/1275502/using-vba-to-export-all-ms-access-sql-queries-to-text-files\">Using VBA to export all MS Access SQL queries to text files</a> \nbut I was not able to get it working to generate the output files. I'm a vba novice, but require to get this working as a once off. It would save a lot of time.</p>\n\n<p>I also looked here at using a PowerShell script: \n<a href=\"https://stackoverflow.com/questions/35753666/export-all-queries-of-an-access-database-with-powershell?noredirect=1&amp;lq=1\">Export all queries of an access database with powershell</a> \nAs similar, I was not able to get it to generate the output files.</p>\n\n<p>I don't mind which process I use, I just need the sql :)</p>\n\n<pre><code>Dim db As DAO.Database\n Dim qdf As DAO.QueryDef\n\n Set db = CurrentDB()\n For Each qdf In db.QueryDefs\n   Debug.Print qdf.SQL\n Next qdf\n Set qdf = Nothing\n Set db = Nothing\n</code></pre>\n\n<pre><code>$dbe = New-Object -com DAO.DBEngine.120\n$db = $dbe.OpenDatabase(\"C:\\Users\\Public\\Database1.accdb\")\n$queries = $db.QueryDefs\nForEach ($query in $queries) {\n    $name = $query.Name\n    If (!$name.StartsWith(\"~\")) {\n        $name\n    }\n}\n</code></pre>\n\n<p>VBA: No error messages are returned, but I suspect it's missing an output component of the code.</p>\n\n<p>PowerShell: No error messages are returned but again, missing an output component of the code.</p>\n\n<p>Appreciate your help!</p>\n"}, {"tags": ["excel", "vba", "oracle"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560928690, "post_id": 56661987, "comment_id": 99892917, "body": "I think you can drop all instances of <code>vbCrLf</code> in the query"}, {"owner": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560929371, "post_id": 56661987, "comment_id": 99893305, "body": "@Tim - Still getting the same error"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1560946710, "post_id": 56661987, "comment_id": 99902716, "body": "Do you try to catch <code>dbms_output.put_line(tmp_table || &#39; - &#39; || row_cnt);</code>? You don&#39;t have access to dbms_output when you call Oracle via ADODB."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "edited": false, "score": 0, "creation_date": 1560929353, "post_id": 56662211, "comment_id": 99893289, "body": "I have removed the res_meta.close, still same error"}, {"owner": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "edited": false, "score": 0, "creation_date": 1560929561, "post_id": 56662211, "comment_id": 99893412, "body": "when I verified res_meta.status, it returns 0. So I think none is captured in recordset"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "edited": false, "score": 0, "creation_date": 1560929631, "post_id": 56662211, "comment_id": 99893447, "body": "I think you are still getting the error because you are trying to copy a non-existing recordset. I reckon no recordset exists hence the errors. On what line are you getting the error?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "edited": false, "score": 0, "creation_date": 1560930247, "post_id": 56662211, "comment_id": 99893732, "body": "Yes exactly, <i>&quot;I think you are still getting the error because you are trying to copy a non-existing recordset&quot;</i>. There is no recordset, so you can&#39;t close it nor copy its values. I will edit my answer."}, {"owner": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "edited": false, "score": 0, "creation_date": 1560935045, "post_id": 56662211, "comment_id": 99896228, "body": "Yup I understood the issue and thanks for your code to handle the situation, but in Oracle Developer I am able to fetch the results for the same code, then why it is not returning anything while invoking thru VBA code?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "edited": false, "score": 0, "creation_date": 1560935122, "post_id": 56662211, "comment_id": 99896273, "body": "I am not familiar with Oracle so unfortunately I cannot tell you"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1560930678, "last_edit_date": 1560930678, "creation_date": 1560929072, "answer_id": 56662211, "question_id": 56661987, "link": "https://stackoverflow.com/questions/56661987/unable-to-execute-pass-block-of-sql-code-to-oracle-through-excel-vba/56662211#56662211", "title": "Unable to execute/pass block of SQL code to Oracle through Excel-VBA", "body": "<p>I believe the error is due to the <code>res_meta.Close</code> line</p>\n\n<p>You can't close a recordset when no recordset was returned. Your <code>Select...</code> query <em>does</em> return a recordset, but from a quick glance it appears the other query makes a temp table and therefore does not return a recordset. Remove the line that is supposed to close the recordset, and the code should work.</p>\n\n<p>The following method won't return anything if no recordset was returned. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>res_meta.Open sqlQry, cnn_meta, adOpenStatic\nOn Error Resume Next\n    Debug.Print rs.EOF\nOn Error GoTo 0\nIf err.Number &lt;&gt; 0 Then\n    MsgBox \"No recordset was returned\", vbCritical, \"Error\"\nElse\n    For iCols = 0 To res_meta.Fields.Count - 1\n        Worksheets(\"sheet1\").Cells(1, iCols + 1).Value = res_meta.Fields(iCols).Name\n    Next\n\n    Worksheets(\"sheet1\").Range(\"A2\").CopyFromRecordset res_meta\n    res_meta.Close\nEnd If\nerr.Clear\ncnn_meta.Close\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560931143, "creation_date": 1560928309, "last_edit_date": 1560931143, "question_id": 56661987, "link": "https://stackoverflow.com/questions/56661987/unable-to-execute-pass-block-of-sql-code-to-oracle-through-excel-vba", "title": "Unable to execute/pass block of SQL code to Oracle through Excel-VBA", "body": "<p>I am trying to pass block of SQL(Oracle) to fetch the results and store in excel using VBA. Connection established successfully and able to fetch results of a simple query. But while replacing the simple query with a block of SQL it returning an error.</p>\n\n<p><strong>Note:</strong> Because of limited access to DB, I am unable to create function. So trying to pass the same block of code in run time.</p>\n\n<p><strong>Trying to achieve</strong> - Fetching each table row count from DB and storing in excel by handling exception too</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>cnn_meta.Open (.....)\nsqlQry = \"DECLARE tmp_table VARCHAR2(125); table_does_not_exist EXCEPTION; PRAGMA EXCEPTION_INIT(table_does_not_exist, -00942); row_cnt integer; \" &amp; vbCrLf &amp; _\n            \"BEGIN FOR cntr IN (SELECT owner,table_name FROM all_tables where owner='APPQOSSYS')\" &amp; vbCrLf &amp; _\n            \"  LOOP BEGIN tmp_table := cntr.owner || '.' || cntr.table_name; EXECUTE IMMEDIATE 'SELECT count(1) FROM ' || tmp_table ||' where rownum =1' into row_cnt; dbms_output.put_line(tmp_table || ' - ' || row_cnt); \" &amp; vbCrLf &amp; _\n            \"        EXCEPTION WHEN table_does_not_exist THEN dbms_output.put_line('table dose not exists - ' || tmp_table); \" &amp; vbCrLf &amp; _\n            \"            WHEN OTHERS THEN IF (SQLCODE = -942) THEN DBMS_Output.Put_Line('in exception'); ELSE DBMS_Output.Put_Line(tmp_table || ' - Dont have access\\didnt exist'); END IF; \" &amp; vbCrLf &amp; _\n            \"END; END LOOP; END;\"\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>res_meta.Open sqlQry, cnn_meta, adOpenStatic\nFor iCols = 0 To res_meta.Fields.Count - 1\n            Worksheets(\"sheet1\").Cells(1, iCols + 1).Value = res_meta.Fields(iCols).Name\nNext\n\nWorksheets(\"sheet1\").Range(\"A2\").CopyFromRecordset res_meta\nres_meta.Close\ncnn_meta.Close\n\n</code></pre>\n\n<p>While I am executing the above code it returns below error</p>\n\n<blockquote>\n  <p>Run-time error '3704':<br>\n  Operation is not allowed when the object is closed</p>\n</blockquote>\n\n<p>When I replaced the simple query to the above code it is working fine. </p>\n\n<p><strong>Simple\\Passed Query-</strong></p>\n\n<pre><code>sqlQry = \"select owner,table_name, to_number(extractvalue(xmltype(dbms_xmlgen.getxml('select count(*) c from '||owner ||'.'||table_name)),'/ROWSET/ROW/C')) Count \" &amp; _\n    '         \"from all_tables\"\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "edited": false, "score": 0, "creation_date": 1561451458, "post_id": 56669115, "comment_id": 100057606, "body": "No I am not interested in the mail forward application of it. PR_IN_REPLY_TO_ID seems like a good option since the existing additional function that sets the folder for the reply is included in the ItemSend Event. I navigated to the link you provided, but I couldnt understand how I could use it. Can you provide some links from where I can understand how one can implement this PR_IN_REPLY_TO?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "edited": false, "score": 0, "creation_date": 1561712932, "post_id": 56669115, "comment_id": 100162282, "body": "Read the PR_IN_REPLY_TO_ID property (DASL name <a href=\"http://schemas.microsoft.com/mapi/proptag/0x1042001F\" rel=\"nofollow noreferrer\">schemas.microsoft.com/mapi/proptag/0x1042001F</a>) using <code>MailItem.PropertyAccessor.GetProperty()</code>. To  access all MIME headers of the messages, read the PR_TRANSPORT_MESSAGE_HEADERS property (DASL name <a href=\"http://schemas.microsoft.com/mapi/proptag/0x007D001F\" rel=\"nofollow noreferrer\">schemas.microsoft.com/mapi/proptag/0x007D001F</a>)."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1560951633, "creation_date": 1560951633, "answer_id": 56669115, "question_id": 56661785, "link": "https://stackoverflow.com/questions/56661785/how-to-reference-the-original-mail-of-a-reply/56669115#56669115", "title": "How to reference the original mail of a reply?", "body": "<p>You may look at the \"In-Reply-To\" header (exposed by the <a href=\"https://docs.microsoft.com/en-us/office/client-developer/outlook/mapi/pidtaginreplytoid-canonical-property\" rel=\"nofollow noreferrer\">PR_IN_REPLY_TO_ID</a> MAPI property), but these values are written after the ItemSend event is fired. </p>\n\n<p>I'd suggest handling the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.reply(even)\" rel=\"nofollow noreferrer\">MailItem.Reply</a> event which is fired when the user selects the Reply action for an item, or when the Reply method is called for the item. Also you may be interested in the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.forward(even)\" rel=\"nofollow noreferrer\">MailItem.Forward</a> event which is fired when the user selects the Forward action for an item, or when the Forward method is called for the item. </p>\n\n<pre><code>Public WithEvents myItem As MailItem  \n\nSub Initialize_Handler()  \n  Set myItem = Application.ActiveInspector.CurrentItem  \nEnd Sub \n\nPrivate Sub myItem_Reply(ByVal Response As Object, Cancel As Boolean)  \n  Set Response.SaveSentMessageFolder = myItem.Parent  \nEnd Sub\n</code></pre>\n\n<p>So, following that way you will be able to access the original item and set the <code>SaveSentMessageFolder</code> property. </p>\n"}], "owner": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1607903111, "creation_date": 1560927607, "last_edit_date": 1607903111, "question_id": 56661785, "link": "https://stackoverflow.com/questions/56661785/how-to-reference-the-original-mail-of-a-reply", "title": "How to reference the original mail of a reply?", "body": "<p>I have code which when I reply to a mail asks which folder the reply should be saved to.</p>\n<p>I need to extend it to move the mail I replied to (the parent mail) to also save in the folder I chose for the reply mail.</p>\n<p>I feel this can be done if I could make an object of the Parent mail with maybe Conversation ID?</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\n    Dim myFolder As MAPIFolder\n    Dim myOlApp As Outlook.Application\n    Dim myOlExp As Outlook.Explorer\n\n    If Environ(&quot;MailSave&quot;) = True Then\n        If TypeName(Item) = &quot;MailItem&quot; Then\n            Set myOlApp = CreateObject(&quot;Outlook.Application&quot;)\n            Set olNS = myOlApp.GetNamespace(&quot;MAPI&quot;)\n            Set myFolder = olNS.PickFolder\n            \n            'todo\n            If Not (myFolder Is Nothing) Then\n                Set Item.SaveSentMessageFolder = myFolder\n                'Item.Parent.Move myFolder ---I tried this. But it is wrong I know\n                ' MsgBox (&quot;All moved&quot;)\n            \n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1560932963, "post_id": 56661783, "comment_id": 99895048, "body": "Please explain why you want to put multiple items in the clipboard.  There may be an easier way to achieve what you want.  At the moment you are just telling us about the technique you think you should use and not the problem you wish to solve."}], "answers": [{"tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": false, "score": 0, "last_activity_date": 1560944980, "last_edit_date": 1560944980, "creation_date": 1560944242, "answer_id": 56666807, "question_id": 56661783, "link": "https://stackoverflow.com/questions/56661783/copy-only-changed-text-to-clipboard/56666807#56666807", "title": "copy only changed text to clipboard", "body": "<p>Cautious: \nI guess there are better ways to achieve what you want to do as this is not proper coding. (Also as the clipboard only has a limit of 24 items), but for the sake of making your code works, here is my answer:</p>\n\n<p>To copy the text in the clipboard instead of replacing it, you can just use the <code>.copy</code> method. </p>\n\n<p>If you replace your line: </p>\n\n<pre><code>Selection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n\n<p>by</p>\n\n<pre><code>Dim iCount As Long \n\n    Selection.Find.Execute\n    Selection.Copy\n\nDo While Selection.Find.Found = True And iCount &lt; 1000\n    iCount = iCount + 1\n\n    Selection.Find.Execute\n    Selection.Copy\nLoop\n</code></pre>\n\n<p>it should work. </p>\n\n<p>The code is simply copying the item found after each search. \n<code>Selection.Find.Execute</code> searches the next itteration of the search every time it appears in the code.   </p>\n\n<p>Once there are no search found anymore (or there are too many searches), the loop will stop.</p>\n"}], "owner": {"reputation": 1, "user_id": 10588153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56927758e4888f2545f35a016751acbe?s=128&d=identicon&r=PG&f=1", "display_name": "philipp_chapo", "link": "https://stackoverflow.com/users/10588153/philipp-chapo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560946697, "creation_date": 1560927599, "last_edit_date": 1560946697, "question_id": 56661783, "link": "https://stackoverflow.com/questions/56661783/copy-only-changed-text-to-clipboard", "title": "copy only changed text to clipboard", "body": "<p>I have a question about a problem i need do solve.\nI have a word doc, on which i want to run a search and replace query.\nBut i dont want to change the actual text, i want to put the changed text\nin the clipboard and leave the actual one unchanged.  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SearchAndReplace()\n\n    ' marks all bold words,italic words, underlined\n    Selection.Find.ClearFormatting\n    Selection.Find.Font.Bold = True\n    Selection.Find.Font.Italic = True\n    Selection.Find.Font.Underline = wdUnderlineSingle\n    Selection.Find.Replacement.ClearFormatting\n\n    With Selection.Find\n        .Text = \"\"\n        .Replacement.Text = \"[test]^&amp;[/test]\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = True\n        .MatchAllWordForms = False\n        .MatchSoundsLike = False\n        .MatchWildcards = True\n    End With\n\n    Selection.Find.Execute Replace:=wdReplaceAll\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1560926666, "creation_date": 1560926666, "answer_id": 56661565, "question_id": 56661432, "link": "https://stackoverflow.com/questions/56661432/how-to-work-with-more-target-address-range/56661565#56661565", "title": "How to work with more Target.Address (range)", "body": "<p>Instead of</p>\n\n<pre><code>If Target.Address = \"$J$13\" Then\n</code></pre>\n\n<p>You can do an <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.intersect\" rel=\"nofollow noreferrer\">Intersect</a> of your <code>Target</code> range with the range you like to check:</p>\n\n<pre><code>Dim AffectedRange As Range\nSet AffectedRange = Intersect(Target, Me.Range(\"J13:J20\")) 'put your range here\n\nIf Not AffectedRange Is Nothing Then\n\n    Dim Cell As Range\n    For Each Cell In AffectedRange 'loop through all affected cells\n        'here use Cell instead of Target\n    Next Cell\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3499098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f46c9cb1a52e7093a8632a0011a7796?s=128&d=identicon&r=PG&f=1", "display_name": "user3499098", "link": "https://stackoverflow.com/users/3499098/user3499098"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560926827, "creation_date": 1560926101, "last_edit_date": 1560926827, "question_id": 56661432, "link": "https://stackoverflow.com/questions/56661432/how-to-work-with-more-target-address-range", "title": "How to work with more Target.Address (range)", "body": "<p>In a cell, I have made a list to choose. However, one choice is not enough. I found some vba code that enables me to make more choices. But this code points to a specific cell. I want to use it more general in the sheet, probably a range. </p>\n\n<p>I tried to put in a range as <code>target.address</code> but that won't work. It won't work with a range of one cell (J3) either. I found out that the formula below does not work after removing the dollar signs from <code>$j$3</code>. </p>\n\n<pre><code>Dim Oldvalue As String\nDim Newvalue As String\n\n\nOn Error GoTo Exitsub\nTheCell = ActiveCell\n\nIf Target.Address = \"$J$13\" Then\n    If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n    GoTo Exitsub\n    Else: If Target.Value = \"\" Then GoTo Exitsub Else\n        Application.EnableEvents = False\n        Newvalue = Target.Value\n        Application.Undo\n        Oldvalue = Target.Value\n        If Oldvalue = \"\" Then\n            Target.Value = Newvalue\n        Else\n            Target.Value = Oldvalue &amp; \", \" &amp; Newvalue\n        End If\n    End If\nEnd If\nApplication.EnableEvents = True\n\nExitsub:\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>I look for a solution to choose from all the list of more than one item. The formula should be changed in a way that is usable in a range of cells. These cells have al the same choice list.</p>\n"}, {"tags": ["excel", "vba", "applet", "winhttp", "winhttprequest"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1560926451, "post_id": 56661156, "comment_id": 99891785, "body": "Try an initial GET request and extract headers with method: GetAllResponseHeaders . Then parse that for cookie info. <a href=\"https://docs.microsoft.com/en-us/windows/desktop/winhttp/winhttprequest\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/winhttp/winhttprequ&zwnj;&#8203;est</a>. Or use GetResponseHeader to retrieve a specific header.  E.g. <a href=\"https://stackoverflow.com/a/19303041/6241235\">stackoverflow.com/a/19303041/6241235</a>,  <a href=\"https://stackoverflow.com/search?q=vba+winhttp+cookie\">stackoverflow.com/search?q=vba+winhttp+cookie</a>"}, {"owner": {"reputation": 33, "user_id": 10811232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e6cdc7978a4e6e0b61512f70c585b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/10811232/jim"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1560955599, "post_id": 56661156, "comment_id": 99908320, "body": "@QHarr thank you for you help, but GET request is not proper here, since it returns only one short line &quot;java.null&quot;, as displayed in my image uploaded, there are some characters appears in some queer format, I do not know how to wirte those queer characters as postdata."}, {"owner": {"reputation": 33, "user_id": 10811232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e6cdc7978a4e6e0b61512f70c585b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/10811232/jim"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1561125153, "post_id": 56661156, "comment_id": 99972908, "body": "Is there any other solutions that may help me on this? See the attached image, how to emulate that request header?"}], "owner": {"reputation": 33, "user_id": 10811232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e6cdc7978a4e6e0b61512f70c585b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/10811232/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1356, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560925597, "creation_date": 1560925065, "last_edit_date": 1560925597, "question_id": 56661156, "link": "https://stackoverflow.com/questions/56661156/how-to-emulate-below-https-headers-through-winhttp-winhttprequest-5-1", "title": "How to emulate below HTTPS headers through WinHttp.WinHttpRequest.5.1", "body": "<p>There is one java sun.Applet embeded inside a HTTPS webpage. \nAfter entering valid profile and password, I can access to that applet, request data of the Http headers captured by Fiddler when my login to that applet is showed in the image below.</p>\n\n<p>what I need is the cookie set from its response text, the cookie is useful in the following actions. I tried codes below with WinHttpRequest.5.1, but I do not know how to emulate the postdata, as you can see in the image, a few characters appear as black squares. And also I tried document.cookie but failed, it returns nothing. </p>\n\n<pre><code>Dim objHTTP As Object\nDim URL As String\nDim PostData as String\nSet objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nURL = \"Https://xxxxxx\"\nPostData = \"\"\nWith objHTTP \n    .Open \"POST\", URL, False\n    .setRequestHeader \"User-Agent\", \"Mozilla/4.5 [en] (winNT; I)\"\n    .setRequestHeader \"companyID\", \"CN\"\n    .setRequestHeader \"Auth_Mode\", \"2\"\n    .setRequestHeader \"CONTENT_TYPE\", \"application/octet-stream\"\n    .setRequestHeader \"Cache-Control\", \"no-cache\"\n    .setRequestHeader \"Pragma\", \"no-cache\"\n    .setRequestHeader \"Host\", \"XXXXX.com\"\n    .setRequestHeader \"Accept\", \"text/html, image/jpeg, *; q=.2, */*; q=.2\"\n    .setRequestHeader \"Proxy-Connection\", \"Keep-alive\"\n    .setRequestHeader \"Content-type\", \"application/x-www-form-urlencode\"\n    .setRequestHeader \"Content-Length\", \"419\"\n\n    .Send PostDate\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/hRl2r.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hRl2r.jpg\" alt=\"Codes in Fiddler request headers\"></a></p>\n"}, {"tags": ["excel", "vba", "export-to-pdf"], "comments": [{"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 1, "creation_date": 1560925155, "post_id": 56661123, "comment_id": 99891230, "body": "Does it perform better when created locally ? If yes: create it there and copy / move it afterwards"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11627114"}, "reply_to_user": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1560925511, "post_id": 56661123, "comment_id": 99891378, "body": "I know that something different working locally. But i have to export to pdf to shared device which is raspberry PI."}, {"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1560952629, "post_id": 56661123, "comment_id": 99906432, "body": "You are not answering the question: is it faster or not ? How are we supposed to improve your Raspberry SMB performance ? If this is the issue SO is the wrong place and you either have to tune your Windows or your Linux"}], "owner": {"user_type": "does_not_exist", "display_name": "user11627114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1560925376, "creation_date": 1560924938, "last_edit_date": 1560925376, "question_id": 56661123, "link": "https://stackoverflow.com/questions/56661123/how-to-speed-up-printing-selected-cells-to-pdf-file-and-saving-xlsm-file-to-shar", "title": "How to speed up printing selected cells to pdf file and saving xlsm file to shared device?", "body": "<p>I've just written the MS Macro script in VBA which selects cells to print to pdf file and saves that pdf and xlsm Files in <strong>shared device</strong> (in this case i have Raspberry Pi). I when I select cells A1:X51 it prints that but it takes long. I've tried by adding that lines of codes:   </p>\n\n<pre><code>Application.Calculation = xlCalculationManual\n     Application.ScreenUpdating = False\n     Application.DisplayStatusBar = False\n     Application.EnableEvents = False\n     Application.DisplayAlerts = False\n     ActiveSheet.DisplayPageBreaks = False\n</code></pre>\n\n<p>But these didn't help. I have a question for now: Is it possible to speed up printing selected cells and saving pdf and xlsm files to shared device?</p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>Macro code:</strong></p>\n\n<pre><code>Sub SaveFile()\n'\n' Macro Macro\n'\n\n'\n    ActiveSheet.PageSetup.PaperSize = xlPaperLegal\n    ActiveSheet.PageSetup.PrintArea = Selection.Address\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"\\\\raspberrypi\\Home_share\\File.pdf\", _\n         Quality:=xlQualityStandard, _\n         IncludeDocProperties:=True, _\n         IgnorePrintAreas:=False, _\n         OpenAfterPublish:=True\n    With ActiveSheet.PageSetup\n        .LeftMargin = Application.InchesToPoints(0)\n        .RightMargin = Application.InchesToPoints(0)\n        .TopMargin = Application.InchesToPoints(0)\n        .BottomMargin = Application.InchesToPoints(0)\n        .HeaderMargin = Application.InchesToPoints(0)\n        .FooterMargin = Application.InchesToPoints(0)\n        .Orientation = xlLandscape\n        .Zoom = False\n        .FitToPagesWide = 1\n        .FitToPagesTall = False\n    End With\n         Application.Calculation = xlCalculationManual\n         Application.ScreenUpdating = False\n         Application.DisplayStatusBar = False\n         Application.EnableEvents = False\n         Application.DisplayAlerts = False\n         ActiveSheet.DisplayPageBreaks = False\n\n         ActiveWorkbook.SaveAs \"\\\\raspberrypi\\Home_share\\File-TV.xlsm\"\n         ActiveWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 3, "creation_date": 1560926066, "post_id": 56661022, "comment_id": 99891630, "body": "Can you add your code to the question?"}], "answers": [{"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560939679, "post_id": 56665358, "comment_id": 99898880, "body": "This method uses <code>Select</code> and <code>Activate</code> which is bad practice"}, {"owner": {"reputation": 301, "user_id": 9071643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lwVGZ.jpg?s=128&g=1", "display_name": "J&#246;rgen R", "link": "https://stackoverflow.com/users/9071643/j%c3%b6rgen-r"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1561032367, "post_id": 56665358, "comment_id": 99936638, "body": "Why is it bad practice @Tim-Stack?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1561034990, "post_id": 56665358, "comment_id": 99938194, "body": "It is asking for errors, which will pop up very soon. Read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1561035127, "post_id": 56665358, "comment_id": 99938284, "body": "If you would allow I could add a version of your code converted not to use <code>Select</code> and <code>Activate</code> to your answer"}], "tags": [], "owner": {"reputation": 301, "user_id": 9071643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lwVGZ.jpg?s=128&g=1", "display_name": "J&#246;rgen R", "link": "https://stackoverflow.com/users/9071643/j%c3%b6rgen-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1560944933, "last_edit_date": 1560944933, "creation_date": 1560939480, "answer_id": 56665358, "question_id": 56661022, "link": "https://stackoverflow.com/questions/56661022/delete-multiple-columns-by-vba/56665358#56665358", "title": "delete Multiple columns by VBA", "body": "<p>Loop through them from rightmost column and delete them one by one.</p>\n\n<pre><code>Sub test()\nDim c As Long, r As Long\n    Worksheets(1).Activate\n    'populate 700 columns\n    For c = 1 To 700\n        Cells(1, c).Value = \"col \" &amp; c\n        For r = 2 To 10\n            Cells(r, c).Value = \"hej \" &amp; c &amp; \"/\" &amp; r\n        Next\n    Next\n    'remove e.g. even columns\n    For c = 700 To 1 Step -2\n        Columns(c).Select\n        Selection.Delete Shift:=xlToLeft\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11668312, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o6h9Su3KCts/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reH7E7IXv0C2ddPrfQ3qlaNcqwSsA/mo/photo.jpg?sz=128", "display_name": "Rachna Sethi Mitra", "link": "https://stackoverflow.com/users/11668312/rachna-sethi-mitra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560944933, "creation_date": 1560924466, "last_edit_date": 1560934966, "question_id": 56661022, "link": "https://stackoverflow.com/questions/56661022/delete-multiple-columns-by-vba", "title": "delete Multiple columns by VBA", "body": "<p>i Have 700 columns in a sheet. I want to delete  more than 650 out of them. If I use range as <code>A:W</code> and more then I get <code>400 Error</code>.</p>\n\n<p>Is there  any limit to no.  of column deletion in VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1560923577, "post_id": 56660604, "comment_id": 99890625, "body": "And your question is?"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1560923936, "post_id": 56660604, "comment_id": 99890745, "body": "@AJD My code above is not working. It gives me application-defined or object-defined error. Can you correct it?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1560924324, "post_id": 56660635, "comment_id": 99890907, "body": "It gives me subscript out of range"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1560925517, "post_id": 56660635, "comment_id": 99891382, "body": "Sounds like one or more of the workbook/worksheet names are incorrect"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1560925769, "post_id": 56660635, "comment_id": 99891497, "body": "I&#39;m sorry Tim. The code to copy is working fine. I am having a problem with pasting the copied content to another sheet. I want the copied content to be pasted at the &quot;I&quot; th column of another sheet. I am being given an error &quot;Select method of range class failed&quot;                                                               <code>Workbooks(&quot;Co_insurer Sample File.xlsx&quot;).Worksheets(&quot;QUIDAM-INSURERS&quot;).Range(&quot;A&quot; &amp; i &amp; &quot;:V&quot; &amp; i).Copy             Workbooks(&quot;Smart_Excel_BK.xlsm&quot;).Worksheets(&quot;Input&quot;).Range(&quot;&zwnj;&#8203;I&quot; &amp; LastRowKS).Select             Workbooks(&quot;Smart_Excel_BK.xlsm&quot;).Worksheets(&quot;Input&quot;).Paste</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1560926075, "post_id": 56660635, "comment_id": 99891633, "body": "What&#39;s the value of <code>LastRowKS</code> (LastRowBK in your posted code) when it fails?  BTW you do not need to select a range to paste to it, and your code will function more reliably if you avoid select/activate."}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1560926212, "post_id": 56660635, "comment_id": 99891686, "body": "I want the copied to content to be pasted at the LastRowKS+1th row from &quot;I&quot;th column to &quot;AD&quot; column. Can you help me with this code?"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1560926696, "post_id": 56660635, "comment_id": 99891904, "body": "Thanks, man. Was stuck with this for an hour. Finally working"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1560940718, "post_id": 56660635, "comment_id": 99899388, "body": "What do I need to change in the code if I need to paste without formatting i.e. only values?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1560956458, "last_edit_date": 1560956458, "creation_date": 1560922504, "answer_id": 56660635, "question_id": 56660604, "link": "https://stackoverflow.com/questions/56660604/copy-variable-sized-range-vba/56660635#56660635", "title": "Copy variable sized range VBA", "body": "<p>Something like this:</p>\n\n<pre><code>Dim wsSource As worksheet, wsDest As Worksheet, rngCopy As Range\n\nSet wsSource = Workbooks(\"Co_insurer Sample File.xlsx\").Worksheets(\"QUIDAM-INSURERS\")\nSet wsDest = Workbooks(\"Smart_Excel_BK.xlsm\").Worksheets(\"Input\")\n\nSet rngCopy = wsSource.Range(\"A\" &amp; i &amp; \":V\" &amp; i)\n\nrngCopy.Copy wsDest.Cells(LastRowKS + 1, \"I\")\n</code></pre>\n\n<p>To copy only values:</p>\n\n<pre><code>wsDest.Cells(LastRowKS + 1, \"I\").Resize( _\n     rngCopy.Rows.Count, rngCopy.columns.Count).Value = rngCopy.Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1560923221, "post_id": 56660657, "comment_id": 99890522, "body": "This is exactly what I did in the code I posted in my question. I used the variable i for LastRow instead"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1560922585, "creation_date": 1560922585, "answer_id": 56660657, "question_id": 56660604, "link": "https://stackoverflow.com/questions/56660604/copy-variable-sized-range-vba/56660657#56660657", "title": "Copy variable sized range VBA", "body": "<p>Try:</p>\n\n<pre><code>Dim lastRow As Long\nlastRow = Workbooks(\"Co_insurer Sample File.xlsx\").Worksheets(\"QUIDAM-INSURERS\").Cells(Rows.Count, 1).End(xlUp).Row\n\nWorkbooks(\"Co_insurer Sample File.xlsx\").Worksheets(\"QUIDAM-INSURERS\").Range(\"A:V\" &amp; lastRow).Copy Workbooks(\"Smart_Excel_BK.xlsm\").Worksheets(\"Input\").Range(\"I\" &amp; lastRow)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56660635, "answer_count": 2, "score": 0, "last_activity_date": 1560956458, "creation_date": 1560922299, "last_edit_date": 1560925118, "question_id": 56660604, "link": "https://stackoverflow.com/questions/56660604/copy-variable-sized-range-vba", "title": "Copy variable sized range VBA", "body": "<p>I have an excel sheet with data present in columns from column A to column V. I have a code which calculates the last row of the sheet. Now, I want to copy the last row i.e. for eg if the last row is 7 then I want to copy range A7 to V7 and paste it another worksheet. </p>\n\n<pre><code>'Here i is the LastRow\nWorkbooks(\"Co_insurer Sample File.xlsx\").Worksheets(\"QUIDAM-INSURERS\").Range(\"A:V\" &amp; i).Copy\nWorkbooks(\"Smart_Excel_BK.xlsm\").Worksheets(\"Input\").Range(\"I\" &amp; LastRowBK).Select\nWorkbooks(\"Smart_Excel_BK.xlsm\").Worksheets(\"Input\").Paste\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1560921510, "post_id": 56660304, "comment_id": 99890025, "body": "<code>Shapes.Range</code> returns a <code>ShapeRange</code>, which isn&#39;t a <code>Range</code> object / doesn&#39;t have a <code>Value</code> property. See <a href=\"https://stackoverflow.com/a/56122859/1188513\">how to use the object browser</a> for tips on figuring out what returns what."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1560920890, "creation_date": 1560920890, "answer_id": 56660389, "question_id": 56660304, "link": "https://stackoverflow.com/questions/56660304/change-arrow-color-based-on-its-label-or-value/56660389#56660389", "title": "Change arrow color based on its label or value", "body": "<p>Shapes don't have a <code>Value</code> property.</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub ArrowColour()     \n    With ActiveSheet.Shapes(\"Left Arrow 1\")\n        .ForeColor.RGB = IIf(CInt(.TextFrame.Characters.Text)&lt;50, _\n                             RGB(0, 176, 80), RGB(255, 0, 0))    \n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11667935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UksTL.jpg?s=128&g=1", "display_name": "Cyber", "link": "https://stackoverflow.com/users/11667935/cyber"}, "is_accepted": false, "score": 0, "last_activity_date": 1560928285, "creation_date": 1560928285, "answer_id": 56661978, "question_id": 56660304, "link": "https://stackoverflow.com/questions/56660304/change-arrow-color-based-on-its-label-or-value/56661978#56661978", "title": "Change arrow color based on its label or value", "body": "<p>I have found the answer:</p>\n\n<pre><code>    Sub Test()\n    Dim shp As Shape\n    Dim sTemp As String\n    Set shp = ActiveSheet.Shapes(\"RightArrow\")\n    sTemp = shp.TextFrame.Characters.Text\n    If CInt(sTemp) &gt; 400 Then\n        shp.Fill.ForeColor.RGB = RGB(255, 0, 0)\n    End If\n    End Sub \n\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11667935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UksTL.jpg?s=128&g=1", "display_name": "Cyber", "link": "https://stackoverflow.com/users/11667935/cyber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1560928285, "creation_date": 1560920300, "last_edit_date": 1560925111, "question_id": 56660304, "link": "https://stackoverflow.com/questions/56660304/change-arrow-color-based-on-its-label-or-value", "title": "Change arrow color based on its label or value", "body": "<p>How do I change the color of an arrow based on its label (converted to integer); say if the value of the arrow is &lt;50; then change the color of the arrow to green?</p>\n\n<p>I encountered run-time error 438:</p>\n\n<blockquote>\n  <p>Object doesn't support this property or method (Line 3). </p>\n</blockquote>\n\n<pre><code>Sub ArrowColour()\nDim nsize As Integer\nnsize = CInt(ActiveSheet.Shapes.Range(Array(\"Left Arrow 1\")).Value)\nWith ActiveSheet.Shapes.Range(Array(\"Left Arrow 1\")).Fill\n    If nsize &lt; 50 Then\n    .ForeColor.RGB = RGB(0, 176, 80)\n    Else\n    .ForeColor.RGB = RGB(255, 0, 0)\n    End If\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 25, "user_id": 7819935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1804fb6dcbd8a2e05871f903b61f05e?s=128&d=identicon&r=PG&f=1", "display_name": "avajhelp", "link": "https://stackoverflow.com/users/7819935/avajhelp"}, "edited": false, "score": 0, "creation_date": 1560922228, "post_id": 56659994, "comment_id": 99890216, "body": "I&#39;m just asking if it is possible, if it is not, you could just say no right? Why give pointless replies"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1560934137, "post_id": 56659994, "comment_id": 99895680, "body": "Are you saying that Input Data must be the root folder?  I think it would be helpful if you could explain why you are trying to do this.  You could allow the user just to specify a drive, but it doesn&#39;t seem like good practice.  Bear in mind that using drive mapping I can change where <i>C:</i> (or any other drive letter) is, ie I could have a mapped drive as <i>D:</i> which is in a subfolder of C:"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1560934184, "post_id": 56659994, "comment_id": 99895709, "body": "(And getting angry with people isn&#39;t going to help)"}, {"owner": {"reputation": 25, "user_id": 7819935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1804fb6dcbd8a2e05871f903b61f05e?s=128&d=identicon&r=PG&f=1", "display_name": "avajhelp", "link": "https://stackoverflow.com/users/7819935/avajhelp"}, "edited": false, "score": 0, "creation_date": 1560940466, "post_id": 56659994, "comment_id": 99899287, "body": "Hi Gareth, the reason for not specifying the drive, is so that the macro-enabled file can be run by another person on their computer, regardless of which drive they choose to save it to, as long as the file is in a folder called &quot;input data&quot;. This is because this file will subsequently by read by another program where I have already indicated to read from a generic &quot;input data&quot; folder. I understand, just frustrated that people comment with things that do not help. After all, if I knew how to resolve it, I would not have posted the question."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": false, "score": 0, "last_activity_date": 1560951322, "creation_date": 1560951322, "answer_id": 56668987, "question_id": 56659994, "link": "https://stackoverflow.com/questions/56659994/save-file-without-specifying-drive-location/56668987#56668987", "title": "Save file without specifying Drive Location", "body": "<p>Rather than trying to specify an unknown location you could use a system location.  Not only will this be consistent (for each user) but it should be a location where files can be saved.  Many systems have been set up not to allow folders to be created in the root of the C:\\ drive.</p>\n\n<pre><code>    Dim fso As Object\n    Dim pth As String\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")       'create a filesystemobject\n    pth = fso.buildpath(Environ(\"userprofile\"), \"Input Data\")  'get the path\n    If Not fso.FolderExists(pth) Then fso.CreateFolder pth     'create the folder if required\n    pth = fso.buildpath(pth, \"My Workbook Name.xlsm\")          'get the save path\n    ThisWorkbook.SaveAs pth                                    'save\n    Set fso = Nothing\n</code></pre>\n\n<p>To see the other system folders see <a href=\"https://pureinfotech.com/list-environment-variables-windows-10/\" rel=\"nofollow noreferrer\">https://pureinfotech.com/list-environment-variables-windows-10/</a>  You might prefer to use %TEMP%.</p>\n\n<p>You will need to change the <code>Save</code> statement to suit</p>\n"}], "owner": {"reputation": 25, "user_id": 7819935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1804fb6dcbd8a2e05871f903b61f05e?s=128&d=identicon&r=PG&f=1", "display_name": "avajhelp", "link": "https://stackoverflow.com/users/7819935/avajhelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1560951322, "creation_date": 1560917954, "question_id": 56659994, "link": "https://stackoverflow.com/questions/56659994/save-file-without-specifying-drive-location", "title": "Save file without specifying Drive Location", "body": "<p>I would like to specify where my new Excel file is saved in terms of the folder (e.g. the folder name is Input Data). However, I do not want to specify the drive that it is contained in (e.g. C:\\Input Data), how should I go about it? </p>\n\n<p>I saw that other people typically would specify the full file path to where the folder is e.g. C:\\Input Data. However, I would like to drop the C:\\ portion.</p>\n\n<p>The expected result would be where the output file is saved in the folder called \"Input Data\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1560919427, "post_id": 56659810, "comment_id": 99889561, "body": "Put a reference to the cell object into variable prior to any rows could be inserted <code>Set mycell = Range(&quot;C3&quot;)</code>, then just update the cell value <code>mycell.Value = code</code>. Note, if the cell will be deleted, then the reference gives an error."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1560921330, "post_id": 56659810, "comment_id": 99889964, "body": "@omegastripes .. I think the row is inserted from the FrontEnd, Rather than any code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560921582, "post_id": 56659810, "comment_id": 99890042, "body": "If you were inserting the cell value manually, how would you know where it should go (eg. would you look for column headers etc)?  You can mimic that process using VBA."}, {"owner": {"reputation": 23, "user_id": 11087237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08dcea47e24393e088611e9d7f80d391?s=128&d=identicon&r=PG&f=1", "display_name": "kang", "link": "https://stackoverflow.com/users/11087237/kang"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1560984545, "post_id": 56659810, "comment_id": 99920617, "body": "Thanks for the comment. Yes sorry I meant insert row by the front end user as @Mikku mentioned, not by the code, but the same issue would arise. I&#39;ve resulted running a for loop to search for a string in the column, that way it doesnt matter what the row is, just have to ensure the entire range is searched over"}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1560917255, "creation_date": 1560917255, "answer_id": 56659906, "question_id": 56659810, "link": "https://stackoverflow.com/questions/56659810/vba-to-reference-the-same-cell-even-after-the-addition-or-deletion-of-rows-col/56659906#56659906", "title": "VBA to reference the same cell even after the addition or deletion of rows &amp; Columns", "body": "<p>One solution is to used <a href=\"https://support.office.com/en-ie/article/define-and-use-names-in-formulas-4d0f13ac-53b7-422e-afd2-abd7ff379c64\" rel=\"nofollow noreferrer\">Named Ranges</a>. You can define a Named Range in Formula Tab by clicking on Name Manager. </p>\n\n<p>Then you will write.</p>\n\n<pre><code>Range(\"Name of the Range\") = code\n</code></pre>\n\n<p>My believe is that named ranges update automatically when a row or column is inserted, so your code will print the value in the correct cell.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 11087237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08dcea47e24393e088611e9d7f80d391?s=128&d=identicon&r=PG&f=1", "display_name": "kang", "link": "https://stackoverflow.com/users/11087237/kang"}, "is_accepted": false, "score": 0, "last_activity_date": 1560988197, "creation_date": 1560988197, "answer_id": 56677286, "question_id": 56659810, "link": "https://stackoverflow.com/questions/56659810/vba-to-reference-the-same-cell-even-after-the-addition-or-deletion-of-rows-col/56677286#56677286", "title": "VBA to reference the same cell even after the addition or deletion of rows &amp; Columns", "body": "<p>Thanks, good idea. I ended up defining the column filled with values as a range, then use a for loop to search for the defined string. That way it doesnt matter what row it is in aslong as the name and string doesnt change (Using a Named Range will probably be better for that exact reason).</p>\n\n<pre><code>Worksheets(\"Sheet1\").Select\n        Set WS = ActiveSheet\n            With WS\n                LastRow = .Cells(.Rows.Count, 2).End(xlUp).Row       'Determine the last row number with data in it for column B\n                    For Each acell In .Range(\"B1:B\" &amp; LastRow)       'Defines the search range from B1 to last row\n\n                        If acell.Value = \"String Searched For\" Then\n                            'Do stuff based on found cell location\n                        End If\n\n                        If acell.Value = \"String Searched For#2\" Then\n                            'Do stuff based on found cell location#2\n                        End If\n                    Next\n            End With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11087237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08dcea47e24393e088611e9d7f80d391?s=128&d=identicon&r=PG&f=1", "display_name": "kang", "link": "https://stackoverflow.com/users/11087237/kang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 56659906, "answer_count": 2, "score": 2, "last_activity_date": 1560988197, "creation_date": 1560916354, "last_edit_date": 1560925083, "question_id": 56659810, "link": "https://stackoverflow.com/questions/56659810/vba-to-reference-the-same-cell-even-after-the-addition-or-deletion-of-rows-col", "title": "VBA to reference the same cell even after the addition or deletion of rows &amp; Columns", "body": "<p>I'm using <code>VBA</code> code to write to cells in excel. For eg.</p>\n\n<pre><code>Range(\"C3\") = code\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Cells(3,3) = code\n</code></pre>\n\n<p>If a row is inserted in the sheet, the code does then not update accordingly and would still write to <code>Range(\"C3\")</code> etc. So the code then writes to the incorrect cell.</p>\n\n<p>Is there a better way I can structure my code so it will update accordingly? Perhaps using a table instead of cells?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560910242, "post_id": 56659159, "comment_id": 99887865, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/579797/open-excel-file-for-reading-with-vba-without-display\">Open Excel file for reading with VBA without display</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560910588, "post_id": 56659159, "comment_id": 99887928, "body": "<code>Application.ScreenUpdating = False</code> might be an option too. Not sure what your actual use case is."}, {"owner": {"reputation": 47, "user_id": 11499924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677f568ba5205a72867399140d4823b0?s=128&d=identicon&r=PG&f=1", "display_name": "Shevy", "link": "https://stackoverflow.com/users/11499924/shevy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560911543, "post_id": 56659159, "comment_id": 99888096, "body": "I have a few mini programs that analyses various sets of data in excel. These are all stored in this macro workbook. I want to give my team a button on the quick access toolbar which will enable the custom tab I created (with buttons for each mini program) to run."}, {"owner": {"reputation": 47, "user_id": 11499924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677f568ba5205a72867399140d4823b0?s=128&d=identicon&r=PG&f=1", "display_name": "Shevy", "link": "https://stackoverflow.com/users/11499924/shevy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560911714, "post_id": 56659159, "comment_id": 99888118, "body": "<code>Application.ScreenUpdating = False</code> doesnt help because there is still a physical workbook that can be closed which will cut off access to all macros in there."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560911834, "post_id": 56659159, "comment_id": 99888132, "body": "It almost sounds like you want to create an add-in..."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1560912235, "post_id": 56659159, "comment_id": 99888206, "body": "You can Hide the Workbook, after it opens, That&#39;s the case with Personal Macro WorkBook as well. Goto - View And then Select Hide."}, {"owner": {"reputation": 47, "user_id": 11499924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677f568ba5205a72867399140d4823b0?s=128&d=identicon&r=PG&f=1", "display_name": "Shevy", "link": "https://stackoverflow.com/users/11499924/shevy"}, "edited": false, "score": 0, "creation_date": 1560912656, "post_id": 56659159, "comment_id": 99888300, "body": "hmm... I recorded the action and got <code>ActiveWindow.Visible = False</code>...  that should do the trick"}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 11499924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677f568ba5205a72867399140d4823b0?s=128&d=identicon&r=PG&f=1", "display_name": "Shevy", "link": "https://stackoverflow.com/users/11499924/shevy"}, "is_accepted": true, "score": 1, "last_activity_date": 1561558256, "last_edit_date": 1561558256, "creation_date": 1561557740, "answer_id": 56774683, "question_id": 56659159, "link": "https://stackoverflow.com/questions/56659159/how-can-i-open-a-macro-workbook-with-vba/56774683#56774683", "title": "How can I open a macro workbook with VBA?", "body": "<p>You can use <code>ActiveWindow.Visible = False</code></p>\n"}], "owner": {"reputation": 47, "user_id": 11499924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677f568ba5205a72867399140d4823b0?s=128&d=identicon&r=PG&f=1", "display_name": "Shevy", "link": "https://stackoverflow.com/users/11499924/shevy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56774683, "answer_count": 1, "score": 0, "last_activity_date": 1561558256, "creation_date": 1560910160, "last_edit_date": 1560923053, "question_id": 56659159, "link": "https://stackoverflow.com/questions/56659159/how-can-i-open-a-macro-workbook-with-vba", "title": "How can I open a macro workbook with VBA?", "body": "<p>I kind of renamed the personal macro workbook and copied it to the server for my teammates to access. When you manually open the macro workbook it only opens in VBA without showing an actual workbook, but when I try to do it with VBA, a physical workbook opens up.</p>\n\n<pre><code>Dim MyFolder As String\nMyFolder = \"file:///\\\\FPSFILES1\\ReviewPricing\\Macro Data\\RP Macro Wrkbk.xlsb\"\nActiveWorkbook.FollowHyperlink MyFolder\n</code></pre>\n\n<p>How can I get the workbook to open in VBA only so users don't see a physical book that they can close (which closes it in VBA too)?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560909638, "post_id": 56659064, "comment_id": 99887755, "body": "You don&#39;t need to <code>Select</code>. I suspect you don&#39;t need the <code>For Each cell in Selection</code> at all. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> for more detail."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560910041, "post_id": 56659064, "comment_id": 99887835, "body": "Also, in regards to your comment that &quot;there&#39;s always more pop up messages than the actual number of empty cells&quot;: That will be case if you&#39;re looping over each cell. As an example, if A2:A3 is a merged cell, then the message will be displayed for <i>both</i> A2 and A3."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1560913478, "post_id": 56659064, "comment_id": 99888459, "body": "You can take some Ideas from this <a href=\"https://stackoverflow.com/a/9452164/5720144\">Link</a> .. The Answer actually detects the merged cells with Values like Constants and Formula. What you can do is skip those from the entire selection and others will be blank. So if blank is Yes then you can proceed with your code."}, {"owner": {"reputation": 1, "user_id": 11667510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/939f79d8c6b53834ff0054e8659a6e96?s=128&d=identicon&r=PG&f=1", "display_name": "kaylavigne", "link": "https://stackoverflow.com/users/11667510/kaylavigne"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1560914752, "post_id": 56659064, "comment_id": 99888706, "body": "Thanks BigBen and Mikku! Thanks for your tips! @Mikku but what is the table has non-merged cells that I also have to run through and detect whether its blank?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1560915276, "post_id": 56659064, "comment_id": 99888810, "body": "@kaylavigne ... See that macro will tell you which cells are merged and have any value in them. Now the remaining cells are blank in your table. You can work out a logic using <code>Intersect</code> or anything else to loop through those blank cells."}, {"owner": {"reputation": 1, "user_id": 11667510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/939f79d8c6b53834ff0054e8659a6e96?s=128&d=identicon&r=PG&f=1", "display_name": "kaylavigne", "link": "https://stackoverflow.com/users/11667510/kaylavigne"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1560919534, "post_id": 56659064, "comment_id": 99889589, "body": "@Mikku i tried running the codes u suggested but how can I modify it to be blank instead of constant/formula? I&#39;m a total beginner and really sorry for the silly question! Also, the codes only show an aggregate area of the merged cells e.g. if I merged A1:A3 and A4:A8, it actually considered A1:A8 alltogether, how can I distinguish them? It&#39;d be clearer if u take a look at the link to the image!"}], "owner": {"reputation": 1, "user_id": 11667510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/939f79d8c6b53834ff0054e8659a6e96?s=128&d=identicon&r=PG&f=1", "display_name": "kaylavigne", "link": "https://stackoverflow.com/users/11667510/kaylavigne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560919360, "creation_date": 1560909212, "last_edit_date": 1560919360, "question_id": 56659064, "link": "https://stackoverflow.com/questions/56659064/how-to-identify-whether-a-merged-cell-is-empty-and-show-a-pop-up-message", "title": "How to identify whether a merged cell is empty and show a pop up message", "body": "<p>I need to show a pop up message indicating that some information is missing in the table according to each column, e.g. if one cell is empty in column A then a pop up message will say 'please fill in the missing values in Column A', 'please fill in the missing values in Column B'...</p>\n\n<p><a href=\"https://i.stack.imgur.com/ak0W6.jpg\" rel=\"nofollow noreferrer\">Table with merged cells</a></p>\n\n<pre><code>LastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).Row\nLastColumn = sht.Cells(StartCell.Row, sht.Columns.Count).End(xlToLeft).Column\nsht.Range(StartCell, sht.Cells(LastRow, LastColumn)).Select\n\nFor Each Cell In Selection\nFor Row = 1 To LastRow\n    If Cells(Row, 1).Value = \"\" Then\n        if isempty(Cells(Row,1).mergearea().Value = true\n            MsgBox \"Please fill in the code\"\n    End If\n\n    If Cells(Row, 2).Value = \"\" Then\n        MsgBox \"Please fill in the description\" &amp; Row\n    End If\n\n    If Cells(Row, 8).Value = \"\" Then\n        MsgBox \"Please fill in the discounting %\" &amp; Row\n\n            ElseIf Cells(Row, 8).Value &lt;&gt; \"&gt;36%\" Then\n            Cells(Row, 8).Interior.ColorIndex = 4\n    End If\nNext Row\n</code></pre>\n\n<p>Should I used for each cell in selection or for next loop?\nThis code will be used as a template which means the number or rows are different each time depending how many 'code' items (column A) is listed, does the first 3 lines of code suffice to find out the last row of not empty cells?</p>\n\n<p>When I execute the code there's always more pop up messages than the actual number of empty cells. It seems like I can't identify whether a merged cell is empty or not.</p>\n\n<p>Lastly, I also need to see the value in the discounted column whether the valued inside the cells > 36%, if yes then the whole row is highlighted. How can I code that? Thanks a lot guys!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 1, "creation_date": 1560929277, "post_id": 56659050, "comment_id": 99893235, "body": "Have you tried putting <code>ThisWorkbook.Saved=True</code> in <code>Workbook_BeforeClose</code> instead of in of in <code>Workbook_Open</code>?"}, {"owner": {"reputation": 11, "user_id": 11667501, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-31_Q2USpb_8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd1MWgy8RkXIpF0Q8YeTzAE9aJsSw/mo/photo.jpg?sz=128", "display_name": "Nototo Hoshi", "link": "https://stackoverflow.com/users/11667501/nototo-hoshi"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1560942154, "post_id": 56659050, "comment_id": 99900106, "body": "putting ThisWorkbook.Saved=True into BeforeClose would remove the prompt even if the users actually did some changes... I just want to remove the prompt in the scenario when they open it and close immediately. Basically Iam just trying to make it, so that my Initialization changes do not count towards changes being made."}], "owner": {"reputation": 11, "user_id": 11667501, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-31_Q2USpb_8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd1MWgy8RkXIpF0Q8YeTzAE9aJsSw/mo/photo.jpg?sz=128", "display_name": "Nototo Hoshi", "link": "https://stackoverflow.com/users/11667501/nototo-hoshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574738317, "creation_date": 1560909080, "last_edit_date": 1574738317, "question_id": 56659050, "link": "https://stackoverflow.com/questions/56659050/avoid-prompt-to-save-if-there-are-only-workbook-initialization-changes", "title": "Avoid prompt to save if there are only Workbook initialization changes", "body": "<p>I have an Excel file that is multilingual.</p>\n\n<p>I created code that fires when the workbook is opened (Initialize Sub).</p>\n\n<p>It figures out the current user's local settings and language and prepares the workbook accordingly. It changes various cell values to the proper language, sets up button captions, fills in comboboxes with the proper strings and so on.</p>\n\n<p>Initial setup makes the file \"not saved\". So when somebody opens the file and tries to close it immediately, the prompt shows up, that changes have been made and if they want to save them.</p>\n\n<p>I want to avoid that, so after the initialization I tried <code>ThisWorkbook.Saved = True</code>, to prevent the save prompt (see the code example). It doesn't work.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Call Initialize\n    ThisWorkbook.Saved = True\nEnd Sub\n</code></pre>\n\n<p>The only explanation is that something must happen after the Workbook_Open event finishes, that changes the workbook. I suspected that some formulas might be recalculating due to the changes, so I tried recalculating every sheet as part of the Initialize Sub.</p>\n\n<p>I tried saving the file as well:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Call Initialize\n    ThisWorkbook.Save\n    ThisWorkbook.Saved = True\nEnd Sub\n</code></pre>\n\n<p>It kind of worked. The prompt to save didn't display. But since there are a lot of changes during the initialization, saving takes a while and makes the file very \"laggy\" when opened. Also it makes the file stall when closing. I mean, when I manually save the file and then close it, it closes immediately. When I put the <code>ThisWorkbook.Save</code> into the Workbook_Open event, and I open the file and then try to immediately close the file, I don't get the prompt (which is good), but it takes 10 to 15 seconds to close.</p>\n\n<p>I am baffled by the behaviour in these two scenarios because when I just use:</p>\n\n<pre><code>ThisWorkbook.Saved = True\n</code></pre>\n\n<p>I get the prompt, which means that something must have happened that turned it to  \"false\".</p>\n\n<p>But when I use both:</p>\n\n<pre><code>ThisWorkbook.Save\nThisWorkbook.Saved = True\n</code></pre>\n\n<p>I don't get the prompt, which means that the \"thing\" that turned it to false in the first scenario doesn't happen.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1560900450, "post_id": 56658237, "comment_id": 99886191, "body": "Please learn how to write code avoiding the use of <code>select</code>.. In saying that, you can simply write <code>Range(&quot;A:A&quot;).NumberFormat = &quot;@&quot;</code>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1560901211, "post_id": 56658237, "comment_id": 99886326, "body": "<a href=\"https://stackoverflow.com/q/10714251/62576\">How to avoid using select in Excel</a>"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1560901604, "post_id": 56658237, "comment_id": 99886386, "body": "@KenWhite thanks. I need to save that link"}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 7969520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QB1ni.jpg?s=128&g=1", "display_name": "scottmwyant", "link": "https://stackoverflow.com/users/7969520/scottmwyant"}, "is_accepted": true, "score": 1, "last_activity_date": 1560902669, "creation_date": 1560902669, "answer_id": 56658482, "question_id": 56658237, "link": "https://stackoverflow.com/questions/56658237/change-formatting-of-a-column-to-text/56658482#56658482", "title": "Change formatting of a column to text", "body": "<p>Just tested these, both work.  Formulas referencing the affected cells do not compute, formulas referencing other numeric cells are calculating as normal.</p>\n\n<pre><code>Range(\"A:A\").NumberFormat=\"@\"\n\nRange(\"A1\").EntireColumn.NumberFormat=\"@\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11226032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p4hc0hfgdUw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfb4vQHmfPUTYAlUDwBEunxQBH82A/mo/photo.jpg?sz=128", "display_name": "Brad Decker", "link": "https://stackoverflow.com/users/11226032/brad-decker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 0, "accepted_answer_id": 56658482, "answer_count": 1, "score": 1, "last_activity_date": 1570560608, "creation_date": 1560900189, "last_edit_date": 1570560608, "question_id": 56658237, "link": "https://stackoverflow.com/questions/56658237/change-formatting-of-a-column-to-text", "title": "Change formatting of a column to text", "body": "<p>Every time I run this code the entire sheet becomes Text.</p>\n\n<p>I want to keep the rest of the sheet General, but change column A to Text. </p>\n\n<p>For the</p>\n\n<pre><code>Columns(\"A\").Select _\n  ActiveCell.NumberFormat = \"@\"\n</code></pre>\n\n<p>I tried</p>\n\n<pre><code> Range(\"A:A\").Select\n Selection.NumberFormat = \"@\"\n</code></pre>\n\n<p>I tried writing it with the specific workbook instead of letting VBA assume the active worksheet and cells.</p>\n\n<p>I tried to NumberFormat the other columns to be General after running the formatting on column A.</p>\n\n<pre><code>Columns(\"A\").Select\nRange(\"A1\").Activate\nSelection.Delete Shift:=xlToLeft\n\nColumns(\"A\").Select\nActiveCell.NumberFormat = \"@\"\nRange(\"A1\").Select\nActiveSheet.Paste\nApplication.CommandBars(\"Office Clipboard\").Visible = False\n</code></pre>\n\n<p>I expected that if I put another line after my numberformat that I would be able to get column B:ZZ to all be General.</p>\n\n<p>I've gotten no error messages.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10706993, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t-Fgs6xyX8M/AAAAAAAAAAI/AAAAAAAAAWY/7Iieu5dKe7I/photo.jpg?sz=128", "display_name": "Jugal Kishor", "link": "https://stackoverflow.com/users/10706993/jugal-kishor"}, "edited": false, "score": 0, "creation_date": 1560915043, "post_id": 56658742, "comment_id": 99888767, "body": "another problem i am facing in same for different link could you help URL = &quot;<a href=\"https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuote.jsp?symbol=MRF\" rel=\"nofollow noreferrer\">nseindia.com/live_market/dynaContent/live_watch/get_quote/&hellip;</a>&zwnj;&#8203;&quot; the value is 54,555.00 but it print only 54."}, {"owner": {"reputation": 165, "user_id": 7969520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QB1ni.jpg?s=128&g=1", "display_name": "scottmwyant", "link": "https://stackoverflow.com/users/7969520/scottmwyant"}, "reply_to_user": {"reputation": 17, "user_id": 10706993, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t-Fgs6xyX8M/AAAAAAAAAAI/AAAAAAAAAWY/7Iieu5dKe7I/photo.jpg?sz=128", "display_name": "Jugal Kishor", "link": "https://stackoverflow.com/users/10706993/jugal-kishor"}, "edited": false, "score": 0, "creation_date": 1560915210, "post_id": 56658742, "comment_id": 99888795, "body": "Yes but I won\u2019t get back to you for probably 12hr"}], "tags": [], "owner": {"reputation": 165, "user_id": 7969520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QB1ni.jpg?s=128&g=1", "display_name": "scottmwyant", "link": "https://stackoverflow.com/users/7969520/scottmwyant"}, "is_accepted": false, "score": 2, "last_activity_date": 1560907924, "last_edit_date": 1560907924, "creation_date": 1560905523, "answer_id": 56658742, "question_id": 56657806, "link": "https://stackoverflow.com/questions/56657806/how-to-get-inner-text-of-html-under-id/56658742#56658742", "title": "how to get inner text of html under id?", "body": "<p>Examine the response text.  There is a difference in the way the page is rendered in the browser versus what is returned in the ResponseText. </p>\n\n<p>I put the URL into a browser went into dev tools (F12), found the  element,  and noted the numeric value inside the HTML element.</p>\n\n<p>Then I dumped the response text we're getting in VBA into a cell and copied the entire cell value into Notepad++.  If you do that you'll see the initial value inside the #open element is indeed \"--\".  </p>\n\n<p>The real value appears to be getting written into the HTML via JavaScript, which is common practice.  There is a JSON object at the top of the page, presumably injected into the document from the back-end of the website upon your request.</p>\n\n<p>So you have to parse the JSON, not the HTML.  I've provided code doing just that.  Now, there may be a better way to do it, I feel this code is kind of \"hacky\" but it's getting the job done for your example URL.</p>\n\n<pre><code>Sub getelementbyid()\n    Dim XMLpage As New MSXML2.XMLHTTP60\n    Dim hdoc As New MSHTML.HTMLDocument\n\n    Dim HBEs As MSHTML.IHTMLElementCollection\n    Dim HBE As MSHTML.IHTMLElement\n    Dim ha As String\n    XMLpage.Open \"GET\", \"https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuote.jsp?symbol=HAL\", False\n    XMLpage.send\n\n    '// sample: ,\"open\":\"681.05\",\n    Dim token As String\n    token = \"\"\"open\"\":\"\"\"\n\n    Dim startPosition As Integer\n    startPosition = InStr(1, XMLpage.responseText, token)\n\n    Dim endPosition As Integer\n    endPosition = InStr(startPosition, XMLpage.responseText, \",\")\n\n    Dim prop As String\n    prop = Mid(XMLpage.responseText, startPosition, endPosition - startPosition)\n    prop = Replace(prop, \"\"\"\", vbNullString)\n    prop = Replace(prop, \"open:\", vbNullString)\n\n    Dim val As Double\n    val = CDbl(prop)\n    ha = val\n\n    Range(\"K11\").Value = ha\n    Debug.Print ha\nEnd Sub\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1575899818, "post_id": 56660990, "comment_id": 104710428, "body": "Did you try either of these?"}, {"owner": {"reputation": 17, "user_id": 10706993, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t-Fgs6xyX8M/AAAAAAAAAAI/AAAAAAAAAWY/7Iieu5dKe7I/photo.jpg?sz=128", "display_name": "Jugal Kishor", "link": "https://stackoverflow.com/users/10706993/jugal-kishor"}, "edited": false, "score": 0, "creation_date": 1593597797, "post_id": 56660990, "comment_id": 110834729, "body": "Hii QHarr yes i tried it, its working. I have one more addition can we bring two values with first method like &quot;open&quot; and &quot;high&quot; (&quot;dayHigh&quot; in HTML) in two different cells."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1560925723, "last_edit_date": 1560925723, "creation_date": 1560924329, "answer_id": 56660990, "question_id": 56657806, "link": "https://stackoverflow.com/questions/56657806/how-to-get-inner-text-of-html-under-id/56660990#56660990", "title": "how to get inner text of html under id?", "body": "<p>Here are two methods. 1) Using regex on the return text. Usually frowned upon but perfectly serviceable here. 2) Traditional extract json string and use json parser to parse out value.</p>\n\n<p>The data you want is stored in a json string found both on the webpage and the <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">xmlhtttp</a> response, under the same element:</p>\n\n<p><a href=\"https://i.stack.imgur.com/V6EIG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V6EIG.png\" alt=\"enter image description here\"></a></p>\n\n<p>This means you can treat the html as a string and target just the pattern for the open price using regex as shown below, or parse the xmlhttp request into an html parser, grab the required element, extract its innerText and trim off the whitespace, then pass to a json parser to extract the open price.</p>\n\n<p>In both methods you want to avoid being served cached results so the following header is an important addition to attempt to mitigate for this:</p>\n\n<pre><code>.setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n</code></pre>\n\n<p>There is no need for addtional cell formatting. Full value comes out for both your tickers.</p>\n\n<hr>\n\n<h2><strong>Regex:</strong></h2>\n\n<p>It is present in a json string in the response. You can regex it out easily from return text. </p>\n\n<hr>\n\n<p>Regex explanation:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ub6TV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ub6TV.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>VBA:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetClosePrice()\n    Dim ws As Worksheet, re As Object, p As String, r As String\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    p = \"\"\"open\"\":\"\"(.*?)\"\"\"\n    Set re = CreateObject(\"VBScript.RegExp\")\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n            .Open \"GET\", \"https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuote.jsp?symbol=HAL\", False\n            .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n            .send\n            If .Status = 200 Then\n                r = GetValue(re, .responseText, p)\n            Else\n                r = \"Failed connection\"\n            End If\n    End With\n    ws.Range(\"K11\").Value = r\nEnd Sub\n\nPublic Function GetValue(ByVal re As Object, ByVal inputString As String, ByVal pattern As String) As String\n    With re\n        .Global = True\n        .pattern = pattern\n        If .test(inputString) Then  ' returns True if the regex pattern can be matched agaist the provided string\n            GetValue = .Execute(inputString)(0).submatches(0)\n        Else\n            GetValue = \"Not found\"\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<hr>\n\n<h2>HTML and json parser:</h2>\n\n<p>This requires installing code for jsonparser from <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">jsonconverter.bas</a> in a standard module called JsonConverter and then going VBE>Tools>References>Add a reference to Microsoft Scripting Runtime and Microsoft HTML Object Library.</p>\n\n<p>VBA:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetClosePrice()\n    Dim ws As Worksheet, re As Object, r As String, json As Object\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n            .Open \"GET\", \"https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuote.jsp?symbol=MRF\", False\n            .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n            .send\n            If .Status = 200 Then\n                Dim html As HTMLDocument\n                Set html = New HTMLDocument\n                html.body.innerHTML = .responseText\n                Set json = JsonConverter.ParseJson(Trim$(html.querySelector(\"#responseDiv\").innerText))\n                r = json(\"data\")(1)(\"open\")\n            Else\n                r = \"Failed connection\"\n            End If\n    End With\n    ws.Range(\"K11\").Value = r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10706993, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t-Fgs6xyX8M/AAAAAAAAAAI/AAAAAAAAAWY/7Iieu5dKe7I/photo.jpg?sz=128", "display_name": "Jugal Kishor", "link": "https://stackoverflow.com/users/10706993/jugal-kishor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 56660990, "answer_count": 2, "score": 1, "last_activity_date": 1560925723, "creation_date": 1560896701, "last_edit_date": 1560925066, "question_id": 56657806, "link": "https://stackoverflow.com/questions/56657806/how-to-get-inner-text-of-html-under-id", "title": "how to get inner text of html under id?", "body": "<p>I am trying to pull data pull inner text under id in excel cell.</p>\n\n<p>This is for XML code.</p>\n\n<pre><code>Sub getelementbyid()\nDim XMLpage As New MSXML2.XMLHTTP60\nDim hdoc As New MSHTML.HTMLDocument\nDim HBEs As MSHTML.IHTMLElementCollection\nDim HBE As MSHTML.IHTMLElement\nDim ha As String\nXMLpage.Open \"GET\",\"https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuote.jsp?symbol=HAL\", False\nXMLpage.send\nhdoc.body.innerHTML = XMLpage.responseText\nha = hdoc.getelementbyid(\"open\").innerText\nRange(\"K11\").Value = ha\nDebug.Print ha\nEnd Sub\n</code></pre>\n\n<p>I expect output value, but it shows --.</p>\n"}, {"tags": ["excel", "vba", "createobject"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1560892675, "post_id": 56656894, "comment_id": 99884252, "body": "What happens, if you only write these 1 line in the code - <code>Dim words As Object: Set words = CreateObject(&quot;System.Collections.Queue&quot;)</code> and see what happens?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1560893626, "post_id": 56656894, "comment_id": 99884570, "body": "You may need to add mscorlib.dll to your references"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1560896763, "post_id": 56656894, "comment_id": 99885379, "body": "System.Collections.Queue is a .NET type, 0x80131700 is CLR_E_SHIM_RUNTIMELOAD, &quot;Failed to load the runtime&quot;.  Might happen when .NET v3.5 is not installed for example."}, {"owner": {"reputation": 11, "user_id": 11666820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b3b5ad13b6d905c59bc004d0d21b5?s=128&d=identicon&r=PG&f=1", "display_name": "sdpitzer", "link": "https://stackoverflow.com/users/11666820/sdpitzer"}, "edited": false, "score": 0, "creation_date": 1560953689, "post_id": 56656894, "comment_id": 99907116, "body": "Thank you Hans Passant that was the issue. I don&#39;t know why I didn&#39;t think of that! Thank you."}], "owner": {"reputation": 11, "user_id": 11666820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b3b5ad13b6d905c59bc004d0d21b5?s=128&d=identicon&r=PG&f=1", "display_name": "sdpitzer", "link": "https://stackoverflow.com/users/11666820/sdpitzer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564184967, "creation_date": 1560891220, "last_edit_date": 1564184967, "question_id": 56656894, "link": "https://stackoverflow.com/questions/56656894/createobjectsystem-collections-queue-generates-run-time-error-2146232576", "title": "CreateObject(&quot;System.Collections.Queue&quot;) generates Run-time error &#39;-2146232576 (80131700)&#39;: Automation error", "body": "<p>This macro is supposed to count and delete duplicates displaying the number of duplicates to the right of the word</p>\n\n<p>It stops at line <code>Set words = CreateObject(\"System.Collections.Queue\")</code>.</p>\n\n<blockquote>\n  <p>Run-time error '-2146232576 (80131700)': Automation error</p>\n</blockquote>\n\n<p>There are a few macros I use that use this <code>CreateObject(\"System.Collections.Queue\")</code>. All work on my old computer but not on my new laptop.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub CountAndDeleteDupes()\n\n    Dim cell As Range\n    Dim i As Integer\n    Dim j As Integer\n    Dim count As Integer\n    Dim startRow As Integer\n    Dim startCol As Integer\n    startRow = Selection.Row\n    startCol = Selection.Column\n\n    Dim words As Object\n    Set words = CreateObject(\"System.Collections.Queue\")\n    Dim counts As Object\n    Set counts = CreateObject(\"System.Collections.Queue\")\n\n    For Each cell In Selection\n        j = 1\n        count = 1\n        If Not cell.Value = \"\" Then\n            For i = j To Selection.Rows.count\n                If UCase(cell.Value) = UCase(Cells(cell.Row + i,     cell.Column).Value) Then\n                'If UCase(cell.Value) = UCase(cell.Offset(i).Value) Then\n                    count = count + 1\n                    Cells(cell.Row + i, cell.Column).Value = \"\"\n                    'cell.Offset(i).Value = \"\"\n                End If\n            Next i\n            counts.enqueue (count)\n            words.enqueue (cell.Value)\n        End If\n        j = j + 1\n        cell.Clear\n    Next cell\n\n    For i = 1 To words.count\n        Cells(startRow + i - 1, startCol).Value = words.dequeue\n        Cells(startRow + i - 1, startCol + 1).Value = counts.dequeue\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 4, "creation_date": 1560890840, "post_id": 56656796, "comment_id": 99883567, "body": "This would be much easier to do through the built in Conditional Formatting. Looping through every cell in 3 columns is going to take ages where Conditional Formatting will make this very responsive and you have to write code."}, {"owner": {"reputation": 441, "user_id": 9148832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/813db743aa2a0f712729a50b58626bae?s=128&d=identicon&r=PG&f=1", "display_name": "Makhele Sabata", "link": "https://stackoverflow.com/users/9148832/makhele-sabata"}, "edited": false, "score": 0, "creation_date": 1560891196, "post_id": 56656796, "comment_id": 99883718, "body": "Is the Range correct?"}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 9148832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/813db743aa2a0f712729a50b58626bae?s=128&d=identicon&r=PG&f=1", "display_name": "Makhele Sabata", "link": "https://stackoverflow.com/users/9148832/makhele-sabata"}, "edited": false, "score": 0, "creation_date": 1560891353, "post_id": 56656876, "comment_id": 99883779, "body": "check out examples: <a href=\"https://www.exceldome.com/solutions/color-blank-cells/\" rel=\"nofollow noreferrer\">exceldome.com/solutions/color-blank-cells</a>"}], "tags": [], "owner": {"reputation": 441, "user_id": 9148832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/813db743aa2a0f712729a50b58626bae?s=128&d=identicon&r=PG&f=1", "display_name": "Makhele Sabata", "link": "https://stackoverflow.com/users/9148832/makhele-sabata"}, "is_accepted": false, "score": 1, "last_activity_date": 1560891123, "creation_date": 1560891123, "answer_id": 56656876, "question_id": 56656796, "link": "https://stackoverflow.com/questions/56656796/highlighting-empty-cells-within-columns/56656876#56656876", "title": "Highlighting empty cells within columns", "body": "<p>Try:</p>\n\n<pre><code>Sub Color_blank_cells()\n'declare variables\n  Dim ws As Worksheet\n  Dim ColorRng As Range\n  Set ws = Worksheets(\"WorksheetName\")\n  Set ColorRng = ws.Range(\"B3:C9\")\n'color blank cells'\n  ColorRng.SpecialCells(xlCellTypeBlanks).Interior.Color = RGB(220, 230, 241)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 3881978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3A55.png?s=128&g=1", "display_name": "DoomedJupiter", "link": "https://stackoverflow.com/users/3881978/doomedjupiter"}, "is_accepted": false, "score": 1, "last_activity_date": 1560892690, "creation_date": 1560892690, "answer_id": 56657186, "question_id": 56656796, "link": "https://stackoverflow.com/questions/56656796/highlighting-empty-cells-within-columns/56657186#56657186", "title": "Highlighting empty cells within columns", "body": "<p>Your code appears to work fine, it highlights all the empty cells red.  The problem is that you have no way to break out of your loop when you reach the end of your data, the code will continue to highlight empty cells all the way to the end of the sheet (to row 1,048,576) which will likely cause Excel to hang.  </p>\n\n<p>You could find the last row of data and break out of the loop when this row is reached.  The below limits the loop to the length of column \"K\" (assumes all columns have the same length). </p>\n\n<pre><code>Sub highlight()\n    Dim myRange As Range, cel As Range\n    Set myRange = Sheet1.Range(\"K:M\")\n    n = Sheets(\"Sheet1\").Range(\"K\" &amp; Sheets(\"Sheet1\").Rows.Count).End(xlUp).Row\n    For Each cel In myRange\n      If cel.Row &gt; n Then Exit For\n      If Trim(cel.Value) = \"\" Then cel.Interior.ColorIndex = 3\n    Next cel\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 11666863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f13589cd21afc761e3b81e6fa294460?s=128&d=identicon&r=PG&f=1", "display_name": "Starbucks", "link": "https://stackoverflow.com/users/11666863/starbucks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1560892690, "creation_date": 1560890761, "last_edit_date": 1560890784, "question_id": 56656796, "link": "https://stackoverflow.com/questions/56656796/highlighting-empty-cells-within-columns", "title": "Highlighting empty cells within columns", "body": "<p>I am trying to highlight empty cells in columns K,L,M. </p>\n\n<p>I tried the below code</p>\n\n<pre><code>Sub highlight()\n    Dim myRange As Range, cel As Range\n    Set myRange = Sheet1.Range(\"K:M\")\n    For Each cel In myRange\n      If Trim(cel.Value) = \"\" Then cel.Interior.ColorIndex = 3\n    Next cel\nEnd Sub\n</code></pre>\n\n<p>Looking to highlight all the empty cells. </p>\n"}]