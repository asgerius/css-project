[{"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "edited": false, "score": 0, "creation_date": 1495066719, "post_id": 44036577, "comment_id": 75099999, "body": "ahh forgot that little chestnut..... So should i just then declare <code>xlUp</code> as an Object?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "edited": false, "score": 3, "creation_date": 1495066975, "post_id": 44036577, "comment_id": 75100053, "body": "<code>Const xlUp = -4162</code>, or define an enum of your own <code>Enum XlDirection</code>..."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1495093766, "post_id": 44036577, "comment_id": 75109339, "body": "To find the value of any others just type, for example, <code>?xlUp</code> into the Excel immediate window."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 4, "last_activity_date": 1495065928, "creation_date": 1495065928, "answer_id": 44036577, "question_id": 44036463, "link": "https://stackoverflow.com/questions/44036463/converting-to-late-binding-causes-runtime-1004-error-outlook/44036577#44036577", "title": "Converting to late binding causes Runtime 1004 error - Outlook", "body": "<p><code>xlUp</code> is an Excel constant that is defined in the Excel library. If you have removed the reference, then <code>xlUp</code> will be an undeclared variable.</p>\n\n<p>If you have <code>Option Explicit</code> set, then you should find that when compiling.</p>\n"}], "owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 44036577, "answer_count": 1, "score": 2, "last_activity_date": 1592871072, "creation_date": 1495065039, "last_edit_date": 1592871072, "question_id": 44036463, "link": "https://stackoverflow.com/questions/44036463/converting-to-late-binding-causes-runtime-1004-error-outlook", "title": "Converting to late binding causes Runtime 1004 error - Outlook", "body": "<p>I have a working Outlook macro which exports the task list of the current user to an Excel spreadsheet, but I want to change it to use late binding for ease of distribution (ie I don't have to explain to other users about setting a library reference etc.)</p>\n\n<p>I followed the example <a href=\"https://stackoverflow.com/questions/32939197/convert-early-binding-vba-to-late-binding-vba-excel-to-outlook-contacts\">Convert Early Binding VBA to Late Binding VBA : Excel to Outlook Contacts</a> to set my Excel variables as objects.</p>\n\n<p>Below is a comparison of how i declared the variables pre/post binding change:</p>\n\n<pre><code>'Late binding variables and their early binding equivilants\n  Dim objExcel As Object 'Dim objExcel As New Excel.Application\n  Dim exWB As Object 'Dim exWb As Excel.Workbook\n  Dim sht As Object 'Dim sht As Excel.Worksheet\n  Dim Range As Object 'Dim Range As Excel.Range\n  Dim r As Object 'Dim r As Range\n  Dim cell As Object 'Dim cell As Range\n\n  'set application\n  Set objExcel = CreateObject(\"Excel.Application\")\n</code></pre>\n\n<p>I am now getting a runtime 1004 error in the following section of my code:</p>\n\n<pre><code>    With objExcel.ActiveSheet\n  Set r = .Range(.Cells(2, col), .Cells(.Rows.Count, col).End(xlUp)) 'runtime 1004 error here after late binding modification\nEnd With\nFor Each cell In r\n s = cell.Text\n If Len(Trim(s)) &gt; 0 Then\n   iloc = InStr(1, s, sChar, vbTextCompare)\n   If iloc &gt; 1 Then\n     s1 = Left(s, iloc - 1)\n     cell.Value = s1\n   Else\n     If iloc &lt;&gt; 0 Then\n      cell.ClearContents\n     End If\n   End If\n End If\nNext cell\n        y = y + 1\n        stat_string = \"\"\n       End If\n\n  Next x\n\n\n'Autofit all column widths\n\nFor Each sht In objExcel.ActiveWorkbook.Worksheets\n    sht.Columns(\"A\").EntireColumn.AutoFit\n    sht.Columns(\"B\").EntireColumn.AutoFit\n    sht.Columns(\"C\").EntireColumn.AutoFit\n    sht.Columns(\"D\").EntireColumn.AutoFit\n    sht.Columns(\"E\").EntireColumn.AutoFit\n    sht.Columns(\"F\").EntireColumn.AutoFit\nNext sht\n\nexWB.Save\n\nexWB.Close\n\nSet exWB = Nothing\n'this kills the excel program from the task manager so the code will not double up on opening the application\n'sKillExcel = \"TASKKILL /F /IM Excel.exe\"\n'Shell sKillExcel, vbHide\nobjExcel.Application.Quit\n</code></pre>\n\n<p>I have included the rest of the code after the error line so, if there are further run-time problems, they might be picked up by the incredible people on SO. </p>\n\n<p>I'm assuming that the methodology for declaring my \"Range\" is incorrect, but I am not really sure why, and therefore unsure on how to fix it.</p>\n\n<p>Any body out there with a suggestion?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "filtering", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6710161, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e53a5ad611c44006f7b86094af3b98da?s=128&d=identicon&r=PG&f=1", "display_name": "terny", "link": "https://stackoverflow.com/users/6710161/terny"}, "edited": false, "score": 0, "creation_date": 1495067141, "post_id": 44036605, "comment_id": 75100090, "body": "that was just an example. I need to get any values that contain any character. Is there any way to make a filter like this?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 21, "user_id": 6710161, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e53a5ad611c44006f7b86094af3b98da?s=128&d=identicon&r=PG&f=1", "display_name": "terny", "link": "https://stackoverflow.com/users/6710161/terny"}, "edited": false, "score": 0, "creation_date": 1495068054, "post_id": 44036605, "comment_id": 75100295, "body": "@terny  See my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1495126244, "last_edit_date": 1495126244, "creation_date": 1495066129, "answer_id": 44036605, "question_id": 44036444, "link": "https://stackoverflow.com/questions/44036444/vba-filter-only-on-character-value/44036605#44036605", "title": "vba filter only on character value", "body": "<p>Use the Text Filter <em>Contains</em> feature in AutoFilter:</p>\n\n<p><a href=\"https://i.stack.imgur.com/u8KRm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u8KRm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Or with VBA:</p>\n\n<pre><code>Sub Macro1()\n    Columns(\"A:A\").AutoFilter\n    ActiveSheet.Range(\"$A$1:$A$5\").AutoFilter Field:=1, Criteria1:=\"=*R*\", _\n        Operator:=xlAnd\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>To test for the presence of ANY letter, use this <em>UDF()</em> in a helper column:</p>\n\n<pre><code>Public Function HasLetter(v As Variant) As Boolean\n    Dim i As Long, L As Long\n    HasLetter = False\n    If Len(v) = 0 Then Exit Function\n    L = Len(v)\n    For i = 1 To L\n        If Mid(v, i, 1) Like \"[a-zA-Z]\" Then\n            HasLetter = True\n            Exit Function\n        End If\n    Next i\nEnd Function\n</code></pre>\n\n<p>and filter on <em>True</em>.</p>\n"}], "owner": {"reputation": 21, "user_id": 6710161, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e53a5ad611c44006f7b86094af3b98da?s=128&d=identicon&r=PG&f=1", "display_name": "terny", "link": "https://stackoverflow.com/users/6710161/terny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2068, "favorite_count": 0, "accepted_answer_id": 44036605, "answer_count": 1, "score": 0, "last_activity_date": 1495126244, "creation_date": 1495064938, "last_edit_date": 1531164843, "question_id": 44036444, "link": "https://stackoverflow.com/questions/44036444/vba-filter-only-on-character-value", "title": "vba filter only on character value", "body": "<p>I want to make a filter to see rows that contain any character.</p>\n\n<p>For example, column A contains 124124, 4231, R2341, RRR</p>\n\n<p>Then I would like to see R2341, RRR from column A. Is there any way to filter only on character string?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "nested-if"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1495064356, "post_id": 44036303, "comment_id": 75099376, "body": "Did you step into it with the debugger?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1495064359, "post_id": 44036303, "comment_id": 75099377, "body": "Even if all your tests fail you should at least see &quot;No&quot;.  Do you get any errors when you run it?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1495067077, "post_id": 44036303, "comment_id": 75100081, "body": "FWIW (almost certainly not related to the problem) <code>ws.Cells(Rows.Count, &quot;M&quot;)</code> should be <code>ws.Cells(ws.Rows.Count, &quot;M&quot;)</code>"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1495073925, "post_id": 44036303, "comment_id": 75101573, "body": "@A.S.H even if he step into it with the debugger he won&#39;t get anything wrong because codes are actually ok (instead of defining a variable as YowE3K has mentioned) the problem is occurring because of looking at wrong worksheet as his loop starts from Sheet1 probably he is at somewhere else."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8028099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/352f70901d962e6f6768233bcc8a4630?s=128&d=identicon&r=PG&f=1", "display_name": "T. Fukunaga", "link": "https://stackoverflow.com/users/8028099/t-fukunaga"}, "edited": false, "score": 1, "creation_date": 1495154895, "post_id": 44037502, "comment_id": 75144573, "body": "Thank you! I have changed ws.Cells(ws.Rows.Count, &quot;M&quot;) in my code and I have also added an &lt;&gt; &quot;TOTALS&quot; to the If statements so the code does not run on the first sheet. Everything works now!"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 3, "user_id": 8028099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/352f70901d962e6f6768233bcc8a4630?s=128&d=identicon&r=PG&f=1", "display_name": "T. Fukunaga", "link": "https://stackoverflow.com/users/8028099/t-fukunaga"}, "edited": false, "score": 0, "creation_date": 1495156134, "post_id": 44037502, "comment_id": 75144819, "body": "Glad to hear that. Have enjoy it. And as long as the question is answered you can approve this, as an <i>answer</i> for future investigations of others about this subject."}], "tags": [], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "is_accepted": true, "score": 0, "last_activity_date": 1506008404, "last_edit_date": 1506008404, "creation_date": 1495073770, "answer_id": 44037502, "question_id": 44036303, "link": "https://stackoverflow.com/questions/44036303/excel-vba-that-uses-nested-if-statements-for-multiple-worksheets/44037502#44037502", "title": "Excel VBA that uses nested If statements for multiple worksheets", "body": "<p>When you start your loop with <code>For Each ws In ThisWorkbook.Worksheets</code> then Excel starts processing from <strong><em>Sheet1</em></strong> and I'm sure your list in another sheet.</p>\n\n<blockquote>\n  <p><strong>So, the reason nothing changes in your <em>U column</em> is, because you are\n  looking at <em>wrong Worksheet</em>.</strong></p>\n</blockquote>\n\n<p>As long as you would like to loop through all of your worksheets, start to follow your lists from <strong>Sheet1.</strong> If you would like to loop in different order, you should define this in your code.</p>\n\n<p>And below I edited some part of your code and also added <code>msgbox ws.name</code> to show you in which sheet Excel is working now.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long/26409520#26409520\">Why Use Integer Instead of Long?</a></p>\n\n<pre><code>Option Explicit\n\nSub Compliance()\n\nDim ws As Worksheet\n\n    For Each ws In ThisWorkbook.Worksheets\n    Dim i As Long\n    Dim listLength\n    MsgBox ws.Name\n    listLength = ws.Cells(ws.Rows.Count, \"M\").End(xlUp).Row - 1\n\n        For i = 2 To listLength + 2\n        If IsEmpty(ws.Range(\"P\" &amp; i)) = True And IsEmpty(ws.Range(\"O\" &amp; i)) = True And IsEmpty(ws.Range(\"N\" &amp; i)) = True And DateDiff(\"d\", ws.Range(\"M\" &amp; i), ws.Range(\"K\" &amp; i)) &gt; 150 Then\n            ws.Range(\"U\" &amp; i) = \"Yes\"\n        ElseIf IsEmpty(ws.Range(\"P\" &amp; i)) = True And IsEmpty(ws.Range(\"O\" &amp; i)) = True And DateDiff(\"d\", ws.Range(\"N\" &amp; i), ws.Range(\"M\" &amp; i)) &lt; 150 Then\n            ws.Range(\"U\" &amp; i) = \"Yes\"\n        ElseIf IsEmpty(ws.Range(\"P\" &amp; i)) = True And DateDiff(\"d\", ws.Range(\"O\" &amp; i), ws.Range(\"N\" &amp; i)) &lt; 150 Then\n            ws.Range(\"U\" &amp; i) = \"Yes\"\n        ElseIf DateDiff(\"d\", ws.Range(\"N\" &amp; i), ws.Range(\"M\" &amp; i)) &lt; 150 Then\n            ws.Range(\"U\" &amp; i) = \"Yes\"\n        Else\n            ws.Range(\"U\" &amp; i) = \"No\"\n        End If\n        Next\n\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8028099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/352f70901d962e6f6768233bcc8a4630?s=128&d=identicon&r=PG&f=1", "display_name": "T. Fukunaga", "link": "https://stackoverflow.com/users/8028099/t-fukunaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 44037502, "answer_count": 1, "score": 0, "last_activity_date": 1506008404, "creation_date": 1495063843, "question_id": 44036303, "link": "https://stackoverflow.com/questions/44036303/excel-vba-that-uses-nested-if-statements-for-multiple-worksheets", "title": "Excel VBA that uses nested If statements for multiple worksheets", "body": "<p>I'm trying to get an output in column U for multiple worksheets in a workbook. The return string will either be \"Yes\" or \"No\" depending on which column is not blank and if the difference between two dates are > 150. This is the code I have written, but nothing shows up in column U. Could anyone help me figure out why this isn't working?</p>\n\n<pre><code>Sub Compliance()\n\nDim ws As Worksheet\n\nFor Each ws In ThisWorkbook.Worksheets\nDim i As Integer\nDim listLength\nlistLength = ws.Cells(Rows.Count, \"M\").End(xlUp).Row - 1\n\n\nFor i = 2 To listLength + 2\nIf IsEmpty(ws.Range(\"P\" &amp; i)) = True And IsEmpty(ws.Range(\"O\" &amp; i)) = True And IsEmpty(ws.Range(\"N\" &amp; i)) = True And DateDiff(\"d\", ws.Range(\"M\" &amp; i), ws.Range(\"K\" &amp; i)) &gt; 150 Then\n    ws.Range(\"U\" &amp; i) = \"Yes\"\nElseIf IsEmpty(ws.Range(\"P\" &amp; i)) = True And IsEmpty(ws.Range(\"O\" &amp; i)) = True And DateDiff(\"d\", ws.Range(\"N\" &amp; i), ws.Range(\"M\" &amp; i)) &lt; 150 Then\n    ws.Range(\"U\" &amp; i) = \"Yes\"\nElseIf IsEmpty(ws.Range(\"P\" &amp; i)) = True And DateDiff(\"d\", ws.Range(\"O\" &amp; i), ws.Range(\"N\" &amp; i)) &lt; 150 Then\n    ws.Range(\"U\" &amp; i) = \"Yes\"\nElseIf DateDiff(\"d\", ws.Range(\"N\" &amp; i), ws.Range(\"M\" &amp; i)) &lt; 150 Then\n    ws.Range(\"U\" &amp; i) = \"Yes\"\nElse\n    ws.Range(\"U\" &amp; i) = \"No\"\nEnd If\nNext\nNext ws\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1495063886, "last_edit_date": 1495063886, "creation_date": 1495063390, "answer_id": 44036235, "question_id": 44036180, "link": "https://stackoverflow.com/questions/44036180/trying-to-vba-script-some-embedded-if-commands/44036235#44036235", "title": "Trying to VBA Script some embedded if commands", "body": "<p>If by <code>contains \"*\"</code> you mean \"has any content\" then:</p>\n\n<pre><code>If cell.Value = \"X\" Then\n    cell.Interior.ColorIndex = IIf(Len(cell.Offset(0, -1).Value) = 0, 19, xlNone)\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 8028077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d020fc15be66367c98b29093307e0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Waters", "link": "https://stackoverflow.com/users/8028077/eric-waters"}, "edited": false, "score": 0, "creation_date": 1495123184, "post_id": 44036279, "comment_id": 75130501, "body": "Thanks so very much!  Works like a charm.  I felt I was getting close but I just couldn&#39;t get there."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1495063690, "creation_date": 1495063690, "answer_id": 44036279, "question_id": 44036180, "link": "https://stackoverflow.com/questions/44036180/trying-to-vba-script-some-embedded-if-commands/44036279#44036279", "title": "Trying to VBA Script some embedded if commands", "body": "<p>So close!</p>\n\n<pre><code>Sub Set_Background_Color ()\n    Dim lRow As Long\n    Dim MR As Range\n    Dim cel As Range\n    lRow = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n    Set MR = Range(\"E2:E\" &amp; lRow)\n    For Each cel In MR\n        If cel.Value = \"string\" Then\n            If cel.Offset(, -1).Value = \"\" Then\n                cel.Offset(, -1).Interior.ColorIndex = 19\n            ElseIf cel.Offset(, -1).Value = \"*\" Then\n                cel.Offset(, -1).Interior.ColorIndex = -4142\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8028077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d020fc15be66367c98b29093307e0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Waters", "link": "https://stackoverflow.com/users/8028077/eric-waters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 44036279, "answer_count": 2, "score": 0, "last_activity_date": 1495063886, "creation_date": 1495062864, "last_edit_date": 1495063728, "question_id": 44036180, "link": "https://stackoverflow.com/questions/44036180/trying-to-vba-script-some-embedded-if-commands", "title": "Trying to VBA Script some embedded if commands", "body": "<p>What I am trying to do is get my macro to search the data in Column \"E\".  If the cell value contains \"<strong>string</strong>\", then I would like to offset by one column to the left, verify if, in the new selected cell, cell value contains \"\". If the new selected cell value is \"\" then background color is 19, if it contains \"*\" then background color is -4142.</p>\n\n<p>Here is the code I have so far:</p>\n\n<pre><code>Sub Set_Background_Color ()\n\n    lRow = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n    Set MR = Range(\"E2:E\" &amp; lRow)\n    For Each cell In MR\n    If cell.Value = \"X\" Then cell.Offset(, -1).Interior.ColorIndex = 19\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>I can't seem to figure out how to embed a new If statement after the Offset and before the .Interior.ColorIndex</p>\n\n<p>I have tried this mess but you will see immediately that it does not work.</p>\n\n<pre><code>If cell.Value = \"X\" Then\n    ElseIf cell.Offset(, -1).Value = \"\" Then cell.Interior.ColorIndex = 19\n    Else: cell.Interior.ColorIndex = -4142\n</code></pre>\n\n<p>Any help is greatly apreciated!</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1495061567, "creation_date": 1495061567, "answer_id": 44035970, "question_id": 44035635, "link": "https://stackoverflow.com/questions/44035635/vba-code-to-format-text-copied-over-from-excel-to-powerpoint/44035970#44035970", "title": "VBA Code to format text copied over from Excel to PowerpoInt", "body": "<p>Very difficult to follow all what your code is actually achieving and I had trouble testing it.. But concerning the main question:</p>\n\n<blockquote>\n  <p>how to position the columns on the slide after i paste them</p>\n</blockquote>\n\n<p>You can get a handle to the shape you just pasted and set its <code>.Top</code> and <code>.Left</code> properties. For example, when you paste a column,</p>\n\n<blockquote>\n<pre><code>ppPres.Slides(SlideNo).Shapes.Paste\n</code></pre>\n</blockquote>\n\n<p>You can use indtead</p>\n\n<pre><code> With ppPres.Slides(SlideNo).Shapes.Paste\n   .Top = tbox1.Top + tbox1.Width + 5\n   .Left = tbox1.Left\n End With\n</code></pre>\n\n<p>This will place a pasted column under <code>tbox1</code>... Write your loop in such a way that each pasted column falls at the appropriate place.</p>\n"}], "owner": {"reputation": 1, "user_id": 7920799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c8ed2aeeb8ef5a45c6731e89dd2f103?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7920799/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 474, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495061567, "creation_date": 1495059316, "question_id": 44035635, "link": "https://stackoverflow.com/questions/44035635/vba-code-to-format-text-copied-over-from-excel-to-powerpoint", "title": "VBA Code to format text copied over from Excel to PowerpoInt", "body": "<p>I'm having trouble figuring out how to format text after I have pasted it to PowerPoint from Excel.  My code correctly copies over text but i can't seem to format it properly. I'm copying over multiple columns of text into each slide under each dept title. I have included a loop because I will be doing this for multiple slides for each manager. However, I don't know how to position the columns on the slide after i paste them. I would appreciate any help or suggestions on what I should do?</p>\n\n<pre><code>Sub CreateNewPresentation()\n\nDim myData As Excel.Range\nSet myData = Range(\"D3:E1000\")\n\nDim ppApp As PowerPoint.Application\nDim ppPres As PowerPoint.Presentation\nDim ppSlide As PowerPoint.Slide\n\nSet ppApp = New PowerPoint.Application\n\nppApp.Visible = True\nppApp.Activate\n\nSet ppPres = ppApp.Presentations.Add\n\nSet ppSlide = ppPres.Slides.Add(1, ppLayoutTitle)\n\nppSlide.Shapes(1).TextFrame.TextRange = \"Title of Powerpoint\"\nppSlide.Shapes(2).TextFrame.TextRange = \"Author\"\n\nSet ppSlide = ppPres.Slides.Add(2, ppLayoutCustom)\n\nppSlide.Shapes(1).TextFrame.TextRange = \"Manager Name\"\n\nSet tbox1 = ppSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, 100, 125, 75, 50)\ntbox1.TextFrame.TextRange.Text = \"Dept 1\"\ntbox1.TextFrame.TextRange.Font.Bold = msoTrue\ntbox1.Fill.ForeColor.RGB = RGB(255, 150, 0)\n\nSet tbox2 = ppSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, 300, 125, 75, 50)\ntbox2.TextFrame.TextRange.Text = \"Dept 2\"\ntbox2.TextFrame.TextRange.Font.Bold = msoTrue\ntbox2.Fill.ForeColor.RGB = RGB(255, 150, 0)\n\nSet tbox3 = ppSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, 500, 125, 75, 50)\ntbox3.TextFrame.TextRange.Text = \"Dept 3\"\ntbox3.TextFrame.TextRange.Font.Bold = msoTrue\ntbox3.Fill.ForeColor.RGB = RGB(255, 150, 0)\n\nSet tbox1 = ppSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, 700, 125, 80, 50)\ntbox1.TextFrame.TextRange.Text = \"Dept 4\"\ntbox1.TextFrame.TextRange.Font.Bold = msoTrue\ntbox1.Fill.ForeColor.RGB = RGB(255, 150, 0)\n\nDim prerow As Integer\nprerow = 3\n\nDim nextrow As Integer\nRange(\"D3\").Select\n\nDim SlideNo As Integer\n\nSlideNo = 2\nDo While True\n\nSelection.End(xlDown).Select\nIf Selection.Value = \"\" Then\n\n  Exit Do\n  End If\n\nnextrow = Selection.Row\nRange(\"E\" &amp; prerow &amp; \":E\" &amp; nextrow - 1).Select\n    Selection.Copy\n\n  ppPres.Slides(SlideNo).Shapes.Paste\n\n   If Range(\"E\" &amp; nextrow).Offset(-1, 0) = \"\" Then\n    SlideNo = SlideNo + 1\n    nextrow = nextrow + 1\n    End If\n\n   prerow = nextrow\n   Range(\"D\" &amp; prerow).Select\n\n   Loop\n\n   End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1495059234, "post_id": 44035549, "comment_id": 75097874, "body": "The straightforward solution would be to open the workbook and call <code>.RefreshAll</code> on it then close it. Are you looking for a way to refresh it without opening it? I dont see how that would be possible."}, {"owner": {"reputation": 73, "user_id": 7724141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a022d535c44aa64b42e86555d9fac75?s=128&d=identicon&r=PG&f=1", "display_name": "D. Morley", "link": "https://stackoverflow.com/users/7724141/d-morley"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1495059633, "post_id": 44035549, "comment_id": 75098007, "body": "Yeah the idea is to not have to open any other workbooks. The file I&#39;m working on is a dashboard for work and so the less I have to do to refresh the dashboard, the better.  So from what you think, there&#39;s no way to somehow say &quot;Refresh.NewTable&quot; at file path C:\\\\etc"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1495062840, "post_id": 44035549, "comment_id": 75098974, "body": "I (personally) dont know of a way to do that without opening the file."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7724141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a022d535c44aa64b42e86555d9fac75?s=128&d=identicon&r=PG&f=1", "display_name": "D. Morley", "link": "https://stackoverflow.com/users/7724141/d-morley"}, "edited": false, "score": 0, "creation_date": 1495118087, "post_id": 44042101, "comment_id": 75126775, "body": "Wow that looks really nice. I&#39;ll give it a try and let you know."}, {"owner": {"reputation": 73, "user_id": 7724141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a022d535c44aa64b42e86555d9fac75?s=128&d=identicon&r=PG&f=1", "display_name": "D. Morley", "link": "https://stackoverflow.com/users/7724141/d-morley"}, "edited": false, "score": 0, "creation_date": 1495139138, "post_id": 44042101, "comment_id": 75139368, "body": "Tried this macro and the debugger errors out on the third to last line &quot;Case Else: Error ErrNo&quot; with an error message of &quot;File not found&quot;."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 73, "user_id": 7724141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a022d535c44aa64b42e86555d9fac75?s=128&d=identicon&r=PG&f=1", "display_name": "D. Morley", "link": "https://stackoverflow.com/users/7724141/d-morley"}, "edited": false, "score": 0, "creation_date": 1495139322, "post_id": 44042101, "comment_id": 75139444, "body": "ofc, you have to link the file where your seperated table is in. if youve done that it should work."}, {"owner": {"reputation": 73, "user_id": 7724141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a022d535c44aa64b42e86555d9fac75?s=128&d=identicon&r=PG&f=1", "display_name": "D. Morley", "link": "https://stackoverflow.com/users/7724141/d-morley"}, "edited": false, "score": 0, "creation_date": 1495141219, "post_id": 44042101, "comment_id": 75140347, "body": "Sorry mate, I&#39;m all self-taught when it comes to computers and programming so I&#39;m afraid I have to ask what you mean by &quot;link the file&quot;. @UGP"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 73, "user_id": 7724141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a022d535c44aa64b42e86555d9fac75?s=128&d=identicon&r=PG&f=1", "display_name": "D. Morley", "link": "https://stackoverflow.com/users/7724141/d-morley"}, "edited": false, "score": 0, "creation_date": 1495141624, "post_id": 44042101, "comment_id": 75140538, "body": "If i understood you correctly then the error should come from this line <code>Path = &quot;C:\\Users\\User\\Desktop\\Files\\1.xlsx&quot;</code> . You have to take the filepath of the workbook with the seperated table, you made and exchange it with that line. Directory + Filename."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 0, "last_activity_date": 1495095071, "creation_date": 1495095071, "answer_id": 44042101, "question_id": 44035549, "link": "https://stackoverflow.com/questions/44035549/simple-excel-linking/44042101#44042101", "title": "Simple Excel Linking", "body": "<p>So this will open the woorkbook and refresh the table and then close it, if the workbook is already opened it will stay open. There is no way to do it with a closed workbook, but its not visible for the user anyway.</p>\n\n<pre><code>Sub Button1_Click()\nDim wbk As Workbook\nDim FileName As String\nDim Path As String\nDim Opened As Boolean\n\nThisWorkbook.RefreshAll\n\nPath = \"C:\\Users\\User\\Desktop\\Files\\1.xlsx\" 'Edit Path\nIf IsWorkBookOpen(Path) = False Then\nSet wbk = Workbooks.Open(Path)\nElse\nPath = Right(Path, Len(Path) - InStrRev(Path, \"\\\"))\nSet wbk = Workbooks(Path)\nOpened = True\nEnd If\nwbk.RefreshAll\nIf Opened = False Then\nwbk.Close (saveChanges = True)\nEnd If\n\nDoEvents\nActiveSheet.Range(\"Q45\") = Now\n\nEnd Sub\n\nFunction IsWorkBookOpen(FileName As String)\n    Dim ff As Long, ErrNo As Long\n\n    On Error Resume Next\n    ff = FreeFile()\n    Open FileName For Input Lock Read As #ff\n    Close ff\n    ErrNo = Err\n    On Error GoTo 0\n\n    Select Case ErrNo\n    Case 0:    IsWorkBookOpen = False\n    Case 70:   IsWorkBookOpen = True\n    Case Else: Error ErrNo\n    End Select\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7724141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a022d535c44aa64b42e86555d9fac75?s=128&d=identicon&r=PG&f=1", "display_name": "D. Morley", "link": "https://stackoverflow.com/users/7724141/d-morley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495095071, "creation_date": 1495058884, "question_id": 44035549, "link": "https://stackoverflow.com/questions/44035549/simple-excel-linking", "title": "Simple Excel Linking", "body": "<p>I have a fairly simple question that I have been unable to find an suitable answer for; I have an excel sheet with many SQL tables nested in the worksheet. I now need to add one more table, but this new table will be over 30 mb and when added to the current file, it makes the entire workbook trudge along very slowly for even simple calculations.</p>\n\n<p>My question is: can I insert this table into a new excel file and then refresh it from my original file using the VBA code I already have that refreshes all my other SQL tables? If so, what would I have to add to my VBA code to refresh the new table in the new file? Let's assume the new table's name is \"NewTable\" and the file path would be C:\\Users\\davidmo\\Desktop\\David</p>\n\n<p>Here is my current VBA Macro:</p>\n\n<pre><code>Sub Button1_Click()\n\nThisWorkbook.RefreshAll\nDoEvents\n\nActiveSheet.Range(\"Q45\") = Now\n\nEnd Sub\n</code></pre>\n\n<p>If it helps, I am envisioning being able to open my original file, click the VBA macro button I use to refresh all my SQL tables and it would also refresh the table in the different file. Then I'd run my formulas in the original file and just reference the newly updated table from the other file.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495056187, "post_id": 44034758, "comment_id": 75096652, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20904092/excel-find-min-max-values-in-a-column-among-those-matched-from-another-column\">Excel: Find min/max values in a column among those matched from another column</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2583, "user_id": 2908576, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/yhWY7.jpg?s=128&g=1", "display_name": "HaveSpacesuit", "link": "https://stackoverflow.com/users/2908576/havespacesuit"}, "is_accepted": true, "score": 0, "last_activity_date": 1495055944, "creation_date": 1495055944, "answer_id": 44034963, "question_id": 44034758, "link": "https://stackoverflow.com/questions/44034758/how-to-return-the-latest-date-with-the-same-report-number/44034963#44034963", "title": "How to return the latest date with the same report number", "body": "<p>Assuming that column I will always be ascending within the groups of column D (e.g., Sort By Report Key, then by Transaction Date), add this formula to <code>J2</code> and fill down:</p>\n\n<pre><code>=IF(D2=D3,J3,I2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1495056703, "creation_date": 1495056703, "answer_id": 44035100, "question_id": 44034758, "link": "https://stackoverflow.com/questions/44034758/how-to-return-the-latest-date-with-the-same-report-number/44035100#44035100", "title": "How to return the latest date with the same report number", "body": "<p>You can use this <em>array formula</em> at <code>J2</code> then fill down:</p>\n\n<pre><code>=MAX(I2:I1000*(D$2:D$1000=D2))    Ctrl+Shift+Enter\n</code></pre>\n\n<p>p.s.: it's an array formula, type it then press <code>Ctrl+Shift+Enter</code></p>\n"}], "owner": {"reputation": 87, "user_id": 7380227, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/96ba7fb215ca8d5acfe30bd60f74da41?s=128&d=identicon&r=PG&f=1", "display_name": "emma12345", "link": "https://stackoverflow.com/users/7380227/emma12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 44034963, "answer_count": 2, "score": 0, "last_activity_date": 1577478143, "creation_date": 1495055153, "last_edit_date": 1577478143, "question_id": 44034758, "link": "https://stackoverflow.com/questions/44034758/how-to-return-the-latest-date-with-the-same-report-number", "title": "How to return the latest date with the same report number", "body": "<p>I have some entries as shown in the image below and I am looking for a formula or VBA code (best to be formula) to do a calculation in column J.</p>\n\n<p>The logic I want is:<br>\nUnder the condition that values in column D are the same, return the latest day in column I. For example, D2 to D14 are with the same value, so return the latest day from I2 to I14 which is 3/16/17.</p>\n\n<p>Column D is the report number, one report can include several transactions, e.g. if I have 10 transactions in one report, I have 10 lines with the same report number. I am trying to identify the date of the last transaction of this report.\nWith right formula, J2 to J14 should all be 3/16/2017.</p>\n\n<p>Can anyone tell me how to do it?</p>\n\n<p><img src=\"https://i.stack.imgur.com/5qMwv.png\" alt=\"Attached pic\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": false, "score": 0, "last_activity_date": 1497122424, "creation_date": 1497122424, "answer_id": 44477192, "question_id": 44034658, "link": "https://stackoverflow.com/questions/44034658/excel-using-a-flag-to-control-cell-level-calculation/44477192#44477192", "title": "Excel - using a flag to control cell level calculation", "body": "<p>This approach might help you,</p>\n\n<p>1) Whatever cells you want to do a recalculate with <code>F9</code>, enter the formulas in the excel sheet directly. Even if you set the formula calculate method to manual, the data will be refreshed and recalculated when you press <code>F9</code></p>\n\n<p>2) For the cells which you do not want to do a recalculate, enter the formulas for those cells through <code>VBA</code>, so that whenever the code is executed, the formulas will be calculated. If not, the old value would still stay there on the cell (UseTheLastValueOfBigCalc)</p>\n\n<p>This code could be triggered through a <code>worksheet_change</code> event which can detect a <code>True/False</code> on a particular cell and execute accordingly. If its true, just recalculate the formulas, if false just ignore.</p>\n\n<p>Below is a code snippet which detects <code>True</code> in cell <code>A1</code> and calculates accordingly,</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$A$1\" And Range(\"A1\") = True Then\n        Range(\"B3\") = Application.WorksheetFunction.Sum(Range(\"B1:B2\"))\n    End If\nEnd Sub\n</code></pre>\n\n<p>This code sums the values in <code>B1</code> and <code>B2</code> and prints in <code>B3</code> only if <code>True</code> is entered in <code>A1</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/dqEjy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dqEjy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Even if you change values in cells <code>B1</code> or <code>B2</code> the sum will not be recalculated, which means the old value can still be used unless <code>A1</code> is changes to <code>true</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/18mh2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/18mh2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Once <code>True</code> is entered, the formulas are calculated,</p>\n\n<p><a href=\"https://i.stack.imgur.com/bmzUD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bmzUD.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1497122424, "creation_date": 1495054645, "last_edit_date": 1531161705, "question_id": 44034658, "link": "https://stackoverflow.com/questions/44034658/excel-using-a-flag-to-control-cell-level-calculation", "title": "Excel - using a flag to control cell level calculation", "body": "<p>I'm trying to figure out if there is a way to control calculation at a cell level.   Here is what I'm basically trying to do in an If statement...   I don't know how to \"UseTheLastValue\" of \"DoThisBigLongCalc\" though.... </p>\n\n<pre><code>Cell A1 =IF(CalculateFlag = True, DoThisBigLongCalc, UseTheLastValueOfBigCalc)\n</code></pre>\n\n<p>Any help would be appreciated!   The reason I'm doing this is I have a lot of formulas that I do want to calculate every time I hit F9, but also a whole lot that I don't because of their long calc time.....  Thanks</p>\n"}, {"tags": ["vba", "if-statement", "ms-word", "delete-row"], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1495103643, "creation_date": 1495103643, "answer_id": 44045378, "question_id": 44034462, "link": "https://stackoverflow.com/questions/44034462/word-document-vba-delete-text-if-its-not-x-y-or-z/44045378#44045378", "title": "Word document VBA Delete text if its not &quot;X&quot; &quot;Y&quot; or &quot;Z&quot;", "body": "<p><code>Selection.Information(wdWithInTable)</code> will return <code>True</code> if the selection is inside a table. <code>If Not Selection.Information(wdWithInTable)</code> will therefore only be executed if the item found is <strong>not</strong> in a table. However, if it isn't within a table <code>Selection.Rows.Delete</code> must fail because rows can only be found if tables.</p>\n\n<p>On the other hand, <code>Selection.Rows.Delete</code> must also fail because it is incorrect syntax which you seem to have borrowed from Excel. In Word you should first extend the selected range to include the entire row and then delete the range.</p>\n\n<p>I realise that you seem to have a loop in mind which will perhaps read the items to be deleted from a list. That is much more complicated, but work on it can't be started until after your present code has been made to work. Therefore I suggest to focus on that target first.</p>\n"}], "owner": {"reputation": 11, "user_id": 4766576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40d893f6393b60d7a289e05551094a66?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Freiges", "link": "https://stackoverflow.com/users/4766576/kevin-freiges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1593904389, "creation_date": 1495053794, "last_edit_date": 1593904389, "question_id": 44034462, "link": "https://stackoverflow.com/questions/44034462/word-document-vba-delete-text-if-its-not-x-y-or-z", "title": "Word document VBA Delete text if its not &quot;X&quot; &quot;Y&quot; or &quot;Z&quot;", "body": "<p>I would like to start off by stating that i am not a good programmer, my degree is in chemistry so this is rather foreign to me! any help would be much appreciated!</p>\n\n<p>So im looking to delete all of the text in a document that is not matching a criteria the text is found here:</p>\n\n<p><a href=\"https://www.mnsu.edu/supersite/academics/catalogs/undergraduate/2014-2015/2014-2015-undergraduate-bulletin.pdf\" rel=\"nofollow noreferrer\">https://www.mnsu.edu/supersite/academics/catalogs/undergraduate/2014-2015/2014-2015-undergraduate-bulletin.pdf</a></p>\n\n<p>for example it would delete most of everything up to page 15 everything and on page 15 it would leave behind \"PRE-MORTUARY SCIENCE ACCT 200 BIOL 220\" and so on.. </p>\n\n<p>the script ive been trying is:</p>\n\n<pre><code>Sub DeleteRowWithSpecifiedText()\nDim sText As String\n\nsText = InputBox(\"Enter text for Row to be deleted\")\nSelection.Find.ClearFormatting\nWith Selection.Find\n    .Text = sText\n    .Wrap = wdFindContinue\nEnd With\nDo While Selection.Find.Execute\n    If Not Selection.Information(wdWithInTable) Then\n        Selection.Rows.Delete\n    End If\nLoop\n</code></pre>\n\n<p>end sub</p>\n\n<p>But this throws out the error 5941: \"The requested member of the collection does not exist\".</p>\n\n<p>I am pretty foreign to coding but i set up a list of everything i want to keep in the document which can be found at the bottom of this post. </p>\n\n<p>Also if possible can it delete the row if it doesnt match the generic form of the class ID:\n\"XX ###\" or \"XXX ###\" or \"XXXX ###\"</p>\n\n<p>\"ACCT\"<em>\"AIS\"</em>\"ANTH\"<em>\"ART\"</em>\"AST\"<em>\"AET\"</em>\"AVIA\"<em>\"BIOL\"</em>\"BLAW\"<em>\"CAHN\"</em>\"CHEM\"<em>\"CHIN\"</em>\"CIVE\"<em>\"BUS\"</em>\"CDIS\"<em>\"CMST\"</em>\"CM\"<em>\"CS\"</em>\"CORR\"<em>\"CSP\"</em>\"DAK\"<em>\"DANC\"</em>\"DHYG\"<em>\"ECON\"</em>\"ED\"<em>\"EDLD\"</em>\"EEC\"<em>\"KSP\"</em>\"EE\"<em>\"EET\"</em>\"ENG\"<em>\"ESL\"</em>\"EAP\"<em>\"ENVR\"</em>\"ETHN\"<em>\"EXED\"</em>\"FILM\"<em>\"FCS\"</em>\"FINA\"<em>\"FYEX\"</em>\"FREN\"<em>\"GWS\"</em>\"GEOG\"<em>\"GEOL\"</em>\"GER\"<em>\"GERO\"</em>\"HLTH\"<em>\"HIST\"</em>\"HONR\"<em>\"HP\"</em>\"HUM\"<em>\"IT\"</em>\"ENGR\"<em>\"IEP\"</em>\"IBUS\"<em>\"IPO\"</em>\"IDST\"<em>\"LAWE\"</em>\"MGMT\"<em>\"MET\"</em>\"MRKT\"<em>\"MASS\"</em>\"MACC\"<em>\"MBA\"</em>\"MATH\"<em>\"ME\"</em>\"MEDT\"<em>\"MSL\"</em>\"MDSM\"<em>\"MUSE\"</em>\"MUSC\"<em>\"MUSP\"</em>\"NPL\"<em>\"NURS\"</em>\"PYIL\"<em>\"PHYS\"</em>\"POL\"<em>\"PSYC\"</em>\"RPLS\"<em>\"REHB\"</em>\"SCAN\"<em>\"SOST\"</em>\"SOWK\"<em>\"SOC\"</em>\"SPAN\"<em>\"SPED\"</em>\"STAT\"<em>\"THEA\"</em>\"URBS\"<em>\"WCDP\"</em>\"WLC\"<em>\"1\"</em>\"2 \"<em>\"3\"</em>\"4\"<em>\"5\"</em>\"6\"<em>\"7\"</em>\"8\"<em>\"9\"</em>\"0\"</p>\n\n<p>% Pre-Professional Programs % Pre-Chiropractic % Pre-Dental % Pre-Engineering % Pre-Law % Pre-Medicine % Pre-Mortuary Science % Pre-Occupational Therapy % Pre-Optometry % Pre-Osteopathic Medicine and Surgery % Pre-Pharmacy % Pre-Physical Therapy % Pre-Podiatric Medicine and Surgery % Pre-Veterinary Medicine % Academic Colleges % Advising/General Education/Diverse Cultures/Writing Intensive % Academic Programs % Accounting % Aging Studies (Formally Gerontology) % Alcohol and Drug Studies % Allied Health and Nursing (Intro Course) % American Indian Studies % Anthropology % Applied Organizational Studies % Art % Astronomy % Athletic Coaching % Athletic Training % Automotive Engineering Technology % Aviation % Biochemistry % Biology % Biotechnology % Business Administration % Business Education % Business Law % Chemistry % Chinese (Mandarin) % Civil Engineering % Cognitive Science % Communication Disorders % Communication Studies % Computer Engineering % Computer Engineering Technology % Computer Information Technology % Computer Science % Construction Management % Corporate &amp; Community Fitness/Wellness % Corrections % Counseling and Student Personnel % Dance % Dental Hygiene % Earth Science % Economics % Educational Leadership % Electrical Engineering % Electronic Engineering Technology % Elementary Education % English % English for Non-Native Speakers (English As A Second Language) % Environmental Sciences % Ethnic Studies % Exercise Science % Family Consumer Science % Film Studies % Finance % First Year Experience % Food Science Technology % French % Gender and Women\u2019s Studies % Geography % Geology % German % Health Science % History % Honors % Humanities % Human Performance % Information Systems % Iron Range Engineering % Integrated Engineering % Interdisciplinary Studies % International Business % International Relations % Japanese % Latin % Latin American Studies % Law Enforcement % Liberal Studies % Management % Manufacturing Engineering Technology % Marketing % Mass Media % Mathematics % Mechanical Engineering % Medical Laboratory Science % Military Science and Leadership/Army ROTC % Museum Studies (See Anthropology) % Music % Nonprofit Leadership % Norwegian % Nursing % Philosophy % Philosophy, Politics, and Economics (PPE) % Physics % Political Science % Portuguese % Psychology % Recreation, Parks &amp; Leisure Services % Rehabilitation Counseling % Russian % Scandinavian Studies % Science Teaching % Secondary % - % &amp; K- % Education\u2014Professional Education % Social Studies % Social Work % Sociology % Spanish % Special Education: Academic &amp; Behavioral Strategist % Sport Management % Statistics % Swedish % Teaching English As A Second Language (TESL) % Theatre Arts % Twin Cities Engineering % Urban &amp; Regional Studies % World Languages &amp; Cultures % </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495051439, "post_id": 44033783, "comment_id": 75094294, "body": "<a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=454\" rel=\"nofollow noreferrer\">vbaexpress.com/kb/getarticle.php?kb_id=454</a>"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 3, "creation_date": 1495052632, "post_id": 44033783, "comment_id": 75094970, "body": "You can query a closed workbook with ADO. I would recommend that as it will be much faster than the <code>ExecuteExcel4Macro</code> solution. I have used both."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1495053198, "post_id": 44033783, "comment_id": 75095242, "body": "Without opening the file, you will only be able to retrieve the <i>values</i> from the sheet, none of the formatting, shapes, charts, etc."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1495054405, "post_id": 44033783, "comment_id": 75095842, "body": "The same goes for <code>ExecuteExcel4Macro</code> about formatting, shapes, etc, correct @DavidZemens?"}], "answers": [{"comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1495053759, "post_id": 44034240, "comment_id": 75095519, "body": "IMO your answer is incomplete without description of how to output field names and recodset data to worksheet (e. g. using recordset <code>.GetRows</code> method)."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1495054340, "post_id": 44034240, "comment_id": 75095809, "body": "@omegastripes, valid point. This is updated to input the data and column headers. I prefer the method above, but another, different, answer is not only welcome, it is preferable."}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 1, "creation_date": 1495074806, "post_id": 44034240, "comment_id": 75101759, "body": "For the above code to work, a reference to Microsoft ActiveX Data Object library must be added."}, {"owner": {"reputation": 39, "user_id": 7982062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44f8b91530cf572a9eba63cb76fdadf?s=128&d=identicon&r=PG&f=1", "display_name": "Sarchwalk", "link": "https://stackoverflow.com/users/7982062/sarchwalk"}, "edited": false, "score": 0, "creation_date": 1495573363, "post_id": 44034240, "comment_id": 75307571, "body": "I get the following an error: &quot;Runtime -2147467259 (80004005) Cannot update. Database or object is read only.&quot; Its happening at With conn .Open. Any leads on an error like this?"}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 1, "last_activity_date": 1495113659, "last_edit_date": 1495113659, "creation_date": 1495053048, "answer_id": 44034240, "question_id": 44033783, "link": "https://stackoverflow.com/questions/44033783/vba-copy-worksheet-from-unopened-workbook-to-active-workbook-fastest-way/44034240#44034240", "title": "VBA Copy Worksheet from Unopened Workbook to Active Workbook FASTEST WAY", "body": "<p>The below will give you a recordset <code>rst</code> that contains the data from <code>Sheet1</code> of the workbook you use in your connection string. You didn't provide much in the way of specifics, so either ask follow up questions, or adjust this code as necessary. </p>\n\n<p>It's important to keep in mind that the connection string <em>may</em> change if you use a different format Excel workbook (ie .xls, .xlsm).</p>\n\n<p>EDIT:\nThis now outputs the whole recordset on Sheet1 of whichever workbook you set to <code>wbk</code> (starting in cell A2) and puts the column headers in row 1.</p>\n\n<p>This also requires a reference to a Microsoft ActiveX Data Objects library.</p>\n\n<pre><code>Sub ExampleOfADO()\n\nDim conn as New ADODB.Connection\nDim rst as New ADODB.Recordset\nDim wbk as Workbook\nDim i as Long\n\nSet wbk = yourworkbook\n\nWith conn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source=C:\\Desktop\\File.xlsx;Extended Properties = 'Excel 12.0 Xml;HDR =YES'\"\n    .Open\nEnd With\n\nrst.Open \"Select * FROM [Sheet1$]\", conn\n\nWith wbk.Sheets(1)\n   .Range(\"a2\").CopyFromRecordSet rst\n\n   For i = 0 To rst.Fields.Count - 1\n      .Range(\"a1\").Offset(0, i) = rst.Fields(i).Name\n   Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7982062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44f8b91530cf572a9eba63cb76fdadf?s=128&d=identicon&r=PG&f=1", "display_name": "Sarchwalk", "link": "https://stackoverflow.com/users/7982062/sarchwalk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 44034240, "answer_count": 1, "score": -1, "last_activity_date": 1495113659, "creation_date": 1495051158, "last_edit_date": 1495052125, "question_id": 44033783, "link": "https://stackoverflow.com/questions/44033783/vba-copy-worksheet-from-unopened-workbook-to-active-workbook-fastest-way", "title": "VBA Copy Worksheet from Unopened Workbook to Active Workbook FASTEST WAY", "body": "<p>I am writing a macro that on a button click in the destination workbook, copies information from a worksheet in an unopened workbook to a worksheet in the current workbook. I've tried copying the data from the source worksheet to the destination worksheet and I've also tried copying the entire source worksheet and pasting it into the destination workbook. Both methods have proven to be extremely slow as the documents I'm using are quite large and the source file needs to be opened each time.</p>\n\n<p>What I am looking for is a method that doesn't open the source workbook (if that's even possible), or any advice as to how I could speed up the process.</p>\n\n<p>I am trying to learn VBA so a pseudo code solution is welcome!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1495054302, "post_id": 44033778, "comment_id": 75095792, "body": "The value of Stack Overflow is that people google up their specific problem, and end up on questions asked by people that had the same issue they&#39;re facing, and find valuable answers easily. Please <a href=\"https://stackoverflow.com/posts/44033778/edit\">edit</a> your title to something searchable."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495057666, "post_id": 44033778, "comment_id": 75097305, "body": "^^ Yes, I saw the question and thought &quot;hmm, someone is having an issue with creating an Excel macro in VBA - that&#39;s strange - I wonder what would be preventing them from doing that&quot;, and then read the question and saw that it was completely unrelated."}], "answers": [{"comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1495112003, "post_id": 44034038, "comment_id": 75121926, "body": "It fixes the problem.  What more elaboration do you need?  The difference between my code and the OP code is the reason it wasn&#39;t working."}, {"owner": {"reputation": 19, "user_id": 8027531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32603af43a66377b3b55324d3bd4ac1d?s=128&d=identicon&r=PG&f=1", "display_name": "XcvrTester", "link": "https://stackoverflow.com/users/8027531/xcvrtester"}, "edited": false, "score": 0, "creation_date": 1495112295, "post_id": 44034038, "comment_id": 75122123, "body": "Sorry, perhaps I should elaborate.  My goal is to create a utility that can be used by non-SW engineers.  The utility will allow these engineers to create their own macros and run them using the base code.  Since they are not versed in VBA I am hoping that we can use the &quot;auto-generated&quot; Excel macro VBA code to create macros.  The problem is that, apparently, the auto-generated code does not always work correctly and I am not sure why.  Perhaps it is a setting I do not have correct?  Some other easy-to-fix issue?  Thanks."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495113019, "post_id": 44034038, "comment_id": 75122649, "body": "What macros will the engineers create?  Are they trying to create a chart for specific data in a specific range?  Are you wanting the engineers to autogenerate their own code with the recording function?  My code could be changed to  operate on a selected area instead of a fixed range.  The engineer would only need to select their data and run the macro, which can be changed to use the current selection as it&#39;s data source.  Would that solve your problem?  Sometimes when you hit a wall you can climb over it or go around it.  Why question its existence?"}, {"owner": {"reputation": 19, "user_id": 8027531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32603af43a66377b3b55324d3bd4ac1d?s=128&d=identicon&r=PG&f=1", "display_name": "XcvrTester", "link": "https://stackoverflow.com/users/8027531/xcvrtester"}, "edited": false, "score": 0, "creation_date": 1495113410, "post_id": 44034038, "comment_id": 75122948, "body": "The utility I&#39;m trying to create needs to be very flexible, meaning that the data plotted, the format of the data/plots, labeling, etc. could all change on a daily basis if we are debugging an issue.  So my utility will start with a macro that does what we need it to do 90% of the time but I want the option for the engineers to replace the default macro with one of their own.  And they are not VBA programmers, so I was hoping that I could have them create their own macro using the Excel &quot;auto-generation&quot; feature and use that code to replace the default macro."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1495052107, "creation_date": 1495052107, "answer_id": 44034038, "question_id": 44033778, "link": "https://stackoverflow.com/questions/44033778/excel-2013-auto-generated-macro-vba-code-does-not-work-when-attempting-to-run-th/44034038#44034038", "title": "Excel 2013 auto generated macro VBA code does not work when attempting to run the macro", "body": "<p>Try this on a new sheet.</p>\n\n<pre><code>Sub SimplePlotExample()\n    Range(\"A1:B11\").Select\n    ActiveSheet.Shapes.AddChart2(332, xlLineMarkers).Select\n    ActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$1:$B$11\")\n    With ActiveChart\n     'chart name\n    .HasTitle = True\n    .ChartTitle.Characters.Text = \"Chart Name\"\n     'X axis name\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"This is my X-Axis\"\n     'y-axis name\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"This is my Y axis title\"\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8027531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32603af43a66377b3b55324d3bd4ac1d?s=128&d=identicon&r=PG&f=1", "display_name": "XcvrTester", "link": "https://stackoverflow.com/users/8027531/xcvrtester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495066521, "creation_date": 1495051134, "last_edit_date": 1495066521, "question_id": 44033778, "link": "https://stackoverflow.com/questions/44033778/excel-2013-auto-generated-macro-vba-code-does-not-work-when-attempting-to-run-th", "title": "Excel 2013 auto generated macro VBA code does not work when attempting to run the macro", "body": "<p>I am trying to create a very simple Excel macro in Office 2013.  The macro should create a line chart with titles on the x and y axes.  I go to the \"Developer\" tab and select \"Record Macro\".  I create my chart and everything looks fine.  When I view my auto-generated VBA code it looks like the following:</p>\n\n<pre><code>Sub SimplePlotExample()\n    Range(\"A1:B11\").Select\n    ActiveSheet.Shapes.AddChart2(332, xlLineMarkers).Select\n    ActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$1:$B$11\")\n    ActiveChart.SetElement (msoElementPrimaryCategoryAxisTitleAdjacentToAxis)\n    Selection.Caption = \"This is my rows title\"\n    ActiveChart.SetElement (msoElementPrimaryValueAxisTitleAdjacentToAxis)\n    Selection.Caption = \"This is my y axis title\"\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>The problem is that when I try to run this macro, the y-axis title does not get created and instead the x-axis has the title intended for the y-axis.  If I go into the VBA code directly, comment out the line \"Selection.Caption = \"This is my y axis title\"\" and manually replace it with the code as shown below everything works fine.</p>\n\n<pre><code>Sub SimplePlotExample()\n    Range(\"A1:B11\").Select\n        ActiveSheet.Shapes.AddChart2(332, xlLineMarkers).Select\n        ActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$1:$B$11\")\n        ActiveChart.SetElement (msoElementPrimaryCategoryAxisTitleAdjacentToAxis)\n        Selection.Caption = \"This is my rows title\"\n        ActiveChart.SetElement (msoElementPrimaryValueAxisTitleAdjacentToAxis)\n    '   Add the 2 lines of code below manually to my macro code\n        ActiveChart.Axes(xlValue, xlPrimary).HasTitle = True\n        ActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Text = \"This is my hand-edited y axis title\"\n    '    Selection.Caption = \"This is my y axis title\"   ### This is the auto-generated line commented out\n        Range(\"A1\").Select\n    End Sub\n</code></pre>\n\n<p>My questions is.....Why does the \"auto-generated\" VBA code not work correctly?  I have found other threads that perhaps indicate this may have been an issue with past versions of Excel, am I to assume that this is also an issue with Excel 2013?  I am using Microsoft Office Professional Plus 2013.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "performance", "excel", "loops"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1495051926, "post_id": 44033766, "comment_id": 75094624, "body": "Instead of repeatedly accessing the worksheet, do all your work in VBA arrays.  You will probably see about a ten-fold increase in speed.  See Chip Pearson&#39;s discussion on <a href=\"http://www.cpearson.com/Excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">VBA arrays and Worksheet Ranges</a> for more information.  This question is better suited for Code Review"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1495052361, "post_id": 44033766, "comment_id": 75094836, "body": "Why does this need VBA? This can be accomplished with a <a href=\"https://support.office.com/en-us/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1\" rel=\"nofollow noreferrer\">VLOOKUP formula</a>"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1495053269, "post_id": 44033766, "comment_id": 75095280, "body": "X2 on arrays and Code Review (since it&#39;s working code)."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8027392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d8e96e4d5feebb51dc849778d5b9d04?s=128&d=identicon&r=PG&f=1", "display_name": "Milito22", "link": "https://stackoverflow.com/users/8027392/milito22"}, "edited": false, "score": 0, "creation_date": 1495056678, "post_id": 44034582, "comment_id": 75096859, "body": "Wow Vlookup method executes almost instantly, this is exactly what I needed ! Thank you very much for your help !"}, {"owner": {"reputation": 13, "user_id": 8027392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d8e96e4d5feebb51dc849778d5b9d04?s=128&d=identicon&r=PG&f=1", "display_name": "Milito22", "link": "https://stackoverflow.com/users/8027392/milito22"}, "edited": false, "score": 0, "creation_date": 1495479826, "post_id": 44034582, "comment_id": 75259869, "body": "Last question, how can I do now if I want to copy the whole row of &quot;Balance_MAJ&quot; (and place this row at the end of &quot;Balance&quot;) each time an element exists in Column D of &quot;Balance_MAJ&quot; but not in Column D of &quot;Balance&quot; ? Thank you"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1495054286, "creation_date": 1495054286, "answer_id": 44034582, "question_id": 44033766, "link": "https://stackoverflow.com/questions/44033766/vba-fast-method-to-compare-two-columns-in-two-different-sheets-and-copy-value/44034582#44034582", "title": "VBA : Fast method to compare two columns in two different sheets and copy value from 2nd sheet next to the respective cell in sheet 1", "body": "<p>I tested two additional methods, one using VLOOKUP and one using the suggested Arrays.  I used your provided sample setup with data copied down to row 28,676 on both sheets.  Here is the code for the two methods and my speed test macro as well:</p>\n\n<pre><code>Sub VLOOKUP_Method()\n\n    Dim wb As Workbook\n    Dim wsBal As Worksheet\n    Dim wsMAJ As Worksheet\n\n    Set wb = ActiveWorkbook\n    Set wsBal = wb.Sheets(\"Balance\")\n    Set wsMAJ = wb.Sheets(\"Balance_MAJ\")\n\n    With wsBal.Range(\"F5\", wsBal.Cells(wsBal.Rows.Count, \"F\").End(xlUp))\n        .Formula = \"=VLOOKUP(D\" &amp; .Row &amp; \",'\" &amp; wsMAJ.Name &amp; \"'!D:G,4,FALSE)\"\n        .Value = .Value\n    End With\n\nEnd Sub\n\nSub ARRAY_Method()\n\n    Dim wb As Workbook\n    Dim wsBal As Worksheet\n    Dim wsMAJ As Worksheet\n    Dim aBalData As Variant\n    Dim aMAJData As Variant\n    Dim i As Long, j As Long\n\n    Set wb = ActiveWorkbook\n    Set wsBal = wb.Sheets(\"Balance\")\n    Set wsMAJ = wb.Sheets(\"Balance_MAJ\")\n\n    aBalData = wsBal.Range(\"B4\").CurrentRegion.Value\n    aMAJData = wsMAJ.Range(\"B4\").CurrentRegion.Value\n\n    For i = LBound(aBalData, 1) To UBound(aBalData, 1)\n        For j = LBound(aMAJData, 1) To UBound(aMAJData, 1)\n            If aBalData(i, 3) = aMAJData(j, 3) Then\n                aBalData(i, 5) = aMAJData(j, 6)\n                Exit For\n            End If\n        Next j\n    Next i\n\n    wsBal.Range(\"B4\").Resize(UBound(aBalData, 1), UBound(aBalData, 2)).Value = aBalData\n\nEnd Sub\n\nSub SpeedTests()\n\n    Dim dTimer As Double\n    Dim aResults(1 To 100, 1 To 2) As Variant\n    Dim i As Long, j As Long\n\n    j = 0\n    For i = 1 To UBound(aResults, 1)\n        j = j + 1\n        dTimer = Timer\n        VLOOKUP_Method\n        aResults(j, 1) = Timer - dTimer\n    Next i\n\n    j = 0\n    For i = 1 To UBound(aResults, 1)\n        j = j + 1\n        dTimer = Timer\n        ARRAY_Method\n        aResults(j, 2) = Timer - dTimer\n    Next i\n\n    Sheets(\"Speed_Results\").Range(\"A2\").Resize(UBound(aResults, 1), UBound(aResults, 2)).Value = aResults\n\nEnd Sub\n</code></pre>\n\n<p>Here are the results of the speed tests on my system.  VLOOKUP was faster by a factor of about 2.5</p>\n\n<p><a href=\"https://i.stack.imgur.com/LlgUH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LlgUH.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 8027392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d8e96e4d5feebb51dc849778d5b9d04?s=128&d=identicon&r=PG&f=1", "display_name": "Milito22", "link": "https://stackoverflow.com/users/8027392/milito22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2896, "favorite_count": 0, "accepted_answer_id": 44034582, "answer_count": 1, "score": 0, "last_activity_date": 1495054286, "creation_date": 1495051104, "last_edit_date": 1495051506, "question_id": 44033766, "link": "https://stackoverflow.com/questions/44033766/vba-fast-method-to-compare-two-columns-in-two-different-sheets-and-copy-value", "title": "VBA : Fast method to compare two columns in two different sheets and copy value from 2nd sheet next to the respective cell in sheet 1", "body": "<p>First of all, I apologize in advance if my English is not perfect, I'll try to do my best to explain my need.</p>\n\n<p>So basically, I have an excel file with 2 sheets named \"Balance\" and \"Balance_MAJ\". </p>\n\n<p>It looks like this (just a little sample) : <a href=\"https://i.stack.imgur.com/EaF1k.png\" rel=\"nofollow noreferrer\">\"Balance\" &amp; \"Balance_MAJ\"</a></p>\n\n<p>What I need is to compare <strong>Column D of \"Balance\"</strong> with <strong>Column D of \"Balance_MAJ\"</strong> in order to update <strong>Column F of \"Balance\"</strong> using values from <strong>Column G of \"Balance_MAJ\"</strong>. </p>\n\n<p>In fact, Columns D of these 2 sheets contain the same informations but not in the same order. So, I have to make 2 loops to compare these 2 columns and each time it matches, I will get the respective value in Column G of \"Balance_MAJ\" and I will put it in the respective cell in Column F of \"Balance\".</p>\n\n<p>Something like that : <a href=\"https://i.stack.imgur.com/B02Ez.jpg\" rel=\"nofollow noreferrer\">What I need to do</a></p>\n\n<p>The problem is that my entire dataset contains a large quantity of data (about 12 000 rows today, it may contain way more rows in the future). I used 2 methods and in both cases it worked perfectely, but it was really slow (about 1mn50sec with the first method and 47sec with the second method).</p>\n\n<p><strong>First method (1mn50sec) :</strong> </p>\n\n<pre><code>`Sub MAJ_Balance()\n\nDim i As Long\nDim j As Long\nDim lastRow_Balance As Long\nDim lastRow_BalanceMAJ As Long\nDim stNow As Date\n\nstNow = Now\n\nApplication.ScreenUpdating = False\n\nlastRow_Balance = Sheets(\"Balance\").Cells(Rows.Count, \"D\").End(xlUp).Row\nlastRow_BalanceMAJ = Sheets(\"Balance_MAJ\").Cells(Rows.Count, \n\"D\").End(xlUp).Row\n\n    For i = 5 To lastRow_Balance\n      For j = 5 To lastRow_BalanceMAJ \n        If Sheets(\"Balance\").Cells(i, \"D\").Value = \n           Sheets(\"Balance_MAJ\").Cells(j, \"D\").Value Then\n           Sheets(\"Balance\").Cells(i, \"F\").Value = \n           Sheets(\"Balance_MAJ\").Cells(j, \"G\").Value\n        End If\n      Next j\n    Next i\n\nMsgBox (DateDiff(\"s\", stNow, Now))\n\nApplication.ScreenUpdating = True\n\nEnd Sub`\n</code></pre>\n\n<p><strong>Second method (47sec) :</strong> </p>\n\n<pre><code>`Sub MAJ_Balance()\n\nDim i As Long\nDim j As Long\nDim v As Variant\nDim lastRow_Balance As Long\nDim lastRow_BalanceMAJ As Long\nDim stNow As Date\n\nstNow = Now\n\nApplication.ScreenUpdating = False\n\nlastRow_Balance = Sheets(\"Balance\").Cells(Rows.Count, \"D\").End(xlUp).Row\nlastRow_BalanceMAJ = Sheets(\"Balance_MAJ\").Cells(Rows.Count, \n\"D\").End(xlUp).Row\n\n    For i = 5 To lastRow_Balance\n      With Sheets(\"Balance\").Cells(i, \"D\")\n      v = .Value\n      For j = 5 To lastRow_BalanceMAJ \n        If v = Sheets(\"Balance_MAJ\").Cells(j, \"D\").Value Then\n        Sheets(\"Balance\").Cells(i, \"F\").Value = \n        Sheets(\"Balance_MAJ\").Cells(j, \"G\").Value\n        End If\n      Next j\n      End With\n    Next i\n\nMsgBox (DateDiff(\"s\", stNow, Now))\n\nApplication.ScreenUpdating = True\n\nEnd Sub`\n</code></pre>\n\n<p>Do you have any idea for code optimization ? <strong>What is the fastest method to do that ?</strong> </p>\n\n<p>I thank you in advance for your help ! </p>\n"}, {"tags": ["regex", "vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495050460, "post_id": 44033400, "comment_id": 75093680, "body": "Why not try and write it first ?  Have you tried anything?"}, {"owner": {"reputation": 1009, "user_id": 6480215, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d8e1516b86b03bb68c18a2cb158626e0?s=128&d=identicon&r=PG&f=1", "display_name": "machump", "link": "https://stackoverflow.com/users/6480215/machump"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495050882, "post_id": 44033400, "comment_id": 75093939, "body": "I threw it away because I was not running properly and I&#39;ve never used regexp with vba before. Here&#39;s something along the lines of what I had <code>sub test() Dim strPattern As String dim regex As Object, str as string set regex=createObject(&quot;VBScript.RegExp&quot;)  with regex .pattern=&quot;[a-z]{2}[0-9]{2}&quot; .global=true end with for each thing in range(&quot;A1:A4&quot;) set matches= regex.execute(thing) thing.offset(0,1)=regex.execute(thing) next</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1009, "user_id": 6480215, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d8e1516b86b03bb68c18a2cb158626e0?s=128&d=identicon&r=PG&f=1", "display_name": "machump", "link": "https://stackoverflow.com/users/6480215/machump"}, "edited": false, "score": 0, "creation_date": 1495053055, "post_id": 44034088, "comment_id": 75095174, "body": "using the code in example 3 (looping through range) of the very deep answer: what would you write in the if statement (if regex.test(strinput) then) to return the value of the matches found? I tried msgbox (regex.execute(strinput)) but it returns an error: &quot;Wrong number of arguments or invalid property assignment&quot;"}, {"owner": {"reputation": 302, "user_id": 7990477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JSQFF.jpg?s=128&g=1", "display_name": "\u0414\u0435\u043d\u0438\u0441 \u0418\u0441\u043c\u0430\u0439\u043b\u043e\u0432\u0441\u043a\u0438\u0439", "link": "https://stackoverflow.com/users/7990477/%d0%94%d0%b5%d0%bd%d0%b8%d1%81-%d0%98%d1%81%d0%bc%d0%b0%d0%b9%d0%bb%d0%be%d0%b2%d1%81%d0%ba%d0%b8%d0%b9"}, "reply_to_user": {"reputation": 1009, "user_id": 6480215, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d8e1516b86b03bb68c18a2cb158626e0?s=128&d=identicon&r=PG&f=1", "display_name": "machump", "link": "https://stackoverflow.com/users/6480215/machump"}, "edited": false, "score": 0, "creation_date": 1495056182, "post_id": 44034088, "comment_id": 75096649, "body": "regex.execute(strinput)  return all the possible matches i think that doing `msgbox (regex.execute(strinput))  you are settings too much arguments. @machump"}], "tags": [], "owner": {"reputation": 302, "user_id": 7990477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JSQFF.jpg?s=128&g=1", "display_name": "\u0414\u0435\u043d\u0438\u0441 \u0418\u0441\u043c\u0430\u0439\u043b\u043e\u0432\u0441\u043a\u0438\u0439", "link": "https://stackoverflow.com/users/7990477/%d0%94%d0%b5%d0%bd%d0%b8%d1%81-%d0%98%d1%81%d0%bc%d0%b0%d0%b9%d0%bb%d0%be%d0%b2%d1%81%d0%ba%d0%b8%d0%b9"}, "is_accepted": false, "score": 0, "last_activity_date": 1495052337, "last_edit_date": 1495541431, "creation_date": 1495052337, "answer_id": 44034088, "question_id": 44033400, "link": "https://stackoverflow.com/questions/44033400/regexp-vba-loop-through-cells-return-matched-value-in-adjacent-cell/44034088#44034088", "title": "Regexp &amp; VBA - loop through cells, return matched value in adjacent cell", "body": "<p>You Regex is correct and should something like this to define it properly in VBA</p>\n\n<pre><code>Private Sub simpleRegex()\n    Dim strPattern As String: strPattern = \"[a-z]{2}[0-9]{2}\"       \n    Dim regEx As New RegExp      \n\n\n        With regEx\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = False\n            .Pattern = strPattern\n        End With\n</code></pre>\n\n<p>with</p>\n\n<pre><code>regEx.Test(strInput)\n</code></pre>\n\n<p>you can check if a String match or not. </p>\n\n<p>you can find a very deep answer <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loopshttp://\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1495055723, "creation_date": 1495055723, "answer_id": 44034912, "question_id": 44033400, "link": "https://stackoverflow.com/questions/44033400/regexp-vba-loop-through-cells-return-matched-value-in-adjacent-cell/44034912#44034912", "title": "Regexp &amp; VBA - loop through cells, return matched value in adjacent cell", "body": "<pre><code>Sub test()\n\n    Dim matches, regex As Object, c As Range\n    Dim i As Long\n\n    Set regex = CreateObject(\"VBScript.RegExp\")\n    With regex\n        .Pattern = \"[a-z]{2}[0-9]{2}\"\n        .Global = True\n    End With\n\n    For Each c In Range(\"A1:A4\")\n        Set matches = regex.Execute(c.Value)\n\n        'if only one match expected...\n        If matches.Count &gt; 0 Then\n            c.Offset(0, 1) = matches(0)\n        End If\n\n        'if can be multiple matches...\n        'For i = 1 To matches.Count\n        '    c.Offset(0, i) = matches(i - 1)\n        'Next i\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1495056902, "last_edit_date": 1495056902, "creation_date": 1495055760, "answer_id": 44034924, "question_id": 44033400, "link": "https://stackoverflow.com/questions/44033400/regexp-vba-loop-through-cells-return-matched-value-in-adjacent-cell/44034924#44034924", "title": "Regexp &amp; VBA - loop through cells, return matched value in adjacent cell", "body": "<p>You almost had it. Since you are searching for only one occurrence of the pattern, say the first, you can have it as <code>matches(0)</code>, but first check if there are matches using <code>matches.count</code>.</p>\n\n<pre><code>Sub Test()\n  Dim cel As Range, matches As Object\n  With CreateObject(\"VBScript.RegExp\")\n    .Global = True\n    .Pattern = \"[a-zA-Z]{2}[0-9]{2}\"\n    For Each cel In Range(\"A1:A10\")\n      Set matches = .Execute(cel.Value2)\n      If matches.Count &gt; 0 Then cel.Offset(0, 1).Value = matches(0)\n    Next\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1009, "user_id": 6480215, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d8e1516b86b03bb68c18a2cb158626e0?s=128&d=identicon&r=PG&f=1", "display_name": "machump", "link": "https://stackoverflow.com/users/6480215/machump"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "closed_date": 1495097406, "accepted_answer_id": 44034924, "answer_count": 3, "score": -2, "last_activity_date": 1495056902, "creation_date": 1495049778, "last_edit_date": 1531164843, "question_id": 44033400, "link": "https://stackoverflow.com/questions/44033400/regexp-vba-loop-through-cells-return-matched-value-in-adjacent-cell", "closed_reason": "Needs more focus", "title": "Regexp &amp; VBA - loop through cells, return matched value in adjacent cell", "body": "<p>If in column A,I had values like\n<strong>A</strong></p>\n\n<p>A0394</p>\n\n<p>948B0129</p>\n\n<p>Zkjs333</p>\n\n<p>0a0401a</p>\n\n<p>09ab28</p>\n\n<p>and I wanted to return matches where there are 2 alpha followed by 2 numeric characters using regular expressions and VBA (without using a custom function)\n<strong>B</strong></p>\n\n<p>js33</p>\n\n<p>ab28</p>\n\n<p>What would the code look like? </p>\n"}, {"tags": ["excel", "vba", "reference", "cell", "userform"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 1134099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d18ea9dd360709f8d73f5514abf8538?s=128&d=identicon&r=PG", "display_name": "djdulee", "link": "https://stackoverflow.com/users/1134099/djdulee"}, "edited": false, "score": 0, "creation_date": 1495464794, "post_id": 44033772, "comment_id": 75251323, "body": "This is not working, still getting error about type mismatch.The Form stays open all the time while cycling through  the worksheets with Previous and Next buttons on the form. As soon I hit Next it will switch the worksheet and activate it. Then I need to find column reference that is pointing to the current day and return value from cell where it is going to be the same column but row will be 50, 51 and 52."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 5, "user_id": 1134099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d18ea9dd360709f8d73f5514abf8538?s=128&d=identicon&r=PG", "display_name": "djdulee", "link": "https://stackoverflow.com/users/1134099/djdulee"}, "edited": false, "score": 0, "creation_date": 1495487095, "post_id": 44033772, "comment_id": 75263539, "body": "where does the type mismatch occure, i couldnt recreate it."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 0, "last_activity_date": 1495051435, "last_edit_date": 1495051435, "creation_date": 1495051117, "answer_id": 44033772, "question_id": 44033375, "link": "https://stackoverflow.com/questions/44033375/how-to-find-column-with-matching-value-and-assign-it-to-the-textbox1-in-user-for/44033772#44033772", "title": "How to find column with matching value and assign it to the textbox1 in user form VBA", "body": "<p>So you cant create a Range of Columns like that. It has to be like this: </p>\n\n<pre><code>.Range(Columns(1), Columns(50))\n</code></pre>\n\n<p>If you want to show some value in a userform then you can assign it with addressing it like that. </p>\n\n<pre><code>Sub Test() \nUserForm1.TextBox1.Text = Worksheets(\"Sheet1\").Range(\"A1\").Value\nUserForm1.Show\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 1134099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d18ea9dd360709f8d73f5514abf8538?s=128&d=identicon&r=PG", "display_name": "djdulee", "link": "https://stackoverflow.com/users/1134099/djdulee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 44033772, "answer_count": 1, "score": -1, "last_activity_date": 1495051435, "creation_date": 1495049714, "last_edit_date": 1495050209, "question_id": 44033375, "link": "https://stackoverflow.com/questions/44033375/how-to-find-column-with-matching-value-and-assign-it-to-the-textbox1-in-user-for", "title": "How to find column with matching value and assign it to the textbox1 in user form VBA", "body": "<p>i am having problem loading data from matched cell to current date into the texbox in the user form</p>\n\n<p>I have  </p>\n\n<pre><code>Private Sub NSheet_Click()\n    MoveSheet (1)\n    txtBox2.Text = \"1st: \" &amp; \" 2nd: \" &amp; \" 3rd: \"\nEnd Sub\n</code></pre>\n\n<p>and when next is selected moveSheet will switch to the next sheet in the workbook\nthen i have function </p>\n\n<pre><code>Sub FindtheDay()\n    Dim rFind As Range\n    Dim kolona As Long\n    Dim today As Date\n    today = Date\n\n    With ActiveSheet.Range(\"F2:AJ2\")\n        Set rFind = .Find(What:=today, LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        If Not rFind Is Nothing Then\n            kolona = CStr(rFind.Column)\n            KolLN = kolona\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>that is looking for cell that match to the current date (date only)</p>\n\n<p>then i need that column number as reference to the cell that is 48 row below the one where it was found.</p>\n\n<p>basicli, when Next button is pressed i whant it to switch sheet and then to find column with matching date and then to point to cell Range(ColumNumber &amp; \"50\") and send that value into textbox</p>\n\n<ul>\n<li>also i have three cels ColumnNumber,50,51 and 52 that i whant to put in textbox on user form</li>\n</ul>\n\n<p>All I have tried is giving me error about wrong type</p>\n\n<p>Also I am using public variables because some of them i need i other Sub procedures </p>\n\n<p>Thanks,\nD</p>\n"}, {"tags": ["ms-access", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495049665, "post_id": 44033214, "comment_id": 75093229, "body": "Does <code>me.txtboxnew = recordset.Find &quot;column1=&quot; &amp; me.txtbox.value &amp; &quot; AND &quot; &amp; &quot;column2=&quot; &amp; me.txtbox2.value</code> reproduce the error? Can you supply a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1495049717, "post_id": 44033214, "comment_id": 75093254, "body": "The datatypes of the columns and/or the text box values are important.  Perhaps you need to wrap the values in quotes or single quotes like <code>recordset.Find &quot;column1=&#39;&quot; &amp; me.txtbox.value &amp; &quot;&#39; AND &quot; &amp; &quot;column2=&#39;&quot; &amp; me.txtbox2.value &amp; &quot;&#39;&quot;</code>.  Is this an ADO recordset, as opposed to an DAO recordset which is available by default in Access VBA environment?"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1495049928, "post_id": 44033214, "comment_id": 75093390, "body": "Also, the Find method does not return a valid that you can assign to <code>me.txtboxnew</code>.  Instead, it just repositions the row to the match if found.  See <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/find-method-ado\" rel=\"nofollow noreferrer\">Find Method ADO</a>"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1495050264, "post_id": 44033214, "comment_id": 75093571, "body": "I&#39;m doubting that others have made this work using the syntax you show.  I would review the resources which claim success and see if you are really matching their syntax and/or procedure.  If you still think you are, please provide links for inspection."}, {"owner": {"reputation": 960, "user_id": 6635644, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/408e9851353a2c3e7290b7bec65f6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Azuraith", "link": "https://stackoverflow.com/users/6635644/azuraith"}, "edited": false, "score": 0, "creation_date": 1495050808, "post_id": 44033214, "comment_id": 75093894, "body": "i&#39;ve edited the original post to contain my exact code that reproduces the error.  This is an ADODB recordset and not a DAO. Sorry for any confusion i messed up my original posts syntax. It should be corrected to exactly what i have."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1495056697, "post_id": 44033214, "comment_id": 75096867, "body": "It is easy to assume, but are both [ID] and [Part_ID] numeric... integers?  Just for kicks, perhaps try wrapping each expression in parenthesis like <code>traceRecordset.Find &quot;([PART_ID]=&quot; &amp; Me.txtSection.Value &amp; &quot;) AND (&quot; &amp; &quot;[ID]= &quot; &amp; Me.txtCopy.Value &amp; &quot;)&quot;</code>.  Also, inspect the full criteria string with <code>Debug.Print &quot;[PART_ID]=&quot; &amp; Me.txtSection.Value &amp; &quot; AND &quot; &amp; &quot;[ID]= &quot; &amp; Me.txtCopy.Value</code>."}], "answers": [{"comments": [{"owner": {"reputation": 960, "user_id": 6635644, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/408e9851353a2c3e7290b7bec65f6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Azuraith", "link": "https://stackoverflow.com/users/6635644/azuraith"}, "edited": false, "score": 0, "creation_date": 1495108818, "post_id": 44037462, "comment_id": 75119594, "body": "Oh ok, was not aware of this. Thank you for your help. I don&#39;t think it will be a big change to switch from ADO to DAO. I will do that and see if it works for me!"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "reply_to_user": {"reputation": 960, "user_id": 6635644, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/408e9851353a2c3e7290b7bec65f6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Azuraith", "link": "https://stackoverflow.com/users/6635644/azuraith"}, "edited": false, "score": 0, "creation_date": 1495298304, "post_id": 44037462, "comment_id": 75198529, "body": "I was also not immediately aware of this, but I did my own research... and it did not take long to discover.  Take what you get in the comments seriously and review the information... follow the links and read.  If you&#39;re having a problem with a particular object or method (i.e. function), then go to the documentation and look at the details."}], "tags": [], "owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "is_accepted": true, "score": 2, "last_activity_date": 1495074507, "last_edit_date": 1495074507, "creation_date": 1495073514, "answer_id": 44037462, "question_id": 44033214, "link": "https://stackoverflow.com/questions/44033214/runtime-error-3001-when-using-ado-recordset-find-with-more-than-one-criteria/44037462#44037462", "title": "Runtime error 3001 when using ADO Recordset.Find with more than one criteria", "body": "<p>According to the <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/find-method-ado\" rel=\"nofollow noreferrer\">ADO Recordset.Find documentation</a>,</p>\n\n<blockquote>\n  <p><strong>Only a single-column name may be specified in criteria. This method\n  does not support multi-column searches.</strong></p>\n  \n  <p>...</p>\n  \n  <p><em>Criteria</em>:\n  A String value that contains a statement specifying the column name, comparison operator, and value to use in the search.</p>\n</blockquote>\n\n<hr>\n\n<p>Since you are already writing VBA within an Access project, DAO works just as well and as of Access 2016, the DAO Recordset type is still the default used by Forms and QueryDef objects.  DAO recordsets support FindFirst, FindNext, FindPrevious and FindLast all supporting multi-column queries.  This single feature might not justify switching from ADO, but if all you're doing is opening, searching and enumerating recordset rows, ADO doesn't provide any significant benefit.</p>\n"}], "owner": {"reputation": 960, "user_id": 6635644, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/408e9851353a2c3e7290b7bec65f6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Azuraith", "link": "https://stackoverflow.com/users/6635644/azuraith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1546, "favorite_count": 0, "accepted_answer_id": 44037462, "answer_count": 1, "score": 0, "last_activity_date": 1495079510, "creation_date": 1495049089, "last_edit_date": 1495079510, "question_id": 44033214, "link": "https://stackoverflow.com/questions/44033214/runtime-error-3001-when-using-ado-recordset-find-with-more-than-one-criteria", "title": "Runtime error 3001 when using ADO Recordset.Find with more than one criteria", "body": "<p>I am trying to use the <code>recordset.Find \"name =\" &amp; me.txtbox.value</code>. To find a particular record/row. I can do this quite easily if i do it exactly as above searching only with 1 variable.</p>\n\n<p>I tried to do the follow as i found other have done this online. <code>traceRecordset.Find \"[PART_ID]=\" &amp; Me.txtSection.Value &amp; \" AND \" &amp; \"[ID]= \" &amp; Me.txtCopy.Value</code></p>\n\n<p>this is the exact line of code that follows, the error does not throw on this line\n<code>Me.txtLastscrap = traceRecordset.Fields(\"APROPERTY_2\")</code></p>\n\n<p>This would give me more flexibility when populating a textbox with a particular value. It seems others have attempted this with no issues. However, i receive the following error.</p>\n\n<blockquote>\n  <p>Arguments are of the wrong type, are out of acceptable\n  range or are in conflict with one another</p>\n</blockquote>\n\n<p>Any thoughts?</p>\n\n<p>NOTE: if i do <code>traceRecordset.Find \"[PART_ID]=\" &amp; Me.txtSection.Value</code> it works and it also works with <code>traceRecordset.Find \"[ID]= \" &amp; Me.txtCopy.Value</code> so individually they function correctly. Only when used together does it throw an error. If the types were the issue one of them would not work when used independently correct?</p>\n\n<p>NOTE2: Here is my adodb connection line. Not sure if this has any effect</p>\n\n<p><code>Dim dbTrace As ADODB.Connection\nDim traceRecordset As New ADODB.Recordset</code></p>\n\n<p><code>Set dbTrace = CurrentProject.Connection\n        traceRecordset.Open \"Select * from TRACE\", _\n            dbTrace, adOpenKeyset, adLockOptimistic, adCmdText</code></p>\n"}, {"tags": ["excel", "loops", "vba"], "comments": [{"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1495075535, "post_id": 44033190, "comment_id": 75101922, "body": "<code>For Each col In Target.Columns &#39;---I added this but not working, </code> - what do you mean it&#39;s not working? Is it throwing an error?"}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1495075945, "post_id": 44033190, "comment_id": 75102025, "body": "<code>myCol = col.Columns.Offset(3)</code>- I don&#39;t see myCol defined anywhere. col is already a column, why do you reference col.Columns? And what are you trying to achieve by this statement?"}, {"owner": {"reputation": 5, "user_id": 7998657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679b668bfd894894c6c4e45df79422f0?s=128&d=identicon&r=PG&f=1", "display_name": "Kristine Vines", "link": "https://stackoverflow.com/users/7998657/kristine-vines"}, "reply_to_user": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1495076860, "post_id": 44033190, "comment_id": 75102220, "body": "Thanks for feedback. The outcome would be something like if I enter a value in cell A5 then the fill this cell will also work in the column not just in row. Currently, if I add a value in cell A5, the fill this cell comment is populate in C5.. I need to loop until cell BV5. BTW, I put a column definition in hope that it will work if I declare it."}], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "is_accepted": false, "score": 0, "last_activity_date": 1495077992, "creation_date": 1495077992, "answer_id": 44038090, "question_id": 44033190, "link": "https://stackoverflow.com/questions/44033190/column-looping-in-worksheet-change-event/44038090#44038090", "title": "Column looping in Worksheet Change Event", "body": "<p>This will copy the value of the changed cell into C5:BV5 on the Worksheet_change event:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Target.Copy\n    Range(\"C5:BV5\").PasteSpecial\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "is_accepted": true, "score": 0, "last_activity_date": 1495098764, "creation_date": 1495098764, "answer_id": 44043458, "question_id": 44033190, "link": "https://stackoverflow.com/questions/44033190/column-looping-in-worksheet-change-event/44043458#44043458", "title": "Column looping in Worksheet Change Event", "body": "<p>input this to your worksheet module. Note that there are global variables declared</p>\n\n<pre><code>Private previousValue As String\nPrivate previousRange As Range\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim KeyIntersect1 As Range\nDim KeyIntersect2 As Range\nDim eachCell1 As Range\nDim eachCell2 As Range\nDim strHolder As String\n\nApplication.EnableEvents = False\nSet KeyIntersect1 = Intersect(Target, Range(\"A5:A8\"))   '&lt;~ get intersect\nIf Not KeyIntersect1 Is Nothing Then                    '&lt;~ check if change happened here\n  For Each eachCell1 In KeyIntersect1                   '&lt;~ loop through. in case copy/pasted\n    strHolder = eachCell1.Value\n    eachCell1.Value = strHolder\n    If eachCell1.Value = \"A\" Or eachCell1.Value = \"C\" Then  '&lt;~ check the new values\n      Set KeyIntersect2 = ActiveSheet.Range(eachCell1.Offset(0, 2), eachCell1.Offset(0, 73))\n      For Each eachCell2 In KeyIntersect2               '&lt;~ loop through columns\n        eachCell2.Value = \"Fill in this cell\"           '&lt;~ fill them with values\n      Next\n    End If\n  Next\nEnd If\nApplication.EnableEvents = True\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim eachCell As Range\nDim KeyIntersect As Range\n\n    If previousRange.Value = \"\" Then        '&lt;~checks if the previous range is blank\n      previousRange.Value = previousValue   '&lt;~if so gives previous value\n    End If\n\n    If Target.Value = \"Fill in this cell\" Then  '&lt;~if the target is default value\n      previousValue = \"Fill in this cell\"       '&lt;~give this to value holder\n      Set previousRange = Target                '&lt;~and set it to previous range\n                                                '&lt;~if there is no change it will be checked later\n      Target.Value = \"\"                         '&lt;~cleans this cell.ready for input\n    End If\nSet KeyIntersect = Intersect(Target, Range(\"C5:C8\"))\nIf Not KeyIntersect Is Nothing Then\n  For Each eachCell In KeyIntersect\n    With eachCell\n      With .Validation\n        .Delete\n        .Add Type:=xlValidateList, _\n                     AlertStyle:=xlValidAlertStop, _\n                     Operator:=xlBetween, _\n                     Formula1:=\"=$J$1:$J$4\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n      End With\n    End With\n  Next\nEnd If\nEnd Sub\n</code></pre>\n\n<p>if there is a valid value in the previous cell. it will not give the \"Fill in this cell\". i am hoping that this will help.</p>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 7998657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679b668bfd894894c6c4e45df79422f0?s=128&d=identicon&r=PG&f=1", "display_name": "Kristine Vines", "link": "https://stackoverflow.com/users/7998657/kristine-vines"}, "is_accepted": false, "score": 0, "last_activity_date": 1495117375, "creation_date": 1495117375, "answer_id": 44050465, "question_id": 44033190, "link": "https://stackoverflow.com/questions/44033190/column-looping-in-worksheet-change-event/44050465#44050465", "title": "Column looping in Worksheet Change Event", "body": "<p>I have able to also create some solution for this. </p>\n\n<p>Private Sub Worksheet_Change(ByVal Target As Range)\nDim ws As Worksheet\nDim cel As Range\nDim myRow As Long</p>\n\n<p>Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    'This subroutine fires when a cell value changes in this worksheet.\n   Set KeyCells = Range(\"A5:A8\")\n    'did someone change something specifically in cell A5?\n    If Not Intersect(Target, KeyCells) Is Nothing Then\n        For Each cel In Target.Rows ' do the next steps for each cell that was changed\n        myRow = cel.Row\n          For columnid = 4 to 8\n        'Is the value A or C?\n        If Target.Value = \"A\" Or Target.Value = \"C\" Then</p>\n\n<pre><code>             ws.cells(myRow, columnID).Validation.Delete\n        'and change the value of C5 to \"Fill in this cell\"\n            ws.cells(myRow, columnID).Value = \"Fill in this cell\"\n</code></pre>\n\n<p>Next columnID\n        End If\n        Application.EnableEvents = True\n    Next cel\n    End If</p>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 5, "user_id": 7998657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679b668bfd894894c6c4e45df79422f0?s=128&d=identicon&r=PG&f=1", "display_name": "Kristine Vines", "link": "https://stackoverflow.com/users/7998657/kristine-vines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 44043458, "answer_count": 3, "score": 0, "last_activity_date": 1495117375, "creation_date": 1495049016, "last_edit_date": 1531164843, "question_id": 44033190, "link": "https://stackoverflow.com/questions/44033190/column-looping-in-worksheet-change-event", "title": "Column looping in Worksheet Change Event", "body": "<p>I am a beginner with VBA and would like to know how loop columns in worksheet event. Below are the scenario.</p>\n\n<p>I want to populate the data validation and \"Fill this cell\" comment not just in row when I select the trigger cell (target). Below is the code I tried to update but really hopeless on making it work. </p>\n\n<p>Thank you so much for all your help. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim ws As Worksheet\nDim cel As Range\nDim myRow As Long\n\n\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\n    'This subroutine fires when a cell value changes in this worksheet.\n   Set KeyCells = Range(\"A5:A8\")\n    'did someone change something specifically in cell A5?\n    If Not Intersect(Target, KeyCells) Is Nothing Then\n        For Each cel In Target.Rows ' do the next steps for each cell that was changed\n        myRow = cel.Row\n        'Is the value A or C?\n        If Target.Value = \"A\" Or Target.Value = \"C\" Then\n            For Each col In Target.Columns '---I added this but not working, \n                myCol = col.Columns.Offset(3)\n                ws.Range(\"C\" &amp; myCol).Validation.Delete '---I added this but not working\n            'Remove any data validation for this cell:\n                ws.Range(\"C\" &amp; myRow).Validation.Delete\n            'and change the value of C5 to \"Fill in this cell\"\n                ws.Range(\"C\" &amp; myRow).Value = \"Fill in this cell\"\n                ws.Range(\"C\" &amp; myCol).Value = \"Fill in this cell\" '---I added this but not working\n            Next col '---I added this but not working\n        End If\n        Application.EnableEvents = True\n    Next cel\n    End If\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n\nDim ws As Worksheet\nDim cel As Range\nDim myRow As Long\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\n    'This subroutine fires when a user selects a different cell or range.\n    'So... it fires ALL The time so the next line is super important.\n    Set KeyCells2 = Range(\"C5:C8\")\n    'Did someone change selection specifically to cell C5?\n    If Not Intersect(Target, KeyCells2) Is Nothing Then\n        For Each cel In Target ' do the next steps for each cell that was changed\n        myRow = cel.Row\n        'Is the value currently \"Fill in this cell\"?\n        If ws.Range(\"C\" &amp; myRow).Value = \"Fill in this cell\" Then\n            'Empty the cell\n            ws.Range(\"C\" &amp; myRow).Value = \"\"\n            'Add data validation to some list somewhere\n            With ws.Range(\"C\" &amp; myRow).Validation\n                .Delete\n                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n                xlBetween, Formula1:=\"=$J$1:$J$4\"  'This the range that the list exists in\n                .IgnoreBlank = True\n                .InCellDropdown = True\n                .InputTitle = \"\"\n                .ErrorTitle = \"\"\n                .InputMessage = \"\"\n                .ErrorMessage = \"\"\n                .ShowInput = True\n                .ShowError = True\n            End With\n        End If\n        Next cel\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 1, "creation_date": 1495048357, "post_id": 44032924, "comment_id": 75092522, "body": "<a href=\"http://stackoverflow.com/questions/1083603/vba-using-withevents-on-userforms\" title=\"vba using withevents on userforms\">stackoverflow.com/questions/1083603/&hellip;</a> maybe that&#39;ll help"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1495050840, "post_id": 44032924, "comment_id": 75093914, "body": "@GibralterTop - how is your link related to the OP&#39;s question?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495050894, "post_id": 44032924, "comment_id": 75093945, "body": "You can use <code>Find()</code> or <code>Vlookup</code> to locate the selected value on the worksheet, then take the value from the required column on the same row."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495051849, "post_id": 44032924, "comment_id": 75094568, "body": "@TimWilliams the question is &quot;I&#39;m heading down the wrong path?&quot;. Just posting the link in case it&#39;ll help, as I said. Maybe the event is never firing? Who knows. Maybe there&#39;s syntax errors in the event register code. I don&#39;t think anyone can know what this question is asking and be certain."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495052717, "post_id": 44032924, "comment_id": 75095019, "body": "There is some confusion.  OP, please define what RejectTitleNm is."}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1495116315, "post_id": 44032924, "comment_id": 75125280, "body": "Sorry guys, RejectTitleNm is the name of ComboBox1"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1495082155, "post_id": 44034822, "comment_id": 75103528, "body": "Hi Tim, srry about that. RejectTitleNm is the name of my ComboBox1"}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1495135821, "post_id": 44034822, "comment_id": 75137627, "body": "Thank you! Also, do I need to change the name of f to the name cell on Worksheet?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1495136586, "post_id": 44034822, "comment_id": 75138039, "body": "<code>f</code> is just the name of variable - it doesn&#39;t make any difference what it&#39;s called."}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1495141432, "post_id": 44034822, "comment_id": 75140443, "body": "Ok, this still isn&#39;t working. Am I suppose to fill in a blank somewhere?"}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1495141579, "post_id": 44034822, "comment_id": 75140516, "body": "Also, my column B is named ProcessProcedures, but that doesn&#39;t see to work either?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1495142156, "post_id": 44034822, "comment_id": 75140754, "body": "&quot;not working&quot; is not a very useful description of what&#39;s happening when you try to run this.  What exactly are you seeing when you make a selection from the combo box?"}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1495142911, "post_id": 44034822, "comment_id": 75141063, "body": "Sorry, Nothing happens. I select an item in the combo box and nothing shows in the TextBox1"}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1495143107, "post_id": 44034822, "comment_id": 75141148, "body": "I apologize my TextBox1 visible setting was set to False. It works perfectly now! Thank you so much, and sorry again!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1495055379, "creation_date": 1495055379, "answer_id": 44034822, "question_id": 44032924, "link": "https://stackoverflow.com/questions/44032924/show-value-in-textbox1-from-worksheet-depending-on-combobox1-selection/44034822#44034822", "title": "Show value in Textbox1 from Worksheet depending on ComboBox1 selection", "body": "<p>Something like this:</p>\n\n<pre><code>Private Sub RejectTitleNm_Change()\n\n    Dim f As Range, v\n\n    v = Me.RejectTitleNm.Value\n    'find the selected value in the source range\n    Set f = Range(\"RejectTitle\").Find(v, lookat:=xlWhole)\n\n    Me.TextBox1.Text = \"\"\n    If Not f Is Nothing Then\n        'got a match: get value from ColB on same row\n        Me.TextBox1.Text = f.EntireRow.Cells(, \"B\").Value\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495055379, "creation_date": 1495047866, "last_edit_date": 1495048152, "question_id": 44032924, "link": "https://stackoverflow.com/questions/44032924/show-value-in-textbox1-from-worksheet-depending-on-combobox1-selection", "title": "Show value in Textbox1 from Worksheet depending on ComboBox1 selection", "body": "<p>Wondering if you could help with adding a value from my Worksheet to my TextBox1 depending on what ComboBox1 item is selected.</p>\n\n<p>So far I have this for my ComboBox1 to pull a list from my Worksheet</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n' *** Load the companies into the delivering firm combo box ***\nFor Each cell In Range(\"RejectTitle\")\n    If cell &lt;&gt; \"\" Then\n        Me.RejectTitleNm.AddItem cell\n    End If\nNext cell\nEnd Sub\n</code></pre>\n\n<p>Now I am trying to have my UserForm show a value from Worksheet into TextBox1 depending on ComboBox but I believe I'm heading down the wrong path?</p>\n\n<pre><code>Private Sub RejectTitleNm_Change()\n    Me.TextBox1.Text = Worksheets(\"Sheet1\").Range(\"E5\").Value\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1495047314, "post_id": 44032516, "comment_id": 75091950, "body": "Ummm - So what is the actual question? You&#39;d be better served showing us real code you have written and where it&#39;s not working rather than telling us what you are attempting in psuedo-code with no real question at hand (other than implicitly saying, I can&#39;t get it to work). Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a> for more information."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1495047916, "post_id": 44032516, "comment_id": 75092311, "body": "There are already functions to calculate average/min/max.  Why not use those and leave the data where it is on the sheet?"}, {"owner": {"reputation": 1, "user_id": 7999167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ed0dff0ebd55846b9f9e29ae8aee4b?s=128&d=identicon&r=PG&f=1", "display_name": "danielr85", "link": "https://stackoverflow.com/users/7999167/danielr85"}, "edited": false, "score": 0, "creation_date": 1495048268, "post_id": 44032516, "comment_id": 75092477, "body": "It&#39;s a &quot;how can I do this&quot; sort of thing with the situation I am in. I want to be able to send a class type to a function instead of having to copy any paste a lot of code for each. I can post the entire code, I was just trying to simplify it here to show what I was trying to do. I was just trying to utilize code that I already wrote without having to go a different direction."}, {"owner": {"reputation": 1, "user_id": 7999167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ed0dff0ebd55846b9f9e29ae8aee4b?s=128&d=identicon&r=PG&f=1", "display_name": "danielr85", "link": "https://stackoverflow.com/users/7999167/danielr85"}, "edited": false, "score": 0, "creation_date": 1495048463, "post_id": 44032516, "comment_id": 75092566, "body": "If I was writing this in .NET I would create a List (Of Type) and use linq to get these values. I am guessing there is no similar way to do this in vba."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1495054814, "post_id": 44032516, "comment_id": 75096009, "body": "Not sure regarding VBA functionality you are asking, but I&#39;m pretty sure the same result could be achieved using ADO with SQL aggregate functions."}], "owner": {"reputation": 1, "user_id": 7999167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ed0dff0ebd55846b9f9e29ae8aee4b?s=128&d=identicon&r=PG&f=1", "display_name": "danielr85", "link": "https://stackoverflow.com/users/7999167/danielr85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495046737, "creation_date": 1495046300, "last_edit_date": 1531164843, "question_id": 44032516, "link": "https://stackoverflow.com/questions/44032516/averaging-numerous-values-in-a-class", "title": "Averaging numerous values in a class", "body": "<p>I have a class with a lot of parameters as it takes in all the columns in Excel, since this is the first step I usually do when building a macro. Then I started to think about how to actually accomplish what I'm trying to do and I think I just wasted a couple of hours of coding. </p>\n\n<p>What I am trying to do is average each of the parameters inside the class as well as trying to get minimum and maximum values. There are about 100000 rows in these excel files. </p>\n\n<p>My plan was to put everything into a collection and then I was thinking there was going to be some sort of averaging function or a min and max function for the collection parameter, or a way to send an array to a function that can calculate min or max.</p>\n\n<p>What would be ideal:</p>\n\n<pre><code>Dim collectionOfRecords as new collection\n\nfor each row in sheet.rows\n    Dim r as New RmmRecord\n\n    call r.PopulateClass(row)\n    collectionOfRecords.add r\nnext row\n</code></pre>\n\n<p>Then get the average from the collection somehow like this:</p>\n\n<pre><code>dim parameter1Average as double\nparameter1Average = collectionOfRecords.Parameter1.Average '(ha, I wish)\n</code></pre>\n\n<p>OR:</p>\n\n<pre><code>parameter1average = GetAverageFromCollection(collectionOfRecords, Parameter1)\n\n\nPublic Function GetAverageFromCollection(records as Collection, parameterToAverage as something??)\n    for each record in records\n        sum = record.parameterToAverage + sum\n    next record\n    GetAverageFromCollection = sum / records.count\nend function\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "reference"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1495042940, "post_id": 44031495, "comment_id": 75089618, "body": "<code>Cells</code> used like this, implicitly refers to whatever the <code>ActiveSheet</code> is. Qualify it with a <code>Worksheet</code> object instance before you run into other issues."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "edited": false, "score": 0, "creation_date": 1495047467, "post_id": 44031596, "comment_id": 75092030, "body": "I tried changing as .formula What happens now is instead of referencing the cell like  =&#39;[210303 to 2017 Yearend NEW.xlsm]210303 2017&#39;!$I$199  which is what i want, it now pulls =A1*I199 which is a formula in that cell"}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1495042906, "creation_date": 1495042906, "answer_id": 44031596, "question_id": 44031495, "link": "https://stackoverflow.com/questions/44031495/how-to-reference-a-cell-through-vba/44031596#44031596", "title": "how to reference a cell through vba", "body": "<p>You just need to reference the <code>.Formula</code> of the cell, instead of the default, which is <code>.Value</code>.    </p>\n\n<pre><code>Do Until Cells(i, 9) = \"Net Income\"\n If Cells(i, 9) = \"BONDS INTEREST EARNED\" Then\n    Bonds_IE = Cells(i + 1, 9).Formula\n\nCells(j - 5, 4).Formula = Bonds_IE\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "edited": false, "score": 0, "creation_date": 1495047341, "post_id": 44031745, "comment_id": 75091969, "body": "I tried changing as .formula What happens now is instead of referencing the cell like  =&#39;[210303 to 2017 Yearend NEW.xlsm]210303 2017&#39;!$I$199  which is what i want, it now pulls =A1*I199 which is a formula in that cell"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "edited": false, "score": 0, "creation_date": 1495047812, "post_id": 44031745, "comment_id": 75092250, "body": "I&#39;m sorry, what you&#39;re looking for is not exactly clear (where&#39;s that multiplication coming from? it&#39;s nowhere in your post). <code>.Formula</code> gets/sets a string that represents the formula that&#39;s used to calculate a range&#39;s <code>.Value</code>. You need to build that string to make it whatever formula you need to have. Or did you mean to make a cell&#39;s <i>value</i> be another cell&#39;s <i>formula</i>?"}, {"owner": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "edited": false, "score": 0, "creation_date": 1495048310, "post_id": 44031745, "comment_id": 75092491, "body": "I have two cells. Cell A1 and Cell B1 which are in two different workbooks. I want cell A1 to be &quot;=CellB1&quot;. I just want to refernece cell A to Cell B. Cell B will have its own calculation in that worksheet. Thanks for your help!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "edited": false, "score": 1, "creation_date": 1495048477, "post_id": 44031745, "comment_id": 75092577, "body": "Then you want to &quot;build&quot; CellA1&#39;s <code>Formula</code> string using <code>=</code> followed by CellB1&#39;s <code>Parent.Parent.FullName</code> (the workbook&#39;s path) enclosed in square brackets, followed by <code>Parent.Name</code> (the worksheet&#39;s name) enclosed in single quotes, followed by an exclamation mark, followed by CellB1&#39;s <code>Address</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1495050590, "post_id": 44031745, "comment_id": 75093752, "body": "^^ But simpler to use <code>Address(External:=True)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495050636, "post_id": 44031745, "comment_id": 75093789, "body": "@YowE3K <i>facepalm</i> yes, yes absolutely!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1495043477, "last_edit_date": 1495542882, "creation_date": 1495043477, "answer_id": 44031745, "question_id": 44031495, "link": "https://stackoverflow.com/questions/44031495/how-to-reference-a-cell-through-vba/44031745#44031745", "title": "how to reference a cell through vba", "body": "<p>VBA code does a lot of things implicitly. If we make everything explicit, the problem becomes clearer:</p>\n\n<pre><code>Do Until CStr(ActiveSheet.Cells(i, 9).Value) = \"Net Income\"\n If CStr(ActiveSheet.Cells(i, 9).Value) = \"BONDS INTEREST EARNED\" Then\n    Bonds_IE = CStr(ActiveSheet.Cells(i + 1, 9).Value)\n</code></pre>\n\n<p>Note:</p>\n\n<ul>\n<li>Implicit string conversions, made explicit with <code>CStr</code>. These <em>will</em> blow up with a <em>type mismatch</em> error if the cell contains an error value. You may want to verify whether <code>IsError</code> returns <code>False</code> given a cell's value, before doing anything with that value.</li>\n<li><p>Implicit <code>ActiveSheet</code> references. These <em>will</em> blow up with run-time error 1004 if you use them against a qualified <code>Range</code> call that isn't referring to the active sheet, e.g.:</p>\n\n<pre><code>Sheet12.Range(Cells(i, 1), Cells(i + 1, 1)) = 42 'Sheet12 isn't active\n</code></pre></li>\n<li><p>Implicit <em>default member</em> calls. <code>Cells</code> returns a <code>Range</code> object; its default member points to its <code>Value</code>. That's why you can do <code>Cells(j - 5, 4) = foo</code> and still have compilable code. Making member calls explicit helps better understand what's <em>really</em> going on when you read the code.</p></li>\n</ul>\n\n<p><a href=\"https://stackoverflow.com/a/44031596/1188513\">As already mentioned</a>, <code>Range.Value</code> gets/sets the range's <em>value</em>. What you want is its <code>.Formula</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1495050919, "last_edit_date": 1495050919, "creation_date": 1495050507, "answer_id": 44033593, "question_id": 44031495, "link": "https://stackoverflow.com/questions/44031495/how-to-reference-a-cell-through-vba/44033593#44033593", "title": "how to reference a cell through vba", "body": "<p>Try using the source cell's <code>Address</code> to create a <code>Formula</code>:</p>\n\n<pre><code>Dim Bonds_IE As String\nDo Until Cells(i, 9) = \"Net Income\"\n    If Cells(i, 9) = \"BONDS INTEREST EARNED\" Then\n        Bonds_IE = \"=\" &amp; Cells(i + 1, 9).Address(RowAbsolute:=True, _\n                                                 ColumnAbsolute:=True, _\n                                                 External:=True)\n'...\n'...\nCells(j - 5, 4).Formula = Bonds_IE\n</code></pre>\n\n<p>One trick with this though ... <code>Address(External:=True)</code> will not include the <strong>path</strong> to the original workbook, so the resultant string needs to be applied as a <code>Formula</code> to the other cell <strong>before</strong> the original workbook is closed.  That way, when the original workbook is closed, Excel will automatically update the formula to include the path as well.</p>\n"}], "owner": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6867, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1495050919, "creation_date": 1495042517, "question_id": 44031495, "link": "https://stackoverflow.com/questions/44031495/how-to-reference-a-cell-through-vba", "title": "how to reference a cell through vba", "body": "<p>I just wrote some codes which pick up values from one workbook,worksheet and paste them in another workbook, worksheet. Currently it pastes in as values.\nHere are some parts of my code:</p>\n\n<pre><code>Do Until Cells(i, 9) = \"Net Income\"\n If Cells(i, 9) = \"BONDS INTEREST EARNED\" Then\n    Bonds_IE = Cells(i + 1, 9)\n</code></pre>\n\n<p>and then with another book activated,</p>\n\n<pre><code>Cells(j - 5, 4) = Bonds_IE\n</code></pre>\n\n<p>I want this to show up as a reference to where it pulled the information from.\nfor Ex:   K:\\etc\\etc\\etc[etc.xlsx] etc!$A$1</p>\n\n<p>I feel like this should be super simple but I am not sure..\nPlease help :(\nThanks!!</p>\n"}, {"tags": ["vba", "templates", "userform"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1495046375, "post_id": 44031473, "comment_id": 75091499, "body": "If your code supposed to work after clicking CommandButton1, you supposed to call template sub. Call template after end if, and exit sub before end if."}, {"owner": {"reputation": 15, "user_id": 7495840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4da8758ded96678940878c8ed8b4186f?s=128&d=identicon&r=PG&f=1", "display_name": "folkstorm", "link": "https://stackoverflow.com/users/7495840/folkstorm"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1495047751, "post_id": 44031473, "comment_id": 75092218, "body": "I have tried add sub template to CommandButton1_Click. it stops on myItem.Display"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1495048259, "post_id": 44031473, "comment_id": 75092470, "body": "What do you mean it stops? Does it return an error? Can you be more specific?"}, {"owner": {"reputation": 15, "user_id": 7495840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4da8758ded96678940878c8ed8b4186f?s=128&d=identicon&r=PG&f=1", "display_name": "folkstorm", "link": "https://stackoverflow.com/users/7495840/folkstorm"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1495048588, "post_id": 44031473, "comment_id": 75092622, "body": "Yes it does, when I debugging it refers to line &quot;myItem.Display&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7495840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4da8758ded96678940878c8ed8b4186f?s=128&d=identicon&r=PG&f=1", "display_name": "folkstorm", "link": "https://stackoverflow.com/users/7495840/folkstorm"}, "edited": false, "score": 0, "creation_date": 1495054382, "post_id": 44034132, "comment_id": 75095830, "body": "Thank you for your reply and sorry for not being specific, I&#39;m quite a newbie. I will apply your suggestions first thing in a morning as on current pc I don&#39;t have outlook."}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": true, "score": 1, "last_activity_date": 1495052517, "creation_date": 1495052517, "answer_id": 44034132, "question_id": 44031473, "link": "https://stackoverflow.com/questions/44031473/apply-outlook-userform-values-to-email-template/44034132#44034132", "title": "Apply Outlook userform values to email template", "body": "<p>As I stated in my comment, you should call template sub in your CommandButton1_Click Sub. And also you should exit sub when your your condition is true because you wouldn't want to run your code when any of your textbox or combobox is empty. It should look like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nIf TextBox1.Text = \"\" Or TextBox2.Text = \"\" Or TextBox3.Text = \"\" Or ComboBox1 = \"\" Or ComboBox2 = \"\" Or ComboBox3 = \"\" Then\n    MsgBox (\"Fill in all Boxes\")\n    Exit Sub\nEnd If\n    template\nEnd Sub\n</code></pre>\n\n<p>Secondly, when something goes wrong, you will be informed about it with an error message, usually with an error number and some description. I had to try your code to get what this error is. </p>\n\n<p>The error says: \"Outlook can't do this because a dialog box is open. Please close it and try again.\" If you had indicated this in your question, you would have an instant answer that says \"Unload Me\". Next time when you post a question, you should indicate the error as well. </p>\n\n<p>You cannot make it run because you first need to close the userform, in order to open the template email. So insert <code>Unload Me</code> in your code like this:</p>\n\n<pre><code>Set myItem = Application.CreateItemFromTemplate(\"C:\\test.oft\")\nstrHTML = myItem.HTMLBody\n\nUnload Me\nmyItem.Display\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7495840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4da8758ded96678940878c8ed8b4186f?s=128&d=identicon&r=PG&f=1", "display_name": "folkstorm", "link": "https://stackoverflow.com/users/7495840/folkstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 0, "accepted_answer_id": 44034132, "answer_count": 1, "score": 0, "last_activity_date": 1537282927, "creation_date": 1495042456, "last_edit_date": 1529180573, "question_id": 44031473, "link": "https://stackoverflow.com/questions/44031473/apply-outlook-userform-values-to-email-template", "title": "Apply Outlook userform values to email template", "body": "<p>I want to select specific values in a userform and based on selection reformat an email template and replace text or just open an empty email and send keys/text to email title, body etc. (values like name, surname etc.)</p>\n\n<p>The userform.</p>\n\n<p><a href=\"https://i.stack.imgur.com/H7Oby.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H7Oby.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub TextBox1_Change()\n\nEnd Sub\n\nPrivate Sub TextBox2_Change()\n\nEnd Sub\n\nPrivate Sub TextBox3_Change()\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nWith ComboBox1\n .AddItem \"Form1\"\n .AddItem \"Form2\"\n\nEnd With\n\nWith ComboBox2\n .AddItem \"Mr\"\n .AddItem \"Miss\"\n .AddItem \"Mrs\"\n .AddItem \"Ms\"\n\nEnd With\n\n  With ComboBox3\n .AddItem \"You\"\n .AddItem \"He\"\n .AddItem \"She\"\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Execution button code.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nIf TextBox1.Text = \"\" Or TextBox2.Text = \"\" Or TextBox3.Text = \"\" Or _\n  ComboBox1 = \"\" Or ComboBox2 = \"\" Or ComboBox3 = \"\" Then\n    MsgBox (\"Fill in all Boxes\")\n\nEnd If\nEnd Sub\n\nSub template()\n\nDim myItem As Outlook.MailItem\nDim strContact As String\nDim strHTML As String\n\nDim typeofapplication As String\nDim title As String\nDim name As String\nDim surename As String\nDim expierydate As String\nDim gender As String\n\ntypeofapplication = ComboBox1.Value\ntitle = ComBox2.Value\nname = TextBox1_Change.Value\nsurename = TextBox2_Change.Value\nexpierydate = TextBox3_Change.Value\ngender = ComBox3.Value\n\nSet myItem = Application.CreateItemFromTemplate(\"C:\\test.oft\")\nstrHTML = myItem.HTMLBody\n\nmyItem.Display\nEnd Sub\n</code></pre>\n\n<p>Code works till \"Fill in all Boxes\". After pressing the OK button it stops on <code>myItem.Display</code>.</p>\n\n<p>Opening the template works if I do not use the userform.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1495049172, "post_id": 44031299, "comment_id": 75092962, "body": "Congratulations on finding the problem.  In your case it turns out to be only a debugging issue, an oversight.  (Your question code doesn&#39;t even show the portion that you fixed... with a call to DoCmd.OpenReport)  Your query is also rather long and so the question will not likely contribute to helping anyone in the future.  In such a case, you might consider deleting the entire question, or perhaps only commenting that you fixed it rather than an answer.  I am aware that you are limited right now as a new user, so this is for future reference. By all means, please return with new questions!"}, {"owner": {"reputation": 1, "user_id": 6262865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a041d7c14d5d45cd5e93b7b5a4d3081a?s=128&d=identicon&r=PG&f=1", "display_name": "JacksonD", "link": "https://stackoverflow.com/users/6262865/jacksond"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1496349628, "post_id": 44031299, "comment_id": 75639219, "body": "I know, since it is ancient code 15+ years old, i got it working the way it was written, then i converted it to a view to limit the length of the call."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6262865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a041d7c14d5d45cd5e93b7b5a4d3081a?s=128&d=identicon&r=PG&f=1", "display_name": "JacksonD", "link": "https://stackoverflow.com/users/6262865/jacksond"}, "is_accepted": false, "score": 0, "last_activity_date": 1495043626, "creation_date": 1495043626, "answer_id": 44031784, "question_id": 44031299, "link": "https://stackoverflow.com/questions/44031299/vba-recordset-says-there-is-data-but-me-recordsource-says-it-is-empty/44031784#44031784", "title": "VBA Recordset says there is data, but me.recordsource says it is empty", "body": "<p>I found the issue. Since i was no longer setting the SQL command to the RecordSource in the Report properties directly, i forgot to remove the Criteria portion from the call to the DoCmd.OpenReport gstrDocName, acViewPreview. It was trying to add on a WHERE clause to the SQL command.</p>\n"}], "owner": {"reputation": 1, "user_id": 6262865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a041d7c14d5d45cd5e93b7b5a4d3081a?s=128&d=identicon&r=PG&f=1", "display_name": "JacksonD", "link": "https://stackoverflow.com/users/6262865/jacksond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495043626, "creation_date": 1495041897, "question_id": 44031299, "link": "https://stackoverflow.com/questions/44031299/vba-recordset-says-there-is-data-but-me-recordsource-says-it-is-empty", "title": "VBA Recordset says there is data, but me.recordsource says it is empty", "body": "<p>Currently i am working on a new report for an access application. The SQL command I am using to fill the RecordSource for the report pulls data in SQL/Server, it also pulls data when i run it using a recordset; but the RecordSource says that there is no data. </p>\n\n<p>My question is, is there anything I am doing/not doing that would cause the SQL command to not return data when set to the RecordSource of the Report?</p>\n\n<pre><code>Private Sub Report_Open(Cancel As Integer)\n\n\ngs = \"SELECT dbo.tblSubGrant.intAutoRecNum \"\ngs = gs &amp; \", dbo.tblSubGrantInstitutionContact.intSubGrantID \"\ngs = gs &amp; \", dbo.tblSubGrant.vcEncumbranceNumber \"\ngs = gs &amp; \", dbo.tblSubGrant.intFiscalYearID \"\ngs = gs &amp; \", dbo.v_InstitutionAllType.exprInstitutionName \"\ngs = gs &amp; \", dbo.tblGrantAwardType.vcGrantAwardTypeDescription \"\ngs = gs &amp; \", dbo.tblSubGrantInstitutionContactType.intSubGrantInstitutionContactTypeID \"\ngs = gs &amp; \", dbo.tblSubGrantInstitutionContactType.vcSubGrantInstitutionContactTypeDescription \"\ngs = gs &amp; \", aSubGrantListAmt.ExprAmtAward \"\ngs = gs &amp; \", CASE WHEN dbo.tblSubGrant.bitHoldClaim = 1 THEN 'OnHold' WHEN dbo.tblSubGrant.bitClosed = 1 THEN 'Closed' ELSE 'OPEN' END AS Status \"\ngs = gs &amp; \", dbo.tblSubGrantInstitutionContact.intInstitutionEmployeeID \"\ngs = gs &amp; \"FROM dbo.tblSubGrant WITH(NOLOCK) \"\ngs = gs &amp; \"INNER JOIN dbo.tblSubGrantInstitutionContact WITH(NOLOCK) \"\ngs = gs &amp; \"ON dbo.tblSubGrant.intSubGrantID = dbo.tblSubGrantInstitutionContact.intSubGrantID \"\ngs = gs &amp; \"INNER JOIN dbo.tblGrantAwardAwardTypeAllocation WITH(NOLOCK) \"\ngs = gs &amp; \"ON dbo.tblSubGrant.intGrantAwardAwardTypeAllocationID = dbo.tblGrantAwardAwardTypeAllocation.intGrantAwardAwardTypeAllocationID \"\ngs = gs &amp; \"INNER JOIN dbo.tblGrantAwardType WITH(NOLOCK) \"\ngs = gs &amp; \"ON dbo.tblGrantAwardAwardTypeAllocation.intGrantAwardTypeID = dbo.tblGrantAwardType.intGrantAwardTypeID \"\ngs = gs &amp; \"INNER JOIN dbo.tblSubGrantInstitutionContactType WITH(NOLOCK) \"\ngs = gs &amp; \"ON dbo.tblSubGrantInstitutionContact.intSubGrantInstitutionContactTypeID = dbo.tblSubGrantInstitutionContactType.intSubGrantInstitutionContactTypeID \"\ngs = gs &amp; \"LEFT OUTER JOIN dbo.v_InstitutionAllType WITH(NOLOCK) \"\ngs = gs &amp; \"ON dbo.tblSubGrant.intInstitutionRecipientID = dbo.v_InstitutionAllType.ID \"\ngs = gs &amp; \"LEFT OUTER JOIN \"\ngs = gs &amp; \"(SELECT SUM (dbo.v_frmSubGrantListAmt.exprOrig) + SUM(dbo.v_frmSubGrantListAmt.exprSup) - SUM(dbo.v_frmSubGrantListAmt.exprRed) - SUM(dbo.v_frmSubGrantListAmt.exprLiq)  AS ExprAmtAward \"\ngs = gs &amp; \", intSubGrantID \"\ngs = gs &amp; \"FROM v_frmSubGrantListAmt WITH(NOLOCK) \"\ngs = gs &amp; \"GROUP BY intSubGrantID) aSubGrantListAmt \"\ngs = gs &amp; \"ON dbo.tblSubGrant.intSubGrantID = aSubGrantListAmt.intSubGrantID \"\ngs = gs &amp; \"GROUP BY dbo.tblSubGrant.intAutoRecNum \"\ngs = gs &amp; \", dbo.tblSubGrantInstitutionContact.intSubGrantID \"\ngs = gs &amp; \", dbo.tblSubGrant.intFiscalYearID \"\ngs = gs &amp; \", dbo.v_InstitutionAllType.exprInstitutionName \"\ngs = gs &amp; \", dbo.tblGrantAwardType.vcGrantAwardTypeDescription \"\ngs = gs &amp; \", dbo.tblSubGrantInstitutionContactType.intSubGrantInstitutionContactTypeID \"\ngs = gs &amp; \", dbo.tblSubGrantInstitutionContactType.vcSubGrantInstitutionContactTypeDescription \"\ngs = gs &amp; \", dbo.tblSubGrant.vcEncumbranceNumber \"\ngs = gs &amp; \", dbo.tblSubGrantInstitutionContact.intInstitutionEmployeeID \"\ngs = gs &amp; \", CASE WHEN bitHoldClaim = 1 THEN 'OnHold' WHEN bitClosed = 1 THEN 'Closed' ELSE 'OPEN' END \"\ngs = gs &amp; \", dbo.tblSubGrant.intInstitutionRecipientID \"\ngs = gs &amp; \", dbo.tblSubGrantInstitutionContact.intSubGrantInstitutionContactTypeID \"\ngs = gs &amp; \", aSubGrantListAmt.ExprAmtAward \"\ngs = gs &amp; \"HAVING dbo.tblSubGrantInstitutionContact.intInstitutionEmployeeID = \" &amp; Forms!frmBULKContactUpdate!intInstitutionEmployeeID &amp; \" \"\ngs = gs &amp; \"AND (CASE WHEN dbo.tblSubGrant.bitHoldClaim = 1 THEN 'OnHold' WHEN dbo.tblSubGrant.bitClosed = 1 THEN 'Closed' ELSE 'OPEN' END = 'OPEN') \"\ngs = gs &amp; \"AND dbo.tblSubGrantInstitutionContactType.intSubGrantInstitutionContactTypeID = \" &amp; Forms!frmBULKContactUpdate!intSubGrantInstitutionContactTypeID &amp; \" \"\ngs = gs &amp; \"ORDER BY 5, 3 \"\n\n\nDim cnn As ADODB.Connection\nDim rst As ADODB.Recordset\n\nSet cnn = CurrentProject.Connection\nSet rst = New ADODB.Recordset\n\nrst.Open gs, cnn, adOpenStatic, adLockReadOnly\n\nMe.RecordSource = gs\nDoEvents\n\nrst.Close\ncnn.Close\n\nSet rst = Nothing\nSet cnn = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1495040923, "post_id": 44030920, "comment_id": 75088435, "body": "You&#39;ll need to use <code>.Range(cellNum)</code> instead of <code>.Cells(cellNum)</code> because of how you built the <code>cellNum</code> string."}, {"owner": {"reputation": 13, "user_id": 8026793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2738de7378d16677c091d41c2b358158?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewZ", "link": "https://stackoverflow.com/users/8026793/matthewz"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1495041246, "post_id": 44030920, "comment_id": 75088623, "body": "Even with .Range instead of .Cells no value is being saved under txtPrice"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1495041412, "post_id": 44030920, "comment_id": 75088723, "body": "What is <code>cbxSite.Value</code>? Does <code>cellNum</code> actually get populated?  If it does, is there anything in that cell?  If you do <code>MsgBox Worksheets(&quot;AllSites&quot;).Range(cellNum).Value</code> does it show anything?"}, {"owner": {"reputation": 13, "user_id": 8026793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2738de7378d16677c091d41c2b358158?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewZ", "link": "https://stackoverflow.com/users/8026793/matthewz"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1495041787, "post_id": 44030920, "comment_id": 75088959, "body": "cbxsite.value is a combobox that lists 6 sites that a user can choose from.  cellnum is a variable created based on what column the site is listed in (ex. the site Aberdeen is the column header of column D). Therefore cellNum is storing the column letter and row number (ex. D10) to display a price associated with those two restrictions.  Then in the text box labeled txtPrice I want the price that is in D10 to be displayed. msgbox doesn&#39;t display anything."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1495041925, "post_id": 44030920, "comment_id": 75089031, "body": "Ok, if the MsgBox is also not displaying anything, then it sounds like there&#39;s nothing in that cell.  Do a <code>MsgBox cellNum</code> to verify that cellNum is built correctly, and then manually verify that cell, on sheet &quot;AllSites&quot; isn&#39;t blank."}, {"owner": {"reputation": 13, "user_id": 8026793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2738de7378d16677c091d41c2b358158?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewZ", "link": "https://stackoverflow.com/users/8026793/matthewz"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1495042525, "post_id": 44030920, "comment_id": 75089369, "body": "I posted a link in my original post to the matrix I&#39;m trying to get prices from. What we&#39;re trying to do is based off the user&#39;s input of the location and the SKU to display the price in the textbox txtPrice based of the matrix"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1495042647, "post_id": 44030920, "comment_id": 75089447, "body": "An image doesn&#39;t really help.  You&#39;ll need to troubleshoot your actual workbook.  You&#39;ll still need to verify that <code>cellNum</code> is built correctly and is pointing to the proper cell, and then manually verify that the cell it&#39;s pointing to isn&#39;t blank.  It sounds like the cell it is pointing to is blank."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1495042942, "post_id": 44030920, "comment_id": 75089621, "body": "You might also want to try using <code>.Range(cellNum).Text</code> instead of <code>.Value</code>, but note the return won&#39;t be a true number in the textbox."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8026793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2738de7378d16677c091d41c2b358158?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewZ", "link": "https://stackoverflow.com/users/8026793/matthewz"}, "edited": false, "score": 0, "creation_date": 1495041319, "post_id": 44031007, "comment_id": 75088661, "body": "Still no value is being displayed under the textbox"}, {"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "reply_to_user": {"reputation": 13, "user_id": 8026793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2738de7378d16677c091d41c2b358158?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewZ", "link": "https://stackoverflow.com/users/8026793/matthewz"}, "edited": false, "score": 0, "creation_date": 1495042205, "post_id": 44031007, "comment_id": 75089193, "body": "What if: txtPrice.Text = Worksheets(&quot;AllSites&quot;).Range(cellNum).Value ?"}], "tags": [], "owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "is_accepted": false, "score": 0, "last_activity_date": 1495429638, "last_edit_date": 1495429638, "creation_date": 1495040845, "answer_id": 44031007, "question_id": 44030920, "link": "https://stackoverflow.com/questions/44030920/how-to-print-the-value-of-a-cell-you-find-into-a-text-box-in-vba/44031007#44031007", "title": "How to print the value of a cell you find into a text box in VBA", "body": "<p>Try this: </p>\n\n<pre><code>Textbox.Text = Worksheets(\"AllSites\").Cells(cellNum).Value\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1495041325, "creation_date": 1495041325, "answer_id": 44031143, "question_id": 44030920, "link": "https://stackoverflow.com/questions/44030920/how-to-print-the-value-of-a-cell-you-find-into-a-text-box-in-vba/44031143#44031143", "title": "How to print the value of a cell you find into a text box in VBA", "body": "<p>You are trying to use something like <code>Cells(\"H6\").Value</code>. It should be <code>.Range(\"H6\").Value</code>.</p>\n\n<pre><code>'where cellNum is a string something like \"H6\"\ntxtPrice.Value = Worksheets(\"AllSites\").Range(cellNum).Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8026793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2738de7378d16677c091d41c2b358158?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewZ", "link": "https://stackoverflow.com/users/8026793/matthewz"}, "edited": false, "score": 0, "creation_date": 1495128409, "post_id": 44033383, "comment_id": 75133480, "body": "Thanks, we figured it out yesterday, started everything over and copied/pasted the code and it magically worked!"}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "reply_to_user": {"reputation": 13, "user_id": 8026793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2738de7378d16677c091d41c2b358158?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewZ", "link": "https://stackoverflow.com/users/8026793/matthewz"}, "edited": false, "score": 0, "creation_date": 1495128575, "post_id": 44033383, "comment_id": 75133575, "body": "That&#39;s great!  If this was the solution, can you please mark it as the solution?  Thanks."}], "tags": [], "owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "is_accepted": true, "score": 0, "last_activity_date": 1495049727, "creation_date": 1495049727, "answer_id": 44033383, "question_id": 44030920, "link": "https://stackoverflow.com/questions/44030920/how-to-print-the-value-of-a-cell-you-find-into-a-text-box-in-vba/44033383#44033383", "title": "How to print the value of a cell you find into a text box in VBA", "body": "<p>The problem is with the structure of your <code>If</code> statement.  Your <code>End If</code> statement is in the wrong place.  This caused Excel to insert a colon after your <code>Else</code> statement.  Using a colon is a way to put two statements on the same line.  So the effect of this is that if none of the other <code>If</code> &amp; <code>ElseIf</code> condtions are met, then this statement <code>cellNum = \"H\" &amp; rowNum</code> will always execute and probably directs cellNum to a blank cell.</p>\n\n<p>Even if one of the other <code>If</code> conditions is met, then the code is skipping the part that sets the textbox value because everything between <code>Else:</code> and <code>End If</code> is part of the <code>Else:</code> clause so those statements don't get executed if any of the other <code>If</code> conditions evaluate to True.</p>\n\n<p>So you need to change the <code>Else:</code> condition to antoher <code>ElseIf</code> and move the <code>End If</code> statement below that block.</p>\n\n<p>Additionally, you need to change <code>.Cells</code> to <code>.Range</code> as others here have noted.</p>\n\n<pre><code>Private Sub btnGO_Click()\n\n    Dim rowNum, cellNum As Variant\n\n    rowNum = Application.WorksheetFunction.Match(txtSKU.Value, Worksheets(\"AllSites\").Range(\"B:B\"), 0)\n\n    If IsError(rowNum) Then MsgBox \"SKU not found\": Exit Sub\n\n    If cbxSite.Value = \"Fairburn\" Then\n        cellNum = \"C\" &amp; rowNum\n    ElseIf cbxSite.Value = \"Aberdeen\" Then\n        cellNum = \"D\" &amp; rowNum\n    ElseIf cbxSite.Value = \"University Park\" Then\n        cellNum = \"E\" &amp; rowNum\n    ElseIf cbxSite.Value = \"Roanoke\" Then\n        cellNum = \"F\" &amp; rowNum\n    ElseIf cbxSite.Value = \"Lathrop\" Then\n        cellNum = \"G\" &amp; rowNum\n    ElseIf cbxSite.Value = \"Redlands\" Then\n        cellNum = \"H\" &amp; rowNum\n    End If\n\n    If IsError(cellNum) Then MsgBox \"Site not found\": Exit Sub\n\n    txtPrice.Value = Worksheets(\"AllSites\").Range(cellNum).Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8026793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2738de7378d16677c091d41c2b358158?s=128&d=identicon&r=PG&f=1", "display_name": "MatthewZ", "link": "https://stackoverflow.com/users/8026793/matthewz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "accepted_answer_id": 44033383, "answer_count": 3, "score": 1, "last_activity_date": 1495429638, "creation_date": 1495040539, "last_edit_date": 1495042407, "question_id": 44030920, "link": "https://stackoverflow.com/questions/44030920/how-to-print-the-value-of-a-cell-you-find-into-a-text-box-in-vba", "title": "How to print the value of a cell you find into a text box in VBA", "body": "<p><a href=\"https://i.stack.imgur.com/h0yBa.png\" rel=\"nofollow noreferrer\">enter image description here</a>We are trying to write a code that, given a site name (column) and SKU (row), the value of the resulting cell gets shown in a text box. We've gotten to the point where we have the cell number, ie. E16, but we can't figure out how to print the value of E16 into the text box. txtPrice.value in the last line is supposed to be what gets posted in the text box, but it keeps coming out empty</p>\n\n<pre><code>Private Sub btnGO_Click()\nDim rowNum, cellNum As Variant\nrowNum = Application.WorksheetFunction.Match(txtSKU.Value, \nWorksheets(\"AllSites\").Range(\"B:B\"), 0)\nIf IsError(rowNum) Then MsgBox \"SKU not found\": Exit Sub\nIf cbxSite.Value = \"Fairburn\" Then\n    cellNum = \"C\" &amp; rowNum\n        ElseIf cbxSite.Value = \"Aberdeen\" Then\n    cellNum = \"D\" &amp; rowNum\n        ElseIf cbxSite.Value = \"University Park\" Then\n    cellNum = \"E\" &amp; rowNum\n        ElseIf cbxSite.Value = \"Roanoke\" Then\n    cellNum = \"F\" &amp; rowNum\n        ElseIf cbxSite.Value = \"Lathrop\" Then\n    cellNum = \"G\" &amp; rowNum\n        Else: cbxSite.Value = \"Redlands\"\n    cellNum = \"H\" &amp; rowNum\nIf IsError(cellNum) Then MsgBox \"Site not found\": Exit Sub\ntxtPrice.Value = Worksheets(\"AllSites\").Cells(cellNum).Value\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1495040819, "post_id": 44030812, "comment_id": 75088382, "body": "This is one of those &quot;pictures are worth a thousand words&quot; situations. It&#39;s very difficult to follow how your data looks and what you want it to look like. It sounds very doable though. In fact, it sounds like it can be done with a formula to pull the information into your blank cells i.e. <code>=INDEX(MATCH())</code>. If you put the Supervisor column first on Sheet2, then you could do this with a <code>=Vlookup()</code> (I think)."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495040937, "post_id": 44030812, "comment_id": 75088443, "body": "Yes that&#39;s possible.  If the Supervisor you &quot;click&quot; (key?) on Sheet1 has his/her name somewhere on sheet2 - along with his phone and address - then it is possible to do this.  What have you tried so far?"}], "answers": [{"tags": [], "owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "is_accepted": false, "score": 0, "last_activity_date": 1495046300, "creation_date": 1495046300, "answer_id": 44032515, "question_id": 44030812, "link": "https://stackoverflow.com/questions/44030812/creating-vba-to-populate-information-from-a-list-into-specific-cells/44032515#44032515", "title": "Creating VBA to populate information from a list into specific cells", "body": "<p>In answer to the basic question, \"What would it look like?\"  You can either enter the supervisor's name manually, or use a pick list.  I'll assume manual entry.  You want a change event on sheet1, that looks like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Target.Worksheet.Range(\"A1\")) Is Nothing Then\n    If Range(\"rngSupervisor\") &lt;&gt; \"\" Then\n        List_the_Subordinates\n    Else\n        Target.Worksheet.Range(\"A1\").Select\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>When you enter the supervisor's name in A1 and press enter (or leave the cell), the change event is triggered.  This checks to see if data was entered in cell A1, and if so, it runs the subroutine \"List_the_Subordinates.\"</p>\n\n<p>Now, the subroutine to list the subordinates could be a for next loop, looking for the super's name and copying the subordinates' information over.  Something like this (very basic).</p>\n\n<pre><code>Sub List_the_Subordinates()\nDim sh1Bottom As Long, sh2Bottom As Long, rowCount As Long\nSheet2.Activate\n'get bottom row of sheet 2\nsh2Bottom = Sheet2.Cells(Rows.Count, 1).End(xlUp).Row\n\nSheet1.Activate\nsh1Bottom = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row + 1\nFor rowCount = 1 To sh2Bottom\n    If Sheet2.Cells(rowCount, 3) = Sheet1.Cells(\"A1\") Then\n        sh1Bottom = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row + 1\n        Sheet1.Cells(sh1Bottom, 1) = Sheet2.Cells(rowCount, 1)\n        Sheet1.Cells(sh1Bottom, 2) = Sheet2.Cells(rowCount, 2)\n    End If\nNext rowCount\nEnd Sub\n</code></pre>\n\n<p>As I said, this is very basic.  Most people will tell you not to use activate and select if you can avoid it, but I have never figured out how to get the bottom row of the sheet without activating it :)  The for next loop is kind of brute force too.  You could use find or match or whatever, but since you have so few rows to deal with, this won't take long.</p>\n\n<p>It's a place to start.  Play with it, and make it sing and dance for you.</p>\n"}], "owner": {"reputation": 1, "user_id": 8026241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c24bd5ae8a02f1a0ce6f69512e8cfbda?s=128&d=identicon&r=PG&f=1", "display_name": "nick1987", "link": "https://stackoverflow.com/users/8026241/nick1987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495046300, "creation_date": 1495040184, "last_edit_date": 1531164843, "question_id": 44030812, "link": "https://stackoverflow.com/questions/44030812/creating-vba-to-populate-information-from-a-list-into-specific-cells", "title": "Creating VBA to populate information from a list into specific cells", "body": "<p>I have a phone list that I need help creating. Sheet 1 has the information being displayed. Sheet 2 has the Data.\nI have 3 categories, Employees, Phone Numbers and Supervisors \nI have about 70 employees, (same with phone numbers) and about 6 supervisors</p>\n\n<p>What I'm trying to do is When I key a supervisor on Sheet 1 they have blank cells under them and I want the employee that's keyed with that supervisor on sheet 2 put under the supervisor on sheet 1 in the next blank cell. Likewise with the phone number being keyed with the employee gets keyed in the adjacent cell next to the employee's name</p>\n\n<p>On sheet 2 , column 1 is employee Column 2 is phone number and column 3 is supervisor</p>\n\n<p>Is this possible to be accomplished? If so what would the VBA look like?</p>\n\n<p>Thank you for any help and anyone stepping up to the challenge.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495040362, "post_id": 44030685, "comment_id": 75088087, "body": "Try this : Destination:=thiwkb.Range(&quot;A&quot; &amp; Irow)"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495040720, "post_id": 44030685, "comment_id": 75088323, "body": "Or whichever book you&#39;re copying from and  too, The format for that is destination:=wb.ws.range(&quot;A1&quot;).  Did you leave out the code where you define the range by date?  I don&#39;t see it."}, {"owner": {"reputation": 1, "user_id": 7897327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9868dd0cfa90da416c13065bb5efc458?s=128&d=identicon&r=PG&f=1", "display_name": "kavi", "link": "https://stackoverflow.com/users/7897327/kavi"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495191779, "post_id": 44030685, "comment_id": 75160609, "body": "The code that u have mentioned is throwing me an debug error."}, {"owner": {"reputation": 1, "user_id": 7897327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9868dd0cfa90da416c13065bb5efc458?s=128&d=identicon&r=PG&f=1", "display_name": "kavi", "link": "https://stackoverflow.com/users/7897327/kavi"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495191862, "post_id": 44030685, "comment_id": 75160662, "body": "I have the dates mentioned on the worksheet called &quot;KPI&quot; - i will be changing the date on daily basis, All i need is as an when i change that date the destination sheet must pick the last line of the row and paste the data irrespective of the dates that i am choosing"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495456657, "post_id": 44030685, "comment_id": 75245425, "body": "Ok, I&#39;m lost.  Your code is confusing me.  Lets start with pseudo code.  You need to &quot;consolidate data for a month.&quot;  What does that mean?  Do you want to add a line to a worksheet for every day of a month?  Or are you taking all figures from a month and adding them all together on a single line of a workbook?  Next, this workbook you are writing to, are you creating a new workbook for each day of the month?  Or would you prefer to have one workbook for each month and add the daily totals on a new row within that workbook?  Name book you write to and the book you are drawing from."}, {"owner": {"reputation": 1, "user_id": 7897327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9868dd0cfa90da416c13065bb5efc458?s=128&d=identicon&r=PG&f=1", "display_name": "kavi", "link": "https://stackoverflow.com/users/7897327/kavi"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495466591, "post_id": 44030685, "comment_id": 75252579, "body": "1) taking all figures from a month and adding them all together on a single worksheet of a workbook. 2)ave one workbook for each month and add the daily totals on a new row within that workbook . Name book you write to = KPI , name book you are drawing from = Signoff Sheet_May_01 ...(02)...(03)"}], "owner": {"reputation": 1, "user_id": 7897327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9868dd0cfa90da416c13065bb5efc458?s=128&d=identicon&r=PG&f=1", "display_name": "kavi", "link": "https://stackoverflow.com/users/7897327/kavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495049010, "creation_date": 1495039762, "last_edit_date": 1531161705, "question_id": 44030685, "link": "https://stackoverflow.com/questions/44030685/consolidate-according-to-the-date-in-the-last-line-of-the-excel", "title": "Consolidate according to the date in the last line of the excel", "body": "<p>I have a simple macro created to consolidate the files one below the other (i.e., find the last line and paste the next data)</p>\n\n<p>So On a daily basis according to the date I need to consolidate the data (for a month - 30days)</p>\n\n<p>My file is saved in the Path- I:\\Tracker\\2017\\May'17</p>\n\n<p>File Name : Signoff Sheet_May_<strong>01</strong> (This date May 01 everyday according to the calendar date)</p>\n\n<p>The File Path and the date I have a sheet created named KPI and entered the details in there,</p>\n\n<p>My code as follows :</p>\n\n<pre><code>Sub KPI()\n\n    Set thiwkb = ThisWorkbook.Worksheets(\"KPI\")\n\n    Mydate = thiwkb.Range(\"B2\")\n\n    Set destsheet = ThisWorkbook.Sheets(\"Production\")\n\n    Path = thiwkb.Range(\"B3\") &amp; \"\\\" &amp; \"Signoff Sheet_\" &amp; Mydate &amp; \".xlsx\"\n\n    Irow = 1\n    Irow1 = 1\n    Irow2 = 1\n\n    Set wkb = Workbooks.Open(Path)\n    wkb.Worksheets(\"Daily tracker\").Range(\"A1\").CurrentRegion.Copy Destination.Range(\"A\" &amp; Irow)\n\n    wkb.Close False\n\n    Irow = destsheet.Range(\"a1\").CurrentRegion.Rows.Count + 1\n\nEnd Sub\n</code></pre>\n\n<p>My Code is pulling the data however when I change the data in the KPI sheet everyday i need the data to be consolidated or pasted according to the date.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1495037746, "post_id": 44029991, "comment_id": 75086580, "body": "You should add a sheet reference to LastRow. However, the main issue is that you are trying to copy a whole column to a range of a smaller size and you can&#39;t put a quart into a pint pot. I doubt you need to copy the whole column."}, {"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1495037988, "post_id": 44029991, "comment_id": 75086721, "body": "So I might need two LastRow variables then? One for the source sheet and one for the destination sheet, and add the sheet reference in front of the Cells( for each?  The columns are not defined in row count, so I could worksheets(&quot;redacted).range(&quot;A1&quot;:&quot;A&quot;&amp;LastRow) to get the specific number?"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "edited": false, "score": 0, "creation_date": 1495045499, "post_id": 44030275, "comment_id": 75091031, "body": "Solution Verified. This is the option I went with, worked like a charm and I learned some stuff along the way. Thanks SJR."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1495038412, "creation_date": 1495038412, "answer_id": 44030275, "question_id": 44029991, "link": "https://stackoverflow.com/questions/44029991/vba-runtime-1004-pasting-to-lastrow-of-another-worksheet/44030275#44030275", "title": "VBA: Runtime 1004 -- Pasting to LastRow of another worksheet", "body": "<p>This is pretty much what you have suggested in your comment above. Of course this could still error if you are copying more cells than there are left on the destination sheet - so would need some error trapping for this probably unlikely event.</p>\n\n<pre><code>Sub x()\n\nDim LastRow1 As Long, LastRow2 As Long\n\nWith Worksheets(\"redactedb\")\n    LastRow1 = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    LastRow2 = Worksheets(\"Aggregate\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n    .Range(\"A1\", .Range(\"A\" &amp; LastRow1)).Copy Worksheets(\"Aggregate\").Range(\"A\" &amp; LastRow2)\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1495039130, "creation_date": 1495039130, "answer_id": 44030478, "question_id": 44029991, "link": "https://stackoverflow.com/questions/44029991/vba-runtime-1004-pasting-to-lastrow-of-another-worksheet/44030478#44030478", "title": "VBA: Runtime 1004 -- Pasting to LastRow of another worksheet", "body": "<p>Something like this should be adaptable for you...</p>\n\n<pre><code>Sub Foo()\n    Dim wsDest As Worksheet: Set wsDest = ThisWorkbook.Worksheets(\"Sheet5\")\n    Dim wsSrc As Worksheet, i As Long, CopyRange As Range, LastRow As Long\n\n    ' Initialize array with sheet names to combine\n    Dim SrcArr() As String: SrcArr = Split(\"Sheet1,Sheet2,Sheet3,Sheet4\", \",\")\n\n    For i = 0 To UBound(SrcArr)\n        On Error Resume Next\n            LastRow = wsDest.Range(\"A:A\").Find(\"*\", SearchDirection:=xlPrevious).Row\n        On Error GoTo 0\n        Set wsSrc = ThisWorkbook.Worksheets(SrcArr(i))\n        With wsSrc\n            Set CopyRange = Application.Intersect(.UsedRange, .Range(\"A:A\"))\n            CopyRange.Copy wsDest.Range(\"A\" &amp; LastRow + 1)\n        End With\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 44030275, "answer_count": 2, "score": 0, "last_activity_date": 1495039130, "creation_date": 1495037571, "question_id": 44029991, "link": "https://stackoverflow.com/questions/44029991/vba-runtime-1004-pasting-to-lastrow-of-another-worksheet", "title": "VBA: Runtime 1004 -- Pasting to LastRow of another worksheet", "body": "<p>I am trying to consolidate four separate tabs pulling only specific columns from each, that are in different locations on each source tab in order to build a pivottable/chart. This is for another user, so manual manipulation is not an option. </p>\n\n<p>The first tab works appropriately because it's just a straight pull. Once I try to paste to the last row, things are weird. I've never had to do this task this way, so there might be some really fundamental concept I'm missing here causing the problem. I am using a method I found when doing my initial research on how to write the script.</p>\n\n<p>Here's an example from the first tab that works:</p>\n\n<pre><code>'Copy and paste data from tab 1\nWorksheets(\"redacteda\").Range(\"H:H\").Copy _\n    Worksheets(\"Aggregate\").Range(\"G:G\")\n</code></pre>\n\n<p>Here's an example from the follow on tab that's resulting in the error:</p>\n\n<pre><code>Dim LastRow As Long\n\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\n'Copy and Past data from tab 2\nWorksheets(\"redactedb\").Range(\"A:A\").Copy _\n    Worksheets(\"Aggregate\").Range(\"A\" &amp; LastRow)\n</code></pre>\n\n<p>I tried Worksheets(\"Aggregate\").Range(\"A &amp; LastRow\") as well, but that didn't work either. </p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 1, "creation_date": 1495037538, "post_id": 44029926, "comment_id": 75086456, "body": "You are counting <i>all</i> of the rows in each of the 3 columns. If <i>any</i> have &quot;Yes&quot; your IF will result in TRUE. Is that your intent?"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1495038097, "creation_date": 1495038097, "answer_id": 44030175, "question_id": 44029926, "link": "https://stackoverflow.com/questions/44029926/ms-excel-formula-determine-count-for-specific-text-across-multiple-columns/44030175#44030175", "title": "MS Excel Formula - Determine count for specific text across multiple columns", "body": "<p>From your question it seems that you want to check for each row alone. To do this you need to enter the formula for each row and fill down For example, at cell <code>AJ3</code>, you can write:</p>\n\n<pre><code>=IF(OR(AF3=\"Yes\", AG3=\"Yes\", AI3=\"Yes\"), \"Yes\", \"1\")\n</code></pre>\n\n<p>Enter this formula at <code>AJ3</code> (or any other column at row 3) then copy/paste on all the column.</p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "is_accepted": false, "score": 1, "last_activity_date": 1495074170, "last_edit_date": 1495074170, "creation_date": 1495041105, "answer_id": 44031078, "question_id": 44029926, "link": "https://stackoverflow.com/questions/44029926/ms-excel-formula-determine-count-for-specific-text-across-multiple-columns/44031078#44031078", "title": "MS Excel Formula - Determine count for specific text across multiple columns", "body": "<p>Use:</p>\n\n<pre><code>Application.WorksheetFunction.Match(\"Yes\", Array1, Array2, Array3)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8026555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14dda87350c06d9da3083825e324c2cd?s=128&d=identicon&r=PG&f=1", "display_name": "user8026555", "link": "https://stackoverflow.com/users/8026555/user8026555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1495074170, "creation_date": 1495037327, "last_edit_date": 1495038221, "question_id": 44029926, "link": "https://stackoverflow.com/questions/44029926/ms-excel-formula-determine-count-for-specific-text-across-multiple-columns", "title": "MS Excel Formula - Determine count for specific text across multiple columns", "body": "<p>I am trying to write a formula in MS Excel that will let me know if the text \"Yes\" is found in any of three selected columns. Below is the formula I created but it does not seem to be working. When I drag the formula to the other rows I get a \"Yes\" value for rows that do not have the text \"Yes\". The values in the columns I am searching are blank or have \"Yes\" text.  </p>\n\n<pre><code>=IF(COUNTIF(AF3:AF2378,\"Yes\") + COUNTIF(AG3:AG2378,\"Yes\")\n   + COUNTIF(AI3:AI2378,\"Yes\")=0, \"1\",\"Yes\")   \n</code></pre>\n"}, {"tags": ["vba", "catia"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6843940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Rkuz.jpg?s=128&g=1", "display_name": "doshin", "link": "https://stackoverflow.com/users/6843940/doshin"}, "edited": false, "score": 0, "creation_date": 1495057494, "post_id": 44030486, "comment_id": 75097238, "body": "Hi C, You can&#39;t find out there to much documentation about CATIA-VBA. I&#39;ve posted on coe too, but nothing. This was my last chance.So, thank you."}, {"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1495130526, "post_id": 44030486, "comment_id": 75134702, "body": "This is the correct answer. It&#39;s called &#39;Late Binding&#39;. The disadvantage is that you would have no intellisense on the variant object type."}], "tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1495039159, "creation_date": 1495039159, "answer_id": 44030486, "question_id": 44029182, "link": "https://stackoverflow.com/questions/44029182/catia-vba-error-function-or-interface-marked-restricted-automation-type-not/44030486#44030486", "title": "CATIA-VBA error: Function or interface marked restricted ... automation type not supported in Visual Basic", "body": "<p>The basic rule is this: When using VBA, any CATIA method which takes an array as an argument, or returns through an argument must be called on a variant object. </p>\n\n<p>You have declared Sketch1Variant as Sketch. And SetAbsoluteAxisData takes an array as an argument. </p>\n\n<p>What you want is this:</p>\n\n<pre><code>Dim Sketch1 as Sketch\n\nDim Sketch1Variant as Variant \n</code></pre>\n\n<p>(or just leave the \"as variant\" part off). </p>\n\n<p>With this change you should be able to get past your problem. </p>\n\n<p>In the future please do a web search first, because this is a VERY common question. coe.org is a good site to search.</p>\n"}], "owner": {"reputation": 13, "user_id": 6843940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Rkuz.jpg?s=128&g=1", "display_name": "doshin", "link": "https://stackoverflow.com/users/6843940/doshin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1431, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495057758, "creation_date": 1495035177, "last_edit_date": 1495057758, "question_id": 44029182, "link": "https://stackoverflow.com/questions/44029182/catia-vba-error-function-or-interface-marked-restricted-automation-type-not", "title": "CATIA-VBA error: Function or interface marked restricted ... automation type not supported in Visual Basic", "body": "<p>I've recorded a line creation in a VBA macro file, and it generated the following code:</p>\n\n<pre><code>Sub CATMain()\n    Dim partDocument1 As PartDocument\n    Set partDocument1 = CATIA.ActiveDocument\n    Dim part1 As Part\n    Set part1 = partDocument1.Part\n    Dim bodies1 As Bodies\n    Set bodies1 = part1.Bodies\n    Dim body1 As Body\n    Set body1 = bodies1.Item(\"PartBody\")\n    Dim sketches1 As Sketches\n    Set sketches1 = body1.Sketches\n    Dim originElements1 As OriginElements\n    Set originElements1 = part1.OriginElements\n    Dim reference1 As Reference\n    Set reference1 = originElements1.PlaneYZ\n    Dim sketch1, sketch1Variant As Sketch *\n    Set sketch1 = sketches1.Add(reference1)\n    Dim arrayOfVariantOfDouble1(8)\n    arrayOfVariantOfDouble1(0) = 0#\n    ...\n    arrayOfVariantOfDouble1(8) = 1#\n    Set sketch1Variant = sketch1\n    sketch1Variant.SetAbsoluteAxisData **\n    arrayOfVariantOfDouble1\n    part1.InWorkObject = sketch1\n    Dim factory2D1 As Factory2D\n    Set factory2D1 = sketch1.OpenEdition()\n    Dim geometricElements1 As GeometricElements\n    Set geometricElements1 = sketch1.GeometricElements\n    Dim axis2D1 As Axis2D\n    Set axis2D1 = geometricElements1.Item(\"AbsoluteAxis\")\n    Dim line2D1 As Line2D\n    Set line2D1 = axis2D1.GetItem(\"HDirection\")\n    line2D1.ReportName = 1\n    Dim line2D2 As Line2D\n    Set line2D2 = axis2D1.GetItem(\"VDirection\")\n    line2D2.ReportName = 2\n    Dim point2D1 As Point2D\n    Set point2D1 = factory2D1.CreatePoint(21.285706, -30.501825)\n    point2D1.ReportName = 3\n    Dim point2D2 As Point2D\n    Set point2D2 = factory2D1.CreatePoint(112.826553, -68.875053)\n    point2D2.ReportName = 4\n    Dim line2D3 As Line2D\n    Set line2D3 = factory2D1.CreateLine(21.285706, -30.501825, 112.826553, -68.875053)\n    line2D3.ReportName = 5\n    line2D3.StartPoint = point2D1\n    line2D3.EndPoint = point2D2\n    sketch1.CloseEdition\n    part1.InWorkObject = body1\n    part1.Update\nEnd Sub\n</code></pre>\n\n<p>Now\nThe issue is that when i run the code as is after recording I get the following error:</p>\n\n<blockquote>\n  <p>Error in loading dll.</p>\n</blockquote>\n\n<p>Than I add sketch1Variant object at line * and run the code again.\nThis time I get the </p>\n\n<blockquote>\n  <p>\"Function or interface marked restricted, or the function uses an automation type not supported in Visual Basic\" error for line **.</p>\n</blockquote>\n\n<p>I don't know what's wrong.\nAny info is highly appreciated.\nThank you in advance.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1495035611, "post_id": 44028889, "comment_id": 75085103, "body": "<a href=\"http://stackoverflow.com/questions/36737670/how-can-i-move-the-cursor-to-a-postion-where-i-want-in-office-word-by-vb\" title=\"how can i move the cursor to a postion where i want in office word by vb\">stackoverflow.com/questions/36737670/&hellip;</a>"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1495035660, "post_id": 44028889, "comment_id": 75085143, "body": "Also, this may help you: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821348.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff821348.aspx</a>"}, {"owner": {"reputation": 31, "user_id": 5721429, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YISVJ2H3B8E/AAAAAAAAAAI/AAAAAAAAAXI/4BejcfxV-po/photo.jpg?sz=128", "display_name": "Thomas McKay-Smith", "link": "https://stackoverflow.com/users/5721429/thomas-mckay-smith"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1495558821, "post_id": 44028889, "comment_id": 75299986, "body": "Neither of these worked. I still don&#39;t understand why but in the end I found a work around solution which was to create the table at the start of the document and then add some lines of code to cut and paste to the correct location."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1495560366, "post_id": 44028889, "comment_id": 75300779, "body": "Glad to hear that. You should post this workaround as an answer so later people can find it. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5721429, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YISVJ2H3B8E/AAAAAAAAAAI/AAAAAAAAAXI/4BejcfxV-po/photo.jpg?sz=128", "display_name": "Thomas McKay-Smith", "link": "https://stackoverflow.com/users/5721429/thomas-mckay-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1495640350, "creation_date": 1495640350, "answer_id": 44162939, "question_id": 44028889, "link": "https://stackoverflow.com/questions/44028889/how-to-locate-specific-string-in-word-document-and-replace-with-automatic-table/44162939#44162939", "title": "How to locate specific string in word document and replace with automatic table of contents with Excel VBA script?", "body": "<p>After other attempts failed, I came up with the following work-around solution which involves creating the table of contents at the top of the document first and then cutting and pasting into the desired location.</p>\n\n<pre><code>Sub createContentsPage()\n\nDim objWord As Word.Application\nDim inputDoc As Word.Document\nDim rngWord As Word.Range\n\nSet objWord = New Word.Application\n\nWith objWord\n    .Visible = True\n    Set inputDoc = .Documents.Open( _\n            Filename:=\"C:\\test.docx\", _\n            ReadOnly:=False)\nEnd With\n\n'Create table of contents at top of document\nWith inputDoc\n    Set rngWord = .Range(Start:=0, End:=0)      \n    .TablesOfContents.Add _\n    Range:=rngWord, _\n    UseFields:=True, _\n    UseHeadingStyles:=True, _\n    LowerHeadingLevel:=2, _\n    UpperHeadingLevel:=1\nEnd With\n\n'Scroll to top of document\nobjWord.Selection.HomeKey Unit:=wdStory\n\n'Select contents table\nobjWord.Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend\n\n'Cut contents table\nobjWord.Selection.Cut\n\n'Find placeholder and delete (cursor will remain at place holder)\nWith inputDoc.Content.Find\n    .Text = \"[contents_table_placeholder]\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    .ExecuteReplace:=wdReplaceOne\nEnd With\n\n'Insert new line\nobjWord.Selection.TypeParagraph\n\n'Paste contents table\nobjWord.Selection.PasteAndFormat (wdFormatOriginalFormatting)\n\ninputDoc.Save\ninputDoc.Close\n\nSet objWord = Nothing\nSet inputDoc = Nothing\nSet rngWord = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5721429, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YISVJ2H3B8E/AAAAAAAAAAI/AAAAAAAAAXI/4BejcfxV-po/photo.jpg?sz=128", "display_name": "Thomas McKay-Smith", "link": "https://stackoverflow.com/users/5721429/thomas-mckay-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495640350, "creation_date": 1495034334, "last_edit_date": 1531164843, "question_id": 44028889, "link": "https://stackoverflow.com/questions/44028889/how-to-locate-specific-string-in-word-document-and-replace-with-automatic-table", "title": "How to locate specific string in word document and replace with automatic table of contents with Excel VBA script?", "body": "<p>I am writing a VBA script in Excel which needs to add a table of contents to a pre-existing word document in a specific location.</p>\n\n<p>I have a word document with the following text somewhere in it: [contents_table_placeholder]</p>\n\n<p>I want to find the text [contents_table_placeholder] and replace it with a word document automatic contents table.</p>\n\n<p>However, I am struggling to get the table of contents to appear anywhere other than at the start of the document. My initial approach was to do a find and replace (replacing [contents_table_placeholder] with an empty string). I thought this would place the cursor in the correct place to then add the contents table but unfortunately this method doesn't work.</p>\n\n<pre><code>Sub createContentsPage()\n\nDim objWord As Word.Application\nDim inputDoc As Word.Document\nDim rngWord As Word.Range\n\nSet objWord = New Word.Application\n\nWith objWord\n    .Visible = True\n    Set inputDoc = .Documents.Open( _\n                Filename:=\"C:\\test.docx\", _\n                ReadOnly:=False)\nEnd With\n\nWith inputDoc.Content.Find\n    .Text = \"[contents_table_placeholder]\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    .ExecuteReplace:=wdReplaceOne\nEnd With\n\nWith inputDoc\n    Set rngWord = .Range(Start:=0, End:=0)\n\n    .TablesOfContents.Add _\n        Range:=rngWord, _\n        UseFields:=True, _\n        UseHeadingStyles:=True, _\n        LowerHeadingLevel:=2, _\n        UpperHeadingLevel:=1\nEnd With\n\nSet objWord = Nothing\nSet inputDoc = Nothing\nSet rngWord = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 1, "user_id": 7816312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f997a06d371dd9249ae4561374f141?s=128&d=identicon&r=PG&f=1", "display_name": "jwiggins", "link": "https://stackoverflow.com/users/7816312/jwiggins"}, "edited": false, "score": 0, "creation_date": 1495034370, "post_id": 44028805, "comment_id": 75084200, "body": "Instead of your last with...end with block"}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 1, "last_activity_date": 1495034139, "creation_date": 1495034139, "answer_id": 44028805, "question_id": 44028591, "link": "https://stackoverflow.com/questions/44028591/using-endxldown-function-to-copy-and-paste-unlimited-data/44028805#44028805", "title": "Using endxldown function to copy and paste unlimited data", "body": "<p>I'd guess:</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    With .Range(\"A\" &amp; .Rows.Count).end(xlUp)\n        .Offset(1, 0) = itemName\n        .Offset(1, 1) = itemPrice\n    End With\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7816312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f997a06d371dd9249ae4561374f141?s=128&d=identicon&r=PG&f=1", "display_name": "jwiggins", "link": "https://stackoverflow.com/users/7816312/jwiggins"}, "edited": false, "score": 0, "creation_date": 1495034547, "post_id": 44028821, "comment_id": 75084317, "body": "It doesn&#39;t copy anything beyond A1, B2"}, {"owner": {"reputation": 1, "user_id": 7816312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f997a06d371dd9249ae4561374f141?s=128&d=identicon&r=PG&f=1", "display_name": "jwiggins", "link": "https://stackoverflow.com/users/7816312/jwiggins"}, "edited": false, "score": 0, "creation_date": 1495036083, "post_id": 44028821, "comment_id": 75085453, "body": "Lol yes I know. That is why I asked how to change the code to include a dynamic range."}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": false, "score": 0, "last_activity_date": 1495035425, "last_edit_date": 1495035425, "creation_date": 1495034184, "answer_id": 44028821, "question_id": 44028591, "link": "https://stackoverflow.com/questions/44028591/using-endxldown-function-to-copy-and-paste-unlimited-data/44028821#44028821", "title": "Using endxldown function to copy and paste unlimited data", "body": "<p>try this, (I cleaned up your code), see also the instruction that sets a value to rowcount</p>\n\n<pre><code>    Private Sub CommandButton21_Click()\n\n    Dim rowcount As Long\n    Dim myData As Workbook\n\n    With Worksheets(\"Sheet1\")\n        .Range(\"A2:B\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row).Copy\n    End With\n    Set myData = Workbooks.Open(\"C:\\Users\\Iraj.Masud\\Desktop\\testing\\Master.xlsm\")\n    With myData.Worksheets(\"Sheet1\")\n        rowcount = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n        .Cells(rowcount, 1).Paste\n    End With\n    myData.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1495037259, "last_edit_date": 1495037259, "creation_date": 1495034368, "answer_id": 44028896, "question_id": 44028591, "link": "https://stackoverflow.com/questions/44028591/using-endxldown-function-to-copy-and-paste-unlimited-data/44028896#44028896", "title": "Using endxldown function to copy and paste unlimited data", "body": "<p>Use <code>End(xlUp)</code> from the bottom to capture the last row, this is better than using <code>xlDown</code> because the latter will capture the first empty row, not the last row.</p>\n\n<p>Removing all the unnecessary <code>Select</code> stuff and using arrays, your code can be reduced to this:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n  With Workbooks.Open(\"C:\\Users\\Iraj.Masud\\Desktop\\testing\\Master.xlsm\").Sheets(\"Sheet1\")\n    .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1).Resize(1, 2).Value = _\n        ThisWorkbook.Sheets(\"Sheet1\").Range(\"A2:B2\").Value2\n    .Parent.Close True\n  End With\nEnd Sub\n</code></pre>\n\n<p>Note that all references are explicit, there is no implicit reference to whichever workbook or worksheet is active. This usually results in safer code.</p>\n\n<p>EDIT</p>\n\n<p>If you want to copy all A:B data from the source, use this:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n  Dim src as Range\n  Set src = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A2\", ThisWorkbook.Sheets(\"Sheet1\").Range(\"B999999\").End(xlUp)\n  With Workbooks.Open(\"C:\\Users\\Iraj.Masud\\Desktop\\testing\\Master.xlsm\").Sheets(\"Sheet1\")\n    .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1) _\n       .Resize(src.Rows.Count, src.Columns.Count).Value = src.Value2\n    .Parent.Close True\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "is_accepted": false, "score": 0, "last_activity_date": 1495090570, "creation_date": 1495090570, "answer_id": 44040659, "question_id": 44028591, "link": "https://stackoverflow.com/questions/44028591/using-endxldown-function-to-copy-and-paste-unlimited-data/44040659#44040659", "title": "Using endxldown function to copy and paste unlimited data", "body": "<pre><code>Private Sub CommandButton21_Click()\n\nDim itemName As String\nDim itemPrice As Single\nDim wbData As Workbook\nDim wsData As Worksheet\nDim newData As Range\n\nWith ThisWorkbook.Worksheets(\"Sheet1\")  '&lt;~defines that we are working on sheet1\n  itemName = .Range(\"A2\")               '&lt;~gets the itemname\n  itemPrice = .Range(\"B2\")              '&lt;~gets the itemprice\nEnd With\n\nSet wbData = Workbooks.Open(\"C:\\Users\\Iraj.Masud\\Desktop\\testing\\Master.xlsm\")  '&lt;~opens then workbook\nSet wsData = wbData.Worksheets(\"Sheet1\")                                        '&lt;~sets the worksheet\nSet newData = wsData.Range(\"A1048576\").End(xlUp).Offset(1, 0)                   '&lt;~locate last cell and offset 1 row below\n\nWith newData                            '&lt;~defines that we are working with the cell below the last non-blank cell\n  .Offset(0, 0).Value = itemName        '&lt;~passes the item name\n  .Offset(0, 1).Value = itemPrice       '&lt;~passes the item price\nEnd With\n\nSet newData = Nothing                   '&lt;~post procedure cleaning\nSet wsData = Nothing                    '&lt;~post procedure cleaning\n\nwbData.Save                             '&lt;~save\nwbData.Close\n\nEnd Sub\n</code></pre>\n\n<p>This might be a chunky code. But IMO, this is flexible in case you want to change some part/s of the code.</p>\n"}], "owner": {"reputation": 1, "user_id": 7816312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f997a06d371dd9249ae4561374f141?s=128&d=identicon&r=PG&f=1", "display_name": "jwiggins", "link": "https://stackoverflow.com/users/7816312/jwiggins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1495090570, "creation_date": 1495033559, "last_edit_date": 1495036243, "question_id": 44028591, "link": "https://stackoverflow.com/questions/44028591/using-endxldown-function-to-copy-and-paste-unlimited-data", "title": "Using endxldown function to copy and paste unlimited data", "body": "<p>I'm trying to copy and paste data from one workbook into another. This function works when the range is static, but I cannot get it to be dynamic. I know the endxldown function is for this, but how would I work it into my code:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\nDim itemName As String\n\nDim itemPrice As Single\n\nDim myData As Workbook\n\n\nWorksheets(\"Sheet1\").Select\n\nitemName = Range(\"A2\")\n\nWorksheets(\"Sheet1\").Select\n\nitemPrice = Range(\"B2\")\n\nSet myData = Workbooks.Open(\"C:\\Users\\Iraj.Masud\\Desktop\\testing\\Master.xlsm\")\nWorksheets(\"Sheet1\").Select\n\nWorksheets(\"Sheet1\").Range(\"A1\").Select\n\nRowCount = Worksheets(\"Sheet1\").Range(\"A1\").CurrentRegion.Rows.Count\nWith Worksheets(\"Sheet1\").Range(\"A1\")\n\n.Offset(RowCount, 0) = itemName\n\n.Offset(RowCount, 1) = itemPrice\n\nEnd With\nmyData.Save\n\nEnd Sub\n</code></pre>\n\n<p>My edits are highlighted in the image below. When I ran the macro, I received an object variable or with block variable not set.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4QtZY.png\" rel=\"nofollow noreferrer\">Code with Error</a></p>\n"}, {"tags": ["excel", "selenium", "late-binding", "vba"], "comments": [{"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1495035158, "post_id": 44028584, "comment_id": 75084789, "body": "This may be what you&#39;re looking for: <a href=\"https://codingislove.com/browser-automation-in-excel-selenium/\" rel=\"nofollow noreferrer\">codingislove.com/browser-automation-in-excel-selenium</a>"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1495035625, "post_id": 44028584, "comment_id": 75085116, "body": "@BillHileman Actually that site specifically mentions &#39;Selenium VBA wrapper library&#39; as a prerequisite! I would like to run macros without that installed"}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 1, "creation_date": 1495036030, "post_id": 44028584, "comment_id": 75085412, "body": "I don&#39;t see a way around it.  VBA cannot create an object without the corresponding object already installed.  Sure, you can create an object of office from within excel, for example, but that&#39;s only because it is (obviously) already installed, as are the other components of office.  But it cannot create an object of something that&#39;s not already been installed and configured.  Selenium was meant for browser control specifically for testing - it was never meant to be an end-user product, as far as I know.  Wish I had a better answer."}, {"owner": {"reputation": 22783, "user_id": 1113772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uLSIj.png?s=128&g=1", "display_name": "Paul Sweatte", "link": "https://stackoverflow.com/users/1113772/paul-sweatte"}, "edited": false, "score": 0, "creation_date": 1495040965, "post_id": 44028584, "comment_id": 75088460, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20796017/call-a-unix-script-from-excel-vba\">Call a Unix Script from Excel Vba</a>"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 22783, "user_id": 1113772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uLSIj.png?s=128&g=1", "display_name": "Paul Sweatte", "link": "https://stackoverflow.com/users/1113772/paul-sweatte"}, "edited": false, "score": 0, "creation_date": 1495180004, "post_id": 44028584, "comment_id": 75152952, "body": "@PaulSweatte not a duplicate I don&#39;t think, I certainly wouldn&#39;t be able to answer this question based purely on that answer. But I think I get the idea, only - what should I replace this line with <code>Set console = shell.Exec(&quot;c:\\putty\\plink -telnet telehack.com -P 443&quot;)</code> in (Comintern&#39;s answer)[<a href=\"http://stackoverflow.com/a/41416923/6609896]\">stackoverflow.com/a/41416923/6609896]</a>? I&#39;m not quite there with the terminology but I guess I just switch this line for something to do with the Selenium &quot;server&quot; (whatever that really means), and send commands in a similar way?"}, {"owner": {"reputation": 22783, "user_id": 1113772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uLSIj.png?s=128&g=1", "display_name": "Paul Sweatte", "link": "https://stackoverflow.com/users/1113772/paul-sweatte"}, "edited": false, "score": 1, "creation_date": 1495182692, "post_id": 44028584, "comment_id": 75154454, "body": "@Greedo I agree. In terms of next steps, setting up Selenium on a remote server, then manually connecting to it using putty and saving the connection profile would be the thing to do. To automate the process, use a command like <code>plink.exe -load seleniumserverputtyprofile -batch -l username -pw password java -jar selenium-server.jar</code>. The <a href=\"https://linux.die.net/man/1/plink\" rel=\"nofollow noreferrer\">plink man page</a> and the <a href=\"https://linux.die.net/man/1/putty\" rel=\"nofollow noreferrer\">putty man page</a> should help for future reference."}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2234, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1495033543, "creation_date": 1495033543, "last_edit_date": 1531164843, "question_id": 44028584, "link": "https://stackoverflow.com/questions/44028584/run-selenium-without-wrapper-installed", "title": "Run Selenium without wrapper installed", "body": "<p>I am creating a tool in Excel for making Google chrome themes. Ultimately, I'd like to install a .crx file on someone's machine automatically, but this requires uploading files to chrome://extensions to be compiled, then installing the compiled file.</p>\n\n<p>I'm a long way off yet, but in the intrest of planning I've found out about Selenium which may help me in the necessary Chrome manipulations to install the theme.\nMy question is: Can Selenium be late bound and made to run on a computer without it installed? For most objects, late binding is:</p>\n\n<pre><code>Dim objIE As Object\nSet objIE = CreateObject(\"InternetExplorer.Application\")\n</code></pre>\n\n<p>But I don't see how I can do that without Selenium installed - as <code>CreateObject</code> won't know where to look for the reference. Can I specify some online service so that my users don't have to download the Selenium wrapper to use my macros?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1495033620, "post_id": 44028505, "comment_id": 75083620, "body": "can you just use <code>=</code> in the results book and fill down by vba?"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 1, "creation_date": 1495033764, "post_id": 44028505, "comment_id": 75083718, "body": "What do you mean by &quot;iterations&quot;? I don&#39;t understand what&#39;s the result you want..."}, {"owner": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495034086, "post_id": 44028505, "comment_id": 75083972, "body": "After each &quot;calculate&quot; the values of the initial range change. The example  just illustrates how the values from 2-d range should be stored in one row."}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1495035169, "post_id": 44028505, "comment_id": 75084802, "body": "The problem is that your segment &quot;calculate&quot; always produce the same result for the array <code>a</code> (5, 0, 6, 7, 8, 9, 0, 0, 0, 0, 0, 0)... So you&#39;ll reproduce the same result on the 100 lines..."}, {"owner": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495035372, "post_id": 44028505, "comment_id": 75084946, "body": "There are formulas in each cell which give different results after recalculation"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1495044659, "post_id": 44028505, "comment_id": 75090592, "body": "You can speed it up by getting rid of all <code>Cells()</code> calls and load up the values into a memory array <code>tmp = Range(&quot;A2&quot;).Resize(2,5).Value</code>, then manipulate the values into memory direct before outputting the results."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495035240, "post_id": 44029004, "comment_id": 75084853, "body": "The numer of rows in the original range is much bigger than 2, so I can&#39;t create a variant for each row."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495035597, "post_id": 44029004, "comment_id": 75085084, "body": "loop it using my code as the base. so a goes from a1-e1 to a3 to e3"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1495034686, "creation_date": 1495034686, "answer_id": 44029004, "question_id": 44028505, "link": "https://stackoverflow.com/questions/44028505/store-values-of-2-dimenssional-range-i-j-recalculated-n-times-to-a-2-dimension/44029004#44029004", "title": "Store values of 2-dimenssional range (i,j) recalculated N times to a 2-dimensional range (N,i*j)", "body": "<p>Not sure I get you, but something like this</p>\n\n<pre><code>Sub test()\n\nDim a() As Variant\nDim b() As Variant\n\na = Range(\"a1:e1\").Value\nb = Range(\"a2:e2\").Value\n\nFor x = 1 To 5\n    Range(\"H1\").Offset(0, x).Value = a(1, x)\n    Range(\"H1\").Offset(0, 5 + x).Value = b(1, x)\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495036588, "post_id": 44029019, "comment_id": 75085841, "body": "Your code produces 1 2 3 4 5 6 7 8 9 0 and I need 1 6 2 7 3 8 4 9 5 0"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495037632, "post_id": 44029019, "comment_id": 75086512, "body": "@TimurMardanov see my eidt, this time I got it right, sorry"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1495037868, "post_id": 44029019, "comment_id": 75086646, "body": "<code>ReDim Preserve</code> is painfully slow. A faster way would be to <code>ReDim</code> the array to a large size and then after the loop <code>ReDim Preserve</code> down to it&#39;s correct size. This way you only have to do it once. It&#39;ll make your code much faster and you&#39;ll definitely notice the speed improvement when you&#39;re doing a lot of iterations like in this case"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1495038563, "post_id": 44029019, "comment_id": 75087073, "body": "Thanks I wasnt aware that was a huge overhead."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1495037613, "last_edit_date": 1495037613, "creation_date": 1495034719, "answer_id": 44029019, "question_id": 44028505, "link": "https://stackoverflow.com/questions/44028505/store-values-of-2-dimenssional-range-i-j-recalculated-n-times-to-a-2-dimension/44029019#44029019", "title": "Store values of 2-dimenssional range (i,j) recalculated N times to a 2-dimensional range (N,i*j)", "body": "<pre><code>Private Sub this()\n    Dim this As Variant, counter As Long, that As Integer, arr() As Variant\n    counter = 0\n    this = ThisWorkbook.Sheets(\"Sheet3\").UsedRange\n    For i = LBound(this, 2) To UBound(this, 2)\n            counter = counter + 2\n            ReDim Preserve arr(1 To 1, 1 To counter)\n            arr(1, counter - 1) = this(1, i)\n            arr(1, counter) = this(2, i)\n    Next i\n    ThisWorkbook.Sheets(\"Sheet4\").Range(ThisWorkbook.Sheets(\"Sheet4\").Cells(1, 1), ThisWorkbook.Sheets(\"Sheet4\").Cells(1, counter)).Value2 = arr\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495035950, "post_id": 44029069, "comment_id": 75085348, "body": "Your code does just what I want, but it is not faster than my original one"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495036409, "post_id": 44029069, "comment_id": 75085719, "body": "@TimurMardanov Due to having to wait for the workbook to calculate, you can&#39;t really get any faster than this (or your original one).  Your original code had a problem with column assignment in your array <code>a</code> though.  This code fixes that and makes it so you only have to update the range instead of making several small changes to get the code to work properly so it is easier to adjust and maintain."}, {"owner": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495037567, "post_id": 44029069, "comment_id": 75086481, "body": "I agree with you about  delays due to the workbook calculations. But saving results takes about 40% of all execution time since I have seven 60-by-20 ranges which need to be saved. I think that there is a way to avoid cell-by-cell copy. I tried to copy column-by-column using pastespecial and transpose, but it was slower."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495040500, "post_id": 44029069, "comment_id": 75088175, "body": "@TimurMardanov Updated code to convert the rData into an array after each iteration.  Hopefully that should help speed it up.  Let me know if there&#39;s any performance gain."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1495040461, "last_edit_date": 1495040461, "creation_date": 1495034868, "answer_id": 44029069, "question_id": 44028505, "link": "https://stackoverflow.com/questions/44028505/store-values-of-2-dimenssional-range-i-j-recalculated-n-times-to-a-2-dimension/44029069#44029069", "title": "Store values of 2-dimenssional range (i,j) recalculated N times to a 2-dimensional range (N,i*j)", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim rData As Range\n    Dim iter As Long\n    Dim lNumIterations As Long\n    Dim i As Long, j As Long, k As Long\n    Dim a() As Double\n    Dim aAfterCalc As Variant\n\n    Set rData = Sheets(\"Data\").Range(\"A1:E2\")\n    lNumIterations = 100\n    ReDim a(1 To lNumIterations, 1 To rData.Rows.Count * rData.Columns.Count)\n\n    For iter = 1 To lNumIterations\n        k = 0\n        Calculate\n        aAfterCalc = rData.Value\n        For j = 1 To rData.Columns.Count\n            For i = 1 To rData.Rows.Count\n                k = k + 1\n                a(iter, k) = aAfterCalc(i, j)\n            Next i\n        Next j\n\n    Next iter\n\n    Sheets(\"results\").Range(\"A1\").Resize(lNumIterations, UBound(a, 2)).Value = a\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495038151, "post_id": 44029837, "comment_id": 75086815, "body": "Thanks! I knew that the answer is to loop through each column, but don&#39;t know how to make it quick."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495038202, "post_id": 44029837, "comment_id": 75086846, "body": "Is it faster then your original code? Also to change the number of columns just change the second dimension of the array. It should figure everything else out for itself."}, {"owner": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495038424, "post_id": 44029837, "comment_id": 75086989, "body": "Your code is about 40% faster than mine. And I can speed it up a lit bit more, since I can replace UBound and LBound with numbers."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "edited": false, "score": 0, "creation_date": 1495040439, "post_id": 44029837, "comment_id": 75088132, "body": "@TimurMardanov I doubt you&#39;ll see much of a performance gain by doing that I&#39;m afraid."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1495037707, "last_edit_date": 1495037707, "creation_date": 1495037002, "answer_id": 44029837, "question_id": 44028505, "link": "https://stackoverflow.com/questions/44028505/store-values-of-2-dimenssional-range-i-j-recalculated-n-times-to-a-2-dimension/44029837#44029837", "title": "Store values of 2-dimenssional range (i,j) recalculated N times to a 2-dimensional range (N,i*j)", "body": "<p>Try this. It gives your desired output and only uses two loops (instead of three)</p>\n\n<pre><code>' For loop\nDim i As Long, j As Long\n' Initalise array\nDim tmp(1 To 100, 1 To 10) As Variant\n\n'Loop through all rows in already initalised array\nFor i = LBound(tmp, 1) To UBound(tmp, 1)\n    'Calculate to get updated row contents\n    Calculate\n    'Loop through each column in row\n    'The Round and divided by two is to calculate the number of columns concerned instead of the number in the array\n    For j = LBound(tmp, 2) To Round((UBound(tmp, 2) + 0.1) / 2)\n        'First row\n        tmp(i, (j + j - 1)) = Cells(1, j).Value2\n        'Second row\n        ' If incase the array is initalised to an odd number otherwise this would be out of range\n        If j * 2 &lt;= UBound(tmp, 2) Then\n            tmp(i, j * 2) = Cells(2, j).Value2\n        End If\n    Next j\nNext i\n' Write back to sheet\nWith Sheets(\"results\").Cells(1, 1)\n    Range(.Offset(0, 0), .Offset(UBound(tmp, 1) - 1, UBound(tmp, 2) - 1)) = tmp\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8026079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc540acd2d464f4d7b54867cb9f0cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Timur Mardanov", "link": "https://stackoverflow.com/users/8026079/timur-mardanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 44029837, "answer_count": 4, "score": 0, "last_activity_date": 1495040461, "creation_date": 1495033338, "last_edit_date": 1495036243, "question_id": 44028505, "link": "https://stackoverflow.com/questions/44028505/store-values-of-2-dimenssional-range-i-j-recalculated-n-times-to-a-2-dimension", "title": "Store values of 2-dimenssional range (i,j) recalculated N times to a 2-dimensional range (N,i*j)", "body": "<p>I have a 2-dimensional range (i, j) like this:</p>\n\n<pre><code>1 2 3 4 5\n6 7 8 9 0\n</code></pre>\n\n<p>I want to copy&amp;paste it to another sheet like this:</p>\n\n<pre><code>1 6 2 7 3 8 4 9 5 0\n</code></pre>\n\n<p>I need to recalculate the 2-dim range many times and store the results on another sheet, where each row stores one iteration.\nRight now I store all calculations in a array (N, i*j) using two for-loops and then paste all itearations on another sheet.  </p>\n\n<p>Is there a faster way to do that?\nCurrent code:</p>\n\n<pre><code>Dim a(1 To 100, 1 To 10) As Double\n\nFor iter = 1 To 100\n\n    Calculate\n    For i = 1 To 2\n        For j = 1 To 5\n            a(iter, i + j * (i - 1)) = Cells(i, j)\n        Next j\n    Next i\n\nNext iter\n\nWith Sheets(\"results\")\n    Range(.Cells(1, 1), .Cells(100, 2 * 5)) = a\nEnd With\n</code></pre>\n\n<p><strong>UPD:</strong>\nAfter each \"calculate\" the values of the initial range change. The example just illustrates how the values from 2-d range should be stored in one row.</p>\n\n<p><strong>UPD2:</strong> \nCorrected my current code</p>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1495033183, "post_id": 44028393, "comment_id": 75083285, "body": "Why aren&#39;t you filtering each of the three columns for <i>purge</i> or blank?"}, {"owner": {"reputation": 2583, "user_id": 2908576, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/yhWY7.jpg?s=128&g=1", "display_name": "HaveSpacesuit", "link": "https://stackoverflow.com/users/2908576/havespacesuit"}, "edited": false, "score": 0, "creation_date": 1495033206, "post_id": 44028393, "comment_id": 75083309, "body": "You would just use an empty string <code>&quot;&quot;</code> instead of <code>&quot;purge&quot;</code> for the cell you want."}, {"owner": {"reputation": 59, "user_id": 7512453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b5a8a807ec12c2b045fa0125bd7b1e3?s=128&d=identicon&r=PG&f=1", "display_name": "chrisleepotter", "link": "https://stackoverflow.com/users/7512453/chrisleepotter"}, "edited": false, "score": 0, "creation_date": 1495033742, "post_id": 44028393, "comment_id": 75083701, "body": "I may not be educated on the methods of filtering available, or the exact effect. I chose offset because it is important that the values I am searching be explicity related to data which I have stored in other columns of the same row. I imagine that if I filter, I might get mixed results in which I am either not finding or am deleting bits of each row instead of locking on to exact criteria. In this I believe I am uneducated. As far as using &quot;&quot; to substitute for &quot;PURGE&quot;, I tried doing that and I got no effect. I am not sure what&#39;s up."}, {"owner": {"reputation": 59, "user_id": 7512453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b5a8a807ec12c2b045fa0125bd7b1e3?s=128&d=identicon&r=PG&f=1", "display_name": "chrisleepotter", "link": "https://stackoverflow.com/users/7512453/chrisleepotter"}, "edited": false, "score": 0, "creation_date": 1495033806, "post_id": 44028393, "comment_id": 75083754, "body": "Here is a link with a folder that has my file in it. The macro-enabled workbook is outdated now, but the macro-free workbook is the exact same kind of file I need to be cleaning.  <a href=\"https://drive.google.com/open?id=0Bz4rZ9ZqoU0tU3M3bzQydTlvbzA\" rel=\"nofollow noreferrer\">drive.google.com/open?id=0Bz4rZ9ZqoU0tU3M3bzQydTlvbzA</a>  Thanks again guys <i>thumbs up</i>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1495034328, "post_id": 44028393, "comment_id": 75084171, "body": "The actual row deletion (e.g. <code>DelRng.EntireRow.Delete</code>) seems out of place. Shouldn&#39;t it be inside the worksheet loop?"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 7512453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b5a8a807ec12c2b045fa0125bd7b1e3?s=128&d=identicon&r=PG&f=1", "display_name": "chrisleepotter", "link": "https://stackoverflow.com/users/7512453/chrisleepotter"}, "edited": false, "score": 0, "creation_date": 1495037877, "post_id": 44028852, "comment_id": 75086652, "body": "I like this a lot, so I am going to put this little bit in there. Is there a way you would suggest sliding this into my code? I will leave the workbook and directory selection code, but should I get rid of my Len(strFile) code? And should I Dim Criteria 1, 2 (and maybe 3 if I want to add it)?"}, {"owner": {"reputation": 59, "user_id": 7512453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b5a8a807ec12c2b045fa0125bd7b1e3?s=128&d=identicon&r=PG&f=1", "display_name": "chrisleepotter", "link": "https://stackoverflow.com/users/7512453/chrisleepotter"}, "edited": false, "score": 0, "creation_date": 1495038006, "post_id": 44028852, "comment_id": 75086731, "body": "I will be eliminating my string search code by the way, all of the offsets and text searching.  As of now with this bit of filter code I am getting an &quot;application-defined&quot; or &quot;object-defined&quot; error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 59, "user_id": 7512453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b5a8a807ec12c2b045fa0125bd7b1e3?s=128&d=identicon&r=PG&f=1", "display_name": "chrisleepotter", "link": "https://stackoverflow.com/users/7512453/chrisleepotter"}, "edited": false, "score": 0, "creation_date": 1495038058, "post_id": 44028852, "comment_id": 75086756, "body": "This should replace the code you have inside your <code>For Each wsh In wbk.Worksheets</code> loop. 2. There is no Criterias3 and that would be another question (one that I have answered in another earlier question)."}, {"owner": {"reputation": 59, "user_id": 7512453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b5a8a807ec12c2b045fa0125bd7b1e3?s=128&d=identicon&r=PG&f=1", "display_name": "chrisleepotter", "link": "https://stackoverflow.com/users/7512453/chrisleepotter"}, "edited": false, "score": 0, "creation_date": 1495038296, "post_id": 44028852, "comment_id": 75086910, "body": "Thanks a lot! Doing as you said, I swapped out the code and it is working beautifully!  Much appreciation for your help, it is a pleasure!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1495034251, "creation_date": 1495034251, "answer_id": 44028852, "question_id": 44028393, "link": "https://stackoverflow.com/questions/44028393/excel-vba-delete-row-if-three-values-are-met-or-if-one-of-the-three-values-is-b/44028852#44028852", "title": "Excel VBA Delete row if three values are met, or if one of the three values is blank", "body": "<p>Using a two criteria .AutoFilter with xlOr seems a more efficient method.</p>\n\n<pre><code>For Each wsh In wbk.Worksheets\n    With wsh\n        If .AutoFilterMode Then .AutoFilterMode = False\n        With .Cells(1, \"A\").CurrentRegion\n            .AutoFilter Field:=4, Criteria1:=\"*purge*\", Operator:=xlOr, Criteria2:=\"\"\n            .AutoFilter Field:=5, Criteria1:=\"*purge*\", Operator:=xlOr, Criteria2:=\"\"\n            .AutoFilter Field:=6, Criteria1:=\"*purge*\", Operator:=xlOr, Criteria2:=\"\"\n            With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                If CBool(Application.Subtotal(103, .Cells)) Then\n                    .Cells.EntireRow.Delete\n                End If\n            End With\n        End With\n        If .AutoFilterMode Then .AutoFilterMode = False\n    End With\nNext wsh\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7512453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b5a8a807ec12c2b045fa0125bd7b1e3?s=128&d=identicon&r=PG&f=1", "display_name": "chrisleepotter", "link": "https://stackoverflow.com/users/7512453/chrisleepotter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 44028852, "answer_count": 1, "score": 1, "last_activity_date": 1495038721, "creation_date": 1495033030, "last_edit_date": 1495038721, "question_id": 44028393, "link": "https://stackoverflow.com/questions/44028393/excel-vba-delete-row-if-three-values-are-met-or-if-one-of-the-three-values-is-b", "title": "Excel VBA Delete row if three values are met, or if one of the three values is blank", "body": "<p>this is Chris here! Earlier this week I posted a question regarding code that was meant to delete a row if three cells in different columns (same row) met a certain text value criteria. In this case, the text value was \"PURGE\" for all three cells, non-case sensitive.</p>\n\n<p>The method was to search a column (in this case D), find the first value that met the search term, then offset to the next specified column to verify the existence of the following value criteria to be met.</p>\n\n<p>My question today is, how do I specify that one of the criteria that I will accept is a blank value? I would like to modify my code to, for example, search Column 4(D) for \"PURGE\" and if Column 5(E) is blank(nothing) and Column 6(F) says \"PURGE\" then delete that row.</p>\n\n<p>I will post the code which a good fellow named Tom helped me out with.</p>\n\n<p>Also, I will be copying and moving code around to meet conditions in which the search term will be different. I may also want to edit the code to accept more than one blank cell value as criteria for deletion.</p>\n\n<p>Let me know if there's any way I can make my question more clear, or if there's already a post with the answer I need that I couldn't find!</p>\n\n<p>Much appreciated all, your time here means more than I can write in text!\n-Chris</p>\n\n<p>This is what I've got:</p>\n\n<pre><code>Option Explicit\n\nSub DeleteRows()\nDim wbk As Workbook\nDim wsh As Worksheet\nDim strPath As String, strFile As String, strFind As String, firstAddress As \nString\nDim x As Range, y As Range, z As Range\nDim DelRng As Range\n\n\n'searches directory for any and all excel files\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    If .Show Then\n        strPath = .SelectedItems(1)\n    Else\n        MsgBox \"No folder selected!\", vbExclamation\n        Exit Sub\n    End If\nEnd With\n\nIf Right(strPath, 1) &lt;&gt; \"\\\" Then\n    strPath = strPath &amp; \"\\\"\nEnd If\n\nWith Application\n    .ScreenUpdating = False\n    ' Stops xlsm files on Open event\n    .EnableEvents = False\n    ' uncomment to hide any deletion message boxes\n    ' .DisplayAlerts = False\nEnd With\n\nstrFile = Dir(strPath &amp; \"*.xls*\")\n\n'end file finding and such\n\nDo While Len(strFile) &gt; 0\n\n    Set wbk = Workbooks.Open(Filename:=strPath &amp; strFile, AddToMRU:=False)\n\n    For Each wsh In wbk.Worksheets\n\n        'supposed to search column d, offset column +1 in same row,\n        'then do same for a third row.\n        'if all three cells contain \"PURGE\" then delete cell\n\n        With wsh.Columns(4)\n            Set x = .Find(\"PURGE\", Lookat:=xlPart)\n            If Not x Is Nothing Then\n                firstAddress = x.Address\n                Do\n                    If InStr(1, x.Offset(0, 1), \"purge\", vbTextCompare) &gt; 0 And InStr(1, x.Offset(0, 2), \"purge\", vbTextCompare) &gt; 0 Then\n                        If DelRng Is Nothing Then\n                            Set DelRng = x\n                        Else\n                            Set DelRng = Union(DelRng, x)\n                        End If\n                    End If\n                    Set x = .FindNext(x)\n                Loop While Not x Is Nothing And x.Address &lt;&gt; firstAddress\n            End If\n        End With\n    Next wsh\n    If Not DelRng Is Nothing Then DelRng.EntireRow.Delete\n\n    wbk.Close SaveChanges:=True\n    strFile = Dir()\nLoop\n\nWith Application\n    .DisplayAlerts = True\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1495036729, "post_id": 44028384, "comment_id": 75085931, "body": "What&#39;s in <code>IsInArray</code> ?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495041706, "post_id": 44028384, "comment_id": 75088918, "body": "Is inarray a function?"}], "answers": [{"comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1495043879, "post_id": 44031386, "comment_id": 75090189, "body": ",that&#39;s where I was getting lost in his logic.  &quot;Result&quot; is not an array.  It&#39;s just a variant variable.  OP needs to turn it into an array and your code should work."}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1495045686, "post_id": 44031386, "comment_id": 75091128, "body": "Thanks Johh.  I updated the code based on your comment.  And thanks to David for adding the del argument."}], "tags": [], "owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "is_accepted": false, "score": 1, "last_activity_date": 1495045611, "last_edit_date": 1495045611, "creation_date": 1495042172, "answer_id": 44031386, "question_id": 44028384, "link": "https://stackoverflow.com/questions/44028384/vba-excel-loop-through-2-arrays-together/44031386#44031386", "title": "VBA excel Loop through 2 arrays together", "body": "<p>Adding this sub and replacing the section that is not working with a call to the sub should work.  </p>\n\n<pre><code>Sub RemoveUnwantedValues(ByRef result As String, del)\n\n    Dim i           As Integer\n    Dim arrResult() As String\n\n\n    arrResult = Split(result, \" \")\n\n    For i = LBound(arrResult) To UBound(arrResult)\n        arrResult(i) = Trim(Replace(Replace(Replace(arrResult(i), del, \"\"), del, \"\"), \"  \", \" \"))\n        arrResult(i) = Replace(arrResult(i), \" \", \",\")\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>You can call it this way:  <code>RemoveUnwantedValues result, del</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8026041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f315711525c8a28b9994c7c2b4aeb355?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Black", "link": "https://stackoverflow.com/users/8026041/joe-black"}, "is_accepted": false, "score": 0, "last_activity_date": 1495111636, "last_edit_date": 1495111636, "creation_date": 1495109842, "answer_id": 44047548, "question_id": 44028384, "link": "https://stackoverflow.com/questions/44028384/vba-excel-loop-through-2-arrays-together/44047548#44047548", "title": "VBA excel Loop through 2 arrays together", "body": "<p>Thanks for your help. It turns out i was over complicating things.\nAll i ended up needing to do was remove the join on result remove loop iii and place If instr, del &amp; ServiceSym inside of loop ii.</p>\n\n<pre><code>Sub Service_Symbols()\n\nApplication.ScreenUpdating = False\nDim StringArray() As String\n\nDim i As Long\n\nFor i = Sheet2.Cells(Rows.Count, 11).End(xlUp).Row To 2 Step -1\n'Seperate multiple values in cells\nIf InStr(Cells(i, 11).Value, \",\") &lt;&gt; 0 Then\n    StringArray() = Split(Cells(i, 11).Value, \",\")\n    'Place selected values into array for inclusion\n    For ii = LBound(StringArray) To UBound(StringArray)\n        If IsInArray(StringArray(), \"1\") Or IsInArray(StringArray, \"4\") Or IsInArray(StringArray, \"5\") Or IsInArray(StringArray, \"6\") Or IsInArray(StringArray, \"7\") Or IsInArray(StringArray, \"8\") Then\n            result = StringArray(ii)\n            'Debug.Print i; result\n        End If\n        If InStr(result, \"2\") &lt;&gt; 0 Or InStr(result, \"3\") &lt;&gt; 0 Or InStr(result, \"9\") &lt;&gt; 0 Or InStr(result, \"11\") &lt;&gt; 0 Then\n            del = result\n            'Debug.Print i; \"del-\"; del\n        End If\n    ServiceSym = Replace(result, del, \"\")\n    'Sheet1.Range(\"G\" &amp; i).Value = ServiceSym\n    Debug.Print i; ServiceSym\n\n    Next ii\n\n'transfer selected single values in cells\nElseIf Sheet2.Range(\"K\" &amp; i).Value = \"1\" Or Sheet2.Range(\"K\" &amp; i).Value = \"4\" Or Sheet2.Range(\"K\" &amp; i).Value = \"5\" Or Sheet2.Range(\"K\" &amp; i).Value = \"6\" Or Sheet2.Range(\"K\" &amp; i).Value = \"7\" Or Sheet2.Range(\"K\" &amp; i).Value = \"8\" Then\nresult2 = Sheet2.Range(\"K\" &amp; i).Value\n'Sheet1.Range(\"G\" &amp; i).Value = result2\nDebug.Print i; result2\nEnd If\nNext i\n\nApplication.ScreenUpdating = True\n\n'Call More_Services_Symbols 'Run the more services sub\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8026041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f315711525c8a28b9994c7c2b4aeb355?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Black", "link": "https://stackoverflow.com/users/8026041/joe-black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495111636, "creation_date": 1495033017, "last_edit_date": 1531164843, "question_id": 44028384, "link": "https://stackoverflow.com/questions/44028384/vba-excel-loop-through-2-arrays-together", "title": "VBA excel Loop through 2 arrays together", "body": "<p>I am filling two arrays with values one for inclusion and the other for exclusion. All working to this point. The next part should take the values from each array and replace unwanted values with a blank space. This also works but only for the first value. I know i need a loop here but can't get my head around it. Any pointers would be helpful. If there is a better way, I'm all ears.</p>\n\n<hr>\n\n<pre><code>Sub Service_Symbols()\n\nApplication.ScreenUpdating = False\nDim StringArray() As String\n\nDim i As Long\nDim ii As Long\nDim iii As Long\n\nFor i = Sheet2.Cells(Rows.Count, 11).End(xlUp).Row To 2 Step -1\n    'Seperate multiple values in cells\n    If InStr(Cells(i, 11).Value, \",\") &lt;&gt; 0 Then\n        StringArray() = Split(Cells(i, 11).Value, \",\")\n        'Place selected values into array for inclusion\n        For ii = LBound(StringArray) To UBound(StringArray)\n            If IsInArray(StringArray(), \"1\") Or IsInArray(StringArray, \"4\") Or IsInArray(StringArray, \"5\") Or IsInArray(StringArray, \"6\") Or IsInArray(StringArray, \"7\") Or IsInArray(StringArray, \"8\") Then\n                result = Join(StringArray(), \" \")\n            End If\n        Next ii\n        'Place selected values into array for removal\n        For iii = LBound(StringArray) To UBound(StringArray)\n            ResultDel = StringArray(iii)\n            If InStr(ResultDel, \"2\") &lt;&gt; 0 Or InStr(ResultDel, \"3\") &lt;&gt; 0 Or InStr(ResultDel, \"9\") &lt;&gt; 0 Or InStr(ResultDel, \"11\") &lt;&gt; 0 Then\n            del = ResultDel\n            Debug.Print i; ResultDel\n            End If\n        Next iii\n\n        'This section not working. Needs to be looped\n\n        'Remove unwanted values\n        ServiceSym = Trim(Replace(Replace(Replace(result, del, \"\"), del, \"\"), \"  \", \" \"))\n        ServiceSym = Replace(ServiceSym, \" \", \",\")\n        'Sheet1.Range(\"G\" &amp; i).Value = ServiceSym\n        Debug.Print i; ServiceSym\n        'Debug.Print result\n        'Debug.Print i; del\n\n        'End of this section not working. Needs to be looped\n\n    'transfer selected single values in cells\n    ElseIf Sheet2.Range(\"K\" &amp; i).Value = \"1\" Or Sheet2.Range(\"K\" &amp; i).Value = \"4\" Or Sheet2.Range(\"K\" &amp; i).Value = \"5\" Or Sheet2.Range(\"K\" &amp; i).Value = \"6\" Or Sheet2.Range(\"K\" &amp; i).Value = \"7\" Or Sheet2.Range(\"K\" &amp; i).Value = \"8\" Then\n    result2 = Sheet2.Range(\"K\" &amp; i).Value\n    'Sheet1.Range(\"G\" &amp; i).Value = result2\n    Debug.Print i; result2\n    End If\nNext i\n\nApplication.ScreenUpdating = True\n\n'Call More_Services_Symbols 'Run the more services sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-access"], "owner": {"reputation": 1, "user_id": 8026101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed83116f818625210e1e4476d1e9623?s=128&d=identicon&r=PG&f=1", "display_name": "RustyS", "link": "https://stackoverflow.com/users/8026101/rustys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4382, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1532677911, "creation_date": 1495032422, "last_edit_date": 1495541427, "question_id": 44028148, "link": "https://stackoverflow.com/questions/44028148/connecting-to-access-2016-from-excel-2016-with-vba", "title": "Connecting to Access 2016 from Excel 2016 with VBA", "body": "<p>I'm very new to VBA, and I've been trying to write some code in Excel 2016 that will, when a button is pressed, take a range of cells and write them to a table that I've set up in an Access 2016 database. I'm working out of an .xlsm workbook right now.</p>\n\n<p>I've been basing my code off of the bulk-insert method (building an SQL \"INSERT INTO\" statement) that the submitter posted as an edit to this previous StackOverflow question <a href=\"https://stackoverflow.com/questions/16161865/using-excel-vba-to-export-data-to-ms-access-table\">Using Excel VBA to export data to MS Access table</a> .</p>\n\n<p>So far, here is the VBA I have written (or at least the part of it dealing with the importing into Access). When I run it, I get the error \"Run-time error '-2147467259 (80004005)': Could not find installable ISAM.\". I think the issue is in my connection string, which I've been having trouble with since I can't find any examples of properly-formatted connection strings on the Internet that use Access 2016 and Excel 2016 (mostly older versions).</p>\n\n<pre><code>' Set up the transfer into Access\nDim dbPath As String, dbWb As String, dbWs As String, scn As String, dsh As String, ssql As String\n\nSet cn = CreateObject(\"ADODB.Connection\")\ndbPath = Application.ActiveWorkbook.Path &amp; \"\\MyDatabase.accdb\"\ndbWb = Application.ActiveWorkbook.FullName\ndbWs = Application.ActiveSheet.Name\nscn = \"Provider=Microsoft.ACE.OLEDB.16.0;Data Source=\" &amp; dbPath\n\ndsh = \"[\" &amp; Application.ActiveSheet.Name &amp; \"$]\" &amp; \"Data2\" 'Data2 is the named range of data to be written to Access\n\n' Open the connection with Access\ncn.Open scn\n\n' Create an SQL \"Insert\" statement using the name dsh developed earlier\nssql = \"INSERT INTO DataPortfolio ([Field1], [Field2], [Field3]) \"\nssql = ssql &amp; \"SELECT * FROM [Excel 16.0;HDR=YES;DATABASE=\" &amp; dbWb &amp; \"].\" &amp; dsh\n\n' Execute the SQL statement\ncn.Execute ssql\n</code></pre>\n\n<p>Can anyone see where I may be going wrong? I assume it's in the connection string (scn), but I'm not sure.</p>\n\n<p>Any help is appreciated! Many thanks.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "truncate", "memo"], "comments": [{"owner": {"reputation": 11, "user_id": 8025771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5aee14de0d79fca773a03cd2431d9dd?s=128&d=identicon&r=PG&f=1", "display_name": "tribe", "link": "https://stackoverflow.com/users/8025771/tribe"}, "edited": false, "score": 0, "creation_date": 1495032499, "post_id": 44028144, "comment_id": 75082753, "body": "Sorry, I don&#39;t know how to create table-looking code, so my sample is all messed up. hopefully you will understand my intent, or advise me how to code this properly in this forum."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1495032688, "post_id": 44028144, "comment_id": 75082887, "body": "Try letting it happen, then checking the data type of each field created, you may need to create the table the long way, but based on the input, or just adjust the column, then insert into.  Can you open 2 recordsets, &quot;select * &quot; from both source and dest and check the field type of MBR_LIST please.  Even try the select with the field rather than &quot;&quot; first."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1495043252, "post_id": 44028144, "comment_id": 75089786, "body": "What happens if you omit the <code>INSERT INTO</code> part? Just execute the SELECT?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1495043301, "post_id": 44028144, "comment_id": 75089819, "body": "And try changing the FROM part to <code>FROM (SELECT DISTINCT Table1.USR FROM Table1)  AS B</code>. Or simply <code>FROM Table1</code> - doesn&#39;t <code>ConcatRelated</code> return only one row per USR?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1495044450, "post_id": 44028144, "comment_id": 75090487, "body": "I don&#39;t have an Access SQL solution. I usually just deal with this type of issue on the back end (which in most of my projects is SQL server so I can CAST/CONVERT) or use VBA rather than SQL to work with long strings within Access."}, {"owner": {"reputation": 11, "user_id": 8025771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5aee14de0d79fca773a03cd2431d9dd?s=128&d=identicon&r=PG&f=1", "display_name": "tribe", "link": "https://stackoverflow.com/users/8025771/tribe"}, "edited": false, "score": 0, "creation_date": 1495050220, "post_id": 44028144, "comment_id": 75093545, "body": "Nathan_Sav, I will try your suggestion a bit later, as it looks asking for a bit of time."}, {"owner": {"reputation": 11, "user_id": 8025771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5aee14de0d79fca773a03cd2431d9dd?s=128&d=identicon&r=PG&f=1", "display_name": "tribe", "link": "https://stackoverflow.com/users/8025771/tribe"}, "edited": false, "score": 0, "creation_date": 1495050290, "post_id": 44028144, "comment_id": 75093585, "body": "Andre, the SQL also returns only 320 chars; I will try your other suggestion (DISTINCT) later tonight or tomorrow and let you know of the result."}, {"owner": {"reputation": 11, "user_id": 8025771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5aee14de0d79fca773a03cd2431d9dd?s=128&d=identicon&r=PG&f=1", "display_name": "tribe", "link": "https://stackoverflow.com/users/8025771/tribe"}, "edited": false, "score": 0, "creation_date": 1495051338, "post_id": 44028144, "comment_id": 75094230, "body": "Andre, I&#39;ve actually tried your suggestion with the DISTINCT, and it gives me the same number of chars, 320. And ConcatRelated returns a single row for every USR in the passed record set - that is why I have to do a Group By (or DISTINCT) first."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1495063259, "post_id": 44028144, "comment_id": 75099101, "body": "Interesting. Can you upload a sample database with enough data to reproduce the issue to a file hoster?"}, {"owner": {"reputation": 11, "user_id": 8025771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5aee14de0d79fca773a03cd2431d9dd?s=128&d=identicon&r=PG&f=1", "display_name": "tribe", "link": "https://stackoverflow.com/users/8025771/tribe"}, "edited": false, "score": 0, "creation_date": 1495120590, "post_id": 44028144, "comment_id": 75128759, "body": "Andre, how do I upload? I am new to Stack overflow (I can&#39;t even format the table ;) )..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8025771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5aee14de0d79fca773a03cd2431d9dd?s=128&d=identicon&r=PG&f=1", "display_name": "tribe", "link": "https://stackoverflow.com/users/8025771/tribe"}, "edited": false, "score": 0, "creation_date": 1495050558, "post_id": 44032595, "comment_id": 75093734, "body": "It seems to me your code serves to extract the full Memo field from the table, am I right? My problem is how to insert the full string (7000+ chars) INTO the Memo field in a table, so if I am right about your code, it might not be working for me. Anyway, thanks for it, I&#39;m sure it will be useful later on."}, {"owner": {"reputation": 11, "user_id": 8025771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5aee14de0d79fca773a03cd2431d9dd?s=128&d=identicon&r=PG&f=1", "display_name": "tribe", "link": "https://stackoverflow.com/users/8025771/tribe"}, "edited": false, "score": 0, "creation_date": 1495125595, "post_id": 44032595, "comment_id": 75131885, "body": "This worked, thanks! Regrettably, in the end I need to append this output to a string and export to a text file - and then I guess that bug kicks in and creates some junk after 250+ chars... Bottom line is, it is taking too much time to do this in Access for what I need it for. Still, thank you all for help, its a great community!"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 11, "user_id": 8025771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5aee14de0d79fca773a03cd2431d9dd?s=128&d=identicon&r=PG&f=1", "display_name": "tribe", "link": "https://stackoverflow.com/users/8025771/tribe"}, "edited": false, "score": 0, "creation_date": 1495134317, "post_id": 44032595, "comment_id": 75136827, "body": "Well, check it out. Don&#39;t assume too much without checking."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1495054162, "last_edit_date": 1495054162, "creation_date": 1495046583, "answer_id": 44032595, "question_id": 44028144, "link": "https://stackoverflow.com/questions/44028144/ms-access-memo-field-truncated/44032595#44032595", "title": "MS Access Memo field truncated", "body": "<p>There is a workaround I created years ago using <em>DLookup</em> in a helper function.</p>\n\n<p>Not the fastest, of course, but if anything else fails ...</p>\n\n<p><a href=\"https://www.experts-exchange.com/questions/28554757/Access-Query-truncates-Memo-Field.html#a40434530\" rel=\"nofollow noreferrer\">Access Query truncates Memo Field</a></p>\n\n<p>To insert a long text, use VBA when you have retrieved the values for USR and MBR_LIST:</p>\n\n<pre><code>Dim rs As DAO.Recordset\n\nSet rs = CurrentDb.OpenRecordset(\"Select [USR], MBR_LIST From Table2\")\n\nrs.AddNew\n    rs!USR.Value = USR\n    rs!MBR_LIST.Value = MBR_LIST\nrs.Update\nrs.Close\n\nSet rs = Nothing\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8025771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5aee14de0d79fca773a03cd2431d9dd?s=128&d=identicon&r=PG&f=1", "display_name": "tribe", "link": "https://stackoverflow.com/users/8025771/tribe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 724, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1495054162, "creation_date": 1495032413, "last_edit_date": 1495535491, "question_id": 44028144, "link": "https://stackoverflow.com/questions/44028144/ms-access-memo-field-truncated", "title": "MS Access Memo field truncated", "body": "<p>This issue sounds familiar, but please read it to the end, as it has a twist to similar questions I found in this forum or elsewhere.\nI am using Access 2010 to build a simple app to create some code to execute in another system. Part of it is to convert number of records per user into a single record, with all user entries separated by comma. To illustrate, here is the sample of my input:</p>\n\n<pre><code>USER    MBR\n----    ---- \nUSR1    DRG \nUSR1    ABC \nUSR1    XYZ \nUSR2    123A \nUSR2    ABS2\n</code></pre>\n\n<p>And I need it in this format:</p>\n\n<pre><code>USER   MBR_LIST\n-----  ---------------\nUSR1   DRG, ABC, XYZ\nUSR2   123A, ABS2\n</code></pre>\n\n<p>So far, so familiar. I've used the code posted by Allen Brown back in 2008 (<a href=\"http://allenbrowne.com/func-concat.html\" rel=\"nofollow noreferrer\">http://allenbrowne.com/func-concat.html</a>), but I've run into an issue.\nThe code works fine - when I debug it, I can see that my output string (\"strOut\") has all MBRs for a single user, as expected. Mind you, sometimes this string is over 7,000 char long. So, again following some great advice found around, I've created a table with the MBR_LIST field set to MEMO, and I execute Allen's function as:</p>\n\n<pre><code>INSERT INTO Table2 ( [USR], MBR_LIST )\nSELECT B.USR, ConcatRelated(\"MBR\",\"Table1\",\"Table1.USR = '\" &amp; B.USR &amp; \"'\",\"USR\") AS Mbr_List\nFROM (SELECT Table1.USR FROM Table1 GROUP BY Table1.USR)  AS B;\n</code></pre>\n\n<p>(NOTE: the query is built as such to avoid doing Group By on the Memo field, which is known to be truncating the Memo field)</p>\n\n<p>Still, after doing this, my MBR_LIST field in the table shows only 320 chars (?). </p>\n\n<p>I even tried adding an empty row, as suggested in this post: <a href=\"https://stackoverflow.com/questions/39088758/ms-access-create-table-is-truncating-memo-field\">MS Access Create Table is Truncating Memo Field</a>, but with no success - the field still gets truncated to 320 chars:</p>\n\n<pre><code>INSERT INTO Table2 ( [USR], MBR_LIST )\nSELECT B.USR, \"\" as Mbr_List\nFROM [Table2] as B Where (False)\nUNION ALL\nSELECT B.USR, ConcatRelated(\"MBR\",\"Table1\",\"Table1.USR = '\" &amp; B.USR &amp; \"'\",\"USR\") AS Mbr_List\nFROM (SELECT Table1.USR FROM Table1 GROUP BY Table1.USR)  AS B;\n</code></pre>\n\n<p>As a last resort, using the MID() I've created 20 \"chunks\" of 300 chars each (Mbr_1 to Mbr_20) in my SELECT statement, and I got them all back fine. Then I wrapped this into another SELECT with those chunks concatenated (Mbr_1 &amp; Mbr_2 &amp; ... &amp; Mbr_20) AS Mbr_LIST, and got - 320 chars!</p>\n\n<p>Any ideas why and how to insert/display the full string created by the function?</p>\n\n<p>Thanks,\ntribe</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1495039579, "creation_date": 1495039579, "answer_id": 44030620, "question_id": 44027860, "link": "https://stackoverflow.com/questions/44027860/run-a-macro-when-creating-new-appointment-in-outlook/44030620#44030620", "title": "run a macro when creating new appointment in outlook", "body": "<p>You <code>apt</code> variable is never initialized and remains null. Try to use <code>Application.Inspectors.MewInspector</code> event to check when a new appointment is opened and set apt to <code>Inspector.CurrentItem</code> after checking that it is really an appointment. Note that you can have more than one appointment open, so a single apt variable won't work, you need to have a list or array.</p>\n"}, {"comments": [{"owner": {"reputation": 677, "user_id": 6203583, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10207881417905705/picture?type=large", "display_name": "Massimo Griffani", "link": "https://stackoverflow.com/users/6203583/massimo-griffani"}, "edited": false, "score": 0, "creation_date": 1495180336, "post_id": 44030711, "comment_id": 75153156, "body": "There&#39;s a problem: the macro works just once. If I add a second appointment nothing happen unless i run Application_Startup again. WHY?"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 2, "last_activity_date": 1495039864, "last_edit_date": 1495542878, "creation_date": 1495039864, "answer_id": 44030711, "question_id": 44027860, "link": "https://stackoverflow.com/questions/44027860/run-a-macro-when-creating-new-appointment-in-outlook/44030711#44030711", "title": "run a macro when creating new appointment in outlook", "body": "<p>From <a href=\"https://stackoverflow.com/questions/7996292/outlook-event-newmail-newitem\">outlook event newMail (newItem)</a></p>\n\n<pre><code>Private WithEvents appt As AppointmentItem\nPrivate WithEvents objinspectors As Outlook.Inspectors\n\nPrivate Sub Application_Startup()\n    Set objinspectors = Application.Inspectors\nEnd Sub\n\nPrivate Sub objinspectors_NewInspector(ByVal Inspector As Inspector)\n    If TypeName(Inspector.currentItem) = \"AppointmentItem\" Then\n        MsgBox \"newinspector\"\n        Set appt = Inspector.currentItem    ' &lt;----\n    End If\nEnd Sub\n\nPrivate Sub appt_Write(Cancel As Boolean)\n    MsgBox (\"test ok\")\nEnd Sub\n</code></pre>\n\n<p>appt will be the most recently opened appointment item </p>\n"}], "owner": {"reputation": 677, "user_id": 6203583, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10207881417905705/picture?type=large", "display_name": "Massimo Griffani", "link": "https://stackoverflow.com/users/6203583/massimo-griffani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1305, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592896289, "creation_date": 1495031709, "last_edit_date": 1592896289, "question_id": 44027860, "link": "https://stackoverflow.com/questions/44027860/run-a-macro-when-creating-new-appointment-in-outlook", "title": "run a macro when creating new appointment in outlook", "body": "<p>I'm new to outlook vba.</p>\n\n<p>I'd like to run a macro when I create a new appointment in mycalendar in Outlook 2016 32bit</p>\n\n<p>I tried with</p>\n\n<pre><code>Private WithEvents appt As Outlook.AppointmentItem\n\nPrivate Sub appt_Write(Cancel As Boolean)\nMsgBox (\"test ok\")\nEnd Sub\n</code></pre>\n\n<p>in the ThisOutlookSession module but nothing happens when I edit anda save a new appointment.</p>\n\n<p>What I have to do?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495030268, "post_id": 44027131, "comment_id": 75080935, "body": "What do you intend to do with <code>Optional Sign as String = &quot;,&quot;</code>?  I believe that&#39;s causing the error."}, {"owner": {"reputation": 4782, "user_id": 3914509, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/618920827/picture?type=large", "display_name": "Jeremy Thomas", "link": "https://stackoverflow.com/users/3914509/jeremy-thomas"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495030318, "post_id": 44027131, "comment_id": 75080968, "body": "I&#39;m very unfamiliar with VBA and copied the code from a blog.  I&#39;m assuming it&#39;s an optional argument that is used at the delimiter when combining the selected cells"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1495030505, "post_id": 44027131, "comment_id": 75081116, "body": "Try entering the formula as <code>=PERSONAL.XLSB!combine(I2:I8)</code>.  You may also want to change <code>If Rng.Text &lt;&gt; &quot;,&quot; Then</code> to <code>If Rng.Text &lt;&gt; Sign Then</code> (if the cell contains the value of <code>Sign</code> then don&#39;t include in the return string)."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1495030569, "post_id": 44027131, "comment_id": 75081172, "body": "May also be worth looking at this post: <a href=\"http://stackoverflow.com/questions/31815205/use-personal-xlsb-function-in-new-workbook\" title=\"use personal xlsb function in new workbook\">stackoverflow.com/questions/31815205/&hellip;</a>"}, {"owner": {"reputation": 4782, "user_id": 3914509, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/618920827/picture?type=large", "display_name": "Jeremy Thomas", "link": "https://stackoverflow.com/users/3914509/jeremy-thomas"}, "edited": false, "score": 0, "creation_date": 1495030990, "post_id": 44027131, "comment_id": 75081473, "body": "when I add the workbook prefix it says <code>Cannot find &#39;PERSONAL.XLSB&#39;. Copy from:</code> and opens a &quot;open file&quot; window.  I&#39;m not even sure where that file is stored on macs"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1495031141, "post_id": 44027131, "comment_id": 75081596, "body": "Ahhh - on a Mac.  No idea then, sorry.  But.... hopefully this will work... to find out where it&#39;s stored open the Immediate window, select a module in the Personal workbook and type <code>?Thisworkbook.FullName</code>.  Should give you the path to the workbook - if it&#39;s the same on the Mac."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1495031155, "post_id": 44027131, "comment_id": 75081614, "body": "Quick test, just remove the <code>Optional</code> part so it&#39;s just your range. Then change <code>OutStr = OutStr &amp; Rng.Text &amp; Sign</code> to just <code>OutStr = OutStr &amp; Rng.Text &amp; &quot;,&quot;</code>.  Does it still throw the error?  Anyways, just realizing, I think the main issue is as @DarrenBartrup-Cook - your Excel doesn&#39;t seem to be &quot;seeing&quot; the Personal.xlsb.  Another quick test is to put that code in an Excel&#39;s workbook module (so, create a new Workbook, and put that in &quot;Module1&quot; say and just see if it works there)."}, {"owner": {"reputation": 4782, "user_id": 3914509, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/618920827/picture?type=large", "display_name": "Jeremy Thomas", "link": "https://stackoverflow.com/users/3914509/jeremy-thomas"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1495032019, "post_id": 44027131, "comment_id": 75082353, "body": "@BruceWayne still no luck.  I think  it has to do with making the notebook visible like you said, but I&#39;m just not sure how to accomplish that.  And if I have to do that in every notebook than there is really no benefit to putting it in a public notebook."}, {"owner": {"reputation": 4782, "user_id": 3914509, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/618920827/picture?type=large", "display_name": "Jeremy Thomas", "link": "https://stackoverflow.com/users/3914509/jeremy-thomas"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1495032022, "post_id": 44027131, "comment_id": 75082359, "body": "@DarrenBartrup-Cook I&#39;m not sure what the &quot;Immediate window&quot; is"}, {"owner": {"reputation": 4782, "user_id": 3914509, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/618920827/picture?type=large", "display_name": "Jeremy Thomas", "link": "https://stackoverflow.com/users/3914509/jeremy-thomas"}, "edited": false, "score": 0, "creation_date": 1495032615, "post_id": 44027131, "comment_id": 75082826, "body": "So it seems as though macros work, but functions don&#39;t.  How might I change this into a macro and simply replace the first cell of the selected cells with the final combined product?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1495032855, "post_id": 44027131, "comment_id": 75083011, "body": "@JeremyThomas - I just mentioned to put it in a new workbook as a troubleshooting method, just to test if the VBA code works properly. If the code works in a new workbook (as you have it, or with taking out the <code>Optional</code> part as I mention) then we know the problem is with the <code>Personal.xlsb</code> part, and not the code itself."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1495033215, "post_id": 44027131, "comment_id": 75083322, "body": "Any command entered into the immediate window is immediately executed.  Again, not sure what it would be on the Mac - press <code>Ctrl+G</code> in the VBA window or selecting <code>View ~ Immediate Window</code> from the toolbar."}, {"owner": {"reputation": 4782, "user_id": 3914509, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/618920827/picture?type=large", "display_name": "Jeremy Thomas", "link": "https://stackoverflow.com/users/3914509/jeremy-thomas"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1495033263, "post_id": 44027131, "comment_id": 75083365, "body": "@BruceWayne when I create the function locally, it works fine.  It&#39;s not an issue with the function, just an issue of locating it"}], "owner": {"reputation": 4782, "user_id": 3914509, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/618920827/picture?type=large", "display_name": "Jeremy Thomas", "link": "https://stackoverflow.com/users/3914509/jeremy-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495031183, "creation_date": 1495029825, "question_id": 44027131, "link": "https://stackoverflow.com/questions/44027131/creating-vba-function-in-personal-notebook-results-in-name-error", "title": "Creating VBA function in Personal Notebook results in NAME? error", "body": "<p>I am creating a VBA function to combine cells with a comma delimiter and trying to save it to my personal notebook so that it is available to all notebooks.  For some reason I could get it working when I use the \"Record Macro\" feature but not when I use VBA.</p>\n\n<p>VBA:</p>\n\n<pre><code>Function combine(WorkRng As Range, Optional Sign As String = \",\") As String\n'Update 20130815\nDim Rng As Range\nDim OutStr As String\nFor Each Rng In WorkRng\n    If Rng.Text &lt;&gt; \",\" Then\n        OutStr = OutStr &amp; Rng.Text &amp; Sign\n    End If\nNext\ncombine = Left(OutStr, Len(OutStr) - 1)\nEnd Function\n</code></pre>\n\n<p>...and here is a screenshot showing where it's saved:</p>\n\n<p><a href=\"https://i.stack.imgur.com/j4CRO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j4CRO.png\" alt=\"enter image description here\"></a></p>\n\n<p>but when I type <code>=combine(CELL_RANGE_GOES_HERE)</code> it results in <code>#NAME?</code>.  What am I doing wrong?</p>\n"}, {"tags": ["vba", "textbox", "highlighting"], "comments": [{"owner": {"reputation": 1866, "user_id": 4011717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WeuZA.png?s=128&g=1", "display_name": "wkl", "link": "https://stackoverflow.com/users/4011717/wkl"}, "edited": false, "score": 1, "creation_date": 1495029081, "post_id": 44026616, "comment_id": 75079957, "body": "If you have two problems, please ask two separate questions."}], "answers": [{"tags": [], "owner": {"reputation": 497, "user_id": 3776309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7004e0b78bf0a646c8b3ab1df1ee194?s=128&d=identicon&r=PG&f=1", "display_name": "David Pedack", "link": "https://stackoverflow.com/users/3776309/david-pedack"}, "is_accepted": false, "score": 0, "last_activity_date": 1495031994, "creation_date": 1495031994, "answer_id": 44027977, "question_id": 44026616, "link": "https://stackoverflow.com/questions/44026616/how-to-compare-vba-code-in-2-worksheets/44027977#44027977", "title": "how to compare VBA code in 2 worksheets", "body": "<p>You should ask each question separately.  Nevertheless, for #1, you likely just need to add a bold tags to the html</p>\n\n<pre><code>\"Latest&lt;b&gt;\" &amp; Space(5) &amp; TextBox16 &amp; Space(5) &amp; \"&lt;/b&gt;&lt;br&gt;&lt;br&gt;\"\n</code></pre>\n\n<p>for #2, copy the code into text files, and use a program that compares two files.  there's a bunch of those out there, like kdiff.  </p>\n"}], "owner": {"reputation": 1, "user_id": 8003518, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211486578514565/picture?type=large", "display_name": "Stefano de Gemmis", "link": "https://stackoverflow.com/users/8003518/stefano-de-gemmis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495045570, "creation_date": 1495028532, "last_edit_date": 1495045570, "question_id": 44026616, "link": "https://stackoverflow.com/questions/44026616/how-to-compare-vba-code-in-2-worksheets", "title": "how to compare VBA code in 2 worksheets", "body": "<p>I have 2 problems. </p>\n\n<p>1) I have code which sends out an email with some information. I want that some info are bold. I looked up for other codes, but they seem to have a different structure than mine...</p>\n\n<p>This is the full email and it is made by takings things out of a form + self written text. I want to bold the dates, which are contained in the \"TextBox16\". How is this done?: </p>\n\n<pre><code>enterIf TextBox28 = \"\" = False Then\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet outMail = OutApp.CreateItem(0)\n\nstrbody = \"&lt;font size=\"\"3\"\" face=\"\"Calibri\"\"&gt;\" &amp; _\n          \"Dear person,\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _              \n          \"Latest\" &amp; Space(5) &amp; TextBox16 &amp; Space(5) &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n</code></pre>\n\n<p>2) I have 2 worksheets with VBA code. One is the back up of the other. How to check which lines of code are different?</p>\n\n<p>Thank you all!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "edited": false, "score": 0, "creation_date": 1495036459, "post_id": 44029507, "comment_id": 75085748, "body": "&quot;91: Object variable or With black variable not set&quot; on <code>nRow = Temp.Row</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "edited": false, "score": 0, "creation_date": 1495037002, "post_id": 44029507, "comment_id": 75086114, "body": "Are these items all found on the sheet?"}, {"owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "edited": false, "score": 0, "creation_date": 1495093511, "post_id": 44029507, "comment_id": 75109152, "body": "It is a list of keywords, some may be present, others may not. All may be present or even none."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "edited": false, "score": 0, "creation_date": 1495098969, "post_id": 44029507, "comment_id": 75112762, "body": "Code above amended."}, {"owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "edited": false, "score": 1, "creation_date": 1495107617, "post_id": 44029507, "comment_id": 75118713, "body": "Thanks, it then brought up error if the first row is already the row containing the keywords.  I added an extra <code>IF</code> to say <code>If nRow &lt;&gt; 1 Then</code> and it now appears to be correct. Thanks!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1495098952, "last_edit_date": 1495098952, "creation_date": 1495036118, "answer_id": 44029507, "question_id": 44025900, "link": "https://stackoverflow.com/questions/44025900/vba-to-delete-rows-once-specified-keywords-are-found/44029507#44029507", "title": "VBA to delete rows, once specified keywords are found", "body": "<p>I think this should do it</p>\n\n<pre><code>Sub RemoveExtraCols()\n    Dim wsSrc As Worksheet: Set wsSrc = ThisWorkbook.Worksheets(\"Weights\")\n    Dim wsDest As Worksheet: Set wsDest = ActiveSheet\n    Dim nRow As Long\n    Dim KeyWords() As String\n    Dim Temp As Range, FoundRange As Range, i As Long\n\n    With wsSrc\n        ' SrcRange should be a single contiguous row or column\n        Dim SrcRange As Range: Set SrcRange = .Range(.Cells(5, 37), .Cells(17, 37))\n    End With\n\n    With wsDest\n        Dim SearchRange As Range: Set SearchRange = wsDest.UsedRange\n    End With\n\n    KeyWords = Split(Join(Application.Transpose(SrcRange), \"#\"), \"#\")\n\n    For i = 0 To UBound(KeyWords)\n        If KeyWords(i) &lt;&gt; \"\" Then\n            Set Temp = FindAll(KeyWords(i), SearchRange, LookIn:=xlValues, LookAt:=xlPart)\n            If FoundRange Is Nothing Then\n                Set FoundRange = Temp\n            Else\n                If Not Temp Is Nothing Then Set FoundRange = Application.Union(FoundRange, Temp)\n            End If\n        End If\n    Next i\n\n    If Not FoundRange Is Nothing Then\n        nRow = FoundRange(1).Row\n        Range(\"A1\").Resize(nRow - 1).EntireRow.Delete shift:=xlUp\n    End If\n\n    For i = SearchRange.Columns.Count To 1 Step -1\n        Set Temp = Application.Intersect(SearchRange.Columns(i), FoundRange)\n        If Temp Is Nothing Then\n            SearchRange.Columns(i).EntireColumn.Delete\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 44029507, "answer_count": 1, "score": 0, "last_activity_date": 1495098952, "creation_date": 1495026635, "last_edit_date": 1531164843, "question_id": 44025900, "link": "https://stackoverflow.com/questions/44025900/vba-to-delete-rows-once-specified-keywords-are-found", "title": "VBA to delete rows, once specified keywords are found", "body": "<p>Following on from this question, <a href=\"https://stackoverflow.com/questions/44004996/vba-wildcards-or-partial-matches?noredirect=1#comment75047956_44004996\">VBA wildcards or partial matches</a></p>\n\n<p>As requested, and for the benefit of others.</p>\n\n<p>User Flephal provided the code at the bottom of this text.</p>\n\n<p>The code searches a list of keywords and deletes all columns that do not contain these keywords.</p>\n\n<p>The last part of the problem is to now modify this code so that it will delete any rows above the row containing the keywords The keywords are always on the same row.\nFor example, if the Keywords are on row 5, then rows 1 to 4 need to be deleted, so the keywords are now on row 1.</p>\n\n<p>I need this as I have other formula on another sheet that relies on the keywords being found in <code>ROW(1:1)</code> of the sheet that is being modified by the below code.</p>\n\n<pre><code>    Sub RemoveExtraCols()\n    Dim wsSrc As Worksheet: Set wsSrc = ThisWorkbook.Worksheets(\"Weights\")\n    Dim wsDest As Worksheet: Set wsDest = ActiveSheet\n\n    Dim KeyWords() As String\n    Dim Temp As Range, FoundRange As Range, i As Long\n\n    With wsSrc\n        ' SrcRange should be a single contiguous row or column\n        Dim SrcRange As Range: Set SrcRange = .Range(.Cells(5, 37), .Cells(17, 37))\n    End With\n\n    With wsDest\n        Dim SearchRange As Range: Set SearchRange = wsDest.UsedRange\n    End With\n\n    KeyWords = Split(Join(Application.Transpose(SrcRange), \"#\"), \"#\")\n\n    For i = 0 To UBound(KeyWords)\n        If KeyWords(i) &lt;&gt; \"\" Then\n            Set Temp = FindAll(KeyWords(i), SearchRange, LookIn:=xlValues, LookAt:=xlPart)\n            If FoundRange Is Nothing Then\n                Set FoundRange = Temp\n            Else\n                If Not Temp Is Nothing Then Set FoundRange = Application.Union(FoundRange, Temp)\n            End If\n        End If\n    Next i\n\n    For i = SearchRange.Columns.Count To 1 Step -1\n        Set Temp = Application.Intersect(SearchRange.Columns(i), FoundRange)\n        If Temp Is Nothing Then\n            SearchRange.Columns(i).EntireColumn.Delete\n        End If\n    Next i\nEnd Sub\n\nFunction FindAll(What, _\n    Optional SearchWhat As Variant, _\n    Optional LookIn, _\n    Optional LookAt, _\n    Optional SearchOrder, _\n    Optional SearchDirection As XlSearchDirection = xlNext, _\n    Optional MatchCase As Boolean = False, _\n    Optional MatchByte, _\n    Optional SearchFormat) As Range\n\n    'LookIn can be xlValues or xlFormulas, _\n     LookAt can be xlWhole or xlPart, _\n     SearchOrder can be xlByRows or xlByColumns, _\n     SearchDirection can be xlNext, xlPrevious, _\n     MatchCase, MatchByte, and SearchFormat can be True or False. _\n     Before using SearchFormat = True, specify the appropriate settings for the Application.FindFormat _\n     object; e.g. Application.FindFormat.NumberFormat = \"General;-General;\"\"-\"\"\"\n\n    Dim SrcRange As Range\n    If IsMissing(SearchWhat) Then\n        Set SrcRange = ActiveSheet.UsedRange\n    ElseIf TypeOf SearchWhat Is Range Then\n        Set SrcRange = IIf(SearchWhat.Cells.Count = 1, SearchWhat.Parent.UsedRange, SearchWhat)\n    ElseIf TypeOf SearchWhat Is Worksheet Then\n        Set SrcRange = SearchWhat.UsedRange\n    Else: SrcRange = ActiveSheet.UsedRange\n    End If\n    If SrcRange Is Nothing Then Exit Function\n\n    'get the first matching cell in the range first\n    With SrcRange.Areas(SrcRange.Areas.Count)\n        Dim FirstCell As Range: Set FirstCell = .Cells(.Cells.Count)\n    End With\n\n    Dim CurrRange As Range: Set CurrRange = SrcRange.Find(What:=What, After:=FirstCell, LookIn:=LookIn, LookAt:=LookAt, _\n        SearchDirection:=SearchDirection, MatchCase:=MatchCase, MatchByte:=MatchByte, SearchFormat:=SearchFormat)\n\n    If Not CurrRange Is Nothing Then\n        Set FindAll = CurrRange\n        Do\n            Set CurrRange = SrcRange.Find(What:=What, After:=CurrRange, LookIn:=LookIn, LookAt:=LookAt, _\n            SearchDirection:=SearchDirection, MatchCase:=MatchCase, MatchByte:=MatchByte, SearchFormat:=SearchFormat)\n            If CurrRange Is Nothing Then Exit Do\n            If Application.Intersect(FindAll, CurrRange) Is Nothing Then\n                Set FindAll = Application.Union(FindAll, CurrRange)\n            Else: Exit Do\n            End If\n        Loop\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "powershell"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1495027070, "post_id": 44025607, "comment_id": 75078339, "body": "Lots of us can help with that, but we need something to help from.  Can you show what code you have written/tried so that we can help you fix it?  Please remember we&#39;re not here to write the code for you, but to help you fix problems you&#39;re having with whatever you came up with :)"}, {"owner": {"reputation": 31, "user_id": 7492158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dccacbbc913ded06999093b5a13e43e7?s=128&d=identicon&r=PG&f=1", "display_name": "kiki1989sb", "link": "https://stackoverflow.com/users/7492158/kiki1989sb"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1495027671, "post_id": 44025607, "comment_id": 75078811, "body": "I have something like this with powershell: $path = &quot;C:\\FromFTP*.*&quot; $Destination = &quot;C:\\Backup&quot; Foreach($file in (Get-ChildItem $path)) { \tIf($file.LastWriteTime -gt (Get-Date).adddays(-1).date) \t{ \t\tMove-Item -Path $file.fullname -Destination $Destination \t} }"}, {"owner": {"reputation": 10981, "user_id": 2208505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b30f13eba910edd70ffd2c62920a3169?s=128&d=identicon&r=PG", "display_name": "James C.", "link": "https://stackoverflow.com/users/2208505/james-c"}, "edited": false, "score": 0, "creation_date": 1495027844, "post_id": 44025607, "comment_id": 75078972, "body": "You&#39;ll need to click the edit button just under your question and paste it in, code isn&#39;t really readable in comments."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7492158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dccacbbc913ded06999093b5a13e43e7?s=128&d=identicon&r=PG&f=1", "display_name": "kiki1989sb", "link": "https://stackoverflow.com/users/7492158/kiki1989sb"}, "edited": false, "score": 0, "creation_date": 1495524109, "post_id": 44026749, "comment_id": 75275061, "body": "This is not working. But I don&#39;t get any errors after running the script."}, {"owner": {"reputation": 31, "user_id": 7492158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dccacbbc913ded06999093b5a13e43e7?s=128&d=identicon&r=PG&f=1", "display_name": "kiki1989sb", "link": "https://stackoverflow.com/users/7492158/kiki1989sb"}, "edited": false, "score": 0, "creation_date": 1495524441, "post_id": 44026749, "comment_id": 75275285, "body": "I&#39;ve changed the script from CreationTime to LastWriteTime and that part in the script (deleting older than 14 days) is working. The part where it have to move the files is not working"}, {"owner": {"reputation": 26648, "user_id": 696808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b622a0660b4f8e7cbde1538bb632fc?s=128&d=identicon&r=PG", "display_name": "Bacon Bits", "link": "https://stackoverflow.com/users/696808/bacon-bits"}, "reply_to_user": {"reputation": 31, "user_id": 7492158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dccacbbc913ded06999093b5a13e43e7?s=128&d=identicon&r=PG&f=1", "display_name": "kiki1989sb", "link": "https://stackoverflow.com/users/7492158/kiki1989sb"}, "edited": false, "score": 0, "creation_date": 1495543434, "post_id": 44026749, "comment_id": 75288806, "body": "@kiki1989sb Does the first part return anything with just the Get-ChildItem and Where-Object portions?  If so, try adding the <code>-Verbose</code> option to the Move-Item command (i.e., <code>Move-Item -Destination $Destination -Verbose;</code>) to see what the script is trying to do.  I&#39;d double check the permissions on the destination folder for the account the script is running under, too."}], "tags": [], "owner": {"reputation": 26648, "user_id": 696808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b622a0660b4f8e7cbde1538bb632fc?s=128&d=identicon&r=PG", "display_name": "Bacon Bits", "link": "https://stackoverflow.com/users/696808/bacon-bits"}, "is_accepted": false, "score": 1, "last_activity_date": 1495028861, "creation_date": 1495028861, "answer_id": 44026749, "question_id": 44025607, "link": "https://stackoverflow.com/questions/44025607/move-files-with-todays-modified-date-to-other-folder-then-delete-files-older-the/44026749#44026749", "title": "Move files with todays modified date to other folder then delete files older then two weeks", "body": "<p>Try this:</p>\n\n<pre><code>$Path = \"C:\\FromFTP\";\n$Destination = \"C:\\Backup\";\n\n$Today = (Get-Date).Date;\n\nGet-ChildItem -Path $Path | \n    Where-Object { ($_.LastWriteTime -ge $Today) -and ($_.LastWriteTime -lt $Today.AddDays(1)) } | \n    Move-Item -Destination $Destination;\n\nGet-ChildItem -Path $Path | \n    Where-Object { $_.CreationTime -lt $Today.AddDays(-14) } | \n    Remove-Item;\n</code></pre>\n\n<p>The first line gets every file that was last written to (<code>LastWriteTime</code>) sometime between midnight today an before midnight tomorrow.  Obviously it's difficult to write files tomorrow, but it makes it easy to run the script for a date in the past, too.</p>\n\n<p>The second line deleted every file that was first created (<code>CreationTime</code>) before 14 days before today.  The number of days might be off by one, depending on how you count.</p>\n"}], "owner": {"reputation": 31, "user_id": 7492158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dccacbbc913ded06999093b5a13e43e7?s=128&d=identicon&r=PG&f=1", "display_name": "kiki1989sb", "link": "https://stackoverflow.com/users/7492158/kiki1989sb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495028861, "creation_date": 1495025956, "last_edit_date": 1495028215, "question_id": 44025607, "link": "https://stackoverflow.com/questions/44025607/move-files-with-todays-modified-date-to-other-folder-then-delete-files-older-the", "title": "Move files with todays modified date to other folder then delete files older then two weeks", "body": "<p>Script needs to be run every one week (via task scheduler) and achieve the following:\nWhen the script runs, all files on the date of script run (modified date for files) in certain folder needs to be copied to other folder, when copied, delete everything older 2 weeks from the original folder.</p>\n\n<p>See screenshot for more explanation</p>\n\n<p><a href=\"https://i.stack.imgur.com/TiW5n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TiW5n.png\" alt=\"http://i.imgur.com/zSD0cgn.png\"></a></p>\n\n<p>I have something with powershell:</p>\n\n<pre><code>$path = \"C:\\FromFTP\\*.*\"\n$Destination = \"C:\\Backup\"\nForeach($file in (Get-ChildItem $path))\n{\n    If($file.LastWriteTime -gt (Get-Date).adddays(-1).date)\n    {\n        Move-Item -Path $file.fullname -Destination $Destination\n    }\n}\n</code></pre>\n\n<p>But maybe it could be also with vba..</p>\n\n<p>Can someone help me with that? Thank you!</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 6830560, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/899732e0636206688b429196e4396ff5?s=128&d=identicon&r=PG&f=1", "display_name": "OSX55", "link": "https://stackoverflow.com/users/6830560/osx55"}, "edited": false, "score": 0, "creation_date": 1495030512, "post_id": 44025717, "comment_id": 75081127, "body": "Thank you! I couldn&#39;t quiet figure out how to go trough every row until the date gives back another week &#39;number&#39;. If I want to to it for only one row it&#39;s: <code>=IF(WEEKNUM(A1; 21)=D1; WEEKNUM(A1))</code> But it needs to not only go this one row\u2026"}, {"owner": {"reputation": 182, "user_id": 8023405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628b17284783fbc6aa4abf9e2485ec7c?s=128&d=identicon&r=PG&f=1", "display_name": "Zedee.Chen", "link": "https://stackoverflow.com/users/8023405/zedee-chen"}, "reply_to_user": {"reputation": 140, "user_id": 6830560, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/899732e0636206688b429196e4396ff5?s=128&d=identicon&r=PG&f=1", "display_name": "OSX55", "link": "https://stackoverflow.com/users/6830560/osx55"}, "edited": false, "score": 0, "creation_date": 1495071027, "post_id": 44025717, "comment_id": 75100929, "body": "refer to mrsundquist&#39;s answer, what you need to do is select row C, and Click menu :     data - filter - advanced,  and retrieve the distinct values to row E"}], "tags": [], "owner": {"reputation": 182, "user_id": 8023405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628b17284783fbc6aa4abf9e2485ec7c?s=128&d=identicon&r=PG&f=1", "display_name": "Zedee.Chen", "link": "https://stackoverflow.com/users/8023405/zedee-chen"}, "is_accepted": false, "score": 3, "last_activity_date": 1498820759, "last_edit_date": 1498820759, "creation_date": 1495026213, "answer_id": 44025717, "question_id": 44025562, "link": "https://stackoverflow.com/questions/44025562/excel-vba-going-through-rows-for-specific-date-range/44025717#44025717", "title": "Excel (VBA): Going through rows for specific date range", "body": "<p>You can try formula - <code>weeknum</code> to get values in your <em>\"week\"</em> column, then use <code>sumif</code> to get values.</p>\n\n<p>It will be like below;</p>\n\n<p>Make a column called Week-Number: <code>=WEEKNUM(\"Date Column\", 2)</code> The number 2 assumes that Monday is the first day of the week. </p>\n\n<p>And then apply <KBD>Remove Duplicates</KBD> on that column, and get the Week column.</p>\n\n<p>For column called value use this formula: <code>=SUMIF(\"Week-Number Column\",\"=\"&amp;\"Week Column (each row)\", \"Value Column\")</code></p>\n\n<p>Look at the pictures below; First one shows the answers and the second one shows the formulas:</p>\n\n<p><img src=\"https://i.stack.imgur.com/F14Fs.png\" alt=\"Values\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/YimrB.png\" alt=\"Formulas\"></p>\n"}, {"tags": [], "owner": {"reputation": 2583, "user_id": 2908576, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/yhWY7.jpg?s=128&g=1", "display_name": "HaveSpacesuit", "link": "https://stackoverflow.com/users/2908576/havespacesuit"}, "is_accepted": true, "score": 1, "last_activity_date": 1495036023, "creation_date": 1495036023, "answer_id": 44029478, "question_id": 44025562, "link": "https://stackoverflow.com/questions/44025562/excel-vba-going-through-rows-for-specific-date-range/44029478#44029478", "title": "Excel (VBA): Going through rows for specific date range", "body": "<p>You'll need to add another column to show the week number. Then it is easily done with <code>SUMIF</code>.</p>\n\n<p>The formula in <code>C2</code> is <code>=WEEKNUM(A2,2)</code>. This starts the week on Monday, as your highlighting above shows. (The week numbers are different than what you show. If you want, you can add a <code>-1</code> at the end.)</p>\n\n<p>The formula in <code>F2</code> is <code>=SUMIF(C$2:C$24,E2,B$2:B$24)</code>, then drag it down for future weeks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ymLNv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ymLNv.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 140, "user_id": 6830560, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/899732e0636206688b429196e4396ff5?s=128&d=identicon&r=PG&f=1", "display_name": "OSX55", "link": "https://stackoverflow.com/users/6830560/osx55"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 44029478, "answer_count": 2, "score": 1, "last_activity_date": 1498820759, "creation_date": 1495025848, "question_id": 44025562, "link": "https://stackoverflow.com/questions/44025562/excel-vba-going-through-rows-for-specific-date-range", "title": "Excel (VBA): Going through rows for specific date range", "body": "<p>First of all: I'm just an average Excel user (so not really experienced with formulas and I just heard of VBA as a possible solution).</p>\n\n<p>I have a table with dates (can be multiple ones for each day) and Values for these dates. I now want to get the SUM of all dates of each week (e.g. 8th May-14th May are calendar week 19, so all values belonging to that week should be added to the SUM value of week 19 [red box]).\nThis also should be a one-time setup, so that I can just apply that for all following weeks.</p>\n\n<p>Is there a possible way to solve that with just Excel formulas or do I need VBA (some formulas or/and code would be great!)</p>\n\n<p><a href=\"https://i.stack.imgur.com/BHFgx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BHFgx.png\" alt=\"Example\"></a></p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "url", "download"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1495032543, "post_id": 44025156, "comment_id": 75082776, "body": "I think you have bigger problems than this. The warning on the bottom of the <a href=\"http://www.cboe.com/delayedquote/help\" rel=\"nofollow noreferrer\">CBOE Help Page</a> explicitly states that this auto-download is prohibited and you&#39;ll be blocked."}, {"owner": {"reputation": 21, "user_id": 7831649, "user_type": "registered", "profile_image": "https://graph.facebook.com/789593357858453/picture?type=large", "display_name": "Matas Povilauskas", "link": "https://stackoverflow.com/users/7831649/matas-povilauskas"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1495040235, "post_id": 44025156, "comment_id": 75088002, "body": "I saw that, nonetheless it still would be great to know how to manage that dialogue box to save, for any other occasion with the same problem, thank you"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1495041070, "post_id": 44025156, "comment_id": 75088529, "body": "I suspect solving this general problem of using IE to download and save a file will involve using the <code>Win32 API</code> in a manner similar to <a href=\"http://stackoverflow.com/a/4590561/4717755\">this Python solution</a>. You&#39;ll have to externally reference the <code>Win32</code> functions and grab the Save button from the security pop-up, as the Python example shows."}], "owner": {"reputation": 21, "user_id": 7831649, "user_type": "registered", "profile_image": "https://graph.facebook.com/789593357858453/picture?type=large", "display_name": "Matas Povilauskas", "link": "https://stackoverflow.com/users/7831649/matas-povilauskas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 775, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1495024823, "creation_date": 1495024823, "question_id": 44025156, "link": "https://stackoverflow.com/questions/44025156/excel-vba-controlling-ie-dialog-box-do-you-want-to-open-or-save", "title": "Excel VBA controlling IE dialog box &quot;Do you want to Open or Save&quot;", "body": "<p>I've been searching for how to press save when downloading file with IE and save the file under specific name in a specific location. \n<a href=\"https://i.stack.imgur.com/QEW75.png\" rel=\"nofollow noreferrer\">This is the screen as fas as I go with vba code</a></p>\n\n<p>My code looks like this so far:</p>\n\n<pre><code>Sub BrowseToSite()\n\n\nDim IE As New SHDocVw.InternetExplorer\nDim HTMLDoc As MSHTML.HTMLDocument\nDim HTMLInput As MSHTML.IHTMLElement\nDim HTMLButtons As MSHTML.IHTMLElementCollection\nDim HTMLButton As MSHTML.IHTMLElement\n\nIE.Visible = True\nIE.navigate \"cboe.com/delayedquote/quote-table-download\"\n\nDo While IE.readyState &lt;&gt; READYSTATE_COMPLETE\nLoop\n\nSet HTMLDoc = IE.document\nSet HTMLInput = HTMLDoc.getElementById(\"ContentTop_C005_txtTicker\")\nHTMLInput.Value = \"DJX\"\n\nSet HTMLButtons = HTMLDoc.getElementsByClassName(\"button blue\")\n\nHTMLButtons(0).Click\n\n\nEnd Sub\n</code></pre>\n\n<p>All other sources i have looked didn't worked for me, maybe I am missing something. SendKeys didn't worked either which I think is supposed to be simplest way of achieving pressing save button. What code should i use?</p>\n"}, {"tags": ["excel", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1495024172, "post_id": 44024845, "comment_id": 75076029, "body": "How is <code>PreventPaste</code> being invoked? Presumably triggered by one of the sheet&#39;s event procedures. Can you include that code as well?"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1495024249, "post_id": 44024845, "comment_id": 75076084, "body": "What is <code>r</code>? If it&#39;s a <code>Range</code> you&#39;ll need to specify this in the parameters of the function, e.g. <code>HasValidation(r as Range)</code>"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 1, "creation_date": 1495024334, "post_id": 44024845, "comment_id": 75076150, "body": "Given you&#39;ve not provided your usage of PreventPaste it&#39;s difficult to know what is being put into it. My assumption would be it is designed as a single cell function and you&#39;re trying to pass in a range of cells. try adding a <code>for each cell in target.cells</code> loop to the PreventPaste function. Additionally there are some other red flags here, the use of <code>on error resume next</code> with no return to normal, and x is not dimmed either."}, {"owner": {"reputation": 46, "user_id": 5222322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12ac4adaf5069f1ed3502ac2b55f6fc?s=128&d=identicon&r=PG&f=1", "display_name": "dstoyanova", "link": "https://stackoverflow.com/users/5222322/dstoyanova"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1495024366, "post_id": 44024845, "comment_id": 75076172, "body": "@David Zemens - I updated the queston @ Jordan Yes, I figured that out - I added it but no change"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1495024387, "post_id": 44024845, "comment_id": 75076185, "body": "The use of <code>On Error Resume Next</code> should definitely prevent the 1004 from raising in this case (it occurs if <code>r</code> has no validation assigned). I&#39;m unable to replicate this error."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1495024555, "post_id": 44024845, "comment_id": 75076294, "body": "Function doesn&#39;t fail on a multi-cell range, although it may return unexpected results if some cells have and others do not have validation rule."}, {"owner": {"reputation": 46, "user_id": 5222322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12ac4adaf5069f1ed3502ac2b55f6fc?s=128&d=identicon&r=PG&f=1", "display_name": "dstoyanova", "link": "https://stackoverflow.com/users/5222322/dstoyanova"}, "reply_to_user": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1495024666, "post_id": 44024845, "comment_id": 75076387, "body": "@Zerk - I dimmed the x, how do I return to normal after <code>on error resume next</code>, I am new to vba  David Zemens - It happens when i try to copy cell with data validation to another cell with data validation in the same range by dragging"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1495025031, "post_id": 44024845, "comment_id": 75076662, "body": "@dstoyanova to disable the handler of <code>resume next</code> use <code>on error goto 0</code>. In this case it isn&#39;t breaking anything but is good practice to only use resume next minimally and disable/replace it as soon as possible, otherwise it can mask errors that would otherwise be noticed."}, {"owner": {"reputation": 46, "user_id": 5222322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12ac4adaf5069f1ed3502ac2b55f6fc?s=128&d=identicon&r=PG&f=1", "display_name": "dstoyanova", "link": "https://stackoverflow.com/users/5222322/dstoyanova"}, "edited": false, "score": 0, "creation_date": 1495025529, "post_id": 44024845, "comment_id": 75077080, "body": "Zerk - I am using the thrown error to determine if the range has data validation, if the error is 0 it has, if other then it doesn&#39;t, but it is throwing 1004 despite that the copied cell has data validation"}], "owner": {"reputation": 46, "user_id": 5222322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12ac4adaf5069f1ed3502ac2b55f6fc?s=128&d=identicon&r=PG&f=1", "display_name": "dstoyanova", "link": "https://stackoverflow.com/users/5222322/dstoyanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495029823, "creation_date": 1495023964, "last_edit_date": 1531161705, "question_id": 44024845, "link": "https://stackoverflow.com/questions/44024845/vba-macros-in-excel-range-validation-type-causes-1004", "title": "Vba macros in Excel - Range.Validation.Type Causes 1004", "body": "<p>I am trying to prevent pasting over a dropdown in Excel. The code I came up with is the following:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n    'turn off events so this routine is not continuously fired\n\n    Set BoroughTrainingTookPlaceIn = Range(\"BoroughTrainingTookPlaceIn\")\n    Set StartTimeOfSession = Range(\"StartTimeOfSession\")\n    Set TypeOfSession = Range(\"TypeOfSession\")\n    Set BikeabilityLevelRatingBeforeTraining = Range(\"BikeabilityLevelRatingBeforeTraining\")\n    Set BikeabilityLevelRatingAfterTraining = Range(\"BikeabilityLevelRatingAfterTraining\")\n\n\n    If RangesIntersect(Target, BoroughTrainingTookPlaceIn) Then\n        PreventPaste (BoroughTrainingTookPlaceIn)\n    ElseIf RangesIntersect(Target, StartTimeOfSession) Then\n        PreventPaste (StartTimeOfSession)\n    ElseIf RangesIntersect(Target, TypeOfSession) Then\n        PreventPaste (TypeOfSession)\n    ElseIf RangesIntersect(Target, BikeabilityLevelRatingBeforeTraining) Then\n        PreventPaste (BikeabilityLevelRatingBeforeTraining)\n    ElseIf RangesIntersect(Target, BikeabilityLevelRatingAfterTraining) Then\n        PreventPaste (BikeabilityLevelRatingAfterTraining)\n    End If\n\n    Application.EnableEvents = True\nEnd Sub\nPrivate Function HasValidation(r) As Boolean\n'   Returns True if every cell in Range r uses Data Validation\n    On Error Resume Next\n    x = r.Validation.Type\n    If Err.Number = 0 Then HasValidation = True Else HasValidation = False\nEnd Function\n Function RangesIntersect(ByVal Range1 As Range, ByVal Range2 As Range) As Variant\n    Dim intersectRange As Range\n    Set intersectRange = Application.Intersect(Range1, Range2)\n    If intersectRange Is Nothing Then\n        RangesIntersect = False\n    Else\n        RangesIntersect = True\n    End If\nEnd Function\n Private Function PreventPaste(ByVal Target As Range) As Variant\n    If Not HasValidation(Target) Then\n        Application.Undo\n        MsgBox \"Invalid value. Please chose a value from the dropdown\"\n    End If\nEnd Function\n</code></pre>\n\n<p>The line <code>x = r.Validation.Type</code> is causing Error 1004 when I try to copy by dragging a cell in the dataValdiation Range. I am using named ranges.</p>\n\n<p>I looked trough the already opened questions but didn't find answer there. All help is greatly appreciated.</p>\n\n<p>EDIT:\nI was trying to cut it and not to copy and paste it by dragging. Still for newbies like me might be useful to record the macro first and see what you are actually doing</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 417, "user_id": 7761311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a53159b6ed1d109072ca901e7141641c?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Co", "link": "https://stackoverflow.com/users/7761311/paul-co"}, "edited": false, "score": 0, "creation_date": 1495023663, "post_id": 44024626, "comment_id": 75075647, "body": "what error did you get?"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "reply_to_user": {"reputation": 417, "user_id": 7761311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a53159b6ed1d109072ca901e7141641c?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Co", "link": "https://stackoverflow.com/users/7761311/paul-co"}, "edited": false, "score": 0, "creation_date": 1495023964, "post_id": 44024626, "comment_id": 75075890, "body": "@PaulCo &quot;Select Method or Range Class Failed. It highlights the Line &quot; ActiveSheet.ListObjects(&quot;Table3&quot;).TableStyle = &quot;TableStyleMedium2&quot;`&quot; when it is used the second time"}, {"owner": {"reputation": 417, "user_id": 7761311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a53159b6ed1d109072ca901e7141641c?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Co", "link": "https://stackoverflow.com/users/7761311/paul-co"}, "edited": false, "score": 0, "creation_date": 1495024392, "post_id": 44024626, "comment_id": 75076188, "body": "Also, if you have column B to S, why is your range up to P only? or is it intentional?"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "reply_to_user": {"reputation": 417, "user_id": 7761311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a53159b6ed1d109072ca901e7141641c?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Co", "link": "https://stackoverflow.com/users/7761311/paul-co"}, "edited": false, "score": 0, "creation_date": 1495024654, "post_id": 44024626, "comment_id": 75076373, "body": "Typo on my part. The main sheet that the data is copied over from is B-S because it included a few extra calculated columbs, but the individual sheets only need to be B-P"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1495024788, "post_id": 44025099, "comment_id": 75076465, "body": "I will try this. Is the unlist what will allow me to repeat this for the other sheets?"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1495025013, "post_id": 44025099, "comment_id": 75076645, "body": "I ran it and got this message &quot;Subscript out of range&quot;"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1495025346, "post_id": 44025099, "comment_id": 75076924, "body": "With Worksheets(&quot;Jamie Lorfano&quot;).ListObjects(&quot;Table3&quot;)"}, {"owner": {"reputation": 417, "user_id": 7761311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a53159b6ed1d109072ca901e7141641c?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Co", "link": "https://stackoverflow.com/users/7761311/paul-co"}, "reply_to_user": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1495025401, "post_id": 44025099, "comment_id": 75076969, "body": "I updated the answer. it is due to the listobject. I added a conditional statement to check if a listobject exist"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1495031149, "post_id": 44025099, "comment_id": 75081609, "body": "Thank you. I copied the part for the other sheets I had in the file and it worked perfect. Thanks for the help"}], "tags": [], "owner": {"reputation": 417, "user_id": 7761311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a53159b6ed1d109072ca901e7141641c?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Co", "link": "https://stackoverflow.com/users/7761311/paul-co"}, "is_accepted": true, "score": 0, "last_activity_date": 1495025367, "last_edit_date": 1495025367, "creation_date": 1495024653, "answer_id": 44025099, "question_id": 44024626, "link": "https://stackoverflow.com/questions/44024626/changing-table-style-with-vba-for-multiple-sheets/44025099#44025099", "title": "Changing Table Style with VBA for multiple sheets", "body": "<p>If you are listing a range as a table, make sure to unlist it as well.  </p>\n\n<p>Here is a sample code based from your code above:  </p>\n\n<pre><code>Dim rList As Range\n\nOn Error Resume Next\nWith Worksheets(\"Jamie Lorfano\")\n    If .ListObjects.Count &gt; 0 Then\n        .ListObjects (\"Table3\")\n        Set rList = .Range\n        .Unlist\n    End If\nEnd With\n\nSheets(\"Jamie Lorfano\").Select\n    Range(\"B1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$B$1:P:P\"), , xlYes).Name = _\n        \"Table3\"\n    Range(\"Table3[#All]\").Select\n    ActiveSheet.ListObjects(\"Table3\").TableStyle = \"TableStyleMedium2\"\n\nWith Worksheets(\"Rich Baran\")\n    If .ListObjects.Count &gt; 0 Then\n        .ListObjects (\"Table3\")\n        Set rList = .Range\n        .Unlist\n    End If\nEnd With\n\nSheets(\"Rich Baran\").Select\n    Range(\"B1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$B$1:P:P\"), , xlYes).Name = _\n        \"Table3\"\n    Range(\"Table3[#All]\").Select\n    ActiveSheet.ListObjects(\"Table3\").TableStyle = \"TableStyleMedium2\"\n</code></pre>\n\n<p>I tried the above code and is working fine for me.</p>\n"}], "owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 0, "accepted_answer_id": 44025099, "answer_count": 1, "score": 0, "last_activity_date": 1495025367, "creation_date": 1495023439, "question_id": 44024626, "link": "https://stackoverflow.com/questions/44024626/changing-table-style-with-vba-for-multiple-sheets", "title": "Changing Table Style with VBA for multiple sheets", "body": "<p>I used the code below to change the table style of a table that is copied over from another sheet. The columns use are B-S, with Row one being headers and the rest are the table data. The rows are likely never to exceed row 1000, but if possible I want to only have the table formatted for the rows show. This will vary every time the table gets updated.</p>\n\n<p>I want to change the table style for 9 different sheets, all with the same column headers, they are just divided by sheet for different departments. When I tried to repeat I ran into an error, so I am reaching out for help. Still basic VBA knowledge</p>\n\n<pre><code>`Sheets(\"Rich Baran\").Select\n    Range(\"B1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$B$1:$P:P\"), , xlYes).Name = _\n        \"Table3\"\n    Range(\"Table3[#All]\").Select\n    ActiveSheet.ListObjects(\"Table3\").TableStyle = \"TableStyleMedium2\"\n\nSheets(\"Jamie Lorfano\").Select\n    Range(\"B1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$B$1:P:P\"), , xlYes).Name = _\n        \"Table3\"\n    Range(\"Table3[#All]\").Select\n    ActiveSheet.ListObjects(\"Table3\").TableStyle = \"TableStyleMedium2\"`\n</code></pre>\n"}, {"tags": ["xml", "vba", "excel", "nodes"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1495029169, "post_id": 44024451, "comment_id": 75080038, "body": "Did you really mean <i>BidDocumentVersion</i> which is sibling to <i>TimeSeriesIdentification</i>? There&#39;s a <i>DocumentVersion</i> one level above."}, {"owner": {"reputation": 13, "user_id": 8024515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a9387bd60bd7dbac89f092eb5ccf73?s=128&d=identicon&r=PG&f=1", "display_name": "Laurin_K", "link": "https://stackoverflow.com/users/8024515/laurin-k"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1495033296, "post_id": 44024451, "comment_id": 75083382, "body": "Sorry I totally messed it up, I meant that I&#39;m currently searching through &quot;AllocationTimeSeries&quot; but want to get one tree level above so I can reach &quot;DocumentVersion&quot;. I know it&#39;s a little bit confusing... Original post is now correct."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8024515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a9387bd60bd7dbac89f092eb5ccf73?s=128&d=identicon&r=PG&f=1", "display_name": "Laurin_K", "link": "https://stackoverflow.com/users/8024515/laurin-k"}, "edited": false, "score": 0, "creation_date": 1495634461, "post_id": 44028697, "comment_id": 75337600, "body": "Thank you so much Parfait, your answer really helped me a lot! Also the ErrorHandle works perfectly, it makes my code much clearer now."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 13, "user_id": 8024515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a9387bd60bd7dbac89f092eb5ccf73?s=128&d=identicon&r=PG&f=1", "display_name": "Laurin_K", "link": "https://stackoverflow.com/users/8024515/laurin-k"}, "edited": false, "score": 0, "creation_date": 1495637741, "post_id": 44028697, "comment_id": 75340375, "body": "Wow! I thought you were gone for good, a usual thing of new SO users who mostly ask one and done questions. Glad to hear from you and that I was able to help. Happy coding!"}, {"owner": {"reputation": 13, "user_id": 8024515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a9387bd60bd7dbac89f092eb5ccf73?s=128&d=identicon&r=PG&f=1", "display_name": "Laurin_K", "link": "https://stackoverflow.com/users/8024515/laurin-k"}, "edited": false, "score": 0, "creation_date": 1496070137, "post_id": 44028697, "comment_id": 75499755, "body": "I bet, but your help was too good not to thank you for it! Just a little bit busy ;-)"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1495033803, "creation_date": 1495033803, "answer_id": 44028697, "question_id": 44024451, "link": "https://stackoverflow.com/questions/44024451/searching-through-highest-node-level-in-xml-document/44028697#44028697", "title": "Searching through highest node level in XML Document", "body": "<p>Simply use the <code>xmlElement</code> to select its child <em>DocumentVersion</em> as it will not fall under <em>AllocationTimeSeries</em> node list. Also, below code runs a few adjustments you can consider:</p>\n\n<ol>\n<li>No need to store parsed xml data in any array but directly output values to worksheet.</li>\n<li>In general VBA programming, use error handling and specifically in this case use MSXML's <a href=\"https://msdn.microsoft.com/en-us/library/ms759188(v=vs.85).aspx\" rel=\"nofollow noreferrer\">parseError</a> to replace the <code>If</code> on <code>Load</code> call.</li>\n<li>In general VBA programming, use <code>Option Explicit</code> at the top of the module (above all macros) which raises compile errors on unassigned objects/variables which current code maintains.</li>\n<li>Uninitialize all set objects, not just <em>xmlDoc</em>, to release such resources even if program encounters an error. See implementation in error handling.</li>\n<li>Be sure you work with a well-formed XML file. Your posted sample does not have <code>&lt;Interval&gt;</code> nodes properly closed which will raise a runtime error.</li>\n</ol>\n\n<p>VBA </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub XMLParse()\nOn Error GoTo ErrHandle\n    Dim strFilePath As String\n\n    Dim xmlDoc As MSXML2.DOMDocument60\n    Dim xmlElement As IXMLDOMElement\n    Dim xmlNodeList As IXMLDOMNodeList\n    Dim xmlNode As IXMLDOMNode\n\n    Dim i As Long\n\n    Set xmlDoc = New MSXML2.DOMDocument60\n    With xmlDoc\n        .async = False\n        .setProperty \"ProhibitDTD\", False\n        .validateOnParse = False\n        .resolveExternals = False\n    End With\n\n    strFilePath = \"C:\\Desktop\\testfolder\\testfile.xml\"\n    xmlDoc.Load strFilePath\n\n    Set xmlElement = xmlDoc.DocumentElement\n    Set xmlNodeList = xmlElement.SelectNodes(\"AllocationTimeSeries\")\n\n    i = 1\n    For Each xmlNode In xmlNodeList\n        Worksheets(\"Table1\").Cells(i, 1).Value = xmlElement.SelectSingleNode(\"DocumentVersion\").Attributes.getNamedItem(\"v\").Text\n        Worksheets(\"Table1\").Cells(i, 2).Value = xmlNode.SelectSingleNode(\"TimeSeriesIdentification\").Attributes.getNamedItem(\"v\").Text\n        i = i + 1\n    Next xmlNode\n\nExitSub:    \n    Set xmlElement = Nothing\n    Set xmlNodeList = Nothing\n    Set xmlDoc = Nothing\n    Exit Sub\n\nErrHandle:\n    If xmlDoc.parseError.reason &lt;&gt; \"\" Then\n        MsgBox xmlDoc.parseError.reason, vbCritical, \"XML ERROR\"\n    Else\n        MsgBox Err.Number &amp; \" - \" &amp; Err.Description, vbCritical, \"RUNTIME ERROR\"\n    End If\n    Resume ExitSub\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8024515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a9387bd60bd7dbac89f092eb5ccf73?s=128&d=identicon&r=PG&f=1", "display_name": "Laurin_K", "link": "https://stackoverflow.com/users/8024515/laurin-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 44028697, "answer_count": 1, "score": 1, "last_activity_date": 1495038958, "creation_date": 1495022922, "last_edit_date": 1531164843, "question_id": 44024451, "link": "https://stackoverflow.com/questions/44024451/searching-through-highest-node-level-in-xml-document", "title": "Searching through highest node level in XML Document", "body": "<p>I'm working on a VBA-macro for Excel that automatically imports values from XML-Files into an array and the pastes them into a certain Worksheet. I simplified the code and pasted it below. Currently it searches for the node \"TimeSeriesIdentification\" in the nodelist \"AllocationTimeSeries\" and copies the values into the array (I would create a multiple dimension array to store the other entries as well). Although it occurs only once in the document, I wanted to save the node \"DocumentVersion\" as well. But what should I declare as the xmlNodeList, since \"DocumentVersion\" is on the same tree level as \"AllocationTimeSeries\"? \"TotalAllocationResultDocument\" doesn't work unfortunately...</p>\n\n<pre><code>Dim xmlDoc As MSXML2.DOMDocument60\nDim xmlElement As MSXML2.IXMLDOMElement\nDim xmlNodeList As MSXML2.IXMLDOMNodeList\nDim xmlNode As MSXML2.IXMLDOMNode\nDim xmlAttribute As MSXML2.IXMLDOMAttribute\nDim strFilePath As String\nDim arrx As Integer\nDim arrStrings As Variant\n\nSet xmlDoc = New MSXML2.DOMDocument60\n    With xmlDoc\n        .async = False\n        .setProperty \"ProhibitDTD\", False\n        .validateOnParse = False\n        .resolveExternals = False\n    End With\n\nstrFilePath = \"C:\\Desktop\\testfolder\\testfile.xml\"\n\nIf Not xmlDoc.Load(strFilePath) Then\n    MsgBox (\"File loading failed!\")\n    Exit Sub\nEnd If\n\nSet xmlElement = xmlDoc.DocumentElement\nSet xmlNodeList = xmlElement.SelectNodes(\"AllocationTimeSeries\")\narrx = 1\nReDim arrStrings(100) As Variant\n\nFor Each xmlNode In xmlNodeList\n    arrStrings(arrx) = xmlNode.SelectSingleNode(\"TimeSeriesIdentification\").Attributes.getNamedItem(\"v\").Text\nNext xmlNode\n\nWorksheets(\"Table1\").Activate\n\nFor i = 1 To arrx\n    Cells (1 + i, 1).Value = arrStrings(i)\nNext i\n\nSet xmlDoc = Nothing\n</code></pre>\n\n<p>And this would be a part of the xml I'm working with:</p>\n\n<pre><code>-&lt;TotalAllocationResultDocument xsi:noNamespaceSchemaLocation=\"total-allocation-result-document.xsd\" DtdVersion=\"4\" DtdRelease=\"0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n    &lt;DocumentIdentification v=\"DAILYPRODU-170301-01\"/&gt;\n    &lt;DocumentVersion v=\"1\"/&gt;\n    &lt;DocumentType v=\"A25\"/&gt;\n    &lt;SenderIdentification v=\"SENDERA\" codingScheme=\"A01\"/&gt;\n    &lt;ReceiverIdentification v=\"RECEIVERA\" codingScheme=\"A01\"/&gt;\n   -&lt;AllocationTimeSeries&gt;\n        &lt;TimeSeriesIdentification v=\"TotalAllocationResults_TS_1982400\"/&gt;\n        &lt;BidDocumentVersion v=\"2\"/&gt;\n        &lt;AuctionIdentification v=\"D-DAILYPRODU-170301-01\"/&gt;\n       -&lt;Period&gt;\n            &lt;TimeInterval v=\"2017-02-28T23:00Z/2017-03-01T23:00Z\"/&gt;\n            &lt;Resolution v=\"PT60M\"/&gt;\n           -&lt;Interval&gt;\n                &lt;Pos v=\"1\"/&gt;\n                &lt;Qty v=\"1.0\"/&gt;\n                &lt;PriceAmount v=\"14.42\"/&gt;\n            &lt;/Interval&gt;\n           -&lt;Interval&gt;\n                &lt;Pos v=\"2\"/&gt;\n                &lt;Qty v=\"3.0\"/&gt;\n                &lt;PriceAmount v=\"14.65\"/&gt;\n           -&lt;Interval&gt;\n        &lt;/Period&gt;\n    &lt;/AllocationTimeSeries&gt;\n   -&lt;AllocationTimeSeries&gt;\n        &lt;TimeSeriesIdentification v=\"TotalAllocationResults_TS_1982400\"/&gt;\n        &lt;BidDocumentVersion v=\"2\"/&gt;\n        &lt;AuctionIdentification v=\"D-DAILYPRODU-170301-01\"/&gt;\n       -&lt;Period&gt;\n            &lt;TimeInterval v=\"2017-02-28T23:00Z/2017-03-01T23:00Z\"/&gt;\n            &lt;Resolution v=\"PT60M\"/&gt;\n           -&lt;Interval&gt;\n                &lt;Pos v=\"1\"/&gt;\n                &lt;Qty v=\"5.0\"/&gt;\n                &lt;PriceAmount v=\"14.02\"/&gt;\n            &lt;/Interval&gt;\n           -&lt;Interval&gt;\n                &lt;Pos v=\"2\"/&gt;\n                &lt;Qty v=\"3.0\"/&gt;\n                &lt;PriceAmount v=\"14.67\"/&gt;\n           -&lt;Interval&gt;\n        &lt;/Period&gt;\n    &lt;/AllocationTimeSeries&gt;\n&lt;/TotalAllocationResultDocument&gt;\n</code></pre>\n\n<p>I apologize for my bad use of terms and chaotic coding structure, I just started with VBA like two weeks ago and still have a lot to learn.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1495025937, "creation_date": 1495025937, "answer_id": 44025599, "question_id": 44024274, "link": "https://stackoverflow.com/questions/44024274/vba-autofill-functions-variables-while-typing-code/44025599#44025599", "title": "VBA autofill functions/variables while typing code", "body": "<blockquote>\n  <p>Any advise is helpful</p>\n</blockquote>\n\n<p>1- </p>\n\n<p>Always use <code>Option Explicit</code> and <code>Dim</code> your variables explicitly</p>\n\n<pre><code>Dim CurrentWB as Workbook ' Will make the WB methods appear after typing `CurrentWB.`\n</code></pre>\n\n<p>On the other hand, when you <code>Dim CurrentWB as Object</code> or <code>As Variant</code> (the Variant case is implictly used when you don't use <code>Option Explicit</code>), no intellisense will be available.</p>\n\n<p>2-</p>\n\n<p>In order to have intellisense on variable names, again if you <code>Dim</code> your variables, when you type the firts part of the variable name then you type <code>Ctrl+Space</code>, intellisense will automatically complete it for you if the entered part is unambiguous, or it will prompt show you the possible suggestions.</p>\n"}], "owner": {"reputation": 76, "user_id": 5766916, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lO4w7.jpg?s=128&g=1", "display_name": "MrDominikku", "link": "https://stackoverflow.com/users/5766916/mrdominikku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1843, "favorite_count": 1, "accepted_answer_id": 44025599, "answer_count": 1, "score": 1, "last_activity_date": 1495025937, "creation_date": 1495022426, "question_id": 44024274, "link": "https://stackoverflow.com/questions/44024274/vba-autofill-functions-variables-while-typing-code", "title": "VBA autofill functions/variables while typing code", "body": "<p>I get used to C++/C# environment where you type code and functions/variables can be inserted by selecting them by \"TAB\".</p>\n\n<p>On daily basis I work on excel/access and atm I'm working on big project. My class module has around 100 variables, mostly strings. Is there any option in VBA to auto fill or suggest variable within class module while writing code? For example:</p>\n\n<p><code>CurrentWB.Sheets(PDSheet).Select</code></p>\n\n<p>CurrentWB is set for Workbooks. After dot it doesn't suggest <code>Sheets</code> and after typing brackets it doesn't suggest <code>PDSheet</code> and so on.</p>\n\n<p>Any advise is helfull.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1495019955, "post_id": 44023102, "comment_id": 75072992, "body": "Unfortunately Excel for Mac is awfully put together. Mine crashes all the time and there&#39;s seemingly no real reason for it."}, {"owner": {"reputation": 301, "user_id": 2269532, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c585e45a3f4d8ac541d4a07eb462bbf9?s=128&d=identicon&r=PG", "display_name": "Mike Eburne", "link": "https://stackoverflow.com/users/2269532/mike-eburne"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1495025984, "post_id": 44023102, "comment_id": 75077456, "body": "Thanks Callum,I learnt the hard way to keep things simple if you want compatibility with Apple MAC. However I never expected such a simple statement as this cause this much trouble..."}], "owner": {"reputation": 301, "user_id": 2269532, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c585e45a3f4d8ac541d4a07eb462bbf9?s=128&d=identicon&r=PG", "display_name": "Mike Eburne", "link": "https://stackoverflow.com/users/2269532/mike-eburne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593678432, "creation_date": 1495019176, "last_edit_date": 1593678432, "question_id": 44023102, "link": "https://stackoverflow.com/questions/44023102/excel-vba-on-mac-close-workbook", "title": "Excel VBA on Mac - Close Workbook", "body": "<p>The following code works 100% on PC but on Mac causes a popup message reading \"There was a problem and Microsoft Excel was closed.....\" and an option to Recover work and restart Excel.</p>\n\n<p>The when reopening the workbook you have to cancel several messages to open readonly...</p>\n\n<p>How can I get the Mac to close without this happening...</p>\n\n<pre><code>ActiveWorkbook.Close\n</code></pre>\n\n<p>I have tried all of the following:</p>\n\n<pre><code>ActiveWorkbook.Close False\nActiveWorkbook.Close True\nActiveWorkbook.Close SaveChanges:=False\nActiveWorkbook.Close SaveChanges:-True\n</code></pre>\n\n<p>They all produce the same result...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1499211789, "post_id": 44022757, "comment_id": 76806697, "body": "maybe activecell.calculate"}, {"owner": {"reputation": 54, "user_id": 2248196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4c91286613d5efb4e84e8b7b215c7d?s=128&d=identicon&r=PG", "display_name": "Lukas Kavicky", "link": "https://stackoverflow.com/users/2248196/lukas-kavicky"}, "reply_to_user": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1499259446, "post_id": 44022757, "comment_id": 76829353, "body": "<code>ActiveCell.Calculate</code> is not working for me, change is also triggered after the <code>Debug.Print</code>"}, {"owner": {"reputation": 54, "user_id": 2248196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4c91286613d5efb4e84e8b7b215c7d?s=128&d=identicon&r=PG", "display_name": "Lukas Kavicky", "link": "https://stackoverflow.com/users/2248196/lukas-kavicky"}, "reply_to_user": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1499259842, "post_id": 44022757, "comment_id": 76829693, "body": "@PatrickLepelletier I have found a better solution, see my answer"}], "answers": [{"comments": [{"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1499334807, "post_id": 44907925, "comment_id": 76866192, "body": "the simples solution is to put the change sub in a normal modul in a sub, that you call in change, and also before the print. This way its clean"}], "tags": [], "owner": {"reputation": 54, "user_id": 2248196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4c91286613d5efb4e84e8b7b215c7d?s=128&d=identicon&r=PG", "display_name": "Lukas Kavicky", "link": "https://stackoverflow.com/users/2248196/lukas-kavicky"}, "is_accepted": false, "score": 0, "last_activity_date": 1499259796, "last_edit_date": 1499259796, "creation_date": 1499176695, "answer_id": 44907925, "question_id": 44022757, "link": "https://stackoverflow.com/questions/44022757/trigger-change-event-of-a-worksheet-with-activated-edited-cell-in-a-shape-button/44907925#44907925", "title": "Trigger change event of a worksheet with activated edited cell in a shape/button click event", "body": "<p>I have found two \"hacks\", the first one quite limited, but the second one does the job:</p>\n\n<ol>\n<li><p><code>Selection.Cut</code>:</p>\n\n<pre><code>Public Sub Shape_click()\n  Selection.Cut Selection\n  Debug.Print \"click\"\nEnd Sub\n</code></pre>\n\n<p>It makes the Change event to fire 3 times (2x before \"click\", 1x after that), every time with the right (changed) value.</p>\n\n<p>Of course you need to check the <code>Selection</code> (if it is set, if it's of <code>Range</code> type etc.)</p>\n\n<p>The solution is quite limited as you can't use it with merged cells in the selection (will ask if you want to unmerge them).</p></li>\n<li><p><code>Selection.Value = Selection.Value</code></p>\n\n<pre><code>Public Sub Shape_click()\n  Selection.Value = Selection.Value\n  Debug.Print \"click\"\nEnd Sub\n</code></pre>\n\n<p>Works even with merged cells. There is also need to check <code>Selection</code> if it really contains a range.</p></li>\n</ol>\n"}], "owner": {"reputation": 54, "user_id": 2248196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4c91286613d5efb4e84e8b7b215c7d?s=128&d=identicon&r=PG", "display_name": "Lukas Kavicky", "link": "https://stackoverflow.com/users/2248196/lukas-kavicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1499259796, "creation_date": 1495018254, "question_id": 44022757, "link": "https://stackoverflow.com/questions/44022757/trigger-change-event-of-a-worksheet-with-activated-edited-cell-in-a-shape-button", "title": "Trigger change event of a worksheet with activated edited cell in a shape/button click event", "body": "<p>I have a worksheet with a clickable shape and a class listening to the change events of that sheet:</p>\n\n<p>Sheet1:</p>\n\n<pre><code>Public Sub Shape_click()\n  Debug.Print \"click\"\nEnd Sub\n</code></pre>\n\n<p>Class1:</p>\n\n<pre><code>Private WithEvents sh As Worksheet\n\nPrivate Sub Class_Initialize()\n  Set sh = Sheet1\nEnd Sub\n\nPrivate Sub sh_Change(ByVal Target As Range)\n  Debug.Print \"change: \" &amp; Target.Address\nEnd Sub\n</code></pre>\n\n<p>When I edit a cell in Sheet1 and click directly on the shape the output is</p>\n\n<pre><code>click\nchange: $B$1\n</code></pre>\n\n<p>I would like to trigger the change event in the shape macro so that the change event would occur before printing \"click\". DoEvents, Sleep from kernel32 and activation of some other cell from the Shape_click were not working for me.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1495020561, "post_id": 44022186, "comment_id": 75073444, "body": "Could you elaborate on point 1? What happens if the source file has blank cells?"}, {"owner": {"reputation": 43, "user_id": 3149584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08bb87b0e8060b53db887bde975be8b6?s=128&d=identicon&r=PG&f=1", "display_name": "fizcris", "link": "https://stackoverflow.com/users/3149584/fizcris"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1495021406, "post_id": 44022186, "comment_id": 75074076, "body": "If the Source file has blanks the formula does not work as the function does not recognize the full argument as a <i>range</i>, it stops parsing after the first blank instead."}], "owner": {"reputation": 43, "user_id": 3149584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08bb87b0e8060b53db887bde975be8b6?s=128&d=identicon&r=PG&f=1", "display_name": "fizcris", "link": "https://stackoverflow.com/users/3149584/fizcris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495016968, "creation_date": 1495016640, "last_edit_date": 1495016968, "question_id": 44022186, "link": "https://stackoverflow.com/questions/44022186/vba-copy-columns-between-tables-checking-index", "title": "vba Copy columns between tables checking index", "body": "<p>I have a table in a source document and I need to copy an entire column and paste it in another table in another Workbook but the cells of the column have to be pasted in terms of an <strong>Index</strong> (As the source and matching rows are not in the same order, and they cannot be)</p>\n\n<p>I have created some code that copies the values using a vloockup function, but it shows two limitations:</p>\n\n<ol>\n<li><strong>The source file is not allowed to have blank spaces</strong></li>\n<li><strong>There is no way to copy also the format of the cell.</strong></li>\n</ol>\n\n<p>Could you give me some guidance in the matter.</p>\n\n<p>P.S: I am avoiding for loops in order to keep a good performance of the program , for that the use of tables, it is a bit more messy when writing code but it result in lower computation time. </p>\n\n<p>Here is the solution that I am currently using:</p>\n\n<pre><code>Sub ss_action(path As String)\n\nDim formula As String\n\nDim prevFile As String\nDim temp As String\n\n    path = Dir(path)\n    prevFile = path + \"!MyTable[[MyColumn1]:[MyColumnX]]\"\n\n    temp = \"VLOOKUP([@MyColumn1],\" &amp; prevFile &amp; \",3,0)\"\n\n    formula = \"=IF(\" &amp; temp &amp; \"&lt;&gt; 0,\" &amp; temp &amp; \",\"\"\"\")\"\n\n    With Workbooks(taqrgetFile).Worksheets(\"TargetSheet\")\n        .Range(\"Table1[MyColumnX]\").NumberFormat = \"General\"\n        .Range(\"Table1[MyColumnX]\").formula = formula\n        .Range(\"Table1[MyColumnX]\").Value = .Range(\"MyTable[MyColumnX]\").Value\n        .Activate\n    End With\n\n    MsgBox (\"Import sucessfull\")\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel", "batch-file", "scheduled-tasks"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1495019617, "post_id": 44022096, "comment_id": 75072748, "body": "So, why not make &quot;HamtaData&quot; onworkbookopen? <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196215.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff196215.aspx</a>"}, {"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1495021569, "post_id": 44022096, "comment_id": 75074172, "body": "@Andreas Maby it could work but i think, beacuse the file needs to be opened att several other times this could be a problem. The macro itself takes about 30 minutes to run so i wouldnt want to it to start every time i would like to check something in the file."}, {"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1495446947, "post_id": 44022096, "comment_id": 75239069, "body": "Nobody that has a clue?? I have tried multiple suggestions with code line in script,        objExcel.Application.Run &quot;&#39;full path to excel file&#39;!module name.macro name&quot; and nothing works. I get error cant run code."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1495450126, "post_id": 44110670, "comment_id": 75241082, "body": "Never used userforms before so thanks! Awesome stuff @Andreas Thnak u!"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1495451788, "post_id": 44110670, "comment_id": 75242204, "body": "@DL1 No problem. One thing I have noticed is that the sendkeys() will fire even if you click no. Just to be safe, keep the messagebox with &quot;don&#39;t run&quot;. This will give the sendkey a safe place to hit enter. Without this msgbox it will hit enter in the workbook. Maybe not a big deal, but better to be safe than sorry."}, {"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1495541830, "post_id": 44110670, "comment_id": 75287647, "body": "Sorry @Andreas but i have another question if thats alright eventough the question is answered by u. When the script opens the workbook i cant have someone push ok in the msgbox that says run macro, if this is what starts the macro run process i mean. When i try to remove the msgbox for Macro Run the macro dont start. Any ideas would be greatly appriciated!"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1495543817, "post_id": 44110670, "comment_id": 75289100, "body": "@DL1 The userform is needed. But the messageboxes was just &quot;placeholders&quot; to show what was what. So in button1_click() you should remove the &quot;msg&quot; line and add your code there. But you need to keep the unload line."}, {"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1495544048, "post_id": 44110670, "comment_id": 75289301, "body": "Thank u @Andreas I wrote a call HamtaData codeline and when i doubleclick the script to run it manualy it works but with task schedual its dead, Guess there something i am missing here."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1495544167, "post_id": 44110670, "comment_id": 75289403, "body": "That is odd. So the code runs automatically if you just open the workbook and wait the five seconds? But if task scheduler does it, it does not run? Need to think...."}, {"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 1, "creation_date": 1495547394, "post_id": 44110670, "comment_id": 75291965, "body": "I figured out a smart other way to solve this problem if i can say it myself. My script only opens the workbook and in the workbook open sub i wrote a weekday and on time procedure. So my sub checks if the day is for example Tuesday and the time is let say 0700 then it runs HamtaData, Otherwise nothing"}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": true, "score": 1, "last_activity_date": 1495449202, "creation_date": 1495449202, "answer_id": 44110670, "question_id": 44022096, "link": "https://stackoverflow.com/questions/44022096/script-to-run-vba-code-in-specifik-workbook-at-certain-time/44110670#44110670", "title": "script to run vba code in specifik workbook at certain time", "body": "<p>Ok. I will give you an answer that I kind of gave you in the comments.  </p>\n\n<p>I made a demo file to test it. <a href=\"http://hoppvader.nu/Run.xlsm\" rel=\"nofollow noreferrer\">http://hoppvader.nu/Run.xlsm</a>  </p>\n\n<p>Basically, it's a run on workbook open. Ask user if he/she wants to run the macro.<br>\nIf user is not present (inactive for 5 seconds) a sendkey will press enter, meaning run the macro.  </p>\n\n<p>This file then needs to be excecuted by windows task schedule and you need to make sure the \"enable content warning\" does not display by either disable the warning (bad idea) or create a signature for this macro (much better) <a href=\"https://support.office.com/en-us/article/Digitally-sign-a-macro-project-6e5de679-01d4-4387-85e0-92e3e9a49483\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Digitally-sign-a-macro-project-6e5de679-01d4-4387-85e0-92e3e9a49483</a> .  </p>\n\n<p>A \"problem\" with this is that the wait() will wait even if you click on \"No\", so this macro will cost you five seconds of your life each time you open it.  </p>\n\n<p>Code that runs in the file above: </p>\n\n<pre><code>Private Sub Workbook_Open()\n    UserForm1.Show 0\n    newHour = Hour(Now())\n    newMinute = Minute(Now())\n    newSecond = Second(Now()) + 5\n    waitTime = TimeSerial(newHour, newMinute, newSecond)\n    Application.Wait waitTime\n    Application.SendKeys (\"~\")\nEnd Sub\n</code></pre>\n\n<p>and  </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    MsgBox \"Run macro\"\n    Unload Me\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    MsgBox \"Don't run macro\"\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KhfQh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KhfQh.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 44110670, "answer_count": 1, "score": 1, "last_activity_date": 1495449202, "creation_date": 1495016407, "last_edit_date": 1495447568, "question_id": 44022096, "link": "https://stackoverflow.com/questions/44022096/script-to-run-vba-code-in-specifik-workbook-at-certain-time", "title": "script to run vba code in specifik workbook at certain time", "body": "<p>I know nothing about scripts and batch files, but i have maneged to read some about it to be able to start and try to write a code that i then want to put in my windows task schedule. </p>\n\n<p>What i want to do is, Open an specifik excel workbook, run a macro named HamtaData and then save workbook and close. </p>\n\n<p>what i have today is, Script (Filename STARTexcel)</p>\n\n<pre><code>dim args, objExcel\n\nset args = wscript.arguments\nset objExcel = CreateObject (\"Excel.Application\")\n\nstart Excel.exe \"\\\\global.com\\home\\Se\\58\\dx\\Desktop\\Test\\Deliveries.xlsm\" 'This is the workbook i want to open.\nobjExcel.run \"HamtaData\" ' this is the macro i want to run.\n\nobjExcel.activeworkbook.Save\nobjExcel.activeworkbook.Close(0)\nobjExcel.Quit\n</code></pre>\n\n<p>My batch file is, </p>\n\n<pre><code> cscript STARTexcel.vbs \"\\\\global.com\\home\\Se\\58\\dx\\Desktop\\Test\\Deliveries.xlsm\"\n</code></pre>\n\n<p>i am guessing i am missing a few big pieces but my googling isnt that smart in this area. </p>\n\n<p>I am thinking that my batch file is what i then should make my windows task schedule run at a certain time in the future.</p>\n\n<p>I have also tried this line of code that i found on google and edited it to fit my needs with no sucess. </p>\n\n<pre><code>   'Code should be placed in a .vbs file\n      Set objExcel = CreateObject(\"Excel.Application\")\n  objExcel.Application.Run \"'C:\\Users\\Ryan\\Desktop\\Sales.xlsm'SalesModule.SalesTotal\"\n      objExcel.DisplayAlerts = False \n objExcel.Application.Save \n      objExcel.Application.Quit\n  Set objExcel = Nothing\n</code></pre>\n\n<p>Here i get error cant save workbook. Any Ideas? \nThanks in advance,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1495014804, "post_id": 44021117, "comment_id": 75069657, "body": "Since there are plenty of examples on SO of how to find the last column (and last row) dynamically, what, exactly is your problem?"}, {"owner": {"reputation": 85, "user_id": 5209360, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/046756d414e28341f6d13fb63b5b8327?s=128&d=identicon&r=PG&f=1", "display_name": "Ghrafkly", "link": "https://stackoverflow.com/users/5209360/ghrafkly"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1495020076, "post_id": 44021117, "comment_id": 75073098, "body": "@RonRosenfeld I have not found any examples that answers my specific requirements. If you know of some, a link would be greatly appreciated"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1495023674, "post_id": 44021117, "comment_id": 75075657, "body": "You want code that specifies a formula to do the sum under all the rows of each column. Not code that does the sum as the title suggest. Please edit the title to make it clear what you want to be done."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1495051610, "post_id": 44021117, "comment_id": 75094412, "body": "If the answers posted below are &quot;<i>too complex for what I need</i>&quot;, then I suspect you may not understand how the code you are using is working.  That being the case, you may need to hire someone to develop and maintain the process you require."}, {"owner": {"reputation": 85, "user_id": 5209360, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/046756d414e28341f6d13fb63b5b8327?s=128&d=identicon&r=PG&f=1", "display_name": "Ghrafkly", "link": "https://stackoverflow.com/users/5209360/ghrafkly"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1495086465, "post_id": 44021117, "comment_id": 75104994, "body": "@RonRosenfeld I am trying to teach myself VBA and macros. The answer that I was given below was above my current level of knowledge"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 5209360, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/046756d414e28341f6d13fb63b5b8327?s=128&d=identicon&r=PG&f=1", "display_name": "Ghrafkly", "link": "https://stackoverflow.com/users/5209360/ghrafkly"}, "edited": false, "score": 0, "creation_date": 1495020017, "post_id": 44021673, "comment_id": 75073045, "body": "While it looks good. This is a tad too complex for what I need. Is there anyway to do it, continuing in the fashion I am using?"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1495015374, "creation_date": 1495015374, "answer_id": 44021673, "question_id": 44021117, "link": "https://stackoverflow.com/questions/44021117/how-to-i-create-code-that-can-sum-an-unknown-number-columns-and-fixed-number-of/44021673#44021673", "title": "How to I create code that can sum an unknown number columns and fixed number of rows?", "body": "<p>Use <code>R1C1</code> notation like this.</p>\n\n<pre><code>With Sheet1 '/* Change with your actual sheet code name */\n    Dim lc As Long, fr As Long\n    Dim r As Range, c As Range\n\n    fr = 3 '/* change it to your actual static row\n    lc = .Cells(fr, .Columns.Count).End(xlToLeft).Column\n    Set r = .Range(\"A1\", .Cells(3, lc))\n    For Each c In r.Offset(fr).Resize(1)\n        If Not c.HasFormula Then\n            c.FormulaR1C1 = \"=SUM(R[-\" &amp; fr &amp; \"]C:R[-1]C)\"\n            Exit For\n        End If\n    Next\nEnd With\n</code></pre>\n\n<p>Should reside in a <code>Module</code> then assign in a <code>Button</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 8026223, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CIcJ75rsMko/AAAAAAAAAAI/AAAAAAAABj8/lfxGwjRKor8/photo.jpg?sz=128", "display_name": "Naveen Goyal", "link": "https://stackoverflow.com/users/8026223/naveen-goyal"}, "is_accepted": false, "score": 0, "last_activity_date": 1495032714, "creation_date": 1495032714, "answer_id": 44028269, "question_id": 44021117, "link": "https://stackoverflow.com/questions/44021117/how-to-i-create-code-that-can-sum-an-unknown-number-columns-and-fixed-number-of/44028269#44028269", "title": "How to I create code that can sum an unknown number columns and fixed number of rows?", "body": "<p>Below is the function that I have created for the output that you are looking for in your above example. This code will add any number of columns and will give you the total in 5th row.You can implement this function on a button.</p>\n\n<pre><code>Sub AddColumns()\n\nDim ColumnCount As Integer\nDim Rownumber As Integer\nDim ColumnNumber As Integer\nDim TotalValue As Integer\n\nColumnCount = ActiveSheet.UsedRange.Columns.Count\nFor ColumnNumber = 1 To ColumnCount\nTotalValue = 0\n    For Rownumber = 2 To 4\n        TotalValue = TotalValue + Cells(Rownumber, ColumnNumber)\n    Next Rownumber\n    Cells(5, ColumnNumber) = TotalValue\nNext ColumnNumber\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 5209360, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/046756d414e28341f6d13fb63b5b8327?s=128&d=identicon&r=PG&f=1", "display_name": "Ghrafkly", "link": "https://stackoverflow.com/users/5209360/ghrafkly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495032714, "creation_date": 1495014018, "question_id": 44021117, "link": "https://stackoverflow.com/questions/44021117/how-to-i-create-code-that-can-sum-an-unknown-number-columns-and-fixed-number-of", "title": "How to I create code that can sum an unknown number columns and fixed number of rows?", "body": "<p>I am trying to write code that will be able to add any number of columns in a spreadsheet. I am well aware this can be hard-coded, however I am trying to write code that can work with any number of columns without needing to change the code everytime. </p>\n\n<p>This is what I'd like to output (Totals are listed at the bottom of each column):</p>\n\n<pre><code>  A   |   B                                        A   |   B   |   C\n----- | -----                                    ----- | ----- | -----\n  20  |   30                                       20  |   30  |    4\n----- | -----                                    ----- | ----- | -----\n   3  |   45      Now another column is added:      3  |   45  |   55    \n----- | -----                                    ----- | ----- | -----\n  13  |    4                                       13  |    4  |   15\n-------------                                    ---------------------\n  36  |   79                                       36  |   79  |   74\n</code></pre>\n\n<p>Here is my current code:</p>\n\n<pre><code>Sub Button1_Click()\n    Range(\"b1\").Select\n    ActiveCell.End(xlDown).Select\n    Range(\"b1\").Select\n    ActiveCell.End(xlDown).Select\n    Dim vStartRow As Integer\n    vStartRow = 2\n    Dim vEndRow As Integer\n    vEndRow = ActiveCell.Row\n    Dim vStartColumn As Integer\n    vStartColumn = 2\n    Dim vEndColumn As Integer\n    vEndColumn = ActiveCell.Column\n    Cells(vEndRow + 1, vEndColumn).Formula = \"=sum(b\" &amp; vStartRow &amp; \":b\" &amp; vEndRow &amp; \")\"\n    Cells(vEndRow, vEndColumn + 1).Select\nEnd Sub\n</code></pre>\n\n<p>Note: I would like each calculation to happen when a button is clicked instead of all at once</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 7469343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b438308d9221bdcfe21c90468043e6?s=128&d=identicon&r=PG", "display_name": "Hocus", "link": "https://stackoverflow.com/users/7469343/hocus"}, "is_accepted": true, "score": 1, "last_activity_date": 1495014696, "creation_date": 1495014696, "answer_id": 44021390, "question_id": 44021065, "link": "https://stackoverflow.com/questions/44021065/remove-unwanted-characters-from-all-cells-within-a-column-in-excel-vba/44021390#44021390", "title": "remove unwanted characters from all cells within a column in excel vba", "body": "<p>You can reuse your loop or a version of a loop to loop through the cells.</p>\n\n<p>There may be a better way than this, but it should work</p>\n\n<pre><code>Sub Test()\nDim a$, b$, c$, k As Integer, LastR#, x As Long\n\nLastR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor x = 1 To LastR\n    a = Range(\"A\" &amp; x).Value\n    c = \"\"\n    For I = 1 To Len(a$)\n        b = Mid(a$, I, 1)\n        If b$ Like \"[A-Z,a-z,0-9]\" Then\n            c = c &amp; b\n        End If\n    Next I\n    Range(\"G\" &amp; x).Value = c\nNext x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4964185, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207051014017675/picture?type=large", "display_name": "Phyo Min Yu", "link": "https://stackoverflow.com/users/4964185/phyo-min-yu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 44021390, "answer_count": 1, "score": 1, "last_activity_date": 1495014696, "creation_date": 1495013889, "last_edit_date": 1531164843, "question_id": 44021065, "link": "https://stackoverflow.com/questions/44021065/remove-unwanted-characters-from-all-cells-within-a-column-in-excel-vba", "title": "remove unwanted characters from all cells within a column in excel vba", "body": "<p>I have a vba code to remove characters except A-Z, a-z or 0-9 from A1 cell to G1 cell. How could I iterate for a whole A:A into G:G? The code I have only works for only a cell. I want to do all cells within a column. Please kindly help.</p>\n\n<pre><code>   Sub test()     \n       Dim a$, b$, c$, k As Integer\n\n       a$ = Range(\"A1\").Value\n       For i = 1 To Len(a$)\n           b$ = Mid(a$, i, 1)\n           If b$ Like \"[A-Z,a-z,0-9]\" Then\n               c$ = c$ &amp; b$\n       End If\n       Next i\n       Range(\"G1\").Value = c$     \n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8024441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9b1282afc19fc4819a23419acb8d8d?s=128&d=identicon&r=PG&f=1", "display_name": "user8024441", "link": "https://stackoverflow.com/users/8024441/user8024441"}, "edited": false, "score": 0, "creation_date": 1495080671, "post_id": 44032346, "comment_id": 75103170, "body": "Giving Run Time Error Object Required : For i = 2 To UsedRange.Rows.Count"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 11, "user_id": 8024441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9b1282afc19fc4819a23419acb8d8d?s=128&d=identicon&r=PG&f=1", "display_name": "user8024441", "link": "https://stackoverflow.com/users/8024441/user8024441"}, "edited": false, "score": 0, "creation_date": 1495120733, "post_id": 44032346, "comment_id": 75128857, "body": "@user8024441 This works great for me. However i have a made a small change to the answer. Try now"}, {"owner": {"reputation": 11, "user_id": 8024441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9b1282afc19fc4819a23419acb8d8d?s=128&d=identicon&r=PG&f=1", "display_name": "user8024441", "link": "https://stackoverflow.com/users/8024441/user8024441"}, "edited": false, "score": 0, "creation_date": 1495191999, "post_id": 44032346, "comment_id": 75160764, "body": "Hi, code is working but their is a issue which if you could help with would solve a lot of problems:   when it is copying data from SheetB to SheetA it copy/Paste complete ROW due to which data in other columns in sheetB is overwritten by this which cannot happen in mycase .   To elaborate if Sheet B (Column A and B are getting Copied) and Pasted (To sheet B Column A and B it should not erase data present in C and D .......) . I Have tried a lot not getting anywhere if you know of something plz help"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 11, "user_id": 8024441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9b1282afc19fc4819a23419acb8d8d?s=128&d=identicon&r=PG&f=1", "display_name": "user8024441", "link": "https://stackoverflow.com/users/8024441/user8024441"}, "edited": false, "score": 0, "creation_date": 1495207783, "post_id": 44032346, "comment_id": 75171732, "body": "@user8024441 I have updated the answer. Please try now it should work. Please mark answer as correct if you found this useful."}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": true, "score": 0, "last_activity_date": 1495207739, "last_edit_date": 1495207739, "creation_date": 1495045729, "answer_id": 44032346, "question_id": 44020790, "link": "https://stackoverflow.com/questions/44020790/i-need-a-way-to-select-perticular-rows-from-one-excel-sheet-and-copy-them-in-oth/44032346#44032346", "title": "I need a way to Select perticular rows from one excel sheet and copy them in other if condition matches", "body": "<p>A simple macro to do your task,</p>\n\n<pre><code>Sub copyrow()\nDim i As Long, j As Long\nj = Sheets(\"SheetA\").Cells(Rows.Count, \"A\").End(xlUp).Row\nFor i = 2 To Sheets(\"SheetB\").Cells(Rows.Count, \"A\").End(xlUp).Row\n    If InStr(Cells(i, 2), \"abc\") &gt; 0 Then\n        Sheets(\"SheetA\").Cells((j + 1), \"A\") = Cells(i, 1)\n        Sheets(\"SheetA\").Cells((j + 1), \"B\") = Cells(i, 2)\n        j = Sheets(\"SheetA\").Cells(Rows.Count, \"A\").End(xlUp).Row\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>This macro copies the rows from <code>SheetB</code> to <code>SheetA</code> if <code>abc</code> is present (case sensitive). Let me know if you need anything else.</p>\n"}], "owner": {"reputation": 11, "user_id": 8024441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9b1282afc19fc4819a23419acb8d8d?s=128&d=identicon&r=PG&f=1", "display_name": "user8024441", "link": "https://stackoverflow.com/users/8024441/user8024441"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 44032346, "answer_count": 1, "score": -5, "last_activity_date": 1495207739, "creation_date": 1495013232, "last_edit_date": 1531161705, "question_id": 44020790, "link": "https://stackoverflow.com/questions/44020790/i-need-a-way-to-select-perticular-rows-from-one-excel-sheet-and-copy-them-in-oth", "title": "I need a way to Select perticular rows from one excel sheet and copy them in other if condition matches", "body": "<p>I have a table1 in sheet A and a table2 in sheet B (B has 2 columns Date &amp; ContentXYZ).</p>\n\n<p>Conditions: If any cell in ContentXYZ column of Sheet B contains a substring say \"abc\" copy that complete row to table1 in sheet A.  Similarly this has to done for every row in Table 2.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 1, "creation_date": 1495013173, "post_id": 44020393, "comment_id": 75068509, "body": "Check this - <a href=\"http://stackoverflow.com/questions/18355462/create-line-chart-for-many-series\">link</a>"}, {"owner": {"reputation": 739, "user_id": 4421382, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cf1169dc3198dc684ba30b4b08d0bff9?s=128&d=identicon&r=PG&f=1", "display_name": "Engo", "link": "https://stackoverflow.com/users/4421382/engo"}, "reply_to_user": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1495014123, "post_id": 44020393, "comment_id": 75069179, "body": "@jivko When I follow this tutorial I get this as output: <a href=\"http://i.imgur.com/8PKuEUP.png\" rel=\"nofollow noreferrer\">i.imgur.com/8PKuEUP.png</a>. I need to get rid of &quot;sum of value&quot;. Any idea how to do this?"}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 1, "creation_date": 1495015057, "post_id": 44020393, "comment_id": 75069801, "body": "When you click on the chart, on the right will appear the pivot chart fields. There in the lower right corner you&#39;ll find VALUES with Sum of values inside. Click on it and select Value Field Settings. There you can select what to display instead of SUM."}, {"owner": {"reputation": 739, "user_id": 4421382, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cf1169dc3198dc684ba30b4b08d0bff9?s=128&d=identicon&r=PG&f=1", "display_name": "Engo", "link": "https://stackoverflow.com/users/4421382/engo"}, "reply_to_user": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1495015475, "post_id": 44020393, "comment_id": 75070076, "body": "@jivko Thank you, this solved my problem! Strange that I couldn&#39;t find this answer on stack. Please create an answer so that I can assign your answer as helpful."}], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "is_accepted": true, "score": 1, "last_activity_date": 1495070071, "last_edit_date": 1495540039, "creation_date": 1495070071, "answer_id": 44037079, "question_id": 44020393, "link": "https://stackoverflow.com/questions/44020393/how-to-plot-3-lines-based-on-filters-with-macro-in-excel/44037079#44037079", "title": "How to plot 3 lines based on filters with macro in Excel?", "body": "<p>Check this <a href=\"https://stackoverflow.com/questions/18355462/create-line-chart-for-many-series\">link</a></p>\n\n<p>When you click on the chart, on the right will appear the pivot chart fields. There in the lower right corner you'll find VALUES with Sum of values inside. Click on it and select Value Field Settings. There you can select what to display instead of SUM.</p>\n"}], "owner": {"reputation": 739, "user_id": 4421382, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cf1169dc3198dc684ba30b4b08d0bff9?s=128&d=identicon&r=PG&f=1", "display_name": "Engo", "link": "https://stackoverflow.com/users/4421382/engo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 44037079, "answer_count": 1, "score": -2, "last_activity_date": 1495070071, "creation_date": 1495012251, "last_edit_date": 1495012595, "question_id": 44020393, "link": "https://stackoverflow.com/questions/44020393/how-to-plot-3-lines-based-on-filters-with-macro-in-excel", "title": "How to plot 3 lines based on filters with macro in Excel?", "body": "<p>I have a lot of records in the following formatting.\nI would like to plot 3 lines (min, avg, max) with the epoch date values on x-axis and values on y-axis. I tried filtering on \"min\" and plotting it, but the data doesn't stay in the graph when I switch to the next \"avg\" filter. Any idea how I can create 1 graph with 3 lines for min, avg and max values?</p>\n\n<pre><code>date            type value\n1476255600000   min  226.1\n1476255600000   avg  227\n1476255600000   max  228\n1476342000000   min  225.9\n1476342000000   avg  227\n1476342000000   max  227.9\n1476342000000   max  228\n1476342000000   min  226.1\n1476342000000   avg  226.9\n1476428400000   min  225.7\n1476428400000   max  227.7\n1476428400000   avg  226.7\n1476514800000   avg  226.8\n1476514800000   min  225.7\n1476514800000   max  227.8\n1476514800000   max  227.7\n1476514800000   avg  226.7\n1476514800000   min  225.8\n1476601200000   min  225.8\n1476601200000   avg  226.8\n1476601200000   min  225.7\n1476601200000   max  227.7\n1476601200000   max  227.8\n1476687600000   min  225.5\n1476687600000   max  227.5\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-addin"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1495012301, "post_id": 44019988, "comment_id": 75067865, "body": "Can you be a bit more specific? What are you trying to achieve? I think you can write some code that will create a reply to the mail and match the mail&#39;s recipient with one of your accounts, is that what you want? You can easily find the code to create the mail&#39;s reply and get the mail&#39;s recipient."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1495012992, "post_id": 44019988, "comment_id": 75068373, "body": "Try the <code>.SentOnBehalfOfName</code> property."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1495051811, "post_id": 44019988, "comment_id": 75094547, "body": "@Al Bundy Apologies, I misread your question earlier on. See my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1495039709, "creation_date": 1495039709, "answer_id": 44030667, "question_id": 44019988, "link": "https://stackoverflow.com/questions/44019988/setting-the-sender-email-address-according-to-the-recipient/44030667#44030667", "title": "Setting the sender email address according to the recipient", "body": "<p>Outlook will not let you set message sender to an arbitrary email address - you must have an explicit permission (in case of Exchange) to set the <code>MailItem.SentOnBehalfOfName</code> property. In case of a POp3/SMTP account, set the <code>MailItem.Account</code> property.</p>\n"}, {"comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 4590, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "edited": false, "score": 0, "creation_date": 1495134152, "post_id": 44033922, "comment_id": 75136745, "body": "@Al Bundy Super, thanks for the correction. Answer updated."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1495133817, "last_edit_date": 1495535491, "creation_date": 1495051650, "answer_id": 44033922, "question_id": 44019988, "link": "https://stackoverflow.com/questions/44019988/setting-the-sender-email-address-according-to-the-recipient/44033922#44033922", "title": "Setting the sender email address according to the recipient", "body": "<p>Credit to @Al Bundy for correcting this. This solution is based on <a href=\"https://stackoverflow.com/questions/21727768/rule-that-runs-macro-when-an-email-is-opened\">this post</a>.</p>\n\n<p>In <code>ThisOutlookSession</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents objMail As MailItem\nPrivate assignmentHandled As Boolean\n\n'Set MailItem\nPrivate Sub Application_ItemLoad(ByVal Item As Object)\n    If Item.Class = olMail And Not assignmentHandled Then\n        Set objMail = Item\n    End If\nEnd Sub\n\n'Handle reply/replayAll from triggering ItemLoad again\nPrivate Sub objMail_Open(Cancel As Boolean)\n    assignmentHandled = True\nEnd Sub\n\n'Reply\nPrivate Sub objMail_Reply(ByVal Response As Object, Cancel As Boolean)\n    Call SetSentOnBehalfOfName(Response)\nEnd Sub\n\n'Reply all\nPrivate Sub objMail_ReplyAll(ByVal Response As Object, Cancel As Boolean)\n    Call SetSentOnBehalfOfName(Response)\nEnd Sub\n\n'MailItem closed\nPrivate Sub objMail_Close(Cancel As Boolean)\n    assignmentHandled = False\nEnd Sub\n\n' Avoid repeating code\nPrivate Sub SetSentOnBehalfOfName(ByRef Response As Object)\n    Response.SentOnBehalfOfName = objMail.To\n    assignmentHandled = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4590, "user_id": 3179492, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ZHPUJ.jpg?s=128&g=1", "display_name": "Peter VARGA", "link": "https://stackoverflow.com/users/3179492/peter-varga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 44033922, "answer_count": 2, "score": 0, "last_activity_date": 1593072514, "creation_date": 1495011166, "last_edit_date": 1593072514, "question_id": 44019988, "link": "https://stackoverflow.com/questions/44019988/setting-the-sender-email-address-according-to-the-recipient", "title": "Setting the sender email address according to the recipient", "body": "<p>How can I set programmatically in an email, <strong>to which I reply</strong>, the sender address to the recipient address?</p>\n\n<p><a href=\"https://i.stack.imgur.com/YqdRs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YqdRs.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there a way in VBA? I don't know where to start so I apologize because I cannot show any code.</p>\n"}, {"tags": ["excel", "vba", "web"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 2, "creation_date": 1495012072, "post_id": 44019929, "comment_id": 75067682, "body": "So, that&#39;s the web source code.  If you need fresh eyes on your code, wouldn&#39;t it be a good idea to post your code?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548672144, "post_id": 44019929, "comment_id": 95611077, "body": "Did you try the answers given?"}], "answers": [{"tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": false, "score": 1, "last_activity_date": 1495023877, "creation_date": 1495023877, "answer_id": 44024818, "question_id": 44019929, "link": "https://stackoverflow.com/questions/44019929/vba-web-scrape-innertext/44024818#44024818", "title": "VBA web scrape innertext", "body": "<p>Something like this should work, however without your code I don't know how you're obtaining your <code>HTMLDocument</code>:</p>\n\n<pre><code>Dim oHTMLDocument As Object\nDim ele As Object\n\nSet oHTMLDocument = ... 'No code provided so I'm unsure how you obtained the HTMLDocument\n\nFor Each ele in oHTMLDocument.getElementsByTagName(\"input\")\n    If ele.Name = \"pg41_PolicyHolder_FogP_PolicyHolderId_FogP_IdentityValue\" Then\n        Debug.Print ele.innerText\n        Exit For\n    End If\nNext ele\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1528443147, "creation_date": 1528443147, "answer_id": 50755588, "question_id": 44019929, "link": "https://stackoverflow.com/questions/44019929/vba-web-scrape-innertext/50755588#50755588", "title": "VBA web scrape innertext", "body": "<p>You can use a CSS selector and avoid the need for a loop.</p>\n\n<pre><code>input[name=\"pg41_PolicyHolder_FogP_PolicyHolderId_FogP_IdentityValue\"]\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/8GDuF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8GDuF.png\" alt=\"CSS query\"></a></p>\n\n<p><a href=\"http://try.jsoup.org/~m26N_s6sCXCZ0x7O0vJ0I2N9EdU\" rel=\"nofollow noreferrer\">Try it</a></p>\n\n<hr>\n\n<p>VBA</p>\n\n<p><code>.querySelector</code> is accessed via the HTML document set when you have your page (method not shown in your question) but with Internet Explorer for example:</p>\n\n<pre><code>IE.document.querySelector(\"pg41_PolicyHolder_FogP_PolicyHolderId_FogP_IdentityValue\").innerText\n</code></pre>\n\n<hr>\n\n<p>Further info:</p>\n\n<p><a href=\"https://www.w3schools.com/jsref/met_document_queryselector.asp\" rel=\"nofollow noreferrer\">HTML DOM querySelector() Method</a></p>\n"}], "owner": {"reputation": 35, "user_id": 7773845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8340163faa9078f56228a1b654a84a?s=128&d=identicon&r=PG&f=1", "display_name": "Suhr415", "link": "https://stackoverflow.com/users/7773845/suhr415"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528443147, "creation_date": 1495011009, "question_id": 44019929, "link": "https://stackoverflow.com/questions/44019929/vba-web-scrape-innertext", "title": "VBA web scrape innertext", "body": "<p>I have now tried for quite some time to web scrape this innertext:\nI want the value 0606 copied to an Excel sheet</p>\n\n<pre><code>&lt;TABLE class=\"group\"\n&lt;td width=\"100%\" nowrap=\"\" colspan=\"3\"&gt;\n&lt;input name=\"pg41_PolicyHolder_FogP_PolicyHolderId_FogP_IdentityQualifier\" \ntype=\"HIDDEN\" value=\"CPR\"&gt;CPR-nr:\n&lt;input name=\"pg41_PolicyHolder_FogP_PolicyHolderId_FogP_IdentityValue\" \ntype=\"HIDDEN\" value=\"0606\"&gt;0606&lt;/td&gt;\n</code></pre>\n\n<p>I have tried through get.attribute,getelementbyclassname, value and innertext, but now I need some fresh eyes on it. \nDoes any of you have a good idea? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1495010969, "post_id": 44019867, "comment_id": 75066907, "body": "The missing argument is <code>ByVal SheetName As String</code>. You have to provide the name of the sheet you&#39;re looking for. E.g. <code>If CheckSheet(&quot;Sheet 1&quot;) = True</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1495010973, "post_id": 44019867, "comment_id": 75066911, "body": "Your <code>CheckSheet</code> function wants a string to be passed to it.  You aren&#39;t.  Do so, and it will work.  You will then need to fix the next line, unless you have a <code>Worksheet</code> object which you have called <code>Worksheet</code>.  Hopefully you haven&#39;t, so it is more likely meant to be <code>Worksheets(&quot;someWorksheetName&quot;).Select</code>."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "edited": false, "score": 0, "creation_date": 1495011472, "post_id": 44019936, "comment_id": 75067283, "body": "I can&#39;t specify just one sheet cause I&#39;m checking through all the worksheets in the active workbook if that sheet exists. What argument should I put?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "edited": false, "score": 2, "creation_date": 1495011586, "post_id": 44019936, "comment_id": 75067371, "body": "@HydesYase - What is the name of the sheet you are checking for?  Put that as the parameter instead of &quot;YourSheetName&quot; in David&#39;s example."}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "reply_to_user": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "edited": false, "score": 0, "creation_date": 1495011836, "post_id": 44019936, "comment_id": 75067526, "body": "@HydesYase - The parameter is the name of the sheet you are checking for, it does not specify the sheet you are checking it against. In fact, you still loop through all the sheets."}], "tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1495011880, "last_edit_date": 1495011880, "creation_date": 1495011038, "answer_id": 44019936, "question_id": 44019867, "link": "https://stackoverflow.com/questions/44019867/id-like-to-see-if-worksheet-exists-and-select-the-worksheet-but-argument-not-o/44019936#44019936", "title": "I&#39;d like to see if worksheet exists and Select the worksheet but &quot;Argument not Optional&quot; appears", "body": "<p>This line:</p>\n\n<pre><code>If CheckSheet() = True Then\n        Worksheet.Select\nEnd If\n</code></pre>\n\n<p>calls a function with parameters, as this line shows:</p>\n\n<pre><code>Function CheckSheet(ByVal SheetName As String) As Boolean\n</code></pre>\n\n<p>Try this instead:</p>\n\n<pre><code>Dim wsName as String\nwsName = \"YourWorksheetName\"\n\nIf CheckSheet(wsName) = True Then\n            Sheets(wsName).Select\nEnd If\n</code></pre>\n\n<p>Edit: As @YowE3K pointed out, your <code>.Select</code> statement needs to know the sheet in question as well. Changed <code>Worksheet.Select</code> to <code>Sheets(\"YourSheetName\").Select</code></p>\n"}], "owner": {"reputation": 65, "user_id": 8002135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-8w_bSYlG2uw/AAAAAAAAAAI/AAAAAAAAB4Q/R40LbGygcuo/photo.jpg?sz=128", "display_name": "Hydes Yase", "link": "https://stackoverflow.com/users/8002135/hydes-yase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 44019936, "answer_count": 1, "score": 1, "last_activity_date": 1495011880, "creation_date": 1495010832, "question_id": 44019867, "link": "https://stackoverflow.com/questions/44019867/id-like-to-see-if-worksheet-exists-and-select-the-worksheet-but-argument-not-o", "title": "I&#39;d like to see if worksheet exists and Select the worksheet but &quot;Argument not Optional&quot; appears", "body": "<pre><code>    If CheckSheet() = True Then\n        Worksheet.Select\n    End If\n\nFunction CheckSheet(ByVal SheetName As String) As Boolean\n\n    Dim Sheet As Worksheet\n    Dim bReturn As Boolean\n\n    For Each Sheet In ActiveWorkbook.Sheets\n       If Sheet.Name = SheetName Then\n           bReturn = True\n           Exit For\n       End If\n   Next Sheet\n\n   CheckSheet = bReturn\nEnd Function\n</code></pre>\n\n<p>Compile Error:\nArgument Not Optional </p>\n\n<p>Then CheckSheet is highlighted after pressing Ok</p>\n"}, {"tags": ["vba", "excel", "paste"], "comments": [{"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 1, "creation_date": 1495012394, "post_id": 44019711, "comment_id": 75067937, "body": "As your source from where you copy is not excel, try pasting like this:  <code>ActiveSheet.Range(&quot;A1&quot;).PasteSpecial Format:=&quot;Unicode Text&quot;, Link:=False, DisplayAsIcon:=False</code>"}, {"owner": {"reputation": 4732, "user_id": 1519058, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c4c40c72d7fee8c91b13e1b4c2ad1458?s=128&d=identicon&r=PG", "display_name": "Enissay", "link": "https://stackoverflow.com/users/1519058/enissay"}, "reply_to_user": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1495036571, "post_id": 44019711, "comment_id": 75085829, "body": "Oh, thanks @jivko, this really put me on the right path. I&#39;m yet to adapt and finish my code... Will get back here later :-)"}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1495070311, "post_id": 44019711, "comment_id": 75100786, "body": "Maybe it would help if you gave an example of the data in the clipboard."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 15434846, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/36e151c9bc2c5f4d0e7426f0d0f2a9ca?s=128&d=identicon&r=PG", "display_name": "Peter Buzzard", "link": "https://stackoverflow.com/users/15434846/peter-buzzard"}, "is_accepted": false, "score": 1, "last_activity_date": 1616175936, "creation_date": 1616175936, "answer_id": 66713191, "question_id": 44019711, "link": "https://stackoverflow.com/questions/44019711/excel-vba-paste-clipboard-data-external-source-with-the-appropriate-cell-data/66713191#66713191", "title": "Excel VBA: Paste clipboard data (external source) with the appropriate cell data type", "body": "<p>I use a Macro to paste my data, and I've inserted this code near the start. It prevents double quotes (at the start of an entry) from being a problem.</p>\n<p>'This section prevents any special characters from interfering with the paste by specifying TextQualifier:=xlNone:</p>\n<pre><code>Range(&quot;A1&quot;).Select\nActiveCell.FormulaR1C1 = &quot;abc&quot;\nSelection.TextToColumns Destination:=Range(&quot;A1&quot;), DataType:=xlDelimited, _\n    TextQualifier:=xlNone, ConsecutiveDelimiter:=False, Tab:=True, Semicolon _\n    :=False, Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, _\n    1), TrailingMinusNumbers:=True\nRange(&quot;A1&quot;).Select\nSelection.ClearContents\n</code></pre>\n<p>'End Section</p>\n"}], "owner": {"reputation": 4732, "user_id": 1519058, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c4c40c72d7fee8c91b13e1b4c2ad1458?s=128&d=identicon&r=PG", "display_name": "Enissay", "link": "https://stackoverflow.com/users/1519058/enissay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3851, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1616175936, "creation_date": 1495010395, "last_edit_date": 1495039588, "question_id": 44019711, "link": "https://stackoverflow.com/questions/44019711/excel-vba-paste-clipboard-data-external-source-with-the-appropriate-cell-data", "title": "Excel VBA: Paste clipboard data (external source) with the appropriate cell data type", "body": "<p>I am copying table data (tab delimited) many times a day from external sources (other applications such as sqlClients: Heidi, MS SQL Management Studio, inhouse tools, ...) and pasting them in Excel sheets for extended analysis.</p>\n\n<p>I've been struggling to make a macro that pastes specific columns in the correct format instead of the <code>General</code> type which alters how data is displayed.</p>\n\n<p>At first I tried setting up specific columns to the appropriate dataType before using <code>paste special</code> to paste values only:</p>\n\n<pre><code>ActiveSheet.Range(\"B:D,X:X\").NumberFormat = \"@\"\nActiveSheet.Range(\"A1\").PasteSpecial _\n    Paste:=xlPasteValues _\n    , Operation:=xlNone _\n    , SkipBlanks:=False _\n    , Transpose:=False\n</code></pre>\n\n<p>Sadly it gives <code>Run Time Error '1004' PasteSpecial method of Range class failed</code> which I couldn't solve.</p>\n\n<p>Next I tried <code>TextToColumns</code> follows:</p>\n\n<pre><code>    ActiveSheet.Range(\"A1\").Select\n    ActiveSheet.Paste\n\n    For Each cell In Selection.Cells\n        If cell &lt;&gt; \"\" Then\n            cell.TextToColumns _\n                Destination:=cell _\n                , DataType:=xlDelimited _\n                , ConsecutiveDelimiter:=False _\n                , Space:=False _\n                , TextQualifier:=xlTextQualifierNone _\n                , Tab:=True _\n                , semicolon:=False _\n                , comma:=False _\n                , other:=False _\n                , FieldInfo:=Array(Array(0, 2), Array(1, 2), Array(3, 2), Array(10, 2), Array(15, 2))\n        End If\n    Next\n</code></pre>\n\n<p>Not only it doesn't work as expected (what is wrong with it ?), but it doesn't seem efficient as It pastes the clipboard content before looping over every cell. My tables can be really huge and thus this will take a lot of time!</p>\n\n<p>So, I was wondering if there is a better/elegant way to paste the clipboard data from an external source into the appropriate cell data type. If not, helping fixing the above leads would be nice as well.</p>\n\n<p>Thank you in advance &lt;3</p>\n\n<h2>Edit.1:</h2>\n\n<p>Now that I have some correct code working thanks to @jivko's comment:</p>\n\n<pre><code>ActiveSheet.Range(\"A1\").Select\nActiveSheet.PasteSpecial Format:=\"Unicode Text\", Link:=False, DisplayAsIcon:=False\n</code></pre>\n\n<p>Since I'm pasting code from different sources with different number of columns, I was wondering how could I know how many columns are there in the clipboard before pasting so I can apply the appropriate format beforehand ?</p>\n\n<p>An idea would be to <code>Paste &gt; Count the columns &gt; Apply the correct Format &gt; Paste again</code>. It doesn't sounds perfect but it should get the job done.</p>\n\n<p>If you have any better solution please feel free to share &lt;3</p>\n"}, {"tags": ["vba", "excel", "charts"], "answers": [{"comments": [{"owner": {"reputation": 1387, "user_id": 2814308, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pz7MQ.jpg?s=128&g=1", "display_name": "SantiBailors", "link": "https://stackoverflow.com/users/2814308/santibailors"}, "edited": false, "score": 0, "creation_date": 1495014402, "post_id": 44020879, "comment_id": 75069378, "body": "Thanks, this is an interesting approach, more indirect than what I was hoping for but absolutely worth looking into. Determining the visible columns is certainly possible and probably easy, and coming up with a conversion formula to determine the points range corresponding to a columns range is certainly workable, although complicated by the fact that when I scroll by one column the amount of chart points that &quot;exit&quot; the visible window on the left side (hopefully equal to the amount of points that &quot;enter&quot; the window from the right side) is also to be determined. It&#39;s certainly a way to go."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1495013455, "creation_date": 1495013455, "answer_id": 44020879, "question_id": 44019659, "link": "https://stackoverflow.com/questions/44019659/detecting-first-and-last-visible-points-in-an-excel-chart-wider-than-excel-windo/44020879#44020879", "title": "Detecting first and last visible points in an Excel chart wider than Excel window", "body": "<p>I'm not versed enough in VBA to provide the exact code for this, but conceptually, if you scroll the sheet horizontally, there should be a way to determine the address of the top left cell in the visible window, for example with <code>ActiveWindow.VisibleRange.Cells(1,1)</code> and along the same lines of logic,  you can determine the last cell of the visible window if you know the column width and the zoom factor. </p>\n\n<p>You can then connect these visible cells and their respective addresses with a related range in the chart data source. For example, if the visible range is columns A to M, then the data range in the chart must be row 1 to 55, if the visible range is columns M to Z then the data range in the chart must be row 55 to 100.  You may need to work out a conversion formula for that relationship.</p>\n\n<p>Then you can grab the pertinent values in the source data that will be plotted in the chart and process the min and max of the value axis. </p>\n"}, {"comments": [{"owner": {"reputation": 1387, "user_id": 2814308, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pz7MQ.jpg?s=128&g=1", "display_name": "SantiBailors", "link": "https://stackoverflow.com/users/2814308/santibailors"}, "edited": false, "score": 0, "creation_date": 1495018241, "post_id": 44021793, "comment_id": 75071888, "body": "Thanks, it looks awesome; I&#39;m just trying to figure out from your code if this solution is dependent on the charted values being the result of a function (ex. <code>y=x^2</code>), because in my case they are not (I just added this info to the question); but even so I can always get the <code>y</code> of a certain <code>x</code>. Thanks also for the info and button idea about detecting a scroll; I totally had the feeling that was much easier said than done. Your suggestion prompted me to think that I could add a scroll-left and scroll-right buttons to do the scrolling, and maybe scroll by an amount specified in a certain cell."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 1387, "user_id": 2814308, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pz7MQ.jpg?s=128&g=1", "display_name": "SantiBailors", "link": "https://stackoverflow.com/users/2814308/santibailors"}, "edited": false, "score": 1, "creation_date": 1495018575, "post_id": 44021793, "comment_id": 75072113, "body": "I just used <code>y=x^2</code> as an example, this solution is entirely dependant on <i>whatever data is on your chart</i>, about half way through I retrieve the chart&#39;s <code>XValues</code>, and near the end I retrieve the chart&#39;s y-values (<code>Values</code>), they could have been anything! Adding scroll buttons would be okay, but you may have issues when someone manually scrolls."}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 1, "last_activity_date": 1495018775, "last_edit_date": 1525816189, "creation_date": 1495015627, "answer_id": 44021793, "question_id": 44019659, "link": "https://stackoverflow.com/questions/44019659/detecting-first-and-last-visible-points-in-an-excel-chart-wider-than-excel-windo/44021793#44021793", "title": "Detecting first and last visible points in an Excel chart wider than Excel window", "body": "<p>Here is a function to scale your axes according to the visible x values.</p>\n\n<p>I've tried to comment it well, but the logic is as follows:</p>\n\n<ul>\n<li>Get the visible range using the <code>.VisibleRange</code> property</li>\n<li>Get the left and right points of the visible range and the plot area</li>\n<li>Calculate the leftmost and rightmost <em>visible</em> x values, then find the closest <em>actual</em> data point to each. This avoids having to assume equidistant x data</li>\n<li>Get the indices of those extreme values within the data, so that you can get the corresponding y values.</li>\n<li>Scale the axes to those y values</li>\n</ul>\n\n<p><strong>Note:</strong> This currently relies on the <code>ActiveChart</code> object, it would be <em>much</em> more robust to use a defined chart object with a given name. That's up to your specific usage.</p>\n\n<p>Code:</p>\n\n<pre><code>Sub scaley()\n    ' Get visible range\n    Dim visrange As Range\n    Set visrange = ActiveWindow.VisibleRange\n    ' Get left and right in points\n    Dim L As Double, R As Double\n    L = visrange.Left\n    R = visrange.Cells(visrange.Cells.Count).Offset(0, 1).Left\n    ' Get left and right of chart, relies on chart being active\n    ' could easily replace with calling your chart by name\n    Dim chtL As Double, chtR As Double\n    Dim cht As Chart\n    Set cht = ActiveChart\n    chtL = cht.Parent.Left + cht.PlotArea.Left\n    chtR = chtL + cht.PlotArea.Width\n    ' Get visible region by percentage\n    Dim pL As Double, pR As Double\n    pL = WorksheetFunction.Max((L - chtL) / (chtR - chtL), 0)\n    pR = WorksheetFunction.Min((R - chtL) / (chtR - chtL), 1)\n    ' Get x axis values, and the visible x axis range\n    Dim xval() As Variant\n    xval = cht.SeriesCollection(1).XValues\n    Dim xmin As Double, xmax As Double, xrange As Double\n    xmin = WorksheetFunction.Min(xval)\n    xrange = WorksheetFunction.Max(xval) - xmin\n    xmax = xmin + pR * xrange\n    xmin = xmin + pL * xrange\n    ' Get actual corresponding x values\n    Dim imin As Long, imax As Long\n    For imin = LBound(xval) To UBound(xval)\n        If xval(imin) &gt;= xmin Then Exit For\n    Next imin\n    For imax = UBound(xval) To LBound(xval) Step -1\n        If xval(imax) &lt;= xmax Then Exit For\n    Next imax\n    ' Get y values in the visible range\n    Dim allyval() As Variant, yval() As Variant\n    allyval = cht.SeriesCollection(1).Values\n    ReDim yval(0 To imax - imin)\n    Dim i As Long\n    For i = imin To imax\n        yval(i - imin) = allyval(i)\n    Next i\n    ' scale axes, including buffer so max/min values dont sit right on edge\n    Dim buffer As Double\n    buffer = 0.1\n    cht.Axes(xlValue).MaximumScale = WorksheetFunction.Max(yval) + buffer\n    cht.Axes(xlValue).MinimumScale = WorksheetFunction.Min(yval) - buffer\nEnd Sub\n</code></pre>\n\n<p>Here are some example outputs. I used the <strong>arbitrary data</strong> <code>x = -10, -9, ..., 10</code> and <code>y = 100, 81, 64, 49, ..., 81, 100</code> (which is <code>x^2</code>) to create the scatter plot, then ran the sub in different window positions.</p>\n\n<p>The chart size doesn't change, I simply change my window size / scroll, make sure the chart is selected (see \"note\" above) and run the sub:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1ePRQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1ePRQ.png\" alt=\"zoom 1\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Gcuok.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gcuok.png\" alt=\"zoom 2\"></a></p>\n\n<hr>\n\n<p>If you actually need to trigger this sub on a scroll event then you might want to look here: <a href=\"http://www.cpearson.com/excel/DetectScroll.htm\" rel=\"nofollow noreferrer\">cpearson - DetectScroll</a>. This is not a simple thing to do though! An easier option would be to have a really wide button across the top (or something similar) which could call the above <code>scaley</code> sub.</p>\n"}, {"comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 2, "creation_date": 1495020510, "post_id": 44023354, "comment_id": 75073410, "body": "This is probably a nicer UI solution, as you say, think my head jumped straight to the interesting problem of detecting the visible chart area! I&#39;m curious what you mean by <i>&quot;established dynamic charting techniques&quot;</i>? You could easily do what you&#39;re saying without named formulas?"}, {"owner": {"reputation": 1387, "user_id": 2814308, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pz7MQ.jpg?s=128&g=1", "display_name": "SantiBailors", "link": "https://stackoverflow.com/users/2814308/santibailors"}, "edited": false, "score": 0, "creation_date": 1495022058, "post_id": 44023354, "comment_id": 75074509, "body": "Great thinking. If you rarely post another answer I&#39;m glad you did so this time. This answer steps back from the original question, captures its context and removes the need for the question itself by suggesting an alternative approach which is probably just The Right Way for this case. I implemented this with the whole data series set into the chart and my brain stuck to that although that wasn&#39;t a requirement at all. I&#39;ll try to find out if it&#39;s proper to mark this as the accepted answer for my question about detecting the visible area, but this solution is the way I&#39;m going to go."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1495022737, "post_id": 44023354, "comment_id": 75074971, "body": "From the <a href=\"http://stackoverflow.com/help/someone-answers\">guidelines</a>: <i>&quot;you may accept the answer that you believe is the best solution to your problem.&quot;</i> If you&#39;re ever unsure, you can ask on <a href=\"https://meta.stackoverflow.com/\">meta</a>"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 2, "creation_date": 1495023617, "post_id": 44023354, "comment_id": 75075613, "body": "I added a sample file and some explanation of a dynamic chart with dynamic range names that can be used with or without code. Open buffet. Eat what you want."}, {"owner": {"reputation": 1387, "user_id": 2814308, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pz7MQ.jpg?s=128&g=1", "display_name": "SantiBailors", "link": "https://stackoverflow.com/users/2814308/santibailors"}, "edited": false, "score": 3, "creation_date": 1495024134, "post_id": 44023354, "comment_id": 75076001, "body": "Just wow. Most effective help I ever got. Thanks also for pointing out that you would welcome questions. I will start reimplementing the whole charting thing soon along your lines and given the clarity and the examples I probably won&#39;t have further questions, but if I will I will ask here. Cheers."}, {"owner": {"reputation": 1387, "user_id": 2814308, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pz7MQ.jpg?s=128&g=1", "display_name": "SantiBailors", "link": "https://stackoverflow.com/users/2814308/santibailors"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1495026606, "post_id": 44023354, "comment_id": 75077948, "body": "@Wolfie I went with your suggestion and <a href=\"https://meta.stackoverflow.com/q/349312/2814308\">asked</a> on meta."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1495023531, "last_edit_date": 1495023531, "creation_date": 1495019906, "answer_id": 44023354, "question_id": 44019659, "link": "https://stackoverflow.com/questions/44019659/detecting-first-and-last-visible-points-in-an-excel-chart-wider-than-excel-windo/44023354#44023354", "title": "Detecting first and last visible points in an Excel chart wider than Excel window", "body": "<p>I rarely post another answer, so this has taken some thinking.</p>\n\n<p>Consider a dynamic chart that shows only a select part of the data, instead of a static chart that shows all data. Consider that instead of building a chart that stretches across multiple screen widths, you could have a single chart that fits the screen perfectly, but the user could determine what they want to see in that chart.</p>\n\n<p>Then give the user a few control cells where they can enter the starting point of the chart data and another control where they can determine how many candles/bars/points they want to see in the chart.</p>\n\n<p>With that information provided by the user, you can apply established dynamic charting techniques like named formulas for chart ranges. Then sprinkle a little VBA on top to determine the min and max of the selected charting range.</p>\n\n<p>Let me know if you want to see a sample of that technique and I'll add a link. It's really not all that hard to do and a much better user experience than scrolling across a chart that disappears off the left and right of the window.</p>\n\n<p><strong>Edit</strong>: I created a sample file that you can download with this <a href=\"https://www.dropbox.com/s/jiy1q49202bhhrq/SO44019659.xlsm?dl=0\" rel=\"nofollow noreferrer\">Dropbox link</a></p>\n\n<p>You need to enable macros for this file.</p>\n\n<p>The top chart shows all data.</p>\n\n<p>The chart in row 26 uses dynamic ranges. The user can manipulate F17 and F18 to select a starting point and the number of rows to plot. The chart in row 26 then uses the Excel defaults to appropriate the value axis with some padding, as Excel does.</p>\n\n<p>The chart in row 42 (love that number) overrides the Exel defaults and uses the values in F23 and F24 for minimum and maximum values respectively. This is done with a Worksheet Change event macro that runs whenever any cell in the sheet is changed. </p>\n\n<p>There's gazillion ways to fine-tune and improve this approach, like, only fire the macro when the chart parameters in F23 or F24 change, but that's not the point.</p>\n\n<p>The point is that you can use a dynamic range name to show a selection of your data in a chart. Without any code, but letting Excel decide what the Y axis min and max should be. Like the chart in D26.</p>\n\n<p>If you want more control over the min and max of the Y axis, use the code version and the chart in D42.</p>\n\n<p>Happy to take questions.</p>\n"}], "owner": {"reputation": 1387, "user_id": 2814308, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pz7MQ.jpg?s=128&g=1", "display_name": "SantiBailors", "link": "https://stackoverflow.com/users/2814308/santibailors"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 970, "favorite_count": 2, "accepted_answer_id": 44023354, "answer_count": 3, "score": 2, "last_activity_date": 1495023531, "creation_date": 1495010252, "last_edit_date": 1495017364, "question_id": 44019659, "link": "https://stackoverflow.com/questions/44019659/detecting-first-and-last-visible-points-in-an-excel-chart-wider-than-excel-windo", "title": "Detecting first and last visible points in an Excel chart wider than Excel window", "body": "<p>I have an Excel worksheet that contains a candlestick chart - but for the purpose of this question it might be a regular 2D-line chart, or any chart that has a horizontal axis.</p>\n\n<p>The data source for the chart is not a math function; instead it's arbitrary data representing prices, read from columns of another worksheet.</p>\n\n<p>My chart is many times wider than the worksheet window - and than the Excel window itself. I browse the chart horizontally by simply using the normal horizontal scrollbar of the worksheet, which scrolls the worksheet including the chart in it.</p>\n\n<p>I placed buttons in the same worksheet to manually adjust through VBA code the vertical scale of the chart (Y-axis), because when scrolling horizontally, the new chart values that become visible might require different minimum and maximum Y-axis values to be displayed in an optimal way.</p>\n\n<p>I would like to replace that manual scaling with automatic scaling: after each scroll, I need to know what is the leftmost visible chart point and the rightmost - that is the first and the last visible points. From that I will calculate the best Y-scale and set it into the chart.</p>\n\n<p>So I'm trying to write the VBA code to detect the first and last visible points. The <code>Chart</code> object doesn't seem to me to have related methods or properties, and so far I couldn't find ways to do that. So that's my question.</p>\n\n<p>The <code>Chart.AutoScaling</code> property won't help as it affects the whole chart, while my goal is to set a vertical scale which is good only for the currently visible portion of the chart. So I need to find the first and last visible  points of the chart.</p>\n\n<p>The users of this chart might have an Excel version as old as Excel 2007, so a solution that works with versions that old would be optimal, but solutions that require newer Excel versions would be great as well.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1495011203, "post_id": 44019523, "comment_id": 75067081, "body": "You would be advised to assign some workbook variables and then you could dispense with all the activates and selects. It&#39;s not clear from there where you are pasting?"}, {"owner": {"reputation": 5, "user_id": 7857305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7b50610ca2632d56a22d2fa4e9306e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Trec", "link": "https://stackoverflow.com/users/7857305/diego-trec"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1495015060, "post_id": 44019523, "comment_id": 75069803, "body": "Sorry, I&#39;m not a developer, trying to do my best, I am trying to paste from taranto.xlsm to Overview etc,then I open Crotone.xls and copy to Overview, then I open Roma and so on.I just would like to add to this cycle the file name to specify for which location data comes from and pasting it into the cell I want"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1495020250, "post_id": 44019523, "comment_id": 75073223, "body": "But where exactly should the file name appear? Because all your references are to active cells it&#39;s hard to see exactly what you are trying to do."}, {"owner": {"reputation": 5, "user_id": 7857305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7b50610ca2632d56a22d2fa4e9306e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Trec", "link": "https://stackoverflow.com/users/7857305/diego-trec"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1495028235, "post_id": 44019523, "comment_id": 75079306, "body": "This I will manage by myself playing with the Offset, I just need the line after Taranto is open, that copies the name and paste it even at the end of the copy from Taranto.Every time I open a new report I start with Range(&quot;D29&quot;).Select to stop the Offset cycle."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7857305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7b50610ca2632d56a22d2fa4e9306e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Trec", "link": "https://stackoverflow.com/users/7857305/diego-trec"}, "edited": false, "score": 0, "creation_date": 1495014919, "post_id": 44019713, "comment_id": 75069720, "body": "I would like to paste the file name as text into a cell, shall I just add this line and then continue pasting as I was doing?"}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "reply_to_user": {"reputation": 5, "user_id": 7857305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7b50610ca2632d56a22d2fa4e9306e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Trec", "link": "https://stackoverflow.com/users/7857305/diego-trec"}, "edited": false, "score": 0, "creation_date": 1495015546, "post_id": 44019713, "comment_id": 75070130, "body": "@Diego Trec - <code>Range(&quot;A1&quot;).Value2 = Activeworkbook.Name</code>. Change A1 with whatever cell you need the name in."}, {"owner": {"reputation": 5, "user_id": 7857305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7b50610ca2632d56a22d2fa4e9306e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Trec", "link": "https://stackoverflow.com/users/7857305/diego-trec"}, "reply_to_user": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1495016352, "post_id": 44019713, "comment_id": 75070665, "body": "@jivko thanks, but doing this way, the active workbook is the Overview, not Taranto, then in the cell A1 I will get Overview etc instead of Taranto, right?"}, {"owner": {"reputation": 121, "user_id": 7469343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b438308d9221bdcfe21c90468043e6?s=128&d=identicon&r=PG", "display_name": "Hocus", "link": "https://stackoverflow.com/users/7469343/hocus"}, "reply_to_user": {"reputation": 5, "user_id": 7857305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7b50610ca2632d56a22d2fa4e9306e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Trec", "link": "https://stackoverflow.com/users/7857305/diego-trec"}, "edited": false, "score": 0, "creation_date": 1495018084, "post_id": 44019713, "comment_id": 75071796, "body": "@DiegoTrec you could set the workbook as a variable to be used later."}, {"owner": {"reputation": 5, "user_id": 7857305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7b50610ca2632d56a22d2fa4e9306e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Trec", "link": "https://stackoverflow.com/users/7857305/diego-trec"}, "edited": false, "score": 0, "creation_date": 1495028550, "post_id": 44019713, "comment_id": 75079549, "body": "@Hocus apologies, I&#39;m not a real developer, could you please edit the code you posted?"}, {"owner": {"reputation": 121, "user_id": 7469343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b438308d9221bdcfe21c90468043e6?s=128&d=identicon&r=PG", "display_name": "Hocus", "link": "https://stackoverflow.com/users/7469343/hocus"}, "reply_to_user": {"reputation": 5, "user_id": 7857305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7b50610ca2632d56a22d2fa4e9306e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Trec", "link": "https://stackoverflow.com/users/7857305/diego-trec"}, "edited": false, "score": 0, "creation_date": 1495029561, "post_id": 44019713, "comment_id": 75080355, "body": "@DiegoTrec I would spend some time googling &quot;VBA Variables&quot; or something similar, that being said as you know the file names (you are opening them manually) you could just add to your code      Range(&quot;[Cell to add it to]&quot;).Value = &quot;[Worksheet name]&quot; after you activate your sheet"}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "reply_to_user": {"reputation": 5, "user_id": 7857305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7b50610ca2632d56a22d2fa4e9306e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Trec", "link": "https://stackoverflow.com/users/7857305/diego-trec"}, "edited": false, "score": 0, "creation_date": 1495070611, "post_id": 44019713, "comment_id": 75100859, "body": "@Diego Trec - <code>Dim wbkTaranto As Woorkbook Set wbkTaranto = Workbooks.Open Filename:=&quot;E:\\TARANTO.xlsx&quot;</code>. Then you can reference <code>wbkTaranto</code> instead of <code>Activeworkbook</code> and you&#39;ll be sure it&#39;s the correct workbook. You can use a similar approach when referencing worksheets."}], "tags": [], "owner": {"reputation": 121, "user_id": 7469343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b438308d9221bdcfe21c90468043e6?s=128&d=identicon&r=PG", "display_name": "Hocus", "link": "https://stackoverflow.com/users/7469343/hocus"}, "is_accepted": true, "score": 0, "last_activity_date": 1495015553, "last_edit_date": 1495015553, "creation_date": 1495010401, "answer_id": 44019713, "question_id": 44019523, "link": "https://stackoverflow.com/questions/44019523/excel-macro-copy-paste-file-name-in-automatized-data-entry-process/44019713#44019713", "title": "Excel Macro - copy/paste file name in automatized Data entry process", "body": "<p>To get the name of the active workbook you can use:</p>\n\n<p>Activeworkbook.Name</p>\n\n<p>To write this into a cell just put:</p>\n\n<pre><code>Range(\"A1\").value = Activeworkbook.Name\n</code></pre>\n\n<p>This will input the file name (including the extension) into the cell.</p>\n"}], "owner": {"reputation": 5, "user_id": 7857305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7b50610ca2632d56a22d2fa4e9306e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Trec", "link": "https://stackoverflow.com/users/7857305/diego-trec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 44019713, "answer_count": 1, "score": 0, "last_activity_date": 1495015553, "creation_date": 1495009859, "question_id": 44019523, "link": "https://stackoverflow.com/questions/44019523/excel-macro-copy-paste-file-name-in-automatized-data-entry-process", "title": "Excel Macro - copy/paste file name in automatized Data entry process", "body": "<p>Perhaps that could really be an easy one to build, but I couldn't find out on the forum, maybe I'm only missing keywords or sintax.\nSimple data entry process, I got a master file (it is a report overview from different locations), in which I copy paste cells from about 16 different reports.\nSomething like this</p>\n\n<pre><code>Workbooks.Open Filename:=\"E:\\TARANTO.xlsx\"\nRange(\"D29\").Select\nSelection.Copy\nWindows(\"Overview weekly reports.xlsm\").Activate\nSheets(\"n\").Select\nActiveCell.Offset(3, 14).Range(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteAllExceptBorders, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\nWindows(\"TARANTO.xlsx\").Activate\nActiveCell.Offset(-1, 1).Range(\"A1\").Select\nSelection.Copy\nWindows(\"Overview figures from ASTs weekly reports.xlsm\").Activate\nActiveCell.Offset(1, 0).Range(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteAllExceptBorders, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\nWindows(\"TARANTO.xlsx\").Activate\nActiveCell.Offset(1, 0).Range(\"A1\").Select\nSelection.Copy\nWindows(\"Overview figures from ASTs weekly reports.xlsm\").Activate\nActiveCell.Offset(1, 0).Range(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteAllExceptBorders, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n'' and so on \n</code></pre>\n\n<p>What I would like to get is to copy the file name of the report into a cell, ideally adding it to the Offset cycle, just like copying another cell.\nThe result would be for instance:</p>\n\n<p>TARANTO                3                  4             8               9</p>\n\n<p>CROTONE                6                  9             4               4</p>\n\n<p>ETC.</p>\n\n<p>Unfortunately, the location is not mentioned in any cell inside the form, I need to grab exactly the file name every time.\nI tried recording also, but of course no action appears on VBE when I attempt to copy the file name manually.\nPlease any help would be really appreciated.\nHave a good day!</p>\n"}, {"tags": ["vba", "excel", "pdf"], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1495009846, "creation_date": 1495009846, "answer_id": 44019518, "question_id": 44019015, "link": "https://stackoverflow.com/questions/44019015/vba-print-export-save-all-excel-workbook-tabs-into-one-pdf-document/44019518#44019518", "title": "VBA print/export/save all Excel workbook tabs into one PDF document", "body": "<p><em>Simply use ThisWorkbook.ExportAsFixedFormat or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198122.aspx\" rel=\"nofollow noreferrer\">ActiveWorkbook.ExportAsFixedFormat</a></em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n\n    ThisWorkbook.ExportAsFixedFormat _\n                     Type:=xlTypePDF, _\n                     FileName:=\"C:\\tempo.pdf\", _\n                     Quality:=xlQualityStandard, _\n                     IncludeDocProperties:=True, _\n                     IgnorePrintAreas:=False, _\n                     OpenAfterPublish:=True\n\nEnd Sub\n</code></pre>\n\n<p><em><a href=\"https://msdn.microsoft.com/en-us/library/office/ff198122.aspx\" rel=\"nofollow noreferrer\">Workbook.ExportAsFixedFormat Method (Excel)</a></em></p>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "accepted_answer_id": 44019518, "answer_count": 1, "score": 1, "last_activity_date": 1495010119, "creation_date": 1495008404, "last_edit_date": 1495010119, "question_id": 44019015, "link": "https://stackoverflow.com/questions/44019015/vba-print-export-save-all-excel-workbook-tabs-into-one-pdf-document", "title": "VBA print/export/save all Excel workbook tabs into one PDF document", "body": "<p>I'M trying to print/export or save all my tabs in an excel workbook as one PDF document.</p>\n\n<p>The number of tabs could be any number and could be named anything.</p>\n\n<p>I have the following piece of code:</p>\n\n<pre><code>ThisWorkbook.Sheets(Array(\"Sheet1\", \"Sheet2\")).Select\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"C:\\tempo.pdf\", Quality:= xlQualityStandard, IncludeDocProperties:=True, _\n     IgnorePrintAreas:=False, OpenAfterPublish:=True\n</code></pre>\n\n<p>But this obviously requires the number of sheets and the exact names of the sheets. Is there a way to maybe count the number of sheets in a workbook and print all of these to PDF as one PDF doc?</p>\n\n<p>Please can someone show me how to do this?\nThanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1495007960, "post_id": 44018782, "comment_id": 75064828, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service. Yet we are eager to help fellow programmers (and aspirants) writing their own code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. You might also want to <a href=\"http://stackoverflow.com/tour\">take the tour</a> and earn a badge while doing so. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve. We will be here waiting for you. Ready to assist and help you finalize <i>your code</i>."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1495008537, "post_id": 44018782, "comment_id": 75065191, "body": "Google <code>VLOOKUP</code>, you don&#39;t need VBA for this."}, {"owner": {"reputation": 11, "user_id": 8023981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rv0vVbzODLQ/AAAAAAAAAAI/AAAAAAAAAX8/weQNnI6S3u0/photo.jpg?sz=128", "display_name": "Mohammad Shaffiq Rahim", "link": "https://stackoverflow.com/users/8023981/mohammad-shaffiq-rahim"}, "edited": false, "score": 0, "creation_date": 1495268669, "post_id": 44018782, "comment_id": 75190045, "body": "hello sir how to make the deduction calculation from  Quantity in Stock sheet after click a save button ? for your information the Quantity that I refer to is at Invoice sheet  should linking to Stock Sheet ."}], "answers": [{"comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1495009216, "post_id": 44019227, "comment_id": 75065624, "body": "Well, based on the example from OP, the barcode is unique, yet you assume they are not unique. This decides if you can use VLOOKUP or not  - why not ask OP rather than arguing?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1495011410, "post_id": 44019227, "comment_id": 75067241, "body": "The bar code is unique in the stock sheet, because each stock item exists only one in that table. As for the Invoice sheet: an item can be ordered many times by different people, so the bar code will not be unique in the Invoice sheet."}, {"owner": {"reputation": 11, "user_id": 8023981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rv0vVbzODLQ/AAAAAAAAAAI/AAAAAAAAAX8/weQNnI6S3u0/photo.jpg?sz=128", "display_name": "Mohammad Shaffiq Rahim", "link": "https://stackoverflow.com/users/8023981/mohammad-shaffiq-rahim"}, "edited": false, "score": 0, "creation_date": 1495083503, "post_id": 44019227, "comment_id": 75103904, "body": "in invoice table there are 1 button to save the data in invoice  then i need to know how and what code to use...to subtract quantity in table stock.. tq =)"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1495088027, "post_id": 44019227, "comment_id": 75105685, "body": "And which part of the code are you having problems with? You did not post any code or mention any button before."}, {"owner": {"reputation": 11, "user_id": 8023981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rv0vVbzODLQ/AAAAAAAAAAI/AAAAAAAAAX8/weQNnI6S3u0/photo.jpg?sz=128", "display_name": "Mohammad Shaffiq Rahim", "link": "https://stackoverflow.com/users/8023981/mohammad-shaffiq-rahim"}, "edited": false, "score": 0, "creation_date": 1495089056, "post_id": 44019227, "comment_id": 75106260, "body": "sorry,I already post there...can you help me?? i want to put in there, when you click button save then the data will save in invoice data (another sheet) then will subtract quantity in stock Sheet.."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1495009353, "last_edit_date": 1495009353, "creation_date": 1495009049, "answer_id": 44019227, "question_id": 44018782, "link": "https://stackoverflow.com/questions/44018782/how-to-read-same-data-from-two-sheet-then-subtract-the-data-using-vba/44019227#44019227", "title": "how to read same data from two sheet then subtract the data using vba", "body": "<p>This kind of scenario is not what Excel was built for. It can be done, but there are many dangers in getting things wrong because the dependencies are not understood.</p>\n\n<p>First of all, the Quantity column should be relative to a starting stock count, so you can use the starting count as the base level and then subtract any numbers of stock referenced in invoices.</p>\n\n<p>I'd add a new column \"Starting Stock Balance\" with the initial stock count for each item.</p>\n\n<p>Then you can create a column with current stock that takes into account the starting balance and subtracts the sum of all items with the same code from the invoice sheet. If starting stock balance is in column D and current stock should be calculated in column E, use a formula along the lines of this:</p>\n\n<pre><code>=D2-Sumifs(Invoice!$D:$D,Invoice!$C:$C,$B2)\n</code></pre>\n\n<p>In words: take the value in D2 and subtract the sum of all items you can find in Invoice column D where Invoice column C is the same description as stock sheet column B in the current row.</p>\n\n<p>Adjust cell ranges and sheet names to your situation.</p>\n\n<p>Despite claims from @vacip that this can be done with Vlookup, it can't.</p>\n\n<p>Edit: Or if you want to base the formula on the bar code instead of the description, use</p>\n\n<pre><code>=D2-Sumifs(Invoice!$D:$D,Invoice!$B:$B,$A2)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8023981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rv0vVbzODLQ/AAAAAAAAAAI/AAAAAAAAAX8/weQNnI6S3u0/photo.jpg?sz=128", "display_name": "Mohammad Shaffiq Rahim", "link": "https://stackoverflow.com/users/8023981/mohammad-shaffiq-rahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1309, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556897847, "creation_date": 1495007676, "last_edit_date": 1556897847, "question_id": 44018782, "link": "https://stackoverflow.com/questions/44018782/how-to-read-same-data-from-two-sheet-then-subtract-the-data-using-vba", "title": "how to read same data from two sheet then subtract the data using vba", "body": "<p>I need some formula or function for subtraction from another sheet using same id(barcode).</p>\n\n<p>When you click button save or submit then the data(Quantity) will change using a  macro.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JCl35.jpg\" rel=\"nofollow noreferrer\">stock</a><a href=\"https://i.stack.imgur.com/JCl35.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JCl35.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/miRRg.jpg\" rel=\"nofollow noreferrer\">invoice</a>\n<a href=\"https://i.stack.imgur.com/miRRg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/miRRg.jpg\" alt=\"![enter image description here\"></a></p>\n\n<p>I want to know how to subtract data from invoice to stock sheet:</p>\n\n<pre><code>answer = invoice (Quantity) - stock (quantity)\n</code></pre>\n\n<p>This is my code:</p>\n\n<pre><code>Option Explicit\n\nSub inv()\n\n\n  Dim rng As Range\n  Dim rng1 As Range\n  Dim i As Long\n  Dim A As Long\n  Dim B As Range\n  Dim rng_dest As Range\n  Dim RANGE1 As Range\n  Dim RANGE2 As Range\n\n\n    'for subtract quantity in invoice and stock\n    Dim num1 As Integer\n    Dim num2 As Integer\n    Dim ans As Integer\n    Dim Stock As Long\n    Dim invoice As Range\n    Dim stk As Range\n\n\n\n\n Application.ScreenUpdating = False\n\n    num1 = ThisWorkbook.Sheets(\"Invoice\").Range(\"B8:B37\").Value\n    num2 = ThisWorkbook.Sheets(\"STOCK\").Range(\"B8:B\").Value\n\n    ans\n     If num2 = num1 Then\n      ans = num2 - num1\n\n\n\n\n\n  'Check if invoice # is found on sheet \"Invoice data\"\n\n  i = 1\n\n  Do Until Sheets(\"Invoice data\").Range(\"A\" &amp; i).Value = \"\"\n\n    If Sheets(\"Invoice data\").Range(\"A\" &amp; i).Value = Sheets(\"Invoice\").Range(\"H3\").Value Then\n\n      'Ask overwrite invoice #?\n\n      If MsgBox(\"Invoice Already Exist.. Do you want to Overwrite.?\", vbYesNo) = vbNo Then\n\n        Exit Sub\n\n      Else\n\n        Exit Do\n\n      End If\n\n    End If\n\n    i = i + 1\n\n  Loop\n\n\n  i = 1\n\n  Set rng_dest = Sheets(\"Invoice data\").Range(\"D:D\")\n    Set RANGE1 = Sheets(\"Invoice data\").Range(\"G:G\")\n\n  'Delete rows if invoice # is found\n\n  Do Until Sheets(\"Invoice data\").Range(\"A\" &amp; i).Value = \"\"\n\n    If Sheets(\"Invoice data\").Range(\"A\" &amp; i).Value = Sheets(\"Invoice\").Range(\"H3\").Value Then\n\n      Sheets(\"Invoice data\").Range(\"A\" &amp; i).EntireRow.Delete\n\n      i = 1\n\n    End If\n\n    i = i + 1\n\n  Loop\n\n  ' Find first empty row in columns D:G on sheet Invoice data\n\n  Do Until WorksheetFunction.CountA(rng_dest.Rows(i)) = 0\n\n    i = i + 1\n     Do Until WorksheetFunction.CountA(RANGE1.Rows(i)) = 0\n\n    i = i + 1\n    Loop\n\n  Loop\n\n      'Copy range B16:I38 on sheet Invoice\n\n  Set rng = Sheets(\"Invoice\").Range(\"B8:B37\")\n    Set RANGE2 = Sheets(\"Invoice\").Range(\"D8:D37\")\n\n\n  ' Copy rows containing values to sheet Invoice data\n\n    For A = 1 To rng.Rows.Count\n\n\n    If WorksheetFunction.CountA(rng.Rows(A)) &lt;&gt; 0 Then\n\n      rng_dest.Rows(i).Value = rng.Rows(A).Value\n\n       If WorksheetFunction.CountA(RANGE2.Rows(A)) &lt;&gt; 0 Then\n\n      RANGE1.Rows(i).Value = RANGE2.Rows(A).Value\n\n\n      Sheets(\"Invoice data\").Range(\"A\" &amp; i).Value = Sheets(\"Invoice\").Range(\"H3\").Value\n\n      'Copy Date\n\n      Sheets(\"Invoice data\").Range(\"B\" &amp; i).Value = Sheets(\"Invoice\").Range(\"H2\").Value\n\n      'Copy Company name\n\n      Sheets(\"Invoice data\").Range(\"C\" &amp; i).Value = Sheets(\"Invoice\").Range(\"B1\").Value\n\n\n\n      i = i + 1\n    End If\n       End If\n\n\n\n\n  Next A\n\n  MsgBox (\"Invoice saved!\")\n\n\n    Application.ScreenUpdating = True\n    Sheets(\"Invoice\").Range(\"H3\").Value = _\n    Sheets(\"Invoice\").Range(\"H3\").Value + 1\n\n\n\n\nEnd Sub\n\n\n\n\n\n\n\nSub Formc()\n\n  UserForm1.Show\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8023929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d5debaa6a4833961b1db54458a3768?s=128&d=identicon&r=PG&f=1", "display_name": "Cecco Beppe", "link": "https://stackoverflow.com/users/8023929/cecco-beppe"}, "edited": false, "score": 0, "creation_date": 1495093230, "post_id": 44029197, "comment_id": 75108970, "body": "Thank you very much for the answer. The code works, the only problem remains how to cycle the contents of the text boxes present in each slides. (I use them as tags because if text boxes match a string, copy the slide to the tape elsewhere) In Word there are bookmarks or &quot;normal text control&quot; but in Ppt I have arranged with text boxes. How do I solve this problem? Thank you and good day"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 27, "user_id": 8023929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d5debaa6a4833961b1db54458a3768?s=128&d=identicon&r=PG&f=1", "display_name": "Cecco Beppe", "link": "https://stackoverflow.com/users/8023929/cecco-beppe"}, "edited": false, "score": 0, "creation_date": 1495146846, "post_id": 44029197, "comment_id": 75142580, "body": "You might want to use .Tags on the PPT slides for this instead. I&#39;ve got an article about them on my PPT FAQ site:  Working with Tags (and a bit about Functions) <a href=\"http://www.pptfaq.com/FAQ00815_Working_with_Tags_-and_a_bit_about_Functions-.htm\" rel=\"nofollow noreferrer\">pptfaq.com/&hellip;</a>"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1495035216, "creation_date": 1495035216, "answer_id": 44029197, "question_id": 44018573, "link": "https://stackoverflow.com/questions/44018573/for-each-text-box-in-all-slides-of-power-point-vba/44029197#44029197", "title": "For each text box in all slides of power point (VBA)", "body": "<p>I've corrected a number of things.  Give this a try:</p>\n\n<pre><code>public sub elaboraSlidePpt ()\n\n    Dim pptPres As PowerPoint.Presentation\n    Dim pptApp As PowerPoint.Application\n    Dim pptSlide As PowerPoint.Slide\n    ' Create a POWERPOINT slide variable to use later\n    Dim pptShape as PowerPoint.Shape\n    Dim pptPath As String\n    Set doc = Application.ActiveDocument\n    Dim docPpt As Slide\n\n    ' use &amp; to combine strings, not +\n    pptPath = file_dir &amp; \"\\\" &amp; file_name\n\n    Set pptApp = CreateObject(\"PowerPoint.Application\")\n    pptApp.Visible = False\n    Set pptPres = pptApp.Presentations.Open(pptPath)\n\n    'Dim sld As Slide, shp As Shape\n    For Each pptSlide In pptPres.Slides\n      For Each pptShape In pptSlide.Shapes\n        ' You'll need to fix this ... \n        ' .Type will return a Long, not a string\n        If pptShape.Type = \"img10\" Then\n\n            pptSlide.Copy\n            Application.ActiveDocument.Activate\n            Selection.PasteAndFormat (wdPasteEnhancedMetafile)\n\n        End If\n      Next ' Shape\n    Next ' Slide\n end sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8023929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d5debaa6a4833961b1db54458a3768?s=128&d=identicon&r=PG&f=1", "display_name": "Cecco Beppe", "link": "https://stackoverflow.com/users/8023929/cecco-beppe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 0, "accepted_answer_id": 44029197, "answer_count": 1, "score": 0, "last_activity_date": 1495035216, "creation_date": 1495007048, "question_id": 44018573, "link": "https://stackoverflow.com/questions/44018573/for-each-text-box-in-all-slides-of-power-point-vba", "title": "For each text box in all slides of power point (VBA)", "body": "<p>Apologize in advance for my bad english, i used part google translate ...</p>\n\n<p>I stuck in cycling all the text boxes scattered in the Ppt slides.\nWhat I should do my program is to initially open a Ppt file from Word or search for codes entered in the text boxes used as tags.\nOnce I find the corresponding code (I do not know if I wrote it right) should make a copy of the entire slide (I do not know how to tell it to take that of the text box) and paste it on a page (for now at random) In Word.\nI searched on Google and found an apparently good code but I was \"ERROR 13\" in the second \"For Each\"</p>\n\n<pre><code> public sub elaboraSlidePpt ()\n\n\n    Dim pptPres As PowerPoint.Presentation\n    Dim pptApp As PowerPoint.Application\n    Dim pptSlide As PowerPoint.Slide\n    Dim pptPath As String\n    Set doc = Application.ActiveDocument\n    Dim docPpt As Slide\n\n    pptPath = file_dir + \"\\\" + file_name\n\n    Set pptApp = CreateObject(\"PowerPoint.Application\")\n    pptApp.Visible = False\n    Set pptPres = pptApp.Presentations.Open(pptPath)\n\n    Dim sld As Slide, shp As Shape\n    For Each sld In pptApp.ActivePresentation.Slides\n      For Each shp In sld.Shapes '&lt;-- ERROR 13\n        If shp.Type = \"img10\" Then\n\n            pptApp.ActivePresentation.Slides(????).Copy\n            Application.ActiveDocument.Activate\n            Selection.PasteAndFormat (wdPasteEnhancedMetafile)\n\n        End If\n      Next shp\n    Next sld\n end sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "formula", "lookup", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1495007090, "post_id": 44018408, "comment_id": 75064296, "body": "Assuming &quot;Matching value to be looked up is in &quot;D7&quot; &quot; means that the matching value is <b>somewhere</b> in column D, but you need to find where, this sounds like a job for the <code>MATCH</code> and <code>INDEX</code> Excel functions."}, {"owner": {"reputation": 123, "user_id": 5124315, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/D0B2S.jpg?s=128&g=1", "display_name": "Abigal", "link": "https://stackoverflow.com/users/5124315/abigal"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1495008742, "post_id": 44018408, "comment_id": 75065325, "body": "I have used MATCH and INDEX and it works just fine. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 7469343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b438308d9221bdcfe21c90468043e6?s=128&d=identicon&r=PG", "display_name": "Hocus", "link": "https://stackoverflow.com/users/7469343/hocus"}, "is_accepted": true, "score": 1, "last_activity_date": 1495007759, "last_edit_date": 1495007759, "creation_date": 1495007066, "answer_id": 44018583, "question_id": 44018408, "link": "https://stackoverflow.com/questions/44018408/look-up-data-left-and-right-with-or-without-vba/44018583#44018583", "title": "look up data left and right (with or without VBA)", "body": "<p>Not sure what you have tried,</p>\n\n<p>But I would recommend using .Find and then Offsetting to the left and right.</p>\n\n<p>So an example would be:</p>\n\n<p>Msgbox(Worksheets(\"List\").Range(\"D1:D20\").Find(Worksheets(\"Data\").Range(\"D7\").Value).Offset(0,3).Value)\nMsgbox(Worksheets(\"List\").Range(\"D1:D20\").Find(Worksheets(\"Data\").Range(\"D7\").Value).Offset(0,-3).Value)</p>\n\n<p>Another option would be to use Index Match so</p>\n\n<p>=Index(List!A:A,Match(Data!B7,List!D:D,0),1) for the left of it</p>\n\n<p>and</p>\n\n<p>=Index(List!G:G,Match(Data!B7,List!D:D,0),1) for the right of it</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 123, "user_id": 5124315, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/D0B2S.jpg?s=128&g=1", "display_name": "Abigal", "link": "https://stackoverflow.com/users/5124315/abigal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 44018583, "answer_count": 1, "score": 0, "last_activity_date": 1495007759, "creation_date": 1495006526, "last_edit_date": 1531161705, "question_id": 44018408, "link": "https://stackoverflow.com/questions/44018408/look-up-data-left-and-right-with-or-without-vba", "title": "look up data left and right (with or without VBA)", "body": "<p>I have an excel file with 2 worksheets.</p>\n\n<p>On the first worksheet called \"data\", I want to look up data from the second worksheet called \"List\". The data that I need to look up comes from the left and right of the look up value. Therefore, I would like to know your suggestion on the best formula or code to be collect data from the both side simulaniously. </p>\n\n<pre><code>Worksheet 1 name \"Data\" &gt; Value to look up is in \"B7\" is \"John\"\n\nWorksheet 2 name \"List\" &gt; Matching value to be looked up is in \"D7\" is \"John\"\n                    &gt; Return a value from \"A7\" -3 cells to the left\n                    &gt; Return a value from \"G7\" 3 cells to the right\n</code></pre>\n\n<p>Any suggestions? </p>\n"}, {"tags": ["arrays", "vba", "output"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6881287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/78948b859aefa7a126cf6246d2bdfd19?s=128&d=identicon&r=PG&f=1", "display_name": "Fabby", "link": "https://stackoverflow.com/users/6881287/fabby"}, "edited": false, "score": 0, "creation_date": 1495012609, "post_id": 44020031, "comment_id": 75068091, "body": "Huy, thanks for the solution, just struggling with the w = myWedge(x,a)  what is &quot;X&quot;"}, {"owner": {"reputation": 483, "user_id": 2708741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845133c785e2d656ce763ddd930bfd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Huy Pham", "link": "https://stackoverflow.com/users/2708741/huy-pham"}, "reply_to_user": {"reputation": 71, "user_id": 6881287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/78948b859aefa7a126cf6246d2bdfd19?s=128&d=identicon&r=PG&f=1", "display_name": "Fabby", "link": "https://stackoverflow.com/users/6881287/fabby"}, "edited": false, "score": 0, "creation_date": 1495015153, "post_id": 44020031, "comment_id": 75069872, "body": "I just copy from your sample YGBL(x, a).... so in this instance, you can make another outside loop for x = 1 to 99...."}], "tags": [], "owner": {"reputation": 483, "user_id": 2708741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845133c785e2d656ce763ddd930bfd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Huy Pham", "link": "https://stackoverflow.com/users/2708741/huy-pham"}, "is_accepted": true, "score": 1, "last_activity_date": 1495011244, "creation_date": 1495011244, "answer_id": 44020031, "question_id": 44018327, "link": "https://stackoverflow.com/questions/44018327/output-array-contents-without-selecting-each-element/44020031#44020031", "title": "Output Array Contents without selecting each element", "body": "<p>Use a function....</p>\n\n<pre><code>Function PropertyOf(wedgeType As Wedge, index As Integer) As Long\n  Dim w As Long\n\n  With wedgeType\n    Select Case index\n      Case 1\n         w = .C407\n      Case 2\n         w = .C417\n      Case 3\n         w = .C507\n      ....\n    End Select\n  End With\n  PropertyOf = w\nEnd Function\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>Dim w As Wedge\nFor a = 1 To 4\n  w = myWedge(x, a)\n  For c = 1 To 35\n     p = PropertyOf(w, c)\n     If p &gt; 0 Then\n        ' Do your stuff here\n     End If\n  Next c\nNext i\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6881287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/78948b859aefa7a126cf6246d2bdfd19?s=128&d=identicon&r=PG&f=1", "display_name": "Fabby", "link": "https://stackoverflow.com/users/6881287/fabby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 44020031, "answer_count": 1, "score": 0, "last_activity_date": 1495011244, "creation_date": 1495006275, "question_id": 44018327, "link": "https://stackoverflow.com/questions/44018327/output-array-contents-without-selecting-each-element", "title": "Output Array Contents without selecting each element", "body": "<p>I have the following multidimensional array structure </p>\n\n<pre><code>Type Wedge\n    C407                As Long\n    C417                As Long\n    C507                As Long\n    C516                As Long\n    C607                As Long\n    C617                As Long\n    C707                As Long\n    C716                As Long\n    C807                As Long\n    C817                As Long\n    C907                As Long\n    C916                As Long\nEnd Type\n</code></pre>\n\n<p>The above has about 35 elements to it</p>\n\n<pre><code>Global myWedge() As Wedge\nReDim myWedge(99, 4)\n</code></pre>\n\n<p>I have populated the array but now want to output the contents of the array to a worksheet.  Previously in other smaller arrays I have outputted each element as below.</p>\n\n<pre><code>  'Output IOTT Number and Duration\n        For a = 1 To 4\n           If YGBL(x, a).IOTT &gt; 0 Then sOutput.Cells(x + 4, IOTTCol) = YGBL(x, a).IOTT\n               IOTTCol = IOTTCol + 2\n           If YGBL(x, a).IOTTDUR &gt; 0 Then sOutput.Cells(x + 4, IOTTDUR) = YGBL(x, a).IOTTDUR\n               IOTTDUR = IOTTDUR + 2\n        Next a\n</code></pre>\n\n<p>But given the number of elements I just want to loop through the elements and put this into a sheet without have to do the above for each elements.</p>\n\n<p>Is this possible</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": false, "score": 0, "last_activity_date": 1495006964, "creation_date": 1495006964, "answer_id": 44018549, "question_id": 44018278, "link": "https://stackoverflow.com/questions/44018278/excel-macro-to-close-all-open-workbooks/44018549#44018549", "title": "Excel macro to close all open workbooks", "body": "<p>save the new name in a variable and use <code>Workbook(\"name\").close(true)</code></p>\n\n<pre><code>Dim wbName As String\n\nDo Until MyFileName = \"\"\n    Workbooks.Open Filename:=MyPath &amp; MyFileName\n    wbName = Left(MyFileName, InStr(1, MyFileName, \".xls\") - 1)\n\n    ActiveWorkbook.SaveAs Filename:=wbName, FileFormat:=xlCSV, CreateBackup:=False\n    Workbooks(wbName).Close (True)\n    ActiveWorkbooks.Close SaveChanges:=True\n    MyFileName = Dir\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 7984401, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/55fcada88c9de576c34ef815e0155fa3?s=128&d=identicon&r=PG&f=1", "display_name": "raju", "link": "https://stackoverflow.com/users/7984401/raju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495007437, "creation_date": 1495006102, "last_edit_date": 1531161705, "question_id": 44018278, "link": "https://stackoverflow.com/questions/44018278/excel-macro-to-close-all-open-workbooks", "title": "Excel macro to close all open workbooks", "body": "<p>I have a macro code like</p>\n\n<pre><code> Do Until MyFileName = \"\"\n    Workbooks.Open Filename:=MyPath &amp; MyFileName\n    ActiveWorkbook.SaveAs Filename:=Left(MyFileName, InStr(1, MyFileName, \".xls\") - 1), FileFormat:=xlCSV, CreateBackup:=False\n    ActiveWorkbooks.CloseSaveChanges:=TRUE\n    MyFileName = Dir\nLoop\n</code></pre>\n\n<p>Its working fine but while converting to csv the file is opening. I want to close the file and save changes is true. Please help me. </p>\n"}, {"tags": ["vba", "xls"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1495008581, "creation_date": 1495008581, "answer_id": 44019065, "question_id": 44018145, "link": "https://stackoverflow.com/questions/44018145/looping-through-excel-file-in-folder-skipping-the-pre-processed-ones-vba/44019065#44019065", "title": "Looping through excel file in folder skipping the pre-processed ones (vba)", "body": "<p>Add a function that checks if your file is already processed. Assuming that you have the list of processed files in column A of 1st Worksheet:</p>\n\n<pre><code>Function FileAlreadyProcessed(filename As String) As Boolean\n    Dim r As Range, matchRes As Variant\n    Set r = ThisWorkbook.Sheets(1).Range(\"A:A\")\n\n    matchRes = Application.Match(filename, r, 0)\n    FileAlreadyProcessed = (Not IsError(matchRes))\nEnd Function\n</code></pre>\n\n<p>This function will search Col A for the filename. When found, the function will return true, else false. So add a check in your loop</p>\n\n<pre><code>if not FileAlreadyProcessed(fileName) then\n    ... do your processing\nendif\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8023844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b9fc27d27c3bf2cf57c7fab7b2f12dc?s=128&d=identicon&r=PG&f=1", "display_name": "J.G.", "link": "https://stackoverflow.com/users/8023844/j-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495008581, "creation_date": 1495005669, "last_edit_date": 1495006139, "question_id": 44018145, "link": "https://stackoverflow.com/questions/44018145/looping-through-excel-file-in-folder-skipping-the-pre-processed-ones-vba", "title": "Looping through excel file in folder skipping the pre-processed ones (vba)", "body": "<p>I'm new to the site and I'm learning VBA. </p>\n\n<p>Basically, I created a code which loops through excel files in a folder and processes some data which are subsequently implemented in a single common excel file with the name of the processed file in column A and all the data I want to record in the following cells.</p>\n\n<p>Since I'm working with a lot of XSL files and the folder is constantly updated with new files, I was wondering which is the easiest way to go through the files once again when the macro starts and skipping the pre-processed files, in order to just record the new ones.</p>\n\n<p>Thanks in advice</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "edited": false, "score": 1, "creation_date": 1495006192, "post_id": 44018105, "comment_id": 75063753, "body": "See this <a href=\"http://stackoverflow.com/questions/14396998/how-to-clear-memory-to-prevent-out-of-memory-error-in-excel-vba\">post</a> (ie save the workbook periodically)."}, {"owner": {"reputation": 294, "user_id": 2976401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c5515193d5a58d5d39eff486ed06a92?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/2976401/adam"}, "reply_to_user": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "edited": false, "score": 0, "creation_date": 1495006974, "post_id": 44018105, "comment_id": 75064224, "body": "i&#39;ve added activeworkbook.save after nm.delete. it still shows me the same error. (am i doing this right?)  i think excel died at loading the name list. is there a way to break down the name list and delete them piecemeal?"}], "answers": [{"comments": [{"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "edited": false, "score": 0, "creation_date": 1495016862, "post_id": 44018468, "comment_id": 75071014, "body": "Code logic is wrong: <code>j</code> is incremented and compared against a falling limit as <code>.names.count</code> is dynamic. Of <code>n</code> names, <code>(n-1)&#47;2</code> names will be left undeleted. Besides, the loop is only run through once, so there&#39;s only 1 chunk. @areklipno&#39;s code uses <code>.names.count</code> correctly and should be marked as the answer."}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1495019251, "last_edit_date": 1495019251, "creation_date": 1495006725, "answer_id": 44018468, "question_id": 44018105, "link": "https://stackoverflow.com/questions/44018105/vba-remove-100k-named-ranges/44018468#44018468", "title": "VBA Remove 100k + named ranges", "body": "<p>I suggest you do it in chunks with (as Amorpheuses says) a save in between</p>\n\n<pre><code>    Sub dlname\n\n    Dim j as long\n\n    For j=20000 to 1 step -1\n     if j&lt;=activeworkbook.names.count then\n       activeworkbook.names(j).delete\n     end if\n    Next j\n    activeworkbook.save\n    End sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 528, "user_id": 6266769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4d17dd331dcfe4464dab3d0fec40d3?s=128&d=identicon&r=PG&f=1", "display_name": "areklipno", "link": "https://stackoverflow.com/users/6266769/areklipno"}, "is_accepted": false, "score": 1, "last_activity_date": 1495006960, "creation_date": 1495006960, "answer_id": 44018548, "question_id": 44018105, "link": "https://stackoverflow.com/questions/44018105/vba-remove-100k-named-ranges/44018548#44018548", "title": "VBA Remove 100k + named ranges", "body": "<p>try this:</p>\n\n<pre><code>Do While (ActiveWorkbook.Names.Count &gt; 0)\n\nActiveWorkbook.Names.Item(1).Delete\n\nLoop\n</code></pre>\n"}], "owner": {"reputation": 294, "user_id": 2976401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c5515193d5a58d5d39eff486ed06a92?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/2976401/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1009, "favorite_count": 0, "accepted_answer_id": 44018468, "answer_count": 2, "score": 1, "last_activity_date": 1552008707, "creation_date": 1495005572, "last_edit_date": 1495007074, "question_id": 44018105, "link": "https://stackoverflow.com/questions/44018105/vba-remove-100k-named-ranges", "title": "VBA Remove 100k + named ranges", "body": "<p>So basically I've gotten a legacy excel from my predecessor to process a bunch of data. \nHe basically names each datapoint and process them accordingly. \nThe problem is that his codes does not clear away the old used names, resulting in names accumulating through the years. \nRight now I've got 100k + names in my excel sheet that I can't clear. </p>\n\n<p>I've tried using:</p>\n\n<pre><code>Sub dlname \n\n  Dim nm as name \n\n  For each nm in activeworkbook.names\n\n    nm.delete\n\n  Next nm \n\nEnd sub \n</code></pre>\n\n<p>It'll always give me runtime error 7, out of memory. </p>\n\n<p>Any solutions to this ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1495006608, "post_id": 44018101, "comment_id": 75064000, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17531128/copy-paste-calculate-visible-cells-from-one-column-of-a-filtered-table\">Copy/Paste/Calculate Visible Cells from One Column of a Filtered Table</a>"}, {"owner": {"reputation": 11, "user_id": 4128759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a37b2f9f996626cd2740e7b3b23b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Zunzunm3", "link": "https://stackoverflow.com/users/4128759/zunzunm3"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1495006779, "post_id": 44018101, "comment_id": 75064113, "body": "Thanks, but I need to copy just the first visible 10 rows"}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1495010807, "post_id": 44018101, "comment_id": 75066789, "body": "Iterate on Range.SpecialCells(xlCellTypeVisible).Rows, count to 10 adding each row to a new range that will contain the 10 rows."}, {"owner": {"reputation": 11, "user_id": 4128759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a37b2f9f996626cd2740e7b3b23b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Zunzunm3", "link": "https://stackoverflow.com/users/4128759/zunzunm3"}, "edited": false, "score": 0, "creation_date": 1495020352, "post_id": 44018101, "comment_id": 75073298, "body": "Ok, I&#39;ll try and comment."}, {"owner": {"reputation": 11, "user_id": 4128759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a37b2f9f996626cd2740e7b3b23b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Zunzunm3", "link": "https://stackoverflow.com/users/4128759/zunzunm3"}, "edited": false, "score": 0, "creation_date": 1495035088, "post_id": 44018101, "comment_id": 75084741, "body": "jivko, could you show me an example? Thanks"}], "owner": {"reputation": 11, "user_id": 4128759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a37b2f9f996626cd2740e7b3b23b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Zunzunm3", "link": "https://stackoverflow.com/users/4128759/zunzunm3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 483, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1495005564, "creation_date": 1495005564, "last_edit_date": 1531164843, "question_id": 44018101, "link": "https://stackoverflow.com/questions/44018101/copy-visible-cells-vba", "title": "Copy visible cells vba", "body": "<p>I need to copy a specific number of cells after apply a filter.</p>\n\n<p>In my case, I need to copy the first 10 visible rows.</p>\n\n<p>I tried with Range(Range(\"A5\"), ActiveCell.Offset(10,3)).Select but not works, that copy hidden rows...</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495003421, "post_id": 44016756, "comment_id": 75062020, "body": "Side note: (1) <code>On Error GoTo 0</code> is completely useless here. (2) You should read and follow the whole guide to <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices\">VBA Best Practices</a> which will sort out many issues if you follow it strictly. (3) <code>Dim Lastrow, ecol, eRow As Integer</code> only declares the last variable the others remain <code>Variant</code> and never use <code>Integer</code> use <code>Long</code> instead: <code>Dim Lastrow As Long, ecol As Long, eRow As Long</code>"}, {"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495037175, "post_id": 44016756, "comment_id": 75086234, "body": "@Peh, my intention of using On error Goto 0 is to provide escape when applying this code on loop. Thank you I&#39;ll go through your suggestion."}, {"owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495037369, "post_id": 44016756, "comment_id": 75086347, "body": "@Peh, could you explain your 3) sentence..&quot;only declares the last variable the others remain Variant&quot; ? and whats the importance using long instead of integer?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495087523, "post_id": 44016756, "comment_id": 75105464, "body": "What I mean is that <code>Dim Lastrow, ecol, eRow As Integer</code> is exactly the same as <code>Dim Lastrow As Variant, ecol As Variant, eRow As Integer</code>. And using <code>Integer</code> for counting rows is no good idea because <code>Integer</code> can handle numbers up to 32767 but Excel has rows up to 1048576. Generally we can <a href=\"http://stackoverflow.com/a/26409520/3219613\">conclude that using integer over long has no advantages</a> and that it is good practice never to use <code>Integer</code> except for 16bit systems. For <code>On Error \u2026</code> read <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/5411/error-handling\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "is_accepted": true, "score": 0, "last_activity_date": 1495038457, "creation_date": 1495038457, "answer_id": 44030288, "question_id": 44016756, "link": "https://stackoverflow.com/questions/44016756/copy-paste-range-using-set-values-to-different-workbook/44030288#44030288", "title": "Copy paste range (using set values) to different workbook", "body": "<p>Now it works, remove myRange and solely use Rng.</p>\n\n<pre><code>Option Explicit\n\nSub cont()\n    Application.Volatile\n\n    Dim sht As Worksheet\n    'Dim myRange As Variant\n    Dim Rng As Range\n    Dim Lastrow, ecol, eRow As Long\n    Dim station As String\n    Dim wb As Workbook, wb2 As Workbook\n\n    Set wb = ActiveWorkbook\n    wb.Sheets(\"Nov\").Activate\n\n    eRow = Cells(Rows.Count, 2).End(xlUp).Row\n    station = Range(\"B2\").Value\n    Range(Cells(2, 2), Cells(eRow, 2)).Copy\n    MsgBox \"Transfer data for station: \" &amp; station\n\n    wb.Sheets(\"Nov Template\").Activate\n    Set sht = ActiveWorkbook.Sheets(\"Nov Template\")\n    ecol = sht.UsedRange.Columns.Count\n\n    sht.Range(Cells(1, 2), Cells(eRow, 2)).PasteSpecial xlPasteValues\n    With ActiveSheet.UsedRange\n        Lastrow = .Rows(.Rows.Count).Row\n        Set Rng = Range(Cells(1, \"C\"), Cells(Lastrow, ecol))\n        'myRange = sht.Rng.Value\n    End With\n\n    Workbooks.Open \"G:\\Mean2std\\Merge NDj (2).xlsm\"\n    Set wb2 = ActiveWorkbook\n    'wb2.Worksheets(\"GM\").Range(\"B3:AO32\").Value = myRange\n    wb2.Worksheets(\"GM\").Range(\"B3:AO32\").Value = Rng.Value\n    wb2.Close SaveChanges:=True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 7356308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/175c381bbc51536ccd6a9e0fd1c69660?s=128&d=identicon&r=PG&f=1", "display_name": "Siti Sal", "link": "https://stackoverflow.com/users/7356308/siti-sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 1, "accepted_answer_id": 44030288, "answer_count": 1, "score": 1, "last_activity_date": 1495038457, "creation_date": 1495000920, "last_edit_date": 1495003372, "question_id": 44016756, "link": "https://stackoverflow.com/questions/44016756/copy-paste-range-using-set-values-to-different-workbook", "title": "Copy paste range (using set values) to different workbook", "body": "<p>I have two workbooks, <code>wb</code> and <code>wb2</code>. What I want to do,</p>\n\n<ol>\n<li><p>Copy data from sheet <code>Nov</code> to sheet <code>Nov Temp</code> in <code>wb</code> // this part, code is working.</p></li>\n<li><p>Copy specific range in <code>wb</code> to <code>wb2</code>. // I try to use <code>Rng</code> to set value but it didn't work possibly due to the way I address my range. <code>Rng</code> in <code>(myRange = sht.Rng.Value)</code> is highlighted for </p>\n\n<blockquote>\n  <p>compile error; method or data member not found. </p>\n</blockquote></li>\n</ol>\n\n<p>Please help...</p>\n\n<pre><code>Option Explicit\n\nSub cont()\n    Application.Volatile\n\n    Dim sht As Worksheet\n    Dim myRange As Variant\n    Dim Rng As Range\n    Dim Lastrow, ecol, eRow As Integer\n    Dim station As String\n    Dim wb As Workbook, wb2 As Workbook\n\n    Set wb = ActiveWorkbook\n    wb.Sheets(\"Nov\").Activate\n\n    eRow = Cells(Rows.Count, 2).End(xlUp).Row\n    station = Range(\"B2\").Value\n    Range(Cells(2, 2), Cells(eRow, 2)).Copy\n    MsgBox \"Transfer data for station: \" &amp; station\n\n    On Error GoTo 0\n\n    wb.Sheets(\"Nov Template\").Activate\n    Set sht = ActiveWorkbook.Sheets(\"Nov Template\")\n    ecol = sht.UsedRange.Columns.Count\n\n    sht.Range(Cells(1, 2), Cells(eRow, 2)).PasteSpecial xlPasteValues\n    With ActiveSheet.UsedRange\n        Lastrow = .Rows(.Rows.Count).Row\n        Set Rng = Range(Cells(1, \"C\"), Cells(Lastrow, ecol))\n        myRange = sht.Rng.Value\n    End With\n\n    Workbooks.Open \"G:\\Mean2std\\Merge NDj (2).xlsm\"\n    Set wb2 = ActiveWorkbook\n    wb2.Worksheets(\"GM\").Range(\"B3:AO32\").Value = myRange\n    wb2.Close SaveChanges:=True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 7292819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986e6709d8b360153849def9dcf8fea8?s=128&d=identicon&r=PG&f=1", "display_name": "Gary99", "link": "https://stackoverflow.com/users/7292819/gary99"}, "edited": false, "score": 0, "creation_date": 1495056768, "post_id": 44016973, "comment_id": 75096902, "body": "This would be easier to read if the SQL were formatted as code.  Please see &#39;Help&#39; at the top right of the answer window for how to do this."}], "tags": [], "owner": {"reputation": 182, "user_id": 8023405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628b17284783fbc6aa4abf9e2485ec7c?s=128&d=identicon&r=PG&f=1", "display_name": "Zedee.Chen", "link": "https://stackoverflow.com/users/8023405/zedee-chen"}, "is_accepted": true, "score": 0, "last_activity_date": 1495001918, "creation_date": 1495001918, "answer_id": 44016973, "question_id": 44016734, "link": "https://stackoverflow.com/questions/44016734/how-to-export-sql-script-file-into-excel-column/44016973#44016973", "title": "How to export SQL script file into Excel column", "body": "<p>U can try \"Find\" to locate the position, and \"MID\" to cut text.</p>\n\n<p>e.g. (assuming a sql  update student set sname='xyz' where RollID='101';  is put in cell A1)</p>\n\n<p>=FIND(\"sname=\",A1,1)+7 - means the begining position of xyz (7 means length of sname='), assuming this formula is put in B1</p>\n\n<p>=FIND(\"' where Roll\", A1) - means the ending position of xyz, assuming this formula is put in C1</p>\n\n<p>then, the below formula give you xyz\n=MID(A1, B1,C1-B1)</p>\n"}], "owner": {"reputation": 3, "user_id": 7923764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5addea4fea0eba27153bb880b6baa843?s=128&d=identicon&r=PG&f=1", "display_name": "Barun Kumar Jha", "link": "https://stackoverflow.com/users/7923764/barun-kumar-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 44016973, "answer_count": 1, "score": 0, "last_activity_date": 1495001918, "creation_date": 1495000846, "last_edit_date": 1531164843, "question_id": 44016734, "link": "https://stackoverflow.com/questions/44016734/how-to-export-sql-script-file-into-excel-column", "title": "How to export SQL script file into Excel column", "body": "<p>I have a SQL script file suppose <code>student.sql</code> (placed somewhere) like:</p>\n\n<pre><code>update student set sname='xyz' where RollID='101';\n\nupdate student set sname='axz' where RollID='102';\n</code></pre>\n\n<p>I want to export value of <code>sname</code> and <code>RollID</code> into on Excel on column wise for each rows.</p>\n\n<p>How to export the column values. Kindly help, I will highly solicited to you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1495001083, "post_id": 44016576, "comment_id": 75060792, "body": "Well you are creating new file every time you run the code, why not look for the file first then create one if it does not exist"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495001780, "post_id": 44016576, "comment_id": 75061108, "body": "Side notes: (1) You <b>must</b> specify the type of <b>every</b> variable. Declaring <code>Dim lRow, lCol As Integer</code> only <code>lCol</code> is <code>Interger</code> and <code>IRow</code> remains <code>Variant</code>. Also you must use <code>Long</code> for row counting variables (or never use Integer at all unless communicating with old 16bit APIs): <code>Dim lRow As Long, lCol As Long</code>. (2) <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9218/never-assume-the-worksheet\">Never assume the Worksheet</a> always fully qualify your cells/ranges."}], "answers": [{"comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1495002340, "post_id": 44016927, "comment_id": 75061431, "body": "What is the different between your code and the OP&#39;s code?"}, {"owner": {"reputation": 97, "user_id": 7809596, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/30ad2942f8ddfa31368d9b8bb3d052d2?s=128&d=identicon&r=PG&f=1", "display_name": "ZQ7", "link": "https://stackoverflow.com/users/7809596/zq7"}, "edited": false, "score": 0, "creation_date": 1495004244, "post_id": 44016927, "comment_id": 75062536, "body": "yea.. i tried the code but it still does the same to find the current file and replacing the whole file.."}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1495006314, "post_id": 44016927, "comment_id": 75063829, "body": "@0m3r I added the explanation as well, this new IF statements made the main difference now, like your suggestion above."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495006750, "post_id": 44016927, "comment_id": 75064087, "body": "@Mertinc you still should fix your code here: <b>Every</b> <code>Range</code> and <code>Cell</code> should reference to a worksheet like <code>ws.Range</code> anything else is still bad practice."}, {"owner": {"reputation": 97, "user_id": 7809596, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/30ad2942f8ddfa31368d9b8bb3d052d2?s=128&d=identicon&r=PG&f=1", "display_name": "ZQ7", "link": "https://stackoverflow.com/users/7809596/zq7"}, "edited": false, "score": 0, "creation_date": 1495006820, "post_id": 44016927, "comment_id": 75064142, "body": "one more question if you dont mind, (yourdesktopaddress &amp; &quot;\\Testforvba&quot; &amp; cell.Value &amp; &quot;.xls&quot;) does this refer to desktop\\Testforvba &lt;- which is my folder called &#39;Testforvba&#39; and i dont quite understand the cell.value.. my database file is named as database.xlsx"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 97, "user_id": 7809596, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/30ad2942f8ddfa31368d9b8bb3d052d2?s=128&d=identicon&r=PG&f=1", "display_name": "ZQ7", "link": "https://stackoverflow.com/users/7809596/zq7"}, "edited": false, "score": 0, "creation_date": 1495009462, "post_id": 44016927, "comment_id": 75065778, "body": "@user7809596 I added  <code>&amp; &quot;\\Testforvba&quot;</code> to the end of this code to define your folder as Testforvba. <code>yourdesktopaddress = CreateObject(&quot;WScript.Shell&quot;).specialfolders(&quot;Desktop&quot;) &amp; &quot;\\Testforvba&quot;</code> Now it will save it to Testforvba folder."}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1495009595, "post_id": 44016927, "comment_id": 75065877, "body": "@Peh there was thousands of them &amp; I was missing some of them each time lol. Now hopefully everything is fine?"}, {"owner": {"reputation": 97, "user_id": 7809596, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/30ad2942f8ddfa31368d9b8bb3d052d2?s=128&d=identicon&r=PG&f=1", "display_name": "ZQ7", "link": "https://stackoverflow.com/users/7809596/zq7"}, "edited": false, "score": 0, "creation_date": 1495009744, "post_id": 44016927, "comment_id": 75065975, "body": "But how do i let it focus on that specific excel file called &#39;Database&#39;?"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1495009863, "post_id": 44016927, "comment_id": 75066058, "body": "You have specified <code>cell.Value</code> as your new workbook name in your question. And I don&#39;t understand where do you want to use that <code>Database</code> name?"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 97, "user_id": 7809596, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/30ad2942f8ddfa31368d9b8bb3d052d2?s=128&d=identicon&r=PG&f=1", "display_name": "ZQ7", "link": "https://stackoverflow.com/users/7809596/zq7"}, "edited": false, "score": 0, "creation_date": 1495010289, "post_id": 44016927, "comment_id": 75066382, "body": "that cell.Value as <i>you</i> defined in your question, is either B1 or C1 or D1 or E1.... it depends on which stage your code is in and then <i>you</i> again defined it to be the workbook name. @user7809596"}, {"owner": {"reputation": 97, "user_id": 7809596, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/30ad2942f8ddfa31368d9b8bb3d052d2?s=128&d=identicon&r=PG&f=1", "display_name": "ZQ7", "link": "https://stackoverflow.com/users/7809596/zq7"}, "edited": false, "score": 0, "creation_date": 1495010620, "post_id": 44016927, "comment_id": 75066647, "body": "ah my bad, it was my friend that told me to input that. but i dont see the cell.value to be working tho.. i will try and direct it to my &#39;Database&#39; file. Thanks!"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "reply_to_user": {"reputation": 97, "user_id": 7809596, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/30ad2942f8ddfa31368d9b8bb3d052d2?s=128&d=identicon&r=PG&f=1", "display_name": "ZQ7", "link": "https://stackoverflow.com/users/7809596/zq7"}, "edited": false, "score": 0, "creation_date": 1495011490, "post_id": 44016927, "comment_id": 75067300, "body": "So, as long as your question is solved please don&#39;t forget to approve this answer as an answer. You are welcome. @user7809596"}], "tags": [], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "is_accepted": true, "score": 0, "last_activity_date": 1495009363, "last_edit_date": 1495009363, "creation_date": 1495001741, "answer_id": 44016927, "question_id": 44016576, "link": "https://stackoverflow.com/questions/44016576/how-to-save-to-the-next-available-row-instead-of-replacing-it/44016927#44016927", "title": "How to save to the next available row instead of replacing it", "body": "<p>Try this one:</p>\n\n<pre><code>Option Explicit\n\nSub RunMe()\n    Application.ScreenUpdating = False\n    Dim lRow As Long, lCol As Long\n\n    Dim wb As Workbook, wbNew as Workbook\n    Dim ws As Worksheet, wsNew as Worksheet\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"Sheet1\")\n\n    lRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    lCol = ws.Cells(1, Columns.Count).End(xlToLeft).Column\n\n    Dim cell As Variant\n    For Each cell In ws.Range(ws.Cells(1, \"B\"), ws.Cells(1, lCol))\n        Union(ws.Range(\"A1:A\" &amp; lRow), ws.Range(ws.Cells(1, cell.Column), ws.Cells(lRow, cell.Column))).Copy\n        Set wbNew = Workbooks.Add\n        Set wsNew = wbNew.Sheets(\"Sheet1\")\n        Dim yourdesktopaddress As String\n        yourdesktopaddress = CreateObject(\"WScript.Shell\").specialfolders(\"Desktop\") &amp; \"\\Testforvba\"\n        wsNew.Range(\"A1\").PasteSpecial\n    If Not Dir(yourdesktopaddress &amp; \"\\\" &amp; cell.Value &amp; \".xls\", vbDirectory) = vbNullString Then\n       'MsgBox \"exists\"\n        Application.DisplayAlerts = False\n    Else\n        Application.DisplayAlerts = False\n        ActiveWorkbook.SaveAs Filename:= _\n        yourdesktopaddress &amp; \"\\\" &amp; cell.Value &amp; \".xls\"\n    End If\n\n    wbNew.Close\n    Application.DisplayAlerts = True        \n    Next cell\n\n    Application.CutCopyMode = False\n    Application.ScreenUpdating = True\n    End Sub\n</code></pre>\n\n<p>The main issue was, whenever macro runs, Excel was creating the files from zero and this was causing Excel to recreate each file again. I have added that  <code>If Not Dir(yourdesktopaddress &amp; \"\\Testforvba\" &amp; cell.Value &amp; \".xls\", vbDirectory) = vbNullString</code> part of my code to check whether did this file already created or not, if not it's creating the file now. If you delete the \"<strong>'</strong>\" from the beginning of <code>'MsgBox \"exists\"</code> it will always tell you that this file is already exist.</p>\n\n<p><strong><em>Also</em></strong> In the case of variables are not defined well, excel might start to overwrite itself and it may replace the previous data. (Especially <code>Range(\"A1).PasteSpecial</code> and <code>Activeworkbook.close</code> kind of critical points are most important ones) So I also edited whole code,defined all variables, defined the user's desktop address to ensure code works on every user.</p>\n"}], "owner": {"reputation": 97, "user_id": 7809596, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/30ad2942f8ddfa31368d9b8bb3d052d2?s=128&d=identicon&r=PG&f=1", "display_name": "ZQ7", "link": "https://stackoverflow.com/users/7809596/zq7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 44016927, "answer_count": 1, "score": 0, "last_activity_date": 1495009363, "creation_date": 1495000186, "last_edit_date": 1495001384, "question_id": 44016576, "link": "https://stackoverflow.com/questions/44016576/how-to-save-to-the-next-available-row-instead-of-replacing-it", "title": "How to save to the next available row instead of replacing it", "body": "<p>I had tried to use VBA to help grab values from a Excel form into a another workbook (Which is blank inside for now) here is the VBA code I'm using: </p>\n\n<pre><code>Sub RunMe()\n    Dim lRow, lCol As Integer\n\n    Sheets(\"Sheet1\").Select\n    lRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    lCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\n    For Each cell In Range(Cells(1, \"B\"), Cells(1, lCol))\n        Union(Range(\"A1:A\" &amp; lRow), Range(Cells(1, cell.Column), Cells(lRow, cell.Column))).Copy\n        Workbooks.Add\n        Range(\"A1\").PasteSpecial\n        ActiveWorkbook.SaveAs Filename:= _\n          \"C:\\Users\\john\\Desktop\\Testforvba\" &amp; cell.Value &amp; \".xls\"\n        ActiveWorkbook.Close\n    Next cell\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>But the thing is that when I run this code after inputting a sample value on the form and manually run the macro, it works as it creates a new file and store the sample data I had type on the Form workbook.\nBut once I tried running the macro again, I realised that it recreates the file AGAIN which means it replace all the previous data. VBA is so dang hard lol. Anyone please give a hand thanks.</p>\n\n<p>P.S The macro I stored in my personal Workbook</p>\n"}, {"tags": ["regex", "vba", "preg-replace", "ms-word"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1494998816, "post_id": 44015655, "comment_id": 75059801, "body": "Maybe this is obvious, but I don&#39;t understand. Why not use the normal search and replace? Just start with the highest number and work your way down."}, {"owner": {"reputation": 442, "user_id": 7968598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828aaa1f81ed8ab493a83ae4ec824ad7?s=128&d=identicon&r=PG&f=1", "display_name": "Eki", "link": "https://stackoverflow.com/users/7968598/eki"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1495001297, "post_id": 44015655, "comment_id": 75060892, "body": "@Andreas  I want to find a more convenient way to solve this kind of problems, and then next I will not need to search and replace again and again and only need to change some code and click run :)"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1495002310, "post_id": 44015655, "comment_id": 75061412, "body": "Ok. What about you do a regex match and manipulate the match then do a &quot;replace&quot; with oldstring and newstring?  I&#39;m not sure regex replace works the way you want. Regex match on the other hand will work."}, {"owner": {"reputation": 442, "user_id": 7968598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828aaa1f81ed8ab493a83ae4ec824ad7?s=128&d=identicon&r=PG&f=1", "display_name": "Eki", "link": "https://stackoverflow.com/users/7968598/eki"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1495007458, "post_id": 44015655, "comment_id": 75064519, "body": "@Andreas I don&#39;t know how to limit the scope of each replacement because I am not familiar with the grammar of VBA. If the full text is replaced by every newstring every time it may lead to some repeated replacement. Wiktor Stribi\u017cew  have given the solution way under and it work!"}], "answers": [{"comments": [{"owner": {"reputation": 442, "user_id": 7968598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828aaa1f81ed8ab493a83ae4ec824ad7?s=128&d=identicon&r=PG&f=1", "display_name": "Eki", "link": "https://stackoverflow.com/users/7968598/eki"}, "edited": false, "score": 1, "creation_date": 1495007678, "post_id": 44017804, "comment_id": 75064645, "body": "Thank you Wiktor Stribi\u017cew! Cool codes and it work preferly!"}, {"owner": {"reputation": 442, "user_id": 7968598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828aaa1f81ed8ab493a83ae4ec824ad7?s=128&d=identicon&r=PG&f=1", "display_name": "Eki", "link": "https://stackoverflow.com/users/7968598/eki"}, "edited": false, "score": 1, "creation_date": 1495009377, "post_id": 44017804, "comment_id": 75065719, "body": "Have clicked. I am a new user of stackoverflow so is not familiar with that function yet. :P"}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1495004641, "creation_date": 1495004641, "answer_id": 44017804, "question_id": 44015655, "link": "https://stackoverflow.com/questions/44015655/how-to-replace-numbers-in-parentheses-with-some-calculations-in-ms-word/44017804#44017804", "title": "How to replace Numbers in Parentheses with some calculations in MS Word", "body": "<p>It is impossible to pass a callback function to the <code>RegExp.Replace</code>, so you have the only option: use <code>RegExp.execute</code> and process matches in a loop.</p>\n\n<p>Here is an example code for your case (I took a shortcut since you only have the value to modify inside known delimiters, <code>[</code> and <code>]</code>.)</p>\n\n<pre><code>Sub replaceWithregExp()\n\nDim regExp As Object\nDim regx, S$, Strnew$\nSet regExp = CreateObject(\"vbscript.regexp\")\nWith regExp\n    .Pattern = \"\\[([0-9]{2})]\"\n    .Global = True\nEnd With\n'How to do some calculations with $1?\n' Removing regExp.Replace(Selection.Text, \"[$1]\")\nFor Each m In regExp.Execute(Selection.Text)\n    Selection.Text = Left(Selection.Text, m.FirstIndex+1) _\n        &amp; Replace(m.Value, m.Value, CStr(CInt(m.Submatches(0)) + 10)) _\n        &amp; Mid(Selection.Text, m.FirstIndex + Len(m.Value))\nNext m\n\nEnd Sub\n</code></pre>\n\n<p>Here, </p>\n\n<ul>\n<li><code>Selection.Text = Left(Selection.Text, m.FirstIndex+1)</code> - Get what is before</li>\n<li><code>&amp; Replace(m.Value, m.Value, CStr(CInt(m.Submatches(0)) + 10))</code> - Add <code>10</code> to the captured number</li>\n<li><code>&amp; Mid(Selection.Text, m.FirstIndex + Len(m.Value))</code> - Append what is after the capture</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1495006086, "creation_date": 1495006086, "answer_id": 44018269, "question_id": 44015655, "link": "https://stackoverflow.com/questions/44015655/how-to-replace-numbers-in-parentheses-with-some-calculations-in-ms-word/44018269#44018269", "title": "How to replace Numbers in Parentheses with some calculations in MS Word", "body": "<p>That should do the trick :</p>\n\n<pre><code>Sub IncrementWithRegex()\n    Dim Para As Paragraph\n    Set Para = ThisDocument.Paragraphs.First\n    Dim ParaNext As Paragraph\n    Dim oRange As Range\n    Set oRange = Para.Range\n    Dim regEx As New RegExp\n    Dim regMatch As Variant\n    Dim ACrO As String\n\n    With regEx\n        .Global = True\n        .MultiLine = False\n        .IgnoreCase = False\n        .Pattern = \"[\\[]([0-9]{2})[\\]]\"\n    End With\n\n    Do While Not Para Is Nothing\n        Set ParaNext = Para.Next\n        Set oRange = Para.Range\n        'Debug.Print oRange.Text\n        If regEx.test(oRange.Text) Then\n            For Each regMatch In regEx.Execute(oRange.Text)\n                oRange.Text = _\n                    Left(oRange.Text, _\n                         InStr(1, oRange.Text, CStr(regMatch))) &amp; _\n                    CDbl(regMatch) + 1 &amp; _\n                    Right(oRange.Text, _\n                          Len(CStr(regMatch)) + InStr(1, oRange.Text, CStr(regMatch)))\n            Next regMatch\n        Else\n        End If\n        Set Para = ParaNext\n    Loop\nEnd Sub\n</code></pre>\n\n<p>To use this, remember to add the reference :</p>\n\n<pre><code>Description: Microsoft VBScript Regular Expressions 5.5\nFullPath: C:\\windows\\SysWOW64\\vbscript.dll\\3\nMajor.Minor: 5.5\nName:     VBScript_RegExp_55\nGUID: {3F4DACA7-160D-11D2-A8E9-00104B365C9F}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 442, "user_id": 7968598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828aaa1f81ed8ab493a83ae4ec824ad7?s=128&d=identicon&r=PG&f=1", "display_name": "Eki", "link": "https://stackoverflow.com/users/7968598/eki"}, "edited": false, "score": 0, "creation_date": 1495009110, "post_id": 44018268, "comment_id": 75065554, "body": "Thanks for your answer! But this method may sometimes have a bit of problem. Because the reference literature serial number is not necessarily ascending in the article. For example sometimes I may quote a same reference literature at the beginning and end of the article."}, {"owner": {"reputation": 3136, "user_id": 7557538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SYpca.jpg?s=128&g=1", "display_name": "Stephane Janicaud", "link": "https://stackoverflow.com/users/7557538/stephane-janicaud"}, "reply_to_user": {"reputation": 442, "user_id": 7968598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828aaa1f81ed8ab493a83ae4ec824ad7?s=128&d=identicon&r=PG&f=1", "display_name": "Eki", "link": "https://stackoverflow.com/users/7968598/eki"}, "edited": false, "score": 0, "creation_date": 1495009870, "post_id": 44018268, "comment_id": 75066067, "body": "Ok, I&#39;ll fix this in a few hours ;)"}], "tags": [], "owner": {"reputation": 3136, "user_id": 7557538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SYpca.jpg?s=128&g=1", "display_name": "Stephane Janicaud", "link": "https://stackoverflow.com/users/7557538/stephane-janicaud"}, "is_accepted": false, "score": 1, "last_activity_date": 1495010880, "last_edit_date": 1495010880, "creation_date": 1495006086, "answer_id": 44018268, "question_id": 44015655, "link": "https://stackoverflow.com/questions/44015655/how-to-replace-numbers-in-parentheses-with-some-calculations-in-ms-word/44018268#44018268", "title": "How to replace Numbers in Parentheses with some calculations in MS Word", "body": "<p>Here is a simple VBA macro you can use to achieve this :</p>\n\n<pre><code>Sub IncrementNumbers()\n\n    Dim regExp As Object\n    Dim i As Integer\n    Dim fullMatch As String\n    Dim subMatch As Integer\n    Dim replacement As String\n    Const TMP_PREFIX As String = \"$$$\"\n\n    Set regExp = CreateObject(\"vbscript.regexp\")\n    With regExp\n        .Pattern = \"\\[([0-9]{2})\\]\"\n        .Global = True\n        .MultiLine = True\n    End With\n\n    'Ensure selected text match our regex\n    If regExp.test(Selection.Text) Then\n        'Find all matches\n        Set matches = regExp.Execute(Selection.Text)\n        ' Start from last match\n        For i = 0 To (matches.Count - 1)\n            fullMatch = matches(i).Value\n            subMatch = CInt(matches(i).SubMatches(0))\n            'Increment by 1\n            subMatch = subMatch + 1\n            'Create replacement. Add a temporary prefix so we ensure [30] replaced with [31]\n            'will not be replaced with [32] when [31] will be replaced\n            replacement = \"[\" &amp; TMP_PREFIX &amp; subMatch &amp; \"]\"\n            'Replace full match with [subMatch]\n            Selection.Text = Replace(Selection.Text, fullMatch, replacement)\n        Next\n    End If\n\n    'Now replacements are complete, we have to remove replacement prefix\n    Selection.Text = Replace(Selection.Text, TMP_PREFIX, \"\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 442, "user_id": 7968598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828aaa1f81ed8ab493a83ae4ec824ad7?s=128&d=identicon&r=PG&f=1", "display_name": "Eki", "link": "https://stackoverflow.com/users/7968598/eki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 1, "accepted_answer_id": 44017804, "answer_count": 3, "score": 2, "last_activity_date": 1495010880, "creation_date": 1494995588, "last_edit_date": 1495541894, "question_id": 44015655, "link": "https://stackoverflow.com/questions/44015655/how-to-replace-numbers-in-parentheses-with-some-calculations-in-ms-word", "title": "How to replace Numbers in Parentheses with some calculations in MS Word", "body": "<p>I have a problem to replace some serial number such as [30] [31] [32]... to [31] [32] [33]... in MS word when I insert a new references in the middle of article. I have not found a solution way in GUI so I try to use VBA to do that replacement. I find a similar problem in stack overflow:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/30154503/ms-word-macro-to-increment-all-numbers-in-word-document\">MS Word Macro to increment all numbers in word document</a></p>\n\n<p>However, this way is a bit inconvenient because it have to generate some replacement array in other place. Can I make that replacement with regex and some function in MS Word VBA like code below?</p>\n\n<pre><code>Sub replaceWithregExp()\n\nDim regExp As Object\nDim regx, S$, Strnew$\nSet regExp = CreateObject(\"vbscript.regexp\")\nWith regExp\n    .Pattern = \"\\[([0-9]{2})\\]\"\n    .Global = True\nEnd With\n'How to do some calculations with $1?\nSelection.Text = regExp.Replace(Selection.Text, \"[$1]\")\nEnd Sub\n</code></pre>\n\n<p>But I don't know how to do some calculations with $1 in regExp? I have try use \"[$1+1]\" but it return [31+1] [32+1] [33+1]. Can anyone help? Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9, "user_id": 8017300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5294b481915f95170dca3f415621916a?s=128&d=identicon&r=PG&f=1", "display_name": "pochimkim", "link": "https://stackoverflow.com/users/8017300/pochimkim"}, "edited": false, "score": 0, "creation_date": 1494991976, "post_id": 44015047, "comment_id": 75057788, "body": "To clarify, the summary page should show all rows from the source sheets that are dated 5/17/2017, with recipient = &quot;Ortigas ATM&quot;"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1494992991, "post_id": 44015047, "comment_id": 75057975, "body": "And how are you planing to run the code? Worksheet.SelectionChange? can you also share your spreadsheet?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1494993008, "post_id": 44015047, "comment_id": 75057977, "body": "How &quot;clearly&quot; is something wrong? Do you expect us to build your environment to run your code so we can see what is wrong or are you prepared to share what you think is wrong and how that manifests?"}, {"owner": {"reputation": 9, "user_id": 8017300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5294b481915f95170dca3f415621916a?s=128&d=identicon&r=PG&f=1", "display_name": "pochimkim", "link": "https://stackoverflow.com/users/8017300/pochimkim"}, "edited": false, "score": 0, "creation_date": 1495003705, "post_id": 44015047, "comment_id": 75062182, "body": "Thank you for responding. I&#39;ve attached the worksheet and edited my post with info re: the syntax error I get. It says there&#39;s an error on the following line: Set ws1 = Sheets(Array(&quot;Ortigas&quot;, &quot;Franchise&quot;, &quot;Movu&quot;)) Set ws2 = Sheets(&quot;Summary&quot;): ws1.Select"}, {"owner": {"reputation": 9, "user_id": 8017300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5294b481915f95170dca3f415621916a?s=128&d=identicon&r=PG&f=1", "display_name": "pochimkim", "link": "https://stackoverflow.com/users/8017300/pochimkim"}, "edited": false, "score": 0, "creation_date": 1495003805, "post_id": 44015047, "comment_id": 75062239, "body": "I added a form button so I can use it to run the macro with every change in the drop down."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8017300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5294b481915f95170dca3f415621916a?s=128&d=identicon&r=PG&f=1", "display_name": "pochimkim", "link": "https://stackoverflow.com/users/8017300/pochimkim"}, "edited": false, "score": 0, "creation_date": 1495003891, "post_id": 44017206, "comment_id": 75062289, "body": "Thank you so much for your help! Will work on your suggestions. However, It&#39;s essential for me to pull data from all the source sheets and not just one sheet. Is there a way to have the code compile data from an array of sheets?"}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "reply_to_user": {"reputation": 9, "user_id": 8017300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5294b481915f95170dca3f415621916a?s=128&d=identicon&r=PG&f=1", "display_name": "pochimkim", "link": "https://stackoverflow.com/users/8017300/pochimkim"}, "edited": false, "score": 0, "creation_date": 1495003983, "post_id": 44017206, "comment_id": 75062350, "body": "You&#39;ll need another loop to do each sheet one at a time."}, {"owner": {"reputation": 9, "user_id": 8017300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5294b481915f95170dca3f415621916a?s=128&d=identicon&r=PG&f=1", "display_name": "pochimkim", "link": "https://stackoverflow.com/users/8017300/pochimkim"}, "edited": false, "score": 0, "creation_date": 1495005458, "post_id": 44017206, "comment_id": 75063268, "body": "Thank you! I will try it."}], "tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": false, "score": 0, "last_activity_date": 1495002674, "creation_date": 1495002674, "answer_id": 44017206, "question_id": 44015047, "link": "https://stackoverflow.com/questions/44015047/copy-rows-from-multiple-excel-sheets-to-a-summary-page-based-on-several-criteria/44017206#44017206", "title": "Copy rows from multiple excel sheets to a summary page based on several criteria", "body": "<p>The following line won't compile with the Array argument:</p>\n\n<pre><code>Set ws1 = ActiveWorkbook.Sheets(Array(\"Ortigas\", \"Franchise\", \"Movu\")) \n</code></pre>\n\n<p>You'll have to choose one of the worksheets for it to work (say \"Ortigas\"); ie:</p>\n\n<pre><code>Set ws1 = ActiveWorkbook.Sheets(\"Ortigas\")\n</code></pre>\n\n<p>Your first .Find command should have the additional parameter: </p>\n\n<pre><code>Set a = .Find(What:=Today_Date, LookAt:=xlPart, LookIn:=xlFormulas)\n</code></pre>\n\n<p>To ensure the copy happens when the 2nd condition is true, you can nest the copy command in an if statement:</p>\n\n<pre><code>If ws1.Cells(a.row,\"D\").Value=ws2.Cells(3,\"B\").Value Then\n   a.EntireRow....\nEndif\n</code></pre>\n\n<p>Also you don't need to set ws1 and ws2 to Nothing.  Once the subroutine returns these variables go out of scope anyway, so you can delete those statements.</p>\n"}], "owner": {"reputation": 9, "user_id": 8017300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5294b481915f95170dca3f415621916a?s=128&d=identicon&r=PG&f=1", "display_name": "pochimkim", "link": "https://stackoverflow.com/users/8017300/pochimkim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495003465, "creation_date": 1494991860, "last_edit_date": 1495003465, "question_id": 44015047, "link": "https://stackoverflow.com/questions/44015047/copy-rows-from-multiple-excel-sheets-to-a-summary-page-based-on-several-criteria", "title": "Copy rows from multiple excel sheets to a summary page based on several criteria", "body": "<p>Thanks in advance for reading this, and for any help at all that you may give. I don't know any VBA but I tracked down some codes from these forums.</p>\n\n<p>I'm trying to copy all rows from three source sheets (Ortigas, Franchise, and Movu) to the Summary tab if they match two criteria: </p>\n\n<p>(1) - date = date today as shown in column A, <br>\n(2) - recipient as shown on column D matches what's on the drop down in 'Summary!'B3.<br></p>\n\n<p><em><a href=\"https://i.stack.imgur.com/6fMor.png\" rel=\"nofollow noreferrer\">Screenshot of sample data from the source sheets</a></em></p>\n\n<blockquote>\n  <p><a href=\"https://i.stack.imgur.com/GUcBP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GUcBP.png\" alt=\"enter image description here\"></a></p>\n</blockquote>\n\n<p><em><a href=\"https://i.stack.imgur.com/ce7EC.png\" rel=\"nofollow noreferrer\">Summary page with drop down</a></em></p>\n\n<blockquote>\n  <p><a href=\"https://i.stack.imgur.com/axE8G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/axE8G.png\" alt=\"enter image description here\"></a></p>\n</blockquote>\n\n<p>Attached is my workbook.<a href=\"https://drive.google.com/open?id=0B1FbsjQ6RkncVFNlMy1aWkdQNnc\" rel=\"nofollow noreferrer\">workbook</a></p>\n\n<p>This is the code I have so far but it says syntax error because of the following line:</p>\n\n<pre><code>Set ws1 = Sheets(Array(\"Ortigas\", \"Franchise\", \"Movu\")) Set ws2 = Sheets(\"Summary\"): ws1.Select\n</code></pre>\n\n<p>I think it's because I put in an array of sheets instead of just one sheet. I've tried different iterations to fix it but it doesn't work. How do I make ws1 refer to an array of sheets?</p>\n\n<p>Hoping for a kind soul who can help me! Thank you so much.</p>\n\n<pre><code>    Sub Test()\n    Dim sheetsArray As SheetsA\n    Set sheetsArray = Sheets(Array(\"Ortigas\", \"Franchise\", \"Movu\"))\n\n    Dim target As Range\n    Dim sheetObject As Worksheet\n\n    ' change value of range 'a1' on each sheet from sheetsArray\n    For Each sheetObject In sheetsArray\n        Set target = sheetObject.Range(\"A1\")\n        target.Value = \"Test\"\n    Next sheetObject\nEnd Sub\n\nSub FindNext_Copy_Data()\n    Dim Last_Row As Long, Next_Row As Long, First_Find As Long\n    Dim Range_Value As Range, a As Variant, i As Integer\n    Dim Today_Date As Date, ws1 As Worksheet, ws2 As Worksheet\n    Application.ScreenUpdating = False\n    Today_Date = Date\n    Set ws1 = Sheets(Array(\"Ortigas\", \"Franchise\", \"Movu\")) Set ws2 = Sheets(\"Summary\"): ws1.Select\n    Next_Row = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n    Last_Row = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set Range_Value = Range(Cells(1, \"A\"), Cells(Last_Row, \"A\"))\n\n    With Range_Value\n        Set a = .Find(What:=Today_Date, LookAt:=xlPart)\n        First_Find = a.Row\n        Do\n            a.EntireRow.Copy Destination:=ws2.Cells(Next_Row, 1): Next_Row = Next_Row + 1\n            Set a = .FindNext(a)\n        Loop While (a.Row &lt;&gt; First_Find)\n    End With\n\n    ws2.Select: Set ws1 = Nothing: Set ws2 = Nothing: Set Range_Value = Nothing\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1494991784, "post_id": 44014969, "comment_id": 75057740, "body": "You may wanna post your code here"}], "answers": [{"tags": [], "owner": {"reputation": 132, "user_id": 2648008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e578798cd12f1fcb707924031d19b7f0?s=128&d=identicon&r=PG", "display_name": "user2648008", "link": "https://stackoverflow.com/users/2648008/user2648008"}, "is_accepted": false, "score": 0, "last_activity_date": 1494995002, "creation_date": 1494995002, "answer_id": 44015540, "question_id": 44014969, "link": "https://stackoverflow.com/questions/44014969/how-to-create-a-button-with-changing-caption-in-excel-vba/44015540#44015540", "title": "How to create a button with changing caption in Excel VBA", "body": "<ol>\n<li>There is no value property for button so instead check for caption</li>\n<li><p>move the code inside sheet1 module (assuming button2 is inside sheet1) to access the button by parent scope</p>\n\n<p>Sub button2_click()\n   If button2.caption = \"include\" then\n     button2.caption = \"exclude\"\n   Else\n     button2.caption = \"include\"\n   End if\n End sub</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 8023027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2710229811e57ff6a7f2e08a1e70386b?s=128&d=identicon&r=PG&f=1", "display_name": "Luso", "link": "https://stackoverflow.com/users/8023027/luso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 711, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1494995002, "creation_date": 1494991392, "last_edit_date": 1531164843, "question_id": 44014969, "link": "https://stackoverflow.com/questions/44014969/how-to-create-a-button-with-changing-caption-in-excel-vba", "title": "How to create a button with changing caption in Excel VBA", "body": "<p>Hi I'm trying to create a button that will change its caption to included when pressed and excluded if not pressed. I have tried to do that, but received an error.</p>\n\n<p>Please, see my screenshot.<br>\n<img src=\"https://i.stack.imgur.com/gr5fg.png\" alt=\"screenshot\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1495101568, "post_id": 44014655, "comment_id": 75114641, "body": "Is none of the answers correct?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2120637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d4a59b37914a7bf695f357e30be71d?s=128&d=identicon&r=PG", "display_name": "William Ho", "link": "https://stackoverflow.com/users/2120637/william-ho"}, "is_accepted": false, "score": 0, "last_activity_date": 1494990985, "creation_date": 1494990985, "answer_id": 44014931, "question_id": 44014655, "link": "https://stackoverflow.com/questions/44014655/vba-rounddown-cashier-program/44014931#44014931", "title": "VBA rounddown cashier program", "body": "<p>exchange = paid - userinput <br>\nget the positive value by change it to this <br>\nexchange = userinput - paid <br>\nrounddown every variable for hundra100, femtio50, and others by using Application.WorksheetFunction.RoundDown function <br>\ne.g.: Application.WorksheetFunction.RoundDown(hundra100, 0)<br><br>\n<code>hundra100  = exchange / 100</code><br>\n<code>hundra100  = Application.WorksheetFunction.RoundDown(hundra100, 0)</code><br>\n<code>kvarHundra = exchange Mod 100</code><br>\n<code>Range(\"A2\").Value = hundra100</code><br></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7555320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa35fb4704d6db873de67b9703c7dc38?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/7555320/cam"}, "edited": false, "score": 0, "creation_date": 1495161843, "post_id": 44016014, "comment_id": 75146067, "body": "Thanks a lot, this helped and worked out fine! Thanks again!"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 1, "user_id": 7555320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa35fb4704d6db873de67b9703c7dc38?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/7555320/cam"}, "edited": false, "score": 0, "creation_date": 1495169780, "post_id": 44016014, "comment_id": 75148049, "body": "It would be nice if you accepted my answer. <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 1, "user_id": 7555320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa35fb4704d6db873de67b9703c7dc38?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/7555320/cam"}, "edited": false, "score": 0, "creation_date": 1496062862, "post_id": 44016014, "comment_id": 75495207, "body": "@Cam ? When people see that you don&#39;t accept people&#39;s answers they will not help you."}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 0, "last_activity_date": 1494997861, "last_edit_date": 1494997861, "creation_date": 1494997460, "answer_id": 44016014, "question_id": 44014655, "link": "https://stackoverflow.com/questions/44014655/vba-rounddown-cashier-program/44016014#44016014", "title": "VBA rounddown cashier program", "body": "<p>Instead of rounding as William suggests you can use int() to truncate the float.  </p>\n\n<pre><code>Sub ttt()\n    Dim userinput As Integer\n    Dim paid As Integer\n\n    Dim hundra100 As Integer\n    Dim femtio50 As Integer\n    Dim tjugo20 As Integer\n    Dim tio10 As Integer\n    Dim fem5 As Integer\n    Dim ett1 As Integer\n\n    userinput = InputBox(\"How much did the products cost?\", \"Cost\")\n    paid = InputBox(\"How much did you pay with?\", \"Paid\")\n\n    exchange = paid - userinput\n\n    hundra100 = Int(exchange / 100)\n    kvarHundra = exchange Mod 100\n\n    femtio50 = Int(kvarHundra / 50)\n    kvarFemtio = kvarHundra Mod 50\n\n    tjugo20 = Int(kvarFemtio / 20)\n    kvarTjugo = kvarFemtio Mod 20\n\n    tio10 = Int(kvarTjugo / 10)\n    kvarTio = kvarTjugo Mod 10\n\n    fem5 = Int(kvarTio / 5)\n    kvarFem = kvarTio Mod 5\n\n    ett1 = kvarFem / 1\n\n    MsgBox (\"Your change is: \" &amp; exchange &amp; vbNewLine &amp; \"100: \" &amp; hundra100 &amp; vbNewLine &amp; \"50: \" &amp; femtio50 &amp; vbNewLine _\n    &amp; \"20: \" &amp; tjugo20 &amp; vbNewLine &amp; \"10: \" &amp; tio10 &amp; vbNewLine &amp; \"5: \" &amp; fem5 &amp; vbNewLine &amp; \"1: \" &amp; ett1)\nEnd Sub\n</code></pre>\n\n<p>The problem with the code is that all your variables are declared as integers but in your calculation the number becomes a float so it rounds the number.</p>\n"}], "owner": {"reputation": 1, "user_id": 7555320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa35fb4704d6db873de67b9703c7dc38?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/7555320/cam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494997959, "creation_date": 1494989121, "last_edit_date": 1494997959, "question_id": 44014655, "link": "https://stackoverflow.com/questions/44014655/vba-rounddown-cashier-program", "title": "VBA rounddown cashier program", "body": "<p>I am new at VBA and I am trying to create a program that gives the amount of 100, 50, 20, 10, 5 and 1 after the user enters how much the product cost and how much he paid with. It works, however if the user pay 30 for the product with 200, then the program gives back 2 x 100, as change. Where it should only be 1 x hundred, 1 x fifty and 1 x 20. Can someone help me out? </p>\n\n<p>Here is my code: </p>\n\n<pre><code>Dim userinput As Integer\nDim paid As Integer\n\nDim hundra100 As Integer\nDim femtio50 As Integer\nDim tjugo20 As Integer\nDim tio10 As Integer\nDim fem5 As Integer\nDim ett1 As Integer\n\nuserinput = InputBox(\"How much did the products cost?\", \"Cost\")\npaid = InputBox(\"How much did you pay with?\", \"Paid\")\n\nexchange = paid - userinput\n\nhundra100 = exchange / 100\nkvarHundra = exchange Mod 100\n\nfemtio50 = kvarHundra / 50\nkvarFemtio = kvarHundra Mod 50\n\ntjugo20 = kvarFemtio / 20\nkvarTjugo = kvarFemtio Mod 20\n\ntio10 = kvarTjugo / 10\nkvarTio = kvarTjugo Mod 10\n\nfem5 = kvarTio / 5\nkvarFem = kvarTio Mod 5\n\nett1 = kvarFem / 1\n\nMsgBox (\"Your change is: \" &amp; exchange &amp; vbNewLine &amp; \"100: \" &amp; hundra100 &amp; vbNewLine &amp; \"50: \" &amp; femtio50 &amp; vbNewLine _\n&amp; \"20: \" &amp; tjugo20 &amp; vbNewLine &amp; \"10: \" &amp; tio10 &amp; vbNewLine &amp; \"5: \" &amp; fem5 &amp; vbNewLine &amp; \"1: \" &amp; ett1)\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "is_accepted": false, "score": 1, "last_activity_date": 1509488914, "creation_date": 1509488914, "answer_id": 47045427, "question_id": 44014639, "link": "https://stackoverflow.com/questions/44014639/protect-word-document-using-vba/47045427#47045427", "title": "Protect Word Document using VBA", "body": "<p>Using VBA, I believe you'd be looking for the <code>protect</code> method:</p>\n\n<pre><code>Application.ActiveDocument.Protect wdAllowOnlyRevisions, password:=\"password\"\n</code></pre>\n\n<p>With <code>protect</code>, you can specify the type of protection, the password, and various components of the protection (style lock, resetting of form fields, etc.).\nMore on <code>protect</code> can be found <a href=\"https://msdn.microsoft.com/en-us/library/office/aa220366(v=office.11).aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Likewise, VBA has a similar method for unprotecting a Word document, if you know the password. This is the aptly named <code>unprotect</code> method.</p>\n\n<pre><code>Application.ActiveDocument.Unprotect \"password\"\n</code></pre>\n\n<p>More on <code>unprotect</code> can be found <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221210(v=office.11).aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8022888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77a0b3bc2af792c9fb3114b19d9a2dd1?s=128&d=identicon&r=PG&f=1", "display_name": "Abigail", "link": "https://stackoverflow.com/users/8022888/abigail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6478, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509488914, "creation_date": 1494989062, "last_edit_date": 1495003781, "question_id": 44014639, "link": "https://stackoverflow.com/questions/44014639/protect-word-document-using-vba", "title": "Protect Word Document using VBA", "body": "<p>I would like to use vba to protect my word document. </p>\n\n<p>Indeed, it is possible but I've searched on how to unprotect the document through this link :<br>\n<em><a href=\"http://www.aurelp.com/2015/04/01/how-to-unlock-a-microsoft-word-document-step-by-stepsolved/\" rel=\"nofollow noreferrer\">http://www.aurelp.com/2015/04/01/how-to-unlock-a-microsoft-word-document-step-by-stepsolved/</a></em> </p>\n\n<p>Is there any other way on how to successfully protect the document from unauthorized user?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494984318, "post_id": 44013989, "comment_id": 75055953, "body": "Get rid of the <code>On Error Resume Next</code> just before <code>For Each sht In objExcel.ActiveWorkbook.Worksheets</code> and see what errors occur."}, {"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494984711, "post_id": 44013989, "comment_id": 75056025, "body": "@YowE3K - have removed and re-run. Still no error is being thrown."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494984920, "post_id": 44013989, "comment_id": 75056071, "body": "Step through the macro with <code>F8</code>. When it gets to <code>exWb.Save</code>, what happens? Also, you can specify the directory to save it in like <code>exWb.SaveAs &quot;C:\\WorkbookName.xls&quot;</code>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1494985080, "post_id": 44013989, "comment_id": 75056110, "body": "add <code>exWb.SaveAs Filename:=FilePath</code> Next to <code>exWb.Sheets(&quot;Sheet1Old&quot;).Delete</code>"}, {"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494985096, "post_id": 44013989, "comment_id": 75056117, "body": "@BruceWayne - stepping through it sits for a sec or two then goes to the next line. Ill try specifying the filepath and see if that works."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1494985103, "post_id": 44013989, "comment_id": 75056118, "body": "Unrelated, but how do you <i>know</i> <code>TASKKILL &#47;F &#47;IM Excel.exe</code> is going to kill the right Excel.exe instance? What&#39;s wrong with <code>objExcel.Quit</code>?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494985187, "post_id": 44013989, "comment_id": 75056136, "body": "It may be saving it in your temporary folder. Have you checked that? It sounds like it&#39;s saving <i>somewhere</i>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494985191, "post_id": 44013989, "comment_id": 75056137, "body": "Perhaps put a <code>MsgBox &quot;File saved as &quot; &amp; exWb.FullName</code> just after the <code>Save</code>, so that you can check whether it actually saved the file and, if so, where."}, {"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1494985237, "post_id": 44013989, "comment_id": 75056147, "body": "@0m3r - your comment worked. add it as the answer and claim your brownie points! :D"}, {"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1494985282, "post_id": 44013989, "comment_id": 75056158, "body": "@Mat&#39;sMug - umm, not really sure, but it worked so i didnt question it. happy to receive advice for improvements (in the correct forum of course! :P)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494985563, "post_id": 44013989, "comment_id": 75056235, "body": "What is <code>objExcel</code> assigned to? Is it a visible instance?"}, {"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494985661, "post_id": 44013989, "comment_id": 75056254, "body": "@Mat&#39;sMug - its just declared as <code>Dim objExcel As New Excel.Application</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1494985489, "creation_date": 1494985489, "answer_id": 44014163, "question_id": 44013989, "link": "https://stackoverflow.com/questions/44013989/new-excel-workbook-created-by-outlook-macro-not-being-saved-in-directory/44014163#44014163", "title": "New Excel Workbook created by Outlook macro not being saved in directory", "body": "<p><em>You need to add <strong><code>exWb.SaveAs Filename:=FilePath</code></strong> Next to <strong><code>exWb.Sheets(\"Sheet1Old\").Delete</code></em></strong></p>\n\n<p><em>Example</em></p>\n\n<pre><code>    Set exWb = objExcel.Workbooks.Add(1)\n    exWb.Sheets(\"Sheet1\").Name = \"Sheet1Old\"\n    exWb.Sheets.Add().Name = \"Sheet1\"\n    exWb.Sheets(\"Sheet1Old\").Delete\n    exWb.SaveAs FileName:=FilePath\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "edited": false, "score": 1, "creation_date": 1494986826, "post_id": 44014287, "comment_id": 75056563, "body": "You are exactly right! Thank you so much for the detailed explanation of my ineptitude! XD certainly worth more than one upvote!!!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1494986394, "last_edit_date": 1495541895, "creation_date": 1494986394, "answer_id": 44014287, "question_id": 44013989, "link": "https://stackoverflow.com/questions/44013989/new-excel-workbook-created-by-outlook-macro-not-being-saved-in-directory/44014287#44014287", "title": "New Excel Workbook created by Outlook macro not being saved in directory", "body": "<p>You're saving the workbook here:</p>\n\n<blockquote>\n<pre><code>exWb.Save\n</code></pre>\n</blockquote>\n\n<p>If the workbook was created here:</p>\n\n<blockquote>\n<pre><code>If TestStr = \"\" Then\n    Set exWb = objExcel.Workbooks.Add(1)\n</code></pre>\n</blockquote>\n\n<p>Then you're not specifying the workbook's filename, so if it's <code>Book1</code> then you quite likely have a new <code>Book1.xlsx</code> file in your <em>My Documents</em> folder.</p>\n\n<p>And if there's already a <code>Book1.xlsx</code> file, the <code>objExcel</code> instance pops an alert:</p>\n\n<p><img src=\"https://i.stack.imgur.com/UkjoF.png\" alt=\"A file named &#39;Book1.xlsx&#39; already exists in this location. Do you want to replace it? | Yes | No | Cancel |\"></p>\n\n<p><s>I need to make an assumption here, but my theory is that</s><sup>1</sup> <code>objExcel</code> is an Excel application instance that was created to \"run in the background\", it's not visible. But even if the app isn't visible, <em>normally</em> you'd get that alert box. Except you explicitly disabled it:</p>\n\n<blockquote>\n<pre><code>objExcel.DisplayAlerts = False\n</code></pre>\n</blockquote>\n\n<p>With alerts disabled, <code>Save</code> will just overwrite an existing file.</p>\n\n<p>So you get no errors, but the file isn't in the folder you expected it in nor with the filename you'd save it with, but it <em>is</em> created.</p>\n\n<p>If you want to <em>save a file under a specified path/filename</em>, you use the <code>SaveAs</code> method instead of <code>Save</code> - <a href=\"https://stackoverflow.com/a/44014163/1188513\">but that's no news</a>.</p>\n\n<hr>\n\n<p><sub><sup>1</sup> <a href=\"https://stackoverflow.com/questions/44013989/new-excel-workbook-created-in-outlook-not-being-saved-in-directory#comment75056254_44013989\">its just declared as Dim objExcel As New Excel.Application. \u2013 scb998 2 mins ago</a></sub></p>\n"}], "owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 44014163, "answer_count": 2, "score": 2, "last_activity_date": 1592871096, "creation_date": 1494984050, "last_edit_date": 1592871096, "question_id": 44013989, "link": "https://stackoverflow.com/questions/44013989/new-excel-workbook-created-by-outlook-macro-not-being-saved-in-directory", "title": "New Excel Workbook created by Outlook macro not being saved in directory", "body": "<p>I have an Outlook macro which works to export the users <code>Tasklist</code> to an Excel spreadsheet stored on a network drive.</p>\n\n<p>I am attempting to check if there is a workbook already present in the directory (<a href=\"https://www.exceltip.com/files-workbook-and-worksheets-in-vba/determine-if-a-workbook-exists-using-vba-in-microsoft-excel.html\" rel=\"nofollow noreferrer\">If statement taken form here</a>). </p>\n\n<p>If there isn't one, then make a new workbook with one worksheet called \"Sheet 1\", and if there is already one with the correct username, then open it (<a href=\"https://www.mrexcel.com/forum/excel-questions/449996-workbooks-add-only-1-sheet-visual-basic-applications.html\" rel=\"nofollow noreferrer\">add statement taken from here</a>):</p>\n\n<p>Thanks to <a href=\"https://stackoverflow.com/questions/44013639/runtime-error-when-attempting-to-delete-a-worksheet-from-a-newly-created-workboo\">SO</a>, I have propery fixed the naming error I was having, but now the newly created worbook is not being saved in the directory folder. There are no errors being thrown, and the msg box at the end of the macro is being displayed correctly, so I am at a loss as to why the file isn't showing up in File Explorer.</p>\n\n<p>Here is my entire program:</p>\n\n<pre><code>Sub Task_Grab_V2()\n  Dim sKillExcel As String\n  Dim strReport As String\n  Dim olnameSpace As Outlook.NameSpace\n  Dim taskFolder As Outlook.MAPIFolder\n  Dim tasks As Outlook.Items\n  Dim tsk As Outlook.TaskItem\n  Dim objExcel As New Excel.Application\n  Dim exWb As Excel.Workbook\n  Dim sht As Excel.Worksheet\n  Dim NAME_s As String\n  Dim Range As Excel.Range\n  Dim str As String, strClean As String\n  Dim z As Integer\n  Dim strMyName As String\n  Dim x As Integer\n  Dim y As Integer\n  Dim stat_string As String\nDim r As Range, s As String, iloc As Long\nDim s1 As String, cell As Range, col As Long\nDim sChar As String\nDim strUserName As String\n\n objExcel.DisplayAlerts = False\n 'Use the Application Object to get the Username\n NAME_s = Environ(\"USERNAME\")\n\n Dim FilePath As String\n    Dim TestStr As String\n\n    FilePath = \"some\\directory\" &amp; NAME_s &amp; \".xlsx\"\n\n    TestStr = \"\"\n    On Error Resume Next\n    TestStr = Dir(FilePath)\n    On Error GoTo 0\n    If TestStr = \"\" Then\n        Set exWb = objExcel.Workbooks.Add(1)\n        exWb.Sheets(\"Sheet1\").Name = \"Sheet1Old\"\n        exWb.Sheets.Add().Name = \"Sheet1\"\n        exWb.Sheets(\"Sheet1Old\").Delete\n    Else\n        Set exWb = objExcel.Workbooks.Open(\"some\\directory\" &amp; NAME_s &amp; \".xlsx\")\n          exWb.Sheets.Add().Name = \"Sheet1\"\n          exWb.Sheets(\"Sheet1_old\").Delete\n    End If\n\n\n\n\n  Set olnameSpace = Application.GetNamespace(\"MAPI\")\n  Set taskFolder = olnameSpace.GetDefaultFolder(olFolderTasks)\n\n  Set tasks = taskFolder.Items\n\n  strReport = \"\"\n\n  'Create Header\n  exWb.Sheets(\"Sheet1\").Cells(1, 1) = \"Subject\"\n  exWb.Sheets(\"Sheet1\").Cells(1, 2) = \"Category\"\n  exWb.Sheets(\"Sheet1\").Cells(1, 3) = \"Due Date\"\n  exWb.Sheets(\"Sheet1\").Cells(1, 4) = \"Percent Complete\"\n  exWb.Sheets(\"Sheet1\").Cells(1, 5) = \"Status\"\n  exWb.Sheets(\"Sheet1\").Cells(1, 6) = \"Notes\"\n\n\n  y = 2\n\n  For x = 1 To tasks.Count\n\n       Set tsk = tasks.Item(x)\n\n       'strReport = strReport + tsk.Subject + \"; \"\n\n       'Fill in Data\n       If Not tsk.Complete Then\n\n            If tsk.Status = olTaskDeferred Then\n                stat_string = \"Deferred\"\n            End If\n            If tsk.Status = olTaskInProgress Then\n                stat_string = \"In Progress\"\n            End If\n            If tsk.Status = olTaskNotStarted Then\n                stat_string = \"Not Started\"\n            End If\n            If tsk.Status = olTaskWaiting Then\n                stat_string = \"Waiting on Someone Else\"\n            End If\n\n\n\n\n        exWb.Sheets(\"Sheet1\").Cells(y, 1) = tsk.Subject\n        exWb.Sheets(\"Sheet1\").Cells(y, 2) = tsk.Categories\n        exWb.Sheets(\"Sheet1\").Cells(y, 3) = tsk.DueDate\n        exWb.Sheets(\"Sheet1\").Cells(y, 4) = tsk.PercentComplete\n        exWb.Sheets(\"Sheet1\").Cells(y, 5) = stat_string\n        exWb.Sheets(\"Sheet1\").Cells(y, 6) = tsk.Body\n\n   'the following section searches the body of the task for a specified character and deletes everything after it\n        col = 6   ' assumes column 6, change to your column\nsChar = \"#\" ' assume character to look for is hash, change to yours\nWith objExcel.ActiveSheet\n  Set r = .Range(.Cells(2, col), .Cells(.Rows.Count, col).End(xlUp))\nEnd With\nFor Each cell In r\n s = cell.Text\n If Len(Trim(s)) &gt; 0 Then\n   iloc = InStr(1, s, sChar, vbTextCompare)\n   If iloc &gt; 1 Then\n     s1 = Left(s, iloc - 1)\n     cell.Value = s1\n   Else\n     If iloc &lt;&gt; 0 Then\n      cell.ClearContents\n     End If\n   End If\n End If\nNext cell\n        y = y + 1\n        stat_string = \"\"\n       End If\n\n  Next x\n\n\n'Autofit all column widths\nOn Error Resume Next\nFor Each sht In objExcel.ActiveWorkbook.Worksheets\n    sht.Columns(\"A\").EntireColumn.AutoFit\n    sht.Columns(\"B\").EntireColumn.AutoFit\n    sht.Columns(\"C\").EntireColumn.AutoFit\n    sht.Columns(\"D\").EntireColumn.AutoFit\n    sht.Columns(\"E\").EntireColumn.AutoFit\n    sht.Columns(\"F\").EntireColumn.AutoFit\nNext sht\n\nexWb.Save\n\nexWb.Close\n\nSet exWb = Nothing\n'this kills the excel program from the task manager so the code will not double up on opening the application\nsKillExcel = \"TASKKILL /F /IM Excel.exe\"\nShell sKillExcel, vbHide\n\nMsgBox (\"Tasks have been sucessfully exported.\")\n\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone see why the above code would not be saving the file created?</p>\n"}, {"tags": ["excel", "vb6", "office365", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1494983961, "post_id": 44013881, "comment_id": 75055892, "body": "If you are using Excel, this sounds like VBA - not VB6.  Please update the question to include as much of the code as is necessary to replicate the problem.  (Probably just the declaration of the object, and the <code>Set</code> statement, but maybe more if the problem doesn&#39;t exist when running just those two lines.)"}, {"owner": {"reputation": 14759, "user_id": 123723, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0af39d29746ae4e1aac45fd517269f58?s=128&d=identicon&r=PG", "display_name": "C-Pound Guru", "link": "https://stackoverflow.com/users/123723/c-pound-guru"}, "edited": false, "score": 0, "creation_date": 1495038991, "post_id": 44013881, "comment_id": 75087300, "body": "Error -1234567: Crystal ball not found. Perhaps it might be useful to add the actual code that shows which object you are trying to create? Hit the <a href=\"https://stackoverflow.com/posts/44013881/edit\">Edit</a> link to provide more info."}], "answers": [{"tags": [], "owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "is_accepted": false, "score": 0, "last_activity_date": 1495043373, "creation_date": 1495043373, "answer_id": 44031710, "question_id": 44013881, "link": "https://stackoverflow.com/questions/44013881/vb6-error-2147418113-automation-error-catastrophic-failure/44031710#44031710", "title": "VB6: Error -2147418113: Automation error Catastrophic failure", "body": "<p>If you re-read your question, you've already answered it yourself.  It only works if the Excel application is already open.  You are probably trying to create/open a workbook or spreadsheet.  Instead of assuming that Excel is open, you would probably have to open Office 2016 itself as an object (I don't know what that code would be off the top of my head) and then you could create an Excel application from -that- object.</p>\n"}], "owner": {"reputation": 11, "user_id": 7628318, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KZnCXeKUCgY/AAAAAAAAAAI/AAAAAAAAEyk/gcbXptHJRJM/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/7628318/lexi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1223, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495043373, "creation_date": 1494983131, "last_edit_date": 1531164843, "question_id": 44013881, "link": "https://stackoverflow.com/questions/44013881/vb6-error-2147418113-automation-error-catastrophic-failure", "title": "VB6: Error -2147418113: Automation error Catastrophic failure", "body": "<p>I am using the <code>CreateObject()</code> in VB6 and I am getting an Automation Error whenever the code reaches the <code>CreateObject()</code> part. The error is not present when I open the application that I put on the <code>CreateObject()</code>. Any ideas? I am using Excel 2016. </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1241, "user_id": 2876977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ud3MR.gif?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/2876977/kris"}, "edited": false, "score": 1, "creation_date": 1494987777, "post_id": 44013707, "comment_id": 75056787, "body": "You could use subforms.  So you&#39;d have a Parent form and 2x subforms.  Or a Parent form and 3x subforms."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1495004120, "post_id": 44013707, "comment_id": 75062444, "body": "That image shows a form with 2 subforms. The subforms are set for Datasheet view. The splitter bar demonstrated is a custom control that site is selling."}], "owner": {"reputation": 91, "user_id": 7639324, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0da29765b29dd7abfd24175af9ecb524?s=128&d=identicon&r=PG&f=1", "display_name": "jp-tech", "link": "https://stackoverflow.com/users/7639324/jp-tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594639936, "creation_date": 1494981521, "last_edit_date": 1594639936, "question_id": 44013707, "link": "https://stackoverflow.com/questions/44013707/ms-access-3-sections-in-a-form", "title": "MS ACCESS 3 sections in a form", "body": "<p>How to create a split form like <a href=\"https://www.google.com/url?sa=i&amp;rct=j&amp;q=&amp;esrc=s&amp;source=images&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwjvibip1_XTAhULHJQKHZspD8kQjRwIBw&amp;url=http%3A%2F%2Fwww.fmsinc.com%2Fmicrosoftaccess%2Fcontrols%2Fcomponents%2Fsplliter-bar%2Findex.html&amp;psig=AFQjCNHIxTSZASH3z6joJpoEwVXJpMtvBQ&amp;ust=1495067684569656\" rel=\"nofollow noreferrer\">this</a> which has 3 sections (2 tables and 1 form sections?</p>\n\n<p>I can only do the form section and a table below. how to add one more table?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1494982155, "post_id": 44013639, "comment_id": 75055540, "body": "You can&#39;t delete the only sheet from the workbook - Excel doesn&#39;t &quot;know&quot; you&#39;re going to add one back...  Start by renaming &quot;Sheet1&quot; to &quot;Sheet1_old&quot;, then add the new sheet, then delete  &quot;Sheet1_old&quot;"}, {"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494982837, "post_id": 44013639, "comment_id": 75055668, "body": "@TimWilliams - Thanks for that, but how would i then modify the above code to rename the sheet? I have updated the code above to show where I have put the name change, but it is showing up  a 438 error - Object doesn&#39;t support this property"}], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "edited": false, "score": 0, "creation_date": 1494983629, "post_id": 44013905, "comment_id": 75055816, "body": "Thanks Tim - have another issue with this particular macro which ill post in a moment - Standby! :P"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1494983330, "creation_date": 1494983330, "answer_id": 44013905, "question_id": 44013639, "link": "https://stackoverflow.com/questions/44013639/runtime-error-when-attempting-to-delete-a-worksheet-from-a-newly-created-workboo/44013905#44013905", "title": "Runtime error when attempting to delete a worksheet from a newly created workbook - Outlook VBA", "body": "<p>Like this:</p>\n\n<pre><code>exWb.Sheets(\"Sheet1\").Name = \"Sheet1Old\"\nexWb.Sheets.Add().Name = \"Sheet1\"\nexWb.Sheets(\"Sheet1Old\").Delete\n</code></pre>\n"}], "owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 44013905, "answer_count": 1, "score": 1, "last_activity_date": 1592871131, "creation_date": 1494981011, "last_edit_date": 1592871131, "question_id": 44013639, "link": "https://stackoverflow.com/questions/44013639/runtime-error-when-attempting-to-delete-a-worksheet-from-a-newly-created-workboo", "title": "Runtime error when attempting to delete a worksheet from a newly created workbook - Outlook VBA", "body": "<p>I have an Outlook macro which works to export the users <code>Tasklist</code> to an Excel spreadsheet stored on a network drive.</p>\n\n<p>I am attempting to check if there is a workbook already present in the directory (<a href=\"https://www.exceltip.com/files-workbook-and-worksheets-in-vba/determine-if-a-workbook-exists-using-vba-in-microsoft-excel.html\" rel=\"nofollow noreferrer\">If statement taken form here</a>). </p>\n\n<p>If there isn't one, then make a new workbook with one worksheet called \"Sheet 1\", and if there is already one with the correct username, then open it (<a href=\"https://www.mrexcel.com/forum/excel-questions/449996-workbooks-add-only-1-sheet-visual-basic-applications.html\" rel=\"nofollow noreferrer\">add statement taken from here</a>):</p>\n\n<pre><code>Dim FilePath As String\nDim TestStr As String\nDim objExcel As New Excel.Application\nDim exWb As Excel.Workbook\nDim NAME_s As String\n\nobjExcel.DisplayAlerts = False\n 'Use the Application Object to get the Username\n NAME_s = Environ(\"USERNAME\")\n\n\n\n    FilePath = \"the\\directory\\\" &amp; NAME_s &amp; \".xlsx\"\n\n    TestStr = \"\"\n    On Error Resume Next\n    TestStr = Dir(FilePath)\n    On Error GoTo 0\n    If TestStr = \"\" Then\n    Set exWb = objExcel.Workbooks.Add(1)\n    exWb.Worksheets(1).Name = \"Sheet1_old\"\n\nElse\n    Set exWb = objExcel.Workbooks.Open(\"J:\\Efficiency Measures\\PTaR\\\" &amp; NAME_s &amp; \".xlsx\")\nEnd If\n\nexWb.Sheets.Add().Name = \"Sheet1\"\nexWb.Sheets(\"Sheet1_old\").Delete\n</code></pre>\n\n<p>When I step through the If statement, the TestStr value is firing the first condition, which is correct, but then the <code>exWb.Sheets(\"Sheet1\").Delete</code> line is triggering a runtime error (Workbook must contain at least one visible sheet). But I thought that having the <code>objExcel.Workbooks.Add(1)</code> would add a new workbook to the directory specified with one worksheet called \"Sheet 1\".</p>\n\n<p>How do I modify the above code to ensure the new workbook generated has the \"Sheet 1\" name, and is saved in the nework location specified in the <code>FilePath</code> variable?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8022460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0736eb83805319fc3609264d1036d9bf?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaK", "link": "https://stackoverflow.com/users/8022460/anujak"}, "edited": false, "score": 0, "creation_date": 1494989223, "post_id": 44013634, "comment_id": 75057133, "body": "Thank you for your answer! While this solves my issue, the code seems a bit hardcoded meaning if I wanted to add more columns, it doesn&#39;t work."}], "tags": [], "owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "is_accepted": false, "score": 1, "last_activity_date": 1494980972, "creation_date": 1494980972, "answer_id": 44013634, "question_id": 44013445, "link": "https://stackoverflow.com/questions/44013445/how-to-check-if-cell-value-is-greater-than-x-get-the-difference-from-those-2-va/44013634#44013634", "title": "How to check if cell value is greater than X, get the difference from those 2 values and add to the next cell in Excel?", "body": "<p>Your best bet is to use Visual Basic. Insert the following code into your sheet and run it. It will do what you are looking for.</p>\n\n<pre><code>Sub Test()\n    Dim lngLastRow As Long\n    Dim lngLoopCtr As Long\n    Dim value_1 As Long\n    Dim value_2 As Long\n    lngLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For lngLoopCtr = 2 To lngLastRow Step 1\n        value_1 = Range(\"B\" &amp; lngLoopCtr)\n        value_2 = Range(\"B\" &amp; lngLoopCtr + 1)\n        If value_1 &gt; 27 Then\n            Range(\"B\" &amp; lngLoopCtr + 1) = value_2 + (value_1 - 27)\n            Range(\"B\" &amp; lngLoopCtr) = 27\n        End If\n    Next lngLoopCtr\n\n    For lngLoopCtr = 2 To lngLastRow Step 1\n        value_1 = Range(\"C\" &amp; lngLoopCtr).Value\n        value_2 = Range(\"C\" &amp; lngLoopCtr + 1).Value\n        If value_1 &gt; 27 Then\n            Range(\"C\" &amp; lngLoopCtr + 1) = value_2 + (value_1 - 27)\n            Range(\"C\" &amp; lngLoopCtr) = 27\n        End If\n    Next lngLoopCtr\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8022460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0736eb83805319fc3609264d1036d9bf?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaK", "link": "https://stackoverflow.com/users/8022460/anujak"}, "edited": false, "score": 0, "creation_date": 1494986543, "post_id": 44013928, "comment_id": 75056504, "body": "Your answer is also correct but wanted to be fair so accepted the first answer because that person answered first. Appreciate your help!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 8022460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0736eb83805319fc3609264d1036d9bf?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaK", "link": "https://stackoverflow.com/users/8022460/anujak"}, "edited": false, "score": 0, "creation_date": 1494987103, "post_id": 44013928, "comment_id": 75056621, "body": "@AnujaK - No worries about where the &quot;tick&quot; goes, but be aware that Darkisa&#39;s answer doesn&#39;t carry forward from the bottom of the first column to the top of the second column.  (That, and the limitation to two columns, was why I posted an answer after they did.)"}, {"owner": {"reputation": 13, "user_id": 8022460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0736eb83805319fc3609264d1036d9bf?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaK", "link": "https://stackoverflow.com/users/8022460/anujak"}, "edited": false, "score": 0, "creation_date": 1494989158, "post_id": 44013928, "comment_id": 75057113, "body": "@YowE3k- Yes, you are right, just realized that and that is what I wanted. Thank you. Quick question, what if I wanted to ignore 2 columns instead of just 1?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 8022460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0736eb83805319fc3609264d1036d9bf?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaK", "link": "https://stackoverflow.com/users/8022460/anujak"}, "edited": false, "score": 0, "creation_date": 1494991694, "post_id": 44013928, "comment_id": 75057719, "body": "@AnujaK - if you mean you have &quot;headings&quot; (or whatever) in columns A and B, and data starts in column C, then change <code>For c = 2 To lastCol</code> to <code>For c = 3 To lastCol</code>.  (And check whether <code>lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row</code> is still appropriate - that is finding the last used cell in column 1, so change the 1 to 2 if it is more appropriate to use column B to find the row containing the last used cell.)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1494983570, "creation_date": 1494983570, "answer_id": 44013928, "question_id": 44013445, "link": "https://stackoverflow.com/questions/44013445/how-to-check-if-cell-value-is-greater-than-x-get-the-difference-from-those-2-va/44013928#44013928", "title": "How to check if cell value is greater than X, get the difference from those 2 values and add to the next cell in Excel?", "body": "<p>Using VBA, with a \"carry forward\" variable to keep track of how much is able to be allocated to the next cell:</p>\n\n<pre><code>Sub runMe()\n    Dim lastCol As Long\n    Dim lastRow As Long\n    Dim c As Long\n    Dim r As Long\n    Dim cf As Double\n    With ActiveSheet\n        'assumes headings in row 1, and column 1\n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n        For c = 2 To lastCol\n            For r = 2 To lastRow\n                cf = cf + CDbl(.Cells(r, c).Value)\n                If cf &gt; 27 Then\n                    .Cells(r, c).Value = 27\n                    cf = cf - 27\n                Else\n                    .Cells(r, c).Value = cf\n                    cf = 0\n                End If\n            Next\n        Next\n        'place any final carry forward into a new column\n        If cf &gt; 0 Then\n            .Cells(2, lastCol + 1).Value = cf\n        Else\n            .Cells(2, lastCol + 1).ClearContents\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8022460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0736eb83805319fc3609264d1036d9bf?s=128&d=identicon&r=PG&f=1", "display_name": "AnujaK", "link": "https://stackoverflow.com/users/8022460/anujak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4035, "favorite_count": 0, "accepted_answer_id": 44013928, "answer_count": 2, "score": 1, "last_activity_date": 1494983570, "creation_date": 1494979294, "question_id": 44013445, "link": "https://stackoverflow.com/questions/44013445/how-to-check-if-cell-value-is-greater-than-x-get-the-difference-from-those-2-va", "title": "How to check if cell value is greater than X, get the difference from those 2 values and add to the next cell in Excel?", "body": "<p>I have an excel problem I really need help with! \nI want to use functions in column Day1 and Day2. \nGoal: To check each cell and make sure it doesn't exceed 27. If it does, get the difference between the cell value and 27, carry over the difference and add to the next cell. </p>\n\n<p>Example, in column Day1, it will check if 13 is greater than 27. It's not so it will leave that value as it is. Same with 14 and 26. The next value in Day1 Column is 29 which is greater than 27, so it will change that cell value to 27 and carry over the difference (29-27)=2 and add to the cell below so 31 + 2 = 33. Now 33 is greater than 27 so it will again change that value to 27 and carry over the difference (33-27) = 6 and add it to first cell in Day2 Column: 6 + 5=11.</p>\n\n<p>The process will be repeated for Day2 column as well. If the last value in Day2 column doesn't exceed 27, then leave as it is. Move to the next column and repeat that process of checking if cell value is greater than 27. </p>\n\n<p>Current:</p>\n\n<pre><code>Time    Day1 Day2\nHour0   13   5\nHour1   14   15\nHour2   26   29\nHour3   29   26\nHour4   31   4\n</code></pre>\n\n<p>Desired: </p>\n\n<pre><code>Time    Day1 Day2\nHour0   13   11\nHour1   14   15\nHour2   26   27\nHour3   27   27\nHour4   27   5\n</code></pre>\n\n<p>Now I'm not an excel expert so I tried few if statements but don't think that is the way to solve this problem. I did, <code>if(A1&gt;27, 27, A1)</code> which is checking if A1 is greater than 27, change that value to 27 else leave that value as it is. But then I also need another if statement, <code>if(A1&gt;27, A2=(A1-27) + A2, A1)</code>\nTrying to find a way to combine those 2 if statements or are there other excel functions/secrets that I can use?\nPlease any help is appreciated. \nThanks!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494980428, "post_id": 44013416, "comment_id": 75055238, "body": "Is there always a hyphen ?"}], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "is_accepted": false, "score": -1, "last_activity_date": 1494994455, "creation_date": 1494994455, "answer_id": 44015423, "question_id": 44013416, "link": "https://stackoverflow.com/questions/44013416/vba-move-character-to-next-column/44015423#44015423", "title": "VBA move character to next column", "body": "<pre><code>Option Explicit\n----------------------------------------------------\nSub moveReg()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim lastRow As Long\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Sheet1\")\nlastRow = ws.Cells(Rows.Count, \"A\").End(3).Row\n\nDim i As Long\nFor i = 1 To lastRow\n\n    Range(\"A\" &amp; i).Replace What:=\" \", Replacement:=\"\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n\n    Dim str As String, reg As String\n    str = Range(\"A\" &amp; i).Value\n    reg = \"REG\"\n\n    Dim indexOfREG As Integer\n    indexOfREG = InStr(1, str, reg, vbTextCompare)\n\n    Dim finalString As String\n    finalString = Left(str, Len(str) - indexOfREG + 1)\n\n    Dim REGString As String\n    REGString = Right(str, (Len(reg)))\n\n    Range(\"A\" &amp; i).Value = finalString\n    Range(\"B\" &amp; i).Value = REGString\n\n    i = i + 1\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6710161, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e53a5ad611c44006f7b86094af3b98da?s=128&d=identicon&r=PG&f=1", "display_name": "terny", "link": "https://stackoverflow.com/users/6710161/terny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1495019714, "creation_date": 1494979071, "last_edit_date": 1495019714, "question_id": 44013416, "link": "https://stackoverflow.com/questions/44013416/vba-move-character-to-next-column", "title": "VBA move character to next column", "body": "<p>I want to write a code that If <code>column A</code> contains <strong>REG</strong> then move it over to <code>column B</code> and remove it from <code>A</code>.</p>\n\n<p><em>For example:</em></p>\n\n<p>If, <strong><code>A1 = tsf - REG</code></strong> <em>and</em> <strong><code>B1 is empy</code></strong></p>\n\n<p>Then, as a result, I'd like to see my cells as below:</p>\n\n<p><strong><code>A1=tsf</code></strong>  <em>and</em>  <strong><code>B1=REG</code></strong></p>\n\n<p>How can I write code for this kind of purpose?</p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1494977040, "post_id": 44013099, "comment_id": 75054465, "body": "Yes, you may use <a href=\"https://regex101.com/r/eRLynR/2\" rel=\"nofollow noreferrer\"><code>-?\\d{2,3}(?!\\S)</code></a> regex. Or even <code>-?\\b\\d{2,3}\\b(?!\\S)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494977199, "post_id": 44013099, "comment_id": 75054504, "body": "Split(Trim(Split(&quot;SRK XXXX SCNO 200 3X2X&quot;, &quot;SCNO&quot;)(1)), &quot; &quot;)(0)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494977842, "post_id": 44013099, "comment_id": 75054656, "body": "formula: <code>=--(MID(A1,FIND(&quot;SCNO&quot;,A1)+4,FIND(&quot; &quot;,A1,FIND(&quot;SCNO&quot;,A1)+5)-FIND(&quot;SCNO&quot;,A1)-4))</code>"}, {"owner": {"reputation": 21, "user_id": 8022345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c88087d66e1886e8ad733be81f0296?s=128&d=identicon&r=PG&f=1", "display_name": "Agnese00", "link": "https://stackoverflow.com/users/8022345/agnese00"}, "edited": false, "score": 0, "creation_date": 1494979453, "post_id": 44013099, "comment_id": 75055008, "body": "I am new to this, if someone can write a complete macro code it would mean a lot."}, {"owner": {"reputation": 21, "user_id": 8022345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c88087d66e1886e8ad733be81f0296?s=128&d=identicon&r=PG&f=1", "display_name": "Agnese00", "link": "https://stackoverflow.com/users/8022345/agnese00"}, "edited": false, "score": 0, "creation_date": 1494980317, "post_id": 44013099, "comment_id": 75055204, "body": "Btw thank you very much for the formula! Great"}], "answers": [{"comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 21, "user_id": 8022345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c88087d66e1886e8ad733be81f0296?s=128&d=identicon&r=PG&f=1", "display_name": "Agnese00", "link": "https://stackoverflow.com/users/8022345/agnese00"}, "edited": false, "score": 0, "creation_date": 1495051202, "post_id": 44013302, "comment_id": 75094147, "body": "@Agnese00: Glad it worked for you. Please consider accepting the answer (see <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">How to accept SO answers</a>)."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 2, "last_activity_date": 1506263411, "last_edit_date": 1506263411, "creation_date": 1494978177, "answer_id": 44013302, "question_id": 44013099, "link": "https://stackoverflow.com/questions/44013099/how-do-i-extract-specific-string-from-cell-in-excel/44013302#44013302", "title": "how do i extract specific string from cell in excel?", "body": "<p>If you cannot rely on any static elements, and <code>SCNO</code> is just arbitrary text, and all you know is that the number you need is just a standalone 2 or 3 digit sequence with an optional <code>-</code> in front, you may use the following regex:</p>\n\n<pre><code>-?\\b\\d{2,3}\\b(?!\\S)\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/eRLynR/3/\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p><strong>Details</strong>:</p>\n\n<ul>\n<li><code>-?</code> - an optional <code>-</code></li>\n<li><code>\\b</code> - word boundary</li>\n<li><code>\\d{2,3}</code> - 2 to 3 digits</li>\n<li><code>\\b</code> - a word boundary</li>\n<li><code>(?!\\S)</code> - a negative lookahead making sure there must be a whitespace or end of string immediately to the right of the current location.</li>\n</ul>\n\n<p>See the sample VBA demo:</p>\n\n<pre><code>Sub ExtractSomeMatches()\nDim rx As RegExp\nDim m As MatchCollection\nDim n As Match\nDim s As String\n\ns = \"SRK XXXX SCNO-200 3X2X \" &amp; vbCrLf &amp; \"SRK XXXX SCNO 200 20X20X\" &amp; vbCrLf &amp; \"SRK XXXX SCNO-25 20X2X\" &amp; vbCrLf &amp; \"KOS YYYY SCNO 25 20X2X\"\n\nSet rx = New RegExp\nWith rx\n   .Global = True\n   .Pattern = \"-?\\b\\d{2,3}\\b(?!\\S)\"\nEnd With\n\n\nSet m = rx.Execute(s)\nIf m.Count &gt; 0 Then\n  For Each n In m\n    Debug.Print n.Value\n  Next\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/BDMzF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BDMzF.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 8022345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c88087d66e1886e8ad733be81f0296?s=128&d=identicon&r=PG&f=1", "display_name": "Agnese00", "link": "https://stackoverflow.com/users/8022345/agnese00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1506263411, "creation_date": 1494976604, "last_edit_date": 1531164843, "question_id": 44013099, "link": "https://stackoverflow.com/questions/44013099/how-do-i-extract-specific-string-from-cell-in-excel", "title": "how do i extract specific string from cell in excel?", "body": "<p>I have lots of data which contains numbers (from 2 to 3 digits) that I wish to extract from cells with pretty inconsistent format, here is the example:</p>\n\n<pre><code>SRK XXXX SCNO-200 3X2X\nSRK XXXX SCNO 200 20X20X\nSRK XXXX SCNO-25 20X2X\nKOS YYYY SCNO 25 20X2X\n</code></pre>\n\n<p>So I only need <code>-200</code>, <code>200</code>, <code>-25</code>, <code>25</code> etc. and I have to place them into a separate column.</p>\n\n<p>If someone knows how to help.</p>\n\n<p>I tested following string and thought it might be used for regex macro.</p>\n\n<pre><code>\\s|\\-|\\d{1,3}\\s\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494976516, "post_id": 44013032, "comment_id": 75054328, "body": "It&#39;s very, very, very rare to find code pre-written that will do exactly what you want.  You almost always have to write something that suits your specific requirements.  Which bit of writing the code are you stuck on?"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1494977907, "post_id": 44013032, "comment_id": 75054672, "body": "Power Query may be a useful tool for Data Cleaning.It&#39;s a free add-on before Excel 2016, but is standard in 2016"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494980603, "post_id": 44013032, "comment_id": 75055280, "body": "You can use <code>Split(valueHere, vbLf)</code> on the Col H/J values, then loop over the resulting arrays and repeat the values from the other columns."}, {"owner": {"reputation": 13, "user_id": 8022338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d3a433bd25233fdb6e9459cf252839?s=128&d=identicon&r=PG&f=1", "display_name": "Diffused", "link": "https://stackoverflow.com/users/8022338/diffused"}, "edited": false, "score": 0, "creation_date": 1495121249, "post_id": 44013032, "comment_id": 75129218, "body": "Thank you all for your responses."}, {"owner": {"reputation": 13, "user_id": 8022338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d3a433bd25233fdb6e9459cf252839?s=128&d=identicon&r=PG&f=1", "display_name": "Diffused", "link": "https://stackoverflow.com/users/8022338/diffused"}, "edited": false, "score": 0, "creation_date": 1495126477, "post_id": 44013032, "comment_id": 75132401, "body": "Tim Williams, I have iterated through a few Macros using the split function, however never achieved exactly what I was looking for.  YowE3K, maybe a more clear statement would have been that I couldn&#39;t find any examples to help me learn how to write the code that would process my data as required.  As Tim suggested, I attempted the use of the Split function, however I also ran into several examples that using different methods. To answer your question, I am stuck on inexperience and appreciate all input!"}], "answers": [{"tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": true, "score": 0, "last_activity_date": 1494991908, "creation_date": 1494991908, "answer_id": 44015056, "question_id": 44013032, "link": "https://stackoverflow.com/questions/44013032/excel-vba-data-organization-with-splitting-and-duplication/44015056#44015056", "title": "Excel VBA Data organization with splitting and duplication", "body": "<p>This will process the data into the format you're after.  The source data is in Sheet1 and the reformatted data is placed into Sheet2:</p>\n\n<pre><code>Option Explicit\n\nSub MapCell2Cells()\n  Dim sht1 As Worksheet, sht2 As Worksheet\n  Set sht1 = Worksheets(\"Sheet1\")\n  Set sht2 = Worksheets(\"Sheet2\")\n\n  Dim strG As String, strL As String\n  Dim arrH() As String, arrI() As String, arrJ() As String\n\n  Dim i As Integer, j As Integer, idx As Integer, lastRow As Integer\n  lastRow = sht1.Cells(Rows.Count, \"G\").End(xlUp).Row\n\n  idx = 1\n  For i = 1 To lastRow:\n\n    With sht1\n      strG = Replace(.Cells(i, \"G\").Value, vbLf, \"\")\n      arrH = Split(.Cells(i, \"H\").Value, vbLf)\n      arrI = Split(.Cells(i, \"I\").Value, vbLf)\n      arrJ = Split(.Cells(i, \"J\").Value, vbLf)\n      strL = Replace(.Cells(i, \"L\").Value, vbLf, \"\")\n    End With\n\n    With sht2\n      For j = LBound(arrH) To UBound(arrH)\n        .Cells(idx, \"G\").Value = strG\n        .Cells(idx, \"H\").Value = arrH(j)\n        .Cells(idx, \"I\").Value = arrI(j)\n        .Cells(idx, \"J\").Value = arrJ(j)\n        .Cells(idx, \"L\").Value = strL\n        idx = idx + 1\n      Next\n    End With\n\n  Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8022338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d3a433bd25233fdb6e9459cf252839?s=128&d=identicon&r=PG&f=1", "display_name": "Diffused", "link": "https://stackoverflow.com/users/8022338/diffused"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 44015056, "answer_count": 1, "score": 0, "last_activity_date": 1494991908, "creation_date": 1494976163, "last_edit_date": 1494976714, "question_id": 44013032, "link": "https://stackoverflow.com/questions/44013032/excel-vba-data-organization-with-splitting-and-duplication", "title": "Excel VBA Data organization with splitting and duplication", "body": "<p>In Microsoft Excel, I am looking to use VBA code to sort through large amounts of data that is not optimally organized</p>\n\n<p>Currently, I have data that looks like this:\n<a href=\"https://i.stack.imgur.com/A3xWS.jpg\" rel=\"nofollow noreferrer\">Poor Data Organization</a><a href=\"https://i.stack.imgur.com/A3xWS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A3xWS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>However, I would like to process the data to this:\n<a href=\"https://i.stack.imgur.com/Ci5ZF.jpg\" rel=\"nofollow noreferrer\">Correct Data Organization</a><a href=\"https://i.stack.imgur.com/Ci5ZF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ci5ZF.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have been unable to find an example for my specific situation and appreciate your time and responses.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1494973902, "post_id": 44012629, "comment_id": 75053446, "body": "VBA? VBScript? VB6? VB.NET?"}, {"owner": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 0, "creation_date": 1494974712, "post_id": 44012629, "comment_id": 75053733, "body": "What program are you using then?? Also VB.NET is about coding, not scripting. <a href=\"http://stackoverflow.com/questions/17253545/scripting-language-vs-programming-language\">There&#39;s a difference</a> ;)"}], "answers": [{"tags": [], "owner": {"reputation": 63245, "user_id": 5274, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lSmPG.jpg?s=128&g=1", "display_name": "Jonathan Allen", "link": "https://stackoverflow.com/users/5274/jonathan-allen"}, "is_accepted": false, "score": 0, "last_activity_date": 1494974016, "creation_date": 1494974016, "answer_id": 44012670, "question_id": 44012629, "link": "https://stackoverflow.com/questions/44012629/vb-scripting-without-autocomplete/44012670#44012670", "title": "VB scripting without autocomplete", "body": "<p>Try ctrl-alt-J. That brings up the Object Explorer in most flavors of VB.</p>\n\n<p>Also try right-clicking and see if there is a \"Go to Definition\" option.</p>\n"}], "owner": {"reputation": 1, "user_id": 3993704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bcac6a378d384241f557e877be19eee?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/3993704/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1495017613, "creation_date": 1494973817, "last_edit_date": 1495017613, "question_id": 44012629, "link": "https://stackoverflow.com/questions/44012629/vb-scripting-without-autocomplete", "title": "VB scripting without autocomplete", "body": "<p>I'm trying to write a short script for some data analysis (kind of software automation). - in vb \nThe program I have to use for that is so old that the autocomplete feature isnt working ... is it possible to somehow list all parameters from a disticnt method? - their reference just states 'The parameters for this algorithm are specified in the method' (which is very helpful)</p>\n\n<p>[Edit]\nIt's a built-in editor of the Bruker Daltonics automation software; which uses VBA</p>\n"}, {"tags": ["excel", "vba", "ms-project"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 4, "creation_date": 1494972774, "post_id": 44012400, "comment_id": 75053032, "body": "(a) A <code>MSProject.Application</code> object probably does not contain an <code>Application</code> method (but it might) but, more importantly ... (b) you have never set <code>PrjApp</code> to anything so it is still <code>Nothing</code>.  Try setting it to a new application, i.e. <code>Set PrjApp = New MSProject.Application</code>.  (I can&#39;t test it because I don&#39;t have Project.)"}, {"owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494972963, "post_id": 44012400, "comment_id": 75053083, "body": "What are the options in setting PrjApp? I&#39;m confused because it&#39;s an application."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494973015, "post_id": 44012400, "comment_id": 75053098, "body": "I updated my comment (probably after you read it) - try <code>Set PrjApp = New MSProject.Application</code>"}, {"owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494973207, "post_id": 44012400, "comment_id": 75053179, "body": "Thanks for the suggestion. It&#39;s still throwing the same error."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1494973393, "post_id": 44012400, "comment_id": 75053261, "body": "In that case, try <code>Set PrjApp = CreateObject(&quot;Msproject.Application&quot;)</code>.  (I assume you are inserting these lines somewhere before the <code>PrjApp.Application.FileOpenEx PrjFullName</code> line).  And I would still get rid of the <code>Application</code> from that line - it wouldn&#39;t be necessary, and it <b>might</b> generate an error - but probably not an error 91."}, {"owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494974442, "post_id": 44012400, "comment_id": 75053636, "body": "No dice :(. This is quite the challenge!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1494980991, "post_id": 44012400, "comment_id": 75055352, "body": "Both of those ways of creating the Project instance should work, and if they don&#39;t, they should throw errors.  It&#39;s difficult to imagine what&#39;s going on in your case.  It would help to update your code to a version which includes creating a Project application instance so we can try to replicate the issue using your exact code."}, {"owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "edited": false, "score": 0, "creation_date": 1494984165, "post_id": 44012400, "comment_id": 75055930, "body": "Wish I knew what you meant and how to do it."}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1495159969, "post_id": 44012400, "comment_id": 75145645, "body": "@ERKSMTY Edit your question to show your current code with the added <code>CreateObject</code> method. Otherwise, as Tim mentioned, it&#39;s hard to know what&#39;s going on."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "edited": false, "score": 0, "creation_date": 1495042768, "post_id": 44031036, "comment_id": 75089516, "body": "Thanks for the suggestion, but that isn&#39;t working. See the comments on the previous answer."}], "tags": [], "owner": {"reputation": 311, "user_id": 6845666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7121d86d37fa1c7568d6d2ce07d30b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jerred S.", "link": "https://stackoverflow.com/users/6845666/jerred-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1495040963, "creation_date": 1495040963, "answer_id": 44031036, "question_id": 44012400, "link": "https://stackoverflow.com/questions/44012400/referencing-msproject-in-excel-vba-produces-runtime-error-91-object-variable-or/44031036#44031036", "title": "Referencing MSProject in Excel VBA produces Runtime Error 91 object variable or with block variable not set", "body": "<p>When you call </p>\n\n<p>PrjApp.Application.FileOpenEx PrjFullName</p>\n\n<p>PrjApp is Nothing, which is causing the error. Prior to this call, add a line </p>\n\n<p>set PrjApp = new MSProject.Application</p>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "is_accepted": true, "score": 0, "last_activity_date": 1495211979, "creation_date": 1495211979, "answer_id": 44075039, "question_id": 44012400, "link": "https://stackoverflow.com/questions/44012400/referencing-msproject-in-excel-vba-produces-runtime-error-91-object-variable-or/44075039#44075039", "title": "Referencing MSProject in Excel VBA produces Runtime Error 91 object variable or with block variable not set", "body": "<p>So turns out the issue was I was somehow shutting down the project application before the loop command. Needed to move it after the loop command. Specifically, these lines:</p>\n\n<pre><code> PrjApp.FileClose False\n PrjApp.Quit pjDoNotSave\n Set PrjApp = Nothing\n</code></pre>\n\n<p>Thanks to everyone for your time and suggestions!</p>\n"}], "owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 44075039, "answer_count": 2, "score": 0, "last_activity_date": 1556594287, "creation_date": 1494972420, "last_edit_date": 1556594287, "question_id": 44012400, "link": "https://stackoverflow.com/questions/44012400/referencing-msproject-in-excel-vba-produces-runtime-error-91-object-variable-or", "title": "Referencing MSProject in Excel VBA produces Runtime Error 91 object variable or with block variable not set", "body": "<p>My objective is to loop through a number of MS Project documents where the file paths (e.g. L:\\Project\\Scchedule.mpp) are stored on worksheet \"Projects\" in column C (beginning in cell C2).</p>\n\n<p>This line returns runtime error 91 (object variable or with block variable not set). <code>PrjApp.Application.FileOpenEx PrjFullName</code></p>\n\n<pre><code>Sub OpenProjectCopyPasteData()\n\nDim PrjApp      As MSProject.Application\nDim aProg       As MSProject.Project\nDim PrjRange    As Range\nDim PrjFullName As String\nDim t           As Task\nDim rng         As Range\nDim rng1        As Range\nDim rng2        As Range\nDim rng3        As Range\nDim ws1         As Worksheet\nDim ws2         As Worksheet\nDim MyCell      As Range\n\nSet ws1 = Worksheets(\"Project Data\")\nSet rng1 = ws1.Range(\"A:D\")\nSet rng2 = ws1.Range(\"F:F\")\nSet ws2 = Worksheets(\"Projects\")\nSet PrjRange = ws2.Range(\"C2\")\nSet PrjRange = Range(PrjRange, PrjRange.End(xlDown))\n\n\n'Clear current contents of Project Data tab\nrng1.ClearContents\nrng2.ClearContents\n\nFor Each MyCell In PrjRange\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n'Open MS Project file\nPrjFullName = MyCell\nIf PrjFullName = \"\" Then GoTo 99\n\nPrjApp.Application.FileOpenEx PrjFullName\nSet aProg = PrjApp.ActiveProject\n\n' show all tasks\nOutlineShowAllTasks\n\n'Copy the project columns and paste into Excel\nSelectTaskColumn Column:=\"Name\"\nEditCopy\nSet ws1 = Worksheets(\"Project Data\")\nSet rng = ws1.Range(\"A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row + 1)\nrng.PasteSpecial xlPasteValues\nrng.PasteSpecial xlPasteFormats\n\nSelectTaskColumn Column:=\"Resource Names\"\nEditCopy\nSet rng = ws1.Range(\"B\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row + 1)\nrng.PasteSpecial xlPasteValues\nrng.PasteSpecial xlPasteFormats\n\nSelectTaskColumn Column:=\"Finish\"\nEditCopy\nSet rng = ws1.Range(\"F\" &amp; Cells(Rows.Count, \"F\").End(xlUp).Row + 1)\nrng.PasteSpecial xlPasteValues\nrng.PasteSpecial xlPasteFormats\n\nSelectTaskColumn Column:=\"Text1\"\nEditCopy\nSet rng = ws1.Range(\"C\" &amp; Cells(Rows.Count, \"C\").End(xlUp).Row + 1)\nrng.PasteSpecial xlPasteValues\nrng.PasteSpecial xlPasteFormats\n\nSelectTaskColumn Column:=\"Text2\"\nEditCopy\nSet rng = ws1.Range(\"D\" &amp; Cells(Rows.Count, \"D\").End(xlUp).Row + 1)\nrng.PasteSpecial xlPasteValues\nrng.PasteSpecial xlPasteFormats\n\n' reset settings of Excel and MS-Project\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nPrjApp.ScreenUpdating = True\nPrjApp.DisplayAlerts = True\n\n'PrjApp.FileClose False\nPrjApp.Quit pjDoNotSave\nSet PrjApp = Nothing\n\nNext MyCell\n\n99 Sheets(\"Projects\").Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1494972777, "post_id": 44012347, "comment_id": 75053033, "body": "Would you post your <code>VLookup</code> formula?"}, {"owner": {"reputation": 1, "user_id": 6426718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce176825f55f2ca6faa4fb4612b3aceb?s=128&d=identicon&r=PG&f=1", "display_name": "51156", "link": "https://stackoverflow.com/users/6426718/51156"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1495053047, "post_id": 44012347, "comment_id": 75095172, "body": "IFERROR(VLOOKUP(A3;Kesken!A10:C999;3;FALSE);&quot;unknown product&quot;)  It is a very basic lookup. I can see the Status with this but I can&#39;t replace it to the original cell."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6426718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce176825f55f2ca6faa4fb4612b3aceb?s=128&d=identicon&r=PG&f=1", "display_name": "51156", "link": "https://stackoverflow.com/users/6426718/51156"}, "edited": false, "score": 0, "creation_date": 1495053400, "post_id": 44013475, "comment_id": 75095354, "body": "Thank you for the suggestion. By using filters this is quite hard to get working if I understand those correctly - each product has it&#39;s unique sticker number so I would need to be able to set a filter with multiple values. Is there a way to do this easily? I can use a barcode scanner and scan those sticker numbers very easily but I don&#39;t know if I can make this list of sticker numbers to work as a filter somehow."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 1, "user_id": 6426718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce176825f55f2ca6faa4fb4612b3aceb?s=128&d=identicon&r=PG&f=1", "display_name": "51156", "link": "https://stackoverflow.com/users/6426718/51156"}, "edited": false, "score": 0, "creation_date": 1495053594, "post_id": 44013475, "comment_id": 75095442, "body": "If your data is in an Excel Table object or you have the Autofilter button enabled, then you should see the filter drop-downs in the column headers. You can select multiple items in the filter drop downs. Or, if you have a list of values in a range, you can use the Advanced Filter to filter the list in place. Look up these topics in the Help."}, {"owner": {"reputation": 1, "user_id": 6426718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce176825f55f2ca6faa4fb4612b3aceb?s=128&d=identicon&r=PG&f=1", "display_name": "51156", "link": "https://stackoverflow.com/users/6426718/51156"}, "edited": false, "score": 0, "creation_date": 1495056048, "post_id": 44013475, "comment_id": 75096599, "body": "Yes, I can see the drop-down and search by selecting sticker numbers manually there - but as I want to select multiple items, this isn&#39;t very handy. I can read those numbers to a list which should work as a criteria for filtering. Tried Advanced Filter but didn&#39;t yet succeed with it."}, {"owner": {"reputation": 1, "user_id": 6426718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce176825f55f2ca6faa4fb4612b3aceb?s=128&d=identicon&r=PG&f=1", "display_name": "51156", "link": "https://stackoverflow.com/users/6426718/51156"}, "edited": false, "score": 0, "creation_date": 1495061988, "post_id": 44013475, "comment_id": 75098735, "body": "I recorded a macro which can select the items listed: <code>Range(&quot;Table1[#All]&quot;).AdvancedFilter Action:=xlFilterInPlace, CriteriaRange _:=Range(&quot;Kesken!Criteria&quot;), Unique:=False</code> I would now like to update column 3, starting from cell C10 automatically with value of cell C1. I want to update only visible cells. Could you help me with that?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 1, "user_id": 6426718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce176825f55f2ca6faa4fb4612b3aceb?s=128&d=identicon&r=PG&f=1", "display_name": "51156", "link": "https://stackoverflow.com/users/6426718/51156"}, "edited": false, "score": 0, "creation_date": 1495062553, "post_id": 44013475, "comment_id": 75098895, "body": "Select the visible cells, type the new value in the active cell, hold down Ctrl and hit Enter."}, {"owner": {"reputation": 1, "user_id": 6426718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce176825f55f2ca6faa4fb4612b3aceb?s=128&d=identicon&r=PG&f=1", "display_name": "51156", "link": "https://stackoverflow.com/users/6426718/51156"}, "edited": false, "score": 0, "creation_date": 1495063417, "post_id": 44013475, "comment_id": 75099140, "body": "I understand that but it isn&#39;t automated. As I save the macro to run with a hotkey I would like the macro also to change the visible cells on column C."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 1, "user_id": 6426718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce176825f55f2ca6faa4fb4612b3aceb?s=128&d=identicon&r=PG&f=1", "display_name": "51156", "link": "https://stackoverflow.com/users/6426718/51156"}, "edited": false, "score": 0, "creation_date": 1495077762, "post_id": 44013475, "comment_id": 75102427, "body": "If you use code, you don&#39;t need to filter anything. The code can just loop through your data and write the new value into the rows that meet the criteria. Don&#39;t overthink this. I think by now you are asking a different question. Close this one and start a new question about the code you need."}, {"owner": {"reputation": 1, "user_id": 6426718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce176825f55f2ca6faa4fb4612b3aceb?s=128&d=identicon&r=PG&f=1", "display_name": "51156", "link": "https://stackoverflow.com/users/6426718/51156"}, "edited": false, "score": 0, "creation_date": 1495089336, "post_id": 44013475, "comment_id": 75106410, "body": "In my opinion it&#39;s the same question still, changing a columns value in specified rows. I did manage to do this with code finally however horrible the code is. Thank you for the replies."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1494979535, "creation_date": 1494979535, "answer_id": 44013475, "question_id": 44012347, "link": "https://stackoverflow.com/questions/44012347/excel-updating-a-column-searched-with-vlookup/44013475#44013475", "title": "Excel: Updating a column searched with VLOOKUP", "body": "<p>A lookup formula only looks up values. If you want to process the results that are returned then you would need VBA to loop through the results, find their respective counterpart on the source sheet and make the changes.</p>\n\n<p>An alternative could be to go to the source sheet and use filters to show only the desired rows. Then you can quickly select all visible cells, enter a new value, confirm with Ctrl-Enter to change them all at the same time. </p>\n"}], "owner": {"reputation": 1, "user_id": 6426718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce176825f55f2ca6faa4fb4612b3aceb?s=128&d=identicon&r=PG&f=1", "display_name": "51156", "link": "https://stackoverflow.com/users/6426718/51156"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 44013475, "answer_count": 1, "score": -3, "last_activity_date": 1494979535, "creation_date": 1494972153, "last_edit_date": 1531161705, "question_id": 44012347, "link": "https://stackoverflow.com/questions/44012347/excel-updating-a-column-searched-with-vlookup", "title": "Excel: Updating a column searched with VLOOKUP", "body": "<p>I have an inventory worksheet (Excel) with tens of columns (product's features) and few hundred rows (products). First few columns are Sticker number (each product has it's own Sticker number), Status, Arrival Date and so on.</p>\n\n<p>To be able to check easily the Status of multiple products at the same time, I have made another sheet using VLOOKUP. On that sheet I can give a Sticker number and it searches and shows this product's Status using a basic VLOOKUP function. By inputting more Sticker numbers I can see more Statuses. Usually these Statuses vary quite a lot.</p>\n\n<p>Problem comes when I want to change all these listed Statuses to a new certain Status, which I could enter f.e. to cell B2. I mean updating the Status only for the products I have listed on this VLOOKUP sheet. How can I do this?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1494986958, "post_id": 44012212, "comment_id": 75056590, "body": "Form_Load only runs once when the form is first loaded.  Your description implies that the main_user form is <b>already loaded</b>, then while it is loaded a record is added on another form and you want the already-loaded main_user to refresh, correct?  In that case, Form_Load will not run again."}, {"owner": {"reputation": 1, "user_id": 8021199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba633b5773f03b01f4e931faae4a2ac?s=128&d=identicon&r=PG&f=1", "display_name": "JHin84", "link": "https://stackoverflow.com/users/8021199/jhin84"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1494991726, "post_id": 44012212, "comment_id": 75057728, "body": "Thanks @CPerkins for your prompt feedback. Yes, that is what I&#39;m trying to tdo but since the Form_Load event will not run again, now I am trying with the Form_Open and Form_Current, but they are not refreshing the result with the new added record. Is there any other operation I need to perform before requerying the form?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1495008029, "post_id": 44012212, "comment_id": 75064873, "body": "That would be <code>Form_Activate</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "is_accepted": false, "score": 0, "last_activity_date": 1495016611, "creation_date": 1495016611, "answer_id": 44022174, "question_id": 44012212, "link": "https://stackoverflow.com/questions/44012212/refreshing-a-subform-after-a-record-is-added-on-another-form/44022174#44022174", "title": "Refreshing a Subform after a record is added on another form", "body": "<p>activate might be what you need. it's like getting the focus back (IIRC) on the main form.</p>\n\n<p>another approach is to open 'secondary' forms in dialog mode.\npseudocode:</p>\n\n<pre><code>- start working in main_user\n- open purchasing requirements -- but open it in *dialog mode*.\n    -&gt; code in main_user stops\n        - work in purchasing requirements\n        - close purchasing requirements\n    -&gt; code in main_user starts *from where it stopped*.\n    -&gt; refresh the subform now - me.sfrmName.form.requery\n</code></pre>\n\n<p>you can do it in 2 lines.</p>\n\n<pre><code>1. on button click, open purchasing requirements in dialog mode;\n2. refresh subform.\n</code></pre>\n\n<p>between 1 and 2 you're working in purchasing requirements. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8021199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba633b5773f03b01f4e931faae4a2ac?s=128&d=identicon&r=PG&f=1", "display_name": "JHin84", "link": "https://stackoverflow.com/users/8021199/jhin84"}, "is_accepted": false, "score": 0, "last_activity_date": 1495134898, "creation_date": 1495134898, "answer_id": 44056112, "question_id": 44012212, "link": "https://stackoverflow.com/questions/44012212/refreshing-a-subform-after-a-record-is-added-on-another-form/44056112#44056112", "title": "Refreshing a Subform after a record is added on another form", "body": "<p>Hello Guys! I already figured it out. What I was missing was closing the form and table after adding the new record. </p>\n\n<pre><code>DoCmd.Close acForm, \"tb_requirements\", acSaveYes\nDoCmd.Close acTable, \"tb_requirements\", acSaveYes\n</code></pre>\n\n<p>Once I did this the .Requery could work, otherwise it remained with the same data. Thank you so much for you time and advise, really appreciated.</p>\n"}], "owner": {"reputation": 1, "user_id": 8021199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba633b5773f03b01f4e931faae4a2ac?s=128&d=identicon&r=PG&f=1", "display_name": "JHin84", "link": "https://stackoverflow.com/users/8021199/jhin84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 616, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495134898, "creation_date": 1494971498, "last_edit_date": 1494972559, "question_id": 44012212, "link": "https://stackoverflow.com/questions/44012212/refreshing-a-subform-after-a-record-is-added-on-another-form", "title": "Refreshing a Subform after a record is added on another form", "body": "<p>I'm having issues refreshing a subform after a record is added in another form in access 2007-2010. It seems that could be very simple but I'm not sure where I'm failing.</p>\n\n<p>I have three forms:  </p>\n\n<ul>\n<li>One that is the main user form called main_user,  </li>\n<li>another one where the user creates the purchasing requirements called tb_requirements  </li>\n<li>and another one that is linked to the tb_requirements that is called tb_records.</li>\n</ul>\n\n<p>The main idea of this system is that the user creates general purchasing requirements with attachments in tb_requirements and then adds some detailed requirements to the general requirement form (tb_records).</p>\n\n<p>This function is already working but when I'm trying to update/go back to the main user screen (main_user) with all the open and new requirements, it does not work. The main user form is using a subform of the table tb_requirements. So in the VBA of main_user, I wrote the following code:</p>\n\n<pre><code>Private Sub Form_Load()\n\n   Dim sSQL as String\n\n   sSQL = 'with the query I want to show in the screen\n\n   Me.tb_requirements.Forms.RecordSource = sSQL\n\n   Me.tb_requirements.Forms.Requery\n\nEnd sub\n</code></pre>\n\n<p>I also tried with <code>.Refresh</code> and <code>.Recalc</code> and it is not working. Could you please help?</p>\n"}, {"tags": ["xml", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 739, "user_id": 7262393, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/10209827239390452/picture?type=large", "display_name": "Dan", "link": "https://stackoverflow.com/users/7262393/dan"}, "is_accepted": true, "score": 2, "last_activity_date": 1494978545, "creation_date": 1494978545, "answer_id": 44013346, "question_id": 44012140, "link": "https://stackoverflow.com/questions/44012140/writing-a-complex-namespace-xml-with-vba/44013346#44013346", "title": "Writing a complex namespace xml with vba", "body": "<p>No worries I've figured it out.  Ill edit it in case anyone else is looking for the same thing!  </p>\n\n<p>I changed this:</p>\n\n<pre><code>xDoc.DocumentElement.setAttribute \"xsi:schemaLocation\", \"uri:rhubarb:pie RHUBARB%20PIE%202012.xsd\", \"xmlns\", \"uri:rhubarb:pie\", \"xmlns:xsi\", \"http://www.w3.org/2001/XMLSchema-instance\"\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>xDoc.DocumentElement.setAttribute \"xsi:schemaLocation\", \"uri:rhubarb:pie RHUBARB%20PIE%202012.xsd\"\nxDoc.DocumentElement.setAttribute \"xmlns\", \"uri:rhubarb:pie\"\nxDoc.DocumentElement.setAttribute \"xmlns:xsi\", \"http://www.w3.org/2001/XMLSchema-instance\"\n</code></pre>\n"}], "owner": {"reputation": 739, "user_id": 7262393, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/10209827239390452/picture?type=large", "display_name": "Dan", "link": "https://stackoverflow.com/users/7262393/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1722, "favorite_count": 1, "accepted_answer_id": 44013346, "answer_count": 1, "score": 2, "last_activity_date": 1494978635, "creation_date": 1494971193, "last_edit_date": 1531164843, "question_id": 44012140, "link": "https://stackoverflow.com/questions/44012140/writing-a-complex-namespace-xml-with-vba", "title": "Writing a complex namespace xml with vba", "body": "<p>So...another xml namespace question.  I want to write this namespace with vba</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Datas xsi:schemaLocation=\"uri:rhubarb:pie RHUBARB%20PIE%202012.xsd\" xmlns=\"uri:rhubarb:pie\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n&lt;\\Datas&gt;\n</code></pre>\n\n<p>and here is my code so far</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Create_Database()\n\n'Declare document objects\nDim xDoc As MSXML2.DOMDocument60\nDim xNode As IXMLDOMNode\nDim xRoot As IXMLDOMElement\n\n'create new DOMDocument\nSet xDoc = New DOMDocument60\n\n'Create processing instructions\nSet xNode = xDoc.createProcessingInstruction(\"xml\", \"version='1.0' encoding= 'UTF-8'\")\nSet xNode = xDoc.InsertBefore(xNode, xDoc.ChildNodes.Item(0))\n\n'create root element\nSet xRoot = xDoc.createElement(\"Datas\")\nxDoc.appendChild xRoot\nxDoc.DocumentElement.setAttribute \"xsi:schemaLocation\", \"uri:rhubarb:pie RHUBARB%20PIE%202012.xsd\"\nxDoc.DocumentElement.setAttribute \"xmlns\", \"uri:rhubarb:pie\"\nxDoc.DocumentElement.setAttribute \"xmlns:xsi\", \"http://www.w3.org/2001/XMLSchema-instance\"\n\n'save xml file\nxDoc.Save \"C:\\Users\\danny\\Desktop\\xml\\Database.xml\"\n'clear xDoc from memory\nSet xDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>...but I know in writing the namespace I have too many arguments.  The only thing I can find online would be to write my namespace like this:</p>\n\n<pre><code>xDoc.DocumentElement.setAttribute \"xmlns:xsi\", \"http://www.w3.org/2001/XMLSchema-instance\"\n</code></pre>\n\n<p>I keep getting an error about too many arguments.  My question:  How do I write a more complex namespace?  Or is that even a correct way to go about writing it?</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494971302, "post_id": 44012069, "comment_id": 75052414, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20227196/excel-vba-combine-rows-with-duplicate-values-in-one-cell-and-merge-values-in-o\">Excel VBA - Combine rows with duplicate values in one cell and merge values in other cell</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8022050, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SpNRdSv4xSc/AAAAAAAAAAI/AAAAAAAAAHs/nonmgSdesMA/photo.jpg?sz=128", "display_name": "Stewpendous", "link": "https://stackoverflow.com/users/8022050/stewpendous"}, "edited": false, "score": 0, "creation_date": 1495041295, "post_id": 44030891, "comment_id": 75088644, "body": "Thanks! I get a couple of syntax errors with this code.                   For i = 2 through 16                          .cells(lngRow - 1, i)value = .cells(lngRow, i).value"}, {"owner": {"reputation": 3, "user_id": 8022050, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SpNRdSv4xSc/AAAAAAAAAAI/AAAAAAAAAHs/nonmgSdesMA/photo.jpg?sz=128", "display_name": "Stewpendous", "link": "https://stackoverflow.com/users/8022050/stewpendous"}, "edited": false, "score": 0, "creation_date": 1495041340, "post_id": 44030891, "comment_id": 75088675, "body": "I&#39;m sorry for being a newbie at this. I promise to learn VBA soon! lol"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 3, "user_id": 8022050, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SpNRdSv4xSc/AAAAAAAAAAI/AAAAAAAAAHs/nonmgSdesMA/photo.jpg?sz=128", "display_name": "Stewpendous", "link": "https://stackoverflow.com/users/8022050/stewpendous"}, "edited": false, "score": 0, "creation_date": 1495042622, "post_id": 44030891, "comment_id": 75089431, "body": "Sorry... yes that should be <code>for i = 2 to 16</code> I will update. And I missed a period in that other line. Should be good now.  No worries on the not knowing VBA. If you get tasked with more stuff like this, then you&#39;d be doing yourself a huge favor by learning it. If you can work your way through understanding just this bit of code, then you&#39;ll be more proficient then most."}, {"owner": {"reputation": 3, "user_id": 8022050, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SpNRdSv4xSc/AAAAAAAAAAI/AAAAAAAAAHs/nonmgSdesMA/photo.jpg?sz=128", "display_name": "Stewpendous", "link": "https://stackoverflow.com/users/8022050/stewpendous"}, "edited": false, "score": 0, "creation_date": 1495044734, "post_id": 44030891, "comment_id": 75090645, "body": "THANK YOU SO MUCH!"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 0, "last_activity_date": 1495042632, "last_edit_date": 1495042632, "creation_date": 1495040399, "answer_id": 44030891, "question_id": 44012069, "link": "https://stackoverflow.com/questions/44012069/combine-rows-based-on-duplicate-values-in-column-a/44030891#44030891", "title": "Combine Rows based on duplicate values in column A", "body": "<p>I highly highly encourage you to spend the time to learn what this is doing. I have made copious comments in the code and changed around your example code to merge all rows with similar job numbers together.</p>\n\n<p>I haven't tested the code, but it should do the job. Make sure to test it first before allowing to eat up all of your data.</p>\n\n<pre><code>Sub mergeCategoryValues() \n    Dim lngRow As Long\n\n    'This is using activesheet, so make sure your worksheet is \n    ' selected before running this code.\n    With ActiveSheet\n\n        'We are looking for duplicate Job Numbers\n        '  which is column 1. Set that here if it needs\n        '  to change.\n        Dim columnToMatch As Integer: columnToMatch = 1\n\n        'Figure out the last row\n        lngRow = .Cells(65536, columnToMatch).End(xlUp).Row\n\n        'Sort the records by the column we will use to match . Column A holds the Job Number\n        .Cells(columnToMatch).CurrentRegion.Sort key1:=.Cells(columnToMatch), Header:=xlYes\n\n        'Loop through each row starting with last and working our way up.\n        Do\n\n            'Does this row match with the next row up accoding to the Job Number in Column A?\n            If .Cells(lngRow, columnToMatch) = .Cells(lngRow - 1, columnToMatch) Then\n\n                'Loop through columns B though P\n                For i = 2 to 16\n\n                    'Determine if the next row up already has a value. If it does leave it be\n                    '   if it doesn't then use the value from this row to populate the next\n                    '   next one up.\n                    If .Cells(lngRow - 1, i).value = \"\" Then\n                        .cells(lngRow - 1, i).value = .cells(lngRow, i).value\n                    End if\n                Next i\n\n                'Now that we've processed all of the columns, delete this row\n                '   as the next row up will have all the values\n                .Rows(lngRow).Delete\n            End If\n\n            'Go to the next row up and do it all again.\n            lngRow = lngRow - 1\n        Loop Until lngRow = 1\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8022050, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SpNRdSv4xSc/AAAAAAAAAAI/AAAAAAAAAHs/nonmgSdesMA/photo.jpg?sz=128", "display_name": "Stewpendous", "link": "https://stackoverflow.com/users/8022050/stewpendous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2363, "favorite_count": 0, "accepted_answer_id": 44030891, "answer_count": 1, "score": -2, "last_activity_date": 1495042632, "creation_date": 1494970916, "last_edit_date": 1531161705, "question_id": 44012069, "link": "https://stackoverflow.com/questions/44012069/combine-rows-based-on-duplicate-values-in-column-a", "title": "Combine Rows based on duplicate values in column A", "body": "<p><strong>*NOTE: I'm on my second day of searching this site and have not found a good answer that works or that I'm able to understand. I do not know coding and this is just for work. (I don't have time to learn it in the next 6 hours). Please assist, as what I've seen does not answer the problem I have. I've posted one of the many VBA codes I've tried at the bottom. It looks close to what I need, but I do not know how to edit it for MY data. *</strong></p>\n\n<p>I have a vendor that separates job numbers based on who worked on a part of that job no matter how many times we ask that they put all of the information in one row.  So my question is, how do I combine the rows based on the job number? There are multiple columns that are associated with the rows that need to be combined, A-P or 1-16, with column A/1 containing the duplicate job numbers. I do not need sums as all of the columns are text or dates. I just need the rows combined and if there are more than one distinct entry for a column to have the comments separated by a comma. For instance: </p>\n\n<p><img src=\"https://i.stack.imgur.com/nJ1iR.jpg\" alt=\"example\"></p>\n\n<p>The first two rows are examples of what I'm receiving and the fifth row is what I need (I've hidden some columns for the example). So as you see, any column with duplicate values are condensed, columns that only have 1 entry just copies that single entry and columns with multiple different entries combines all of the entries into one cell and separates each with a comma. </p>\n\n<p>I know it seems simple to do by hand, but some of these job numbers are duplicated 20 times and I have 600+ of these to go through every week when the vendor submits the info incorrectly again. </p>\n\n<p>Here is one of the VBA codes I've tried. This is the original. I won't show you how I tried to edit it for my work... bc I know it was horrible. PLEASE ASSIST! </p>\n\n<p>Sub mergeCategoryValues()\n    Dim lngRow As Long</p>\n\n<pre><code>With ActiveSheet\n    Dim columnToMatch As Integer: columnToMatch = 1\n    Dim columnToConcatenate As Integer: columnToConcatenate = 3\n    Dim columnToSum As Integer: columnToSum = 4\n\n    lngRow = .Cells(65536, columnToMatch).End(xlUp).Row\n    .Cells(columnToMatch).CurrentRegion.Sort key1:=.Cells(columnToMatch), Header:=xlYes\n\n    Do\n        If .Cells(lngRow, columnToMatch) = .Cells(lngRow - 1, columnToMatch) Then\n            .Cells(lngRow - 1, columnToConcatenate) = .Cells(lngRow - 1, columnToConcatenate) &amp; \"; \" &amp; .Cells(lngRow, columnToConcatenate)\n            .Cells(lngRow - 1, columnToSum) = .Cells(lngRow - 1, columnToSum) + .Cells(lngRow, columnToSum)\n            .Rows(lngRow).Delete\n        End If\n\n        lngRow = lngRow - 1\n    Loop Until lngRow = 1\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494971873, "post_id": 44011913, "comment_id": 75052652, "body": "@YowE3K I think that the column <code>AM</code> is yet to be filled while other data exists in the <code>Sheets(&quot;sample&quot;)</code> (the Q being a follow-up on a previous answer of mine). Yet I leave the confirmation to OP."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1494971947, "post_id": 44011913, "comment_id": 75052684, "body": "@A.S.H - If an array formula can&#39;t be populated in multiple cells at a single time, your answer is probably the solution, so I removed my comment just as you were replying to me :D"}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494972236, "post_id": 44012271, "comment_id": 75052816, "body": "@YowE3K Feel free! I trust your edits so no need to ask me anytime :) I didn&#39;t much care about editing the formula itself."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494972338, "post_id": 44012271, "comment_id": 75052857, "body": "Thanks - it gets rid of that annoying scroll bar!"}, {"owner": {"reputation": 21, "user_id": 6710161, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e53a5ad611c44006f7b86094af3b98da?s=128&d=identicon&r=PG&f=1", "display_name": "terny", "link": "https://stackoverflow.com/users/6710161/terny"}, "edited": false, "score": 0, "creation_date": 1494978912, "post_id": 44012271, "comment_id": 75054893, "body": "It saying &quot;Object variable or With block variable not set&quot; is there any way to fix this?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 21, "user_id": 6710161, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e53a5ad611c44006f7b86094af3b98da?s=128&d=identicon&r=PG&f=1", "display_name": "terny", "link": "https://stackoverflow.com/users/6710161/terny"}, "edited": false, "score": 0, "creation_date": 1494979006, "post_id": 44012271, "comment_id": 75054913, "body": "@terny my code should replace the very last two lines of your OP&#39;s code. Is that what you did? Because you still need to <code>set</code> the range first."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1494972305, "last_edit_date": 1494972305, "creation_date": 1494971736, "answer_id": 44012271, "question_id": 44011913, "link": "https://stackoverflow.com/questions/44011913/match-formula-in-vba-array-macro-for-excel-data/44012271#44012271", "title": "Match formula in vba array macro for excel data", "body": "<p>You need to set each cell's formula alone, because the formula you are using is an array formula for a single cell. Try it this way:</p>\n\n<pre><code>With rng\n  .Cells(1).FormulaArray = \"=IF(ISNUMBER(MATCH(1,\" &amp; Chr(10) &amp; _\n                           \"  (order!R2C17:R1000000C17=RC[-22])*\" &amp; Chr(10) &amp; _\n                           \"  (order!R2C7:R1000000C7=RC[-32])*\" &amp; Chr(10) &amp; _\n                           \"  (order!R2C24:R1000000C24=RC[-15]),\" &amp; Chr(10) &amp; _\n                           \"  0)), \"\"pass\"\",\"\"review\"\")\"\n  .Filldown\n  .Value = .Value2\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6710161, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e53a5ad611c44006f7b86094af3b98da?s=128&d=identicon&r=PG&f=1", "display_name": "terny", "link": "https://stackoverflow.com/users/6710161/terny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 44012271, "answer_count": 1, "score": 1, "last_activity_date": 1494975443, "creation_date": 1494970212, "last_edit_date": 1494975443, "question_id": 44011913, "link": "https://stackoverflow.com/questions/44011913/match-formula-in-vba-array-macro-for-excel-data", "title": "Match formula in vba array macro for excel data", "body": "<pre><code>  Dim rng As Range\nLastrow = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row\nWith Sheets(\"sample\")\n    Set rng = .Range(.Range(\"AM1000000\").End(xlUp).Offset(1, 0), .Range(\"AM\" &amp; Lastrow))\nEnd With\nrng.FormulaArray = \"=IF(ISNUMBER(MATCH(1,\" &amp; Chr(10) &amp; \"  (order!R2C17:R1000000C17=RC[-22])*\" &amp; Chr(10) &amp; \"  (order!R2C7:R1000000C7=RC[-32])*\" &amp; Chr(10) &amp; \"  (order!R2C24:R1000000C24=RC[-15]),\" &amp; Chr(10) &amp; \"  0)), \"\"pass\"\",\"\"review\"\")\"\nrng = rng.Value\n</code></pre>\n\n<p>I have VBA code to populate a field to compare two worksheets and return the result. However, this code is giving me only result for first line. Is there any way to make this array works for every line?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1494970276, "post_id": 44011763, "comment_id": 75051995, "body": "You&#39;re checking <code>lRow1</code> to be the last row...so VBA is &quot;correctly&quot; resizing to your <code>0</code> row. You instead need to loop through those rows until a row doesn&#39;t equal zero."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1494970113, "creation_date": 1494970113, "answer_id": 44011892, "question_id": 44011763, "link": "https://stackoverflow.com/questions/44011763/dynamically-resizing-table-to-last-row/44011892#44011892", "title": "Dynamically Resizing Table to last row?", "body": "<p>Something like:</p>\n\n<pre><code>With Sheets(\"Sheet4\")\n\n    Lrow1 = .Cells(.Rows.Count, \"J\").End(xlUp).Row\n    Do While .Cells(Lrow1, \"J\").Value=0\n        Lrow1 = Lrow1 - 1\n    Loop\n\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1494972666, "post_id": 44012387, "comment_id": 75052985, "body": "Normally I would just use a pivot table for this, but for this particular data set I need to use a calculated field that I&#39;m not sure can be done in a pivot table (at least so far as I can tell). Basically I&#39;m taking the table and then exporting it into a chart for visualization. The dynamically resizing effect is because of the chart looks quite ugly if the a slicer item is selected where there are null values present. Thank you for your information. I&#39;ll definitely use this in the future."}, {"owner": {"reputation": 331, "user_id": 7834321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/147fb04269e2225ecafbcf20dfbbd76d?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Nevins", "link": "https://stackoverflow.com/users/7834321/tim-nevins"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1494973188, "post_id": 44012387, "comment_id": 75053169, "body": "Have you used calculated fields in Pivot Tables? They are somewhat limited, but can be very useful. To add a calculated field select a pivot table, then click Options on the PivotTable Tools tab, to the right in the Calculations area is Fields, Items, &amp; Sets. Click Calculated Field and let the fun begin! (intuitive af, no?)"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1494973428, "post_id": 44012387, "comment_id": 75053284, "body": "Yes, I&#39;ve used calculated fields quite extensively. I believe I&#39;ve ran into one of the &quot;limitations&quot; of calculated fields this time around though, that&#39;s why I was just wanting to stick with a standard table in this instance."}], "tags": [], "owner": {"reputation": 331, "user_id": 7834321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/147fb04269e2225ecafbcf20dfbbd76d?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Nevins", "link": "https://stackoverflow.com/users/7834321/tim-nevins"}, "is_accepted": false, "score": 2, "last_activity_date": 1494972370, "creation_date": 1494972370, "answer_id": 44012387, "question_id": 44011763, "link": "https://stackoverflow.com/questions/44011763/dynamically-resizing-table-to-last-row/44012387#44012387", "title": "Dynamically Resizing Table to last row?", "body": "<p>Is there a particular reason you want to do this in VBA? You can simply create a defined name and use the following to create a self-adjusting range:</p>\n\n<pre><code>OFFSET(Sheet!$A$1,0,0,COUNTA(Sheet!$A:$A),COUNTA(Sheet!$1:$1))\nOFFSET(reference, rows, cols, [height], [width])\n</code></pre>\n\n<p>The top line shows typical usage, 2nd line is the official syntax.</p>\n\n<p>Go into Name Manager on the Formulas tab, click new, give it a name and paste the code into Refers to:.</p>\n\n<p>One caveat, it looks as though your data has 0's where there are no values. If that is truly the case, you'll have to do a different test to determine height.</p>\n\n<p>One benefit of this method is that it is always calculated. If the data changes then the size definition of your named range adjusts as needed.</p>\n\n<p>I hope this is helpful, I use this a lot...</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 11120000, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b3vv-dp2I2o/AAAAAAAAAAI/AAAAAAAAGZY/UFZai8PUnsY/photo.jpg?sz=128", "display_name": "Sabir Guiri", "link": "https://stackoverflow.com/users/11120000/sabir-guiri"}, "is_accepted": false, "score": 3, "last_activity_date": 1551358370, "creation_date": 1551358370, "answer_id": 54926230, "question_id": 44011763, "link": "https://stackoverflow.com/questions/44011763/dynamically-resizing-table-to-last-row/54926230#54926230", "title": "Dynamically Resizing Table to last row?", "body": "<p>This should help you to automatically resize the table.</p>\n\n<pre><code>   With Worksheets(\"sheet-name\").ListObjects(\"table-name\")\n        .Resize .Range(1, 1).CurrentRegion\n    End With\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4635, "favorite_count": 0, "accepted_answer_id": 44011892, "answer_count": 3, "score": 4, "last_activity_date": 1551358370, "creation_date": 1494969628, "question_id": 44011763, "link": "https://stackoverflow.com/questions/44011763/dynamically-resizing-table-to-last-row", "title": "Dynamically Resizing Table to last row?", "body": "<p>I have a table that I would like to resize dynamically in VBA.\nMy current code is this:</p>\n\n<pre><code>Sub resizedata()\nDim ws As Worksheet\nDim ob As ListObject\nDim Lrow1 As Long\n\nLrow1 = Sheets(\"Sheet4\").Cells(Rows.Count, \"J\").End(xlUp).Row\nSet ws = ActiveWorkbook.Worksheets(\"Sheet4\")\nSet ob = ws.ListObjects(\"Table28\")\n\nob.Resize ob.Range.Resize(Lrow1)\n\nEnd Sub\n</code></pre>\n\n<p>I would like to add one condition onto this though...</p>\n\n<ol>\n<li>The table should resize to before the first 0 in column J.</li>\n</ol>\n\n<p>For instance:</p>\n\n<pre><code>+-------+--------+-------+\n|Date(I)|Hours(J)| Sal(K)|\n+-------+--------+-------+\n| Aug   | 150000 | 12356 |\n| Sep   |  82547 |  8755 |\n| Oct   |  92857 | 98765 |\n| Nov   |  10057 | 45321 |\n| Dec   |      0 |     0 |\n| Jan   |      0 |     0 |\n+-------+--------+-------+\n</code></pre>\n\n<p>The above table's last row should be the November row because December is the first 0 value in column J.</p>\n\n<p>Can anyone assist in revising my existing code?</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494968777, "post_id": 44011504, "comment_id": 75051359, "body": "You create a loop by saying something like <code>For r = 1 To 56</code> <code>&#39;code goes here</code> <code>Next</code>, but it&#39;s not clear from your question exactly what code you want us to write for you, so you may have to do most of the work."}, {"owner": {"reputation": 11, "user_id": 2521517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4a3ed7c9ee97faa60d9afdd0f6386a2?s=128&d=identicon&r=PG", "display_name": "user2521517", "link": "https://stackoverflow.com/users/2521517/user2521517"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494968882, "post_id": 44011504, "comment_id": 75051406, "body": "i am new to vba which is why i am hoping someone can teach me how to write somethign like this, the loop should essentially open each of the files in the folder and copy data and paste in the master file and then go to the next file in the folder"}, {"owner": {"reputation": 11, "user_id": 2521517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4a3ed7c9ee97faa60d9afdd0f6386a2?s=128&d=identicon&r=PG", "display_name": "user2521517", "link": "https://stackoverflow.com/users/2521517/user2521517"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494969501, "post_id": 44011504, "comment_id": 75051705, "body": "the master file consolidation tab has a list of 1 to 56 in column B and i want to paste data in cells starting c5,d5,e5. I just need the macro to know what cells to pull based on the name of the file if its APL copy summary tab Cells A1, A2 and A7, if its PL copy data tab cells D4, D7 and G98 BPL and if its BPL pull Liquidation tab cells E4,R5,T6"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2521517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4a3ed7c9ee97faa60d9afdd0f6386a2?s=128&d=identicon&r=PG", "display_name": "user2521517", "link": "https://stackoverflow.com/users/2521517/user2521517"}, "edited": false, "score": 0, "creation_date": 1494973102, "post_id": 44012361, "comment_id": 75053138, "body": "thanks David a couple questions for you 1) what does the split by period and split by space do ? 2) what does the the RowNumber = FileNumber + 4 do"}, {"owner": {"reputation": 497, "user_id": 3776309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7004e0b78bf0a646c8b3ab1df1ee194?s=128&d=identicon&r=PG&f=1", "display_name": "David Pedack", "link": "https://stackoverflow.com/users/3776309/david-pedack"}, "reply_to_user": {"reputation": 11, "user_id": 2521517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4a3ed7c9ee97faa60d9afdd0f6386a2?s=128&d=identicon&r=PG", "display_name": "user2521517", "link": "https://stackoverflow.com/users/2521517/user2521517"}, "edited": false, "score": 0, "creation_date": 1494975228, "post_id": 44012361, "comment_id": 75053921, "body": "well you could put in a break in the code and use the locals window to see what the variables contain...  but if the file name is &#39;1 APL.xlsm&#39; then fileNumber = 1 and fileText = &quot;APL&quot;.  I think you should be able to figure out the second one."}], "tags": [], "owner": {"reputation": 497, "user_id": 3776309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7004e0b78bf0a646c8b3ab1df1ee194?s=128&d=identicon&r=PG&f=1", "display_name": "David Pedack", "link": "https://stackoverflow.com/users/3776309/david-pedack"}, "is_accepted": false, "score": 0, "last_activity_date": 1494972234, "creation_date": 1494972234, "answer_id": 44012361, "question_id": 44011504, "link": "https://stackoverflow.com/questions/44011504/loop-through-range-of-hyperlinks-and-pull-data/44012361#44012361", "title": "Loop through range of hyperlinks and pull data", "body": "<p>Here's some sample code to get you started.  Once you understand the copy/paste parts, you should be able to adapt to the rest of your data and the rest of your files.  This code needs to live in your master workbook and you must have the master workbook activated/selected when you start running the code.</p>\n\n<pre><code>Public Sub test()\n\nDim tempWb As Workbook\nDim masterWb As Workbook\n\nSet masterWb = ActiveWorkbook\nDim Path As String\n\n'change to your path\nPath = \"C:\\TEMP\\test\\\"\nFilename = Dir(Path &amp; \"*.xlsm\")\n\nDo While Len(Filename) &gt; 0\n\n    'make sure the file name contains 1 of the 3 strings\n    If InStr(Filename, \"APL\") &gt; 0 Or InStr(Filename, \"PL\") Or InStr(Filename, \"BPL\") Then\n\n        'split the file name to get the number and file text\n        splitByPeriod = Split(Filename, \".\")\n        splitBySpace = Split(splitByPeriod(0), \" \")\n\n        Dim fileNumber As Integer\n        Dim fileText As String\n\n        fileNumber = splitBySpace(0)\n        fileText = splitBySpace(1)\n\n        'activate the master\n        masterWb.Activate\n        Worksheets(\"Consolidation\").Activate\n\n        Dim rowNumber As Integer\n        rowNumber = fileNumber + 4\n\n        'open the file\n        Set tempWb = Workbooks.Open(Path &amp; Filename)\n\n        If fileText = \"APL\" Then\n\n            'activate the workbook\n            tempWb.Activate\n            'activate the summary tab\n            Worksheets(\"summary\").Activate\n            'copy the data in range A1\n            Range(\"A1\").Select\n            Selection.Copy\n\n            'activate your summary workbook\n            masterWb.Activate\n            'activate the consolidation tab\n            Worksheets(\"Consolidation\").Activate\n\n            'activate the cell to place the data in\n            Range(\"C\" &amp; rowNumber).Select\n            'paste the data\n            ActiveSheet.Paste\n\n            'repeat as necessary\n            'add additional copy/paste code here\n\n\n        ElseIf fileText = \"PL\" Then\n\n            'add copy/paste code\n\n        ElseIf fileText = \"BPL\" Then\n\n            'add copy/paste code\n\n        End If\n\n        'close the file, don't save, don't display alerts about not saving\n        Application.DisplayAlerts = False\n        tempWb.Close False\n        Application.DisplayAlerts = True\n\n    End If\n\n    Filename = Dir\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2521517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4a3ed7c9ee97faa60d9afdd0f6386a2?s=128&d=identicon&r=PG", "display_name": "user2521517", "link": "https://stackoverflow.com/users/2521517/user2521517"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 455, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494972234, "creation_date": 1494968506, "last_edit_date": 1531164843, "question_id": 44011504, "link": "https://stackoverflow.com/questions/44011504/loop-through-range-of-hyperlinks-and-pull-data", "title": "Loop through range of hyperlinks and pull data", "body": "<p>I am new to VBA and could really use your help on this. </p>\n\n<ul>\n<li><p>I have a folder that has 3 types of files (APL, PL, BPL) and a master file. I would like to pull specific data from specific sheets in each of these files and pull it back into the master file. </p></li>\n<li><p>The issue I am having is there are over 50 files in this folder (1 APL to 19 APL, 20 PL to 40 PL, 41 BPL to 56 BPL). </p></li>\n<li><p>How do I create a loop that will pull specific cells and paste them back in a orderly fashion( 1 through 56 rows) in the master file starting cells C5, D5, E5 in the CONSOLIDATION tab. </p></li>\n<li><p>Each file in the folder should be labeled a number (1,2,3) followed by either APL, PL or BPL. </p></li>\n<li><p>Based on the file name the loop should pull specific cells. </p></li>\n<li><p>For any APL files - Copy summary tab Cells A1, A2 and A7 paste in master file Consolidation tab starting C5, D5, E5</p></li>\n<li><p>For any PL files - copy Data tab cells D4, D7 and G98 </p></li>\n<li><p>For any BPL files - Liquidation tabl cells E4,R5,T6</p></li>\n<li><p>Below is what my CONSOLIDATION sheet looks like</p></li>\n</ul>\n\n<h1>Pool    Data    Date    Processor</h1>\n\n<p>1   APL<br>\n2   APL<br>\n3   APL<br>\n4   APL<br>\n5   APL<br>\n6   APL<br>\n7   APL<br>\n8   APL<br>\n9   APL<br>\n10  APL<br>\n11  APL<br>\n12  APL<br>\n13  APL<br>\n14  APL<br>\n15  APL<br>\n16  APL<br>\n17  APL<br>\n18  APL<br>\n19  APL<br>\n20  PL<br>\n21  PL<br>\n22  PL<br>\n23  PL<br>\n24  PL<br>\n25  PL<br>\n26  PL<br>\n27  PL<br>\n28  PL<br>\n29  PL<br>\n30  PL<br>\n31  PL<br>\n32  PL<br>\n33  PL<br>\n34  PL<br>\n35  PL<br>\n36  PL<br>\n37  PL<br>\n38  PL<br>\n39  PL<br>\n40  PL<br>\n41  BPL<br>\n42  BPL<br>\n43  BPL<br>\n44  BPL<br>\n45  BPL<br>\n46  BPL<br>\n47  BPL<br>\n48  BPL<br>\n49  BPL<br>\n50  BPL<br>\n51  BPL<br>\n52  BPL<br>\n53  BPL<br>\n54  BPL<br>\n55  BPL<br>\n56  BPL </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1494967705, "creation_date": 1494967705, "answer_id": 44011295, "question_id": 44011186, "link": "https://stackoverflow.com/questions/44011186/macro-copy-and-paste-cells-every-other-row/44011295#44011295", "title": "Macro - Copy and Paste Cells Every Other Row", "body": "<p>You can use a <code>For</code> loop, with <code>Step 2</code> to skip two cells:</p>\n\n<pre><code>Sub copyMove()\nDim lastRow As Long, i As Long\nApplication.ScreenUpdating = False\nlastRow = Cells(Rows.Count, 6).End(xlUp).Row\n\nFor i = 3 To lastRow Step 2\n    Cells(i + 1, 4).Value = Cells(i, 6).Value\n    Cells(i, 6).Value = \"\"\nNext i\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>(This assumes you just want the values. If you need a formula, then it needs slight tweaking so let me know).</p>\n"}], "owner": {"reputation": 21, "user_id": 8021914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e5b13685b739ad70014c4bb4b52dd1?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Higa", "link": "https://stackoverflow.com/users/8021914/joe-higa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2474, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1494968195, "creation_date": 1494967255, "last_edit_date": 1494968195, "question_id": 44011186, "link": "https://stackoverflow.com/questions/44011186/macro-copy-and-paste-cells-every-other-row", "title": "Macro - Copy and Paste Cells Every Other Row", "body": "<p>I have multiple rows of data, where I'm trying to make another row and take Column F into the new Column D line by line.  I have the create new row macro set up, but how can I have a loop that would copy a cell from F into the new row in D?</p>\n\n<p>Basically like:</p>\n\n<pre><code>Range(\"F3\").Select\nSelection.Cut\nRange(\"D4\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>For every other row. </p>\n\n<p>So like the next one would put \"F5\" into \"D6\", and continue this till the end of the sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1494967066, "post_id": 44010988, "comment_id": 75050489, "body": "I ran into this issue and ended up having to loop through a range set and dump each array item into the range using a counter and range.offset for each cell.value. I am sure it can be modified for formula just as well."}, {"owner": {"reputation": 277, "user_id": 3827129, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/960016133ef5ea70ab5e71aea147ff8f?s=128&d=identicon&r=PG&f=1", "display_name": "PVic", "link": "https://stackoverflow.com/users/3827129/pvic"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1494967877, "post_id": 44010988, "comment_id": 75050898, "body": "Is it possible you could provide an example? I&#39;m not too familiar with ranges in vba."}], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 3827129, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/960016133ef5ea70ab5e71aea147ff8f?s=128&d=identicon&r=PG&f=1", "display_name": "PVic", "link": "https://stackoverflow.com/users/3827129/pvic"}, "edited": false, "score": 0, "creation_date": 1494970086, "post_id": 44011595, "comment_id": 75051920, "body": "Okay, so I updated my code.  Just to confirm your first part of the Sub, &quot;With wsSubjectivities&quot; is basically my, &quot;Function getR1C1Array()&quot; is that correct? Then, how does your, &quot;With wsStaging&quot; know what your Range is, &quot;SubjectivityList&quot;? I guess what I&#39;m asking is which part of my code is useful and which part do I need to replace/modify since I have characters longer than 255?"}, {"owner": {"reputation": 277, "user_id": 3827129, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/960016133ef5ea70ab5e71aea147ff8f?s=128&d=identicon&r=PG&f=1", "display_name": "PVic", "link": "https://stackoverflow.com/users/3827129/pvic"}, "edited": false, "score": 0, "creation_date": 1495059941, "post_id": 44011595, "comment_id": 75098117, "body": "Does your SubjectivityList represent the worksheet your on?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 277, "user_id": 3827129, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/960016133ef5ea70ab5e71aea147ff8f?s=128&d=identicon&r=PG&f=1", "display_name": "PVic", "link": "https://stackoverflow.com/users/3827129/pvic"}, "edited": false, "score": 0, "creation_date": 1495117475, "post_id": 44011595, "comment_id": 75126283, "body": "<code>SubjectivityList</code> in <code>wsStaging</code> is just a placeholder cell where I store the information (since that sheet is used for several staging processes (think ETL)."}, {"owner": {"reputation": 277, "user_id": 3827129, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/960016133ef5ea70ab5e71aea147ff8f?s=128&d=identicon&r=PG&f=1", "display_name": "PVic", "link": "https://stackoverflow.com/users/3827129/pvic"}, "edited": false, "score": 0, "creation_date": 1495126418, "post_id": 44011595, "comment_id": 75132370, "body": "If you have a minute could  you please add some comments to the code? One thing I&#39;m trying to figure out is how to incorporate my, getR1C1Array function into this sub proc.  My thought process is that after I modify your code I will need it to read in my arrays, &quot;getR1C1Array&quot;,  transpose it then run it through my Function, &quot;getFormulaR1C1Array&quot;, and finally through my sub proc, &quot;Quick&quot;.  Also, I&#39;ve yet to use With statements, so that&#39;s another reason for getting confused."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1494968868, "creation_date": 1494968868, "answer_id": 44011595, "question_id": 44010988, "link": "https://stackoverflow.com/questions/44010988/vba-transpose-multiple-array-with-more-than-255-characters/44011595#44011595", "title": "VBA Transpose Multiple Array with more than 255 Characters", "body": "<p>Here is an example of how I worked around the issue when I came across it recently. I included the entire procedure so you can see how the arrays are being populated, but the meat of the workaround I used is in last part of code <code>With wsStaging</code>.</p>\n\n<p>In this case <code>arrSubjectivity</code> is populated by cells, some of which had > 255 characters of text.</p>\n\n<pre><code>Sub StageSubjectivities()\n\nsProcName = \"StageSubjectivities\"\n\nWith wsSubjectivities\n\n    Dim lRow As Long\n    lRow = .Cells(.Rows.Count, .Range(\"subjectivity_list\").Column).END(xlUp).Row\n\n    Dim rSubjectivity As Range\n\n    For Each rSubjectivity In .Range(.Cells(.Range(\"subjectivity_list\").Row + 2, 1), .Cells(lRow, 1))\n\n        If rSubjectivity.Value = \"X\" Then\n\n            Dim arrLOB() As Variant\n            Dim arrSubjectivity() As Variant\n\n            Dim iCnt As Integer\n            ReDim Preserve arrLOB(iCnt)\n            ReDim Preserve arrSubjectivity(iCnt)\n\n            arrLOB(iCnt) = rSubjectivity.Offset(, 9)\n            arrSubjectivity(iCnt) = rSubjectivity.Offset(, 1)\n\n            iCnt = iCnt + 1\n\n        End If\n\n    Next\n\nEnd With\n\nWith wsStaging\n    Range(.Range(\"SubjectivityList\").Offset(2), .Range(\"SubjectivityList\").Offset(2).END(xlDown).Offset(0, 1)).Clear 'first it will clear the range and fill again\n    .Range(\"SubjectivityList\").Offset(2).Resize(UBound(arrLOB) + 1, 1).Value = Application.Transpose(arrLOB)\n    'The below line errors out because of text &gt; 255 not working with Array Transpose\n    '.Range(\"SubjectivityList\").Offset(2).Resize(UBound(arrSubjectivity) + 1, 1).Value = Application.Transpose(arrSubjectivity)\n    'iCnt declared above to use as a counter\n    For iCnt = 0 To UBound(arrSubjectivity)\n        With .Range(\"SubjectivityList\").Offset(iCnt + 2, 1)\n            .Value = arrSubjectivity(iCnt)\n            .WrapText = False 'because sometimes it wraps text aotmatically\n        End With\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 3827129, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/960016133ef5ea70ab5e71aea147ff8f?s=128&d=identicon&r=PG&f=1", "display_name": "PVic", "link": "https://stackoverflow.com/users/3827129/pvic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494969921, "creation_date": 1494966488, "last_edit_date": 1531164843, "question_id": 44010988, "link": "https://stackoverflow.com/questions/44010988/vba-transpose-multiple-array-with-more-than-255-characters", "title": "VBA Transpose Multiple Array with more than 255 Characters", "body": "<p>I've tried a number of different ways, but cannot figure it out.  And the similar posts haven't helped me because I have never done this before, but I have multiple arrays I need to transpose due to having more than 255 characters.  Below are my arrays.  </p>\n\n<pre><code>Sub Quick()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nDim Target As Range\nDim lastRow As Long\nDim FormulaR1C1\n\nFormulaR1C1 = getR1C1Array\nSet Target = Range(\"A1:ZZ1\").Find(\"LiquidD\")\n\nIf Not Target Is Nothing Then\n    lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n    Set Target = Target.Offset(1).Resize(UBound(FormulaR1C1, 1), UBound(FormulaR1C1, 2))\n    Target.FormulaR1C1 = FormulaR1C1\n    Set Target = Target.Rows(Target.Rows.Count).Resize(lastRow - Target.Rows.Count)\n    Target.Rows(1).AutoFill Destination:=Target\n    'Uncomment to replace worksheet formulas with their value for better performance\n    'Target.EntireColumn.Value = Target.EntireColumn.Value\nEnd If\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n\nFunction getR1C1Array()\nDim data\nReDim data(6)\ndata(0) = Array(\"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]\", \"=RC[-3]+RC[-2]/6\", \"=RC[-4]+RC[-3]/14\", \"=IF(AND(R[1048574]C[-18]=RC[-18],COUNTIF(RC[-9]:R[1048574]C[-9],0)=0),AVERAGE(RC[-9]:R[1048574]C[-9]),0)\", \"=IF(AND(R[1048574]C[-19]=RC[-19], COUNTIF(RC[-9]:R[1048574]C[-9],0)=0),AVERAGE(RC[-9]:R[1048574]C[-9]),0)\", \"=IF(AND(R[1048574]C[-20]=RC[-20],COUNTIF(RC[-9]:R[1048574]C[-9],0)=0),AVERAGE(RC[-9]:R[1048574]C[-9]),0)\", \"=IF(AND(R[1048571]C[-21]=RC[-21],COUNTIF(RC[-6]:R[1048571]C[-6],0)=0),AVERAGE(RC[-6]:R[1048571]C[-6]),0)\", \"=IF(AND(R[1048571]C[-22]=RC[-22],COUNTIF(RC[6]:R[1048571]C[6],0)=0),AVERAGE(RC[6]:R[1048571]C[6]),0)\", \"=IF(R[1048571]C[-23]=RC[-23],AVERAGE(RC[6]:R[1048571]C[6]),0)\", \"=(INTERCEPT(RC[-11]:R[-5]C[-11],RC[-15]:R[-5]C[-15])+(RC[-15]*SLOPE(RC[-11]:R[5]C[-11],RC[-15]:R[5]C[-15])))-RC[-11]\", \"=IF(RC[-11]=0,0,IF(RC[-1]&gt;RC[-11],0,1))\", \"=IF(RC[-1]=1,RC[-11],0)\", \"=0\", \"=0\")\ndata(1) = Array(\"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]\", \"=RC[-3]+RC[-2]/6\", \"=RC[-4]+RC[-3]/14\", \"=IF(AND(R[-2]C[-18]=RC[-18],COUNTIF(R[-2]C[-9]:RC[-9],0)=0),AVERAGE(R[-2]C[-9]:RC[-9]),0)\", \"=IF(R[-2]C[-19]=RC[-19],AVERAGE(R[-2]C[-9]:RC[-9]),0)\", \"=IF(AND(R[-2]C[-20]=RC[-20],COUNTIF(R[-2]C[-9]:RC[-9],0)=0),AVERAGE(R[-2]C[-9]:RC[-9]),0)\", \"=IF(AND(R[1048571]C[-21]=RC[-21],COUNTIF(RC[-6]:R[1048571]C[-6],0)=0),AVERAGE(RC[-6]:R[-1048571]C[-6]),0)\", \"=IF(AND(R[1048571]C[-22]=RC[-22],COUNTIF(RC[-6]:R[1048571]C[-6],0)=0),AVERAGE(RC[-6]:R[1048571]C[-6]),0)\", \"=IF(AND(R[1048571]C[-23]=RC[-23],COUNTIF(RC[-6]:R[1048571]C[-6],0)=0),AVERAGE(RC[-6]:R[1048571]C[-6]),0)\", \"=(INTERCEPT(R[-1]C[-11]:R[4]C[-11],R[-1]C[-15]:R[4]C[-15])+(RC[-15]*SLOPE(R[-1]C[-11]:R[4]C[-11],R[-1]C[-15]:R[4]C[-15])))-RC[-11]\", \"=IF(RC[-11]=0,0,IF(RC[-1]&gt;RC[-11],0,1))\", \"=IF(RC[-1]=1,RC[-11],0)\", \"=0\", \"=0\")\ndata(2) = Array(\"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]\", \"=RC[-3]+RC[-2]/6\", \"=RC[-4]+RC[-3]/14\", \"=IF(AND(R[-2]C[-18]=RC[-18],COUNTIF(R[-2]C[-3]:RC[-3],0)=0),AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(R[-2]C[-19]=RC[-19],AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(AND(R[-2]C[-20]=RC[-20],COUNTIF(R[-2]C[-3]:RC[-3],0)=0),AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(AND(R[1048571]C[-21]=RC[-21],COUNTIF(RC[-6]:R[1048571]C[-6],0)=0),AVERAGE(RC[-6]:R[-1048571]C[-6]),0)\", \"=IF(AND(R[1048571]C[-22]=RC[-22],COUNTIF(RC[-6]:R[1048571]C[-6],0)=0),AVERAGE(RC[-6]:R[1048571]C[-6]),0)\", \"=IF(AND(R[1048571]C[-23]=RC[-23],COUNTIF(RC[-6]:R[1048571]C[-6],0)=0),AVERAGE(RC[-6]:R[1048571]C[-6]),0)\", \"=(INTERCEPT(R[-2]C[-11]:R[3]C[-11],R[-2]C[-15]:R[3]C[-15])+(RC[-15]*SLOPE(R[-2]C[-11]:R[3]C[-11],R[-2]C[-15]:R[3]C[-15])))-RC[-11]\", \"=IF(RC[-11]=0,0,IF(RC[-1]&gt;RC[-11],0,1))\", \"=IF(RC[-1]=1,RC[-11],0)\", \"=0\", \"=0\")\ndata(3) = Array(\"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]\", \"=RC[-3]+RC[-2]/6\", \"=RC[-4]+RC[-3]/14\", \"=IF(AND(R[-2]C[-18]=RC[-18],COUNTIF(R[-2]C[-3]:RC[-3],0)=0),AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(R[-2]C[-19]=RC[-19],AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(AND(R[-2]C[-20]=RC[-20],COUNTIF(R[-2]C[-3]:RC[-3],0)=0),AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(AND(R[1048571]C[-21]=RC[-21],COUNTIF(RC[-6]:R[1048571]C[-6],0)=0),AVERAGE(RC[-6]:R[-1048571]C[-6]),0)\", \"=IF(AND(R[1048571]C[-22]=RC[-22],COUNTIF(RC[-6]:R[1048571]C[-6],0)=0),AVERAGE(RC[-6]:R[1048571]C[-6]),0)\", \"=IF(AND(R[1048571]C[-23]=RC[-23],COUNTIF(RC[-6]:R[1048571]C[-6],0)=0),AVERAGE(RC[-6]:R[1048571]C[-6]),0)\", \"=(INTERCEPT(R[-3]C[-11]:R[2]C[-11],R[-3]C[-15]:R[2]C[-15])+(RC[-15]*SLOPE(R[-3]C[-11]:R[2]C[-11],R[-3]C[-15]:R[2]C[-15])))-RC[-11]\", \"=IF(RC[-11]=0,0,IF(RC[-1]&gt;RC[-11],0,1))\", \"=IF(RC[-1]=1,RC[-11],0)\", \"=0\", \"=0\")\ndata(4) = Array(\"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]\", \"=RC[-3]+RC[-2]/6\", \"=RC[-4]+RC[-3]/14\", \"=IF(AND(R[-2]C[-18]=RC[-18],COUNTIF(R[-2]C[-3]:RC[-3],0)=0),AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(R[-2]C[-19]=RC[-19],AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(AND(R[-2]C[-20]=RC[-20],COUNTIF(R[-2]C[-3]:RC[-3],0)=0),AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(AND(R[-5]C[-21]=RC[-21],COUNTIF(R[-5]C[-6]:RC[-6],0)=0),AVERAGE(R[-5]C[-6]:RC[-6]),0)\", \"=IF(AND(R[-5]C[-22]=RC[-22],COUNTIF(R[-5]C[-6]:RC[-6],0)=0),AVERAGE(R[-5]C[-6]:RC[-6]),0)\", \"=IF(AND(R[-5]C[-23]=RC[-23],COUNTIF(R[-5]C[-6]:RC[-6],0)=0),AVERAGE(R[-5]C[-6]:RC[-6]),0)\", \"=(INTERCEPT(R[-3]C[-11]:R[2]C[-11],R[-3]C[-15]:R[2]C[-15])+(RC[-15]*SLOPE(R[-3]C[-11]:R[2]C[-11],R[-3]C[-15]:R[2]C[-15])))-RC[-11]\", \"=IF(RC[-11]=0,0,IF(RC[-1]&gt;RC[-11],0,1))\", \"=IF(RC[-1]=1,RC[-11],0)\", \"=0\", \"=0\")\ndata(5) = Array(\"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]\", \"=RC[-3]+RC[-2]/6\", \"=RC[-4]+RC[-3]/14\", \"=IF(AND(R[-2]C[-18]=RC[-18],COUNTIF(R[-2]C[-3]:RC[-3],0)=0),AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(R[-2]C[-19]=RC[-19],AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(AND(R[-2]C[-20]=RC[-20],COUNTIF(R[-2]C[-3]:RC[-3],0)=0),AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(AND(R[-5]C[-21]=RC[-21],COUNTIF(R[-5]C[-6]:RC[-6],0)=0),AVERAGE(R[-5]C[-6]:RC[-6]),0)\", \"=IF(AND(R[-5]C[-22]=RC[-22],COUNTIF(R[-5]C[-6]:RC[-6],0)=0),AVERAGE(R[-5]C[-6]:RC[-6]),0)\", \"=IF(AND(R[-5]C[-23]=RC[-23],COUNTIF(R[-5]C[-6]:RC[-6],0)=0),AVERAGE(R[-5]C[-6]:RC[-6]),0)\", \"=(INTERCEPT(R[-3]C[-11]:R[2]C[-11],R[-3]C[-15]:R[2]C[-15])+(RC[-15]*SLOPE(R[-3]C[-11]:R[2]C[-11],R[-3]C[-15]:R[2]C[-15])))-RC[-11]\", \"=IF(RC[-11]=0,0,IF(RC[-1]&gt;RC[-11],0,1))\", \"=IF(RC[-1]=1,RC[-11],0)\", \"=0\", \"=0\")\ndata(6) = Array(\"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]/DAY(EOMONTH(RC[-2],0))\", \"=RC[-2]\", \"=RC[-3]+RC[-2]/6\", \"=RC[-4]+RC[-3]/14\", \"=IF(AND(R[-2]C[-18]=RC[-18],COUNTIF(R[-2]C[-3]:RC[-3],0)=0),AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(R[-2]C[-19]=RC[-19],AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(AND(R[-2]C[-20]=RC[-20],COUNTIF(R[-2]C[-3]:RC[-3],0)=0),AVERAGE(R[-2]C[-3]:RC[-3]),0)\", \"=IF(AND(R[-5]C[-21]=RC[-21],COUNTIF(R[-5]C[-6]:RC[-6],0)=0),AVERAGE(R[-5]C[-6]:RC[-6]),0)\", \"=IF(AND(R[-5]C[-22]=RC[-22],COUNTIF(R[-5]C[-6]:RC[-6],0)=0),AVERAGE(R[-5]C[-6]:RC[-6]),0)\", \"=IF(AND(R[-5]C[-23]=RC[-23],COUNTIF(R[-5]C[-6]:RC[-6],0)=0),AVERAGE(R[-5]C[-6]:RC[-6]),0)\", \"=(INTERCEPT(R[-3]C[-11]:R[2]C[-11],R[-3]C[-15]:R[2]C[-15])+(RC[-15]*SLOPE(R[-3]C[-11]:R[2]C[-11],R[-3]C[-15]:R[2]C[-15])))-RC[-11]\", \"=IF(RC[-11]=0,0,IF(RC[-1]&gt;RC[-11],0,1))\", \"=IF(RC[-1]=1,RC[-11],0)\", \"=0\", \"=0\")\nEnd Function\n\nFunction getFormulaR1C1Array(Source As Range)\nDim r As Range\nDim Result As String\nResult = \"Array(\"\nFor Each r In Source\n    Result = Result &amp; Chr(34) &amp; Replace(r.FormulaR1C1, Chr(34), Chr(34) &amp; Chr(34)) &amp; Chr(34) &amp; \",\"\nNext\n\nResult = Left(Result, Len(Result) - 1) &amp; \")\"\n\ngetFormulaR1C1Array = Result\n\nEnd Function\n</code></pre>\n\n<p>Currently there are no strings longer than 255 characters, b/c I've been working on them separately until I can figure out how to transpose them.  Any help would be greatly appreciated!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7992900, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c278b6f74be0b2374e73bc8b01e29083?s=128&d=identicon&r=PG&f=1", "display_name": "GTA", "link": "https://stackoverflow.com/users/7992900/gta"}, "edited": false, "score": 0, "creation_date": 1494967029, "post_id": 44010897, "comment_id": 75050474, "body": "Thank you Scott for your answer.  I happened to figure out another way to also do it using flash fill.  I appreciate your response."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1494966172, "creation_date": 1494966172, "answer_id": 44010897, "question_id": 44010830, "link": "https://stackoverflow.com/questions/44010830/convert-data-from-text-format-to-time-format-in-excel/44010897#44010897", "title": "Convert data from text format to time format in excel", "body": "<p>Since your data is uniform use this formula:</p>\n\n<pre><code>=LEFT(A1,2)+TIME(MID(A1,5,2),MID(A1,9,2),MID(A1,13,2))\n</code></pre>\n\n<p>Then format the cell:</p>\n\n<pre><code>[hh]:mm:ss\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aIKo3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aIKo3.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 7992900, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c278b6f74be0b2374e73bc8b01e29083?s=128&d=identicon&r=PG&f=1", "display_name": "GTA", "link": "https://stackoverflow.com/users/7992900/gta"}, "is_accepted": false, "score": 3, "last_activity_date": 1495057611, "last_edit_date": 1495057611, "creation_date": 1494972413, "answer_id": 44012397, "question_id": 44010830, "link": "https://stackoverflow.com/questions/44010830/convert-data-from-text-format-to-time-format-in-excel/44012397#44012397", "title": "Convert data from text format to time format in excel", "body": "<p>I solved it with the following steps:</p>\n\n<ol>\n<li>Format the data as a table</li>\n<li>Insert column</li>\n<li>Fill the first two lines with the data in 00:00:00 format</li>\n<li>Press <kbd>Ctrl</kbd>+<kbd>E</kbd> to flash fill the rest of the column</li>\n</ol>\n"}], "owner": {"reputation": 65, "user_id": 7992900, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c278b6f74be0b2374e73bc8b01e29083?s=128&d=identicon&r=PG&f=1", "display_name": "GTA", "link": "https://stackoverflow.com/users/7992900/gta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495057611, "creation_date": 1494965826, "last_edit_date": 1531161705, "question_id": 44010830, "link": "https://stackoverflow.com/questions/44010830/convert-data-from-text-format-to-time-format-in-excel", "title": "Convert data from text format to time format in excel", "body": "<p>Is there a way to convert the following \"text\" data into a \"time\" data?</p>\n\n<p>Here is a picture of the data:<br>\n<img src=\"https://i.stack.imgur.com/ByFhf.jpg\" alt=\"Talk Time\"></p>\n\n<p>I need to extract the numbers from the data for thousands of records at a time.</p>\n\n<p>Does anyone have any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1494965545, "post_id": 44010584, "comment_id": 75049684, "body": "All data validation should be done on the form before it is copied to the worksheet.  ie, if textbox2 = &quot;&quot; then (add commands to get the user to fill the form properly.)  That way you know the worksheet has correct info and you won&#39;t need to validate it on the worksheet.  Can you update your question by showing the code in your form module?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1494966119, "post_id": 44010584, "comment_id": 75050000, "body": "1) To fix compile error, add <code>End If</code> right before <code>End Sub</code>. To stop it from running if a value is missing place <code>Exit Sub</code> right after the <code>Msgbox</code> for each condition 3) Read about <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid select</a> and your programming life will be much better."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8021683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8442d496a5f4eaaecb0f4ce33f7b732?s=128&d=identicon&r=PG&f=1", "display_name": "Shayne", "link": "https://stackoverflow.com/users/8021683/shayne"}, "edited": false, "score": 0, "creation_date": 1494968268, "post_id": 44011054, "comment_id": 75051120, "body": "Thanks Steve Lovell - This works with the prompts but now seems to paste the data on the Input Sheet and not on the next available blank row in the log sheet worksheet. Apologies but I am still learning to read the code."}, {"owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "reply_to_user": {"reputation": 3, "user_id": 8021683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8442d496a5f4eaaecb0f4ce33f7b732?s=128&d=identicon&r=PG&f=1", "display_name": "Shayne", "link": "https://stackoverflow.com/users/8021683/shayne"}, "edited": false, "score": 0, "creation_date": 1494968711, "post_id": 44011054, "comment_id": 75051337, "body": "I see what I did ... have updated. Hopefully that&#39;s now fixed."}, {"owner": {"reputation": 3, "user_id": 8021683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8442d496a5f4eaaecb0f4ce33f7b732?s=128&d=identicon&r=PG&f=1", "display_name": "Shayne", "link": "https://stackoverflow.com/users/8021683/shayne"}, "edited": false, "score": 0, "creation_date": 1494969034, "post_id": 44011054, "comment_id": 75051484, "body": "Thanks very much for the help with this. :)"}, {"owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "reply_to_user": {"reputation": 3, "user_id": 8021683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8442d496a5f4eaaecb0f4ce33f7b732?s=128&d=identicon&r=PG&f=1", "display_name": "Shayne", "link": "https://stackoverflow.com/users/8021683/shayne"}, "edited": false, "score": 0, "creation_date": 1494969529, "post_id": 44011054, "comment_id": 75051717, "body": "No worries. I&#39;ve made a few additional minor tweaks. Please mark my answer as accepted if you feel the question is now answered. P.S. I recommend ConditionalFormatting for your cell highlighting."}, {"owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "reply_to_user": {"reputation": 3, "user_id": 8021683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8442d496a5f4eaaecb0f4ce33f7b732?s=128&d=identicon&r=PG&f=1", "display_name": "Shayne", "link": "https://stackoverflow.com/users/8021683/shayne"}, "edited": false, "score": 0, "creation_date": 1494969596, "post_id": 44011054, "comment_id": 75051741, "body": "You could probably also get rid of the <code>Visble = True&#47;False</code> lines also."}, {"owner": {"reputation": 3, "user_id": 8021683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8442d496a5f4eaaecb0f4ce33f7b732?s=128&d=identicon&r=PG&f=1", "display_name": "Shayne", "link": "https://stackoverflow.com/users/8021683/shayne"}, "edited": false, "score": 0, "creation_date": 1494970028, "post_id": 44011054, "comment_id": 75051901, "body": "Thanks Steve. It still copies back on to the Input sheet but I replaced the copy and paste code with my original code and it now works fine. Quicker with your changes too!! Thanks again"}, {"owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "reply_to_user": {"reputation": 3, "user_id": 8021683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8442d496a5f4eaaecb0f4ce33f7b732?s=128&d=identicon&r=PG&f=1", "display_name": "Shayne", "link": "https://stackoverflow.com/users/8021683/shayne"}, "edited": false, "score": 0, "creation_date": 1494972084, "post_id": 44011054, "comment_id": 75052749, "body": "Sorry about that, I&#39;d worked with different sheet names at my end to test the code, and forgot to change that one back. I did now, so I think it should work as I&#39;ve got it. Either way, glad you got it working."}], "tags": [], "owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "is_accepted": true, "score": 0, "last_activity_date": 1494971972, "last_edit_date": 1494971972, "creation_date": 1494966751, "answer_id": 44011054, "question_id": 44010584, "link": "https://stackoverflow.com/questions/44010584/stop-macro-running-if-cell-is-empty-and-highlight-empty-cells-in-red/44011054#44011054", "title": "Stop Macro Running If Cell is empty and highlight empty cells in red", "body": "<p>I've made some tweaks to your code ... several more are possible, but this will get you started. Firstly, I've replaced your <code>End If / If</code>s with <code>ElseIf</code>s. This allows the final <code>Else</code> to be triggered only if no other branch is triggered. I've also removed all the unncessary <code>select</code>s which slow down the code.</p>\n\n<pre><code>Sub Submission()\n\n    If Range(\"B3\") = \"\" Then\n      MsgBox \"Please insert Outlet Name\"\n      Range(\"B3\").Select\n    ElseIf Range(\"B4\") = \"\" Then\n      MsgBox \"Please insert Date\"\n    ElseIf Range(\"F3\") = \"\" Then\n      MsgBox \"Please insert Till Number\"\n      Range(\"F3\").Select\n    ElseIf Range(\"F4\") = \"\" Then\n      MsgBox \"Please insert Operator Name\"\n    ElseIf Range(\"B5\") = \"\" Then\n      MsgBox \"Please insert Department Name\"\n    ElseIf Range(\"G19\") = \"\" Then\n      MsgBox \"Please insert Till Reading\"\n    ElseIf Range(\"B30\") = \"\" Then\n      MsgBox \"Please insert Counted By Name\"\n    ElseIf Range(\"F30\") = \"\" Then\n      MsgBox \"Please insert Witnessed By Name\"\n    Else\n      Sheets(\"Log Sheet\").Visible = True\n      Sheets(\"Sheet3\").Visible = True\n      Sheets(\"Log Sheet\").Rows(\"2:2\").Copy\n      With Cells(Sheets(\"Log Sheet\").Rows.Count, \"A\").End(xlUp).Offset(1)\n      .PasteSpecial Paste:=xlPasteValues\n      .PasteSpecial Paste:=xlPasteFormats\n      End With\n      With Sheets(\"Input \")\n      .Range(\"B3:C5\").ClearContents\n      .Range(\"F3:H4\").ClearContents\n      .Range(\"C6:C17\").ClearContents\n      .Range(\"C19:C20\").ClearContents\n      .Range(\"G19:H19\").ClearContents\n      .Range(\"A24:H28\").ClearContents\n      .Range(\"B30:C30\").ClearContents\n      .Range(\"F30:H30\").ClearContents\n      .Range(\"K6:K17\").ClearContents\n      End With\n      Sheets(\"Log Sheet\").Visible = False\n      Sheets(\"Sheet3\").Visible = False\n      ActiveWorkbook.Save\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8021683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8442d496a5f4eaaecb0f4ce33f7b732?s=128&d=identicon&r=PG&f=1", "display_name": "Shayne", "link": "https://stackoverflow.com/users/8021683/shayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1986, "favorite_count": 0, "accepted_answer_id": 44011054, "answer_count": 1, "score": 0, "last_activity_date": 1494971972, "creation_date": 1494964921, "last_edit_date": 1531164843, "question_id": 44010584, "link": "https://stackoverflow.com/questions/44010584/stop-macro-running-if-cell-is-empty-and-highlight-empty-cells-in-red", "title": "Stop Macro Running If Cell is empty and highlight empty cells in red", "body": "<p>I am trying to run a macro that records data put into a form.</p>\n\n<p>When the macro is run, it copies the information to a worksheet called <code>Log sheet</code>. It then clears the form for the next user to submit their details. </p>\n\n<p>I would like the macro to only run once the required fields have been filled in <code>Cells</code> <code>(B3,B4,B5,F3,F4,G19,B30,F30)</code>. If any of the cells are blank, then do not copy the data to the next page but add <code>Msgbox \"Complete the required fields\"</code> and highlight the empty cells in red to be completed.</p>\n\n<p>The macro works for recording details, but I do not know how to prevent it from running if the above cells are not filled in. It currently shows <code>Compile Error: Else without If</code>.</p>\n\n<pre><code>Sub Submission()\n\n    If Range(\"B3\") = \"\" Then\n      MsgBox \"Please insert Outlet Name\"\n      Range(\"B3\").Select\n    End If\n    If Range(\"B4\") = \"\" Then\n      MsgBox \"Please insert Date\"\n    End If\n    If Range(\"F3\") = \"\" Then\n      MsgBox \"Please insert Till Number\"\n      Range(\"F3\").Select\n    End If\n    If Range(\"F4\") = \"\" Then\n      MsgBox \"Please insert Operator Name\"\n    End If\n    If Range(\"B5\") = \"\" Then\n      MsgBox \"Please insert Department Name\"\n    End If\n    If Range(\"G19\") = \"\" Then\n      MsgBox \"Please insert Till Reading\"\n    End If\n    If Range(\"B30\") = \"\" Then\n      MsgBox \"Please insert Counted By Name\"\n    End If\n    If Range(\"F30\") = \"\" Then\n      MsgBox \"Please insert Witnessed By Name\"\n    Else\n      Sheets(\"Input \").Select\n      Sheets(\"Log Sheet\").Visible = True\n      Sheets(\"Log Sheet\").Select\n      Sheets(\"Sheet3\").Visible = True\n      Sheets(\"Log Sheet\").Select\n      Rows(\"2:2\").Select\n      Selection.Copy\n      Application.Goto Cells(Rows.Count, \"A\").End(xlUp).Offset(1), Scroll:=True\n      Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n      Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n      Sheets(\"Input \").Select\n      Range(\"B3:C3\").Select\n      Selection.ClearContents\n      Range(\"F3:H3\").Select\n      Selection.ClearContents\n      Range(\"F4:H4\").Select\n      Selection.ClearContents\n      Range(\"B4:C4\").Select\n      Selection.ClearContents\n      Range(\"B5:C5\").Select\n      Selection.ClearContents\n      Range(\"C7\").Select\n      Selection.ClearContents\n      Range(\"C8\").Select\n      Selection.ClearContents\n      Range(\"C9:C17\").Select\n      Selection.ClearContents\n      Range(\"G19:H19\").Select\n      Selection.ClearContents\n      Range(\"C6\").Select\n      Selection.ClearContents\n      Range(\"A24:H28\").Select\n      Selection.ClearContents\n      Range(\"C21\").Select\n      Selection.ClearContents\n      ActiveWindow.SmallScroll Down:=9\n      Range(\"B30:C30\").Select\n      Selection.ClearContents\n      Range(\"F30:H30\").Select\n      Selection.ClearContents\n      Range(\"C19\").Select\n      Selection.ClearContents\n      Range(\"C20\").Select\n      Selection.ClearContents\n      Range(\"B3\").Select\n      Range(\"K6:K17\").Select\n      Selection.ClearContents\n      Sheets(\"Log Sheet\").Select\n      ActiveWindow.SelectedSheets.Visible = False\n      Sheets(\"Sheet3\").Select\n      ActiveWindow.SelectedSheets.Visible = False\n      Range(\"B3:C3\").Select\n      Sheets(\"Input \").Select\n      Range(\"B3:C3\").Select\n      ActiveWorkbook.Save\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494964923, "post_id": 44010499, "comment_id": 75049321, "body": "What are you trying to do? What&#39;s the code so far? You&#39;re trying to use <code>LEFT()</code> in VBA?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1494966111, "post_id": 44010499, "comment_id": 75049992, "body": "I don&#39;t understand what you mean by string variable.  Do you mean as the thing being passed to the function, Right(&quot;TheLastLetterIsR&quot;, &quot;1&quot;) where the number 1 is a string?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5858404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b96d1fb9768d748fdc2655e5ea133e?s=128&d=identicon&r=PG&f=1", "display_name": "lemon", "link": "https://stackoverflow.com/users/5858404/lemon"}, "edited": false, "score": 0, "creation_date": 1494966123, "post_id": 44010591, "comment_id": 75050001, "body": "Thank you for your great answer! I chose Scott Holtzman&#39;s solution because I could change it along with my other variables in the main module."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1494964968, "creation_date": 1494964968, "answer_id": 44010591, "question_id": 44010499, "link": "https://stackoverflow.com/questions/44010499/excel-vba-call-application-function-left-right-by-name/44010591#44010591", "title": "Excel VBA - Call application function (left, right) by name", "body": "<p>The easiest way around this is to replace all your <code>Left</code> and <code>Right</code> calls with a generic function, e.g. instead of</p>\n\n<pre><code>x = Left(\"abc\", 2)\n</code></pre>\n\n<p>say</p>\n\n<pre><code>x = LeftOrRight(\"abc\", 2)\n</code></pre>\n\n<p>and then have a function</p>\n\n<pre><code>Function LeftOrRight(str As Variant, len As Long) As Variant\n    'Uncomment this line for Left\n    LeftOrRight = Left(str, len)\n    'Uncomment this line for Right\n    LeftOrRight = Right(str, len)\nEnd Function\n</code></pre>\n\n<p>Then you can just change the one function as required.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5858404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b96d1fb9768d748fdc2655e5ea133e?s=128&d=identicon&r=PG&f=1", "display_name": "lemon", "link": "https://stackoverflow.com/users/5858404/lemon"}, "edited": false, "score": 0, "creation_date": 1494966055, "post_id": 44010662, "comment_id": 75049961, "body": "I was trying to avoid writing my own function, but seems like there&#39;s no way around it. Thank you very much!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1494965152, "last_edit_date": 1592644375, "creation_date": 1494965152, "answer_id": 44010662, "question_id": 44010499, "link": "https://stackoverflow.com/questions/44010499/excel-vba-call-application-function-left-right-by-name/44010662#44010662", "title": "Excel VBA - Call application function (left, right) by name", "body": "<p>You can build a custom function where you pass if you want <code>Left</code> or <code>Right</code>.</p>\n<pre><code>Option Explicit\n\nSub Test()\n\n    Debug.Print LeftRight(&quot;L&quot;, &quot;StackOverflow&quot;, 5)\n    Debug.Print LeftRight(&quot;R&quot;, &quot;StackOverflow&quot;, 8)\n\nEnd Sub\n\nFunction LeftRight(sWhich As String, sValue As String, iLength As Integer) As String\n\n    Select Case sWhich\n\n        Case &quot;L&quot;: LeftRight = Left(sValue, iLength)\n        Case &quot;R&quot;: LeftRight = Right(sValue, iLength)\n    \n    End Select\n\nEnd Function\n</code></pre>\n<p>You just use &quot;L&quot; or &quot;R&quot; as needed. Change it once and pass as <code>sWhich</code> each time.\nYou can even use a cell reference for this and update the cell before running code.</p>\n<p>Results</p>\n<blockquote>\n<p>Stack</p>\n<p>Overflow</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1495072249, "creation_date": 1495072249, "answer_id": 44037305, "question_id": 44010499, "link": "https://stackoverflow.com/questions/44010499/excel-vba-call-application-function-left-right-by-name/44037305#44037305", "title": "Excel VBA - Call application function (left, right) by name", "body": "<p>You could also use <code>SWITCH</code> to implement Scott's idea (no error handling if string length is invalid):</p>\n\n<pre><code>Sub Test()\n    Debug.Print LeftRight(\"L\", \"StackOverflow\", 5)\n    Debug.Print LeftRight(\"R\", \"StackOverflow\", 8)\nEnd Sub\n\nFunction LeftRight(sWhich As String, sValue As String, iLength As Integer) As String\n     LeftRight = Switch(sWhich = \"L\", Left$(sValue, iLength), sWhich = \"R\", Right$(sValue, iLength))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5858404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b96d1fb9768d748fdc2655e5ea133e?s=128&d=identicon&r=PG&f=1", "display_name": "lemon", "link": "https://stackoverflow.com/users/5858404/lemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 44010662, "answer_count": 3, "score": 2, "last_activity_date": 1495072249, "creation_date": 1494964600, "question_id": 44010499, "link": "https://stackoverflow.com/questions/44010499/excel-vba-call-application-function-left-right-by-name", "title": "Excel VBA - Call application function (left, right) by name", "body": "<p>I would like to be able to call application functions such as left() and right() using a string variable. </p>\n\n<p>The reason is that my current code works fine, but has multiple instances of left() and right() that may need to change every time I run it. I'd like to be able to only change it once (\"globally\") every time.</p>\n\n<p>After googling, I tried <strong>CallByName</strong> and <strong>Application.Run</strong>. It seems that they only work with a custom class/macro. Is this true? Is there anything else I should look into? I don't need specific code, thank you!</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494964032, "post_id": 44010137, "comment_id": 75048810, "body": "If you want a VBA solution, would you be okay with a list like <code>BBB, CCC, EEE, FFF</code> in a single string/cell? Or would you need it to have one value (<code>BBB</code>, <code>CCC</code>, etc) per a cell?  (Also, instead of a screen shot, could you copy/paste data and format as a table? That helps us throw it into Excel to play around with)."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494964873, "post_id": 44010472, "comment_id": 75049300, "body": "Wooooo - nicely done. I was scratching my head on the <code>Index&#47;Match</code> part, and was going to work on a VBA function, but you beat me to it!"}, {"owner": {"reputation": 25, "user_id": 8021596, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-40C21jtVucU/AAAAAAAAAAI/AAAAAAAAESo/9PYZmDxqs2Q/photo.jpg?sz=128", "display_name": "Frostbitphoenix", "link": "https://stackoverflow.com/users/8021596/frostbitphoenix"}, "edited": false, "score": 0, "creation_date": 1495108792, "post_id": 44010472, "comment_id": 75119580, "body": "Even with all that beautiful verbiage, it didn&#39;t work for me for some reason. As I put in my edit, I will try to get a table drawn up and more information within the next little while to better help in understanding this. Still, thank you so much for that!"}, {"owner": {"reputation": 25, "user_id": 8021596, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-40C21jtVucU/AAAAAAAAAAI/AAAAAAAAESo/9PYZmDxqs2Q/photo.jpg?sz=128", "display_name": "Frostbitphoenix", "link": "https://stackoverflow.com/users/8021596/frostbitphoenix"}, "edited": false, "score": 0, "creation_date": 1495193220, "post_id": 44010472, "comment_id": 75161507, "body": "I realized just now why it didn&#39;t work for me before: I forgot to rename my ranges (I already had them named, but differently than you did, tigeravatar). I went back after reading MacroMarc&#39;s comment and realized I had not updated my range names and it worked absolutely perfectly. You are a saint/genius/wizard/some other person of high societal position deserving of my respect and all the cookies. Thank you very very much! :D"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1494964501, "creation_date": 1494964501, "answer_id": 44010472, "question_id": 44010137, "link": "https://stackoverflow.com/questions/44010137/how-to-lookup-in-an-abnormal-excel-matrix/44010472#44010472", "title": "How To Lookup In An Abnormal Excel Matrix", "body": "<p>Here is a formula that will work for you.  Without knowing your exact ranges, I opted to use Named Ranges that you can replace as desired.</p>\n\n<p>Named Ranges Used:</p>\n\n<ul>\n<li><strong>Results</strong>: This is the list of your \"Results\" in column A (AAA, BBB, etc)</li>\n<li><strong>BlockHeaders</strong>: This is the headers row containing the Block numbers (BA000-, BA010-, etc)</li>\n<li><strong>tblData</strong>: This is the table of data containing your reference numbers (032, 040, etc)</li>\n<li><strong>BlockNum</strong>: This is the cell containing the specific Block Number you are looking for (set to BA000- as per your example)</li>\n<li><strong>RefNum</strong>: This is the cell containing the specific Reference Number you are looking for (set to 040 as per your example)</li>\n</ul>\n\n<p>Using those named ranges, this formula should work for you assuming that all of the Results are unique (as shown in your example).  I put this formula in a separate sheet starting in cell B4 and copied down:</p>\n\n<pre><code>=IFERROR(INDEX(Results,MATCH(1,INDEX((COUNTIF($B$3:$B3,Results)=0)*(INDEX(tblData,0,MATCH(BlockNum,BlockHeaders,0))=RefNum),),0)),\"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 8021596, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-40C21jtVucU/AAAAAAAAAAI/AAAAAAAAESo/9PYZmDxqs2Q/photo.jpg?sz=128", "display_name": "Frostbitphoenix", "link": "https://stackoverflow.com/users/8021596/frostbitphoenix"}, "edited": false, "score": 0, "creation_date": 1495193792, "post_id": 44054509, "comment_id": 75161912, "body": "Until I read your answer and realized I had been using different names for my ranges than tigeravatar, I couldn&#39;t figure out why it wouldn&#39;t work but thank you for emphasizing that; I apparently was in a daze. You solution worked perfectly for me as well and I sincerely thank you for taking the time to work on that for me, as well as your explanations. Your check is in the mail along with a spiritual bear hug. Thank you again :D"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "reply_to_user": {"reputation": 25, "user_id": 8021596, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-40C21jtVucU/AAAAAAAAAAI/AAAAAAAAESo/9PYZmDxqs2Q/photo.jpg?sz=128", "display_name": "Frostbitphoenix", "link": "https://stackoverflow.com/users/8021596/frostbitphoenix"}, "edited": false, "score": 0, "creation_date": 1495196622, "post_id": 44054509, "comment_id": 75163866, "body": "Glad you got it sorted out."}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 1, "last_activity_date": 1495129032, "creation_date": 1495129032, "answer_id": 44054509, "question_id": 44010137, "link": "https://stackoverflow.com/questions/44010137/how-to-lookup-in-an-abnormal-excel-matrix/44054509#44054509", "title": "How To Lookup In An Abnormal Excel Matrix", "body": "<p>tigeravatar has a good idea about Named Ranges. I would advise the same if you can.</p>\n\n<p>Here is a formula entered into F10 and copied down as per my screenshot:</p>\n\n<p><code>=IFERROR(INDEX($A:$A, SMALL(IF(INDEX($C$4:$E$8, 0, MATCH($B$1, $C$2:$E$2, 0))=$A$1, ROW($A$4:$A$8), 1E+99), ROWS($F$10:$F10))), \"\")</code></p>\n\n<p>1) The values to search for are in A1 and B1 as you see. </p>\n\n<p>2)The range <code>$C$4:$E$8</code> in the second INDEX function is the block of 'Reference Numbers'. Expand the reference or use Named Ranges(better)</p>\n\n<p>3) <code>$C$2:$E$2</code> in the MATCH function are your Block codes. Expand or use Named Ranges</p>\n\n<p>4) <code>ROW($A$4:$A$8)</code> needs to cover all your 'Results'. Expand or use Named Ranges</p>\n\n<p>5) <code>ROWS($F$10:$F10)</code> needs to be amended to match the first cell where you want the list to appear. So if you were in AX1, you would use <code>ROWS($AX$1:$AX1)</code> - Please note dollar signs are slightly different.</p>\n\n<p><a href=\"https://i.stack.imgur.com/VbQie.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VbQie.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 8021596, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-40C21jtVucU/AAAAAAAAAAI/AAAAAAAAESo/9PYZmDxqs2Q/photo.jpg?sz=128", "display_name": "Frostbitphoenix", "link": "https://stackoverflow.com/users/8021596/frostbitphoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 44010472, "answer_count": 2, "score": 1, "last_activity_date": 1495129032, "creation_date": 1494963388, "last_edit_date": 1495128787, "question_id": 44010137, "link": "https://stackoverflow.com/questions/44010137/how-to-lookup-in-an-abnormal-excel-matrix", "title": "How To Lookup In An Abnormal Excel Matrix", "body": "<p>This may get complicated...please bear with me...</p>\n\n<p>I have a table that, from what I have been able to find in my research, is a somewhat special case with using lookup formulas and functions. It's much easier to show than describe so here is the screenshot of my data for an idea of what I'm working with (the actual table extends down by 60 rows and to the right by over 160 columns).  <a href=\"https://i.stack.imgur.com/blrxc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/blrxc.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>(I will refer to the values in column A as \"Results\", the values in row 2 as \"Block numbers\" and the matrix below the Block Numbers as \"Reference Numbers\".)</p>\n\n<p>What I want to do create a formula where, if I plug in a given Block Number (for example, \"BA000-\") and Reference Number (for example, \"040\"), Excel will return a list from the Results that line up with that (in the case of my example criteria, it would list \"BBB\", \"CCC\", \"EEE\", \"FFF\" and \"KKK\"). </p>\n\n<p>I have been researching this for two days now, trying every lookup function and combination of functions that I can find (including, but not limited to, INDEX-MATCH, INDEX-MATCH-MATCH, VLOOKUP-HLOOKUP, etc). Regardless of what functions I use I keep coming up with errors. I have yet to try VBA only because I have not had time to delve into it very much for this however I am beginning to think that I'm going to have to give in to that dark side or switch to Access (with which my proficiency is much lower than Excel).</p>\n\n<p>Any help would be greatly appreciated and awarded with something to the effect of 783 Karma Points (or whatever personal system of indulgence you would like me to wish to you). If you need any further information, please do not hesitate to let me know.</p>\n\n<p>EDIT: I have to work on this while balancing work time (as this is a project I have been undertaking for my work) so it may take me a minute but I will try to get a table with more information to play around with. In the interim, thank you all very much for helping me out so far!</p>\n\n<p>EDIT #2: <a href=\"https://drive.google.com/file/d/0B8XrTTcJis8WeGxEOFZQd1pSYmM/view?usp=sharing\" rel=\"nofollow noreferrer\">Here is a link</a>to a sample of the file I am working with (hosted on Google Drive). I have tried to make it as clear and concise as possible but, as before, please let me know if you need any other information about it. The actual file I am working with spans all the way to column EP but I figured that that large of a file was unnecessary. </p>\n\n<p>The gist of what this is is a reference tool to find what model a particular component is used in (a Bill Of Materials). After looking up the part number (in a separate file), you are given a block number and a reference number for that part which, when cross-referenced in the matrix, tells you which model that component is used in. My goal is to create an automatic search tool that will list all models a part is used in when the user enters the block and reference numbers (as the actual list of models, while all are unique, can get quite long and is tedious to filter through). </p>\n\n<p>As before, any help towards achieving this goal is extremely appreciated. If any other information is needed please let me know. </p>\n"}]