[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4714, "user_id": 3555000, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/145762f352604453bb4ba60e8d5738d7?s=128&d=identicon&r=PG&f=1", "display_name": "Enamul Hassan", "link": "https://stackoverflow.com/users/3555000/enamul-hassan"}, "edited": false, "score": 0, "creation_date": 1446076974, "post_id": 33403643, "comment_id": 54598886, "body": "no question mark noticed!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5500661, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203929337992780/picture?type=large", "display_name": "Zamaan Shah", "link": "https://stackoverflow.com/users/5500661/zamaan-shah"}, "edited": false, "score": 0, "creation_date": 1446158775, "post_id": 33404045, "comment_id": 54641000, "body": "Hey, thanks for your response but the problem is that the interim blanks exist because the worksheets is full of data from different sources with different sizes that is mismatched by their columns and I need to match and sort out the data into one big data set. I&#39;m trying to do this by first matching the column from each data set to the correct column I need it moved to. So what I need here is something to let me count from the first row to the last non blank row in each section into a variable to use for Resizing my copy selection later. Do you think there is a simpler solution to this?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1446079037, "creation_date": 1446079037, "answer_id": 33404045, "question_id": 33403643, "link": "https://stackoverflow.com/questions/33403643/need-to-select-the-last-cell-in-a-column-that-isnt-blank-to-count-how-many-cell/33404045#33404045", "title": "Need to select the last cell in a column that isn&#39;t blank to count how many cells of data in that section", "body": "<p>You need to <code>Set</code> a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a> and remove the <code>.Select</code> from the latter cell range reference. Typically, it is better to look for the last populated cell from the bottom UP rather than from the top down. If there were interim blank cells, you would stop at the blank rather than finding the true <em>last cell</em>.</p>\n\n<p>It would also be a good idea to resolve the parent worksheet.</p>\n\n<pre><code>dim countRes as range, resRow as long\nwith worksheets(\"Sheet1\")   '&lt;~ set this properly!\n    SET countRes = .Range(.Cells(checkRow, matchCol), .Cells(Rows.Count, matchCol).End(xlUP))\n    resRow = countRes.Rows.Count\nend with\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5500661, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203929337992780/picture?type=large", "display_name": "Zamaan Shah", "link": "https://stackoverflow.com/users/5500661/zamaan-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446079037, "creation_date": 1446076584, "last_edit_date": 1446077911, "question_id": 33403643, "link": "https://stackoverflow.com/questions/33403643/need-to-select-the-last-cell-in-a-column-that-isnt-blank-to-count-how-many-cell", "title": "Need to select the last cell in a column that isn&#39;t blank to count how many cells of data in that section", "body": "<p>I need a piece of code to work for me in a project. The clause that isn't working is meant to set a Range Variable where the Range is determined with the first cell being the row/col # of a matched cell and the ranges end cell being the last non blank cell in the respective column. I'm working with data that has blanks in between each section of data with different numbers of rows in each section, all sections on the same sheet separated by a blank row each, so I need something that keeps counting how many cells in each section for each matched case.\nThe code that's giving me an error is:</p>\n\n<pre><code>    countRes = Range(.Cells(checkRow, matchCol), .Cells(checkRow, matchCol).End(xlDown).Select)\n    resRow = countRes.Rows.Count\n</code></pre>\n\n<p>I keep getting an error that the <em>object variable hasn't been set or with block variable not set</em>.  </p>\n\n<p>Anyone know what could be wrong?  </p>\n\n<p>I know its something to do with that first line but I can't seem to figure out what's wrong.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1446100508, "post_id": 33402928, "comment_id": 54605769, "body": "Are you wanting to edit the picture as soon as you have inserted it? Or at a later stage go back using script to then edit the picture?"}, {"owner": {"reputation": 13, "user_id": 5500472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rTruX.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/5500472/sean"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1446159007, "post_id": 33402928, "comment_id": 54641079, "body": "@Jean-Pierre Oosthuizen The plan was to come back to it later, but your question of asking if I wanted to edit it as soon as I insert the picture just changed my mind!  Makes way more sense to do it that way.  Thank you for your response."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5500472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rTruX.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/5500472/sean"}, "edited": false, "score": 0, "creation_date": 1446158227, "post_id": 33422143, "comment_id": 54640812, "body": "Cindy, thank you very much.  The code you provided doesn&#39;t do exactly what I need to do, but that is due to a poor explanation on my part.  It definitely led me on the correct path by using a range.  What I ended up doing is creating a range starting at the beginning of the document, the end of the range is just prior to the bookmark where I insert my image, and then I can use range.inlineshapes.count to find out the number of shapes in the document prior to the insertion point.  Unfortunately, I cannot post any code because the VBA code is at work and I cannot open up this website there."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1446256551, "last_edit_date": 1446256551, "creation_date": 1446143888, "answer_id": 33422143, "question_id": 33402928, "link": "https://stackoverflow.com/questions/33402928/determine-index-number-for-inline-shape/33422143#33422143", "title": "Determine index number for inline shape", "body": "<p>Well, if I'm understanding you correctly the correct way to \"get a handle\" on the thing you're inserting so that you can continue working with it is to assign it to an object variable at the same time it's created, then work with that:</p>\n\n<pre><code>Dim ils as Word.InlineShape\nSet ils = ActiveDocument.InlineShapes.AddPicture('parameters here)\nils.Width = 100\n</code></pre>\n\n<p>If you really want the index value, then something like this:</p>\n\n<pre><code>Dim rng as Word.Range\nDim ils as Word.InlineShape\nSet ils = ActiveDocument.InlineShapes.AddPicture('parameters here)\nSet rng = ils.Range\nrng.Start = ActiveDocument.Content.Start\nDebug.Print rng.InlineShapes.Count \n</code></pre>\n\n<p>EDIT: Approach chosen by OP</p>\n\n<pre><code>Dim rng as Word.Range\nDim bk As Word.Bookmark\nDim ils as Word.InlineShape\nSet rng = ActiveDocument.Content\nSet bk= ActiveDocument.Bookmarks([name])\nrng.End = bk.Range.End\nSet ils = ActiveDocument.InlineShapes.AddPicture(bk.Range, other param)\nDebug.Print rng.InlineShapes.Count \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5500472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rTruX.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/5500472/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1710, "favorite_count": 0, "accepted_answer_id": 33422143, "answer_count": 1, "score": 0, "last_activity_date": 1459262194, "creation_date": 1446072559, "last_edit_date": 1459262194, "question_id": 33402928, "link": "https://stackoverflow.com/questions/33402928/determine-index-number-for-inline-shape", "title": "Determine index number for inline shape", "body": "<p>I am attempting to refer to an inline shape that I added in the middle of the document.  My current workaround is short term, and I'd like to solicit advice for a better solution.</p>\n\n<p>The situation is I am adding an inline shape using .addpicture about half way through the document.  The issue with doing this is if there are inlineshapes after the location where I am inserting the picture, the index number for the inline shape I add isn't simply the nth shape added to the document.  Inlineshapes.count will not refer to the picture I just added, it refers to the picture at the end of the document.</p>\n\n<p>My current workaround is to physically look at the document, count the number of shapes below where I am entering the new picture, and I can refer to it with something like inlineshapes(totalShapes-shapesBelow).select</p>\n\n<p>The reason I'd like to do this is so I can crop the image area or perform other manipulation of the inlineshape, if necessary.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1446072689, "post_id": 33402915, "comment_id": 54597332, "body": "Do you get the same error when you use <code>Dim i As Long, j As Long, k As Long</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1446072995, "post_id": 33402915, "comment_id": 54597468, "body": "Use <code>Workbooks(&quot;MetaTesting.xlsm&quot;)</code> or <code>Workbooks(&quot;MetaTesting.xlsb&quot;)</code> as the case may be; whatever is reported by <code>?thisworkbook.Name</code> in the VBE&#39;s Immediate window (Ctrl+G). (btw, none of those <code>Application</code> calls seem necessary)"}, {"owner": {"reputation": 77, "user_id": 3764284, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Kds7a.jpg?s=128&g=1", "display_name": "Imamadmad", "link": "https://stackoverflow.com/users/3764284/imamadmad"}, "edited": false, "score": 0, "creation_date": 1446074847, "post_id": 33402915, "comment_id": 54598211, "body": "@Jeeped it shouldn&#39;t need to be declared as a Long as the section I&#39;m testing with is only about 10 by 10.  However, adding the .xlsm to the end of the workbook name did migrate the error to line 11 (under the first comment).  Same error though."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1446073599, "post_id": 33403120, "comment_id": 54597747, "body": "Since the problem seems to originating before any copying commences, I believe the actual issue is either in the <code>Workbooks(&quot;MetaTesting&quot;)</code> or variable assignment. While you make a valid point, I don&#39;t think it addresses the issue at hand."}, {"owner": {"reputation": 77, "user_id": 3764284, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Kds7a.jpg?s=128&g=1", "display_name": "Imamadmad", "link": "https://stackoverflow.com/users/3764284/imamadmad"}, "edited": false, "score": 0, "creation_date": 1446075013, "post_id": 33403120, "comment_id": 54598267, "body": "Would this copying method work if the block of cells to be copied is of an unknown length?"}, {"owner": {"reputation": 77, "user_id": 3764284, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Kds7a.jpg?s=128&g=1", "display_name": "Imamadmad", "link": "https://stackoverflow.com/users/3764284/imamadmad"}, "edited": false, "score": 0, "creation_date": 1446075978, "post_id": 33403120, "comment_id": 54598568, "body": "This does work, and it makes my life a lot easier! Just wondering, how would I refer to a whole column except for the first row?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 77, "user_id": 3764284, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Kds7a.jpg?s=128&g=1", "display_name": "Imamadmad", "link": "https://stackoverflow.com/users/3764284/imamadmad"}, "edited": false, "score": 0, "creation_date": 1446076162, "post_id": 33403120, "comment_id": 54598644, "body": "@Imamadmad - When you change the conditions of your question to the point where a previously right answer becomes wrong, it is considered good <a href=\"http://stackoverflow.com/tour\">SO</a> ettiquette to accept the answer provided and move on to another question."}, {"owner": {"reputation": 77, "user_id": 3764284, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Kds7a.jpg?s=128&g=1", "display_name": "Imamadmad", "link": "https://stackoverflow.com/users/3764284/imamadmad"}, "edited": false, "score": 0, "creation_date": 1446076514, "post_id": 33403120, "comment_id": 54598751, "body": "@Jeeped The conditions of the question didn&#39;t change.  I was receiving an error when I was doing it my way and asked for help, and somebody provided a much simpler way to solve the problem which avoided the error.  You did help by suggesting to put the extension on the end of the question in one of your comments, but it didn&#39;t solve the whole problem and I can only accept 1 answer.  I will however upvote all three answers as they all played a part in helping solve the problem."}, {"owner": {"reputation": 77, "user_id": 3764284, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Kds7a.jpg?s=128&g=1", "display_name": "Imamadmad", "link": "https://stackoverflow.com/users/3764284/imamadmad"}, "edited": false, "score": 0, "creation_date": 1446076562, "post_id": 33403120, "comment_id": 54598763, "body": "Hehe, I just managed to make my first upvotes! Man I&#39;ve been wanting to be able to do that for a while."}], "tags": [], "owner": {"reputation": 26, "user_id": 5500084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838c90dd18dfed26ba796e8d40281860?s=128&d=identicon&r=PG&f=1", "display_name": "lifeonatlantis", "link": "https://stackoverflow.com/users/5500084/lifeonatlantis"}, "is_accepted": true, "score": 1, "last_activity_date": 1446073424, "creation_date": 1446073424, "answer_id": 33403120, "question_id": 33402915, "link": "https://stackoverflow.com/questions/33402915/cant-see-what-subscript-out-of-range/33403120#33403120", "title": "Can&#39;t see what &quot;subscript out of range&quot;", "body": "<p>You can do this without all the loops, just copy the whole worksheet - the Copy function will handle skipping empty areas for you.</p>\n\n<pre><code>Workbooks(\"MetaTesting\").Worksheets(1).Cells.Copy\nWorkbooks(\"MetaTesting\").Worksheets(2).Cells.PasteSpecial xlPasteValues\n</code></pre>\n\n<p>To copy only a block of cells:</p>\n\n<pre><code>Workbooks(\"MetaTesting\").Worksheets(1).Range(\"A1:M100\").Copy\nWorkbooks(\"MetaTesting\").Worksheets(2).Range(\"F12\").PasteSpecial xlPasteValues  ' this is the top-left corner of the paste, it'll fill in the rest\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 3764284, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Kds7a.jpg?s=128&g=1", "display_name": "Imamadmad", "link": "https://stackoverflow.com/users/3764284/imamadmad"}, "edited": false, "score": 0, "creation_date": 1446075915, "post_id": 33403472, "comment_id": 54598548, "body": "Ah, this does solve one of my problems, but I am marking the other answer because it solves more of them.  Thanks for the help!  It&#39;s always those small things that are missed!"}], "tags": [], "owner": {"reputation": 13, "user_id": 5500472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rTruX.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/5500472/sean"}, "is_accepted": false, "score": 1, "last_activity_date": 1446075557, "creation_date": 1446075557, "answer_id": 33403472, "question_id": 33402915, "link": "https://stackoverflow.com/questions/33402915/cant-see-what-subscript-out-of-range/33403472#33403472", "title": "Can&#39;t see what &quot;subscript out of range&quot;", "body": "<p>The issue on line 11 is probably due to the (\"MetaTesting.xlms\").  Looks like a little mistake on the file extentions; should be .xlsm like it is in the first half of the equation.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1446075971, "creation_date": 1446075971, "answer_id": 33403541, "question_id": 33402915, "link": "https://stackoverflow.com/questions/33402915/cant-see-what-subscript-out-of-range/33403541#33403541", "title": "Can&#39;t see what &quot;subscript out of range&quot;", "body": "<p>OK, now that it is determined that the workbook extension was required, let's cut your code down to what is necessary.</p>\n\n<pre><code>with Workbooks(\"MetaTesting.xlsm\")\n    .Worksheets(3).Cells.Copy Destination:=.Worksheets(1).Cells\n    .Worksheets(1).Cells = .Worksheets(1).Cells.Value\nend with\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 3764284, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Kds7a.jpg?s=128&g=1", "display_name": "Imamadmad", "link": "https://stackoverflow.com/users/3764284/imamadmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 33403120, "answer_count": 3, "score": 1, "last_activity_date": 1446075971, "creation_date": 1446072524, "last_edit_date": 1446074947, "question_id": 33402915, "link": "https://stackoverflow.com/questions/33402915/cant-see-what-subscript-out-of-range", "title": "Can&#39;t see what &quot;subscript out of range&quot;", "body": "<p>I'm trying to create a macro in VBA in Excel to copy the contents of one worksheet to another (eventually will be upgraded to copying contents from one workbook to another but need to prove the concept first) but I keep encountering Run-time error '9': \"Subscript out of range\".  The thing is, I can't see what part of the highlighted line could possibly ever be out of range.</p>\n\n<p>I am using a workbook called \"MetaTesting\" that has 3 worksheets, and the following bit of code starts at A1 and only ever increments upwards. I have previously been able to refer to these two worksheets to be able to copy across a single row, so I know the problem isn't there. It is the fourth line of text that is being highlighted by the debugger (the line starting \"Do While Trim(Application...\").</p>\n\n<p>Note: edited to take into account file name extension (as suggested in comments).  Same error still being thrown, but now it's being thrown on line 11 (under the first comment)</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\nDim i As Integer, j As Integer, k As Integer\ni = 1\n\nDo While Trim(Application.Workbooks(\"MetaTesting.xlsm\").Worksheets(3).Cells(i, 1).Value) &lt;&gt; \"\"\n    j = 1\n    Do While Trim(Application.Workbooks(\"MetaTesting.xlsm\").Worksheets(3).Cells(1, j).Value) &lt;&gt; \"\"\n\n        'Copy cell data from one sheet to the other\n        Application.Workbooks(\"MetaTesting.xlsm\").Worksheets(1).Cells(i, j).Value = Application.Workbooks(\"MetaTesting.xlms\").Worksheets(3).Cells(i, j).Value\n\n        j = j + 1\n    Loop\n\n    'Copy formatting of previous row and paste it on current row. Starts at row 3, copying formatting from row 2\n    If i &gt; 2 Then\n        k = i - 1\n        Application.Workbooks(\"MetaTesting.xlsm\").Worksheets(1).Cells(k, j).Copy\n        Application.Workbooks(\"MetaTesting.xlsm\").Worksheets(1).Range(Cells(i, 1), Cells(i, j)).PasteSpecial Paste:=xlPasteFormats\n    End If\n\n    i = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Any and all help appreciated.</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446069484, "post_id": 33402284, "comment_id": 54596018, "body": "Unsure what the arguments mean but perhaps a loop?"}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446069896, "post_id": 33402284, "comment_id": 54596229, "body": "There are three arugments for .slides.InsertFromFile. The first is at what slide in the powerpoint do you want to start inserting from file (i&#39;ve used myPres.slides.Count meaning I want to add these slides from file to the end of my presentation). The second is &quot;what is the first slide in your file that you want to insert&quot;. The third is &quot;what is the last slide in your file that you want to insert&quot;. I need to figure out how to make that third argument a variable."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446070074, "post_id": 33402284, "comment_id": 54596297, "body": "Wait so <code>.slides.Count</code> is what slide you want to start inserting from? Doesn&#39;t that give you what you want? Or am I mixing the files? Edit: oh ok. So do a <code>.slides.Count</code> on the file you&#39;re pulling from?"}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446070327, "post_id": 33402284, "comment_id": 54596394, "body": "I think you&#39;re mixing. The .slide.Count I&#39;m using currently is the first argument and is referring to the presentation that I want to add TO. So it says start adding the slides from file at the end of my activepresentation. IE my active presentation has 23 slides, myPres.slides.Count = 23, using that as the first argument tells vba to start adding after the 23rd slide."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446070369, "post_id": 33402284, "comment_id": 54596406, "body": "Yea, I edited my comment also see answer below."}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446070413, "post_id": 33402284, "comment_id": 54596424, "body": "Right i&#39;ve tried doing .slides.Count as my third argument. Return is a compile error: invalid or unqualified reference. I have a feeling I can&#39;t do any sort of measuring on that file as it is not associated to an object.. but that&#39;s just a guess"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446070469, "post_id": 33402284, "comment_id": 54596451, "body": "How can it work for first argument but not third?? How did you qualify it. You need to set the other presentation first as indicated in my answer."}], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1446071512, "post_id": 33402500, "comment_id": 54596856, "body": "Hello, I was able to set the fromPres to an object and the use fromPres.slides.count to add all slides. Code used is below. Thanks for your help"}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1446071602, "post_id": 33402500, "comment_id": 54596890, "body": "..I suck at stack overflow commenting"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1446071666, "post_id": 33402500, "comment_id": 54596911, "body": "Uh you can post your code as an answer and check that or check mine. Don&#39;t post it as a comment."}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 0, "last_activity_date": 1446070303, "creation_date": 1446070303, "answer_id": 33402500, "question_id": 33402284, "link": "https://stackoverflow.com/questions/33402284/slides-insertfromfile-variable-unknown-slide-count-to-insert/33402500#33402500", "title": ".slides.InsertFromFile variable/unknown slide count to insert", "body": "<p>If you set your other presentation to <code>fromPres</code> then you can do something like:</p>\n\n<pre><code>myPres.slides.InsertFromFile \"C:\\Users\\\" &amp; uName &amp; \"\\productslide.pptx\", myPres.slides.Count, 1, fromPres.slides.Count\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1446617524, "post_id": 33436513, "comment_id": 54812264, "body": "Hi DanL I amended the code to yours above as it ran successfully and reduced the run time. I didn&#39;t realize you could omit the two arguments to the method.. makes me wonder what other unnecessary arguments I&#39;m adding to other things.. Thanks!"}, {"owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "reply_to_user": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1446619213, "post_id": 33436513, "comment_id": 54812943, "body": "Good to hear. Please mark as answer if it solved your problem :-)"}], "tags": [], "owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "is_accepted": true, "score": 1, "last_activity_date": 1446210037, "last_edit_date": 1446210037, "creation_date": 1446209694, "answer_id": 33436513, "question_id": 33402284, "link": "https://stackoverflow.com/questions/33402284/slides-insertfromfile-variable-unknown-slide-count-to-insert/33436513#33436513", "title": ".slides.InsertFromFile variable/unknown slide count to insert", "body": "<p>You should simply omit the SlideStart and SlideEnd parameters, which are optional. This inserts all the slides from the specified file:</p>\n\n<pre><code>myPres.Slides.InsertFromFile \"C:\\Users\\\" &amp; uName &amp; \"\\productslide.pptx\", myPres.slides.Count\n</code></pre>\n\n<p>EDIT: I just want to add that the method proposed by findWindow is unnecessarily complex. You don't need to open the origin presentation.</p>\n"}], "owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 33436513, "answer_count": 2, "score": 0, "last_activity_date": 1446617601, "creation_date": 1446069261, "last_edit_date": 1531164843, "question_id": 33402284, "link": "https://stackoverflow.com/questions/33402284/slides-insertfromfile-variable-unknown-slide-count-to-insert", "title": ".slides.InsertFromFile variable/unknown slide count to insert", "body": "<p>I have an activepresentation defined as myPres and I would like to add slides from a file. I've done some testing with myPres.Slides.InsertFromFile, and I've successfully added slides to my activepresentation. The problem is the powerpoint that I'm wishing to pull from will have a variable amount of slides. It may have 4 slides, It may have 22 slides. How can I modify the below code to say \"all slides\" from file. Thanks, I'll be happy to provide further clarity as necessary.</p>\n\n<pre><code>myPres.slides.InsertFromFile \"C:\\Users\\\" &amp; uName &amp; \"\\productslide.pptx\", myPres.slides.Count, 1, 1\n</code></pre>\n\n<p>FYI The last 1 describes how many slides you wish to add from file.</p>\n\n<p>Question answered by DanL below:</p>\n\n<pre><code>myPres.slides.InsertFromFile \"C:\\Users\\\" &amp; uName &amp; \"\\productslide.pptx\", myPres.slides.Count\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446068328, "post_id": 33402005, "comment_id": 54595372, "body": "Do you need formatting? If not, just set one range to another."}, {"owner": {"reputation": 26, "user_id": 4366659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d5fe690dc1c76b020cdfb062554542?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan", "link": "https://stackoverflow.com/users/4366659/morgan"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446068405, "post_id": 33402005, "comment_id": 54595406, "body": "I&#39;m not sure what you mean, formatting isn&#39;t the issue. I&#39;m working in two separate workbooks, and the logic piece needs to work, or else this project is a bust."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1446068475, "post_id": 33402005, "comment_id": 54595447, "body": "This makes my brain hurt...so many loops, if you have a lot of data it is going to take forever.  But on the line you get the error change<code>activesheet</code> to <code>activecell</code>.   Then do some research on finding the last row with data and how not to use select.  These two items will greatly speed up your code and make it more robust."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446068558, "post_id": 33402005, "comment_id": 54595499, "body": "Copy/paste is very slow and... ugly. If you don&#39;t need formatting, you don&#39;t need to copy/paste which means you won&#39;t have the problem you have now."}, {"owner": {"reputation": 26, "user_id": 4366659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d5fe690dc1c76b020cdfb062554542?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan", "link": "https://stackoverflow.com/users/4366659/morgan"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446068772, "post_id": 33402005, "comment_id": 54595619, "body": "@ScottCraner I have tried using activecell, and it doesn&#39;t seem to work. Also, I will not be the only person importing data. It is to roll information to one central location. No more than 100 entries at a time. And the last cell will always be fluctuating."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446068848, "post_id": 33402005, "comment_id": 54595658, "body": "When Scott says last row, he means to use a variable which can handle fluctuations."}, {"owner": {"reputation": 26, "user_id": 4366659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d5fe690dc1c76b020cdfb062554542?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan", "link": "https://stackoverflow.com/users/4366659/morgan"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446068910, "post_id": 33402005, "comment_id": 54595692, "body": "@findwindow what is the non-copy/paste alternative? And how can I ensure its the first blank row, without loops? Sorry... This is my first project."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446068941, "post_id": 33402005, "comment_id": 54595715, "body": "As I said, you <code>set</code> one range to another. Edit: Scott&#39;s better than I. I will let him help you =P"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446069019, "post_id": 33402005, "comment_id": 54595755, "body": "see <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">this</a> for how to find the last row in a range of values."}, {"owner": {"reputation": 26, "user_id": 4366659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d5fe690dc1c76b020cdfb062554542?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan", "link": "https://stackoverflow.com/users/4366659/morgan"}, "edited": false, "score": 0, "creation_date": 1446069057, "post_id": 33402005, "comment_id": 54595776, "body": "Okay, I will try that. Thank for the help."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446069075, "post_id": 33402005, "comment_id": 54595785, "body": "see <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this</a> on how to avoid using select."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446069255, "post_id": 33402005, "comment_id": 54595883, "body": "In your first sub are you trying to get all data starting at A11 down and to column M?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446069426, "post_id": 33402005, "comment_id": 54595983, "body": "If that is the case I could do the whole select in one line <code>worksheets(&quot;Page 3&quot;).Range(&quot;A11&quot;).End(xldown).resize(,13).copy</code>"}, {"owner": {"reputation": 26, "user_id": 4366659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d5fe690dc1c76b020cdfb062554542?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan", "link": "https://stackoverflow.com/users/4366659/morgan"}, "edited": false, "score": 0, "creation_date": 1446069588, "post_id": 33402005, "comment_id": 54596064, "body": "Yes, that&#39;s what I&#39;m trying to achieve in that sub, as that&#39;s where the form begins. You two are rockstars, I will have lots of ideas to work on tomorrow. Thank you so much!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446069695, "post_id": 33402005, "comment_id": 54596129, "body": "Try to do what has been pointed out and simplify the code some, then come back if you have problems."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1446070163, "post_id": 33402005, "comment_id": 54596334, "body": "<code>Selection.EntireRow.Delete Shift:=xlUp</code> ..could be the issue, once you delete something, you would have nothing copied anymore."}], "answers": [{"tags": [], "owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1446071471, "creation_date": 1446071471, "answer_id": 33402709, "question_id": 33402005, "link": "https://stackoverflow.com/questions/33402005/paste-works-in-if-portion-of-statement-but-not-else/33402709#33402709", "title": ".Paste works in &#39;If&#39; portion of statement, but not &#39;Else&#39;", "body": "<p>Here are some tips to avoid getting stuck in such moments.</p>\n\n<ol>\n<li><p>Always try to emulate what macro does by manually performing all the actions, wherever it is possible to. In your case you can choose 2 identifiers for QA - one which is not present and another which is present. You won't have any trouble with the first one, but with the second - as soon as you delete any cell content after you have copied some range, your selection and copied range would be lost from clipboard. And that's actually what makes a trouble.</p></li>\n<li><p>Do proper debugging. As soon as you go into strange exception - debug what brought your code to this point. And again - in your case you can see that as soon as you delete contents the \"dashed border\" around copied range will disappear, meaning you have no copied range anymore which you could paste.</p></li>\n<li><p>This one goes directly to copy-paste combination. Whenever you are in need to use Copy &amp; Paste build up your code so that these two go one after another. Avoid any range interaction between these two functions. If you need to do some calculations just save the range parameters(like range rectangle dimensions, starting row+column, ending row+column) to other variables and Copy only when you've done with everything using those saved parameters.</p></li>\n</ol>\n\n<p>Good luck with this one.</p>\n"}], "owner": {"reputation": 26, "user_id": 4366659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d5fe690dc1c76b020cdfb062554542?s=128&d=identicon&r=PG&f=1", "display_name": "Morgan", "link": "https://stackoverflow.com/users/4366659/morgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446071471, "creation_date": 1446068107, "last_edit_date": 1446069609, "question_id": 33402005, "link": "https://stackoverflow.com/questions/33402005/paste-works-in-if-portion-of-statement-but-not-else", "title": ".Paste works in &#39;If&#39; portion of statement, but not &#39;Else&#39;", "body": "<p>I'm automating a process to import data from a worksheet, though for data integrity (and to eventually append to a database), I do not want the identifier entered twice. My code works to import the data if the identifier (SHC_No) is not in column A, and to prompt if you would like to replace the entries because something has changed. It will delete the entries, and find the next blank row, but the .paste function will not operate. (Even though it is on the cell I want to paste into and I can see the data in the clipboard.)</p>\n\n<p>I have gotten Run Time Error 1004 \"Paste method of worksheet class failed,\" and \"PasteSpecial Method of Range class failed,\" as well as 438 \"Object doesn't support this property or method.\"</p>\n\n<p>I'm relatively new to Excel VBA. I have tried different variations of .paste and .pastespecial and nothing seems to work. I have tried With statements, and defining the range. I'm at a loss.</p>\n\n<p>Any ideas or suggestions, would be greatly appreciated.</p>\n\n<pre><code>Sub ImportAPDR()\n\nDim wbImport As Workbook\nDim wbCurrent As Workbook\nDim strSHC As String\n\nSet wbImport = Workbooks(\"ImportPhase2.xlsm\") 'Ensure name of the workbook... and don't change it.\nSet wbCurrent = ActiveWorkbook\n\n'On Error GoTo Handler:\nApplication.ScreenUpdating = False 'Prevents flickering screen.\n\n'Activate Page 3 of the APDR\n\nWorksheets(\"Page 3\").Activate\n\nstrSHC = Range(\"A11\").Value\n\nRange(\"A11\").Activate\n\nDo\n\n    If ActiveCell.Value = \"\" Then Exit Do\n    ActiveCell.Offset(1, 0).Activate\n\nLoop\n\n'Selects All data from A11 until the EOR\nActiveCell.Offset(-1, 12).Activate\nRange(\"A11\", ActiveCell).Select\n\nSelection.Copy\n\n'Find the first blank cell in the Import workbook.\n\nwbImport.Activate\nWorksheets(\"Import\").Activate\n\nFindSHC (strSHC) 'Must send a variable or the other subroutine will not work.\nApplication.ScreenUpdating = True\n\nExit Sub\n\n'Handler:\n'MsgBox (\"Ensure to run the macro on the APDR workbook, not the import workbook.\")\n\nEnd Sub\n\nSub FindSHC(strSHC As String)\n\n    Dim foundSHC As String\n    Dim Rng As Range\n    Dim StartRange As Range\n    Dim PasteRng As Range\n\n    FindString = strSHC\n    If Trim(strSHC) &lt;&gt; \"\" Then\n        With Sheets(\"Import\").Range(\"A:A\")\n            Set Rng = .Find(What:=FindString, _\n                            After:=.Cells(.Cells.Count), _\n                            LookIn:=xlValues, _\n                            LookAt:=xlWhole, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlNext, _\n                            MatchCase:=False)\n            If Rng Is Nothing Then\n                Range(\"A1\").Activate\n                Do\n                    If ActiveCell.Value = \"\" Then Exit Do\n                    ActiveCell.Offset(1, 0).Activate\n                Loop\n                ActiveSheet.Paste\n                Application.CutCopyMode = False\n                MsgBox (\"The Tenant/Unit Details have been copied for import.\")\n            Else\n                Application.Goto Rng, True\n                Set StartRange = ActiveCell\n                Answer = MsgBox(\"This APDR looks like it has already been imported.\" &amp; vbNewLine &amp; \"Do you want to reimport and replace?\", vbYesNo)\n                If Answer = vbYes Then\n                    'Finds the values that have previously been entered and loops to select them all for deletion.\n                    Do\n\n                        If ActiveCell.Value &lt;&gt; strSHC Then Exit Do\n                        ActiveCell.Offset(1, 0).Activate\n\n                    Loop\n\n                    ActiveCell.Offset(-1, 0).Activate\n                    Range(StartRange, ActiveCell).Select\n                    Selection.EntireRow.Delete Shift:=xlUp\n\n                    'Find the next open row\n                    Range(\"A1\").Activate\n\n                    Do\n\n                        If ActiveCell.Value = \"\" Then Exit Do\n                        ActiveCell.Offset(1, 0).Activate\n\n                    Loop\n\n                    ActiveSheet.Paste    '&lt;-----This is where I get my error.\n                    Application.CutCopyMode = False\n                    MsgBox (\"The Tenant/Unit Details have been replaced.\")\n                Else\n                    Application.CutCopyMode = False\n                    MsgBox (\"Import has been cancelled.\")\n                End If\n            End If\n        End With\n    End If\n\nEnd Sub    \n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5175169, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d4a089f2685bf73c762344a499b71c94?s=128&d=identicon&r=PG", "display_name": "Don Ritchie", "link": "https://stackoverflow.com/users/5175169/don-ritchie"}, "edited": false, "score": 0, "creation_date": 1446127288, "post_id": 33405077, "comment_id": 54622309, "body": "Thanks for the reply.  I think I sort of understand your idea, but there has to be a simpler way.  I was thinking of using the following code to find the current week&#39;s Saturday:      <code>Dim TDate As Date     Dim TDay As Integer     Dim SatFinder As Integer     Dim SatDate As Date                      TDate = Date     TDay = Weekday(TDate)     SatDate = TDate - SatFinder</code>  But is there a function to find the current week number?  Ex. If this is the 41st week of the year, how would I find the Saturday from the 40th week of last year?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 59, "user_id": 5175169, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d4a089f2685bf73c762344a499b71c94?s=128&d=identicon&r=PG", "display_name": "Don Ritchie", "link": "https://stackoverflow.com/users/5175169/don-ritchie"}, "edited": false, "score": 0, "creation_date": 1446145637, "post_id": 33405077, "comment_id": 54634548, "body": "My answer outputs a date range to a table but you can easily remove any need for table and pass all dates of range to a VBA array or collection. To obtain week number use <a href=\"http://www.techonthenet.com/access/functions/date/datepart.php\" rel=\"nofollow noreferrer\">DatePart()</a> function, specifying <code>ww</code> argument."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1446086584, "creation_date": 1446086584, "answer_id": 33405077, "question_id": 33401836, "link": "https://stackoverflow.com/questions/33401836/sales-year-to-date-from-end-of-previous-week-and-for-last-year/33405077#33405077", "title": "Sales Year To Date From End Of Previous Week AND For Last Year", "body": "<p>Consider using a temporary table such as a <code>YTDDates</code> of two fields (<code>ID</code>, <code>SalesDate</code>) that holds the date range which can be cleaned out per needed use. Then join your sales data to this table for daily reporting.</p>\n\n<p>VBA can run a loop through all days from beginning (1/1/2015) to end (10/24/2015) and iteratively append to temp table using the <code>DateAdd()</code> function.</p>\n\n<pre><code>Dim db As Database\nDim startDate As Date, endDate As Date, d As Date\nDim diff As Integer, i as Integer\n\nSet db = CurrentDb()\n\nstartDate = #1/1/2015#\nendDate = #10/24/2015#    \ndiff = DateDiff(\"d\", startDate, endDate)\n\n' CLEAN OUT PRIOR DATE RECORDS\ndb.Execute \"DELETE FROM YTDDates\", dbFailOnError\n\nFor i = 0 To diff\n\n    d = DateAdd(\"d\", i, startDate)\n    db.Execute \"INSERT INTO YTDDates ([SalesDate]) VALUES (#\" &amp; d &amp; \"#);\", dbFailOnError\n\nNext i\n\nSet db = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "is_accepted": false, "score": 0, "last_activity_date": 1446145596, "creation_date": 1446145596, "answer_id": 33422621, "question_id": 33401836, "link": "https://stackoverflow.com/questions/33401836/sales-year-to-date-from-end-of-previous-week-and-for-last-year/33422621#33422621", "title": "Sales Year To Date From End Of Previous Week AND For Last Year", "body": "<p>Instead of a temp table I would just use a formula in your query using a BETWEEN clause on your date field with a formula like this:</p>\n\n<pre><code>vba.DateSerial(Year(Now()),Month(Now()),Day(Now())-Weekday(Now(),vbSunday))\n</code></pre>\n\n<p>The Weekday function returns an integer from Sunday (vbSunday).  So on a Monday it will return '2' and on Saturday it will return '7' which will give you the previous week's Saturday date.</p>\n\n<p>For getting the beginning of the year date you could use a function like this:</p>\n\n<pre><code>vba.DateSerial(Year(Now()),1,1)\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5175169, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d4a089f2685bf73c762344a499b71c94?s=128&d=identicon&r=PG", "display_name": "Don Ritchie", "link": "https://stackoverflow.com/users/5175169/don-ritchie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446145596, "creation_date": 1446067362, "question_id": 33401836, "link": "https://stackoverflow.com/questions/33401836/sales-year-to-date-from-end-of-previous-week-and-for-last-year", "title": "Sales Year To Date From End Of Previous Week AND For Last Year", "body": "<p>I am trying to write a query in Access to poll year to date sales records to build a report.  I think I need to write a VBA module to calculate these dates.</p>\n\n<p>I need a date range for Year to Date from Last Saturday (ex. from 1/1/2015 to 10/24/2015 for this week's report).  I also need to poll the records from Last Year To Date (ex. from 1/1/2014 to 10/25/2014 for this week's report).</p>\n\n<p>Any suggestions on how I can query this date range?  </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "email", "hyperlink"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1446066946, "post_id": 33401269, "comment_id": 54594712, "body": "Have you tried using a more differentiated name?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1446068169, "post_id": 33401269, "comment_id": 54595294, "body": "Your Replace calls don&#39;t make sense. What is <code>Replace(pic, &quot; &quot;, &quot; &quot;, &quot;520&quot;)</code> supposed to do?"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1446075672, "post_id": 33401269, "comment_id": 54598464, "body": "Is it possible that <code>Screener.SubsidyBox = False</code> ?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1446083825, "post_id": 33401269, "comment_id": 54600828, "body": "You should make a more generic body with special tags to replace depending on your control values in the <code>Screener</code>. The email attachments should also act differently according these control values."}, {"owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1446126706, "post_id": 33401269, "comment_id": 54621810, "body": "@Andre451, Frankly, I don&#39;t quite understand the Replace calls either, but if they aren&#39;t there, it doesn&#39;t work?"}, {"owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1446126831, "post_id": 33401269, "comment_id": 54621925, "body": "@LiamH - I checked the Screener and it is True"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1446128359, "post_id": 33401269, "comment_id": 54623219, "body": "I agree it doesn&#39;t make sense but just so you know your replace appears to be replacing spaces with spaces starting from the 520th character of you <code>pic</code> string."}, {"owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1446130749, "post_id": 33401269, "comment_id": 54624925, "body": "@LiamH I understand that, but, again, If i take it out, the pic doesn&#39;t show up at all..strange"}], "owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1446065748, "creation_date": 1446065034, "last_edit_date": 1446065748, "question_id": 33401269, "link": "https://stackoverflow.com/questions/33401269/trouble-adding-multiple-images-to-an-e-mail", "title": "Trouble adding multiple images to an e-mail", "body": "<p>I have an e-mail that is generated through Excel with VBA. This e-mail includes two embedded pictures in the body of the e-mail along with the separate hyperlinks to the videos they refer to. The problem is that it isn't recognizing the second picture and just embedding the same picture twice, however the hyperlinks are correct. Below is a sample of my code:</p>\n\n<pre><code>Private Sub SubmitBtn_Click()\nDim Source As Range\nDim Dest As Workbook\nDim wb As Workbook\nDim TempFilePath As String\nDim TempFileName As String\nDim FileExtStr As String\nDim FileFormatNum As Long\nDim OutApp As Object\nDim OutMail As Object\nDim MemNme As String, Email As String, UsrName As String, domainID As String, pic As String, pic2 As String\nDim Hlink As String, Hlink2 As String\nState = Screener.StateBox\n If State = \"California\" Then\n        If Screener.MktPlcBox = True Then\n            pic = \"websitewithpicture1\"\n            Hlink = \"videolink\"\n            count = 1\n        End If\n        If Screener.SubsidyBox = True Then\n            pic2 = \"websitewithpicture2\"\n            Hlink2 = \"videolink\"\n            count = 2\n        End If\nWith OutMail\n            .To = Email\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = \"Helpful Video\"\n            .HTMLBody = \"Dear \" &amp; MemNme &amp; \",&lt;br&gt;&lt;br&gt;\" _\n            &amp; vbNewLine &amp; vbNewLine &amp; \"Thank you for speaking with me today about your plan. You have a lot of choices, \" _\n            &amp; \" and &lt;b&gt;we appreciate you choosing company&lt;/b&gt;. Helping you understand your plan is important to us and I thought this video would be valuable to you.&lt;br&gt;&lt;br&gt;\" _\n            &amp; vbNewLine &amp; \"&lt;center&gt;&lt;a href=\" &amp; Hlink &amp; \"&lt;img src=cid:\" &amp; Replace(pic, \" \", \" \", \"520\") &amp; \" height =250 width=400&gt;&lt;/a&gt;\" _\n            &amp; \"&lt;a href=\" &amp; Hlink2 &amp; \"&lt;img src=cid:\" &amp; Replace(pic2, \" \", \" \", \"420\") &amp; \" height =250 width=400&gt;&lt;/a&gt;&lt;/center&gt;&lt;br&gt;\" _\n            &amp; vbNewLine &amp; vbNewLine &amp; \"You can always get additional information at &lt;b&gt;website.com&lt;/b&gt; or by calling the number on the back of your card.&lt;br&gt;&lt;br&gt;\" _\n            &amp; vbNewLine &amp; vbNewLine &amp; \"Thank you,&lt;br&gt;\" _\n\n\n &amp; vbNewLine &amp; UsrName \n\n        .Attachments.Add pic, olByValue, 0\n        .Attachments.Add pic2, olByValue, 0 &lt;--------It doesn't \"See\" this pic???\n'            MsgBox \"Press ok to create your e-mail\"\n        .Display  'or use .Send\n    End With\n    On Error GoTo 0\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nUnload Me\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "type-mismatch"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1446065924, "post_id": 33401179, "comment_id": 54594207, "body": "Please indicate in your question which line actually caused the error. Once you&#39;ve done that, it will be easier to isolate the exact expression which is causing the error."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1446067525, "post_id": 33401179, "comment_id": 54594971, "body": "I&#39;d say <code>b.Offset(0, 2).VALUE &lt;&gt; 0</code> is the only thing I really see, but the default option when not declared should be <code>.Value</code> so without more on which line is erroring..."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1446067653, "post_id": 33401179, "comment_id": 54595042, "body": "This is going to be tricky to diagnose because we also don&#39;t know if your error occurred while still in the b loop under <code>a = E3</code> or during the second b loop with <code>a = E4</code>..."}, {"owner": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "edited": false, "score": 0, "creation_date": 1446111260, "post_id": 33401179, "comment_id": 54611285, "body": "It occurs during the first loop, while still in E3...."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "is_accepted": false, "score": 0, "last_activity_date": 1446125580, "creation_date": 1446125580, "answer_id": 33415680, "question_id": 33401179, "link": "https://stackoverflow.com/questions/33401179/loop-to-find-value-matching-condition-produces-type-mismatch/33415680#33415680", "title": "loop to find value matching condition produces type mismatch", "body": "<p>the puzle is solved, code is below:</p>\n\n<pre><code>Sub find_sku2()\n\nDim a As Long, i As Long\nDim b As Long, j As Long\n\ni = Sheets(\"Output\").Range(\"E\" &amp; Rows.Count).End(xlUp).Row\nj = Sheets(\"SelectionOfSKU\").Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n\nFor a = 3 To i\n    For b = 1 To j\n            If Sheets(\"Output\").Cells(a, 2).Value = Sheets(\"SelectionOfSKU\").Cells(b, 6).Value And Sheets(\"SelectionOfSKU\").Cells(b, 8).Value &lt;&gt; 0 Then\n                Sheets(\"Output\").Cells(a, 5).Value = Sheets(\"SelectionOfSKU\").Cells(b, 2).Value\n            End If\n        Next\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446125580, "creation_date": 1446064706, "last_edit_date": 1446065767, "question_id": 33401179, "link": "https://stackoverflow.com/questions/33401179/loop-to-find-value-matching-condition-produces-type-mismatch", "title": "loop to find value matching condition produces type mismatch", "body": "<p>I'm trying to loop through a range looking if the value matches another value from different range, if it does it will input the value that matched. The loop worked once, inserted the matched value into \"E3\" and then produced \"type mismatch\" error. Is there a kind person who could advise why my code doesn't work? I'd appreciate that so much...  </p>\n\n<pre><code>Sub find_that()\n    ActiveWorkbook.Worksheets(\"Output\").Activate \n    For Each a In Worksheets(\"Output\").Range(\"E3:E28\")\n        For Each b In Worksheets(\"SelectionOfSKU\").Range(\"F3:F66\")\n            If a.Offset(0, -3).Value = b.Value And b.Offset(0, 2) &lt;&gt; 0 Then\n                a.Value = b.Offset(0, -4).Value 'If condition met, input the matched value\n            End If\n        Next b\n    Next a\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1446064264, "post_id": 33400948, "comment_id": 54593304, "body": "Do you know how to do it if you do reference the name directly? You don&#39;t need to know the workbook&#39;s name. I would add something like <code>If strFilename = activeworkbook.name Then </code> and then continue with your <code>Do While</code> loop, and place <code>End If</code> after <code>loop</code>."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1446064378, "post_id": 33401053, "comment_id": 54593366, "body": "Can you mix <code>while</code> and <code>until</code> in loops? Could he do something like <code>Do Until strFilename = &quot;&quot; and while strfilename &lt;&gt; ThisWorkbook.Name</code>?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1446064926, "post_id": 33401053, "comment_id": 54593648, "body": "ASAIK that is not possible, @BruceWayne"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1446065031, "last_edit_date": 1446065031, "creation_date": 1446064294, "answer_id": 33401053, "question_id": 33400948, "link": "https://stackoverflow.com/questions/33400948/open-all-files-in-same-folder-as-active-workbook-except-active-workbook/33401053#33401053", "title": "Open all files in same folder as active workbook EXCEPT active workbook", "body": "<p>Put an <code>If</code> block inside our loop</p>\n\n<pre><code>Do Until strFilename = \"\"\n\n   If strFilename &lt;&gt; wbDest.Name Then 'since you already set wbDest = ThisWorkbook\n\n      '... rest of code\n\n   End If\n\nLoop\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5476017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23b1c3f953e2ac2b7e922889c1a84131?s=128&d=identicon&r=PG&f=1", "display_name": "IMiller", "link": "https://stackoverflow.com/users/5476017/imiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2120, "favorite_count": 0, "accepted_answer_id": 33401053, "answer_count": 1, "score": 0, "last_activity_date": 1446065844, "creation_date": 1446063846, "last_edit_date": 1446065844, "question_id": 33400948, "link": "https://stackoverflow.com/questions/33400948/open-all-files-in-same-folder-as-active-workbook-except-active-workbook", "title": "Open all files in same folder as active workbook EXCEPT active workbook", "body": "<p>I am using a macro that opens each excel file in the same folder that the workbook containing the macro (I'll call it the master workbook) is in and copies all the data in the first spreadsheet, then pastes them into the master workbook on a new worksheet.  I found some very useful code online that I made a few changes to.  Everything seems to be working fine, except that while this code is opening each file in the folder (in the Do Until loop), it opens itself half way through.  </p>\n\n<p>I'd like to be able to avoid this without referencing the master spread sheet's name directly, in case someone renames it.  </p>\n\n<p>Is there a simple command that will make skip the remaining code in the loop if it tries to open itself?  </p>\n\n<p>Code is below:</p>\n\n<pre><code>Sub CombineWSs()\nDim wbDst As Workbook\nDim wbSrc As Workbook\nDim wsSrc As Worksheet\nDim MyPath As String\nDim strFilename As String\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nMyPath = ThisWorkbook.Path \nSet wbDst = ThisWorkbook\nstrFilename = Dir(MyPath &amp; \"\\*.xls\", vbNormal)\n\nIf Len(strFilename) = 0 Then Exit Sub\n\nDo Until strFilename = \"\"\n\n        Set wbSrc = Workbooks.Open(Filename:=MyPath &amp; \"\\\" &amp; strFilename)\n        Set wsSrc = wbSrc.Worksheets(1)\n\n        'copy the data\n        wbSrc.ActiveSheet.UsedRange.Select\n        Selection.Copy\n\n        'create a new worksheet in this master file\n        wbDst.Sheets.Add After:=Sheets(Sheets.Count)\n\n        'paste the data into master file's new sheet\n        wbDst.Sheets(wbDst.Worksheets.Count).Range(\"A1\").PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n\n        wbSrc.Close False\n\n    strFilename = Dir()\n\nLoop\nwbDst.Worksheets(1).Delete\n\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "edited": false, "score": 0, "creation_date": 1446135482, "post_id": 33400785, "comment_id": 54628387, "body": "I recreated your query and it worked for me, so the logic seems correct. Is there anything you&#39;re missing? Is cost_collector the same variable type for both undefined_execution and tbl_imbalances (text vs. memo for example)"}, {"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "reply_to_user": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "edited": false, "score": 0, "creation_date": 1446135602, "post_id": 33400785, "comment_id": 54628478, "body": "Thank you for confirming.  Yes it does work. I accidentally referred to a different imbalances table."}], "owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594643335, "creation_date": 1446063315, "last_edit_date": 1594643335, "question_id": 33400785, "link": "https://stackoverflow.com/questions/33400785/delete-a-record-from-a-table-that-doesnt-exist-in-another", "title": "Delete a record from a table that doesn&#39;t exist in another", "body": "<p>I have tbl_Imbalances that I would like to \"synchronize\" with a query of same records called UNDEFINED_EXECUTION.  I want to make sure 3 fields match to qualify i.e funds_center, SAG, MDEP, COST_COLLECTOR.  But I can't seem to get even one attempt to work. </p>\n\n<p>I've currently tried DELETE tbl_IMBALANCES* cost_collector from tbl_IMBALANCES Where cost_collector not in (select cost_collector from undefined_execution) it should delete one record since it doesn't exist in the \"undefined execution\" query but it doesn't delete anything.  </p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1446062629, "post_id": 33400464, "comment_id": 54592434, "body": "++ for not parsing HTML with Regex!"}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1446062968, "post_id": 33400464, "comment_id": 54592617, "body": "Appreciate it Mat - was tempted to use Regex lookarounds but fought the urge"}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 1, "creation_date": 1446063142, "post_id": 33400464, "comment_id": 54592729, "body": "What is the &quot;title&quot; text you want to extract from the example you sent?  I can&#39;t find the word &quot;title&quot; in that page."}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446063470, "post_id": 33400464, "comment_id": 54592904, "body": "&quot;User-operated amusement apparatus for kicking the user&#39;s buttocks&quot; - a watershed patent in the self-butt-kicking field."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446067565, "post_id": 33401136, "comment_id": 54594991, "body": "I had found that Google Patents pages would deny http get requests from Jsoup, but it hadn&#39;t even occurred to me to see if it would allow access by MSXML.  I will give it a try.  However, you should be aware that Google Patents has a few issues for consistent patent downloading: 1) Google&#39;s pdf documents are not updated for a Certificate of Correction or Reexamination Certificate, which can substantively affect the scope of a patent, especially the latter; 2) there are occasional unexplained gaps in Google&#39;s records; and 3) Google Patents lags behind USPTO in publication by a week or more."}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446068778, "post_id": 33401136, "comment_id": 54595621, "body": "Also, Google can give you a false sense that its pdf&#39;s are OCR&#39;ed - last I checked, if the document has 20+ pages containing recognizable text, it stops after the 20th.  So if you text search a patent PDF from Google, you may incorrectly conclude that your search string isn&#39;t there, in case it shows up somewhere farther down."}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446068877, "post_id": 33401136, "comment_id": 54595677, "body": "I only discovered these obscure tidbits about Google Patents through a year and a half of developing (Java and VBA) tools for use in my own practice =P"}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446068968, "post_id": 33401136, "comment_id": 54595728, "body": "Of course none of the above is legal advice and you should consult a patent attorney if you have any questions about your own rights."}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446069249, "post_id": 33401136, "comment_id": 54595875, "body": "Sorry I don&#39;t mean get requests but parsing methods; Google allows Jsoup to connect and download a patent document, but I couldn&#39;t manage to get at the html document (granted I am still a newbie programmer)."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "reply_to_user": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446072223, "post_id": 33401136, "comment_id": 54597166, "body": "Thanks for the extra info, @PatentWookiee.  I hadn&#39;t considered the broader issues with using Google Patents.  Was just trying to get you a title!  Good luck."}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446139132, "post_id": 33401136, "comment_id": 54630877, "body": "Those are only the negatives - Google patents has a lot of pluses too, including the one you discovered about a dedicated title HTML element, In addition to a lot of cross-linking and status info contained in the HTML"}], "tags": [], "owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "is_accepted": false, "score": 1, "last_activity_date": 1446065384, "last_edit_date": 1446065384, "creation_date": 1446064572, "answer_id": 33401136, "question_id": 33400464, "link": "https://stackoverflow.com/questions/33400464/how-to-find-extract-an-html-font-element-with-attribute-size-1-using-excel/33401136#33401136", "title": "How to find/extract an HTML &quot;font&quot; element with attribute size=&quot;+1&quot; using Excel VBA", "body": "<p>This answer is somewhat incomplete because my Excel won't do these lines:</p>\n\n<pre><code>Dim xml_obj As XMLHTTP60\nSet xml_obj = CreateObject(\"MSXML2.XMLHTTP\")\n</code></pre>\n\n<p>But I think this might be a preferred approach.</p>\n\n<p>Instead of using USPTO's site, what about using Google's?</p>\n\n<p>Hit this URL: <a href=\"http://www.google.com/patents/US6293874\" rel=\"nofollow\">http://www.google.com/patents/US6293874</a></p>\n\n<p>Note that the patent number is apparent in that URL.</p>\n\n<p>Then, in your function, just pull that tag named <code>invention-title</code>.</p>\n\n<pre><code>Set titleElement = html_doc.getElementsByTagName(\"invention-title\").Item(0)\ntitle = titleElement.innerText\nMsgBox(title)\n</code></pre>\n\n<p>If you check the source on that page, there's only one of those.</p>\n\n<p>If you're open to this alternative approach, it would be relatively easy to parse patent numbers from the URLs you have, and I think the extraction of <code>invention-title</code> would be much more reliable.</p>\n"}, {"tags": [], "owner": {"reputation": 3265, "user_id": 4338570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HzhLM.png?s=128&g=1", "display_name": "Sean Wessell", "link": "https://stackoverflow.com/users/4338570/sean-wessell"}, "is_accepted": true, "score": 1, "last_activity_date": 1446065182, "creation_date": 1446065182, "answer_id": 33401312, "question_id": 33400464, "link": "https://stackoverflow.com/questions/33400464/how-to-find-extract-an-html-font-element-with-attribute-size-1-using-excel/33401312#33401312", "title": "How to find/extract an HTML &quot;font&quot; element with attribute size=&quot;+1&quot; using Excel VBA", "body": "<p>You can try this. As long as its the first font tag with the size attribute and a value of \"+1\" this should work. I only tested with 3 different pages but they all returned the correct results.</p>\n\n<pre><code>Function Test_UpdateTitle(url)\n    title = \"Title Not Found!\"\n    Set xml_obj = CreateObject(\"MSXML2.XMLHTTP\")\n    xml_obj.Open \"GET\", url, False\n    xml_obj.send\n    pageSource = xml_obj.responseText\n    Set xml_obj = Nothing\n\n    Set document = CreateObject(\"HTMLFile\")\n    document.write pageSource   \n\n    For i = 0 To document.getElementsByTagName(\"font\").length - 1\n        If document.getElementsByTagName(\"font\")(i).size = \"+1\" Then\n            title = document.getElementsByTagName(\"font\")(i).innerText\n            Exit For\n        End If\n    Next\n\n    Test_UpdateTitle = title\n\nEnd Function\n\nMsgBox Test_UpdateTitle(\"http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO1&amp;Sect2=HITOFF&amp;d=PALL&amp;p=1&amp;u=%2Fnetahtml%2FPTO%2Fsrchnum.htm&amp;r=1&amp;f=G&amp;l=50&amp;s1=6293874.PN.&amp;OS=PN/6293874&amp;RS=PN/6293874\")\nMsgBox Test_UpdateTitle(\"http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;p=1&amp;u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&amp;r=1&amp;f=G&amp;l=50&amp;co1=AND&amp;d=PTXT&amp;s1=fight.TI.&amp;OS=TTL/fight&amp;RS=TTL/fight\")\nMsgBox Test_UpdateTitle(\"http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=14&amp;f=G&amp;l=50&amp;d=PTXT&amp;p=1&amp;S1=search&amp;OS=search&amp;RS=search\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446069463, "post_id": 33401394, "comment_id": 54596010, "body": "I like the contribution of checking the HTTP status - I only picked Sean Wessell&#39;s answer because it addresses how to get at the &quot;size&quot; attribute.  Also, as I noted above, my &quot;InStr(strInnerText, &quot; **&quot;) = 0&quot; seems not to match the html element  &lt;b&gt; **&lt;/b&gt; .  I was not sure why, but could it be treating asterisk as a wildcard?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "reply_to_user": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446086837, "post_id": 33401394, "comment_id": 54601554, "body": "Not a problem. He replied first :) Also we are getting the size in two different ways: strSize = oFontTag.getAttributeNode(&quot;size&quot;).Value."}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "edited": false, "score": 0, "creation_date": 1446139001, "post_id": 33401394, "comment_id": 54630793, "body": "Oh somehow I missed that you were also getting the size"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "is_accepted": false, "score": 1, "last_activity_date": 1446065493, "creation_date": 1446065493, "answer_id": 33401394, "question_id": 33400464, "link": "https://stackoverflow.com/questions/33400464/how-to-find-extract-an-html-font-element-with-attribute-size-1-using-excel/33401394#33401394", "title": "How to find/extract an HTML &quot;font&quot; element with attribute size=&quot;+1&quot; using Excel VBA", "body": "<p>See if this answer is working as intended. Make sure you have references to the following libraries in your workbook:</p>\n\n<p>Microsoft XML, v6.0\nMicrosoft HTML Object Library</p>\n\n<p><a href=\"https://i.stack.imgur.com/3bcn4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3bcn4.png\" alt=\"Libraries used\"></a></p>\n\n<p>If you are not sure how to add these to Excel just give a read to this link <a href=\"http://excel-macro.tutorialhorizon.com/vba-excel-reference-libraries-in-excel-workbook/\" rel=\"nofollow noreferrer\">Link to reference adding</a></p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    Debug.Print Test_UpdateTitle(\"http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO1&amp;Sect2=HITOFF&amp;d=PALL&amp;p=1&amp;u=%2Fnetahtml%2FPTO%2Fsrchnum.htm&amp;r=1&amp;f=G&amp;l=50&amp;s1=6293874.PN.&amp;OS=PN/6293874&amp;RS=PN/6293874\")\n\nEnd Sub\n\nFunction Test_UpdateTitle(ByVal strURL As String) As String\n\n\n    Dim oHTTP As MSXML2.XMLHTTP60\n    Dim oDoc As MSHTML.HTMLDocument\n    Dim oFontTags As Variant\n    Dim oFontTag As HTMLFontElement\n    Dim strInnerText As String\n    Dim strSize As String\n\n    ' Create the http object and send it.\n    Set oHTTP = New MSXML2.XMLHTTP60\n    oHTTP.Open \"GET\", strURL, False\n    oHTTP.send\n\n\n    ' Make sure that get the a reponse back\n    If oHTTP.Status = 200 Then\n\n        Set oDoc = New HTMLDocument\n        oDoc.body.innerHTML = oHTTP.responseText\n\n        Set oFontTags = oDoc.getElementsByTagName(\"font\")\n\n        ' Go through all the tags.\n        For Each oFontTag In oFontTags\n\n            'Get the inner text and size of each tag.\n            strInnerText = oFontTag.innerText\n            strSize = oFontTag.getAttributeNode(\"size\").Value\n\n                        'Compare to make sure you have what's needed\n            If InStr(strInnertText, \"Please see\") = 0 And _\n               InStr(strInnertText, \"( Certificate of Correction )\") = 0 And _\n               InStr(strInnertText, \"( Reexamination Certificate )\") = 0 And _\n               InStr(strInnertText, \" **\") = 0 Then\n\n                If strSize = \"+1\" Then\n                    Test_UpdateTitle = strInnerText\n                    Exit Function\n                End If\n            End If\n        Next oFontTag\n    End If\n\nEnd Function\n</code></pre>\n\n<p>I hope this helps. :)</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530372843, "last_edit_date": 1592644375, "creation_date": 1530372843, "answer_id": 51116258, "question_id": 33400464, "link": "https://stackoverflow.com/questions/33400464/how-to-find-extract-an-html-font-element-with-attribute-size-1-using-excel/51116258#51116258", "title": "How to find/extract an HTML &quot;font&quot; element with attribute size=&quot;+1&quot; using Excel VBA", "body": "<p>In short:</p>\n<pre><code>Debug.Print html_doc.querySelector(&quot;font[size=+1]&quot;).innerText\n</code></pre>\n<hr />\n<h1>tl;dr;</h1>\n<p><strong>\u2460 CSS selector:</strong></p>\n<p>No need for any of the long winded methods. You have stated the styling pattern. Use a CSS selector to grab it.</p>\n<pre><code>font[size=+1]\n</code></pre>\n<p>The reads as <code>font</code> tag with attribute <code>size</code> who value is <code>+1</code>. You may need <code>font[size='+1']</code> when using VBA to try both.</p>\n<hr />\n<p><strong>\u2461 CSS query:</strong></p>\n<p><a href=\"https://i.stack.imgur.com/3INH2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3INH2.png\" alt=\"CSS query\" /></a></p>\n<hr />\n<p><strong>\u2462 VBA:</strong></p>\n<p>As it is the first match you want you can use the <code>querySelector</code> method of <code>document</code> to apply the selector and retrieve a single element.</p>\n<pre><code> html_doc.querySelector(&quot;font[size=+1]&quot;)\n</code></pre>\n<p>You may need to add a reference to <code>HTML Object Library</code> and use an early bound call of <code>Dim html_doc As HTMLDocument</code> to access the method. The late bound method may expose the <code>querySelector</code> method but if the interface doesn't then use early binding.</p>\n"}], "owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 1, "accepted_answer_id": 33401312, "answer_count": 4, "score": 5, "last_activity_date": 1530372843, "creation_date": 1446062193, "last_edit_date": 1446064340, "question_id": 33400464, "link": "https://stackoverflow.com/questions/33400464/how-to-find-extract-an-html-font-element-with-attribute-size-1-using-excel", "title": "How to find/extract an HTML &quot;font&quot; element with attribute size=&quot;+1&quot; using Excel VBA", "body": "<p>I want to extract a U.S. Patent title from a url like </p>\n\n<p><a href=\"http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO1&amp;Sect2=HITOFF&amp;d=PALL&amp;p=1&amp;u=%2Fnetahtml%2FPTO%2Fsrchnum.htm&amp;r=1&amp;f=G&amp;l=50&amp;s1=6293874.PN.&amp;OS=PN/6293874&amp;RS=PN/6293874\" rel=\"nofollow\">http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO1&amp;Sect2=HITOFF&amp;d=PALL&amp;p=1&amp;u=%2Fnetahtml%2FPTO%2Fsrchnum.htm&amp;r=1&amp;f=G&amp;l=50&amp;s1=6293874.PN.&amp;OS=PN/6293874&amp;RS=PN/6293874</a></p>\n\n<p>(Update: as pointed out the comments, the patent title is not labeled \"Title;\" however, it consistently appears by itself above \"Abstract\" on the web page.) In most cases it is in the 7th child element of \"body\" or the 3rd \"font\" element in the document, but occasionally a notice at the top of the page to \"** Please see images for: ( Certificate of Correction ) **\" or \"( Reexamination Certificate )\" messes up both methods of extraction by inserting one additional child of \"body\" and three additional \"font\" elements before you get to the title.  </p>\n\n<p>However, the title seems to be consistently the first \"font\" element with the attribute \"size\" having a value of \"+1\".  Unfortunately other elements have size=\"-1\", including the aforementioned elements that are not always present, so it has to be specifically with that attribute and value.  I have searched but can't figure out how to get elements by attribute and value.  Here is my code:</p>\n\n<pre><code>Function Test_UpdateTitle(url As String)\n    Dim title As String\n    Dim pageSource As String\n    Dim xml_obj As XMLHTTP60\n    Set xml_obj = CreateObject(\"MSXML2.XMLHTTP\")\n    xml_obj.Open \"GET\", url, False\n    xml_obj.send\n    pageSource = xml_obj.responseText\n    Set xml_obj = Nothing\n\n    Dim html_doc As HTMLDocument\n    Set html_doc = CreateObject(\"HTMLFile\")\n    html_doc.body.innerHTML = pageSource\n    Dim fontElement As IHTMLElement\n\n'Methods 1 and 2 fail in cases of a certificate of correction or reexamination certificate\n\n'Method 1\n\n'    Dim body As IHTMLElement\n'    Set body = html_doc.getElementsByTagName(\"body\").Item(0)\n'    Set fontElement = body.Children(6)\n\n'Method 2\n'    Set fontElement = html_doc.getElementsByTagName(\"font\").Item(3)\n\n'Method 3\n\n    Dim n As Integer\n    For n = 3 To html_doc.getElementsByTagName(\"font\").Length - 1\n        Set fontElement = html_doc.getElementsByTagName(\"font\").Item(n)\n        If InStr(fontElement.innerText, \"Please see\") = 0 And _\n        InStr(fontElement.innerText, \"( Certificate of Correction )\") = 0 And _\n        InStr(fontElement.innerText, \"( Reexamination Certificate )\") = 0 And _\n        InStr(fontElement.innerText, \" **\") = 0 Then\n            Test_UpdateTitle = fontElement.innerText\n            Exit Function\n        End If\n    Next n\n\nEnd Function\n</code></pre>\n\n<p>I should add that the \" **\" is not working to skip the the last element <code>&lt;b&gt; **&lt;/b&gt;</code> and I am getting \" **\" as the title where there is a notice to please see images.  Is asterisk a wildcard character in this context? </p>\n"}, {"tags": ["forms", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 212961, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fae615d8b81dac44da16d98caa073c39?s=128&d=identicon&r=PG", "display_name": "Thorbj&#248;rn Reimann-Andersen", "link": "https://stackoverflow.com/users/212961/thorbj%c3%b8rn-reimann-andersen"}, "edited": false, "score": 0, "creation_date": 1446065226, "post_id": 33400430, "comment_id": 54593822, "body": "Thanks a lot! It was a FILLIN. I didn&#39;t even know about these."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 103, "user_id": 212961, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fae615d8b81dac44da16d98caa073c39?s=128&d=identicon&r=PG", "display_name": "Thorbj&#248;rn Reimann-Andersen", "link": "https://stackoverflow.com/users/212961/thorbj%c3%b8rn-reimann-andersen"}, "edited": false, "score": 0, "creation_date": 1446073041, "post_id": 33400430, "comment_id": 54597483, "body": "Interesting, then, that you didn&#39;t see your input in the document... Yeah, these were (are) the simple way for useres to create &quot;forms&quot; and pre-date form fields and VBA (i.e. been around for over 20 years)."}, {"owner": {"reputation": 103, "user_id": 212961, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fae615d8b81dac44da16d98caa073c39?s=128&d=identicon&r=PG", "display_name": "Thorbj&#248;rn Reimann-Andersen", "link": "https://stackoverflow.com/users/212961/thorbj%c3%b8rn-reimann-andersen"}, "edited": false, "score": 0, "creation_date": 1446149612, "post_id": 33400430, "comment_id": 54636749, "body": "I think it is because that particular place might be overwritten at some later point in the code. But thanks a lot for the help!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1446062112, "creation_date": 1446062112, "answer_id": 33400430, "question_id": 33400164, "link": "https://stackoverflow.com/questions/33400164/visual-basic-in-word-extra-form-appearing-before-start-of-main-form/33400430#33400430", "title": "Visual Basic in Word - Extra form appearing before start of main form", "body": "<p>I'm going out on a limb here and guessing it's an ASK or FILLIN field in the document (probably ASK since you're not seeing the result in the document).</p>\n\n<p>Press Alt+F9 to toggle on the field code display then, if you don't see { ASK [other stuff here ] } immediately you can do a Find on: ^d ASK </p>\n\n<p>ASK writes the user input to a bookmark which can then be used (referenced) elsewhere on by the object model. You should be able to simply delete the field and request the input in your form. But do watch out for REF fields referencing the bookmark information. Ctrl+A, F9 (update all the fields in the main story) should show up an ERROR! if the field (and its bookmark) are deleted.</p>\n\n<p>If it's not one of these fields then it could be something popping up from another add-in. But if that's the case you'd see it with other documents, as well...</p>\n"}], "owner": {"reputation": 103, "user_id": 212961, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fae615d8b81dac44da16d98caa073c39?s=128&d=identicon&r=PG", "display_name": "Thorbj&#248;rn Reimann-Andersen", "link": "https://stackoverflow.com/users/212961/thorbj%c3%b8rn-reimann-andersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 33400430, "answer_count": 1, "score": 0, "last_activity_date": 1459760076, "creation_date": 1446061253, "last_edit_date": 1459760076, "question_id": 33400164, "link": "https://stackoverflow.com/questions/33400164/visual-basic-in-word-extra-form-appearing-before-start-of-main-form", "title": "Visual Basic in Word - Extra form appearing before start of main form", "body": "<p>I have taken over development of a tool that helps our company fill out standardized contracts. It is a Visual Basic form in Word.</p>\n\n<p>There is one very small issue left, but it is annoying.\nSo we have a form that starts when a new document created from the template and this works just fine, however before the form is presented to the user, another form(at least that's what it looks like) appears. It have a text input field and an OK and a Cancel button. The title of the window is <strong>Referencenumber</strong>. </p>\n\n<p>I have searched all the code for this title and can not find it. It also doesn't matter what you put in the input field, it is not put in the final document. And it also doesn't matter whether you press OK or Cancel.</p>\n\n<p>Could you help figure what it is or how I can remove it?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1446061864, "creation_date": 1446061864, "answer_id": 33400355, "question_id": 33400100, "link": "https://stackoverflow.com/questions/33400100/formatting-an-excel-text-field-from-access/33400355#33400355", "title": "Formatting an Excel text field from Access", "body": "<p>If you want to do it in Excel, before importing to Access with VBA, you can use this formula to trim them.  Note: I'm assuming that each of your strings will have \"GMT\" at the end to denote the time zone, and will have a <code>,</code> after the day of the week.</p>\n\n<p>If <code>Saturday, November 28, 2015 11:59:59 PM GMT-5</code> is in A1, use this formula in B1:</p>\n\n<p><code>=TRIM(MID(A1,SEARCH(\", \",A1)+1,SEARCH(\"GMT\",A1)-SEARCH(\", \",A1)-2))</code></p>\n"}, {"tags": [], "owner": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "is_accepted": false, "score": 0, "last_activity_date": 1446136298, "creation_date": 1446136298, "answer_id": 33419796, "question_id": 33400100, "link": "https://stackoverflow.com/questions/33400100/formatting-an-excel-text-field-from-access/33419796#33419796", "title": "Formatting an Excel text field from Access", "body": "<p>Try using the Instr() function. Replace Find(\"GMT\") with</p>\n\n<pre><code>Instr(string:=ExcelWorksheet.Cells(1 + counter, nIdCol).Value, substring:=\"GMT\") - 1\n</code></pre>\n\n<p>More on the Instr() function: <a href=\"http://www.techonthenet.com/excel/formulas/instr.php\" rel=\"nofollow\">http://www.techonthenet.com/excel/formulas/instr.php</a></p>\n"}], "owner": {"reputation": 11, "user_id": 5499042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/452acee49da5ccba4c571285f8e85362?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/5499042/jorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1594651561, "creation_date": 1446061074, "last_edit_date": 1594651561, "question_id": 33400100, "link": "https://stackoverflow.com/questions/33400100/formatting-an-excel-text-field-from-access", "title": "Formatting an Excel text field from Access", "body": "<p>I have a string like \"Saturday, November 28, 2015 11:59:59 PM GMT-5\" in an Excel spreadsheet and would like to remove the Day of the week and Time Zone before importing it to Access using VBA. I tried : </p>\n\n<p>ExcelWorksheet.Cells(1 + counter, nIdCol) = left((ExcelWorksheet.Cells(1 + counter, nIdCol)), Find(\" GMT\", ExcelWorksheet.Cells(1 + counter, nIdCol) - 1)) \"</p>\n\n<p>but found that \"Find\" is not an Access function.  </p>\n\n<p>Any idea to do it?</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 352, "user_id": 4835627, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10153337036588783/picture?type=large", "display_name": "Austin Donley", "link": "https://stackoverflow.com/users/4835627/austin-donley"}, "edited": false, "score": 0, "creation_date": 1446059623, "post_id": 33399632, "comment_id": 54590725, "body": "No this is not what I need. I need the text added to the body of the message before it is sent out, so the user filling out the email can see it. I will update my question with another example."}, {"owner": {"reputation": 352, "user_id": 4835627, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10153337036588783/picture?type=large", "display_name": "Austin Donley", "link": "https://stackoverflow.com/users/4835627/austin-donley"}, "edited": false, "score": 0, "creation_date": 1446060630, "post_id": 33399632, "comment_id": 54591319, "body": "Thank you for the help. It might not be possible then the way I want to do it. Excel-VBA has &quot;worksheet_change&quot; event that triggers every time anything is altered; I wish outlook had the same."}, {"owner": {"reputation": 642, "user_id": 5454739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L7I5I.jpg?s=128&g=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/5454739/chase"}, "reply_to_user": {"reputation": 352, "user_id": 4835627, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10153337036588783/picture?type=large", "display_name": "Austin Donley", "link": "https://stackoverflow.com/users/4835627/austin-donley"}, "edited": false, "score": 0, "creation_date": 1446061036, "post_id": 33399632, "comment_id": 54591574, "body": "Yea, I&#39;ve had that request several times for outlook to behave more like other office apps... that&#39;s why Mail merge is still a word function.  ;-)  If someone comes up with a better idea, I&#39;ll delete my answer post."}], "tags": [], "owner": {"reputation": 642, "user_id": 5454739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L7I5I.jpg?s=128&g=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/5454739/chase"}, "is_accepted": false, "score": 0, "last_activity_date": 1446059967, "last_edit_date": 1446059967, "creation_date": 1446059548, "answer_id": 33399632, "question_id": 33399541, "link": "https://stackoverflow.com/questions/33399541/add-text-to-body-of-email-based-on-recipient-specified/33399632#33399632", "title": "Add text to body of email based on recipient specified", "body": "<p>If you're using MS Exchange, a Transport Rule will achieve this.  The only downside is it appends/replaces the text on the way out after send his hit so you wouldn't see the added text during message composition.  You can also define further filters so it only happens IF user A sends to user B to prevent the rule from firing for all outbound mail to user B.</p>\n\n<p>There are a lot of options a Transport Rule can achieve over Outlook Rules.</p>\n\n<p><a href=\"https://technet.microsoft.com/en-us/library/dn600437(v=exchg.150).aspx\" rel=\"nofollow\">https://technet.microsoft.com/en-us/library/dn600437(v=exchg.150).aspx</a></p>\n\n<p>This link shows how legal disclaimers can be added (even with HTML markup) and would be a similar rule for outbound may based on your TO filter needs.</p>\n\n<p><strong>Update</strong>:</p>\n\n<p>For MS Exchange &amp;/OR Outlook, rules and automation are event driven.  Adding someone to the TO field isn't a client event so there's nothing to trigger the addition of a message body.  Outlook could process data if a 3rd party tool was written to trigger on TO field population.</p>\n\n<p>And Transport rules only process messages going in and out of various message transports, i.e. inbound/outbound during message inspection.  So while it can be automated at several stages during message submission, at the client level, it would require manual input (copy/pasting of the additional body).  That's a limitation of most mail clients too, not just Outlook.</p>\n\n<p>Other applications have this feature but they're generally more expensive service desk/support tools like Service-Now or Siebel Customer Center... and even then it's manually scripted one-off functionality. </p>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1446072744, "creation_date": 1446072744, "answer_id": 33402957, "question_id": 33399541, "link": "https://stackoverflow.com/questions/33399541/add-text-to-body-of-email-based-on-recipient-specified/33402957#33402957", "title": "Add text to body of email based on recipient specified", "body": "<p>Trap the MailItem.PropertyChange event and if the property name is To, CC or BCC, loop through the recipients looking for a match.</p>\n"}], "owner": {"reputation": 352, "user_id": 4835627, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10153337036588783/picture?type=large", "display_name": "Austin Donley", "link": "https://stackoverflow.com/users/4835627/austin-donley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1364, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593306052, "creation_date": 1446059160, "last_edit_date": 1593306052, "question_id": 33399541, "link": "https://stackoverflow.com/questions/33399541/add-text-to-body-of-email-based-on-recipient-specified", "title": "Add text to body of email based on recipient specified", "body": "<p>I've been looking around and I can't find an answer to this question.</p>\n\n<p>What I want to do is have text automatically added to the body of an email message when the \"To:\"(email recipient) field is a specific email address.</p>\n\n<p>I've tried to find an event that fires while filling out a new email but haven't had much luck. </p>\n\n<p>This question is similar, <a href=\"https://stackoverflow.com/questions/11264834/outlook-insert-text-based-on-recipient\">Outlook - insert text based on recipient</a>, but his solution only works when the message sends. I need it to happen before the message is sent so the user can continue to fill out the email. </p>\n\n<p>For example, if I fill out \"austin@company.com\" in the \"To:\" field, the body of the email would get filled with pre-specified. In my case I want to have text added so the user knows what to fill out next, like a template. </p>\n\n<p>An example of the template, to be added to the body of the message:</p>\n\n<pre><code>Time: \nLocation: \nUsername:\nComments: \n</code></pre>\n\n<p>And the user would fill out the email from there, after each item. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446059960, "post_id": 33399496, "comment_id": 54590928, "body": "To clarify, I don&#39;t need a single line of code. Just logic/architecture. I was also thinking perhaps building checks into column V? A formula that sums <code>i:t</code> and subtracts <code>u</code>? But that doesn&#39;t ensure accuracy if ALL <code>i:u</code> is bad and the same XD"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1446059990, "post_id": 33399496, "comment_id": 54590944, "body": "And you are not using Excel&#39;s built in subtotals because...? Just a question as I think this through"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446060037, "post_id": 33399496, "comment_id": 54590978, "body": "Because I didn&#39;t build this spreadsheet. Just checking it ;_; Edit: there&#39;s also a lot of formatting I took out. The actual thing looks like a report XD"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446060692, "post_id": 33399496, "comment_id": 54591374, "body": "Actually, that&#39;s not a bad idea. Build a new book and run subtotals then compare...I would need to manually fake data though XD"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446061657, "post_id": 33399496, "comment_id": 54591892, "body": "You could strip the row range from the formula string then compare that to the to row string that you build via vba using loops that resets on each &quot;subtotal&quot; or &quot;total&quot;.  Putting the string(&quot;Start row Number:End row Number&quot;) in another cell."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446061873, "post_id": 33399496, "comment_id": 54592008, "body": "That sounds like my idea? but to capture range for total is a pain XD Edit: I was hoping for some brilliance like <a href=\"http://stackoverflow.com/questions/33397041/selecting-multiple-ranges-in-excel-vba#33398237\">this</a> XD"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446062137, "post_id": 33399496, "comment_id": 54592153, "body": "To get the row range from a formula I use this <code>Replace(Left(Split(Selection.Formula, &quot;(&quot;)(1), Len(Split(Selection.Formula, &quot;(&quot;)(1)) - 1), &quot;A&quot;, &quot;&quot;)</code> Where &quot;A&quot; is the column that the formula calls."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446062207, "post_id": 33399496, "comment_id": 54592184, "body": "Maybe I am overthinking it. Let me start coding."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446063047, "post_id": 33399496, "comment_id": 54592673, "body": "Boo for use of <code>select</code> =P"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446063115, "post_id": 33399496, "comment_id": 54592714, "body": "I figured you are smart enough to replace it with the appropriate variable. Don&#39;t go proving me wrong :)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446063174, "post_id": 33399496, "comment_id": 54592752, "body": "Pfft flagging and reporting you for using select. I had such high regards for you. NO MORE."}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446063581, "post_id": 33400768, "comment_id": 54592961, "body": "Ah niiiice. Yea, I think easiest way to check is to fake data."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446064313, "post_id": 33400768, "comment_id": 54593330, "body": "Sigh faking data is actually the hardest part XD"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1446063266, "creation_date": 1446063266, "answer_id": 33400768, "question_id": 33399496, "link": "https://stackoverflow.com/questions/33399496/need-logic-for-checking-range-in-formula/33400768#33400768", "title": "Need logic for checking range in formula", "body": "<p>I'm not sure if this is what you are looking for, but I wanted to run it by you as an idea.\nThis example will put the totals from column G into Column Z.</p>\n\n<p>Anyway, check it out, if you don't like it, I'll get rid of it.\nYou can add another line or make up a loop to get all the columns total.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim RangeArea As Range\n\n    For Each RangeArea In Columns(\"C\").SpecialCells(xlCellTypeConstants, 1).Areas\n\n        Cells(Rows.Count, \"Z\").End(xlUp).Offset(1).Value = Application.Sum(RangeArea.Offset(, 4))\n\n    Next RangeArea\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1446063266, "creation_date": 1446059021, "last_edit_date": 1531164843, "question_id": 33399496, "link": "https://stackoverflow.com/questions/33399496/need-logic-for-checking-range-in-formula", "title": "Need logic for checking range in formula", "body": "<p>Need help with logic. I have about 1000 rows of data where formulas were entered to calculate subtotals and totals. The nature of the formulas require each respective range to be correct. The correct range is determined by data in column C (please see illustration). For the most part, the ranges (and in turn the formula) are correct. But I have reason to believe a handful are not. </p>\n\n<p>I can check them all manually or I can ask SO for help ^_^ My current thought is to loop column A and at every <code>Subtotal</code>, dump the rows counted so far into column V and pull the rows in the formula from column G into column W then compare V and W.</p>\n\n<p>But what do I do when I reach a <code>Total</code>? My current thought would become cumbersome. Is there a better way? All the highlighted <code>0</code>s between columns <code>i:u</code> need to be tested as well.</p>\n\n<p>I will entertain solution to replace all formulas from scratch as well.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oNOcY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oNOcY.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access", "report"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5499807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b4d509c77c5f6e07be377fea7eb5260?s=128&d=identicon&r=PG&f=1", "display_name": "Bill L.", "link": "https://stackoverflow.com/users/5499807/bill-l"}, "edited": false, "score": 0, "creation_date": 1446228262, "post_id": 33399930, "comment_id": 54672733, "body": "Thanks, I just used a sub-report as mentioned by Parfait because it will also double for another report, so it has been resolved."}], "tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 0, "last_activity_date": 1446060548, "creation_date": 1446060548, "answer_id": 33399930, "question_id": 33399481, "link": "https://stackoverflow.com/questions/33399481/access-2003-report-detail/33399930#33399930", "title": "Access 2003 Report detail", "body": "<p>Gonna need some VBA to do that, or base it off a query.  The key here is that you need to <strong>INNER JOIN</strong> the tables to each other, on the OrderID.  Also, adding the <strong>DISTINCT</strong> qualifier will only return unique values, thereby removing dupes.  So, something like this (which will need to be changed based on your actual table names and field names):</p>\n\n<pre><code>SELECT DISTINCT Orders.OrderID\nFROM tblOrders Orders\nINNER JOIN tblParts Parts\nON tblOrders.OrderID = tblParts.OrderID\n</code></pre>\n\n<p>Then, if you're looking for a specific order, you can filter that by adding a WHERE clause.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5499807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b4d509c77c5f6e07be377fea7eb5260?s=128&d=identicon&r=PG&f=1", "display_name": "Bill L.", "link": "https://stackoverflow.com/users/5499807/bill-l"}, "edited": false, "score": 0, "creation_date": 1446228196, "post_id": 33404878, "comment_id": 54672700, "body": "Duh. I created the Order form with a sub-form for Parts. Did I think of that for the report? Forest for the trees ... Thanks for the suggestion."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1446085227, "creation_date": 1446085227, "answer_id": 33404878, "question_id": 33399481, "link": "https://stackoverflow.com/questions/33399481/access-2003-report-detail/33404878#33404878", "title": "Access 2003 Report detail", "body": "<p>Consider using a subreport. Here are steps:</p>\n\n<ol>\n<li>Create a <strong>smaller Parts report</strong> separately which contains all your listed fields (<code>PartNumber</code>, <code>PartDescription</code>, <code>PartQty</code>, etc.) bound only to the <code>Parts</code> table. Be sure to not put any controls in Page Header/Footer of this subform (as they will not show on main report). Put field headers in this subreport's Report Header section. </li>\n<li>Then, on your <strong>main Orders report</strong> stretch out the detail section and place the Parts subreport just below the records in the same manner as your screenshot. Subforms are the newspaper icon in control section close to the very end which automates a walk-through Wizard -might be slightly different in AC2003 .mdb files.</li>\n<li>In the wizard, select the Parts subreport created above and confirm the matched <code>OrderID</code> between parent form and child subform. If relationships are set up matched keys should be auto-linked waiting for user confirmation.</li>\n</ol>\n\n<p>Doing this your original main report will now have correctly aligned <code>Orders</code> and <code>Parts</code> for each distinct <code>OrderID</code> of Order table.</p>\n"}], "owner": {"reputation": 3, "user_id": 5499807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b4d509c77c5f6e07be377fea7eb5260?s=128&d=identicon&r=PG&f=1", "display_name": "Bill L.", "link": "https://stackoverflow.com/users/5499807/bill-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 33404878, "answer_count": 2, "score": 0, "last_activity_date": 1446085227, "creation_date": 1446058982, "question_id": 33399481, "link": "https://stackoverflow.com/questions/33399481/access-2003-report-detail", "title": "Access 2003 Report detail", "body": "<p>I have two tables that I am creating a report from. One is Orders, and the key is called OrderID.\nI have another table called Parts, also containing OrderID. They have a relationship as well. On my Order forms, I have a listbox and populate that based on the two OrderID's.</p>\n\n<p>Now, I have a report with the data source as Orders. I also added a listbox and set the Row Source/Type to Table/Query pointing to my Parts table. However, when I set the criteria of the two OrderID's to match to display on the corresponding Parts per the Order,  it only picks up the Order in the <em>first</em> detail, and repeats it for each successive detail. How can I get the listbox to only display where the two OrderID's match>\n<a href=\"http://i.stack.imgur.com/calyw.jpg\" rel=\"nofollow\">Code used</a>\n<a href=\"http://i.stack.imgur.com/6tJGY.jpg\" rel=\"nofollow\">Report results</a></p>\n"}, {"tags": ["arrays", "vba", "dynamic"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1446058464, "post_id": 33399276, "comment_id": 54590043, "body": "What is the second dimension dependent on?"}, {"owner": {"reputation": 2352, "user_id": 4823151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pwh6B.jpg?s=128&g=1", "display_name": "user23573", "link": "https://stackoverflow.com/users/4823151/user23573"}, "edited": false, "score": 1, "creation_date": 1446061757, "post_id": 33399276, "comment_id": 54591944, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6344990/dynamic-multi-dimensional-array-problem\">Dynamic Multi-Dimensional array problem</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446062607, "post_id": 33399276, "comment_id": 54592419, "body": "just before your loop <code>redim farr(4,x) as variant</code> x is the variable that you use in your for loop <code>for arow = 0 to x</code>. so what ever you have in place of x in your for loop put that same thing in for x in the redim. Just like @AlexWeber stated."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1446068007, "post_id": 33399276, "comment_id": 54595213, "body": "Just an unrelated side note, wouldn&#39;t <code>Case &quot;A&quot;</code> be simpler than <code>Case Is = &quot;A&quot;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "edited": false, "score": 0, "creation_date": 1446062072, "post_id": 33400105, "comment_id": 54592120, "body": "at present it is like this"}], "tags": [], "owner": {"reputation": 420, "user_id": 5423764, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/daf8ba645547240462b5036013c2a682?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Weber", "link": "https://stackoverflow.com/users/5423764/alex-weber"}, "is_accepted": true, "score": 1, "last_activity_date": 1446061091, "creation_date": 1446061091, "answer_id": 33400105, "question_id": 33399276, "link": "https://stackoverflow.com/questions/33399276/vba-multidimensional-dynamic-array/33400105#33400105", "title": "VBA Multidimensional dynamic array?", "body": "<p>You can use a <code>ReDim</code> to create a dynamic amount of dimensions in an array. Firstly, you must dim your array in the following way:</p>\n\n<pre><code>Dim fArr() as String ' Or whatever datatype you want\n</code></pre>\n\n<p>Then, when you're ready to enter the dimension of the Array, you use a ReDim. </p>\n\n<pre><code>ReDim fArr(4, VBAVariable) as String 'Or whatever datatype you want\n</code></pre>\n\n<p>You can ReDim multiple times. <a href=\"https://msdn.microsoft.com/en-us/library/w8k3cys2.aspx\" rel=\"nofollow\">Check out this article for extra features that ReDim has.</a></p>\n"}], "owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5169, "favorite_count": 0, "accepted_answer_id": 33400105, "answer_count": 1, "score": 0, "last_activity_date": 1446062349, "creation_date": 1446058308, "last_edit_date": 1446062349, "question_id": 33399276, "link": "https://stackoverflow.com/questions/33399276/vba-multidimensional-dynamic-array", "title": "VBA Multidimensional dynamic array?", "body": "<p>I don't know how to create a dynamic multidimensional Array. At present i have declared my array as <code>Dim fArr(0 To 4, 0 To 9)</code>. it is always (0 to 4) in one dimension but other dimension (0-9) is always variable so how do i do it?.</p>\n\n<p>I populate my array like this example</p>\n\n<pre><code>     Select Case fTyp\n         Case Is = \"A\"\n             fArr(0, aRow) = j\n         Case Is = \"B\"\n             fArr(1, aRow) = j\n         Case Is = \"C\"\n             fArr(2, aRow) = j\n     End Select\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "function", "excel", "loops"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1446059881, "post_id": 33399238, "comment_id": 54590888, "body": "if you leave code running endlessly in an open workbook you will be <i>severely</i> hampered in working with Excel throughout your day. You could however, create a <code>vbscript</code> to open the workbook in a separate Excel instance and run the code, then close the workbook. And then use the Task Scheduler to schedule the vbscript to run every X seconds throughout the day."}, {"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446060180, "post_id": 33399238, "comment_id": 54591057, "body": "The situation would be that the file is on a computer that does nothing but run that excel file all day. Absolutely nothing else.  Because i need the excel file open all day.Would it be ok then?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1446060883, "post_id": 33399238, "comment_id": 54591498, "body": "You can use <code>Application.OnTime()</code> to update on a periodic basis."}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 1, "creation_date": 1446061295, "post_id": 33399238, "comment_id": 54591702, "body": "You don&#39;t have to turn calculation off and back on again to make Excel calculate, you can just use <code>Application.Calculate</code>."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446061963, "post_id": 33399238, "comment_id": 54592055, "body": "see my answer based on your last comment CORNAKI."}, {"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1446063378, "post_id": 33399238, "comment_id": 54592863, "body": "Sorry for my ignorance. Application on time sounds great....but where do i paste that....on my &#39;thisworkbook&#39; page? And in between what? a function sub?     I do not want to be putting this in button code, because i want it to run always."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1446061919, "last_edit_date": 1446061919, "creation_date": 1446061517, "answer_id": 33400252, "question_id": 33399238, "link": "https://stackoverflow.com/questions/33399238/continuous-loop-to-refresh-formulas/33400252#33400252", "title": "Continuous loop to refresh formulas", "body": "<p>Based on the fact that you are <strong>only</strong> using this workbook on a machine doing <strong>nothing</strong> else, you can place your code in the <code>workbook_open</code> event of your workbook (ThisWorkbook module in the VBE) and surround it with a <code>Do Loop</code> like below.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDo\n\n    'code to move files\n\n    Application.Wait Now + TimeValue(\"0:05:00\"))  'waits 5 minutes       \n\nLoop Until Time() &gt;= TimeValue(\"17:00:00\") '5pm military time\n\nThisWorkbook.Close True 'closes workbook after loop is over\n\nEnd Sub\n</code></pre>\n\n<p>This code will execute <strong>as soon as you open your workbook</strong> and essentially continue until a defined time period in the day, then close the workbook, pausing the loop every x minutes (set by Application.Wait).</p>\n\n<h2>Alternate Approach</h2>\n\n<p>Alternatively, as Tim Williams suggested, you can use a loop with the <code>Application.OnTime</code> command like this</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim t as Date\nt = Now + TimeValue(\"00:00:05\") 'just give a 5 seconds to start loop\n\nDo \n\n  Application.OnTime t, \"mySub\" 'where mySub is your sub name\n\n  t = Now + TimeValue(\"00:05:00\") 'sets t to 5 minutes from now\n\nLoop Until t &gt; = TimeValue(\"17:00:00\")\n\nThisWorkbook.Close True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1446061919, "creation_date": 1446058214, "last_edit_date": 1446061567, "question_id": 33399238, "link": "https://stackoverflow.com/questions/33399238/continuous-loop-to-refresh-formulas", "title": "Continuous loop to refresh formulas", "body": "<p>I have a worksheet that is using =Files as a named range (so I can see files in a folder. I then have a MOVE button that can move files from one folder to another.\nWhen I click the command button I have told it perform the move and</p>\n\n<pre><code>ActiveSheet.EnableCalculation = False\nActiveSheet.EnableCalculation = True\n</code></pre>\n\n<p>Which works fantastic.\nThe only thing is that only updates my list of files when I click the move button</p>\n\n<p>Is there anyway to have this function be working at all times?\nWithout clicking a button.....\nSo as long as the file is open it is always performing that refresh.</p>\n\n<p>Ideally I would be able to tell it to do it every X seconds....but that is not necessary.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1446059001, "post_id": 33399178, "comment_id": 54590358, "body": "<code>ws</code> is your <code>For Each</code> control variable but you don&#39;t use inside the If block. You act on <code>ActiveSheet</code> regardless of where the loop is. I would think that your problem would be that only one sheet is getting updated and not that too many are. What happens when you change <code>With ActiveSheet.PageSetup</code> to <code>With ws.PageSetup</code>?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1446060322, "post_id": 33399178, "comment_id": 54591142, "body": "I see what you are getting at...I will try it out.  At one point just below for each, I had ws.select....but I was only getting one worksheet to print at the time.  However I may have removed that before I built the selection at the end.  I will get back with the results as soon as I have them."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1446062116, "post_id": 33399178, "comment_id": 54592140, "body": "ok I see what happened...I removed the _ in the subroutine name so it was not executing the code on save.  I have now added that back in, and despite making the change from <code>activesheet.pagesetup</code> to <code>ws.pagesetup</code>, my worksheet(7) is being reformatted to portrait and scale of sheets 2-5.  I suspect all pages are being formatted the same.  its just that 2-5 need to be the same so I do not notice the change on them"}], "answers": [{"tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": true, "score": 2, "last_activity_date": 1446064143, "last_edit_date": 1495535285, "creation_date": 1446063367, "answer_id": 33400799, "question_id": 33399178, "link": "https://stackoverflow.com/questions/33399178/updating-headers-is-screwing-up-my-page-orientation-and-scaling/33400799#33400799", "title": "Updating Headers is screwing up my page orientation and scaling", "body": "<p>So first off thanks to D.K. for the suggestion to change from activesheet.page setup to ws.pagesetup.  This however did not solve the problem but did make a lot more sense.  I then stumbled onto this thread: <a href=\"https://stackoverflow.com/questions/18601744/excel-headers-footers-wont-change-via-vba-unless-blank?rq=1\">Excel headers/footers won&#39;t change via VBA unless blank</a>.  I was wondering what the line</p>\n\n<pre><code> Application.PrintCommunication = False \n</code></pre>\n\n<p>actually did.  When I commented that line out the last sheet's layout no longer got updated/changed to match the other pages and things are working as intended.</p>\n\n<p>This is what the final code looks like:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim ws As Worksheet\n\n    For Each ws In Worksheets\n        If ws.Name &lt;&gt; \"HEADER AND FOOTER\" And InStr(1, Left(ws.Name, 5), \"Table\", vbTextCompare) = 0 Then\n            With ws.PageSetup\n                .CenterHeader = Sheets(1).Range(\"B1\").Value &amp; Chr(10) &amp; \"Load Evaluation\"\n                .RightHeader = _\n                \"Calculated by: \" &amp; Sheets(1).Range(\"B3\").Value &amp; \"  Date: \" &amp; Sheets(1).Range(\"B4\").Value &amp; Chr(10) &amp; \"Checked By:  \" &amp; Sheets(1).Range(\"B5\").Value &amp; \"  Date: \" &amp; Sheets(1).Range(\"B6\").Value\n                .LeftFooter = \"Project Number: \" &amp; Sheets(1).Range(\"B2\").Value\n                .CenterFooter = \"Page &amp;P/&amp;N\"\n                .RightFooter = \"Print Date:  \" &amp; Sheets(1).Range(\"B7\").Value\n            End With\n        End If\n    Next ws\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 33400799, "answer_count": 1, "score": 3, "last_activity_date": 1446064998, "creation_date": 1446057999, "last_edit_date": 1446064998, "question_id": 33399178, "link": "https://stackoverflow.com/questions/33399178/updating-headers-is-screwing-up-my-page-orientation-and-scaling", "title": "Updating Headers is screwing up my page orientation and scaling", "body": "<p>so I burned a whole day yesterday getting side tracked on a different process for toggling images on and off based on a cell value.  The funny thing is it all started from me writing a wee bit of VBA to update the Header and Footer Information automatically prior to printing or saving.</p>\n\n<h2>Situation</h2>\n\n<p>I have 12 worksheets currently in the workbook.\nSheet1(HEADER AND FOOTER) contains all the information to go into the various header/footer locations.</p>\n\n<p>Sheets 2-7 are the pages that get printed as a group and have the header and footers on them.</p>\n\n<p>Sheets 2-6 are portrait letter pages with multiple pages on each sheet (I cannot force 1 page wide on certain sheets due to their layout).</p>\n\n<p>Sheet 7 is landscape letter page.</p>\n\n<p>If I print /save as pdf prior to writing the code and changing each page separately everything worked nice, all paged printed in their respective page layouts/setups.</p>\n\n<p>When I implemented the VBA code in the beforeprint or beforesave in ThisWorkbook things did not go well.  Depending on which variation of the VBA code I tried, either sheet 7 would adopt the portrait orientation and scaling same as the other sheets OR all sheets would be landscape and have the scaling of sheet 7.</p>\n\n<h2>OBJECTIVE</h2>\n\n<p>Update sheets 2 through 7 with the appropriate header/footer information while maintaining their original assigned page settings.  That way when I print, sheets 2-6 are all portrait and sheet 7 is landscape all on letter paper.</p>\n\n<h2>What I have tried</h2>\n\n<p>I recorded a macro to get the base structure.  Originally it had all sheets in one area and modifying them.  I figured that the pages were all being made the same because they were all selected at the same time,  So instead of selecting all them at once, I thought I would try modifying one sheet at a time.  This lead to only one worksheet being printed, so I had to add reselecting all the sheets as the last line of code.  This is the VBA code I currently have:</p>\n\n<pre><code>Private Sub WorkbookBeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim ws As Worksheet\n\n    For Each ws In Worksheets\n    If ws.Name &lt;&gt; \"HEADER AND FOOTER\" And InStr(1, Left(ws.Name, 5), \"Table\", vbTextCompare) = 0 Then\n        Application.PrintCommunication = False\n        With ActiveSheet.PageSetup\n            .CenterHeader = Sheets(1).Range(\"B1\").Value &amp; Chr(10) &amp; \"Load Evaluation\"\n            .RightHeader = _\n            \"Calculated by: \" &amp; Sheets(1).Range(\"B3\").Value &amp; \"  Date: \" &amp; Sheets(1).Range(\"B4\").Value &amp; Chr(10) &amp; \"Checked By:  \" &amp; Sheets(1).Range(\"B5\").Value &amp; \"  Date: \" &amp; Sheets(1).Range(\"B6\").Value\n            .LeftFooter = \"Project Number: \" &amp; Sheets(1).Range(\"B2\").Value\n            .CenterFooter = \"Page &amp;P/&amp;N\"\n            .RightFooter = \"Print Date:  \" &amp; Sheets(1).Range(\"B7\").Value\n        End With\n    End If\n    Next ws\n    Sheets(Array(\"General\", \"Loads\", \"Capacity\", \"Analysis\", \"POSTING\", \"SUMMARY\")).Select\n    Sheets(\"General\").Activate\n End Sub\n</code></pre>\n\n<p>I was thinking maybe there is something wrong with the way I implemented the For Each as that is not a form I am familiar with.  I was originally thinking about using a <code>For x = 2 to ws.count - UDF_worksheet_count_names_starting_with_tables</code> to loop through the sheets.  I thought I would check in here first to see if there is a better approach to this problem.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446059228, "post_id": 33399241, "comment_id": 54590490, "body": "I just tried this and got an &quot;Expected Array&quot; error on this portion: &quot;If sheetexist(type3) Then&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446059465, "post_id": 33399241, "comment_id": 54590630, "body": "Sorry forgot to get rid of the <code>dim sheetexist as boolean</code> @sfowler38"}, {"owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446060185, "post_id": 33399241, "comment_id": 54591060, "body": "Had a couple small errors that I was able to work through by declaring variables, but now getting &quot;Run-time error &#39;1004&#39;: Application-defined or object-defined error&quot; on the &quot;Worksheets.Add(after:=.Sheets(.Sheets.Count)).Name = typ3&quot; line"}, {"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "edited": false, "score": 0, "creation_date": 1446060320, "post_id": 33399241, "comment_id": 54591140, "body": "Inconsistent use of &#39;typ3&#39; and &#39;type3&#39;. (Always) Use &#39;Option Explicit&#39; on a line before the <code>Sub()</code> to avoid this."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "edited": false, "score": 0, "creation_date": 1446060566, "post_id": 33399241, "comment_id": 54591282, "body": "@user1016274 you are correct. As I did not want to build a mock workbook I did not test it.  Thanks for the catch."}, {"owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446060676, "post_id": 33399241, "comment_id": 54591357, "body": "That was one of the small errors that I had corrected. All instances are consistent now and I&#39;m still getting that error."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446060730, "post_id": 33399241, "comment_id": 54591395, "body": "What is the value of typ3 at when you get the error?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446061799, "post_id": 33399241, "comment_id": 54591966, "body": "@sfowler38 sorry I left a test string in place of typ3.  I fixed that too."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446063253, "post_id": 33399241, "comment_id": 54592797, "body": "@sfowler38 did that fix it for you?"}, {"owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446063796, "post_id": 33399241, "comment_id": 54593057, "body": "Sorry for the delay! Updated based on the most recent version and get a &quot;Method &#39;Name&#39; of Object &#39;_Worksheet&#39; failed&quot; error on the &quot;ws.Name = typ3&quot; line."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446064400, "post_id": 33399241, "comment_id": 54593378, "body": "I do not get that error. What is the value of typ3 when it throws the error? @ sfowler38"}, {"owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446065609, "post_id": 33399241, "comment_id": 54594028, "body": "I just stepped through it and it gives me the error when I get to a blank cell (versus stopping the loop)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446065895, "post_id": 33399241, "comment_id": 54594187, "body": "@sfowler38 There must be either cells lower that are either formatted or there are values in cells after what should be the last cells.  Do this; go to the bottom of column E the very last cell on the sheet. with the last cell active hit ctrl - up arrow.  Are there blank cells above where it stops?"}, {"owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446066119, "post_id": 33399241, "comment_id": 54594328, "body": "There is some data that is below where the last cells should be, but there are three blank rows between where the data should stop and where the additional data is. It&#39;s info that I can&#39;t delete unfortunately."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446066161, "post_id": 33399241, "comment_id": 54594359, "body": "@sfowler38 I have changed to code slightly.  It will now look down for the last row not up.  Try this, but beware it will go down column E and stop at the first blank cell."}, {"owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446066619, "post_id": 33399241, "comment_id": 54594569, "body": "Sorry, I didn&#39;t mean for this to take as long as it is!! I tried the updated version and got the &quot;Method &#39;Name&#39; of Object &#39;_Worksheet&#39; failed&quot; error. Then I tried to replace the two other areas where it says xlUp with xlDown and got the &quot;Application-defined or object-defined error&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446066790, "post_id": 33399241, "comment_id": 54594643, "body": "Can you send me a copy of the workbook? email scott.craner@gmail.com.  You should have only needed to replace your for loop line with this line <code>For i = startrow To sh.Range(issuetyp3 &amp; startrow).End(xldown).Row</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446066866, "post_id": 33399241, "comment_id": 54594680, "body": "@sfowler38 did you catch the fact that I replaced <code>.rows.count</code> with startrow on the for loop line?"}, {"owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446067338, "post_id": 33399241, "comment_id": 54594895, "body": "I missed the replaced .rows.count with startrow. That did the trick!! Thank you so much Scott, I cannot thank you enough for working through this with me!! It is much appreciated!!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1446067718, "post_id": 33399241, "comment_id": 54595074, "body": "@sfowler38 I am glad I could help."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1446066033, "last_edit_date": 1446066033, "creation_date": 1446058220, "answer_id": 33399241, "question_id": 33398954, "link": "https://stackoverflow.com/questions/33398954/copying-an-entire-row-based-on-cell-value-and-pasting-in-new-worksheet-stopping/33399241#33399241", "title": "Copying an entire row based on cell value and pasting in new worksheet, stopping on blank cell", "body": "<p>This should speed it up a little:</p>\n\n<p>When only needing the values, skipping the clipboard and assigning the values will speed it up some.  Also, my rule of thumb is that if is only one line then a second sub or function is not needed.  I incorporated all your called subs into the code directly and moved the one I would use as a function out.</p>\n\n<pre><code>Sub test2()\n\nDim i As Long\nDim startrow As Long\nDim typ3 As String\nDim ws As Worksheet\n'Dim sheetexist As Boolean\nDim sh As Worksheet\n\nissuetyp3 = \"E\"\nstartrow = 22\n\nSet sh = Sheets(\"Issues List\")\n\nFor i = startrow To sh.Range(issuetyp3 &amp; startrow).End(xldown).Row\n    typ3 = sh.Range(issuetyp3 &amp; i).Value\n    If sheetexist(typ3) Then\n        Set ws = Sheets(typ3)\n        ws.Rows(ws.Range(issuetyp3 &amp; Rows.Count).End(xlUp).Row + 1).Value = sh.Rows(i).Value\n    Else\n        Set ws = Worksheets.Add(after:=Worksheets(Worksheets.Count))\n        ws.Name = typ3\n        ws.Rows(ws.Range(issuetyp3 &amp; Rows.Count).End(xlUp).Row + 1).Value = sh.Rows(i).Value\n    End If\nNext i\n\nEnd Sub\nFunction sheetexist(nm As String) As Boolean\n    sheetexist = False\n    For Each ws In ThisWorkbook.Sheets\n        If StrComp(ws.Name, nm, vbTextCompare) = 0 Then\n            sheetexist = True\n            Exit For\n        End If\n    Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 33399241, "answer_count": 1, "score": 0, "last_activity_date": 1446066033, "creation_date": 1446057216, "question_id": 33398954, "link": "https://stackoverflow.com/questions/33398954/copying-an-entire-row-based-on-cell-value-and-pasting-in-new-worksheet-stopping", "title": "Copying an entire row based on cell value and pasting in new worksheet, stopping on blank cell", "body": "<p>I'm trying to figure out how to copy an entire row and paste it into a specific worksheet based on the value in one particular cell within that row. I've pieced together a couple different codes to do what I need except that I need it to end once it reaches a blank cell and I'm not sure how to modify to do that since I didn't use a loop. Below is the code I've got so far. Any help would be greatly appreciated!! Also, this code seems like it takes a long time to run so anywhere I can clean it up to make it run smoother would be helpful as well!</p>\n\n<pre><code>Option Explicit\n\nSub test2()\n\nDim sh33tname As String\nDim issuetyp3 As String\nDim i As Long\nDim startrow As Long\nDim typ3 As String\nDim ws As Worksheet\nDim sheetexist As Boolean\nDim sh As Worksheet\n\nsh33tname = \"Issues List\"\nissuetyp3 = \"E\"\nstartrow = 22\n\nSet sh = Sheets(sh33tname)\n\nFor i = startrow To sh.Range(issuetyp3 &amp; Rows.Count).End(xlUp).row\n    typ3 = sh.Range(issuetyp3 &amp; i).Value\n    For Each ws In ThisWorkbook.Sheets\n        If StrComp(ws.Name, typ3, vbTextCompare) = 0 Then\n            sheetexist = True\n            Exit For\n        End If\n    Next\n    If sheetexist Then\n        copyrow i, sh, ws, issuetyp3\n    Else\n        InsertSheet type3\n        Set ws = Sheets(Worksheets.Count)\n        copyrow i, sh, ws, issuetyp3\n    End If\n    Reset sheetexist\nNext i\n\nEnd Sub\n\nPrivate Sub copyrow(i As Long, ByRef sh As Worksheet, ByRef ws As Worksheet, issuetyp3 As String)\n\nDim wsrow As Long\n    wsrow = ws.Range(issuetyp3 &amp; Rows.Count).End(xlUp).row + 1\n    sh.Rows(i &amp; \":\" &amp; i).Copy\n    ws.Rows(wsrow &amp; \":\" &amp; wsrow).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\nEnd Sub\n\nPrivate Sub Reset(ByRef x As Boolean)\n    x = False\nEnd Sub\n\nPrivate Sub InsertSheet(shname As String)\n    Worksheets.Add(after:=.Sheets(.Sheets.Count)).Name = shname\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 649, "user_id": 3207381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8d1d7d1741b6d353fc66fa732b7af609?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul215", "link": "https://stackoverflow.com/users/3207381/mukul215"}, "edited": false, "score": 0, "creation_date": 1446056870, "post_id": 33398823, "comment_id": 54589030, "body": "Have you tried putting it(code) into a module?"}, {"owner": {"reputation": 331, "user_id": 4585227, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/54d4069b40bcf7f7cbe387af1a12cb4b?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4585227/chris"}, "reply_to_user": {"reputation": 649, "user_id": 3207381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8d1d7d1741b6d353fc66fa732b7af609?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul215", "link": "https://stackoverflow.com/users/3207381/mukul215"}, "edited": false, "score": 0, "creation_date": 1446057009, "post_id": 33398823, "comment_id": 54589120, "body": "I put it in ThisWorkbook, which works fine with all my other customUI buttons."}, {"owner": {"reputation": 331, "user_id": 4585227, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/54d4069b40bcf7f7cbe387af1a12cb4b?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4585227/chris"}, "reply_to_user": {"reputation": 649, "user_id": 3207381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8d1d7d1741b6d353fc66fa732b7af609?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul215", "link": "https://stackoverflow.com/users/3207381/mukul215"}, "edited": false, "score": 0, "creation_date": 1446057103, "post_id": 33398823, "comment_id": 54589177, "body": "Which I call using onAction=&quot;ThisWorkbook.highlight_eventhandler&quot; in the customUI editor @Mukul215"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1446058733, "post_id": 33398823, "comment_id": 54590208, "body": "I don&#39;t see any reason that code should be in ThisWorkbook. Move it to a standard module and see if it works."}, {"owner": {"reputation": 331, "user_id": 4585227, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/54d4069b40bcf7f7cbe387af1a12cb4b?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4585227/chris"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1446132064, "post_id": 33398823, "comment_id": 54625912, "body": "@DickKusleika Thank you. that did work. Not sure why. ThisWorkBook has always worked for me prior"}], "owner": {"reputation": 331, "user_id": 4585227, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/54d4069b40bcf7f7cbe387af1a12cb4b?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4585227/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446061693, "creation_date": 1446056822, "last_edit_date": 1446061693, "question_id": 33398823, "link": "https://stackoverflow.com/questions/33398823/macro-works-as-button-but-not-as-ui-ribbon", "title": "Macro works as button but not as UI ribbon", "body": "<p>Ive coded a very simple VBA macro in Excel to highlight rows if there is only one letter in column 1. The code works fine when run from a Form Control Button, but does not run from a custom UI Button in the ribbon (using an eventhandler, ofcourse). Here is the code:</p>\n\n<pre><code>Dim counter As Integer\nDim index As String\n\ncounter = 1\n\nWhile Not index = \"\"\n    On Error Resume Next\n    index = ActiveWorkbook.ActiveSheet.Cells(counter, 1).Value\n\n    If Len(index) = 1 Then\n        ActiveSheet.Rows(counter).Interior.ColorIndex = 16\n    End If\n\n    counter = counter + 1\nWend\n</code></pre>\n\n<p>Any ideas why? I'm assuming it has something to do with not being able to find ActiveWorkBook.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "edited": false, "score": 0, "creation_date": 1446060477, "post_id": 33398526, "comment_id": 54591224, "body": "<code>Dim Warinat As String</code> has a typo. Use <code>Option Explicit</code> as the first line of the module."}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "edited": false, "score": 0, "creation_date": 1446057921, "post_id": 33399005, "comment_id": 54589683, "body": "I thought the same thing, but I guess ExecuteExcel4Macro is actually a standard VBA function: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193589.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff193589.aspx</a>"}, {"owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "reply_to_user": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "edited": false, "score": 1, "creation_date": 1446058046, "post_id": 33399005, "comment_id": 54589759, "body": "yeah, standard function that starts custom macro"}, {"owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "edited": false, "score": 0, "creation_date": 1446058722, "post_id": 33399005, "comment_id": 54590200, "body": "In @BenNowak&#39;s case, the argument doesn&#39;t call a macro; it calls a cell reference value. See <a href=\"http://stackoverflow.com/a/27527560/5103770\">stackoverflow.com/a/27527560/5103770</a>"}], "tags": [], "owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "is_accepted": false, "score": 0, "last_activity_date": 1446057410, "creation_date": 1446057410, "answer_id": 33399005, "question_id": 33398526, "link": "https://stackoverflow.com/questions/33398526/getvalue-loop-can-it-go-faster/33399005#33399005", "title": "GetValue + loop = Can it go faster?", "body": "<p>not without knowing what you are calling with ExecuteExcel4Macro function, because called macro can be anything and very likely is reason why your code excecutes slowly</p>\n\n<pre><code>GetValue = ExecuteExcel4Macro(arg)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1446057776, "creation_date": 1446057776, "answer_id": 33399115, "question_id": 33398526, "link": "https://stackoverflow.com/questions/33398526/getvalue-loop-can-it-go-faster/33399115#33399115", "title": "GetValue + loop = Can it go faster?", "body": "<p>It will probably run faster if you open each workbook rather than reading cell-by-cell from a closed workbook.</p>\n"}, {"comments": [{"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1446061029, "post_id": 33399129, "comment_id": 54591566, "body": "I regard this as the definitive answer: reading the range into an array a single &#39;hit&#39; is always faster than multiple reads of individual cells: so much so that you may as well regard anything you do in VBA to the array as taking zero time... Except if it&#39;s something <b>really</b> slow, like opening files, or reading from closed files. Or, as Stadem has pointed out, reading the same workbook thousands of times. Open the file, and keep it open, and maybe look at a way of grabbing that data into an array in a single &#39;hit&#39;, too!"}, {"owner": {"reputation": 13, "user_id": 5063087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98fbb6b4ca85e755f01cb2b0179f562?s=128&d=identicon&r=PG&f=1", "display_name": "BenNowak", "link": "https://stackoverflow.com/users/5063087/bennowak"}, "edited": false, "score": 0, "creation_date": 1446112938, "post_id": 33399129, "comment_id": 54612372, "body": "Thank you, it really works under 2 seconds :) I am a beginner in VBA so I will learn a lot from your code!"}], "tags": [], "owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "is_accepted": true, "score": 1, "last_activity_date": 1446057824, "creation_date": 1446057824, "answer_id": 33399129, "question_id": 33398526, "link": "https://stackoverflow.com/questions/33398526/getvalue-loop-can-it-go-faster/33399129#33399129", "title": "GetValue + loop = Can it go faster?", "body": "<p>Your ExecuteExcel4Macro call is likely slowing down the process, as it opens the same workbook 12,445 times. You're dealing with two 2-D arrays; one in your Wariant sheet and one in your imported workbook. Try something like this.</p>\n\n<pre><code>Dim var1 As Variant\nDim var2 As Variant\nDim wbImport As Workbook\n\n'Set var1 as your range value\nvar1 = ThisWorkbook.Sheets(Wariant).Range(\"B7:CR137\").Value\n\n'Open the Import workbook, set the value, then close it.\nSet wbImport = Application.Workbooks.Open(p &amp; f)\nvar2 = wbImport.Sheets(\"Sheet1\").Range(\"B7:CR137\").Value\nwbImport.Close\n\n'Now loop through the variant arrays - much faster\nFor r = 1 To 131\n    For c = 1 To 95\n\n        If IsNumeric(var1(r, c)) And var1(r, c) &lt;&gt; \"\" Then\n            var1(r, c) = _\n            var1(r, c) + var2(r, c)\n        Else\n            var1(r, c) = var2(r, c)\n        End If\n    Next c\nNext r\n\n'Finally, copy the variant array back into the workbook.\nThisWorkbook.Sheets(Wariant).Range(\"B7:CR137\").Value = var1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1446075351, "last_edit_date": 1446075351, "creation_date": 1446074688, "answer_id": 33403339, "question_id": 33398526, "link": "https://stackoverflow.com/questions/33398526/getvalue-loop-can-it-go-faster/33403339#33403339", "title": "GetValue + loop = Can it go faster?", "body": "<p>To do this without opening the workbook you can paste this code into a new module:</p>\n\n<pre><code>Dim v As Variant\n\nFunction GetValues(p As String, f As String, s As String, a As String)\nv = Empty\nApplication.ExecuteExcel4Macro \"'\" &amp; ThisWorkbook.Name &amp; \"'!SetV('\" &amp; p &amp; \"\\[\" &amp; f &amp; \"]\" &amp; s &amp; \"'!\" &amp; a &amp; \")\"\nGetValues = v\nEnd Function\n\nPublic Function SetV(Value)\nv = Value\nEnd Function\n</code></pre>\n\n<p>You can then retrieve all the values from the closed workbook in a single call like this:</p>\n\n<pre><code>GetValues(ThisWorkbook.path,\"files.xlsx\",\"Sheet1\",\"r7c2:r137c96\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5063087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98fbb6b4ca85e755f01cb2b0179f562?s=128&d=identicon&r=PG&f=1", "display_name": "BenNowak", "link": "https://stackoverflow.com/users/5063087/bennowak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 661, "favorite_count": 0, "accepted_answer_id": 33399129, "answer_count": 4, "score": 0, "last_activity_date": 1446075351, "creation_date": 1446055843, "last_edit_date": 1446056885, "question_id": 33398526, "link": "https://stackoverflow.com/questions/33398526/getvalue-loop-can-it-go-faster", "title": "GetValue + loop = Can it go faster?", "body": "<p>I have created main file which imports data from other (closed) excel files. There is x-ten of files from which I need to import data. I made a code in UserForm so that mine boss can choose where to import (sheet = wariant) file. It is not completed because I need to add options button (for choosing which file to import), but main core will look like beneath.</p>\n\n<p>But there is a problem, in our company we have a medium class laptops, so that code (beneath) in executin in 5-7 minutes for each file (wariant). I need it to run as fast as possible. Can you make something with it?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nStartTime = Timer\n\nDim p As String\nDim f As String\nDim s As String\nDim a As String\nDim r As Long\nDim c As Long\nDim Warinat As String\n\n    If UserForm1.War1 = True Then Wariant = \"Wariant 1\"\n    If UserForm1.War2 = True Then Wariant = \"Wariant 2\"\n    If UserForm1.War3 = True Then Wariant = \"Wariant 3\"\n    If UserForm1.War4 = True Then Wariant = \"Wariant 4\"\n\n    p = ThisWorkbook.path\n    f = \"files.xlsx\"\n    s = \"Sheet1\"\n\n    Application.ScreenUpdating = False\n\n    For r = 7 To 137\n    For c = 2 To 96\n    a = Cells(r, c).Address\n    If IsNumeric(Cells(r, c)) = True And ThisWorkbook.Sheets(Wariant).Cells(r, c) &lt;&gt; \"\" _\n    Then ThisWorkbook.Sheets(Wariant).Cells(r, c) = _ \n     ThisWorkbook.Sheets(Wariant).Cells(r, c).Value + GetValue(p, f, s, a)\n     Else\n     ThisWorkbook.Sheets(Wariant).Cells(r, c) = GetValue(p, f, s, a)\n     End If\n     Next c\n    Next r\n\nEndTime = Timer\nMsgBox Format(EndTime - StartTime, ssss)\n\nUnload Me\n\nEnd Sub\n\nPrivate Function GetValue(path, file, sheet, ref)\n\n    Dim arg As String\n\n    If Right(path, 1) &lt;&gt; \"\\\" Then path = path &amp; \"\\\"\n    If Dir(path &amp; file) = \"\" Then\n        GetValue = \"Files is missing\"\n        Exit Function\n    End If\n\n    arg = \"'\" &amp; path &amp; \"[\" &amp; file &amp; \"]\" &amp; sheet &amp; \"'!\" &amp; _ \nRange(ref).Range(\"A1\").Address(, , xlR1C1)\n\nGetValue = ExecuteExcel4Macro(arg)\n\nEnd Function\n\nPrivate Sub CommandButton2_Click()\n\nUnload Me\n\nEnd Sub\n\nPrivate Sub UserForm_Click()\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["windows", "vba", "shell", "camera", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1446056322, "post_id": 33398098, "comment_id": 54588702, "body": "Can you do it without the .bat file like this? <code>Shell &quot;cmd &#47;C C:\\GJ\\Camera.lnk&quot;</code>"}, {"owner": {"reputation": 364, "user_id": 2347485, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Xsnjm.jpg?s=128&g=1", "display_name": "Madison Knight", "link": "https://stackoverflow.com/users/2347485/madison-knight"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1446146018, "post_id": 33398098, "comment_id": 54634747, "body": "Thanks for the comment. That does indeed work and is simpler."}], "tags": [], "owner": {"reputation": 364, "user_id": 2347485, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Xsnjm.jpg?s=128&g=1", "display_name": "Madison Knight", "link": "https://stackoverflow.com/users/2347485/madison-knight"}, "is_accepted": false, "score": 2, "last_activity_date": 1446146165, "last_edit_date": 1446146165, "creation_date": 1446054500, "answer_id": 33398098, "question_id": 33398097, "link": "https://stackoverflow.com/questions/33398097/how-to-launch-a-metro-app-from-microsoft-access-vba-on-windows-10-computer/33398098#33398098", "title": "How to Launch a Metro App from Microsoft Access VBA on Windows 10 Computer", "body": "<p>I looked around a decent bit, but was unable to find any simple solutions and ended up coming up with my own. My solution is to make a shortcut link to the camera application and then to launch the link.</p>\n\n<p>In order to make a shortcut link in Windows 10, you can click on the start button, go to \"All Apps\", find the app you want (in my case \"Camera\"), and then click and drag it to the desktop.</p>\n\n<p>Now that you have a shortcut, you can launch the shortcut from a command line. (So my shortcut doesn't clutter up my desktop, I dragged it off my desktop and into a folder on the \"C\" drive.)</p>\n\n<p>Type the path into a command prompt like this and hit enter to test launching your app: <code>C:\\GJ\\Camera.lnk</code></p>\n\n<p>So that solves the problem if you wanted to launch from a command line. For some reason, though, Access would not accept that command. The way I got around it was I put the command in a batch file (Edit: Alternatively, see HansUp's comment). To do that, you just need to open notepad, type in the same thing you typed in the command prompt, save the note pad document, and then rename the document to have a .bat extension.</p>\n\n<p>You can then execute the .bat file from Microsoft Access as follows:</p>\n\n<p><code>Shell \"C:\\GJ\\OpenCamera.bat\", vbMinimizedNoFocus</code></p>\n\n<p>Note that normally, I use vbNormalFocus when running the shell command, but in this case, it is desirable not to see the little command prompt open before the actual program opens.</p>\n"}], "owner": {"reputation": 364, "user_id": 2347485, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Xsnjm.jpg?s=128&g=1", "display_name": "Madison Knight", "link": "https://stackoverflow.com/users/2347485/madison-knight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446146165, "creation_date": 1446054500, "question_id": 33398097, "link": "https://stackoverflow.com/questions/33398097/how-to-launch-a-metro-app-from-microsoft-access-vba-on-windows-10-computer", "title": "How to Launch a Metro App from Microsoft Access VBA on Windows 10 Computer", "body": "<p>I have a situation in which I wanted to utilize the camera app in Windows 10 from my Microsoft Access program. Normally I could just send a command to execute the program's executable, but with the metro app there is no straightforward executable. </p>\n\n<p>The basic code I use is this:</p>\n\n<pre><code>Shell \"\"\"\" &amp; PthToExe &amp; \"\"\"\", vbNormalFocus\n</code></pre>\n\n<p><code>PthToExe</code> is the path name for the executable.</p>\n"}, {"tags": ["sql", "vba", "excel", "adodb"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1446056740, "post_id": 33398048, "comment_id": 54588952, "body": "Have you considered putting this data in a table and pointing a pivot table at it? Or using a <code>SUMIFS</code> formula? Either could address the added information that you gave in Scott Craner&#39;s answer. No VBA needed and more flexible."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5499528, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df592d76722b9730c325d9d1b17d3455?s=128&d=identicon&r=PG&f=1", "display_name": "nubuk29", "link": "https://stackoverflow.com/users/5499528/nubuk29"}, "edited": false, "score": 0, "creation_date": 1446055357, "post_id": 33398286, "comment_id": 54588100, "body": "Hello Scott and thank you for your help. The problem is that my sheet of data can change and the order of the columns can be changed.  For example  Line Number|Country|Firstname|Lastname|Training Status|Training Hours 1|USA|John|Smith|USA|Completed|1 2|France|Henri|Dupont|France|Completed|1 3|USA|Paul|Walker|USA|Incomplete|25 4|USA|Ron|Howard|Completed|10   That&#39;s why I want to work with column header and not column number. Any idea ?"}, {"owner": {"reputation": 17, "user_id": 5499528, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df592d76722b9730c325d9d1b17d3455?s=128&d=identicon&r=PG&f=1", "display_name": "nubuk29", "link": "https://stackoverflow.com/users/5499528/nubuk29"}, "edited": false, "score": 0, "creation_date": 1446057449, "post_id": 33398286, "comment_id": 54589389, "body": "Nice approach Scott. Thanks a lot for your help. I will use an array with the  column name used for filter and make a loop on it to get the column number."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1446057933, "post_id": 33398286, "comment_id": 54589695, "body": "FYI as omegastripes said, you can make the data into an Excel table and then use column names directly in your code to access them."}, {"owner": {"reputation": 17, "user_id": 5499528, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df592d76722b9730c325d9d1b17d3455?s=128&d=identicon&r=PG&f=1", "display_name": "nubuk29", "link": "https://stackoverflow.com/users/5499528/nubuk29"}, "edited": false, "score": 0, "creation_date": 1446058476, "post_id": 33398286, "comment_id": 54590054, "body": "Hi omegastripes and MacroMarc, I will use an xls file and I want to store the filter used with values, the result needed : a sum, an average, a count in a cell to calculate dynamically the result.  For example : I want to put in the cell G1 the result and the formula in the cell H1 to be re-editing later filter:country;equal;USA filter:training status;equal;Completed result:sum;training hours That&#39;s why I can&#39;t use a pivot table.  Maybe MacroMarc you can provide me an example."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1446057265, "last_edit_date": 1446057265, "creation_date": 1446055047, "answer_id": 33398286, "question_id": 33398048, "link": "https://stackoverflow.com/questions/33398048/associative-array-in-vba-like-php/33398286#33398286", "title": "associative array in vba like php", "body": "<p>So I set my sheet up like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wsli4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wsli4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then using the following code I loaded the array and cycled through each line in the array.  I added the Hours as they met the condition and displayed the result in the immediate window.</p>\n\n<p>Edit: As far as I know excel does not use column names.  So the only way I could come up with is this, Where we add the first row into the array then cycle through them looking for the names in the first row of the array to get the position of that column then use the variable to find again.</p>\n\n<p>A quicker method would likely be an advanced filter with subtotals.  Filter on a different page than the data.  Or, the best answer would be using a pivot table.</p>\n\n<pre><code>Sub nubuk()\n\nDim arr() As Variant\nDim smTtl As Double\nDim i&amp;\nDim lastrow As Long\nDim lastcolumn\nDim t&amp;\nDim cntry&amp;, stus&amp;, hrs&amp;\n\nWith ActiveSheet\n    lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    lastcolumn = Cells(1, .Columns.Count).End(xlToLeft).Column\n    Debug.Print lastcolumn\n    arr = .Range(.Cells(1, 1), .Cells(lastrow, lastcolumn)).Value\nEnd With\nFor t = 1 To lastcolumn\n    Select Case LCase(arr(1, t))\n        Case \"country\"\n            cntry = t\n        Case \"training status\"\n            stus = t\n        Case \"training hours\"\n            hrs = t\n        Case Else\n    End Select\nNext t\nFor i = LBound(arr, 1) To UBound(arr, 1)\n    If arr(i, cntry) = \"USA\" And arr(i, stus) = \"Completed\" Then\n        smTtl = smTtl + arr(i, hrs)\n    End If\nNext\n\nDebug.Print smTtl\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 5499528, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df592d76722b9730c325d9d1b17d3455?s=128&d=identicon&r=PG&f=1", "display_name": "nubuk29", "link": "https://stackoverflow.com/users/5499528/nubuk29"}, "edited": false, "score": 0, "creation_date": 1446062940, "post_id": 33400291, "comment_id": 54592608, "body": "Thanks a lot omegastripes, it works perfectly. It is exactly what I need."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 1, "last_activity_date": 1450210561, "last_edit_date": 1450210561, "creation_date": 1446061641, "answer_id": 33400291, "question_id": 33398048, "link": "https://stackoverflow.com/questions/33398048/associative-array-in-vba-like-php/33400291#33400291", "title": "associative array in vba like php", "body": "<p>You can make the SQL query to the worksheet in the opened workbook (the same way as to any other workbook). In this case the query string will be as follows:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT SUM([Training Hours]) AS Myval FROM [data sheet$] WHERE Country = 'USA' AND [Training Status] = 'Completed';\n</code></pre>\n\n<p>Here is the code</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub TestSQLRequest()\n\n    Const adOpenStatic = 3\n    Const adLockOptimistic = 3\n    Const adCmdText = &amp;H1\n\n    Select Case LCase(Mid(ThisWorkbook.Name, InStrRev(ThisWorkbook.Name, \".\")))\n        Case \".xls\"\n            strConnection = \"Provider=Microsoft.Jet.OLEDB.4.0;User ID=Admin;Data Source='\" &amp; ThisWorkbook.FullName &amp; \"';Mode=Read;Extended Properties=\"\"Excel 8.0;HDR=YES;\"\";\"\n        Case \".xlsm\"\n            strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source='\" &amp; ThisWorkbook.FullName &amp; \"';Mode=Read;Extended Properties=\"\"Excel 12.0 Macro;HDR=YES;\"\";\"\n    End Select\n\n    With CreateObject(\"ADODB.Connection\")\n        .Open strConnection\n        With .Execute(\"SELECT SUM([Training Hours]) AS Myval FROM [data sheet$] WHERE Country = 'USA' AND [Training Status] = 'Completed';\")\n            Myval = .Fields(\"Myval\")\n        End With\n        .Close\n    End With\n\n    MsgBox Myval\n\nEnd Sub\n</code></pre>\n\n<p>Within the query string, the column names with spaces should be put into square brackets, as well as the name of the worksheet containing data followed by <code>$</code>.\nIt goes without saying that the query can't access to the data, which wasn't saved to the file after some changes have been made to the sheet.\nNote that <code>Excel 8.0</code> provider won't work on 64-bit Excel version, try to use <code>Excel 12.0</code> provider instead (the second <code>strConnection</code> assignment).</p>\n"}], "owner": {"reputation": 17, "user_id": 5499528, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df592d76722b9730c325d9d1b17d3455?s=128&d=identicon&r=PG&f=1", "display_name": "nubuk29", "link": "https://stackoverflow.com/users/5499528/nubuk29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 1, "accepted_answer_id": 33400291, "answer_count": 2, "score": 1, "last_activity_date": 1532292660, "creation_date": 1446054375, "last_edit_date": 1532292660, "question_id": 33398048, "link": "https://stackoverflow.com/questions/33398048/associative-array-in-vba-like-php", "title": "associative array in vba like php", "body": "<p>I need your help for building analytics in Microsoft Excel using VBA.</p>\n\n<p>I have one data sheet with y columns and n lines</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Line Number  Firstname  Lastname  Country  Training Hours  Training Status\n1            John       Smith     USA      1               Completed\n2            Henri      Dupont    France   1               Completed\n3            Paul       Walker    USA      25              Incomplete\n4            Ron        Howard    USA      10              Completed\n</code></pre>\n\n<p>And I would like to use array like in php but using VBA</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>For i = 1 To nblines\n    If(array[i][\"Country\"] = \"USA\" And array[i][\"Training Status\"] = \"Completed\") Then\n        myval = myval + array[i][\"Training Hours\"]\n    End If\nNext\n</code></pre>\n\n<p>myval should be 11</p>\n\n<p>Unfortunately I don't find THE solution. I've tried dictionnary, collection and array but without success. Any idea?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1446054166, "creation_date": 1446054166, "answer_id": 33397987, "question_id": 33397833, "link": "https://stackoverflow.com/questions/33397833/if-combobox-equal-to-empty-do-not-copy-userform-data-to-excel-sheet/33397987#33397987", "title": "If combobox equal to empty, do not copy userform data to excel sheet", "body": "<p>Change</p>\n\n<pre><code>If IsEmpty(UserForm5.ComboBox5.Value) Then\n</code></pre>\n\n<p>to </p>\n\n<pre><code>If UserForm5.ComboBox5.Value = \"\" Then\n</code></pre>\n\n<p>And make the same sort of change to the Product2 sub.</p>\n"}, {"tags": [], "owner": {"reputation": 1811, "user_id": 4347950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33c2cda3907b3f3014aee555819a8d68?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Dannemann", "link": "https://stackoverflow.com/users/4347950/joshua-dannemann"}, "is_accepted": false, "score": 0, "last_activity_date": 1446054507, "creation_date": 1446054507, "answer_id": 33398102, "question_id": 33397833, "link": "https://stackoverflow.com/questions/33397833/if-combobox-equal-to-empty-do-not-copy-userform-data-to-excel-sheet/33398102#33398102", "title": "If combobox equal to empty, do not copy userform data to excel sheet", "body": "<p>If the combo box is \"empty\" then checking its value will give you an empty string.</p>\n\n<pre><code>Sub Product1()\n    Dim lRow As Long\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Inventory\")\n    lRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n    With ws\n        If UserForm5.ComboBox5.Value &lt;&gt; \"\" Then\n            Exit Sub\n        Else\n            .Cells(lRow, 1).Value = UserForm5.TextBox1.Value\n            .Cells(lRow, 2).Value = UserForm5.ComboBox2.Value\n            .Cells(lRow, 3).Value = UserForm5.ComboBox3.Value\n            .Cells(lRow, 4).Value = UserForm5.ComboBox4.Value\n            .Cells(lRow, 5).Value = UserForm5.ComboBox1.Value\n            .Cells(lRow, 6).Value = UserForm5.ComboBox5.Value\n            .Cells(lRow, 7).Value = UserForm5.TextBox2.Value\n            .Cells(lRow, 8).Value = UserForm5.TextBox5.Value\n            .Cells(lRow, 9).Value = UserForm5.TextBox6.Value\n            .Cells(lRow, 10).Value = UserForm5.TextBox4.Value\n            .Cells(lRow, 11).Value = UserForm5.TextBox7.Value\n        End If\n    End With\nEnd Sub\n\nSub Product2()\n    Dim lRow As Long\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Inventory\")\n    lRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n    With ws\n        If UserForm5.ComboBox6.Value &lt;&gt; \"\" Then\n            Exit Sub\n        Else\n            .Cells(lRow, 1).Value = UserForm5.TextBox1.Value\n            .Cells(lRow, 2).Value = UserForm5.ComboBox2.Value\n            .Cells(lRow, 3).Value = UserForm5.ComboBox3.Value\n            .Cells(lRow, 4).Value = UserForm5.ComboBox4.Value\n            .Cells(lRow, 5).Value = UserForm5.ComboBox1.Value\n            .Cells(lRow, 6).Value = UserForm5.ComboBox6.Value\n            .Cells(lRow, 7).Value = UserForm5.TextBox9.Value\n            .Cells(lRow, 8).Value = UserForm5.TextBox11.Value\n            .Cells(lRow, 9).Value = UserForm5.TextBox12.Value\n            .Cells(lRow, 10).Value = UserForm5.TextBox10.Value\n            .Cells(lRow, 11).Value = UserForm5.TextBox8.Value\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 3689699, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/de801467c40de66ac25d864171f8d444?s=128&d=identicon&r=PG&f=1", "display_name": "user36896989", "link": "https://stackoverflow.com/users/3689699/user36896989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 871, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446054507, "creation_date": 1446053777, "last_edit_date": 1446054029, "question_id": 33397833, "link": "https://stackoverflow.com/questions/33397833/if-combobox-equal-to-empty-do-not-copy-userform-data-to-excel-sheet", "title": "If combobox equal to empty, do not copy userform data to excel sheet", "body": "<p>I have create 2 sub function like this:</p>\n\n<pre><code>Sub Product1()\n\nDim lRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Inventory\")\n\nlRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\nSearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\nWith ws\n\nIf IsEmpty(UserForm5.ComboBox5.Value) Then\n    Exit Sub\nElse\n    .Cells(lRow, 1).Value = UserForm5.TextBox1.Value\n    .Cells(lRow, 2).Value = UserForm5.ComboBox2.Value\n    .Cells(lRow, 3).Value = UserForm5.ComboBox3.Value\n    .Cells(lRow, 4).Value = UserForm5.ComboBox4.Value\n    .Cells(lRow, 5).Value = UserForm5.ComboBox1.Value\n    .Cells(lRow, 6).Value = UserForm5.ComboBox5.Value\n    .Cells(lRow, 7).Value = UserForm5.TextBox2.Value\n    .Cells(lRow, 8).Value = UserForm5.TextBox5.Value\n    .Cells(lRow, 9).Value = UserForm5.TextBox6.Value\n    .Cells(lRow, 10).Value = UserForm5.TextBox4.Value\n    .Cells(lRow, 11).Value = UserForm5.TextBox7.Value\n\nEnd If\n\nEnd With\n\nEnd Sub\n\n\nSub Product2()\nDim lRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Inventory\")\n\nlRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\nSearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\nWith ws\n\nIf IsEmpty(UserForm5.ComboBox6.Value) Then\n    Exit Sub\nElse\n    .Cells(lRow, 1).Value = UserForm5.TextBox1.Value\n    .Cells(lRow, 2).Value = UserForm5.ComboBox2.Value\n    .Cells(lRow, 3).Value = UserForm5.ComboBox3.Value\n    .Cells(lRow, 4).Value = UserForm5.ComboBox4.Value\n    .Cells(lRow, 5).Value = UserForm5.ComboBox1.Value\n    .Cells(lRow, 6).Value = UserForm5.ComboBox6.Value\n    .Cells(lRow, 7).Value = UserForm5.TextBox9.Value\n    .Cells(lRow, 8).Value = UserForm5.TextBox11.Value\n    .Cells(lRow, 9).Value = UserForm5.TextBox12.Value\n    .Cells(lRow, 10).Value = UserForm5.TextBox10.Value\n    .Cells(lRow, 11).Value = UserForm5.TextBox8.Value\nEnd If\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I was wondering that, if my combobox6 is empty, it should not transfer the data for to exel sheet.</p>\n\n<p>What I faced now is if the combobox6 is empty( did not select any value), it will still copy all the data to the excel sheet.</p>\n\n<p>Is there any way to fix it?</p>\n"}, {"tags": ["arrays", "excel", "vba", "variables"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1446053610, "post_id": 33397737, "comment_id": 54586971, "body": "are you meaning <code>redim</code> and/or <code>redim preserve</code>?"}, {"owner": {"reputation": 1, "user_id": 5036707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8c27a87b7fad72ebadf5fa0f40d888?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Danon", "link": "https://stackoverflow.com/users/5036707/eduardo-danon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446058667, "post_id": 33397737, "comment_id": 54590171, "body": "I tried that! but didnt work out. i used the following: [code] Dim Max as INteger Max = Sheets(&quot;Home&quot;).Range(&quot;H1&quot;).Value ReDim MySlideArray(2 To Max) [code], but did not work out. got error 91 in another line, above all these"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446059134, "post_id": 33397737, "comment_id": 54590438, "body": "by <code>redim myslidearray(2 to max)</code> you are saying you want an array with <code>max - 2</code> slots with a <code>lbound</code> of 2 and a <code>ubound</code> of max not an array with values 2 to max. So in the code you are calling <code>myslidearray(2) to </code>myslidearray(max) which does not exist the <code>MyRangeArray</code>  with a <code>lbound</code> of 1 and a <code>ubound</code> of 5"}, {"owner": {"reputation": 1, "user_id": 5036707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8c27a87b7fad72ebadf5fa0f40d888?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Danon", "link": "https://stackoverflow.com/users/5036707/eduardo-danon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446142085, "post_id": 33397737, "comment_id": 54632595, "body": "thanks for your answer! how can I solve it?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5036707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8c27a87b7fad72ebadf5fa0f40d888?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Danon", "link": "https://stackoverflow.com/users/5036707/eduardo-danon"}, "edited": false, "score": 0, "creation_date": 1446058467, "post_id": 33398099, "comment_id": 54590049, "body": "I tried that! but didnt work out. i used the following:   [code] Dim Max as INteger  Max = Sheets(&quot;Home&quot;).Range(&quot;H1&quot;).Value  ReDim MySlideArray(2 To Max) [code], but did not work out. got error 91 in another line, above all these"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 5036707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8c27a87b7fad72ebadf5fa0f40d888?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Danon", "link": "https://stackoverflow.com/users/5036707/eduardo-danon"}, "edited": false, "score": 1, "creation_date": 1446059937, "post_id": 33398099, "comment_id": 54590917, "body": "You should <i>edit your question</i> and show exactly what you tried, and describe exactly what happened when you ran it."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1446054503, "creation_date": 1446054503, "answer_id": 33398099, "question_id": 33397737, "link": "https://stackoverflow.com/questions/33397737/variable-array-based-on-cell-value/33398099#33398099", "title": "Variable Array based on cell value", "body": "<p>You can use <code>ReDim</code></p>\n\n<pre><code>Sub Tester()\n\n    Dim myArr() As Range\n    Dim myCell\n\n    Set myCell = Sheet1.Range(\"A1\")\n\n    ReDim myArr(0 To myCell.Value)\n\n    Debug.Print LBound(myArr), UBound(myArr)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5036707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8c27a87b7fad72ebadf5fa0f40d888?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Danon", "link": "https://stackoverflow.com/users/5036707/eduardo-danon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446054541, "creation_date": 1446053503, "last_edit_date": 1446054541, "question_id": 33397737, "link": "https://stackoverflow.com/questions/33397737/variable-array-based-on-cell-value", "title": "Variable Array based on cell value", "body": "<p>The following code shows an array with fixed size, with six values.  </p>\n\n<p>What should I do to make its size depends on a cell value? For example, from 1 to 10?</p>\n\n<pre><code>Dim MySlideArray As Variant\n        Dim MyRangeArray As Variant\n'List of PPT Slides to Paste to\n   MySlideArray = Array(2, 3, 4, 5, 6, 7)\n 'List of Excel Ranges to Copy from. For now, assume that it's always 6 ranges\n  With tb.DataBodyRange\n     MyRangeArray = Array(Worksheets(.Cells(1, 1).Value).Range(.Cells(1, 2).Value), _\n                Worksheets(.Cells(2, 1).Value).Range(.Cells(2, 2).Value), _\n                Worksheets(.Cells(3, 1).Value).Range(.Cells(3, 2).Value), _\n                Worksheets(.Cells(4, 1).Value).Range(.Cells(4, 2).Value), _\n                Worksheets(.Cells(5, 1).Value).Range(.Cells(5, 2).Value), _\n                Worksheets(.Cells(6, 1).Value).Range(.Cells(6, 2).Value))\n\n\n\n'Loop through Array data\nFor x = LBound(MySlideArray) To UBound(MySlideArray)\n'Copy Excel Range\nMyRangeArray(x).Copy\n\n'Paste to PowerPoint and position\n  On Error Resume Next\n    Set shp = myPresentation.Slides(MySlideArray(x)).Shapes.PasteSpecial(DataType:=2) 'Excel 2007-2010\n    Set shp = PowerPointApp.ActiveWindow.Selection.ShapeRange 'Excel 2013\n  On Error GoTo 0]\n</code></pre>\n"}, {"tags": ["excel", "vba", "printing", "userform"], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 2, "last_activity_date": 1446056752, "creation_date": 1446056752, "answer_id": 33398801, "question_id": 33397649, "link": "https://stackoverflow.com/questions/33397649/vba-excel-userform-preview-print/33398801#33398801", "title": "vba excel userform preview print", "body": "<p>Here is the answer.</p>\n\n<p>It is not possible to display a Print Preview of a userform using only VBA.</p>\n\n<p>It is possible to do so using a series of Wind32 APIs, as the userform is a Window. However, this is not trivial and requires a lot of code.</p>\n"}], "owner": {"reputation": 1, "user_id": 5499488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/721beab99314866ce34cfa787b246a27?s=128&d=identicon&r=PG&f=1", "display_name": "ernie", "link": "https://stackoverflow.com/users/5499488/ernie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1086, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447159885, "creation_date": 1446053267, "last_edit_date": 1447159885, "question_id": 33397649, "link": "https://stackoverflow.com/questions/33397649/vba-excel-userform-preview-print", "title": "vba excel userform preview print", "body": "<p>Is it possible to preview print a user from in vba excel or print the user form to a place in a worksheet?  </p>\n\n<p>I already know this \n<code>UserForm1.PrintForm</code></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5499360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c3cbaa52816cd8a2967153068931a2?s=128&d=identicon&r=PG&f=1", "display_name": "falco", "link": "https://stackoverflow.com/users/5499360/falco"}, "edited": false, "score": 1, "creation_date": 1446062362, "post_id": 33398600, "comment_id": 54592281, "body": "Thank you very much for the prompt and thorough reponse! That worked perfectly. It required a few quick edits, but was exactly what I needed! Thanks again."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 27, "user_id": 5499360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c3cbaa52816cd8a2967153068931a2?s=128&d=identicon&r=PG&f=1", "display_name": "falco", "link": "https://stackoverflow.com/users/5499360/falco"}, "edited": false, "score": 1, "creation_date": 1446062610, "post_id": 33398600, "comment_id": 54592421, "body": "I just realized some of it superfluous. You can remove the whole <code>Select Case</code> and just set <code>sLink</code> after the <code>Then</code> of the each <code>If</code> statement. Will make it shorter code and easier to read."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 27, "user_id": 5499360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c3cbaa52816cd8a2967153068931a2?s=128&d=identicon&r=PG&f=1", "display_name": "falco", "link": "https://stackoverflow.com/users/5499360/falco"}, "edited": false, "score": 1, "creation_date": 1446126820, "post_id": 33398600, "comment_id": 54621918, "body": "I just saw another way to make cleaner and easier to read, in terms of naming the file. I guess I was a bit bored at the moment :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1446126481, "last_edit_date": 1446126481, "creation_date": 1446056101, "answer_id": 33398600, "question_id": 33397595, "link": "https://stackoverflow.com/questions/33397595/update-four-links-in-a-workbook/33398600#33398600", "title": "Update four links in a workbook", "body": "<p>If you loop through each of the links and use a <code>Select Case</code> to determine which link you are working with, you can then determine the right link to change.</p>\n\n<p>See the code below that I modified based on what you have in your OP.</p>\n\n<pre><code>Sub UpDateLinks()\n\nDim Date1 As String\nDim StateAbbrev As String, sLink As String, sNewName as String\nDim varLinks As Variant\nDim i As Integer\nDim ws As Worksheet\n\nSet ws = Sheets(\"Inputs\")\n\nWith ws\n\n    StateAbbrev = .Range(\"StateAbbrev\")\n    Date1 = .Range(\"AD1\")\n\nEnd With\n\nvarLinks = ActiveWorkbook.LinkSources(xlExcelLinks)\n\nFor i = 1 To UBound(varLinks)\n\n    Dim x As Integer\n    If InStr(1, varLinks(i), \"Loss Trends\") Then sLink = \"Loss Trends\"\n    If InStr(1, varLinks(i), \"Prem Trends\") Then sLink = \"Prem Trends\"\n    If InStr(1, varLinks(i), \"Fast Track Loss Trends\") Then sLink = \"Fast Track Loss Trends\"\n    If InStr(1, varLinks(i), \"Section A\") Then sLink = \"Section A\"\n\n    sNewName = \"F:\\MyHouse\\\" &amp; Date1 &amp; \"\\\" &amp; StateAbbrev &amp; \"\\Home\\\" &amp; StateAbbrev &amp; \" \" &amp; sLink &amp; \" \" &amp; Date1 &amp; \".xlsm\"\n\n    If sLink = \"Section A\" Then sNewName = Replace(sNewName,\".xlsm\",\"-Revised.xlsm\")         \n\n    ActiveWorkbook.ChangeLink _\n            Name:=varLinks(i), NewName:=sNewName, Type:=xlExcelLInks\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5499360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c3cbaa52816cd8a2967153068931a2?s=128&d=identicon&r=PG&f=1", "display_name": "falco", "link": "https://stackoverflow.com/users/5499360/falco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 1, "accepted_answer_id": 33398600, "answer_count": 1, "score": 2, "last_activity_date": 1446126481, "creation_date": 1446053091, "last_edit_date": 1446054601, "question_id": 33397595, "link": "https://stackoverflow.com/questions/33397595/update-four-links-in-a-workbook", "title": "Update four links in a workbook", "body": "<p>I am attempting to update four links in a workbook that I have created. I have pieced together the following code using what I found online. The links that I am trying to replace have dynamic file names based on date and state. I was hoping that excel orders link names the same way they are ordered in the edit links window. It appears this is not the case. </p>\n\n<p>The issue I am having is that the link that I intended to be varlink(1) is being replaced by the one that is meant to replace varlink(4). Is there anyway to ensure I replace the \"loss\" link with the \"loss\" link, etc.? </p>\n\n<pre><code>Sub UpDateLinks()\n\nDim Date1 As String\nDim StateAbbrev As Variant\nDim varLinks As Variant\nDim i As Integer\n\nSheets(\"Inputs\").Select\nActiveSheet.Range(\"StateAbbrev\").Activate\nStateAbbrev = ActiveCell.Value\nDate1 = Range(\"AD1\")\n\nvarLinks = ActiveWorkbook.LinkSources(xlExcelLinks)\n\nActiveWorkbook.ChangeLink _\n            Name:=varLinks(1), NewName:=\"F:\\MyHouse\\\" &amp; Date1 &amp; \"\\\" &amp; StateAbbrev &amp; \"\\Home\\\" &amp; StateAbbrev &amp; \" Loss Trends \" &amp; Date1 &amp; \".xlsm\", _\n            Type:=xlExcelLinks\n\nActiveWorkbook.ChangeLink _\n            Name:=varLinks(2), NewName:=\"F:\\MyHouse\\\" &amp; Date1 &amp; \"\\\" &amp; StateAbbrev &amp; \"\\Home\\\" &amp; StateAbbrev &amp; \" Prem Trends \" &amp; Date1 &amp; \".xlsm\", _\n            Type:=xlExcelLinks\n\nActiveWorkbook.ChangeLink _\n            Name:=varLinks(3), NewName:=\"F:\\MyHouse\\\" &amp; Date1 &amp; \"\\\" &amp; StateAbbrev &amp; \"\\Home\\\" &amp; StateAbbrev &amp; \" Fast Track Loss Trends \" &amp; Date1 &amp; \".xlsm\", _\n            Type:=xlExcelLinks\n\nActiveWorkbook.ChangeLink _\n            Name:=varLinks(4), NewName:=\"F:\\MyHouse\\\" &amp; Date1 &amp; \"\\Home\\\" &amp; StateAbbrev &amp; \" Section A \" &amp; Date1 &amp; \"-Revised.xlsx\", _\n            Type:=xlExcelLinks\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "colors", "max"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1446051568, "post_id": 33397084, "comment_id": 54585558, "body": "Why not use conditional formatting?"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446052626, "post_id": 33397394, "comment_id": 54586246, "body": "to add more clarity to <code>to equal the value of the maximum in your range</code> ... <code>when its expecting a valid Excel range object because it&#39;s declared as Range</code>"}], "tags": [], "owner": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "is_accepted": false, "score": 2, "last_activity_date": 1446052427, "creation_date": 1446052427, "answer_id": 33397394, "question_id": 33397084, "link": "https://stackoverflow.com/questions/33397084/change-the-colour-of-a-cell-that-has-the-maximum-value/33397394#33397394", "title": "Change the colour of a cell that has the maximum value", "body": "<p><code>Max</code> doesn't return the location of the maximum value - it simply tells you what the maximum value is. In this case, your <code>Set HLF = WorksheetsFunction.Max(Range(\"H2:H7\"))</code> is trying to set the range <code>HLF</code> to equal the value of the maximum in your range. This, I think, is why it's throwing out an error.</p>\n\n<p>As @Scott Craner suggests, you can do this through Conditional Formatting fairly easily - select \"Use a formula to determine which cells to format\" in conditional formatting, set it to apply to the range <code>H2:H7</code> and set the rule to be <code>=H2=MAX($H$2:$H$7)</code>. The advantage of this is it will update as soon as your values do.</p>\n"}, {"comments": [{"owner": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "edited": false, "score": 2, "creation_date": 1446053222, "post_id": 33397450, "comment_id": 54586674, "body": "If the maximum appeared more than once, would this not only return the first instance of the max value? Might be worth using a <code>For</code> loop for all cells in <code>HLF</code> instead of <code>Find</code> to ensure you catch every instance of the maximum."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "edited": false, "score": 1, "creation_date": 1446053547, "post_id": 33397450, "comment_id": 54586918, "body": "@asongtoruin - good call! I&#39;ll edit my post.  (Although your point also exemplifies why using Conditional Formatting might be the best option - it&#39;d catch all such instances of the max number)."}, {"owner": {"reputation": 3, "user_id": 5499333, "user_type": "registered", "profile_image": "https://graph.facebook.com/980929791963053/picture?type=large", "display_name": "Bernd Keuning", "link": "https://stackoverflow.com/users/5499333/bernd-keuning"}, "edited": false, "score": 0, "creation_date": 1446126502, "post_id": 33397450, "comment_id": 54621641, "body": "Thank you! The method works, although I had to specify the sheet at both &#39;Range&#39; commands to get it to work. I did use the first suggestion. Since the numbers are ratio&#39;s between 10 figure numbers the chance of two numbers being the same is very small."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 5499333, "user_type": "registered", "profile_image": "https://graph.facebook.com/980929791963053/picture?type=large", "display_name": "Bernd Keuning", "link": "https://stackoverflow.com/users/5499333/bernd-keuning"}, "edited": false, "score": 0, "creation_date": 1446127635, "post_id": 33397450, "comment_id": 54622578, "body": "@BerndKeuning - Happy to help! If it worked, do you mind marking as the answer?  Also, just to make sure, if you&#39;re using <code>Range(cells(),Cells())</code> instead of <code>Range(&quot;A1:A10&quot;)</code>, then specify the sheet before Range <i>and</i> cells, ie. myWS.Range(myWS.Cells(1,1),myWS.cells(10,1))`."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1446053598, "last_edit_date": 1446053598, "creation_date": 1446052639, "answer_id": 33397450, "question_id": 33397084, "link": "https://stackoverflow.com/questions/33397084/change-the-colour-of-a-cell-that-has-the-maximum-value/33397450#33397450", "title": "Change the colour of a cell that has the maximum value", "body": "<p><code>Max</code> will return a <em>value</em> from your column.  This won't, by itself, give you a cell, which is required for a range.  What you can do is a small workaround, see below:</p>\n\n<pre><code>Sub test()\nDim HLF As Range, finalHLF\nDim maxNum As Double\nSet HLF = Range(\"H2:H7\")\nmaxNum = WorksheetFunction.Max(HLF)\n\nfinalHLF = HLF.Find(what:=maxNum, lookat:=xlWhole).Address\nRange(finalHLF).Interior.Color = RGB(0, 255, 0)\nEnd Sub\n</code></pre>\n\n<p>This will find your max value, then using that max value, will search in the determined range (in your example, <code>H2:H7</code> for that max value, then return that cell's address.  Then you can continue on with the <code>.Color</code>, using the <code>.Address</code>).</p>\n\n<p>But, as has also been suggested, Conditional Formatting might be your safest bet - as it's easy, and doesn't require the use of macros.  But try the above and let me know if you have any questions!</p>\n\n<p>Edit: As @asongtoruin pointed out, the above only will highlight one of the max values, so if there are multiple cells of the same max value, only one will be highlighted.  The below code will highlight all max values:</p>\n\n<pre><code>Sub test()\nDim HLF As Range, cel As Range\nDim maxNum As Double\n\nSet HLF = Range(\"H2:H7\")\nmaxNum = WorksheetFunction.Max(HLF)\n\nFor Each cel In HLF\n    If cel.Value = maxNum Then\n        cel.Interior.Color = RGB(0, 255, 0)\n    End If\nNext cel\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5499333, "user_type": "registered", "profile_image": "https://graph.facebook.com/980929791963053/picture?type=large", "display_name": "Bernd Keuning", "link": "https://stackoverflow.com/users/5499333/bernd-keuning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1495, "favorite_count": 0, "accepted_answer_id": 33397450, "answer_count": 2, "score": 0, "last_activity_date": 1446053598, "creation_date": 1446051516, "last_edit_date": 1446052255, "question_id": 33397084, "link": "https://stackoverflow.com/questions/33397084/change-the-colour-of-a-cell-that-has-the-maximum-value", "title": "Change the colour of a cell that has the maximum value", "body": "<p>I'm trying to recolour the cell with the highest value in a range, but whatever method I'm using, there always seems to be one combination that does not work. I'm not rely used to VBA. What I've tried the last is:</p>\n\n<pre><code>Sub HLF()\n  Dim HLF As Range\n  Set HLF = WorksheetsFunction.Max(Range(\"H2:H7\"))\n  Range(\"HLF\").Interior.Color = RGB(0,255,0)\nEnd Sub\n</code></pre>\n\n<p>It seems that the 'Set' and 'Max' function don't go together. My basic programming logic says that a normal 'Range' should be replaceable by a function that finds a range, but apparently Excel says not. I've also tried by selecting the cell and using 'ActiveCell' instead of 'Range' to color the cell, but a function and select don't seem to go together either. Other supposed solutions seem overly complicated for such a small task.</p>\n"}, {"tags": ["vba", "excel", "tags"], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 0, "last_activity_date": 1446055001, "creation_date": 1446055001, "answer_id": 33398263, "question_id": 33397061, "link": "https://stackoverflow.com/questions/33397061/changing-all-labels-colour-after-disabling-the-frame/33398263#33398263", "title": "Changing all labels colour after disabling the frame", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub cbxCSENetworkDeseign_Click()\nDim Tbox As Object   'MSForms.TextBox\n\n    If cbxCSENetworkDeseign.Value = True Then  'Check box that will disable / enable the frame\n        frmCustomerDetails.Enabled = False\n        For Each Tbox In frmCustomerDetails.Controls\n            Tbox.ForeColor = vbGrayText\n        Next Tbox\n    Else\n        frmCustomerDetails.Enabled = True\n        For Each Tbox In frmCustomerDetails.Controls\n            Tbox.ForeColor = vbBlack\n        Next Tbox\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 5255116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xDejQTQVW74/AAAAAAAAAAI/AAAAAAAABwA/2CNZIvH7-uc/photo.jpg?sz=128", "display_name": "Hamdi", "link": "https://stackoverflow.com/users/5255116/hamdi"}, "is_accepted": false, "score": 0, "last_activity_date": 1446060130, "creation_date": 1446060130, "answer_id": 33399805, "question_id": 33397061, "link": "https://stackoverflow.com/questions/33397061/changing-all-labels-colour-after-disabling-the-frame/33399805#33399805", "title": "Changing all labels colour after disabling the frame", "body": "<p>@Excel Hero\nThankx Bud.\nbut after re-checking my code , I found that what is missing is to complete all the Tags in my frame ( some of them were empty) , so when I run it it is actually working.\nthx bud again\n;)</p>\n"}], "owner": {"reputation": 35, "user_id": 5255116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xDejQTQVW74/AAAAAAAAAAI/AAAAAAAABwA/2CNZIvH7-uc/photo.jpg?sz=128", "display_name": "Hamdi", "link": "https://stackoverflow.com/users/5255116/hamdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 33398263, "answer_count": 2, "score": 1, "last_activity_date": 1446060130, "creation_date": 1446051398, "last_edit_date": 1446054479, "question_id": 33397061, "link": "https://stackoverflow.com/questions/33397061/changing-all-labels-colour-after-disabling-the-frame", "title": "Changing all labels colour after disabling the frame", "body": "<p>I need some help in turning the label colours of a frame to Gray after disabling it. Enabling and disabling the frame is quite easy but I'm straggling on how getting all labels belonging to that frame and changing the colour to Gray. I tried to  tag all the frame text boxes with their respective labels , and working on the text box level but it is just not working. Here is my code:</p>\n\n<pre><code>Private Sub cbxCSENetworkDeseign_Click()\nDim Tbox As MSForms.TextBox\n\n    If cbxCSENetworkDeseign.Value = True Then  'Check box that will disable / enable the frame\n        frmCustomerDetails.Enabled = False\n        For Each Tbox In frmCustomerDetails.Controls\n            Controls(Tbox.Tag).ForeColor = vbGrayText\n        Next Tbox\n    Else\n        frmCustomerDetails.Enabled = True\n        For Each Tbox In frmCustomerDetails.Controls\n            Controls(Tbox.Tag).ForeColor = vbBlack\n        Next Tbox\n    End If   \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "syntax-error"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1446053241, "post_id": 33397041, "comment_id": 54586685, "body": "You have two areas in your range - <code>A:H</code> and <code>J:R</code>.  <code>maplage.Rows(1).address</code> will naturally use the first area, while <code>maplage.Areas(2).Rows(1).address</code> will return J:R.  The Union method <code>Set MaPlage = Union(Range(&quot;A:H&quot;), Range(&quot;J:R&quot;))</code> will still return two areas.  Maybe better to set a reference to A:R?"}, {"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1446054193, "post_id": 33397041, "comment_id": 54587369, "body": "can i use that for more than 2 or three areas"}, {"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1446054460, "post_id": 33397041, "comment_id": 54587541, "body": "@DarrenBartrup-Cook i tried that but is still takes only the first area  <code>Set MaPlage = Union(Range(&quot;A:H&quot;), Range(&quot;J:R&quot;)).Rows(q)</code>"}, {"owner": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "edited": false, "score": 0, "creation_date": 1446058136, "post_id": 33397041, "comment_id": 54589804, "body": "Some commands like Row don&#39;t allow for ranges with more than one area. You could try instead with: <code>Intersect(Range(&quot;A:H, J:R&quot;),Rows(q))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1446056859, "post_id": 33398237, "comment_id": 54589025, "body": "Thank you  so much @Tim Williams"}, {"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1446056948, "post_id": 33398237, "comment_id": 54589079, "body": "I would like to know how to color if one or more  of these cells are empty"}, {"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1446164466, "post_id": 33398237, "comment_id": 54642819, "body": "Hey @Tim Williams i tried it it dosn&#39;t really work     <code>Dim g As Integer        Dim MaPlage As Range, c As Range  Dim q As Integer  For q = 2 To ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row  Set MaPlage = Sheet1.Range(Replace(&quot;A#:H#,J#:R#&quot;, &quot;#&quot;, q))  For Each c In MaPlage .Cells  If Len(c.Value) = 0 Then c.Interior.Color = vbRed  If CStr(ActiveSheet.Cells(q, 31).Value) = &quot;Completed - Appointment made &#47; Compl&#233;t&#233; - Nomination faite&quot; _  And WorksheetFunction.CountIf(MaPlage, &quot;&quot;) = 0 Then</code>"}, {"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1446164498, "post_id": 33398237, "comment_id": 54642836, "body": "<code>Select Case UCase(ActiveSheet.Cells(q, 14).Value)  Case &quot;INA_CIN&quot;  ActiveSheet.Cells(q, 42).Value = &quot;XX&quot;  End Select  End If  Next c  Next q</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446165732, "post_id": 33398237, "comment_id": 54643152, "body": "<i>Update your question</i> and add your code there: code in comments is impossible to read."}, {"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1446237744, "post_id": 33398237, "comment_id": 54677399, "body": "@TimWilliams Thank u for trying to help me out but it doesn&#39;t work really good , i fixed another code ( i updated the code on the top) but the problem he does not take the last row , he stopped always on the one before the last row of the tab"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1446221924, "last_edit_date": 1446221924, "creation_date": 1446054920, "answer_id": 33398237, "question_id": 33397041, "link": "https://stackoverflow.com/questions/33397041/how-to-colors-empty-cells/33398237#33398237", "title": "how to colors empty cells", "body": "<p><strong>EDIT:</strong> updated to show how to highlight empty cells</p>\n\n<pre><code>Dim MaPlage As Range, c As Range\n\nSet MaPlage = Sheet1.Range(Replace(\"A#:H#,J#:R#\", \"#\", q)) \n\nFor Each c In MaPlage.Cells '&lt;&lt;EDIT2 to remove extra space\n    If Len(c.Value) = 0 Then c.Interior.Color = vbRed\nNext c\n</code></pre>\n\n<p>EDIT2:</p>\n\n<pre><code>Sub TT()\n\n    Const S As String = \"Completed - Appointment made / Compl\u00e9t\u00e9 - Nomination faite\"\n\n    Dim MaPlage As Range, c As Range, rw As Range\n    Dim q As Integer, blanks As Long\n\n       For q = 2 To ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row\n\n           Set rw = Sheet1.Rows(q)\n           Set MaPlage = rw.Range(\"A1:H1,J1:R1\")\n           blanks = 0\n           For Each c In MaPlage.Cells\n               If Len(c.Value) = 0 Then\n                  c.Interior.Color = vbRed\n                  blanks = blanks + 1\n               End If\n           Next c\n\n           If CStr(rw.Cells(31).Value) = S And blanks = 0 Then\n               Select Case UCase(rw.Cells(14).Value)\n                Case \"INA_CIN\"\n                    rw.Cells(42).Value = \"XX\"\n                End Select\n           End If\n\n    Next q\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 33398237, "answer_count": 1, "score": 0, "last_activity_date": 1446237582, "creation_date": 1446051348, "last_edit_date": 1531164843, "question_id": 33397041, "link": "https://stackoverflow.com/questions/33397041/how-to-colors-empty-cells", "title": "how to colors empty cells", "body": "<p>it works good but he doesn't take the last line of the tab </p>\n\n<p>can u please help me to find my errors !</p>\n\n<pre><code>         Dim c As Range\n</code></pre>\n\n<p><code>Dim MaPlage As Range</code></p>\n\n<pre><code>   For q = 2 To ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row\n\nSet MaPlage = Range(\"A:H, J:R\").Rows(q)\n For Each c In MaPlage.Cells\nIf Len(c.Value) = 0 Then c.Interior.Color = vbYellow\n\nIf CStr(ActiveSheet.Cells(q, 31).Value) = \"Completed - Appointment made / Compl\u00e9t\u00e9 - Nomination faite\" _\n     And WorksheetFunction.CountIf(MaPlage, \"\") = 0 Then\n    Select Case UCase(ActiveSheet.Cells(q, 14).Value)\n        Case \"INA_CIN\"\n            ActiveSheet.Cells(q, 42).Value = \"XX\"\n    End Select\nEnd If\n\nNext c\n</code></pre>\n\n<p><code>Next q</code></p>\n"}, {"tags": ["vba", "excel", "button", "for-loop", "worksheet"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1446051592, "post_id": 33397040, "comment_id": 54585576, "body": "Maybe use <code>Set btn = ThisWorkbook.Sheets(&quot;Navigation&quot;).Buttons.Add(rng.Left, rng.Top, rng.Width, rng.Height * 2) </code>?"}, {"owner": {"reputation": 165, "user_id": 1304152, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e60976c8c2ba3122059557c2685e64c3?s=128&d=identicon&r=PG", "display_name": "Eli Greenberg", "link": "https://stackoverflow.com/users/1304152/eli-greenberg"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1446051729, "post_id": 33397040, "comment_id": 54585658, "body": "<i>sigh</i>, I&#39;d give you a check mark if I could. Thank you for the help."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1446051962, "post_id": 33397040, "comment_id": 54585789, "body": "Wasn&#39;t use if the Buttons collection was Workbook wide or WorkSheet wide"}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1446051897, "creation_date": 1446051897, "answer_id": 33397204, "question_id": 33397040, "link": "https://stackoverflow.com/questions/33397040/creating-command-button-on-navigation-worksheet-for-all-other-worksheets/33397204#33397204", "title": "Creating command button on Navigation worksheet for all other worksheets", "body": "<p>You need to add the button in the Buttons collection of the Navigation Sheet.</p>\n\n<pre><code>Set btn = ThisWorkbook.Sheets(\"Navigation\").Buttons.Add(rng.Left, rng.Top, rng.Width, rng.Height * 2)\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 1304152, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e60976c8c2ba3122059557c2685e64c3?s=128&d=identicon&r=PG", "display_name": "Eli Greenberg", "link": "https://stackoverflow.com/users/1304152/eli-greenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 33397204, "answer_count": 1, "score": 0, "last_activity_date": 1446051897, "creation_date": 1446051348, "question_id": 33397040, "link": "https://stackoverflow.com/questions/33397040/creating-command-button-on-navigation-worksheet-for-all-other-worksheets", "title": "Creating command button on Navigation worksheet for all other worksheets", "body": "<p>Current code:</p>\n\n<pre><code>Sub CreateFormsButton()\n\nDim ws As Worksheet\nDim btn As Button\nDim rng As Range\nDim counter As String\ncounter = 6\n\nFor Each ws In ThisWorkbook.Worksheets\n     If ws.Name = \"Navigation\" Or ws.Name = \"Todo\" Then\n     Else\n     With ws\n        Set rng = ThisWorkbook.Sheets(\"Navigation\").Range(\"C\" + CStr(counter))\n        Set btn = .Buttons.Add(rng.Left, rng.Top, rng.Width, rng.Height * 2)\n     With btn\n        .Caption = ws.Name\n        .OnAction = \"GoToWS\"\n        .Font.Bold = True\n        .Font.Size = 16\n     End With\n     End With\n     End If\n     counter = counter + 2\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>The code sort of works as is, however, the buttons are being placed on the worksheets themselves instead of the Navigation worksheet as intended. Am I doing something incorrectly by setting <code>Set rng = ThisWorkbook.Sheets(\"Navigation\").Range(\"C\" + CStr(counter))</code>? This doesn't seem to be having any effect on where the button is being placed. Thanks for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446051218, "post_id": 33396921, "comment_id": 54585330, "body": "Can you do <code>workbooks.add</code> with a variable? I would just leave it at <code>add</code> then set a sheet to first sheet in newbook like <code>set ws=newbook.worksheets(&quot;Sheet1&quot;)</code> and use that later. You can name the sheet &quot;GMD&quot; afterwards. Lunch time so excuse me but can post code upon return ^_^;"}, {"owner": {"reputation": 35, "user_id": 4047967, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-uBHXHcAAu_U/AAAAAAAAAAI/AAAAAAAAAGI/bH9nO1ZUO64/photo.jpg?sz=128", "display_name": "Lee Carver", "link": "https://stackoverflow.com/users/4047967/lee-carver"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446051856, "post_id": 33396921, "comment_id": 54585734, "body": "I don&#39;t see why I couldn&#39;t, but I don&#39;t think that is what is causing the paste problem? However, I could be completely dense. I&#39;ve also updated the code above to reflect a change. One of my cells contains linebreaks (which I need to transfer over to the new document). So I had to add a new loop to accommodate. I&#39;m still stuck with only one line copying over however, and it doesn&#39;t copy over the header that is on row 1 either. Your insight would be greatly appreciated."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446052394, "post_id": 33396921, "comment_id": 54586083, "body": "Scott&#39;s got it. You&#39;re in good hands."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4047967, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-uBHXHcAAu_U/AAAAAAAAAAI/AAAAAAAAAGI/bH9nO1ZUO64/photo.jpg?sz=128", "display_name": "Lee Carver", "link": "https://stackoverflow.com/users/4047967/lee-carver"}, "edited": false, "score": 0, "creation_date": 1446053595, "post_id": 33397264, "comment_id": 54586958, "body": "Scott - brilliant! Thank you so much, works like a charm."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 35, "user_id": 4047967, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-uBHXHcAAu_U/AAAAAAAAAAI/AAAAAAAAAGI/bH9nO1ZUO64/photo.jpg?sz=128", "display_name": "Lee Carver", "link": "https://stackoverflow.com/users/4047967/lee-carver"}, "edited": false, "score": 1, "creation_date": 1446066140, "post_id": 33397264, "comment_id": 54594343, "body": "@LeeCarver - there&#39;s some good info. in there if you&#39;re new to VBA.  Try and see how he removed the need to use <code>.Select</code>, and how he avoided the copy/paste by setting a range&#39;s values.  Both great practices to learn, just FYI.  They speed up the macro and reduce room for errors (especially by removing the <code>.Select</code>)."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1446053166, "last_edit_date": 1446053166, "creation_date": 1446052060, "answer_id": 33397264, "question_id": 33396921, "link": "https://stackoverflow.com/questions/33396921/copy-looping-rows-to-new-workbook/33397264#33397264", "title": "Copy Looping Rows to New Workbook", "body": "<p>The problem is that in you paste section you are only calling the first cell and it is in the loop so each time the loop will paste in cell A1.</p>\n\n<p>Also if all you want is values, it is best to skip the clipboard and assign the values directly. With this you can avoid the loop all together.</p>\n\n<p>Thirdly avoid using the select.</p>\n\n<p>Edit: Removed loop and added the wrap text for the line breaks.</p>\n\n<pre><code>Dim i, LastRow\nDim ws As Worksheet\n\nSet oldbook = ActiveWorkbook\nSet ws = oldbook.Sheets(\"Entry Sheet\")\nSet newbook = Workbooks.Add(xlWBATWorksheet)\n   With newbook\n        .ActiveSheet.Name = \"GMD\"\n   End With\nWith ws\n    LastRow = .Range(\"AJ\" &amp; .Rows.Count).End(xlUp).Row ''Finds the last row of the column with text\n\n    newbook.Sheets(\"GMD\").Range(newbook.Sheets(\"GMD\").Cells(1, 1), newbook.Sheets(\"GMD\").Cells(LastRow, 7)).Value = .Range(.Cells(1, 36), .Cells(LastRow, 43)).Value\n\nEnd With\nnewbook.Sheets(\"GMD\").Range(\"H:I\").WrapText = True\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4047967, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-uBHXHcAAu_U/AAAAAAAAAAI/AAAAAAAAAGI/bH9nO1ZUO64/photo.jpg?sz=128", "display_name": "Lee Carver", "link": "https://stackoverflow.com/users/4047967/lee-carver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 33397264, "answer_count": 1, "score": 1, "last_activity_date": 1446053166, "creation_date": 1446050990, "last_edit_date": 1531161705, "question_id": 33396921, "link": "https://stackoverflow.com/questions/33396921/copy-looping-rows-to-new-workbook", "title": "Copy Looping Rows to New Workbook", "body": "<p>I'm trying to copy data from columns AJ through AQ from one workbook and paste the values in a new workbook. The number of rows is variable (dependent on the user). I've tried implementing the following code, but it only pastes the first row into the new workbook:</p>\n\n<pre><code> Dim i, j, LastRow, LastRow2\n\n Set OldBook = ActiveWorkbook\n Set NewBook = Workbooks.Add(xlWBATWorksheet)\n      With NewBook\n           .ActiveSheet.Name = \"GMD\"\n      End With\n\n OldBook.Activate\n Sheets(\"Entry Sheet\").Select\n\n LastRow = ActiveSheet.Range(\"AJ\" &amp; Rows.Count).End(xlUp).Row ''Finds the last row of the column with text\n LastRow2 = ActiveSheet.Range(\"AQ\" &amp; Rows.Count).End(xlUp).Row ''Finds the last row of the column with text\n\n\n For i = 1 To LastRow ''Sets the range of rows to be copied including header\n\n Range(Cells(i, 36), Cells(i, 43)).Select ''Selects relevant columns\n Selection.Copy\n\n NewBook.Activate\n Range(\"A1\").Select\n Selection.PasteSpecial Paste:=xlPasteValues\n OldBook.Activate\n Sheets(\"Entry Sheet\").Select\n\n Next i\n\n For j = 1 To LastRow ''Sets the range of Rows to be copied including header\n Range(Cells(j, 43), Cells(j, 44)).Select ''Selects relevant columns\n Selection.Copy\n\n NewBook.Activate\n Range(\"H1\").Select\n ActiveSheet.Paste\n OldBook.Activate\n Sheets(\"Entry Sheet\").Select\n\n Next j\n</code></pre>\n\n<p>Any observations on what I'm doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 4, "creation_date": 1446049843, "post_id": 33396458, "comment_id": 54584364, "body": "Guessing <code>sheets(h)</code> is faulty..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1446049853, "post_id": 33396458, "comment_id": 54584371, "body": "What is the value of h when it stops?  does it equal the name of one of your sheets"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1446050165, "post_id": 33396458, "comment_id": 54584606, "body": "you are using <code>v</code> to create the named sheets but then <code>a</code> to access them. Maybe the data in <code>v</code> and <code>a</code> doesn&#39;t mesh properly."}, {"owner": {"reputation": 9, "user_id": 3546470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7da29c88ee054498e9eb7bac0e7c4086?s=128&d=identicon&r=PG&f=1", "display_name": "EliteNewb", "link": "https://stackoverflow.com/users/3546470/elitenewb"}, "edited": false, "score": 0, "creation_date": 1446050205, "post_id": 33396458, "comment_id": 54584636, "body": "It stays on the last sheet. (which is Vancouver)  For example, if I use some other column, it works ok - sometimes."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1446050275, "post_id": 33396458, "comment_id": 54584679, "body": "It would be nice if you used better variables XD Code so hard to follow ;_;"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1446050571, "post_id": 33396458, "comment_id": 54584890, "body": "You do a Worksheet Exists test in the portion right above that, why not do another Worksheet Exists test when you change the value of <code>h</code> again."}, {"owner": {"reputation": 9, "user_id": 3546470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7da29c88ee054498e9eb7bac0e7c4086?s=128&d=identicon&r=PG&f=1", "display_name": "EliteNewb", "link": "https://stackoverflow.com/users/3546470/elitenewb"}, "edited": false, "score": 0, "creation_date": 1446050674, "post_id": 33396458, "comment_id": 54584959, "body": "Haha, I&#39;m trying! I&#39;m sort of new to VBA (learned it all from homeandlearn.org) so I&#39;m still getting a grasp on this.  I didn&#39;t think I would need one because it works for other columns; so I&#39;m confused on what&#39;s causing the current location to flop."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1446052264, "post_id": 33396458, "comment_id": 54585988, "body": "The 1st error is looking for &quot;Price-1&quot; worksheet, it does not exist... so the &quot;Sub-script is out of range&quot;"}, {"owner": {"reputation": 9, "user_id": 3546470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7da29c88ee054498e9eb7bac0e7c4086?s=128&d=identicon&r=PG&f=1", "display_name": "EliteNewb", "link": "https://stackoverflow.com/users/3546470/elitenewb"}, "edited": false, "score": 0, "creation_date": 1446053347, "post_id": 33396458, "comment_id": 54586765, "body": "Davesexcel - Thanks for your help! I solved it!"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 3546470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7da29c88ee054498e9eb7bac0e7c4086?s=128&d=identicon&r=PG&f=1", "display_name": "EliteNewb", "link": "https://stackoverflow.com/users/3546470/elitenewb"}, "is_accepted": false, "score": 0, "last_activity_date": 1446054798, "last_edit_date": 1446054798, "creation_date": 1446053625, "answer_id": 33397784, "question_id": 33396458, "link": "https://stackoverflow.com/questions/33396458/run-time-error-9-sub-script-out-of-range-error-in-excel-vba/33397784#33397784", "title": "Run-time Error &#39;9&#39;. Sub-script out of range error in Excel VBA", "body": "<p>I modified the code and understood what the problem was. Here's the updated code and if you guys ever need to do something similar - hope this helps.</p>\n\n<pre><code>Option Explicit\nSub DistributeRows()\n\nDim a As Variant, h As String\nDim i As Long, nr As Long\nDim rng As Range, c As Range, v\n\nApplication.ScreenUpdating = False\n\n//Change Range(\"XX#:X\" to whatever you want to create new tabs from.\n\n    With Sheets(\"Sheet1\")\n      a = .Cells(1).CurrentRegion\n      Set rng = .Range(\"M2:M\" &amp; UBound(a, 1))\n    End With\n\n    With CreateObject(\"Scripting.Dictionary\")\n      .CompareMode = vbTextCompare\n\n      For Each c In rng\n        If c &lt;&gt; \"\" Then\n          If Not .Exists(c.Value) Then\n            .Add c.Value, c.Value\n          End If\n        End If\n      Next\n      v = Application.Transpose(Array(.keys))\n    End With\n\n    For i = LBound(v) To UBound(v)\n      h = v(i, 1)\n        If Not WorksheetExists(h) Then\n          Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = h\n          Sheets(h).Range(\"A1\").Resize(, UBound(a, 2)).Value = Sheets(\"Sheet1\").Range(\"A1\").Resize(, UBound(a, 2)).Value\n        End If\n\n    Next i\n        For i = 2 To UBound(a, 1)\n            h = a(i, 13)\n            nr = Sheets(h).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Row\n            Sheets(h).Range(\"A\" &amp; nr).Resize(, 16).Value = Sheets(\"Sheet1\").Cells(i, 1).Resize(, 16).Value\n            Sheets(h).Columns.AutoFit\n    Next i\n    // Change the Resize(, XX) to whatever you want to copy until.\n    // Also change the H = a(i,XX) to whatever column your \"tab names\" are at.\n    // \n    Sheets(\"Sheet1\").Activate\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nFunction WorksheetExists(WSName As String) As Boolean\nOn Error Resume Next\nWorksheetExists = Worksheets(WSName).Name = WSName\nOn Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 3546470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7da29c88ee054498e9eb7bac0e7c4086?s=128&d=identicon&r=PG&f=1", "display_name": "EliteNewb", "link": "https://stackoverflow.com/users/3546470/elitenewb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446054798, "creation_date": 1446049720, "last_edit_date": 1446050694, "question_id": 33396458, "link": "https://stackoverflow.com/questions/33396458/run-time-error-9-sub-script-out-of-range-error-in-excel-vba", "title": "Run-time Error &#39;9&#39;. Sub-script out of range error in Excel VBA", "body": "<p>I'm getting a</p>\n\n<blockquote>\n  <p>Run-time Error '9' : Sub-script out of range.</p>\n</blockquote>\n\n<pre><code>Option Explicit\nSub DistributeRows()\n\nDim a As Variant, h As String\nDim i As Long, nr As Long\nDim rng As Range, c As Range, v\n\nApplication.ScreenUpdating = False\n\nWith Sheets(\"Sheet1\")\n  a = .Cells(1).CurrentRegion\n  Set rng = .Range(\"M2:M\" &amp; UBound(a, 1))\nEnd With\n\nWith CreateObject(\"Scripting.Dictionary\")\n  .CompareMode = vbTextCompare\n\n  For Each c In rng\n    If c &lt;&gt; \"\" Then\n      If Not .Exists(c.Value) Then\n        .Add c.Value, c.Value\n      End If\n    End If\n  Next\n  v = Application.Transpose(Array(.keys))\nEnd With\n\nFor i = LBound(v) To UBound(v)\n  h = v(i, 1)\n    If Not WorksheetExists(h) Then\n      Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = h\n      Sheets(h).Range(\"A1\").Resize(, UBound(a, 2)).Value = Sheets(\"Sheet1\").Range(\"A1\").Resize(, UBound(a, 2)).Value\n    End If\n\nNext i\n    For i = 2 To UBound(a, 1)\n        h = a(i, 3)\n        nr = Sheets(h).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Row\n        Sheets(h).Range(\"A\" &amp; nr).Resize(, 3).Value = Sheets(\"Sheet1\").Cells(i, 1).Resize(, 3).Value\n        Sheets(h).Columns.AutoFit\nNext i\n\nSheets(\"Sheet1\").Activate\nApplication.ScreenUpdating = True\nEnd Sub\n\nFunction WorksheetExists(WSName As String) As Boolean\nOn Error Resume Next\nWorksheetExists = Worksheets(WSName).Name = WSName\nOn Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>I'm getting the error on this line.</p>\n\n<p><code>nr = Sheets(h).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Row</code></p>\n\n<p>The excel sheet I'm trying to pull it from has information like this</p>\n\n<p><a href=\"http://imgur.com/vTXl5TG\" rel=\"nofollow\">Example</a>.</p>\n\n<p>Dropbox file related to the error </p>\n\n<p><a href=\"https://dl.dropboxusercontent.com/u/64819855/StackOverflow.xlsx\" rel=\"nofollow\">https://dl.dropboxusercontent.com/u/64819855/StackOverflow.xlsx</a></p>\n\n<p>The goal of this script is to create new tabs in the worksheet based on the \"Current Location (Column M)\". I have multiple current locations (maybe 100+).\nThen it would copy all the data relating to Column M. E.g. everything in Los Angeles, would be copied to the Los Angeles Tab.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "edited": false, "score": 0, "creation_date": 1446477906, "post_id": 33399237, "comment_id": 54746853, "body": "great, thanks! Finally, I got time to apply your code to my needs. Works like a charm"}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 2, "last_activity_date": 1446058210, "creation_date": 1446058210, "answer_id": 33399237, "question_id": 33395894, "link": "https://stackoverflow.com/questions/33395894/get-options-of-vba-dialogsxldialogsort/33399237#33399237", "title": "Get options of VBA Dialogs(xlDialogSort)", "body": "<p>As far as I know, you can't get parameters from a dialog box. You can send in parameters with the Show method, but they must be ByVal because they don't change. Sort and Find (and maybe some others) arguments persist from one call to the other. That means the next time you sort the same range, the dialog will remember what you did the previous time. Normally that's dangerous from a code perspective, but you can use it to your advantage here.</p>\n\n<pre><code>Dim srt As Sort\n\nIf Application.Dialogs(xlDialogSort).Show Then\n    Set srt = ActiveSheet.Sort\n    Debug.Print srt.SortFields(1).Key.Address\nEnd If\n</code></pre>\n\n<p>Whatever the user selects for the key of the first sort field will be print to the Immediate Window. You can get at any properties of the Sort object right after the dialog closes to see what was selected. Obviously to put together a whole picture will be more complicated than the code above.</p>\n"}], "owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 33399237, "answer_count": 1, "score": 2, "last_activity_date": 1446058210, "creation_date": 1446048057, "last_edit_date": 1446048532, "question_id": 33395894, "link": "https://stackoverflow.com/questions/33395894/get-options-of-vba-dialogsxldialogsort", "title": "Get options of VBA Dialogs(xlDialogSort)", "body": "<p>I need to implement the same sorting on several sheets. Moreover, I want user to set sorting rules manually using standard Sort dialog window.</p>\n\n<p>So, I want to create a procedure that will initiate Dialogs(xlDialogSort) window, and after user has specified sorting parameteres and clicked OK, procedure will \"read\" those parameters and apply them to several sheets through the macro (standard sorting code). </p>\n\n<p>Currently my code looks like the following:</p>\n\n<pre><code>Public Sub sortMultipleSheets()\n    Dim sortDiagAnswer As Boolean\n\n    sortDiagAnswer = Application.Dialogs(xlDialogSort).Show\n\n    If Err.Number = 1004 Then\n        MsgBox \"Place the cursor in the area to be sorted\"\n        Exit Sub\n    End If\n    Err.Clear\n\n    If sortDiagAnswer Then\n        'read user defined parameters\n        '...\n\n        actualSort (wsh1)\n        actualSort (wsh2)\n    End If\n\nEnd Sub\n\nPrivate Sub actualSort(ByVal wsh As Worksheet)\n    With wsh.Sort\n        With .SortFields\n            .Clear\n            .Add Key:= 'user-defined key1\n            .Add Key:= 'user-defined key2\n            .Add Key:= 'user-defined key3\n            'any more user-defined keys\n        End With\n        .SetRange Range('actual range)\n        .Header = 'setting from the sorting dialog window\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n\n<p>I am missing the part that will obtain user defined parameters on hitting OK button. \nAny ideas please?</p>\n"}, {"tags": ["excel", "math", "grouping", "equation", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1446108149, "post_id": 33397050, "comment_id": 54609374, "body": "Works like a charm, thanks. Also, I didn&#39;t know about application.evaluate so that&#39;s a bonus :)"}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 2, "last_activity_date": 1446051366, "creation_date": 1446051366, "answer_id": 33397050, "question_id": 33395851, "link": "https://stackoverflow.com/questions/33395851/excel-vba-math-count-how-many-groups-of-n-are-in-a-range-of-numbers/33397050#33397050", "title": "Excel VBA / math: count how many groups of n are in a range of numbers", "body": "<p>I'm not aware of any clever math to do this. You could do this with worksheet formulas:</p>\n\n<pre><code>=SUM(--(FREQUENCY(ROUND(r,dec_places),ROUND(r,dec_places))&gt;0))\n</code></pre>\n\n<p>where <code>r</code> is the data range and dec_places is the amount of rounding (since you're rounding to the nearest 10s, dec_places = -1).</p>\n\n<p>You could implement this in VBA with something like:</p>\n\n<pre><code>Function CountUniqueRounded(r As Range, dec_places As Double) As Long\n    ' Implement this worksheet formula\n    '    =SUM(--(FREQUENCY(ROUND(r,dec_places),ROUND(r,dec_places))&gt;0))\n    Dim rAddr As String\n    Dim rFormula As String\n    Dim c As Long\n\n    ' Build up the formula string\n    rAddr = r.Parent.Name &amp; \"!\" &amp; r.Address\n    rFormula = \"ROUND(\" &amp; rAddr &amp; \",\" &amp; CStr(dec_places) &amp; \")\"\n    rFormula = \"=SUM(--(FREQUENCY(\" &amp; rFormula &amp; \",\" &amp; rFormula &amp; \")&gt;0))\"\n    ' Debug.Print rFormula\n    c = Application.Evaluate(rFormula)\n    CountUniqueRounded = c\nEnd Function\n</code></pre>\n\n<p>Hope this helps</p>\n"}, {"comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1446107509, "post_id": 33397759, "comment_id": 54609036, "body": "Good explanation and one for the toolkit, thanks. As far as I know there&#39;s no way to use an array formula directly in VBA without setting it as a cell formula?"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1446121070, "post_id": 33397759, "comment_id": 54617734, "body": "I&#39;ve never done it, but I know you can - see here for starters: <a href=\"http://stackoverflow.com/q/24630187/5090027\">stackoverflow.com/q/24630187/5090027</a>"}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1446053562, "creation_date": 1446053562, "answer_id": 33397759, "question_id": 33395851, "link": "https://stackoverflow.com/questions/33395851/excel-vba-math-count-how-many-groups-of-n-are-in-a-range-of-numbers/33397759#33397759", "title": "Excel VBA / math: count how many groups of n are in a range of numbers", "body": "<p>I have an Array Formula solution which does not require VBA. Array Formulas take single function which would normally apply only to a single cell, and perform that function over a range of cells, returning an Array of different results (1 for each cell). That Array of results is then collapsed into a single number to give your answer.</p>\n\n<p>Assuming your data is in column A, and goes for less than 1000 rows, this will work:</p>\n\n<pre><code>=SUM(IFERROR(MATCH(10*(ROW(A1:A1000)),ROUND(A1:A1000,-1),0)*0+1,0))\n</code></pre>\n\n<p>Note that to confirm an Array Formula, you need to press CTRL + SHIFT + ENTER, isntead of just ENTER.</p>\n\n<p>What it does is multiplies 10 by each row from A1 to A1000, and then checks to see if that result can be found when rounding each cell present in A1 to A1000. That is, it checks 10, 20, etc. up to 1000, and tries to find it in a range of your rounded values. Whenever it finds a value, it multiplies the row it was found on by 0, and adds 1. Whenever it doesn't find a value (ie: returns an error), it shows 0. The sum of all matches gives you the number of times each rounded number from 10 - 1000 is found.</p>\n\n<p>Caveat - this will not work if you have numbers > 1000; if such numbers would occur you can easily change all instances of 1,000 to 10,000. Likewise if your data sometimes extends further than row 1000, you will need to increase all instances of 1000 to an appropriate number. If data would vary wildly and you can't estimate size / max limit, then there are ways to automate this, but as the formula is already somewhat complex, I left that as a manual process.</p>\n"}], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 33397050, "answer_count": 2, "score": 0, "last_activity_date": 1446053562, "creation_date": 1446047958, "last_edit_date": 1531161705, "question_id": 33395851, "link": "https://stackoverflow.com/questions/33395851/excel-vba-math-count-how-many-groups-of-n-are-in-a-range-of-numbers", "title": "Excel VBA / math: count how many groups of n are in a range of numbers", "body": "<p>I'm having a bit of a brain freeze, I thought this would be simple but it's not coming to me. I need an equation to calculate the number of groups of 10 in a variable range of variable data. Here's a small example, the real thing has hundreds of numbers with a variable min and max:</p>\n\n<pre><code>Number      Rounded number to nearest 10\n303.9       300\n285         290 - min\n443         440\n446.8       450\n461.1       460 - max\n428.83      430\n428.545     430\n445.835     450\n427.215     430\n429.97      430\n\nUnique groups of 10     \n300     \n290     \n440     \n450     \n460     \n430     \n\nAnswer = 6 groups\n</code></pre>\n\n<p>I don't want to use pivot tables or group functions, I'd rather keep it solely in VBA. Also I don't want to work out the rounded values first and then count the distinct ones because I'd like to use the number to dimension an array, which I'll then populate in a loop. Is there a clever bit of math that can give answer?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1446047361, "post_id": 33395595, "comment_id": 54582465, "body": "Conditional formatting on duplicates?"}, {"owner": {"reputation": 530, "user_id": 2173856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R2QTo.jpg?s=128&g=1", "display_name": "bushell", "link": "https://stackoverflow.com/users/2173856/bushell"}, "edited": false, "score": 0, "creation_date": 1446047930, "post_id": 33395595, "comment_id": 54582916, "body": "Should be easy to do using COUNTIF(), and maybe also creating a new cell that concatenates column A &amp; C, and then also do a COUNTIF() on that."}, {"owner": {"reputation": 769, "user_id": 1167535, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e25d239e49e71821a24fbfa80c05d458?s=128&d=identicon&r=PG", "display_name": "RoyRumaner", "link": "https://stackoverflow.com/users/1167535/royrumaner"}, "edited": false, "score": 0, "creation_date": 1446047994, "post_id": 33395595, "comment_id": 54582968, "body": "I had a thought and added a column that appended the two columns. I now have the Equipment Number and the date as a string (41203 = 10/21/2012)."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446048038, "post_id": 33395595, "comment_id": 54582999, "body": "see my answer below, rrumaner. It&#39;s in line with what you are thinking."}], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 1167535, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e25d239e49e71821a24fbfa80c05d458?s=128&d=identicon&r=PG", "display_name": "RoyRumaner", "link": "https://stackoverflow.com/users/1167535/royrumaner"}, "edited": false, "score": 0, "creation_date": 1446048309, "post_id": 33395828, "comment_id": 54583195, "body": "Thanks Scott, but that gave me 1/1/1900 in column E. I set the format to general and every row is a 1"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 769, "user_id": 1167535, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e25d239e49e71821a24fbfa80c05d458?s=128&d=identicon&r=PG", "display_name": "RoyRumaner", "link": "https://stackoverflow.com/users/1167535/royrumaner"}, "edited": false, "score": 0, "creation_date": 1446048412, "post_id": 33395828, "comment_id": 54583269, "body": "format column E as <code>Number</code> or <code>General</code> and you will see the number that is there. Right now it&#39;s in <code>Date</code> format."}, {"owner": {"reputation": 769, "user_id": 1167535, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e25d239e49e71821a24fbfa80c05d458?s=128&d=identicon&r=PG", "display_name": "RoyRumaner", "link": "https://stackoverflow.com/users/1167535/royrumaner"}, "edited": false, "score": 0, "creation_date": 1446049086, "post_id": 33395828, "comment_id": 54583770, "body": "Here is another wrinkle. Now that I see I have no duplicates (there are nothing but 1&#39;s), I need to determine if there are any dates within 1 or 2 days plus/minus each other. Is this even possible?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 769, "user_id": 1167535, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e25d239e49e71821a24fbfa80c05d458?s=128&d=identicon&r=PG", "display_name": "RoyRumaner", "link": "https://stackoverflow.com/users/1167535/royrumaner"}, "edited": false, "score": 2, "creation_date": 1446049689, "post_id": 33395828, "comment_id": 54584238, "body": "change the formula in step 4 in my answer to be <code>=COUNTIFS(C:C,C2,A:A,A2+1)+COUNTIFS(C:C,C2,A:A,A2+2)+COUNTIF&zwnj;&#8203;S(C:C,C2,A:A,A2-1)+C&zwnj;&#8203;OUNTIFS(C:C,C2,A:A,A&zwnj;&#8203;2-2)</code> and then filter on <code>&gt;= 1</code> in column E."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1446047898, "creation_date": 1446047898, "answer_id": 33395828, "question_id": 33395595, "link": "https://stackoverflow.com/questions/33395595/need-to-search-through-one-column-of-values-and-if-duplicates-are-found-compare/33395828#33395828", "title": "Need to search through one column of values and if duplicates are found, compare values in another column", "body": "<p>Here's a multiple step approach, but it will get you want you need:</p>\n\n<ol>\n<li>Sort by Equipment Number and Date together.</li>\n<li>Insert 2 blank columns after Column C</li>\n<li>Write this formula in the new column D: <code>=A2&amp;C2</code></li>\n<li>Write this formula in the new column E: <code>=Countif(D2,D:D)</code></li>\n<li>Filter column E on anything greater than 1</li>\n</ol>\n\n<p>You will then have all your duplicate equipment numbers with the same date.</p>\n"}], "owner": {"reputation": 769, "user_id": 1167535, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e25d239e49e71821a24fbfa80c05d458?s=128&d=identicon&r=PG", "display_name": "RoyRumaner", "link": "https://stackoverflow.com/users/1167535/royrumaner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 33395828, "answer_count": 1, "score": 0, "last_activity_date": 1446047898, "creation_date": 1446047284, "last_edit_date": 1531161705, "question_id": 33395595, "link": "https://stackoverflow.com/questions/33395595/need-to-search-through-one-column-of-values-and-if-duplicates-are-found-compare", "title": "Need to search through one column of values and if duplicates are found, compare values in another column", "body": "<p>I have a spreadsheet of over 9,000 rows and 27 columns. In column A is a date. in Column C is an Equipment Number consisting of letters and numbers. (example ITDX5096, ITD6082, ITDX6843)</p>\n\n<p>I need to compare the values in Col C, looking for duplicates. If one or more is found I then need to compare the dates of those rows for duplicate dates</p>\n\n<p>I have sorted Col C alpha. but I am not sure how to do the date comparison without scrolling through the entire sheet line by line. There could be as many as 20-30 of the same Equipment Number all with different dates. </p>\n\n<p>I would really like to color code any duplicates so that I can locate them quickly but that is probably just a wish on my part. What I need is a way to identify the duplicates so I can scroll the sheet and deal with them.</p>\n\n<p>Is there a way to do what I want?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1446046958, "post_id": 33395404, "comment_id": 54582141, "body": "Unclear how you want it split but try text to columns?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446047467, "post_id": 33395404, "comment_id": 54582540, "body": "yes, please provide more clarity on how you want to split the data, because your examples are all different. Then we can know if <a href=\"https://support.office.com/en-us/article/Split-names-by-using-the-Convert-Text-to-Columns-Wizard-2cd989db-2b1f-4d89-b17b-534250ff9905\" rel=\"nofollow noreferrer\">text-to-columns</a> will work, or perhaps even a formula."}, {"owner": {"reputation": 21, "user_id": 5207528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/515ed50ee169a5096ea96eb143268c0c?s=128&d=identicon&r=PG&f=1", "display_name": "HotCoffee", "link": "https://stackoverflow.com/users/5207528/hotcoffee"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446802110, "post_id": 33395404, "comment_id": 54905038, "body": "@ScottHoltzman Text-to-column does not work as the data would turn out to be a continuous string. See what I mean:  &quot;1-12345605-456789&quot;"}, {"owner": {"reputation": 21, "user_id": 5207528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/515ed50ee169a5096ea96eb143268c0c?s=128&d=identicon&r=PG&f=1", "display_name": "HotCoffee", "link": "https://stackoverflow.com/users/5207528/hotcoffee"}, "edited": false, "score": 0, "creation_date": 1447083122, "post_id": 33395404, "comment_id": 54999324, "body": "I&#39;ve updated more a more accurate scenario to my question above. Appreciate if you guys can help me out."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5207528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/515ed50ee169a5096ea96eb143268c0c?s=128&d=identicon&r=PG&f=1", "display_name": "HotCoffee", "link": "https://stackoverflow.com/users/5207528/hotcoffee"}, "edited": false, "score": 0, "creation_date": 1446800894, "post_id": 33395967, "comment_id": 54904314, "body": "No. They are in the same cell. Meaning 1-123456 is on top of 9-52364  in the same cell in Row &quot;A&quot; Column &quot;Product ID&quot;."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1446048258, "creation_date": 1446048258, "answer_id": 33395967, "question_id": 33395404, "link": "https://stackoverflow.com/questions/33395404/splitting-multiple-values-data-in-a-single-cell/33395967#33395967", "title": "Splitting multiple values data in a single cell", "body": "<p>If your sample data is column A and B, you could use this formula and drag down.  I'm assuming that \"a\" is on the same row as \"1-13456\" and \"9-52364\" is on the row just below it.</p>\n\n<p>Place this in C2 (assuming headers): <code>=if(and(a3=\"\",b3&lt;&gt;\"\",a2&lt;&gt;\"\"),b2&amp;b3,\"\")</code></p>\n\n<p>And drag down.</p>\n"}], "owner": {"reputation": 21, "user_id": 5207528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/515ed50ee169a5096ea96eb143268c0c?s=128&d=identicon&r=PG&f=1", "display_name": "HotCoffee", "link": "https://stackoverflow.com/users/5207528/hotcoffee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1446802024, "creation_date": 1446046808, "last_edit_date": 1531161705, "question_id": 33395404, "link": "https://stackoverflow.com/questions/33395404/splitting-multiple-values-data-in-a-single-cell", "title": "Splitting multiple values data in a single cell", "body": "<p>How do I split/ separate a string of data in a single cell in product ID:</p>\n\n<p>Apologies.. it is rather challenging to explain my situation and I am unable to post a pic. Could you kindly visit the below link to view the screenshot pls.</p>\n\n<p><a href=\"http://i.imgur.com/rC9SxkX.png\" rel=\"nofollow\">http://i.imgur.com/rC9SxkX.png</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446046318, "post_id": 33395166, "comment_id": 54581673, "body": "Have you tried <code>find</code>?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1446046395, "post_id": 33395166, "comment_id": 54581723, "body": "No it isn&#39;t hard code, but SO is not a &quot;do my code for me&quot; website... The ultimate &quot;How to ask a VBA question on SO&quot;: 1. Write down all the steps that you want your code to accomplish 2. Write out the pseudocode to accomplish your goal 3. Break out each of those steps and Google or search SO for the code related to that step 4. Replace the pseduocode with real code and test. Debug errors. 5. If there are errors you can&#39;t get around through searching or trial and error, THEN you can ask a new question on SO."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1446046996, "creation_date": 1446046996, "answer_id": 33395466, "question_id": 33395166, "link": "https://stackoverflow.com/questions/33395166/delete-row-with-certain-text/33395466#33395466", "title": "Delete row with certain text", "body": "<p>Normally I'd wait for some code on your part, but this isn't too complex, so here's something that should get you started:</p>\n\n<pre><code>Sub test()\nDim lastRow&amp;, i&amp;\nDim findStr$\n\nfindStr = \"Planning\"\n\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = lastRow To 1 Step -1 ' change this to 2 if you have headers\n    If Cells(i, 1).Value = findStr Then\n        'Range(Rows(i), Rows(i - 4)).Select\n        Range(Rows(i), Rows(i - 4)).EntireRow.Delete\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>This is assuming that \"Planning\" will be in Column A (\"The row always starts with the word 'Planning'\"). If not, change the ranges to match where it would be found.</p>\n"}], "owner": {"reputation": 75, "user_id": 5104582, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70b53947d3eaa59131176d25470f3074?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5104582/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1446681073, "accepted_answer_id": 33395466, "answer_count": 1, "score": -1, "last_activity_date": 1446052476, "creation_date": 1446046202, "last_edit_date": 1446052476, "question_id": 33395166, "link": "https://stackoverflow.com/questions/33395166/delete-row-with-certain-text", "closed_reason": "Needs details or clarity", "title": "Delete row with certain text", "body": "<p>I have VBA code that cleans up my data and sets text to columns. The row always starts with the word <code>Planning</code>. I need a code that will delete that row and the four rows above it. Hopefully this isn't a hard code.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446045604, "post_id": 33394611, "comment_id": 54581167, "body": "what line do you get the error on?"}, {"owner": {"reputation": 43, "user_id": 875698, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5da1bc3c0420777bbaf886c5ac57903f?s=128&d=identicon&r=PG", "display_name": "Deany", "link": "https://stackoverflow.com/users/875698/deany"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446046477, "post_id": 33394611, "comment_id": 54581780, "body": "Sorry about that, this line as it is now over 12:  pt.PivotFields(&quot;Dealing Date&quot;).CurrentPage = Date + 1"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446046649, "post_id": 33394611, "comment_id": 54581923, "body": "does the value for 10/29/2015 (which is date + 1 as of now) exist in the <code>Dealing Date</code> field? If not, the pivot table will not be able to display that date."}, {"owner": {"reputation": 43, "user_id": 875698, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5da1bc3c0420777bbaf886c5ac57903f?s=128&d=identicon&r=PG", "display_name": "Deany", "link": "https://stackoverflow.com/users/875698/deany"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446048016, "post_id": 33394611, "comment_id": 54582982, "body": "Yes. It seems the +1 is the issue, if i do +2 it works fine. Really weird..."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446048129, "post_id": 33394611, "comment_id": 54583063, "body": "It&#39;s a matter of what dates are available in the <code>Dealing Date</code> field at any given time. If the date does not exist, it will not work. You may need to write a statement that checks for the date and if it is not there, make a decision from there."}, {"owner": {"reputation": 43, "user_id": 875698, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5da1bc3c0420777bbaf886c5ac57903f?s=128&d=identicon&r=PG", "display_name": "Deany", "link": "https://stackoverflow.com/users/875698/deany"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1446048273, "post_id": 33394611, "comment_id": 54583165, "body": "Seems to have fixed the issue by putting Date + 1 as a string, slightly strange but did the trick."}], "answers": [{"tags": [], "owner": {"reputation": 4301, "user_id": 4381330, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4373cf5624ae7b7e77bd2017abad9850?s=128&d=identicon&r=PG&f=1", "display_name": "Mincong Huang", "link": "https://stackoverflow.com/users/4381330/mincong-huang"}, "is_accepted": false, "score": 0, "last_activity_date": 1446049877, "creation_date": 1446049877, "answer_id": 33396521, "question_id": 33394611, "link": "https://stackoverflow.com/questions/33394611/pivottable-cell-change/33396521#33396521", "title": "PivotTable cell change", "body": "<p>You can replace your code by the following one, or other date-pattern, such as <code>yyyy/MM/dd</code> :</p>\n\n<pre><code>pt.PivotFields(\"Dealing Date\").CurrentPage = Format(Date, \"dd/MM/yyyy\")\npt.PivotFields(\"Dealing Date\").CurrentPage = Format(Date + 1, \"dd/MM/yyyy\")\n</code></pre>\n\n<p>However, <strong>it won't help you the choose the correct date</strong>. Because these lines modify the current display values.</p>\n\n<p>You can try the following lines :</p>\n\n<pre><code>Sub ChngDate()\n\nDim pt As PivotTable\nSet pt = Worksheets(1).PivotTables(1)\n\n'pt.PivotFields(\"Dealing Date\").ClearAllFilters\n\n' if time is before 12\nWith pt.PivotFields(\"Dealing Date\")\n    If Hour(Now) &lt; 12 Then\n        'pt.PivotFields(\"Dealing Date\").CurrentPage = Date\n        .PivotItems(Format(Date, \"dd/MM/yyyy\")).Visible = True\n    ElseIf Hour(Now) &gt;= 12 Then\n        'pt.PivotFields(\"Dealing Date\").CurrentPage = Date + 1\n        .PivotItems(Format(Date + 1, \"dd/MM/yyyy\")).Visible = True\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 875698, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5da1bc3c0420777bbaf886c5ac57903f?s=128&d=identicon&r=PG", "display_name": "Deany", "link": "https://stackoverflow.com/users/875698/deany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446052584, "creation_date": 1446044713, "last_edit_date": 1446052584, "question_id": 33394611, "link": "https://stackoverflow.com/questions/33394611/pivottable-cell-change", "title": "PivotTable cell change", "body": "<p>Trying to get the <code>Dealing Date</code> cell to change. The cell updates if the code is run on its own, but when put as part of a script it doesn't seem to run:</p>\n\n<pre><code>Sub ChngDate()\n\nDim pt As PivotTable\nSet pt = Worksheets(1).PivotTables(1)\n\n'pt.PivotFields(\"Dealing Date\").ClearAllFilters\n\n' if time is before 12\nIf Hour(Now) &lt; 12 Then\n    pt.PivotFields(\"Dealing Date\").CurrentPage = Date\nElseIf Hour(Now) &gt;= 12 Then\n    pt.PivotFields(\"Dealing Date\").CurrentPage = Date + 1\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>When running the above I get :</p>\n\n<blockquote>\n  <p>run-time error 5, invalid procedure or call argument</p>\n</blockquote>\n\n<p>The PivotTable is the only one on the workbook and located within sheet 1.  </p>\n\n<p>Any idea why?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1446044599, "post_id": 33394562, "comment_id": 54580380, "body": "Conditional formatting?"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446044786, "post_id": 33394562, "comment_id": 54580526, "body": "@findwindow is right that conditional formatting will likely be easier than VBA - unless you have other VBA things, in which case you might prefer this method. In short, you will need to create a loop which creates a counter and looks at each row of S that you care about."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1446044863, "post_id": 33394562, "comment_id": 54580579, "body": "I would use conditional formatting like @fndwindow stated, but if you want to keep it in vba, then look into <code>for</code> loops to iterate through a given range."}], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1446044939, "creation_date": 1446044939, "answer_id": 33394700, "question_id": 33394562, "link": "https://stackoverflow.com/questions/33394562/changing-cell-value-for-a-range-of-cells-without-multiple-if-statments/33394700#33394700", "title": "Changing cell value for a range of cells without multiple if statments", "body": "<p>To elaborate on my comment, you could do something like this:</p>\n\n<pre><code>For i = 5 to 100\n\n    If LCase(Sheets(1).Range(\"S\"&amp;i).Value) = \"yes\" Then\n        Sheets(1).Range(\"T\"&amp;i).Interior.ColorIndex = 33\n\n    ElseIf Sheets(1).Range(\"S\"&amp;i).Value &lt;&gt; \"\" Then\n        Sheets(1).Range(\"T\"&amp;i).Interior.ColorIndex = 19\n\n    Else\n        Sheets(1).Range(\"T\"&amp;i).Interior.ColorIndex = 0\n    End If\nNext i\n</code></pre>\n\n<p>Note how instead of referring directly to \"S5\", instead the code refers to Si [for whatever number i is, starting at 5 and going row by row up to 100].</p>\n"}, {"tags": [], "owner": {"reputation": 549, "user_id": 1010036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5qzXf.png?s=128&g=1", "display_name": "LimpingNinja", "link": "https://stackoverflow.com/users/1010036/limpingninja"}, "is_accepted": false, "score": 0, "last_activity_date": 1446045506, "creation_date": 1446045506, "answer_id": 33394906, "question_id": 33394562, "link": "https://stackoverflow.com/questions/33394562/changing-cell-value-for-a-range-of-cells-without-multiple-if-statments/33394906#33394906", "title": "Changing cell value for a range of cells without multiple if statments", "body": "<p>Conditional formatting in EXCEL would probably be the best way to handle this:</p>\n\n<ul>\n<li><a href=\"http://www.techonthenet.com/excel/questions/cond_format9_2010.php\" rel=\"nofollow\">Conditional Formatting</a></li>\n</ul>\n\n<p>Grade 'Eh' Bacon gave a good solution for doing this, and it is acceptable. Here is another solution that should work fine and allows some different math based Column/Row solutions if you need to make these actions more modular.</p>\n\n<pre><code>Set myRange = Range(\"S5:S100\")\n\nFor Each cell in myRange\n    If LCase(cell.Value) = \"yes\" Then\n        cell.Offset(0, 1).Interior.ColorIndex = 33\n    ElseIf LCase(cell.Value) = \"no\" Then\n        cell.Offset(0, 1).Interior.ColorIndex = 19\n    Else\n        cell.Offset(0, 1).Interior.ColorIndex = 0\n    End If\nNext\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff840060.aspx\" rel=\"nofollow\">Range Offset Information</a></p>\n"}, {"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 0, "last_activity_date": 1446053308, "last_edit_date": 1446053308, "creation_date": 1446051211, "answer_id": 33396995, "question_id": 33394562, "link": "https://stackoverflow.com/questions/33394562/changing-cell-value-for-a-range-of-cells-without-multiple-if-statments/33396995#33396995", "title": "Changing cell value for a range of cells without multiple if statments", "body": "<p>Here is an interesting way to do this:</p>\n\n<pre><code>Const FORMULA = \"CHOOSE(MMULT(--(~&gt;{\"\"yerz\"\",\"\"\"\"}),{1;1})+1,0,19,33)\"\nWith [t5:t100]\n    v = Evaluate(Replace(FORMULA, \"~\", .Address))\n    For i = 1 To .Count\n        .Item(i, 2).Interior.ColorIndex = v(i, 1)\n    Next\nEnd With\n</code></pre>\n\n<p>This small solution packs a lot of learning opportunities that can be leveraged far beyond this question.</p>\n\n<p>Notice that your color numbers can be edited at the end of the first line.</p>\n\n<p>Here is what is happening.</p>\n\n<p>We use the Evaluate function to evaluate a formula that takes your range of values <code>T5:T100</code> and produces an array of color numbers.</p>\n\n<p>We then assign each value in the array to the ColorIndex of the cell to the right.</p>\n\n<p>The challenging part is creating the formula that will result in the appropriate array of color numbers.  :)</p>\n"}], "owner": {"reputation": 131, "user_id": 5469176, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/031e28aeacbf16f3a78ece53dcc8f18b?s=128&d=identicon&r=PG&f=1", "display_name": "SFro", "link": "https://stackoverflow.com/users/5469176/sfro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1446053308, "creation_date": 1446044559, "last_edit_date": 1531161705, "question_id": 33394562, "link": "https://stackoverflow.com/questions/33394562/changing-cell-value-for-a-range-of-cells-without-multiple-if-statments", "title": "Changing cell value for a range of cells without multiple if statments", "body": "<p>I would like to change the color of a cell based on the value of an adjacent cell. The following code is working properly for a single cell, but I would like it to apply to a range of cells, currently it looks at the value of S5 and changes to color of T5, I would like this to iterate for a range of cells (S5 to S100 matching with T5 to T100). How can I do this without needing to make an if statement for 100 cells?</p>\n\n<pre><code>If LCase(Sheets(1).Range(\"S5\").Value) = \"yes\" Then\n    Sheets(1).Range(\"T5\").Interior.ColorIndex = 33\n\nElseIf Sheets(1).Range(\"S5\").Value &lt;&gt; \"\" Then\n    Sheets(1).Range(\"T5\").Interior.ColorIndex = 19\n\nElse\n    Sheets(1).Range(\"T5\").Interior.ColorIndex = 0\nEnd If\n</code></pre>\n"}, {"tags": ["vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 1402, "user_id": 2223566, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74716b1ef308b59103a1f2415f84abb1?s=128&d=identicon&r=PG&f=1", "display_name": "rotgers", "link": "https://stackoverflow.com/users/2223566/rotgers"}, "edited": false, "score": 0, "creation_date": 1446045479, "post_id": 33394191, "comment_id": 54581065, "body": "You can also wrap your <code>objExcel.Run()</code> in a <code>try-catch</code> block, and display an error message if <code>objExcel.Run()</code> throws an exception."}], "answers": [{"comments": [{"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1446124604, "post_id": 33395074, "comment_id": 54620173, "body": "Thanks i will look at it."}], "tags": [], "owner": {"reputation": 9028, "user_id": 341762, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c9e40ea650664809cb82a148b8d86939?s=128&d=identicon&r=PG", "display_name": "NoAlias", "link": "https://stackoverflow.com/users/341762/noalias"}, "is_accepted": false, "score": 0, "last_activity_date": 1446045946, "creation_date": 1446045946, "answer_id": 33395074, "question_id": 33394191, "link": "https://stackoverflow.com/questions/33394191/check-excel-macro-security-settings/33395074#33395074", "title": "Check Excel Macro Security Settings", "body": "<p>I found on <a href=\"http://blogs.technet.com/b/diana_tudor/archive/2014/12/02/microsoft-project-how-to-control-macro-settings-using-registry-keys.aspx\" rel=\"nofollow\">this</a> site that you can check the registry for the security settings.  The one issue I found was that my registry key was not in the exact place that was referenced on the site.  That being said, you may want to just Try Catch it or make a more elaborate method for finding the VBAWarnings key in the registry.</p>\n\n<pre><code>    Dim strVBASecuritySetting As String = My.Computer.Registry.GetValue(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\", _\n                                                                        \"VBAWarnings\", String.Empty)\n\n    If strVBASecuritySetting = \"1\" Then\n\n        objExcel.Run(\"SortIO\")\n\n    End If\n</code></pre>\n\n<p>These are the possible values for VBAWarnings:</p>\n\n<ol>\n<li>Enable All</li>\n<li>Disable All with Notification</li>\n<li>Disable All Except Digitally Signed</li>\n<li>Disable All without Notification</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1446124577, "post_id": 33399816, "comment_id": 54620152, "body": "Thanks i will give it a try"}], "tags": [], "owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "is_accepted": true, "score": 0, "last_activity_date": 1446060191, "creation_date": 1446060191, "answer_id": 33399816, "question_id": 33394191, "link": "https://stackoverflow.com/questions/33394191/check-excel-macro-security-settings/33399816#33399816", "title": "Check Excel Macro Security Settings", "body": "<p>This seems to have cross-posted to the Excel VBA questions page: would you mind speaking a little more slowly?</p>\n\n<p>... <em>reads slowly</em> ...</p>\n\n<p>Well, I can give you an answer in VBA: the <CODE>Excel.Application.AutomationSecurity</CODE> property.</p>\n\n<p>The available values are enumerated by Office.MsoAutomationSecurity:</p>\n\n<p>&nbsp;1&nbsp;&nbsp;msoAutomationSecurityLow<BR /> \n&nbsp;2&nbsp;&nbsp;msoAutomationSecurityByUI<BR /> \n&nbsp;3&nbsp;&nbsp;msoAutomationSecurityForceDisable<BR /></p>\n\n<p>These are the settings for macros available in the API exposed to VBA. The user interface, visible in the 'Developer' tab of the ribbon, corresponds to the registry settings explained by NoAlias in the previous answer:</p>\n\n<p>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\VBAWarnings</p>\n\n<p>With the following enumerated values:</p>\n\n<ol>\n<li>Enable all macros </li>\n<li>Disable all macros with notification</li>\n<li>Disable all macros except digitally signed macros</li>\n<li>Disable all macros without notification</li>\n</ol>\n\n<p>If you go down the registry route, a VBA coder's advice would be to use the safe registry classes exposed by WMI scripting... And check that your user does actually have the privileges to make that registry write: there may be a registry policy in place preventing it.    </p>\n"}], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "accepted_answer_id": 33399816, "answer_count": 2, "score": 0, "last_activity_date": 1446554017, "creation_date": 1446043530, "last_edit_date": 1531164843, "question_id": 33394191, "link": "https://stackoverflow.com/questions/33394191/check-excel-macro-security-settings", "title": "Check Excel Macro Security Settings", "body": "<p>I have a vb.net Application that starts a Excel macro.\nIs there a way to check the macro Security Settings of the Excel first?</p>\n\n<pre><code>Imports Excel = Microsoft.Office.Interop.Excel\nPrivate Sub macrotest ()\n\n     objExcel.Workbooks.Open(strPath)\n\n     if ***'Check her what macro Security Settings is selected!*** Then\n         objExcel.Run(\"SortIO\")\n     end if\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "edited": false, "score": 0, "creation_date": 1446045057, "post_id": 33393836, "comment_id": 54580725, "body": "This previous question might provide a helpful push in the right direction:  <a href=\"http://stackoverflow.com/questions/14422003/vba-to-open-excel-hyperlink-does-not-work-when-hyperlink-generated-with-a-formul\" title=\"vba to open excel hyperlink does not work when hyperlink generated with a formul\">stackoverflow.com/questions/14422003/&hellip;</a>"}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "edited": false, "score": 0, "creation_date": 1446045085, "post_id": 33393836, "comment_id": 54580749, "body": "This one might also be helpful:  <a href=\"http://stackoverflow.com/questions/14574281/excel-thisaddin-vb-why-is-application-sheetfollowhyperlink-not-called-for-hyp\" title=\"excel thisaddin vb why is application sheetfollowhyperlink not called for hyp\">stackoverflow.com/questions/14574281/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446049396, "post_id": 33393836, "comment_id": 54584009, "body": "<a href=\"http://stackoverflow.com/questions/33114093/excel-hyperlink-to-nothing/33115239#33115239\" title=\"excel hyperlink to nothing\">stackoverflow.com/questions/33114093/excel-hyperlink-to-noth&zwnj;&#8203;ing/&hellip;</a>"}, {"owner": {"reputation": 161, "user_id": 3276067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6dc33734bcf352e3dae76d28a4570a66?s=128&d=identicon&r=PG&f=1", "display_name": "John W", "link": "https://stackoverflow.com/users/3276067/john-w"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446056330, "post_id": 33393836, "comment_id": 54588705, "body": "@Tim Williams &amp; EntryLevel.  Thank you both for the quick responses.   I ended up following ExcelHero&#39;s technique from Tim&#39;s link.  Referencing a user created function to run my code is something I hadn&#39;t considered and I think this may work better than I had hoped.   Just as a side note, none of the searches for this problem returned the links each of you posted so hopefully the phrasing of my question will direct someone else in the right direction."}, {"owner": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "edited": false, "score": 0, "creation_date": 1446057807, "post_id": 33393836, "comment_id": 54589625, "body": "Also: <a href=\"http://stackoverflow.com/questions/32660492/running-vba-from-a-hyperlink/32665442#32665442\" title=\"running vba from a hyperlink\">stackoverflow.com/questions/32660492/&hellip;</a> (which preceded Tim&#39;s link)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "edited": false, "score": 0, "creation_date": 1446058323, "post_id": 33393836, "comment_id": 54589942, "body": "@lori_m - that was the one I was looking for when I posted the other link  ;-)"}, {"owner": {"reputation": 161, "user_id": 3276067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6dc33734bcf352e3dae76d28a4570a66?s=128&d=identicon&r=PG&f=1", "display_name": "John W", "link": "https://stackoverflow.com/users/3276067/john-w"}, "reply_to_user": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "edited": false, "score": 0, "creation_date": 1446059016, "post_id": 33393836, "comment_id": 54590368, "body": "@lori_m Thanks Lori,  I appreciate the extra info you included in your post.  Tim, I am glad I am not the only one having trouble finding relevant posts."}, {"owner": {"reputation": 161, "user_id": 3276067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6dc33734bcf352e3dae76d28a4570a66?s=128&d=identicon&r=PG&f=1", "display_name": "John W", "link": "https://stackoverflow.com/users/3276067/john-w"}, "reply_to_user": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "edited": false, "score": 0, "creation_date": 1446148924, "post_id": 33393836, "comment_id": 54636354, "body": "@lori_m My original hyperlink opened another workbook.  However when I tried to add code to open a workbook in the function nothing happened.  I am able to easily reference the path but the following code does nothing: <code>Set x = Application.Workbooks.Open(ChecklistPath_str)</code>.  Furthermore, I found that I can&#39;t insert breaks  to see the code in action, yet I know it&#39;s working because the msgboxes appear."}], "owner": {"reputation": 161, "user_id": 3276067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6dc33734bcf352e3dae76d28a4570a66?s=128&d=identicon&r=PG&f=1", "display_name": "John W", "link": "https://stackoverflow.com/users/3276067/john-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2689, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1446045606, "creation_date": 1446042675, "last_edit_date": 1446045606, "question_id": 33393836, "link": "https://stackoverflow.com/questions/33393836/have-formula-hyperlink-execute-a-vba-macro", "title": "Have formula hyperlink execute a VBA macro", "body": "<p>Is there away to make the \"=Hyperlink(Path,Name)\" formula, within Excel,  trigger a macro when clicked?</p>\n\n<p>I attempted to use the following code:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\nIf  WithinRange(Target.Range.Address ,\"CustomerNameList\")=True Then  \n      'run code \n      Exit Sub  \nEnd If  \nEnd Sub \n</code></pre>\n\n<p>This works perfectly for traditional hyperlinks but does not appear to work with the hyperlink formula.  Ultimately, I would like a way to modify the above code to make it work with the hyperlink function. </p>\n\n<p>Additionally, this workbook is not static.  New rows are added from the top, shift down. Using the hyperlink formula has made my other processes much simpler and I would rather not have to write code that hardcodes a hyperlink each time an item is added or a name is changed. I also would prefer to not use an Onclick event with the cells within that range as the user may just want to modify the customer name and not follow the hyperlink.</p>\n\n<p>I realize this is a lot of conditions and this just may not be possible but any suggestions would be appreciated. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1446043277, "post_id": 33393893, "comment_id": 54579356, "body": "<code>formula.local</code> will allow you to use <code>;</code>"}, {"owner": {"reputation": 1402, "user_id": 2223566, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74716b1ef308b59103a1f2415f84abb1?s=128&d=identicon&r=PG&f=1", "display_name": "rotgers", "link": "https://stackoverflow.com/users/2223566/rotgers"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1446043370, "post_id": 33393893, "comment_id": 54579428, "body": "Thanks, I didn&#39;t know that. Correct line would become <code>Range(&quot;A1&quot;).FormulaLocal = &quot;=IF(1=1;1;0)&quot;</code>"}, {"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "edited": false, "score": 0, "creation_date": 1446043542, "post_id": 33393893, "comment_id": 54579585, "body": "OMG. Thanks, Lars! Weird thing is <code>thing.Formula = &quot;=IF(&quot; &amp; temp &amp; &quot;=0;&quot;&quot;not filled&quot;&quot;;&quot; &amp; temp &amp; &quot;)&quot;</code> did work in an other line written earlier."}, {"owner": {"reputation": 1402, "user_id": 2223566, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74716b1ef308b59103a1f2415f84abb1?s=128&d=identicon&r=PG&f=1", "display_name": "rotgers", "link": "https://stackoverflow.com/users/2223566/rotgers"}, "edited": false, "score": 0, "creation_date": 1446043822, "post_id": 33393893, "comment_id": 54579794, "body": "You&#39;re welcome. Please accept this as an answer if your problem is fixed. I also tried your formula but I get the same error as in your question. And see findwindow&#39;s his comment; you can use <code>FormulaLocal</code> too."}], "tags": [], "owner": {"reputation": 1402, "user_id": 2223566, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74716b1ef308b59103a1f2415f84abb1?s=128&d=identicon&r=PG&f=1", "display_name": "rotgers", "link": "https://stackoverflow.com/users/2223566/rotgers"}, "is_accepted": true, "score": 4, "last_activity_date": 1446045893, "last_edit_date": 1446045893, "creation_date": 1446042817, "answer_id": 33393893, "question_id": 33393745, "link": "https://stackoverflow.com/questions/33393745/why-cant-insert-this-simple-formula-into-a-cell/33393893#33393893", "title": "Why can&#39;t insert this simple formula into a cell?", "body": "<p>You have to use a <code>,</code> instead of <code>;</code> in your formula.</p>\n\n<p>Like this:</p>\n\n<pre><code>Range(\"AB7\").Formula = \"=IF(1=1,1,0)\"\n</code></pre>\n\n<p>The formula bar in the Excel application itself uses your culture info. That defines if you should use <code>,</code> or <code>;</code>. In the VBA code for <code>Formula</code> you have to use <code>,</code>, regardless of culture settings.</p>\n\n<p>As <strong>findwindow</strong> states in the comments on this answer; you can also use <code>FormulaLocal</code> which uses your culture settings.</p>\n\n<pre><code>Range(\"AB7\").FormulaLocal = \"=IF(1=1;1;0)\"\n</code></pre>\n\n<p>Although I doubt the portability of that. If I have the culture settings for <code>;</code> and my workbook is distributed to another computer that uses <code>,</code>, I guess you get the same error. Based on that, I would recommend to use <code>Formula</code> and <code>,</code>.</p>\n"}], "owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1795, "favorite_count": 0, "accepted_answer_id": 33393893, "answer_count": 1, "score": -1, "last_activity_date": 1446045893, "creation_date": 1446042478, "last_edit_date": 1531164843, "question_id": 33393745, "link": "https://stackoverflow.com/questions/33393745/why-cant-insert-this-simple-formula-into-a-cell", "title": "Why can&#39;t insert this simple formula into a cell?", "body": "<p>I have a line of simple VBA code in a sub:</p>\n\n<pre><code>Range(\"AB7\").Formula = \"=IF(1=1;1;0)\"\n</code></pre>\n\n<p>for which I get the mystical <em>Error 1004: Application-defined or object-defined error</em></p>\n\n<p>Why On Earth?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 420, "user_id": 5423764, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/daf8ba645547240462b5036013c2a682?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Weber", "link": "https://stackoverflow.com/users/5423764/alex-weber"}, "edited": false, "score": 0, "creation_date": 1446045059, "post_id": 33393523, "comment_id": 54580726, "body": "Do you have any sample code? How far have you gotten by yourself? StackOverflow is designed to help people who are stuck, not so much give them free code."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5498272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f84af0297861809b6f5d2ba9b20bf77?s=128&d=identicon&r=PG&f=1", "display_name": "GPol", "link": "https://stackoverflow.com/users/5498272/gpol"}, "edited": false, "score": 0, "creation_date": 1446043108, "post_id": 33393930, "comment_id": 54579236, "body": "Thanks, I&#39;m new to all this stuff!"}, {"owner": {"reputation": 21, "user_id": 5498272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f84af0297861809b6f5d2ba9b20bf77?s=128&d=identicon&r=PG&f=1", "display_name": "GPol", "link": "https://stackoverflow.com/users/5498272/gpol"}, "edited": false, "score": 0, "creation_date": 1446043274, "post_id": 33393930, "comment_id": 54579354, "body": "Basically I have one &#39;master&#39; sheet which contains some values. In sheet V1 I have an equivalent set of numbers. I&#39;ve created a copy of V1 which gives a duplicate sheet called &#39;V1 (2)&#39;. In &#39;V1 (2)&#39;, I want to multiply these values =&#39;Master&#39;!D2*&#39;V1&#39;!D2. I also have sheet V2 which gives a duplicate sheet called &#39;V2 (2)&#39;. In &#39;V2 (2)&#39;, I want to multiply these values =&#39;Master&#39;!D2*&#39;V2&#39;!D2, and so on"}, {"owner": {"reputation": 420, "user_id": 5423764, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/daf8ba645547240462b5036013c2a682?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Weber", "link": "https://stackoverflow.com/users/5423764/alex-weber"}, "reply_to_user": {"reputation": 21, "user_id": 5498272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f84af0297861809b6f5d2ba9b20bf77?s=128&d=identicon&r=PG&f=1", "display_name": "GPol", "link": "https://stackoverflow.com/users/5498272/gpol"}, "edited": false, "score": 0, "creation_date": 1446044221, "post_id": 33393930, "comment_id": 54580101, "body": "@GPol This is possible... do you want to keep the new sheets named V1 (2), V2 (2), etc? Do you want to delete the old V1, V2, etc, sheets? This can be done with a  for loop. Do you want this done in a loop or a macro that&#39;s run for each sheet. It might be helpful if you update your question."}, {"owner": {"reputation": 21, "user_id": 5498272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f84af0297861809b6f5d2ba9b20bf77?s=128&d=identicon&r=PG&f=1", "display_name": "GPol", "link": "https://stackoverflow.com/users/5498272/gpol"}, "edited": false, "score": 0, "creation_date": 1446044594, "post_id": 33393930, "comment_id": 54580373, "body": "I need the original (v1, v2) sheets but the new sheets can take any name. I have no preference as to how it can be done! Thanks"}], "tags": [], "owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "is_accepted": false, "score": 0, "last_activity_date": 1446042895, "creation_date": 1446042895, "answer_id": 33393930, "question_id": 33393523, "link": "https://stackoverflow.com/questions/33393523/vba-formula-to-look-into-different-tab-based-on-current-tab-name/33393930#33393930", "title": "VBA formula to look into different tab based on current tab name", "body": "<p>At first:</p>\n\n<p>Tabs are called sheets in vba,</p>\n\n<p>You can select or set them active:</p>\n\n<p>Sheets(\"sheetname\").Select\nor Sheets(\"Sheetname\").Activate</p>\n\n<p>can you specify your question?</p>\n"}, {"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1446045781, "creation_date": 1446045781, "answer_id": 33395015, "question_id": 33393523, "link": "https://stackoverflow.com/questions/33393523/vba-formula-to-look-into-different-tab-based-on-current-tab-name/33395015#33395015", "title": "VBA formula to look into different tab based on current tab name", "body": "<p>You can try this macro, but run it only once or each time the number of sheets will go up.</p>\n\n<pre><code>Sub CopySheetAndSetFormula()\n    Dim sh As Worksheet\n    Dim oldSheet As Worksheet, newSheet As Worksheet, refSheet As Worksheet\n    Set refSheet = Worksheets(\"master\")\n    For Each sh In Worksheets\n        If Not sh Is refSheet And Not sh.Name Like \"*(*)\" Then ' we do not copy the ref sheet, nor the ones with (*) inside\n            sh.Copy After:=sh  ' the new sheet become the actve one\n            ActiveSheet.Range(\"D2:P30\").Formula = \"='\" &amp; sh.Name &amp; \"'!D2 * 'master'!D2\"\n        End If\n    Next sh\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5498272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f84af0297861809b6f5d2ba9b20bf77?s=128&d=identicon&r=PG&f=1", "display_name": "GPol", "link": "https://stackoverflow.com/users/5498272/gpol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446045781, "creation_date": 1446041908, "last_edit_date": 1446043092, "question_id": 33393523, "link": "https://stackoverflow.com/questions/33393523/vba-formula-to-look-into-different-tab-based-on-current-tab-name", "title": "VBA formula to look into different tab based on current tab name", "body": "<p>I have a file which contains sheets named V1, V2, V3, ..., V15.\nThe amount of sheets can vary based on whether or not they exist.</p>\n\n<p>I also have a 'master' sheet which contains the multiplier values in.</p>\n\n<p>What I have done is duplicate each sheet to give V1 (2), V2 (2), ..., V* (2)</p>\n\n<p>The next step is (all contained in range D2:P30):\n- in V1 (2), times each value in V1 by the equiv value in multiplier\n- in V2 (2), times each value in V2 by the equiv value in multiplier \n- in V* (2), times each value in V* by the equiv value in multiplier </p>\n\n<p>bearing in mind there could be 2 or up to 15 V sheets</p>\n"}, {"tags": ["excel", "replace", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1446479406, "post_id": 33445811, "comment_id": 54747879, "body": "You can read more about RegEx syntax e. g. <a href=\"https://msdn.microsoft.com/en-us/library/1400241x.aspx\" rel=\"nofollow noreferrer\">here</a> and <a href=\"http://www.regular-expressions.info/vbscript.html\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 1, "last_activity_date": 1446244193, "creation_date": 1446244193, "answer_id": 33445811, "question_id": 33393431, "link": "https://stackoverflow.com/questions/33393431/manipulate-a-textfile-to-add-2-in-front-of-integersremove-unknown-number-of-spa/33445811#33445811", "title": "Manipulate a textfile to add 2 in front of integers(remove unknown number of spaces) in excel vba", "body": "<p>Consider the below snippet, it replaces the consecutive spaces in the string with \"2\":</p>\n\n<pre><code>With CreateObject(\"VBScript.RegExp\")\n    .Global = True\n    .MultiLine = True\n    .IgnoreCase = True\n    .Pattern = \" +\"\n    element = .Replace(element, \"2\")\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 33445811, "answer_count": 1, "score": 1, "last_activity_date": 1446244193, "creation_date": 1446041675, "last_edit_date": 1531164843, "question_id": 33393431, "link": "https://stackoverflow.com/questions/33393431/manipulate-a-textfile-to-add-2-in-front-of-integersremove-unknown-number-of-spa", "title": "Manipulate a textfile to add 2 in front of integers(remove unknown number of spaces) in excel vba", "body": "<p>I have a fairly long file(479394 lines) which contains node and element numbers for a FEM model I am trying to combine with another model. To do this I want to add 2 to all numbers to make sure that I have unique node/element numbers when I combine the two models. This should be straight forward, however I can't figure out how to replace several spaces after each other with the number 2. It can be 3 spaces,maybe 2 maybe 5 and so on(remove unknown number of spaces). </p>\n\n<pre><code>Sub readTextFile()\nstrFileName = \"Z:\\Prosjekt\\32637\\FEM\\RP_32637_PR_02_D\\FEM\\kim2.dat\"\nOpen strFileName For Input As #1\ndataArray = Split(input$(LOF(1), #1), vbLf)\nClose #1\n\nFor Each element In dataArray\n\n    If InStr(element, \"CTETRA\") Or _\n        InStr(element, \"PSOLID\") Or _\n        InStr(element, \"CELAS1\") Or _\n        InStr(element, \"         \") Or _\n        InStr(element, \"GRID\") Then\n        element = Replace(element, \"remove unknown number of spaces\", \"2\")\n    End If\n'write back to file\nNext element\n\nEnd Sub\n</code></pre>\n\n<p>here is a <a href=\"https://www.dropbox.com/s/uxr48ivb4360h6k/kim2.dat?dl=0\" rel=\"nofollow\">link</a> to a stripped version (129 lines) of my input file and <a href=\"https://www.dropbox.com/s/pqvdbn5f1yf5hd3/stackOverflow.dat?dl=0\" rel=\"nofollow\">here</a> is the output I want to achieve </p>\n"}, {"tags": ["excel", "vbscript", "qtp", "hp-uft", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "edited": false, "score": 0, "creation_date": 1446099575, "post_id": 33393856, "comment_id": 54605429, "body": "Thanks Buddy. Seems a huge code.See the code in Java and help me in VB"}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "reply_to_user": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "edited": false, "score": 0, "creation_date": 1446118671, "post_id": 33393856, "comment_id": 54616112, "body": "check the edit, broke it down for you, let me know if you have any questions."}, {"owner": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "edited": false, "score": 0, "creation_date": 1446126377, "post_id": 33393856, "comment_id": 54621538, "body": "Excellent Work Buddy :)  But i just wanted to know what is the exact error message we will get  If oHttpRequest.ReadyState is not  4 and If oHttpRequest.Status is not  200 instead putting a bad URL"}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "reply_to_user": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "edited": false, "score": 0, "creation_date": 1446127497, "post_id": 33393856, "comment_id": 54622474, "body": "cheers! see edit for <code>Status</code> and <code>ReadyState</code>, along with any specific error message..."}, {"owner": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "edited": false, "score": 0, "creation_date": 1446205902, "post_id": 33393856, "comment_id": 54658654, "body": "I have a Question, This Program works well but when the WSDL keeps on LOADING in the browser, the programs is not responding , then i need to terminate it manually. i created the MACRO with list of wsdls i have and i am running one by one and getting the status , if one of the wsdl is keep on loading , the macro gets hanged and i need to terminate the process and restart it. do we have any solution for this kind of situations and proceed for next wsdl in the list after some timeout ?"}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "reply_to_user": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "edited": false, "score": 0, "creation_date": 1446206129, "post_id": 33393856, "comment_id": 54658816, "body": "take a look at the reference for <a href=\"https://msdn.microsoft.com/en-us/library/ms535874(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>Microsoft.XMLHTTP</code></a> -- you can set your own <code>timeout</code> value, there is also an <code>abort</code> method, which may help..."}, {"owner": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "edited": false, "score": 0, "creation_date": 1446455462, "post_id": 33393856, "comment_id": 54733414, "body": "HI bro, Can you please help me in putting this. i tried and i am getting error like object doesn&#39;t support. I am getting error at line 3   Set oHttpRequest = CreateObject(&quot;Microsoft.XMLHTTP&quot;)               oHttpRequest.Open &quot;GET&quot;, WSDL, False               oHttpRequest.timeout = 30 *1000               oHttpRequest.Send"}, {"owner": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "edited": false, "score": 0, "creation_date": 1446779916, "post_id": 33393856, "comment_id": 54896992, "body": "Ok i will wait for you reply bro"}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "reply_to_user": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "edited": false, "score": 0, "creation_date": 1449175183, "post_id": 33393856, "comment_id": 55904648, "body": "Sorry, forgot to get back to you. XMLHTTP does <i>not</i> have a <code>timeout</code> property when instantiated from Excel. The reference link above must be specific to Internet Explorer only. However, you can also use WinHTTP. I have added an example to the answer, hope it helps. Note the need to set credentials or logon policy..."}, {"owner": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "edited": false, "score": 0, "creation_date": 1449475169, "post_id": 33393856, "comment_id": 56005614, "body": "Thanks Bro that helped :)"}], "tags": [], "owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "is_accepted": true, "score": 0, "last_activity_date": 1449174939, "last_edit_date": 1449174939, "creation_date": 1446042716, "answer_id": 33393856, "question_id": 33392981, "link": "https://stackoverflow.com/questions/33392981/test-if-a-soap-wsdl-is-up-or-down-in-vb-script/33393856#33393856", "title": "Test if a SOAP WSDL is up or down in vb script?", "body": "<p>Something like this should work.<br>\nI tested using a SharePoint 2010 web service.</p>\n\n<pre><code>' TestWSDL - Test if WSDL is up and running\nPublic Sub TestWSDL()\n  Dim oHttpRequest As Object\n  Dim oHttpResponse As Object\n\n  On Error GoTo Trap\n\n  Set oHttpRequest = CreateObject(\"Microsoft.XMLHTTP\")\n  oHttpRequest.Open \"GET\", \"http://domain/path/_vti_bin/UserGroup.asmx?wsdl\", False\n  oHttpRequest.Send\n\n  If oHttpRequest.ReadyState = 4 Then\n    If oHttpRequest.Status = 200 Then\n      Set oHttpResponse = oHttpRequest.ResponseXML\n      If oHttpResponse Is Nothing Then\n        MsgBox \"bad url\"\n      Else\n        MsgBox \"good url\"\n        Set oHttpResponse = Nothing\n      End If\n    Else\n      MsgBox oHttpRequest.Status &amp; \" - \" &amp; oHttpRequest.StatusText\n    End If\n  Else\n    MsgBox oHttpRequest.ReadyState\n  End If\n\nTrap:\n  If Err &lt;&gt; 0 Then\n    MsgBox Error(Err)\n  End If\n\n  Set oHttpRequest = Nothing\nEnd Sub\n</code></pre>\n\n<p>Following is similar, using <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384106(v=vs.85).aspx\" rel=\"nofollow\">Microsoft WinHTTP Services v5.1</a> instead of Microsoft XMLHTTP</p>\n\n<pre><code>Public Sub TestWinHTTP()\n  Dim oHttpRequest As Object\n\n  On Error GoTo Trap\n\n  Set oHttpRequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n  oHttpRequest.Open \"GET\", \"http://domain/path/_vti_bin/UserGroup.asmx?wsdl\", False\n\n  ' Need to use SetCredentials OR SetAutoLogonPolicy\n  ' Set specific username / password\n  'oHttpRequest.SetCredentials \"username\", \"password\", 0\n\n  ' Use windows authentication\n  oHttpRequest.SetAutoLogonPolicy 0\n\n  ' Set timeout values -- host, connect, send, receive\n  oHttpRequest.SetTimeouts 30000, 60000, 30000, 30000\n\n  oHttpRequest.Send\n\n  If oHttpRequest.Status = 200 Then\n    If oHttpRequest.ResponseText = \"\" Then\n      MsgBox \"bad url\"\n    Else\n      MsgBox \"good url\"\n    End If\n  Else\n    MsgBox \"bad url\"\n  End If\n\nTrap:\n  If Err &lt;&gt; 0 Then\n    MsgBox Error(Err)\n  End If\n\n  Set oHttpRequest = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3401482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0fd06ff876e02029633261537ad5f?s=128&d=identicon&r=PG", "display_name": "Vasudev Reddy", "link": "https://stackoverflow.com/users/3401482/vasudev-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1064, "favorite_count": 0, "accepted_answer_id": 33393856, "answer_count": 1, "score": 1, "last_activity_date": 1449174939, "creation_date": 1446040563, "last_edit_date": 1531161705, "question_id": 33392981, "link": "https://stackoverflow.com/questions/33392981/test-if-a-soap-wsdl-is-up-or-down-in-vb-script", "title": "Test if a SOAP WSDL is up or down in vb script?", "body": "<p>I am trying to Verify if the WSDL is UP and Running or NOT in VB Script.</p>\n\n<p>IF we open the WSDL in browser, if we get an XML in that then the WSDL is UP and Running</p>\n\n<p>If it is blank/timing out/not responding then WSDL is DOWN</p>\n\n<p>I want to write a VB Script program for this?</p>\n\n<p>I was expecting some thing like this in VB Script to run in QTP/UFT or EXCEL VBA MACRO. </p>\n\n<p>This program is written in Java</p>\n\n<pre><code>public static void main(String args[]) {\n    String wsdl = \"http://lxomavnat005.dev.qintra.com:10301/icl/services/ICL_2_0?wsdl\";\n    URL url = null;\n    URLConnection urlConnection = null;\n    try {\n\n        url = new URL(wsdl);\n        urlConnection = url.openConnection();\n\n        if (urlConnection.getContent() != null) {\n            System.out.println(\"GOOD URL\");\n        } else {\n            System.out.println(\"BAD URL\");\n        }\n\n    } catch (IOException ex) {\n\n        System.out\n                .println(\"Failed opening connection. Perhaps WS is not up?\");\n    }\n}\n</code></pre>\n\n<p>This Program just check the content is loading or not and decides if it running or not</p>\n\n<p>Any Ideas</p>\n"}, {"tags": ["php", "excel", "oracle", "vba", "data-manipulation"], "comments": [{"owner": {"reputation": 4303, "user_id": 851930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmU6r.png?s=128&g=1", "display_name": "kevinsky", "link": "https://stackoverflow.com/users/851930/kevinsky"}, "edited": false, "score": 0, "creation_date": 1446039904, "post_id": 33392661, "comment_id": 54576786, "body": "have your php called a stored procedure which fixes the data as you see fit"}, {"owner": {"reputation": 420, "user_id": 5423764, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/daf8ba645547240462b5036013c2a682?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Weber", "link": "https://stackoverflow.com/users/5423764/alex-weber"}, "edited": false, "score": 0, "creation_date": 1446040469, "post_id": 33392661, "comment_id": 54577176, "body": "Personally, I&#39;d dump everything in Excel and then sort it that way. Or you could use a PHP function."}], "owner": {"reputation": 592, "user_id": 931123, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b58772325804922a7956cbd666549813?s=128&d=identicon&r=PG", "display_name": "livefree75", "link": "https://stackoverflow.com/users/931123/livefree75"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446039724, "creation_date": 1446039724, "question_id": 33392661, "link": "https://stackoverflow.com/questions/33392661/massage-data-in-sql-or-php", "title": "Massage data in SQL or PHP?", "body": "<p>I have a macro-enabled Excel spreadsheet.  When I click a button, it executes a macro that uses cURL to call a PHP script on a web server, which makes some queries against an Oracle database.  The PHP script formats the data into a JSON string, which the Excel macro then picks up in the cURL response.  It then uses that data to update the Worksheet.</p>\n\n<p>The reason I'm not using ODBC from Excel is that I can't be guaranteed that the user will have Oracle ODBC installed on their PC.  However, the web server obviously does.</p>\n\n<p>Here's the issue.  Some of the data from the database must be modified based on certain values of other columns before it gets updated on the Excel sheet.  I can do most of this in the SQL statement itself using CASE statements.  However, I could also just get the straight data from the database, and do the modifications in PHP.  Further, I could even just return the straight data from the PHP to the Excel, and do the modifications in Excel VBA.</p>\n\n<p>I will only have to do most of this massaging for the current version of the data.  The customer has told me that future versions of the data will be more pure and won't require these hackish modifications.  Unfortunately, the app will have to keep working for this current version of the data, so the hackish code will always be there.</p>\n"}, {"tags": ["mysql", "vba"], "comments": [{"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 1, "creation_date": 1446038819, "post_id": 33392109, "comment_id": 54575979, "body": "This is not mysql syntax, this is used in ms access. Mysql is not a file based rdbms like access or paradox, I do not think you can do this. Use linked tables or connect to mysql directly using myodbc and ADO."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1446039274, "post_id": 33392109, "comment_id": 54576340, "body": "As Shadow mentioned, you cannot use a VBA variable within an SQL statement. To do so, you would need to connect with the data source using ODBC or ADO within VBA, and then you could use a variable within the SQL statement."}, {"owner": {"reputation": 212, "user_id": 5463410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a7cec411c86ab8d42f4a831c0241b6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny Nguyen", "link": "https://stackoverflow.com/users/5463410/kenny-nguyen"}, "edited": false, "score": 0, "creation_date": 1446039442, "post_id": 33392109, "comment_id": 54576458, "body": "So would my best bet would be to update my sql statement from vba file? and not have a vba variable in a sql file"}, {"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1446040023, "post_id": 33392109, "comment_id": 54576877, "body": "You can assemble an SQL statement as string from VBA and thus you can include the content of a variable in it. However, I doubt that this would work for mysql from ms access. My point was: either do not use ms access at all or use linked tables from ms access. You can dinamically link tables from VBA code as well."}], "answers": [{"tags": [], "owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1463058807, "last_edit_date": 1495539848, "creation_date": 1463058807, "answer_id": 37188043, "question_id": 33392109, "link": "https://stackoverflow.com/questions/33392109/vba-variable-in-sql/37188043#37188043", "title": "Vba variable in SQL", "body": "<p>The whole point of SQL is to define an interface between your code and the database so no you would never want to share information between the two except using a database driver - that would be a huge security risk. </p>\n\n<p>It's trivial to form SQL statements in VBA to execute on MySQL see: <a href=\"https://stackoverflow.com/questions/13558921/how-can-vba-connect-to-mysql-database-in-excel\">How can VBA connect to MySQL database in Excel?</a>.</p>\n"}], "owner": {"reputation": 212, "user_id": 5463410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a7cec411c86ab8d42f4a831c0241b6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny Nguyen", "link": "https://stackoverflow.com/users/5463410/kenny-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463058807, "creation_date": 1446038269, "last_edit_date": 1446038643, "question_id": 33392109, "link": "https://stackoverflow.com/questions/33392109/vba-variable-in-sql", "title": "Vba variable in SQL", "body": "<p>Is it possible to have a <code>vba</code> variable in <code>MySQL</code>?</p>\n\n<pre><code>SELECT a,b,c\nFROM table1 IN &lt;**someVBAvariable**&gt;\nWHERE ...\n</code></pre>\n\n<p>My goal is to be able to re-locate the path of the table to where I want via vba.</p>\n\n<p>EDIT: I understand that VBA can have a global variable, would sql see this?</p>\n\n<p>If this IS possible, would it also work for 2 different sql with 1 vba variable? </p>\n"}, {"tags": ["excel", "vba", "edit"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1446038243, "post_id": 33391770, "comment_id": 54575549, "body": "To prevent the user to modify the cell, protect them (and the worksheet). When you need to modify them with VBA, just unprotect them, do you modifications and re-protect them after."}, {"owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1446038874, "post_id": 33391770, "comment_id": 54576020, "body": "Then I would end up protecting and unprotecting endles times, due my code contains a lot of parts where the user/VBA  take turns on editing the Workbook. thanks though!"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1446038938, "post_id": 33391770, "comment_id": 54576070, "body": "No other choice, sorry. But you can make two Sub to protect and Unprotect the cells that you call at the start and at the end of your VBA processing."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1446039308, "post_id": 33391770, "comment_id": 54576357, "body": "Didn&#39;t remember of UserInterfaceOnly parameter, my bad."}, {"owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "edited": false, "score": 0, "creation_date": 1446039351, "post_id": 33391770, "comment_id": 54576383, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/125449/how-to-protect-cells-in-excel-but-allow-these-to-be-modified-by-vba-script\">How to protect cells in Excel but allow these to be modified by VBA script</a>"}, {"owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "edited": false, "score": 0, "creation_date": 1446041043, "post_id": 33391770, "comment_id": 54577666, "body": "yes... but would like to know how to apply this on just a certain range"}], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "edited": false, "score": 0, "creation_date": 1446039294, "post_id": 33392199, "comment_id": 54576351, "body": "p.s. bas de beer is een bazen spel  #90s"}], "tags": [], "owner": {"reputation": 240, "user_id": 5341300, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4bfd18a98c7c42e9cae2146fcabd6dff?s=128&d=identicon&r=PG&f=1", "display_name": "GijsApeldoorn", "link": "https://stackoverflow.com/users/5341300/gijsapeldoorn"}, "is_accepted": false, "score": 1, "last_activity_date": 1446038498, "creation_date": 1446038498, "answer_id": 33392199, "question_id": 33391770, "link": "https://stackoverflow.com/questions/33391770/prevent-user-to-edit-range-of-cells-manual-but-allowing-vba-to-do/33392199#33392199", "title": "Prevent User to edit range of cells manual (but allowing VBA to do)", "body": "<p>Protect the sheet with VBA:</p>\n\n<pre><code>Dim sh As Worksheet\nDim myPassword As String\nmyPassword = \"password\"\n\nFor Each sh In ActiveWorkbook.Worksheets\n    sh.Protect Password:=myPassword\nNext sh\n</code></pre>\n\n<p>Now, if you want to modify something with VBA you can unprotect them with:</p>\n\n<pre><code>Dim sh As Worksheet\nDim myPassword As String\nmyPassword = \"password\"\n\nFor Each sh In ActiveWorkbook.Worksheets\n    sh.Unprotect Password:=myPassword\nNext sh\n</code></pre>\n\n<p>And then protect them again afterwards.</p>\n"}, {"tags": [], "owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "is_accepted": true, "score": 2, "last_activity_date": 1446041224, "last_edit_date": 1446041224, "creation_date": 1446039224, "answer_id": 33392469, "question_id": 33391770, "link": "https://stackoverflow.com/questions/33391770/prevent-user-to-edit-range-of-cells-manual-but-allowing-vba-to-do/33392469#33392469", "title": "Prevent User to edit range of cells manual (but allowing VBA to do)", "body": "<p><strong>Sollution</strong></p>\n\n<p>Worksheet.Protect \"Password\", UserInterfaceOnly := True</p>\n\n<p>to Apply on a certain Range (I gues the folloing code should work...?):</p>\n\n<p>Worksheet.Sheets(\"ControlSheet\").Range(\"M5:N19\").Protect \"Password\", UserInterfaceOnly :=True</p>\n"}], "owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6973, "favorite_count": 1, "accepted_answer_id": 33392469, "answer_count": 2, "score": 0, "last_activity_date": 1446041224, "creation_date": 1446037251, "last_edit_date": 1495542380, "question_id": 33391770, "link": "https://stackoverflow.com/questions/33391770/prevent-user-to-edit-range-of-cells-manual-but-allowing-vba-to-do", "title": "Prevent User to edit range of cells manual (but allowing VBA to do)", "body": "<p>I'd like to prevent the user from being able to editing a certain range of cells. But VBA should keep the ability to do this. So when a button in Excel is pressed VBA should be able make modifications in the Cell's values, while the user can't do this manually.</p>\n\n<p><strong>Just found a sollution in an other toppic which rather fits my demands:</strong> <a href=\"https://stackoverflow.com/questions/125449/how-to-protect-cells-in-excel-but-allow-these-to-be-modified-by-vba-script?rq=1\">How to protect cells in Excel but allow these to be modified by VBA script</a></p>\n\n<p>Only thing I'm still questioning is if this is alwso aplicable to a certain range instead of the whole workbook?</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 201, "user_id": 5498266, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9e47cb8439ec713f2c67a3e6dd7b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "A Torre", "link": "https://stackoverflow.com/users/5498266/a-torre"}, "is_accepted": false, "score": 0, "last_activity_date": 1446217843, "creation_date": 1446217843, "answer_id": 33439160, "question_id": 33391328, "link": "https://stackoverflow.com/questions/33391328/export-pivot-table-and-source-data-to-another-workbook/33439160#33439160", "title": "Export Pivot Table and Source data to another Workbook", "body": "<p>I have found a solution that makes a copy of the whole spreadsheet in the new location and deletes the unnecessary tabs</p>\n\n<p>This is the the function:</p>\n\n<pre><code>Public Function SaveASSheets(sheetsArray As Variant, destination As String)\n\n   ActiveWorkbook.Sheets.Copy\n   ActiveWorkbook.SaveAs destination, 50\n   For Each Sheet In ActiveWorkbook.Worksheets\n      doNotDelete = False\n        For Each element In sheetsArray\n          If element = Sheet.Name Then\n              doNotDelete = True\n          End If\n      Next\n      If Not doNotDelete Then\n        Application.DisplayAlerts = False\n        Sheet.Delete\n        Application.DisplayAlerts = True\n      End If\n  Next\n  ActiveWorkbook.Save\n  ActiveWorkbook.Close\n\nEnd Function\n</code></pre>\n\n<p>I know it is not very nice solution but it works.</p>\n"}, {"comments": [{"owner": {"reputation": 201, "user_id": 5498266, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9e47cb8439ec713f2c67a3e6dd7b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "A Torre", "link": "https://stackoverflow.com/users/5498266/a-torre"}, "edited": false, "score": 0, "creation_date": 1446462537, "post_id": 33439372, "comment_id": 54737506, "body": "Thank you very much @EEM for both methods. I have tried the the first one, and it works perfectly when there is just 1 pivot table to copy in the new excel. If there are more than 1, I got always this error: &quot;Run-time erro 5: Invalid procedure call or argument&quot; in this line: &quot; Ptb.ChangePivotCache Pch &quot; when the code is trying to set up the second pivot table. Ptb has the correct name of Pivot Table and Pch has the correct arguments (Type, SourceData and Version). Doy you know why? Thanks again!"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 201, "user_id": 5498266, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9e47cb8439ec713f2c67a3e6dd7b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "A Torre", "link": "https://stackoverflow.com/users/5498266/a-torre"}, "edited": false, "score": 0, "creation_date": 1446463886, "post_id": 33439372, "comment_id": 54738178, "body": "Need more info to figure out what the problem is: 1) There are more that one worksheet with PivotTables?, 2) Do you have at least one worksheet with more than one PivotTable?, 3) Are all these PivotTables pointing to the same <code>SourceData</code> are in the same worksheet?, 4) What version of Excel are you using?"}, {"owner": {"reputation": 201, "user_id": 5498266, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9e47cb8439ec713f2c67a3e6dd7b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "A Torre", "link": "https://stackoverflow.com/users/5498266/a-torre"}, "edited": false, "score": 0, "creation_date": 1446464162, "post_id": 33439372, "comment_id": 54738317, "body": "To fix that error, I have moved <code>Set Pch</code> code to the <code>For Each Ptb In Wsh.PivotTables</code> loop"}, {"owner": {"reputation": 201, "user_id": 5498266, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9e47cb8439ec713f2c67a3e6dd7b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "A Torre", "link": "https://stackoverflow.com/users/5498266/a-torre"}, "edited": false, "score": 0, "creation_date": 1446464519, "post_id": 33439372, "comment_id": 54738532, "body": "Thank you very much @EEM. My source excel spreadsheet has 7 worksheets with pivot tables (1 pivot table per sheet) pointing to the same SourceData (range). I need to export all of them and the data source tab. To fix that error, I have moved <code>Set Pch</code> code into the <code>For Each Ptb In Wsh.PivotTables</code> loop."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 201, "user_id": 5498266, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9e47cb8439ec713f2c67a3e6dd7b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "A Torre", "link": "https://stackoverflow.com/users/5498266/a-torre"}, "edited": false, "score": 0, "creation_date": 1446468257, "post_id": 33439372, "comment_id": 54740576, "body": "@ATorre Though moving <code>Set Pch</code> code into the <code>For Each Ptb In Wsh.PivotTables</code> loop, seems to fixed the error, that is not correct, as that is actually creating a new <code>PivotCache</code> for each <code>PivotTable</code>. This is not efficient and will certainly lead to errors as users will have to refresh <code>PivotTables</code> one by one contrary to what\u2019s Excel expected behavior. Additionally, users may think that because one <code>PivotTable</code> is updated all of them also are. I updated the procedure and now still creating only one <code>PivotCache</code> and it assigns this <code>PivotCache</code> to all <code>PivotTables</code>. Pls use revised code."}, {"owner": {"reputation": 201, "user_id": 5498266, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9e47cb8439ec713f2c67a3e6dd7b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "A Torre", "link": "https://stackoverflow.com/users/5498266/a-torre"}, "edited": false, "score": 0, "creation_date": 1446471430, "post_id": 33439372, "comment_id": 54742491, "body": "thank for the quick response. I totally agree with you. My code was not efficient. I have tested the new version of your method 1 and it works perfectly. Thanks again!"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 201, "user_id": 5498266, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9e47cb8439ec713f2c67a3e6dd7b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "A Torre", "link": "https://stackoverflow.com/users/5498266/a-torre"}, "edited": false, "score": 0, "creation_date": 1446471898, "post_id": 33439372, "comment_id": 54742783, "body": "Most welcome, glad it serves you and that you appreciate efficiency. Looking forward to you next question..."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 2, "last_activity_date": 1446467666, "last_edit_date": 1446467666, "creation_date": 1446218463, "answer_id": 33439372, "question_id": 33391328, "link": "https://stackoverflow.com/questions/33391328/export-pivot-table-and-source-data-to-another-workbook/33439372#33439372", "title": "Export Pivot Table and Source data to another Workbook", "body": "<p>Let\u2019s first review the procedures you posted:</p>\n\n<p>Both procedures create a new workbook using a group of worksheets copied from the active workbook.</p>\n\n<p>The objects in the copied worksheets retain all their original properties, <code>PivotTable.SourceData</code> among them, so the <code>PivotTables</code> copied are still pointing to the \u201csource workbook\u201d.</p>\n\n<p>In the second procedure your attempt to set the <code>PivotTable.SourceData</code> to the \u201cInput Range\u201d recieved by the procedure. It fails as the application is trying to create in the \u201cNew Workbook\u201d a <code>PivotCache</code> pointing to the \u201cSource Workbook\u201d. However, even if this operation ends successfully, it will not achieve its purpose as the \u201cInput Range\u201d is still addressing the \u201cSource Workbook\u201d. Additionally, note that the procedure closes the workbook without saving it, so if the objective was achieved it would have been lost.</p>\n\n<p>Suggest also to always declare the variables having this line in all modules will assist you with this good practice.</p>\n\n<pre><code>Option Explicit\n</code></pre>\n\n<p>It can be part of the standard VBA settings. In the Excel VBA application menu select: <code>Tools\\Options</code> in the dialog box tab: Editor, check the \u201cRequire Variable Declaration\u201d option</p>\n\n<p><a href=\"https://i.stack.imgur.com/EiiN6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EiiN6.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>This solution propose two methods to achieve the:</em></p>\n\n<p><strong>Objective</strong>: Create a new workbook containing a set of worksheets from the active workbook. This set contains worksheets with <code>PivotTables</code> having a common <code>SourceData</code> that resides in a worksheet also included in the set. </p>\n\n<p><strong>Procedures arguments</strong>:</p>\n\n<p><code>aShtSrc</code>   <code>As Variant</code>    Array containing the names of the worksheets to be included in the new workbook</p>\n\n<p><code>sFullPath</code> <code>As String</code> Path and Filename of the new workbook </p>\n\n<ul>\n<li><p><strong>Method 1</strong>: Copy set of worksheets from source workbook into a new workbook and change <code>PivotTables</code> in new workbook to a new <code>PivotCache</code> pointing to the <code>DataSource</code> in the new workbook.</p>\n\n<pre><code>Sub Ptb_Copy_To_NewWbk_And_Change_DataSource(aShtSrc As Variant, sFullPath As String)\nDim WbkSrc As Workbook, WbkNew As Workbook\nDim Wsh As Worksheet, Pch As PivotCache, Ptb As PivotTable\nDim sPtbSrc As String\nDim blPtDone As Boolean\nDim blAppDisplayAlerts As Boolean\n\n    Rem Set Application Properties\n    blAppDisplayAlerts = Application.DisplayAlerts\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Rem Set Source Workbook\n    Set WbkSrc = ThisWorkbook\n\n    Rem Get PivotTable Source Data\n    sPtbSrc = Empty\n    For Each Wsh In WbkSrc.Worksheets(aShtSrc)\n        On Error Resume Next\n        sPtbSrc = Wsh.PivotTables(1).SourceData\n        On Error GoTo 0\n        If sPtbSrc &lt;&gt; Empty Then Exit For\n    Next\n\n    Rem Copy Sheets to Create New Workbook\n    WbkSrc.Sheets(aShtSrc).Copy\n    Set WbkNew = ActiveWorkbook\n\n    Rem Save New Workbook (overwrites existing workbook)\n    Application.DisplayAlerts = 0\n    WbkNew.SaveAs Filename:=sFullPath, FileFormat:=xlExcel12\n    Application.DisplayAlerts = 1\n\n    Rem Create PivotCache in New Workbook\n    Set Pch = WbkNew.PivotCaches.Create( _\n        SourceType:=xlDatabase, _\n        SourceData:=sPtbSrc, _\n        Version:=xlPivotTableVersion15)\n\n    Rem Change PivotCache to 1st PivotTable in New Workbook\n    For Each Wsh In WbkNew.Worksheets\n        For Each Ptb In Wsh.PivotTables\n            Ptb.ChangePivotCache Pch\n            blPtDone = True\n            Exit For\n        Next\n        If blPtDone Then Exit For\n    Next\n\n    Rem Change PivotCache to Reamining PivotTables in New Workbook\n    For Each Wsh In WbkNew.Worksheets\n        For Each Ptb In Wsh.PivotTables\n            Ptb.CacheIndex = Pch.Index\n    Next: Next\n\n    Rem Refresh PivotTables, Save &amp; Close New Workbbok\n    Pch.Refresh\n    WbkNew.Close SaveChanges:=True\n    WbkSrc.Activate\n\n    Rem Set Application Properties\n    Application.DisplayAlerts = blAppDisplayAlerts\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre></li>\n<li><p><strong>Method 2</strong>: Copy source workbook as new workbook, then open new workbook and delete in new workbook the worksheets not included in list of worksheets received.</p>\n\n<pre><code>Sub Wbk_Copy_To_NewWbk_SelectedSheets(aShtSrc As Variant, sFullPath As String)\nDim WbkSrc As Workbook, WbkNew As Workbook\nDim Wsh As Worksheet\nDim blShtDelete As Boolean\nDim vItm As Variant\nDim blAppDisplayAlerts As Boolean\n\nRem Set Application Properties\nblAppDisplayAlerts = Application.DisplayAlerts\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nRem Set Source Workbook\nSet WbkSrc = ThisWorkbook\n\nRem Save as New Workbook\nWbkSrc.SaveCopyAs (sFullPath)\n\nRem Open New Workbook\nSet WbkNew = Workbooks.Open(sFullPath)\n\nRem Delete Other Worksheets in New Workbook\nFor Each Wsh In WbkNew.Worksheets\n    blShtDelete = True\n    For Each vItm In aShtSrc\n        If Wsh.Name = vItm Then\n            blShtDelete = False\n            Exit For\n    End If: Next\n    If blShtDelete Then Wsh.Delete\nNext\n\nRem Save &amp; Close New Workbbok\nWbkNew.Close SaveChanges:=True\nWbkSrc.Activate\n\nRem Set Application Properties\nApplication.DisplayAlerts = blAppDisplayAlerts\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 6744632, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/26b96ba757c0213c8eaf4a3c8dc94042?s=128&d=identicon&r=PG", "display_name": "user6744632", "link": "https://stackoverflow.com/users/6744632/user6744632"}, "is_accepted": false, "score": 0, "last_activity_date": 1471887739, "last_edit_date": 1471887739, "creation_date": 1471886140, "answer_id": 39085208, "question_id": 33391328, "link": "https://stackoverflow.com/questions/33391328/export-pivot-table-and-source-data-to-another-workbook/39085208#39085208", "title": "Export Pivot Table and Source data to another Workbook", "body": "<p>If you are copying both the pivot table and the source, why not just update the source of the pivot table in the new workbook to match that of the old. Assuming your sheet naming is the same, use the code below. </p>\n\n<pre><code>WkShtIndex = 0\nFor Each WkSht In NewWB.Worksheets\n    WkShtIndex = WkShtIndex + 1\n    PTIndex = 0\n    For Each PTable In WkSht.PivotTables\n        PTIndex = PTIndex + 1\n        PTable.SourceData = MasterWkBk.Sheets(NewWB.Worksheets(WkShtIndex).Name).PivotTables(PTIndex).SourceData\n        PTable.RefreshTable\n    Next PTable\nNext WkSht\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 5498266, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9e47cb8439ec713f2c67a3e6dd7b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "A Torre", "link": "https://stackoverflow.com/users/5498266/a-torre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8979, "favorite_count": 1, "accepted_answer_id": 33439372, "answer_count": 3, "score": 2, "last_activity_date": 1471887739, "creation_date": 1446035961, "last_edit_date": 1446048924, "question_id": 33391328, "link": "https://stackoverflow.com/questions/33391328/export-pivot-table-and-source-data-to-another-workbook", "title": "Export Pivot Table and Source data to another Workbook", "body": "<p>I need to export a pivot table and its source data to another Excel Workbook. I have written this function to do it:</p>\n\n<pre><code>Public Function SaveASSheets (sheetsArray As Variant, destination As String)    \n    Sheets(sheetsArray).Copy\n    ActiveWorkbook.SaveAs destination, 50\n    ActiveWorkbook.Close    \nEnd Function\n</code></pre>\n\n<p>sheetsArray is an array with PivotTable and PivotTable source data worksheets\ndestination is a full path where I want the new Excel file (path + fine name + extension (.xlsb))</p>\n\n<p>The problem I have when I execute this code is new pivot table saved in a new file in destination folder is pointing to the old pivot table source data, instead of using the source data tab I have copied with it.\nData source range in the Name Manager that I use for the old pivot table exist in both files (new and old) but the pivot table in the new file is pointing to the data source range in the old file.</p>\n\n<p>I have tried to reassign new pivot table data source but I got an error: </p>\n\n<blockquote>\n  <p>\"Excel cannot complete this task with available resources, Chose less data or close other applications\"</p>\n</blockquote>\n\n<p>This is my the code:</p>\n\n<pre><code>Public Function SaveASSheets(sheetsArray As Variant, destination As String, Optional pivotTableRange As Range)    \n    Sheets(sheetsArray).Copy\n    ActiveWorkbook.SaveAs destination, 50\n    For Each Sheet In ActiveWorkbook.Worksheets\n        For Each Pivot In Sheet.PivotTables\n            If Not pivotTableRange Is Nothing Then\n                Pivot.SourceData = pivotTableRange\n            End If\n            Pivot.RefreshTable\n            Pivot.Update            \n        Next\n    Next\n    ActiveWorkbook.Close    \nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1446037751, "post_id": 33391291, "comment_id": 54575199, "body": "Can you post the SQL created by Access query designer? Usually it goes <code>INNER JOIN .. ON ... INNER JOIN ... ON...</code> but you have to <code>ONs</code> next to each other."}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1446048585, "last_edit_date": 1446048585, "creation_date": 1446040664, "answer_id": 33393021, "question_id": 33391291, "link": "https://stackoverflow.com/questions/33391291/multiple-inner-joins-in-vba-from-access-database/33393021#33393021", "title": "Multiple INNER JOINS in VBA from ACCESS database", "body": "<p>Your best bet to troubleshoot things like this is to send the string that is generated to your debug/immediate window:</p>\n\n<pre><code>Sub test()\n    Sql = \"SELECT Table2.W, Table5.Attribute \" _\n    &amp; \" FROM (((((Table7 \" _\n    &amp; \" INNER JOIN Table5 )\" _\n    &amp; \" INNER JOIN Table6) \" _\n    &amp; \" INNER JOIN Table1) \" _\n    &amp; \" INNER JOIN Table2 \" _\n    &amp; \" ON Table1.DB_ID = Table2.Attrib_Def) \" _\n    &amp; \" INNER JOIN Table4 \" _\n    &amp; \" ON Table2.Opt_Obj_ID = Table4.Signal \" _\n    &amp; \" AND Table2.Object_ID = Table4.Node \" _\n    &amp; \" ON Table6.DB_ID = Table4.Signal) \" _\n    &amp; \" INNER JOIN Table3 \" _\n    &amp; \" ON Table4.Node = Table3.Node \" _\n    &amp; \" ON Table5.DB_ID = Table3.Node\" _\n    &amp; \" ON Table7.DB_ID = Table3.Message \" _\n    &amp; \" WHERE (((Table1.Name)='TypeA') \" _\n    &amp; \" AND ((Table7.Name)='XX') \" _\n    &amp; \" AND ((Table6.Name)='X')) \"\n\n    Debug.Print Sql\nEnd Sub\n</code></pre>\n\n<p>Copy out the sql produced when you run this and head over to a text editor so you can properly indent this mess:</p>\n\n<pre><code>SELECT Table2.W, Table5.Attribute  \nFROM \n    (\n        (\n            (\n                (\n                    (\n                        Table7  INNER JOIN Table5 \n                    ) \n                    INNER JOIN Table6\n                )  \n                INNER JOIN Table1\n            )  \n            INNER JOIN Table2  \n            ON Table1.DB_ID = Table2.Attrib_Def\n        )  \n        INNER JOIN Table4  \n        ON Table2.Opt_Obj_ID = Table4.Signal  \n            AND Table2.Object_ID = Table4.Node  \n        ON Table6.DB_ID = Table4.Signal\n    )  \n    INNER JOIN Table3  \n    ON Table4.Node = Table3.Node  \n    ON Table5.DB_ID = Table3.Node \n    ON Table7.DB_ID = Table3.Message  \nWHERE \n    (\n        (\n            (\n                Table1.Name\n            ) ='TypeA'\n        )  \n        AND \n        (\n            (\n                Table7.Name\n            )='XX'\n        )  \n        AND \n        (\n            (\n                Table6.Name\n            )='X'\n        )\n    ) \n</code></pre>\n\n<p>The thing with Access's GUI for producing SQL is that it gets stupid about the parentheses. In this case, not a single parentheses is needed. I don't see anything super off here, but its ugly and difficult to diagnose what's happening. Instead use:</p>\n\n<pre><code>SELECT Table2.W, Table5.Attribute  \nFROM Table7  \n    INNER JOIN Table3\n        ON Table3.Message = Table3.DB_ID  \n    INNER JOIN Table5\n        ON Table5.DB_ID = Table3.Node\n    INNER JOIN Table4\n        ON Table4.Node = Table3.Node \n    INNER JOIN Table6 \n        ON Table6.DB_ID = Table4.Signal\n    INNER JOIN Table2\n        ON Table2.Opt_Obj_ID = Table4.Signal  \n    INNER JOIN Table1\n        ON Table1.DB_ID = Table2.Attrib_Def\nWHERE\n    Table1.Name ='TypeA' AND\n    Table7.Name = 'XX' AND\n    Table6.Name = 'X';\n</code></pre>\n\n<p>This is much cleaner and easier to follow. The reason we were able to remove all those parantheses is because it's only <code>INNER JOIN</code> and the <code>WHERE</code> statement is all 'ANDs'. If there were some <code>OR</code> or <code>LEFT OUTER JOIN</code> hanging out in there then we'd have to be more judicial, but I can guarantee you that Access will stick way way way way too many parentheses in there. It just loves em.</p>\n\n<p>Anyway putting this back into VBA you can use:</p>\n\n<pre><code>Sub test()\n    ...all your existing code...\n\n    Dim sql As String\n\n    sql = \"SELECT Table2.W, Table5.Attribute\"\n    sql = sql &amp; \" FROM Table7\"\n    sql = sql &amp; \" INNER JOIN Table3\"\n    sql = sql &amp; \"     ON Table3.Message = Table3.DB_ID\"\n    sql = sql &amp; \" INNER JOIN Table5\"\n    sql = sql &amp; \"     ON Table5.DB_ID = Table3.Node\"\n    sql = sql &amp; \" INNER JOIN Table4\"\n    sql = sql &amp; \"     ON Table4.Node = Table3.Node\"\n    sql = sql &amp; \" INNER JOIN Table6\"\n    sql = sql &amp; \"     ON Table6.DB_ID = Table4.Signal\"\n    sql = sql &amp; \" INNER JOIN Table2\"\n    sql = sql &amp; \"     ON Table2.Opt_Obj_ID = Table4.Signal\"\n    sql = sql &amp; \" INNER JOIN Table1\"\n    sql = sql &amp; \"     ON Table1.DB_ID = Table2.Attrib_Def\"\n    sql = sql &amp; \" WHERE\"\n    sql = sql &amp; \" Table1.Name ='TypeA' AND\"\n    sql = sql &amp; \" Table7.Name = 'XX' AND\"\n    sql = sql &amp; \" Table6.Name = 'X';\"\n\n    Set Signal = cnn.Execute(sql)\nEnd Sub\n</code></pre>\n\n<p>In the end, there is no guarantee that removing the parentheticals will help, but it will definitely remove some of the ambiguity and help you diagnose why it's not executing properly. </p>\n"}], "owner": {"reputation": 3, "user_id": 5498007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7594da2bda3e5e051707b1ae87d9dc40?s=128&d=identicon&r=PG&f=1", "display_name": "Flekxi", "link": "https://stackoverflow.com/users/5498007/flekxi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 856, "favorite_count": 0, "accepted_answer_id": 33393021, "answer_count": 1, "score": 0, "last_activity_date": 1446048585, "creation_date": 1446035833, "last_edit_date": 1531164843, "question_id": 33391291, "link": "https://stackoverflow.com/questions/33391291/multiple-inner-joins-in-vba-from-access-database", "title": "Multiple INNER JOINS in VBA from ACCESS database", "body": "<p>I used Access query designer to set up the joins but it didn't work in VBA.<br>\nI get Syntax Error in FROM '-2147217900 (80040e14)'</p>\n\n<pre><code>Set Signal = cnn.Execute(\"SELECT Table2.W, Table5.Attribute \" _\n    &amp; \" FROM (((((Table7 \" _\n    &amp; \" INNER JOIN Table5 )\" _\n    &amp; \" INNER JOIN Table6) \" _\n    &amp; \" INNER JOIN Table1) \" _\n    &amp; \" INNER JOIN Table2 \" _\n    &amp; \" ON Table1.DB_ID = Table2.Attrib_Def) \" _\n    &amp; \" INNER JOIN Table4 \" _\n    &amp; \" ON Table2.Opt_Obj_ID = Table4.Signal \" _\n    &amp; \" AND Table2.Object_ID = Table4.Node \" _\n    &amp; \" ON Table6.DB_ID = Table4.Signal) \" _\n    &amp; \" INNER JOIN Table3 \" _\n    &amp; \" ON Table4.Node = Table3.Node \" _\n    &amp; \" ON Table5.DB_ID = Table3.Node\" _\n    &amp; \" ON Table7.DB_ID = Table3.Message \" _\n    &amp; \" WHERE (((Table1.Name)='TypeA') \" _\n    &amp; \" AND ((Table7.Name)='XX') \" _\n    &amp; \" AND ((Table6.Name)='X')) \")\n</code></pre>\n"}, {"tags": ["excel", "find", "vba"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1446038394, "post_id": 33391029, "comment_id": 54575672, "body": "As far as I understand, the <code>Find</code> function matches the cell values as they are formatted by the cell. This would find your value, for example, <code>rng.Cells.Find(&quot;23%&quot;, rng.Cells(1), xlValues, xlWhole, xlRows, xlNext, True)</code>."}, {"owner": {"reputation": 2318, "user_id": 4454635, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/68948c08bbd4e872c4ea3726bfeb97d8?s=128&d=identicon&r=PG&f=1", "display_name": "horace_vr", "link": "https://stackoverflow.com/users/4454635/horace-vr"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1446039260, "post_id": 33391029, "comment_id": 54576330, "body": "@Ambie Correct; if I force the argument, it returns the correct address. So this then becomes a problem of either the <code>Min_1</code> into percentage or the cells into a number..."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1446040269, "post_id": 33391029, "comment_id": 54577039, "body": "Well, I&#39;m allergic to cell formatting and the <code>Find</code> function, so I&#39;d read the column into an array of variants and just run a <code>For</code> loop on each cell to match <code>Value2</code> with your item - 4 lines of code and done."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1446041195, "post_id": 33391029, "comment_id": 54577774, "body": "I&#39;ll put the code in an answer for you."}], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 1, "last_activity_date": 1446042077, "creation_date": 1446042077, "answer_id": 33393601, "question_id": 33391029, "link": "https://stackoverflow.com/questions/33391029/vba-range-find-method-return-nothing-when-value-exists/33393601#33393601", "title": "VBA Range.Find Method return Nothing when value exists", "body": "<p>As per my comment, I believe the <code>Find</code> function will match the value of a cell as it is formatted by that cell. So <em>0.23</em> won't find <em>23%</em> unless you do a bit of extra work. This, for example, would work: <code>rng.Cells.Find(\"23%\", rng.Cells(1), xlValues, xlWhole, xlRows, xlNext, True)</code>. I've heard of various, quite extravagant, actions people have taken, esp. when it comes to finding dates (I've even heard of people reading the cell formats, clearing them, and then rewriting them at the conclusion of the <code>Find</code>).</p>\n\n<p>I'm not a big fan of the <code>Find</code> function. One can go to all the effort, for example, of creating a value as a <code>String</code> that would be a match for the specific cell format, only to find that you or someone else decided one more decimal place would be better. It doesn't take a big depth charge to sink that <code>Find</code> sub.</p>\n\n<p>I still favour reading the values into an array and <code>For ... Next</code> looping, especially as <code>Value2</code> gives you the option, for example, of searching for dates in their <code>Long</code> form so there's no risk of formatting issues.</p>\n\n<p>Here's the code for you:</p>\n\n<pre><code>Dim v As Variant\nDim r As Long\nDim c As Long\n\n'If DetractRow range is just one column\nv = DetractRow.Value2\nFor r = 1 To UBound(v, 1)\n    If v(r, 1) = Min_1 Then\n        MsgBox \"Gotcha at index \" &amp; CStr(r)\n        Exit For\n    End If\nNext\n\n'If DetractRow range is just one row\nv = DetractRow.Value2\nFor c = 1 To UBound(v, 2)\n    If v(1, c) = Min_1 Then\n        MsgBox \"Gotcha at index \" &amp; CStr(c)\n        Exit For\n    End If\nNext\n\n'If DetractRow range is more than one row and column\nv = DetractRow.Value2\nFor c = 1 To UBound(v, 2)\n    For r = 1 To UBound(v, 1)\n        If v(r, c) = Min_1 Then\n            MsgBox \"Gotcha at index \" &amp; CStr(r) &amp; _\n                    \", \" &amp; CStr(c)\n            Exit For\n        End If\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 2318, "user_id": 4454635, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/68948c08bbd4e872c4ea3726bfeb97d8?s=128&d=identicon&r=PG&f=1", "display_name": "horace_vr", "link": "https://stackoverflow.com/users/4454635/horace-vr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2345, "favorite_count": 0, "accepted_answer_id": 33393601, "answer_count": 1, "score": 0, "last_activity_date": 1446042077, "creation_date": 1446035156, "last_edit_date": 1531164843, "question_id": 33391029, "link": "https://stackoverflow.com/questions/33391029/vba-range-find-method-return-nothing-when-value-exists", "title": "VBA Range.Find Method return Nothing when value exists", "body": "<p>I am trying to get the address of the cell which contains a certain value:</p>\n\n<pre><code>dim MinAdrress as Range\nSet MinAddress = DetractRow.Find(Min_1, , xlValues, xlWhole)\n</code></pre>\n\n<p><code>Min_1</code> is 0.23, and the <code>DetractRow</code> range contains the following values:</p>\n\n<pre><code>30% 26% 23% 27% -7%\n</code></pre>\n\n<p>So MinAddress should be the 3rd cell in the range. However, in the Locals window I see it as <code>Nothing</code>. I also tried without the optional paramaters (<code>xlValues, xlWhole</code>), same result. Many thanks for any input</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 1, "creation_date": 1446035171, "post_id": 33390940, "comment_id": 54573496, "body": "try this : .NumberFormat = &quot;@&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "edited": false, "score": 0, "creation_date": 1446035974, "post_id": 33391041, "comment_id": 54574000, "body": "You don&#39;t need the the &#39; if you use Value2"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "reply_to_user": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "edited": false, "score": 0, "creation_date": 1446057506, "post_id": 33391041, "comment_id": 54589430, "body": "@Fratyx - Value2 does not work this way for write ; the string gets converted to a time value when its entered"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1446035186, "creation_date": 1446035186, "answer_id": 33391041, "question_id": 33390940, "link": "https://stackoverflow.com/questions/33390940/assigning-cell-value-changes-its-type/33391041#33391041", "title": "Assigning cell value changes its type", "body": "<p>If you want to force a string then preface it with '</p>\n\n<pre><code>Range(\"A3\").Value2 = \"'8:15\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 0, "last_activity_date": 1446036399, "last_edit_date": 1446036399, "creation_date": 1446035815, "answer_id": 33391285, "question_id": 33390940, "link": "https://stackoverflow.com/questions/33390940/assigning-cell-value-changes-its-type/33391285#33391285", "title": "Assigning cell value changes its type", "body": "<p>try this:</p>\n\n<pre><code>With MonthDaysRange1.Cells(1, i)\n     .NumberFormat = \"@\"\n     .Value = DayValue(i, MonthNum)\nEnd With\n</code></pre>\n\n<p>test</p>\n\n<p><a href=\"https://i.stack.imgur.com/HWIrI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HWIrI.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 3687706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d7849e96ef3e32cedad7b2096d0486?s=128&d=identicon&r=PG&f=1", "display_name": "user3687706", "link": "https://stackoverflow.com/users/3687706/user3687706"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 33391285, "answer_count": 2, "score": 0, "last_activity_date": 1446036399, "creation_date": 1446034902, "last_edit_date": 1446035041, "question_id": 33390940, "link": "https://stackoverflow.com/questions/33390940/assigning-cell-value-changes-its-type", "title": "Assigning cell value changes its type", "body": "<p>My function returns different string values.<br>\nFor example: <code>8:15</code> or <code>7</code> or <code>B</code><br>\nI assign it to a cell like this:  </p>\n\n<pre><code>MonthDaysRange1.Cells(1, i).Value = DayValue(i, MonthNum)\n</code></pre>\n\n<p>After that, Excel changes format of the cells to Time. Cell turns into <code>8:15:00</code>. I don`t want that.<br>\nEven if I use this:</p>\n\n<pre><code>MonthDaysRange1.NumberFormat = \"String\"\n</code></pre>\n\n<p>Cell value still <code>8:15:00</code><br>\nI only want to populate cells with text, without any changes to the format.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1402, "user_id": 2223566, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74716b1ef308b59103a1f2415f84abb1?s=128&d=identicon&r=PG&f=1", "display_name": "rotgers", "link": "https://stackoverflow.com/users/2223566/rotgers"}, "edited": false, "score": 0, "creation_date": 1446034934, "post_id": 33390890, "comment_id": 54573341, "body": "Why declare something as a <code>constant</code> if you want to change it?"}, {"owner": {"reputation": 51, "user_id": 4873141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3bb99f7e50f487cdc861c3917f0989?s=128&d=identicon&r=PG&f=1", "display_name": "dtk142", "link": "https://stackoverflow.com/users/4873141/dtk142"}, "reply_to_user": {"reputation": 1402, "user_id": 2223566, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74716b1ef308b59103a1f2415f84abb1?s=128&d=identicon&r=PG&f=1", "display_name": "rotgers", "link": "https://stackoverflow.com/users/2223566/rotgers"}, "edited": false, "score": 0, "creation_date": 1446094309, "post_id": 33390890, "comment_id": 54603639, "body": "Cause I use Workbook event handler to trigger my vba code. And the constant will store the result from last run and pass it to vba code when trigger were turn on"}, {"owner": {"reputation": 1402, "user_id": 2223566, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74716b1ef308b59103a1f2415f84abb1?s=128&d=identicon&r=PG&f=1", "display_name": "rotgers", "link": "https://stackoverflow.com/users/2223566/rotgers"}, "edited": false, "score": 0, "creation_date": 1446108189, "post_id": 33390890, "comment_id": 54609394, "body": "You can not change the value of a constant at run-time. Declare a normal variable instead; <code>Public prev as String</code>."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4873141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3bb99f7e50f487cdc861c3917f0989?s=128&d=identicon&r=PG&f=1", "display_name": "dtk142", "link": "https://stackoverflow.com/users/4873141/dtk142"}, "edited": false, "score": 0, "creation_date": 1446094316, "post_id": 33391155, "comment_id": 54603644, "body": "Cause I use Workbook event handler to trigger my vba code. And the constant will store the result from last run and pass it to vba code when trigger were turned on"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "reply_to_user": {"reputation": 51, "user_id": 4873141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3bb99f7e50f487cdc861c3917f0989?s=128&d=identicon&r=PG&f=1", "display_name": "dtk142", "link": "https://stackoverflow.com/users/4873141/dtk142"}, "edited": false, "score": 0, "creation_date": 1446108974, "post_id": 33391155, "comment_id": 54609858, "body": "then, save the variables in a worksheet or file or registry."}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 0, "last_activity_date": 1446035486, "creation_date": 1446035486, "answer_id": 33391155, "question_id": 33390890, "link": "https://stackoverflow.com/questions/33390890/vba-code-change-while-running/33391155#33391155", "title": "VBA code change while running", "body": "<p>if you want to change values, declare it as</p>\n\n<pre><code>public prev as {your data type}\n</code></pre>\n\n<p>constants are <strong>immutable</strong> once the compiler reserves the memory for it you won't have a change to modify it again unless you are recompiling.</p>\n"}, {"comments": [{"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 0, "creation_date": 1446192006, "post_id": 33430921, "comment_id": 54650558, "body": "I think your question was downvoted because you tried to achieve your goal in a very complicated way. Writing the value to a cell or a file would be easier, and doesn&#39;t conflict any changes of your code structure."}, {"owner": {"reputation": 51, "user_id": 4873141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3bb99f7e50f487cdc861c3917f0989?s=128&d=identicon&r=PG&f=1", "display_name": "dtk142", "link": "https://stackoverflow.com/users/4873141/dtk142"}, "reply_to_user": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 0, "creation_date": 1446194433, "post_id": 33430921, "comment_id": 54651711, "body": "I know that will be easier but the requirement is that. I am not the one who use this code."}], "tags": [], "owner": {"reputation": 51, "user_id": 4873141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3bb99f7e50f487cdc861c3917f0989?s=128&d=identicon&r=PG&f=1", "display_name": "dtk142", "link": "https://stackoverflow.com/users/4873141/dtk142"}, "is_accepted": false, "score": 0, "last_activity_date": 1446190863, "creation_date": 1446190863, "answer_id": 33430921, "question_id": 33390890, "link": "https://stackoverflow.com/questions/33390890/vba-code-change-while-running/33430921#33430921", "title": "VBA code change while running", "body": "<p>finnally I have found out the way</p>\n\n<pre><code>Application.VBE.CodePanes(1).CodeModule.ReplaceLine 1, \"Public Const prev = \" &amp; strValue\n</code></pre>\n\n<p>For those who vote down my question, if you dont have enough knowledge , just dont think that it cannot work</p>\n"}], "owner": {"reputation": 51, "user_id": 4873141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3bb99f7e50f487cdc861c3917f0989?s=128&d=identicon&r=PG&f=1", "display_name": "dtk142", "link": "https://stackoverflow.com/users/4873141/dtk142"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1446190863, "creation_date": 1446034738, "question_id": 33390890, "link": "https://stackoverflow.com/questions/33390890/vba-code-change-while-running", "title": "VBA code change while running", "body": "<p>I have a vba with declaration of some constant, such as </p>\n\n<pre><code>Public Const prev = \"\"\n</code></pre>\n\n<p>My idea is that the VBA code will update/change this constant prev everytime the code was run.\nIn the past, I have found out the solution of this case, but unfortunately I forgot to save it . So I sure that we can do it with VBA. But now I cannot find it again.</p>\n"}, {"tags": ["ms-access", "vba", "calc"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1446035801, "post_id": 33390081, "comment_id": 54573896, "body": "This expression is very fast, so you probably have to look elsewhere for optimization. And it <i>will</i> work if your textboxes contain numerals, so what is your code, please?"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1446037379, "post_id": 33390081, "comment_id": 54574938, "body": "I added the my code I have to the post"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1446044482, "post_id": 33390081, "comment_id": 54580286, "body": "Test with your form&#39;s <i>Timer Interval</i> property set to 0.  Does that make the &quot;4th total box&quot; more responsive?  It seemed to in my copy of your db."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1446044743, "post_id": 33390081, "comment_id": 54580488, "body": "HansUp if I change the timer will that make my live clock not work?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1446045001, "post_id": 33390081, "comment_id": 54580685, "body": "Yes, the &quot;Discover Time&quot; text box will remain empty.  I&#39;m only suggesting you test the impact of disabling the timer.  If it helps, you will need to decide what to do about &quot;Discover Time&quot; later.  If it doesn&#39;t help, set it back to 125 and look elsewhere for improvements."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1446045048, "post_id": 33390081, "comment_id": 54580716, "body": "It does help alot I will just have to not have a live clock thanks so much!"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1446045316, "post_id": 33390081, "comment_id": 54580929, "body": "Excellent!  I think you made the right choice there, BC.  You acknowledged <i>&quot;the form I have created has so many things running on it thats why the calculation is slow&quot;</i>.  Updating  &quot;Discover Time&quot; 8 times per second only added to that workload.  And actually, I didn&#39;t see why displaying &quot;Discover Time&quot; at all was valuable.  Suggest you look for other opportunities to simplify that form.  Good luck."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1446044665, "post_id": 33393883, "comment_id": 54580426, "body": "Ok so I should put this in the afterupdate of each of the three textboxes?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1446048999, "post_id": 33393883, "comment_id": 54583714, "body": "No. You would save it in a function called, say, <code>UpdateTotal</code> and then call this function from the three <code>AfterUpdate</code> events."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1446042788, "creation_date": 1446042788, "answer_id": 33393883, "question_id": 33390081, "link": "https://stackoverflow.com/questions/33390081/converting-an-expression-to-vba-in-access/33393883#33393883", "title": "Converting an expression to VBA in access", "body": "<p>Then you could use:</p>\n\n<pre><code>Me!Total.Value = 0\n' Ignore error from non-numeric input.\nOn Error Resume Next\nMe!Total.Value = CDbl(Nz(Me!txtPart1.Value, 0)) + CDbl(Nz(Me!txtPart2.Value, 0)) + CDbl(Nz(Me!txtPart3.Value, 0)) \n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 33393883, "answer_count": 1, "score": 0, "last_activity_date": 1594643339, "creation_date": 1446032401, "last_edit_date": 1594643339, "question_id": 33390081, "link": "https://stackoverflow.com/questions/33390081/converting-an-expression-to-vba-in-access", "title": "Converting an expression to VBA in access", "body": "<p>I have created an expression to add 3 textboxes together into a 4th total box. The expression is:</p>\n\n<pre><code>=Cdbl(Nz[txtPart1],0)) + Cdbl(Nz[txtPart2],0)) + Cdbl(Nz[txtPart3],0)) \n</code></pre>\n\n<p>I am trying to convert this into VBA code because the form I have created has so many things running on it thats why the calculation is slow. I want to be able to add an hour glass so the user doesn't think that the program is not working. I tried putting a code that sums the 3 in the after update event of all three textboxes but that did not work. Please help!</p>\n\n<p>I have this code in the AfterUpdate of the 3 textboxes:</p>\n\n<pre><code>me.total = me.txtpPart1 + me.txtPart2 + me.txtPart3\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["forms", "vba", "sql-server-2008", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1446034886, "post_id": 33389709, "comment_id": 54573319, "body": "Actually I&#39;m not sure what exactly you want to achieve. If you want to have all column names of a specific table as list items (rows) in the listbox, then my answer doesn&#39;t help you."}, {"owner": {"reputation": 871, "user_id": 2514925, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0b3640302f881d24076f5454336e7f23?s=128&d=identicon&r=PG", "display_name": "user2514925", "link": "https://stackoverflow.com/users/2514925/user2514925"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1446037352, "post_id": 33389709, "comment_id": 54574919, "body": "yes i want to have all column names of a specific table as list items (rows) in the listbox"}], "answers": [{"comments": [{"owner": {"reputation": 871, "user_id": 2514925, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0b3640302f881d24076f5454336e7f23?s=128&d=identicon&r=PG", "display_name": "user2514925", "link": "https://stackoverflow.com/users/2514925/user2514925"}, "edited": false, "score": 0, "creation_date": 1446033576, "post_id": 33390028, "comment_id": 54572501, "body": "Thank you for the response..But the list box still blank."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "reply_to_user": {"reputation": 871, "user_id": 2514925, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0b3640302f881d24076f5454336e7f23?s=128&d=identicon&r=PG", "display_name": "user2514925", "link": "https://stackoverflow.com/users/2514925/user2514925"}, "edited": false, "score": 0, "creation_date": 1446035814, "post_id": 33390028, "comment_id": 54573906, "body": "@user2514925 if the listbox is blank check its row-source"}, {"owner": {"reputation": 871, "user_id": 2514925, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0b3640302f881d24076f5454336e7f23?s=128&d=identicon&r=PG", "display_name": "user2514925", "link": "https://stackoverflow.com/users/2514925/user2514925"}, "edited": false, "score": 0, "creation_date": 1446037289, "post_id": 33390028, "comment_id": 54574877, "body": "I have given the &quot;Table Name&quot;  row source value and &quot;Field List&quot; as the Row source Type..Am i missing anything"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 871, "user_id": 2514925, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0b3640302f881d24076f5454336e7f23?s=128&d=identicon&r=PG", "display_name": "user2514925", "link": "https://stackoverflow.com/users/2514925/user2514925"}, "edited": false, "score": 0, "creation_date": 1446038298, "post_id": 33390028, "comment_id": 54575588, "body": "@user2514925: If you have selected the table name as <code>RowSource</code>, this should work. <code>ColumnCount</code> should be 1 and <code>ColumnWidths</code> should be empty."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 4, "last_activity_date": 1446032237, "creation_date": 1446032237, "answer_id": 33390028, "question_id": 33389709, "link": "https://stackoverflow.com/questions/33389709/how-to-display-the-column-names-of-the-table-in-the-listbox-in-ms-access/33390028#33390028", "title": "How to display the Column names of the table in the listbox in MS Access?", "body": "<p>The Listbox (and Combobox) have a property under \"Format\" for that: <code>ColumnHeads</code></p>\n\n<p>Set it to True to show column names.</p>\n"}], "owner": {"reputation": 871, "user_id": 2514925, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0b3640302f881d24076f5454336e7f23?s=128&d=identicon&r=PG", "display_name": "user2514925", "link": "https://stackoverflow.com/users/2514925/user2514925"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2664, "favorite_count": 0, "accepted_answer_id": 33390028, "answer_count": 1, "score": 1, "last_activity_date": 1446032284, "creation_date": 1446031320, "question_id": 33389709, "link": "https://stackoverflow.com/questions/33389709/how-to-display-the-column-names-of-the-table-in-the-listbox-in-ms-access", "title": "How to display the Column names of the table in the listbox in MS Access?", "body": "<p>I am trying to display all the column names of the table in the list box in MS ACCESS front end where SQL SERVER is used as the back end and have the linked tables and queries in the application</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1402, "user_id": 2223566, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74716b1ef308b59103a1f2415f84abb1?s=128&d=identicon&r=PG&f=1", "display_name": "rotgers", "link": "https://stackoverflow.com/users/2223566/rotgers"}, "edited": false, "score": 0, "creation_date": 1446030233, "post_id": 33389178, "comment_id": 54570407, "body": "What do you want the code to do? Where is the problem in your code? What have you tried?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1446032049, "post_id": 33389178, "comment_id": 54571544, "body": "when optional parameters x2 and x3 are missing, you try to compare them to some value... Maybe you should compare them when they are Not missing?"}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1446032582, "last_edit_date": 1446032582, "creation_date": 1446032281, "answer_id": 33390044, "question_id": 33389178, "link": "https://stackoverflow.com/questions/33389178/bucketing-using-vba/33390044#33390044", "title": "Bucketing Using VBA", "body": "<pre><code>Function BUCKET(\n    range As range, \n    x1 As Double, \n    name1 As String, \n    Optional x2 As Variant, 'IsMissing needs Variant to work.\n    Optional name2 As String, \n    Optional x3 As Variant, 'IsMissing needs Variant to work. \n    Optional name3 As String\n) As String\n\n    If range.Value &lt; x1 Then\n        BUCKET = name1\n    ElseIf Not IsMissing(x2) And range.Value &lt; x2 Then\n        BUCKET = name2\n    ElseIf Not IsMissing(x3) And range.Value &lt; x3 Then\n        BUCKET = name3\n    Else\n        BUCKET = \"NO\"\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5497857, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DHMsp_y__oo/AAAAAAAAAAI/AAAAAAAAAWw/UL6pu8iRXdY/photo.jpg?sz=128", "display_name": "Shankha Patsa", "link": "https://stackoverflow.com/users/5497857/shankha-patsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 33390044, "answer_count": 1, "score": -3, "last_activity_date": 1446032582, "creation_date": 1446029773, "last_edit_date": 1446030114, "question_id": 33389178, "link": "https://stackoverflow.com/questions/33389178/bucketing-using-vba", "title": "Bucketing Using VBA", "body": "<p>Tried to Bucket data wrote this code can anybody will say what is wrong with this code.</p>\n\n<pre><code>Function BUCKET(\n    range As range, \n    x1 As Double, \n    name1 As String, \n    Optional x2 As Double, \n    Optional name2 As String, \n    Optional x3 As Double, \n    Optional name3 As String\n) As String\n\n    If range.Value &lt; x1 Then\n        BUCKET = name1\n    ElseIf IsMissing(x2) Then\n        If range.Value &lt; x2 Then\n            BUCKET = name2\n        ElseIf IsMissing(x3) Then\n            If range.Value &lt; x3 Then\n                BUCKET = name3\n            Else\n                BUCKET = \"NO\"\n            End If\n        End If\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "comaddin"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1446032933, "post_id": 33388504, "comment_id": 54572064, "body": "Have you checked if the addin is setting a .CustomDocumentProperty?  If so, setting it before saving may stop the addin dialogue from firing."}, {"owner": {"reputation": 31, "user_id": 5480319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fa70da3e70b421c063e5a4e6e9fb453?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName88", "link": "https://stackoverflow.com/users/5480319/displayname88"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1446042879, "post_id": 33388504, "comment_id": 54579047, "body": "Hi Mark, I&#39;m a bit of a newbie to developing/VBA, are you able to prove any further details on this (i.e. how would I check/change this)? Thanks."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1446074601, "post_id": 33388504, "comment_id": 54598124, "body": "Are you operating within a SharePoint environment?"}, {"owner": {"reputation": 31, "user_id": 5480319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fa70da3e70b421c063e5a4e6e9fb453?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName88", "link": "https://stackoverflow.com/users/5480319/displayname88"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1446110927, "post_id": 33388504, "comment_id": 54611086, "body": "The document itself has not been uploaded to any sharepoint if that&#39;s what you mean..."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1446111369, "post_id": 33388504, "comment_id": 54611349, "body": "So you get the message when you try to upload it to SharePoint?"}, {"owner": {"reputation": 31, "user_id": 5480319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fa70da3e70b421c063e5a4e6e9fb453?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName88", "link": "https://stackoverflow.com/users/5480319/displayname88"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1446112681, "post_id": 33388504, "comment_id": 54612195, "body": "The user gets the dialogue box when trying to save to any location irrespective of where it&#39;s being saved."}], "owner": {"reputation": 31, "user_id": 5480319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fa70da3e70b421c063e5a4e6e9fb453?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName88", "link": "https://stackoverflow.com/users/5480319/displayname88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446027877, "creation_date": 1446027877, "last_edit_date": 1495542595, "question_id": 33388504, "link": "https://stackoverflow.com/questions/33388504/vba-default-response-to-a-comaddin", "title": "VBA default response to a comaddin", "body": "<p>My excel contains a comaddin that is implemented by the company I work for, in which when the user saves a file it brings up a dialogue box in which they have to specify the type of document it is (e.g. public, confidential etc...). As I am unable to disable this (see <a href=\"https://stackoverflow.com/questions/33367531/disable-but-not-disconnect-excel-com-addin-with-vba\">https://stackoverflow.com/questions/33367531/disable-but-not-disconnect-excel-com-addin-with-vba</a>) my alternative thought was whether there was a way to implement a default response to this within the vba (e.g. always select public when this dialogue box appears). Does anyone know whether this is viable and if so how I would go about it?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1446028559, "post_id": 33388358, "comment_id": 54569371, "body": "Are missing values only in ColB?"}], "answers": [{"tags": [], "owner": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "is_accepted": false, "score": 0, "last_activity_date": 1446029194, "creation_date": 1446029194, "answer_id": 33388991, "question_id": 33388358, "link": "https://stackoverflow.com/questions/33388358/excel-macro-to-insert-blank-cells-that-are-different-from-each-other/33388991#33388991", "title": "Excel macro to insert blank cells that are different from each other", "body": "<p>Try the below ?</p>\n\n<pre><code>For i = 2 To ActiveSheet.UsedRange.Rows.Count\n    If Not Cells(i, 1).Value = Cells(i, 2).Value Then\n        Cells(i, 2).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        Cells(i, 2).Value = \"Blank Cell\"\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5312109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd0eee6027ab1dc6efe78896de5fed9?s=128&d=identicon&r=PG&f=1", "display_name": "MUKESH KUMAR", "link": "https://stackoverflow.com/users/5312109/mukesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1446201303, "creation_date": 1446027524, "last_edit_date": 1446201303, "question_id": 33388358, "link": "https://stackoverflow.com/questions/33388358/excel-macro-to-insert-blank-cells-that-are-different-from-each-other", "title": "Excel macro to insert blank cells that are different from each other", "body": "<p>I want to insert a blank cells that are different from each other; in this case colA and colB. </p>\n\n<p>What I'm trying to insert a blank cell if ColB if different from ColA</p>\n\n<p>Input is</p>\n\n<pre><code>ColA ColB\n1      1\n2      2\n3      4\n4\n</code></pre>\n\n<p>output should be</p>\n\n<pre><code>ColA ColB\n1      1\n2      2\n3     Blank cel\n4      4\n</code></pre>\n"}, {"tags": ["vba", "excel", "drop-down-menu"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1446032464, "post_id": 33388199, "comment_id": 54571780, "body": "This code runs fine for me. (although I altered to specify the worksheet in the with statement). Are you sure the names in the spreadsheet are the same as the named ranges - also the third code box (debug high-lighted code) contains an asterisk at the end; you may have a typo?"}, {"owner": {"reputation": 957, "user_id": 2820289, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4eec9f1586150444590497403571d65f?s=128&d=identicon&r=PG&f=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/2820289/helen"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 2, "creation_date": 1446032780, "post_id": 33388199, "comment_id": 54571981, "body": "removed the asterix. Using <b>With Sheets(&quot;Sheet1&quot;).Range(&quot;B1:B2&quot;).Validation</b> does nothing for me unfortunately... this is so weird"}, {"owner": {"reputation": 957, "user_id": 2820289, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4eec9f1586150444590497403571d65f?s=128&d=identicon&r=PG&f=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/2820289/helen"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1446034118, "post_id": 33388199, "comment_id": 54572836, "body": "@Flephal : maybe you recognize the problem from my EDIT?"}, {"owner": {"reputation": 957, "user_id": 2820289, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4eec9f1586150444590497403571d65f?s=128&d=identicon&r=PG&f=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/2820289/helen"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1446046536, "post_id": 33388199, "comment_id": 54581835, "body": "@Flephal : how exactly did you alter the code?"}, {"owner": {"reputation": 957, "user_id": 2820289, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4eec9f1586150444590497403571d65f?s=128&d=identicon&r=PG&f=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/2820289/helen"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1446049878, "post_id": 33388199, "comment_id": 54584390, "body": "How this code works when I generate it with the Macro Recorder, and not when ececuting the code, can anybody please explain me?"}], "owner": {"reputation": 957, "user_id": 2820289, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4eec9f1586150444590497403571d65f?s=128&d=identicon&r=PG&f=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/2820289/helen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2416, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446118314, "creation_date": 1446027049, "last_edit_date": 1495539890, "question_id": 33388199, "link": "https://stackoverflow.com/questions/33388199/excel-vba-drop-down-list-from-named-range", "title": "Excel VBA drop down list from named range", "body": "<p>Similar problem: <a href=\"https://stackoverflow.com/questions/31455822/using-indirect-function-in-data-validation-through-vba\">here</a></p>\n\n<p>I have this code, where I want to create a drop down list, say in Range B1:B2, where the list is dependent on some named ranges given in A1:A2. </p>\n\n<p><a href=\"https://i.stack.imgur.com/k5j2o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k5j2o.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub asdf()\n\n\n    With Range(\"B1:B2\").Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=\"=INDIRECT(INDIRECT(\"\"RC[-1]\"\",0))\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Problem is this gives me the error </p>\n\n<blockquote>\n  <p>Run time error 1004' (Application defined or object defined error)</p>\n</blockquote>\n\n<p>and when I click debug the following line is highlighted </p>\n\n<pre><code>   .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=\"=INDIRECT(INDIRECT(\"\"RC[-1]\"\",0))\"\n</code></pre>\n\n<p>The code actually has run a couple of times, I have no idea why. But then only the first cell A1 gets a dropdown list with correct values from the named range - while the cell A2 is a dropdown list with no values (all named ranges work, I've checked)</p>\n\n<p><strong>EDIT</strong> \nI think I located part of the problem, although this does not explain my problems with running the code. (forgive the non-English version of my Excel, but you might recognize this as the \"Name Manager\" inside \"Formula\"). The code is basically exactly the same as the code I get from the Macro Recorder, so this should work, should it not? Some of my named ranges has Value {...}. Why is this? The Named Ranges refer to the correct cells, but the cell values are empty...</p>\n\n<p><a href=\"https://i.stack.imgur.com/lfg5z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lfg5z.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT2</strong></p>\n\n<p>It seems that you do not get the values for the cells you choose for a named range, when the cells are separated. This is so messed up... Is there a away around this?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1446028055, "post_id": 33388138, "comment_id": 54569058, "body": "Have you tried a simple <code>MsgBox wdDoc.Tables.Count</code>?"}, {"owner": {"reputation": 1271, "user_id": 1545812, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a11d1e37ad8e4c29dbe7e166aac30ba0?s=128&d=identicon&r=PG", "display_name": "Timothy Alston", "link": "https://stackoverflow.com/users/1545812/timothy-alston"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1446031953, "post_id": 33388138, "comment_id": 54571478, "body": "Thank you- I combined your code with that suggested by BasDeBeer below, and the combo worked. Many thanks for the help."}], "answers": [{"comments": [{"owner": {"reputation": 1271, "user_id": 1545812, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a11d1e37ad8e4c29dbe7e166aac30ba0?s=128&d=identicon&r=PG", "display_name": "Timothy Alston", "link": "https://stackoverflow.com/users/1545812/timothy-alston"}, "edited": false, "score": 0, "creation_date": 1446031882, "post_id": 33388747, "comment_id": 54571437, "body": "I added &quot;MsgBox&quot; in front of the &quot;Active.Document.Tables.Count&quot; and that seemed to work. Many thanks!"}], "tags": [], "owner": {"reputation": 240, "user_id": 5341300, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4bfd18a98c7c42e9cae2146fcabd6dff?s=128&d=identicon&r=PG&f=1", "display_name": "GijsApeldoorn", "link": "https://stackoverflow.com/users/5341300/gijsapeldoorn"}, "is_accepted": true, "score": 4, "last_activity_date": 1579276244, "last_edit_date": 1579276244, "creation_date": 1446028491, "answer_id": 33388747, "question_id": 33388138, "link": "https://stackoverflow.com/questions/33388138/counting-the-number-of-tables-in-a-word-document/33388747#33388747", "title": "Counting the number of tables in a Word document", "body": "<p>This should work:</p>\n\n<pre><code>   Debug.Print Active.Document.Tables.Count\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14311982, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GJn5vOcaRDQ/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucnWKK7gmUxNtMWmymKnFm25jU7D2g/photo.jpg?sz=128", "display_name": "Connor Campbell", "link": "https://stackoverflow.com/users/14311982/connor-campbell"}, "is_accepted": false, "score": 0, "last_activity_date": 1604898521, "creation_date": 1604898521, "answer_id": 64746154, "question_id": 33388138, "link": "https://stackoverflow.com/questions/33388138/counting-the-number-of-tables-in-a-word-document/64746154#64746154", "title": "Counting the number of tables in a Word document", "body": "<p>Using Word 2016, the recommended answer was still running into an error. I tried a slightly revised version combining the answer &amp; comments above. Having a period between &quot;Active&quot; and &quot;Document&quot; caused the macro to fail. I swapped in Message Box for Debug.Print, and this worked:</p>\n<pre><code>Sub CountTables()\n'\n' CountTables Macro\n'\n'\nMsgBox ActiveDocument.Tables.Count\n    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1271, "user_id": 1545812, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a11d1e37ad8e4c29dbe7e166aac30ba0?s=128&d=identicon&r=PG", "display_name": "Timothy Alston", "link": "https://stackoverflow.com/users/1545812/timothy-alston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9835, "favorite_count": 1, "accepted_answer_id": 33388747, "answer_count": 2, "score": 3, "last_activity_date": 1604898521, "creation_date": 1446026881, "last_edit_date": 1593756523, "question_id": 33388138, "link": "https://stackoverflow.com/questions/33388138/counting-the-number-of-tables-in-a-word-document", "title": "Counting the number of tables in a Word document", "body": "<p>I have a Word document with many tables.</p>\n\n<p>I need to count the number of tables.</p>\n\n<p>I have tried the following VBA</p>\n\n<pre><code>Dim T as Table\nDim i as Integer\nDim Tables as Integer\n\nFor Each T In wdDoc.Tables\n    i = i + 1\n    Exit For\nNext\nTables = i\nEnd sub\n</code></pre>\n\n<p>However this comes back with</p>\n\n<blockquote>\n  <p>\"Run-time error '424': Object required\".</p>\n</blockquote>\n\n<p>I also found on the internet the code</p>\n\n<pre><code>Tables = wdDoc.Tables.Count\n</code></pre>\n\n<p>Creating a macro with this code doesn't seem to do anything.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "edited": false, "score": 1, "creation_date": 1446026038, "post_id": 33387770, "comment_id": 54567746, "body": "Did not know that tmpAr = getAr makes dimensioning of tmpAr redundant. Good to know! Thanks a lot!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 3, "last_activity_date": 1446025861, "creation_date": 1446025861, "answer_id": 33387770, "question_id": 33387718, "link": "https://stackoverflow.com/questions/33387718/how-to-use-a-string-array-returned-from-a-function/33387770#33387770", "title": "How to use a string array returned from a function?", "body": "<p>Your function and sub both need changing:</p>\n\n<pre><code>Function getAr() As String()\n    Dim tmpAr(3)              As String\n    tmpAr(0) = \"Hallo\"\n    tmpAr(1) = \"I\"\n    tmpAr(2) = \"Am\"\n    tmpAr(3) = \"I\"\n    getAr = tmpAr\nEnd Function\n\nSub test()\n    Dim tmpAr()               As String\n    tmpAr = getAr\n    Debug.Print tmpAr(0)\n    Debug.Print tmpAr(1)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1446026101, "creation_date": 1446026101, "answer_id": 33387848, "question_id": 33387718, "link": "https://stackoverflow.com/questions/33387718/how-to-use-a-string-array-returned-from-a-function/33387848#33387848", "title": "How to use a string array returned from a function?", "body": "<p>You don't need to know the dimension to assign an array, but your code wasn't correct.</p>\n\n<p>Here is my amended version :</p>\n\n<pre><code>Function getAr() As String()\n\nDim tmpAr(3) As String\n\ntmpAr(0) = \"Hallo\"\ntmpAr(1) = \"I\"\ntmpAr(2) = \"Am\"\ntmpAr(3) = \"I\"\n\ngetAr = tmpAr\nEnd Function\n</code></pre>\n\n<p>Notice the <code>String()</code>, this is how you declare the type of a function returning an array.</p>\n\n<p>Also, you were dimensionning <code>tmpAr</code> and tried to affect values to <code>getAr</code> which wasn't set and as you started, it is much easier to work with a temp variable that you'll assign to the function's output at the end of the manipulations.</p>\n\n<p>And your ReDim <code>ReDim tmpAr(UBound(getAr))</code> was working but did not pass the array, this how you do it <code>tmpAr = getAr</code> and you don't even need to use <code>ReDim</code> before! ;)</p>\n\n<pre><code>Sub test()\nDim tmpAr() As String\ntmpAr = getAr\n\nDebug.Print tmpAr(0)\nDebug.Print tmpAr(1)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 33387848, "answer_count": 2, "score": 2, "last_activity_date": 1487251186, "creation_date": 1446025691, "last_edit_date": 1487251186, "question_id": 33387718, "link": "https://stackoverflow.com/questions/33387718/how-to-use-a-string-array-returned-from-a-function", "title": "How to use a string array returned from a function?", "body": "<p>I have a function that returns a <code>string array</code> </p>\n\n<pre><code>Function getAr() As String\nDim tmpAr(3) As String\ngetAr(0) = \"Hallo\"\ngetAr(1) = \"I\"\ngetAr(2) = \"Am\"\ngetAr(3) = \"I\"\ngetAr = tmpAr\nEnd Function\n</code></pre>\n\n<p>In a <code>Sub</code> I want to reassign the returned string array like</p>\n\n<pre><code>Sub test()\nDim tmpAr() As String\nReDim tmpAr(UBound(getAr))\nDebug.Print tmpAr(0)\nDebug.Print tmpAr(1)\nEnd Sub\n</code></pre>\n\n<p>The error is </p>\n\n<blockquote>\n  <p>assigning to data field is not possible. </p>\n</blockquote>\n\n<p>I guess that is because I have to dimension the <code>strAr</code> to the same dimension as the <code>myfunc</code> arry. But I just do not get that information.</p>\n\n<p>Could anyone help me here?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1446025706, "post_id": 33387551, "comment_id": 54567521, "body": "You want to use a UDF (User Defined Function) directly in Word or in the VBA code for Word? Can you give an example, because I don&#39;t see how you can use something like this..."}, {"owner": {"reputation": 39, "user_id": 2587965, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PPee2.jpg?s=128&g=1", "display_name": "francogrex", "link": "https://stackoverflow.com/users/2587965/francogrex"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1446029188, "post_id": 33387551, "comment_id": 54569759, "body": "well simple in excel something like: Declare Function myfunction Lib &quot;c:/test.dll&quot; Alias &quot;myfunction@8&quot; (ByVal x As Long, ByVal y As Long) As Long   then in an excel cell type =myfunction(2,3) [enter] and there is the result in the cell."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1446038663, "post_id": 33387551, "comment_id": 54575859, "body": "Hmmm... ok, so it seems you want to calculation directly into a Word document&#39;s body using a UDF... I don&#39;t know if it&#39;s possible, but it seems improbable... Maybe with some event handling, but I&#39;m not sure that you will find an event that fit your need..."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1446048255, "creation_date": 1446048255, "answer_id": 33395964, "question_id": 33387551, "link": "https://stackoverflow.com/questions/33387551/is-it-possible-to-use-an-udf-in-ms-word-documents-body/33395964#33395964", "title": "Is it possible to use an UDF in MS WORD document&#39;s body?", "body": "<p>The closest Word comes to \"functions\" is field codes. But these are all pre-defined. Years ago, there were requests to introduce \"UDF\" but the idea was never followed-up on because they'd be a major security issue (malicious code that could execute automatically).</p>\n\n<p>You can get some \"automatic\" calculation without code by using form fields, but then the document must be protected as a form. You can also use fields, otherwise and without protecting the document, for calculating but the calculation will not update automatically/transparently unless there's code present.</p>\n\n<p>Beyond that, code is required. You can attach to content controls or ActiveX controls embedded on the document surface.</p>\n"}], "owner": {"reputation": 39, "user_id": 2587965, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PPee2.jpg?s=128&g=1", "display_name": "francogrex", "link": "https://stackoverflow.com/users/2587965/francogrex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 33395964, "answer_count": 1, "score": 1, "last_activity_date": 1446048255, "creation_date": 1446025198, "last_edit_date": 1446038708, "question_id": 33387551, "link": "https://stackoverflow.com/questions/33387551/is-it-possible-to-use-an-udf-in-ms-word-documents-body", "title": "Is it possible to use an UDF in MS WORD document&#39;s body?", "body": "<p>I know in MS Excel one can write a <strong>custom function in VBA module</strong> and then from the excel spreadsheet call it like: <code>=myfunction(arg1,arg2,...)</code></p>\n\n<p>However in VBA for MS WORD is it possible to do such a direct call without having to have a VBA macro/subroutine around it?</p>\n"}, {"tags": ["vba", "excel", "delay", "adjustable"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1446024919, "post_id": 33387306, "comment_id": 54567022, "body": "Can you specify, the data you input in &quot;D3&quot; and the format of that cell? Also on which line do you get the error! ;)"}], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "edited": false, "score": 1, "creation_date": 1446026244, "post_id": 33387475, "comment_id": 54567891, "body": "Thanks for the very clear explaination, but unfortunatly I&#39;m still getting te same error.  - Changed (&quot;t&quot;) into (t) -Changed the cell&#39;s  Category back into General instead of time  -Tryed to enter 0:00:01 instead of 0:00:00  But both changes didn&#39;t make any sence.  (thanks for your anwser, although it didn&#39;t work it was at least explained very clear. &quot;give a man a fish and he&#39;ll have food for a day, learn a man how to fish and he will never be hungry again&quot;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "edited": false, "score": 1, "creation_date": 1446026515, "post_id": 33387475, "comment_id": 54568063, "body": "Set the <b>format of the cell D3 to Text</b> and take a look at the edited code, I added <code>CStr()</code> function to convert your input as a <code>String</code> to avoid any misinterpretation from Excel! ;)"}, {"owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "edited": false, "score": 0, "creation_date": 1446027562, "post_id": 33387475, "comment_id": 54568731, "body": "Changing Cell &quot;D3&quot;into text format was sufficient to fix my problem! Thanks a lot."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1446026526, "last_edit_date": 1446026526, "creation_date": 1446024975, "answer_id": 33387475, "question_id": 33387306, "link": "https://stackoverflow.com/questions/33387306/adjustable-macro-delay-by-entering-time-in-cell/33387475#33387475", "title": "Adjustable macro delay (by entering time in cell)", "body": "<p>In facts, it is pretty simple mistake, <strong>Just change<code>TimeValue(\"t\")</code> to <code>TimeValue(t)</code></strong></p>\n\n<hr>\n\n<p><strong>Why is that?</strong></p>\n\n<p>You need to input a time value formatted as text into <code>TimeValue()</code> function, you are getting this value properly into the variable <code>t</code>. </p>\n\n<p>The problem is when you reuse this, because <code>\"t\"</code> is a String only containing the <code>t</code> letter and not the variable <code>t</code>!</p>\n\n<hr>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim i As Integer\nDim Response As Integer\n    t = CStr(Range(\"D3\"))\n    Application.Wait (Now + TimeValue(t))\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 1, "accepted_answer_id": 33387475, "answer_count": 1, "score": 1, "last_activity_date": 1446027431, "creation_date": 1446024520, "last_edit_date": 1446027431, "question_id": 33387306, "link": "https://stackoverflow.com/questions/33387306/adjustable-macro-delay-by-entering-time-in-cell", "title": "Adjustable macro delay (by entering time in cell)", "body": "<p><strong>Anwser: Change Cell format from D3 into Text instead of General or Time</strong></p>\n\n<p>I'm trying to delay a macro by a variable amount of time.</p>\n\n<p>And I'd like to be able to adjust the amount of delay in my excel workbook without having to open a macro.</p>\n\n<p>I tryed the code below but got : </p>\n\n<blockquote>\n  <p>run time error 13 (Type mismatch).</p>\n</blockquote>\n\n<p>Is this solvable?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim i As Integer\nDim Response As Integer\n    t = Range(\"D3\")\n    Application.Wait (Now + TimeValue(\"t\"))\n</code></pre>\n\n<p>-Cell Format: First Tryed Time (0:00:00), then changed it back to general.</p>\n\n<p>-The data in Cell \"D3\" : 0:00:00, 0:00:01, 0:30:00 or higher values.</p>\n\n<ul>\n<li>Error occures @ Application.Wait....ect line</li>\n</ul>\n\n<p>-Time format= General --> t turns out to be something like 0,00000453*E-5 When \"D3\" is 0:00:01</p>\n\n<p>Time format = time --> t turns out to be empty (using the 37:23:23 time format)</p>\n"}, {"tags": ["vba", "excel", "events", "event-handling"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 4, "creation_date": 1446022730, "post_id": 33386460, "comment_id": 54565624, "body": "Declare the <code>Workbook_open</code> handler as <code>Public</code>."}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1446023182, "post_id": 33386460, "comment_id": 54565903, "body": "Many thanks @Gserg! Changing the <code>Workbook_open</code> to <code>Public Sub Workbook_open()</code> and then adding the following button click event works <code>Private Sub Cmd_Refresh_Click()     ThisWorkbook.Workbook_open End Sub</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1446025672, "post_id": 33386460, "comment_id": 54567495, "body": "You can also just use <code>Run</code> without making it public: <code>Application.Run &quot;ThisWorkbook.Workbook_Open&quot;</code>"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1446026191, "post_id": 33386460, "comment_id": 54567857, "body": "Thanks @Rory! This possibly works better than using a <code>Public Sub</code> for the <code>Workbook Open</code> event, as I&#39;ve noticed that the automatic execution of the <code>Workbook Open</code> event is not as reliable when &#39;Public&#39;. Not sure why this should be the case? However, <code>Application.Run&quot;ThisWorkbook.Workbook_Open&quot;</code> appears to work all the time!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1446026670, "post_id": 33386460, "comment_id": 54568184, "body": "It&#39;s probably worth specifying the workbook too, just for safety: <code>Application.Run &quot;&#39;&quot; &amp; thisworkbook.name &amp; &quot;&#39;!ThisWorkbook.Workbook_Open&quot;</code>"}, {"owner": {"reputation": 1402, "user_id": 2223566, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/74716b1ef308b59103a1f2415f84abb1?s=128&d=identicon&r=PG&f=1", "display_name": "rotgers", "link": "https://stackoverflow.com/users/2223566/rotgers"}, "edited": false, "score": 0, "creation_date": 1446031828, "post_id": 33386460, "comment_id": 54571404, "body": "Why not wrap the code in the <code>Workbook_Open</code> function in a sub. Call that sub in the <code>Workbook_Open</code> function and then you can call the sub anywhere."}], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1446024218, "creation_date": 1446022086, "last_edit_date": 1495542217, "question_id": 33386460, "link": "https://stackoverflow.com/questions/33386460/can-i-force-an-excel-workbook-open-event-via-a-button-click", "title": "Can I force an Excel &quot;Workbook_open&quot; event via a button click", "body": "<p>I know there are a number of threads on the topic of the <code>Workbook_open</code> event not always firing. Seems disabling UDFs might work as might digital certificates. </p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/5438548/excel-workbook-open-event-macro-doesnt-always-run\">Excel Workbook Open Event macro doesn&#39;t always run</a></p>\n\n<p>But why would adding a digital certificate help? </p>\n\n<p>As an alternate solution I wondered if there might be a way to force the <code>Workbook_open</code> event to fire via a button click? This way a user could refresh the on screen combo boxes etc when the initial open event fails.</p>\n\n<p>I've tried adding <code>Workbook_open</code> as part of a button click, but get a <code>\"Sub or Function not defined\"</code> error. I suppose this is no great surprise as this event belongs to the \"ThisWorkbook\" object!</p>\n\n<p><code>ThisWorkbook.RefreshAll</code> does not work. </p>\n\n<p>Note: I've added extra coded items to a combo box in the <code>Workbook_open</code> event so I'm expecting these to appear if I can get the refresh to work!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1446022417, "post_id": 33386385, "comment_id": 54565433, "body": "which error do you get?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5497279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-328b8JaGmsY/AAAAAAAAAAI/AAAAAAAAAgw/HITJIjGpD5I/photo.jpg?sz=128", "display_name": "Jun Yi ", "link": "https://stackoverflow.com/users/5497279/jun-yi"}, "edited": false, "score": 0, "creation_date": 1446023119, "post_id": 33386744, "comment_id": 54565869, "body": "Hi newjenn, could you enlighten me ? I am getting most of my variables from my sheet except B1 * 1"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 23, "user_id": 5497279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-328b8JaGmsY/AAAAAAAAAAI/AAAAAAAAAgw/HITJIjGpD5I/photo.jpg?sz=128", "display_name": "Jun Yi ", "link": "https://stackoverflow.com/users/5497279/jun-yi"}, "edited": false, "score": 0, "creation_date": 1446029632, "post_id": 33386744, "comment_id": 54570067, "body": "@JunYi  &#39; If you need to get values from the range(&quot;D1&quot;) Then use the above code"}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1446029721, "last_edit_date": 1446029721, "creation_date": 1446022909, "answer_id": 33386744, "question_id": 33386385, "link": "https://stackoverflow.com/questions/33386385/runtime-error-13-type-mismatch/33386744#33386744", "title": "Runtime Error 13 : Type mismatch", "body": "<p>variables need to get the values from sheet. You are trying opposite way which is why you getting error.</p>\n\n<pre><code>Private Sub Workbook_Open()\nxdate = Worksheets(\"sheet1\").Range(\"A1\")\nlsdate = DateAdd(\"d\", -7, Date)\n'MsgBox lsdate\nIf Day(lsdate) &gt; Day(xdate) Then\nresult = Worksheets(\"sheet1\").Range(\"B1\") * 1\nElse\nresult = Worksheets(\"sheet1\").Range(\"B1\") * 1.07\nEnd If\nRange(\"c1\").Value = result\nEnd Sub\n\n\nSub test1()\n\nDim var1 As Variant\n\n' If you need to get values from the range(\"D1\") Then use the below code\nvar1 = Worksheets(\"sheet1\").Range(\"D1\").Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1446023907, "creation_date": 1446023907, "answer_id": 33387082, "question_id": 33386385, "link": "https://stackoverflow.com/questions/33386385/runtime-error-13-type-mismatch/33387082#33387082", "title": "Runtime Error 13 : Type mismatch", "body": "<p>You seem pretty new at programming, so I'll explain plainly :</p>\n\n<p>When you are trying to assign a <code>value</code> to a <code>variable</code> in almost every language, you use : </p>\n\n<pre><code>variable = value\n</code></pre>\n\n<p>So you can do a lot of operations on the <code>value</code>, which is on the right of the equals <code>=</code>.</p>\n\n<p>BUT you canNOT do operations on the left of the equals <code>=</code> when you simply assigning a <code>value</code> to a <code>variable</code>. You can do almost any operations when you are testing 2 <code>variables</code> but you'll have a keyword like <code>If</code> or <code>While</code> at the start of the line of code.</p>\n\n<hr>\n\n<p>So the issue with your code is that you reversed the order of the <code>value</code> and the <code>variable</code> and tried to do <code>value * 1 = variable</code></p>\n\n<p>Here is your corrected code (I indented it so that it can be read easily) :</p>\n\n<pre><code>Private Sub Workbook_Open()\nxdate = Worksheets(\"sheet1\").Range(\"A1\")\nlsdate = DateAdd(\"d\", -7, Date)\n'MsgBox lsdate\nIf Day(lsdate) &gt; Day(xdate) Then\n   result = Worksheets(\"sheet1\").Range (\"B1\") * 1\nElse\n   result = Worksheets(\"sheet1\").Range (\"B1\") * 1.07\nEnd If\n\nSheets(\"Sheet_name\").Range(\"c1\").Value = result\n\nEnd Sub\n</code></pre>\n\n<p>And you should always reference the sheet you are working with, because previously, your code didn't specify on which sheet the <code>C1</code> was supposed to be.</p>\n\n<p>So here, just change <code>Sheet_name</code> to whatever the name of your sheet is!</p>\n"}], "owner": {"reputation": 23, "user_id": 5497279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-328b8JaGmsY/AAAAAAAAAAI/AAAAAAAAAgw/HITJIjGpD5I/photo.jpg?sz=128", "display_name": "Jun Yi ", "link": "https://stackoverflow.com/users/5497279/jun-yi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1446172273, "creation_date": 1446021847, "last_edit_date": 1446172273, "question_id": 33386385, "link": "https://stackoverflow.com/questions/33386385/runtime-error-13-type-mismatch", "title": "Runtime Error 13 : Type mismatch", "body": "<p>This is my first time coding from scratch and a very dumb question indeed. </p>\n\n<p>Why do i keep getting this error?</p>\n\n<blockquote>\n  <p>Runtime Error '13' : Type mismatch </p>\n</blockquote>\n\n<p>My value in B1 is an integer </p>\n\n<pre><code>Private Sub Workbook_Open()\nxdate = Worksheets(\"sheet1\").Range(\"A1\")\nlsdate = DateAdd(\"d\", -7, Date)\n'MsgBox lsdate\nIf Day(lsdate) &gt; Day(xdate) Then\n    Worksheets(\"sheet1\").Range (\"B1\") * 1 = result\nElse\n    Worksheets(\"sheet1\").Range (\"B1\") * 1.07 = result\nEnd If\nRange(\"c1\").Value = result\nEnd Sub\n</code></pre>\n\n<p>I have further edit my code to the following but not able to get the condition to work</p>\n\n<pre><code>'To create the following condition\n'If less than 7 days interest = 0%\n'if 8 to 30 days interest = 7%\n'if more than 31 days interest = 9%\n\nSub Workbook_Open()\n\nFor i = 1 To 3 'Rows.Count\nxdate = Cells(i, 1)\n'MsgBox Cells(i, 1)\nnulldate = DateAdd(\"d\", -7, Date)\nirate7late = DateAdd(\"d\", -8, Date)\nirate7early = DateAdd(\"d\", -30, Date)\n\n\nIf Day(nulldate) &lt; Day(xdate) Then\n    result = Cells(i, 2) * 1\nElseIf Day(irate7early) &lt;= Day(xdate) And Day(xdate) &lt;= Day(irate7late) Then\n            '30/9/2015      20/10/2015      20/10/2015      22/10/2015\n    result = Cells(i, 2) * 1.07\n\nElseIf Day(irate7early) &gt; Day(xdate) Then\n    result = Cells(i, 2) * 1.09\nEnd If\n\nCells(i, 3).Value = result\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint", "filepicker"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1446022846, "post_id": 33386371, "comment_id": 54565695, "body": "Please join your code, that will be easier for us to help you. you might be able to store both the folder <code>fd</code> and the <code>SelectItems</code> in variables and if you have a lot of them, store them into an array (1 column for the folder path (as string) and 1 for the selected items) that you&#39;ll process when the array is filled!"}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1446022898, "creation_date": 1446022898, "answer_id": 33386739, "question_id": 33386371, "link": "https://stackoverflow.com/questions/33386371/vba-way-to-select-files-and-then-destination-folder/33386739#33386739", "title": "VBA way to select files and then destination folder", "body": "<p>Just save the SelectedItems list returned by fd.</p>\n\n<pre><code>Sub test()\n    Dim fd As FileDialog, destFolder As FileDialog\n    Dim s As FileDialogSelectedItems\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n    fd.AllowMultiSelect = True\n    fd.Show\n    Set s = fd.SelectedItems ' s will be kept after next line\n    Set destFolder = Application.FileDialog(msoFileDialogFolderPicker)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 58, "user_id": 4452902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69f368fa321df15a31c8e4db50fc75a?s=128&d=identicon&r=PG&f=1", "display_name": "marcelo13k", "link": "https://stackoverflow.com/users/4452902/marcelo13k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 33386739, "answer_count": 1, "score": 1, "last_activity_date": 1446022898, "creation_date": 1446021785, "question_id": 33386371, "link": "https://stackoverflow.com/questions/33386371/vba-way-to-select-files-and-then-destination-folder", "title": "VBA way to select files and then destination folder", "body": "<p>I am trying to select a bunch of files, using:</p>\n\n<pre><code>Set fd = Application.FileDialog(msoFileDialogFilePicker)\n</code></pre>\n\n<p>and then I have to process each one of the selected files (I allow multiple selection) and write it back into a destination directory.\nMy problen is that when I use:</p>\n\n<pre><code>Set destFolder = Application.FileDialog(msoFileDialogFolderPicker)\n</code></pre>\n\n<p>to pick the destination folder, <code>fd</code> gets overwritten, because the Application object only can instantiate a single <code>FileDialog</code> object. And then I loose the <code>SelectedItems</code> list from <code>fd</code>.</p>\n\n<p>How should I do it so I can keep the list for iteration?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1446025444, "post_id": 33386258, "comment_id": 54567366, "body": "I&#39;m not sure what you are trying to accomplish here... Because your code seems to do what you are trying to do... Could you be a bit more clearer on your expectations and issues?"}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": false, "score": 0, "last_activity_date": 1448884357, "creation_date": 1448884357, "answer_id": 33998021, "question_id": 33386258, "link": "https://stackoverflow.com/questions/33386258/vb-code-import-userform-data-to-excel-sheet/33998021#33998021", "title": "VB code : Import userform data to excel sheet", "body": "<p>Try This:</p>\n\n<pre><code>Private Sub Addstock_Click()\n\nDim lRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Inventory\")\nlRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\nSearchDirection:=xlPrevious, LookIn:=xlValues)\n\nWith ws\n .Cells(lRow.Row + 1, 1).Value = Me.ordernumber.Value\n '.Cells(lRow.Row + 1, 2).Value = Me.TextBox5.Value\n .Cells(lRow.Row + 1, 3).Value = Me.supplier.Value\n .Cells(lRow.Row + 1, 4).Value = Me.productname.Value\n .Cells(lRow.Row + 1, 5).Value = Me.stockavai.Value\n .Cells(lRow.Row + 1, 6).Value = Me.qty.Value\n .Cells(lRow.Row + 1, 7).Value = Me.newstock.Value\n .Cells(lRow.Row + 1, 8).Value = Me.unit.Value\n .Cells(lRow.Row + 1, 9).Value = Me.amount.Value\n End With\n\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 3689699, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/de801467c40de66ac25d864171f8d444?s=128&d=identicon&r=PG&f=1", "display_name": "user36896989", "link": "https://stackoverflow.com/users/3689699/user36896989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3496, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1448884357, "creation_date": 1446021423, "last_edit_date": 1446021801, "question_id": 33386258, "link": "https://stackoverflow.com/questions/33386258/vb-code-import-userform-data-to-excel-sheet", "title": "VB code : Import userform data to excel sheet", "body": "<p>I wish to populate a vb code that can allow me to do the following function:</p>\n\n<p>Below is my userform:</p>\n\n<p>Condition 1: \n<a href=\"https://i.stack.imgur.com/0H4Bf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0H4Bf.png\" alt=\"enter image description here\"></a></p>\n\n<p>After I click the Add Stock button, it will upload the data I fill in the data sheet named as Inventory (A4:A6)</p>\n\n<p>Red color will be auto generate once the product and the stock in field being filled.</p>\n\n<p>For the stock available will be able to search through the whole data sheet in Inventory to sum up all the stock which is being added or the last amount of the stock available.</p>\n\n<p>If inside Inventory sheet does not contain the product ( new product), it will auto show 0 or blank to the stock available field in userform.</p>\n\n<p>Condition 2:\n<a href=\"https://i.stack.imgur.com/pfVN1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pfVN1.png\" alt=\"enter image description here\"></a></p>\n\n<p>After I click the Add Stock button, it will upload the data I fill in the data sheet named as Inventory (A7)</p>\n\n<p>The Inventory sheet should look like this after I submit click the Add Stock button:\n<a href=\"https://i.stack.imgur.com/DnCwZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DnCwZ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have no idea on this method on how to import the data to my Inventory sheet.</p>\n\n<p>Thanks or the help in advanced</p>\n\n<p>My code will be like this:</p>\n\n<pre><code>Private Sub Addstock_Click()\n\nDim lRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Inventory\")\nlRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\nSearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\nWith ws\n .Cells(lRow, 1).Value = Me.ordernumber.Value\n '.Cells(lRow, 2).Value = Me.TextBox5.Value\n.Cells(lRow, 3).Value = Me.supplier.Value\n.Cells(lRow, 4).Value = Me.productname.Value\n.Cells(lRow, 5).Value = Me.stockavai.Value\n .Cells(lRow, 6).Value = Me.qty.Value\n .Cells(lRow, 7).Value = Me.newstock.Value\n  .Cells(lRow, 8).Value = Me.unit.Value\n  .Cells(lRow, 9).Value = Me.amount.Value\n End With\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5495104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1195297980499867/picture?type=large", "display_name": "Max Wesener", "link": "https://stackoverflow.com/users/5495104/max-wesener"}, "edited": false, "score": 0, "creation_date": 1446028872, "post_id": 33386962, "comment_id": 54569574, "body": "This one worked for hidding the column, I will need to hide the row."}, {"owner": {"reputation": 3, "user_id": 5493254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ec51471b8eaea5a8d5b2e558277d735?s=128&d=identicon&r=PG&f=1", "display_name": "Ishwarya", "link": "https://stackoverflow.com/users/5493254/ishwarya"}, "reply_to_user": {"reputation": 15, "user_id": 5495104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1195297980499867/picture?type=large", "display_name": "Max Wesener", "link": "https://stackoverflow.com/users/5495104/max-wesener"}, "edited": false, "score": 0, "creation_date": 1446036322, "post_id": 33386962, "comment_id": 54574209, "body": "Just replace &quot;Columns&quot; with &quot;Row&quot; in the code and replace B:B with row number (eg: 2:2,)"}], "tags": [], "owner": {"reputation": 3, "user_id": 5493254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ec51471b8eaea5a8d5b2e558277d735?s=128&d=identicon&r=PG&f=1", "display_name": "Ishwarya", "link": "https://stackoverflow.com/users/5493254/ishwarya"}, "is_accepted": false, "score": 0, "last_activity_date": 1446023580, "creation_date": 1446023580, "answer_id": 33386962, "question_id": 33386210, "link": "https://stackoverflow.com/questions/33386210/excel-vba-display-next-cell-if-previous-cell-includes-text/33386962#33386962", "title": "Excel VBA - Display next cell if previous cell includes text", "body": "<p>I tried this code. Worked for me. Please give it a try</p>\n\n<pre><code>Sub Macro1()\n\n    If Range(\"A1\").Value = vbNullString Then\n        Columns(\"B:B\").EntireColumn.Hidden = True\n    ElseIf Not IsEmpty(Range(\"A1\").Value) Then\n        Columns(\"B:B\").EntireColumn.Hidden = False\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5495104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1195297980499867/picture?type=large", "display_name": "Max Wesener", "link": "https://stackoverflow.com/users/5495104/max-wesener"}, "edited": false, "score": 0, "creation_date": 1446029100, "post_id": 33387226, "comment_id": 54569707, "body": "For some reason, I had an endless loop with your code. Problem is solved, though. Thanks!"}, {"owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "reply_to_user": {"reputation": 15, "user_id": 5495104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1195297980499867/picture?type=large", "display_name": "Max Wesener", "link": "https://stackoverflow.com/users/5495104/max-wesener"}, "edited": false, "score": 0, "creation_date": 1446029327, "post_id": 33387226, "comment_id": 54569862, "body": "Are you sure it has an endless loop, for me it simply takes a long time since it is done for 65536/2 rows."}, {"owner": {"reputation": 15, "user_id": 5495104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1195297980499867/picture?type=large", "display_name": "Max Wesener", "link": "https://stackoverflow.com/users/5495104/max-wesener"}, "edited": false, "score": 0, "creation_date": 1446034058, "post_id": 33387226, "comment_id": 54572792, "body": "After I have clicked the button, it took a minute and crashed my application. I had to restart the whole thing. Could be an issue with my Excel version. (2010)"}], "tags": [], "owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "is_accepted": false, "score": 0, "last_activity_date": 1446024303, "creation_date": 1446024303, "answer_id": 33387226, "question_id": 33386210, "link": "https://stackoverflow.com/questions/33386210/excel-vba-display-next-cell-if-previous-cell-includes-text/33387226#33387226", "title": "Excel VBA - Display next cell if previous cell includes text", "body": "<p>The <code>Hidden</code> property seems to work. I've changed the function a bit such that it sets the next row (<em>i+1</em>) visible based on row <em>i</em>. It now only checks each 2nd row, otherwise you could hide all rows (if there were nothing), and you would not be able to set any \"text\" such that the next row is unhidden:</p>\n\n<pre><code>Sub showRows_Klicken()\n'loop all rows\nFor i = 1 To 65536 Step 2\n    'check if has string \"text\" and set hidden\n    If LCase(Cells(i, 1)) = \"text\" Then\n        Range(Cells(i + 1, 1), Cells(i + 1, 1)).EntireRow.Hidden = False\n    Else\n        Range(Cells(i + 1, 1), Cells(i + 1, 1)).EntireRow.Hidden = True\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 5495104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1195297980499867/picture?type=large", "display_name": "Max Wesener", "link": "https://stackoverflow.com/users/5495104/max-wesener"}, "is_accepted": false, "score": 0, "last_activity_date": 1446028983, "creation_date": 1446028983, "answer_id": 33388909, "question_id": 33386210, "link": "https://stackoverflow.com/questions/33386210/excel-vba-display-next-cell-if-previous-cell-includes-text/33388909#33388909", "title": "Excel VBA - Display next cell if previous cell includes text", "body": "<p>Thanks for your help, I changed the code a bit and now it works for me:</p>\n\n<pre><code>         Sub Schaltfl\u00e4che259_Klicken()\n            If Range(\"A1\").Value = vbNullString Then\n                Rows(\"2\").EntireRow.Hidden = True\n            ElseIf Not IsEmpty(Range(\"A1\").Value) Then\n                Rows(\"2\").EntireRow.Hidden = False\n            End If\n\n         End Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5495104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1195297980499867/picture?type=large", "display_name": "Max Wesener", "link": "https://stackoverflow.com/users/5495104/max-wesener"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1446028983, "creation_date": 1446021256, "question_id": 33386210, "link": "https://stackoverflow.com/questions/33386210/excel-vba-display-next-cell-if-previous-cell-includes-text", "title": "Excel VBA - Display next cell if previous cell includes text", "body": "<p>I am not a Genius in Excel VBA, so here is my question:</p>\n\n<p>I have an Excel Sheet which has hidden rows. </p>\n\n<p>For example: As long as cell A1 is empty keep the row(A2) hidden. When A1 includes text show the next row (A2). </p>\n\n<p>My Approach was the following:</p>\n\n<pre><code>    Sub showRows_Klicken()\n\n    Dim rng As Range\n\n        For Each rng In Range(Cells(1, 1), Cells(65536, 1).End(xlUp))       \n              If LCase(rng) = \"text\"    \n                  Then                                            \n                        rng.EntireRow.Hidden = False\n              Else\n\n              End If\n        Next rng\n\n     End Sub\n</code></pre>\n\n<p>I hope somebody can help me out here.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "selection", "copy-paste"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1446020681, "post_id": 33386015, "comment_id": 54564514, "body": "Must be a typo, but there is a &quot; missing at the end of the  <code>.SaveAs ... </code> line."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1446021043, "post_id": 33386015, "comment_id": 54564685, "body": "And you don&#39;t <code>rng.Select</code> inside the RangeSelectionPrompt, so the call does nothing useful."}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1446022018, "creation_date": 1446022018, "answer_id": 33386436, "question_id": 33386015, "link": "https://stackoverflow.com/questions/33386015/copy-paste-selection-from-one-workbook-to-another/33386436#33386436", "title": "Copy-paste selection from one workbook to another", "body": "<p>Do you need global variables? It is unlikely, move them inside the Sub. You didn't concatenate the filename rightly for the .SaveAs, and you did not copy what you was expecting to...\nHere is my code, ther is still some control of errors missing.</p>\n\n<pre><code>    Sub transferit()\n\n        Dim wbI As Workbook, wbO As Workbook, wsI As Worksheet, wsO As Worksheet\n        Dim wbName As String\n        wbName = InputBox(\"Enter name\", \"name\")\n\n        '~~&gt; Source/Input Workbook\n        Set wbI = ThisWorkbook\n        '~~&gt; Set the relevant sheet from where you want to copy\n        Set wsI = wbI.Sheets(\"Sheet1\")\n\n        '~~&gt; Destination/Output Workbook\n        Set wbO = Workbooks.Add\n        '~~&gt; Set the relevant sheet to where you want to paste\n        Set wsO = wbO.Sheets(\"Sheet1\")\n\n        With wbO\n            '~~&gt;. Save the file\n            .SaveAs Filename:=\"D:\\Documents\\Output\\\" &amp; wbName\n        End With\n\n        RangeSelectionPrompt.Copy\n\n        With wsO\n            '~~&gt; Paste it in say Cell A1. Change as applicable\n            .Range(\"A1\").PasteSpecial xlPasteValues\n        End With\n    End Sub\n\n    Function RangeSelectionPrompt() As Range\n        Set RangeSelectionPrompt = Application.InputBox(\"Select a range\", \"Obtain Range Object\", Type:=8)\n    End Function\n\n\n    RangeSelectionPrompt.Copy\n\n    With wsO\n        '~~&gt; Paste it in say Cell A1. Change as applicable\n        .Range(\"A1\").PasteSpecial xlPasteValues\n    End With\nEnd Sub\n\nFunction RangeSelectionPrompt() As Range\n    Set RangeSelectionPrompt = Application.InputBox(\"Select a range\", \"Obtain Range Object\", Type:=8)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4956683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85ec56c42219436ec2e006d95b1d5e2d?s=128&d=identicon&r=PG&f=1", "display_name": "013_", "link": "https://stackoverflow.com/users/4956683/013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446022018, "creation_date": 1446020514, "last_edit_date": 1446020592, "question_id": 33386015, "link": "https://stackoverflow.com/questions/33386015/copy-paste-selection-from-one-workbook-to-another", "title": "Copy-paste selection from one workbook to another", "body": "<p>I am trying to automate a process that involves copy pasting data from one workbook to a new workbook. I've been able to put together the code shows below from snippets found in the forums here, and other places. However, I am receiving a \"Runtime error 1004\" when attempting to run the procedure. Any suggestions?</p>\n\n<pre><code>Option Explicit\nDim wbI As Workbook, wbO As Workbook, wsI As Worksheet, wsO As Worksheet\nDim wbName As String\nSub transferit()\n\nwbName = InputBox(\"Enter name\", \"name\")\n\n'~~&gt; Source/Input Workbook\nSet wbI = ThisWorkbook\n'~~&gt; Set the relevant sheet from where you want to copy\nSet wsI = wbI.Sheets(\"Sheet1\")\n\n'~~&gt; Destination/Output Workbook\nSet wbO = Workbooks.Add\n'~~&gt; Set the relevant sheet to where you want to paste\nSet wsO = wbO.Sheets(\"Sheet1\")\n\nWith wbO\n    '~~&gt;. Save the file\n    .SaveAs Filename:=\"D:\\Documents\\Output\\wbName\nEnd With\n\nWith wsI\n   Call RangeSelectionPrompt\n   Selection.Copy\nEnd With\n\nWith wsO\n    '~~&gt; Paste it in say Cell A1. Change as applicable\n    .Range(\"A1\").PasteSpecial xlPasteValues\nEnd With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub RangeSelectionPrompt()\n    Dim rng As Range\n    Set rng = Application.InputBox(\"Select a range\", \"Obtain Range Object\", Type:=8)\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba"], "comments": [{"owner": {"reputation": 1343, "user_id": 5416019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GEe99.png?s=128&g=1", "display_name": "jhmt", "link": "https://stackoverflow.com/users/5416019/jhmt"}, "edited": false, "score": 0, "creation_date": 1446023077, "post_id": 33385874, "comment_id": 54565843, "body": "Are you allowed to replace DLLs with Excel add-in?"}, {"owner": {"reputation": 930, "user_id": 1158379, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d0d3a91339f11ef77e5edc7fef051585?s=128&d=identicon&r=PG", "display_name": "udaya726", "link": "https://stackoverflow.com/users/1158379/udaya726"}, "reply_to_user": {"reputation": 1343, "user_id": 5416019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GEe99.png?s=128&g=1", "display_name": "jhmt", "link": "https://stackoverflow.com/users/5416019/jhmt"}, "edited": false, "score": 0, "creation_date": 1446176846, "post_id": 33385874, "comment_id": 54645392, "body": "Hi I am not allowed to replace it with an add-in"}, {"owner": {"reputation": 1343, "user_id": 5416019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GEe99.png?s=128&g=1", "display_name": "jhmt", "link": "https://stackoverflow.com/users/5416019/jhmt"}, "edited": false, "score": 0, "creation_date": 1446193368, "post_id": 33385874, "comment_id": 54651201, "body": "Unfortunately, I have no idea to embed C# library to an Excel book other than add-ins."}], "answers": [{"tags": [], "owner": {"reputation": 154, "user_id": 2835725, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db358a650daf5a9b67372b428017f838?s=128&d=identicon&r=PG&f=1", "display_name": "user2835725", "link": "https://stackoverflow.com/users/2835725/user2835725"}, "is_accepted": false, "score": 1, "last_activity_date": 1446021933, "creation_date": 1446021933, "answer_id": 33386414, "question_id": 33385874, "link": "https://stackoverflow.com/questions/33385874/embed-external-dll-to-excel-workbook/33386414#33386414", "title": "embed external dll to excel workbook", "body": "<p>there is no good way (as far as I am aware) to accomplish this. apparently there are some way to hack it in, but it wont work on any protected systems (for good reasons). just zip the files together and distribute them together.</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 7507208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CWODdquYWjk/AAAAAAAAAAI/AAAAAAAAAoE/AWJOhtQ1ygg/photo.jpg?sz=128", "display_name": "Gregg Burns", "link": "https://stackoverflow.com/users/7507208/gregg-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1592956773, "last_edit_date": 1592956773, "creation_date": 1592956100, "answer_id": 62545460, "question_id": 33385874, "link": "https://stackoverflow.com/questions/33385874/embed-external-dll-to-excel-workbook/62545460#62545460", "title": "embed external dll to excel workbook", "body": "<p>There is a good way. (BTW, you could also embed a zip file and unzip file for user as a final step)</p>\n<p>In the Ribbon. Insert -&gt; Object-&gt; Create from File</p>\n<p>Now you have an embedded .dll within a worksheet. Next you need to extract the OLEObject file to your temp directory. This blog captures it well: <a href=\"https://danny.fyi/embedding-and-accessing-a-file-in-excel-with-vba-and-ole-objects-4d4e7863cfff\" rel=\"nofollow noreferrer\">https://danny.fyi/embedding-and-accessing-a-file-in-excel-with-vba-and-ole-objects-4d4e7863cfff</a></p>\n<p>Next copy .dll from the temp to the directory you want to store the dll on the users machine. You'll see the GetOLETempPath() function in the blog.</p>\n<pre><code>Set obj = Sheets(&quot;Content&quot;).OLEObjects(&quot;stdCallObj&quot;)\nfilesource = GetOLETempPath(obj)\nFileCopy filesource , &quot;C:\\somefolder\\myNewDLL.dll&quot;\n</code></pre>\n<p>Finally you load library</p>\n<pre><code>Private Declare Function LoadLibrary Lib &quot;kernel32&quot; Alias &quot;LoadLibraryA&quot; (ByVal lpLibFileName As String) As Long\nLoadLibrary(&quot;C:\\somefolder\\myNewDLL.dll&quot;)\n</code></pre>\n"}], "owner": {"reputation": 930, "user_id": 1158379, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d0d3a91339f11ef77e5edc7fef051585?s=128&d=identicon&r=PG", "display_name": "udaya726", "link": "https://stackoverflow.com/users/1158379/udaya726"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1593698604, "creation_date": 1446019933, "last_edit_date": 1593698604, "question_id": 33385874, "link": "https://stackoverflow.com/questions/33385874/embed-external-dll-to-excel-workbook", "title": "embed external dll to excel workbook", "body": "<p>I am going to execute C# dll through excel VBA . The file is macro enabled file(.xslm)\nI have to circulate this excel with several users. Is there a way embed an external dll with the excel file </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1446020031, "post_id": 33385802, "comment_id": 54564236, "body": "It is usually a good idea to not use <code>Select</code> and <code>Selection</code>. Try <code>Range(&quot;C&quot; &amp; Rows.Count).End(x1Up).Rows.Copy</code>. Same for the Paste operation."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1446020319, "post_id": 33385901, "comment_id": 54564360, "body": "btw, don&#39;t forget to turn off <code>application.enableevents</code> before changing values in the worksheet. Remember to turn them back on again before you exit the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow noreferrer\">Worksheet_Change</a> event macro."}, {"owner": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "edited": false, "score": 0, "creation_date": 1446020623, "post_id": 33385901, "comment_id": 54564490, "body": "what&#39;s the rationale behind turning off application.enableevents? just curious"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "edited": false, "score": 0, "creation_date": 1446020870, "post_id": 33385901, "comment_id": 54564610, "body": "If you don&#39;t and add/modify/delete a cell value in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow noreferrer\">Worksheet_Change</a> event macro, it will trigger another event and try to run on top of itself."}, {"owner": {"reputation": 2306, "user_id": 5352608, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/63b08108d058968f69c62bd3dad118c9?s=128&d=identicon&r=PG&f=1", "display_name": "Stanley", "link": "https://stackoverflow.com/users/5352608/stanley"}, "edited": false, "score": 0, "creation_date": 1446021098, "post_id": 33385901, "comment_id": 54564716, "body": "I see... ok thanks for the information!"}, {"owner": {"reputation": 1, "user_id": 5497082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdcaadc84759a72b6ad2ec930a8583d1?s=128&d=identicon&r=PG&f=1", "display_name": "osullb01", "link": "https://stackoverflow.com/users/5497082/osullb01"}, "edited": false, "score": 0, "creation_date": 1446080649, "post_id": 33385901, "comment_id": 54600010, "body": "Thanks for the response, but it doesn&#39;t seem to keep running automatically - ie when I add a new client&#39;s details in the next row, I want the row below to automatically become formatted like the one above?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1446081420, "post_id": 33385901, "comment_id": 54600220, "body": "I did not address that point because there are a myriad of problems involved that your original code did not address. You never isolated the event code to column C. You never isolated the event code to the next unused row in column C. What happens if a value is changed somewhere on the worksheet? The code you provided is incomplete. You&#39;ve snipped out portions that were important. I cannot address the issue as a whole unless I can see everything without guessing."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1446020075, "creation_date": 1446020075, "answer_id": 33385901, "question_id": 33385802, "link": "https://stackoverflow.com/questions/33385802/vba-that-will-copy-and-paste-last-record-into-first-blank-row/33385901#33385901", "title": "VBA that will copy and paste last record into first blank row", "body": "<p>If you use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838404.aspx\" rel=\"nofollow\">Range.FillDown method</a> and then clear the cell contents (<a href=\"https://msdn.microsoft.com/en-us/library/office/aa223828%28v=office.11%29.aspx\" rel=\"nofollow\">Range.ClearContents method</a>) on the new row you should be left with the cell formats and data validation.</p>\n\n<pre><code>with Range(\"C\" &amp; Rows.Count).End(xlUp).resize(2, 1).entirerow\n    .filldown\n    with .offset(1, 0)\n        .clearcontents\n    end with\nend with\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5497082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdcaadc84759a72b6ad2ec930a8583d1?s=128&d=identicon&r=PG&f=1", "display_name": "osullb01", "link": "https://stackoverflow.com/users/5497082/osullb01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1240, "favorite_count": 0, "closed_date": 1458575274, "answer_count": 1, "score": 0, "last_activity_date": 1446022898, "creation_date": 1446019594, "last_edit_date": 1446022898, "question_id": 33385802, "link": "https://stackoverflow.com/questions/33385802/vba-that-will-copy-and-paste-last-record-into-first-blank-row", "closed_reason": "Duplicate", "title": "VBA that will copy and paste last record into first blank row", "body": "<p>I am new to VBA, so my query is probably (hopefully) a straightforward one! </p>\n\n<p>I have a large database of client details, and want to write a macro for the worksheet that will find the last non-blank row, copy the row, and paste the 'format' and 'validation' into the first blank row. I want the macro to automatically run all the time (so the first blank row will always have the formats etc applied the same as the row above, even when more clients are added).</p>\n\n<p>So far I have written this, and when I press Run Sub it works the first time, however if I add details in the last blank row I get an error. When I try debug it highlights the row after 'Copy last row:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    'Copy last row\n\n        Range(\"C\" &amp; Rows.Count).End(x1Up).Rows.Select\n        Selection.Copy\n\n    'Paste format and validation into next blank row\n\n        Range(\"C\" &amp; Rows.Count).End(x1Up).Offset(1).Rows.Select\n            Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n            SkipBlanks:=False, Transpose:=False\n            Selection.PasteSpecial Paste:=xlPasteValidation, Operation:=xlNone, _\n            SkipBlanks:=False, Transpose:=False\n            Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>Also, I am running the code based on column \"C\" because that is a required field, so will never be blank for any of the records.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1000, "user_id": 900564, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UoHjG.jpg?s=128&g=1", "display_name": "Micha\u0142 Szkudlarek", "link": "https://stackoverflow.com/users/900564/micha%c5%82-szkudlarek"}, "edited": false, "score": 0, "creation_date": 1446019844, "post_id": 33385756, "comment_id": 54564156, "body": "Welcome on SO. This question not realated to programming at all, please have a look at <a href=\"http://stackoverflow.com/help/asking\">stackoverflow.com/help/asking</a>"}, {"owner": {"reputation": 11, "user_id": 5497076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af38f54cd3d3013bc4efbe31256bc778?s=128&d=identicon&r=PG&f=1", "display_name": "user5497076", "link": "https://stackoverflow.com/users/5497076/user5497076"}, "reply_to_user": {"reputation": 1000, "user_id": 900564, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UoHjG.jpg?s=128&g=1", "display_name": "Micha\u0142 Szkudlarek", "link": "https://stackoverflow.com/users/900564/micha%c5%82-szkudlarek"}, "edited": false, "score": 0, "creation_date": 1446020257, "post_id": 33385756, "comment_id": 54564336, "body": "I think the problem could lie in the VBA-code, so that must be a programming question. I might rephrase the question a bit though."}, {"owner": {"reputation": 1000, "user_id": 900564, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UoHjG.jpg?s=128&g=1", "display_name": "Micha\u0142 Szkudlarek", "link": "https://stackoverflow.com/users/900564/micha%c5%82-szkudlarek"}, "edited": false, "score": 2, "creation_date": 1446020338, "post_id": 33385756, "comment_id": 54564369, "body": "If you think it is realted with VBA code, please post it."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5497076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af38f54cd3d3013bc4efbe31256bc778?s=128&d=identicon&r=PG&f=1", "display_name": "user5497076", "link": "https://stackoverflow.com/users/5497076/user5497076"}, "edited": false, "score": 0, "creation_date": 1446041817, "post_id": 33392722, "comment_id": 54578258, "body": "Hi and thanks for the answer. But I can&#39;t follow you. I have a BeforeClose macro. But what do I do after I have breaked the execution? Actually some of my observations have been, that when I click the big red &quot;X&quot;, the BeforeClose does NOT execute. Really strange"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 11, "user_id": 5497076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af38f54cd3d3013bc4efbe31256bc778?s=128&d=identicon&r=PG&f=1", "display_name": "user5497076", "link": "https://stackoverflow.com/users/5497076/user5497076"}, "edited": false, "score": 1, "creation_date": 1446043709, "post_id": 33392722, "comment_id": 54579717, "body": "@user5497076  You may have some add-ins or other procedures which are monitoring application-level events and interfering with &quot;normal&quot; use.."}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 1, "last_activity_date": 1446040440, "last_edit_date": 1446040440, "creation_date": 1446039853, "answer_id": 33392722, "question_id": 33385756, "link": "https://stackoverflow.com/questions/33385756/excel-workbook-wont-close/33392722#33392722", "title": "Excel workbook won&#39;t close", "body": "<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nCancel = True\nEnd Sub\n</code></pre>\n\n<p>Is an example of a code that would produce the issue you're having.<br>\nTo solve the \"issue\" open the VBE (Alt+F11) and <code>Break</code> the execution (pause button).<br>\nI personally think the <code>Cancel</code> declaration is linked to a status of the workbook, make sure you have done what you were supposed to do with the workbook.</p>\n"}], "owner": {"reputation": 11, "user_id": 5497076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af38f54cd3d3013bc4efbe31256bc778?s=128&d=identicon&r=PG&f=1", "display_name": "user5497076", "link": "https://stackoverflow.com/users/5497076/user5497076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1432, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446040440, "creation_date": 1446019402, "last_edit_date": 1446035416, "question_id": 33385756, "link": "https://stackoverflow.com/questions/33385756/excel-workbook-wont-close", "title": "Excel workbook won&#39;t close", "body": "<p><strong>I have an Excel workbook which I have problems closing properly.</strong></p>\n\n<p>Only if I press the little \"x\", it closes the Excel workbook, but not the Excel application. When I press the big red \"X\", the Excel application closes. So this works...</p>\n\n<p>BUT...\nif I start by pressing the big red \"X\", nothing happens except that all the ribbon tools is greyed out, and so is everything in the menu under the Office-circle in the top left corner of the application.\nI can close the workbook by pressing the little \"x\", but I'm still not able to close the Excel application, and I have to \"kill\" it in the Windows Task Manager.</p>\n\n<h2>A few observations:</h2>\n\n<p>If I, before I open the Excel workbook, open an existing Excel workbook, and then opens the specific workbook, it can be closed properly pressing the big red \"X\" (only when the existing workbook is still open).</p>\n\n<p>The problem ONLY exists for this specific workbook, so I must have made something which cause the problem.\nThe workbook has VBA code, which could be the problem.</p>\n\n<p>The problem is that I have many users using this workbook, and would like to have it work without these problems.</p>\n\n<p>I really hope someone can help...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1446018189, "post_id": 33385351, "comment_id": 54563425, "body": "I also tried a variation where I passed CL1_W_F as a range to the function:  <code>Function Capacity_Factor_Fetch2(Da_Range as Range) As Long</code>.  However when I did this I could no longer step through the code and ultimately it did not work."}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1446026017, "post_id": 33386565, "comment_id": 54567730, "body": "You could also use <code>Worksheet_Calculate</code> since the inputs are formulas."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1446027243, "post_id": 33386565, "comment_id": 54568523, "body": "@Rory: Thanks for the hint. That will be the best approach."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1446043979, "post_id": 33386565, "comment_id": 54579915, "body": "2 questions:  1) Does UDF stand for USER DEFINED FUNCTION?  I have seen it more than a few times and I have been guessing at its definition.  2)  In the last block of code for Worksheet_Calculate you have Me.range and Me.Shapes.  Is Me fine as is or is there also supposed to be a <code>dim me as worksheet</code> and `set Me = sheets(&quot;POSTING&quot;).  Thanks for the informative and detailed response.  CL1_W_F is populated with formulas so no user entry is occurring there.  As an option I could go further up the food chain and monitor every single data entry point over 5 worksheets but that seemed cumbersome."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1446045409, "post_id": 33386565, "comment_id": 54581009, "body": "See my supplement. So the last approach should work for you."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1446047985, "post_id": 33386565, "comment_id": 54582960, "body": "it works...as an unintended side effect, I can no longer perform an undo.  I will have to do some more testing to see if it is actually due to the code implementation."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1446048955, "post_id": 33386565, "comment_id": 54583683, "body": "Further testing shows my workbook had been corrupted somehow and that after restarting excel I can now undo again."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1446050391, "post_id": 33386565, "comment_id": 54584759, "body": "Yes, <code>Private Sub Worksheet_Calculate()</code> clears the undo chain. If this is not acceptable for you, you must use the UDF approach."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 1, "last_activity_date": 1446045624, "last_edit_date": 1446045624, "creation_date": 1446022378, "answer_id": 33386565, "question_id": 33385351, "link": "https://stackoverflow.com/questions/33385351/function-placement-shape-error-and-executing-code-when-a-formula-changes-a-cel/33386565#33386565", "title": "Function placement, Shape Error, and Executing code when a formula changes a cell Value", "body": "<p>A UDF (User Defined Function) should only return a value. It should not do anything else. Especially it can't changing cell values in the same manner a <code>Sub</code> will can. The error will disappear if you would use fully qualified references for the shapes <code>Sheets(\"POSTING\").Shapes(\"Single Truck Load\")</code> but then the next error will appear, that is the kind of circular reference since you trying to to get the value from <code>J30</code> which is the cell in which the formula resides which calls the function.</p>\n\n<p>You could have a <code>Private Sub Worksheet_Change</code> in the sheet \"Analysis\" which will react if something in the named range <code>CL1_W_F</code> has changed.</p>\n\n<p>Like so:</p>\n\n<p>Code in the worksheet class module \"Analysis\":</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n Application.EnableEvents = False\n On Error GoTo mEnd\n If Not Intersect(Target, Me.Range(\"CL1_W_F\")) Is Nothing Then\n\n  Status = False\n\n  If Sheets(\"POSTING\").Range(\"J30\").Value &lt; 1 And Sheets(\"POSTING\").Range(\"J30\").Value &gt;= 0.3 Then\n    Status = True\n  End If\n\n  Sheets(\"POSTING\").Shapes(\"Single Truck Load\").Visible = Status\n\n End If\nmEnd:\n Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>This approach will only work if the values in in the named range <code>CL1_W_F</code> are changed directly since the <code>Private Sub Worksheet_Change</code> is not involved if the values change because of changes on other cells. If the values in in the named range <code>CL1_W_F</code> are changed directly, it will be the best approach in my opinion.</p>\n\n<p>With the following code your approach will also work but only as a volatile function. This is not my recommendation but will be necessary  if the values in in the named range <code>CL1_W_F</code> are not changed directly.</p>\n\n<p>The code in a <code>Module</code> and used as Formula <code>=Capacity_Factor_Fetch2()</code></p>\n\n<pre><code>Public Function Capacity_Factor_Fetch2() As Double\n\n Application.Volatile\n Dim Status As Boolean\n Dim Da_Range As Range\n Dim dMin As Double\n\n Set Da_Range = Sheets(\"Analysis\").Range(\"CL1_W_F\")\n\n dMin = WorksheetFunction.Min(Da_Range)\n\n Status = False\n\n If dMin &lt; 1 And dMin &gt;= 0.3 Then\n    Status = True\n End If\n\n Sheets(\"POSTING\").Shapes(\"Single Truck Load\").Visible = Status\n 'Sheets(\"POSTING\").Shapes(\"Truck and Trailer Load\").Visible = Status\n 'Sheets(\"POSTING\").Shapes(\"Truck Train Load\").Visible = Status\n 'Sheets(\"POSTING\").Shapes(\"Triple Posting Sign\").Visible = Status\n\n Capacity_Factor_Fetch2 = dMin\n\nEnd Function\n</code></pre>\n\n<p>As of the comment from Rory you could also have a <code>Private Sub Worksheet_Calculate()</code> in the sheet \"Posting\" like so:</p>\n\n<p>Code in the worksheet class module \"Posting\":</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n  Status = False\n\n  If Me.Range(\"J30\").Value &lt; 1 And Me.Range(\"J30\").Value &gt;= 0.3 Then\n    Status = True\n  End If\n\n  Me.Shapes(\"Single Truck Load\").Visible = Status\n\n\nEnd Sub\n</code></pre>\n\n<p><code>Me</code> here stands for the worksheet \"Posting\" since this code resides in the class module of this worksheet. <code>Me</code> is a default reference in class modules like <code>this</code> in some other languages.</p>\n\n<p>That will really be the best approach, thanks to Rory.</p>\n"}], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 33386565, "answer_count": 1, "score": 1, "last_activity_date": 1475785999, "creation_date": 1446017777, "last_edit_date": 1475785999, "question_id": 33385351, "link": "https://stackoverflow.com/questions/33385351/function-placement-shape-error-and-executing-code-when-a-formula-changes-a-cel", "title": "Function placement, Shape Error, and Executing code when a formula changes a cell Value", "body": "<p>ok so I have burned more of a day reading on this and going around in circles.</p>\n\n<h2>SITUATION</h2>\n\n<p>On a worksheet called \"Analysis\" in Cells N279:O279 I have named the range CL1_W_F</p>\n\n<p>On a worksheet called \"Analysis\" in Cells N280:O280 I have named the range CL2_W_F</p>\n\n<p>On a worksheet called \"Analysis\" in Cells N281:O281 I have named the range CL3_W_F</p>\n\n<p>The numbers in those cells are a results from a formula</p>\n\n<p>On a worksheet called \"posting\" in cell J30 I have the formula \"Min(CL1_W_F)\"</p>\n\n<p>On worksheet called \"Posting\" I have 1 picture and 3 text boxes.  I was able to rename them and manipulate them using shapes(\"Triple Posting Sign\") for the picture and shapes(\"Single Truck Load\"), shapes(\"Truck and Trailer Load\") or shapes(\"Truck Train Load\")</p>\n\n<h2>OBJECTIVE</h2>\n\n<p>What I am trying to achieve is to turn the visibility of the 4 shapes to True when the value in J30 is less than 1 and Greater than or equal to 0.3.  When the value is outside the test values, then the visibility should be set to False.</p>\n\n<h2>What I have tried</h2>\n\n<p>I read a bunch of different options for monitoring the cell J30 changing since its due to a formula, but I got lost and confused in that process.  Then I read something about embedding the changes you want to happen into a FUNCTION call and that sounded simple enough so I tried the following</p>\n\n<pre><code>Function Capacity_Factor_Fetch2() As Long\n\nDim Status As Boolean\nDim Da_Range As Range\n\nSet Da_Range = Sheets(\"Analysis\").Range(\"CL1_W_F\")\n\nStatus = False\n\nIf Sheets(\"POSTING\").Range(\"j30\").Value &lt; 1 And Sheets(\"POSTING\").Range(\"j30\").Value &gt;= 0.3 Then\n    Status = True\nEnd If\n\nShapes(\"Single Truck Load\").Visible = Status\nShapes(\"Truck and Trailer Load\").Visible = Status\nShapes(\"Truck Train Load\").Visible = Status\nShapes(\"Triple Posting Sign\").Visible = Status\n\nCapacity_Factor_Fetch2 = WorksheetFunction.Min(Da_Range)\n\nEnd Function\n</code></pre>\n\n<p>The problem I encountered is I originally placed it in sheet6(POSTING) and could not call the function when I tried entering \"=Capacity_Factor_Fetch2\" in cell J30.  I could however step through it using \"F8\" and it did what I wanted it to.  I then copied and pasted the code into \"Module1\".  This allowed me to call it from the worksheet but I now get Compile error: Sub or Function not defined.  When I click ok to clear the error window the word \"Shapes\" is highlighted on the first line of changing the visibility status.</p>\n\n<p>So I am now stuck with either not being able to call code that works, or being able to call code that won't compile.</p>\n\n<p>Any assistance with A) why I am having the errors and how to fix them, B) a more elegant solution that may require spoon feeding me.</p>\n"}, {"tags": ["python", "vba", "excel"], "comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1446146912, "post_id": 33385259, "comment_id": 54635247, "body": "File &gt; Options &gt; Trust Center     Click on Trust Center Settings... button     Macro Settings &gt; Check Enable all macros"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 5, "last_activity_date": 1483630028, "last_edit_date": 1483630028, "creation_date": 1446153580, "answer_id": 33424796, "question_id": 33385259, "link": "https://stackoverflow.com/questions/33385259/python-running-excel-macro-with-python/33424796#33424796", "title": "Python : running Excel macro with python", "body": "<p>This worked fine for me.  Just change the path and the name of the Macro.</p>\n\n<pre><code>from __future__ import print_function\nimport unittest\nimport os.path\nimport win32com.client\n\nclass ExcelMacro(unittest.TestCase):\n    def test_excel_macro(self):\n        try:\n            xlApp = win32com.client.DispatchEx('Excel.Application')\n            xlsPath = os.path.expanduser('C:\\\\Users\\\\rshuell001\\\\Desktop\\\\Valuation Code Rollover.xlsb')\n            wb = xlApp.Workbooks.Open(Filename=xlsPath)\n            xlApp.Run('Macro1')\n            wb.Save()\n            xlApp.Quit()\n            print(\"Macro ran successfully!\")\n        except:\n            print(\"Error found while running the excel macro!\")\n            xlApp.Quit()\nif __name__ == \"__main__\":\n    unittest.main()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7232823, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/07514aeab9c2e1cf56079aae43bf97f4?s=128&d=identicon&r=PG", "display_name": "Hanni", "link": "https://stackoverflow.com/users/7232823/hanni"}, "is_accepted": false, "score": -1, "last_activity_date": 1480535615, "creation_date": 1480535615, "answer_id": 40897000, "question_id": 33385259, "link": "https://stackoverflow.com/questions/33385259/python-running-excel-macro-with-python/40897000#40897000", "title": "Python : running Excel macro with python", "body": "<p>I tried xl.Application.Run(\"macroname\"), then it worked. I only have one workbook opened and one unique \"macroname\".  </p>\n"}], "owner": {"reputation": 31, "user_id": 5496882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c51b94dae4c9f6cde8e15ed62bf5987d?s=128&d=identicon&r=PG&f=1", "display_name": "SINORA", "link": "https://stackoverflow.com/users/5496882/sinora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7841, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1483630028, "creation_date": 1446017472, "last_edit_date": 1446022968, "question_id": 33385259, "link": "https://stackoverflow.com/questions/33385259/python-running-excel-macro-with-python", "title": "Python : running Excel macro with python", "body": "<p>I need to run an Excel macro via python and I always get the following error :</p>\n\n<pre><code>result = self._oleobj_.InvokeTypes(*(dispid, LCID, wFlags, retType, argTypes) + args)\npywintypes.com_error: (-2147352567, 'Exception occurred.', (0, None, None, None, 0, -2146788248), None)\n</code></pre>\n\n<p>In Excel, it is giving the following error :</p>\n\n<blockquote>\n  <p>Run-time error 1004: \n  Cannot run the macro \". The macro may not be available in this workbook or all macros may be disabled.</p>\n</blockquote>\n\n<p>My code is the following :</p>\n\n<pre><code>xl=win32.Dispatch(\"Excel.Application\")\nwb=xl.Workbooks.Open(Filename=\"Path+MyExcelFile.xlsm\", ReadOnly=1)\nxl.Visible = True\ntime.sleep(1)\nws=wb.Worksheets(\"Sheet1\")\nws.Cells(4,2).Value='Value1'\nws.Cells(5,2).Value='Value2'\nws.Cells(1,8).Value='Bool'\ntime.sleep(10)\nxl.Application.Run(\"MyExcelFile.xlsm!macroname\")\nresult = ws.Cells(3,10).Value\nprint result\nxl.Application.Quit()\ndel xl\n</code></pre>\n\n<p>I enabled all macros through Macros security, and the macro is not defined for a specific sheet. And of course the macro is working correctly if I run it manually in Excel</p>\n"}, {"tags": ["vba", "excel", "excel-2003"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1446015471, "post_id": 33384722, "comment_id": 54562281, "body": "Given that a filter really only increases the visibility of certain values, would <a href=\"https://support.office.com/en-au/article/Use-a-formula-to-apply-conditional-formatting-fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f\" rel=\"nofollow noreferrer\">Conditional Formatting</a> be sufficient?"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1446016130, "post_id": 33384722, "comment_id": 54562546, "body": "Okay basically i have a table of values showing different periods, with values of financial ratios corresponding to the periods.These values are plotted in graphs. So i want to only see certain periods to track the progress of the ratios. Not all periods all the time. That is why i need a filter @Jeeped"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1446017027, "post_id": 33384722, "comment_id": 54562904, "body": "Do you happen to use XL 2013? You can filter graphs there. Anyways, it is still a little bit unclear. Could you site simple examples on what you&#39;re trying to achieve."}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1446017380, "post_id": 33384722, "comment_id": 54563057, "body": "I am using 2003 unfortunately:/ @L42"}], "answers": [{"tags": [], "owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "is_accepted": false, "score": 0, "last_activity_date": 1446017535, "creation_date": 1446017535, "answer_id": 33385285, "question_id": 33384722, "link": "https://stackoverflow.com/questions/33384722/filter-customized-range-of-cells/33385285#33385285", "title": "Filter customized range of cells", "body": "<p>I don't think you can have multiple filters in one sheet, so answer is no.\n<a href=\"http://answers.microsoft.com/en-us/office/forum/office_2013_release-excel/can-you-have-multiple-filter-tables-on-one-sheet/f9b617b0-25a4-439f-9212-0649754855b7\" rel=\"nofollow\">Here</a> is discussion about same question, with option to use custom views, but I think it's not what you want</p>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446019061, "creation_date": 1446015342, "last_edit_date": 1446019061, "question_id": 33384722, "link": "https://stackoverflow.com/questions/33384722/filter-customized-range-of-cells", "title": "Filter customized range of cells", "body": "<p>I have a several tables of cells (they are just ranges not tables) . I was wondering if it is possible to create a filter option for each of these ranges. Example place a data filter for cells K13:K22. I realised that the filter can only be implemented for one range at a time . I was wondering if there is an easier way to programme a data filter for each of the ranges , so as to make it more convenient. Came across something like this online but it only focuses at a certain value. Some help would be greatly appreciated. Thank you</p>\n\n<pre><code>Sheets(\"Base data\").Select\n\n    'If Data Filter is already active on this worksheet\n    Selection.AutoFilter Field:=18, Criteria1:=Range(\"H82\").Value\n\n\n    'If Data Filter is NOT active on this worksheet\n    Range(\"A1\").Select\n    Selection.AutoFilter Field:=18, Criteria1:=Range(\"H82\").Value\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5319870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-a6r6fG_3CmQ/AAAAAAAAAAI/AAAAAAAAAJI/c_6KZR7CCJg/photo.jpg?sz=128", "display_name": "IlhamideaZ", "link": "https://stackoverflow.com/users/5319870/ilhamideaz"}, "edited": false, "score": 0, "creation_date": 1446017330, "post_id": 33384653, "comment_id": 54563031, "body": "It shows error &quot;Argument not optional&quot;. How to slove this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 103, "user_id": 5319870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-a6r6fG_3CmQ/AAAAAAAAAAI/AAAAAAAAAJI/c_6KZR7CCJg/photo.jpg?sz=128", "display_name": "IlhamideaZ", "link": "https://stackoverflow.com/users/5319870/ilhamideaz"}, "edited": false, "score": 0, "creation_date": 1446017800, "post_id": 33384653, "comment_id": 54563248, "body": "My apologies. It should have been <code>NetworkDays_Intl</code> as a VBA call, not <code>NetworkDays.Intl</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1446017757, "last_edit_date": 1446017757, "creation_date": 1446015029, "answer_id": 33384653, "question_id": 33384387, "link": "https://stackoverflow.com/questions/33384387/vba-macro-subtract-weekdays-from-two-date-column/33384653#33384653", "title": "VBA Macro Subtract Weekdays from Two Date Column", "body": "<p>You seem to have missed the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow\">WorksheetFunction object</a> from the call to <a href=\"https://support.office.com/en-us/article/NETWORKDAYS-INTL-function-A9B26239-4F20-46A1-9AB8-4E925BFD5E28\" rel=\"nofollow\">NETWORKDAYS.INTL function</a>. I've moved the repetitive call to the worksheet into a surrounding <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a>.</p>\n\n<pre><code>WITH CurrentSheet\n    For lrow = EndRow To InitialRow Step -1\n        .Cells(lrow, \"AH\").Value = WORKSHEETFUNCTION.NetworkDays_Intl(.Cells(lrow, \"W\"), .Cells(lrow, \"V\"), 11)\n    Next lrow\nEND WITH\n</code></pre>\n\n<p>Are the types of weekends really that different for each line that you cannot just put a number in the third parameter instead of <code>.Cells(lrow, \"AG\")</code>? Check the official documentation for the <a href=\"https://support.office.com/en-us/article/NETWORKDAYS-INTL-function-A9B26239-4F20-46A1-9AB8-4E925BFD5E28\" rel=\"nofollow\">NETWORKDAYS.INTL function</a> to make sure you are providing the correct parameters.</p>\n"}], "owner": {"reputation": 103, "user_id": 5319870, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-a6r6fG_3CmQ/AAAAAAAAAAI/AAAAAAAAAJI/c_6KZR7CCJg/photo.jpg?sz=128", "display_name": "IlhamideaZ", "link": "https://stackoverflow.com/users/5319870/ilhamideaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 33384653, "answer_count": 1, "score": 2, "last_activity_date": 1446023000, "creation_date": 1446014060, "last_edit_date": 1446023000, "question_id": 33384387, "link": "https://stackoverflow.com/questions/33384387/vba-macro-subtract-weekdays-from-two-date-column", "title": "VBA Macro Subtract Weekdays from Two Date Column", "body": "<p>Currently I'm trying to minus weekdays between two days from two columns using Networkdays.Intl.</p>\n\n<p>But the error shows </p>\n\n<blockquote>\n  <p>Object-required. </p>\n</blockquote>\n\n<p>How I need to solve this? I'm actually unsure the way I'm using Networkdays.Intl is correct or not.</p>\n\n<p>Here is my code :</p>\n\n<pre><code>Private Sub MinusWeekDays()\n    Dim InitialRow As Long\n    Dim EndRow As Long\n    Dim lrow As Long\n\n    Dim CurrentSheet As Worksheet\n    Set CurrentSheet = Excel.ActiveSheet\n\n    InitialRow = CurrentSheet.UsedRange.Cells(1).Row\n    EndRow = CurrentSheet.UsedRange.Rows(CurrentSheet.UsedRange.Rows.count).Row\n\n    For lrow = EndRow To InitialRow Step -1\n        CurrentSheet.Cells(lrow, \"AH\").Value = NetworkDays.Intl((CurrentSheet.Cells(lrow, \"W\").Value), (CurrentSheet.Cells(lrow, \"V\").Value), (CurrentSheet.Cells(lrow, \"AG\").Value))\n    Next lrow\nEnd Sub\n</code></pre>\n\n<p>I'm also tried to replace CurrentSheet.Cells(lrow, \"AG\").Value) directly with '11' by doing Dim intdays As Integer, intdays = 11 coz to avoid needs for creating a column with value 11 only but seems failed.</p>\n"}, {"tags": ["vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 743, "user_id": 1688277, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bc01368317cbf8a91520c79e13d960d7?s=128&d=identicon&r=PG", "display_name": "Marc L", "link": "https://stackoverflow.com/users/1688277/marc-l"}, "edited": false, "score": 0, "creation_date": 1446014855, "post_id": 33384138, "comment_id": 54562019, "body": "See the solution I found posted below"}], "answers": [{"comments": [{"owner": {"reputation": 743, "user_id": 1688277, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bc01368317cbf8a91520c79e13d960d7?s=128&d=identicon&r=PG", "display_name": "Marc L", "link": "https://stackoverflow.com/users/1688277/marc-l"}, "edited": false, "score": 0, "creation_date": 1446014677, "post_id": 33384333, "comment_id": 54561933, "body": "Tried adding the dim statement in-gives an error that it is an user defined type"}, {"owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "reply_to_user": {"reputation": 743, "user_id": 1688277, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bc01368317cbf8a91520c79e13d960d7?s=128&d=identicon&r=PG", "display_name": "Marc L", "link": "https://stackoverflow.com/users/1688277/marc-l"}, "edited": false, "score": 0, "creation_date": 1446015135, "post_id": 33384333, "comment_id": 54562141, "body": "unfortunately I cannot test it on 2010, but it works on Office 2013 Pro"}], "tags": [], "owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "is_accepted": false, "score": 0, "last_activity_date": 1446013841, "creation_date": 1446013841, "answer_id": 33384333, "question_id": 33384138, "link": "https://stackoverflow.com/questions/33384138/access-2010-file-dialog-call-from-vba-not-working/33384333#33384333", "title": "Access 2010 file dialog call from VBA not working", "body": "<p>You have to declare variable first :</p>\n\n<pre><code>Private Sub cmdSelectFile_Click()\nDim objDialog As Office.FileDialog\nSet objDialog = Application.FileDialog(msoFileDialogFilePicker)\n\nWith objDialog\n  .AllowMultiSelect = False\n  .Show\n  If .SelectedItems.Count = 0 Then\n    MsgBox \"No file selected.\"\n  Else\n     txtFilePath = .SelectedItems(1)\n    End If\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 743, "user_id": 1688277, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bc01368317cbf8a91520c79e13d960d7?s=128&d=identicon&r=PG", "display_name": "Marc L", "link": "https://stackoverflow.com/users/1688277/marc-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1446014938, "creation_date": 1446014938, "answer_id": 33384629, "question_id": 33384138, "link": "https://stackoverflow.com/questions/33384138/access-2010-file-dialog-call-from-vba-not-working/33384629#33384629", "title": "Access 2010 file dialog call from VBA not working", "body": "<p>The library seemed t not pick up the msofiledialogpicker- changed it to msofiledialogopen and it worked fine.  Not sure why- it worked with picker on one machine but not across the network on other machines, still this solution did work.</p>\n"}], "owner": {"reputation": 743, "user_id": 1688277, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bc01368317cbf8a91520c79e13d960d7?s=128&d=identicon&r=PG", "display_name": "Marc L", "link": "https://stackoverflow.com/users/1688277/marc-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446014938, "creation_date": 1446012930, "last_edit_date": 1446013247, "question_id": 33384138, "link": "https://stackoverflow.com/questions/33384138/access-2010-file-dialog-call-from-vba-not-working", "title": "Access 2010 file dialog call from VBA not working", "body": "<p>I am calling a filedialog but for some reason I am getting the error in the screenshot.  The code calling it is:\n<a href=\"https://i.stack.imgur.com/6AjFR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6AjFR.png\" alt=\"Runtime Error\"></a></p>\n\n<pre><code>Private Sub cmdSelectFile_Click()\n  Set objDialog = Application.FileDialog(msoFileDialogFilePicker)\n\n   With objDialog\n    .AllowMultiSelect = False\n    .Show\n    If .SelectedItems.Count = 0 Then\n      MsgBox \"No file selected.\"\n    Else\n      txtFilePath = .SelectedItems(1)\n    End If\n  End With\nEnd Sub\n</code></pre>\n\n<p>Anyone able to say what the error is?  References has both the office 14 object library and the access 14 library included</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "forms", "outlook", "appointment"], "comments": [{"owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1446194056, "post_id": 33382856, "comment_id": 54651539, "body": "How would this be simple if Outlook had a macro recorder? I see no way to change the dropdown through the standard user interface. Have you considered using a user form or a custom Outlook form - or does it have to be native?"}, {"owner": {"reputation": 4143, "user_id": 65184, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/85b38a9a30e31f55c332869248fa701f?s=128&d=identicon&r=PG", "display_name": "notnot", "link": "https://stackoverflow.com/users/65184/notnot"}, "reply_to_user": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1446231791, "post_id": 33382856, "comment_id": 54674533, "body": "With a macro recorder I could potentially find out how to reference the form elements by changing their values and seeing what gets spit out in the code, or at least get some clue as to how the controls are arranged."}, {"owner": {"reputation": 4143, "user_id": 65184, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/85b38a9a30e31f55c332869248fa701f?s=128&d=identicon&r=PG", "display_name": "notnot", "link": "https://stackoverflow.com/users/65184/notnot"}, "reply_to_user": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1446231981, "post_id": 33382856, "comment_id": 54674652, "body": "My boss wants this to be seamless - the users shouldn&#39;t have to do anything different from what they would do normally when setting up or altering an appointment."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "edited": false, "score": 2, "creation_date": 1446473998, "post_id": 33382856, "comment_id": 54744128, "body": "I do not think you are adjust this in Outlook. VBA will help you with tasks involving the application but you cannot always modify the application. Perhaps you need to develop a more robust application add-in in VSTO."}], "answers": [{"comments": [{"owner": {"reputation": 4143, "user_id": 65184, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/85b38a9a30e31f55c332869248fa701f?s=128&d=identicon&r=PG", "display_name": "notnot", "link": "https://stackoverflow.com/users/65184/notnot"}, "edited": false, "score": 0, "creation_date": 1446680463, "post_id": 33508156, "comment_id": 54849798, "body": "Where should I be using this function? What event would I call this from? I would want to not only have a reference to the start time dropdown control, but be able to independently reference it within an entirely different function without requiring user interaction first."}, {"owner": {"reputation": 4143, "user_id": 65184, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/85b38a9a30e31f55c332869248fa701f?s=128&d=identicon&r=PG", "display_name": "notnot", "link": "https://stackoverflow.com/users/65184/notnot"}, "edited": false, "score": 0, "creation_date": 1446680597, "post_id": 33508156, "comment_id": 54849851, "body": "The Start property would be great if I were trying to independently, in code, set the start time, but I need to alter what the options are within the start time dropdown so that the user can simply select the time they want."}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 3, "last_activity_date": 1446581446, "creation_date": 1446581446, "answer_id": 33508156, "question_id": 33382856, "link": "https://stackoverflow.com/questions/33382856/outlook-appointment-how-to-change-the-items-in-the-start-time-dropdown-list/33508156#33508156", "title": "Outlook Appointment - how to change the items in the Start Time dropdown list", "body": "<p>Check the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff861915.aspx\" rel=\"nofollow\">Appointment.Start</a> property. Use the following function to get current object</p>\n\n<pre><code>Function GetCurrentItem() As Object\n    Dim objApp As Outlook.Application\n    Set objApp = Application\n    On Error Resume Next\n    Select Case TypeName(objApp.ActiveWindow)\n    Case \"Explorer\"\n    Set GetCurrentItem = objApp.ActiveExplorer.Selection.Item(1)\n    Case \"Inspector\"\n    Set GetCurrentItem = objApp.ActiveInspector.CurrentItem\n    End Select\n    GetCurrentItem.UnRead = False\n    Set objApp = Nothing\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4143, "user_id": 65184, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/85b38a9a30e31f55c332869248fa701f?s=128&d=identicon&r=PG", "display_name": "notnot", "link": "https://stackoverflow.com/users/65184/notnot"}, "edited": false, "score": 0, "creation_date": 1446755758, "post_id": 33533751, "comment_id": 54888055, "body": "Thanks for the answer! My boss just kind of assumed it would be easy since Excel and Word macros are so easy and flexible, but I guess she was wrong. We&#39;re not really willing to put the time in to learn and develop a new technology just to make this work, since it wasn&#39;t a big priority in the first place."}], "tags": [], "owner": {"reputation": 698, "user_id": 5526349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d812ca76337577d1eefe44dc80877e6f?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Wynn", "link": "https://stackoverflow.com/users/5526349/andrew-wynn"}, "is_accepted": false, "score": 3, "last_activity_date": 1446679024, "last_edit_date": 1446679024, "creation_date": 1446678272, "answer_id": 33533751, "question_id": 33382856, "link": "https://stackoverflow.com/questions/33382856/outlook-appointment-how-to-change-the-items-in-the-start-time-dropdown-list/33533751#33533751", "title": "Outlook Appointment - how to change the items in the Start Time dropdown list", "body": "<p>This doesn't answer your question exactly - but I don't believe that it is possible to do what you need because there isn't a programmatic interface to those drop downs, nor is there a way to manually achieve what you want, so I don't know how having a macro recorder would help</p>\n\n<p><a href=\"http://blogs.technet.com/b/ewan/archive/2013/11/08/tip-o-the-week-196-change-outlook-meeting-duration.aspx\" rel=\"nofollow\">This Website</a> will tell you how to set a meeting up with a custom start time and duration, but you could build your own userform to popup whenever a meeting/appointment is created requesting a start and end time (or start time &amp; duration if you prefer), which is probably the best workaround you'll get.</p>\n\n<p>You could go crazy with this and make a non-modal userform that places itself over the existing controls and replicates their functionality - but that's a lot of coding, and it would be slow because it would be constantly updating its position or hiding itself when the appointment item loses focus, but its very achievable if you are determined.</p>\n\n<p>Outside of VBA/Outlook, you could use Visual Studio to make a VSTO Add-In, creating a new ribbon in the appointment/meeting section, which has two custom controls which modify the start and end dates. You could also populate these with whatever code you want, but you'll probably need to learn C# to do this, although it may be possible with VB.net (which is much more similar to VBA). <a href=\"https://naimhamadi.wordpress.com/2014/07/15/adding-a-custom-context-menu-item-to-outlook-2013/\" rel=\"nofollow\">This Website</a> is a reasonable starting point.</p>\n\n<p>I'm sorry that this isn't really an answer, but I'm afraid that there isn't a satisfactory answer to this question.</p>\n"}], "owner": {"reputation": 4143, "user_id": 65184, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/85b38a9a30e31f55c332869248fa701f?s=128&d=identicon&r=PG", "display_name": "notnot", "link": "https://stackoverflow.com/users/65184/notnot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 789, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1592948829, "creation_date": 1446006100, "last_edit_date": 1592948829, "question_id": 33382856, "link": "https://stackoverflow.com/questions/33382856/outlook-appointment-how-to-change-the-items-in-the-start-time-dropdown-list", "title": "Outlook Appointment - how to change the items in the Start Time dropdown list", "body": "<p>I need to <strong>change the items in the start/end time dropdown list to be 5 minutes apart</strong>. Seems there's no simple way to set this up, so I'm trying VBA.</p>\n\n<p>I can get an Inspector to look for when an appointment form is opened:</p>\n\n<pre><code>If Inspector.CurrentItem.Class = olAppointment Then\n</code></pre>\n\n<p>... but I don't know <strong>how to refer to or change the start/end time dropdown control</strong> to have the list of times I want it to.</p>\n\n<p>If anyone out there knows of an alternative method of allowing the user to choose the times in intervals of 5 minutes, that would be great, too!</p>\n"}, {"tags": ["xml", "vba", "class", "properties", "module"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446003875, "post_id": 33382361, "comment_id": 54558569, "body": "If that&#39;s what you want to do then you can do that. It&#39;s not clear what&#39;s stopping you exactly?"}, {"owner": {"reputation": 3, "user_id": 5496299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cfc09aa920485556b2aca88420c1951?s=128&d=identicon&r=PG&f=1", "display_name": "brebbles", "link": "https://stackoverflow.com/users/5496299/brebbles"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446004183, "post_id": 33382361, "comment_id": 54558642, "body": "That&#39;s my question - I want to know how to loop through certain elements of the class, where the elements aren&#39;t specifically an array"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446004539, "post_id": 33382361, "comment_id": 54558708, "body": "That&#39;s typically why this type of task would use an array: not doing so make your life much more difficult. The answer in your case though is probably to use <code>CallByName</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5496299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cfc09aa920485556b2aca88420c1951?s=128&d=identicon&r=PG&f=1", "display_name": "brebbles", "link": "https://stackoverflow.com/users/5496299/brebbles"}, "edited": false, "score": 0, "creation_date": 1446080677, "post_id": 33382712, "comment_id": 54600014, "body": "Many thanks, that&#39;s exactly what I was after.  I noticed when following the get/set method that the &quot;v&quot; array will create duplicate entries in that it creates both mT1/2/3 as well as Total1/2/3 but this should be easy enough to deal with."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 5496299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cfc09aa920485556b2aca88420c1951?s=128&d=identicon&r=PG&f=1", "display_name": "brebbles", "link": "https://stackoverflow.com/users/5496299/brebbles"}, "edited": false, "score": 0, "creation_date": 1446089731, "post_id": 33382712, "comment_id": 54602376, "body": "mT1 etc are private variables used to back the public properties Total1 etc.  that&#39;s typically how you implement a property - there needs to be somewhere to store the value within the class..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1446004956, "creation_date": 1446004956, "answer_id": 33382712, "question_id": 33382361, "link": "https://stackoverflow.com/questions/33382361/vba-assigning-values-to-certain-elements-of-a-class/33382712#33382712", "title": "VBA - Assigning values to certain elements of a class", "body": "<p>Example:</p>\n\n<pre><code>Sub Tester()\n\n    Dim t As New clsTest\n    Dim i As Long\n\n    For i = 1 To 3\n        CallByName t, \"Total\" &amp; i, VbLet, i * 10\n    Next i\n\n    Debug.Print t.Total1, t.Total2, t.Total3 '--&gt; 10, 20, 30\n\nEnd Sub\n</code></pre>\n\n<p>clsTest:</p>\n\n<pre><code>Option Explicit\n\nPrivate mT1 As Double\nPrivate mT2 As Double\nPrivate mT3 As Double\n\nProperty Let Total1(v As Double)\n    mT1 = v\nEnd Property\nProperty Get Total1() As Double\n    Total1 = mT1\nEnd Property\nProperty Let Total2(v As Double)\n    mT2 = v\nEnd Property\nProperty Get Total2() As Double\n    Total2 = mT2\nEnd Property\nProperty Let Total3(v As Double)\n    mT3 = v\nEnd Property\nProperty Get Total3() As Double\n    Total3 = mT3\nEnd Property\n</code></pre>\n\n<p>You can also simply use Public variables in <code>clsTest</code> (no need for getter/setter)</p>\n"}], "owner": {"reputation": 3, "user_id": 5496299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cfc09aa920485556b2aca88420c1951?s=128&d=identicon&r=PG&f=1", "display_name": "brebbles", "link": "https://stackoverflow.com/users/5496299/brebbles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 33382712, "answer_count": 1, "score": 0, "last_activity_date": 1446004956, "creation_date": 1446002528, "last_edit_date": 1446003222, "question_id": 33382361, "link": "https://stackoverflow.com/questions/33382361/vba-assigning-values-to-certain-elements-of-a-class", "title": "VBA - Assigning values to certain elements of a class", "body": "<p>I have some XML with values I would like to assign through to a class, and I was wondering if it is possible to loop through certain elements of the class (as opposed to creating an array in the class).</p>\n\n<p>So with reference to the XML snippet below, I'd like to have the class set up to pass values from the XML as follows:</p>\n\n<pre><code>event.homeTeamName\nevent.awayTeamName\nevent.homeSpread1 \nevent.homeSpread2\nevent.homeSpread3\nevent.homeSpread4\nevent.homeSpread5\nevent.totalPoints1\nevent.totalPoints2\nevent.totalPoints3\nevent.totalPoints4\nevent.totalPoints5\n</code></pre>\n\n<p>as opposed to</p>\n\n<pre><code>event.homeTeamName\nevent.awayTeamName\nevent.homeSpread(1) \nevent.homeSpread(2)\nevent.homeSpread(3)\nevent.homeSpread(4)\nevent.homeSpread(5)\nevent.totalPoints(1)\nevent.totalPoints(2)\nevent.totalPoints(3)\nevent.totalPoints(4)\nevent.totalPoints(5)\n</code></pre>\n\n<p>Is there a way to loop through the <em>homeSpread1</em> - <em>homeSpread5</em> and <em>totalPoints1</em> - <em>totalPoints5</em> elements of the class when assigning the values from the XML?  I'm aware of the <strong>Property Get</strong> and <strong>Property Let</strong> features within the class module, but as far as I can see this would result in the undesired class involving arrays. Also as far as I can see I'd need to create a <strong>Property Let/Get</strong> for each array anyway.</p>\n\n<p>Here is an example of the XML snippet:</p>\n\n<pre><code>                            &lt;homeTeam type=\"Team1\"&gt;\n                                &lt;name&gt;Brisbane Roar&lt;/name&gt;\n                                &lt;rotNum&gt;2151&lt;/rotNum&gt;\n                            &lt;/homeTeam&gt;\n                            &lt;awayTeam type=\"Team2\"&gt;\n                                &lt;name&gt;Adelaide United&lt;/name&gt;\n                                &lt;rotNum&gt;2152&lt;/rotNum&gt;\n                            &lt;/awayTeam&gt;\n                            &lt;periods&gt;\n                                &lt;period lineId=\"234921091\"&gt;\n                                    &lt;spreads&gt;\n                                        &lt;spread&gt;\n                                            &lt;awaySpread&gt;0.25&lt;/awaySpread&gt;\n                                            &lt;awayPrice&gt;2.01&lt;/awayPrice&gt;\n                                            &lt;homeSpread&gt;-0.25&lt;/homeSpread&gt;\n                                            &lt;homePrice&gt;1.909&lt;/homePrice&gt;\n                                        &lt;/spread&gt;\n                                        &lt;spread altLineId=\"1893988627\"&gt;\n                                            &lt;awaySpread&gt;0.75&lt;/awaySpread&gt;\n                                            &lt;awayPrice&gt;1.549&lt;/awayPrice&gt;\n                                            &lt;homeSpread&gt;-0.75&lt;/homeSpread&gt;\n                                            &lt;homePrice&gt;2.59&lt;/homePrice&gt;\n                                        &lt;/spread&gt;\n                                        &lt;spread altLineId=\"1893988629\"&gt;\n                                            &lt;awaySpread&gt;0.5&lt;/awaySpread&gt;\n                                            &lt;awayPrice&gt;1.751&lt;/awayPrice&gt;\n                                            &lt;homeSpread&gt;-0.5&lt;/homeSpread&gt;\n                                            &lt;homePrice&gt;2.21&lt;/homePrice&gt;\n                                        &lt;/spread&gt;\n                                        &lt;spread altLineId=\"1893988631\"&gt;\n                                            &lt;awaySpread&gt;0&lt;/awaySpread&gt;\n                                            &lt;awayPrice&gt;2.47&lt;/awayPrice&gt;\n                                            &lt;homeSpread&gt;0&lt;/homeSpread&gt;\n                                            &lt;homePrice&gt;1.598&lt;/homePrice&gt;\n                                        &lt;/spread&gt;\n                                        &lt;spread altLineId=\"1893988633\"&gt;\n                                            &lt;awaySpread&gt;-0.25&lt;/awaySpread&gt;\n                                            &lt;awayPrice&gt;2.91&lt;/awayPrice&gt;\n                                            &lt;homeSpread&gt;0.25&lt;/homeSpread&gt;\n                                            &lt;homePrice&gt;1.444&lt;/homePrice&gt;\n                                        &lt;/spread&gt;\n                                    &lt;/spreads&gt;\n                                    &lt;totals&gt;\n                                        &lt;total&gt;\n                                            &lt;points&gt;2.75&lt;/points&gt;\n                                            &lt;overPrice&gt;2.02&lt;/overPrice&gt;\n                                            &lt;underPrice&gt;1.884&lt;/underPrice&gt;\n                                        &lt;/total&gt;\n                                        &lt;total altLineId=\"1893988628\"&gt;\n                                            &lt;points&gt;2.25&lt;/points&gt;\n                                            &lt;overPrice&gt;1.571&lt;/overPrice&gt;\n                                            &lt;underPrice&gt;2.49&lt;/underPrice&gt;\n                                        &lt;/total&gt;\n                                        &lt;total altLineId=\"1893988630\"&gt;\n                                            &lt;points&gt;2.5&lt;/points&gt;\n                                            &lt;overPrice&gt;1.793&lt;/overPrice&gt;\n                                            &lt;underPrice&gt;2.12&lt;/underPrice&gt;\n                                        &lt;/total&gt;\n                                        &lt;total altLineId=\"1893988632\"&gt;\n                                            &lt;points&gt;3&lt;/points&gt;\n                                            &lt;overPrice&gt;2.36&lt;/overPrice&gt;\n                                            &lt;underPrice&gt;1.632&lt;/underPrice&gt;\n                                        &lt;/total&gt;\n                                        &lt;total altLineId=\"1893988634\"&gt;\n                                            &lt;points&gt;3.25&lt;/points&gt;\n                                            &lt;overPrice&gt;2.69&lt;/overPrice&gt;\n                                            &lt;underPrice&gt;1.49&lt;/underPrice&gt;\n                                        &lt;/total&gt;\n                                    &lt;/totals&gt;\n                                &lt;/period&gt;\n                            &lt;/periods&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1446004767, "post_id": 33381902, "comment_id": 54558770, "body": "<code>On Error Resume Next</code> does not do what you think it does, and, it should be used <i>very</i> sparingly.  In this case, it&#39;s more appropriate to anticipate errors (i.e., the result of the <code>Find</code> is a <code>Nothing</code>, which can easily be tested and handled in the code."}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 2, "last_activity_date": 1445999931, "creation_date": 1445999931, "answer_id": 33382005, "question_id": 33381902, "link": "https://stackoverflow.com/questions/33381902/vba-ignore-the-variable-not-set-error/33382005#33382005", "title": "VBA: Ignore the Variable not set error", "body": "<p>I assume you have declared (<code>Dim</code>'d) FindAdmin as a <code>Range</code>\nYou could put a single <code>On Error Resume Next</code> at the beginning of your <code>.Find</code>'s, and, to turn off error checking, <code>On error goto 0</code> at the end of all those.</p>\n\n<p>But, to avoid missing other errors, a construct such as the following would be more useful, and also give you the opportunity for other options if the search phrase is not found:</p>\n\n<pre><code>Set FindAdmin = Worksheets(\"IVES\").Range(\"A1:Z350\").Find(\"** ACCRUED ADMINISTRATION EXPENSE\", LookIn:=xlValues, lookat:=xlWhole)\nIf Not FindAdmin Is Nothing Then\n    With FindAdmin\n        .Offset(, 4) = \"Budget\"\n        .Offset(, 5) = \"Closing Accruals (Admin Expense)\"\n    End With\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1446004622, "post_id": 33382613, "comment_id": 54558731, "body": "Excellent. Even if the ranges or worksheets are different, the function can be easily modified to take other parameters (<code>shtName$, rngAddress$</code>, etc) to make it even more flexible."}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 2, "last_activity_date": 1446004374, "creation_date": 1446004374, "answer_id": 33382613, "question_id": 33381902, "link": "https://stackoverflow.com/questions/33381902/vba-ignore-the-variable-not-set-error/33382613#33382613", "title": "VBA: Ignore the Variable not set error", "body": "<p>If the range to be searched is indeed the same for each search text, and the offsets are indeed all the same(4 and 5), then it's nicer to create a function and call the function, passing the strings as parameters. Put this function ONCE in your module:</p>\n\n<pre><code>Function NewRange(txt As String, str1 As String, str2 As String)\n    Dim r As Range\n    Set r = Worksheets(\"IVES\").Range(\"A1:Z350\").Find(txt, LookIn:=xlValues, LookAt:=xlWhole)\n    If Not r Is Nothing Then\n        r.Offset(, 4) = str1\n        r.Offset(, 5) = str2\n    End If\nEnd Function\n</code></pre>\n\n<p>Then call each bit of code in your sub like so:</p>\n\n<pre><code>Call NewRange(\"** ACCRUED ADMINISTRATION EXPENSE\", \"Budget\", \"Closing Accruals(Audit Expense)\")\n\nCall NewRange(\"** ACC AUDIT\", \"Budget\", \"Closing Accruals(Audit Expense)\")\n\nCall NewRange(\"** PAYABLE FOR FUND LEGAL - EXP\", \"Budget\", \"Closing Accruals (Legal Fees)\")\n</code></pre>\n\n<p>etc...</p>\n\n<p>If your function was a little bit different, you could put error handling in your functions for example if you were working with numbers, you could check for division by zero and address it in your function/</p>\n"}], "owner": {"reputation": 13, "user_id": 5496268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096abe7a2d31122d1baa99eade238fd8?s=128&d=identicon&r=PG&f=1", "display_name": "user52363", "link": "https://stackoverflow.com/users/5496268/user52363"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 33382613, "answer_count": 2, "score": 0, "last_activity_date": 1446004374, "creation_date": 1445999223, "last_edit_date": 1445999541, "question_id": 33381902, "link": "https://stackoverflow.com/questions/33381902/vba-ignore-the-variable-not-set-error", "title": "VBA: Ignore the Variable not set error", "body": "<p>I need to populate a range of data based on another range of data. For example, if the 1st range contains accrued admin expense I would populate \"closing Accruals (Admin Expense)\" into another range. My code below works if it manages to find all of the fields. However, if one of the fields is missing it returns error variable not set and stop running.</p>\n\n<pre><code>Set FindAdmin = Worksheets(\"IVES\").Range(\"A1:Z350\").Find(\"** ACCRUED ADMINISTRATION EXPENSE\", LookIn:=xlValues, lookat:=xlWhole)\nRange(FindAdmin.Address).Offset(, 4) = \"Budget\"\nRange(FindAdmin.Address).Offset(, 5) = \"Closing Accruals (Admin Expense)\"\nOn Error Resume Next\n\nSet FindAudit = Worksheets(\"IVES\").Range(\"A1:Z350\").Find(\"** ACC AUDIT\", LookIn:=xlValues, lookat:=xlWhole)\nRange(FindAudit.Address).Offset(, 4) = \"Budget\"\nRange(FindAudit.Address).Offset(, 5) = \"Closing Accruals(Audit Expense)\"\nOn Error Resume Next\n\nSet FindLegal = Worksheets(\"IVES\").Range(\"A1:Z350\").Find(\"** PAYABLE FOR FUND LEGAL - EXP\", LookIn:=xlValues, lookat:=xlWhole)\nRange(FindLegal.Address).Offset(, 4) = \"Budget\"\nRange(FindLegal.Address).Offset(, 5) = \"Closing Accruals (Legal Fees)\"\nOn Error Resume Next\n\nSet FindTax = Worksheets(\"IVES\").Range(\"A1:Z350\").Find(\"** PAYABLE FOR FUND TAX-EXPENSE\", LookIn:=xlValues, lookat:=xlWhole)\nRange(FindTax.Address).Offset(, 4) = \"Budget\"\nRange(FindTax.Address).Offset(, 5) = \"Closing Accruals (Tax Exp)\"\nOn Error Resume Next\n\nSet FindProf = Worksheets(\"IVES\").Range(\"A1:Z350\").Find(\"** ACCRUED OTHER PROF FEE\", LookIn:=xlValues, lookat:=xlWhole)\nRange(FindProf.Address).Offset(, 4) = \"Budget\"\nRange(FindProf.Address).Offset(, 5) = \"Closing Accruals (Other Prof Fee)\"\nOn Error Resume Next\n\nSet FindCustody = Worksheets(\"IVES\").Range(\"A1:Z350\").Find(\"** CUSTODY\", LookIn:=xlValues, lookat:=xlWhole)\nRange(FindCustody.Address).Offset(, 4) = \"Budget\"\nRange(FindCustody.Address).Offset(, 5) = \"Closing Accruals (Custody Exp)\"\nOn Error Resume Next\n\nSet FindMisc = Worksheets(\"IVES\").Range(\"A1:Z350\").Find(\"** ACCRUED MISCELLANEOUS EXPENSE\", LookIn:=xlValues, lookat:=xlWhole)\nRange(FindMisc.Address).Offset(, 4) = \"Budget\"\nRange(FindMisc.Address).Offset(, 5) = \"Closing Accruals (Misc Exp)\"\nOn Error Resume Next\n\nSet FindIRC = Worksheets(\"IVES\").Range(\"A1:Z350\").Find(\"** IRC FEE ACCRUAL\",    LookIn:=xlValues, lookat:=xlWhole)\nRange(FindIRC.Address).Offset(, 4) = \"Budget\"\nRange(FindIRC.Address).Offset(, 5) = \"Closing Accruals (IRC Fee)\"\nOn Error Resume Next\n</code></pre>\n\n<p>I would need the code to ignore the error and continue running so that it can continue to populate those that are found. I have tried to use On Error Resume Next but it don't seem to be working. Any idea how i could get the system to ignore this error? Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5496093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4783f0c16c9d88dbd0c9e8e9acb1980?s=128&d=identicon&r=PG&f=1", "display_name": "AYU", "link": "https://stackoverflow.com/users/5496093/ayu"}, "edited": false, "score": 0, "creation_date": 1446093449, "post_id": 33381348, "comment_id": 54603396, "body": "Thanks! this is exactly what I was looking for! actually my code was just rotten and I tried pasting it on, but it&#39;s my first question on this forum and it needed it to be formatted a certain way which I didn&#39;t know how to do... :("}, {"owner": {"reputation": 287, "user_id": 5458854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71d4ee178e2286b2d9017bdf26d2e889?s=128&d=identicon&r=PG&f=1", "display_name": "Louis. B", "link": "https://stackoverflow.com/users/5458854/louis-b"}, "reply_to_user": {"reputation": 1, "user_id": 5496093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4783f0c16c9d88dbd0c9e8e9acb1980?s=128&d=identicon&r=PG&f=1", "display_name": "AYU", "link": "https://stackoverflow.com/users/5496093/ayu"}, "edited": false, "score": 0, "creation_date": 1446099346, "post_id": 33381348, "comment_id": 54605359, "body": "No problem. Just add 4 spaces at the beginning of a line to declare it as a block of code in your post. And don&#39;t forget to accept the answer too :). Cheers"}], "tags": [], "owner": {"reputation": 287, "user_id": 5458854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71d4ee178e2286b2d9017bdf26d2e889?s=128&d=identicon&r=PG&f=1", "display_name": "Louis. B", "link": "https://stackoverflow.com/users/5458854/louis-b"}, "is_accepted": false, "score": 2, "last_activity_date": 1445995405, "creation_date": 1445995405, "answer_id": 33381348, "question_id": 33381045, "link": "https://stackoverflow.com/questions/33381045/fill-combobox-with-values-from-table-based-on-column-value-next-to-it-vba-code/33381348#33381348", "title": "Fill combobox with values from table based on column value next to it VBA code", "body": "<p>Some code of what you've already attempted is preferred. But you should try something like the following. Assume combobox1 is in UserForm1 :</p>\n\n<pre><code>Private Sub UserForm1_Initialize()\n\ndim ws as worksheet\nset ws = activesheet\n\nrowsCount = ws.cells(ws.rows.count, 1).end(xlup).row\n\n'loop over data in column A \nfor i = 0 to rowsCount\n    if ws.cells(i, 3).value = \"PINK\" then\n        combobox1.AddItem(ws.cells(i, 1).value)\n    end if\nnext i\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5496093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4783f0c16c9d88dbd0c9e8e9acb1980?s=128&d=identicon&r=PG&f=1", "display_name": "AYU", "link": "https://stackoverflow.com/users/5496093/ayu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1677, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1445995405, "creation_date": 1445993194, "last_edit_date": 1445993314, "question_id": 33381045, "link": "https://stackoverflow.com/questions/33381045/fill-combobox-with-values-from-table-based-on-column-value-next-to-it-vba-code", "title": "Fill combobox with values from table based on column value next to it VBA code", "body": "<p>I want to fill a combo box upon startup of userform with values in column A based on a value in Column C. \ni.e. my combobox options should list Items in column A if it's correponsing value in column C is \"PINK\"</p>\n"}, {"tags": ["html", "xml", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1445988383, "post_id": 33380260, "comment_id": 54554347, "body": "Easier if you can post the code you&#39;re using and show how you get this collection in the first place."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1445989910, "post_id": 33380260, "comment_id": 54554877, "body": "I don&#39;t see any tables on that page."}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1445990231, "post_id": 33380260, "comment_id": 54554982, "body": "Try search with random criteria so that results show up, and the table is created..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1445992662, "post_id": 33380260, "comment_id": 54555672, "body": "The results table is in a page hosted in an iframe, so it&#39;s not the same document as the one you have a reference to in your code..."}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1445993606, "post_id": 33380260, "comment_id": 54555935, "body": "Can you tell me how to access it?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1445998932, "post_id": 33380260, "comment_id": 54557333, "body": "It has an id, so presumably you can use something like <code>objHTML.getElementById(&quot;id_here&quot;).document.getElementsByTagN&zwnj;&#8203;ame(&quot;td&quot;)</code>"}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1446035078, "post_id": 33380260, "comment_id": 54573445, "body": "Thank you for your answer!"}], "answers": [{"comments": [{"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "edited": false, "score": 0, "creation_date": 1446035071, "post_id": 33382060, "comment_id": 54573438, "body": "Thank you for your answer!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "reply_to_user": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "edited": false, "score": 0, "creation_date": 1446038478, "post_id": 33382060, "comment_id": 54575731, "body": "You are welcome but all the credit goes to Tim Williams for his Html DOM knowledge."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "is_accepted": true, "score": 1, "last_activity_date": 1446000397, "creation_date": 1446000397, "answer_id": 33382060, "question_id": 33380260, "link": "https://stackoverflow.com/questions/33380260/accessing-disphtmlelementcollection-properties/33382060#33382060", "title": "Accessing DispHTMLElementCollection properties", "body": "<p>Using the feedback from Tim Williams</p>\n\n<pre><code>Sub test()\n\n    Dim objHTML As HTMLDocument\n    Dim ie As InternetExplorer\n    Dim oElemets As Object\n    Dim oElement As Object\n\n        Dim h As HTMLOptionElementFactory\n    Set ie = New InternetExplorer\n    With ie\n        .navigate \"https://www.oeko-tex.com/en/manufacturers/certified_products/certified_products.html\"\n        .Visible = True\n        While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE\n            DoEvents\n        Wend\n        Set objHTML = .document\n        DoEvents\n    End With\n\n    ' As per the suggestion Tim Williams proposed\n    Set objHTML = objHTML.getElementById(\"customer-profile\")\n    Set oElemets = objHTML.getElementsByTagName(\"td\")\n\n\n    For Each oElement In oElemets\n        Debug.Print oElement.nodeName\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2392, "favorite_count": 1, "accepted_answer_id": 33382060, "answer_count": 1, "score": 0, "last_activity_date": 1446000397, "creation_date": 1445988229, "last_edit_date": 1445989687, "question_id": 33380260, "link": "https://stackoverflow.com/questions/33380260/accessing-disphtmlelementcollection-properties", "title": "Accessing DispHTMLElementCollection properties", "body": "<p>I need to iterate through the elements of an object that (as the debugger states) is a <code>DispHTMLElementCollection</code>.</p>\n\n<p>Can't seem to be able to access the properties of a <code>DispHTMLElementCollection</code> as there is a table with 50 <code>td</code> tags on this page, and when I print out the length of this object it returns <code>0</code>.</p>\n\n<p>Any light about this is appreciated.</p>\n\n<p>Thanks.</p>\n\n<p>EDIT:</p>\n\n<p>Using this snippet, you still need to break the code to press the search button to show some results, but after that, still returns <code>zero</code> as length...</p>\n\n<pre><code>Dim objHTML As HTMLDocument\n\nSet ie = New InternetExplorer\nWith ie\n    .navigate \"https://www.oeko-tex.com/en/manufacturers/certified_products/certified_products.html\"\n    .Visible = True\n    While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE\n       DoEvents\n    Wend\n    Set objHTML = .document\n    DoEvents\nEnd With\nSet elementONE = objHTML.getElementsByTagName(\"td\")\nDebug.Print TypeName(elementONE)\nDebug.Print elementONE.Length\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1445990660, "post_id": 33380255, "comment_id": 54555116, "body": "Because this is the same Range we are checking, it wont do the job for me. What it actually does is highlight all the ones that not equal to &quot;9900&quot;."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 1, "creation_date": 1446018800, "post_id": 33380255, "comment_id": 54563698, "body": "@Isu: <code>If Range(&quot;E&quot; &amp; i).Value &lt;&gt; &quot;9900&quot; And Range(&quot;E&quot; &amp; i).Value &lt;&gt; &quot;9100&quot; Then</code> behaves identical to <code>If Range(&quot;E&quot; &amp; i).Value &lt;&gt; &quot;9900&quot; Then   If Range(&quot;E&quot; &amp; i).Value &lt;&gt; &quot;9100&quot; Then</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1446090531, "post_id": 33380255, "comment_id": 54602590, "body": "@Isu -  Is it <code>&quot;9100&quot;</code> and <code>&quot;9900&quot;</code> or <code>9100</code> and <code>9900</code>? They are not the same thing."}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1446094748, "post_id": 33380255, "comment_id": 54603747, "body": "Actually I do not know the difference. They are in number format 9900 and 9100."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1445988201, "creation_date": 1445988201, "answer_id": 33380255, "question_id": 33380147, "link": "https://stackoverflow.com/questions/33380147/if-function-to-check-multiple-conditions-on-same-range/33380255#33380255", "title": "IF function to check multiple conditions on same range", "body": "<p>If you want to highlight it, if the value is neither 9900 nor 9100, then it's</p>\n\n<pre><code>If Range(\"E\" &amp; i).Value &lt;&gt; \"9900\" And Range(\"E\" &amp; i).Value &lt;&gt; \"9100\" Then\n</code></pre>\n\n<p>The other way around it's</p>\n\n<pre><code>If Range(\"E\" &amp; i).Value = \"9900\" Or Range(\"E\" &amp; i).Value = \"9100\" Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "is_accepted": false, "score": 0, "last_activity_date": 1445994625, "creation_date": 1445994625, "answer_id": 33381248, "question_id": 33380147, "link": "https://stackoverflow.com/questions/33380147/if-function-to-check-multiple-conditions-on-same-range/33381248#33381248", "title": "IF function to check multiple conditions on same range", "body": "<p>This is what I found,</p>\n\n<pre><code>If Range(\"E\" &amp; i).Value &lt;&gt; \"9900\" Then\n  If Range(\"E\" &amp; i).Value &lt;&gt; \"9100\" Then\n    Range(\"A\" &amp; i &amp; \":\" &amp; \"L\" &amp; i).Select\n        With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent2\n        .TintAndShade = 0.399975585192419\n        .PatternTintAndShade = 0\n        End With\n        With Selection.Font\n        .Color = -16711681\n        .TintAndShade = 0\n        End With\n    End If\n    End If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 265, "user_id": 1534035, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cbe937653af345a35eb303a976d1dee9?s=128&d=identicon&r=PG", "display_name": "Ashwith Ullal", "link": "https://stackoverflow.com/users/1534035/ashwith-ullal"}, "is_accepted": false, "score": -1, "last_activity_date": 1446010219, "creation_date": 1446010219, "answer_id": 33383558, "question_id": 33380147, "link": "https://stackoverflow.com/questions/33380147/if-function-to-check-multiple-conditions-on-same-range/33383558#33383558", "title": "IF function to check multiple conditions on same range", "body": "<pre><code>last_row = Application.Workbooks(file_name).Worksheets(\"ms\").Range(\"a65536\").End(xlUp).Row\n\n\nRange(\"A\" &amp; last_row &amp; \":\" &amp; \"L\" &amp; last_row).Select\n\n With Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent2\n    .TintAndShade = 0.399975585192419\n    .PatternTintAndShade = 0\n    End With\n    With Selection.Font\n    .Color = -16711681\n    .TintAndShade = 0\n    End With\n\n\n\nIf Range(\"E\" &amp; i).Value &lt;&gt; \"9900\" Or \"9100\" Then\nRange(\"A\" &amp; i &amp; \":\" &amp; \"L\" &amp; i).Select\n    With Selection.Interior\n    .Pattern = xlNone\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nEnd If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1446010219, "creation_date": 1445987650, "last_edit_date": 1445990798, "question_id": 33380147, "link": "https://stackoverflow.com/questions/33380147/if-function-to-check-multiple-conditions-on-same-range", "title": "IF function to check multiple conditions on same range", "body": "<p>I am trying to highlight cells depend on the cell value.</p>\n\n<p>If it is a single value I can do it with the IF function. I am trying to identify whether the value is either \"9900\" or \"\"9100\". Cam someone please explain me where I get this wrong? (I know it is the first line of the code)</p>\n\n<pre><code>If Range(\"E\" &amp; i).Value &lt;&gt; \"9900\" Or \"9100\" Then\n    Range(\"A\" &amp; i &amp; \":\" &amp; \"L\" &amp; i).Select\n        With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent2\n        .TintAndShade = 0.399975585192419\n        .PatternTintAndShade = 0\n        End With\n        With Selection.Font\n        .Color = -16711681\n        .TintAndShade = 0\n        End With\n    End If\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 698, "user_id": 3132781, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f5dc4628b15f2a17bd6c93c9074739ea?s=128&d=identicon&r=PG&f=1", "display_name": "ratmalwer", "link": "https://stackoverflow.com/users/3132781/ratmalwer"}, "edited": false, "score": 0, "creation_date": 1445986016, "post_id": 33379801, "comment_id": 54553538, "body": "I m not familiar with Excel but maybe that helps:     If ((&quot;E&quot; &amp; i).value &lt; 400 and (&quot;F&quot;&amp;i).value &lt; 400 ))  Then rows(i).Delete"}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "edited": false, "score": 0, "creation_date": 1445986636, "post_id": 33379905, "comment_id": 54553753, "body": "Can I just ask what <code>LR = ActiveSheet.Cells(ActiveSheet.Rows.Count, &quot;E&quot;).End(xlUp).Row</code> does? Also is column F also included in this code?"}, {"owner": {"reputation": 265, "user_id": 1534035, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cbe937653af345a35eb303a976d1dee9?s=128&d=identicon&r=PG", "display_name": "Ashwith Ullal", "link": "https://stackoverflow.com/users/1534035/ashwith-ullal"}, "edited": false, "score": 0, "creation_date": 1446010934, "post_id": 33379905, "comment_id": 54560637, "body": "it gets u the last element in column E"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "edited": false, "score": 1, "creation_date": 1446043154, "post_id": 33379905, "comment_id": 54579262, "body": "@user112947 if you are testing both rows for deletion, logic dictates that it doesn&#39;t matter which column you pick to find last row. Of course, if you picked the one that&#39;s longer, your loop is unnecessarily extended but the difference can&#39;t be that great given your chosen architecture. Also kind of amusing that you picked another answer when it was incorrect XD"}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 3, "last_activity_date": 1445986296, "creation_date": 1445986296, "answer_id": 33379905, "question_id": 33379801, "link": "https://stackoverflow.com/questions/33379801/deleting-rows-with-cells-of-certain-values/33379905#33379905", "title": "Deleting rows with cells of certain values", "body": "<pre><code>Sub workbook()\n\nDim LR As Long, i As Long\nLR = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"E\").End(xlUp).Row\n\nFor i = LR To 1 Step -1\n    If Range(\"E\" &amp; i).Value &lt; 400 And Range(\"F\" &amp; i).Value &lt; 400 Then Rows(i).Delete\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1445986368, "post_id": 33379908, "comment_id": 54553648, "body": "<code>LR = Range(&quot;E:F&quot; &amp; rows.Count).End(xlUp).Row</code> that&#39;s bad code XD"}, {"owner": {"reputation": 287, "user_id": 5458854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71d4ee178e2286b2d9017bdf26d2e889?s=128&d=identicon&r=PG&f=1", "display_name": "Louis. B", "link": "https://stackoverflow.com/users/5458854/louis-b"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1445986464, "post_id": 33379908, "comment_id": 54553689, "body": "I completely agree, I didn&#39;t even see that."}, {"owner": {"reputation": 287, "user_id": 5458854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71d4ee178e2286b2d9017bdf26d2e889?s=128&d=identicon&r=PG&f=1", "display_name": "Louis. B", "link": "https://stackoverflow.com/users/5458854/louis-b"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1445986606, "post_id": 33379908, "comment_id": 54553742, "body": "But col E and F may not have the same number of rows, in this case this is a way to get the highest without adding another if statement."}, {"owner": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "edited": false, "score": 0, "creation_date": 1445986798, "post_id": 33379908, "comment_id": 54553810, "body": "@Louis.B This is under the assumption column E and F have the same number of rows. The <code>EndIf</code> and <code>LR = Range(&quot;E:F&quot; &amp; rows.Count).End(xlUp).Row</code> give me an error when running."}, {"owner": {"reputation": 287, "user_id": 5458854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71d4ee178e2286b2d9017bdf26d2e889?s=128&d=identicon&r=PG&f=1", "display_name": "Louis. B", "link": "https://stackoverflow.com/users/5458854/louis-b"}, "edited": false, "score": 0, "creation_date": 1445989587, "post_id": 33379908, "comment_id": 54554771, "body": "Sorry about the delay, I just edit my answer, <code>EndIf</code> should be <code>End If</code> and if they have the same number of rows, you can then write : <code>LR = Range(&quot;E&quot; &amp; rows.Count).End(xlUp).Row</code>. It should run like that."}, {"owner": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "edited": false, "score": 0, "creation_date": 1445992329, "post_id": 33379908, "comment_id": 54555579, "body": "@Louis.B Thanks for your reply. How come column F is not included in <code>LR = Range(&quot;E&quot; &amp; rows.Count).End(xlUp).Row</code> though?"}, {"owner": {"reputation": 287, "user_id": 5458854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71d4ee178e2286b2d9017bdf26d2e889?s=128&d=identicon&r=PG&f=1", "display_name": "Louis. B", "link": "https://stackoverflow.com/users/5458854/louis-b"}, "reply_to_user": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "edited": false, "score": 1, "creation_date": 1445994523, "post_id": 33379908, "comment_id": 54556192, "body": "@user112947, what you want to do is to count the number of rows, however you need to specify to excel in which column you want to count the rows. As long as you are sure that column F and E have the same number of rows, you could use either. If you&#39;re not sure, the best way to ensure getting all rows would be to count the number of rows in both columns separately and then take the highest."}], "tags": [], "owner": {"reputation": 287, "user_id": 5458854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71d4ee178e2286b2d9017bdf26d2e889?s=128&d=identicon&r=PG&f=1", "display_name": "Louis. B", "link": "https://stackoverflow.com/users/5458854/louis-b"}, "is_accepted": true, "score": 3, "last_activity_date": 1445989606, "last_edit_date": 1445989606, "creation_date": 1445986304, "answer_id": 33379908, "question_id": 33379801, "link": "https://stackoverflow.com/questions/33379801/deleting-rows-with-cells-of-certain-values/33379908#33379908", "title": "Deleting rows with cells of certain values", "body": "<p>If you want to delete rows that have value greater than 400 either in column \"E\" or \"F\" you should try something like :</p>\n\n<pre><code>Sub workbook()\n\n  Dim LR As Long, i As Long\n  LR = Range(\"E\" &amp; rows.Count).End(xlUp).Row\n  For i = LR To 1 Step -1\n      If Range(\"E\" &amp; i).value &lt; 400 or Range(\"F\" &amp; i).value &lt; 400 Then \n          rows(i).Delete\n      End If\n  Next i\n\nEnd Sub\n</code></pre>\n\n<p>If you require both columns to have values greater than 400, replace <code>or</code> by <code>and</code>.</p>\n"}], "owner": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 33379908, "answer_count": 2, "score": 2, "last_activity_date": 1446023057, "creation_date": 1445985812, "last_edit_date": 1446023057, "question_id": 33379801, "link": "https://stackoverflow.com/questions/33379801/deleting-rows-with-cells-of-certain-values", "title": "Deleting rows with cells of certain values", "body": "<pre><code>Sub workbook()\n  Dim LR As Long, i As Long\n  LR = Range(\"E:F\" &amp; rows.Count).End(xlUp).Row\n  For i = LR To 1 Step -1\n  If (Range(\"E:F\" &amp; i).value &lt; 400) Then rows(i).Delete\n  Next i\nEnd Sub\n</code></pre>\n\n<p>I am trying to delete rows in columns E and F on my excel worksheet that have values less than 400. </p>\n\n<p>However, the Range function does not seem to work when selecting two columns at a time (without a specific range such as E1:F10). </p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 5685, "user_id": 5240004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j8eFV.jpg?s=128&g=1", "display_name": "theB", "link": "https://stackoverflow.com/users/5240004/theb"}, "edited": false, "score": 0, "creation_date": 1445986364, "post_id": 33379799, "comment_id": 54553647, "body": "While I was adjusting the indenting of the code I noticed that in the first block you have <code>Me.Schooltxt.Tag = .Fields(&quot;School_ID&quot;)</code> and the debug line you have <code>Me.Schooltxt = .Fields(&quot;School_Name&quot;)</code>. Which is correct?"}, {"owner": {"reputation": 87, "user_id": 4479525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9784316c3c65f14fcb719d9721d66800?s=128&d=identicon&r=PG&f=1", "display_name": "KraZy", "link": "https://stackoverflow.com/users/4479525/krazy"}, "reply_to_user": {"reputation": 5685, "user_id": 5240004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j8eFV.jpg?s=128&g=1", "display_name": "theB", "link": "https://stackoverflow.com/users/5240004/theb"}, "edited": false, "score": 0, "creation_date": 1445992649, "post_id": 33379799, "comment_id": 54555666, "body": "Yes, I was using the tag to store ID for the purpose of update."}, {"owner": {"reputation": 5685, "user_id": 5240004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j8eFV.jpg?s=128&g=1", "display_name": "theB", "link": "https://stackoverflow.com/users/5240004/theb"}, "edited": false, "score": 0, "creation_date": 1445994911, "post_id": 33379799, "comment_id": 54556285, "body": "Apologies, I read <code>School_ID</code> and <code>School_Name</code> as the same word. That actually makes perfect sense."}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 4479525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9784316c3c65f14fcb719d9721d66800?s=128&d=identicon&r=PG&f=1", "display_name": "KraZy", "link": "https://stackoverflow.com/users/4479525/krazy"}, "is_accepted": true, "score": 1, "last_activity_date": 1446006607, "creation_date": 1446006607, "answer_id": 33382935, "question_id": 33379799, "link": "https://stackoverflow.com/questions/33379799/run-time-error-the-value-you-entered-isnt-valid-for-this-field/33382935#33382935", "title": "Run-time error: The value you entered isn&#39;t valid for this field", "body": "<p>I figured that after the each update, I am losing the position of record. I added the following statement after update and Requery </p>\n\n<pre><code>Me.frmschoolsub.Form.Recordset.MoveFirst\n</code></pre>\n\n<p>Following is the code snippet.</p>\n\n<pre><code>    Else\n        CurrentDb.Execute \"Update School \" &amp; _\n                \" SET School_Name ='\" &amp; Me.Schooltxt &amp; \"'\" &amp; _\n                \", Description ='\" &amp; Me.Desctxt &amp; \"'\" &amp; _\n                \", Dean ='\" &amp; Me.Deantxt &amp; \"'\" &amp; _\n                \", Associate_Dean='\" &amp; Me.Adeantxt &amp; \"'\" &amp; _\n                \"where School_ID=\" &amp; Me.Schooltxt.Tag\n\n\n    End If\n    'Clear the Fields\n    cmdClr_Click\n    'Refresh the table\n    frmschoolsub.Form.Requery\n    Me.frmschoolsub.Form.Recordset.MoveFirst\n</code></pre>\n\n<p>This fixed the issue.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7922745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/398cac00d920a30ef4a2db06dd70b305?s=128&d=identicon&r=PG", "display_name": "Cennamanesh", "link": "https://stackoverflow.com/users/7922745/cennamanesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1493176530, "last_edit_date": 1493176530, "creation_date": 1493173941, "answer_id": 43624019, "question_id": 33379799, "link": "https://stackoverflow.com/questions/33379799/run-time-error-the-value-you-entered-isnt-valid-for-this-field/43624019#43624019", "title": "Run-time error: The value you entered isn&#39;t valid for this field", "body": "<p>This error is happening that a form field cannot be referenced to a textbox like you did.</p>\n\n<p>You can do it as below.</p>\n\n<pre><code>With Me.frmschoolsub.Form.Recordset\n     Me.Schooltxt = Forms![&lt;&lt;if you have main form  &gt;&gt;]![frmschoolsub].form![School_Name]\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4479525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9784316c3c65f14fcb719d9721d66800?s=128&d=identicon&r=PG&f=1", "display_name": "KraZy", "link": "https://stackoverflow.com/users/4479525/krazy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "accepted_answer_id": 33382935, "answer_count": 2, "score": 0, "last_activity_date": 1493176530, "creation_date": 1445985786, "last_edit_date": 1445986264, "question_id": 33379799, "link": "https://stackoverflow.com/questions/33379799/run-time-error-the-value-you-entered-isnt-valid-for-this-field", "title": "Run-time error: The value you entered isn&#39;t valid for this field", "body": "<p>I am trying to update a record using Subform. When I update the first time it updates properly but when I try to update the same record again I am getting the error:</p>\n\n<blockquote>\n  <p>Run-time error '-2147352567 (80020009)': The value you entered isn't valid for this field </p>\n</blockquote>\n\n<p>The following is the form.</p>\n\n<p><img src=\"https://i.stack.imgur.com/gCXFw.jpg\" alt=\"Form\"></p>\n\n<p>When I click edit, the information from the selected record is populated into the respective text-boxes. Once I update the information and click update, the record gets successfully updated for the first time.</p>\n\n<p>When I try to update the same record again I get the mentioned error.</p>\n\n<p><img src=\"https://i.stack.imgur.com/fhsWT.jpg\" alt=\"Error\"></p>\n\n<p>Here is the VB script that runs on clicking edit.</p>\n\n<pre><code>Private Sub cmdEdit_Click()\n    'Check if data exists in the list\n    If Not (Me.frmschoolsub.Form.Recordset.EOF And Me.frmschoolsub.Form.Recordset.BOF) Then\n        'get data to text box control\n        With Me.frmschoolsub.Form.Recordset\n            Me.Schooltxt = .Fields(\"School_Name\")\n            Me.Desctxt = .Fields(\"Description\")\n            Me.Deantxt = .Fields(\"Dean\")\n            Me.Adeantxt = .Fields(\"Associate_Dean\")\n            'store id of student in tag\n            Me.Schooltxt.Tag = .Fields(\"School_ID\")\n            'change caption of button to update\n            Me.cmdAdd.Caption = \"Update\"\n            Me.cmdEdit.Enabled = False\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>When I click on Debug it highlights the following line.</p>\n\n<pre><code>Me.Schooltxt = .Fields(\"School_Name\")\n</code></pre>\n\n<p>Can you help me in identifying what is the issue here.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3932, "user_id": 1373484, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b84de825c3ec2af80862933da919d4f9?s=128&d=identicon&r=PG", "display_name": "Mat Richardson", "link": "https://stackoverflow.com/users/1373484/mat-richardson"}, "edited": false, "score": 0, "creation_date": 1445984637, "post_id": 33379436, "comment_id": 54552991, "body": "Easiest way to do this would be by making a pivot table using your data."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445985343, "post_id": 33379436, "comment_id": 54553276, "body": "Are the duplicate rows always consecutive? Or can they be mixed between other rows?"}], "answers": [{"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1446148128, "post_id": 33380149, "comment_id": 54635915, "body": "@S.Mac Please let me know if this worked out for you. If you need help, I&#39;m here."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 0, "last_activity_date": 1445995660, "last_edit_date": 1445995660, "creation_date": 1445987656, "answer_id": 33380149, "question_id": 33379436, "link": "https://stackoverflow.com/questions/33379436/adding-a-column-of-data-table-if-rows-match/33380149#33380149", "title": "Adding a Column of Data Table if Rows Match", "body": "<p>Place the following routine in a standard code module. Then run it with the data sheet active.</p>\n\n<pre><code>Sub Condense()\n    Dim c&amp;, i&amp;, j&amp;, k&amp;, m&amp;, cols&amp;, v, w, bMatch As Boolean, r As Range\n    Set r = [a2:e6]\n    v = r.Resize(r.Rows.Count + 1)\n    cols = UBound(v, 2)\n    ReDim w(1 To UBound(v), 1 To cols)\n    For i = 2 To UBound(v)\n        k = i - 1\n        bMatch = True\n        For j = 1 To cols - 1\n            If v(i, j) &lt;&gt; v(k, j) Then\n                bMatch = False: Exit For\n            End If\n        Next\n        If bMatch Then\n            m = k\n        Else\n            c = c + 1\n            For j = 1 To cols\n                w(c, j) = v(k, j)\n            Next\n            If m Then\n                w(c, cols) = Application.Average(Range(r(m, cols), r(k, cols)))\n            End If\n            m = 0\n        End If\n    Next\n    r.Resize(UBound(w), cols).Offset(, cols + 1) = w\nEnd Sub\n</code></pre>\n\n<p>Note: you can edit the location of the data by adjusting the range on line #2.</p>\n\n<p>Note: a condensed copy of the data with the averaging done will be written to the right of the data range.</p>\n"}], "owner": {"reputation": 13, "user_id": 5416119, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/067aebec4549392df1e64c1874f74b75?s=128&d=identicon&r=PG&f=1", "display_name": "S. Mac", "link": "https://stackoverflow.com/users/5416119/s-mac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445995660, "creation_date": 1445984089, "last_edit_date": 1445984696, "question_id": 33379436, "link": "https://stackoverflow.com/questions/33379436/adding-a-column-of-data-table-if-rows-match", "title": "Adding a Column of Data Table if Rows Match", "body": "<p>I have a data table of 5 different columns. I would like to get the average of one of the columns if the 4 previous columns match one another for that row. For example, if rows 1-3 match, I would like to get the average of column 5 for rows 1-3. The specific values in the columns will be changing so I can't use a VLOOKUP / INDEX and MATCH because I do not necessarily know what I am looking for. I would ideally like an output table that lists the averages and the values that these averages correspond too. Below is an oversimplified example -</p>\n\n<p>Raw Data</p>\n\n<p>New Jersey  Dec  Red    Soccer   2\nNew York    Dec  Blue   Hockey   5\nNew York    Dec  Blue   Hockey   1\nMaine       Mar  Blue   Soccer   6\nMaryland    Feb  Red    Soccer   9</p>\n\n<p>Would result in</p>\n\n<p>New Jersey  Dec  Red    Soccer   2\nNew York    Dec  Blue   Hockey   3\nMaine       Mar  Blue   Soccer   6\nMaryland    Feb  Red    Soccer   9</p>\n"}, {"tags": ["macos", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5495749, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205126682514598/picture?type=large", "display_name": "Matthew Schwabenbauer", "link": "https://stackoverflow.com/users/5495749/matthew-schwabenbauer"}, "edited": false, "score": 0, "creation_date": 1446042998, "post_id": 33380058, "comment_id": 54579151, "body": "Tsolina, I put in those two lines of code and I am now receiving a run-time error &#39;76&#39;"}], "tags": [], "owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "is_accepted": false, "score": 0, "last_activity_date": 1445987108, "creation_date": 1445987108, "answer_id": 33380058, "question_id": 33379348, "link": "https://stackoverflow.com/questions/33379348/capitalization-issue-with-workbooks-open-using-vba-in-excel-2016/33380058#33380058", "title": "Capitalization issue with Workbooks.Open using VBA in Excel 2016", "body": "<p>this seems to be missing</p>\n\n<pre><code>' Change drive/directory to MyPath.\nChDrive MyPath\nChDir MyPath\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5495749, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205126682514598/picture?type=large", "display_name": "Matthew Schwabenbauer", "link": "https://stackoverflow.com/users/5495749/matthew-schwabenbauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 540, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1465456432, "creation_date": 1445983710, "question_id": 33379348, "link": "https://stackoverflow.com/questions/33379348/capitalization-issue-with-workbooks-open-using-vba-in-excel-2016", "title": "Capitalization issue with Workbooks.Open using VBA in Excel 2016", "body": "<p>I am trying to write code that will prompt the user for a .xlsx file path and then open that workbook. Eventually, I will want VBA to copy data from the workbook it is opening. But, I am not able to get VBA to open a workbook.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    Sub Select_File_Or_Files_Mac()\nDim MyPath As String\nDim MyScript As String\nDim MyFiles As String\nDim MySplit As Variant\nDim N As Long\nDim Fname As String\nDim mybook As Workbook\n\nOn Error Resume Next\nMyPath = MacScript(\"return (path to documents folder) as String\")\n'Or use MyPath = \"Macintosh HD:Users:Ron:Desktop:TestFolder:\"\n\n' In the following statement, change true to false in the line \"multiple\n' selections allowed true\" if you do not want to be able to select more\n' than one file. Additionally, if you want to filter for multiple files, change\n' {\"\"com.microsoft.Excel.xls\"\"} to\n' {\"\"com.microsoft.excel.xls\"\",\"\"public.comma-separated-values-text\"\"}\n' if you want to filter on xls and csv files, for example.\nMyScript = _\n\"set applescript's text item delimiters to \"\",\"\" \" &amp; vbNewLine &amp; _\n           \"set theFiles to (choose file of type \" &amp; _\n         \" {\"\"org.openxmlformats.spreadsheetml.sheet\"\"} \" &amp; _\n           \"with prompt \"\"Please select a file or files\"\" default location alias \"\"\" &amp; _\n           MyPath &amp; \"\"\" multiple selections allowed true) as string\" &amp; vbNewLine &amp; _\n           \"set applescript's text item delimiters to \"\"\"\" \" &amp; vbNewLine &amp; _\n           \"return theFiles\"\n\nMyFiles = MacScript(MyScript)\nOn Error GoTo 0\n\nIf MyFiles &lt;&gt; \"\" Then\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    MySplit = Split(MyFiles, \",\")\n    For N = LBound(MySplit) To UBound(MySplit)\n\n        ' Get the file name only and test to see if it is open.\n        Fname = Right(MySplit(N), Len(MySplit(N)) - InStrRev(MySplit(N), Application.PathSeparator, , 1))\n        If bIsBookOpen(Fname) = False Then\n\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MySplit(N))\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n                MsgBox \"You open this file : \" &amp; MySplit(N) &amp; vbNewLine &amp; _\n                       \"And after you press OK it will be closed\" &amp; vbNewLine &amp; _\n                       \"without saving, replace this line with your own code.\"\n                mybook.Close SaveChanges:=False\n            End If\n        Else\n            MsgBox \"We skipped this file : \" &amp; MySplit(N) &amp; \" because it Is already open.\"\n        End If\n    Next N\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd If\n\n    Cells(1, 1) = MyFiles\n\n    Set mybook = Workbooks.Open(MyFiles)\n\n    End Sub\n\n    Function bIsBookOpen(ByRef szBookName As String) As Boolean\n    ' Contributed by Rob Bovey\nOn Error Resume Next\nbIsBookOpen = Not (Application.Workbooks(szBookName) Is Nothing)\n    End Function\n</code></pre>\n\n<p>When I run the code, I get a 1004 run-time error saying the file could not be found with the file path in all caps. This is odd as the user has to select the file in a pop up window so the file HAS to be there. I also have the code write the file path to cell 1,1 in the spreadsheet. Whats weird is the file path the program prints has the proper casing as the actual file path, but the error is in all caps. I think the issue is that unix is case sensitive and I am running this on OSX. why is Excel putting the file path in all caps? This also happens if I hard code the file path to Workbooks.Open(direct file path here)</p>\n\n<p>I am using code I found at <a href=\"https://msdn.microsoft.com/en-us/library/office/hh710200(v=office.14).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/hh710200(v=office.14).aspx</a></p>\n"}, {"tags": ["excel", "ms-access", "vba", "range"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4942330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7268b4363552c2dd1e3d6ff30391db44?s=128&d=identicon&r=PG&f=1", "display_name": "mak&#233;man", "link": "https://stackoverflow.com/users/4942330/mak%c3%a9man"}, "edited": false, "score": 0, "creation_date": 1445983689, "post_id": 33379212, "comment_id": 54552631, "body": "Thank you, it is now working. So was the error caused by the SELECT?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 25, "user_id": 4942330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7268b4363552c2dd1e3d6ff30391db44?s=128&d=identicon&r=PG&f=1", "display_name": "mak&#233;man", "link": "https://stackoverflow.com/users/4942330/mak%c3%a9man"}, "edited": false, "score": 0, "creation_date": 1445983881, "post_id": 33379212, "comment_id": 54552708, "body": "@mak&#233;man A lot of discussions have taken place on SO about the <code>Select</code> method. There is almost <i>unanimity</i> that it has to be avoided in VBA code as much as possible, because it fails for many reasons (the most common one being that the worksheet containing the range you want to select, is not active). Moreover the code is faster when working directly on the range, without select :)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 25, "user_id": 4942330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7268b4363552c2dd1e3d6ff30391db44?s=128&d=identicon&r=PG&f=1", "display_name": "mak&#233;man", "link": "https://stackoverflow.com/users/4942330/mak%c3%a9man"}, "edited": false, "score": 0, "creation_date": 1445984006, "post_id": 33379212, "comment_id": 54552759, "body": "I guess that much of the code that we see using <code>Select</code> is derived somehow from the macro recorder, but even though, it is better to edit that code and remove the use of this method.."}, {"owner": {"reputation": 25, "user_id": 4942330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7268b4363552c2dd1e3d6ff30391db44?s=128&d=identicon&r=PG&f=1", "display_name": "mak&#233;man", "link": "https://stackoverflow.com/users/4942330/mak%c3%a9man"}, "edited": false, "score": 0, "creation_date": 1446048882, "post_id": 33379212, "comment_id": 54583618, "body": "I am having a similiar problem with this line..     RowNo = Selection.Find(What:=&quot;SummaryType&quot;, After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Row  The error I get is Run-Time Error 91. Once again it happens on the second loop. Is the selection getting the best of me again?"}, {"owner": {"reputation": 25, "user_id": 4942330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7268b4363552c2dd1e3d6ff30391db44?s=128&d=identicon&r=PG&f=1", "display_name": "mak&#233;man", "link": "https://stackoverflow.com/users/4942330/mak%c3%a9man"}, "edited": false, "score": 0, "creation_date": 1446058979, "post_id": 33379212, "comment_id": 54590343, "body": "I tried replacing &#39;Selection&#39; with &#39;xlSheet.Cells&#39;. Now I am getting a Type Mismatch error."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 25, "user_id": 4942330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7268b4363552c2dd1e3d6ff30391db44?s=128&d=identicon&r=PG&f=1", "display_name": "mak&#233;man", "link": "https://stackoverflow.com/users/4942330/mak%c3%a9man"}, "edited": false, "score": 0, "creation_date": 1446063355, "post_id": 33379212, "comment_id": 54592846, "body": "@mak&#233;man I cannot tell the error because I dont see where this is in your code. but as a first guess, I&#39;d say the trouble comes from <code>LookIn:=xlFormulas</code>. Try the search by <code>xlValues</code> to verify that everything else is working ok. (I prefer the second version of course, not the one using Selection ;) )"}, {"owner": {"reputation": 25, "user_id": 4942330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7268b4363552c2dd1e3d6ff30391db44?s=128&d=identicon&r=PG&f=1", "display_name": "mak&#233;man", "link": "https://stackoverflow.com/users/4942330/mak%c3%a9man"}, "edited": false, "score": 0, "creation_date": 1446069741, "post_id": 33379212, "comment_id": 54596151, "body": "Sorry for the confusion, I added in this piece after my initial question. I have the line of code inside the &#39;With xlSheet1&#39;. I realized that a static range was not going to work since not all of my reports have the same number of records. So now I am trying to grab the row number where &quot;Summary Type&quot; appears, then use that value to set the range for formatting.   I gave xlValues a shot but no luck. Still getting Type Mismatch. I appreciate the tip though."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1445983011, "creation_date": 1445983011, "answer_id": 33379212, "question_id": 33379091, "link": "https://stackoverflow.com/questions/33379091/formatting-excel-through-access-vba-range-application-object-defined-error/33379212#33379212", "title": "Formatting Excel through Access VBA - Range Application/Object Defined Error", "body": "<p>1) avoid using select whenever you can. It fails very often, especially when the sheet is not active..</p>\n\n<p>2) Use the With statement correctly:</p>\n\n<pre><code>With xlSheet1\n   .Columns(\"A\").Delete Shift:=xlToLeft ' &lt;~~~ you dont need select\n   .Rows(1).Delete Shift:=xlUp ' &lt;~~~ you dont need select\n\n   .Range(\"A1:J1\").Interior.Color = RGB(191, 191, 191)\n   .Range(\"A1:J1\").Borders.Weight = xlThin\n   .Range(\"A1:J100\").Font.Name = \"Calibri (Body)\"\n   .Range(\"A1:J100\").Font.Size = 11\n   .Range(\"A1:J1\").HorizontalAlignment = xlCenter\n   .Range(\"A12:F12\").Interior.Color = RGB(191, 191, 191)\n   .Range(\"A12:F12\").Borders.Weight = xlThin\n   .Range(\"A12:F12\").HorizontalAlignment = xlCenter\n   .Range(\"A1:J100\").Cells.Columns.AutoFit\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1445983299, "creation_date": 1445983299, "answer_id": 33379267, "question_id": 33379091, "link": "https://stackoverflow.com/questions/33379091/formatting-excel-through-access-vba-range-application-object-defined-error/33379267#33379267", "title": "Formatting Excel through Access VBA - Range Application/Object Defined Error", "body": "<p>EDIT - @A.S.H. beat me to it...</p>\n\n<pre><code>Dim xl As Excel.Application\nDim xlBook As Excel.Workbook\nDim xlSheet1 As Excel.Worksheet\n\noutputFileName = \"C:\\Users\\UserID\\Desktop\\Reports\\\" &amp; tblData &amp; \".xls\"\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n                          \"tbl_Report\", outputFileName, True\n\nSet xl = New Excel.Application\nSet xlBook = xl.Workbooks.Open(outputFileName)\nxl.Visible = True\n\nSet xlSheet1 = xlBook.Worksheets(1)\n\nWith xlSheet1\n\n    .Range(\"A:A\").Delete Shift:=xlToLeft\n    .Range(\"1:1\").Delete Shift:=xlUp\n\n    With .Range(\"A1:J1\")\n        .Interior.Color = RGB(191, 191, 191)\n        .Borders.Weight = xlThin\n        .HorizontalAlignment = xlCenter\n    End with\n\n    With .Range(\"A1:J100\")\n        .Font.Name = \"Calibri (Body)\"\n        .Font.Size = 11\n        .Cells.Columns.AutoFit\n    End with\n\n    With .Range(\"A12:F12\")\n        .Interior.Color = RGB(191, 191, 191)\n        .Borders.Weight = xlThin\n        .HorizontalAlignment = xlCenter\n    End with\n\n\nEnd With    \n\nxlBook.Close True 'save changes\n\nSet xlSheet1 = Nothing\nSet xlBook = Nothing\nSet xl = Nothing\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4942330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7268b4363552c2dd1e3d6ff30391db44?s=128&d=identicon&r=PG&f=1", "display_name": "mak&#233;man", "link": "https://stackoverflow.com/users/4942330/mak%c3%a9man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "accepted_answer_id": 33379267, "answer_count": 2, "score": 1, "last_activity_date": 1594643358, "creation_date": 1445982481, "last_edit_date": 1594643358, "question_id": 33379091, "link": "https://stackoverflow.com/questions/33379091/formatting-excel-through-access-vba-range-application-object-defined-error", "title": "Formatting Excel through Access VBA - Range Application/Object Defined Error", "body": "<p>My issue occurs on the following line:</p>\n\n<pre><code>Worksheets(1).Range(\"A:A\").Select\n</code></pre>\n\n<p>Background: I have a process that loads a text file, splits it into numerous other tables, then brings some of those pieces together as new tables, exports them to excel, and does some formatting. </p>\n\n<p>I use a 'For Each' loop to go through my access tables. When certain tables are identified some other code runs that creates new tables (code not shown). Once a new table is created is gets exported to excel and formatted. This is where the error occurs. The first loop works fine, it is on the second loop that the code goes to error when selecting the column range. </p>\n\n<p>I have done some searching on this error, it looks like the cause is often how the worksheets are referenced. I have a number of tools that use this sort of process so it would be great to finally understand the cause.</p>\n\n<p>Code: </p>\n\n<pre><code>Dim xl                           As Excel.Application\nDim xlBook                       As Excel.Workbook\nDim xlSheet1                     As Excel.Worksheet\n\noutputFileName = \"C:\\Users\\UserID\\Desktop\\Reports\\\" &amp; tblData &amp; \".xls\"\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"tbl_Report\",     outputFileName, True\n\nSet xl = New Excel.Application\nSet xlBook = xl.Workbooks.Open(outputFileName)\nxl.Visible = True\n\nSet xlSheet1 = xlBook.Worksheets(1)\n\nWith xlSheet1\nWorksheets(1).Range(\"A:A\").Select\nSelection.Delete Shift:=xlToLeft\nWorksheets(1).Range(\"1:1\").Select\nSelection.Delete Shift:=xlUp\n\nWorksheets(1).Range(\"A1:J1\").Interior.Color = RGB(191, 191, 191)\nWorksheets(1).Range(\"A1:J1\").Borders.Weight = xlThin\nWorksheets(1).Range(\"A1:J100\").Font.Name = \"Calibri (Body)\"\nWorksheets(1).Range(\"A1:J100\").Font.Size = 11\nWorksheets(1).Range(\"A1:J1\").HorizontalAlignment = xlCenter\nWorksheets(1).Range(\"A12:F12\").Interior.Color = RGB(191, 191, 191)\nWorksheets(1).Range(\"A12:F12\").Borders.Weight = xlThin\nWorksheets(1).Range(\"A12:F12\").HorizontalAlignment = xlCenter\nWorksheets(1).Range(\"A1:J100\").Cells.Columns.AutoFit\n\nxl.DisplayAlerts = False\n\nxl.ActiveWorkbook.Save\nxl.ActiveWorkbook.Close\n\nxl.DisplayAlerts = True\n\nSet xlSheet1 = Nothing\nSet xlBook = Nothing\nSet xl = Nothing\n\nEnd With\n</code></pre>\n"}, {"tags": ["xml", "oracle", "excel", "vba"], "comments": [{"owner": {"reputation": 160176, "user_id": 266304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdb6217d08dcea7d67ff75f5f255081?s=128&d=identicon&r=PG", "display_name": "Alex Poole", "link": "https://stackoverflow.com/users/266304/alex-poole"}, "edited": false, "score": 0, "creation_date": 1445989049, "post_id": 33379081, "comment_id": 54554611, "body": "This is ringing a bell but I can&#39;t find it... but I have a feeling it was either the SQL Developer version or Java/driver version. Are you using the latest version of SQL Devloper?"}, {"owner": {"reputation": 11, "user_id": 5413056, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yhHtD-3K51k/AAAAAAAAAAI/AAAAAAAABKk/4XEoK0rMkvg/photo.jpg?sz=128", "display_name": "Stalin Daniel - Consultant", "link": "https://stackoverflow.com/users/5413056/stalin-daniel-consultant"}, "reply_to_user": {"reputation": 160176, "user_id": 266304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdb6217d08dcea7d67ff75f5f255081?s=128&d=identicon&r=PG", "display_name": "Alex Poole", "link": "https://stackoverflow.com/users/266304/alex-poole"}, "edited": false, "score": 0, "creation_date": 1446146829, "post_id": 33379081, "comment_id": 54635197, "body": "SQL developer Version 3.1.07"}], "owner": {"reputation": 11, "user_id": 5413056, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yhHtD-3K51k/AAAAAAAAAAI/AAAAAAAABKk/4XEoK0rMkvg/photo.jpg?sz=128", "display_name": "Stalin Daniel - Consultant", "link": "https://stackoverflow.com/users/5413056/stalin-daniel-consultant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1445984768, "creation_date": 1445982435, "last_edit_date": 1531161705, "question_id": 33379081, "link": "https://stackoverflow.com/questions/33379081/sql-developer-exporting-a-xml-from-particular-column-in-oracle-db-to-excel-she", "title": "Sql Developer : Exporting a XML from particular column in oracle db to excel sheet truncates some of the XML lines in the excel sheet", "body": "<p><a href=\"http://i.stack.imgur.com/pgP2T.png\" rel=\"nofollow\">This</a> screenshot shows the data retrieved.</p>\n\n<p>I thought it was a problem with the excel sheet which cannot handle the XML size, but after I tried to paste a single xml manually to the excel sheet worked out.But when I try to do the same thing for hundreds of XML files using exporting option in sql developer to excel sheet truncates some of the lines.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5495623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77245a028665af9c3ca77d12c33c733e?s=128&d=identicon&r=PG&f=1", "display_name": "instanceoftime", "link": "https://stackoverflow.com/users/5495623/instanceoftime"}, "edited": false, "score": 0, "creation_date": 1446093689, "post_id": 33379036, "comment_id": 54603460, "body": "ok, yes I understand what you have said. I entered a text and it crashed so I threw in the &quot;val&quot; as a safety. I will edit it to your recommendation. What would declaring it an integer accomplish(if anything)? How could I &quot;ignore&quot; a minus sign if the user was to mistakenly put one in?"}, {"owner": {"reputation": 1731, "user_id": 496236, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/1JUEQ.jpg?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/496236/wolfie"}, "reply_to_user": {"reputation": 3, "user_id": 5495623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77245a028665af9c3ca77d12c33c733e?s=128&d=identicon&r=PG&f=1", "display_name": "instanceoftime", "link": "https://stackoverflow.com/users/5495623/instanceoftime"}, "edited": false, "score": 0, "creation_date": 1446128984, "post_id": 33379036, "comment_id": 54623627, "body": "<code>Response = Val(&quot;0&quot; &amp; Replace(txtItemNumber.Text,&quot;-&quot;,&quot;&quot;))</code>   You already DIM Response as a LONG at the top of your code!"}, {"owner": {"reputation": 3, "user_id": 5495623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77245a028665af9c3ca77d12c33c733e?s=128&d=identicon&r=PG&f=1", "display_name": "instanceoftime", "link": "https://stackoverflow.com/users/5495623/instanceoftime"}, "edited": false, "score": 0, "creation_date": 1446230456, "post_id": 33379036, "comment_id": 54673849, "body": "Just wondering if I should change it to integer instead of long and if that would help in error proofing?"}], "tags": [], "owner": {"reputation": 1731, "user_id": 496236, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/1JUEQ.jpg?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/496236/wolfie"}, "is_accepted": false, "score": 0, "last_activity_date": 1445982197, "creation_date": 1445982197, "answer_id": 33379036, "question_id": 33378696, "link": "https://stackoverflow.com/questions/33378696/vba-fill-a-listbox-will-all-occurrences/33379036#33379036", "title": "VBA fill a listbox will all occurrences", "body": "<p>Just curious, if you define Response as a long, why are you using val(Response) in the while loop?  And if its a long, then <code>Response = txtItemNumber.Text</code> could throw an error by potentially trying to store an alphanumeric string in a numeric only long.</p>\n\n<p>Since you dim Response as a long, use this instead...</p>\n\n<pre><code>Response = Val(\"0\" &amp; txtItemNumber.Text)\n</code></pre>\n\n<p>This assumes no negative numbers.  By pre-pending the zero you don't change the value of the number (0100 is still 100) but you also handle \"0abc\" issues if the user enters text.  It will return 0 if the user enters \"abc\" and your solution checks for 0 (false) already.  If the user enters \"100\" it converts \"0100\" to 100 and your solution then moves on with that value.  It will fail if the user enters \"-100\" since \"0-100\" isn't 100.</p>\n\n<p>Now, since we are using a long, remove all references to Val(Response) elsewhere.  This will reduce the type conversions inside the loop that searches for the cell value.  As you have it, each time through the loop it converts Response from a long to a string then to a long and then does the UNTIL compare.  And it does that 35000 times.</p>\n\n<p>By converting it using Val before the loop, it now does the string to long conversion ONCE instead of all 35000 times it loops going through the cells.  Its a minor change that could speed it up a bit.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5495623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77245a028665af9c3ca77d12c33c733e?s=128&d=identicon&r=PG&f=1", "display_name": "instanceoftime", "link": "https://stackoverflow.com/users/5495623/instanceoftime"}, "edited": false, "score": 0, "creation_date": 1446094123, "post_id": 33381375, "comment_id": 54603585, "body": "Holy cow, I have to digest this and try it out tomorrow. [The purpose behind the frame] Rather than use a msgbox for the user to input the search item, I have a textbox on the form. For visual purposed only, I have the results (among other buttons) on a frame that is hidden until the user does the search."}, {"owner": {"reputation": 3, "user_id": 5495623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77245a028665af9c3ca77d12c33c733e?s=128&d=identicon&r=PG&f=1", "display_name": "instanceoftime", "link": "https://stackoverflow.com/users/5495623/instanceoftime"}, "edited": false, "score": 0, "creation_date": 1446231384, "post_id": 33381375, "comment_id": 54674314, "body": "OMG that is SO much faster. Thanks RickXI"}, {"owner": {"reputation": 3, "user_id": 5495623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77245a028665af9c3ca77d12c33c733e?s=128&d=identicon&r=PG&f=1", "display_name": "instanceoftime", "link": "https://stackoverflow.com/users/5495623/instanceoftime"}, "edited": false, "score": 0, "creation_date": 1446237218, "post_id": 33381375, "comment_id": 54677127, "body": "and yes, correct, that frame.visible wasnt doing anything lol"}], "tags": [], "owner": {"reputation": 16, "user_id": 5496068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3d5389501bd87ceeba31afc49d8d76?s=128&d=identicon&r=PG&f=1", "display_name": "RickXl", "link": "https://stackoverflow.com/users/5496068/rickxl"}, "is_accepted": true, "score": 0, "last_activity_date": 1445995605, "creation_date": 1445995605, "answer_id": 33381375, "question_id": 33378696, "link": "https://stackoverflow.com/questions/33378696/vba-fill-a-listbox-will-all-occurrences/33381375#33381375", "title": "VBA fill a listbox will all occurrences", "body": "<p>This code is based on your idea but it uses an array, called arr, to input the data quickly and to facilitate fast processing. The located references are stored in strings which are split later into the ListBoxes.</p>\n\n<p>A vertical bar is used as a split character. If that clashes with your data you will need to change it.</p>\n\n<p>Note: I don't think your Frame1.Visible commands are effective.actually do anything.</p>\n\n<pre><code>Private Sub cmdSearch_Click()\n\n    Dim Response As Long\n    Dim NotFound As Integer\n    Dim arr As Variant\n    Dim i As Long\n    Dim str1 As String, str2 As String, str3 As String\n\n    NotFound = 0\n    ActiveWorkbook.Sheets(\"test\").Activate\n    Frame1.Visible = False\n    Response = txtItemNumber.Text\n\n    If Response &lt;&gt; False Then\n\n        With ActiveSheet\n            arr = .Range(\"A2:D\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\n        End With\n\n        For i = 1 To UBound(arr)\n            If arr(i, 1) = Response Then\n                str1 = IIf(str1 = \"\", arr(i, 2), str1 &amp; \"|\" &amp; arr(i, 2))\n                str2 = IIf(str2 = \"\", arr(i, 3), str2 &amp; \"|\" &amp; arr(i, 3))\n                str3 = IIf(str3 = \"\", arr(i, 4), str3 &amp; \"|\" &amp; arr(i, 4))\n            End If\n        Next\n\n        If str1 = \"\" Then\n            MsgBox \"Item Number Not Found!\", vbExclamation\n            NotFound = 1\n        Else\n            Frame1.Visible = True\n            ListBox1.List = Split(str1, \"|\")\n            ListBox2.List = Split(str2, \"|\")\n            ListBox3.List = Split(str3, \"|\")\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5495623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77245a028665af9c3ca77d12c33c733e?s=128&d=identicon&r=PG&f=1", "display_name": "instanceoftime", "link": "https://stackoverflow.com/users/5495623/instanceoftime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 33381375, "answer_count": 2, "score": 0, "last_activity_date": 1445995605, "creation_date": 1445980840, "last_edit_date": 1531164843, "question_id": 33378696, "link": "https://stackoverflow.com/questions/33378696/vba-fill-a-listbox-will-all-occurrences", "title": "VBA fill a listbox will all occurrences", "body": "<p>I have a spreadsheet with 4 columns and 35000 lines.</p>\n\n<p>I have made a form with 3 listboxes (among other buttons)</p>\n\n<p>When I click search button I would like to search column A for all occurrences of the number and fill the listboxes with the corresponding B, C &amp; D</p>\n\n<p>(if it helps speed there will never be more than 10 occurrences of the same number and column A is sorted)</p>\n\n<p>123 dog Fido Elm $50</p>\n\n<p>123 dog Spot Oak $40</p>\n\n<p>456 Cat Jet Adam $30</p>\n\n<p>Search for 123 and</p>\n\n<p>listbox 1 will show Fido &amp; Spot\nlistbox 2 will show Elm &amp; Oak\nlistbox3 ....</p>\n\n<p>Code so far:</p>\n\n<pre><code>Private Sub cmdSearch_Click()\n\nDim Response As Long\nDim NotFound As Integer\n\n\nNotFound = 0\n\n\nActiveWorkbook.Sheets(\"test\").Activate\n\nFrame1.Visible = False\n\nResponse = txtItemNumber.Text\n\nIf Response &lt;&gt; False Then\n\nRange(\"A2\").Select\n\n\nDo Until ActiveCell.Value = Val(Response)\nIf ActiveCell.Value = \"\" Then\nMsgBox \"Item Number Not Found!\", vbExclamation\nNotFound = 1\nExit Do\nEnd If\nActiveCell.Offset(1, 0).Select\nLoop\n\nIf ActiveCell.Value = Val(Response) Then\nFrame1.Visible = True\n\nListBox1.Text = ActiveCell.Offset(0, 1)\nListBox2.Text = ActiveCell.Offset(0, 2)\nListBox3.Text = ActiveCell.Offset(0, 3)\n\n**'would like to see if next number in Column A is also the same as being searched... if so then add to listbox'\n'do this until the next number doesn't match'**\n\n\nEnd If\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>also would the process be sped up with an array or vlookup? I'm not to familiar with those\nand I would like the multiple list boxes rather than a multicolumn list box (in case that comes up)</strong></p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1445981503, "post_id": 33378100, "comment_id": 54551608, "body": "I guess you have to import the corresponding API functions from Kernel32 API... <code>CreateMutex</code>, <code>OpenMutex</code>, <code>WaitForSingleObject</code> etc.."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1445981890, "post_id": 33378100, "comment_id": 54551829, "body": "this old thread might be helpful: <a href=\"http://stackoverflow.com/questions/947/how-to-use-a-mutex-in-visual-basic\" title=\"how to use a mutex in visual basic\">stackoverflow.com/questions/947/&hellip;</a>"}, {"owner": {"reputation": 13788, "user_id": 275449, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ff514c9ed9e93ff6b95e2775320d0a8c?s=128&d=identicon&r=PG", "display_name": "wpfwannabe", "link": "https://stackoverflow.com/users/275449/wpfwannabe"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1446023231, "post_id": 33378100, "comment_id": 54565936, "body": "Yeah, I figured as much but how do I do that in VBA? I can do that in VB.NET but what&#39;s the correct syntax for VBA?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1446036765, "post_id": 33378100, "comment_id": 54574497, "body": "plz see my answer below. It should provide some general guideline, you can adjust it to what you want to achieve. Hope this helps :)"}], "answers": [{"comments": [{"owner": {"reputation": 13788, "user_id": 275449, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ff514c9ed9e93ff6b95e2775320d0a8c?s=128&d=identicon&r=PG", "display_name": "wpfwannabe", "link": "https://stackoverflow.com/users/275449/wpfwannabe"}, "edited": false, "score": 0, "creation_date": 1446044582, "post_id": 33391262, "comment_id": 54580364, "body": "Perfect, thanks! Although I figured out most of it myself after a lot of fiddling and trial and error. You still deserve the credit."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 13788, "user_id": 275449, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ff514c9ed9e93ff6b95e2775320d0a8c?s=128&d=identicon&r=PG", "display_name": "wpfwannabe", "link": "https://stackoverflow.com/users/275449/wpfwannabe"}, "edited": false, "score": 0, "creation_date": 1446044849, "post_id": 33391262, "comment_id": 54580572, "body": "@wpfwannabe thanks, glad to give some help in such interesting problem :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 6, "last_activity_date": 1446036683, "last_edit_date": 1446036683, "creation_date": 1446035753, "answer_id": 33391262, "question_id": 33378100, "link": "https://stackoverflow.com/questions/33378100/create-and-use-a-named-mutex-in-vba/33391262#33391262", "title": "Create and use a named mutex in VBA", "body": "<p>This answer should provide you with the general approach to achieve the synchronization between Excel-VBA and word-VBA using a mutex to protect some shared data. The details depend on your target application..</p>\n\n<p>The idea goes like this, you can create this code in the module <code>ThisWorkbook</code> of Excel and similarly in <code>ThisDocument</code> of Word:</p>\n\n<pre><code>' Module ThisWorkbook or similarly ThisDocument\n\nPrivate myMutex As Long\n\nPrivate Const ERROR_ALREADY_EXISTS = 183&amp;\nPrivate Const MUTEX_ALL_ACCESS = &amp;H1F0001\n\nPrivate Declare PtrSafe Function CreateMutex Lib \"kernel32\" Alias \"CreateMutexA\" (ByVal lpMutexAttributes As Long, ByVal bInitialOwner As Long, ByVal lpName As String) As Long\nPrivate Declare PtrSafe Function CloseHandle Lib \"kernel32\" (ByVal hObject As Long) As Long\nPrivate Declare PtrSafe Function WaitForSingleObject Lib \"kernel32\" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long\nPrivate Declare PtrSafe Function OpenMutex Lib \"kernel32\" Alias \"OpenMutexA\" (ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, ByVal lpName As String) As Long\nPrivate Declare PtrSafe Function ReleaseMutex Lib \"kernel32\" (ByVal hMutex As Long) As Long\n\nPrivate Sub Workbook_Open()\n    myMutex = CreateMutex(0, 1, \"myMutex\")\n    Dim er As Long: er = Err.LastDllError\n    If er = 0 Then\n        MsgBox \"myMutex Created\"\n    ElseIf er = ERROR_ALREADY_EXISTS Then\n        MsgBox \"mutex previously created\"\n        myMutex = OpenMutex(MUTEX_ALL_ACCESS, 0, \"myMutex\")\n    Else\n        MsgBox \"mutex creation failed\"\n    End If\nEnd Sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    CloseHandle myMutex\nEnd Sub\n\nPrivate Sub doSomeCriticalTask()\n    WaitForSingleObject myMutex, 20000 ' say we can wait for 20 seconds\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' do critical section code, access shared data safely\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ReleaseMutex myMutex\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13788, "user_id": 275449, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ff514c9ed9e93ff6b95e2775320d0a8c?s=128&d=identicon&r=PG", "display_name": "wpfwannabe", "link": "https://stackoverflow.com/users/275449/wpfwannabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1679, "favorite_count": 3, "accepted_answer_id": 33391262, "answer_count": 1, "score": 2, "last_activity_date": 1446036683, "creation_date": 1445978598, "last_edit_date": 1531164843, "question_id": 33378100, "link": "https://stackoverflow.com/questions/33378100/create-and-use-a-named-mutex-in-vba", "title": "Create and use a named mutex in VBA", "body": "<p>I am doing some intertwining clipboard magic with <code>Word</code> and <code>Excel</code> VBA and I figured clipboard being a shared resource should probably be guarded by a simple mutex.</p>\n\n<p>How would I go about creating and releasing a named mutex in VBA? I couldn't find anything VBA related. As if nobody ever created a mutex from VBA. Is it impossible?</p>\n"}, {"tags": ["vba", "excel", "checkbox"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1445977867, "post_id": 33377782, "comment_id": 54549633, "body": "You can post an image to any public file share (<a href=\"http://imgur.com/\" rel=\"nofollow noreferrer\">imgur.com</a> is a nice one) and edit your question to include the public link. Very often someone with a little more rep will come along and edit your question to include the image from the link."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1445981366, "post_id": 33378716, "comment_id": 54551535, "body": "Might be better to use the linked cell rather than <code>TopLeftCell</code>.  Like this <code>Set r = Range(CkBx.LinkedCell)</code>"}, {"owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1445984589, "post_id": 33378716, "comment_id": 54552970, "body": "It sounded to me like the OP wanted to have all check boxes checked or unchecked with a single click. Will this do that? It seems like it will only check one at a time."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1445994045, "post_id": 33378716, "comment_id": 54556045, "body": "@ClintStreet- where in the question do you see that? The OP wants to show &quot;Yes/No&quot; instead of &quot;True/False&quot;, where does it say to click a button to check/uncheck all checkboxes?"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 2, "last_activity_date": 1445982094, "last_edit_date": 1445982094, "creation_date": 1445980910, "answer_id": 33378716, "question_id": 33377782, "link": "https://stackoverflow.com/questions/33377782/hundreds-of-checkboxes-change-from-true-false-to-yes-no/33378716#33378716", "title": "Hundreds of checkboxes change from True/False to Yes/No", "body": "<p>When the code is creating the checkboxes, you can add <code>.OnAction =\"MacroName\"</code></p>\n\n<pre><code> With cb\n        .LinkedCell = cel.Address\n        .Caption = \"\"\n        .OnAction = \"YesNoChkBox\"    'will call the macro when the checkbox is clicked.\n    End With\n</code></pre>\n\n<p>What this does is assigns a macro to the checkbox when it is clicked. The macro will then figure out the range of the clicked checkbox and will display \"yes\" or \"no\" if it is true or now.</p>\n\n<pre><code> Sub MakeCkBx()\n\n    Dim cb As CheckBox\n    Dim myRange As Range, cel As Range\n    Dim wks As Worksheet\n\n    Set wks = Sheets(\"Sheet1\")\n\n    Set myRange = wks.Range(\"K2:K21, L2:L21\")\n\n    For Each cel In myRange\n\n        Set cb = wks.CheckBoxes.Add(cel.Left, cel.Top, 30, 6)\n\n        With cb\n            .LinkedCell = cel.Address\n            .Caption = \"\"\n            .OnAction = \"YesNoChkBox\"    'will call the macro when the checkbox is clicked.\n        End With\n        cel.HorizontalAlignment = xlRight\n    Next\n\nEnd Sub\nSub YesNoChkBox()\n    Dim r As Range, x, CkBx As CheckBox\n    Set CkBx = ActiveSheet.CheckBoxes(Application.Caller)\n    Set r = Range(CkBx.LinkedCell)\n\n    If CkBx = 1 Then\n        r = \"yes\"\n    Else\n        r = \"No\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Run the MakeCkBx macro then click on the checkboxes to get the results.</p>\n\n<p>I have a simple example of <code>application.caller</code> located <a href=\"http://www.xlorate.com/excel-questions.html#Find%20Button%20Range\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 25, "user_id": 5494931, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153692855074568/picture?type=large", "display_name": "Kay", "link": "https://stackoverflow.com/users/5494931/kay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1521, "favorite_count": 0, "accepted_answer_id": 33378716, "answer_count": 1, "score": 0, "last_activity_date": 1445982094, "creation_date": 1445977418, "question_id": 33377782, "link": "https://stackoverflow.com/questions/33377782/hundreds-of-checkboxes-change-from-true-false-to-yes-no", "title": "Hundreds of checkboxes change from True/False to Yes/No", "body": "<p>I have a spreadsheet that is continuously being updated to track visitations to patients. I have 2 columns that I've used the below VBA code to enter multiple checkboxes into which are assigned to the cell into which they are located. However, I would like to add something that makes the value of the checkboxes either Yes or No when I click on them. There are over 600 of these in the spreadsheet, so I need something that will cover all of them at once instead of having to change each one separately. I would post a pic of the spreadsheet, but I can't yet since I'm a new user and don't have reputation points. Can anyone help?</p>\n\n<pre><code>Sub AddCheckBoxes()\n\nDim cb As CheckBox\nDim myRange As Range, cel As Range\nDim wks As Worksheet\n\nSet wks = Sheets(\"Sheet1\")\n\nSet myRange = wks.Range(\"K2:K300, L2:L300\")\n\nFor Each cel In myRange\n\nSet cb = wks.CheckBoxes.Add(cel.Left, cel.Top, 30, 6)\n\n\nWith cb\n\n    .Caption = \"\"\n    .LinkedCell = cel.Address\n\nEnd With\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1445977123, "post_id": 33377632, "comment_id": 54549224, "body": "Changing a cell&#39;s format (colour or other) is insufficient to mark the cell as &#39;dirty&#39;. A volatile UDF will recalculate on every calculation cycle but you have to have something occur (typically a value change anywhere in the workbook) that triggers it."}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1446028260, "post_id": 33377632, "comment_id": 54569167, "body": "Thanks for that, if I have a question regarding that solution that won&#39;t work for me can I ask it here or on the link above?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1446099982, "post_id": 33377632, "comment_id": 54605561, "body": "Your asking how to make something work that was never designed to work (e.g. changing a cell&#39;s color triggering an event). If you can formulate your new line of inquiry together into a comprehensive question then start as new question (as advised to in the blurb above). Posting a comment into the other answer is unlikely to garner a response but I believe that the thread does answer every point you&#39;ve brought up in this question."}], "owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "closed_date": 1445977216, "answer_count": 0, "score": 0, "last_activity_date": 1445976864, "creation_date": 1445976864, "question_id": 33377632, "link": "https://stackoverflow.com/questions/33377632/excel-vba-auto-update-custom-formula", "closed_reason": "Duplicate", "title": "Excel VBA auto update custom formula", "body": "<p>I have an excel spreadsheet and want to have a custom formula that will count the numbers of cells with a specific colour.</p>\n\n<pre><code>Function CountCcolor(range_data As range, criteria As range) As Long\n    Dim datax As range\n    Dim xcolor As Long\nxcolor = criteria.Interior.ColorIndex\nFor Each datax In range_data\n    If datax.Interior.ColorIndex = xcolor Then\n        CountCcolor = CountCcolor + 1\n    End If\nNext datax\nEnd Function\n</code></pre>\n\n<p>I have used the following code and it works but when I change a cell colour it doesn't automatically update the result of the formula.</p>\n\n<p>On other questions I was advised that I need to add the </p>\n\n<pre><code>Application.Volatile\n</code></pre>\n\n<p>command inside the function. This doesn't work for me.</p>\n\n<p>Has anyone any solution or is it possible if the cell colour is changed and not the contents to automatically show an updated total.</p>\n"}, {"tags": ["javascript", "vba", "excel", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5043490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/587e452a80f311b49ccd50a81645b712?s=128&d=identicon&r=PG&f=1", "display_name": "Sapmess", "link": "https://stackoverflow.com/users/5043490/sapmess"}, "edited": false, "score": 0, "creation_date": 1446032485, "post_id": 33377685, "comment_id": 54571790, "body": "Thank you for the response! So is there no method in VBA of obtaining that URL without actually navigating there? Reason being that this website limits you to 9 &quot;clicks&quot; per session. Not great for webscraping!"}, {"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "reply_to_user": {"reputation": 23, "user_id": 5043490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/587e452a80f311b49ccd50a81645b712?s=128&d=identicon&r=PG&f=1", "display_name": "Sapmess", "link": "https://stackoverflow.com/users/5043490/sapmess"}, "edited": false, "score": 0, "creation_date": 1446056966, "post_id": 33377685, "comment_id": 54589094, "body": "No, like I said, the URL exists only on the server and never sent to the client until the redirect happens. Your VBA has no access to the server."}, {"owner": {"reputation": 1487, "user_id": 2801377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b8fcb705ceb412aaef2ebc9fa500a30?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas Malaco", "link": "https://stackoverflow.com/users/2801377/jonas-malaco"}, "reply_to_user": {"reputation": 23, "user_id": 5043490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/587e452a80f311b49ccd50a81645b712?s=128&d=identicon&r=PG&f=1", "display_name": "Sapmess", "link": "https://stackoverflow.com/users/5043490/sapmess"}, "edited": false, "score": 0, "creation_date": 1446241038, "post_id": 33377685, "comment_id": 54678814, "body": "@Sapmess can&#39;t you force new sections?"}, {"owner": {"reputation": 1487, "user_id": 2801377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b8fcb705ceb412aaef2ebc9fa500a30?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas Malaco", "link": "https://stackoverflow.com/users/2801377/jonas-malaco"}, "reply_to_user": {"reputation": 23, "user_id": 5043490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/587e452a80f311b49ccd50a81645b712?s=128&d=identicon&r=PG&f=1", "display_name": "Sapmess", "link": "https://stackoverflow.com/users/5043490/sapmess"}, "edited": false, "score": 0, "creation_date": 1446241191, "post_id": 33377685, "comment_id": 54678873, "body": "@Sapmess, also, depending on what you need, it might be easy and cheap (with a binary search) to find the maximum FPI number for each year, assuming they are emitted sequentially (which does appear to be true).  Then you would have all existing profile URLs and, from that, you could build your own database or whatever it is that you need to do."}], "tags": [], "owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "is_accepted": true, "score": -1, "last_activity_date": 1445977044, "creation_date": 1445977044, "answer_id": 33377685, "question_id": 33377264, "link": "https://stackoverflow.com/questions/33377264/how-to-find-the-actionurl-in-a-javascript-dopostback/33377685#33377685", "title": "How to find the ActionURL in a javascript __doPostBack", "body": "<p>The website is an ASP.Net application. The JavaScript is auto-generated by .Net engine, and the function <code>__doPostBack()</code> is simply posting the arguments back to the server which is then redirecting to the other page. This means that the URL is on the server not in JavaScript, so there is no way for you to find it.</p>\n"}], "owner": {"reputation": 23, "user_id": 5043490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/587e452a80f311b49ccd50a81645b712?s=128&d=identicon&r=PG&f=1", "display_name": "Sapmess", "link": "https://stackoverflow.com/users/5043490/sapmess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 1, "accepted_answer_id": 33377685, "answer_count": 1, "score": 1, "last_activity_date": 1445977044, "creation_date": 1445975593, "last_edit_date": 1531164843, "question_id": 33377264, "link": "https://stackoverflow.com/questions/33377264/how-to-find-the-actionurl-in-a-javascript-dopostback", "title": "How to find the ActionURL in a javascript __doPostBack", "body": "<p>I'm using VBA in excel to webscrape. I'm trying to pull down the URLs of links on a website.</p>\n\n<p>Do a search on this website, with any of the checkboxes near the bottom checked:(<a href=\"http://www.fpi.co.za/YourFinancialPlanning/FindaFinancialPlanner/tabid/3255/Default.aspx\" rel=\"nofollow\">http://www.fpi.co.za/YourFinancialPlanning/FindaFinancialPlanner/tabid/3255/Default.aspx</a>)</p>\n\n<p>You'll see there's a list of names here (advisers in south africa)</p>\n\n<p>If you click on the name it will bring you to a new page. That being said, the method of URL change is actually through javascript <code>__doPostBack</code>, which means I can't simply <code>getelementsbyclassname().href</code></p>\n\n<p>I know that I can simply use VBA to click the link, and then store URL, but is there any way of obtaining that URL WITHOUT navigating to it?</p>\n\n<p>This is the HREF I'm dealing with:</p>\n\n<pre><code> javascript:__doPostBack('dnn$ctr4953$Clients_Custom$ctl00$rg_Members$ctl00$ctl04$lnkName','')\n</code></pre>\n\n<p>Is there anything around <code>postBackOptions.ActionURL</code> or something?</p>\n"}, {"tags": ["sql-server", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1445978356, "post_id": 33376971, "comment_id": 54549939, "body": "On the first sight your VBA looks OK, but I cannot test this here... Well, your question is only about the compiler error you got about &quot;User defined type not defined&quot;. If my answer could solve this problem you should just try your code to see what happens. Than - if there are new problems / questions go and ask a new question (with a link to this if this helps...). If this could help you with the problem here, please vote up and or mark as accepted. Thx!"}], "tags": [], "owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "is_accepted": false, "score": 1, "last_activity_date": 1445974535, "last_edit_date": 1495541030, "creation_date": 1445974535, "answer_id": 33376971, "question_id": 33376781, "link": "https://stackoverflow.com/questions/33376781/creating-a-macro-that-runs-a-query-out-of-sql-and-paste-the-data-in-excel/33376971#33376971", "title": "Creating a Macro that runs a query out of SQL and paste the data in Excel", "body": "<p>You probably did not set the reference for your ADODB objects.</p>\n\n<p>You can either do this with early binding:</p>\n\n<p>(Don't know the names exactly. I am using a german Excel)\nExtras - References: Add the reference Microsoft ActiveX Data Objects vXXX with a click in the checkbox to your project.</p>\n\n<p>Or you can do this via late binding. In this case you must declare your variable as <code>Object</code> and instantiate it via <code>CreateObject</code>. Please find a related question here: <a href=\"https://stackoverflow.com/q/26604111/5089204\">Excel VBA: Late binding reference</a></p>\n"}], "owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445974535, "creation_date": 1445973756, "last_edit_date": 1445974172, "question_id": 33376781, "link": "https://stackoverflow.com/questions/33376781/creating-a-macro-that-runs-a-query-out-of-sql-and-paste-the-data-in-excel", "title": "Creating a Macro that runs a query out of SQL and paste the data in Excel", "body": "<p>So here's my dilemma I'm attempting to create a macro that runs a query out of sql that located in cell (Sheets(\"SQL\").Range(\"G1\")), and paste the data from that query into Sheets(\"Data\").Range(\"B1\").  I came up with the code below but I keep getting a compile error:  User-defined type not defined.  Please any insight on what I'm doing wrong will be appreciated.</p>\n\n<pre><code>    Sub ConnectSqlServer()\n\n    Dim conn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim sConnString As String\n    Dim StrSQL As Variant\n\n    Application.ScreenUpdating = False\n    Application.Cursor = xlWait\n\n    Set cnPubs = New ADODB.Connection\n    Set rsPubs = New ADODB.Recordset\n\n    StrSQL = \" SET NOCOUNT ON \"\n\n    ' Create the connection string.\n    sConnString = \"Provider=SQLOLEDB; DATA SOURCE=CFS-SERVERSQL;\" &amp; _\n                  \"Initial Catalog=dmtrans;\" &amp; _\n                  \"Integrated Security=SSPI;\"\n\n    ' Create the Connection and Recordset objects.\n    Set conn = New ADODB.Connection\n    Set rs = New ADODB.Recordset\n\n    ' Open the connection and execute.\n    conn.Open sConnString\n    Set rs = conn.Execute(Sheets(\"SQL\").Range(\"G1\"))\n\n    ' Check we have data.\n    If Not rs.EOF Then\n        ' Transfer result.\n        Sheets(\"Data\").Range(\"B4:S50000\").ClearContents\n        Sheets(Data).Range(\"b4\").CopyFromRecordset rs\n    ' Close the recordset\n        rs.Close\n    Else\n        MsgBox \"Error: No records returned.\", vbCritical\n    End If\n\n    ' Clean up\n    If CBool(conn.State And adStateOpen) Then conn.Close\n    Set conn = Nothing\n    Set rs = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5490468, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/17b7fd62bb6ac02414fc301da31a1927?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/5490468/todd"}, "edited": false, "score": 0, "creation_date": 1446030247, "post_id": 33376990, "comment_id": 54570413, "body": "I can&#39;t get this one to work.  I entered my sheet with data name, but it gives me a debug error."}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1445974619, "creation_date": 1445974619, "answer_id": 33376990, "question_id": 33376775, "link": "https://stackoverflow.com/questions/33376775/select-first-visible-cell-directly-beneath-the-header-of-a-filtered-column/33376990#33376990", "title": "Select first visible cell directly beneath the header of a filtered column", "body": "<p>Something like this might work...</p>\n\n<pre><code>Sub Macro16()\n\n    Dim ARow As Long, JRow As Long, ws1 As Worksheet\n    ws1 = Sheets(\"NAME OF SHEET WITH DATA\")\n    ARow = ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).Row + 1\n    ws1.Range(\"$A$1:$R$\" &amp; ARow).AutoFilter Field:=12, Criteria1:=\"Sheets\"\n    JRow = ws1.Range(\"J\" &amp; ws1.Rows.Count).End(xlUp).Row + 1\n    ws1.Range(\"J\" &amp; JRow).FormulaR1C1 = \"=RIGHT(RC[1],3)\"\n    ws1.Range(\"J\" &amp; JRow).FillDown\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 5490468, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/17b7fd62bb6ac02414fc301da31a1927?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/5490468/todd"}, "edited": false, "score": 0, "creation_date": 1446030141, "post_id": 33377191, "comment_id": 54570354, "body": "This code works as well! Plus this code, I can figure out what it is actually doing with out any extra explanation.  Thanks for your help!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 5, "last_activity_date": 1548775451, "last_edit_date": 1548775451, "creation_date": 1445975341, "answer_id": 33377191, "question_id": 33376775, "link": "https://stackoverflow.com/questions/33376775/select-first-visible-cell-directly-beneath-the-header-of-a-filtered-column/33377191#33377191", "title": "Select first visible cell directly beneath the header of a filtered column", "body": "<p>Untested but:</p>\n\n<pre><code>Sub Macro16()\n\n    With ActiveSheet.Range(\"A1\").CurrentRegion\n        .AutoFilter field:=12, Criteria1:=\"Sheets\"\n        If .Columns(1).SpecialCells(xlCellTypeVisible).count &gt; 1 Then\n            With .Columns(10)\n                .Resize(.rows.count - 1).offset(1).SpecialCells(xlCellTypeVisible).FormulaR1C1 = \"=RIGHT(RC[1],3)\"\n            End With\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 5490468, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/17b7fd62bb6ac02414fc301da31a1927?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/5490468/todd"}, "edited": false, "score": 0, "creation_date": 1446028639, "post_id": 33378483, "comment_id": 54569430, "body": "This gives me what I wanted, but can you explain what each line does. I am just a novice when it comes to macros and I am not familiar with much of this code."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1445980054, "creation_date": 1445980054, "answer_id": 33378483, "question_id": 33376775, "link": "https://stackoverflow.com/questions/33376775/select-first-visible-cell-directly-beneath-the-header-of-a-filtered-column/33378483#33378483", "title": "Select first visible cell directly beneath the header of a filtered column", "body": "<p>I prefer non-destructive methods of determining whether there are visible cells to work with after a filtering operation. Since you are filling in column J with a formula, there is no guarantee that column J contains any values tat can be counted with the worksheet's <a href=\"https://support.office.com/en-us/article/SUBTOTAL-function-e27c301c-be9a-458b-9d12-b9a2ce3c62af\" rel=\"nofollow noreferrer\">SUBTOTAL function</a> (SUBTOTAL does not count rows hidden by a filter) but the formula you are planning to populate into column J references column K so there must be something there.</p>\n\n<pre><code>Sub Macro16()\n    With ActiveSheet\n        If .AutoFilterMode Then .AutoFilterMode = False\n        With .Cells(1, 1).CurrentRegion\n            .Columns(12).AutoFilter Field:=1, Criteria1:=\"Sheets\"\n            With .Resize(.Rows.Count - 1, 1).Offset(1, 9)\n                If CBool(Application.Subtotal(103, .Offset(0, 1))) Then\n                    .SpecialCells(xlCellTypeVisible).FormulaR1C1 = \"=RIGHT(RC[1],3)\"\n                End If\n            End With\n            .Columns(12).AutoFilter Field:=1\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/kF3yo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kF3yo.png\" alt=\"Fill Formula to Visible cells\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 14618, "user_id": 4952806, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/buq6j.png?s=128&g=1", "display_name": "andreas", "link": "https://stackoverflow.com/users/4952806/andreas"}, "edited": false, "score": 3, "creation_date": 1477906817, "post_id": 40297058, "comment_id": 67933635, "body": "While this code snippet may solve the question, <a href=\"http://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\">including an explanation</a> really helps to improve the quality of your post. Remember that you are answering the question for readers in the future, and those people might not know the reasons for your code suggestion."}, {"owner": {"reputation": 449, "user_id": 4541083, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-EZyRVAiJQhc/AAAAAAAAAAI/AAAAAAAAADc/wCn4jjBJjwc/photo.jpg?sz=128", "display_name": "Orin Moyer", "link": "https://stackoverflow.com/users/4541083/orin-moyer"}, "reply_to_user": {"reputation": 14618, "user_id": 4952806, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/buq6j.png?s=128&g=1", "display_name": "andreas", "link": "https://stackoverflow.com/users/4952806/andreas"}, "edited": false, "score": 0, "creation_date": 1477921800, "post_id": 40297058, "comment_id": 67941137, "body": "You can add this to your module.  the only thing you need to change it the sheet name and range &quot;A&quot; to the leftmost (or any) column contained in the table"}], "tags": [], "owner": {"reputation": 449, "user_id": 4541083, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-EZyRVAiJQhc/AAAAAAAAAAI/AAAAAAAAADc/wCn4jjBJjwc/photo.jpg?sz=128", "display_name": "Orin Moyer", "link": "https://stackoverflow.com/users/4541083/orin-moyer"}, "is_accepted": false, "score": 5, "last_activity_date": 1477621218, "creation_date": 1477621218, "answer_id": 40297058, "question_id": 33376775, "link": "https://stackoverflow.com/questions/33376775/select-first-visible-cell-directly-beneath-the-header-of-a-filtered-column/40297058#40297058", "title": "Select first visible cell directly beneath the header of a filtered column", "body": "<pre><code>Sub FirstVisibleCell()\n    With Worksheets(\"You Sheet Name\").AutoFilter.Range\n       Range(\"A\" &amp; .Offset(1, 0).SpecialCells(xlCellTypeVisible)(1).Row).Select\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 5490468, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/17b7fd62bb6ac02414fc301da31a1927?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/5490468/todd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37155, "favorite_count": 1, "accepted_answer_id": 33377191, "answer_count": 4, "score": 6, "last_activity_date": 1548775451, "creation_date": 1445973733, "last_edit_date": 1445974636, "question_id": 33376775, "link": "https://stackoverflow.com/questions/33376775/select-first-visible-cell-directly-beneath-the-header-of-a-filtered-column", "title": "Select first visible cell directly beneath the header of a filtered column", "body": "<p>I am trying to select the first visible cell directly beneath the header of a filtered column.  The code I am getting is as below, but I have to problems with this code.  First, the first line of code is using the current active range of the file.  It is highly likely that this file will change and this range will not be the same.  How can I make it work for any file I would use it on?  Second, if I use a totally different file with the same column format, the first visible cell under Column J could be J210.  How can I make this work for any array of variables? </p>\n\n<pre><code>Sub Macro16()\n'\n' Macro16 Macro\n'\n\n'\n    ActiveSheet.Range(\"$A$1:$R$58418\").AutoFilter Field:=12, Criteria1:= _\n        \"Sheets\"\n    Range(\"J2\").Select\n    ActiveCell.FormulaR1C1 = \"=RIGHT(RC[1],3)\"\n    Selection.FillDown\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "loops", "if-statement", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1445974673, "post_id": 33376742, "comment_id": 54547848, "body": "&quot;cannot get to work correctly&quot; - what does that code do now? What do you expect it to do?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445974714, "post_id": 33376742, "comment_id": 54547875, "body": "<code>except if there is information in the adjacent cells.</code> - adjacent cells in sheet1 (where the column A = 1991) or sheet2 (where it will be pasted)? and which cells do you consider adjacent (i.e. - which columns?)"}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1445975345, "post_id": 33376742, "comment_id": 54548259, "body": "Grade&#39;Eh&#39; Bacon, Right now the code that&#39;s enabled only copy&#39;s cells from Sheet1 ( A2, B2, C2, D2) Pastes to (D2, A2, C2 B2) when i run the macro again it pastes to (D2+1, A2+1, C2+1 B2+1) ect.&lt;br&gt; What I would like the code to do is copy all the code in Column A that has Text &quot;1991&quot; to sheet2 (D2, A2, C2 B2)&lt;br&gt; so when I have 1500 rows with &quot;1999 in Column A I won&#39;t have to manually copy and paste them to Sheet2."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1445975791, "post_id": 33376742, "comment_id": 54548517, "body": "So you need to do a loop that iterates through column A and use an if statement to determine if it moves or not. with z = the row number of the cells in column A being tested."}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1445976221, "post_id": 33376742, "comment_id": 54548756, "body": "Scott Holtzman, I removed the adjacent cells sentence because it was confusing the way I wrote it. Scott Craner, I&#39;m Not sure exactly if a LOOP and IF Statement will do exactly what I&#39;m asking but I&#39;m Open to the idea of it, Also looking at how you use Array&#39;s but i don&#39;t know if I can get the code to be very dynamic using a Array."}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1445990508, "post_id": 33376742, "comment_id": 54555056, "body": "Updated the Macro code with the help of EntryLevel, But now I face another problem. All the cells are not being copied correctly."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1445982352, "post_id": 33378932, "comment_id": 54552035, "body": "So I understand doing an automatic filter on vba may take the other cars out of sheet1, But the reason I need to use a if statement is because I have to be able to use multiple filters that automatically search and copy selected cells and pasting them into a pre-formatted sheet2.  Sounds silly but I have product listing with 200,000 rows that I need to retrieve information  to paste to selected cells. I didn&#39;t put that in the overall question because I already feel like I&#39;m overly complicating the macro. The code I&#39;m trying to get to work is the beginning portion."}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1445983548, "post_id": 33378932, "comment_id": 54552569, "body": "I don&#39;t think I understand why a filter with multiple criteria and copying only the remaining visible cells won&#39;t work, but I&#39;ll accept it and try to edit your original code.  Are the columns on sheet 2 in the same order as the columns on sheet 1?  Or do we need to rearrange the order when we paste the data? Also, what are we trying to do with that <code>z</code> variable?"}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1445984556, "post_id": 33378932, "comment_id": 54552960, "body": "EntryLevel, The z variable was just me trying to clean things up but ignore that for now, To help you understand the bigger picture for what I&#39;m getting at. If i was to open my product database it has over 154,000 rows &amp; 17 columns wide the formatted sheet2 is in a complete different order and has about 50 columns. In example I need to be able to select the brand I want to copy all the products cells that I need to the proper place in there correct order of Sheet2, Then sheet2 with have the required unique information from the cells of sheet1 &amp; the rest of Sheet2 can be Null."}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1445984694, "post_id": 33378932, "comment_id": 54553016, "body": "To add to making it complicated I have multiple excel sheets i need to source information from automatically using some kind of search Cell for Exact Text string then copy certain cell from pertaining row to one of the 50 columns for the specific product. sounds crazy I know."}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1445985522, "post_id": 33378932, "comment_id": 54553337, "body": "If I disable b.Range(&quot;A1&quot;).Select then it works exactly like i was orginally asking and the code you put was so simple compared to what I had been trying all day to do Your Awesome!"}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446040894, "post_id": 33378932, "comment_id": 54577535, "body": "What&#39;s up with the edits to my answer? It looks like everything after the second code section should have been an edit to the original question."}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446043021, "post_id": 33378932, "comment_id": 54579168, "body": "I removed those erroneous edits and made new edits that add to my original response and answer the new questions from @Michael M."}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446050247, "post_id": 33378932, "comment_id": 54584664, "body": "I have changed the placement where erow =.b.Cells(b.Rows.Count, 1).End(xlUp).offset(1, 0).Row to underneath line that defines lastrowsheet1 &amp;  added erow = erow + 1  and I have the exact same output.  Only the very last line from sheet1 is copied to sheet2."}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446051221, "post_id": 33378932, "comment_id": 54585335, "body": "Can you please update the code in your question to reflect your changes?"}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446051956, "post_id": 33378932, "comment_id": 54585786, "body": "Added the code you said would correct the issue to the orginal fixed code. @EntryLevel"}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446060239, "post_id": 33378932, "comment_id": 54591090, "body": "I am not able to replicate your issue. I reran your new code unmodifed on some test data, and it looks like it is working to me. It copies over the data for each sheet 1 row that has &quot;AEM&quot; in the first column and it places each piece into the specified columns."}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446060638, "post_id": 33378932, "comment_id": 54591329, "body": "Though I will mention that if you initially define <code>erow</code> by going <code>.End(xlUp)</code> from the bottom of the first column but don&#39;t actually ever put data into the first column, then it will always initially define <code>erow</code> as row 2 (assuming you have column headings in row 1).  That means it would start writing the data into row 2 of sheet 2 every time instead of appending the new data at the end of the existing data. You&#39;ll probably still want to change that initial <code>erow</code> definition to look at a column that has data every time, perhaps column 31 where we know it puts &quot;AEM&quot; every time."}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446111732, "post_id": 33378932, "comment_id": 54611580, "body": "After trying the fixed code on a different computer and using different test data it worked corrected right away. But then I thought I could use a modified version of the IF Statement to add additional functionality by searching column 1 rows for = to column 6 rows, Then copy description from sheet3 cell row to Sheet2 cell row. The Problem is the code only copy&#39;s the very first row to sheet 2 then stops, where the code unmodified return all rows to sheet2 columns."}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446127903, "post_id": 33378932, "comment_id": 54622844, "body": "Your new outside loop, the one that starts <code>For r = 1 to erow</code> is basically saying <code>For r = 1 to 2</code> because <code>erow</code> is still defined based on the last row in column 1 that has data plus one row. So it probably finds your column header in row 1 then adds 1 to that via <code>Offset(1,0)</code> and sets <code>erow</code> to 2.  Then it only goes through that outside loop twice so it&#39;s stopping before you want it to."}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446128049, "post_id": 33378932, "comment_id": 54622965, "body": "Can you also please elaborate more regarding what you want this new section of your code to do?  I think there may be other gremlins we need to work out, but I&#39;m getting confused about which sheets and columns we are trying to compare in this new section."}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446130393, "post_id": 33378932, "comment_id": 54624650, "body": "So I figured by adding another variable and containing the loop inside of a loop it would continue down the sheet3 column,  the purpose of this code is after the code you helped me with macro &quot;TakeTwo&quot; there will be 356 rows of unique texts in column 6 of sheet 2, the code iterates through column 1 of sheet3 once a match is made then in that matching row it takes c.Cells(i, 2) and pastes them to the corresponding row b.Cells(erow,8) then it continues down the entire column of sheet2."}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446131068, "post_id": 33378932, "comment_id": 54625206, "body": "That sounds like a job for a <code>VLookup</code> formula.  Have you tried putting something like <code>=VLOOKUP($F2,Sheet3!$A:$B,2,0)</code> into <code>Cell H2</code> on <code>Sheet 2</code> and copying the formula down that column?"}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446131804, "post_id": 33378932, "comment_id": 54625731, "body": "VLOOKUP function would be great but I need the automated verson by running a macro so it can be ported to click of a button on a UserForm,So Is there a way to use the simple For Loop function to do a Simular to Vlookup?"}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446132004, "post_id": 33378932, "comment_id": 54625872, "body": "We can add that formula in to column 8 of sheet 2 when it initially copies the data from sheet 1 to sheet 2 in the TakeTwo sub. Would that work?"}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446132835, "post_id": 33378932, "comment_id": 54626514, "body": "I added that formula to cell H2 it worked for row 2 but then you have to change $F2 to $F3 for row 3 then $F4 for row 4 ect.. so it would require another variable. Also using the vlookup function kind of mirrors the info from the Cell to the cell with the function without actually coping it?"}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446133649, "post_id": 33378932, "comment_id": 54627120, "body": "If you copy cell F2 and paste it down into the rows below it, it will change the row number in the formula automatically. If we didn&#39;t want it to automatically update the row number as you copy it down, we could put a $ in front of the 2 so it would be $F$2 (that isn&#39;t what you want, just a side note about how that works).  However, if you&#39;d rather have just the value in there instead of the actual formula, we can have the vba do the same thing and just put the value in there instead of the formula."}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446135116, "post_id": 33378932, "comment_id": 54628151, "body": "In the <code>TakeTwo</code> sub, you could put <code>b.Cells(erow, 8) = WorksheetFunction.VLookup(b.Cells(erow, 6).Value, c.Range(&quot;$A:$B&quot;), 2, 0)</code> right above <code>erow = erow + 1</code> if you just want the value in there."}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446135323, "post_id": 33378932, "comment_id": 54628293, "body": "Or if you want the formula to show in the cell, you could use <code>b.Cells(erow, 8).Formula = &quot;=VLookup($F&quot; &amp; erow &amp; &quot;, Sheet3!$A:$B,2,0)&quot;</code> in that same place."}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446136385, "post_id": 33378932, "comment_id": 54629017, "body": "The first way of using &#39;VLOOKUP&#39; error&#39;s to that line but the 2nd one works correctly. I&#39;m going to try added more to the &#39;taketwo&#39; sub and see how it works out."}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446139783, "post_id": 33378932, "comment_id": 54631275, "body": "using <code>b.Cells(erow, 8).Formula = &quot;=VLookup($F&quot; &amp; erow &amp; &quot;, Sheet3!$A:$B,2,0)&quot;</code> how do I put a If within the function, So when  Vlookup fails finding erow to display a Generic value  instead of #N/A in the cell?"}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446474543, "post_id": 33378932, "comment_id": 54744491, "body": "Sorry, my grandfather passed away and I haven&#39;t been around to see this until now.  If you still need an answer, give <code>b.Cells(erow, 8).Formula = &quot;=iferror(VLookup($F&quot; &amp; erow &amp; &quot;, Sheet3!$A:$B,2,0),&quot; &amp; Chr(34) &amp; Chr(34) &amp; &quot;)&quot;</code> a try."}, {"owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446568626, "post_id": 33378932, "comment_id": 54792131, "body": "Thanks for the reply,  very sorry to hear that, EntryLevel.  Family comes first."}, {"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "reply_to_user": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "edited": false, "score": 0, "creation_date": 1446581110, "post_id": 33378932, "comment_id": 54799662, "body": "So did that work for you or do we still have some kinks to work out?"}], "tags": [], "owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "is_accepted": false, "score": 0, "last_activity_date": 1446063199, "last_edit_date": 1446063199, "creation_date": 1445981817, "answer_id": 33378932, "question_id": 33376742, "link": "https://stackoverflow.com/questions/33376742/vba-excel-automatically-copy-paste-specific-cells-based-on-if-statement/33378932#33378932", "title": "VBA Excel Automatically Copy &amp; Paste Specific cells based on IF statement", "body": "<p>Based on your statement that <code>I'm trying to get the If statement to search all of column A and copy all Cars that are year 1991 to sheet2</code>, it seems like <code>Autofilter</code> might be an easier solution than looping.  You should be able to use something like this: </p>\n\n<pre><code>Sub TestyTestTest()\n    Dim lastrowsheet1 As Long\n    Dim lastrowsheet2 As Long\n\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        .AutoFilterMode = False\n        lastrowsheet1 = .Cells(.Rows.Count, 1).End(xlUp).Row\n        .Range(.Cells(1, 1), .Cells(lastrowsheet1, 4)).AutoFilter Field:=1, Criteria1:=\"1991\"\n        .Range(.Cells(2, 1), .Cells(lastrowsheet1, 4)).SpecialCells(xlCellTypeVisible).Copy\n        .AutoFilterMode = False\n    End With\n\n    With ThisWorkbook.Sheets(\"Sheet2\")\n        .AutoFilterMode = False\n        lastrowsheet2 = .Cells(.Rows.Count, 1).End(xlUp).Row\n        .Cells(lastrowsheet2 + 1, 1).PasteSpecial Paste:=xlPasteValues\n        .AutoFilterMode = False\n    End With\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong> </p>\n\n<p>Trying to stick close to your original code, would something like this be more like what you are looking for? </p>\n\n<pre><code>Sub TakeTwo()\n    Dim a As Worksheet\n    Dim b As Worksheet\n    Dim c As Worksheet\n\n    Set a = ThisWorkbook.Sheets(\"Sheet1\")\n    Set b = ThisWorkbook.Sheets(\"Sheet2\")\n    Set c = ThisWorkbook.Sheets(\"Sheet3\")\n\n    Dim i As Long\n    Dim lastrowsheet1 As Long\n    Dim erow As Long\n\n    lastrowsheet1 = a.Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 2 To lastrowsheet1\n        If a.Cells(i, 1).Value = 1991 Then\n            erow = b.Cells(b.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n            b.Cells(erow, 1) = a.Cells(i, 1)\n            b.Cells(erow, 2) = a.Cells(i, 2)\n            b.Cells(erow, 3) = a.Cells(i, 3)\n            b.Cells(erow, 4) = a.Cells(i, 4)\n        End If\n    Next i\n    Application.CutCopyMode = False\n    b.Columns.AutoFit\nEnd Sub\n</code></pre>\n\n<p><strong>SECOND EDIT - OP's NEW PROBLEM:</strong> </p>\n\n<p>It looks like your data is just pasting over itself because <code>erow</code> is defined as the row after the last row in column 1 that is not empty, but you are not actually putting any data into that column, so <code>erow</code> isn't moving down to the next line. </p>\n\n<p>Basically, change the column number in this line: </p>\n\n<pre><code>erow = b.Cells(b.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n</code></pre>\n\n<p>The <code>1</code> in <code>b.Cells(b.Rows.Count, 1)</code> should be changed to a column number that you paste data into every time. Alternatively, you could use <code>erow</code> as a counter and increment it manually each time through the loop. In that case move the existing line that defines <code>erow</code> up underneath the line that defines <code>lastrowsheet1</code> and then put <code>erow = erow + 1</code> inside the loop after all the pasting has taken place but before <code>End if</code>. If you put it after <code>End If</code>, you'll end up with a bunch of blank lines between your data.</p>\n"}], "owner": {"reputation": 19, "user_id": 5495176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11d13f4fc2ce3dc5ebc92c4826ecb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael M", "link": "https://stackoverflow.com/users/5495176/michael-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3223, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446119362, "creation_date": 1445973574, "last_edit_date": 1531164843, "question_id": 33376742, "link": "https://stackoverflow.com/questions/33376742/vba-excel-automatically-copy-paste-specific-cells-based-on-if-statement", "title": "VBA Excel Automatically Copy &amp; Paste Specific cells based on IF statement", "body": "<p>The code I have placed below is a combination of what works and what i can't get to work.</p>\n\n<p>The code that is not commented will copy cells to \"sheet2\" from \"sheet1\".</p>\n\n<p>What I cannot get to work correctly is the code that I have disabled that would replace my Range Method of coping from \"sheet1\" to \"sheet2\".</p>\n\n<p>Also my <code>If Then</code> Code is what will some up what I'm trying to accomplish. I'm trying to get the If statement to search all of column A and copy all Cars that are year 1991 to sheet2. </p>\n\n<p>Mind my poor coding skills I'm Doing my best to show &amp; explain so I can be helped.<br> \nHere is the Sheets 1 &amp; 2</p>\n\n<p>(hxxp://s15.postimg.org/orfw7tlaz/test.jpg)</p>\n\n<p><strong>OLD CODE</strong></p>\n\n<pre><code>Sub Macro1()\n\nSet a = Sheets(\"Sheet1\")\nSet b = Sheets(\"Sheet2\")\nSet c = Sheets(\"Sheet3\")\n\nDim x\nDim z\nDim lastrow As Long, erow As Long\n\nx = x + 1\nz = 2\n\n\n'lastrow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n'lastrow = b.Cells(Rows.Count, 1).End(xlUp).Row\n'For i = 2 To lastrow\nlastrow = b.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + x\n\n'If a.Cells(i, 1) = \u201c1991\u201d Then\n\n\n'a.Cells(i, 1).Copy\n'erow = b.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n'b.Paste Destination:=b.Range.Cells(erow, 4)\nRange(\"A\" &amp; z).Copy Destination:=b.Range(\"D\" &amp; lastrow)\n\n'a.Cells(i, 1).Copy\n'b.Paste Destination:=b.Range.Cells(erow, 1)\nRange(\"B\" &amp; z).Copy Destination:=b.Range(\"A\" &amp; lastrow)\n\n\n'a.Cells(i, 1).Copy\n'b.Paste Destination:=b.Range.Cells(erow, 3)\nRange(\"C\" &amp; z).Copy Destination:=b.Range(\"C\" &amp; lastrow)\n\n'a.Cells(i, 1).Copy\n'b.Paste Destination:=b.Range(erow, 2)\nRange(\"D\" &amp; z).Copy Destination:=b.Range(\"B\" &amp; lastrow)\n'End If\n\n'Next i\nApplication.CutCopyMode = False\nSheet2.Columns().AutoFit\n'b.Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>So I added some Lines and Began changing the cell locations to reflect the format I need and now when I run the macro it only copys the very last line from Sheet1 to sheet2. I believe it has to do with the order of the way these cells are. </p>\n\n<pre><code>        b.Cells(erow, 1) = a.Cells(i, 1)\n        b.Cells(erow, 2) = a.Cells(i, 2)\n        b.Cells(erow, 3) = a.Cells(i, 3)\n        b.Cells(erow, 4) = a.Cells(i, 4)\n</code></pre>\n\n<p>Changing these back fixes it so it copys all the cells but its not what I'm trying to do.\nThe Code I'm Trying to run is Below</p>\n\n<p><strong>NEW CODE Working Thanks to EntryLevel!</strong></p>\n\n<pre><code>Sub TakeTwo()\n    Dim a As Worksheet\n    Dim b As Worksheet\n    Dim c As Worksheet\n\n    Set a = ThisWorkbook.Sheets(\"Sheet1\")\n    Set b = ThisWorkbook.Sheets(\"Sheet2\")\n    Set c = ThisWorkbook.Sheets(\"Sheet3\")\n\n    Dim i As Long\n    Dim lastrowsheet1 As Long\n    Dim erow As Long\n\n    lastrowsheet1 = a.Cells(Rows.Count, 1).End(xlUp).Row\n    erow = b.Cells(b.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    For i = 2 To lastrowsheet1\n        If a.Cells(i, 1).Value = \"AEM\" Then\n            b.Cells(erow, 31) = a.Cells(i, 1)  '&lt;------When I modify these\n            b.Cells(erow, 6) = a.Cells(i, 4)   '&lt;------The copied cells\n            b.Cells(erow, 28) = a.Cells(i, 5)  '&lt;------Don't show up\n            b.Cells(erow, 26) = a.Cells(i, 6)  '&lt;------In Sheet2\n            b.Cells(erow, 46) = a.Cells(i, 11) '&lt;------Only the last\n            b.Cells(erow, 29) = a.Cells(i, 14) '&lt;------Line found Is copied to sheet2\n            erow = erow + 1\n        End If\n    Next i\n    Application.CutCopyMode = False\n    b.Columns.AutoFit\n    'b.Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p><strong>Now Using Same Working Code</strong> But <strong>Different function Not Working</strong></p>\n\n<pre><code>Sub TakeThree()\n    Dim a As Worksheet\n    Dim b As Worksheet\n    Dim c As Worksheet\n\n    Set a = ThisWorkbook.Sheets(\"Sheet1\")\n    Set b = ThisWorkbook.Sheets(\"Sheet2\")\n    Set c = ThisWorkbook.Sheets(\"Sheet3\")\n\n    Dim i As Long\n    Dim lastrowsheet1 As Long\n    Dim erow As Long\n\n    lastrowsheet1 = c.Cells(Rows.Count, 1).End(xlUp).Row\n    erow = b.Cells(b.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    For i = 2 To lastrowsheet1\n        If c.Cells(i, 1).Value = b.Cells(erow, 6).Value Then 'If serial number is found from sheet2 column 6 in sheet3 Column 1\n            b.Cells(erow, 8) = c.Cells(i, 2) 'Then copy description from sheet3 cell row to Sheet2 cell row\n            erow = erow + 1\n            End If\n    Next i\n    Application.CutCopyMode = False\n    b.Columns.AutoFit\n    c.Columns.AutoFit\n    'b.Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>So I added another For Loop with Dim r and added another Line erow = erow + r &amp; now the code copys the first 2 rows needed but does not continue iterating down the list. which is confusing me. here is the code below i have added.</p>\n\n<pre><code>Dim r As Long\nDim i As Long\nDim lastrowsheet1 As Long\nDim erow As Long\n\nlastrowsheet1 = c.Cells(Rows.Count, 1).End(xlUp).Row\nerow = b.Cells(b.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n For r = 1 To erow\n  For i = 2 To lastrowsheet1\n  If c.Cells(i, 1) = b.Cells(erow, 6) Then\n     b.Cells(erow, 8) = c.Cells(i, 2)\n     erow = erow + r\n  End If\nDebug.Print i\n  Next i\n  Next r\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1445973692, "post_id": 33376741, "comment_id": 54547314, "body": "you can&#39;t. <code>insert</code> only allows one single table. if you want to target multiple tables, then you&#39;ll have to use multiple inserts - and preferably do it inside a transaction."}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1445973961, "post_id": 33376741, "comment_id": 54547463, "body": "@MarcB - I think he&#39;s inserting this into a new table, so it&#39;s a matter of constructing the proper join statement.  potatosoup, can you maybe edit this question to include a little bit of sample data, even if it&#39;s made up.  I&#39;m having difficulty visualizing how the data is related."}, {"owner": {"reputation": 35, "user_id": 5000658, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/1f381d128f581b28e5093a3efdcff4e0?s=128&d=identicon&r=PG&f=1", "display_name": "potatosoup", "link": "https://stackoverflow.com/users/5000658/potatosoup"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1445975114, "post_id": 33376741, "comment_id": 54548106, "body": "@JohnnyBones I added a visualization of the tables, hopefully that helps."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1445985505, "post_id": 33376741, "comment_id": 54553329, "body": "Slightly unrelated, but I see people doing this a lot. <code>[Forms]![frmInput].[Form]![TerritoryID]</code> - the <code>.Form</code> in there is unnecessary. It&#39;s just a reference to <code>frmInput</code>. You could do also <code>Forms!frmInput.Form.Form.Form![TerritoryID]</code>, it would work too, but be just as unnecessary."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5000658, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/1f381d128f581b28e5093a3efdcff4e0?s=128&d=identicon&r=PG&f=1", "display_name": "potatosoup", "link": "https://stackoverflow.com/users/5000658/potatosoup"}, "edited": false, "score": 0, "creation_date": 1445979572, "post_id": 33377718, "comment_id": 54550606, "body": "Nice work @Hogan, solution a lot easier than what I expected. Thanks!"}, {"owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "reply_to_user": {"reputation": 35, "user_id": 5000658, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/1f381d128f581b28e5093a3efdcff4e0?s=128&d=identicon&r=PG&f=1", "display_name": "potatosoup", "link": "https://stackoverflow.com/users/5000658/potatosoup"}, "edited": false, "score": 0, "creation_date": 1445979709, "post_id": 33377718, "comment_id": 54550688, "body": "@potatosoup This is actually a basic building blocks of what sql does... Just wait... Your mind will soon be blown"}], "tags": [], "owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "is_accepted": true, "score": 0, "last_activity_date": 1445977192, "creation_date": 1445977192, "answer_id": 33377718, "question_id": 33376741, "link": "https://stackoverflow.com/questions/33376741/expanding-sql-insert-into-statement-ms-access/33377718#33377718", "title": "Expanding SQL INSERT INTO Statement (MS Access)", "body": "<p>Just specify the field.</p>\n\n<pre><code>INSERT INTO tblTest (LanguageID, CountryID)\nSELECT  tblCountry_Language.LanguageID, tblTerritory_Country.CountryID\nFROM    tblCountry_Language\nINNER JOIN tblTerritory_Country ON tblCountry_Language.Territory_CountryID = tblTerritory_Country.Territory_CountryID\nWHERE   tblTerritory_Country.TerritoryID = \"&amp; [Forms]![frmInput].[Form]![TerritoryID]&amp;\";\"\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5000658, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/1f381d128f581b28e5093a3efdcff4e0?s=128&d=identicon&r=PG&f=1", "display_name": "potatosoup", "link": "https://stackoverflow.com/users/5000658/potatosoup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 33377718, "answer_count": 1, "score": 0, "last_activity_date": 1445977192, "creation_date": 1445973572, "last_edit_date": 1445976886, "question_id": 33376741, "link": "https://stackoverflow.com/questions/33376741/expanding-sql-insert-into-statement-ms-access", "title": "Expanding SQL INSERT INTO Statement (MS Access)", "body": "<p>I have a current INSERT INTO function in Access VBA as follows:</p>\n\n<pre><code>INSERT INTO tblTest\nSELECT  tblCountry_Language.Language ID\nFROM    tblCountry_Language\n        INNER JOIN tblTerritory_Country\n            ON tblCountry_Language.Territory_CountryID = tblTerritory_Country.Territory_CountryID\nWHERE   tblTerritory_Country.TerritoryID = \"&amp; [Forms]![frmInput].[Form]![TerritoryID]&amp;\";\"\n</code></pre>\n\n<p>which works as desired; it basically grabs the listed languages from <code>tblCountry_Language</code> that match the territory specification of the user form.</p>\n\n<p>NOTE: <code>tblCountry_Language</code> has the unique ID <code>Country_LanguageID</code>, and the fields <code>Territory_CountryID</code> and <code>LanguageID</code>. <code>tblTerritory_Country</code> is just a one to many table that details all of the countries that belong to each territory.</p>\n\n<p>PROBLEM:\nFor new functionalities, I now want to bring in the <i> associated</i> <code>CountryID</code> from <code>tblTerritory_Country</code> that each of those <code>LanguageID</code>'s is paired with from <code>tblCountry_Language</code></p>\n\n<p>The logic would look something like the following:</p>\n\n<p>a)<code>LanguageID</code> directs to <code>Territory_CountryID</code> from <code>tblCountry_Language</code>,</p>\n\n<p>b) and I can grab <code>CountryID</code> <code>Territory_CountryID</code> based on the connected <code>Territory_CountryID</code></p>\n\n<p>How can I make the INSERT INTO statement insert <i> both </i> <code>LanguageID</code> and <code>CountryID</code> ?</p>\n\n<p>=================================   EDIT  #1 ================================</p>\n\n<p>Here's a visualization of the tables:</p>\n\n<pre><code>tblTerritory_Country\nTerritory_CountryID -----TerritoryID ----- CountryID\n                      |                |\n\ntblCountry_Language\nCountry_LanguageID ----- Territory_CountryID ----- LanguageID\n                     |               |               \n\n\ntblTest\nTestID ----- LanguageID ----- CountryID -----.....(More Irrelevant IDS)\n         |                |               | ............\n</code></pre>\n\n<p>I want to add into the current INSERT INTO statement something that triangulates the matching <code>Country_ID</code> to the same <code>Territory_CountryID</code> used in the inner join, and use that ID to grab CountryID from <code>tblTerritory_Country</code> and then insert it into <code>tblTest</code>.</p>\n"}]