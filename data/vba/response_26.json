[{"tags": ["vba", "excel", "range"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1436398682, "post_id": 31305391, "comment_id": 50600891, "body": "Be careful that the <code>Cells</code> inside the <code>Range</code> know where their parent is. See <a href=\"http://stackoverflow.com/questions/27763089/count-the-number-of-rows-in-another-sheet/27763394#27763394\">this</a>."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1436447380, "last_edit_date": 1436447380, "creation_date": 1436396922, "answer_id": 31305391, "question_id": 31305355, "link": "https://stackoverflow.com/questions/31305355/range-in-excel-to-go-from-a-specific-cell-to-the-end-of-the-column/31305391#31305391", "title": "Range in Excel to go from a specific cell to the end of the column", "body": "<p>You could do: <code>Worksheets(\"Sub\").Range(Cells(5,3),Cells(5,Cells(5,3).End(xltoLeft).column)).Select</code></p>\n\n<p>This will start at cell C5 (aka Cells(5,3)), and go left.</p>\n\n<p>edit: As Jeeped points out, it might be better to do:</p>\n\n<pre><code>With Worksheets(\"Sub\")\n    .Range(.Cells(5,3),.Cells(5,.Cells(5,3).End(xlToLeft).Column)).Select\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436462470, "post_id": 31305637, "comment_id": 50634911, "body": "nice answer, and it removes the whole &quot;.select&quot; business, which is good to learn."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1436398915, "last_edit_date": 1436398915, "creation_date": 1436398410, "answer_id": 31305637, "question_id": 31305355, "link": "https://stackoverflow.com/questions/31305355/range-in-excel-to-go-from-a-specific-cell-to-the-end-of-the-column/31305637#31305637", "title": "Range in Excel to go from a specific cell to the end of the column", "body": "<p>You don't have to copy and paste special, values. Transfer the values over directly and avoid using the clipboard.</p>\n\n<p>This could probably use one or two variable assignments to clean up the code. </p>\n\n<pre><code>With Worksheets(\"Sub\")\n    Worksheets(\"Master Worksheet\").Range(\"A1\") _\n      .Resize(.Range(.Cells(5, 3), .Cells(5, Columns.Count).End(xlToLeft)).Columns.Count, 1) = _\n      Application.Transpose(.Range(.Cells(5, 3), .Cells(5, Columns.Count).End(xlToLeft)).Value)\nEnd With\n</code></pre>\n\n<ol>\n<li>The code is a little long because we need to resize the destination in order to receive the values. As mentioned, one or more vars would clean it up tidily.</li>\n<li>When creating a <code>Range(Cells, Cells.End)</code> type cell range reference, MAKE SURE that the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow\">Range.Cells property</a> inside the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a> know what their <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224980(v=office.11).aspx\" rel=\"nofollow\">Range .Parent property</a> is. In this case, I've used a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With...End With statement</a> and prefixed the <code>.Cells</code> with a period (aka <em>full stop</em>) so that they know that they belong to <code>Worksheets(\"Sub\")</code> .</li>\n<li>Use <code>Application.Transpose</code> to flip the columns of values into rows.</li>\n</ol>\n"}], "owner": {"reputation": 27, "user_id": 1267620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e79cc8b93411e0cd568f3b9e4698ba?s=128&d=identicon&r=PG", "display_name": "NewtoCompSci", "link": "https://stackoverflow.com/users/1267620/newtocompsci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1436447380, "creation_date": 1436396733, "last_edit_date": 1436397256, "question_id": 31305355, "link": "https://stackoverflow.com/questions/31305355/range-in-excel-to-go-from-a-specific-cell-to-the-end-of-the-column", "title": "Range in Excel to go from a specific cell to the end of the column", "body": "<p>I am wondering how to define a range in order for it to be define from <strong><code>C5</code></strong> until the last value of the column. <strong><code>C5</code></strong> is a constant but the end of the list isn't.  </p>\n\n<pre><code>Sub Merge()\nWorksheets(\"Sub\").Range(\"C5\").End(xlToLeft).Select.copy\nWorksheets(\"Master Worksheet\").Range(\"A1:A23\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>End Sub</p>\n\n<p>I am getting a subscript out of range error. Any guidance would be really nice. </p>\n"}, {"tags": ["regex", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5096057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1d3cd7d7dfc99950f765bc1819fc2d?s=128&d=identicon&r=PG&f=1", "display_name": "wtsnk", "link": "https://stackoverflow.com/users/5096057/wtsnk"}, "edited": false, "score": 0, "creation_date": 1436448286, "post_id": 31305298, "comment_id": 50624739, "body": "thanks for the advice! those patterns definitely look more comprehensive.  unfortunately the split function still doesn&#39;t appear to be splitting. Values is still spitting out a Variant/String(0 to 0) leaving all the data as one string"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1436477483, "last_edit_date": 1495541167, "creation_date": 1436396446, "answer_id": 31305298, "question_id": 31305018, "link": "https://stackoverflow.com/questions/31305018/split-string-in-vba-using-regex-not-splitting/31305298#31305298", "title": "Split string in VBA using RegEx - Not Splitting", "body": "<p>The local article  on <a href=\"https://stackoverflow.com/questions/632475/regex-to-pick-commas-outside-of-quotes\">Regex to pick commas outside of quotes</a> has some slightly different pattern strings which appear successful.</p>\n\n<pre><code>'Pattern = /^([^\"]|\"[^\"]*\")*?(,)/\nregex.Pattern = \"/^([^\" &amp;  Chr(34) &amp; \"]|\" &amp;  Chr(34) &amp; \"[^\" &amp;  Chr(34) &amp; \"]*\" &amp;  Chr(34) &amp; \")*?(,)/\"\n\n'Pattern = /(,)(?=(?:[^\"]|\"[^\"]*\")*$)/\nregex.Pattern = \"/(,)(?=(?:[^\" &amp;  Chr(34) &amp; \"]|\" &amp;  Chr(34) &amp; \"[^\" &amp;  Chr(34) &amp; \"]*\" &amp;  Chr(34) &amp; \")*$)/\"\n</code></pre>\n\n<p>I would also suggest a less common delimiter to split on. ChrW(8203) (a zero-length unicode space) is a common delimiter for atoms and the like.</p>\n\n<pre><code>splitLine = Split(regex.Replace(line, ChrW(8203)), ChrW(8203))\n</code></pre>\n\n<p>I've culled together a working function using yet another regex pattern</p>\n\n<pre><code>Function stripCommasOutsideOfQuotedString(rng As Range)\n\n    Dim strPattern As String\n    Dim regEx As Object\n\n    Set regEx = CreateObject(\"VBScript.RegExp\")\n    'pattern is: ,(?=([^\"]*\"[^\"]*\")*(?![^\"]*\"))\n    strPattern = \",(?=([^\" &amp; Chr(34) &amp; \"]*\" &amp; Chr(34) &amp; \"[^\" &amp; Chr(34) &amp; \"]*\" &amp; Chr(34) &amp; \")*(?![^\" &amp; Chr(34) &amp; \"]*\" &amp; Chr(34) &amp; \"))\"\n    'Debug.Print strPattern\n\n    With regEx\n        .Global = True\n        .Pattern = strPattern\n    End With\n\n    stripCommasOutsideOfQuotedString = Split(regEx.Replace(rng.Value, ChrW(8203)), ChrW(8203))\nEnd Function\n</code></pre>\n\n<p>The above function can be array-entered into a series of columns to receive the split values.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5096057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1d3cd7d7dfc99950f765bc1819fc2d?s=128&d=identicon&r=PG&f=1", "display_name": "wtsnk", "link": "https://stackoverflow.com/users/5096057/wtsnk"}, "is_accepted": false, "score": 0, "last_activity_date": 1436881395, "creation_date": 1436881395, "answer_id": 31408426, "question_id": 31305018, "link": "https://stackoverflow.com/questions/31305018/split-string-in-vba-using-regex-not-splitting/31408426#31408426", "title": "Split string in VBA using RegEx - Not Splitting", "body": "<p>I'm no programmer, by any means, but I have managed to piece together this little guy to pull down info from yahoo finance for stock information. Figured I'd leave this here:</p>\n\n<pre><code>Function stripCommasOutsideOfQuotedString(rng As String) As String()\n\nDim strPattern As String\nDim regEx As Object\n\nSet regEx = CreateObject(\"VBScript.RegExp\")\n'pattern is: ,(?=([^\"]*\"[^\"]*\")*(?![^\"]*\"))\nstrPattern = \",(?=([^\" &amp; Chr(34) &amp; \"]*\" &amp; Chr(34) &amp; \"[^\" &amp; Chr(34) &amp; \"]*\" &amp; Chr(34) &amp; \")*(?![^\" &amp; Chr(34) &amp; \"]*\" &amp; Chr(34) &amp; \"))\"\n'Debug.Print strPattern\n\nWith regEx\n    .Global = True\n    .Pattern = strPattern\nEnd With\n\nstripCommasOutsideOfQuotedString = Split(regEx.Replace(rng, ChrW(8203)), ChrW(8203))\n\nEnd Function\n\nPrivate Sub btnRefresh_Click()\n  Dim W As Worksheet: Set W = ActiveSheet\n  Dim Last As Integer: Last = W.Range(\"A1000\").End(xlUp).Row\n  If Last = 1 Then Exit Sub\n  Dim Symbols As String\n  Dim i As Integer\n  For i = 2 To Last\n    Symbols = Symbols &amp; W.Range(\"A\" &amp; i).Value &amp; \"+\"\n  Next i\n  Symbols = Left(Symbols, Len(Symbols) - 1)\n\n\n  Dim URL As String: URL = \"http://finance.yahoo.com/d/quotes.csv?s=\" &amp; Symbols &amp; \"&amp;f=npobat8mwva2j1rey\"\n\n\n\n  Dim Http As New WinHttpRequest\n  Http.Open \"GET\", URL, False\n  Http.Send\n\n  Dim Resp As String: Resp = Http.ResponseText\n  Dim Lines As Variant: Lines = Split(Resp, vbLf)\n  Dim sLine As String\n  Dim Values As Variant\n  For i = 0 To UBound(Lines)\n    sLine = Lines(i)\n    If InStr(sLine, \",\") &gt; 0 Then\n\n        Values = stripCommasOutsideOfQuotedString(sLine)\n        W.Cells(i + 2, 2).Value = Replace(Values(0), Chr(34), \"\")\n        W.Cells(i + 2, 3).Value = Replace(Values(1), Chr(34), \"\")\n        W.Cells(i + 2, 4).Value = Replace(Values(2), Chr(34), \"\")\n        W.Cells(i + 2, 5).Value = Replace(Values(3), Chr(34), \"\")\n        W.Cells(i + 2, 6).Value = Replace(Values(4), Chr(34), \"\")\n        W.Cells(i + 2, 7).Value = Replace(Values(5), Chr(34), \"\")\n        W.Cells(i + 2, 8).Value = Replace(Values(6), Chr(34), \"\")\n        W.Cells(i + 2, 9).Value = Replace(Values(7), Chr(34), \"\")\n        W.Cells(i + 2, 10).Value = Replace(Values(8), Chr(34), \"\")\n        W.Cells(i + 2, 11).Value = Replace(Values(9), Chr(34), \"\")\n        W.Cells(i + 2, 12).Value = Replace(Values(10), Chr(34), \"\")\n        W.Cells(i + 2, 13).Value = Replace(Values(11), Chr(34), \"\")\n        W.Cells(i + 2, 14).Value = Replace(Values(12), Chr(34), \"\")\n        W.Cells(i + 2, 15).Value = Replace(Values(13), Chr(34), \"\")\n    End If\nNext i\nW.Cells.Columns.AutoFit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5096057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1d3cd7d7dfc99950f765bc1819fc2d?s=128&d=identicon&r=PG&f=1", "display_name": "wtsnk", "link": "https://stackoverflow.com/users/5096057/wtsnk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 763, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1436881395, "creation_date": 1436394907, "last_edit_date": 1531161705, "question_id": 31305018, "link": "https://stackoverflow.com/questions/31305018/split-string-in-vba-using-regex-not-splitting", "title": "Split string in VBA using RegEx - Not Splitting", "body": "<p>Really new at VBA/RegEx currently I have the RegEx function defined</p>\n\n<pre><code>Public Function splitLine(line As String) As String()\n\nDim regex As Object\nSet regex = CreateObject(\"vbscript.regexp\")\nregex.IgnoreCase = True\nregex.Global = True\n\n'This pattern matches only commas outside quotes\n'Pattern = \",(?=([^\"]\"[^\"]\")(?![^\"]\"))\"\nregex.Pattern = \",(?=([^\" &amp; Chr(34) &amp; \"]\" &amp; Chr(34) &amp; \"[^\" &amp; Chr(34) &amp; \"]\" &amp; Chr(34) &amp; \")(?![^\" &amp; Chr(34) &amp; \"]\" &amp; Chr(34) &amp; \"))\"\n\n\nsplitLine = Split(regex.Replace(line, \";\"), \";\")\n\nEnd Function\n</code></pre>\n\n<p>And I reference that with:</p>\n\n<pre><code>Dim Resp As String: Resp = Http.ResponseText\nDim Lines As Variant: Lines = Split(Resp, vbLf)\nDim sLine As String\nDim Values As Variant\n\nFor i = 0 To UBound(Lines)\n    sLine = Lines(i)\n    Values = splitLine(sLine)\n\n    Stop\n\nNext i\n</code></pre>\n\n<p>This isn't curerntly throwing an error - there is just no split happening.</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1436394697, "post_id": 31304875, "comment_id": 50599563, "body": "There is not a lot of difference between VBA and VBScript <a href=\"http://stackoverflow.com/questions/268648/how-do-i-sort-arrays-using-vbscript\" title=\"how do i sort arrays using vbscript\">stackoverflow.com/questions/268648/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1436461121, "last_edit_date": 1495540810, "creation_date": 1436461121, "answer_id": 31323857, "question_id": 31304875, "link": "https://stackoverflow.com/questions/31304875/ms-access-dictionary-sorting-and-manipulation/31323857#31323857", "title": "MS Access: dictionary sorting and manipulation", "body": "<p>You could use a Dictionary from the <em>Microsoft Scripting Runtime library</em>:</p>\n\n<p><a href=\"http://www.snb-vba.eu/VBA_Dictionary_en.html\" rel=\"nofollow noreferrer\">Dictionary in VBA</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/14808104/sorting-a-dictionary-by-key-in-vba\">Sorting a Dictionary</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436461121, "creation_date": 1436394279, "question_id": 31304875, "link": "https://stackoverflow.com/questions/31304875/ms-access-dictionary-sorting-and-manipulation", "title": "MS Access: dictionary sorting and manipulation", "body": "<p>Suppose I want to have a list of item as below</p>\n\n<pre><code>arr[\"john\"] = 40\narr[\"mark\"] = 12\narr[\"clark\"] = 53\narr[\"sam\"] = 23\n</code></pre>\n\n<p>Now I want to sort them depending on the values as below</p>\n\n<pre><code>arr[\"clark\"] = 53\narr[\"john\"] = 40\narr[\"sam\"] = 23\narr[\"mark\"] = 12\n</code></pre>\n\n<p>How can I do this?</p>\n"}, {"tags": ["excel", "vba", "object", "dictionary", "arguments"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1436395482, "creation_date": 1436395482, "answer_id": 31305139, "question_id": 31304812, "link": "https://stackoverflow.com/questions/31304812/argument-not-optional-error-when-returning-dictionary/31305139#31305139", "title": "Argument not optional error when returning dictionary", "body": "<p>I would suggest changing your function to a sub and passing the pre-declared dictionary object in as a parameter.</p>\n\n<pre><code>Public Sub constructParents(dPRNTs As Dictionary)\n\n    dPRNTs.RemoveAll\n    dPRNTs.CompareMode = TextCompare\n\n    dPRNTs.Add Key:=\"Joe &amp; Jill\", Item:=100\n    dPRNTs.Add Key:=\"Sam &amp; Sally\", Item:=200\n    dPRNTs.Add Key:=\"Dave &amp; Debbie\", Item:=300\n    dPRNTs.Add Key:=\"Bob &amp; Jane\", Item:=400\n    Debug.Print dPRNTs.Count\n\nEnd Sub\n\nPublic Sub ComputeChanges()\n\n    Dim dParents As New Dictionary, vKEY As Variant\n\n    constructParents dParents\n    'optionally use this if it makes more sense\n    'Call constructParents(dParents)\n\n    For Each vKEY In dParents\n        Debug.Print \"key: \" &amp; vKEY &amp; \", item: \" &amp; dParents.Item(vKEY)\n    Next vKEY\n\nEnd Sub\n</code></pre>\n\n<p>I've simplified your code in order that I did not have to completely duplicate the environment but I hope you can transcribe this method for your own purposes.</p>\n"}], "owner": {"reputation": 371, "user_id": 1943079, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/48ee4e6cb6918afbe4294c4c8f4a99d1?s=128&d=identicon&r=PG", "display_name": "user1943079", "link": "https://stackoverflow.com/users/1943079/user1943079"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 366, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436395482, "creation_date": 1436393890, "question_id": 31304812, "link": "https://stackoverflow.com/questions/31304812/argument-not-optional-error-when-returning-dictionary", "title": "Argument not optional error when returning dictionary", "body": "<p>I have the following code in VBA and i'm trying to capture the dictionary object returned by the first function Parents in the line that says \"Set Parents = Parents()\" but I keep getting the Argument not optional error. </p>\n\n<p>Everyone on the internet says it's usually because the Set keyword is missing but in this case it isn't. Any help is much appreciated, thanks!</p>\n\n<pre><code>Public Function Parents() As Dictionary\n    Dim FileNum As Integer\n    Dim DataLine As String\n    Dim FilePath As String\n    Set Parents = New Dictionary\n\n\n    FilePath = Application.ActiveWorkbook.Path &amp; \"\\parents.txt\"\n\n    FileNum = FreeFile()\n    Open FilePath For Input As #FileNum\n\n    While Not EOF(FileNum)\n        Line Input #FileNum, DataLine\n        Parents.Add DataLine, 1\n    Wend\nEnd Function\n\nPublic Sub ComputeChanges()\n    .\n    .\n    Dim Parents As Dictionary, Adjustments As Dictionary, inner As Dictionary, Changes As Dictionary\n    Set Parents = Parents()\n    .\n    .\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "is_accepted": false, "score": 1, "last_activity_date": 1436433746, "creation_date": 1436433746, "answer_id": 31313292, "question_id": 31304686, "link": "https://stackoverflow.com/questions/31304686/how-to-intercept-built-in-find-procedure/31313292#31313292", "title": "How to Intercept built-in Find Procedure?", "body": "<p>You can check if <code>Shift = 2</code>. The Shift value will be 1 if Shift is pressed, 2 if Ctrl is pressed, 4 if Alt is pressed, the sum of those values if two or three of those Buttons are pressed or 0 if None of them is pressed. So your <code>If</code> Statement should look like this: </p>\n\n<pre><code>If KeyCode = vbKeyF and Shift = 2 then\n    KeyCode = 0\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1436497789, "post_id": 31320425, "comment_id": 50648950, "body": "Thanks for that; I didn&#39;t realize that <code>shift</code> meant more than <i>shift</i>.  No clue about the ribbon find button?"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1436529589, "post_id": 31320425, "comment_id": 50664367, "body": "@BGM Unless they have Office Pro, I don&#39;t believe they have access to that."}, {"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1436534786, "post_id": 31320425, "comment_id": 50667956, "body": "Our entire office has Office Pro.  I have to figure something out because if they use it it will cause the application to hang."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1436537186, "post_id": 31320425, "comment_id": 50669731, "body": "@BGM I know how to entirely hide the ribbon from users, does that work for your situation?"}, {"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1436544759, "post_id": 31320425, "comment_id": 50674806, "body": "Newd - No, I&#39;m not ready to hide the ribbon completely.  Sorry to make a two-part question, but it&#39;s all closely related, and sometimes there&#39;s a lower level answer that satisfies both parts... If I can interecept the button&#39;s functionality then I would not have to remove it."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1436544920, "post_id": 31320425, "comment_id": 50674901, "body": "@BGM In that cause I am almost positive you are going to need to explore the custom ribbon path.  Unfortunately I don&#39;t have enough experience with it that I can be of much use.  I had dabbled, but not enough to pass on that knowledge."}], "tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 1, "last_activity_date": 1436452336, "last_edit_date": 1436452336, "creation_date": 1436451994, "answer_id": 31320425, "question_id": 31304686, "link": "https://stackoverflow.com/questions/31304686/how-to-intercept-built-in-find-procedure/31320425#31320425", "title": "How to Intercept built-in Find Procedure?", "body": "<p>If you want to disable (<kbd>Ctrl</kbd>+<kbd>F</kbd>) everywhere in your entire database you can do the following: </p>\n\n<p>\n<li>Create a macro called \"AutoKeys\" </li>\n<li>Once you have created this macro, double-click \"Submacro\" under Action Catalog </li>\n<li>Name that Submacro \"^F\" </li>\n<li>Leave the action empty </li>\n <br>\nBasically this should prevent (<kbd>Ctrl</kbd>+<kbd>F</kbd>) from working on any form in your database.  Additionally you should be able to create other Submacros for other key combinations you wish to control. </p>\n\n<p>I have never used this before myself and just tested it briefly and it worked fine.  Though I can neither condone nor condemn it with regards to long term usage. </p>\n\n<p><strong>Note:</strong> This was tested in MS Access 2010 so you may have to adjust for your version. </p>\n"}], "owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1436452336, "creation_date": 1436393209, "last_edit_date": 1495541165, "question_id": 31304686, "link": "https://stackoverflow.com/questions/31304686/how-to-intercept-built-in-find-procedure", "title": "How to Intercept built-in Find Procedure?", "body": "<p>In my Access project I have a custom find procedure.</p>\n\n<p>Now I want to eradicate the built-in Find procedure so the user doesn't try to use that.</p>\n\n<p>So I have two tasks to acccomplish:</p>\n\n<ol>\n<li>Intercept the <kbd>ctrl+F</kbd> hotkey</li>\n<li>Remove the Find button from the ribbon.</li>\n</ol>\n\n<p>On my main form I have <em>Key Preview</em> enabled, and I know how to <a href=\"https://stackoverflow.com/questions/31279201/how-to-absorb-a-keypress/31279270#31279270\">detect keypresses</a>, but I'm not sure how to detect the <kbd>ctrl</kbd> key.</p>\n\n<p>Now what do I do?</p>\n"}, {"tags": ["vb.net", "excel", "charts", "vba"], "comments": [{"owner": {"reputation": 1232, "user_id": 4847772, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fd5efa4bdec75631678b36842fea7c5a?s=128&d=identicon&r=PG&f=1", "display_name": "PJTraill", "link": "https://stackoverflow.com/users/4847772/pjtraill"}, "edited": false, "score": 0, "creation_date": 1436394526, "post_id": 31304673, "comment_id": 50599496, "body": "You could try reading the documentation."}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1436396794, "post_id": 31304673, "comment_id": 50600333, "body": "sounds like your question is doomed because it is too broad and no one will answer it on SO. Sorry"}, {"owner": {"reputation": 2873, "user_id": 643192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8815aa8e5b47ca9c65c7ebdf51a6f9f1?s=128&d=identicon&r=PG", "display_name": "yu_ominae", "link": "https://stackoverflow.com/users/643192/yu-ominae"}, "edited": false, "score": 0, "creation_date": 1436406823, "post_id": 31304673, "comment_id": 50602909, "body": "I think you right click the chart and then there should be dialogs that allow you to set all these options..."}], "answers": [{"tags": [], "owner": {"reputation": 107, "user_id": 5000848, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95fb1e27c3aeda003564a27548fed706?s=128&d=identicon&r=PG&f=1", "display_name": "bill", "link": "https://stackoverflow.com/users/5000848/bill"}, "is_accepted": true, "score": 0, "last_activity_date": 1436559620, "last_edit_date": 1495540274, "creation_date": 1436559620, "answer_id": 31349625, "question_id": 31304673, "link": "https://stackoverflow.com/questions/31304673/creating-and-editing-excel-chart/31349625#31349625", "title": "Creating and Editing Excel Chart", "body": "<p>Thank you. I have found the solution to these problems. Please see my other post\n<a href=\"https://stackoverflow.com/questions/31329726/how-to-set-the-xvalues-of-a-series-in-excel-using-vb-net\">How to set the XValues of a series in excel using vb.net</a></p>\n\n<p>The example shows how to create a chart and most of the formatting methods. There is one minor error in the code which has been answered by TnTinMn in the post. </p>\n"}], "owner": {"reputation": 107, "user_id": 5000848, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95fb1e27c3aeda003564a27548fed706?s=128&d=identicon&r=PG&f=1", "display_name": "bill", "link": "https://stackoverflow.com/users/5000848/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2887, "favorite_count": 0, "accepted_answer_id": 31349625, "answer_count": 1, "score": 0, "last_activity_date": 1436559620, "creation_date": 1436393124, "last_edit_date": 1531161705, "question_id": 31304673, "link": "https://stackoverflow.com/questions/31304673/creating-and-editing-excel-chart", "title": "Creating and Editing Excel Chart", "body": "<p>I am trying to create a data analysis program using vb.net. The data is in an excel file. The X Values are in A col from A2, Y Values are in B col from B2. </p>\n\n<p>I am able to generate a chart from this data. </p>\n\n<p>How do I format the chart:</p>\n\n<ol>\n<li>Add Title</li>\n<li>Change the line color in the chart to any specified color</li>\n<li>Add a trend line (polynomial)</li>\n<li>Modify the color of the trend line </li>\n<li>Add another series(Data Set plot) to the chart</li>\n<li>Edit the Series names</li>\n<li>X,Y Labels</li>\n</ol>\n\n<p>Any other formatting tips are appreciated. </p>\n\n<p>Sorry for my ambiguous question. So what am trying to do is to automate excel to create some charts using vb.net. </p>\n\n<p>I am not sure how to implement this since I am new to vb.net. I am able to create a micro in excel which does all the functions. But I am not sure how to code this in vb.net. </p>\n\n<p>Is there a way to convert this vba excel micro to vb.net?</p>\n\n<pre><code>Sub Macro2()\n  '\n  ' Macro2 Macro\n  '\n\n  '\n   Range(\"B1:B14\").Select\n   ActiveSheet.Shapes.AddChart.Select\n   ActiveChart.ChartType = xlXYScatterSmoothNoMarkers\n   ActiveChart.SetSourceData Source:=Range(\"Sheet1!$B$1:$B$14\")\n   ActiveChart.SeriesCollection(1).Select\n   With Selection.Format.Line\n       .Visible = msoTrue\n       .ForeColor.ObjectThemeColor = msoThemeColorAccent1\n       .ForeColor.TintAndShade = 0\n       .ForeColor.Brightness = 0\n   End With\n   With Selection.Format.Line\n       .Visible = msoTrue\n       .ForeColor.RGB = RGB(255, 0, 0)\n       .Transparency = 0\n   End With\n   ActiveChart.SeriesCollection(1).Trendlines.Add\n   ActiveChart.SeriesCollection(1).Trendlines(1).Select\n   With Selection\n       .Type = xlPolynomial\n       .Order = 2\n   End With\nEnd Sub\n</code></pre>\n\n<p>Thank you. </p>\n"}, {"tags": ["excel", "vba", "formula", "units-of-measurement", "evaluate"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 5095809, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1R4UfI_f2ws/AAAAAAAAAAI/AAAAAAAAGGQ/_SyDPDrnK54/photo.jpg?sz=128", "display_name": "Shawn Pauliszyn", "link": "https://stackoverflow.com/users/5095809/shawn-pauliszyn"}, "edited": false, "score": 0, "creation_date": 1436397222, "post_id": 31305130, "comment_id": 50600464, "body": "Hi John and thanks.  I may not be able to go and programmatically alter the characters this way every time I enter a formula.  I was thinking of just insert the symbol from the INSERT -&gt; SYMBOL command on the ribbon, in the actual font I am using (such as Arial or Calibri).  Alternatively I already programmed some of the basic ones and greek into my AUTOCORRECT such as \\a gives me \u03b1, * gives me &#183;, _| gives me \u22a5, \\^2 gives me &#178;, \\/ gives me \u221a, etc.  Alternatively, alternatively I can just hold Alt and type the character code and get it that way.  Alt-0248 gives me &#248;."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 129, "user_id": 5095809, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1R4UfI_f2ws/AAAAAAAAAAI/AAAAAAAAGGQ/_SyDPDrnK54/photo.jpg?sz=128", "display_name": "Shawn Pauliszyn", "link": "https://stackoverflow.com/users/5095809/shawn-pauliszyn"}, "edited": false, "score": 0, "creation_date": 1436406740, "post_id": 31305130, "comment_id": 50602881, "body": "I wasn&#39;t thinking of programmatically altering each and every formula in the explicit way my sub did it. That was just to illustrate that VBA is able to adjust font on individual characters and thus create strings which display as combinations of ordinary characters and symbols. To make it useful, you would need to create a sort of code where e.g. \\p is pi (sort of like what you are already doing with autocorrect) and then have VBA implement the translation scheme. What you already do sounds clever, but a VBA approach might be more flexible."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1436395433, "creation_date": 1436395433, "answer_id": 31305130, "question_id": 31304421, "link": "https://stackoverflow.com/questions/31304421/how-to-evaluate-typed-out-formulas-in-excel/31305130#31305130", "title": "How to evaluate typed-out formulas in Excel", "body": "<p>Those are tall orders. The following sub might give you an idea for your first question:</p>\n\n<pre><code>Sub test()\n    Dim R As Range\n    Set R = Range(\"A1\")\n    R.Value = \"A = pr2\"\n    R.Characters(5, 1).Font.Name = \"Symbol\"\n    R.Characters(7, 1).Font.Superscript = True\nEnd Sub\n</code></pre>\n\n<p>Run it an then look at the contents of A1</p>\n\n<p>As far as your second question goes - sure you can do it, but you would need to write a full-fledged expression parser. Writing one from scratch is fairly involved (at least a couple hundred lines of code) and is probably best done by using classes to create a custom tree data type then writing a recursive descent parser to parse strings into expression trees. Doable, though I have neither the time nor the inclination to do so.</p>\n\n<p>I'm not quite sure what you are driving at with your last question, though my gut reaction is that it is easier than your second question since no real parsing is required and it is easy enough to create a dictionary of conversion factors.  </p>\n"}], "owner": {"reputation": 129, "user_id": 5095809, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1R4UfI_f2ws/AAAAAAAAAAI/AAAAAAAAGGQ/_SyDPDrnK54/photo.jpg?sz=128", "display_name": "Shawn Pauliszyn", "link": "https://stackoverflow.com/users/5095809/shawn-pauliszyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1436395433, "creation_date": 1436392094, "question_id": 31304421, "link": "https://stackoverflow.com/questions/31304421/how-to-evaluate-typed-out-formulas-in-excel", "title": "How to evaluate typed-out formulas in Excel", "body": "<p>If I type the formula <code>1/4*pi()*($A$1)^2</code> as a string in a cell and assuming I have a value in $A$1, I use the following VBA function in a third cell to evaluate the formula:</p>\n\n<pre><code>Public Function E(byval TextFormula as String) as Variant\n  E = Evaluate(TextFormula)\nEnd Function  \n</code></pre>\n\n<p>Is there a way to use math characters like \u2022, \u221a, \u00bc, \u03c0, \u00b2, etc. so that my typed-out formula looks more agreeable?  Even translate '[' and ']' as '(' and ')'.  I can just iterate through an array replacements using REPLACE() function for the simple characters but what about the extended characters like \u03c0?</p>\n\n<p>For the really sharp macro'ers...</p>\n\n<p>What about showing intermediate steps (iterations) as in <code>(2*3) + (2.5*4)</code> evaluates to <code>6 + 10</code> in the first iteration and then <code>16</code> in the next iteration.  Asside: I would want the iterations to stop just before each set of addings/subtractings because I sometimes like to know what the relative magnitudes of the individual evaluated terms are to see what part of my formula is controlling the result.</p>\n\n<p>And for the mega-genius ones...</p>\n\n<p>What about mixed units?  Such as typing out <code>560{lbs}/[1.23{m}*3.4{'}]</code> and getting my result in <code>###{psf}</code> as an example.  I thought that the unit could be delineated by the underscore such as <code>34_kN</code> but I think a start and end delineation is required for compound units like <code>34{kN/m^2}</code>.  There would need to be a way to force the output to a desired unit (ie. mm instead of in) like maybe setting up your desired units ahead in your sheet and then it would at least try to convert to one of those units.  I think at this stage you will be charging me for the code;)</p>\n\n<p>I like using Excel for my engineering calculations because I only use simpler formulas (no calculus!) and I don't want to constantly switch between Excel and Mathcad apps but use only one.</p>\n\n<p>Shawn</p>\n"}, {"tags": ["vba", "loops"], "answers": [{"tags": [], "owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "is_accepted": false, "score": 0, "last_activity_date": 1436391395, "creation_date": 1436391395, "answer_id": 31304252, "question_id": 31304206, "link": "https://stackoverflow.com/questions/31304206/for-loop-vba-with-2-variable/31304252#31304252", "title": "For loop Vba with 2 variable", "body": "<p>Why not hierarchical?</p>\n\n<pre><code>For x = LBound(arrayOne) To UBound(arrayOne)\n    For y = LBound(arrayTwo) To UBound(arrayTwo)\n        Call Sub(x, y) \n    Next y\nNext x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "edited": false, "score": 0, "creation_date": 1436392588, "post_id": 31304368, "comment_id": 50598759, "body": "Simple and effective."}], "tags": [], "owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "is_accepted": true, "score": 0, "last_activity_date": 1436391865, "creation_date": 1436391865, "answer_id": 31304368, "question_id": 31304206, "link": "https://stackoverflow.com/questions/31304206/for-loop-vba-with-2-variable/31304368#31304368", "title": "For loop Vba with 2 variable", "body": "<p>One <code>For Next</code> loop cannot use two indexers<br>\nIf you sure that arrays are same size, then you can use same indexer for both arrays</p>\n\n<pre><code>Dim i As Integer\nFor i = LBound(arrayOne) To UBound(arrayOne)\n    Call Sub(arrayOne(i), arrayTwo(i)) \nNext i\n</code></pre>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 31304368, "answer_count": 2, "score": 0, "last_activity_date": 1436391865, "creation_date": 1436391222, "question_id": 31304206, "link": "https://stackoverflow.com/questions/31304206/for-loop-vba-with-2-variable", "title": "For loop Vba with 2 variable", "body": "<p>arrayOne(1) = A arrayTwo(1) = B <br>\narrayOne(2) = C arrayTwo(2) = D <br>\narrayOne(3) = E arrayTwo(3) = F <br></p>\n\n<p>I need to loop through two arrays to call a sub. Note the sub is always called in pair, e.g.: </p>\n\n<p>Sub(arrayOne(1), arrayTwo(1)) <br>\nSub(arrayOne(2), arrayTwo(2)) <br>    </p>\n\n<p>Is it possible  to initialize a for with two variables? Something like that:</p>\n\n<pre><code>For x = LBound(arrayOne) To UBound(arrayOne) and y = LBound(arrayTwo) To UBound(arrayTwo)\n\n   Call Sub(x, y) \n\nNext x\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "cell", "columnsorting"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1436440980, "post_id": 31304174, "comment_id": 50619376, "body": "Actually, I think that you should show that sorting code. So, we can solve easily."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1436452787, "post_id": 31304174, "comment_id": 50628487, "body": "How are you determining that certain cells are clicked?  <code>Worksheet_SelectionChange</code>?  If so, this is intended behavior as the cells move around while being sorted.  Can you included the code for however you are detecting the event?  Please <a href=\"https://stackoverflow.com/posts/31304174/edit\">edit</a> that detail into the question."}, {"owner": {"reputation": 121, "user_id": 4927266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65e645a523006e7f77a49bb3977053d3?s=128&d=identicon&r=PG&f=1", "display_name": "elt2jdavis", "link": "https://stackoverflow.com/users/4927266/elt2jdavis"}, "edited": false, "score": 0, "creation_date": 1436538286, "post_id": 31304174, "comment_id": 50670477, "body": "Thanks Byron, that was correct.  I didn&#39;t realize I had copy pasted the wrong sub name.  To fix the problem I replaced <code>Worksheet_Selectionchange</code> with <code>Worksheet_BeforeDoubleClick</code>.  This required a double click vice a single click, but prevented the macro from running when I didn&#39;t want it to."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 2, "creation_date": 1436550260, "post_id": 31304174, "comment_id": 50677646, "body": "Sounds like you fixed it?  Can you add your solution as answer and accept it?  Helps folks in the future and those of us looking for unanswered questions."}, {"owner": {"reputation": 121, "user_id": 4927266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65e645a523006e7f77a49bb3977053d3?s=128&d=identicon&r=PG&f=1", "display_name": "elt2jdavis", "link": "https://stackoverflow.com/users/4927266/elt2jdavis"}, "edited": false, "score": 0, "creation_date": 1436818479, "post_id": 31304174, "comment_id": 50761694, "body": "Thanks Byron, I added my solution."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 4927266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65e645a523006e7f77a49bb3977053d3?s=128&d=identicon&r=PG&f=1", "display_name": "elt2jdavis", "link": "https://stackoverflow.com/users/4927266/elt2jdavis"}, "is_accepted": true, "score": 1, "last_activity_date": 1436560334, "creation_date": 1436560334, "answer_id": 31349813, "question_id": 31304174, "link": "https://stackoverflow.com/questions/31304174/sorting-column-triggers-click-to-run-macro-how-do-i-fix-this/31349813#31349813", "title": "Sorting column triggers click to run Macro...How do I fix this?", "body": "<p>Sorting will trigger <code>Worksheet_SelectionChange</code> because the range is selected in the sorting process.  Using <code>Worksheet_BeforeDoubleClick</code> instead will run the macro with a double click on the desired cell and the event will not be triggered by sorting.</p>\n\n<p>The following code worked for me:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    If Selection.Count = 1 Then\n        If Not Intersect(Target, Range(\"AI13:AI10000\")) Is Nothing Then\n            MsgBox \"Hello World!\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4927266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65e645a523006e7f77a49bb3977053d3?s=128&d=identicon&r=PG&f=1", "display_name": "elt2jdavis", "link": "https://stackoverflow.com/users/4927266/elt2jdavis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1026, "favorite_count": 0, "accepted_answer_id": 31349813, "answer_count": 1, "score": 1, "last_activity_date": 1436669754, "creation_date": 1436391048, "last_edit_date": 1436669754, "question_id": 31304174, "link": "https://stackoverflow.com/questions/31304174/sorting-column-triggers-click-to-run-macro-how-do-i-fix-this", "title": "Sorting column triggers click to run Macro...How do I fix this?", "body": "<p>I have some code that runs a macro when certain cells are clicked.  The problem is that sorting a column also causes the macro to run.  How can I prevent this code from running when a column is sorted?</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Selection.Count = 1 Then\n        If Not Intersect(Target, Range(\"AI13:AI10000\")) Is Nothing Then\n            MsgBox \"Hello World!\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>I'm pretty sure it's irrelevant, but the rest of my code is simply for taking values from one workbook and using it to filter pivot tables in another workbook.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "asp.net", "vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1436410196, "post_id": 31304064, "comment_id": 50603711, "body": "C# or Vb which one is it. According to code its not C#. Please fix the tags..."}], "answers": [{"tags": [], "owner": {"reputation": 856, "user_id": 1404038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/871378e0b9fac80c52dc519a75f1e101?s=128&d=identicon&r=PG", "display_name": "Sarin Vadakkey Thayyil", "link": "https://stackoverflow.com/users/1404038/sarin-vadakkey-thayyil"}, "is_accepted": false, "score": 1, "last_activity_date": 1436390997, "creation_date": 1436390997, "answer_id": 31304162, "question_id": 31304064, "link": "https://stackoverflow.com/questions/31304064/export-datatable-to-excel-file-xlsx/31304162#31304162", "title": "Export Datatable to Excel File (.XLSX)", "body": "<p>Your are creating a TSV - tab separated value.\nInstead .xlsx try using .tsv</p>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 4911512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IJhcB.png?s=128&g=1", "display_name": "Carey Tzou", "link": "https://stackoverflow.com/users/4911512/carey-tzou"}, "is_accepted": false, "score": -1, "last_activity_date": 1436393919, "creation_date": 1436393919, "answer_id": 31304815, "question_id": 31304064, "link": "https://stackoverflow.com/questions/31304064/export-datatable-to-excel-file-xlsx/31304815#31304815", "title": "Export Datatable to Excel File (.XLSX)", "body": "<p>If you want to export as excel, maybe you can the third-party lib NPOI to make a excel object.</p>\n"}], "owner": {"reputation": 73, "user_id": 4811783, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/fe69ac067b63ebbe203a5c6175a18aa0?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Bravo", "link": "https://stackoverflow.com/users/4811783/johnny-bravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1436393919, "creation_date": 1436390637, "last_edit_date": 1531161705, "question_id": 31304064, "link": "https://stackoverflow.com/questions/31304064/export-datatable-to-excel-file-xlsx", "title": "Export Datatable to Excel File (.XLSX)", "body": "<p>I use this code to export Datatable to excel file (.xlsx)</p>\n\n<pre><code>Dim attachment As String = \"attachment; filename=Excel.xlsx\"\n    Response.ClearContent()\n    Response.AddHeader(\"content-disposition\", attachment)\n    Response.ContentType = \"application/vnd.ms-excel\"\n    Dim tab As String = \"\"\n    For Each dc As DataColumn In dt.Columns\n        Response.Write(tab + dc.ColumnName)\n        tab = vbTab\n    Next\n    Response.Write(vbLf)\n\n    Dim i As Integer\n    For Each dr As DataRow In dt.Rows\n        tab = \"\"\n        For i = 0 To dt.Columns.Count - 1\n            Response.Write(tab &amp; dr(i).ToString())\n            tab = vbTab\n        Next\n        Response.Write(vbLf)\n    Next\n    Response.End()\n</code></pre>\n\n<p>When I download the file I get This message :</p>\n\n<p>\"Excel cannot open the file 'Excel.xlsx' because the file format or file extension is not valid \"</p>\n\n<p>I use Excel 2010</p>\n\n<p>Any Ideas why ?!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436391225, "post_id": 31304021, "comment_id": 50598109, "body": "If you are using wildcards, you need to use <code>... Like &quot;Pickup*&quot;</code> and <code>... Like  &quot;Red*&quot;</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436391649, "post_id": 31304021, "comment_id": 50598317, "body": "a) What is <code>Sheets(&quot;Sheet1&quot;).Text(&quot;C&quot; &amp; x).Value</code> intended to reference? b) what worksheet is intended to receive the formulas?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436392736, "post_id": 31304021, "comment_id": 50598829, "body": "Do you want to put a formula into the worksheet or resolve the formula result within VBA and put the result value into the worksheet?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1436669731, "post_id": 31304021, "comment_id": 50708336, "body": "Please do not use the <a href=\"http://stackoverflow.com/tags/macros/info\"><b>macros</b> tag</a> for MS Office / VBA."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5086508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948cf822be22ad27924426b74b9e5000?s=128&d=identicon&r=PG&f=1", "display_name": "How About It", "link": "https://stackoverflow.com/users/5086508/how-about-it"}, "is_accepted": false, "score": 0, "last_activity_date": 1436393655, "creation_date": 1436393655, "answer_id": 31304774, "question_id": 31304021, "link": "https://stackoverflow.com/questions/31304021/excel-vba-populate-a-column-on-one-sheet-with-values-from-another-sheet-based/31304774#31304774", "title": "Excel VBA - Populate a column on one sheet with values from another sheet based on 3 criteria (complicated IF AND related VBA with wildcards)", "body": "<p>My knee-jerk reaction is to use two different functions, since color and type are interdependent: one for handling the year and one for handling the type and  color of the vehicle.  Something like</p>\n\n<pre><code>Sub ValueFill()\n   For car = 1 to last 'this is your loop over the cars in Sheet1\n     color = type_color(car)\n     year = get_year(car)\n     price = Sheets(\"FEEDER\").Cells(year, color).value\nFunction get_year(car)\n     'gets the year value for a give car and returns the corresponding row \n      number of that year, i.e car year 2009 is row 10 in FEEDER\n  End Function\nFunction type_color()\n   'will first get the type then convert based on color\n   'gets the type of the car and returns the left column index for that type\n         'i.e. type = pickup then column index = 3  (Column C)\n    if color not same as column value from above then\n        offset it\n        'i.e. for a blue pickup column index + 1 -&gt; 4\n  end function\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1436393669, "creation_date": 1436393669, "answer_id": 31304777, "question_id": 31304021, "link": "https://stackoverflow.com/questions/31304021/excel-vba-populate-a-column-on-one-sheet-with-values-from-another-sheet-based/31304777#31304777", "title": "Excel VBA - Populate a column on one sheet with values from another sheet based on 3 criteria (complicated IF AND related VBA with wildcards)", "body": "<p>Here is a partial rewrite of your sample code. It isn't enough to finalize the module but perhaps it can get you started.</p>\n\n<pre><code>Sub ValueFill()\n    Dim x As Long, wsf As Worksheet, app As Application\n\n    Set app = Application\n    Set wsf = Sheets(\"FEEDER\")\n\n    With Sheets(\"Sheet1\")\n        For x = 3 To .Cells(Rows.Count, 1).End(xlUp).Row\n            Select Case Left(LCase(.Cells(x, 1).Text), 5)\n                Case \"picku\"\n                    Select Case Left(LCase(.Cells(x, 3).Text), 3)\n                        Case \"red\"\n                            'unclear on whether you want a value or a formula - pick one of these\n                            .Range(\"I\" &amp; x).Value = app.Index(wsf.Columns(3), app.Match(.Cells(x, 6).Value, wsf.Columns(2), 0))\n                            '.Range(\"I\" &amp; x).Formula = \"=INDEX(Feeder!C:C, MATCH(F\" &amp; x &amp; \", Feeder!B:B, 0))\"\n                            '.Range(\"I\" &amp; x).FormulaR1C1 = \"=INDEX(Feeder!C3, MATCH(RC6, Feeder!C2, 0))\"\n                        Case \"blu\"\n                            .Range(\"I\" &amp; x).Value = app.Index(wsf.Columns(4), app.Match(.Cells(x, 6).Value, wsf.Columns(2), 0))\n                        Case Else\n                            'do nothing\n                    End Select\n                Case \"sedan\"\n                    Select Case Left(LCase(.Cells(x, 3).Text), 3)\n                        Case \"red\"\n                            .Range(\"I\" &amp; x).Value = app.Index(wsf.Columns(5), app.Match(.Cells(x, 6).Value, wsf.Columns(2), 0))\n                        Case \"blu\"\n                            .Range(\"I\" &amp; x).Value = app.Index(wsf.Columns(6), app.Match(.Cells(x, 6).Value, wsf.Columns(2), 0))\n                        Case Else\n                            'do nothing\n                    End Select\n                Case Else\n                    Debug.Print \"not it\"\n            End Select\n        Next x\n\n    End With\n    Set wsf = Nothing\n    Set app = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>If more information about the nature of the FEEDER worksheet was provided, a one-size-fits-all formula may be able to be developed.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5095746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98468852adf9dd7e922661763e497e6?s=128&d=identicon&r=PG&f=1", "display_name": "malteaser", "link": "https://stackoverflow.com/users/5095746/malteaser"}, "edited": false, "score": 0, "creation_date": 1436541250, "post_id": 31311221, "comment_id": 50672580, "body": "First of all, I want to thank everyone who has commented with solutions. Apologies for being slow to respond.   Nicolas, your code fits the bill. I didn&#39;t think of the approach you took which makes plenty of sense when I analyze the coding. I thank you 100X over for the assistance. I will be able to expand on this and complete the task."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 21, "user_id": 5095746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98468852adf9dd7e922661763e497e6?s=128&d=identicon&r=PG&f=1", "display_name": "malteaser", "link": "https://stackoverflow.com/users/5095746/malteaser"}, "edited": false, "score": 0, "creation_date": 1436706273, "post_id": 31311221, "comment_id": 50715622, "body": "OK...if this is work for you, mark as answer. Thanks..!"}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1436430313, "last_edit_date": 1436430313, "creation_date": 1436428134, "answer_id": 31311221, "question_id": 31304021, "link": "https://stackoverflow.com/questions/31304021/excel-vba-populate-a-column-on-one-sheet-with-values-from-another-sheet-based/31311221#31311221", "title": "Excel VBA - Populate a column on one sheet with values from another sheet based on 3 criteria (complicated IF AND related VBA with wildcards)", "body": "<p>Actually, I am not familiar with excel functions. But, I can do it with vba code only.</p>\n\n<p>Thanks, this is very good question. Try it with my idea.</p>\n\n<p>Here, my approach for your problem. You don't need anything to modify. Just copy and run. It work well.</p>\n\n<pre><code>Public Sub fillValue()\n\n    Dim inventorySheet, priceSheet As Worksheet\n    Dim inventoryRow, priceRow As Integer\n    Dim redPickup, bluePickup, redSedan, blueSedan, redRoadster, blueRoadster As String\n    Dim automobileType, automobileColor, automobilePrice As String\n    Dim isFound As Boolean\n\n    'Set sheet for common use.\n    Set inventorySheet = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set priceSheet = ThisWorkbook.Worksheets(\"FEEDER\")\n\n    'Price list in FEEDER sheet are stable.\n    'So, we can use them as constant.\n    'I initialize them as follow. You can add more column.\n    redPickup = \"C\"\n    bluePickup = \"D\"\n    redSedan = \"E\"\n    blueSedan = \"F\"\n    redRoadster = \"G\"\n    blueRoadster = \"H\"\n\n    'Set the start row Sheet1 sheet\n    inventoryRow = 3\n\n    'Looping all data from \"Sheet1\" sheet.\n    'One thing that the main colum is Automobile Type. So, loop until it is blank.\n    Do While inventorySheet.Range(\"A\" &amp; inventoryRow) &lt;&gt; \"\"\n\n        'First, get the price row from FEEDER sheet for manufacture year.\n\n        'Reset flag.\n        isFound = False\n\n        'Set the start row of FEEDER sheet.\n        priceRow = 4\n\n        'Loop manufacture year column of FEEDER sheet until blank\n        Do While priceSheet.Range(\"B\" &amp; priceRow) &lt;&gt; \"\"\n\n            If priceSheet.Range(\"B\" &amp; priceRow) = inventorySheet.Range(\"F\" &amp; inventoryRow) Then\n\n                'Set true for exist record for manufacture year\n                isFound = True\n\n                'Exit loop\n                Exit Do\n\n            End If\n\n            priceRow = priceRow + 1\n\n        Loop\n\n        'If there is no record for price, we should not do anything.\n        'If price record for manufacture year is exist, take the price.\n        If isFound Then\n\n            'Second, getting the automobile type from Sheet1.\n\n            'Get Automobile Type from sheet\n            automobileType = inventorySheet.Range(\"A\" &amp; inventoryRow)\n\n            'Split by space\n            splitedValues = Split(Trim(automobileType), \" \")\n\n            'Get last word for automobile type\n            automobileType = splitedValues(UBound(splitedValues))\n\n\n            'Third, get the automobile color.\n\n            'Get Automobile Color from sheet.\n            automobileColor = inventorySheet.Range(\"C\" &amp; inventoryRow)\n\n            'Split by \"-\"\n            splitedValues = Split(Trim(automobileColor), \"-\")\n\n            'Get first word for automobile type\n            automobileColor = splitedValues(LBound(splitedValues))\n\n\n            'Reset automobile price.\n            automobilePrice = \"\"\n\n            'Fouth, check type and color and get price\n            Select Case automobileType\n\n             Case \"Roadster\"\n\n                If automobileColor = \"Red\" Then\n                    automobilePrice = priceSheet.Range(redRoadster &amp; priceRow)\n                Else\n                    automobilePrice = priceSheet.Range(blueRoadster &amp; priceRow)\n                End If\n\n\n             Case \"Sedan\"\n\n                If automobileColor = \"Red\" Then\n                    automobilePrice = priceSheet.Range(redSedan &amp; priceRow)\n                Else\n                    automobilePrice = priceSheet.Range(blueSedan &amp; priceRow)\n                End If\n\n\n             Case \"Pickup\"\n\n                If automobileColor = \"Red\" Then\n                    automobilePrice = priceSheet.Range(redPickup &amp; priceRow)\n                Else\n                    automobilePrice = priceSheet.Range(bluePickup &amp; priceRow)\n                End If\n\n            End Select\n\n            'Fifth, set the price in inventory sheet.\n            inventorySheet.Range(\"I\" &amp; inventoryRow) = automobilePrice\n\n        Else\n\n            'Set error for miss.\n            inventorySheet.Range(\"I\" &amp; inventoryRow) = \"Error\"\n\n        End If\n\n        'Increase inventory row\n        inventoryRow = inventoryRow + 1\n\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>Here, my evidence for your problem.</p>\n\n<p>My prepare data for \"Sheet1\" sheet.</p>\n\n<p><img src=\"https://i.stack.imgur.com/sjbWk.png\" alt=\"enter image description here\"></p>\n\n<p>My prepare data for \"FEEDER\" sheet.</p>\n\n<p><img src=\"https://i.stack.imgur.com/tyPQV.png\" alt=\"enter image description here\"></p>\n\n<p>After running code, I got this result.</p>\n\n<p><img src=\"https://i.stack.imgur.com/KfpO0.png\" alt=\"enter image description here\"></p>\n\n<p>Have a nice job..!</p>\n"}], "owner": {"reputation": 21, "user_id": 5095746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98468852adf9dd7e922661763e497e6?s=128&d=identicon&r=PG&f=1", "display_name": "malteaser", "link": "https://stackoverflow.com/users/5095746/malteaser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6247, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1585350170, "creation_date": 1436390509, "last_edit_date": 1436669710, "question_id": 31304021, "link": "https://stackoverflow.com/questions/31304021/excel-vba-populate-a-column-on-one-sheet-with-values-from-another-sheet-based", "title": "Excel VBA - Populate a column on one sheet with values from another sheet based on 3 criteria (complicated IF AND related VBA with wildcards)", "body": "<p>I am new at Excel VBA and despite my efforts I cannot seem to find a similar example online to use as a solution to my issue.</p>\n\n<p>I am creating a table of data related to an inventory of automobiles. The workbook that I have set up has two tabs. The first is labeled \"FEEDER\", and contains a table of hardcoded inputs (automobile values). The second is labeled \"Sheet1\" and contains raw data for all inventory. Sheet 1 requires automobile values in column \"I\". My goal is to set the workbook up so that a Column I labeled \"Values\" within \"Sheet1\", would be autopopulated with the click of a button from value inputs from the FEEDER sheet. The tricky part (for me) is that the values are based on 1) the automobile type (i.e. sedan/ pickup/ etc.), 2) the color (different colors have slightly different values), and 3) the Manufacture year. I was approaching this at first like an IF AND statement, but thought creating a macro would be a more efficient route to take. </p>\n\n<p>I have a working list, but many more automobile types to go (400+ total). If I could get a some help at thsi stage I can [hopefully] figure out the rest.</p>\n\n<p>Your help would be greatly appreciated.</p>\n\n<p>Screen Shots here: <a href=\"https://transportcit.box.com/AutoInventoryVBA\" rel=\"nofollow\">FEEDER Table and SHEET1 Inventory List</a></p>\n\n<p>My code:</p>\n\n<pre><code>Sub ValueFill()\nDim x As Integer\nFor x = 3 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nIf UCase(Sheets(\"Sheet1\").Range(\"A\" &amp; x).Text) = \"Pickup*\" And UCase(Sheets(\"Sheet1\").Text(\"C\" &amp; x).Value) = \"Red*\" Then\n        Range(\"I\" &amp; x).Formula = Application.WorksheetFunction.Index(Sheets(\"FEEDER\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row, Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"f\" &amp; x), Sheets(\"Feeder\").Range(\"b\" &amp; Rows.Count).End(xlUp).Row, 0), 1)\nElseIf UCase(Sheets(\"Sheet1\").Range(\"A\" &amp; x).Text) = \"Pickup*\" And UCase(Sheets(\"Sheet1\").Text(\"C\" &amp; x).Value) = \"Blue*\" Then\n        Range(\"I\" &amp; x).Formula = Application.WorksheetFunction.Index(Sheets(\"FEEDER\").Range(\"D\" &amp; Rows.Count).End(xlUp).Row, Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"f\" &amp; x), Sheets(\"Feeder\").Range(\"b\" &amp; Rows.Count).End(xlUp).Row, 0), 1)\nElseIf UCase(Sheets(\"Sheet1\").Range(\"A\" &amp; x).Text) = \"Sedan*\" And UCase(Sheets(\"Sheet1\").Text(\"C\" &amp; x).Value) = \"Red*\" Then\n        Range(\"I\" &amp; x).Formula = Application.WorksheetFunction.Index(Sheets(\"FEEDER\").Range(\"E\" &amp; Rows.Count).End(xlUp).Row, Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"f\" &amp; x), Sheets(\"Feeder\").Range(\"b\" &amp; Rows.Count).End(xlUp).Row, 0), 1)\nElseIf UCase(Sheets(\"Sheet1\").Range(\"A\" &amp; x).Text) = \"Sedan*\" And UCase(Sheets(\"Sheet1\").Text(\"C\" &amp; x).Value) = \"Blue*\" Then\n        Range(\"I\" &amp; x).Formula = Application.WorksheetFunction.Index(Sheets(\"FEEDER\").Range(\"F\" &amp; Rows.Count).End(xlUp).Row, Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"f\" &amp; x), Sheets(\"Feeder\").Range(\"b\" &amp; Rows.Count).End(xlUp).Row, 0), 1)\n\n'I would keep \"ElseIf-ing\" for each combination of auto type and color, then index match by year...\n\nElse: Range(\"I\" &amp; x).Text = \"Error\"\n\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1436390507, "post_id": 31303970, "comment_id": 50597790, "body": "I have 21 items and I don&#39;t think Excel will like me after so many if then. lol"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1436391894, "post_id": 31303970, "comment_id": 50598437, "body": "Then you could try doing Index/Match, or vLookup even - I&#39;m pretty sure those are ok in Data Validation.  But I see you used hLookup, so glad to see you found a solution!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1574832891, "last_edit_date": 1574832891, "creation_date": 1436390359, "answer_id": 31303970, "question_id": 31303888, "link": "https://stackoverflow.com/questions/31303888/clear-2nd-dependent-drop-down-excel/31303970#31303970", "title": "Clear 2nd Dependent Drop Down Excel", "body": "<p>In the second drop down, you can use formulas.  If your fruit choices are in one column, and the vegetable choices are in another, you can do something like the following...</p>\n\n<p>Assuming that your Drop Down 1 is in A10, your list of Fruits is C1:C10, list of Vegetables is D1:D10:</p>\n\n<p>For the second drop down in cell A20, go to Data Validation -> List.  Instead of just choosing your list of either Fruits, or Vegetables, do this <code>=If(A10=\"Fruit\",c1:c10,d1:d10)</code>.</p>\n\n<p>Then, as you change the A1 value from Fruits to Vegetables, your second drop down will update the list choices.</p>\n\n<p>Edit: I don't know if you are going to be adding to those lists of fruits/vegetables, but you can also used <a href=\"https://support.office.com/en-ca/article/Define-and-use-names-in-formulas-4d0f13ac-53b7-422e-afd2-abd7ff379c64\" rel=\"nofollow noreferrer\">named ranges</a>.  If you name all of your Fruit choices as, say, \"Fruit\", and vegetables as \"Vegetables\", the data validation can use these named ranges: <code>=If(A10=\"Fruit\",Fruits,Vegetables)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "is_accepted": false, "score": 1, "last_activity_date": 1436391116, "creation_date": 1436391116, "answer_id": 31304186, "question_id": 31303888, "link": "https://stackoverflow.com/questions/31303888/clear-2nd-dependent-drop-down-excel/31304186#31304186", "title": "Clear 2nd Dependent Drop Down Excel", "body": "<p>I realized I was doing this all the hard way. Instead of doing a second drop down, I removed it and I decided to do HLOOKUP. Then I could find the word in question. </p>\n\n<p>Many thanks to all those that have answered.</p>\n"}], "owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574832891, "creation_date": 1436390077, "last_edit_date": 1531161705, "question_id": 31303888, "link": "https://stackoverflow.com/questions/31303888/clear-2nd-dependent-drop-down-excel", "title": "Clear 2nd Dependent Drop Down Excel", "body": "<p>I finally figured out how to make a dependent drop down. FINALLY.</p>\n\n<p>My problem is when I change the first drop down, the second one still has the options from the first option.</p>\n\n<p>Drop down 1:</p>\n\n<p>Fruit<br>\nVegetables</p>\n\n<p>Fruits Drop Down info:\nApples<br>\nBananas</p>\n\n<p>Vegetables Drop Down info: \nCarrots<br>\nCucumbers</p>\n\n<p>If I choose Fruit, I can choose Apples. However, if I choose Vegetables, Apples is still an option until I change it. </p>\n\n<p>Is there a solution to purge the second drop down every time a change is made on the first one?</p>\n\n<p>I found: <a href=\"https://stackoverflow.com/questions/30129119/dependent-drop-down-list-in-excel-auto-update\">Dependent drop down list in excel auto update</a> but I'm confused on how to make it work for my situation. Drop down is in A10 and secondary is A20. My next plan is to learn VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1436390038, "post_id": 31303648, "comment_id": 50597548, "body": "<i>All responses I&#39;ve seen regarding restarting a Do Until loop address the user&#39;s code logic rather than identifying how to do the restart</i>  that&#39;s because wanting to restart the loop is a clear sign of flawed logic!  I suggest you address the real issue rather than try to bandaid bad code."}, {"owner": {"reputation": 35, "user_id": 4569300, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/g6RxD.jpg?s=128&g=1", "display_name": "GeorgeInNC", "link": "https://stackoverflow.com/users/4569300/georgeinnc"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1436545374, "post_id": 31303648, "comment_id": 50675162, "body": "Thanks, Chris, I understand and agree completely."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4569300, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/g6RxD.jpg?s=128&g=1", "display_name": "GeorgeInNC", "link": "https://stackoverflow.com/users/4569300/georgeinnc"}, "edited": false, "score": 0, "creation_date": 1436457084, "post_id": 31303847, "comment_id": 50631569, "body": "I&#39;ve tried to avoid GoTo, but in this case it&#39;s the simplest solution.  Thanks."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "reply_to_user": {"reputation": 35, "user_id": 4569300, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/g6RxD.jpg?s=128&g=1", "display_name": "GeorgeInNC", "link": "https://stackoverflow.com/users/4569300/georgeinnc"}, "edited": false, "score": 0, "creation_date": 1436457321, "post_id": 31303847, "comment_id": 50631714, "body": "Completely agree, sometimes you have to accept an answer that may not be ideal to get moving on to the next part of your project.  Perhaps flag that section with a note to refactor when you can dive in a bit deeper as @chris-neilsen suggested in his comments."}], "tags": [], "owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "is_accepted": false, "score": 0, "last_activity_date": 1436389933, "creation_date": 1436389933, "answer_id": 31303847, "question_id": 31303648, "link": "https://stackoverflow.com/questions/31303648/need-to-restart-an-excel-vba-do-until-loop/31303847#31303847", "title": "Need to Restart an Excel VBA Do...Until Loop", "body": "<p>One way would be to use a \"goto\" statement, like so:</p>\n\n<pre><code>For i = 1 To numPlayers\n    replacementDone = 0\n\n    LoopStart:\n    Do Until replacementDone &lt;&gt; 0\n        replaceCards = InputBox(\"blah...blah\")\n        If replaceCards &lt;&gt; 0 Then\n            replace100 = Application.Round((replaceCards / 100), 0)\n            If replace100 &lt; 5 Then\n                Players(i, replace100) = Deck(DeckIndex)\n                DeckIndex = DeckIndex + 1\n            Else\n                MsgBox \"Invalid entry - try again.\"\n                GoTo LoopStart\n            End If\n            replace10 = Application.Round(Application.Mod(replaceCards, 100) / 10, 0)\n            If replace10 &lt; 5 And replace10 &gt; replace100 Then\n                Players(i, replace10) = Deck(DeckIndex)\n                DeckIndex = DeckIndex + 1\n            Else\n                MsgBox \"Invalid entry - try again.\"\n                GoTo LoopStart\n            End If\n            replace1 = Application.Round(Application.Mod(replaceCards, 10), 0)\n            If replace1 &lt; 5 And replace1 &gt; replace10 Then\n                Players(i, replace1) = Deck(DeckIndex)\n                DeckIndex = DeckIndex + 1\n            Else\n                MsgBox \"Invalid entry - try again.\"\n                GoTo LoopStart\n            End If\n        End If\n    Loop\nNext i\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4569300, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/g6RxD.jpg?s=128&g=1", "display_name": "GeorgeInNC", "link": "https://stackoverflow.com/users/4569300/georgeinnc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 672, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436389933, "creation_date": 1436389276, "last_edit_date": 1531164843, "question_id": 31303648, "link": "https://stackoverflow.com/questions/31303648/need-to-restart-an-excel-vba-do-until-loop", "title": "Need to Restart an Excel VBA Do...Until Loop", "body": "<p>Here's the code about which I will seek assistance:</p>\n\n<pre><code>For i = 1 To numPlayers\n    replacementDone = 0\n    Do Until replacementDone &lt;&gt; 0\n        replaceCards = InputBox(\"blah...blah\")\n        If replaceCards &lt;&gt; 0 Then\n            replace100 = Application.Round((replaceCards / 100), 0)\n            If replace100 &lt; 5 Then\n                Players(i, replace100) = Deck(DeckIndex)\n                DeckIndex = DeckIndex + 1\n            Else\n                MsgBox \"Invalid entry - try again.\"\n            End If\n            replace10 = Application.Round(Application.Mod(replaceCards, 100) / 10, 0)\n            If replace10 &lt; 5 And replace10 &gt; replace100 Then\n                Players(i, replace10) = Deck(DeckIndex)\n                DeckIndex = DeckIndex + 1\n            Else\n                MsgBox \"Invalid entry - try again.\"\n            End If\n            replace1 = Application.Round(Application.Mod(replaceCards, 10), 0)\n            If replace1 &lt; 5 And replace1 &gt; replace10 Then\n                Players(i, replace1) = Deck(DeckIndex)\n                DeckIndex = DeckIndex + 1\n            Else\n                MsgBox \"Invalid entry - try again.\"\n            End If\n        End If\n    Loop\nNext i\n</code></pre>\n\n<p>At each point where an <code>If</code> statement is untrue and the <code>MsgBox \"Invalid entry - try again.\"</code> is to appear, I want to restart the <code>Do Until</code> loop.  All responses I've seen regarding restarting a <code>Do Until</code> loop address the user's code logic rather than identifying how to do the restart.  Help is greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "formulas"], "answers": [{"tags": [], "owner": {"reputation": 164, "user_id": 2577529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3lCwg.jpg?s=128&g=1", "display_name": "iamstrained", "link": "https://stackoverflow.com/users/2577529/iamstrained"}, "is_accepted": true, "score": 0, "last_activity_date": 1436391499, "creation_date": 1436391499, "answer_id": 31304273, "question_id": 31303502, "link": "https://stackoverflow.com/questions/31303502/need-help-on-excel-autocomplete-function-for-drop-down-list/31304273#31304273", "title": "Need help on excel autocomplete function for drop-down list", "body": "<p>There is a very handy guide for doing just that, but <strong>you need to rely on a mixture of VBA and form controls</strong>, specifically comboboxes. The initial method was outlined in a slightly revamped <a href=\"http://www.contextures.com/xlDataVal10.html\" rel=\"nofollow\">guide by Contextures</a>. </p>\n\n<p>This guide was later expanded into, what I felt, was a slightly easier and more robust method dubbed <a href=\"http://www.experts-exchange.com/articles/12362/The-magical-floating-ActiveX-control.html\" rel=\"nofollow\">\"the magical floating activeX control\".</a></p>\n\n<p>I hope you have luck with those two - but knowledge of VBA will help you get the most out of it. You have to customize their setup to match your data structures. I use this method to produce 'autocomplete' forms for users in my organization. So far, my one extension has been to make an 'on/off' button for this code, because it's method runs <em>constantly</em>, meaning that you lose the ability to do UNDO in excel while the lookup/autocomplete code is available to the user. I strongly advise setting up a button/feature that allows a user to disable it when not in use.</p>\n\n<p>For enable/disable, here is the very-rough code that will do the job to ensure the code doesn't execute when you don't want it to. This disables the 'catch' that watches for the intial value change in the script from the links above.</p>\n\n<pre><code>   If Application.EnableEvents = False Then\n    Application.EnableEvents = True\n    btn_Enable.ForeColor = 0\nElse\n    Application.EnableEvents = False\n    btn_Enable.ForeColor = 35653\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5095784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TS4hV.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5095784/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 31304273, "answer_count": 1, "score": 1, "last_activity_date": 1436391499, "creation_date": 1436388766, "question_id": 31303502, "link": "https://stackoverflow.com/questions/31303502/need-help-on-excel-autocomplete-function-for-drop-down-list", "title": "Need help on excel autocomplete function for drop-down list", "body": "<p>I'm trying to add an auto-complete function to some of the boxes on the first sheet that I have for entering data on an excel worksheet, but I can't figure out how so. Here's the link for the excel document. <a href=\"https://drive.google.com/file/d/0B2ksoDGxry1tR2JGNnhoSEZuYU0/view?usp=sharing\" rel=\"nofollow\">https://drive.google.com/file/d/0B2ksoDGxry1tR2JGNnhoSEZuYU0/view?usp=sharing</a></p>\n\n<p>I have read some of the articles here but I didn't really get how to apply them to my work. </p>\n"}, {"tags": ["mysql", "sql", "sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 1, "creation_date": 1436388647, "post_id": 31303145, "comment_id": 50596845, "body": "You can&#39;t really do that without adding a separate query table for each item number within your spreadsheet. You could, however, add a query table that looks up the information you need for ALL item numbers, then do a lookup to join the item numbers in your excel sheet to the information from the query table."}, {"owner": {"reputation": 9, "user_id": 5095717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f92dd6d4a8e4fb6169cf44d3905448?s=128&d=identicon&r=PG&f=1", "display_name": "CollegeHelp", "link": "https://stackoverflow.com/users/5095717/collegehelp"}, "reply_to_user": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1436446765, "post_id": 31303145, "comment_id": 50623631, "body": "I have too much data to do a query table I need to make the item numbers a parameter of the query"}, {"owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1436456235, "post_id": 31303145, "comment_id": 50631013, "body": "Well, the only other solution I can think of is to set up a connection to the database, loop through each of the item numbers in your spreadsheet, pass a query for each one, and return the results of that query next to it, but I wouldn&#39;t be able to help you with that without more info on the database and your spreadsheet."}, {"owner": {"reputation": 9, "user_id": 5095717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f92dd6d4a8e4fb6169cf44d3905448?s=128&d=identicon&r=PG&f=1", "display_name": "CollegeHelp", "link": "https://stackoverflow.com/users/5095717/collegehelp"}, "reply_to_user": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1436475283, "post_id": 31303145, "comment_id": 50642161, "body": "Can you provide a mock example?"}], "answers": [{"tags": [], "owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "is_accepted": false, "score": 0, "last_activity_date": 1436539542, "creation_date": 1436539542, "answer_id": 31343742, "question_id": 31303145, "link": "https://stackoverflow.com/questions/31303145/sql-query-is-updated-when-user-updates-excel/31343742#31343742", "title": "SQL Query is updated when user updates Excel", "body": "<p>Keep in mind that this is a mock example for what you are trying to do. With no knowledge of your database or spreadsheet, I can't guarantee that any of this will even work. At the very least, it will require you to make some adjustments before you can use it.</p>\n\n<p>With that in mind, I have commented on various parts of the code to let you know what is going on there. The sections that have a <code>***</code> are areas that you may want to change. The sections with <code>###</code> are areas that you will <strong>HAVE</strong> to change for it to work for you.</p>\n\n<p>This code assumes that you have a list of item numbers in column A of sheet 1, that each item number will only return one record, and that there are no blank cells in your list of item numbers.</p>\n\n<pre><code>Sub GrabItemInfo()\nDim objADO As New ADODB.Connection\nDim objRecSet As New ADODB.Recordset\nDim objCmd As New ADODB.Command\nDim strConn As String\nDim strSQL As String\nDim RowNum As Long\nDim errNum As Long\n\n'open a connection to the database\n'### change the properties for the connection to suit your needs\nstrConn = \"DSN=DSNName; DBQ=Database; UID=Username; PWD=Password\"\nobjADO.Open strConn\nobjCmd.ActiveConnection = objADO\nobjCmd.CommandType = adCmdText\n\n'errNum is the row that the error log will start on\n'***change errNum to change which row it starts on\nerrNum = 1\n'***changeRowNum here to change which row to start on\nRowNum = 1\n'start the loop\nDo Until ThisWorkbook.Sheets(1).Cells(RowNum, 1) = \"\"\n    On Error Resume Next\n    '### change the sql to whatever you need\n    '*** change the cells section if you're not using the first column\n    strSQL = \"SELECT [field] FROM [table] WHERE ItemNum = \" &amp; ThisWorkbook.Sheets(1).Cells(RowNum, 1).Value\n    objCmd.CommandText = strSQL\n    Set objRecSet = objCmd.Execute\n    'pastes results from query into the cell next to the item number\n    '***change the cells section if you want to use a different column\n    ThisWorkbook.Sheets(1).Cells(RowNum, 2).CopyFromRecordset objRecSet\n    'clear out the recordset before the loops starts again\n    Set objRecSet = Nothing\n    'put the item number, error number, and error description on the second sheet of the work book\n    '***change the sheet number to put it on another sheet if you're already using the second\n    If Err &gt; 0 Then\n        ThisWorkbook.Sheets(2).Cells(errNum, 1).Value = ThisWorkbook.Sheets(1).Cells(RowNum, 1).Value\n        ThisWorkbook.Sheets(2).Cells(errNum, 2).Value = Err.Number\n        ThisWorkbook.Sheets(2).Cells(errNum, 3).Value = Err.Description\n        On Error GoTo 0\n    End If\n    'raise the value for the row for the next iteration\n    RowNum = RowNum + 1\nLoop\n\n'clear out the connection\nSet objADO = Nothing\nSet objRecSet = Nothing\nSet objCmd = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>For more information on connection strings, I recommend <a href=\"http://www.connectionstrings.com\" rel=\"nofollow\">http://www.connectionstrings.com</a>\nIt's a great resource to use for figuring out what kind of connection string you need. Connections strings can be...tricky...sometimes, and this really helps.</p>\n\n<p>If you need any resources for SQL, I would recommend <a href=\"http://www.w3schools.com/sql\" rel=\"nofollow\">http://www.w3schools.com/sql</a>\nThey have a good introduction to it there. Past that, get a good reference book, find a mentor, join forums(or Q&amp;A sites like this one), etc. If you look into the SQL tag on this site, there is more information, along with some recommended resources as well.</p>\n\n<p>Good luck.</p>\n"}], "owner": {"reputation": 9, "user_id": 5095717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f92dd6d4a8e4fb6169cf44d3905448?s=128&d=identicon&r=PG&f=1", "display_name": "CollegeHelp", "link": "https://stackoverflow.com/users/5095717/collegehelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1436539542, "creation_date": 1436387621, "last_edit_date": 1436387859, "question_id": 31303145, "link": "https://stackoverflow.com/questions/31303145/sql-query-is-updated-when-user-updates-excel", "title": "SQL Query is updated when user updates Excel", "body": "<p>I have an excel document that I want to link to an SQL query. In the excel document I have a list of item numbers. Whenever an item number gets changed I want the sql query to query that list of item numbers and return an output. Basically I want the excel sheet to use the Item Number as a parameter for the database item numbers ? The excel item numbers are updated daily. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1436396130, "post_id": 31302787, "comment_id": 50600107, "body": "I created code for functionality similar to yours. If you find it helpful I can give you more details: <a href=\"http://codereview.stackexchange.com/questions/93879/select-and-paste-rows-in-a-different-location/94046#94046\">processing by groups</a>"}, {"owner": {"reputation": 11, "user_id": 5086599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68053b97a8b8c1d70d82b85b1af364b2?s=128&d=identicon&r=PG&f=1", "display_name": "HP-12C", "link": "https://stackoverflow.com/users/5086599/hp-12c"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1436448297, "post_id": 31302787, "comment_id": 50624749, "body": "@paulbica Thanks! I did find it helpful, generally (I got lost in a few parts; this is my first time coding not in Java). Would it help you understand my situation more if I attached a screenshot of the workbooks I am using? Thanks again."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1436448595, "post_id": 31302787, "comment_id": 50624994, "body": "It would help to know more details about the data. The most effective (for me) is to know the source(s) with any exceptions you might have, and the expected result, then we can modify the other version quite easily"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1436451796, "post_id": 31302787, "comment_id": 50627669, "body": "<code>I can&#39;t get the function to work</code>.  Please <a href=\"https://stackoverflow.com/posts/31302787/edit\">edit</a> the question with more detail about what is not working: does it return an error, a bad value, inconsistent values, a picture of a spider?  A summary of inputs/expected outputs/actual outputs is generally ideal.  Also, if the function is the only problem, it would be better if the question only addresses that issue."}, {"owner": {"reputation": 11, "user_id": 5086599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68053b97a8b8c1d70d82b85b1af364b2?s=128&d=identicon&r=PG&f=1", "display_name": "HP-12C", "link": "https://stackoverflow.com/users/5086599/hp-12c"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1436453587, "post_id": 31302787, "comment_id": 50629103, "body": "@Byron The question has been updated at the bottom. My error is that right now, my Sub works perfectly for the first copy+paste portion, but then won&#39;t switch back to the first workbook for copying the rest of the data. It just stays on the destination workbook and copys from cells on the sheet, instead of from the original workbook."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1436454144, "post_id": 31302787, "comment_id": 50629506, "body": "Oh, that&#39;s much clearer.  Since you are using <code>Range(&quot;D12&quot;)</code> by itself, you need to be sure that the <code>ActiveWorkbook</code> and <code>ActiveSheet</code> refer to the objects you expect.  I am suspicious of your <code>Set wb2 = ActiveWorkbook</code> since that will erase whatever object was referenced before.  Should that be <code>wb2.Activate</code> instead?  Also, you might want to see <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros?s=2|3.4997\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a> to avoid a lot of this <code>Select</code> <code>Activate</code> business."}, {"owner": {"reputation": 11, "user_id": 5086599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68053b97a8b8c1d70d82b85b1af364b2?s=128&d=identicon&r=PG&f=1", "display_name": "HP-12C", "link": "https://stackoverflow.com/users/5086599/hp-12c"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1436455050, "post_id": 31302787, "comment_id": 50630164, "body": "@Byron I have tried switching it to <code>wb2.Activate</code>     but that doesn&#39;t seem to make a difference. Interestingly, my code works if I manually switch over to (use the mouse to click on) the original workbook anytime before the <code>Set wb2 =  ActiveWorkbook</code> / <code>wb2.Activate</code> line. However, if I don&#39;t do that, it just selects <code>Cells(12,13)</code> on the destination workbook instead.  I will also check out your link."}], "owner": {"reputation": 11, "user_id": 5086599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68053b97a8b8c1d70d82b85b1af364b2?s=128&d=identicon&r=PG&f=1", "display_name": "HP-12C", "link": "https://stackoverflow.com/users/5086599/hp-12c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1436453401, "creation_date": 1436386397, "last_edit_date": 1436453401, "question_id": 31302787, "link": "https://stackoverflow.com/questions/31302787/finishing-code-vba-function-to-skip-blank-cells-and-begin-a-procedure-whenever", "title": "Finishing Code - VBA Function to Skip Blank Cells and Begin A Procedure Whenever It Comes Across Text", "body": "<p>I have a spreadsheet that has broad groups in column A and then specific data points in column B (with more data throughout those specific rows). It looks very roughly like this:</p>\n\n<pre><code>  A            B            C           D           E        F\nGroup         Name        Weight      Gross        Net     Contribution\nEquity                      25%        10%          8%       .25\n              IBM           5%         15%         12%    \n              AAPL          7%         23%         18%\nFixed Income                25%        5%           4%       .17\n            10 Yr Bond      10%        7%           5%\nEmerging Mrkts            \n</code></pre>\n\n<p>I want my macro to scroll through column A until it finds a \"Group\" (e.g. Equity) and then have it spit out the name as well as some other data for each specific holding within every group.</p>\n\n<p>I have started writing this macro, and have a procedure (that works) and a function. But I can't get the function to work. Can you take a look and tell me what you see wrong? Thanks</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Demo1()\n    Dim Ptr As Integer\n    Ptr = 12\n    ActiveSheet.Cells(1, Ptr).Select\n\n    Dim Wb As Workbook\n    Set Wb = ThisWorkbook\n    Dim Wb2 As Workbook\n\n    For Each Wb2 In Application.Workbooks\n        Wb2.Activate\n    Next\n    Set Wb2 = ActiveWorkbook\n\n    ' Set Wb = ActiveWorkbook\n    Wb.Activate\n\n    'Sheets(\"Attribution\").Select\n    ActiveSheet.Cells(Ptr, 2).Select\n    Selection.Copy\n    '  Sheets(\"F2 perf Chart\").Range(\"E7\") = ActiveSheet.Cells(12, 2).Value\n    'Set Wb2 = ActiveWorkbook\n    Wb2.Activate\n    ActiveSheet.Cells(1, Ptr).Select\n    Wb2.Sheets(\"F2 perf Chart\").Range(\"E7\").Select\n    ActiveSheet.Paste\n\n    Set Wb = ActiveWorkbook\n    Range(\"M12\").Copy\n    Set Wb2 = ActiveWorkbook\n    Wb2.Sheets(\"F2 perf Chart\").Range(\"F7\").Select\n    ActiveSheet.Paste\n\n    Set Wb = ActiveWorkbook\n    Range(\"D12\").Copy\n    Set Wb2 = ActiveWorkbook\n    Wb2.Sheets(\"F2 perf Chart\").Range(\"G7\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>And for the function:</p>\n\n<pre><code>Function NumBlankCells(Rownum As Integer) As Integer\n    Dim RetVar As Integer\n    Set RetVar = 0\n    Dim rRng As Object\n    rRng = Sheets(\"Attribution\").Cells(Rownum + 1, 1)\n    While IsEmpty(rRng.Value)\n        RetVar = RetVar + 1\n        rRng = Sheets(\"Attribution\").Cells(Rownum + RetVar + 1, 1)\n    Loop\n\n\n    MsgBox RetVar\n\n    NumBlankCells = RetVar\n\n\nEnd Function\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>So Workbook 1 (\"Attribution\") is all this data that has been exported from a program. Workbook 2 (\"F2 perf Chart\") is a template that I use to self-populate a graph that is used in a quarterly report. An example of one of the data subsets I am trying to pull is  the Name, the Weight, and then the Net Return(\"IBM, 5%, 12%\") - and then I am pasting it into Workbook 2, in a different order (\"IBM, 12%, 5%\"). I am trying to get this to run through and copy-paste each data point under the Name column, and my function is an attempt to use the blank spaces in between each group to tell itself that it should skip these blank rows.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1436386190, "post_id": 31302643, "comment_id": 50595475, "body": "What error are you getting?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1436386497, "post_id": 31302643, "comment_id": 50595657, "body": "You are attempting to save as a CSV. This means that you can only save the single current worksheet in a multi-worksheet workbook."}, {"owner": {"reputation": 533, "user_id": 4775844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/381d952439316c3764777f0bdab45379?s=128&d=identicon&r=PG&f=1", "display_name": "EDC", "link": "https://stackoverflow.com/users/4775844/edc"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1436386661, "post_id": 31302643, "comment_id": 50595760, "body": "@MatthewD I cannot check this right now, but I will add the information as soon as possible. Thanks for your interest."}, {"owner": {"reputation": 533, "user_id": 4775844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/381d952439316c3764777f0bdab45379?s=128&d=identicon&r=PG&f=1", "display_name": "EDC", "link": "https://stackoverflow.com/users/4775844/edc"}, "edited": false, "score": 0, "creation_date": 1436386725, "post_id": 31302643, "comment_id": 50595799, "body": "@Jeeped I know that. But that means I have to activate it? Is not usually enough to just refer to the objects thoroughly, like up to the parent etc.?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1436386857, "post_id": 31302643, "comment_id": 50595883, "body": "I have done alot of Excel programming and i have never had anything slow even though i activate all the time to switch sheets.  If you are not having any performance issues , i wouldn&#39;t worry about it."}, {"owner": {"reputation": 533, "user_id": 4775844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/381d952439316c3764777f0bdab45379?s=128&d=identicon&r=PG&f=1", "display_name": "EDC", "link": "https://stackoverflow.com/users/4775844/edc"}, "edited": false, "score": 0, "creation_date": 1436388269, "post_id": 31302643, "comment_id": 50596649, "body": "MatthewD alright that sounds very good, but I got kind of curious - why do we sometimes need to Activate and sometimes we don&#39;t, that is so confusing to me. In my code, I was able to avoid it 95% of times now just by referencing clearly, but I don&#39;t understand why it is not possible in the above case. Moreover, btw, it is also not possible to avoid when running a routine from another workbook, by using a macro in the currently opened workbook."}], "answers": [{"comments": [{"owner": {"reputation": 533, "user_id": 4775844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/381d952439316c3764777f0bdab45379?s=128&d=identicon&r=PG&f=1", "display_name": "EDC", "link": "https://stackoverflow.com/users/4775844/edc"}, "edited": false, "score": 0, "creation_date": 1436388210, "post_id": 31303148, "comment_id": 50596623, "body": "Krishna thanks for your reponse. I am using an older vers of Excel and there was some bug by trying to save Worksheets directly before. I will check it again though"}], "tags": [], "owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "is_accepted": true, "score": 1, "last_activity_date": 1436387640, "creation_date": 1436387640, "answer_id": 31303148, "question_id": 31302643, "link": "https://stackoverflow.com/questions/31302643/avoiding-activate-by-saving-files-when-using-many-workbooks/31303148#31303148", "title": "Avoiding Activate by saving files when using many workbooks", "body": "<p>when you want to save a sheet as csv, why dont you use the worksheet in question directly. workbook save as csv requires to know the active sheet</p>\n\n<pre><code>Private Sub saveWorksheet(pathx, wbkn, sheetn)\n    dim ws as worksheet\n    path = pathx &amp; \".csv\"\n    set ws = worksheets(sheetn)\n    ws.SaveAs Filename:=path, FileFormat:=xlCSV, Local:=True, CreateBackup:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 533, "user_id": 4775844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/381d952439316c3764777f0bdab45379?s=128&d=identicon&r=PG&f=1", "display_name": "EDC", "link": "https://stackoverflow.com/users/4775844/edc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "accepted_answer_id": 31303148, "answer_count": 1, "score": 0, "last_activity_date": 1436395674, "creation_date": 1436385971, "last_edit_date": 1495541677, "question_id": 31302643, "link": "https://stackoverflow.com/questions/31302643/avoiding-activate-by-saving-files-when-using-many-workbooks", "title": "Avoiding Activate by saving files when using many workbooks", "body": "<p>I have a special cases, where I cannot find a way around <code>Activate</code> which is considered to be bad (slow) coding in VBA. In this case I am looping over sheets of an original workbook, copy contents from those sheets - under certain conditions - then paste these contents into a new workbook and finally try to save the result to csv-files. I am doing this by using the following save-routine:</p>\n\n<pre><code>Private Sub saveWorksheet(pathx, wbkn, sheetn)\n\npath = pathx &amp; \".csv\"\nWorkbooks(wbkn).Sheets(sheetn).Activate\n\nWorkbooks(wbkn).SaveAs Filename:=path, _\nFileFormat:=xlCSV, Local:=True, CreateBackup:=False\n\nEnd Sub\n</code></pre>\n\n<p>If I don't use <code>Activate</code> I get an error. Is there any way to avoid it when saving files?</p>\n\n<p>edit: Some info on why <code>Activate</code> is considered bad:\n<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a>\n<a href=\"https://stackoverflow.com/questions/7180008/excel-select-vs-activate\">Excel Select vs Activate</a></p>\n\n<p>edit2: After some research and testing, I found out that the problem is not the save method itself, but rather the context of multiple workbooks being involved. I do not think you can prevent <code>Activate</code> when saving a file from <em>another</em> workbook or also when running a macro on <em>another</em> workbook, while doing also stuff on the 'original' base-workbook. You can only prevent its use when you are working on the same (ie 'original') workbook all the time.\nPlease correct me if I am wrong.</p>\n"}, {"tags": ["excel", "vba", "debugging", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5095644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d4a4797230918781d9c77a14444ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Linville", "link": "https://stackoverflow.com/users/5095644/garrett-linville"}, "edited": false, "score": 0, "creation_date": 1436448862, "post_id": 31303646, "comment_id": 50625229, "body": "Thank you so much for the speedy response! I&#39;m very new to VBA (Matlab and Swift are more my bread and butter). When I implement this macro(Or at least attempt to) it doesn&#39;t seem to do anything upon saving.  I used your code verbatim and also changed .Shapes to .CheckBox1 Both don&#39;t throw any errors but both don&#39;t move anything upon saving. Can you help me out?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 3, "user_id": 5095644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d4a4797230918781d9c77a14444ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Linville", "link": "https://stackoverflow.com/users/5095644/garrett-linville"}, "edited": false, "score": 0, "creation_date": 1436451098, "post_id": 31303646, "comment_id": 50627116, "body": "This code has to go in the ThisWorkbook module. Events can only be in class modules: workbook events go in ThisWorkbook, worksheet events go in the sheet&#39;s module, other events go in custom class modules. If you put this in a standard module, it would not trigger."}, {"owner": {"reputation": 3, "user_id": 5095644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d4a4797230918781d9c77a14444ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Linville", "link": "https://stackoverflow.com/users/5095644/garrett-linville"}, "edited": false, "score": 0, "creation_date": 1436461030, "post_id": 31303646, "comment_id": 50634041, "body": "This is awesome so far! is there a way to root it to the right side? I essentially want to center these check boxes and its easier if I can link it to the right side.  and one final thing.   If Someone chooses to insert a row in between two check boxes how could I assign that checkbox to not snap to the  new row/colum before save"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 3, "user_id": 5095644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d4a4797230918781d9c77a14444ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Linville", "link": "https://stackoverflow.com/users/5095644/garrett-linville"}, "edited": false, "score": 0, "creation_date": 1436532415, "post_id": 31303646, "comment_id": 50666286, "body": "You get Top, Left, Height, and Width. To center or right align, you have to do the math. To right align, for instance, you set Left to (Left minus the difference in widths). For center, it would be half the distance of the widths."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 3, "user_id": 5095644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d4a4797230918781d9c77a14444ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Linville", "link": "https://stackoverflow.com/users/5095644/garrett-linville"}, "edited": false, "score": 0, "creation_date": 1436532509, "post_id": 31303646, "comment_id": 50666349, "body": "Instead of using a cell reference like J3 in your code, name a cell and use the named range. If you name J3 to <code>chkbox1_anchor</code> and the user enters a new row 3, that name will now point to J4. Then in your code <code>.Top = Sheet1.Range(&quot;chkbox1_anchor&quot;).Top</code> etc."}, {"owner": {"reputation": 3, "user_id": 5095644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d4a4797230918781d9c77a14444ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Linville", "link": "https://stackoverflow.com/users/5095644/garrett-linville"}, "edited": false, "score": 0, "creation_date": 1436533911, "post_id": 31303646, "comment_id": 50667348, "body": "First one worked like a charm!        With Sheet1.Shapes(&quot;Check Box 2&quot;)         Range(&quot;j4&quot;).Name = &quot;MyCell2&quot;         .Top = Sheet1.Range(&quot;MyCell2&quot;).Top         .Left = Sheet1.Range(&quot;MyCell2&quot;).Left     End With  This code runs but it doesnt seem to do anything different when a row is inserted. Did I do something wrong?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 3, "user_id": 5095644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d4a4797230918781d9c77a14444ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Linville", "link": "https://stackoverflow.com/users/5095644/garrett-linville"}, "edited": false, "score": 0, "creation_date": 1436539815, "post_id": 31303646, "comment_id": 50671585, "body": "Is that code in the BeforeSave event? Then it will only run before you save, not when a row is inserted. If you need that to run when a row is inserted, you have to put it in a different event. There is no &#39;insert row&#39; event, so SheetCalculate is probably your best bet. But beware that it will run <i>a lot</i> and may affect performance. It seems that if you made the checkbox <code>Move and don&#39;t size with cells</code> that it would follow the cell down when a row is inserted. Then you could keep your code in BeforeSave so it doesn&#39;t run so often.  You&#39;ll have to test it out to see."}, {"owner": {"reputation": 3, "user_id": 5095644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d4a4797230918781d9c77a14444ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Linville", "link": "https://stackoverflow.com/users/5095644/garrett-linville"}, "edited": false, "score": 0, "creation_date": 1436540212, "post_id": 31303646, "comment_id": 50671891, "body": "That seems to be my issue though. The cell will move down with the cell and usage goes on as per usual. but when I save it will jump back to the location it is rooted to is there any way to fix this without slaughtering performance."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 3, "user_id": 5095644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d4a4797230918781d9c77a14444ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Linville", "link": "https://stackoverflow.com/users/5095644/garrett-linville"}, "edited": false, "score": 0, "creation_date": 1436551230, "post_id": 31303646, "comment_id": 50678140, "body": "That&#39;s what the named range does. It moves down also. Don&#39;t name the range in code, name it in the UI. If you name it in code, you will always be moving it to, say, J4. But if you name J4 in the UI and only refer to the name in code, then the name will move with inserts and deletes."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 0, "last_activity_date": 1436389270, "creation_date": 1436389270, "answer_id": 31303646, "question_id": 31302534, "link": "https://stackoverflow.com/questions/31302534/how-do-i-fix-a-checkbox-to-a-location-in-vba/31303646#31303646", "title": "How do I fix a checkbox to a location in VBA", "body": "<p>You need to determine an appropriate event. I picked the BeforeSave event so that the control is always repositioned before it saves. You may want an event that fires more often.</p>\n\n<p>In the event, you can set the Top and Left properties to whatever you want, including to the Top and Left properties of a cell.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    With Sheet1.Shapes(\"Check Box 1\")\n        .Top = Sheet1.Range(\"J3\").Top\n        .Left = Sheet1.Range(\"J3\").Left\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5095644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d4a4797230918781d9c77a14444ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Linville", "link": "https://stackoverflow.com/users/5095644/garrett-linville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1968, "favorite_count": 0, "accepted_answer_id": 31303646, "answer_count": 1, "score": 0, "last_activity_date": 1436389270, "creation_date": 1436385587, "question_id": 31302534, "link": "https://stackoverflow.com/questions/31302534/how-do-i-fix-a-checkbox-to-a-location-in-vba", "title": "How do I fix a checkbox to a location in VBA", "body": "<p>I am attempting to fix a checkbox to a certain cell because, what I believe to be a bug continuously moves it. </p>\n\n<p>I have already tried selecting \" Don't move and size with cells\" and it will randomly shift to a different location without the re-sizing of any cells.</p>\n\n<p>Others seem to have the same issue but no one has any answers</p>\n\n<p>any help  would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 29, "user_id": 5095392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e814ea7e163ac231c3554c718beee48d?s=128&d=identicon&r=PG&f=1", "display_name": "idk123", "link": "https://stackoverflow.com/users/5095392/idk123"}, "edited": false, "score": 0, "creation_date": 1436388088, "post_id": 31301897, "comment_id": 50596552, "body": "I feel like I&#39;m trying to just form rows and didn&#39;t cite where to import what from each Excel cell... Ugh this is so hard..."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1436446854, "post_id": 31301897, "comment_id": 50623700, "body": "At the risk of insulting you this is a serious question, do you have any experience with debuging in the VBA IDE?  This allows you to step through each line of code and see the values in variables.  This allows you to track the results of the logic an figure out exactly what is going wrong. I can give you some pointers in chat if needed."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1436447128, "post_id": 31301897, "comment_id": 50623889, "body": "I would take out the line &quot;On Error Resume Next&quot;. That should be used with great caution.  And when appropriate to use, after the code you are allowing to fail you should have a &quot;on error goto 0&quot;.  That tells it to resume notifying you of errors.  How it is, your code might be producing some error and it will not tell you about it because of that.  It is sort of like leaving the seen of an accident."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1436448060, "post_id": 31301897, "comment_id": 50624577, "body": "Also putting &quot;Option explicit&quot; at the very top of your form code (the very first line) may help.  I assume you don&#39;t have it because you left in my example lines value1= value2= and it didn&#39;t complain that you don&#39;t have those variables defined.  But that could be because the on error resume next also."}], "answers": [{"comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1436385080, "post_id": 31301940, "comment_id": 50594890, "body": "Welcome to Stack Overflow by the way. Please accept the answer that works for you.  Let me know if you need any other help."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 0, "last_activity_date": 1436385378, "last_edit_date": 1436385378, "creation_date": 1436383728, "answer_id": 31301940, "question_id": 31301897, "link": "https://stackoverflow.com/questions/31301897/automatically-add-rows-into-a-ms-word-table-in-a-loop-as-long-as-you-read-data-f/31301940#31301940", "title": "Automatically add rows into a MS Word table in a loop as long as you read data from the excel sheet", "body": "<p>You can add your rows as you read excel. Inside that loop.</p>\n\n<pre><code>For counter = 0 To ExcelSheetLength Step 1\n\n    row.Cells(1) = exWb.Sheets(\"Tabelle1\").Cells(counter, 0)\n    row.Cells(2) = exWb.Sheets(\"Tabelle1\").Cells(counter, 1)\n    row.Cells(3) = exWb.Sheets(\"Tabelle1\").Cells(counter, 2)\n\n    Set row = tbl.Rows.Add(BeforeRow:=tbl.Rows(2))\n    'set the table column values here with the row.cells 1-3\n\nNext counter\n</code></pre>\n\n<p>I've always preferred this style loop personally </p>\n\n<pre><code>Dim iCount as integer\nDim ws As Excel.Worksheet\nSet ws = Application.ActiveSheet\nlRow = 4\nDo While lRow &lt;= ws.UsedRange.Rows.Count\n\n    value1 = ws.Range(\"A\" &amp; lRow).Value\n    value2 = ws.Range(\"B\" &amp; lRow).Value\n\n    Set row = tbl.Rows.Add(BeforeRow:=tbl.Rows(2))\n    'set the table column values here with the row.cells 1-3\n\n    'Here you deal with the extras\n    iCount = iCount  + 1\n    if icount = 8 then\n        iCount = 0\n        lrow = lrow + 5\n    else\n        lRow = lRow + 1\n    End if\n\n    ws.Range(\"A\" &amp; lRow).Activate\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 2577529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3lCwg.jpg?s=128&g=1", "display_name": "iamstrained", "link": "https://stackoverflow.com/users/2577529/iamstrained"}, "is_accepted": false, "score": 0, "last_activity_date": 1436384138, "creation_date": 1436384138, "answer_id": 31302088, "question_id": 31301897, "link": "https://stackoverflow.com/questions/31301897/automatically-add-rows-into-a-ms-word-table-in-a-loop-as-long-as-you-read-data-f/31302088#31302088", "title": "Automatically add rows into a MS Word table in a loop as long as you read data from the excel sheet", "body": "<p>So for your sub-question:</p>\n\n<blockquote>\n  <p>There is 5 repeated unnecessary rows after every 8 rows. So not sure how to loop that around since I'm planning on ignoring/skipping the 5 repeating rows of unnecessary info while importing data into Word.</p>\n</blockquote>\n\n<p>For this, there are a couple ways to handle it. 1)ingest everything from your excel sheet, blank rows included and delete them after using VBA in MS WORD. I don't really like the idea of this approach as much as I think on it.</p>\n\n<p>2) A slightly slower route would be to write an <strong>IF</strong> statement that looks at the data on a given line about to be ingest from EXCEL and determines if that value is BLANK/SPACE/EMPTY (whatever value is relevant for the examined piece), move on to the next line and re-start the check. IF the check comes up as having valid data, ingest and add to MS WORD table as desried.</p>\n"}], "owner": {"reputation": 29, "user_id": 5095392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e814ea7e163ac231c3554c718beee48d?s=128&d=identicon&r=PG&f=1", "display_name": "idk123", "link": "https://stackoverflow.com/users/5095392/idk123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1228, "favorite_count": 0, "accepted_answer_id": 31301940, "answer_count": 2, "score": 1, "last_activity_date": 1459760243, "creation_date": 1436383554, "last_edit_date": 1459760243, "question_id": 31301897, "link": "https://stackoverflow.com/questions/31301897/automatically-add-rows-into-a-ms-word-table-in-a-loop-as-long-as-you-read-data-f", "title": "Automatically add rows into a MS Word table in a loop as long as you read data from the excel sheet", "body": "<p>I'm a VBA newbie and having lots of errors and problems as I go on about this task. Any help will be appreciated.</p>\n\n<p>Basically I have a textbox (TextBox1) in a Word doc. that I have for users to type in. It'll be a number and that text references back to a folder with Excel files with numbers as their name. </p>\n\n<p>All the Excel files in that folder has the same formatting (created from the same template), but the number of rows in each file differs from one another.</p>\n\n<p>My boss wants me to create a VBA code in Word to import data from Excel into the word doc, but the problem occurs with varying number of rows in each file, as users can select from any existing file in the folder.</p>\n\n<p>Someone suggested creating rows in a loop as long as there is data to pull from Excel, but I just cannot get the code to work. It especially keeps failing where I'm setting the word table cell and Excel cell equal to each other (which I don't even know I'm doing right).</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim tbl As Table\nDim row As row\n\nSet tbl = ActiveDocument.Tables(3)\nSet row = tbl.Rows.Add(BeforeRow:=tbl.Rows(1))\n    tbl.Rows(1).Range.FormattedText = tbl.Rows(2).Range.FormattedText\n    '~~~&gt; This is required as the above code inserts a blank row in between\n    tbl.Rows(2).Delete\n\nDim objExcel As Excel.Application\nDim exWb As Excel.Workbook\nOn Error Resume Next\nSet exWb = objExcel.Workbooks.Open(\"S:\\Electro-Protocol\\Mot_Protocols\\\" &amp; TextBox1 &amp; \".xls\")\n\nrow.Cells(0) = exwb.Sheets(\"Tabelle1\u201c).Cells(4,1)\n'Now you just need to define the loop in which you execute the previous mentioned code. Here's some pseudo code you got to adapt in VBA for yourself:\n\nFor counter = 0 To ExcelSheetLength Step 1\n\n       row.Cells(1) = exWb.Sheets(\"Tabelle1\").Cells(counter, 0)\n       row.Cells(2) = exWb.Sheets(\"Tabelle1\").Cells(counter, 1)\n       row.Cells(3) = exWb.Sheets(\"Tabelle1\").Cells(counter, 2)\n Next counter\n\nFor counter = 0 To ExcelSheetLength Step 1\nIf counter = 25 Or counter = 26 Or counter = 27 Then\n    'nothing\n Else\n    Set row = tbl.Rows.Add(BeforeRow:=tbl.Rows(2))\n\nEnd If\n Next counter\nEnd Sub\n</code></pre>\n\n<p>So basically, it's a mess. I'm trying to import data from a selection of Excel worksheets with the same format, but varying number of rows into a Word table that'll dynamically add rows in a loop as long as I have data to read in the Excel sheet.</p>\n\n<p>The information I want from Excel starts at A4 and goes to D4, which I want in Word doc Tables(3), starting at row 1, column 1 to column 4. The Excel template repeats itself over and over until it is finished with all the data. There is 5 repeated unnecessary rows after every 8 rows. So not sure how to loop that around since I'm planning on ignoring/skipping the 5 repeating rows of unnecessary info while importing data into Word.</p>\n\n<p>I know this sounds really confusing, so let me know if you have any questions.\nThanks in advance!</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 1, "user_id": 5095485, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153251391994713/picture?type=large", "display_name": "Negron", "link": "https://stackoverflow.com/users/5095485/negron"}, "edited": false, "score": 0, "creation_date": 1436383848, "post_id": 31301691, "comment_id": 50594105, "body": "@Negron can you update your original post with exactly what you have right now?  I have tested the above code and it runs with no problem in my system."}, {"owner": {"reputation": 1, "user_id": 5095485, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153251391994713/picture?type=large", "display_name": "Negron", "link": "https://stackoverflow.com/users/5095485/negron"}, "edited": false, "score": 0, "creation_date": 1436384407, "post_id": 31301691, "comment_id": 50594440, "body": "Private Sub ResetButton_Click()  Dim correo As String  If Nz(Me.Email, &quot;&quot;) = &quot;&quot; Then MsgBox &quot;Email Empty. Please Enter a Valid Email Address.&quot;, vbInformation, &quot;Email Empty&quot; Me.Email.SetFocus  Else If Nz(DLookup(&quot;Email&quot;, &quot;Employees&quot;, &quot;Email= &#39;&quot; &amp; Me![Email]) &amp; &quot;&#39;&quot;, &quot;&quot;) &lt;&gt; &quot;&quot; Then     correo = DLookup(&quot;Email&quot;, &quot;Employees&quot;, &quot;Email= &#39;&quot; &amp; Me![Email] &amp; &quot;&#39;&quot;)   End If  If correo &lt;&gt; Me.Email Then MsgBox &quot;Wrong Email Address. Please Use a Correct Email Address.&quot;, vbCritical, &quot;Wrong Email Address&quot; Me.Email.SetFocus Else DoCmd.Close DoCmd.OpenForm &quot;UserVerificationPasswordReset&quot;  End If End If  End Sub"}, {"owner": {"reputation": 1, "user_id": 5095485, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153251391994713/picture?type=large", "display_name": "Negron", "link": "https://stackoverflow.com/users/5095485/negron"}, "edited": false, "score": 0, "creation_date": 1436384498, "post_id": 31301691, "comment_id": 50594504, "body": "where Employees is a table and Email is a field"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 1, "user_id": 5095485, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153251391994713/picture?type=large", "display_name": "Negron", "link": "https://stackoverflow.com/users/5095485/negron"}, "edited": false, "score": 0, "creation_date": 1436445550, "post_id": 31301691, "comment_id": 50622675, "body": "@Negron in your immediate windows Ctrl+G can you type <code>Msgbox DLookup(&quot;Email&quot;, &quot;Employees&quot;, &quot;Email= &#39;&quot;Example@Domain.com&#39;&quot;)</code> but put in a valid email and see what happens."}], "tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436382900, "creation_date": 1436382900, "answer_id": 31301691, "question_id": 31301578, "link": "https://stackoverflow.com/questions/31301578/runtime-error-3075-vba-access-missing-operator/31301691#31301691", "title": "Runtime Error 3075 - - VBA Access- missing Operator", "body": "<p>Email is going to be a string so your syntax should be: </p>\n\n<pre><code>If Nz(DLookup(\"Email\", \"Employees\", \"Email= '\" &amp; Me.Email &amp; \"'\"), \"\") &lt;&gt; \"\" Then\n    correo = DLookup(\"Email\", \"Employees\", \"Email= '\" &amp; Me.Email &amp; \"'\")\n</code></pre>\n\n<p>Notice the single quotes added around the email address you are looking for. </p>\n"}, {"comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 1, "creation_date": 1436445404, "post_id": 31302827, "comment_id": 50622557, "body": "He posted it in a comment.  Which has no return lines, now rewrite his code but go to another line where there is a space between Else If.  That will likely make a lot more sense."}, {"owner": {"reputation": 620, "user_id": 3013378, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3a9dI.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3013378/mike"}, "edited": false, "score": 0, "creation_date": 1436459514, "post_id": 31302827, "comment_id": 50633063, "body": "I updated my answer, the references to the Email control were wrong."}], "tags": [], "owner": {"reputation": 620, "user_id": 3013378, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3a9dI.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3013378/mike"}, "is_accepted": false, "score": -1, "last_activity_date": 1436459421, "last_edit_date": 1436459421, "creation_date": 1436386511, "answer_id": 31302827, "question_id": 31301578, "link": "https://stackoverflow.com/questions/31301578/runtime-error-3075-vba-access-missing-operator/31302827#31302827", "title": "Runtime Error 3075 - - VBA Access- missing Operator", "body": "<p>Two things.  First, it's <code>ElseIf</code> in VBA, not <code>Else If</code> (no space).  Second, you have an extra <code>End If</code> at the end of the <code>If</code> block.  See below:</p>\n\n<pre><code>Private Sub ResetButton_Click()\n\n    Dim correo As String\n\n        If Nz(Me.Email, \"\") = \"\" Then\n            MsgBox \"Email Empty. Please Enter a Valid Email Address.\", vbInformation, \"Email Empty\"\n            Me.Email.SetFocus\n        ElseIf Nz(DLookup(\"Email\", \"Employees\", \"Email= '\" &amp; Me.Email &amp; \"'\", \"\") &lt;&gt; \"\" Then\n            correo = DLookup(\"Email\", \"Employees\", \"Email= '\" &amp; Me.Email &amp; \"'\")\n        End If\n\n        If correo &lt;&gt; Me.Email Then\n            MsgBox \"Wrong Email Address. Please Use a Correct Email Address.\", vbCritical, \"Wrong Email Address\"\n            Me.Email.SetFocus\n        Else\n            DoCmd.Close\n            DoCmd.OpenForm \"UserVerificationPasswordReset\"\n        End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5095485, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153251391994713/picture?type=large", "display_name": "Negron", "link": "https://stackoverflow.com/users/5095485/negron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1366, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1436459421, "creation_date": 1436382475, "last_edit_date": 1436384964, "question_id": 31301578, "link": "https://stackoverflow.com/questions/31301578/runtime-error-3075-vba-access-missing-operator", "title": "Runtime Error 3075 - - VBA Access- missing Operator", "body": "<p>Where is the missing Operator?</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>If Nz(DLookup(\"Email\", \"Employees\", \"Email=\" &amp; Me![Email]), \"\") &lt;&gt; \"\" Then\n    correo = DLookup(\"Email\", \"Employees\", \"Email=\" &amp; Me![Email])\n</code></pre>\n"}, {"tags": ["excel", "array-formulas", "vba"], "comments": [{"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1436384153, "post_id": 31301483, "comment_id": 50594287, "body": "<code>c.CurrentArray</code> would return the <code>Range</code> of the <code>FormulaArray</code> if there is one in <code>c</code>.  You could check the presence of an array in <code>c</code> with <code>c.HasArray</code>.  It will return <code>True</code> if there is."}, {"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1436384601, "post_id": 31301483, "comment_id": 50594574, "body": "BTW, you should dim your <code>c</code> as a <code>Range</code> to have access to the list of methods and properties applicable to it."}, {"owner": {"reputation": 768, "user_id": 4789843, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7b0345992a82b453ff9e68376fd3f791?s=128&d=identicon&r=PG&f=1", "display_name": "deseosuho", "link": "https://stackoverflow.com/users/4789843/deseosuho"}, "reply_to_user": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1436385076, "post_id": 31301483, "comment_id": 50594886, "body": "This is perfect.  Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1436390346, "post_id": 31302974, "comment_id": 50597713, "body": "On this line <code>Dim c, fa_range As Range</code>, only <code>fa_range</code> will be seen as <code>Range</code>.  If you want to declare on the same line, you must do it like this: <code>Dim c As Range, fa_range As Range</code>"}], "tags": [], "owner": {"reputation": 768, "user_id": 4789843, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7b0345992a82b453ff9e68376fd3f791?s=128&d=identicon&r=PG&f=1", "display_name": "deseosuho", "link": "https://stackoverflow.com/users/4789843/deseosuho"}, "is_accepted": true, "score": 0, "last_activity_date": 1436660205, "last_edit_date": 1436660205, "creation_date": 1436386997, "answer_id": 31302974, "question_id": 31301483, "link": "https://stackoverflow.com/questions/31301483/excel-vba-value-paste-all-formulas-of-type-x/31302974#31302974", "title": "excel vba value paste all formulas of type &quot;=X()&quot;", "body": "<p>Following simpLE MAn's suggestions above, this is my solution:</p>\n\n<pre><code>Public Sub breakLinks(scope As String)\nDim formula_tokens()\nDim c As Range, fa_range As Range\nDim ws As Worksheet\nDim token\nformula_tokens = Array(\"MYFORMULA1(\", \"MYFORMULA2(\", \"OTHERFORMULA(\", \"OTHERFORMULA2(\")\nIf scope = \"sheet\" Then\n    For Each c In ActiveSheet.Cells.SpecialCells(xlCellTypeFormulas)\n        For Each token In formula_tokens\n            If InStr(UCase(c.FormulaArray), token) Then\n                If c.HasArray Then\n                    Set fa_range = c.CurrentArray\n                    fa_range.FormulaArray = fa_range.Value\n                Else\n                    c.Formula = c.Value\n                End If\n            End If\n        Next\n    Next\n\nElseIf scope = \"wbook\" Then\n    For Each ws In Worksheets\n        For Each c In ws.Cells.SpecialCells(xlCellTypeFormulas)\n            For Each token In formula_tokens\n                If InStr(UCase(c.FormulaArray), token) Then\n                    If c.HasArray Then\n                        Set fa_range = c.CurrentArray\n                        fa_range.FormulaArray = fa_range.Value\n                    Else\n                        c.Formula = c.Value\n                    End If\n                End If\n            Next\n        Next\n    Next\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 768, "user_id": 4789843, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7b0345992a82b453ff9e68376fd3f791?s=128&d=identicon&r=PG&f=1", "display_name": "deseosuho", "link": "https://stackoverflow.com/users/4789843/deseosuho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 31302974, "answer_count": 1, "score": 1, "last_activity_date": 1436660205, "creation_date": 1436382148, "last_edit_date": 1531164843, "question_id": 31301483, "link": "https://stackoverflow.com/questions/31301483/excel-vba-value-paste-all-formulas-of-type-x", "title": "excel vba value paste all formulas of type &quot;=X()&quot;", "body": "<p>I have a database app that stores data in array formulas through a UDF.</p>\n\n<p>I would like to have a macro that goes through the sheet/wbook and breaks all the external links by replacing the udf array formula with the current value in the given cell.</p>\n\n<p><strong>The challenge is that cells within a given array formula can't be written individually.</strong> For example a macro like that below will cause the entire array to be destroyed on the first write.</p>\n\n<pre><code>Public Sub breaklink()\nDim c\nFor Each c In ActiveSheet.Cells.SpecialCells(xlCellTypeFormulas)\n    Debug.Print c.FormulaArray\n    If InStr(c.FormulaArray, \"MYFORMULA(\") Then\n        Stop\n        c.FormulaArray = c.Value\n        'c.Value = c.Value     --THIS THROWS ERROR 1004 (Can't edit part of an array)\n        Stop\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>If there were a cell method like <code>c.getArrayFormulaRange</code>, then I could use it to create an array of values and then write-over the array formula.</p>\n\n<p>I could conceivably loop through adjacent cells to attempt to find the bounds of each array, but this seems quite cumbersome (also, I'd be changing the range I was looping through during the loop, which could raise problems).  Is there any method or object property that will help me identify the entire range that is occupied by a given array formula?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1436383070, "post_id": 31301408, "comment_id": 50593615, "body": "have you looked at the value of <code>ActiveCell.Formula</code>? this shows it in the A1 style"}, {"owner": {"reputation": 340, "user_id": 970456, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c28253bb7082a54b4f3a4d06ee1aaa0e?s=128&d=identicon&r=PG", "display_name": "vinz", "link": "https://stackoverflow.com/users/970456/vinz"}, "reply_to_user": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1436383667, "post_id": 31301408, "comment_id": 50593990, "body": "Hey @SeanC, thanks for the comment and I just tried that. It seemed like the ActiveCell in &quot;=&#39;Sheet1&#39;!C&quot; &amp; ActiveCell.row + 3 isn&#39;t getting the cell that I am selecting in Sheet1. I&#39;m guessing I did not understand fully on the ActiveCell part. Why does the ActiveCell always on the first row."}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1436384086, "post_id": 31301408, "comment_id": 50594239, "body": "with the <code>For Each</code>, you will need to refer to <b>cell</b>, instead of ActiveCell"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1436669674, "post_id": 31301408, "comment_id": 50708328, "body": "Please do not use the <a href=\"http://stackoverflow.com/tags/macros/info\"><b>macros</b> tag</a> for MS Office / VBA."}], "answers": [{"tags": [], "owner": {"reputation": 340, "user_id": 970456, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c28253bb7082a54b4f3a4d06ee1aaa0e?s=128&d=identicon&r=PG", "display_name": "vinz", "link": "https://stackoverflow.com/users/970456/vinz"}, "is_accepted": false, "score": -1, "last_activity_date": 1436384140, "creation_date": 1436384140, "answer_id": 31302090, "question_id": 31301408, "link": "https://stackoverflow.com/questions/31301408/vba-macro-using-forumular1c1-to-get-data-from-another-sheet/31302090#31302090", "title": "vba Macro - Using ForumulaR1C1 to get data from another sheet", "body": "<p>Well, might not be the best solution but I guess the latter ActiveCell.row refers to Sheet2 if I'm on Sheet2 Selection. Now I have to store a temp row number instead at the start to get the true ActiveCell.row which is the row of <code>2-Jul</code></p>\n\n<pre><code>Dim tmpRow As Integer\ntmpRow = ActiveCell.Row\n</code></pre>\n\n<p>Then I'm gonna call it later</p>\n\n<pre><code>ActiveCell.Formula = \"='Sheet1'!C\" &amp; tmpRow + 3\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1436384922, "creation_date": 1436384922, "answer_id": 31302339, "question_id": 31301408, "link": "https://stackoverflow.com/questions/31301408/vba-macro-using-forumular1c1-to-get-data-from-another-sheet/31302339#31302339", "title": "vba Macro - Using ForumulaR1C1 to get data from another sheet", "body": "<p>I'm going to go out on a limb as I suspect that your use of offset R1C1 formulas was due to some problems coming up with an adequate formula for retrieving the 'Total' from Sheet1 for each date on Sheet2.</p>\n\n<pre><code>Sub get_dated_total()\n    Dim rw As Long, ws1 As Worksheet, sFormulaR1C1 As String\n\n    sFormulaR1C1 = \"=IFERROR(INDEX(INDEX(Sheet1!C3,MATCH(RC1,Sheet1!C1,0)):INDEX(Sheet1!C3,ROWS(C3)),MATCH(\"\"total\"\",INDEX(Sheet1!C,MATCH(RC1,Sheet1!C1,0)):INDEX(Sheet1!C,ROWS(C)), 0)), \"\"\"\")\"\n    Set ws1 = Worksheets(\"Sheet1\")\n\n    With Worksheets(\"Sheet2\")\n        For rw = 1 To .Cells(Rows.Count, 1).End(xlUp).Row\n            If IsDate(.Cells(rw, 1)) Then\n                If CBool(Application.CountIf(ws1.Columns(1), .Cells(rw, 1).Value)) Then\n                    .Cells(rw, 2).FormulaR1C1 = sFormulaR1C1\n                End If\n            End If\n        Next rw\n    End With\n\n    Set ws1 = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/5VZhE.png\" alt=\"R1C1 for floating total\"></p>\n"}], "owner": {"reputation": 340, "user_id": 970456, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c28253bb7082a54b4f3a4d06ee1aaa0e?s=128&d=identicon&r=PG", "display_name": "vinz", "link": "https://stackoverflow.com/users/970456/vinz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1436669668, "creation_date": 1436381918, "last_edit_date": 1436669668, "question_id": 31301408, "link": "https://stackoverflow.com/questions/31301408/vba-macro-using-forumular1c1-to-get-data-from-another-sheet", "title": "vba Macro - Using ForumulaR1C1 to get data from another sheet", "body": "<p>I'm trying to use vba to automate a simple process by getting a data from another sheet in the same workbook. I'm cannot just copy because the data is updated dynamically, if there is changes to the other sheet, it will be affected.</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"='Sheet2'!R[7]C[4]\"\n</code></pre>\n\n<p>This is my first time doing vba and I think the R[7]C[4] meant sort of the coordinates of getting the value either vertically or horizontally based on the positivity and negativity of the numbers.</p>\n\n<p>Sheet1</p>\n\n<pre><code>2-Jul\n-------\nitem1     item2     3\nitem1.1   item2.2   43\n          total     46\n3-Jul\n-------\nitem1     item2     3\nitem1.1   item2.2   41\n          total     44\n</code></pre>\n\n<p>Sheet2</p>\n\n<pre><code>1-Jul     \n2-Jul     46 (works here)\n3-Jul     44 (does not work here)\n</code></pre>\n\n<p>It will run through the dates on sheet 2 and show the total accordingly on the 2nd column. This is what I did.</p>\n\n<pre><code>For Each cell In Range(\"A1:A3\")\n    If cell.Value = selDate Then\n        Range(\"B\" &amp; cell.row).Select\n        ActiveCell.FormulaR1C1 = \"='Sheet1'!R[3]C[3]\"\n    End If\nNext cell\n</code></pre>\n\n<p>I place my selected cell on <code>2-Jul</code> and it got the cell correct and took <code>46</code> but as for the second one that I ran by placing my selected cell on <code>3-Jul</code>, it took data just one cell down from <code>46</code> than actually getting <code>44</code>.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1436384124, "post_id": 31301323, "comment_id": 50594268, "body": "I&#39;m trying to understand exactly what it is you&#39;re trying to do. Are you looking for the first row that says &quot;Planning/Fieldwork&quot;, and then looking for the last row that says &quot;Planning/Fieldwork&quot; ?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1436384336, "post_id": 31301323, "comment_id": 50594404, "body": "Your code returns 10 and 18 respectively when I run it (which seems to be working as intended). <a href=\"http://i.imgur.com/HRasrds.png\" rel=\"nofollow noreferrer\">i.imgur.com/HRasrds.png</a>"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 3, "last_activity_date": 1436384262, "creation_date": 1436384262, "answer_id": 31302132, "question_id": 31301323, "link": "https://stackoverflow.com/questions/31301323/vba-last-row-for-specific-text-value/31302132#31302132", "title": "VBA Last Row for Specific Text Value", "body": "<p>You code appears to function with correct data:</p>\n\n<pre><code>Sub SeperateRowSub()\n\n    Dim FirstRowPFW As Integer\n    Dim LastRowPFW As Integer\n\n    FirstRowPFW = Range(\"B:B\").Find(what:=\"Planning/Fieldwork\", after:=Range(\"B6\")).Row\n    LastRowPFW = Range(\"B:B\").Find(what:=\"Planning/Fieldwork\", after:=Range(\"B6\"), searchdirection:=xlPrevious).Row\n\n    MsgBox FirstRowPFW &amp; vbCrLf &amp; LastRowPFW\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/lTuOL.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5024893, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/472bdb6f9cde8b80ffe86fe4e517b1b6?s=128&d=identicon&r=PG&f=1", "display_name": "michaelvhaug", "link": "https://stackoverflow.com/users/5024893/michaelvhaug"}, "is_accepted": false, "score": 0, "last_activity_date": 1436390579, "creation_date": 1436390579, "answer_id": 31304039, "question_id": 31301323, "link": "https://stackoverflow.com/questions/31301323/vba-last-row-for-specific-text-value/31304039#31304039", "title": "VBA Last Row for Specific Text Value", "body": "<p>I found that the problem was it was referencing a formula for Planning/Fieldwork, i.e. that text came up conditionally.  When I put a hardcoding statement in for that reference, it works.  Thank you for your help anyway!</p>\n"}], "owner": {"reputation": 11, "user_id": 5024893, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/472bdb6f9cde8b80ffe86fe4e517b1b6?s=128&d=identicon&r=PG&f=1", "display_name": "michaelvhaug", "link": "https://stackoverflow.com/users/5024893/michaelvhaug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3608, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1436390579, "creation_date": 1436381663, "last_edit_date": 1436382902, "question_id": 31301323, "link": "https://stackoverflow.com/questions/31301323/vba-last-row-for-specific-text-value", "title": "VBA Last Row for Specific Text Value", "body": "<pre><code>Sub SeperateRowSub()\n\nDim FirstRowPFW As Integer\nDim LastRowPFW As Integer\n\nFirstRowPFW = Range(\"B:B\").Find(what:=\"Planning/Fieldwork\", after:=Range(\"B6\")).Row\nLastRowPFW = Range(\"B:B\").Find(what:=\"Planning/Fieldwork\", after:=Range(\"B6\"), searchdirection:=xlPrevious).Row\n\nEnd Sub\n</code></pre>\n\n<p>FirstRowPFW returns the correct row that it starts at.\nLastrow continues to count the rest of the rows, even those outside of the \"planning/fieldwork\" criteria. </p>\n\n<p>How can I fix the lastrowpfw variable to only count to the last row for cells containing \"Planning/Fieldwork\" ?</p>\n"}, {"tags": ["excel", "one-to-many", "pivot-table", "vba"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 1403777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0d702c5daa9cbdbc6a577c30adee28be?s=128&d=identicon&r=PG", "display_name": "Joel G", "link": "https://stackoverflow.com/users/1403777/joel-g"}, "edited": false, "score": 0, "creation_date": 1436386575, "post_id": 31301548, "comment_id": 50595711, "body": "Thanks, I see how this could work, but I can&#39;t get it to... I put the formula in the pivot table (2nd screenshot), but the countif only evaluated true for the row it was on. e.g. when the formula is next to &quot;70115\t randomization&quot;, randomization evaluates true. But it doesn&#39;t pick up if the ID has 2 more visit types (or even 1 more visit type)"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 67, "user_id": 1403777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0d702c5daa9cbdbc6a577c30adee28be?s=128&d=identicon&r=PG", "display_name": "Joel G", "link": "https://stackoverflow.com/users/1403777/joel-g"}, "edited": false, "score": 0, "creation_date": 1436387219, "post_id": 31301548, "comment_id": 50596085, "body": "Change your pivot table options to repeat the rows in the rid column, otherwise when Excel looks at those cells it sees blanks. Alternatively, put the formula on your raw data tab. Note that to do that you need to refer to column &quot;F:F&quot; instead of &quot;C:C&quot; in your formulas, as the locations of the &quot;Visit Type&quot; column are different between tabs."}, {"owner": {"reputation": 67, "user_id": 1403777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0d702c5daa9cbdbc6a577c30adee28be?s=128&d=identicon&r=PG", "display_name": "Joel G", "link": "https://stackoverflow.com/users/1403777/joel-g"}, "edited": false, "score": 0, "creation_date": 1436492540, "post_id": 31301548, "comment_id": 50647733, "body": "@Grade-eh-bacon Perfect, it worked! A few minor modifications, so that I could run the formula once per ID and count the result: (1) Copy pivot table to new sheet. (2) Data Tab -&gt; Advanced Filter -&gt; Unique values in ID range (3) Add your formula to new column (except I used =0&lt;&gt; instead of =0=, so that it would return TRUE when value is NOT 0). (4) COUNTIF(range,&quot;TRUE&quot;). Thanks again for your help!"}, {"owner": {"reputation": 67, "user_id": 1403777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0d702c5daa9cbdbc6a577c30adee28be?s=128&d=identicon&r=PG", "display_name": "Joel G", "link": "https://stackoverflow.com/users/1403777/joel-g"}, "edited": false, "score": 0, "creation_date": 1436492814, "post_id": 31301548, "comment_id": 50647787, "body": "Also, pre Excel 2010, you can Repeat Row Labels using the steps from the last answer here: <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2007-excel/repeat-row-labels-in-a-pivottable/306a3c8f-d7c7-460b-b046-950646ac0427?auth=1\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/office/forum/office_2007-excel/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": true, "score": 2, "last_activity_date": 1436382377, "creation_date": 1436382377, "answer_id": 31301548, "question_id": 31301217, "link": "https://stackoverflow.com/questions/31301217/excel-one-to-many-table-query-number-of-rows-per-id/31301548#31301548", "title": "Excel One-to-Many Table, Query Number of Rows Per ID", "body": "<p>Can be done in a bunch of ways; one would be to test for each criteria using a COUNTIFS function, and indicate whether any of these are 0. Like so (starting in cell H4 of your first tab there, dragged down):</p>\n\n<pre><code>=countifs(A:A,A4,C:C,\"randomization\")*countifs(A:A,A4,C:C,\"30-week\")*countifs(A:A,A4,C:C,\"delivery\")\n</code></pre>\n\n<p>If any of those testing types don't appear on the same row as the rid in column A, then the formula will simplify to 0.</p>\n\n<p>To create a cleaner result, compare the function to 0, to show all rids where not all 3 are present; like so:</p>\n\n<p>=0=countifs(A:A,A4,C:C,\"randomization\")*countifs(A:A,A4,C:C,\"30-week\")*countifs(A:A,A4,C:C,\"delivery\")    </p>\n\n<p>This will show TRUE wherever not all 3 tests were present for that rid. To only test for unique rids (will be a little cleaner; there are many ways to create a list of rids without duplicates, but this works too) :</p>\n\n<pre><code>=if(iserror(match(A4,$A$1:A3,0)),0=countifs(A:A,A4,C:C,\"randomization\")*countifs(A:A,A4,C:C,\"30-week\")*countifs(A:A,A4,C:C,\"delivery\"),\"\")\n</code></pre>\n\n<p>This only starts the formula if there is no match found for that particular rid, in any row above the current row.</p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 1403777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0d702c5daa9cbdbc6a577c30adee28be?s=128&d=identicon&r=PG", "display_name": "Joel G", "link": "https://stackoverflow.com/users/1403777/joel-g"}, "edited": false, "score": 0, "creation_date": 1436383491, "post_id": 31301774, "comment_id": 50593876, "body": "Yes, each ID could have more than 3 visit types. But I could see this working for some things."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1436383600, "post_id": 31301774, "comment_id": 50593946, "body": "This doesn&#39;t work as in the example table provided, some rid&#39;s have multiple visits of the same types."}], "tags": [], "owner": {"reputation": 46, "user_id": 3521037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbet0.jpg?s=128&g=1", "display_name": "dasg7", "link": "https://stackoverflow.com/users/3521037/dasg7"}, "is_accepted": false, "score": 0, "last_activity_date": 1436383140, "creation_date": 1436383140, "answer_id": 31301774, "question_id": 31301217, "link": "https://stackoverflow.com/questions/31301217/excel-one-to-many-table-query-number-of-rows-per-id/31301774#31301774", "title": "Excel One-to-Many Table, Query Number of Rows Per ID", "body": "<p>If you just have 3 visit types, why not just perform a Count of ID, and if it is 3 it means it has the 3 visit types done. Something like</p>\n\n<p>=IF(COUNTIF($A$1:$A$100,A1)=3,\"Done\",\"Pending\")</p>\n\n<p>I dont know.. if you have more than 3 visit types just let us know.</p>\n"}], "owner": {"reputation": 67, "user_id": 1403777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0d702c5daa9cbdbc6a577c30adee28be?s=128&d=identicon&r=PG", "display_name": "Joel G", "link": "https://stackoverflow.com/users/1403777/joel-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 0, "accepted_answer_id": 31301548, "answer_count": 2, "score": 0, "last_activity_date": 1436383140, "creation_date": 1436381374, "last_edit_date": 1531161705, "question_id": 31301217, "link": "https://stackoverflow.com/questions/31301217/excel-one-to-many-table-query-number-of-rows-per-id", "title": "Excel One-to-Many Table, Query Number of Rows Per ID", "body": "<p>I have a one-to-many table in Excel, set up as shown in the picture. Each rid (ID) has many samples; each sample has a fixed number of properties (visit, visit type, etc).</p>\n\n<p><img src=\"https://i.stack.imgur.com/0nXoY.png\" alt=\"enter image description here\"></p>\n\n<p>I also have a pivot table set up to visualize the data:\n<img src=\"https://i.stack.imgur.com/Bixxh.png\" alt=\"enter image description here\"></p>\n\n<p>Now, I need to filter/query my data to find all the IDs that have all 3 visit types: randomization And 30-week And delivery. (There are also additional queries I may need to do with each ID and its dependent objects)</p>\n\n<p>Is this possible to do in Excel using advanced filters and pivot tables? Or do I need to write VBA scripts to process and organize this for me? (Using Excel 2010)</p>\n\n<p>If a VBA script is best, should I use Find and FindNext to get all the samples that belong to an ID?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1436380951, "post_id": 31301070, "comment_id": 50592286, "body": "access-vba &lt;&gt; VB.NET"}, {"owner": {"reputation": 219, "user_id": 3657834, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/14c105ad51a1fdd8a879ba96102b71c8?s=128&d=identicon&r=PG&f=1", "display_name": "user3657834", "link": "https://stackoverflow.com/users/3657834/user3657834"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1436381225, "post_id": 31301070, "comment_id": 50592466, "body": "sorry, misclicked when choosing the suggested tags"}, {"owner": {"reputation": 219, "user_id": 3657834, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/14c105ad51a1fdd8a879ba96102b71c8?s=128&d=identicon&r=PG&f=1", "display_name": "user3657834", "link": "https://stackoverflow.com/users/3657834/user3657834"}, "edited": false, "score": 0, "creation_date": 1436382163, "post_id": 31301070, "comment_id": 50593035, "body": "Thanks for the correction. I&#39;ll fix my post."}], "answers": [{"tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436382055, "creation_date": 1436382055, "answer_id": 31301449, "question_id": 31301070, "link": "https://stackoverflow.com/questions/31301070/how-to-create-controls-at-run-time-access-vb/31301449#31301449", "title": "How to create controls at run time Access VB?", "body": "<p>Whenever I attempt to run your code I get the runtime error of: </p>\n\n<blockquote>\n  <p>Run-time error '6062':<br>\n  You must be in Design or Layout View to create or delete controls. </p>\n</blockquote>\n\n<p>Based off of that information it seems like dynamically creating controls in runtime isn't going to be possible.</p>\n"}, {"comments": [{"owner": {"reputation": 219, "user_id": 3657834, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/14c105ad51a1fdd8a879ba96102b71c8?s=128&d=identicon&r=PG&f=1", "display_name": "user3657834", "link": "https://stackoverflow.com/users/3657834/user3657834"}, "edited": false, "score": 0, "creation_date": 1436382421, "post_id": 31301469, "comment_id": 50593216, "body": "Bummer. The controls really need to be added at run time in &quot;Form View&quot; I have a table that has questions. And on this form I&#39;d like the form to dynamically adjust to the number of questions required. I currently have this deigned where controls are hidden and then made visible then needed. But It would be ideal to only have the correct number of controls as needed."}, {"owner": {"reputation": 219, "user_id": 3657834, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/14c105ad51a1fdd8a879ba96102b71c8?s=128&d=identicon&r=PG&f=1", "display_name": "user3657834", "link": "https://stackoverflow.com/users/3657834/user3657834"}, "edited": false, "score": 0, "creation_date": 1436382499, "post_id": 31301469, "comment_id": 50593273, "body": "would a workaround be to somehow quickly change the form into design view, create the controls, then quickly change back into form view? Do such VB commands exist?"}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1436385188, "post_id": 31301469, "comment_id": 50594957, "body": "Thanks HansUp. Corrected."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 219, "user_id": 3657834, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/14c105ad51a1fdd8a879ba96102b71c8?s=128&d=identicon&r=PG&f=1", "display_name": "user3657834", "link": "https://stackoverflow.com/users/3657834/user3657834"}, "edited": false, "score": 1, "creation_date": 1436385493, "post_id": 31301469, "comment_id": 50595114, "body": "@user3657834, I would guess this would result in some flashing onscreen (which you probably could get around), but real trouble is the control limit. I might play around with this to see if you use the same names each time it still increments toward your limit, but it sounds unlikely. Probably better to have a bunch of invisible controls and arrange those dynamically each time. This gets around a bunch of issues."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 219, "user_id": 3657834, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/14c105ad51a1fdd8a879ba96102b71c8?s=128&d=identicon&r=PG&f=1", "display_name": "user3657834", "link": "https://stackoverflow.com/users/3657834/user3657834"}, "edited": false, "score": 0, "creation_date": 1436392323, "post_id": 31301469, "comment_id": 50598635, "body": "@user3657834 I was able to get it working. See updated answer."}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 7, "last_activity_date": 1470070540, "last_edit_date": 1495535383, "creation_date": 1436382118, "answer_id": 31301469, "question_id": 31301070, "link": "https://stackoverflow.com/questions/31301070/how-to-create-controls-at-run-time-access-vb/31301469#31301469", "title": "How to create controls at run time Access VB?", "body": "<p>The documentation you need is here (these are specifically for Access VBA): </p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/bb237827(v=office.12).aspx\" rel=\"noreferrer\">Application.CreateControl Method (Office 2007)</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/aa221167(v=office.11).aspx\" rel=\"noreferrer\">Application.CreateControl Method (Office 2003)</a></li>\n</ul>\n\n<p>According to the documentatin, there are some big limitations to this feature:</p>\n\n<ul>\n<li>Limited to 754 controls over the lifetime of the form (this is not reset by deleting them, so you are likely to run into this limit quickly)</li>\n<li>Must be done in Design view (so it can't be done in mde/accde)</li>\n<li>It is questionable how it will perform in a multi-user environment.</li>\n</ul>\n\n<p>Because of these limitations, it is inadvisable, unless you are using to design forms initially.</p>\n\n<p>Duplicate Question: <a href=\"https://stackoverflow.com/questions/7975380/how-do-you-dynamically-create-controls-on-a-ms-access-form\">How do you dynamically create controls on a MS Access form?</a></p>\n\n<p>In response to the OP's suggestion, here is my test code which was able to add 40 controls and repeat the process 50 times without exceeding the 754 limit (I reused 40 names in my test). </p>\n\n<p><strong>Caveat 1</strong> This is inadvisable because it can only be done in design view which will not work in an mde/accde. </p>\n\n<p><strong>Caveat 2</strong>: It is questionable how it will perform in a multi-user environment.</p>\n\n<p>This code is from a form with two buttons. It opens a second form named \"Form2\" </p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Const FORM_NAME As String = \"Form2\"\nPrivate m_nCounter As Long\n\nPrivate Sub cmdCreate_Click()\n    runDynamicForm\nEnd Sub\n\nPrivate Sub cmdRepeat_Click()\n\n    Dim n As Long\n\n    m_nCounter = 0\n\n    For n = 0 To 50\n        runDynamicForm\n        DoEvents\n        DoCmd.Close acForm, FORM_NAME, acSaveNo\n        DoEvents\n    Next 'n\n\n    MsgBox m_nCounter\n\nEnd Sub\n\nPrivate Sub runDynamicForm()\n\n    Const DYNAMIC_TAG As String = \"dynamic\"\n\n    Dim n As Long\n    Dim frm As Form\n    Dim ctl As Access.Control\n\n    On Error GoTo EH\n\n    Application.Echo False\n\n    DoCmd.OpenForm FORM_NAME, acDesign\n    Set frm = Application.Forms(FORM_NAME)\n\n    For n = frm.Controls.Count - 1 To 0 Step -1\n        Set ctl = frm.Controls(n)\n        If ctl.Tag = DYNAMIC_TAG Then\n            Application.DeleteControl FORM_NAME, ctl.Name\n        End If\n    Next 'n\n\n    For n = 1 To 20\n\n        With Application.CreateControl(FORM_NAME, acLabel, acDetail, , , 400, n * 300, 1500, 300)\n\n            .Name = \"lbl\" &amp; n\n            .Caption = \"Question \" &amp; n\n            .Visible = True\n            .Tag = DYNAMIC_TAG\n\n        End With\n\n        With Application.CreateControl(FORM_NAME, acTextBox, acDetail, , , 2000, n * 300, 3000, 300)\n\n            .Name = \"txt\" &amp; n\n            .Visible = True\n            .TabIndex = n - 1\n            .Tag = DYNAMIC_TAG\n\n        End With\n\n        m_nCounter = m_nCounter + 2\n\n    Next 'n\n\n    DoCmd.Close acForm, FORM_NAME, acSaveYes\n\n    DoCmd.OpenForm FORM_NAME, acNormal\n\n    GoTo FINISH\n\nEH:\n    With Err\n        MsgBox \"Error:\" &amp; vbTab &amp; .Number &amp; vbCrLf _\n            &amp; \"Source\" &amp; vbTab &amp; .Source &amp; vbCrLf _\n            &amp; .Description\n    End With\n\nFINISH:\n\n    Application.Echo True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1262, "user_id": 4849861, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/P1hp3.jpg?s=128&g=1", "display_name": "Mladen Or\u0161oli\u0107", "link": "https://stackoverflow.com/users/4849861/mladen-or%c5%a1oli%c4%87"}, "is_accepted": false, "score": -1, "last_activity_date": 1436394353, "creation_date": 1436394353, "answer_id": 31304893, "question_id": 31301070, "link": "https://stackoverflow.com/questions/31301070/how-to-create-controls-at-run-time-access-vb/31304893#31304893", "title": "How to create controls at run time Access VB?", "body": "<p>You might be only missing <code>DoCmd.Restore</code>, here is an example on how to dynamically create form, data bind it, and create controls, all in runtime.</p>\n\n<pre><code>Sub NewControls()\n    Dim frm As Form\n    Dim ctlLabel As Control, ctlText As Control\n    Dim intDataX As Integer, intDataY As Integer\n    Dim intLabelX As Integer, intLabelY As Integer\n\n    ' Create new form with Orders table as its record source.\n    Set frm = CreateForm\n    frm.RecordSource = \"Orders\"\n    ' Set positioning values for new controls.\n    intLabelX = 100\n    intLabelY = 100\n    intDataX = 1000\n    intDataY = 100\n    ' Create unbound default-size text box in detail section.\n    Set ctlText = CreateControl(frm.Name, acTextBox, , \"\", \"\", _\n        intDataX, intDataY)\n    ' Create child label control for text box.\n    Set ctlLabel = CreateControl(frm.Name, acLabel, , _\n         ctlText.Name, \"NewLabel\", intLabelX, intLabelY)\n    ' Restore form.\n    DoCmd.Restore\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 481, "user_id": 1932159, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dc48e9b92e4210d7a3131b3ef46eb8b1?s=128&d=identicon&r=PG", "display_name": "PurTahan", "link": "https://stackoverflow.com/users/1932159/purtahan"}, "edited": false, "score": 0, "creation_date": 1563264305, "post_id": 42495084, "comment_id": 100631711, "body": "<code>DoCmd.OpenForm FormName, acDesign</code> has error. please help me. <code>Property not found</code> <b>3270</b>"}], "tags": [], "owner": {"reputation": 11, "user_id": 7631937, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/914cd68e64969f521e8528b3abc2c733?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/7631937/brian"}, "is_accepted": false, "score": 1, "last_activity_date": 1488229086, "last_edit_date": 1488229086, "creation_date": 1488227078, "answer_id": 42495084, "question_id": 31301070, "link": "https://stackoverflow.com/questions/31301070/how-to-create-controls-at-run-time-access-vb/42495084#42495084", "title": "How to create controls at run time Access VB?", "body": "<p>I took that upove code and simplified it as it was long winded, and turned it into a a sample code for my own future use.  Hope it helps someone in the future.</p>\n\n<pre><code>Public Sub runDynamicCreateControls()\n    Dim FormName As String\n    Dim NumControls As Integer\n    Dim n As Long\n    Dim ctl As Access.Control\n    Dim ctlname As String\n    On Error GoTo EH\n    Application.Echo False\n    FormName = \"createcontrolF\" 'Input Name of Form\n    NumControls = 20 'input number of controls\n    ctlname = \"txt\" 'input control name\n    DoCmd.OpenForm FormName, acDesign\n    For n = 1 To NumControls\n        With Application.CreateControl(FormName, acTextBox, acDetail, , , 1000,1000, 1100, 600)\n            .Name = ctlname &amp; \"_\" &amp; n\n            .Visible = True\n            .Tag = n\n        End With\n    Next 'n\n    DoCmd.Close acForm, FormName, acSaveYes\n    DoCmd.OpenForm FormName, acNormal\n    GoTo FINISH\nEH:\n    With Err\n        MsgBox \"Error:\" &amp; vbTab &amp; .Number &amp; vbCrLf _\n            &amp; \"Source\" &amp; vbTab &amp; .Source &amp; vbCrLf _\n            &amp; .Description\n    End With\nFINISH:\n    Application.Echo True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 3657834, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/14c105ad51a1fdd8a879ba96102b71c8?s=128&d=identicon&r=PG&f=1", "display_name": "user3657834", "link": "https://stackoverflow.com/users/3657834/user3657834"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16708, "favorite_count": 6, "answer_count": 4, "score": 6, "last_activity_date": 1488229086, "creation_date": 1436380882, "last_edit_date": 1436382198, "question_id": 31301070, "link": "https://stackoverflow.com/questions/31301070/how-to-create-controls-at-run-time-access-vb", "title": "How to create controls at run time Access VB?", "body": "<p>How can you create controls at run time with VB code in Microsoft Access? after some digging I found that this is possible with the <code>CreateControl</code> function. The problem is every random forum I find online has some code similar to this:</p>\n\n<pre><code>Private Sub Button_Click()\n    Call AddLabel\nEnd Sub\n\nFunction AddLabel()\n    Set ctl = CreateControl(\"MyForm\", acLabel, acDetail, \"\", \"\", 0, 0, 100, 100)\n    With ctl\n       .name = \"myTextBox\"\n       .Caption = \"Hello World!\"\n       .Height = 50\n       .Width = 100\n       .FontSize = 11\n       .Visible = True\n    End With\nEnd Function\n</code></pre>\n\n<p>but this code appears to not create a visible label.</p>\n\n<p>In my case I'm just trying to learn how to get this to work. So I created a blank form with a button that when clicked will create a label that says \"Hello world!\". What I'm expecting to happen is a textbox will display in the top left of the form when the button is clicked. I'm curious if anyone could help show me a simple example of some code that actually works. </p>\n\n<p>Before anyone says I can create a label and hide it then change its visibilty property, I know. But I'd like to know how to create controls dynamically and getting this simple example to actually work will greatly help my understanding.</p>\n"}, {"tags": ["vba", "architecture", "multiprocessing"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1436381466, "post_id": 31301033, "comment_id": 50592620, "body": "Some features of Excel can use multiple cores: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff700514(v=office.14).aspx#MultithreadedCalculation\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1436381878, "post_id": 31301033, "comment_id": 50592882, "body": "While that is something I didn&#39;t know and a rather interesting read, I dont think it accounts for this situation. The bulk of my find duplicates macro was comparing cells using if statements. I nested them for preformance so anywhere between 1 and 10 comparisions were performed on each row within a loop. This sounded like it parrallel calculated independant spreadsheet formulas."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1436381962, "post_id": 31301033, "comment_id": 50592922, "body": "Yes - I suspected that might be the case, but it was possible you were using some worksheet-level calculations so I posted anyway."}], "owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1501, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1436380760, "creation_date": 1436380760, "question_id": 31301033, "link": "https://stackoverflow.com/questions/31301033/multicore-processing-with-vba", "title": "MultiCore processing with VBA", "body": "<p>I know there is no way to thread or anything fancy like that with VBA but when I was recently running a find duplicates macro in VBA on about 60000 lines of excel data I opened task manager performance to find that all 4 cores of my processor were under heavier than normal usage. One core was at about 80% and the other 3 were at about 60%.</p>\n\n<p>This is rather high being as of right now none of them are going over 15%.</p>\n\n<p>So my question is how does my sequential VBA macro get divided into 4 parrallel parts that tax each processor core?</p>\n"}, {"tags": ["vba", "excel", "runtime"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436380431, "post_id": 31300694, "comment_id": 50591952, "body": "Have you somehow filled one or more rows with data all the way to column XFD? If you did, you should get a more detailed message that explained that you were trying to push data off the right-side of the worksheet. (btw, there is nothing wrong with your code once the gaps have been filled in and NO you do not have to select either a worksheet or a range before inserting a column)"}, {"owner": {"reputation": 33, "user_id": 4780010, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2227ddbce8817b363d29c1da28393bab?s=128&d=identicon&r=PG&f=1", "display_name": "huynle", "link": "https://stackoverflow.com/users/4780010/huynle"}, "edited": false, "score": 0, "creation_date": 1436381720, "post_id": 31300694, "comment_id": 50592785, "body": "Jeeped, how would i check if my data is filled all the way to XFD? i visually checked this by looking at how much the horizontal scrollbar is filled up on the sheet."}, {"owner": {"reputation": 19172, "user_id": 138938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d23af44c0135c0904c61f4cb0469771?s=128&d=identicon&r=PG", "display_name": "Jon Crowell", "link": "https://stackoverflow.com/users/138938/jon-crowell"}, "edited": false, "score": 1, "creation_date": 1436381775, "post_id": 31300694, "comment_id": 50592812, "body": "You can try to add the column manually through the UI. If the sheet is filled up, you won&#39;t be able to add the column. If you can, that isn&#39;t your issue."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436381793, "post_id": 31300694, "comment_id": 50592826, "body": "Try Shift+Ctrl+End to see where Excel thinks the <i>last_cell</i> is."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436381970, "post_id": 31300694, "comment_id": 50592925, "body": "You started with a brand spanking new workbook but have you locked the structure with worksheet or workbook protection in one of the steps that you omitted?"}, {"owner": {"reputation": 33, "user_id": 4780010, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2227ddbce8817b363d29c1da28393bab?s=128&d=identicon&r=PG&f=1", "display_name": "huynle", "link": "https://stackoverflow.com/users/4780010/huynle"}, "edited": false, "score": 0, "creation_date": 1436382052, "post_id": 31300694, "comment_id": 50592970, "body": "i tried this method.. and the last column is only to column &#39;O&#39; as expected. One thing i did noticed from other Workbook, is that the when i select a cell, the cell is not highlighted. can that be an issue?"}, {"owner": {"reputation": 19172, "user_id": 138938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d23af44c0135c0904c61f4cb0469771?s=128&d=identicon&r=PG", "display_name": "Jon Crowell", "link": "https://stackoverflow.com/users/138938/jon-crowell"}, "edited": false, "score": 0, "creation_date": 1436382135, "post_id": 31300694, "comment_id": 50593016, "body": "Can you post the rest of your code?"}, {"owner": {"reputation": 33, "user_id": 4780010, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2227ddbce8817b363d29c1da28393bab?s=128&d=identicon&r=PG&f=1", "display_name": "huynle", "link": "https://stackoverflow.com/users/4780010/huynle"}, "edited": false, "score": 0, "creation_date": 1436382704, "post_id": 31300694, "comment_id": 50593391, "body": "Jon, i have added the full sub function for your review. thanks for your time!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4780010, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2227ddbce8817b363d29c1da28393bab?s=128&d=identicon&r=PG&f=1", "display_name": "huynle", "link": "https://stackoverflow.com/users/4780010/huynle"}, "edited": false, "score": 0, "creation_date": 1436381841, "post_id": 31301071, "comment_id": 50592856, "body": "i did not activate the worksheet when i was copying sheet over.. would this have anything to do with it? and definitely, the SheetName is defined and it does exist in the TTB workbook"}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1436380888, "creation_date": 1436380888, "answer_id": 31301071, "question_id": 31300694, "link": "https://stackoverflow.com/questions/31300694/excel-vba-insert-column-runtime-error-1004/31301071#31301071", "title": "excel vba insert column runtime error 1004", "body": "<p>This works for me when I change the variable naming to:</p>\n\n<pre><code>Sub testingg()\nDim ttb_sheet As Worksheet\nSet ttb_sheet = Sheets(1)\n\nttb_sheet.Columns(\"I:I\").Insert Shift:=xlToRight\n\nEnd Sub\n</code></pre>\n\n<p>So I presume there's an issue with the way you reference the workbook when setting ttb_sheet on line 3. Note that you add a workbook but you aren't actually 'activating' it necessarily. And are you sure the 'Sheetname' actually exists in the TTB workbook?</p>\n"}, {"tags": [], "owner": {"reputation": 19172, "user_id": 138938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d23af44c0135c0904c61f4cb0469771?s=128&d=identicon&r=PG", "display_name": "Jon Crowell", "link": "https://stackoverflow.com/users/138938/jon-crowell"}, "is_accepted": false, "score": 1, "last_activity_date": 1436400013, "last_edit_date": 1436400013, "creation_date": 1436384396, "answer_id": 31302180, "question_id": 31300694, "link": "https://stackoverflow.com/questions/31300694/excel-vba-insert-column-runtime-error-1004/31302180#31302180", "title": "excel vba insert column runtime error 1004", "body": "<p>Whenever I run into an issue like this, I always isolate the code to its simplest form. Once I get it working at that level, I add it back in to the full application and can usually figure out what I did wrong.</p>\n\n<p>I've written a simple version of what you are trying to do. Note that I've included a few <code>Debug.Print</code> statements to help me verify what is going on. The debug messages will appear in your Immediate window. Obviously you can also step through the code and examine variables as you go.</p>\n\n<p>To get this to work, create a workbook and save it as DestinationWorkbook.xlsx. Then open another workbook and insert the code below.</p>\n\n<pre><code>Sub InsertColumnInDestinationWorksheet()\n    Dim sourceWb As Workbook\n    Dim targetWb As Workbook\n    Dim sourceWs As Worksheet\n    Dim targetWs As Worksheet\n\n    Set sourceWb = ThisWorkbook\n    Debug.Print sourceWb.Name\n\n    Set targetWb = Workbooks(\"DestinationWorkbook.xlsx\")\n    Debug.Print targetWb.Name\n\n    Set sourceWs = sourceWb.Sheets(\"Sheet1\")\n    Debug.Print sourceWs.Name\n\n    Set targetWs = targetWb.Sheets(\"Sheet1\")\n    Debug.Print targetWs.Name\n\n    targetWs.Range(\"I1\").Value2 = \"Moving right along...\"\n    targetWs.Columns(\"I:I\").Insert shift:=xlToRight\nEnd Sub\n</code></pre>\n\n<p>After running the code, you can examine the target sheet. You should see the text we wrote into column I is now in column J.</p>\n"}], "owner": {"reputation": 33, "user_id": 4780010, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2227ddbce8817b363d29c1da28393bab?s=128&d=identicon&r=PG&f=1", "display_name": "huynle", "link": "https://stackoverflow.com/users/4780010/huynle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3651, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1436400013, "creation_date": 1436379853, "last_edit_date": 1495539839, "question_id": 31300694, "link": "https://stackoverflow.com/questions/31300694/excel-vba-insert-column-runtime-error-1004", "title": "excel vba insert column runtime error 1004", "body": "<p>this is my first post on StackExchange! I've been using StackExchange for answers, but now i really have a question.</p>\n\n<p>I am trying to add a column in excel using vba. This is procedure is part of a bigger sub function of which I created a new workbook and copy a series of sheets from a different workbook over.</p>\n\n<pre><code>Workbooks.Add\nSet TTB = ActiveWorkbook\n'add a bunch of sheets here\n'sheetName = specific_sheet\nSet ttb_sheet = TTB.Sheets(sheetName)\nttb_sheet.Columns(\"I:I\").Insert Shift:=xlToRight\n</code></pre>\n\n<p>With this i get a runtime error of 1004: 'Insert method of Range class failed'</p>\n\n<p>I tried following a series of questions on StackOverflow...</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3902818/select-method-of-range-class-failed-via-vba\">Select method of Range class failed via VBA</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/10949893/vba-error-1004-select-method-of-range-class-failed\">VBA error 1004 - select method of range class failed</a></p>\n\n<p>It seems like the solution is to select the sheet first, then select the range. I have tried this and there was no luck. Anyone have any insight?</p>\n\n<p>Here's my main sub code..</p>\n\n<pre><code>Sub create_TTB_workbook(TTB_name_)\n'create TTB workbook\nDim wsHelper As New WorksheetHelper\nDim final_TTB As Workbook\nDim ttb_sheet As Worksheet\n\nttb_wb = ActiveWorkbook.name\nWorkbooks(ttb_wb).Activate\n\nPCB_tab = 0\nST_COMP_tab = 0\n\nFor Each WS In Worksheets\n\n    If WS.name = \"PCB_PIN_REPORT\" Then\n        PCB_tab = 1\n    End If\n    If WS.name = \"ST_PIN_REPORT\" Then\n        ST_COMP_tab = 1\n    End If\nNext WS\n\nWorkbooks.Add\nSet TTB = ActiveWorkbook\nnew_ttb_wb = TTB.name\n\nDebug.Print (new_ttb_wb)\n\nIf PCB_tab = 1 Then\n    wsHelper.copySheet ttb_wb, \"PCB_PIN_REPORT\", new_ttb_wb, \"PCB_PIN_REPORT\"\nEnd If\nIf ST_COMP_tab = 1 Then\n    wsHelper.copySheet ttb_wb, \"ST_PIN_REPORT\", new_ttb_wb, \"ST_PIN_REPORT\"\nEnd If\n\nwsHelper.copySheet ttb_wb, TTB_name_, new_ttb_wb, TTB_name_\n' TRIED A BUNCH OF METHODS here...\n'Workbooks(ttb_wb).Sheets(TTB_name_).Cells.copy\n'Sheets.Add.name = TTB_name_\n'ActiveSheet.paste\n\n'Sheets(TTB_name_).Activate\n'Columns(\"I:I\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n'Worksheets(TTB_name_).Range(\"I1\").EntireColumn.Insert\n\n'Columns(\"I:I\").Select\n\n'Columns(\"I:I\").Insert Shift:=xlToRight\n\nSet ttb_sheet = Sheets(TTB_name_)\nttb_sheet.Columns(\"I:I\").Insert Shift:=xlToRight\n\nColumns(\"K\").copy Destination:=Range(\"I1\")\nRange(\"I6\") = \"header name\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 5, "creation_date": 1436379384, "post_id": 31300364, "comment_id": 50591354, "body": "searchTerm is a Range and needs to be set and not just assigned. <code>Set searchTerm = .....etc....</code>"}, {"owner": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "reply_to_user": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 2, "creation_date": 1436379636, "post_id": 31300364, "comment_id": 50591490, "body": "As @NickSlash mentioned, you need to use Set to return a Range. Also you are using the .Column property at the end, which would return the Column number rather than a Range. You need to leave off the .Column."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436379652, "post_id": 31300364, "comment_id": 50591498, "body": "Why do you have searchTerm returning a column? You know already it&#39;ll be &quot;1&quot; (which is column A).  Just remove that part of the code (the .column).  Then just put &quot;Set&quot; before &quot;searchTerm - Range(...&quot; and you&#39;ll be good to go."}, {"owner": {"reputation": 97, "user_id": 1842030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kNrRc.png?s=128&g=1", "display_name": "Ashwood", "link": "https://stackoverflow.com/users/1842030/ashwood"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1436382617, "post_id": 31300364, "comment_id": 50593342, "body": "@user3578951 This gives me an error &quot;object variable or with block variable not set&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 1842030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kNrRc.png?s=128&g=1", "display_name": "Ashwood", "link": "https://stackoverflow.com/users/1842030/ashwood"}, "edited": false, "score": 0, "creation_date": 1436382634, "post_id": 31301186, "comment_id": 50593352, "body": "This also gives me an error of &quot;object variable or with block variable not set&quot;"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 97, "user_id": 1842030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kNrRc.png?s=128&g=1", "display_name": "Ashwood", "link": "https://stackoverflow.com/users/1842030/ashwood"}, "edited": false, "score": 0, "creation_date": 1436382821, "post_id": 31301186, "comment_id": 50593468, "body": "For my code and data this means that there is no <i>Happiness</i> in column <b>A</b>"}, {"owner": {"reputation": 97, "user_id": 1842030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kNrRc.png?s=128&g=1", "display_name": "Ashwood", "link": "https://stackoverflow.com/users/1842030/ashwood"}, "edited": false, "score": 0, "creation_date": 1436384566, "post_id": 31301186, "comment_id": 50594556, "body": "Thank you, your answer did help point me in the right direction"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1436381312, "creation_date": 1436381312, "answer_id": 31301186, "question_id": 31300364, "link": "https://stackoverflow.com/questions/31300364/vba-find-last-occurrence-of-a-string/31301186#31301186", "title": "VBA find last occurrence of a string", "body": "<p>How about:</p>\n\n<pre><code>Sub dural()\n    Dim job As String\n    Dim searchTerm As Range\n    job = \"Happiness\"\n    Set searchTerm = Range(\"A1:A999\").Find(what:=job, after:=Range(\"A1\"), searchorder:=xlByColumns, searchdirection:=xlPrevious)\n    MsgBox \"last cell is \" &amp; searchTerm.Address\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/U5lu3.png\" alt=\"enter image description here\"></p>\n\n<p><em>Notice I used <strong>Set</em></strong>.</p>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 1842030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kNrRc.png?s=128&g=1", "display_name": "Ashwood", "link": "https://stackoverflow.com/users/1842030/ashwood"}, "edited": false, "score": 0, "creation_date": 1436382751, "post_id": 31301205, "comment_id": 50593429, "body": "This has helped a bit, It keeps returning &quot;Text was not found&quot; So searchTerm isn&#39;t being set"}, {"owner": {"reputation": 5514, "user_id": 3190758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MM5AT.jpg?s=128&g=1", "display_name": "grovesNL", "link": "https://stackoverflow.com/users/3190758/grovesnl"}, "reply_to_user": {"reputation": 97, "user_id": 1842030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kNrRc.png?s=128&g=1", "display_name": "Ashwood", "link": "https://stackoverflow.com/users/1842030/ashwood"}, "edited": false, "score": 0, "creation_date": 1436382892, "post_id": 31301205, "comment_id": 50593509, "body": "@AshWood: Try a breakpoint or <code>MsgBox job</code> after the line <code>job = CmbBoxJob.Value</code>. Is the value what you expect? Either <code>CmbBoxJob.Value</code> does not have your search term, or the value is never found in the range you specified."}, {"owner": {"reputation": 97, "user_id": 1842030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kNrRc.png?s=128&g=1", "display_name": "Ashwood", "link": "https://stackoverflow.com/users/1842030/ashwood"}, "edited": false, "score": 0, "creation_date": 1436384545, "post_id": 31301205, "comment_id": 50594539, "body": "Thank you, I have got it sorted finally! Your answer helped me a alot"}], "tags": [], "owner": {"reputation": 5514, "user_id": 3190758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MM5AT.jpg?s=128&g=1", "display_name": "grovesNL", "link": "https://stackoverflow.com/users/3190758/grovesnl"}, "is_accepted": true, "score": 6, "last_activity_date": 1436381346, "creation_date": 1436381346, "answer_id": 31301205, "question_id": 31300364, "link": "https://stackoverflow.com/questions/31300364/vba-find-last-occurrence-of-a-string/31301205#31301205", "title": "VBA find last occurrence of a string", "body": "<p>The first issue is that <code>searchTerm</code> is defined as a <code>Range</code> object. You must set object assignments using the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264263.aspx\"><code>Set</code> keyword</a>. So the assignment becomes <code>Set searchTerm = Range(\"A1:A999\")...</code></p>\n\n<p>Secondly, you will hit error messages if the <code>searchTerm</code> is not found, because <code>searchTerm</code> will be assigned a value of <code>Nothing</code>. We can avoid this issue by using a simple condition to check if the <code>job</code> was found.</p>\n\n<p>Therefore your updated <code>Sub</code> may look something like this:</p>\n\n<pre><code>Private Sub CmdBtnClockIt_Click()\n  Dim job As String\n  Dim searchTerm As Range\n\n  job = CmbBoxJob.Value\n  Set searchTerm = Range(\"A1:A999\").Find(what:=job, searchorder:=xlByColumns, searchdirection:=xlPrevious)\n  If searchTerm Is Nothing Then\n    MsgBox \"Text was not found\"\n  Else\n    MsgBox \"Last cell is \" &amp; searchTerm.Address\n  End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 1842030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kNrRc.png?s=128&g=1", "display_name": "Ashwood", "link": "https://stackoverflow.com/users/1842030/ashwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10952, "favorite_count": 0, "accepted_answer_id": 31301205, "answer_count": 2, "score": 5, "last_activity_date": 1436381346, "creation_date": 1436378854, "last_edit_date": 1436379330, "question_id": 31300364, "link": "https://stackoverflow.com/questions/31300364/vba-find-last-occurrence-of-a-string", "title": "VBA find last occurrence of a string", "body": "<p>I've been trying to work this problem out for a few days now and I just can't get my head around it. I have searched multiple websites (Even here several times), I have seen that many people have asked this question but the solutions don't work for me.</p>\n\n<p>I want to find the last occurrence of a string in a range and store the address in a variable and display a message telling me where it is.</p>\n\n<p>So far I have this</p>\n\n<pre><code>Private Sub CmdBtnClockIt_Click()\n  Dim job As String\n  Dim searchTerm as Range\n\n  job = CmbBoxJob.Value\n  searchTerm = Range(\"A1:A999\").find(what:=job, searchorder:=xlByColumns, searchdirection:=xlPrevious).Column\n  MsgBox \"last cell is \" &amp; searchTerm.Address\nEnd Sub\n</code></pre>\n\n<p>All I seem to get is either \"invalid qualifier\" or \"object variable or with block variable not set\"</p>\n\n<p>Any help is appreciated</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1436380524, "post_id": 31300173, "comment_id": 50592003, "body": "CustomXMLPart (2010+)?  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865361(v=office.14).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1436382368, "post_id": 31300173, "comment_id": 50593178, "body": "CustomXMLPart sounds interesting. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "edited": false, "score": 0, "creation_date": 1436382133, "post_id": 31300291, "comment_id": 50593015, "body": "If it would be just me or my team working with the Excel file then this could be an option. Unfortunately this spreadsheet is going to be used by consumer level users. That is why the file needs to be able to handle it all by it self."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "edited": false, "score": 0, "creation_date": 1436382521, "post_id": 31300291, "comment_id": 50593285, "body": "Even if a consumer level user has this file, you should be able to package your offering together with your .txt file alongside your .xlsx file. If the &#39;consumers&#39; still work in a location which accesses a common work network, the consider even having that file in a public location. You wouldn&#39;t need to send the .txt around at all (although the user would need to have access to the network at the point of using the Excel file)."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "edited": false, "score": 0, "creation_date": 1436382610, "post_id": 31300291, "comment_id": 50593337, "body": "Though I don&#39;t have much experience with this, you can rename a .xlsx file to .zip and it will allow you to open it like a folder. You can place files inside that zipped package, and rename to .xlsx. This will technically allow you to save it as a single file, but I personally don&#39;t have experience referring to &quot;internal&quot; files like this within a macro. It&#39;s basically the same as what I suggested except that the file size again because a limit if you are emailing the Excel file around."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1436387013, "post_id": 31300291, "comment_id": 50595983, "body": "@GradeEhBacon it&#39;s a good idea to work with .xlsx as .zip, but seems there are issues like validation errors (unreadable content) and file access lock (while file is opened with Excel), that couldn&#39;t be solved unfortunately."}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 3, "last_activity_date": 1436378619, "creation_date": 1436378619, "answer_id": 31300291, "question_id": 31300173, "link": "https://stackoverflow.com/questions/31300173/how-to-embed-large-max-10mb-text-files-into-an-excel-file/31300291#31300291", "title": "How to embed large (max 10Mb) text files into an Excel file", "body": "<p>It would likely be best to simply save the .txt file alongside the Excel file, and have the macro pull the text as needed from that folder. To read more on importing files see this:</p>\n\n<p><a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-customize/vba-code-to-import-multiple-text-files-from/525bd388-0f7d-4b4a-89f9-310c67227458\" rel=\"nofollow\">http://answers.microsoft.com/en-us/office/forum/office_2010-customize/vba-code-to-import-multiple-text-files-from/525bd388-0f7d-4b4a-89f9-310c67227458</a></p>\n\n<p>Keeping the .txt within the Excel file itself is not necessary and will likely make it harder to transfer files in the long run. For example, if you cannot e-mail a file larger than 10MB, then you can simply break your .txt file in half and e-mail separately - using a macro which loads the text into Excel locally.</p>\n"}, {"comments": [{"owner": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "edited": false, "score": 0, "creation_date": 1436455683, "post_id": 31304691, "comment_id": 50630608, "body": "Some sources say that there would be a maximum length of 1024 or 2048 characters for the Label Caption. Do you have an experience that there could be more than 2048 characters in the caption?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "edited": false, "score": 0, "creation_date": 1436465891, "post_id": 31304691, "comment_id": 50636877, "body": "For my system <code>ActiveX Control Label</code>, which used in code above, has capacity approx. 90 MB per element, for reference: <code>Forms Control Label</code> has limitation of 32 kB per element, and @TimWilliams&#39; <code>CustomXMLPart</code> capacity is approx. 50 MB per element. I must confess that <code>CustomXMLPart</code> is faster, native, and has higher compression ratio for result .xlsx file."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 1, "last_activity_date": 1436393234, "creation_date": 1436393234, "answer_id": 31304691, "question_id": 31300173, "link": "https://stackoverflow.com/questions/31300173/how-to-embed-large-max-10mb-text-files-into-an-excel-file/31304691#31304691", "title": "How to embed large (max 10Mb) text files into an Excel file", "body": "<p>Consider the method shown below. It uses <code>Caption</code> property of <code>Label</code> object located on a worksheet for data storage. So you can create a number of such containers with different names.</p>\n\n<pre><code>Sub Test()\n    Dim sText\n    ' create special hidden sheet for data storage\n    If Not IsSheetExists(\"storage\") Then\n        With ThisWorkbook.Worksheets.Add()\n            .Name = \"storage\"\n            .Visible = xlVeryHidden\n        End With\n    End If\n    ' create new OLE object TypeForms.Label type as container\n    AddContainer \"test_container_\"\n    ' read text from file\n    sText = ReadTextFile(\"C:\\Users\\DELL\\Desktop\\tmp\\tmp.txt\", 0)\n    ' put text into container\n    PutContent \"test_container_\", sText\n    ' retrieve text from container\n    sText = GetContent(\"test_container_\")\n    ' show length\n    MsgBox Len(sText)\n    ' remove container\n    RemoveContainer \"test_container_\"\nEnd Sub\n\nFunction IsSheetExists(sSheetName)\n    Dim oSheet\n    For Each oSheet In ThisWorkbook.Sheets\n        If oSheet.Name = sSheetName Then\n            IsSheetExists = True\n            Exit Function\n        End If\n    Next\n    IsSheetExists = False\nEnd Function\n\nSub AddContainer(sName)\n    With ThisWorkbook.Sheets(\"storage\").OLEObjects.Add(ClassType:=\"Forms.Label.1\")\n        .Visible = False\n        .Name = sName\n    End With\nEnd Sub\n\nSub RemoveContainer(sName)\n    ThisWorkbook.Sheets(\"storage\").OLEObjects.Item(sName).Delete\nEnd Sub\n\nSub PutContent(sName, sContent)\n    ThisWorkbook.Sheets(\"storage\").OLEObjects.Item(sName).Object.Caption = sContent\nEnd Sub\n\nFunction GetContent(sName)\n    GetContent = ThisWorkbook.Sheets(\"storage\").OLEObjects.Item(sName).Object.Caption\nEnd Function\n\nFunction ReadTextFile(sPath, iFormat)\n    With CreateObject(\"Scripting.FileSystemObject\").OpenTextFile(sPath, 1, False, iFormat)\n        ReadTextFile = \"\"\n        If Not .AtEndOfStream Then ReadTextFile = .ReadAll\n        .Close\n    End With\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "edited": false, "score": 0, "creation_date": 1436455469, "post_id": 31305606, "comment_id": 50630466, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/bb216070%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb216070%28v=office.12%29.a&zwnj;&#8203;spx</a> says that Excel 2007 supports CustomXMLParts. I think this is a very promising solution."}, {"owner": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "edited": false, "score": 0, "creation_date": 1439909579, "post_id": 31305606, "comment_id": 52047988, "body": "The stinks, Mac VBA does not know about CustomXMLPart. Why Microsoft makes VBA in different platforms so different from each other. I quess I need to have the .txt file alongside the Excel file on mac."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1436398257, "creation_date": 1436398257, "answer_id": 31305606, "question_id": 31300173, "link": "https://stackoverflow.com/questions/31300173/how-to-embed-large-max-10mb-text-files-into-an-excel-file/31305606#31305606", "title": "How to embed large (max 10Mb) text files into an Excel file", "body": "<p>Very simple CustomXMLPart example:</p>\n\n<pre><code>Sub CustomTextTester()\n\n    Dim cxp1 As CustomXMLPart, cxp2 As CustomXMLPart\n    Dim txt As String\n\n    'read file content\n    txt = CreateObject(\"scripting.filesystemobject\").opentextfile( _\n                                      \"C:\\_Stuff\\test.txt\").readall()\n\n    'Add a custom XML part with that content\n    Set cxp1 = ThisWorkbook.CustomXMLParts.Add(\"&lt;myXMLPart&gt;&lt;content&gt;&lt;![CDATA[\" &amp; txt _\n                                               &amp; \"]]&gt;&lt;/content&gt;&lt;/myXMLPart&gt;\")\n\n    Debug.Print cxp1.SelectSingleNode(\"myXMLPart/content\").FirstChild.NodeValue\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1111, "favorite_count": 2, "accepted_answer_id": 31305606, "answer_count": 3, "score": 2, "last_activity_date": 1436398257, "creation_date": 1436378190, "question_id": 31300173, "link": "https://stackoverflow.com/questions/31300173/how-to-embed-large-max-10mb-text-files-into-an-excel-file", "title": "How to embed large (max 10Mb) text files into an Excel file", "body": "<p>What is the best way to store a large text file (max 10Mb) in an Excel file? </p>\n\n<p>I have a couple of requirements:</p>\n\n<ol>\n<li><p>It has to be embedded so that the excel file can be moved and sent to a different computer and all the text files will follow.</p></li>\n<li><p>It needs to be done from a macro.</p></li>\n<li><p>And a macro needs to be able to read the file contents after it has been embedded.</p></li>\n</ol>\n\n<p>I already tried to store it by breaking the text into several chunks enough small to fit into a cell (~32 000 chars), but it didn't work. After my macro had inserted the first 150 000 characters it gave me an \"Out of Memory\" error.</p>\n\n<p>I remember seeing one web page with a couple of options for this I but cannot find it anymore. Any suggestions are most welcome. I will try them out if you are not sure if it works or not.</p>\n"}, {"tags": ["vba", "excel", "reference", "range", "cell"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4643531, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d47605fa37d7427544d9e7eecdcb5b13?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4643531/bryan"}, "edited": false, "score": 0, "creation_date": 1436379217, "post_id": 31300325, "comment_id": 50591245, "body": "Unfortunately I am not familiar with how to utilize a function properly. I tried a couple ways to no avail and just read the differences between when to use a function, but still couldn&#39;t implement it. I just get error &quot;Object doesnt support this property or method&quot; Also does Sheets(1) matter if the sheet name is different or is that simply 1 = active?"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 89, "user_id": 4643531, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d47605fa37d7427544d9e7eecdcb5b13?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4643531/bryan"}, "edited": false, "score": 1, "creation_date": 1436379284, "post_id": 31300325, "comment_id": 50591299, "body": "See my edits - this works for most functions but it appears that &#39;Indirect&#39; is not supported in this way. makes sense as that is more confusing IMO anyway."}, {"owner": {"reputation": 89, "user_id": 4643531, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d47605fa37d7427544d9e7eecdcb5b13?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4643531/bryan"}, "edited": false, "score": 0, "creation_date": 1436406665, "post_id": 31300325, "comment_id": 50602858, "body": "Ahh great, yeah that seems safer as I have ran into that issue in the past, ill make that one work! Any chance you have knowledge on this post? No one has responded and its been up for 1 month...  <a href=\"http://stackoverflow.com/questions/30764616/downloaded-new-versions-of-files-need-to-be-opened-and-saved-to-work-automatic-r\" title=\"downloaded new versions of files need to be opened and saved to work automatic r\">stackoverflow.com/questions/30764616/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1436379237, "last_edit_date": 1436379237, "creation_date": 1436378739, "answer_id": 31300325, "question_id": 31300156, "link": "https://stackoverflow.com/questions/31300156/how-to-use-indirect-reference-to-select-a-single-cell-or-range-in-vba/31300325#31300325", "title": "How to use indirect reference to select a single cell or range in vba", "body": "<p>You can do this a different way, but if you want to use a native Excel worksheet function within your VBA code, you need to do this like so (note that I have also adjusted how you reference A1):</p>\n\n<pre><code>Application.WorksheetFunction.Indirect(Sheets(1).Range(\"A1\"))\n</code></pre>\n\n<p><strong>Edit</strong>\nApologies - I hadn't test this. It seems that the Indirect function is not available in this context. Instead, try something like this:</p>\n\n<pre><code>Dim rng as Range\nSet rng = sheets(1).Range(\"A1\")\n\nsheets(1).Range(rng.text).Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 4643531, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d47605fa37d7427544d9e7eecdcb5b13?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4643531/bryan"}, "edited": false, "score": 0, "creation_date": 1436381631, "post_id": 31301086, "comment_id": 50592731, "body": "Thanks! The first and third ones worked! I will go with the third one since you advise them instead."}, {"owner": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "reply_to_user": {"reputation": 89, "user_id": 4643531, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d47605fa37d7427544d9e7eecdcb5b13?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4643531/bryan"}, "edited": false, "score": 0, "creation_date": 1436381931, "post_id": 31301086, "comment_id": 50592906, "body": "The second formula needs adapting to the sheet you are using, this would be <code>Sheet1</code> for the first sheet of a new workbook. This is often recommended in practice as then the code will always work the same and won&#39;t depend on which sheet is currently active."}], "tags": [], "owner": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1436380916, "creation_date": 1436380916, "answer_id": 31301086, "question_id": 31300156, "link": "https://stackoverflow.com/questions/31300156/how-to-use-indirect-reference-to-select-a-single-cell-or-range-in-vba/31301086#31301086", "title": "How to use indirect reference to select a single cell or range in vba", "body": "<p>A slight alteration to the posted code works: </p>\n\n<pre><code>Range([indirect(\"a1\")]).Select\n</code></pre>\n\n<p>but I would advise to try either of these instead:</p>\n\n<pre><code>Sheet.Range(Sheet.Range(\"A1\").Value).Select\nRange(Range(\"A1\")).Select\n</code></pre>\n\n<p>the first being more explicit and is recommended in production code.</p>\n"}, {"comments": [{"owner": {"reputation": 8957, "user_id": 3345375, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TbVFk.png?s=128&g=1", "display_name": "jkdev", "link": "https://stackoverflow.com/users/3345375/jkdev"}, "edited": false, "score": 1, "creation_date": 1471625019, "post_id": 39035944, "comment_id": 65437709, "body": "Welcome to Stack Overflow! You can clarify your answer by adding a more detailed explanation along with the code sample."}], "tags": [], "owner": {"reputation": 1, "user_id": 6734313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c086526805a751c6ee899f780fa8c159?s=128&d=identicon&r=PG", "display_name": "user6734313", "link": "https://stackoverflow.com/users/6734313/user6734313"}, "is_accepted": false, "score": 0, "last_activity_date": 1471600543, "last_edit_date": 1471600543, "creation_date": 1471600099, "answer_id": 39035944, "question_id": 31300156, "link": "https://stackoverflow.com/questions/31300156/how-to-use-indirect-reference-to-select-a-single-cell-or-range-in-vba/39035944#39035944", "title": "How to use indirect reference to select a single cell or range in vba", "body": "<pre><code>Worksheets(\"list\").Sort.SortFields.Add Key:=Range(INDIRECT(\"I16\" &amp; \"3\" &amp; \":\" &amp; \"I16\" &amp; \"5002\")) _\n        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With Worksheets(\"list\").Sort\n        .SetRange Range(\"B2:K5002\")\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 4643531, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d47605fa37d7427544d9e7eecdcb5b13?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/4643531/bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53184, "favorite_count": 0, "accepted_answer_id": 31301086, "answer_count": 3, "score": 5, "last_activity_date": 1471600543, "creation_date": 1436378140, "last_edit_date": 1436378583, "question_id": 31300156, "link": "https://stackoverflow.com/questions/31300156/how-to-use-indirect-reference-to-select-a-single-cell-or-range-in-vba", "title": "How to use indirect reference to select a single cell or range in vba", "body": "<p>I need simply a code for selecting a cell, however that cell to select changes. I have a cell in the workbook that will identify what cell it should be. Cell A1 contains the cell # that should be selected. </p>\n\n<p>In this example cell A1 contains the word \"P25\", so I want the below code to reference A1 for the indirect cell ref to P25, thus select cell P25. </p>\n\n<p>I tried both of these lines separately:</p>\n\n<pre><code>Sub IndirectCellSelect()\n\n     Sheet.Range(INDIRECT(A1)).Select\n     Range(INDIRECT(A1)).Select\n\nEnd Sub\n</code></pre>\n\n<p>I get the error Sub or Function is not defined, when it gets to the word INDIRECT </p>\n"}, {"tags": ["html", "excel", "calendar", "vba"], "owner": {"reputation": 11, "user_id": 5095190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acffe24fb37a6f4052f83390dcfcbb73?s=128&d=identicon&r=PG&f=1", "display_name": "IanAdd", "link": "https://stackoverflow.com/users/5095190/ianadd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1436378839, "creation_date": 1436378133, "last_edit_date": 1531164843, "question_id": 31300155, "link": "https://stackoverflow.com/questions/31300155/writing-to-live-com-calendar", "title": "writing to live.com calendar", "body": "<p>I want to write calendar entries from an excel spreadsheet into my live.com calendar.</p>\n\n<p>I am using VBA and have basically succeeded, I can write the start date and end date, I can add description, all fine.</p>\n\n<p>However I cannot work out how to write the start and end Times. If I write the time into the .text it is basically ignored. If I look at the page being written the data-entry box vanishes and the time is shown as text but is ignored. </p>\n\n<p>Can anyone help?</p>\n\n<pre><code>' GoToPage takes me to the right web paage and logs me in if necessary and sets HTMLDoc up.\n\nGoToPage(\"calendar.live.com/calendar/calendar.aspx?rru=addevent\")\n\n\nHTMLdoc.all.Item(\"__livecal_id2\").Value = Str(fromdate)\n\nHTMLdoc.all.Item(\"ns10_startTime\").Text = \"16:00:00\" ' doesn't do what I expect\n\nHTMLdoc.all.Item(\"ns10_durationSelect\").Value = \"Custom\"\n\nHTMLdoc.all.Item(\"__livecal_id3\").Value = Str(todate)\n\nHTMLdoc.all.Item(\"ns10_endTime\").Text = \"10:00:00\"\n\nHTMLdoc.all.Item(\"ns10_whatField\").Value = who\n\nHTMLdoc.all.Item(\"ns10_saveButton\").Click\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": true, "score": 3, "last_activity_date": 1436380268, "creation_date": 1436380268, "answer_id": 31300834, "question_id": 31300092, "link": "https://stackoverflow.com/questions/31300092/compare-two-pivot-tables/31300834#31300834", "title": "Compare Two Pivot Tables", "body": "<p>There are two broad ways to achieve this without VBA. The first is to create a 'helper column' next to each pivot table. In that column, starting at row 1 and dragged down, type (Assuming the name is in column A and the ID is in column B)</p>\n\n<pre><code>=A1&amp;B1\n</code></pre>\n\n<p>Then with that done in both tables, use the MATCH function to determine if any of the NAME&amp;ID strings matches, like so, starting in cell D1 on sheet1 (assuming the NAME&amp;ID string is in column C):</p>\n\n<pre><code>=match(C1,Sheet2!C:C,0)\n</code></pre>\n\n<p>If it shows a number, that means there was a match found in the other sheet. If it shows N/A#, then there was no match found. To clean it up a bit, wrap that in the function ISERROR, like so:</p>\n\n<pre><code>=iserror(match(C1,Sheet2!C:C,0))\n</code></pre>\n\n<p>If it says TRUE in a cell, that means the MATCH function found no matching data, which creates an error. If it says FALSE, that means there was a match found, meaning there is a duplicate value.</p>\n\n<p>Alternatively, you can do this without creating helper columns, but I don't recommend if you are unfamiliar with array formulas.</p>\n\n<p>Put this formula in Sheet1, cell C1, and drag down (when the formula is typed, confirm by pressing CTRL + SHIFT + ENTER, instead of just ENTER):</p>\n\n<pre><code>=iserror(match(A1&amp;B1,sheet2!A1:A100&amp;sheet2!B1:B100))\n</code></pre>\n\n<p>Note that with an array function you must specify how far down your column goes, or performance will lag significantly.</p>\n"}], "owner": {"reputation": 21, "user_id": 5061589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153442029721410/picture?type=large", "display_name": "DragoSalaamii", "link": "https://stackoverflow.com/users/5061589/dragosalaamii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15995, "favorite_count": 0, "accepted_answer_id": 31300834, "answer_count": 1, "score": 1, "last_activity_date": 1536126394, "creation_date": 1436377976, "last_edit_date": 1536126394, "question_id": 31300092, "link": "https://stackoverflow.com/questions/31300092/compare-two-pivot-tables", "title": "Compare Two Pivot Tables", "body": "<p>I have two pivot tables, one in Column A, one in Column B, and they are formatted the same way.</p>\n\n<p>The pivot tables have a list of Users, and under each User a list of IDs.</p>\n\n<p>Is there a way I can compare the two pivot tables against each other? I want to match Users in both tables and see which Users have duplicate IDs.</p>\n\n<p>To help visualize, the tables look something like this:</p>\n\n<p>Table 1  </p>\n\n<pre><code>-------------------------                                          \n| DAVE  | asgh4 | lshg8 |                                         \n| MATT  | 39f8  | 2352  |                                               \n-------------------------\n</code></pre>\n\n<p>Table 2</p>\n\n<pre><code>-------------------------\n| PETER | dgghn  | lkasj|\n| DAVE  | asgh4  | 38gfj|\n-------------------------\n</code></pre>\n\n<p>I want to see matches like \"DAVE\" and \"asgh4\" because the user matches and the ID matches. Is there a way to accomplish this? Thanks!</p>\n"}, {"tags": ["vba", "excel", "variables", "vbscript"], "comments": [{"owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1436378108, "post_id": 31300086, "comment_id": 50590530, "body": "Do you need to use VBA? This seems like a good opportunity to use <a href=\"https://support.office.com/en-za/article/CONCATENATE-function-8f8ae884-2ca8-4f7a-b093-75d702bea31d\" rel=\"nofollow noreferrer\">=CONCATENATE</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 3, "last_activity_date": 1436378073, "creation_date": 1436378073, "answer_id": 31300124, "question_id": 31300086, "link": "https://stackoverflow.com/questions/31300086/excel-setting-a-variable-to-be-a/31300124#31300124", "title": "Excel Setting a variable to be a", "body": "<p>Assuming your first row is row 2, you'd enter the following worksheet function in A2:</p>\n\n<pre><code>=\"Dear \"&amp;B2&amp;\" \"&amp;C2\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1436378305, "creation_date": 1436378305, "answer_id": 31300208, "question_id": 31300086, "link": "https://stackoverflow.com/questions/31300086/excel-setting-a-variable-to-be-a/31300208#31300208", "title": "Excel Setting a variable to be a", "body": "<pre><code>dim str as string\nstr = replace(range(\"A2\"), \"var$\", range(\"B2\") &amp; chr(32) &amp; range(\"C2\"))\n'do something with str\n</code></pre>\n"}], "owner": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 31300124, "answer_count": 2, "score": 1, "last_activity_date": 1436378305, "creation_date": 1436377966, "last_edit_date": 1436378256, "question_id": 31300086, "link": "https://stackoverflow.com/questions/31300086/excel-setting-a-variable-to-be-a", "title": "Excel Setting a variable to be a", "body": "<p>I have like 3 columns in a spreadsheet. \nThey are <code>Body</code>, <code>First Name</code>, and <code>Last Name</code>. For example: </p>\n\n<pre><code>Body               First Name                  Last Name                        \n</code></pre>\n\n<p><code>Dear $var etc...      Jon                         Doe</code><br>\n<code>Dear $var etc...      Jane                        Doe</code> </p>\n\n<p>What I want is for <code>$var</code> to be the concatenation with a space of the first name on current row plus a space plus the last name on the same row. </p>\n\n<p>Basically the body in the end should be appear to be <code>\"Dear Jon Doe\"</code>  and <code>\"Dear Jane Doe\"</code>. I hope I made myself clear enough. Please ask questions for further clarification.</p>\n"}, {"tags": ["vba", "excel", "replace", "find"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1436376731, "post_id": 31299638, "comment_id": 50589669, "body": "Have you tried recording the Find &amp; Replace action performed directly on the worksheet? (Ctrl+H)"}, {"owner": {"reputation": 1, "user_id": 5095104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d04f208420441bc080e06ef92ce0fbe0?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny P", "link": "https://stackoverflow.com/users/5095104/jenny-p"}, "edited": false, "score": 0, "creation_date": 1436378205, "post_id": 31299638, "comment_id": 50590596, "body": "Yes, but it doesn&#39;t work. The macro seems to run, but no changes. In fact it does but I cannot control it.  I could write Columns(&quot;Z:Z&quot;).Select     ActiveCell.Replace What:=&quot;A&quot;, Replacement:=&quot;B&quot;, LookAt:=xlPart, _         SearchOrder:=xlByColumns, MatchCase:=True, SearchFormat:=False, _         ReplaceFormat:=False and it works but it I change &quot;A&quot; and &quot;B&quot; to something like Range(&quot;X1&quot;).Value it does not anymore. I also forgot to mention that I want the string that is to be found, and its replacement to be input parameters."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5095104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d04f208420441bc080e06ef92ce0fbe0?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny P", "link": "https://stackoverflow.com/users/5095104/jenny-p"}, "edited": false, "score": 0, "creation_date": 1436379899, "post_id": 31300145, "comment_id": 50591641, "body": "Thanks, this one finally worked. Still it wouldn&#39;t work if I used column numbers. I had to change the number to the name of the column."}], "tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": false, "score": 2, "last_activity_date": 1436378117, "creation_date": 1436378117, "answer_id": 31300145, "question_id": 31299638, "link": "https://stackoverflow.com/questions/31299638/how-to-replace-a-part-of-formula-and-modify-it-using-excel-vba/31300145#31300145", "title": "How to replace a part of formula and modify it using excel VBA?", "body": "<p>For example looping through column A using i as the counter:</p>\n\n<pre><code>Cells(i,1).Formula = Replace(Cells(i,1).Formula,\"82\",\"85\")\nCells(i,1).Formula = Replace(Cells(i,1).Formula,\"$F$\",\"$H$\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5095104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d04f208420441bc080e06ef92ce0fbe0?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny P", "link": "https://stackoverflow.com/users/5095104/jenny-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10981, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1436378117, "creation_date": 1436376603, "question_id": 31299638, "link": "https://stackoverflow.com/questions/31299638/how-to-replace-a-part-of-formula-and-modify-it-using-excel-vba", "title": "How to replace a part of formula and modify it using excel VBA?", "body": "<p>Let's say I have a column in excel where many cells are populated with values from sheets and a formula. For example, a cell has '82'!G7*2*F3^2*$F$6. (where 82 is the name of the sheet values are coming from. I want to write a for or loop that goes through all the cells and change all the 82s to something else, 85 for example. and also the $F$s to $H$. </p>\n\n<p>What's the code to find these certain parts to then be able to replace them within the formula or whatever it is that is in a cell?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1436376538, "post_id": 31299500, "comment_id": 50589554, "body": "Possible duplicate of: <a href=\"http://stackoverflow.com/questions/11707888/sum-function-in-vba\">stackoverflow.com/questions/11707888/sum-function-in-vba</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436377158, "post_id": 31299500, "comment_id": 50589929, "body": "You can use many worksheet functions within VBA. e.g. <code>Dim dTotal as double: dTotal = Application.Sum(Range(&quot;A1:A9&quot;))</code> ."}], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1436377129, "creation_date": 1436377129, "answer_id": 31299830, "question_id": 31299500, "link": "https://stackoverflow.com/questions/31299500/how-do-you-sum-a-range-in-a-sheet-using-vba/31299830#31299830", "title": "How do you sum a range in a sheet using vba", "body": "<p>One method would be </p>\n\n<pre><code>Dim rng as Range\nDim lAnswer as Long\n\nSet rng = sheets(1).Range(\"A1:A5\")\n\nlAnswer = application.WorksheetFunction.Sum(rng)\n</code></pre>\n\n<p>This works because application.WorksheetFunction creates a reference to all functions available within an excel sheet.</p>\n"}], "owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6061, "favorite_count": 0, "closed_date": 1436403507, "answer_count": 1, "score": -1, "last_activity_date": 1436377129, "creation_date": 1436376205, "last_edit_date": 1436376488, "question_id": 31299500, "link": "https://stackoverflow.com/questions/31299500/how-do-you-sum-a-range-in-a-sheet-using-vba", "closed_reason": "Needs more focus", "title": "How do you sum a range in a sheet using vba", "body": "<p>How do you sum a range in a sheet using vba. </p>\n\n<p>I tried many different things but I can't figure it out. Thank you.</p>\n\n<pre><code>Sheet3.Sum...\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1436382095, "post_id": 31299374, "comment_id": 50592989, "body": "&quot;Enter&quot; here means &quot;about to get focus&quot; (i.e. you are about to &quot;go in to&quot; the control), not &quot;user pressed enter&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 0, "last_activity_date": 1436385589, "creation_date": 1436385589, "answer_id": 31302535, "question_id": 31299374, "link": "https://stackoverflow.com/questions/31299374/excel-userform-runs-button1-enter-when-tab-to-button1-without-hitting-enter/31302535#31302535", "title": "Excel Userform runs Button1_Enter when tab to Button1 (without hitting Enter)", "body": "<p>Place you code in the <code>Button1_Click</code> event instead of the <code>Button1_Enter</code>. As Tim points out, \"Enter\" refers to receiving focus and not clicking of the button hence the behavior you've described.</p>\n"}], "owner": {"reputation": 65, "user_id": 4597946, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0decbde175760966460b4e22c1598a33?s=128&d=identicon&r=PG&f=1", "display_name": "Julie", "link": "https://stackoverflow.com/users/4597946/julie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436385589, "creation_date": 1436375824, "question_id": 31299374, "link": "https://stackoverflow.com/questions/31299374/excel-userform-runs-button1-enter-when-tab-to-button1-without-hitting-enter", "title": "Excel Userform runs Button1_Enter when tab to Button1 (without hitting Enter)", "body": "<p>I have created a small UserForm in Excel. I have created Button1 and have enabled the tab index. When I tab from a drop down box to Button1, it assumes that I have hit enter on the button, just by simply tabbing to it. Is there a way to disable this?</p>\n\n<p>I want the user to tab to Button1 and then actually hit Enter or click. I am not sure why simply clicking tab after previous item is running the macro in Button1_Enter.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436375334, "post_id": 31299191, "comment_id": 50588825, "body": "Given the orientation of the example, I was thinking that the <a href=\"https://support.office.com/en-us/article/HLOOKUP-function-f3f3b210-5dd6-4b58-9c83-b9db2c306d6a\" rel=\"nofollow noreferrer\">HLOOKUP function</a> would be more appropriate."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1436375486, "post_id": 31299191, "comment_id": 50588920, "body": "@Jeeped is right - my comments above only apply if you have your &quot;index key&quot; (the type of fruit, in this case) running along a column. If instead your fruits are along the top, so row 1 shows fruit, row 2 shows location, etc., then the formula would be =hlookup(A1,sheet2!A1:E4,2)"}, {"owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1436376723, "post_id": 31299191, "comment_id": 50589665, "body": "Thank you both! I got it to work using the extra tips. Luckily, I didn&#39;t have the data filled in yet so I was able to do it the VLookup way but I just learned a new function so thanks @Jeeped. I really need to learn VLOOKUP!! Thank you a million more times!"}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": true, "score": 8, "last_activity_date": 1436375257, "creation_date": 1436375257, "answer_id": 31299191, "question_id": 31299063, "link": "https://stackoverflow.com/questions/31299063/excel-drop-down-with-if/31299191#31299191", "title": "Excel Drop Down with IF", "body": "<p>There are many ways to do what you're asking. Vlookup is probably the simplest.</p>\n\n<p>First, you need a table somewhere which has all of your data in it. Something that has all of your fruits in one column, and then a column for each attribute (location, colour, etc.) to the right.</p>\n\n<p>So on sheet2, you could put your raw table data. Starting at A1, you type your fruits on column A, etc.</p>\n\n<p>Then your formula on sheet 1 would look at what you've typed in cell A1, and pull data from sheet 2, based on that value. For example, sheet1 A2, which looks for the fruit's location, would be:</p>\n\n<pre><code>=vlookup(A1,sheet2!A1:D5,2)\n</code></pre>\n\n<p>Assuming your table on sheet2 starts at A1 with fruits on column A, and location in column B, and it goes only to row 5.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 1162972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a104dc298bea8f752b4e88627b7a10e?s=128&d=identicon&r=PG", "display_name": "Ryan McCool", "link": "https://stackoverflow.com/users/1162972/ryan-mccool"}, "is_accepted": false, "score": 0, "last_activity_date": 1436383956, "creation_date": 1436383956, "answer_id": 31302020, "question_id": 31299063, "link": "https://stackoverflow.com/questions/31299063/excel-drop-down-with-if/31302020#31302020", "title": "Excel Drop Down with IF", "body": "<p>You can also use the <a href=\"https://support.office.com/en-in/article/INDIRECT-function-474b3a3a-8a26-4f44-b491-92b6306fa261\" rel=\"nofollow\">INDIRECT function</a> to help correlate between two lists.</p>\n"}], "owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 31299191, "answer_count": 2, "score": 0, "last_activity_date": 1436383956, "creation_date": 1436374821, "last_edit_date": 1531161705, "question_id": 31299063, "link": "https://stackoverflow.com/questions/31299063/excel-drop-down-with-if", "title": "Excel Drop Down with IF", "body": "<p>I want to create a sheet that uses drop downs and fills in some blank spaces based on selection.</p>\n\n<p>Let's say the drop down has Apple, Banana, Cucumber, and Pear. When I create the tables for each one, I have additional information for each one. A1 is the finding word (vlookup) and the other 3 in this case are additional pieces of information.</p>\n\n<p>Sheet(Data)</p>\n\n<p>A1: Apple<br>\nA2: Made in USA<br>\nA3: Red<br>\nA4: Round</p>\n\n<p>On Sheet1, I have a drop down. When I choose Apple on A20, I'd like to fill in A21, A22, A23 with the descriptions as above. So when choosing Apple, it fills it in. If I chose Banana, it could have different variables with it depending on what I put under Banana.</p>\n\n<p>I'm familiar with IF statement, but it seems like it would be too many variables. I have 15 \"fruits\" to choose from and each one may contain something different to fill in those spaces.</p>\n\n<p>Would this be a possibility?</p>\n"}, {"tags": ["arrays", "vba", "for-loop"], "comments": [{"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "edited": false, "score": 0, "creation_date": 1436374215, "post_id": 31298829, "comment_id": 50588170, "body": "do you want to remove anything after and including the first occurance of a number?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1436374754, "post_id": 31298829, "comment_id": 50588500, "body": "Is there an error with your current code?  Do you have a specific question related to your current code?"}, {"owner": {"reputation": 169, "user_id": 3324611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-2aPHF--Nkl0/AAAAAAAAAAI/AAAAAAAAAE4/OyfWjxNx_D0/photo.jpg?sz=128", "display_name": "herkyonparade", "link": "https://stackoverflow.com/users/3324611/herkyonparade"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1436378894, "post_id": 31298829, "comment_id": 50591058, "body": "@Chrismas007 Thanks for pointing that out. I edited the question"}, {"owner": {"reputation": 169, "user_id": 3324611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-2aPHF--Nkl0/AAAAAAAAAAI/AAAAAAAAAE4/OyfWjxNx_D0/photo.jpg?sz=128", "display_name": "herkyonparade", "link": "https://stackoverflow.com/users/3324611/herkyonparade"}, "reply_to_user": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "edited": false, "score": 0, "creation_date": 1436379082, "post_id": 31298829, "comment_id": 50591170, "body": "@Krishna I want to remove everything after and the first occurrence of a space followed by a number or decimal point"}, {"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "edited": false, "score": 0, "creation_date": 1436380290, "post_id": 31298829, "comment_id": 50591880, "body": "ok, updated the regexp below. this worked for me"}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 3324611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-2aPHF--Nkl0/AAAAAAAAAAI/AAAAAAAAAE4/OyfWjxNx_D0/photo.jpg?sz=128", "display_name": "herkyonparade", "link": "https://stackoverflow.com/users/3324611/herkyonparade"}, "edited": false, "score": 0, "creation_date": 1436391092, "post_id": 31298988, "comment_id": 50598051, "body": "I&#39;m unsure how to get this to work. Where am I plugging this in at? Is there anyway to tweak the code I provided?"}, {"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "reply_to_user": {"reputation": 169, "user_id": 3324611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-2aPHF--Nkl0/AAAAAAAAAAI/AAAAAAAAAE4/OyfWjxNx_D0/photo.jpg?sz=128", "display_name": "herkyonparade", "link": "https://stackoverflow.com/users/3324611/herkyonparade"}, "edited": false, "score": 0, "creation_date": 1436391933, "post_id": 31298988, "comment_id": 50598461, "body": "the problem with the code you supplied is for every string, you will need to check for an occurrence of an item within the array. this is going to be cumbersome and less effective. but if that is the only way to go, then please see my edit. I strongly feel that you should change yours to the Regex way"}, {"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "reply_to_user": {"reputation": 169, "user_id": 3324611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-2aPHF--Nkl0/AAAAAAAAAAI/AAAAAAAAAE4/OyfWjxNx_D0/photo.jpg?sz=128", "display_name": "herkyonparade", "link": "https://stackoverflow.com/users/3324611/herkyonparade"}, "edited": false, "score": 0, "creation_date": 1436445920, "post_id": 31298988, "comment_id": 50622990, "body": "were you able to fix it?"}, {"owner": {"reputation": 169, "user_id": 3324611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-2aPHF--Nkl0/AAAAAAAAAAI/AAAAAAAAAE4/OyfWjxNx_D0/photo.jpg?sz=128", "display_name": "herkyonparade", "link": "https://stackoverflow.com/users/3324611/herkyonparade"}, "edited": false, "score": 0, "creation_date": 1436449294, "post_id": 31298988, "comment_id": 50625598, "body": "Yes, it works. Thanks for explaining it through. I still don&#39;t understand your Regex way, but I&#39;m just a VBA beginner!"}], "tags": [], "owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "is_accepted": true, "score": 3, "last_activity_date": 1436391985, "last_edit_date": 1436391985, "creation_date": 1436374589, "answer_id": 31298988, "question_id": 31298829, "link": "https://stackoverflow.com/questions/31298829/remove-everything-to-the-right-after-a-list-of-strings/31298988#31298988", "title": "Remove everything to the right after a list of strings", "body": "<p>Will this work for you  if you want get text before a number occurance?</p>\n\n<p>you need to add reference to Microsoft VBScript Reglar Expressions 5.5</p>\n\n<pre><code>Debug.print GetLeftPart (\"TA COCO TROP 16.9OZ\")\n\nFunction GetLeftPart (stringToCheck As String) as string\n   Dim regex As New RegExp\n   Dim regmatch As MatchCollection\n   regex.Pattern = \"\\s\\d\"\n   Set regmatch = regex.Execute(stringToCheck)\n   GetLeftPart = Left(stringToCheck , regmatch.Item(0).FirstIndex)\nEnd function\n</code></pre>\n\n<p>alternative more cumbersome way but since the author already started working along, this may suit the context</p>\n\n<pre><code>Sub KeepItem()\n\nDim itemDescr As Range\nDim Rng As Range\nDim xChar As Variant\nDim ele As Variant\nDim iFoundAt As Integer\nDim xValue As String\n\nSet itemDescr = Range(\"$D:$D\")\nxChar = Array(\" 1\", \" 2\", \" 3\", \" 4\", \" 5\", \" 6\", \" 7\", \" 8\", \" 9\", \" .\")\n\nFor Each Rng In itemDescr\n    iFoundAt = 0\n    xValue = Rng.Value\n    'find if this is a line we are interested in\n    If xValue = \"\" Then GoTo continue 'Question - do you want to continue or stop. if stop replace continue with exit for\n    For Each ele In xChar\n        iFoundAt = InStr(xValue, ele)\n        If iFoundAt &gt; 0 Then Exit For\n    Next\n    If iFoundAt &gt; 0 Then Rng.Value = Left(xValue, iFoundAt - 1)\ncontinue:\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1436394773, "creation_date": 1436394773, "answer_id": 31304992, "question_id": 31298829, "link": "https://stackoverflow.com/questions/31298829/remove-everything-to-the-right-after-a-list-of-strings/31304992#31304992", "title": "Remove everything to the right after a list of strings", "body": "<p>Try this, for each cell in the range it loops 0 through 9 using a Split command to split the string into an array, we want everything to the left so we take the first element (index 0), then trim out the space.</p>\n\n<pre><code>Sub RemoveNumOnwards()\nDim X As Long, Y As Long\nFor X = 1 To Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n    For Y = 0 To 9\n        Range(\"D\" &amp; X).Formula = Trim(Split(Range(\"D\" &amp; X).text, Y)(0))\n    Next\nNext\nEnd Sub\n</code></pre>\n\n<p>Edit: Just saw your note about the decimal point, here is the updated code:</p>\n\n<pre><code>Sub RemoveNumOnwards()\nDim X As Long, Y As Long, xChar As Variant\nxChar = Array(\" 1\", \" 2\", \" 3\", \" 4\", \" 5\", \" 6\", \" 7\", \" 8\", \" 9\", \" .\")\nFor X = 1 To Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n    For Y = LBound(xChar) To UBound(xChar)\n        Range(\"D\" &amp; X).Formula = Trim(Split(Range(\"D\" &amp; X).text, xChar(Y))(0))\n    Next\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 3324611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-2aPHF--Nkl0/AAAAAAAAAAI/AAAAAAAAAE4/OyfWjxNx_D0/photo.jpg?sz=128", "display_name": "herkyonparade", "link": "https://stackoverflow.com/users/3324611/herkyonparade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 31298988, "answer_count": 2, "score": 2, "last_activity_date": 1436394773, "creation_date": 1436374107, "last_edit_date": 1436379264, "question_id": 31298829, "link": "https://stackoverflow.com/questions/31298829/remove-everything-to-the-right-after-a-list-of-strings", "title": "Remove everything to the right after a list of strings", "body": "<p>I'm trying to remove everything to the right after a list of specific strings for a column.</p>\n\n<pre><code>Sub KeepItem()\n\nDim itemDescr As Range\nDim Rng As Range\nDim xChar As Variant\n\nSet itemDescr = Range(\"$D:$D\")\nxChar = Array(\" 1\", \" 2\", \" 3\", \" 4\", \" 5\", \" 6\", \" 7\", \" 8\", \" 9\", \" .\")\n\nFor Each Rng In itemDescr\n    xValue = Rng.Value\n    Rng.Value = Left(xValue, InStr(xValue, xChar) - 1)\nNext\n\nEnd Sub\n</code></pre>\n\n<p>This</p>\n\n<pre><code>VITA COCO TROP 16.9OZ\nARGO CAROLINA HNY 13.5OZ GLS\nARGO GRN TEA GNGR 13.5OZ GLS\nARGO HIBISC SNGRIA 13.5OZ GLS\nARGO MOJI TEA 13.5OZ GLS\n</code></pre>\n\n<p>Should look like:</p>\n\n<pre><code>VITA COCO TROP\nARGO CAROLINA HNY\nARGO GRN TEA GNGR\nARGO HIBISC SNGRIA\nARGO MOJI TEA\n</code></pre>\n\n<p>I'm a novice VBA programmer and I'd appreciate your feedback.</p>\n\n<p>Error in: (Type mismatch):</p>\n\n<pre><code>Rng.Value = Left(xValue, InStr(xValue, xChar) - 1)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1436371702, "post_id": 31297866, "comment_id": 50586582, "body": "If you post the specifics of what you&#39;ve tried, you&#39;re more likely to have someone help you fix it, as opposed to having it written for you."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1436373263, "post_id": 31297866, "comment_id": 50587550, "body": "There are so many <code>#|#|</code> and <code>####</code> Which of the values are you looking for?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1436377501, "post_id": 31297866, "comment_id": 50590137, "body": "i Should remove all the strings between #|#| and #### but not between #|#| and #|#| and ####"}], "answers": [{"comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1436378061, "post_id": 31298039, "comment_id": 50590494, "body": "I added the line at the bottom to write the modified string in the variable back to the spreadsheet.  As is stated this is just modifying cell A1.  If you need a loop example i can provide it."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1436380829, "post_id": 31298039, "comment_id": 50592197, "body": "ws needs to be your worksheet.  I will add that for you."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1436542704, "post_id": 31298039, "comment_id": 50673495, "body": "Hi MathewD, thanks for helping :)  Finally my source has been updated."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436380851, "last_edit_date": 1436380851, "creation_date": 1436371733, "answer_id": 31298039, "question_id": 31297866, "link": "https://stackoverflow.com/questions/31297866/removing-particular-string-from-a-cell/31298039#31298039", "title": "Removing particular string from a cell", "body": "<p>Something like this.</p>\n\n<p>If that value is in cell A1</p>\n\n<pre><code>Dim str As String\nDim i As Integer\nDim i2 As Integer\nDim ws As Excel.Worksheet\n\nSet ws = Application.ActiveSheet\n\nstr = ws.Range(\"A1\").Value\ni = InStr(str, \"#|#|\")\ni2 = InStr(str, \"####\")\n\nstr = Left(str, i) &amp; Right(str, Len(str) - i2)\n\nws.Range(\"A1\").Value = str\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1436377603, "post_id": 31298745, "comment_id": 50590210, "body": "I got error on &quot;Dim reg As New RegExp&quot; should i do?"}, {"owner": {"reputation": 358, "user_id": 5042442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee21c40fa5a3ec804e543cb7d510a3d9?s=128&d=identicon&r=PG", "display_name": "Latch", "link": "https://stackoverflow.com/users/5042442/latch"}, "reply_to_user": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 1, "creation_date": 1436378774, "post_id": 31298745, "comment_id": 50590969, "body": "Did you add the reference to the Microsoft VBScript Regular Expressions 5.5? Here is a step by step on doing so: <a href=\"http://stackoverflow.com/a/22542835/5042442\">stackoverflow.com/a/22542835/5042442</a>  You only need to do the step 1 steps."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1436379319, "post_id": 31298745, "comment_id": 50591324, "body": "Sry i know English only that link has some other language"}, {"owner": {"reputation": 358, "user_id": 5042442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee21c40fa5a3ec804e543cb7d510a3d9?s=128&d=identicon&r=PG", "display_name": "Latch", "link": "https://stackoverflow.com/users/5042442/latch"}, "reply_to_user": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1436380922, "post_id": 31298745, "comment_id": 50592257, "body": "This link is definitely english... <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264402.aspx\" rel=\"nofollow noreferrer\">Here is the msdn entry</a> on adding a reference. You can change the language at the bottom left if it&#39;s easier to you. Then you need to find Microsoft VBScript Regular Expressions 5.5 in the window that opens."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1436542673, "post_id": 31298745, "comment_id": 50673474, "body": "Hi Latch, thanks for helping :)  Finally my source has been updated."}], "tags": [], "owner": {"reputation": 358, "user_id": 5042442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee21c40fa5a3ec804e543cb7d510a3d9?s=128&d=identicon&r=PG", "display_name": "Latch", "link": "https://stackoverflow.com/users/5042442/latch"}, "is_accepted": false, "score": 1, "last_activity_date": 1436377118, "last_edit_date": 1436377118, "creation_date": 1436373774, "answer_id": 31298745, "question_id": 31297866, "link": "https://stackoverflow.com/questions/31297866/removing-particular-string-from-a-cell/31298745#31298745", "title": "Removing particular string from a cell", "body": "<p>The other solution will remove anything between the first #|#| and ####, event the #||# etc. </p>\n\n<p>In case you only need to remove the text between #|#| and #### only if there is no other ##|| inbetween, I think the simplest way is to use a regex.</p>\n\n<p>You will need to activate the Microsoft VBScript Regular Expressions 5.5 library in Tools->References from the VBA editor.</p>\n\n<p>Change range(\"D166\") to wherever your cell is. The expression as it is right now (\"#\\|#\\|[A-Za-z0-9&amp; ]*####\")matches any text that starts with #|#|, ends with #### and has any number of alphanumerical character, &amp; or space. You can add other caracters between the brakets if needed.</p>\n\n<pre><code>Sub remove()\nDim reg As New RegExp\nDim pattern As String\nDim replace As String\nDim strInput As String\nstrInput = Range(\"D166\").Value\nreplace = \"\"\npattern = \"#\\|#\\|[A-Za-z0-9&amp; ]*####\"\nWith reg\n    .Global = True\n    .MultiLine = True\n    .IgnoreCase = False\n    .pattern = pattern\nEnd With\n\n\nIf reg.test(strInput) Then Range(\"D166\").Value = reg.replace(strInput, replace)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1436380851, "creation_date": 1436371217, "last_edit_date": 1531161705, "question_id": 31297866, "link": "https://stackoverflow.com/questions/31297866/removing-particular-string-from-a-cell", "title": "Removing particular string from a cell", "body": "<p>I have text in a range of cells like</p>\n\n<p>Manufacturer#||#Coaster#|#|Width (side to side)#||#20\" W####Height (bottom to top)#||#35\" H#|#|Depth (front to back)#||#20.5\" D####Seat Depth#||#14.25\"**#|#|Material &amp; Finish####**Composition#||#Wood Veneers &amp; Solids#|#|Composition#||#Metal#|#|Style Elements####Style#||#Contemporary#|#|Style#||#Casual</p>\n\n<p>From this cell i need to remove strings between #|#|\"needtoremove\"#### only without affecting other strings. \nI have tried find and replace, finding #|#|*#### and replacing it with #|#|. However its not giving the exact result.</p>\n\n<p>Can anyone help me? </p>\n"}, {"tags": ["vba", "excel", "password-protection"], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 3, "last_activity_date": 1436371247, "creation_date": 1436371247, "answer_id": 31297876, "question_id": 31297188, "link": "https://stackoverflow.com/questions/31297188/how-to-unprotect-an-excel-workbook/31297876#31297876", "title": "How to unprotect an Excel workbook", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff196695.aspx\" rel=\"nofollow\">Here is what the MSDN says</a></p>\n\n<pre><code>Sub Example()\n    Dim WB as Workbook\n    Dim pw as String\n\n    Set WB = ThisWorkbook\n    pw = \"Your password\"\n    WB.Unprotect(pw)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 4, "last_activity_date": 1436371608, "creation_date": 1436371608, "answer_id": 31297998, "question_id": 31297188, "link": "https://stackoverflow.com/questions/31297188/how-to-unprotect-an-excel-workbook/31297998#31297998", "title": "How to unprotect an Excel workbook", "body": "<p>If it's the password to open the file, you want:</p>\n\n<pre><code>Thisworkbook.Password = \"\"\n</code></pre>\n\n<p>then save it.</p>\n\n<p><code>Wb.Unprotect</code> would remove the password that protects the workbook structure/windows.</p>\n"}], "owner": {"reputation": 237, "user_id": 3873262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e668b2ddec5b66447e1cb1f696b4fa5?s=128&d=identicon&r=PG&f=1", "display_name": "mjavon", "link": "https://stackoverflow.com/users/3873262/mjavon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6553, "favorite_count": 0, "accepted_answer_id": 31297998, "answer_count": 2, "score": 3, "last_activity_date": 1462366549, "creation_date": 1436369409, "last_edit_date": 1462366549, "question_id": 31297188, "link": "https://stackoverflow.com/questions/31297188/how-to-unprotect-an-excel-workbook", "title": "How to unprotect an Excel workbook", "body": "<p>I have an Excel workbook that is password protected (the entire document, not just a sheet or set of sheets - you can't open the file without the password).  I know the password, so I am able to open it, but there is no obvious way to turn off the password protection.</p>\n\n<p>Specifically, I would like to do this in VBA, because eventually I want to be able to do this to multiple files using a loop.  I tried using:</p>\n\n<pre><code>ThisWorkbook.Unprotect(Password = \"[password]\")\n</code></pre>\n\n<p>but this does absolutely nothing.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "edited": false, "score": 0, "creation_date": 1436369711, "post_id": 31296881, "comment_id": 50585227, "body": "Are you aware that the formula you provided [=MAX(..)] is wrong?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436369769, "post_id": 31296881, "comment_id": 50585278, "body": "Because you are using a <i>relative</i> row number in the CF formula, you need to select a cell in that row in your code before you apply the CF."}, {"owner": {"reputation": 53, "user_id": 5040968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d560c150d2a862397ec7e7e80dac9b43?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Oropeza", "link": "https://stackoverflow.com/users/5040968/sergio-oropeza"}, "edited": false, "score": 0, "creation_date": 1436371201, "post_id": 31296881, "comment_id": 50586233, "body": "how is the max formula wrong is it does what I need it to do? im confused."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5040968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d560c150d2a862397ec7e7e80dac9b43?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Oropeza", "link": "https://stackoverflow.com/users/5040968/sergio-oropeza"}, "edited": false, "score": 0, "creation_date": 1436370333, "post_id": 31296968, "comment_id": 50585663, "body": "If Range(&quot;$H$5&quot;) = Range(&quot;$L8&quot;) Then     copysheet.Range(&quot;l&quot; &amp; lRow).Font.ColorIndex = 3"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 53, "user_id": 5040968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d560c150d2a862397ec7e7e80dac9b43?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Oropeza", "link": "https://stackoverflow.com/users/5040968/sergio-oropeza"}, "edited": false, "score": 0, "creation_date": 1436370469, "post_id": 31296968, "comment_id": 50585750, "body": "@Sergio Oropeza You need to change the range in the copysheet. \t If Range(&quot;$H$5&quot;) = Range(&quot;$L8&quot;) Then copysheet.Range(&quot;$H$5&quot;).Font.ColorIndex = 3"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1436368871, "creation_date": 1436368871, "answer_id": 31296968, "question_id": 31296881, "link": "https://stackoverflow.com/questions/31296881/conditional-formatting-vba-not-highlighting-cell-in-a-specific-cell-in-a-workshe/31296968#31296968", "title": "Conditional formatting VBA not highlighting cell in a specific cell in a worksheet", "body": "<p>You could do your formatting in your code.  Something like this.</p>\n\n<pre><code>if somecondition then\n    copysheet.Range(\"I\" &amp; lRow).Font.ColorIndex = 3\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5040968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d560c150d2a862397ec7e7e80dac9b43?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Oropeza", "link": "https://stackoverflow.com/users/5040968/sergio-oropeza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 31296968, "answer_count": 1, "score": 1, "last_activity_date": 1436368871, "creation_date": 1436368663, "question_id": 31296881, "link": "https://stackoverflow.com/questions/31296881/conditional-formatting-vba-not-highlighting-cell-in-a-specific-cell-in-a-workshe", "title": "Conditional formatting VBA not highlighting cell in a specific cell in a worksheet", "body": "<p>I had a quick question about the conditional formatting part of my code,</p>\n\n<p>the rest of the code works perfect but when I get to the conditional formatting part,  the row I wanted to highlight doesn't. I want the row with to be highlighted based on a value that is on cell H5 on the copysheet area.</p>\n\n<p>cell H5 has the formala =MAX(IF(ISERROR(\"L8:L2500,\"\",L8:2500\") which finds the max value in range L</p>\n\n<p>is there any way to apply conditional formatting to search for that max value? </p>\n\n<pre><code>Sub Search()\n\nDim vCrit As Variant\nDim filtersheet As Worksheet\nDim copysheet As Worksheet\nDim rngCrit As Range\nDim rngList As Range\n\n\n\nSet filtersheet = Worksheets(\"Datalog\")\nSet copysheet = Worksheets(\"Line Inquiry\")\n\n\nfiltersheet.Unprotect\n\n\nSet rngCrit = filtersheet.Range(\"$A$7:$L$2500\").CurrentRegion\nSet rngList = copysheet.Range(\"B5\")\n\n\n\nvCrit = Sheets(\"Datalog\").Range(\"O3\")\n\ncopysheet.Range(\"A8:K2500\").Clear\n\n\nWith filtersheet\nrngCrit.AutoFilter _\nField:=3, _\nCriteria1:=Application.Transpose(vCrit), _\nOperator:=xlFilterValues\n\n\n\nrngCrit.SpecialCells(xlCellTypeVisible).Copy\ncopysheet.Range(\"A7\").PasteSpecial xlPasteFormulasAndNumberFormats\nApplication.CutCopyMode = False\n\nApplication.ScreenUpdating = False\nfiltersheet.AutoFilterMode = False\n\n\nfiltersheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\n\ncopysheet.Range(\"A8:L2500\").FormatConditions.Delete\n\nWith copysheet.Range(\"$A8:$L8\").FormatConditions.Add( _\nType:=xlExpression, _\nFormula1:=\"=$H$5=$L8\")\n.Interior.Color = RGB(198, 239, 206)\n.Font.Color = RGB(0, 97, 0)\n\n\n    End With\n\nEnd With\n\n'returning to original sheet\ncopysheet.Range(\"B5\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1436368731, "post_id": 31296755, "comment_id": 50584454, "body": "Just a note that if you declare a variable in another sub and (a) it isn&#39;t a global declaration, such as saying &#39;Public x as integer&#39;; and (b) it isn&#39;t passed to another sub when that other sub is called, then it isn&#39;t the &quot;same&quot; variable. It is poor practice to use the same name between subs for something that refers to a different item."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436369132, "post_id": 31296755, "comment_id": 50584782, "body": "How are you setting the third field in an AutoFilter that only has one column as its scope?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1436369278, "post_id": 31296755, "comment_id": 50584910, "body": "<code>End(xlDown)</code> is notoriously bad because you might have some blanks in data.  Instead use <code>lastrow = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1436369346, "post_id": 31296755, "comment_id": 50584961, "body": "You are deleting rows in a top-to-bottom progression. This means that as soon as you delete one row, all of the other rows change their worksheet references so you cannot simply move to the next as the next is no longer where it used to be. Always delete rows working from the bottom to the top to avoid this."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436369921, "post_id": 31296755, "comment_id": 50585385, "body": "It should just be <code>wRange.AutoFilter 1, &quot;&quot;</code> or if the cells are actually empty, just use <code>Range(&quot;$C$7:$C$&quot; &amp; lastrow).SpecialCells(xlCelltypeblanks).EntireRow.Delete</code>"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1436370207, "post_id": 31296755, "comment_id": 50585585, "body": "What @Jeeped said. Work from the bottom up to prevent skipping rows. (Make that an <b>answer</b>!)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436370908, "post_id": 31296755, "comment_id": 50586051, "body": "@Rory - If that was coupled with an <code>If Application.CountBlank(...)</code> to avoid errors, it is a better method than filtering. Suggest you flesh it out to an answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436375073, "post_id": 31296755, "comment_id": 50588689, "body": "BTW, the reason you were populating cells with TRUE was this malformed code line: <code>wRange = wRange.AutoFilter(3)</code> . It assigns TRUE to the values in wRange."}], "answers": [{"tags": [], "owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "is_accepted": false, "score": 0, "last_activity_date": 1436370665, "creation_date": 1436370665, "answer_id": 31297679, "question_id": 31296755, "link": "https://stackoverflow.com/questions/31296755/vba-autofilter-returns-true-for-each-loop-hits-every-other-cell/31297679#31297679", "title": "VBA: AutoFilter returns TRUE; For Each loop hits every other cell", "body": "<p>A better way to check if there is any information in a cell is the IsEmpty function: </p>\n\n<pre><code>If IsEmpty(cell(1, 1)) = True\n       wCell.EntireRow.DELETE\nendif\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1436370970, "post_id": 31297682, "comment_id": 50586096, "body": "<code>End(xlDown)</code> is notoriously bad because you might have some blanks in data. Instead use <code>lastrow = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1436371281, "post_id": 31297682, "comment_id": 50586290, "body": "You&#39;re certainly correct; it&#39;s not my preferred method. I usually go with .CurrentRegion for filtering (there could be a blank in the last row&#39;s columns A and C but data in other columns) but I left it as the OP knows the original data and has been cautioned already."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1436371315, "post_id": 31297682, "comment_id": 50586319, "body": "Just making a note on the answer :-D"}, {"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1436374338, "post_id": 31297682, "comment_id": 50588252, "body": "What does .CurrentRegion take into account?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1436374734, "post_id": 31297682, "comment_id": 50588489, "body": "@Tawm - The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow noreferrer\">Range.CurrentRegion property</a> is an island of data surrounding any cell. It extends in all directions until it meets the edge of the worksheet or a fully blank row or a fully blank column. It is analogous to selecting a single cell and tapping Ctrl+A once."}, {"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1436375884, "post_id": 31297682, "comment_id": 50589164, "body": "How could I use that for a column?  <code>wRange = wRange.CurrentRegion(0,1)</code> would select the entire column of the selected cell?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1436376331, "post_id": 31297682, "comment_id": 50589424, "body": "This is getting increasingly difficult to respond to properly without seeing some example of your data but if row 6 is completely blank then the current region of any cell in row 7 should reference row 7 down to the extents of the data as wide as there is data. So <code>.Cells(7, 3).CurrentRegion.Columns(3)</code> is the same as <code>.Cells(7, 1).CurrentRegion.Columns(3)</code> , e.g. column C."}, {"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1436378252, "post_id": 31297682, "comment_id": 50590625, "body": "Okay so I&#39;ve found another area in my code where it seems (my idea of) <code>CurrentRegion</code> would work great.  I&#39;m trying to see if there are ANY non-blank cells within the range from A7 on.  That is, A-Q and 7-inf.  I&#39;m trying to use the line <code>If Range(&quot;A7&quot;).Cells(7,1).CurrentRegion.Columns(1) Is Empty Then</code>.  I feel like I&#39;m giving too much information in this line; I say the column and row twice."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1436370673, "creation_date": 1436370673, "answer_id": 31297682, "question_id": 31296755, "link": "https://stackoverflow.com/questions/31296755/vba-autofilter-returns-true-for-each-loop-hits-every-other-cell/31297682#31297682", "title": "VBA: AutoFilter returns TRUE; For Each loop hits every other cell", "body": "<p>When deleting rows individually, <em>always</em> work from the bottom to the top. The nature of a <code>For Each wCell In wRange2</code> is such that you are working from the top to the bottom.</p>\n\n<p>In any event, deleting the rows in bulk would be preferred.</p>\n\n<pre><code>Sub DeleteBlankRows()\n    Dim wRange As Range\n    Dim lastrow As Long\n\n    With ActiveSheet   '&lt;-set this worksheet erference properly!\n        If .AutoFilterMode Then .AutoFilterMode = False\n        lastrow = .Range(\"A7\").End(xlDown).Row\n        Set wRange = .Range(\"$A$7:$C$\" &amp; lastrow)\n\n        With wRange\n            .AutoFilter field:=3, Criteria1:=\"\"\n            With .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count)\n                If CBool(Application.Subtotal(103, .Columns(1))) Then\n                    .SpecialCells(xlCellTypeVisible).EntireRow.Delete\n                End If\n            End With\n            .AutoFilter field:=3\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>As per your sample code, I've left the autofilter active but cleared the filter.</p>\n"}, {"comments": [{"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1436385314, "post_id": 31297941, "comment_id": 50595030, "body": "I&#39;ve seen and used <code>On Error GoTo 0</code> before, but I don&#39;t know what <code>0</code> is.  Could you explain?"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1436371448, "creation_date": 1436371448, "answer_id": 31297941, "question_id": 31296755, "link": "https://stackoverflow.com/questions/31296755/vba-autofilter-returns-true-for-each-loop-hits-every-other-cell/31297941#31297941", "title": "VBA: AutoFilter returns TRUE; For Each loop hits every other cell", "body": "<p>If the cells in question in column C are actually empty, rather than formulas returning \"\" for example, you could use something like this:</p>\n\n<pre><code>Sub DeleteBlankRows()\n\n    Dim wRange                As Range\n    Dim lastrow               As Long\n\n    lastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    If lastrow &gt; 7 Then\n        On Error Resume Next\n        Set wRange = Range(\"C7:C\" &amp; lastrow).SpecialCells(xlCellTypeBlanks)\n        On Error GoTo 0\n        If Not wRange Is Nothing Then wRange.EntireRow.Delete\n    ElseIf lastrow = 7 Then\n        If Len(Range(\"C7\").Value) = 0 Then Rows(7).Delete\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 31297941, "answer_count": 3, "score": 0, "last_activity_date": 1436371448, "creation_date": 1436368331, "question_id": 31296755, "link": "https://stackoverflow.com/questions/31296755/vba-autofilter-returns-true-for-each-loop-hits-every-other-cell", "title": "VBA: AutoFilter returns TRUE; For Each loop hits every other cell", "body": "<p>I'm trying to run the below Sub within another Sub.</p>\n\n<p>The issue I'm having is <code>wRange.AutoFilter(3, \"\")</code> fills all cells in wRange with <code>TRUE</code>, overwriting the data which was previously in them.</p>\n\n<p>Just to see if it would work aside from the <code>TRUE</code> issue, I changed the line <code>If wCell = \"\" Then</code> to <code>If wCell = \"True\"</code> and I see that it does not delete every row, but rather <em>every other</em> row.</p>\n\n<hr>\n\n<pre><code>Sub DeleteBlankRows()\n\nDim wRange As Range\nDim wRange2 As Range\nDim lastrow As Integer\n\nlastrow = Range(\"A7\").End(xlDown).Row\nSet wRange = Range(\"$C$7:$C$\" &amp; lastrow)\nwRange = wRange.AutoFilter(3, \"\")\n\nRange(\"$A$10000\").Select\nSelection.End(xlUp).Select\nIf ActiveCell.Row &lt;&gt; 5 Then\n    Set wRange2 = wRange.SpecialCells(xlCellTypeVisible)\n    For Each wCell In wRange2\n        If wCell = \"\" Then\n            wCell.EntireRow.DELETE\n        End If\n    Next wCell\nEnd If\nwRange = wRange.AutoFilter(3)\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Can you see why it would be doing that?</p>\n\n<p>Thanks for your help.</p>\n\n<hr>\n\n<p><strong>P.S.</strong> As a side note, I originally had the sub has <code>Sub DeleteBlankRows(ByRef wRange)</code> and it didn't have a problem that I hadn't said what <code>wRange2</code> was.  Both of these <code>Dims</code> are stated in the larger Sub which this is run in, but that doesn't make sense to me.</p>\n"}, {"tags": ["arrays", "xml", "vba", "excel"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436368355, "post_id": 31296713, "comment_id": 50584158, "body": "<a href=\"http://stackoverflow.com/questions/11305/how-to-parse-xml-using-vba\" title=\"how to parse xml using vba\">stackoverflow.com/questions/11305/how-to-parse-xml-using-vba</a> This may help"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4330383, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0ce202cbbb6abd0f6f2a1d9518d38f3?s=128&d=identicon&r=PG", "display_name": "Chris Newman", "link": "https://stackoverflow.com/users/4330383/chris-newman"}, "edited": false, "score": 0, "creation_date": 1436463879, "post_id": 31299347, "comment_id": 50635775, "body": "Thanks! That helped ALOT :)"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 1, "last_activity_date": 1436375728, "creation_date": 1436375728, "answer_id": 31299347, "question_id": 31296713, "link": "https://stackoverflow.com/questions/31296713/vba-function-to-read-xml-nodes/31299347#31299347", "title": "VBA Function To Read XML Nodes", "body": "<p>Here is an example of getting the <code>To</code> array. Good starting point for you to get the other arrays/nodes.</p>\n\n<pre><code>Function GetToArr()\n    Dim XDoc As Object\n    Dim xEmpDetails As Object\n    Dim xEmployee As Object\n    Dim xChild As Object\n\n    Set XDoc = CreateObject(\"MSXML2.DOMDocument\")\n    XDoc.async = False\n    XDoc.validateOnParse = False\n    XDoc.Load (\"C:\\[path]\\test.xml\")\n    Set items = XDoc.DocumentElement\n    Set Item = items.ChildNodes(0)\n    Set Item = Item.FirstChild\n    Set Item = Item.ChildNodes(1)\n    GetToArr = Split(Item.Text, \";\")\nEnd Function\n\nSub TestGetToArr()\n    For Each it In GetToArr()\n        Debug.Print it\n    Next it\nEnd Sub\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>John\nBob\nRob\nChris\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4330383, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0ce202cbbb6abd0f6f2a1d9518d38f3?s=128&d=identicon&r=PG", "display_name": "Chris Newman", "link": "https://stackoverflow.com/users/4330383/chris-newman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2744, "favorite_count": 0, "accepted_answer_id": 31299347, "answer_count": 1, "score": 1, "last_activity_date": 1436375728, "creation_date": 1436368231, "question_id": 31296713, "link": "https://stackoverflow.com/questions/31296713/vba-function-to-read-xml-nodes", "title": "VBA Function To Read XML Nodes", "body": "<p>I am very new to working with XML and was wondering if anyone could help get me started? </p>\n\n<p>I am trying to write a VBA function that could output an array with just the List Names [ie Array(\"Recon\", \"Safety\", \"Performance\")]. </p>\n\n<p>I also need to have the functionality to output an array with just a specific \"To\" node's text. For example, I may call the function to pull the names that are to be CC'ed in reference to the Recon list [ie Array(\"Jane\",\"Ashley\") or Array(\"Jane;Ashley;\") -- whichever output that would make the most sense works for me)</p>\n\n<p>Also, if there is a better way to structure this XML I would be open to changing, as I am writing this from scratch, my VBA userforms will eventually be creating and modifying this file in the end.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Settings&gt;\n&lt;DistributionLists&gt;\n    &lt;List&gt;\n        &lt;Name&gt;Recon&lt;/Name&gt;\n        &lt;TO&gt;John;Bob;Rob;Chris;&lt;/TO&gt;\n        &lt;CC&gt;Jane;Ashley;&lt;/CC&gt;\n        &lt;BCC&gt;Brent;&lt;/BCC&gt;\n    &lt;/List&gt;\n    &lt;List&gt;\n        &lt;Name&gt;Safety Metrics&lt;/Name&gt;\n        &lt;TO&gt;&lt;/TO&gt;\n        &lt;CC&gt;&lt;/CC&gt;\n        &lt;BCC&gt;&lt;/BCC&gt;\n    &lt;/List&gt;\n    &lt;List&gt;\n        &lt;Name&gt;Performance Report&lt;/Name&gt;\n        &lt;TO&gt;&lt;/TO&gt;\n        &lt;CC&gt;&lt;/CC&gt;\n        &lt;BCC&gt;&lt;/BCC&gt;\n    &lt;/List&gt;\n&lt;/DistributionLists&gt;\n\n&lt;Presets&gt;\n&lt;/Presets&gt;\n\n&lt;/Settings&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel", "data-connections"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1436368189, "post_id": 31296529, "comment_id": 50584026, "body": "Are you building the DB connections in your code?"}, {"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "edited": false, "score": 0, "creation_date": 1436368423, "post_id": 31296529, "comment_id": 50584201, "body": "your question and the content seem to be contradicting. Server change or Database change?"}, {"owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "edited": false, "score": 0, "creation_date": 1436368677, "post_id": 31296529, "comment_id": 50584408, "body": "Sorry I meant just the server name."}, {"owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "edited": false, "score": 0, "creation_date": 1436368721, "post_id": 31296529, "comment_id": 50584446, "body": "The connections are not built/defined in VBA."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1436669650, "post_id": 31296529, "comment_id": 50708324, "body": "Please do not use the <a href=\"http://stackoverflow.com/tags/macros/info\"><b>macros</b> tag</a> for MS Office / VBA."}], "answers": [{"comments": [{"owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "edited": false, "score": 0, "creation_date": 1436368832, "post_id": 31296723, "comment_id": 50584540, "body": "I&#39;ll give that go @krishna and let you know if it works for me. Thank you."}, {"owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "edited": false, "score": 0, "creation_date": 1436369074, "post_id": 31296723, "comment_id": 50584732, "body": "Seems to run with no errors but the connections havent updated."}, {"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "reply_to_user": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "edited": false, "score": 0, "creation_date": 1436369185, "post_id": 31296723, "comment_id": 50584839, "body": "can you put a breakpoint on q.connection =... and see if the replace happened there correctly"}, {"owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "edited": false, "score": 0, "creation_date": 1436369563, "post_id": 31296723, "comment_id": 50585117, "body": "It doesnt seem to hit that line of code. When I watch through step through it jumps from Fro Each q.... down to Next... and goes through this process until its gone through each worksheet."}, {"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "reply_to_user": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "edited": false, "score": 0, "creation_date": 1436370251, "post_id": 31296723, "comment_id": 50585618, "body": "please try my EDIT- it worked on both sheet level query tables and connections in the workbook"}, {"owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "edited": false, "score": 0, "creation_date": 1436427980, "post_id": 31296723, "comment_id": 50610697, "body": "that works a treat. Thank you so much for your help."}], "tags": [], "owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "is_accepted": true, "score": 3, "last_activity_date": 1436370204, "last_edit_date": 1436370204, "creation_date": 1436368249, "answer_id": 31296723, "question_id": 31296529, "link": "https://stackoverflow.com/questions/31296529/excel-vba-change-just-the-server-name-in-all-data-connections-in-a-workbook/31296723#31296723", "title": "Excel VBA change just the Server name in all data connections in a workbook", "body": "<p>assuming the database names havent changed, but just the server, will the below work for you. Not tested</p>\n\n<pre><code>Sub ChangeAllConnections()\n\n    Dim q As QueryTable, w As Worksheet, oldserverName As String, newServerName  As String\n    Dim con As Variant\n\n    oldserverName = \"onlsrvr\" 'Change here\n    newServerName = \"newsrvr\" ' change here\n\n    For Each w In ThisWorkbook.Worksheets\n      For Each q In w.QueryTables\n        q.Connection = Replace(q.Connection, oldserverName, newServerName)\n      Next\n    Next\n\n    On Error Resume Next\n     For Each con In ThisWorkbook.Connections\n        con.ODBCConnection.Connection = Replace(con.ODBCConnection.Connection, oldserverName, newServerName)\n        con.OLEDBConnection.Connection = Replace(con.OLEDBConnection.Connection, oldserverName, newServerName)\n      Next\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1436368317, "creation_date": 1436368317, "answer_id": 31296749, "question_id": 31296529, "link": "https://stackoverflow.com/questions/31296529/excel-vba-change-just-the-server-name-in-all-data-connections-in-a-workbook/31296749#31296749", "title": "Excel VBA change just the Server name in all data connections in a workbook", "body": "<p>I would consider placing things like this in an sameNameAsWorkbook.ini file. Keep the file in the same location as the Workbook.  Then have your code read the ini file and build the connection that way.  Then if it needs to change you can change it in one spot very easily.</p>\n"}], "owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1928, "favorite_count": 0, "accepted_answer_id": 31296723, "answer_count": 2, "score": 1, "last_activity_date": 1436669643, "creation_date": 1436367752, "last_edit_date": 1495542108, "question_id": 31296529, "link": "https://stackoverflow.com/questions/31296529/excel-vba-change-just-the-server-name-in-all-data-connections-in-a-workbook", "title": "Excel VBA change just the Server name in all data connections in a workbook", "body": "<p>Good Afternoon All,</p>\n\n<p>I have been looking at various ways to change/update the data connection strings in a workbook to update the Server name only and keep the other parts of the string as they are.</p>\n\n<p>Basically we have migrated servers and the server name has change and now we have a number of reports that need updating. Some have multiple connections as they connect to different databases.</p>\n\n<p>I found a useful article but this replaces the string with a completely new one for all the data connections (which doesnt work due to the different databases)\n<a href=\"https://stackoverflow.com/questions/2708086/excel-macro-to-change-external-data-query-connections-e-g-point-from-one-data\">excel-macro-to-change-external-data-query-connections-e-g-point-from-one-data</a></p>\n\n<p>Has anyone had to go through this process and found a way of easily updating the connection string?</p>\n\n<p>Kind Regards</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1436367490, "post_id": 31296045, "comment_id": 50583460, "body": "Sheets(&quot;Data&quot;).Range(&quot;A1&quot;).Select    ActiveSheet.Paste"}, {"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "reply_to_user": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1436367798, "post_id": 31296045, "comment_id": 50583714, "body": "@Fabrizio Did you mean Copy instead of Select?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1436368169, "post_id": 31296045, "comment_id": 50584011, "body": "See my edit - you need to specify which workbook you&#39;re copying from. <code>Sheets(&quot;Data&quot;).Select</code> is ambiguous because you have two workbooks with the sheet data open. Add <code>wbSource</code> and <code>wbTarget</code> as shown in my answer."}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "reply_to_user": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1436368268, "post_id": 31296045, "comment_id": 50584083, "body": "@Mark ?!?!??    wbTarget.Activate;     Sheets(&quot;Data&quot;).Range(&quot;A1&quot;).Select;    ActiveSheet.Paste; now the code run correctly, whatever the best solution is to user1274820"}, {"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "reply_to_user": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1436368675, "post_id": 31296045, "comment_id": 50584406, "body": "@Fabrizio Nevermind. I thought you were trying to replace the whole chunk with one line (no activates or selects) which is a much better option. Didn&#39;t realize you were just modifying the last two lines."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4351504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d1699ca95da9733c8d37900bb5137a8?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4351504/david"}, "edited": false, "score": 0, "creation_date": 1436367919, "post_id": 31296456, "comment_id": 50583805, "body": "Just tried this to no avail.  Basically acting the same way."}, {"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1436367951, "post_id": 31296456, "comment_id": 50583830, "body": "This should be equivalent to the simpler <code>wbTarget.Sheets(&quot;Data&quot;).Range(&quot;A1&quot;).Value = wbSource.Sheets(&quot;Data&quot;).Range(&quot;B7&quot;).Value</code>."}], "tags": [], "owner": {"reputation": 95, "user_id": 4989217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d08961fd579f4943eed96a7e00edbe?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/4989217/richard"}, "is_accepted": false, "score": 0, "last_activity_date": 1436368237, "last_edit_date": 1436368237, "creation_date": 1436367602, "answer_id": 31296456, "question_id": 31296045, "link": "https://stackoverflow.com/questions/31296045/excel-vba-data-from-one-workbook-to-another/31296456#31296456", "title": "Excel VBA - Data From One Workbook to Another", "body": "<p>Can't you store the value instead of copy paste  </p>\n\n<pre><code>Sub TransferData()\n       Dim wbTarget As Workbook\n       Dim wbSource As Workbook\n\n       Set wbTarget = Application.ActiveWorkbook\n       Set wbSource = Workbooks.Open(\"C:\\folder\\source.xls\")\n\n\n       wbSource.Activate\n       Sheets(\"Data\").Select\n       xValue = ActiveSheet.Range(\"B7\").Value\n\n       wbTarget.Activate\n       Sheets(\"Data\").Select\n       ActiveSheet.Range(\"A1\").Value = xValue\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 4351504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d1699ca95da9733c8d37900bb5137a8?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4351504/david"}, "edited": false, "score": 1, "creation_date": 1436368261, "post_id": 31296510, "comment_id": 50584076, "body": "Thank you, User1274820!  Perfect!"}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 2, "last_activity_date": 1436368050, "last_edit_date": 1436368050, "creation_date": 1436367719, "answer_id": 31296510, "question_id": 31296045, "link": "https://stackoverflow.com/questions/31296045/excel-vba-data-from-one-workbook-to-another/31296510#31296510", "title": "Excel VBA - Data From One Workbook to Another", "body": "<p>I think your problem is here:</p>\n\n<pre><code>ActiveSheet.Range(\"B7\").Copy\n</code></pre>\n\n<p>Excel doesn't know which workbook to copy from:</p>\n\n<pre><code>With wbSource\n    .Activate\n    .Sheets(\"Data\").Select\n    .ActiveSheet.Range(\"B7\").Copy\nEnd With\n\nWith wbTarget\n    .Activate\n    .Sheets(\"Data\").Select\n    .ActiveSheet.Range(\"A1\").Paste\nEnd With\n</code></pre>\n\n<p>Try this code without select statements.</p>\n\n<p>Also, you said the code is in your target workbook?</p>\n\n<p>If you're opening both workbooks, the code should be in a third, unrelated workbook.</p>\n\n<pre><code>Sub TransferData()\n\n   Dim wbTarget As Workbook\n   Dim wbSource As Workbook\n\n   Set wbSource = Workbooks.Open(\"C:\\folder\\source.xls\")\n   Set wbTarget = Workbooks.Open(\"C:\\folder\\target.xlsm\")\n\n   wbSource.Sheets(\"Data\").Range(\"B7\").Copy wbTarget.Sheets(\"Data\").Range(\"A1\")\n\n   wbTarget.Close(True)\n   wbSource.Close(True)\n\nEnd Sub\n</code></pre>\n\n<p>Here is code I use on a daily basis to copy a spreadsheet from one workbook to another:</p>\n\n<pre><code>Dim TWB As Workbook\nDim CopyWB As Workbook\nSet TWB = ThisWorkbook\nSet CopyWB = Workbooks.Open(FName, ReadOnly:=True)\nCopyWB.Sheets(TWB.Sheets(\"Menu\").ComboBox1.Text).Cells.Copy TWB.Sheets(\"DataSheet\").Cells\nCopyWB.Close (False)\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4351504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d1699ca95da9733c8d37900bb5137a8?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4351504/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 31296510, "answer_count": 2, "score": 0, "last_activity_date": 1436368237, "creation_date": 1436366605, "last_edit_date": 1531161705, "question_id": 31296045, "link": "https://stackoverflow.com/questions/31296045/excel-vba-data-from-one-workbook-to-another", "title": "Excel VBA - Data From One Workbook to Another", "body": "<p>I'm probably missing something simple here.  It just isn't copying the data from the source workbook to the target workbook and no errors are tripping.  The source workbook is opening just fine.  The target workbook contains this code. Both workbooks contain a sheet called 'Data'.  Any help would be greatly appreciated.</p>\n\n<pre><code>Sub TransferData()\n\n   Dim wbTarget As Workbook\n   Dim wbSource As Workbook\n\n   Set wbSource = Workbooks.Open(\"C:\\folder\\source.xls\")\n   Set wbTarget = Workbooks.Open(\"C:\\folder\\target.xlsm\")\n\n   wbSource.Activate\n   Sheets(\"Data\").Select\n   ActiveSheet.Range(\"B7\").Copy\n\n   wbTarget.Activate\n   Sheets(\"Data\").Select\n   ActiveSheet.Range(\"A1\").Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "multiple-matches"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4737597, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206754511970216/picture?type=large", "display_name": "Manpreet Juneja", "link": "https://stackoverflow.com/users/4737597/manpreet-juneja"}, "edited": false, "score": 0, "creation_date": 1436421855, "post_id": 31295671, "comment_id": 50607212, "body": "Review team checks and changes through the links only, and sumif wont cut it. Need specific links in the summary sheet."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 35, "user_id": 4737597, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206754511970216/picture?type=large", "display_name": "Manpreet Juneja", "link": "https://stackoverflow.com/users/4737597/manpreet-juneja"}, "edited": false, "score": 0, "creation_date": 1436431054, "post_id": 31295671, "comment_id": 50612681, "body": "I dont understand you sentence... I had the above solution working here"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1436365690, "creation_date": 1436365690, "answer_id": 31295671, "question_id": 31295389, "link": "https://stackoverflow.com/questions/31295389/match-and-concatenate-vba/31295671#31295671", "title": "Match and concatenate vba", "body": "<p>Push everything right one column and put in A1 \"=B1 &amp; C2\" . e.g. Customer and T/C</p>\n\n<p>Then in your columns you want sum's use a sumif</p>\n\n<pre><code>Name T1 T2\nSandy =SUMIF(A:A,S2&amp;$T$1,D:D) =SUMIF(A:A,S2&amp;$U$1,D:D)\nCandy =SUMIF(A:A,S3&amp;$T$1,D:D) =SUMIF(A:A,S3&amp;$U$1,D:D)\nDandy =SUMIF(A:A,S4&amp;$T$1,D:D) =SUMIF(A:A,S4&amp;$U$1,D:D)\n</code></pre>\n\n<p>Ranges have moved over one due to the new column \"A\"</p>\n"}], "owner": {"reputation": 35, "user_id": 4737597, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206754511970216/picture?type=large", "display_name": "Manpreet Juneja", "link": "https://stackoverflow.com/users/4737597/manpreet-juneja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1436422574, "creation_date": 1436365000, "last_edit_date": 1436422574, "question_id": 31295389, "link": "https://stackoverflow.com/questions/31295389/match-and-concatenate-vba", "title": "Match and concatenate vba", "body": "<p>I have data like this</p>\n\n<pre><code>      A      B   C   D\n1. Customer T/C NET VAT\n2.  Sandy    T1\n3.  Sandy    T5\n4.  Sandy    T1\n5.  Sandy    T5\n6.  Candy    T1\n7.  Candy    T5\n8.  Dandy    T5\n9.  Dandy    T1\n</code></pre>\n\n<p>Where <code>NET</code> and <code>VAT</code> contains <code>$Amount</code> &amp; <code>1,2</code> etc are row numbers &amp; T1/T5 are TaxCodes</p>\n\n<blockquote>\n  <p>Summary Columns</p>\n</blockquote>\n\n<pre><code>      R        S      T\n1. Customer  T5NET  T5VAT\n2.  Sandy \n3.  Candy \n4.  Dandy \n</code></pre>\n\n<p>I want to summarize <code>NET</code> + <code>VAT</code> with <code>cell.address</code> in Summary columns respectively in front of the Customer.</p>\n\n<blockquote>\n  <p>Example: Summary Columns </p>\n</blockquote>\n\n<pre><code>       R        S      T\n 1. Customer  T5NET  T5VAT\n 2.  Sandy   =C3+C5  =D3+D5\n 3.   etc\n</code></pre>\n\n<p>I'm assuming I'll need a <code>Match</code> function to Match <code>#1 Customer</code> (Summary to Database) and <code>#2 T5</code> then Concatenate the offset values against summarized name.</p>\n\n<p>Editied Now (This is close but how do I alter it for match function?)</p>\n\n<pre><code>`Sub MatchConcanate()\nDim outputText As String, Rw As Range, cell As Range\ndelim = \"+\"\nApplication.ScreenUpdating = False\nRange(\"A:A\").SpecialCells(xlCellTypeConstants).Select\nFor Each Rw In Selection.Columns\n'Here I want it to only Select Supplier till it is duplicate (they are sorted) and then to next\n    For Each cell In Rw.Cells\n    If cell.Value = \"T5\" Then\n        outputText = outputText &amp; delim &amp; cell.Address\n    End If\n    Next cell\n    With Rw\n'Here I'd like a match function instead of pasting it all in cell 1\n    .Cells(1).Offset(0, 5).Value = outputText\n    .HorizontalAlignment = xlGeneral\n    .VerticalAlignment = xlCenter\n    .WrapText = False\n    End With\n    outputText = \"\"\nNext Rw\nApplication.ScreenUpdating = True\nEnd Sub`\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 54, "user_id": 4502824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea39103277c9b4d30ab2dbfdef5ea9f?s=128&d=identicon&r=PG&f=1", "display_name": "L-f", "link": "https://stackoverflow.com/users/4502824/l-f"}, "edited": false, "score": 0, "creation_date": 1436365283, "post_id": 31295464, "comment_id": 50581588, "body": "I remember using both on different occasions, I just wanted to find out if there&#39;s something wrong with my thinking, or (by some magic) one of those methods is not as reliable as the other."}, {"owner": {"reputation": 105, "user_id": 5044752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b50af6031cb0cb6a348fd59842824b?s=128&d=identicon&r=PG&f=1", "display_name": "LateRefrigerator", "link": "https://stackoverflow.com/users/5044752/laterefrigerator"}, "reply_to_user": {"reputation": 54, "user_id": 4502824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea39103277c9b4d30ab2dbfdef5ea9f?s=128&d=identicon&r=PG&f=1", "display_name": "L-f", "link": "https://stackoverflow.com/users/4502824/l-f"}, "edited": false, "score": 0, "creation_date": 1436365463, "post_id": 31295464, "comment_id": 50581743, "body": "I guess they are both as reliable. I mean, I can&#39;t see how one of them could fail..."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436365810, "post_id": 31295464, "comment_id": 50582049, "body": "The both are accepted syntax. If IsEmpty(Cells(i, j)) Then Is probably a neater way to do things."}], "tags": [], "owner": {"reputation": 105, "user_id": 5044752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b50af6031cb0cb6a348fd59842824b?s=128&d=identicon&r=PG&f=1", "display_name": "LateRefrigerator", "link": "https://stackoverflow.com/users/5044752/laterefrigerator"}, "is_accepted": false, "score": 1, "last_activity_date": 1436365178, "creation_date": 1436365178, "answer_id": 31295464, "question_id": 31295380, "link": "https://stackoverflow.com/questions/31295380/vba-does-isempty-require-comparision-to-boolean-value/31295464#31295464", "title": "VBA: Does IsEmpty require comparision to boolean value?", "body": "<p>Normally both should work.\nHave you tried them?</p>\n"}, {"comments": [{"owner": {"reputation": 54, "user_id": 4502824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea39103277c9b4d30ab2dbfdef5ea9f?s=128&d=identicon&r=PG&f=1", "display_name": "L-f", "link": "https://stackoverflow.com/users/4502824/l-f"}, "edited": false, "score": 0, "creation_date": 1436367143, "post_id": 31296075, "comment_id": 50583187, "body": "Well, I guess that answers it. I was mostly uncertain about the <code>If Not IsEmpty</code> part."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 54, "user_id": 4502824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea39103277c9b4d30ab2dbfdef5ea9f?s=128&d=identicon&r=PG&f=1", "display_name": "L-f", "link": "https://stackoverflow.com/users/4502824/l-f"}, "edited": false, "score": 0, "creation_date": 1436367322, "post_id": 31296075, "comment_id": 50583334, "body": "I find <code>If Not IsEmpty</code> much easier to think about than <code>If IsEmpty() = False</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436372236, "post_id": 31296075, "comment_id": 50586916, "body": "The first is preferred as it is cleaner code (and demonstrates that you know what IsEmpty actually returns!). Just remember that if used mathematically any VBA boolean is 0 for False and -1 for True while a worksheet is 0 for FALSE and 1 for TRUE."}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": true, "score": 2, "last_activity_date": 1436366690, "creation_date": 1436366690, "answer_id": 31296075, "question_id": 31295380, "link": "https://stackoverflow.com/questions/31295380/vba-does-isempty-require-comparision-to-boolean-value/31296075#31296075", "title": "VBA: Does IsEmpty require comparision to boolean value?", "body": "<p>The <code>IsEmpty</code> function returns a boolean value, so your first examples are fine. Plus, I find them easier/simpler to read.</p>\n"}], "owner": {"reputation": 54, "user_id": 4502824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea39103277c9b4d30ab2dbfdef5ea9f?s=128&d=identicon&r=PG&f=1", "display_name": "L-f", "link": "https://stackoverflow.com/users/4502824/l-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 31296075, "answer_count": 2, "score": 0, "last_activity_date": 1436366690, "creation_date": 1436364961, "last_edit_date": 1436365194, "question_id": 31295380, "link": "https://stackoverflow.com/questions/31295380/vba-does-isempty-require-comparision-to-boolean-value", "title": "VBA: Does IsEmpty require comparision to boolean value?", "body": "<p>I'm confus. Which two forms are correct?</p>\n\n<pre><code>If IsEmpty(Cells(i, j)) Then\nMsgBox (\"This cell is empty!\")\nEnd If\n\nIf Not IsEmpty(Cells(i, j)) Then\nMsgBox (\"This cell contains something!\")\nEnd If\n</code></pre>\n\n<p>...or:</p>\n\n<pre><code>If IsEmpty(Cells(i, j)) = True Then\nMsgBox (\"This cell is empty!\")\nEnd If\n\nIf IsEmpty(Cells(i, j)) = False Then\nMsgBox (\"This cell contains something!\")\nEnd If\n</code></pre>\n\n<p>Basically, do I need to compare the IsEmpty function to a boolean value?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 906, "user_id": 2485248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/IzdaY.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/2485248/roland"}, "edited": false, "score": 0, "creation_date": 1436371720, "post_id": 31295329, "comment_id": 50586607, "body": "Do you want to sort the groups by size?"}, {"owner": {"reputation": 26, "user_id": 2616515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d825be4de2bb6bf6f3085462a3ab2f9?s=128&d=identicon&r=PG", "display_name": "chdelamo", "link": "https://stackoverflow.com/users/2616515/chdelamo"}, "reply_to_user": {"reputation": 906, "user_id": 2485248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/IzdaY.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/2485248/roland"}, "edited": false, "score": 0, "creation_date": 1436378452, "post_id": 31295329, "comment_id": 50590770, "body": "Preferably seperate files, but a sort will work in the mean time. I just cant get the grouping on the page count or even produce the right number. I only get the entire ID field count."}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 2616515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d825be4de2bb6bf6f3085462a3ab2f9?s=128&d=identicon&r=PG", "display_name": "chdelamo", "link": "https://stackoverflow.com/users/2616515/chdelamo"}, "edited": false, "score": 0, "creation_date": 1436457095, "post_id": 31311246, "comment_id": 50631576, "body": "Hi Rolan, thank you for your reply. I was able to get the grouping done through a different method. I did notice that paging was done dynamically so grouping through it was more trouble then it was worth."}], "tags": [], "owner": {"reputation": 906, "user_id": 2485248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/IzdaY.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/2485248/roland"}, "is_accepted": false, "score": 0, "last_activity_date": 1436428210, "creation_date": 1436428210, "answer_id": 31311246, "question_id": 31295329, "link": "https://stackoverflow.com/questions/31295329/group-on-page-count/31311246#31311246", "title": "Group on page count", "body": "<p>AFAIK you can not access the number of pages since the grouping is done before the render of the page.</p>\n\n<p>But, assuming you have a table T with a column ID being of a set of values v, which you group by, why not do a count of how many rows there are per value v and join that to you report source (or just use the HAVING clause)? You can maybe derive the number of pages by the number of members of each ID. </p>\n\n<p>Like</p>\n\n<pre><code>ID value count\n\n1    a     2\n2    a     2\n3    b     1\n...\n</code></pre>\n"}], "owner": {"reputation": 26, "user_id": 2616515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d825be4de2bb6bf6f3085462a3ab2f9?s=128&d=identicon&r=PG", "display_name": "chdelamo", "link": "https://stackoverflow.com/users/2616515/chdelamo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436428210, "creation_date": 1436364856, "last_edit_date": 1436370205, "question_id": 31295329, "link": "https://stackoverflow.com/questions/31295329/group-on-page-count", "title": "Group on page count", "body": "<p>I have a report which is grouped on an <code>ID</code> field. Each grouping is roughly 1-3 pages depending on how much data Is pulled from the source. </p>\n\n<p>Is there a way to group the report based on the page count of each section?</p>\n\n<p><strong>Example:</strong></p>\n\n<ul>\n<li>All Groups that are 3 pages</li>\n\n<li>All Groups that are 2 pages</li>\n\n<li>All Groups that are 1 page</li>\n</ul>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436364430, "post_id": 31295091, "comment_id": 50580878, "body": "I know I can use ActiveCell.Offset(1, 0) to go down the column each time but I don&#39;t know how to extract the data"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436368339, "post_id": 31295330, "comment_id": 50584150, "body": "please look at my code. I figured out a way to store the values in an array but it gives me an error. thanks"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436368452, "post_id": 31295330, "comment_id": 50584220, "body": "@Dean What error is it giving your.  It is always helpful to provide the error you are getting from code."}, {"owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436368583, "post_id": 31295330, "comment_id": 50584325, "body": "Constant expression required, it highlights  the word Max"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436369434, "post_id": 31295330, "comment_id": 50585029, "body": "See additions to my original answer"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436369406, "last_edit_date": 1436369406, "creation_date": 1436364857, "answer_id": 31295330, "question_id": 31295091, "link": "https://stackoverflow.com/questions/31295091/going-through-workbook-and-making-a-column-in-the-first-sheet-out-of-the-content/31295330#31295330", "title": "Going through workbook and making a column in the first sheet out of the content of a particular cell across all sheets", "body": "<pre><code>SomeVariable = Sheet.Range(\"B22\").Value\n</code></pre>\n\n<p>If you need a way to iterate the sheets you can do this.</p>\n\n<pre><code>iFoundWorksheet = 0\nFor iIndex = 1 To ea.ActiveWorkbook.Worksheets.Count\n    Set ws = ea.Worksheets(iIndex)\n    If UCase(ws.Name) = \"RESULTS\" Then\n        iFoundWorksheet = iIndex\n        Exit For\n    End If\nNext iIndex\nIf iFoundWorksheet = 0 Then\n    MsgBox \"No worksheet was found with the name RESULTS (this is not case sensetive). Aborting.\"\n    GoTo Abort\nEnd If\nSet ws = ea.Worksheets(iFoundWorksheet)\nws.Activate\n</code></pre>\n\n<hr>\n\n<p>For you new issue Constant expression required\nYour array definition has to be defined with constants.</p>\n\n<pre><code>Dim Max As Long\nConst Max1 = 5\nDim Dates(2 To Max1) As String\n</code></pre>\n\n<p>This would work. But you are not going to be able to load   </p>\n\n<pre><code>ActiveWorkbook.Worksheets.Count\n</code></pre>\n\n<p>Into a const</p>\n\n<p>You are probably going to need to ReDim your Dates Array.</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436365459, "post_id": 31295467, "comment_id": 50581740, "body": "Yes thank you that was a typo, so What I am trying to do is let say go through the entire workbook and from each sheet copy let say Call A1 and then paste those values in a column that start at H9."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436365666, "post_id": 31295467, "comment_id": 50581923, "body": "You want all the values in H9, or you want them to start in H9 and then go down or left?"}, {"owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436366680, "post_id": 31295467, "comment_id": 50582803, "body": "I see your point i will need that too. but my big issue is going through the entire workbook and let say for sheet2 A1=1   for      sheet3  A1=2 for        sheet4 A1=3     then sheet1 will display a column of 1,2,3"}, {"owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "edited": false, "score": 0, "creation_date": 1436368204, "post_id": 31295467, "comment_id": 50584036, "body": "please look at my code. I figured out a way to store the values in an array but it gives me an error. thanks"}], "tags": [], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "is_accepted": false, "score": 0, "last_activity_date": 1436365804, "last_edit_date": 1436365804, "creation_date": 1436365191, "answer_id": 31295467, "question_id": 31295091, "link": "https://stackoverflow.com/questions/31295091/going-through-workbook-and-making-a-column-in-the-first-sheet-out-of-the-content/31295467#31295467", "title": "Going through workbook and making a column in the first sheet out of the content of a particular cell across all sheets", "body": "<pre><code>Dim SummarySheet as Sheet\n\nFor r = 2 To ActiveWorkbook.Worksheets.Count\n  Set Sheet = ActiveWorkbook.Worksheets(r)\nIf Sheet.Name = \"Page\"&amp; r Then\n     SummarySheet.Cells(Row you want to paste,Column you want to paste) = Sheet.Range(\"Cell you want to copy\").Value\nEnd if\nNext r\n</code></pre>\n\n<p>I was in doubt if your t and r were different, but if so then you should make a For loop for both, or make r a calculated value from t</p>\n\n<p>Edit: If you want to paste in H9 and go from there, you column will be 8 and your row 9. If you then put 9+r it will always take the next row below. Assuming r starts at 1 and has all number in a row. You can play a bit with these values until you get it right.</p>\n"}], "owner": {"reputation": 63, "user_id": 5090461, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7440489dbb8a2bf4c4494938c2a2e2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/5090461/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1483046627, "creation_date": 1436364271, "last_edit_date": 1531164843, "question_id": 31295091, "link": "https://stackoverflow.com/questions/31295091/going-through-workbook-and-making-a-column-in-the-first-sheet-out-of-the-content", "title": "Going through workbook and making a column in the first sheet out of the content of a particular cell across all sheets", "body": "<p>This gives me an error:</p>\n\n<blockquote>\n  <p>(Constant expression required)</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre><code>Dim Sheet3 As Worksheet\nDim t As Long\nDim Max As Long\nMax = ActiveWorkbook.Worksheets.Count\nDim Dates(2 To Max) As String\n\nFor t = 2 To ActiveWorkbook.Worksheets.Count\n  Set Sheet3 = ActiveWorkbook.Worksheets(t)\n  If Sheet3.Name = \"USA\" &amp; t Then\n    Dates(t) = Sheet3.Range(\"E4\").Value\n  End If\nNext t\n</code></pre>\n"}, {"tags": ["excel", "vba", "drop-down-menu"], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436367026, "creation_date": 1436367026, "answer_id": 31296217, "question_id": 31295086, "link": "https://stackoverflow.com/questions/31295086/cant-change-dropdown-text-while-processing-another-dropdown/31296217#31296217", "title": "Cant Change DropDown text while processing another DropDown", "body": "<p>You will have to add the value select to you combo boxes.</p>\n\n<pre><code>Dim bExit as Boolean\n\nPrivate Sub ComboBox1_Change()\n    If bExit = True Then\n        bExit = False\n        Exit Sub\n    End If\n    bExit = True\n    ComboBox2.Text = \"Select\"\n\nEnd Sub\n\nPrivate Sub ComboBox2_Change()\n    If bExit = True Then\n        bExit = False\n        Exit Sub\n    End If\n    bExit = True\n    ComboBox1.Text = \"Select\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4965884, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh6.googleusercontent.com/-Haa1oGGa8rI/AAAAAAAAAAI/AAAAAAAAAFg/cUBKWuUgsCg/photo.jpg?sz=128", "display_name": "Tan12", "link": "https://stackoverflow.com/users/4965884/tan12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436367026, "creation_date": 1436364267, "question_id": 31295086, "link": "https://stackoverflow.com/questions/31295086/cant-change-dropdown-text-while-processing-another-dropdown", "title": "Cant Change DropDown text while processing another DropDown", "body": "<p>I have 2 DropDowns on an excel sheet which work independently of each other. The selections on both drop down's can cause confusion during reporting generation. So I need to set DropDown#1 to \"select\"  if DropDown2 is being used by the user and vice versa. \nI am trying to use the DropDown.Text property but it does not do the trick.</p>\n\n<pre><code>Sub PDropDown_Click()\n\nDim DropDownP As DropDown\nDim DropDownD As DropDown\nSet DropDownD = Me.DropDowns(\"DDropDown\")\nSet DropDownP = Me.DropDowns(\"PDropDown\")\nDropDownD.Text =\"Select\"\nDropDownP.Text = DropDownP.List(DropDownP.ListIndex)\nCall Report_Generator.Create_Graph(DropDownP.List(DropDownP.ListIndex))\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1436365985, "post_id": 31295555, "comment_id": 50582192, "body": "Yes, this is more concise than what I have below."}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1436366123, "post_id": 31295555, "comment_id": 50582319, "body": "Thank you so much for the fast answer. I especially appreciate the warning against &#39;Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress&#39;"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1436365408, "creation_date": 1436365408, "answer_id": 31295555, "question_id": 31294982, "link": "https://stackoverflow.com/questions/31294982/unable-to-get-the-findnext-property-of-the-range-class-using-delete-loop/31295555#31295555", "title": "Unable to get the FindNext Property of the Range Class using Delete Loop", "body": "<p>You can't very well use <code>c</code> as a range argument to <code>findnext</code> when you just deleted it. Try simply:</p>\n\n<pre><code>Sub DeleteHeaderError()\n    With Worksheets(1).Range(\"a2:a10000\")\n    Set c = .Find(\"Create Time\", LookIn:=xlValues)\n    If Not c Is Nothing Then\n        Do\n            Rows(c.Row).DELETE Shift:=xlUp\n            Set c = .Find(\"Create Time\", LookIn:=xlValues)\n        Loop While Not c Is Nothing\n    End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>By the way, you should never use this:</p>\n\n<pre><code>Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n</code></pre>\n\n<p>If <code>c</code> is <code>Nothing</code> then attempting to access <code>c.Address</code> will cause an error. (I know it's in all the help file examples, but it's still wrong!)</p>\n"}], "owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1003, "favorite_count": 0, "accepted_answer_id": 31295555, "answer_count": 1, "score": 0, "last_activity_date": 1436365910, "creation_date": 1436363956, "last_edit_date": 1436365818, "question_id": 31294982, "link": "https://stackoverflow.com/questions/31294982/unable-to-get-the-findnext-property-of-the-range-class-using-delete-loop", "title": "Unable to get the FindNext Property of the Range Class using Delete Loop", "body": "<p>I am trying to make a simple macro to search and delete an entire row. Unfortunately I am getting an error on <code>Set c= .FindNext(c)</code></p>\n\n<pre><code>Sub DeleteHeaderError()\n    With Worksheets(1).Range(\"a2:a10000\")\n    Set c = .Find(\"Create Time\", LookIn:=xlValues)\n    If Not c Is Nothing Then\n        firstAddress = c.Address\n        Do\n            c.Select\n            Rows(c.Row).DELETE Shift:=xlUp\n            Set c = .FindNext(c)\n        Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n    End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1436431229, "post_id": 31295251, "comment_id": 50612778, "body": "There is still a small problem : when I use this technique, I get two double quotes at the first line of the updatedtext file, how can I remove them ? @Jason Faulkner"}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1436432483, "post_id": 31295251, "comment_id": 50613521, "body": "There is still a small problem : when I use this technique, the text is between two double quotes in the updatedtext file, how can I remove them ? @Jason Faulkner"}, {"owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "reply_to_user": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1436451641, "post_id": 31295251, "comment_id": 50627539, "body": "@otus - Try <code>Print #1</code> instead of <code>Write #1</code>."}], "tags": [], "owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "is_accepted": true, "score": 0, "last_activity_date": 1436364663, "creation_date": 1436364663, "answer_id": 31295251, "question_id": 31294901, "link": "https://stackoverflow.com/questions/31294901/move-cursor-to-write-in-specific-line-of-a-text-file-with-vba/31295251#31295251", "title": "Move cursor to write in specific line of a text file with VBA", "body": "<p>You would need to keep track of the positions yourself and apply the logic accordingly.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Dim text As String, allText As String\nDim lineNumber As Integer\n\n' Open read handle.\nOpen \"C:\\sometext.txt\" For Input As #1\n\nallText = \"\"\nlineNumber = 0\nDo Until EOF(1)\n    lineNumber = lineNumber + 1\n    Line Input #1, text\n\n    ' Assume you want to replace line 5.\n    If lineNumber = 5 Then\n        text = \"My new value\"\n    End if\n\n    allText = allText &amp; vbCrLf &amp; text\nLoop\n\n' Close read handle.\nClose #1\n\n\n' Output the new text to a separate file.\nOpen \"C:\\updatedtext.txt\" For Append As #1\nWrite #1, allText\nClose #1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 2, "last_activity_date": 1445225257, "creation_date": 1445225257, "answer_id": 33206192, "question_id": 31294901, "link": "https://stackoverflow.com/questions/31294901/move-cursor-to-write-in-specific-line-of-a-text-file-with-vba/33206192#33206192", "title": "Move cursor to write in specific line of a text file with VBA", "body": "<p>How about this:</p>\n\n<pre><code>Dim TextString As Variant\n  'read text from file\nTextString = Split(CreateObject(\"Scripting.FileSystemObject\").OpenTextFile(\"C:\\sometext.txt\").ReadAll, Chr(13) &amp; Chr(10))\n\n  'change your text here as TextString(#Line - 1) = \"Text\"\n  'still assume you want to replace line 5\nTextString(4) = \"New Text\"\n\n  'write back in file\nCreateObject(\"Scripting.FileSystemObject\").CreateTextFile(\"C:\\sometext.txt\").Write (Join(TextString, Chr(13) &amp; Chr(10)))\n</code></pre>\n\n<p>I think it's pretty simple cuz there is only one line to read and another one to write. No loops or closing files or anything like that.</p>\n"}], "owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3666, "favorite_count": 0, "accepted_answer_id": 31295251, "answer_count": 2, "score": 1, "last_activity_date": 1445225257, "creation_date": 1436363793, "question_id": 31294901, "link": "https://stackoverflow.com/questions/31294901/move-cursor-to-write-in-specific-line-of-a-text-file-with-vba", "title": "Move cursor to write in specific line of a text file with VBA", "body": "<p>I would like to know how I can use VBA to replace a specific line of a text file by another text, and to write in specific zone of the text file by moving the cursor.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1436365229, "post_id": 31295112, "comment_id": 50581545, "body": "Thank you for the quick response. I&#39;ve corrected the way I was defining my range. I&#39;ve added the <code>debug.print rng.value</code> but no pop up box appears. I assume something must still be wrong with my search method."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1436367222, "post_id": 31295112, "comment_id": 50583252, "body": "I used this function and when I typed 26 into cell AJ4, it did find that cell. However, there were some issues with your formula method that I have resolved - see edits to my answer above."}, {"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1436370134, "post_id": 31295112, "comment_id": 50585532, "body": "Worked for me as well. Thanks again."}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": true, "score": 0, "last_activity_date": 1436367547, "last_edit_date": 1436367547, "creation_date": 1436364315, "answer_id": 31295112, "question_id": 31294812, "link": "https://stackoverflow.com/questions/31294812/compare-value-in-array-to-value-in-range-if-equal-insert-a-formula/31295112#31295112", "title": "Compare value in array to value in range, if equal, insert a formula", "body": "<p>Your code first sets rng to be equal to be a specifically identified range (AJ3:AJ14458). Your code then asks the loop to run for each 'rng' within ThisWorkbook.Worksheets(\"Model2\").Range(\"AJ3:AJ14458\"). There is only 1 'rng' within ThisWorkbook.Worksheets(\"Model2\").Range(\"AJ3:AJ14458\"), because you have defined rng to mean the whole worksheet in its entirety.</p>\n\n<p>In fact, you should not need to set 'rng' to be equal to anything. Instead simply define it as a range; ie:</p>\n\n<blockquote>\n  <p>dim rng as Range</p>\n</blockquote>\n\n<p>Then, when you perform your loop, ThisWorkbook.Worksheets(\"Model2\").Range(\"AJ3:AJ14458\") will go through every 'Range' within that area (ie: it will go through every single cell).</p>\n\n<p>In the future, when checking your code for similar errors, consider more than just whether an actual error message appears; have the code give you a message when you expect your desired result to be found - and then you can check what the result is actually calculated as. For example, below your \"if rng.value = ...', on the next line put:</p>\n\n<blockquote>\n  <p>debug.print rng.value</p>\n</blockquote>\n\n<p>This will pop up a message if it finds your value. In this case, while your code doesn't have an error, it didn't find your value either. So, you know that your problem is not in your '.Cells(r, \"O\").FormulaR1C1 =...' line, it is in your search method.</p>\n\n<p><strong>Edit</strong> It also seems there are two issues with how you are telling the found cells to insert the formula. Should be as follows:</p>\n\n<pre><code>If rng.Value = arr1(11) Then\n\n            For r = 3 To lastrow\n                Sheets(\"Model2\")).Range(\"O\" &amp; r).FormulaR1C1 = \"=IF(R[0]C[-6]&lt;10,10,IF(R[0]C[-1]&gt;45,45,R[0]C[-1]))\"\n            Next r\nEnd If\n</code></pre>\n\n<p>Note that I have added a closing bracket to the formula itself, and I have referred to .Range(\"O\" &amp; r) [which simplifies to O4,O5, etc. during the loop], whereas you referred to .Cells(\"O\", r) - where O is a letter not a number, so the cells function could not find the cell you were referring to.</p>\n\n<p>This worked for me so if it isn't working first check to ensure you actually have 26 entered (in number format, not text format) somewhere on column AJ.</p>\n"}, {"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1436367634, "post_id": 31295154, "comment_id": 50583575, "body": "Also I agree with @MatthewD that it is generally unwise to simply refer to an arbitrary block of data to search for; it will either slow down your code by searching unnecessarily, or it may become too small depending on how much data changes in the future."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436364422, "creation_date": 1436364422, "answer_id": 31295154, "question_id": 31294812, "link": "https://stackoverflow.com/questions/31294812/compare-value-in-array-to-value-in-range-if-equal-insert-a-formula/31295154#31295154", "title": "Compare value in array to value in range, if equal, insert a formula", "body": "<p>It might be in your .FormulaR1C1 format.  I've never used that before. Are you sure that is what you want to be using.  I've used the simple .Formula before with ease.</p>\n\n<p>Also a tip.  I used to have to hard code my ranges until i found usedRange.</p>\n\n<p>So this</p>\n\n<pre><code>For Each rng In ThisWorkbook.Worksheets(\"Model2\").Range(\"AJ3:AJ14458\")\n</code></pre>\n\n<p>Can simply be replaced with </p>\n\n<pre><code>Do While lRow &lt;= ws.UsedRange.Rows.Count\n</code></pre>\n\n<p>Here is the entire loop.</p>\n\n<pre><code>lRow = 1\nDo While lRow &lt;= ws.UsedRange.Rows.Count\n\n    'Do stuff here\n\nlRow = lRow + 1\nLoop\n</code></pre>\n\n<p>Hope that makes your coding easier in the future.</p>\n"}], "owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 31295112, "answer_count": 2, "score": 0, "last_activity_date": 1436367547, "creation_date": 1436363585, "question_id": 31294812, "link": "https://stackoverflow.com/questions/31294812/compare-value-in-array-to-value-in-range-if-equal-insert-a-formula", "title": "Compare value in array to value in range, if equal, insert a formula", "body": "<p>I am trying to compare values in a range to values in an array. If the values are equal, I want to insert a formula in column \"O\" in the corresponding row of the cell in the range that is equal to the value in the array. There is a corresponding formula for each value in the array, but for brevity I have only included the first formula in the below code. When I run the code, I receive no error message, but column \"O\" is not populated with any data. Any suggestions as to where my code is going wrong? I am pretty new to arrays. </p>\n\n<pre><code>Sub ScenarioData2()\n    Dim arr1 As Variant, result As String, r As Long, rng As Range\n    arr1 = Array(11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 31, 32, 33, 34, 35, 36)\n\n    Set rng = ThisWorkbook.Worksheets(\"Model2\").Range(\"AJ3:AJ14458\")\n\n    Dim lastrow As Long\n    lastrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    For Each rng In ThisWorkbook.Worksheets(\"Model2\").Range(\"AJ3:AJ14458\")\n        If rng.Value = arr1(11) Then\n            With Sheets(\"Model2\")\n                For r = 3 To lastrow\n                .Cells(r, \"O\").FormulaR1C1 = \"=IF(R[]C[-6]&lt;10,10,IF(R[]C[-1]&gt;45,45,R[]C[-1])\"\n                Next r\n            End With\n        'Else\n        End If\n    Next rng\n\n    End Sub\n</code></pre>\n\n<p>Thank you very much for any help.</p>\n\n<p>Best regards,</p>\n"}, {"tags": ["excel", "vba", "ms-access", "ms-access-2010", "database-administration"], "answers": [{"tags": [], "owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1436372842, "last_edit_date": 1436372842, "creation_date": 1436364009, "answer_id": 31294997, "question_id": 31294458, "link": "https://stackoverflow.com/questions/31294458/i-have-some-vba-that-opens-a-spreadsheet-and-imports-data-from-access-how-do-i/31294997#31294997", "title": "I have some VBA that opens a spreadsheet and imports data from Access, how do I lock the original and automatically &quot;Save As&quot;?", "body": "<p>Try this:</p>\n\n<pre><code>Set wbook = appExcel.Workbooks.Open(Filename:=\"F:\\Network Folder\\MySpreadsheet.xlsx\", ReadOnly:=True)\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 3654439, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/7TJw3.jpg?s=128&g=1", "display_name": "msiudut", "link": "https://stackoverflow.com/users/3654439/msiudut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 31294997, "answer_count": 1, "score": 0, "last_activity_date": 1594644164, "creation_date": 1436362711, "last_edit_date": 1594644164, "question_id": 31294458, "link": "https://stackoverflow.com/questions/31294458/i-have-some-vba-that-opens-a-spreadsheet-and-imports-data-from-access-how-do-i", "title": "I have some VBA that opens a spreadsheet and imports data from Access, how do I lock the original and automatically &quot;Save As&quot;?", "body": "<p>The code below is attached to a command button and opens an Excel Workbook then imports a dozen (mostly redacted in code below) fields from an Access Form. The trouble I have is that users:</p>\n\n<p>(1) Use the button once. </p>\n\n<p>(2) Hit \"Save\" instead of \"Save As\".</p>\n\n<p>(3) Use the button a second time. </p>\n\n<p>(3) Complain that the workbook has old data on it. </p>\n\n<p>Within the code below, how can I:</p>\n\n<p>(A) Prevent users from editing the master copy of the workbook.</p>\n\n<p>(B) Automatically present the \"Save As\" dialogue box upon opening.</p>\n\n<pre><code>Private Sub cmd1_Click()\nDim appExcel As Excel.Application\nDim wbook As Excel.Workbook\nDim wsheet As Excel.Worksheet\n\nSet appExcel = New Excel.Application\nappExcel.Visible = True\nSet wbook = appExcel.Workbooks.Open(\"F:\\Network Folder\\MySpreadsheet.xlsx\")\nSet wsheet = wbook.Worksheets(\"Sheet1\")\n\nWith wsheet\n.Cells(10, 1).Value = txt1\n.Cells(10, 2).Value = txt2   \nEnd With\nEnd Sub\n</code></pre>\n\n<p>I've tried the solutions offered <a href=\"http://www.mrexcel.com/forum/excel-questions/80796-how-set-readonly-visual-basic-applications.html\" rel=\"nofollow\">here</a> but no luck so far. </p>\n"}, {"tags": ["vba", "excel", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436363449, "creation_date": 1436363449, "answer_id": 31294755, "question_id": 31294335, "link": "https://stackoverflow.com/questions/31294335/add-values-in-combo-box-from-access-using-vba-ado-connection/31294755#31294755", "title": "Add values in combo box from access using VBA ADO connection", "body": "<p>Should work.  You will need to add a reference for the adodb.</p>\n\n<p>In your vba ide you will have to go to dropdown menu tools -> reference and select \"Microsoft ActiveX Data Ovjects 2.8 Library\"</p>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 4533426, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/915128241833410/picture?type=large", "display_name": "AggieIE", "link": "https://stackoverflow.com/users/4533426/aggieie"}, "is_accepted": false, "score": 0, "last_activity_date": 1436363685, "creation_date": 1436363685, "answer_id": 31294851, "question_id": 31294335, "link": "https://stackoverflow.com/questions/31294335/add-values-in-combo-box-from-access-using-vba-ado-connection/31294851#31294851", "title": "Add values in combo box from access using VBA ADO connection", "body": "<p>Check what type of file your Access DB is being saved as. Most have switched over to .accdb filetypes, so if it is, you should be using </p>\n\n<pre><code>\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='\" \n</code></pre>\n\n<p>Also, make sure you have the Microsoft Access 14.0 Object Library referenced</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1436363735, "creation_date": 1436363735, "answer_id": 31294873, "question_id": 31294335, "link": "https://stackoverflow.com/questions/31294335/add-values-in-combo-box-from-access-using-vba-ado-connection/31294873#31294873", "title": "Add values in combo box from access using VBA ADO connection", "body": "<p>You need the <code>ACE.OLEDB.12.0</code> provider, and using <code>AddItem</code> is quite slow. I suggest:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    On Error GoTo UserForm_Initialize_Err\n    Dim cnn As New ADODB.Connection\n    Dim rst As New ADODB.Recordset\n    cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n             \"Data Source=C:\\Databases\\StaffDatabase.mdb\"\n    rst.Open \"SELECT DISTINCT [Department] FROM tblStaff ORDER BY [Department];\", _\n             cnn, adOpenStatic\n    Me.ComboBox1.Column = rst.GetRows\n\nUserForm_Initialize_Exit:\n    On Error Resume Next\n    rst.Close\n    cnn.Close\n    Set rst = Nothing\n    Set cnn = Nothing\n    Exit Sub\nUserForm_Initialize_Err:\n    MsgBox Err.Number &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error!\"\n    Resume UserForm_Initialize_Exit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5094135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74d6be67cfaa1f18f3fe9aaa97d0bd12?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5094135/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 971, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1436363735, "creation_date": 1436362452, "last_edit_date": 1531164843, "question_id": 31294335, "link": "https://stackoverflow.com/questions/31294335/add-values-in-combo-box-from-access-using-vba-ado-connection", "title": "Add values in combo box from access using VBA ADO connection", "body": "<p>I want to add values in combo box from access using VBA ADO connection. I got the coding from google but it is for account 2003 and below. I have the access 2013 install. Please advise me as to what need to be changed in below coding</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    On Error GoTo UserForm_Initialize_Err\n    Dim cnn As New ADODB.Connection\n    Dim rst As New ADODB.Recordset\n    cnn.Open \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n             \"Data Source=C:\\Databases\\StaffDatabase.mdb\"\n    rst.Open \"SELECT DISTINCT [Department] FROM tblStaff ORDER BY [Department];\", _\n             cnn, adOpenStatic\n    rst.MoveFirst\n    With Me.ComboBox1\n        .Clear\n        Do\n            .AddItem rst![Department]\n            rst.MoveNext\n        Loop Until rst.EOF\n    End With\nUserForm_Initialize_Exit:\n    On Error Resume Next\n    rst.Close\n    cnn.Close\n    Set rst = Nothing\n    Set cnn = Nothing\n    Exit Sub\nUserForm_Initialize_Err:\n    MsgBox Err.Number &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error!\"\n    Resume UserForm_Initialize_Exit\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "internet-explorer", "scrape", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "is_accepted": true, "score": 0, "last_activity_date": 1502721861, "last_edit_date": 1502721861, "creation_date": 1436427811, "answer_id": 31311123, "question_id": 31294225, "link": "https://stackoverflow.com/questions/31294225/importing-scraping-an-website-into-excel/31311123#31311123", "title": "Importing/scraping an website into excel", "body": "<p>I found the solution, which was fairly simple but hard to find.\nI can just grab the ie.Document.body.innertext which is all the text I need.\nSee the code I updated below:</p>\n\n<pre><code>Sub import()\nDim row As Integer\nDim strTargetFile As String\nDim wb As Workbook\nDim test As String\nDim ie As Object\nDim pageText As String\n\nCall Fill_Array_Cultivar\n\nFor row = 3 To 4\n\n    Sheets.Add.Name = Cultivar_Array(row, 1)\n    strTargetFile = \"https://www3.wipo.int/pluto/user/jsp/select.jsp?fl=app_date%2Cden_info%2Cden_final&amp;hl=false&amp;json.nl=map&amp;wt=json&amp;type=upov&amp;start=0&amp;qi=3-nNCXQ6etEVv184O9nnd5yg%3D%3D&amp;q=cc%3AIT%20AND%20latin_name%3A(zea%20mays)%20AND%20den_info%3A\" &amp; Trim(Cultivar_Array(row, 1)) &amp; \"&amp;facet=false\"\n\n    Set ie = GetIE(\"https://www3.wipo.int\" &amp; \"*\")\n    If Not ie Is Nothing Then\n        ie.navigate (strTargetFile)\n\n        Do Until ie.ReadyState = 4: DoEvents: Loop\n\n        pageText = ie.Document.body.innertext\n        ActiveSheet.Cells(1, 1) = pageText\n        pageText = Empty\n    Else\n        MsgBox \"IE not found!\"\n    End If\nNext row\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 2, "accepted_answer_id": 31311123, "answer_count": 1, "score": 2, "last_activity_date": 1502721861, "creation_date": 1436362182, "last_edit_date": 1531164843, "question_id": 31294225, "link": "https://stackoverflow.com/questions/31294225/importing-scraping-an-website-into-excel", "title": "Importing/scraping an website into excel", "body": "<p>I am trying to scrape some data from a database, and I have it pretty much set. I look in IE for a tab that has me logged in into the database, and paste the query link there through vba. But how do I extract the data that it returns from the IE tab and put that into an excel cell or array.</p>\n\n<p>This is the code I have for opening my query:</p>\n\n<pre><code>Sub import()\nDim row As Integer\nDim strTargetFile As String\nDim wb As Workbook\nDim test As String\nDim ie As Object\n\n\nCall Fill_Array_Cultivar\n\n For row = 3 To 4\n\n    Sheets.Add.Name = Cultivar_Array(row, 1)\n    strTargetFile = \"https://www3.wipo.int/pluto/user/jsp/select.jsp?fl=app_date%2Cden_info%2Cden_final&amp;hl=false&amp;json.nl=map&amp;wt=json&amp;type=upov&amp;start=0&amp;qi=3-nNCXQ6etEVv184O9nnd5yg%3D%3D&amp;q=cc%3AIT%20AND%20latin_name%3A(zea%20mays)%20AND%20den_info%3A\" &amp; Trim(Cultivar_Array(row, 1)) &amp; \"&amp;facet=false\"\n\n        Set ie = GetIE(\"https://www3.wipo.int\" &amp; \"*\")\n         If Not ie Is Nothing Then\n\n            ie.navigate (strTargetFile)\n\nElse\n    MsgBox \"IE not found!\"\nEnd If\nNext row\n\nEnd Sub\n</code></pre>\n\n<p>And this is the appropriate function:</p>\n\n<pre><code>'Find an IE window with a matching (partial) URL\n'Assumes no frames.\nFunction GetIE(sAddress As String) As Object\n\nDim objShell As Object, objShellWindows As Object, o As Object\nDim retVal As Object, sURL As String\n\n\n    Set retVal = Nothing\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objShellWindows = objShell.Windows\n\n 'see if IE is already open\n    For Each o In objShellWindows\n        sURL = \"\"\n        On Error Resume Next\n        sURL = o.document.Location\n        On Error GoTo 0\n        If sURL &lt;&gt; \"\" Then\n            If sURL Like sAddress &amp; \"*\" Then\n              Set retVal = o\n              Exit For\n            End If\n        End If\n    Next o\n\nSet GetIE = retVal\nEnd Function\n</code></pre>\n\n<p>What the website returns to me is a white page with a line of text. Here is an example: </p>\n\n<pre><code> {\"response\":{\"start\":0,\"docs\":[{\"den_final\":\"Abacus\",\"app_date\":\"1998-01-13T22:59:59Z\"}],\"numFound\":1},\"qi\":\"3-nNCXQ6etEVv184O9nnd5yg==\",\"sv\":\"bswa2.wipo.int\",\"lastUpdated\":1436333633993}\n</code></pre>\n\n<p>PS. I also tried using the importxml function, it will import the website, but only an error page, as it does not recognize me as logged in.</p>\n"}, {"tags": ["excel", "combobox", "userform", "vba"], "answers": [{"comments": [{"owner": {"reputation": 521, "user_id": 2691958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cea785fb00ce20411ecb35949e0d10e4?s=128&d=identicon&r=PG&f=1", "display_name": "Pex", "link": "https://stackoverflow.com/users/2691958/pex"}, "edited": false, "score": 0, "creation_date": 1436783610, "post_id": 31294583, "comment_id": 50739835, "body": "Worked like a charm! Thanks"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1436786068, "last_edit_date": 1436786068, "creation_date": 1436363046, "answer_id": 31294583, "question_id": 31294076, "link": "https://stackoverflow.com/questions/31294076/link-combobox-with-textbox-in-vba-excel/31294583#31294583", "title": "Link Combobox with Textbox in vba Excel", "body": "<p>In the change event of the combo box loop through the column a values.\nWhen you find the match, put the column b value in the text box.</p>\n\n<pre><code>    Private Sub ComboBox1_Change()\n    Dim lRow As Long\n\n    'Now go through and check the values of the first column against what was selected in the combo box.\n    lRow = 1\n    Do While lRow &lt;= ws.UsedRange.Rows.Count\n\n        If ws.Range(\"A\" &amp; lRow).Value = ComboBox1.Text Then\n            Text1.Text = ws.Range(\"B\" &amp; lRow).Value\n            Exit Do\n        End If\n\n    lRow = lRow + 1\n    Loop\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 521, "user_id": 2691958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cea785fb00ce20411ecb35949e0d10e4?s=128&d=identicon&r=PG&f=1", "display_name": "Pex", "link": "https://stackoverflow.com/users/2691958/pex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3656, "favorite_count": 0, "accepted_answer_id": 31294583, "answer_count": 1, "score": 1, "last_activity_date": 1471988300, "creation_date": 1436361865, "last_edit_date": 1531161705, "question_id": 31294076, "link": "https://stackoverflow.com/questions/31294076/link-combobox-with-textbox-in-vba-excel", "title": "Link Combobox with Textbox in vba Excel", "body": "<p>I'm making a Userform in Excel to easily input text into a worksheet.</p>\n\n<p>I have a second worksheet containing information that has to be populated into the userform.</p>\n\n<p>This sheet contains 2 columns, one column (A) has numbers and the second one (B) has the description of the items linked to these numbers.</p>\n\n<p>Currently I have the first part of the population working.</p>\n\n<p>A combobox is being populated with the item numbers using this code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    With Worksheets(\"nummers\")\n        cobProductNr.List = .Range(\"A1:A\" &amp; .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row).Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>My question is, what code do I write in my form so that when I select an item(number) through my combobox, a textbox that has to contain the description automatically gets filled in?</p>\n"}, {"tags": ["vba", "ms-access-2010", "excel-2010", "sharepoint-2013"], "comments": [{"owner": {"reputation": 29, "user_id": 3679517, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f859680c913dcdff369872fe0aa74ca8?s=128&d=identicon&r=PG&f=1", "display_name": "user24555", "link": "https://stackoverflow.com/users/3679517/user24555"}, "reply_to_user": {"reputation": 311, "user_id": 4625094, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3668fc2b694b942575f32afdef39da31?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/4625094/rick"}, "edited": false, "score": 0, "creation_date": 1436363506, "post_id": 31294044, "comment_id": 50580110, "body": "I&#39;ve tried using docmd.transfersharepointlist , but I think I could not use this, because I can&#39;t find acExport or something like that."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3679517, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f859680c913dcdff369872fe0aa74ca8?s=128&d=identicon&r=PG&f=1", "display_name": "user24555", "link": "https://stackoverflow.com/users/3679517/user24555"}, "edited": false, "score": 0, "creation_date": 1436365355, "post_id": 31295279, "comment_id": 50581642, "body": "Yes, but I need also update some fields. Is this also possible with an append query?"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1436364725, "creation_date": 1436364725, "answer_id": 31295279, "question_id": 31294044, "link": "https://stackoverflow.com/questions/31294044/export-to-access-data-to-a-sharepoint-2013-list-via-vba/31295279#31295279", "title": "Export to Access Data to a SharePoint 2013 List via vba", "body": "<p>Are you writing to a SharePoint list? If so, just add the SharePoint table as a linked table. Then it's just an append query.</p>\n"}], "owner": {"reputation": 29, "user_id": 3679517, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f859680c913dcdff369872fe0aa74ca8?s=128&d=identicon&r=PG&f=1", "display_name": "user24555", "link": "https://stackoverflow.com/users/3679517/user24555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1019, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436536914, "creation_date": 1436361809, "last_edit_date": 1436536914, "question_id": 31294044, "link": "https://stackoverflow.com/questions/31294044/export-to-access-data-to-a-sharepoint-2013-list-via-vba", "title": "Export to Access Data to a SharePoint 2013 List via vba", "body": "<p>How can I export Access data to SharePoint via VBA?</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "cell", "enter"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1436362094, "post_id": 31293828, "comment_id": 50578964, "body": "If calculation is definitely not being disabled, then I&#39;d guess you have a circular reference problem."}, {"owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436362740, "post_id": 31293828, "comment_id": 50579470, "body": "I checked all sheets and non of them has the Circular Reference at the status bar next to Ready. Moreover, the Check Circular Reference option is disabled in the Formula tab"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436363008, "post_id": 31293828, "comment_id": 50579681, "body": "Is it only that one worksheet? If so, have you ever used <code>EnableCalculation</code> on that sheet to disable calculations?"}, {"owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436363707, "post_id": 31293828, "comment_id": 50580279, "body": "I have used this flag but now even if I set in all worksheets this flag to True, the problem isn&#39;t resolved."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436363768, "post_id": 31293828, "comment_id": 50580335, "body": "I have heard before of instances where using that property caused problems. I&#39;d try recreating that sheet."}, {"owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436364887, "post_id": 31293828, "comment_id": 50581257, "body": "I will try to do that then. Do you know how can I isolate a number of worksheets and prevent from calculating when I don&#39;t need them? Because some of them are pretty heavy and take ages to calculate but I don&#39;t use them."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436365199, "post_id": 31293828, "comment_id": 50581518, "body": "That&#39;s a whole separate question, and the answer will depend on the nature of your model."}, {"owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436366526, "post_id": 31293828, "comment_id": 50582670, "body": "It seems that this flag was the problem. I have the same problem with that guy here: <a href=\"http://www.mrexcel.com/forum/excel-questions/318115-enablecalculation.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/318115-enablecalculation.h&zwnj;&#8203;tml</a> Application.CalculateFull sold my problem. However I am afraid if this will happen again. I will try not to use <code>EnableCalculation</code> again. My other problem is that I have a sheet (sheet2) with more than 10,000 cells which are formula driven based on values in another sheet (sheet1). By making any change in sheet1 it takes ages to update sheet2, but I don&#39;t want to use the values in sheet2 yet. So I want to isolate them for a while."}], "answers": [{"comments": [{"owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "edited": false, "score": 5, "creation_date": 1436361985, "post_id": 31294048, "comment_id": 50578871, "body": "No, as I have said, the calculations are set to Automatic, so the issue is not there. Thanks however for the prompt reply."}, {"owner": {"reputation": 1357, "user_id": 295802, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/db9457d6fa5337f527ae87ea348a038d?s=128&d=identicon&r=PG", "display_name": "Mark Bennett", "link": "https://stackoverflow.com/users/295802/mark-bennett"}, "edited": false, "score": 0, "creation_date": 1485212454, "post_id": 31294048, "comment_id": 70822552, "body": "Menu bar looks bit different on recent Mac versions (with the dark green background), but approximately the same place.  Myself and a coworker thank you!"}], "tags": [], "owner": {"reputation": 707, "user_id": 3956549, "user_type": "registered", "profile_image": "https://graph.facebook.com/1316610025/picture?type=large", "display_name": "Carl Kevinson", "link": "https://stackoverflow.com/users/3956549/carl-kevinson"}, "is_accepted": false, "score": 15, "last_activity_date": 1436361815, "creation_date": 1436361815, "answer_id": 31294048, "question_id": 31293828, "link": "https://stackoverflow.com/questions/31293828/excel-doesnt-update-value-unless-i-hit-enter/31294048#31294048", "title": "Excel doesn&#39;t update value unless I hit Enter", "body": "<p>It sounds like your workbook got set to Manual Calculation.  You can change this to Automatic by going to Formulas > Calculation > Calculation Options > Automatic.</p>\n\n<p><img src=\"https://i.stack.imgur.com/ixxpZ.png\" alt=\"Location in Ribbon\"></p>\n\n<p>Manual calculation can be useful to reduce computational load and improve responsiveness in workbooks with large amounts of formulas.  The idea is that you can look at data and make changes, then choose when you want to make your computer go through the effort of calculation.</p>\n"}, {"tags": [], "owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "is_accepted": false, "score": 4, "last_activity_date": 1436367189, "creation_date": 1436367189, "answer_id": 31296290, "question_id": 31293828, "link": "https://stackoverflow.com/questions/31293828/excel-doesnt-update-value-unless-i-hit-enter/31296290#31296290", "title": "Excel doesn&#39;t update value unless I hit Enter", "body": "<p>I have the same problem with that guy here: <a href=\"http://mrexcel.com/forum/excel-questions/318115-enablecalculation.html\" rel=\"nofollow\">mrexcel.com/forum/excel-questions/318115-enablecalculation.html</a> <code>Application.CalculateFull</code> sold my problem. However I am afraid if this will happen again. I will try not to use <code>EnableCalculation</code> again.</p>\n"}, {"comments": [{"owner": {"reputation": 635, "user_id": 2487072, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/qsxD3.jpg?s=128&g=1", "display_name": "Taha Rushain", "link": "https://stackoverflow.com/users/2487072/taha-rushain"}, "edited": false, "score": 2, "creation_date": 1510856571, "post_id": 39153031, "comment_id": 81625011, "body": "You saved my life. Thanks for the jugaad"}, {"owner": {"reputation": 13325, "user_id": 2641576, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/K9yqy.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2641576/matt"}, "edited": false, "score": 1, "creation_date": 1532591234, "post_id": 39153031, "comment_id": 90034778, "body": "Such an excellent and simple solution, works in Excel 2016. I created this as a Macro to do it automatically:  <code>Sub InternalRefresh() Cells.Replace What:=&quot;=&quot;, Replacement:=&quot;=&quot;, LookAt:=xlPart, SearchOrder _ :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False End Sub</code>"}, {"owner": {"reputation": 108, "user_id": 5495810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec09101278f3be9c1c5e9c6d7ad00fd?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/5495810/raj"}, "edited": false, "score": 0, "creation_date": 1552258584, "post_id": 39153031, "comment_id": 96930851, "body": "This worked for me, but I still do not understand why it was necessary. This appears to be a bug in Excel."}, {"owner": {"reputation": 1260, "user_id": 4420129, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Am8Sj.jpg?s=128&g=1", "display_name": "isopach", "link": "https://stackoverflow.com/users/4420129/isopach"}, "edited": false, "score": 0, "creation_date": 1560514762, "post_id": 39153031, "comment_id": 99772018, "body": "This worked for me, wish I could have solved it programmatically though."}], "tags": [], "owner": {"reputation": 341, "user_id": 6758577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530601bca79fa85ed710176783b8d13f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyGneiss", "link": "https://stackoverflow.com/users/6758577/andygneiss"}, "is_accepted": false, "score": 24, "last_activity_date": 1472152203, "creation_date": 1472152203, "answer_id": 39153031, "question_id": 31293828, "link": "https://stackoverflow.com/questions/31293828/excel-doesnt-update-value-unless-i-hit-enter/39153031#39153031", "title": "Excel doesn&#39;t update value unless I hit Enter", "body": "<p>Executive summary / TL;DR:<br>\nTry doing a find &amp; replace of \"=\" with \"=\". Yes, replace the equals sign with itself. For my scenario, it forced everything to update.</p>\n\n<p>Background:<br>\nI frequently make formulas across multiple columns then concatenate them together. After doing such, I'll copy &amp; paste them as values to extract my created formula. After this process, they're typically stuck displaying a formula, and not displaying a value, unless I enter the cell and press Enter. Pressing F2 &amp; Enter repeatedly is not fun.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7004761, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000413475907/picture?type=large", "display_name": "Alex Chuan", "link": "https://stackoverflow.com/users/7004761/alex-chuan"}, "is_accepted": false, "score": 0, "last_activity_date": 1476234939, "creation_date": 1476234939, "answer_id": 39989076, "question_id": 31293828, "link": "https://stackoverflow.com/questions/31293828/excel-doesnt-update-value-unless-i-hit-enter/39989076#39989076", "title": "Excel doesn&#39;t update value unless I hit Enter", "body": "<p>I Encounter this problem before. I suspect that is some of ur cells are link towards other sheet, which the other sheets is returning #NAME? which ends up the current sheets is not working on calculation.</p>\n\n<p>Try solve ur other sheets that is linked</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 8839484, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c77447e1b4522661198499e02460cb68?s=128&d=identicon&r=PG", "display_name": "Mathew", "link": "https://stackoverflow.com/users/8839484/mathew"}, "is_accepted": false, "score": 6, "last_activity_date": 1509040606, "creation_date": 1509040606, "answer_id": 46960850, "question_id": 31293828, "link": "https://stackoverflow.com/questions/31293828/excel-doesnt-update-value-unless-i-hit-enter/46960850#46960850", "title": "Excel doesn&#39;t update value unless I hit Enter", "body": "<p>This doesn't sound intuitive but select the column you're having the issue with and use \"text to column\" and just press finish. This is the suggested answer from Excel help as well. For some reason in converts text to numbers.</p>\n"}, {"tags": [], "owner": {"reputation": 1658, "user_id": 6501190, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vapSh.jpg?s=128&g=1", "display_name": "java-addict301", "link": "https://stackoverflow.com/users/6501190/java-addict301"}, "is_accepted": false, "score": 0, "last_activity_date": 1522864739, "creation_date": 1522864739, "answer_id": 49657529, "question_id": 31293828, "link": "https://stackoverflow.com/questions/31293828/excel-doesnt-update-value-unless-i-hit-enter/49657529#49657529", "title": "Excel doesn&#39;t update value unless I hit Enter", "body": "<p>I ran into this exact problem too.  In my case, adding parenthesis around any internal functions (to get them to evaluate first) seemed to do the trick:</p>\n\n<p>Changed</p>\n\n<pre><code>=SUM(A1, SUBSTITUTE(A2,\"x\",\"3\",1), A3) \n</code></pre>\n\n<p>to</p>\n\n<pre><code>=SUM(A1, (SUBSTITUTE(A2,\"x\",\"3\",1)), A3) \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 1269868, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/64422b5505fd417261e51ec282e3ae49?s=128&d=identicon&r=PG", "display_name": "Sawd", "link": "https://stackoverflow.com/users/1269868/sawd"}, "edited": false, "score": 1, "creation_date": 1525798068, "post_id": 49909692, "comment_id": 87494458, "body": "You, sir, are a lifesaver."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1591984830, "post_id": 49909692, "comment_id": 110271677, "body": "This works bu has tons of side-effects <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.forcefullcalculation\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}], "tags": [], "owner": {"reputation": 71, "user_id": 8473938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb65e751855c27017ad6e09dced7b9be?s=128&d=identicon&r=PG&f=1", "display_name": "Kamol Singh", "link": "https://stackoverflow.com/users/8473938/kamol-singh"}, "is_accepted": false, "score": 7, "last_activity_date": 1524088997, "creation_date": 1524088997, "answer_id": 49909692, "question_id": 31293828, "link": "https://stackoverflow.com/questions/31293828/excel-doesnt-update-value-unless-i-hit-enter/49909692#49909692", "title": "Excel doesn&#39;t update value unless I hit Enter", "body": "<p>Found the problem and couldn't find the solution until tried this.</p>\n\n<ol>\n<li>Open Visual Basic from Developer tab (OR right-click at any sheet\nand click 'View code')</li>\n<li>At upper left panel, select 'ThisWorkbook'</li>\n<li>At lower left panel, find 'ForceFullCalculation' attribute</li>\n<li>Change it from 'False' to 'True' and save it</li>\n</ol>\n\n<p>I'm not sure if this has any side-effect, but it is work for me now.</p>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 1518699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e79b615c29e6d8915ed9852a2d30af32?s=128&d=identicon&r=PG", "display_name": "user1518699", "link": "https://stackoverflow.com/users/1518699/user1518699"}, "edited": false, "score": 0, "creation_date": 1617134387, "post_id": 50179833, "comment_id": 118217637, "body": "Great trick to use to get around excels stupid quirks. Especially when you are talking thousands of rows."}], "tags": [], "owner": {"reputation": 31, "user_id": 9742503, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0dc76b023ef8b653d7efbea92260c5f3?s=128&d=identicon&r=PG", "display_name": "user9742503", "link": "https://stackoverflow.com/users/9742503/user9742503"}, "is_accepted": false, "score": 3, "last_activity_date": 1525452997, "creation_date": 1525452997, "answer_id": 50179833, "question_id": 31293828, "link": "https://stackoverflow.com/questions/31293828/excel-doesnt-update-value-unless-i-hit-enter/50179833#50179833", "title": "Excel doesn&#39;t update value unless I hit Enter", "body": "<p>Select all the data and use the option \"Text to Columns\", that will allow your data for Applying Number Formatting \nERIK</p>\n"}], "owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105346, "favorite_count": 3, "protected_date": 1539810876, "answer_count": 8, "score": 18, "last_activity_date": 1539810459, "creation_date": 1436361303, "last_edit_date": 1531243106, "question_id": 31293828, "link": "https://stackoverflow.com/questions/31293828/excel-doesnt-update-value-unless-i-hit-enter", "title": "Excel doesn&#39;t update value unless I hit Enter", "body": "<p>I have a very annoying problem in one of my worksheets in a workbook. I am using EXCEL 2007. Any cell's value will not be updated unless I hit ENTER. Either if the formula in the cell includes an if condition, or a VLOOKUP function or even an AVERAGE function. All the calculations are set to automatic, Application.Calculation = xlAutomatic, and even the calculations for the specific worksheet are enabled, like : ws.EnableCalculation = TRUE. </p>\n\n<p>Furthermore, the ScreenUpdating is set to TRUE. After I hit the ENTER or I drag down the right corner, the cells will be updated, and they will keep being updated if I make any change. However, after saving the file and reopening it again they will be frozen again. I haven't figured out exactly when they will stop being updated again. All the formatting are set to General or number. </p>\n\n<p>Especially in IF conditions, when I check the calculations through the evaluate feature, the result is correct but it is not passed on the screen.</p>\n\n<p>Any suggestion? This thing is driving me crazy.</p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1436361237, "post_id": 31293502, "comment_id": 50578275, "body": "Have you confirmed that the Access database itself is fine - i.e. no corruption in the DB? I wouldn&#39;t be shocked if Access has had a, umm, hiccup."}, {"owner": {"reputation": 125, "user_id": 4533426, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/915128241833410/picture?type=large", "display_name": "AggieIE", "link": "https://stackoverflow.com/users/4533426/aggieie"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1436361379, "post_id": 31293502, "comment_id": 50578383, "body": "Haha yeah Im almost 100% sure its the code, since I&#39;ve deleted and recreated the table about 5 times now."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436362229, "post_id": 31293502, "comment_id": 50579056, "body": "When does this error actually occur?"}, {"owner": {"reputation": 125, "user_id": 4533426, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/915128241833410/picture?type=large", "display_name": "AggieIE", "link": "https://stackoverflow.com/users/4533426/aggieie"}, "edited": false, "score": 0, "creation_date": 1436362302, "post_id": 31293502, "comment_id": 50579126, "body": "Rory It occurs whenever the code finishes and I try to open up the DB to look at it"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436362497, "post_id": 31293502, "comment_id": 50579282, "body": "Why do you have OERN before the <code>CommitTrans</code> and why are you using a <code>Recordset</code> for an Insert query rather than a <code>Connection.Execute</code>?"}, {"owner": {"reputation": 125, "user_id": 4533426, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/915128241833410/picture?type=large", "display_name": "AggieIE", "link": "https://stackoverflow.com/users/4533426/aggieie"}, "edited": false, "score": 0, "creation_date": 1436362669, "post_id": 31293502, "comment_id": 50579415, "body": "Honestly I found the code online, and it has worked for me in the past. I dont use it that much, so basically every time I need it, I just edit it a little to get it to do what I need"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436362942, "post_id": 31293502, "comment_id": 50579611, "body": "Does it make any difference if you use <code>Conn.Execute &quot;INSERT INTO &quot; &amp; tblName &amp; colHead &amp; &quot; VALUES &quot; &amp; rcdDetail</code> instead of the <code>rs.Open ...</code> line?"}, {"owner": {"reputation": 125, "user_id": 4533426, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/915128241833410/picture?type=large", "display_name": "AggieIE", "link": "https://stackoverflow.com/users/4533426/aggieie"}, "edited": false, "score": 0, "creation_date": 1436363052, "post_id": 31293502, "comment_id": 50579707, "body": "Thanks I&#39;ll try it out, and let you know the results."}, {"owner": {"reputation": 125, "user_id": 4533426, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/915128241833410/picture?type=large", "display_name": "AggieIE", "link": "https://stackoverflow.com/users/4533426/aggieie"}, "edited": false, "score": 0, "creation_date": 1436363519, "post_id": 31293502, "comment_id": 50580132, "body": "Didn&#39;t work. It wouldnt even insert into the Database"}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1436364521, "creation_date": 1436364521, "answer_id": 31295201, "question_id": 31293502, "link": "https://stackoverflow.com/questions/31293502/unrecognized-db-format-excel-vba-to-access-database/31295201#31295201", "title": "Unrecognized DB Format-Excel VBA to Access Database", "body": "<p>Everything looks ok, here's what I'd try.</p>\n\n<p>Manually type the path for dbPath, moreover the entire connection string. Perhaps path isn't being populated correctly.</p>\n\n<p>Here's the connection string you can follow:</p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\myFolder\\myAccessFile.accdb;Persist Security Info=False;\n</code></pre>\n\n<p>If that doesn't work, double check your table name is correctly named. If it checks out, try wrapping your table name in []. So:</p>\n\n<pre><code>tblName = \"[Wait_Data_Table]\"\n</code></pre>\n\n<p>These are common things that give me grief, perhaps one of these are happening to you as well.</p>\n"}], "owner": {"reputation": 125, "user_id": 4533426, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/915128241833410/picture?type=large", "display_name": "AggieIE", "link": "https://stackoverflow.com/users/4533426/aggieie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1397, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1436364521, "creation_date": 1436360448, "last_edit_date": 1436362258, "question_id": 31293502, "link": "https://stackoverflow.com/questions/31293502/unrecognized-db-format-excel-vba-to-access-database", "title": "Unrecognized DB Format-Excel VBA to Access Database", "body": "<p>Im using a .accdb file and connecting with the following code, which has worked for me multiple times, so I don't know why its corrupting the file this time.</p>\n\n<pre><code>dbPath = ActiveWorkbook.Path &amp; \"\\WaitAnalysisDB.accdb\"\ntblName = \"Wait_Data_Table\"\nstrcon = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='\" &amp; dbPath &amp; \"';\"\nconn.Open strcon\n</code></pre>\n\n<p>Does the \"Unrecognized Format\" Access error only occur due to an error in the connection string, or could it be my SQL statement inserting records as well? Thanks</p>\n\n<p><br>\n<br></p>\n\n<p>Here's my code, if anyone cares to look through it. In the for loops that build the SQL statemetn (rcdDetail variable), I have an if statement, which basically says if there is a blank in Column A, then use the row above it that isnt blank. </p>\n\n<pre><code>Dim conn As New ADODB.Connection, rs As New ADODB.Recordset, dbPath As String, tblName As String\nDim rngColHeads As Range, rngTblRcds As Range, colHead As String, rcdDetail As String\nDim ch As Integer, cl As Integer, notNull As Boolean, strcon As String, lr As Integer\nDim currentdate As String\nDim strdbcheck As String\n\n\n'Code Checks if There Are Records for the Date in the DB\n'If there is, then it skips the SQL code\n\ncurrentdate = Date\ndbPath = ActiveWorkbook.Path &amp; \"\\WaitAnalysisDB.accdb\"\ntblName = \"Wait_Data_Table\"\nstrcon = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='\" &amp; dbPath &amp; \"';\"\nconn.Open strcon\n\nstrdbcheck = \"SELECT * FROM \" &amp; tblName\nrs.Open strdbcheck, conn\n\nrs.Filter = \"Date= #\" &amp; currentdate &amp; \"#\"\nIf Not rs.EOF Then\n    Set rs = Nothing\n    Set conn = Nothing\n    GoTo SkipExport\nElse\n    Set rs = Nothing\n    Set conn = Nothing\n        GoTo Export\nEnd If\n\n\n\nExport:\n\n'Set Up Connections\ndbPath = ActiveWorkbook.Path &amp; \"\\WaitAnalysisDB.accdb\"\ntblName = \"Wait_Data_Table\"\n\n'Create Date Column\nWorksheets(\"Wait Analysis DATA\").Select\nlr = Cells(Rows.Count, \"K\").End(xlUp).Row\ncurrentdate = Date: Range(\"O1\").Value = \"Date\": Range(Range(\"O2\"), Range(\"O\" &amp; lr)).Value = currentdate\n\nSet rngColHeads = ActiveSheet.Range(Range(\"a1\"), Range(\"a1\").End(xlToRight))\nSet rngTblRcds = ActiveSheet.Range(Range(\"K2:k\" &amp; lr).Offset(0, -10), Range(\"K2:k\" &amp; lr).Offset(0, 4))\n\n'SQL connection String\nstrcon = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='\" &amp; dbPath &amp; \"';\"\n\n'Create String for Columns for SQL\ncolHead = \"([\"\nFor ch = 1 To rngColHeads.Count\n    colHead = colHead &amp; rngColHeads.Columns(ch).Value\n    Select Case ch\n        Case Is = rngColHeads.Count\n            colHead = colHead &amp; \"])\"\n        Case Else\n            colHead = colHead &amp; \"],[\"\n    End Select\nNext ch\n\n\nOn Error GoTo EndUpdate\nconn.Open strcon\nconn.BeginTrans\n\nDim tempcl As Integer\n\nFor cl = 1 To rngTblRcds.Rows.Count\n\n    If Range(\"a2\").Offset(cl - 1, 0) = \"\" Then\n        tempcl = cl - Range(\"a2\").Offset(cl, 0).End(xlUp).Rows.Count\n\n        notNull = False\n        rcdDetail = \"('\"\n        For ch = 1 To rngColHeads.Count\n        Select Case rngTblRcds.Rows(tempcl).Columns(ch).Value\n            Case Is = Empty\n                Select Case ch\n                    Case Is = rngColHeads.Count\n                        rcdDetail = Left(rcdDetail, Len(rcdDetail) - 1) &amp; \"NULL)\"\n                    Case Else\n                        rcdDetail = Left(rcdDetail, Len(rcdDetail) - 1) &amp; \"NULL,'\"\n                End Select\n            Case Else\n                notNull = True\n                Select Case ch\n                    Case \"11\":\n                        rcdDetail = rcdDetail &amp; rngTblRcds.Rows(cl).Columns(ch).Value &amp; \"','\"\n                    Case Is = rngColHeads.Count\n                        rcdDetail = rcdDetail &amp; rngTblRcds.Rows(tempcl).Columns(ch).Value &amp; \"')\"\n                    Case Else\n                        rcdDetail = rcdDetail &amp; rngTblRcds.Rows(tempcl).Columns(ch).Value &amp; \"','\"\n                End Select\n            End Select\n    Next ch\n        tempcl = 0\n        GoTo skipads\n\n    End If\n\n\n    notNull = False\n    rcdDetail = \"('\"\n    For ch = 1 To rngColHeads.Count\n        Select Case rngTblRcds.Rows(cl).Columns(ch).Value\n            Case Is = Empty\n                Select Case ch\n                    Case Is = rngColHeads.Count\n                        rcdDetail = Left(rcdDetail, Len(rcdDetail) - 1) &amp; \"NULL)\"\n                    Case Else\n                        rcdDetail = Left(rcdDetail, Len(rcdDetail) - 1) &amp; \"NULL,'\"\n                End Select\n            Case Else\n                notNull = True\n                Select Case ch\n                    Case Is = rngColHeads.Count\n                        rcdDetail = rcdDetail &amp; rngTblRcds.Rows(cl).Columns(ch).Value &amp; \"')\"\n                    Case Else\n                        rcdDetail = rcdDetail &amp; rngTblRcds.Rows(cl).Columns(ch).Value &amp; \"','\"\n                End Select\n            End Select\n    Next ch\n\nskipads:\n    Select Case notNull\n        Case Is = True\n            rs.Open \"INSERT INTO \" &amp; tblName &amp; colHead &amp; \" VALUES \" &amp; rcdDetail, conn\n        Case Is = False\n                'do not insert record\n    End Select\n\n\nNext cl\n\nEndUpdate:\n    If Err.Number &lt;&gt; 0 Then\n        On Error Resume Next\n        conn.RollbackTrans\n        MsgBox \"There was an error. This will exit the macro.\", vbCritical, \"Error!\"\n        End\n    Else\n        On Error Resume Next\n        conn.CommitTrans\n    End If\n\n    conn.Close\n    Set rs = Nothing\n    Set conn = Nothing\n    On Error GoTo 0\n\n\n\nSkipExport:\n</code></pre>\n"}, {"tags": ["excel", "vba", "diagnostics"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1436361361, "post_id": 31293398, "comment_id": 50578365, "body": "have you debugged your code? Does it reach the line and don&#39;t change the text, or doesn&#39;t even reach it?"}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1238, "user_id": 2391294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8af32502212174717014d4867e8bda3?s=128&d=identicon&r=PG", "display_name": "Arin", "link": "https://stackoverflow.com/users/2391294/arin"}, "edited": false, "score": 0, "creation_date": 1436362823, "post_id": 31294124, "comment_id": 50579527, "body": "@A.Franklin - Thanks!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1436362762, "last_edit_date": 1436362762, "creation_date": 1436361971, "answer_id": 31294124, "question_id": 31293398, "link": "https://stackoverflow.com/questions/31293398/hiding-columns-based-upon-cell-value/31294124#31294124", "title": "Hiding columns based upon cell value", "body": "<p>You must re-structure the inner loop:</p>\n\n<pre><code>Sub Hide_columns()\n\nDim i As Integer\nDim j As Integer\n\ni = 3\n\nDo Until i = 26\n    j = 4\n    Do Until j = 54\n        With ActiveSheet.Cells(i, j)\n            If .Value = 1 Then\n            MsgBox i &amp; vbCrLf &amp; j\n                ActiveSheet.Columns(i).EntireColumn.Hidden = True\n                With ActiveSheet.Shapes(Application.Caller).TextFrame.Characters\n                    If .Text = \"Show 1\" Then\n                        .Text = \"Hide 1\"\n                    ElseIf .Text = \"Hide 1\" Then\n                        .Text = \"Show 1\"\n                    Else\n                        MsgBox (\"VBA has gone wrong.\")\n                        Exit Sub\n                    End If\n                End With\n            End If\n        End With\n        j = j + 1\n    Loop\n    i = i + 1\nLoop\nEnd Sub\n</code></pre>\n\n<p>Explanation: The first time through the outer loop (for Column A), the row number, <code>j</code>, starts at 4 and loops until it's 54. But the second time through the outer loop (for Column B), <code>j</code> is still stuck at 54, so no rows in Column B get checked. To fix this, reset <code>j</code> to 4 each time you move to a new column, as shown above.</p>\n"}], "owner": {"reputation": 25, "user_id": 4860309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90723c939a2c9af53f7dda5816e1efbb?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Smith", "link": "https://stackoverflow.com/users/4860309/harry-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 31294124, "answer_count": 1, "score": 0, "last_activity_date": 1436362762, "creation_date": 1436360179, "question_id": 31293398, "link": "https://stackoverflow.com/questions/31293398/hiding-columns-based-upon-cell-value", "title": "Hiding columns based upon cell value", "body": "<p>I am not sure why my code is not working. It is intended to recognise when I press a button (saying \"Hide1\") and search through each column, row by row, looking for cells that have the value <code>1</code> Once it does this, it should change the button to say \"Show 1\". However, when I run it, simply nothing happens.</p>\n\n<p>Here is the macro for Excel:</p>\n\n<pre><code>Sub Hide_columns()\n\nDim i As Integer\nDim j As Integer\n\ni = 3\nj = 4\n\nDo Until i = 26\n    Do Until j = 54\n        With ActiveSheet.Cells(i, j)\n            If .Value = 1 Then\n                ActiveSheet.Columns(i).EntireColumn.Hidden = True\n                With ActiveSheet.Shapes(Application.Caller).TextFrame.Characters\n                    If .Text = \"Show 1\" Then\n                        .Text = \"Hide 1\"\n                    ElseIf .Text = \"Hide 1\" Then\n                        .Text = \"Show 1\"\n                    Else\n                        MsgBox (\"VBA has gone wrong.\")\n                        Exit Sub\n                    End If\n                End With\n            End If\n        End With\n        j = j + 1\n    Loop\n    i = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "spinner", "userform"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436360496, "post_id": 31293361, "comment_id": 50577719, "body": "You would need a <code>Collection</code> (or Dictionary or array) to store the individual ranges so that you can loop through them when necessary. As you state in your post a <code>Range</code> variable can only refer to ranges on the same sheet."}, {"owner": {"reputation": 318, "user_id": 4721565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700af168e5e09a36b844328770337189?s=128&d=identicon&r=PG&f=1", "display_name": "Lumigraphics", "link": "https://stackoverflow.com/users/4721565/lumigraphics"}, "edited": false, "score": 0, "creation_date": 1436361093, "post_id": 31293361, "comment_id": 50578157, "body": "The other (possible) approaches might be to copy your selections to a new, temporary sheet and work with them there, or simply queue the sheets and do your calculations on one sheet at a time."}], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1436362819, "creation_date": 1436362819, "answer_id": 31294488, "question_id": 31293361, "link": "https://stackoverflow.com/questions/31293361/modify-a-userform-to-work-on-multiple-sheets/31294488#31294488", "title": "Modify a userform to work on multiple sheets", "body": "<p>Each Excel <code>Window</code> keeps track of the cells selected, so you could loop through the <code>Windows</code> collection:</p>\n\n<pre><code>Dim wdw As Window\nFor Each wdw In Application.Windows\n        Debug.Print wdw.Selection.Address(External:=True)\nNext wdw\n</code></pre>\n\n<p>But the problem with this approach is that your code needs to make sure the user only has open the expected workbooks or tests every workbook. Also, what happens if the user has a workbook in several views (the New Window button on the View tab)?</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 5039812, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97af98a6b4824b717b6fbe61c8297c59?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5039812/sam"}, "edited": false, "score": 0, "creation_date": 1436439164, "post_id": 31297632, "comment_id": 50618212, "body": "Thanks for your help again John. I will have a go at implementing this methodology when I get chance."}, {"owner": {"reputation": 81, "user_id": 5039812, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97af98a6b4824b717b6fbe61c8297c59?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5039812/sam"}, "edited": false, "score": 0, "creation_date": 1438165494, "post_id": 31297632, "comment_id": 51334988, "body": "Hi John. This is brilliant, thank you for your help. Sorry it took so long to reply, this took a bit of a backseat for a while."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 2, "last_activity_date": 1436370575, "last_edit_date": 1525816098, "creation_date": 1436370575, "answer_id": 31297632, "question_id": 31293361, "link": "https://stackoverflow.com/questions/31293361/modify-a-userform-to-work-on-multiple-sheets/31297632#31297632", "title": "Modify a userform to work on multiple sheets", "body": "<p>As proof of concept I created the following userform. In the editor I set ShowModal equal to False. This is important since it allows the user to switch to different sheets while the form is showing. It looks like this: </p>\n\n<p><img src=\"https://i.stack.imgur.com/4gG7x.gif\" alt=\"enter image description here\"></p>\n\n<p>The following code shows one way of allowing a user to select possibly noncontiguous ranges on separate sheets, modify them by a multiplicative factor, and then restore the original values:</p>\n\n<pre><code>Option Explicit\nDim valCopies As Collection\nDim ranges As Collection\n\nPrivate Sub UserForm_Initialize()\n    Dim r As Range\n    tbChangeFactor.Value = \"1.0\"\n    Set ranges = New Collection\n    Set valCopies = New Collection\n    For Each r In Selection.Areas\n        ranges.Add r\n        valCopies.Add r.Value\n    Next r\nEnd Sub\n\nPrivate Sub btnChange_Click()\n    Dim r As Range, c As Range, p As Double\n\n    Application.ScreenUpdating = False\n    p = tbChangeFactor.Value\n    For Each r In ranges\n        For Each c In r.Cells\n            c = c * p\n        Next c\n    Next r\n    Application.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub btnRestore_Click()\n    Dim i As Long, n As Long\n\n    n = ranges.Count\n    For i = 1 To n\n        ranges(i).Value = valCopies(i)\n    Next i\nEnd Sub\n\nPrivate Sub btnSelect_Click()\n    Dim choice As Range, A As Range\n    Dim home As Worksheet, ws As Worksheet\n\n    Set valCopies = New Collection\n    Set ranges = New Collection\n    Set home = ActiveSheet\n    For Each ws In Sheets\n        ws.Select\n        Set choice = Nothing\n        On Error Resume Next 'when the user hits cancel\n        Set choice = Application.InputBox(\"Select cells from \" &amp; ws.Name, \"Change/Restore\", Selection.Address, , , , , 8)\n        On Error GoTo 0\n        If Not choice Is Nothing Then\n            choice.Select 'for future reference\n            For Each A In choice.Areas\n                ranges.Add A\n                valCopies.Add A.Value\n            Next A\n        End If\n    Next ws\n    home.Select\nEnd Sub    \n</code></pre>\n\n<p>It would be easy to modify so that the select ranges sub only iterates over a predetermined collection of sheets. If I understand what you are trying to do, you might want to run the restore sub at the beginning of the select range sub if you want to make sure that the original (as opposed to modified) values are saved when the user runs the select sub more than once. The code hasn't been thoroughly tested but seems to work. A word of warning -- areas can overlap if the user does weird things while selecting. The above code would modify any cells contained in any such overlaps 2 (or more) times. To be really safe you might want to modify the selecting code to make sure that the areas don't overlap. One way would be to run the areas through Chip Pearson's excellent ProperUnion function: <a href=\"http://www.cpearson.com/Excel/BetterUnion.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/Excel/BetterUnion.aspx</a></p>\n"}], "owner": {"reputation": 81, "user_id": 5039812, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97af98a6b4824b717b6fbe61c8297c59?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5039812/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "accepted_answer_id": 31297632, "answer_count": 2, "score": 2, "last_activity_date": 1436370575, "creation_date": 1436360073, "question_id": 31293361, "link": "https://stackoverflow.com/questions/31293361/modify-a-userform-to-work-on-multiple-sheets", "title": "Modify a userform to work on multiple sheets", "body": "<p>I have spent much of the last few weeks struggling through making a few userforms (not one of my strengths). With my intended userform the user can select whatever values they want to on a spreadsheet (for example asset prices) and then apply the spinner, this mimics an increase/decrease of a % in the price of those assets etc and then they can observe how this impacts various aspects of the business. Then they have two buttons, one that can keep the adjusted values and another to reset the values. </p>\n\n<p>So far I have one userform that appears to work over various sheets but the selected ranges have to be contiguous and one, with great help on here (see a previous question from myself), that works perfectly for noncontiguous selections however they have to be on the same worksheet. However I would ideally like to be able to select a number of non-contiguous ranges over a number of worksheets and be able to edit these. I am reliably informed that range variables can only refer to ranges on a specific sheet which I suppose is where I am going wrong. </p>\n\n<p>The code for that works for non-contiguous ranges is below, I honestly can't take much credit for getting this far though as I have needed a lot of help from here and I haven't tidied it up completely yet, can anyone suggest how I could edit or revamp this to work across numerous worksheets and non-contiguous ranges at the same time?</p>\n\n<p>Opening Userform;</p>\n\n<pre><code>Public myRange As Range, myArea As Range\nPublic myCopy As Variant\nPublic i As Long, numAreas As Long\nPublic pvar As Double\n\nSub Button2_Click()\nSpinner.Show\nEnd Sub\n</code></pre>\n\n<p>The userform:</p>\n\n<pre><code>Option Explicit\n\n'on opening userform this sets the variables\n\nPrivate Sub UserForm_Activate()\n\npvar = 1\n\nSet myRange = Selection\n\n    numAreas = myRange.Areas.Count\n    If numAreas = 1 Then\n        myCopy = myRange.Value\n    Else\n        ReDim myCopy(1 To numAreas)\n        For i = 1 To numAreas\n            myCopy(i) = myRange.Areas(i).Value\n        Next i\n    End If\nEnd Sub\n\n'Useful Subs\n\nSub RestoreVals(R As Range, V As Variant)\n    Dim A As Range\n    Dim i As Long, n As Long\n    n = R.Areas.Count\n    If n = 1 Then\n        R.Value = V\n    Else\n        For i = 1 To n\n            R.Areas(i).Value = V(i)\n        Next i\n    End If\nEnd Sub\n\nSub Multiply(R As Range, p As Double)\n    Dim c As Range\n    For Each c In R.Cells\n        c.Value = p * c.Value\n    Next c\nEnd Sub\n\n'Spin Up button\n\nPrivate Sub SpinButton1_SpinUp()\n\nDim myRange As Range, myCopy As Variant\n\n    Set myRange = Selection\n\n'Reset Values so that pvar is * by the right values\n\n    CopyVals myRange, myCopy\n    Multiply myRange, (1 / pvar)\n\n'Now * by pvar\n\n    CopyVals myRange, myCopy\n    pvar = pvar + UpBox.Value / 100\n    Multiply myRange, pvar\n\nEnd Sub\n\n' Spin Down button\n\nPrivate Sub SpinButton1_SpinDown()\n\nDim myRange As Range, myCopy As Variant\n\n    Set myRange = Selection\n\n'Reset Values so that pvar is * by the right values\n\n    CopyVals myRange, myCopy\n    Multiply myRange, (1 / pvar)\n\n'Now * by pvar\n\n    CopyVals myRange, myCopy\n    pvar = pvar - DownBox.Value / 100\n    Multiply myRange, pvar\n\nEnd Sub\n\n'Button to return to starting values\n\nPublic Sub DefaultButton_Click()\n\nIf numAreas = 1 Then\n        myRange.Value = myCopy\n    Else\n        For i = 1 To numAreas\n            myRange.Areas(i).Value = myCopy(i)\n        Next i\n    End If\n\nEnd Sub\n\n'button to maintain adjusted values\n\nPrivate Sub CommandButton1_Click()\n\nUserForm3.Show\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "vba", "powerpoint", "office-interop"], "comments": [{"owner": {"reputation": 7066, "user_id": 1856015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MnsaK.png?s=128&g=1", "display_name": "Adrian Wragg", "link": "https://stackoverflow.com/users/1856015/adrian-wragg"}, "edited": false, "score": 0, "creation_date": 1436361121, "post_id": 31293115, "comment_id": 50578185, "body": "What are you currently using to pull the text out? Some sample code may be useful."}, {"owner": {"reputation": 747, "user_id": 1346356, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/1fa308a5068e3856ffc8b812d4a3d7ac?s=128&d=identicon&r=PG", "display_name": "Kailas", "link": "https://stackoverflow.com/users/1346356/kailas"}, "reply_to_user": {"reputation": 7066, "user_id": 1856015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MnsaK.png?s=128&g=1", "display_name": "Adrian Wragg", "link": "https://stackoverflow.com/users/1856015/adrian-wragg"}, "edited": false, "score": 0, "creation_date": 1436361850, "post_id": 31293115, "comment_id": 50578764, "body": "Added code I am using"}], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 1, "last_activity_date": 1436367481, "creation_date": 1436367481, "answer_id": 31296413, "question_id": 31293115, "link": "https://stackoverflow.com/questions/31293115/extract-bulleted-text-from-powerpoint/31296413#31296413", "title": "Extract Bulleted Text From Powerpoint", "body": "<p>You can use this method to establish if the paragraph is bulleted or not:</p>\n\n<pre><code>blnBullet = oShp.TextFrame.TextRange.Paragraphs(x).ParagraphFormat.Bullet\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 747, "user_id": 1346356, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/1fa308a5068e3856ffc8b812d4a3d7ac?s=128&d=identicon&r=PG", "display_name": "Kailas", "link": "https://stackoverflow.com/users/1346356/kailas"}, "is_accepted": true, "score": 0, "last_activity_date": 1436425230, "creation_date": 1436425230, "answer_id": 31310268, "question_id": 31293115, "link": "https://stackoverflow.com/questions/31293115/extract-bulleted-text-from-powerpoint/31310268#31310268", "title": "Extract Bulleted Text From Powerpoint", "body": "<p>Thanks JamieG for helping out. Your answer gave me hint. Here is how I was able to solve this problem:   </p>\n\n<pre><code> PowerPoint.BulletFormat bulletFormat = textRange.Paragraphs(x).ParagraphFormat.Bullet;\n\n    if( bulletFormat.Type == PowerPoint.PpBulletType.ppBulletNone )\n                           // Not Bulleted\n    else\n                        // Bulleted\n</code></pre>\n"}], "owner": {"reputation": 747, "user_id": 1346356, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/1fa308a5068e3856ffc8b812d4a3d7ac?s=128&d=identicon&r=PG", "display_name": "Kailas", "link": "https://stackoverflow.com/users/1346356/kailas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 31310268, "answer_count": 2, "score": 0, "last_activity_date": 1593763281, "creation_date": 1436359494, "last_edit_date": 1593763281, "question_id": 31293115, "link": "https://stackoverflow.com/questions/31293115/extract-bulleted-text-from-powerpoint", "title": "Extract Bulleted Text From Powerpoint", "body": "<p>I am trying to extract bulleted text from powerpoint slides. But I couldn't find any helpful function which can provide information about if current line is in bullet list or not. I tried identifying it using indent level, but I dont find it useful either.</p>\n<p>For example:</p>\n<p>If slide contains text like:</p>\n<pre><code>Abcdefg...\n. B\n. C\n  . D\n     .E\n</code></pre>\n<p>In this, there are 5 paragraphs, if get indent level of each paragraph it will come as :</p>\n<pre><code>Paragraph   IndentLevel\nAbcdefg...   1\nB            1\nC            1\nD            2\nE            3\n</code></pre>\n<p>Here, first 3 paragraph have same indent level, but only B and C are in bulleted list, so my program should B, c, D, E.</p>\n<p>Here, i dont have any way to figure out if this para starts with bullet or not.</p>\n<p>Can you please help?</p>\n<p>Thanks,\nKailas</p>\n<h1>Edit:</h1>\n<p>Code that I am using for retrieving text</p>\n<pre><code>public void analyzeText( PowerPoint.Shape shape )\n{\n    if( shape.HasTextFrame == Office.MsoTriState.msoTrue &amp;&amp; shape.TextFrame.HasText == Office.MsoTriState.msoTrue )\n    {\n        PowerPoint.TextRange textRange = shape.TextFrame.TextRange;\n        string text = textRange.Text;\n        MessageBox.Show(text);\n        for( int i=1; i&lt;=textRange.Paragraphs().Count; i++)\n        {\n            MessageBox.Show(&quot;Paragram COunt : &quot; + textRange.Paragraphs(i).Text + &quot; Indent &quot; + textRange.Paragraphs(i).IndentLevel);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "vba", "types"], "comments": [{"owner": {"reputation": 90882, "user_id": 447156, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8348bcf40f55bc5818651824369caff1?s=128&d=identicon&r=PG", "display_name": "Soner G&#246;n&#252;l", "link": "https://stackoverflow.com/users/447156/soner-g%c3%b6n%c3%bcl"}, "edited": false, "score": 0, "creation_date": 1436357212, "post_id": 31292125, "comment_id": 50575141, "body": "Can you please explain what <code>integerArray(5 To 100) As Integer</code> do exactly in VBA?"}, {"owner": {"reputation": 1368, "user_id": 3660761, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ARtU7.jpg?s=128&g=1", "display_name": "Revils", "link": "https://stackoverflow.com/users/3660761/revils"}, "reply_to_user": {"reputation": 90882, "user_id": 447156, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8348bcf40f55bc5818651824369caff1?s=128&d=identicon&r=PG", "display_name": "Soner G&#246;n&#252;l", "link": "https://stackoverflow.com/users/447156/soner-g%c3%b6n%c3%bcl"}, "edited": false, "score": 0, "creation_date": 1436357307, "post_id": 31292125, "comment_id": 50575219, "body": "I can&#39;t find the exact definition on the web, but it is either accessible from index 5 to 100 or it can contain values between both."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1436357509, "post_id": 31292125, "comment_id": 50575368, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/82943/initializing-an-array-on-arbitrary-starting-index-in-c-sharp\">Initializing an array on arbitrary starting index in c#</a>"}, {"owner": {"reputation": 408521, "user_id": 284240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/01d6005ebf89c14de87a62add488aaad?s=128&d=identicon&r=PG", "display_name": "Tim Schmelter", "link": "https://stackoverflow.com/users/284240/tim-schmelter"}, "edited": false, "score": 0, "creation_date": 1436358103, "post_id": 31292125, "comment_id": 50575866, "body": "Are you sure that anything else than <code>0</code> is allowed? If i try the code in VB.NET(which is upwards compatible) i get a compiler error: <i>&quot;Array lower bounds can be only &#39;0&#39;&quot;</i> <a href=\"https://msdn.microsoft.com/en-us/library/ttw7c10x(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ttw7c10x(v=vs.90).aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1436359059, "post_id": 31292252, "comment_id": 50576597, "body": "It should actually be <code>96</code> elements ... <code>new double[96]</code> because in VBA the array(5 to 100) has 96 elements."}, {"owner": {"reputation": 1368, "user_id": 3660761, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ARtU7.jpg?s=128&g=1", "display_name": "Revils", "link": "https://stackoverflow.com/users/3660761/revils"}, "edited": false, "score": 0, "creation_date": 1436359132, "post_id": 31292252, "comment_id": 50576657, "body": "Does integerArray(5 To 100, 200 To 300) As Double means; An array from 5 to 100 and 200 to 300. (Thus 195 places?)"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1436359306, "post_id": 31292252, "comment_id": 50576772, "body": "this means array with 96 elements where each this element has 101 another elements. So if i count right: 9696 elements."}], "tags": [], "owner": {"reputation": 31953, "user_id": 2528063, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5776e315b2aeae4338bee6b40ef1104d?s=128&d=identicon&r=PG", "display_name": "HimBromBeere", "link": "https://stackoverflow.com/users/2528063/himbrombeere"}, "is_accepted": true, "score": 1, "last_activity_date": 1436362865, "last_edit_date": 1436362865, "creation_date": 1436357409, "answer_id": 31292252, "question_id": 31292125, "link": "https://stackoverflow.com/questions/31292125/vba-type-statement-conversion-to-c/31292252#31292252", "title": "Vba Type-Statement conversion to C#", "body": "<p>Actually C# does not support those kind of arrays based on any other start-index then zero. </p>\n\n<p>However you may do.</p>\n\n<pre><code>double[] myArray = new double[96];\n</code></pre>\n\n<p>Alternatvily you may create a dictionary with indexes as keys and the actual value:</p>\n\n<pre><code>var myDict = new Dictionary&lt;int, double&gt;();\n</code></pre>\n"}], "owner": {"reputation": 1368, "user_id": 3660761, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ARtU7.jpg?s=128&g=1", "display_name": "Revils", "link": "https://stackoverflow.com/users/3660761/revils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 31292252, "answer_count": 1, "score": 0, "last_activity_date": 1436362865, "creation_date": 1436357096, "last_edit_date": 1436357813, "question_id": 31292125, "link": "https://stackoverflow.com/questions/31292125/vba-type-statement-conversion-to-c", "title": "Vba Type-Statement conversion to C#", "body": "<p>This can probably be accomplished very easily but I have the following statement in VBA:</p>\n\n<pre><code>Type testType\n    integerArray(5 To 100) As Double\nEnd Type\n</code></pre>\n\n<p>How can I accomplish the same in C#?</p>\n\n<p>@Edit 14:16   08-07-2015</p>\n\n<p>In my belief this is not the same as the question mentioned. This is a question how to convert the Type statement with an array inside. The question mentioned is only about an array with it's starting index.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1436355759, "post_id": 31291116, "comment_id": 50574077, "body": "Are you just trying to get the last line with data? There are <a href=\"http://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">plenty of ways</a> to do so, my favorite being <code>LastRow = Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row</code>."}, {"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "reply_to_user": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1436356575, "post_id": 31291116, "comment_id": 50574661, "body": "So in which part of my code do I add this line + use the lastrow so that I copy my RS in the right place?"}, {"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1436357740, "post_id": 31291116, "comment_id": 50575571, "body": "I couldn&#39;t tell by looking at your code, are you trying to select a range of rows? Or are you just trying to get the first open row at the bottom and then paste data below it?"}, {"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "reply_to_user": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1436362945, "post_id": 31291116, "comment_id": 50579613, "body": "the first open, but don&#39;t worry, I got it to work! My code needed some thinning out, I found a way to check my existing values in the excel. Thanks though!"}, {"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1436363748, "post_id": 31291116, "comment_id": 50580319, "body": "Sure thing! If you answered your own question, could you post the solution in an answer below and then accept your own answer? Just in case someone down the road is having a similar issue."}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 0, "last_activity_date": 1436360758, "creation_date": 1436360758, "answer_id": 31293614, "question_id": 31291116, "link": "https://stackoverflow.com/questions/31291116/excel-vba-adding-records-below-existing-values/31293614#31293614", "title": "Excel VBA Adding records below existing values", "body": "<p>Expand the scope of your loop.</p>\n\n<pre><code>rs.MoveFirst\nDo Until rs.EOF\n\n   'Do all your work here\n\n\n   'Then increment your counter and the recordset\n    rs.MoveNext\n    startrow = startrow + 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 31293614, "answer_count": 1, "score": 1, "last_activity_date": 1436360758, "creation_date": 1436354329, "last_edit_date": 1436355586, "question_id": 31291116, "link": "https://stackoverflow.com/questions/31291116/excel-vba-adding-records-below-existing-values", "title": "Excel VBA Adding records below existing values", "body": "<p>I've been developing a little tool that query's our database and returns some references. </p>\n\n<p>I'm having a problem adding the newly query'd values below already existing values in the excel <code>Sheet1</code>. </p>\n\n<pre><code>Option Explicit\n\nPublic Ref As String\nConst DWConnectString = \"Provider=SQLOLEDB... \"\n\nPublic Property Get rRef() As String\n    rRef = Me.TextBox1.Value\n    Ref = Trim(rRef)\nEnd Property\n\nPrivate Sub TextBox1_Change()\n    Dim rRef As String\n    rRef = Me.TextBox1.Value\nEnd Sub\n\nPrivate Sub ZoekRef_Click()\n    Dim cn As Object\n    Dim rs As Object\n    Dim cm As Object\n    Dim Ref As String\n    Dim StrSource As String\n    Dim startrow As Integer\n\n    Ref = rRef\n\n    Set cn = CreateObject(\"ADODB.Connection\")\n    cn.Open DWConnectString\n\n    Set rs = CreateObject(\"ADODB.Recordset\")\n    'rs = New ADODB.Recordset\n\n    StrSource = \"Select CONSIGNMENT.CONSIGNMENT, CONSIGNMENT.DOCUMENT_REMARK_2, INVOICE_HIST.NET_AMOUNT, INVOICE_HIST.VAT_AMOUNT, INVOICE_HIST.INV_CURRENCY \"\n    StrSource = StrSource &amp; \"from CONSIGNMENT  left outer join INVOICE_HIST  ON CONSIGNMENT.CONSIGNMENT=INVOICE_HIST.CONSIGNMENT \"\n    StrSource = StrSource &amp; \"where DOCUMENT_REMARK_2 like '%\"\n    StrSource = StrSource &amp; Ref &amp; \"%'\"\n\n    rs.Open StrSource, cn\n\n    If rs.EOF Then\n        MsgBox \"Geen Resultaten\"\n        Exit Sub\n    Else\n        Dim fieldNames, j\n\n        rs.MoveFirst\n\n        ReDim fieldNames(rs.Fields.Count - 1)\n\n        For j = 0 To rs.Fields.Count - 1\n            fieldNames(j) = rs.Fields(j).Name\n        Next\n\n        Sheet1.Range(Sheet1.Cells(1, 1), Sheet1.Cells(1, rs.Fields.Count)).Value = fieldNames\n\n        For j = 1 To rs.Fields.Count\n            Sheet1.Columns(j).AutoFit\n        Next\n\n        Sheet1.Cells.CopyFromRecordset rs\n        'fldcount2 = Sheets(\"sheet1\").UsedRange.Rows.Count\n        Sheet1.Rows(1).Insert\n        Sheet1.Range(Sheet1.Cells(1, 1), Sheet1.Cells(1, rs.Fields.Count)).Value =   fieldNames\n        startrow = 3\n\n        Do Until rs.EOF\n            rs.MoveNext\n            startrow = startrow + 1\n        Loop\n    End If\n\n    rs.Close\n    Set rs = Nothing\n\n    cn.Close\n    Set cn = Nothing\nEnd Sub\n</code></pre>\n\n<p>I thought about using the line: </p>\n\n<pre><code>Do until trim(cells(startrow,1).Value) = \"\" \n    startrow = startrow + 1 \nLoop\n</code></pre>\n\n<p>Before the <code>rs.Movenext</code> lines, but that seems to test the recordset, not the actual excel file. </p>\n\n<p>Can I test my current Sheet1's values before adding the new recordset so it comes below what's already existing? </p>\n\n<p>Thanks for the help. </p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1436669605, "post_id": 31290974, "comment_id": 50708315, "body": "Please do not use the <a href=\"http://stackoverflow.com/tags/macros/info\"><b>macros</b> tag</a> for MS Office / VBA."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2590640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e867aa4e6d1d66ccdf26e837ec3493?s=128&d=identicon&r=PG", "display_name": "Aman Sinha", "link": "https://stackoverflow.com/users/2590640/aman-sinha"}, "edited": false, "score": 0, "creation_date": 1436417110, "post_id": 31307488, "comment_id": 50605482, "body": "Thanks, I have already tried this. But, this is not my use case. I need a mechanism which can either track or stop the incoming external reference."}], "tags": [], "owner": {"reputation": 313, "user_id": 4275816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/91Zq4.gif?s=128&g=1", "display_name": "shg", "link": "https://stackoverflow.com/users/4275816/shg"}, "is_accepted": false, "score": 0, "last_activity_date": 1436411682, "creation_date": 1436411682, "answer_id": 31307488, "question_id": 31290974, "link": "https://stackoverflow.com/questions/31290974/disable-any-incoming-external-links-to-a-excel-workbook/31307488#31307488", "title": "Disable any incoming external links to a Excel Workbook", "body": "<p>Not exactly the behavior requested, but you could do this:</p>\n\n<p>Password-protect test1. The user will be prompted for the password when the formula is entered.</p>\n\n<p>If the password is correctly entered, the formula(s) will execute, but the users will be prompted for the password to update links each time test2 is opened.</p>\n"}], "owner": {"reputation": 1, "user_id": 2590640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e867aa4e6d1d66ccdf26e837ec3493?s=128&d=identicon&r=PG", "display_name": "Aman Sinha", "link": "https://stackoverflow.com/users/2590640/aman-sinha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436669486, "creation_date": 1436353946, "last_edit_date": 1436669486, "question_id": 31290974, "link": "https://stackoverflow.com/questions/31290974/disable-any-incoming-external-links-to-a-excel-workbook", "title": "Disable any incoming external links to a Excel Workbook", "body": "<p>I have two workbooks. Say test1.xlsx and test2.xlsx and have saved them in the same directory.</p>\n\n<p>I write a formula to create an external link in cell A1 of sheet1 of test2.xlsx.</p>\n\n<p>Example:\nIn the A1 cell of sheet1 of test2.xlsx I write =[test1.xlsx]Sheet1!A1 and press enter. It copies the corresponding cell content of test1.xlsx into test2.xlsx</p>\n\n<p>I don't want this formula to be executed. I want that my workbook \"test1.xlsx\" shouldn't be accessed by any other external workbook i.e. no one can provide an external reference to test1.xlsx and if provided, it should return any error say \"!#REF\"  </p>\n\n<p>I am using Excel 2010.</p>\n\n<p>It will be quite helpful for me to know exactly what are the events taking place in test1.xlsx </p>\n"}, {"tags": ["vba", "ms-word", "powerpoint"], "comments": [{"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1436358398, "post_id": 31290923, "comment_id": 50576090, "body": "Are you searching for the a part of the text in that chapter or are you searching for the heading directly, i.e. are these &quot;texts&quot; in your ppt equal to the headings or are they part of that chapter in the word doc?"}, {"owner": {"reputation": 3, "user_id": 5039187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858891b5e902b2c67219390b95387335?s=128&d=identicon&r=PG&f=1", "display_name": "mew2sharan", "link": "https://stackoverflow.com/users/5039187/mew2sharan"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1436366041, "post_id": 31290923, "comment_id": 50582240, "body": "The &quot;texts&quot; are parts of the chapter in the word doc. I aim at selecting few lines of text, after our search word is detected. And, copy the selected few lines to a new document. @LocEngineer"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5039187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858891b5e902b2c67219390b95387335?s=128&d=identicon&r=PG&f=1", "display_name": "mew2sharan", "link": "https://stackoverflow.com/users/5039187/mew2sharan"}, "edited": false, "score": 0, "creation_date": 1436435401, "post_id": 31296521, "comment_id": 50615688, "body": "Hi, (@LoCEngineer)  Thanks a lot for the help. The code works the way you said. I&#39;ve been trying to understand how this happens. And now, if I have to make some changes and search only the headings, do I add &quot;.Style = &quot;Heading 1&quot;&quot; within the .Find section?  And If I have have search inside tables for a text, and copy the description (which is usually the next column), what do I have to change? How do I directly search and copy from tables inside a word doc? @LocEngineer"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 3, "user_id": 5039187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858891b5e902b2c67219390b95387335?s=128&d=identicon&r=PG&f=1", "display_name": "mew2sharan", "link": "https://stackoverflow.com/users/5039187/mew2sharan"}, "edited": false, "score": 0, "creation_date": 1436438023, "post_id": 31296521, "comment_id": 50617504, "body": "1) For searching Headings you must change the code on various parts. You must search for style &quot;Heading 1&quot; (or 2 or whatever you use) but you must also alter the .MoveDown / .MoveUp parts; do you need to search for text or heading now, it makes quite a difference.  2.) For Cells: you need to save a) the table you are in, e.g. <code>Set tbl = Selection.Tables(1)</code> as well as your row <code>Selection.Cells(1).Row</code> and move from there. Please specify what <b>exactly</b> you need."}, {"owner": {"reputation": 3, "user_id": 5039187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858891b5e902b2c67219390b95387335?s=128&d=identicon&r=PG&f=1", "display_name": "mew2sharan", "link": "https://stackoverflow.com/users/5039187/mew2sharan"}, "edited": false, "score": 0, "creation_date": 1436447857, "post_id": 31296521, "comment_id": 50624423, "body": "My first requirement was to copy a paragraph. Now, There are two columns inside a table in the word doc. First column has features and the second column has description. I will be have a set of features in a ppt. I have to find the same feature from ppt inside this table in the word doc, and copy the corresponding description to to new document. @LocEngineer. I hope am clear now"}, {"owner": {"reputation": 3, "user_id": 5039187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858891b5e902b2c67219390b95387335?s=128&d=identicon&r=PG&f=1", "display_name": "mew2sharan", "link": "https://stackoverflow.com/users/5039187/mew2sharan"}, "edited": false, "score": 0, "creation_date": 1436529274, "post_id": 31296521, "comment_id": 50664183, "body": "Thanks for the updated code. I&#39;m planning on using this as a function, so that I can use it whenever i want to look for a text and add it to another document, I can call this. Will that be ok?  I think we might get problems in adding the current text to an existing doc with text, when I call the function multiple times and writing into the same doc again and again. Like, we will have to add it at the end of the existing text inside the doc, without erasing the available text. What do you think? @LocEngineer"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 3, "user_id": 5039187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858891b5e902b2c67219390b95387335?s=128&d=identicon&r=PG&f=1", "display_name": "mew2sharan", "link": "https://stackoverflow.com/users/5039187/mew2sharan"}, "edited": false, "score": 0, "creation_date": 1436530152, "post_id": 31296521, "comment_id": 50664698, "body": "You can do with this whatever you want for whatever you need this. If you want to append. I&#39;ll ad a little something to the code above so you don&#39;t overwrite existing content when pasting."}, {"owner": {"reputation": 3, "user_id": 5039187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858891b5e902b2c67219390b95387335?s=128&d=identicon&r=PG&f=1", "display_name": "mew2sharan", "link": "https://stackoverflow.com/users/5039187/mew2sharan"}, "edited": false, "score": 0, "creation_date": 1436774510, "post_id": 31296521, "comment_id": 50734749, "body": "Yes. I actually want to append the data everytime and Not overwrite them. I will have to collect all the details in a doc"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 3, "user_id": 5039187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858891b5e902b2c67219390b95387335?s=128&d=identicon&r=PG&f=1", "display_name": "mew2sharan", "link": "https://stackoverflow.com/users/5039187/mew2sharan"}, "edited": false, "score": 0, "creation_date": 1436775975, "post_id": 31296521, "comment_id": 50735479, "body": "Try with the added bit above. If you come across problems, paste the code you have been using and where exactly the problem occurs."}], "tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": true, "score": 0, "last_activity_date": 1436530273, "last_edit_date": 1436530273, "creation_date": 1436367742, "answer_id": 31296521, "question_id": 31290923, "link": "https://stackoverflow.com/questions/31290923/use-vba-with-powerpoint-to-search-titles-in-a-word-doc-and-copy-text-into-anothe/31296521#31296521", "title": "Use VBA with Powerpoint to Search titles in a Word Doc and Copy Text into another Word Document", "body": "<p>I see. The following is not exactly elegant since it uses Selection which I always try to avoid but it is the only way I know to achieve such a thing.</p>\n\n<p>Disclaimer 1: this is made in Word VBA, so you will need a slight adaption, like set a reference to <code>Word</code>, use a <code>wrdApp = New Word.Application</code> object and declare <code>doc</code> and <code>newdoc</code> explicitely as <code>Word.Document</code>.</p>\n\n<p>Disclaimer 2: Since you search for text instead of the respective heading, beware that this will find the first occurence of that text so you better not have the same text in several chapters. ;-)</p>\n\n<p>Disclaimer 3: I cannot paste anymore! :-( My clipboard is set, it pastes elsewhere but I just cannot paste in here.\nCode follows with first edit, hopefully in a minute...</p>\n\n<p>Edit: yepp, pasting works again. :-)</p>\n\n<pre><code>Sub FindChapter()\n\nDim doc As Document, newdoc As Document\nDim startrange As Long, endrange As Long\nDim HeadingToFind As String, ChapterToFind As String\n\nChapterToFind = \"zgasfdiukzfdggsdaf\" 'just for testing\n\nSet doc = ActiveDocument\nSet newdoc = Documents.Add\ndoc.Activate\nSelection.HomeKey unit:=wdStory\n\nWith Selection\n    With .Find\n        .ClearFormatting\n        .Text = ChapterToFind\n        .MatchWildcards = False\n        .MatchCase = True\n        .Execute\n    End With\n\n    If .Find.Found Then\n    '**********\n    'Find preceding heading to know where chapter starts\n    '**********\n        .Collapse wdCollapseStart\n        With .Find\n            .Text = \"\"\n            .Style = \"Heading 1\"\n            .Forward = False\n            .Execute\n            If Not .Found Then\n                MsgBox \"Could not find chapter heading\"\n                Exit Sub\n            End If\n        End With\n\n        .MoveDown Count:=1\n        .HomeKey unit:=wdLine\n        startrange = .Start\n\n        '*********\n        'Find next heading to know where chapter ends\n        '*********\n        .Find.Forward = True\n        .Find.Execute\n        .Collapse wdCollapseStart\n        .MoveUp Count:=1\n        .EndKey unit:=wdLine\n        endrange = .End\n\n        doc.Range(startrange, endrange).Copy\n        newdoc.Content.Paste\n        newdoc.SaveAs2 doc.Path &amp; \"\\\" &amp; HeadingToFind &amp; \".docx\", wdFormatFlatXML\n    Else\n        MsgBox \"Chapter not found\"\n    End If\n\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>Edit: If you need to search for a \"feature\" that will be in some table in column 1 with the description in column 2 and you need that description in a new doc, try this:</p>\n\n<pre><code>Sub FindFeature()\n\nDim doc As Document, newdoc As Document\nDim FeatureToFind As String\nDim ro As Long, tbl As Table\n\nFeatureToFind = \"zgasfdiukzfdggsdaf\"   'just for testing\n\nSet doc = ActiveDocument\nSet newdoc = Documents.Add\ndoc.Activate\nSelection.HomeKey unit:=wdStory\n\nWith Selection\n    With .Find\n        .ClearFormatting\n        .Text = FeatureToFind\n        .MatchWildcards = False\n        .MatchCase = True\n        .Execute\n    End With\n\n    If .Find.Found Then\n        Set tbl = Selection.Tables(1)\n        ro = Selection.Cells(1).RowIndex\n        tbl.Cell(ro, 2).Range.Copy\n        newdoc.Range.Paste\n    End If\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>Edit: Slight adaptation so you can paste without overwriting existing content in newdoc:\nInstead of <code>newdoc.Range.Paste</code> just use something along the line of this:</p>\n\n<pre><code> Dim ran As Range\n Set ran = newdoc.Range\n ran.Start = ran.End\n ran.Paste\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5039187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858891b5e902b2c67219390b95387335?s=128&d=identicon&r=PG&f=1", "display_name": "mew2sharan", "link": "https://stackoverflow.com/users/5039187/mew2sharan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 31296521, "answer_count": 1, "score": 0, "last_activity_date": 1436530273, "creation_date": 1436353822, "question_id": 31290923, "link": "https://stackoverflow.com/questions/31290923/use-vba-with-powerpoint-to-search-titles-in-a-word-doc-and-copy-text-into-anothe", "title": "Use VBA with Powerpoint to Search titles in a Word Doc and Copy Text into another Word Document", "body": "<p>I'm working on a Powerpoint slide, where I few texts are listed. I have to search for these texts in a Word Document which has a lot of Headings and Texts. After I find the title text, I need to copy the text under the Heading and paste in a new document. </p>\n\n<p>Basically, the VBA coding has to be done in the Powerpoint VBA, with two documents in the background for searching text and pasting it in another.</p>\n\n<p>I've opened the word doc. But searching the text in it and selecting it for copying to another document is what I've not been able to do. Kindly help me.</p>\n"}, {"tags": ["vba", "match", "lookup"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1436353887, "post_id": 31290782, "comment_id": 50572838, "body": "You should show your code. No problem, it is right or not. Ok!!! If show, we can easily understand and can solve your problem quickly."}, {"owner": {"reputation": 105, "user_id": 5093451, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c274f79ce13c1a76c2654d33d5abb883?s=128&d=identicon&r=PG&f=1", "display_name": "Becky", "link": "https://stackoverflow.com/users/5093451/becky"}, "reply_to_user": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1436355557, "post_id": 31290782, "comment_id": 50573953, "body": "I&#39;ve added a chunk of code I found to select all instances of Client 1 and tried to adapt it, but it doesn&#39;t work :("}], "answers": [{"comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1436412563, "post_id": 31294332, "comment_id": 50604285, "body": "Mr.Krishna, you should add some code comment in your answer. So, he can easily understand. Because he is beginner for VBA. Okay.!!"}, {"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "reply_to_user": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1436423414, "post_id": 31294332, "comment_id": 50607990, "body": "if you have edit functionality and you are not a beginner, be constructive and start doing it. easy to give easy advises.OK.!!"}], "tags": [], "owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "is_accepted": true, "score": 0, "last_activity_date": 1436362444, "creation_date": 1436362444, "answer_id": 31294332, "question_id": 31290782, "link": "https://stackoverflow.com/questions/31290782/vba-lookup-multiple-instances-of-a-variable-and-copy-range-to-another-sheet/31294332#31294332", "title": "VBA; Lookup multiple instances of a variable and copy range to another sheet", "body": "<p>Please try this. currently it create multiple sheets for each client. you should be able to change the behaviour if required, once you go through the code this is obvious</p>\n\n<pre><code>Sub MakeInvoiceSheets()\n\n    Dim ws As Worksheet, strStartCol As String, strEndCol As String, iStartRow As Integer, iEndRow As Integer\n    Dim iClient As String, wsInv As Worksheet, strCompletedClients As String\n\n    iStartRow = 1\n    iEndRow = 8\n    strStartCol = \"A\"\n    strEndCol = \"B\"\n\n    Set ws = Sheets(\"Client\")\n    strCompletedClients = \",\"\n\n    For irow = iStartRow + 1 To iEndRow\n        iClient = ws.Range(strStartCol &amp; irow).Text\n\n        If InStr(1, strCompletedClients, \",\" &amp; iClient &amp; \",\") &lt;= 0 Then\n            ws.Select\n            ws.Range(\"$\" &amp; strStartCol &amp; \"$\" &amp; iStartRow &amp; \":$\" &amp; strEndCol &amp; \"$\" &amp; iEndRow).AutoFilter Field:=1, Criteria1:=\"=\" &amp; iClient\n            ws.Range(strStartCol &amp; iStartRow).Select\n            ws.Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\n            Selection.Copy\n            Set wsInv = Sheets.Add(After:=Sheets(Sheets.Count))\n            wsInv.Name = \"Invoice For Client \" &amp; iClient\n            wsInv.Paste\n            ws.AutoFilterMode = False\n            strCompletedClients = strCompletedClients &amp; iClient &amp; \",\"\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 5093451, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c274f79ce13c1a76c2654d33d5abb883?s=128&d=identicon&r=PG&f=1", "display_name": "Becky", "link": "https://stackoverflow.com/users/5093451/becky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 31294332, "answer_count": 1, "score": 0, "last_activity_date": 1436362444, "creation_date": 1436353412, "last_edit_date": 1436357528, "question_id": 31290782, "link": "https://stackoverflow.com/questions/31290782/vba-lookup-multiple-instances-of-a-variable-and-copy-range-to-another-sheet", "title": "VBA; Lookup multiple instances of a variable and copy range to another sheet", "body": "<p>I currently have a spreadsheet tab containing amounts to be paid by various clients.  Often there is more than one row per client.  What I need to do is be able to select all the instances of this client, then copy all the columns of data for each instance of the client into another tab.  At the moment I only know how to select the first instance of the record.</p>\n\n<p>So For Example, I want to put all instances of Client with ID 1 into another tab;</p>\n\n<p>Data Tab</p>\n\n<p>ID Amt</p>\n\n<p>1  \u00a320</p>\n\n<p>2  \u00a310</p>\n\n<p>3  \u00a315</p>\n\n<p>1  \u00a310</p>\n\n<p>2  \u00a320</p>\n\n<p>Invoice Tab</p>\n\n<p>ID Amt</p>\n\n<p>1  \u00a320</p>\n\n<p>1  \u00a310</p>\n\n<p>I hope I've explained this well enough, but please let me know if you need more detail.\nI'm pretty new to VBA so sorry if this is actually a very easy question. </p>\n\n<p>Thanks in advance :)</p>\n\n<p>ETA</p>\n\n<p>I tried to adapt a piece of code I found, but it failed to work at all;</p>\n\n<pre><code>'What value do you want to find (must be in string form)?\n\nfnd = 1\n\nSet myRange = Worksheets(\"Data\").Range(\"I:AC\")\nSet LastCell = Worksheets(\"Data\").Cells(myRange.Cells.Count)\n\nSet FoundCell = myRange.Find(what:=fnd, after:=LastCell)\n\n'Test to see if anything was found\n  If Not FoundCell Is Nothing Then\n    FirstFound = FoundCell.Address\n  Else\n    GoTo NothingFound\n  End If\n\nSet rng = FoundCell\n\n'Loop until cycled through all unique finds\n  Do Until FoundCell Is Nothing\n    'Find next cell with fnd value\n      Set FoundCell = myRange.FindNext(after:=FoundCell)\n\n    'Add found cell to rng range variable\n      Set rng = Union(rng, FoundCell)\n\n    'Test to see if cycled through to first found cell\n     If FoundCell.Address = FirstFound Then Exit Do\n\n  Loop\n\n'Select Cells Containing Find Value\nrng.Select\n\nExit Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 1, "creation_date": 1436353880, "post_id": 31290765, "comment_id": 50572831, "body": "Why what is? What is it that doesn&#39;t happen as expected?"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 1, "creation_date": 1436353899, "post_id": 31290765, "comment_id": 50572847, "body": "You&#39;ve mentioned what it is supposed to do but not what it fails to. I personally like to switch all <code>Backgroundquery</code> properties to <code>False</code> then run a <code>RefreshAll</code> method.  I want my tables set onto the queries to refresh as well."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 1, "creation_date": 1436353935, "post_id": 31290765, "comment_id": 50572874, "body": "<code>ActiveWorkbook.SaveAs Filename:=ActiveWorkbook.Path &amp; &quot;\\\\Company.local\\AnyDrive\\Company\\Projects\\Project001\\Report&zwnj;&#8203;ing\\Report Updates&quot; &amp; Format(Date, ddmmyyyy) &amp; &quot;.xls&quot;</code> The <code>ActiveWorkbook.Path</code> will return your the workbooks filepath and then you&#39;re adding another filepath to the end? So it looks like it will debug on this step."}, {"owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "edited": false, "score": 1, "creation_date": 1436358383, "post_id": 31290765, "comment_id": 50576075, "body": "<code>ActiveWorkbook.Path</code> is only the folder, without file name, so it is good to use here (to get full path you use <code>ActiveWorkbook.FullName</code>)"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1436360828, "post_id": 31290765, "comment_id": 50577960, "body": "Have you tried adding <code>Option Explicit</code> to the top of your module? That  could uncover some, but not all, problems."}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1436358683, "post_id": 31292613, "comment_id": 50576313, "body": "Jacek - The names in the example have been redacted and replaced with sample ones, to avoid any potential DPA issues. Unlikely I know, but better safe than sorry!"}, {"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1436358760, "post_id": 31292613, "comment_id": 50576381, "body": "Also, I&#39;ve copied that part of the code from a similar piece of work I&#39;ve done which actually works, hence the reason for my puzzlement :)"}, {"owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "reply_to_user": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1436359339, "post_id": 31292613, "comment_id": 50576798, "body": "Interesting. Tested this and indeed Excel ignores extra &quot;/&quot;, even when there are several of them. One can learn new things every day :)"}], "tags": [], "owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "is_accepted": false, "score": 1, "last_activity_date": 1436359463, "last_edit_date": 1436359463, "creation_date": 1436358303, "answer_id": 31292613, "question_id": 31290765, "link": "https://stackoverflow.com/questions/31290765/updating-a-workbook-and-saving-using-vba/31292613#31292613", "title": "Updating a workbook and Saving using VBA", "body": "<pre><code>ActiveWorkbook.Path &amp; \"\\\\Company.local\n</code></pre>\n\n<p>Double \"\\\" sign is your problem. Cut one of those and you should be fine (or at least you'll move to some other problem if it turns out there is one later).</p>\n\n<p>Also, calling your project <code>Project-001</code> will bite you once you have several projects and you can't remember which number is doing what. Best to start giving proper descriptive names right at the start.</p>\n\n<hr>\n\n<p>Edit:\nYou don't specify file format in your <code>SaveAs</code> - this may cause problems. Will such code help?</p>\n\n<pre><code>Sub TestSave()\n\n    Dim savepath As String\n\n    savepath = ThisWorkbook.Path &amp; \"\\\\testdir\\\" &amp; \"test.xlsm\"\n\n    ThisWorkbook.SaveAs Filename:=savepath, FileFormat:=52\n\nEnd Sub\n</code></pre>\n\n<p>51 is xlsx, 52 is xlsm, 56 is xls</p>\n"}, {"comments": [{"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1436361225, "post_id": 31293669, "comment_id": 50578270, "body": "The save thing works elsewhere though! I&#39;ve simply pulled that part of the code from elsewhere! From my understanding, using the folder path in the save as means that VBA knows where to save the document to - or at least that was my understanding, and it works perfectly well for another macro I&#39;ve written which deposits a different report into a different folder."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1436361565, "post_id": 31293669, "comment_id": 50578539, "body": "Really? A filename with slashes <i>in</i> the filename (<b>not</b> the folder path)? So have you tried stepping through your code using F8? Add <code>Debug.Print StrSaveAs</code> just before you try to save the file."}, {"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1436361632, "post_id": 31293669, "comment_id": 50578587, "body": "I&#39;ll try that now, but just for your reference, removing the middle part of my code and changing the file type to a macro enabled workbook type means that the document saves fine to the target folder."}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 1, "last_activity_date": 1436360887, "creation_date": 1436360887, "answer_id": 31293669, "question_id": 31290765, "link": "https://stackoverflow.com/questions/31290765/updating-a-workbook-and-saving-using-vba/31293669#31293669", "title": "Updating a workbook and Saving using VBA", "body": "<p>You cannot include slashes in Windows file names. You are missing speech marks in the <code>Format</code> function. Change this code:</p>\n\n<pre><code>    StrSaveName = \"Report\" &amp; Format(Date, ddmmyyyy) &amp; \".xlsx\"\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>    StrSaveName = \"Report\" &amp; Format(Date, \"ddmmyyyy\") &amp; \".xlsx\"\n</code></pre>\n\n<p>to get the date as 08072015.</p>\n"}, {"comments": [{"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1436363541, "post_id": 31294442, "comment_id": 50580147, "body": "Code: <code>Sheets(&quot;January&quot;).Visible = True</code> - replace <code>January</code> with whatever the sheet you want to show is called, and if you want to hide instead of show, simply replace <code>true</code> with <code>false</code>"}], "tags": [], "owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "is_accepted": true, "score": 0, "last_activity_date": 1436362677, "creation_date": 1436362677, "answer_id": 31294442, "question_id": 31290765, "link": "https://stackoverflow.com/questions/31290765/updating-a-workbook-and-saving-using-vba/31294442#31294442", "title": "Updating a workbook and Saving using VBA", "body": "<p>OK. Thanks to Jacek and Chips I've managed to trouble shoot this VBA. </p>\n\n<p>Seems that I'd formatted the \"save as\" data wrongly. Below is the working Macro, in case anyone else comes across the issue :) </p>\n\n<p>Next step is for me to do a show/hide so the only thing that shows on entry to the workbook is the spreadsheet update page. I'll post the code for this later as an additional comment.</p>\n\n<pre><code>Sub Spreadsheet_Refresher()\n\n'Refreshes the spreadsheet and copies it with today's date\n\n' Gets name to save new workbook as\n  Dim StrSaveName As String\n  Dim StrFolderPath As String\n StrSaveName = \"Report\" &amp; \" \" &amp; Format(Date, \"dd-mm-yyyy\") &amp; \".xlsm\"\n    StrFolderPath = \"\\\\Company.local\\AnyDrive\\Company\\Projects\\001\\Reporting\\Status Report Updates\\\"\n    StrSaveAs = StrFolderPath &amp; StrSaveName\n\n'Deletes Update Spreadsheet worksheet\n\nApplication.DisplayAlerts = False\n\n    Sheets(\"Update Spreadsheet\").Select\n     ActiveWindow.SelectedSheets.Delete\n\nApplication.DisplayAlerts = True\n\n'Refreshes Spreadsheet\n\n  For Each objConnection In ThisWorkbook.Connections\n    'Get current background-refresh value\n    bBackground = objConnection.OLEDBConnection.BackgroundQuery\n\n    'Temporarily disable background-refresh\n    objConnection.OLEDBConnection.BackgroundQuery = False\n\n    'Refresh this connection\n    objConnection.Refresh\n\n    'Set background-refresh value back to original value\n    objConnection.OLEDBConnection.BackgroundQuery = bBackground\n   Next\n\n\n\n\n'Saves Spreadsheet\n\n ActiveWorkbook.SaveAs Filename:=StrSaveAs\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2422, "favorite_count": 0, "accepted_answer_id": 31294442, "answer_count": 3, "score": 1, "last_activity_date": 1436362677, "creation_date": 1436353363, "last_edit_date": 1495540274, "question_id": 31290765, "link": "https://stackoverflow.com/questions/31290765/updating-a-workbook-and-saving-using-vba", "title": "Updating a workbook and Saving using VBA", "body": "<p>I've created a macro which should refresh all data sources. It's data sources are sql servers, and as such automatically pull up the password box as required. If you've already input a password into the server since Excel was last opened it doesn't ask for the password.</p>\n\n<p>I've managed to get the following piece of code together, but it's not behaving as I'd expect</p>\n\n<pre><code>Sub BSR_Refresher()\n'Refreshes the spreadsheet and copies it with today's date\n\n'Clears all filters\n\nOn Error Resume Next\nActiveWorkbook.ShowAllData\n\n\n'Refreshes Spreadsheet\n\n  For Each objConnection In ThisWorkbook.Connections\n    'Get current background-refresh value\n    bBackground = objConnection.OLEDBConnection.BackgroundQuery\n\n    'Temporarily disable background-refresh\n    objConnection.OLEDBConnection.BackgroundQuery = False\n\n    'Refresh this connection\n    objConnection.Refresh\n\n    'Set background-refresh value back to original value\n    objConnection.OLEDBConnection.BackgroundQuery = bBackground\n   Next\n\n'Saves Spreadsheet\n\nActiveWorkbook.SaveAs Filename:=ActiveWorkbook.Path &amp; \"\\\\Company.local\\AnyDrive\\Company\\Projects\\Project001\\Reporting\\Report Updates\" &amp; Format(Date, ddmmyyyy) &amp; \".xls\"\n      End Sub\n</code></pre>\n\n<p>From my knowledge of VBA this should do the following:</p>\n\n<p>1) Clear all filters from the tables</p>\n\n<p>2) Run a data refresh (cribbed from <a href=\"https://stackoverflow.com/questions/22083668/wait-until-activeworkbook-refreshall-finishes-vba\" title=\"Code\">Here</a>)</p>\n\n<p>3) Save to <code>\\\\Company.local\\AnyDrive\\Company\\Projects\\Project001\\Reporting\\Report Updates</code> (fake names, actual structure) with the file name as <code>FileName</code> 08/07/2015 (where <code>FileName</code> is the current name of the file)</p>\n\n<p>Any clues as to why this is?</p>\n\n<p>EDIT:</p>\n\n<p>As per comments, its not saving the documents as I require.</p>\n\n<p>==================</p>\n\n<p>I've altered the code and it's still not working. I've moved things around as the loop was leading to repeated deletion of one of the sheets due to the addition of a \"delete sheet\" step. </p>\n\n<pre><code>Sub BSR_Refresher()\n'Refreshes the spreadsheet and copies it with today's date\n\n' Gets name to save new workbook as\n  Dim StrSaveName As String\n    Dim StrFolderPath As String\n    StrSaveName = \"Report\" &amp; Format(Date, ddmmyyyy) &amp; \".xlsx\"\n    StrFolderPath = \"\\\\Company.local\\anyDrive\\Company\\Projects\\Project-001\\Reporting\\Status Report Updates\\\"\n    StrSaveAs = StrFolderPath &amp; StrSaveName\n'Deletes Sheet1, Clears all filters\n\nApplication.DisplayAlerts = False\n\n    Sheets(\"Sheet1\").Select\n     ActiveWindow.SelectedSheets.Delete\n\nApplication.DisplayAlerts = True\n\n'Refreshes Spreadsheet\nOn Error Resume Next\nActiveWorkbook.ShowAllData\n\n   For Each objConnection In ThisWorkbook.Connections\n        'Get current background-refresh value\n        bBackground = objConnection.OLEDBConnection.BackgroundQuery\n\n        'Temporarily disable background-refresh\n        objConnection.OLEDBConnection.BackgroundQuery = False\n\n        'Refresh this connection\n        objConnection.Refresh\n\n        'Set background-refresh value back to original value\n        objConnection.OLEDBConnection.BackgroundQuery = bBackground\nNext\n\n'Saves Spreadsheet\n\n ActiveWorkbook.SaveAs Filename:=StrSaveAs\n\n\nEnd Sub\n</code></pre>\n\n<p>My issue is that it doesn't seem to save to where it needs to be :S</p>\n"}, {"tags": ["excel", "sorting", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1436353762, "post_id": 31290747, "comment_id": 50572774, "body": "I&#39;m pretty sure you can&#39;t do this without applying a macro, is that an acceptable solution?"}, {"owner": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1436360230, "post_id": 31290747, "comment_id": 50577524, "body": "@erikdaude as I stated in my question : &quot;I accept either macro or formula answers, thank you.&quot;"}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1436361115, "post_id": 31290747, "comment_id": 50578180, "body": "Yes I don&#39;t see how you could do it in situ without VBA, but if you were prepared to duplicate the contents of column C somewhere else and do a lookup on columns D:G you could use a VLOOKUP or MATCH/INDEX formula."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1436361334, "post_id": 31290747, "comment_id": 50578342, "body": "Welcome to SO! Reading <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> will help you get an answer sooner. Remember, this isn&#39;t a code-writing service, so post what you&#39;ve got &amp; we can help you fix it. If you don&#39;t know where to start, try using the Macro Recorder."}, {"owner": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1436362151, "post_id": 31290747, "comment_id": 50579000, "body": "@FreeMan thank you for the welcome message. The problem is that I don&#39;t know how to start codewise, so I wanted to know if there was a formula. Since there is none, I still don&#39;t know how should I start. I&#39;d post the code I had if I had any."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "edited": false, "score": 0, "creation_date": 1436362511, "post_id": 31294156, "comment_id": 50579290, "body": "There are some errors in that code, it gives me syntax error in : <code>.Fields.Append &quot;&quot;Possible&quot;&quot;, adChar, 20</code>  And you forgot to finish a comment line <code>&quot;Find the current existing in th</code>"}, {"owner": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "edited": false, "score": 0, "creation_date": 1436362821, "post_id": 31294156, "comment_id": 50579525, "body": "Also where do I assign that macro, I&#39;m not finding a way to assign it to a button or anything."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "edited": false, "score": 0, "creation_date": 1436363287, "post_id": 31294156, "comment_id": 50579901, "body": "@Atheisthotdog I fixed the extra quote, my bad.  To &#39;assign&#39; it to a button simply take the body of the sub and put it into the button event of your liking, probably the click event.  So everything between Private Sub SortExisting()   and   End Sub"}, {"owner": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "edited": false, "score": 0, "creation_date": 1436363434, "post_id": 31294156, "comment_id": 50580041, "body": "it still gives me syntax error in <code>.Fields.Append &quot;&quot;Possible&quot;, adChar, 20</code>"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "edited": false, "score": 0, "creation_date": 1436363494, "post_id": 31294156, "comment_id": 50580101, "body": "change .Fields.Append &quot;&quot;Possible&quot;, adChar, 20  to  .Fields.Append &quot;Possible&quot;, adChar, 20    Take out the extra &quot;"}, {"owner": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "edited": false, "score": 0, "creation_date": 1436363954, "post_id": 31294156, "comment_id": 50580478, "body": "@MattheyD I fixed everything in your code to make it run, now it gives me <code>Multiple-step operation generated errors. Check each status value.</code>"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "edited": false, "score": 0, "creation_date": 1436364671, "post_id": 31294156, "comment_id": 50581083, "body": "@Atheisthotdog  It is probably in the rsExists field appends.  I mistakenly had those as integers.  change adinteger to adChar.   And if you have values more that 20 char you will need to make that bigger as well"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436364686, "last_edit_date": 1436364686, "creation_date": 1436362033, "answer_id": 31294156, "question_id": 31290747, "link": "https://stackoverflow.com/questions/31290747/sorting-things-to-match-information-on-a-column/31294156#31294156", "title": "Sorting things to match information on a column", "body": "<p>Try something like this.\nIn your vba ide you will have to got tool -> reference and select\n\"Microsoft ActiveX Data Ovjects 2.8 Library\"</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub SortExisting()\nDim rsPossible As New ADODB.Recordset\nDim rsExists As New ADODB.Recordset\nDim ws As Excel.Worksheet\nDim lRow As Long\nDim lFind as Long\n\n    Set ws = Application.ActiveSheet\n\n    'Add fields to your recordset for storing data.  You can store sums here.\n    With rsPossible\n        .Fields.Append \"Row\", adInteger\n        .Fields.Append \"\"Possible\", adChar, 20\n        .Open\n    End With\n\n    With rsExists\n        .Fields.Append \"Exists\", adChar, 20\n        .Fields.Append \"Value1\", adChar, 30\n        .Fields.Append \"Value2\", adChar, 33  'Make the fields as big as they need to be.\n        .Fields.Append \"Value3\", adChar, 20\n        .Open\n    End With\n\n    lRow = 1\n\n    'Loop through and record what is in the columns.\n    Do While lRow &lt;= ws.UsedRange.Rows.Count\n\n        rsPossible.AddNew\n        rsPossible.Fields(\"Row\").Value = lRow\n        rsPossible.Fields(\"Possible\").Value = ws.Range(\"C\" &amp; lRow).Value\n        rsPossible.Update\n\n        rsExists.AddNew\n        rsExists.Fields(\"Exists\").Value = ws.Range(\"D\" &amp; lRow).Value\n        ws.Range(\"D\" &amp; lRow).Value = \"\"\n        rsExists.Fields(\"Value1\").Value = ws.Range(\"E\" &amp; lRow).Value\n        ws.Range(\"E\" &amp; lRow).Value = \"\"\n        rsExists.Fields(\"Value2\").Value = ws.Range(\"F\" &amp; lRow).Value\n        ws.Range(\"F\" &amp; lRow).Value = \"\"\n        rsExists.Fields(\"Value3\").Value = ws.Range(\"G\" &amp; lRow).Value\n        ws.Range(\"G\" &amp; lRow).Value = \"\"\n        rsExists.Update\n\n        lRow = lRow + 1\n        ws.Range(\"A\" &amp; lRow).Activate\n    Loop\n\n    If rsExists.EOF = False Then\n        rsExists.MoveFirst\n    End If\n\n    'Here we loop through the existing\n    Do While rsExists.EOF = False\n        \"Find the current existing in th\n        rsPossible.Filter = \"\"\n        rsPossible.Filter = \"Possible='\" &amp; rsExist.fields(\"Exists\").Value\n        lFind = rsPossible.Fields(\"Row\").Value\n\n        'Write the value of the existing to the row of the possible\n        ws.Range(\"D\" &amp; lFind).Value = rsPossible.Fields(\"Exists\").Value\n        ws.Range(\"E\" &amp; lFind).Value = rsPossible.Fields(\"Value1\").Value\n        ws.Range(\"F\" &amp; lFind).Value = rsPossible.Fields(\"Value2\").Value\n        ws.Range(\"G\" &amp; lFind).Value = rsPossible.Fields(\"Value3\").Value\n\n    rsExists.MoveNext\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436364686, "creation_date": 1436353305, "last_edit_date": 1531161705, "question_id": 31290747, "link": "https://stackoverflow.com/questions/31290747/sorting-things-to-match-information-on-a-column", "title": "Sorting things to match information on a column", "body": "<p>Watch this example: </p>\n\n<p><img src=\"https://i.stack.imgur.com/XWIpl.jpg\" alt=\"example\"></p>\n\n<p>I have all the possible information in the first column, the second one only has the information of what exists phisically. The row starting on that second column shows the information of what exists.</p>\n\n<p>Is there any way to sort things out like this?</p>\n\n<p><img src=\"https://i.stack.imgur.com/4pnmi.jpg\" alt=\"Sorted things\"></p>\n\n<p>I've tried sortings things out alphabetically, and it didn't work as I demonstrated. Also note that this is only an example.\nIn my main sheets things are not properly near one another yet my point stands.</p>\n\n<p>I accept either macro or formula answers, thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1436353085, "post_id": 31290450, "comment_id": 50572361, "body": "You need <code>count2 = Range(&quot;B:B&quot;).SpecialCells(xlLastCell).Row - 1</code>. Otherwise the <code>count2</code> is the last empty cell e.g. if B1:B5 have values than <code>count2</code> = 6 and you end up checking K6"}, {"owner": {"reputation": 23, "user_id": 5082050, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e436437d0db4de548ef40ad9d350250d?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5082050/dev"}, "reply_to_user": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1436496908, "post_id": 31290450, "comment_id": 50648763, "body": "Thanks Alex for the help. This is working . but I used 999moorem&#39;s solution as it co validate another columns. Thnks again"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1436671021, "post_id": 31290450, "comment_id": 50708579, "body": "Please do not use the <a href=\"http://stackoverflow.com/tags/macros/info\"><b>macros</b> tag</a> for MS Office / VBA."}], "answers": [{"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": true, "score": 1, "last_activity_date": 1436353062, "creation_date": 1436353062, "answer_id": 31290644, "question_id": 31290450, "link": "https://stackoverflow.com/questions/31290450/unable-to-rerun-macro-after-delete-the-row/31290644#31290644", "title": "Unable to rerun macro after delete the row", "body": "<p>Use another column (like an ID or something that is never going to blank) and use that in the IF statement too</p>\n\n<pre><code>Sub Errormsg ()\ncount2 = Range(\"B:B\").SpecialCells(xlLastCell).Row\nFor n = 2 To count2\n    If Range(\"K\" &amp; n).Value = vbNullString AND Range(\"A\" &amp; n).Value &lt;&gt; \"\" Then\n        Range(\"K\" &amp; n).Interior.ColorIndex = 3\n        MsgBox \"Error ! Null value \"\n        Exit Sub\n    End If                  \nNext n\nEnd Sub \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5082050, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e436437d0db4de548ef40ad9d350250d?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5082050/dev"}, "edited": false, "score": 0, "creation_date": 1436496960, "post_id": 31290728, "comment_id": 50648775, "body": "Thanks Nicolas for the help. This is working . but I used 999moorem&#39;s solution as it co validate another columns. Thnks again"}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1436353268, "creation_date": 1436353268, "answer_id": 31290728, "question_id": 31290450, "link": "https://stackoverflow.com/questions/31290450/unable-to-rerun-macro-after-delete-the-row/31290728#31290728", "title": "Unable to rerun macro after delete the row", "body": "<p>Actually, your code is also work the last row. Just remove last row from loop. It will OK.</p>\n\n<pre><code>Sub Errormsg ()\n\n     count2 = Range(\"B:B\").SpecialCells(xlLastCell).Row\n\n     For n = 2 To count2 - 1 'Just modify it\n\n         If Range(\"C\" &amp; n).Value = vbNullString Then\n\n             Range(\"C\" &amp; n).Interior.ColorIndex = 3\n\n             MsgBox (\"Error ! Null value \")\n\n             Exit Sub\n\n         End If\n\n     Next n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5082050, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e436437d0db4de548ef40ad9d350250d?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5082050/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 31290644, "answer_count": 2, "score": 0, "last_activity_date": 1436671015, "creation_date": 1436352522, "last_edit_date": 1436671015, "question_id": 31290450, "link": "https://stackoverflow.com/questions/31290450/unable-to-rerun-macro-after-delete-the-row", "title": "Unable to rerun macro after delete the row", "body": "<p>I am trying to run a code to validate a column \"K\". If any cells in column \"K\" is Null then an error message should pop up and the cell should turn to red. I tried the following code and it is working. Following is my issue.\nI run the macro. \nMacro detects the Null cell and pop up error msg.\nI deleted the row with Null cell.\nRun macro again.\nError msg pop up again. Last cell of column K turn into red eventhough that row doesnt have any data.</p>\n\n<p>This is the code I am using</p>\n\n<pre><code>Sub Errormsg ()\ncount2 = Range(\"B:B\").SpecialCells(xlLastCell).Row\nFor n = 2 To count2\nIf Range(\"K\" &amp; n).Value = vbNullString Then\nRange(\"K\" &amp; n).Interior.ColorIndex = 3\nMsgBox \"Error ! Null value \"\nExit Sub\nEnd If                  \nNext n\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1436671036, "post_id": 31290421, "comment_id": 50708582, "body": "Please do not use the <a href=\"http://stackoverflow.com/tags/macros/info\"><b>macros</b> tag</a> for MS Office / VBA."}], "answers": [{"comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 11, "user_id": 5093442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e13e1b0cdd2695ba7d6dccca02871af?s=128&d=identicon&r=PG&f=1", "display_name": "DanielDk", "link": "https://stackoverflow.com/users/5093442/danieldk"}, "edited": false, "score": 0, "creation_date": 1436352870, "post_id": 31290513, "comment_id": 50572234, "body": "Could you mark as answered if this has answered your question"}, {"owner": {"reputation": 11, "user_id": 5093442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e13e1b0cdd2695ba7d6dccca02871af?s=128&d=identicon&r=PG&f=1", "display_name": "DanielDk", "link": "https://stackoverflow.com/users/5093442/danieldk"}, "edited": false, "score": 0, "creation_date": 1436439519, "post_id": 31290513, "comment_id": 50618447, "body": "Sorry 99moorem but could please advise on how I mark the question answered? Your answer solved my problem and I simply moved the selection of shet Open quotes to the very end. Thank you!"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 11, "user_id": 5093442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e13e1b0cdd2695ba7d6dccca02871af?s=128&d=identicon&r=PG&f=1", "display_name": "DanielDk", "link": "https://stackoverflow.com/users/5093442/danieldk"}, "edited": false, "score": 0, "creation_date": 1436440321, "post_id": 31290513, "comment_id": 50618974, "body": "to the left of my answer you should see an up and down arrow, underneath them you should see a tick greyed out, click that to mark this as the answer that answered your questions :)"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1436440401, "last_edit_date": 1436440401, "creation_date": 1436352701, "answer_id": 31290513, "question_id": 31290421, "link": "https://stackoverflow.com/questions/31290421/excel-2010-macro-copy-range-of-cells-instead-of-entire-row/31290513#31290513", "title": "Excel 2010 - Macro Copy range of cells instead of entire row", "body": "<p>Try</p>\n\n<pre><code>Sub Create()\nDim RngColF As Range\nDim i As Range\nDim Dest As Range\n\nSheets(\"Data\").Select\nSet RngColF = Range(\"K1\", Range(\"K\" &amp; Rows.Count).End(xlUp))\n\nWith Sheets(\"Open quotes\")\n    Set Dest = .Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\nEnd With\n\nFor Each i In RngColF\n    If i.Value = \"Create\" Then\n        range(cells(i.row,1).address,cells(i.row,10).address).copy Dest\n        Set Dest = Dest.Offset(1,0)\n        Sheets(\"Open quotes\").Select\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>I am not sure where data is you want to copy. if it is in Data sheet then you will have a problem as you are selecting \"Open Quotes\" so the second time the runs around it will copy from \"open quotes\". may want to address that.</p>\n\n<p>EDIT: for the sake of being complete Sheets(\"Open quotes\").Select should (and believe OP has) be moved to the end of the code</p>\n"}], "owner": {"reputation": 11, "user_id": 5093442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e13e1b0cdd2695ba7d6dccca02871af?s=128&d=identicon&r=PG&f=1", "display_name": "DanielDk", "link": "https://stackoverflow.com/users/5093442/danieldk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 569, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1436671031, "creation_date": 1436352442, "last_edit_date": 1436671031, "question_id": 31290421, "link": "https://stackoverflow.com/questions/31290421/excel-2010-macro-copy-range-of-cells-instead-of-entire-row", "title": "Excel 2010 - Macro Copy range of cells instead of entire row", "body": "<p>I've tried using the feedback from similar threats - but I can't seem to implement any of them in my code.\nI apoligize as I'm brand new to macros!</p>\n\n<p>I have a spreadsheet with a pivot table, \nfrom where I wish to copy A2:J2 if K2=\"Create\".\nMy macro is working but is copying the entire row, can someone please help me?   </p>\n\n<pre><code>Sub Create()\nDim RngColF As Range\nDim i As Range\nDim Dest As Range\n\nSheets(\"Data\").Select\nSet RngColF = Range(\"K1\", Range(\"K\" &amp; Rows.Count).End(xlUp))\n\nWith Sheets(\"Open quotes\")\n    Set Dest = .Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\nEnd With\n\nFor Each i In RngColF\n    If i.Value = \"Create\" Then\n        i.EntireRow.Copy Dest\n        Set Dest = Dest.Offset(1)\n        Sheets(\"Open quotes\").Select\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436352482, "post_id": 31290389, "comment_id": 50571980, "body": "What error message do you get? and on which line?"}, {"owner": {"reputation": 9, "user_id": 4853792, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/06542b0265c6dddc2d4c4cf446b101c2?s=128&d=identicon&r=PG&f=1", "display_name": "user4853792", "link": "https://stackoverflow.com/users/4853792/user4853792"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436352553, "post_id": 31290389, "comment_id": 50572023, "body": "runtime error 1004 cannot rename a sheet to the same name as another sheet.... but I rename the sheet at the bottom? :("}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1436353275, "post_id": 31290389, "comment_id": 50572482, "body": "You&#39;re copying sheet1 every time, so your final sheet name will be the same every time, unless you have altered D2 on Sheet1 (which this code doesn&#39;t do)."}, {"owner": {"reputation": 9, "user_id": 4853792, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/06542b0265c6dddc2d4c4cf446b101c2?s=128&d=identicon&r=PG&f=1", "display_name": "user4853792", "link": "https://stackoverflow.com/users/4853792/user4853792"}, "edited": false, "score": 0, "creation_date": 1436354058, "post_id": 31290389, "comment_id": 50572956, "body": "how do I change that&gt;"}], "answers": [{"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": true, "score": 1, "last_activity_date": 1436355799, "creation_date": 1436355799, "answer_id": 31291635, "question_id": 31290389, "link": "https://stackoverflow.com/questions/31290389/excel-macro-sometimes-breaks/31291635#31291635", "title": "Excel Macro Sometimes Breaks?", "body": "<p>Try with this code.</p>\n\n<pre><code>Sub Add_Week()\n\n    Dim newDate As String\n\n    'Copy the last sheet\n    Sheets(Sheets.Count).Copy After:=Sheets(Sheets.Count)\n\n    'Extend date\n    newDate = DateAdd(\"w\", 7, DateValue(Range(\"D2\")))\n\n    'The main problem is here, because sheet name can't accept \"/, \\ and single quote\"\n    'Return value by \"DateAdd\" method include slash by default.\n    'So, I change it to \"dd-mmm-yy\" format. If you need others, modify format.\n    'But it need to valid for sheet name.\n\n    'Change data format to desire format (8-Jul-15)\n    newDate = Format(newDate, \"dd-mmm-yy\")\n\n    'Set date value\n    Range(\"D2\") = newDate\n\n    'Change sheet name\n    ActiveSheet.Name = newDate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4853792, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/06542b0265c6dddc2d4c4cf446b101c2?s=128&d=identicon&r=PG&f=1", "display_name": "user4853792", "link": "https://stackoverflow.com/users/4853792/user4853792"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 31291635, "answer_count": 1, "score": 1, "last_activity_date": 1436378382, "creation_date": 1436352381, "last_edit_date": 1436378382, "question_id": 31290389, "link": "https://stackoverflow.com/questions/31290389/excel-macro-sometimes-breaks", "title": "Excel Macro Sometimes Breaks?", "body": "<p>I've made a macro to duplicate a excel spreadsheet however when its run once it won't run again? </p>\n\n<pre><code>Sub Add_Week()\n    'copy worksheet\n    Dim test As Worksheet\n    Sheets(1).Copy After:=Sheets(Sheets.Count)\n    Set test = ActiveSheet\n\n    'extend date\n    jamesdata = Range(\"D2\")\n    Firstdate = DateValue(jamesdata)\n    seconddate = DateAdd(\"w\", 7, Firstdate)\n    Range(\"D2\").Select\n    ActiveCell.FormulaR1C1 = seconddate\n\n    'change sheet name\n    newname = Range(\"D2\").Text\n    test.Name = newname\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4616, "user_id": 4338425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CjX33.png?s=128&g=1", "display_name": "Mukesh Kalgude", "link": "https://stackoverflow.com/users/4338425/mukesh-kalgude"}, "edited": false, "score": 0, "creation_date": 1436350386, "post_id": 31289507, "comment_id": 50570705, "body": "You are missing comm like this TR.DocNo, check it"}, {"owner": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "reply_to_user": {"reputation": 4616, "user_id": 4338425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CjX33.png?s=128&g=1", "display_name": "Mukesh Kalgude", "link": "https://stackoverflow.com/users/4338425/mukesh-kalgude"}, "edited": false, "score": 0, "creation_date": 1436350815, "post_id": 31289507, "comment_id": 50570983, "body": "a comma? the query is compiled successfully, when i use it in my report to view TR.DocNo is not working"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "edited": false, "score": 0, "creation_date": 1436351444, "post_id": 31289825, "comment_id": 50571368, "body": "If i put the comma know TR.DocNo is not recognized and i have TR filed with the correct field value.  TR.DocNo not recognized stays empty"}, {"owner": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "edited": false, "score": 0, "creation_date": 1436351953, "post_id": 31289825, "comment_id": 50571692, "body": "when i use that Query in my report. set a text have the value of TR.DocNo the same error occurs even with the comma"}], "tags": [], "owner": {"reputation": 4616, "user_id": 4338425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CjX33.png?s=128&g=1", "display_name": "Mukesh Kalgude", "link": "https://stackoverflow.com/users/4338425/mukesh-kalgude"}, "is_accepted": false, "score": 1, "last_activity_date": 1436350883, "creation_date": 1436350883, "answer_id": 31289825, "question_id": 31289507, "link": "https://stackoverflow.com/questions/31289507/multi-level-group-by-clause-is-not-allowed-in-a-sub-query/31289825#31289825", "title": "Multi-level Group By clause is not allowed in a sub query", "body": "<p>You are missing comma check it</p>\n\n<pre><code>SELECT T.traID, \n           IIf(T.trawrhIDTo,\"Purchase\",\" Sales \") AS FormSorP, \n           T.traDocNoID, \n           W.wrhName, \n           TS.trsPrice, \n           TS.trsVatRate,\n           TS.trsAuxField, \n           WI.whiAdjustment, \n           W.wrhCountry,\n           T.traDate AS TDATE, \n           TS.trsSubTotalGross,\n           C.cstName AS CName, \n           TR.DocNo,\n         (SELECT tblTransactionsSC.traDocNoID AS DocNo\n            FROM tblTransactionsSC\n           WHERE (((tblTransactionsSC.traID)=[Forms]![frmReturns]![tratraID]))) AS TR\n      FROM tblWarehouse AS W \n          INNER JOIN ((tblTransactionsSC AS T LEFT JOIN tblCustomer AS C ON T.tracstID = C.cstID)   \n          INNER JOIN (tblTransactionsSubSC AS TS  \n          LEFT JOIN tblWarehouseItem AS WI ON TS.trswhiID = WI.whiID) ON T.traID = TS.trstraID) ON W.wrhID = T.trawrhID\n      WHERE (((T.traID)=[Forms]![frmReturns]![traID]));\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436350883, "creation_date": 1436350070, "question_id": 31289507, "link": "https://stackoverflow.com/questions/31289507/multi-level-group-by-clause-is-not-allowed-in-a-sub-query", "title": "Multi-level Group By clause is not allowed in a sub query", "body": "<p>The Query is running fine in query design when i use TR.DocNo field in My report. an error msg pops up : </p>\n\n<pre><code>Multi-level Group By clause is not allowed in a sub query.\n</code></pre>\n\n<p>any ideas how can i fix it thanks </p>\n\n<pre><code>SELECT T.traID, \n           IIf(T.trawrhIDTo,\"Purchase\",\" Sales \") AS FormSorP, \n           T.traDocNoID, \n           W.wrhName, \n           TS.trsPrice, \n           TS.trsVatRate,\n           TS.trsAuxField, \n           WI.whiAdjustment, \n           W.wrhCountry,\n           T.traDate AS TDATE, \n           TS.trsSubTotalGross,\n           C.cstName AS CName, \n           TR.DocNo\n         (SELECT tblTransactionsSC.traDocNoID AS DocNo\n            FROM tblTransactionsSC\n           WHERE (((tblTransactionsSC.traID)=[Forms]![frmReturns]![tratraID]))) AS TR\n      FROM tblWarehouse AS W \n          INNER JOIN ((tblTransactionsSC AS T LEFT JOIN tblCustomer AS C ON T.tracstID = C.cstID)   \n          INNER JOIN (tblTransactionsSubSC AS TS  \n          LEFT JOIN tblWarehouseItem AS WI ON TS.trswhiID = WI.whiID) ON T.traID = TS.trstraID) ON W.wrhID = T.trawrhID\n      WHERE (((T.traID)=[Forms]![frmReturns]![traID]));\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1436350940, "post_id": 31289381, "comment_id": 50571047, "body": "Try Microsoft ActiveX Data Objects - Although it may help to see what you are trying to use? or do? or some information/context ?"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1436352554, "post_id": 31289381, "comment_id": 50572024, "body": "Tell me more. What is your main error. Is it shown compile error? What is error. If compile error is not shown, you should show your code."}], "answers": [{"tags": [], "owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "is_accepted": false, "score": 0, "last_activity_date": 1436351036, "creation_date": 1436351036, "answer_id": 31289877, "question_id": 31289381, "link": "https://stackoverflow.com/questions/31289381/reference-to-be-add/31289877#31289877", "title": "Reference to be add", "body": "<p>Try \"Microsoft Access 12.0 (or higher) Object Library\". Be sure to set the DAO library to a lower priority or dereference it.</p>\n"}, {"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1436353706, "creation_date": 1436353706, "answer_id": 31290881, "question_id": 31289381, "link": "https://stackoverflow.com/questions/31289381/reference-to-be-add/31290881#31290881", "title": "Reference to be add", "body": "<p>Try with this.</p>\n\n<pre><code>Microsoft ActiveX Data Objects Recordset 2.8 Library\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Microsoft ActiveX Data Objects Recordset 6.0 Library\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4741398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2be05219975e8ff9df2754e440a604e1?s=128&d=identicon&r=PG&f=1", "display_name": "DeepikaShinde", "link": "https://stackoverflow.com/users/4741398/deepikashinde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1436359989, "creation_date": 1436349747, "last_edit_date": 1531164843, "question_id": 31289381, "link": "https://stackoverflow.com/questions/31289381/reference-to-be-add", "title": "Reference to be add", "body": "<p>Which reference do I add to use <code>Recordset</code> object in Excel VBA?</p>\n\n<p>I tried adding <strong><code>Microsoft DAO 3.6 Object Library</code></strong> reference but still it's not working.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3052, "user_id": 2090341, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/fq0KO.jpg?s=128&g=1", "display_name": "Matthias M&#252;ller", "link": "https://stackoverflow.com/users/2090341/matthias-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1436522956, "post_id": 31290669, "comment_id": 50660341, "body": "Thanks sir, since we needed it immediately, we just exported it to a SharePoint List, where it is working. I will mark this as answer."}], "tags": [], "owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "is_accepted": true, "score": 1, "last_activity_date": 1436353125, "creation_date": 1436353125, "answer_id": 31290669, "question_id": 31289038, "link": "https://stackoverflow.com/questions/31289038/vba-follow-link-in-existing-session-excel/31290669#31290669", "title": "VBA: Follow Link in existing Session - Excel", "body": "<p>Please try this and post feedback</p>\n\n<ol>\n<li>Open Sheet1 </li>\n<li>In Column A, from row 2 create your list of URLS</li>\n<li>Insert ActiveXControl Microsoft Web Browser WebBrowser1</li>\n<li>Size the control to your needs</li>\n<li>Insert Control Button outside the bounds of the browser</li>\n<li>Change name of the button to NextButton </li>\n</ol>\n\n<p>Open Code Editor (Alt+F11)</p>\n\n<p>In Sheet1 place the below code</p>\n\n<pre><code>Dim currentURLRow As Integer ''Sheet level variable\n\nSub NextButton_Click()\n    On Error Resume Next\n    Dim url As String\n\n    ''VBA evaluates second expression even when the first of OR is true. So on error resume next helps here\n    If currentURLRow = 0 Or Trim(Cells(currentURLRow, 1)) = \"\" Then\n        ''First time or loop back\n        currentURLRow = 2\n    Else\n        currentURLRow = currentURLRow + 1\n    End If\n    On Error GoTo 0 ''reset error so you know of any (good) errors\n\n    url = Cells(currentURLRow, 1)\n\n    ''Sheet1.WebBrowser1.Silent = True ''Uncomment this if you are seeing lot of script errors that you dont want to see\n    WebBrowser1.Navigate url\n    Debug.Print WebBrowser1.Document.body.InnerHTML ''' Here you can do magic if the urls you are navigating are serialisable to objects :)\n\nEnd Sub\n</code></pre>\n\n<p>Now the first time you navigate to the site, you should be prompted for user name and password, on click of next, your session to saved. </p>\n"}], "owner": {"reputation": 3052, "user_id": 2090341, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/fq0KO.jpg?s=128&g=1", "display_name": "Matthias M&#252;ller", "link": "https://stackoverflow.com/users/2090341/matthias-m%c3%bcller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 782, "favorite_count": 0, "accepted_answer_id": 31290669, "answer_count": 1, "score": 1, "last_activity_date": 1436353125, "creation_date": 1436348817, "last_edit_date": 1495539831, "question_id": 31289038, "link": "https://stackoverflow.com/questions/31289038/vba-follow-link-in-existing-session-excel", "title": "VBA: Follow Link in existing Session - Excel", "body": "<p>We have a Excel-List of URLs with a lot of parameters.\nThe problem is: The first time you follow a link, you get redirected to a ADFS-Login, which cuts some of the Parameters, since they have a maximum URL-length.</p>\n\n<p>My question: Is there a possibility to tell excel (be it via VBA or default) to use an existing Session?</p>\n\n<p>I tried some shennenigans, for example via Chrome: <a href=\"https://stackoverflow.com/questions/19705797/find-the-window-handle-for-a-chrome-browser\">Find the Window handle for a Chrome Browser</a> or to take an existing IE-Window: <a href=\"http://www.mrexcel.com/forum/excel-questions/553580-visual-basic-applications-macro-already-open-ie-window.html\" rel=\"nofollow noreferrer\">http://www.mrexcel.com/forum/excel-questions/553580-visual-basic-applications-macro-already-open-ie-window.html</a> While I get an existing Window, it seems like it always gets redirected and the URL cut. Is there anyhow a possibility to make this?</p>\n"}, {"tags": ["excel", "formatting", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1436353638, "last_edit_date": 1436353638, "creation_date": 1436352852, "answer_id": 31290569, "question_id": 31288921, "link": "https://stackoverflow.com/questions/31288921/message-box-appear-based-on-different-criteria/31290569#31290569", "title": "Message box appear based on different criteria", "body": "<p>For 1. &amp; 3., you'd simply use an if formula:</p>\n\n<pre><code>=IF(AND(F3&lt;&gt;\"\",H3&lt;&gt;\"\",B3=B4),N3+3/24,\"\")\n</code></pre>\n\n<p>This is assuming the value in N3 is a time value, otherwise it gets a bit trickier - but hardly impossible.</p>\n\n<p>Your problem statement no. 2 is somewhat trickier, I don't think you can it without VBA, and the code isn't entirely straightforward. However, I'll give it a go. In a similar-ish workbook, I have a line which moves forward to indicate when different tasks needs to be completed. To have the \"line\" move, I color in a column of cells using conditional formatting, comparing the column of cells to a timestamp I have in Y29. The code I use to update the timestamp is the following, it updates the cells every minute:</p>\n\n<p><strong>In a standard module</strong></p>\n\n<pre><code>Option Explicit\n\nPublic setDate As Date\n\nPublic Const nameToIgnore = \"OAA0006Monitor\"\n\nSub UpdateTime()\n    If currentUser() = nameToIgnore Then\n    Else\n      setDate = Now() + TimeValue(\"00:01:00\")\n      Application.OnTime setDate, \"TimeUp\"\n    End If\nEnd Sub\n\nSub TimeUp()\n\n  If currentUser() = nameToIgnore Then\n  Else\n    ThisWorkbook.Worksheets(\"ArbPlan 2011 (5)\").Range(\"Y29\") = Time\n\n    UpdateTime\n  End If\nEnd Sub\n\nSub KillOnTime()\n  If currentUser() = nameToIgnore Then\n  Else\n    On Error Resume Next\n    Application.OnTime setDate, \"TimeUp\", , False\n    On Error GoTo 0\n  End If\nEnd Sub\n</code></pre>\n\n<p><strong>In the <code>ThisWorkbook</code>-module</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Activate()\n    UpdateTime\nEnd Sub\n\nPrivate Sub Workbook_Deactivate()\n    KillOnTime\nEnd Sub\n</code></pre>\n\n<p>I don't think this should be very hard to convert to the purpose you want it for, instead of using conditional formatting, you can even have the code do all the formatting for you! :)</p>\n\n<p>Anyway, I hope this gives you a good starting point, feel free to comment if you feel anything is unclear, or if you have trouble understanding any of the logic of the code.</p>\n"}], "owner": {"reputation": 45, "user_id": 3651045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/92ee48269159cf941aa265cc4c82dc19?s=128&d=identicon&r=PG&f=1", "display_name": "Kimberly", "link": "https://stackoverflow.com/users/3651045/kimberly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436355564, "creation_date": 1436348504, "last_edit_date": 1531161705, "question_id": 31288921, "link": "https://stackoverflow.com/questions/31288921/message-box-appear-based-on-different-criteria", "title": "Message box appear based on different criteria", "body": "<p>I have some complicated Excel formatting to do, but I have no idea where to begin.</p>\n\n<p>There are few criteria that need to be met:</p>\n\n<ol>\n<li>When there are cell values in F3 and H3, the time at cell N4 should automatically be the time in N3 plus three hours.</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/jE9Es.png\" alt=\"enter image description here\"></p>\n\n<ol start=\"2\">\n<li>If system time is exceeds the value in N4, and the value in F4 and H4 is still empty, it will trigger a message or format highlighting to inform user that the time is over.</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/KN1Ru.png\" alt=\"enter image description here\"></p>\n\n<ol start=\"3\">\n<li>If there is new bath being created in column B, the time in column N will stop adding the time and just left blank for user to key in the new time.</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/L5S11.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1436349379, "post_id": 31288903, "comment_id": 50570037, "body": "You can&#39;t run VBA in Excel if it&#39;s closed. You could perhaps use a VBScript via a scheduled task. Why can&#39;t you open the text file?"}, {"owner": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436350521, "post_id": 31288903, "comment_id": 50570783, "body": "@Rory Because I want to loop it through many files and the time spent opening/closing each of them eventually accumulates into wasted minutes. Since I don&#39;t want to edit the data but rather just extract it, I was wondering if it was possible to just do so without the need to open it."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1436350575, "post_id": 31288903, "comment_id": 50570819, "body": "You cannot logically read a file without opening it; perhaps if you share your read code &amp; explain why deleting a file would help improvements can be suggested"}, {"owner": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1436351541, "post_id": 31288903, "comment_id": 50571431, "body": "@AlexK. Edited the entry and added the simplified version of my code (baring a whole lot of variables to take into consideration when entering the text into the excel)."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1436351899, "post_id": 31288903, "comment_id": 50571657, "body": "I would try looping the files loading the text into an array then perform a <i>single</i> update on the sheet: <code>Range(&quot;B1:B&quot; &amp; row).Value = Application.Transpose(arry)</code> as some time will be consumed updating the sheet for every file"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1436373115, "post_id": 31288903, "comment_id": 50587476, "body": "<a href=\"http://stackoverflow.com/questions/11267459/vba-importing-text-file-into-excel-sheet/11267603#11267603\">relevant</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1436410981, "last_edit_date": 1436410981, "creation_date": 1436404114, "answer_id": 31306481, "question_id": 31288903, "link": "https://stackoverflow.com/questions/31288903/read-file-without-opening-and-delete-it/31306481#31306481", "title": "Read file without opening and delete it", "body": "<p>This might be faster than opening each file (reads first line from a 18.5 Mb file in 0.1953125 sec)</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nDim cmdLine As Object\n\nSub Test_Proc()\n    Dim i As Long, minRow As Long, maxRow As Long, rng1 As Range, rng2 As Range\n    Dim t As Double, ws As Worksheet, x As Variant, col1 As Variant, col2 As Variant\n\n    Set ws = ThisWorkbook.Worksheets(1)\n    minRow = 2\n    With ws\n        .Columns(2).Delete\n        maxRow = .UsedRange.Rows.Count\n        Set rng1 = .Range(\"A1:A\" &amp; maxRow)\n        Set rng2 = .Range(\"B1:B\" &amp; maxRow)\n    End With\n    col1 = rng1.Value2: col2 = rng2.Value2\n    Set cmdLine = CreateObject(\"WScript.Shell\")\n\n    Application.ScreenUpdating = False\n    t = Timer\n    For i = minRow To maxRow\n        If Len(col1(i, 1)) &gt; 0 Then\n            ws.Cells(i, 2).Value2 = Replace(ImportLine(col1(i, 1)), vbCrLf, vbNullString)\n        End If\n    Next\n    'rng2.Value2 = col2\n    Application.ScreenUpdating = True\n    InputBox \"Duration: \", \"Duration\", Timer - t    '18.5 Mb file in 0.1953125 sec\nEnd Sub\n\nFunction ImportLine(ByVal strFile As String) As String\n    ImportLine = Replace(cmdLine.Exec( _\n            \"%comspec% /C FindStr /N . \" &amp; strFile &amp; \" | FindStr ^1:\" _\n        ).STDOut.ReadAll, \"1:\", vbNullString)\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>A bit nested but it does the following:</p>\n\n<ul>\n<li>CMD /C - opens a command line window, then closes it when completed</li>\n<li>FindStr /N . C:\\test.txt - Find any character, and output the line with line number in format \"1:\"</li>\n<li>| FindStr ^1: - redirect to another FindStr that uses regex to find \"1:\" at start of line</li>\n<li>When the command line is completed, return the output to the Replace function</li>\n<li>Replace removes \"1:\" and returns the string</li>\n</ul>\n\n<p>If your files might contain the string \"1:\" somewhere else within the first line</p>\n\n<ul>\n<li>we can use the Right() function: return Right(output, Len(output)-2)</li>\n<li><p>or we can use a different command line that numbers the lines with \"[1]\":</p>\n\n<ul>\n<li>Find /N \" \" C:\\test.txt | Find \"[1]\"</li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1949, "favorite_count": 0, "accepted_answer_id": 31306481, "answer_count": 1, "score": 1, "last_activity_date": 1436410981, "creation_date": 1436348465, "last_edit_date": 1436351429, "question_id": 31288903, "link": "https://stackoverflow.com/questions/31288903/read-file-without-opening-and-delete-it", "title": "Read file without opening and delete it", "body": "<p>I'm trying to figure out a way to read the first line of text in a .txt through excel VBA without opening the file, something I've been having trouble finding since all the examples I've seen involve opening the .txt one way or another.</p>\n\n<p>Aside from this, I was wondering if there was any way for me to get the VBA code to delete the mentioned .txt a set time after excel has been closed... which I'm not too sure is even remotely possible (with VBA at least).</p>\n\n<p>EDIT:</p>\n\n<p>The simplified code goes like this:</p>\n\n<pre><code>Option Explicit\nPublic g_strVar As String\nSub Test_Proc()\n    Dim row as Long        \n    row = 2\n\n    Do While Cells(row, 1) &lt;&gt; \"\" \n        Cells(row, 2) = ImportVariable(Cells(row, 1))\n        row = row + 1\n    Loop\n\nEnd Sub\nFunction ImportVariable(strFile As String) As String\n\n    Open strFile For Input As #1\n    Line Input #1, ImportVariable\n    Close #1\n\nEnd Function\n</code></pre>\n\n<p>Column 1 contains the locations of each and every .txt file, and on the column next to it I have to detail what is the first line of text on each file. Problem is that the list has been in a couple occasions about 10K long, and the only place I can think of from where I can improve on the time this takes to execute is in the \"Open / Close\" since some of these .txt files are 12.000 KB in size and take a bit to open.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1436349343, "post_id": 31288821, "comment_id": 50570015, "body": "Hi, Dorian,  In both cases it returns <code>&quot;#VALUE!&quot;</code>"}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "reply_to_user": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1436350339, "post_id": 31288821, "comment_id": 50570681, "body": "Ok, then try to run the function in the immediate window. That will show you a better error message. Maybe you only need to reference &quot;Microsoft Office 14.0 Access Database Engine Object Library&quot; (and delete the reference to &quot;Microsoft DAO 3.6 Object Library&quot; or set it to a lower priority)."}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "reply_to_user": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1436350816, "post_id": 31288821, "comment_id": 50570985, "body": "sorry, i didn&#39;t see you are the guy from yesterday&#39;s question, so you will already have the correct references... what error does the function throw when you run it in the immediate window?"}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "reply_to_user": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1436352015, "post_id": 31288821, "comment_id": 50571721, "body": "Hmmm, i don&#39;t see a syntax error in your SQL-statement. Maybe your tablename or columnname have illegal characters like space or leading numbers etc. Try to use squared brackets. This could work: <code>&quot;SELECT MAX([&quot; &amp; COLMN &amp; &quot;]) as MaxDate FROM [&quot; &amp; TBL &amp; &quot;] WHERE MaxDate &lt;= #&quot; &amp; Format(DT, &quot;m\\&#47;d\\&#47;yyyy&quot;)</code>"}, {"owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1436352218, "post_id": 31288821, "comment_id": 50571842, "body": "Sorry , I made some changes and it gave me another error. I&#39;ll write it under my question"}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "reply_to_user": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1436352688, "post_id": 31288821, "comment_id": 50572109, "body": "your Sub won&#39;t work because it can&#39;t assign a value to itself. The <code>GetDateDB = RS!MaxDate</code> can&#39;t work. The <code>MsgBox GetDateDB</code> won&#39;t work as well. You can either use <code>MsgBox RS!MaxDate</code> or you undo your edits and write <code>?GetDateDb(&quot;CB_EXCHANGE&quot;, &quot;RDATE&quot;, &quot;07.07.2015&quot;)</code> into the immediate window."}, {"owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1436354772, "post_id": 31288821, "comment_id": 50573430, "body": "OK, I did it. and it gave me an error  <code>run-time error &#39;3075&#39; syntax error in date in query expression &#39;MaxDate &lt; #07.07.2015&#39;.</code>"}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "reply_to_user": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1436356953, "post_id": 31288821, "comment_id": 50574946, "body": "sorry, the ending sharp (#) is missing and the date is not in the correct format. Do you have the <code>Format(DT, &quot;m\\&#47;d\\&#47;yyyy&quot;)</code> in your instruction? Try to initialize DT as a Date <code>Public Function GetDateDB(TBL As String, COLMN As String, DT As Date) As Variant</code> so it should notice that it&#39;s a variable that can be formatted as &quot;m\\/d\\/yyyy&quot;."}, {"owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1436358968, "post_id": 31288821, "comment_id": 50576518, "body": "You will laugh if I say where the problem was:  my system&#39;s format is dd/mm/yy ,  <code>?GetDateDb(&quot;CB_EXCHANGE&quot;, &quot;RDATE&quot;, &quot;07&#47;07&#47;2015&quot;). </code> Anyway, Thank you for your help. ))))"}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "reply_to_user": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1436359371, "post_id": 31288821, "comment_id": 50576824, "body": "You&#39;re welcome. You should try different dates, because the format dd/mm/yy can easily be mixed up with m/d/yyyy. Check if the function returns the correct value."}], "tags": [], "owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "is_accepted": true, "score": 1, "last_activity_date": 1436348207, "creation_date": 1436348207, "answer_id": 31288821, "question_id": 31288502, "link": "https://stackoverflow.com/questions/31288502/get-the-last-date-before-selected-date-from-access-in-excel/31288821#31288821", "title": "Get the last date before selected date from ACCESS in Excel", "body": "<p>As far as i consider, you only need to replace the <code>... WHERE MaxDate &lt;= ...</code> by <code>... WHERE MaxDate &lt; ...</code>.  (Just delete the equals-symbol)</p>\n\n<p>When you search with &lt;= you will in most cases get the input date.</p>\n"}], "owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "accepted_answer_id": 31288821, "answer_count": 1, "score": 1, "last_activity_date": 1436354229, "creation_date": 1436347357, "last_edit_date": 1436354229, "question_id": 31288502, "link": "https://stackoverflow.com/questions/31288502/get-the-last-date-before-selected-date-from-access-in-excel", "title": "Get the last date before selected date from ACCESS in Excel", "body": "<p>I have an Access DATABASE with date column in table, the dates are sorted but there can be missing dates. The problem is to get the latest date before the input date. For example I managed to solve this problem in excel sheet with just this <code>{=MAX(IF(A1:A10&lt;=C1,A1:A10,0))}</code> formula, but I have a DataBase with large amount of data and need to call it from DB with formula.</p>\n\n<p>I tried to write a code, but it doesn't work. I don't get why ?  Could anyone  help me with this problem ? thanks.</p>\n\n<pre><code>Public Function GetDateDB(TBL As String, COLMN As String, DT As String) As Variant\n\nDim DB As Database\nDim RS As Recordset\nDim DBfile\n\nDBfile = Application.ThisWorkbook.Path &amp; \"\\myDatabase.accdb\"\n\nSet DB = DBEngine.OpenDatabase(DBfile)\nSet RS = DB.OpenRecordset(\"SELECT MAX(\" &amp; COLMN &amp; \") as MaxDate FROM \" &amp; TBL &amp; \" WHERE MaxDate &lt;= #\" &amp; Format(DT, \"m\\/d\\/yyyy\") &amp; \"# \", dbOpenDynaset)\n\nIf RS.RecordCount &gt; 0 Then\n    RS.MoveFirst\n    GetDateDB = RS!MaxDate\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "sendmessage"], "owner": {"reputation": 136, "user_id": 2742162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVv1s.jpg?s=128&g=1", "display_name": "Tunca", "link": "https://stackoverflow.com/users/2742162/tunca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1510, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1436430897, "creation_date": 1436346426, "last_edit_date": 1436430897, "question_id": 31288154, "link": "https://stackoverflow.com/questions/31288154/sendmessage-cant-get-text-with-wm-gettext", "title": "SendMessage can&#39;t get text with WM_GETTEXT", "body": "<p>I am trying to get text of window with SendMessage function. However, I can get length of text but I can't get text. I guess type of txt (String) is not correct to SendMessage. Thanks.</p>\n\n<pre><code>Const WM_SETTEXT = &amp;HC\nConst WM_GETTEXT = &amp;HD\nConst WM_GETTEXTLENGTH = &amp;HE\n\nDim hwnd As Long\nDim hwnd_child As Long\nDim result As Long\nDim txtlen As Long\nDim txt As String\n\n\nhwnd = FindWindow(vbNullString, \"\u0130ngilizce T\u00fcrk\u00e7e S\u00f6zl\u00fck\")\nhwnd_child = FindWindowEx(hwnd, 0, \"Edit\", vbNullString)\ntxtlen = SendMessage(hwnd_child, WM_GETTEXTLENGTH, 0, 0)\ns = Space$(txtlen + 1)\nresult2 = SendMessage(hwnd_child, WM_GETTEXT, ByVal txtlen, txt) \nMsgBox txt\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1436346503, "post_id": 31288149, "comment_id": 50568143, "body": "I don&#39;t think this will work, as <code>Range.Text</code> will look like &quot;01/01/2015&quot; which is not a valid sheet name (because of the slashes)."}, {"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1436346560, "post_id": 31288149, "comment_id": 50568180, "body": "The cells format need to be changed, else it will pop out error message box."}], "tags": [], "owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "is_accepted": false, "score": 0, "last_activity_date": 1436346784, "last_edit_date": 1436346784, "creation_date": 1436346409, "answer_id": 31288149, "question_id": 31288025, "link": "https://stackoverflow.com/questions/31288025/excel-date-change-vba-issue/31288149#31288149", "title": "Excel date change VBA Issue", "body": "<p>You can use <code>newname = Range(\"D2\").Text</code> to get the date. <br></p>\n\n<p>Editted:<br>\nDo take note that the date format in the cell need to be changed<br>\n<img src=\"https://i.stack.imgur.com/nzkcY.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": false, "score": 0, "last_activity_date": 1436347228, "last_edit_date": 1495541677, "creation_date": 1436347228, "answer_id": 31288448, "question_id": 31288025, "link": "https://stackoverflow.com/questions/31288025/excel-date-change-vba-issue/31288448#31288448", "title": "Excel date change VBA Issue", "body": "<p>The problem is the forward slashes in the date.  You can either use <code>Format()</code> to re-format the date into something that doesn't contain slashes - e.g.</p>\n\n<pre><code>If IsDate(Range(\"A1\").Value) Then\n    newname = Format(Range(\"A1\").Value, \"yyyy-mm-dd\")\nElse\n    'Handle the error here\nEnd If\n</code></pre>\n\n<p>This doesn't rely on the cell being in the correct format.  Note also that if <code>D2</code> doesn't contain a date, then <code>Format</code> would just leave it alone - possibly including invalid characters - hence why I check first.</p>\n\n<p>A more general solution is to use a regular expression to replace invalid characters with something else (e.g. as in <a href=\"https://stackoverflow.com/questions/8590860/replacing-multiple-invalid-characters-in-a-sheet-name/8591088#8591088\">this question</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1436388163, "last_edit_date": 1436388163, "creation_date": 1436347236, "answer_id": 31288450, "question_id": 31288025, "link": "https://stackoverflow.com/questions/31288025/excel-date-change-vba-issue/31288450#31288450", "title": "Excel date change VBA Issue", "body": "<blockquote>\n  <p>date is dd/mm/yyyy it wont import it. I'M trying to get it to display it as 11th August 2011</p>\n</blockquote>\n\n<p>Try the following</p>\n\n<pre><code>Option Explicit\nSub ChangeSheetName()\n    Dim newname As String\n    newname = Format(Range(\"D2\"), \"dd mmmm yyyy;@\") ' 11 August 2011\n    'or\n    'newname = Format(Sheets(\"Sheet1\").Range(\"D2\"), \"dd mmmm yyyy;@\") ' 11 August 2011\n    ActiveSheet.Name = newname\nEnd Sub\n</code></pre>\n\n<p>You don't have to format the cell, See Date <a href=\"http://www.techonthenet.com/access/functions/date/format.php\" rel=\"nofollow\">formats</a> </p>\n"}], "owner": {"reputation": 9, "user_id": 4853792, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/06542b0265c6dddc2d4c4cf446b101c2?s=128&d=identicon&r=PG&f=1", "display_name": "user4853792", "link": "https://stackoverflow.com/users/4853792/user4853792"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1436388163, "creation_date": 1436346028, "last_edit_date": 1436348790, "question_id": 31288025, "link": "https://stackoverflow.com/questions/31288025/excel-date-change-vba-issue", "title": "Excel date change VBA Issue", "body": "<p>I'm trying to make a macro that will change the name of the current sheet open in Excel. </p>\n\n<p>Its taking the information from a cell that contains a date in the future however cause the format of the date is dd/mm/yyyy it wont import it. I'M trying to get it to display it as 11th August 2011 or something like that. This is what i have got so far and I can't seem to find anything on the web.</p>\n\n<pre><code>Sub ChangeSheetName()\n\nnewname = Range(\"D2\")\n\nActiveSheet.Name = newname\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "edited": false, "score": 0, "creation_date": 1436345748, "post_id": 31287887, "comment_id": 50567631, "body": "extract all the contents present inbetween <code>&lt;&gt;</code> using <code>&lt;(.*?)&gt;</code> regex."}, {"owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "edited": false, "score": 0, "creation_date": 1436345757, "post_id": 31287887, "comment_id": 50567635, "body": "Which lang you&#39;re running?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1436345821, "post_id": 31287887, "comment_id": 50567674, "body": "You can just match anything inside the <code>&lt;...&gt;</code> with <code>&lt;([^&lt;&gt;]+)&gt;;</code> and get the contents of group 1. Is that enough? Please let us know what language you are using."}, {"owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 0, "creation_date": 1436347295, "post_id": 31287887, "comment_id": 50568671, "body": "hi, im just using sublime text. To the downvoter, how about a comment on what you think is wrong with my question?"}], "answers": [{"tags": [], "owner": {"reputation": 62965, "user_id": 3679490, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/70f98fb23b16862298ea208aedfd18ae?s=128&d=identicon&r=PG&f=1", "display_name": "vks", "link": "https://stackoverflow.com/users/3679490/vks"}, "is_accepted": false, "score": 1, "last_activity_date": 1436347122, "last_edit_date": 1436347122, "creation_date": 1436346515, "answer_id": 31288176, "question_id": 31287887, "link": "https://stackoverflow.com/questions/31287887/regex-to-insert-new-line-character-after-semicolon-and-remove-names-before-email/31288176#31288176", "title": "Regex to insert new line character after semicolon and remove names before email", "body": "<pre><code>&lt;([^&gt;]*)&gt;(;)|[^&gt;&lt;]*\n</code></pre>\n\n<p>You can try this.Replace by <code>$1$2\\n</code>.Remove empty newlines later.See demo.</p>\n\n<p><a href=\"https://regex101.com/r/cK4iV0/27\" rel=\"nofollow\">https://regex101.com/r/cK4iV0/27</a></p>\n"}, {"comments": [{"owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 0, "creation_date": 1436349032, "post_id": 31288266, "comment_id": 50569821, "body": "Thanks stribizhev, very good answer i must say, i like the demo page :)"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 0, "creation_date": 1436349152, "post_id": 31288266, "comment_id": 50569911, "body": "Please be careful with that site as it can only deal with PCRE (PHP/Perl), Python and JavaScript regex flavors. If you are using C#, you should not use that site, but regexstorm.net or regexhero.net. What flavor are you using?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 0, "creation_date": 1436349934, "post_id": 31288266, "comment_id": 50570412, "body": "I have updated the answer so that in case you have <code>&lt;&gt;</code> or <code>&lt;  &gt;</code> inside with no emails inside, they could also be removed."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 0, "creation_date": 1436369021, "post_id": 31288266, "comment_id": 50584696, "body": "Please let me know if it works for you, or if you need more assistance withtit. If it works, please consider accepting the answer."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 0, "creation_date": 1436445039, "post_id": 31288266, "comment_id": 50622245, "body": "Yes, but look-behinds are not supported. I updated the answer."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1436445038, "last_edit_date": 1436445038, "creation_date": 1436346746, "answer_id": 31288266, "question_id": 31287887, "link": "https://stackoverflow.com/questions/31287887/regex-to-insert-new-line-character-after-semicolon-and-remove-names-before-email/31288266#31288266", "title": "Regex to insert new line character after semicolon and remove names before email", "body": "<p>Instead of replacing everything but the <code>&lt;...&gt;</code>-ed emails, you can just match the mails with one of the following regular expressions (if you really insist on a regex solution):</p>\n\n<pre><code>&lt;([^@&lt;&gt;]+@[^@&lt;&gt;]+)&gt;;\n</code></pre>\n\n<p>The email addresses will be in captured group 1. See <a href=\"https://regex101.com/r/cP0cJ4/1\" rel=\"nofollow\">demo</a></p>\n\n<p>If you need to get the string with replacing what you do not need, you may still use </p>\n\n<pre><code>&lt;([^@&lt;&gt;]+@[^@&lt;&gt;]+)&gt;(;)|[^&lt;&gt;]+|&lt;|&gt;\n</code></pre>\n\n<p>With <code>$1$2</code> replacement string. See <a href=\"https://regex101.com/r/cP0cJ4/4\" rel=\"nofollow\">demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 10493, "user_id": 751527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df6b0a061810c2b448fa73a4af0e7112?s=128&d=identicon&r=PG&f=1", "display_name": "NeverHopeless", "link": "https://stackoverflow.com/users/751527/neverhopeless"}, "is_accepted": false, "score": 1, "last_activity_date": 1436348250, "last_edit_date": 1592644375, "creation_date": 1436348250, "answer_id": 31288833, "question_id": 31287887, "link": "https://stackoverflow.com/questions/31287887/regex-to-insert-new-line-character-after-semicolon-and-remove-names-before-email/31288833#31288833", "title": "Regex to insert new line character after semicolon and remove names before email", "body": "<p>You can try this regex as well:</p>\n<pre><code>(?:[^&lt;]+)&lt;([^&gt;]+)&gt;(;)\n</code></pre>\n<p>and replace it with <code>$1$2\\n</code>.</p>\n<p>Here first group captures email address and second group captures <code>;</code>. Here <code>?:</code> ignore the name before the email addresses.</p>\n<h3><a href=\"https://regex101.com/r/xW0sR4/2\" rel=\"nofollow noreferrer\">Live Demo</a></h3>\n"}], "owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 31288266, "answer_count": 3, "score": 0, "last_activity_date": 1436445038, "creation_date": 1436345677, "last_edit_date": 1531164843, "question_id": 31287887, "link": "https://stackoverflow.com/questions/31287887/regex-to-insert-new-line-character-after-semicolon-and-remove-names-before-email", "title": "Regex to insert new line character after semicolon and remove names before email", "body": "<p>I have a list of emails all on one line that I would like to clean up. They are currently in the following format:</p>\n\n<pre><code>Jones, Peter &lt;jones.h7@petstore.com&gt;; Bradley, Charles &lt;bradley19@petstore.com&gt;; Frank, Hilda &lt;frank.hl@petstore.com&gt;;\n</code></pre>\n\n<p>and the desired result is as follows:</p>\n\n<pre><code>jones.h7@petstore.com;\nbradley19@petstore.com; \nfrank.hl@petstore.com;\n</code></pre>\n\n<p>So the names and angle brackets around the email are removed.</p>\n\n<p>I would like a regex solution. I have tried replacing <code>;\\s</code> with <code>\\r\\n</code> but did not get tthe expected result. I am very new to regex so I'm stuck.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436345821, "post_id": 31287765, "comment_id": 50567675, "body": "<code>TrueUsedRange</code> expects a Worksheet as a parameter but you are passing an Integer for some reason."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436346038, "post_id": 31287765, "comment_id": 50567815, "body": "@Rory Fixed that. Now I get <code>Object Variable or With block not set</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436346068, "post_id": 31287765, "comment_id": 50567840, "body": "Where do you assign a worksheet to the variable?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436346140, "post_id": 31287765, "comment_id": 50567900, "body": "From a Sub. I use the following: <code>rData.clTrueUsedRange = ActiveSheet.Cells</code>"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436346192, "post_id": 31287765, "comment_id": 50567933, "body": "I&#39;m assigning all the cells on the worksheet as a range. Would have preferred to simply use the specified worksheet though."}], "answers": [{"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1436346800, "post_id": 31288151, "comment_id": 50568329, "body": "Thanks! I&#39;m getting much further with this now... it still tells me that I am missing a <code>Object variable or With block variable</code> in the Function. Everything seems to be within the <code>wsSource</code> with block though??"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1436347111, "post_id": 31288151, "comment_id": 50568542, "body": "Ok. Didn&#39;t see your last comment! Thanks a ton!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1436346413, "creation_date": 1436346413, "answer_id": 31288151, "question_id": 31287765, "link": "https://stackoverflow.com/questions/31287765/class-wont-work/31288151#31288151", "title": "Class won&#39;t work", "body": "<p>Your function expects a sheet, not a <code>Range</code>. You need: <code>Set clTrueUsedRange = TrueUsedRange(mySheet.Worksheet)</code> or change your code as below, and pass a Worksheet when you call it. Also, your <code>Property Let</code> needs to be a <code>Property Set</code> as you are assigning an Object:</p>\n\n<pre><code>Option Explicit\nPrivate mySheet As Worksheet\n\nPublic Property Get clTrueUsedRange() As Range\n    Set clTrueUsedRange = TrueUsedRange(mySheet)\nEnd Property\n\nPublic Property Set Sheet(ByRef wsSource As Worksheet)\n    Set mySheet = wsSource\nEnd Property\nPrivate Function TrueUsedRange(ByRef wsSource As Worksheet) As Range\nDim rLastCell As Range\n\nWith wsSource\n    Set rLastCell = .Cells.Find(What:=\"*\", After:=.Cells(1, 1), LookIn:=xlFormulas, LookAt:= _\n            xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False)\n    Set TrueUsedRange = .Range(\"$A$1:\" &amp; rLastCell.Address)\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>and then use:\n<code>Set rData.Sheet = ActiveSheet</code></p>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 31288151, "answer_count": 1, "score": 0, "last_activity_date": 1436346413, "creation_date": 1436345346, "last_edit_date": 1436346086, "question_id": 31287765, "link": "https://stackoverflow.com/questions/31287765/class-wont-work", "title": "Class won&#39;t work", "body": "<p>I'm learning to work with classes in VBA. I'm attempting to write one that gets the true used range. My code in the class module looks like this:</p>\n\n<pre><code>Option Explicit\nPrivate mySheet As Range\n\nPublic Property Get clTrueUsedRange() As Range\n    Set clTrueUsedRange = TrueUsedRange(mySheet)\nEnd Property\n\nPublic Property Let clTrueUsedRange(ByRef wsSource As Range)\n    mySheet = wsSource\nEnd Property\nPrivate Function TrueUsedRange(ByRef wsSource As Worksheet) As Range\nDim rLastCell As Range\n\nWith wsSource\n    Set rLastCell = .Cells.Find(What:=\"*\", After:=.Cells(1, 1), LookIn:=xlFormulas, LookAt:= _\n            xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False)\n    Set TrueUsedRange = .Range(\"$A$1:\" &amp; rLastCell.Address)\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>When I try to run it, I get an error message, stating: ByRef Type mismatch</p>\n\n<p><strong>What is not correct in my refrences in the code?</strong></p>\n"}, {"tags": ["vba", "excel", "outofrangeexception"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1436345647, "post_id": 31287725, "comment_id": 50567557, "body": "On which line do you have the error message?"}, {"owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1436345744, "post_id": 31287725, "comment_id": 50567628, "body": "I&#39;m not sure that&#39;s the problem, it&#39;s just every time i try to run it i end up getting the error message, have i set part of the code up wrong. There are also some breaks in the text but not in column A"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1436345808, "post_id": 31287725, "comment_id": 50567661, "body": "I didn&#39;t mean on which line of your Excel sheet, I meant on which line of code ;)"}, {"owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1436345817, "post_id": 31287725, "comment_id": 50567670, "body": "When the error message comes up it highlights the whole vba so i&#39;m assuming that means it&#39;s all wrong. I think the error must be driven by the set rng line"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1436345936, "post_id": 31287725, "comment_id": 50567753, "body": "The whole code??? I never saw that!^^ Generally, it is only one row at a time... So check that you have a sheet name &quot;Sheet1&quot;, because your code doesn&#39;t seem that wrong!"}, {"owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1436346134, "post_id": 31287725, "comment_id": 50567896, "body": "Haha thanks, i&#39;d named it a different sheet however when i was on the VBA screen it called it sheet1 then in brackets the name. I thought the sheet 1 would still pull it through. Like i said i&#39;m very new to coding, most the time my job doesn&#39;t need it and never used it at university"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1436346228, "post_id": 31287725, "comment_id": 50567972, "body": "No problem, I&#39;ll post an answer to explain different ways to call a sheet, if you could accept it to mark the issue as solved, that would be great! ;)"}, {"owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1436346552, "post_id": 31287725, "comment_id": 50568172, "body": "Yep absolutely thank you for your help"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1436346783, "creation_date": 1436346783, "answer_id": 31288273, "question_id": 31287725, "link": "https://stackoverflow.com/questions/31287725/how-to-avoid-subset-out-of-range-when-running-a-delete-rows-with-variable/31288273#31288273", "title": "How to avoid subset out of range when running a delete rows with variable", "body": "<p>Be careful when you hard code the name of your sheets like this :</p>\n\n<pre><code>Set ws = ActiveWorkbook.Sheets(\"Sheet1\")\n</code></pre>\n\n<p>Because if you change the name in Excel, you'll have to it also in your code (you'll find it out pretty shortly with an error message)</p>\n\n<p>So <strong>different ways to call/reference a sheet</strong> :</p>\n\n<h2>Classical, with Sheet's name</h2>\n\n<pre><code>Set ws = ActiveWorkbook.Sheets(\"Sheet1\")\n</code></pre>\n\n<h2>Using index</h2>\n\n<pre><code>Set ws = ActiveWorkbook.Sheets(1)\n</code></pre>\n\n<h2>Using Sheet's object name</h2>\n\n<pre><code>Set ws = ActiveWorkbook.Sheet1\n</code></pre>\n\n<p><strong>That name won't change, even if you rename the Sheet directly in Excel!</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/kM0zK.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 4965884, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh6.googleusercontent.com/-Haa1oGGa8rI/AAAAAAAAAAI/AAAAAAAAAFg/cUBKWuUgsCg/photo.jpg?sz=128", "display_name": "Tan12", "link": "https://stackoverflow.com/users/4965884/tan12"}, "is_accepted": false, "score": 1, "last_activity_date": 1436371760, "creation_date": 1436371760, "answer_id": 31298049, "question_id": 31287725, "link": "https://stackoverflow.com/questions/31287725/how-to-avoid-subset-out-of-range-when-running-a-delete-rows-with-variable/31298049#31298049", "title": "How to avoid subset out of range when running a delete rows with variable", "body": "<p>I assume you are not working with table. If that is the case then try this :</p>\n\n<pre><code>Sub KeepOnlyAtSymbolRows()\n\nDim ws As Worksheet\nDim rng As Range\nDim lastRow As Long\n\nSet ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\nlastRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\nSet rng = ws.Range(\"A1:A\" &amp; lastRow)\nApplication.DisplayAlerts = False 'to stop prompting for deletion\nWith rng\n    .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;*International SBU*\"\n    .Offset(1, 0).SpecialCells(xlCellTypeVisible).Delete\nEnd With\nws.AutoFilterMode = False\nApplication.DisplayAlerts = True\nEnd Sub      \n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 31288273, "answer_count": 2, "score": 1, "last_activity_date": 1436371760, "creation_date": 1436345238, "last_edit_date": 1436345538, "question_id": 31287725, "link": "https://stackoverflow.com/questions/31287725/how-to-avoid-subset-out-of-range-when-running-a-delete-rows-with-variable", "title": "How to avoid subset out of range when running a delete rows with variable", "body": "<p>I know this may have been asked in various formats, however I am completely new to coding and don't understand how to apply it to this function.</p>\n\n<p>I keep getting a <strong>subscript out of range error</strong> message when running this vba.</p>\n\n<pre><code>Sub KeepOnlyAtSymbolRows()\n\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim lastRow As Long\n\n    Set ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\n    lastRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\n    Set rng = ws.Range(\"A1:A\" &amp; lastRow)\n\n    With rng\n        .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;*International SBU*\"\n        .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End With\n    ws.AutoFilterMode = False\nEnd Sub\n</code></pre>\n\n<p>For context my sheet at the moment is 178 rows long and goes up to AK however the number of rows will vary each update the number of columns won't</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 3053, "user_id": 1436926, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/X1720.jpg?s=128&g=1", "display_name": "Raghavendra", "link": "https://stackoverflow.com/users/1436926/raghavendra"}, "edited": false, "score": 2, "creation_date": 1436345478, "post_id": 31287672, "comment_id": 50567455, "body": "i think this <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-excel/vba-from-excel-check-if-word-document-is-open/ada09bd0-d1bc-4fca-bfdc-2a8b987e80b1?auth=1\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/office/forum/office_2010-excel/&hellip;</a> will help your problem"}, {"owner": {"reputation": 3053, "user_id": 1436926, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/X1720.jpg?s=128&g=1", "display_name": "Raghavendra", "link": "https://stackoverflow.com/users/1436926/raghavendra"}, "edited": false, "score": 0, "creation_date": 1436345533, "post_id": 31287672, "comment_id": 50567493, "body": "do some research before posting a question"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1436943376, "post_id": 31287672, "comment_id": 50818461, "body": "Zhijie Ying : Did answer helped you? If yes and your problem is solved, please accept answer to mark your question as solved (tick under up/down votes, that&#39;ll become green) and if not let us know where is the issue"}, {"owner": {"reputation": 55, "user_id": 5039763, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fe2f1a32ab8f1b3019b38614bb7b9476?s=128&d=identicon&r=PG&f=1", "display_name": "ZHIJIE YING", "link": "https://stackoverflow.com/users/5039763/zhijie-ying"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1436954632, "post_id": 31287672, "comment_id": 50825517, "body": "@R3uK Hi! It&#39;s indeed helpful. I have accepted your answer. I&#39;m pretty new to this forum so I don&#39;t quite get around with it. Thanks for your information!"}, {"owner": {"reputation": 55, "user_id": 5039763, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fe2f1a32ab8f1b3019b38614bb7b9476?s=128&d=identicon&r=PG&f=1", "display_name": "ZHIJIE YING", "link": "https://stackoverflow.com/users/5039763/zhijie-ying"}, "reply_to_user": {"reputation": 3053, "user_id": 1436926, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/X1720.jpg?s=128&g=1", "display_name": "Raghavendra", "link": "https://stackoverflow.com/users/1436926/raghavendra"}, "edited": false, "score": 0, "creation_date": 1436954684, "post_id": 31287672, "comment_id": 50825554, "body": "@raghavendra Thanks!"}, {"owner": {"reputation": 3053, "user_id": 1436926, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/X1720.jpg?s=128&g=1", "display_name": "Raghavendra", "link": "https://stackoverflow.com/users/1436926/raghavendra"}, "edited": false, "score": 0, "creation_date": 1436954945, "post_id": 31287672, "comment_id": 50825701, "body": "Happy to help thank you :)"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1436349005, "creation_date": 1436349005, "answer_id": 31289106, "question_id": 31287672, "link": "https://stackoverflow.com/questions/31287672/how-to-make-sure-from-excel-that-a-specific-word-document-is-open-or-not/31289106#31289106", "title": "How to make sure from Excel that a specific Word document is open or not?", "body": "<p>Here comes an evolution of what was suggested in comments :</p>\n\n<p>A <strong>function that test if the file is open and offer you to set it directly while testing</strong>.</p>\n\n<p>How to use it :</p>\n\n<pre><code>Sub test()\nDim WdDoc As Word.Document\n\nSet WdDoc = Is_Doc_Open(\"test.docx\", \"D:\\Test\\\")\nMsgBox WdDoc.Content\nWdDoc.Close\nSet WdDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>And the function :</p>\n\n<pre><code>Public Function Is_Doc_Open(FileToOpen As String, FolderPath As String) As Word.Document\n'Will open the doc if it isn't already open and set an object to that doc\nDim wrdApp As Word.Application\nDim wrdDoc As Word.Document\n\nOn Error Resume Next\n'Set wrdApp = GetObject(, \"Word.Application\")\nIf wrdApp Is Nothing Then\n    Set wrdApp = CreateObject(\"Word.Application\")\n    Set wrdDoc = wrdApp.Documents.Open(FolderPath &amp; FileToOpen)\nElse\n    On Error GoTo NotOpen\n    Set wrdDoc = wrdApp.Documents(FileToOpen)\n    GoTo OpenAlready\nNotOpen:\n    Set wrdDoc = wrdApp.Documents.Open(FolderPath &amp; FileToOpen)\nEnd If\n\nOpenAlready:\nOn Error GoTo 0\n\nSet Is_Doc_Open = wrdDoc\n\nSet wrdApp = Nothing\nSet wrdDoc = Nothing\n\nEnd Function\n</code></pre>\n\n<p><strong>Only downside of this, you don't have the reference of the Word application...</strong></p>\n\n<p>Any suggestion/evolution are welcome!</p>\n"}], "owner": {"reputation": 55, "user_id": 5039763, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fe2f1a32ab8f1b3019b38614bb7b9476?s=128&d=identicon&r=PG&f=1", "display_name": "ZHIJIE YING", "link": "https://stackoverflow.com/users/5039763/zhijie-ying"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 1, "accepted_answer_id": 31289106, "answer_count": 1, "score": 1, "last_activity_date": 1436529174, "creation_date": 1436345064, "last_edit_date": 1436529174, "question_id": 31287672, "link": "https://stackoverflow.com/questions/31287672/how-to-make-sure-from-excel-that-a-specific-word-document-is-open-or-not", "title": "How to make sure from Excel that a specific Word document is open or not?", "body": "<p>I wanted my excel macro to create a report by inserting spreadsheet data after Bookmarks I placed in the template word documents. </p>\n\n<p>But I found out that <strong>if the template word document is already open, the macro will crash</strong>, and consequently the template document will be locked as Read-only and no longer accessible by the macro. </p>\n\n<p>Is there a <strong>way to prevent then macro from crashing even if the template word document is already open</strong>? </p>\n\n<p>Below is my code</p>\n\n<pre><code>Set wdApp = CreateObject(\"Word.Application\") 'Create an instance of word\n\nSet wdDoc = wdApp.Documents.Open(ThisWorkbook.Path &amp; \"\\Templates\\Template_Confirmation.docx\") 'Create a new confirmation note\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 3800275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2748dd4b7e0bc2f8c18d13357e6f7cff?s=128&d=identicon&r=PG&f=1", "display_name": "Nadz", "link": "https://stackoverflow.com/users/3800275/nadz"}, "edited": false, "score": 0, "creation_date": 1436415679, "post_id": 31288648, "comment_id": 50605095, "body": "Thanks for the response. I tried it and getting an error in the &quot;if&quot; condition. Object doesnt support this property or method. I tried removing the IF condition and it works fine but it is copying ALL visible cells instead of only the first 10."}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1436425355, "last_edit_date": 1436425355, "creation_date": 1436347718, "answer_id": 31288648, "question_id": 31287418, "link": "https://stackoverflow.com/questions/31287418/excel-vba-selecting-first-visible-row-after-filter/31288648#31288648", "title": "Excel vba Selecting first visible row after filter", "body": "<pre><code>With wbk5.Sheets(\"Consolidated\")\n    .AutoFilterMode = False\n    .Range(\"A1:D1\").AutoFilter\n    .Range(\"A1:D1\").AutoFilter Field:=1, Criteria1:=\"COUNTRY1\"\n    Dim Cols As Range, Rows1 As Range, Counter As Long, RowNum As Long\n    RowNum = 10 'quota of ten\n    'edit that might help\n    Counter = 0\n    '/edit\n    Set Cols = .Columns(\"A:L\") 'columns from where we need data\n    For i = 2 To .Cells.Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious) 'from the second row to the last\n        If .Cells(i, 1).Visible And Counter &lt; RowNum Then 'if it's visible and we haven't filled our quota\n            Counter = Counter + 1 'we're closer to our quota\n            Set Rows1 = .Range(\"2:\" &amp; i) ' we can include this row\n        End If\n    Next i\n    Intersect(Cols, Rows1).SpecialCells(xlCellTypeVisible).Copy 'from selected columns, from selected rows, only visible cells\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 3800275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2748dd4b7e0bc2f8c18d13357e6f7cff?s=128&d=identicon&r=PG&f=1", "display_name": "Nadz", "link": "https://stackoverflow.com/users/3800275/nadz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3453, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436425355, "creation_date": 1436344365, "last_edit_date": 1436344749, "question_id": 31287418, "link": "https://stackoverflow.com/questions/31287418/excel-vba-selecting-first-visible-row-after-filter", "title": "Excel vba Selecting first visible row after filter", "body": "<p>I am trying to filter a list for a specific value \"COUNTRY1\" and then select the first 10 rows below the header (from Row 2 Column A to Row 11 Column L) or (\"A2:L11\") </p>\n\n<p>However because of the filter, the first visible row is not (\"A2\") but is for example (\"A15\").</p>\n\n<p>What I would like to do is point to the first visible row, copy the first 10 rows but only to column L. not the entire row. <BR>Searched some online references but they are quite complicated and with much more details that wasn't helpful. </p>\n\n<p>Any help would be truly appreciated.</p>\n\n<p>Code below:</p>\n\n<pre><code>wbk5.Sheets(\"Consolidated\").Activate\n\nWith wbk5.Sheets(\"Consolidated\")\n    .AutoFilterMode = False\n    .Range(\"A1:D1\").AutoFilter\n    .Range(\"A1:D1\").AutoFilter Field:=1, Criteria1:=\"COUNTRY1\"\n    .Range(\"A2:L11\").Copy\nEnd With\n\nwbk5.Sheets(\"TOP 10-C\").Activate\nwbk5.Sheets(\"TOP 10-C\").Range(\"A6\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}, {"tags": ["arrays", "vba", "compare", "decimal"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5092825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc842606ae262134f8fe58218c3ea19d?s=128&d=identicon&r=PG&f=1", "display_name": "jooiijjooii", "link": "https://stackoverflow.com/users/5092825/jooiijjooii"}, "edited": false, "score": 0, "creation_date": 1436356741, "post_id": 31288316, "comment_id": 50574787, "body": "Well that was an bad example I gave but yes I realised that they are Strings. I tried to converting to Double as you said but then for some reason I lose the dot so 1.234 becomes 1234. How do I solve that?"}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "reply_to_user": {"reputation": 1, "user_id": 5092825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc842606ae262134f8fe58218c3ea19d?s=128&d=identicon&r=PG&f=1", "display_name": "jooiijjooii", "link": "https://stackoverflow.com/users/5092825/jooiijjooii"}, "edited": false, "score": 0, "creation_date": 1436357214, "post_id": 31288316, "comment_id": 50575146, "body": "Maybe you need a different decimal separator. That depends on what country settings are set on your machine. For example in Germany we use a comma as decimal separator. So you would have to use <code>Abs(CDbl(Replace(DataArray1(i), &quot;.&quot;, &quot;,&quot;))) &lt; Abs(CDbl(Replace(DataArray2(i), &quot;.&quot;, &quot;,&quot;)))</code>"}, {"owner": {"reputation": 1, "user_id": 5092825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc842606ae262134f8fe58218c3ea19d?s=128&d=identicon&r=PG&f=1", "display_name": "jooiijjooii", "link": "https://stackoverflow.com/users/5092825/jooiijjooii"}, "edited": false, "score": 0, "creation_date": 1436357972, "post_id": 31288316, "comment_id": 50575754, "body": "That did the job, simple as that. Thank you!!"}], "tags": [], "owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "is_accepted": false, "score": 2, "last_activity_date": 1436346914, "creation_date": 1436346914, "answer_id": 31288316, "question_id": 31287309, "link": "https://stackoverflow.com/questions/31287309/vba-compare-abs-values-not-working/31288316#31288316", "title": "VBA compare Abs() values not working", "body": "<p>are the arrays of String type? Otherwise i couldn't explain why values like 1.0100 even exist. That value should automatically be shown as 1.01</p>\n\n<p>If you are working with Strings then try to convert the values to floats. This could work: <code>Abs(CDbl(DataArray1(i))) &lt; Abs(CDbl(DataArray2(i)))</code></p>\n"}], "owner": {"reputation": 1, "user_id": 5092825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc842606ae262134f8fe58218c3ea19d?s=128&d=identicon&r=PG&f=1", "display_name": "jooiijjooii", "link": "https://stackoverflow.com/users/5092825/jooiijjooii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436346914, "creation_date": 1436344042, "last_edit_date": 1436345771, "question_id": 31287309, "link": "https://stackoverflow.com/questions/31287309/vba-compare-abs-values-not-working", "title": "VBA compare Abs() values not working", "body": "<p>I have two arrays of data where I want to compare every element in both arrays and put the biggest absolute value in an new array. See code below:</p>\n\n<pre><code>If Abs(DataArray1(i)) &lt; Abs(DataArray2(i)) Then\n     NewDataArray(i) = DataArray2(i)\nElse\n     NewDataArray(i) = DataMinArray(i)\nEnd If\n</code></pre>\n\n<p>The probem is that some of the values are decimals and if I compare for example -1.02 and 1.0100 then normaly -1.02 has bigger abs value. In my case my program returns 1.0100 and it happens to all values are not the same length. The longer one is always returned. How could that happen and what is wrong?</p>\n"}, {"tags": ["vba", "excel", "message"], "comments": [{"owner": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1436344271, "post_id": 31287222, "comment_id": 50566696, "body": "you have <code>End Ifs</code> and this is <code>End If</code>"}, {"owner": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1436344353, "post_id": 31287222, "comment_id": 50566755, "body": "your <code>If Range(&quot;C7&quot;).Value &gt; Range(&quot;E7&quot;) Then     End If</code> does absolutly nothing, because you&#39;re closing the <code>if </code> statement instead of closing your first <code>if</code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 1, "creation_date": 1436344834, "post_id": 31287222, "comment_id": 50567070, "body": "@Hearner : I think that the reference of row 7 and 8 are to show that it want this to work on each row, see answer in few secs! ;)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5092735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac57a2966856f5535364432c9a672c7?s=128&d=identicon&r=PG&f=1", "display_name": "NINI", "link": "https://stackoverflow.com/users/5092735/nini"}, "edited": false, "score": 0, "creation_date": 1436346865, "post_id": 31287613, "comment_id": 50568369, "body": "Thank you for your speedy replies."}, {"owner": {"reputation": 1, "user_id": 5092735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac57a2966856f5535364432c9a672c7?s=128&d=identicon&r=PG&f=1", "display_name": "NINI", "link": "https://stackoverflow.com/users/5092735/nini"}, "edited": false, "score": 0, "creation_date": 1436346909, "post_id": 31287613, "comment_id": 50568394, "body": "Private Sub CommandButton1_Click()  &#39; Calculate worksheet  Application.Calculate  Dim ireply As Integer &#39; Perform the test  If Range(&quot;C7&quot;).Value &gt; Range(&quot;E7&quot;).Value Then  &#39; Ask me if Excel needs to keep tracking and assign YES or No  ireply = MsgBox(prompt:=&quot;Security &quot; &amp; Range(&quot;F7&quot;).Value &amp; &quot; Reached target. Stop tracking ?&quot;, Buttons:=vbYesNoCancel, Title:=&quot;Tracking&quot;)  Beep  End If  If ireply = vbYes Then  Range(&quot;B7&quot;).Value = &quot;TRUE&quot;  ElseIf ireply = vbNo Then  Range(&quot;B7&quot;).Value = &quot;FALSE&quot;  End If"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 1, "user_id": 5092735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac57a2966856f5535364432c9a672c7?s=128&d=identicon&r=PG&f=1", "display_name": "NINI", "link": "https://stackoverflow.com/users/5092735/nini"}, "edited": false, "score": 0, "creation_date": 1436347326, "post_id": 31287613, "comment_id": 50568687, "body": "What is that code for? Did mine solved your problem? (did you see where to place it?)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1436344906, "creation_date": 1436344906, "answer_id": 31287613, "question_id": 31287222, "link": "https://stackoverflow.com/questions/31287222/message-box-pop-up/31287613#31287613", "title": "Message box pop up", "body": "<p>To make this possible directly when you input data into Excel, you'll need to place this into the sheet module of the sheet that you want it to work on :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim iReply As Integer\n\nIf Target.Count &gt; 1 Then Exit Sub\n\nIf Application.Intersect(Target, Columns(3)) Is Nothing Then\nElse\n    If Range(\"C\" &amp; Target.Row).Value &gt; Range(\"E\" &amp; Target.Row).Value Then\n        Beep\n        iReply = MsgBox(\"Price\" &amp; Range(\"F\" &amp; Target.Row).Value &amp; \" Reached target. Stop tracking ?\", vbOKCancel + vbCritical, \"Tracking\")\n        If iReply &lt;&gt; vbCancel Then\n            Range(\"B\" &amp; Target.Row).Value = \"TRUE\"\n        Else\n            Range(\"B\" &amp; Target.Row).Value = \"FALSE\"\n        End If\n    Else\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5092735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac57a2966856f5535364432c9a672c7?s=128&d=identicon&r=PG&f=1", "display_name": "NINI", "link": "https://stackoverflow.com/users/5092735/nini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 649, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488362934, "creation_date": 1436343849, "last_edit_date": 1488362934, "question_id": 31287222, "link": "https://stackoverflow.com/questions/31287222/message-box-pop-up", "title": "Message box pop up", "body": "<p>I need to build a code to give me a pop up message if the value of a cell (Price) is bigger than another cell (Target). \n<strong>If PRICE > TARGET then pop up a window</strong> (ideally with sound). </p>\n\n<p>Also if <strong>I hit ok</strong> i need to <strong>register \"true\"</strong> to another cell or if i hit <strong>cancel</strong> insert to a cell <strong>FALSE</strong></p>\n\n<p>My FIRST vba code so please show some understanding, Thanks a lot in advance.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nSub userinput()\n\nDim ireply As Integer\n\nIf Range(\"C6\").Value &gt; Range(\"E6\").Value Then\n\nireply = MsgBox(prompt:=\"Price\" &amp; Range(\"F6\").Value &amp; \" Reached target. Stop tracking ?\", Buttons:=vbYesNoCancel, Title:=\"Tracking\")\n\nIf ireply = vbYes Then\n\nRange(\"B6\").Value = \"TRUE\"\n\nElseIf ireply = vbNo Then\n\nRange(\"B6\").Value = \"FALSE\"\n\nEnd Ifs\n\nIf Range(\"C7\").Value &gt; Range(\"E7\") Then\n\nEnd If\n\nIf Range(\"C8\").Value &gt; Range(\"E8\") Then\n\nEnd If\n\nExit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "edited": false, "score": 1, "creation_date": 1436343226, "post_id": 31286667, "comment_id": 50566017, "body": "I not sure what problem are you facing? Could you show what had you tried?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1436343410, "post_id": 31286667, "comment_id": 50566128, "body": "This can be done numerous ways. At least post what you&#39;ve tried so we can narrow your issues. As is, this question is quite broad."}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1436343732, "post_id": 31286667, "comment_id": 50566331, "body": "another question is is your date always sorted?I mean is it always like &quot;AAA,AAA,AAA,BBB,BBB,BBB&quot; or can it be &quot;AAA,AAA,BBB,AAA,BBB,BBB&quot;?"}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 0, "creation_date": 1436345365, "post_id": 31286667, "comment_id": 50567389, "body": "sorted. i don&#39;t know how to split"}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 0, "creation_date": 1436358837, "post_id": 31286667, "comment_id": 50576434, "body": "i don&#39;t know how to make the code. that&#39;s why..."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 3, "creation_date": 1436518475, "post_id": 31286667, "comment_id": 50657332, "body": "What do you want to happen if the workbook AAA already exsists"}], "answers": [{"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 2, "last_activity_date": 1436521174, "creation_date": 1436521174, "answer_id": 31337508, "question_id": 31286667, "link": "https://stackoverflow.com/questions/31286667/split-a-single-workbook-into-multiple-workbooks-containing-multiple-worksheets-u/31337508#31337508", "title": "Split a single workbook into multiple workbooks containing multiple worksheets using Excel VBA", "body": "<p>Try below, below should sort your data into the correct sheets/workbooks and create you a chart for each sheet. f_Path is the file path of where you will save these files. if the files already exist the code will SKIP THESE</p>\n\n<pre><code>Sub main()\nDim f_Path\nf_Path = \"C:\\\" 'Filepath to save files to\n\nWith ActiveSheet 'run on activesheet\n    If .Cells(2, 1).Value &lt;&gt; \"\" Then 'if A2 not blank\n        For Each cell In .Range(\"A2:\" &amp; .Range(\"A2\").End(xlDown).Address)\n            If Dir(f_Path &amp; cell.Value &amp; \".xls\") &lt;&gt; \"\" Then\n                'exists\n                If IsWorkBookOpen(f_Path &amp; cell.Value &amp; \".xls\") Then\n                     'open\n                Else\n                    GoTo Skipper 'not open\n                End If\n                Workbooks(cell.Value &amp; \".xls\").Activate\n\n                On Error Resume Next\n                Sheets(cell.Offset(0, 1).Value).Select\n                If Err.Number &lt;&gt; 0 Then\n                    Worksheets.Add().Name = cell.Offset(0, 1).Value\n                End If\n                On Error GoTo 0\n                lastrow = ActiveSheet.Range(\"A1\").End(xlDown).Row - 1\n                If lastrow = 1048575 Then 'First time\n                    With ActiveSheet\n                        .Range(\"A1\").Value = \"Levels\"\n                        .Range(\"B1\").Value = \"Chart_Value1\"\n                        .Range(\"C1\").Value = \"Chart_Value2\"\n                        .Range(\"D1\").Value = \"Chart_Value3\"\n                        .Range(\"A2\").Value = cell.Offset(0, 2).Value\n                        .Range(\"B2\").Value = cell.Offset(0, 3).Value\n                        .Range(\"C2\").Value = cell.Offset(0, 5).Value\n                        .Range(\"D2\").Value = cell.Offset(0, 7).Value\n                    End With\n                Else\n                    With ActiveSheet\n                        .Range(\"A2\").Offset(0 + lastrow, 0).Value = cell.Offset(0, 2).Value\n                        .Range(\"B2\").Offset(0 + lastrow, 0).Value = cell.Offset(0, 3).Value\n                        .Range(\"C2\").Offset(0 + lastrow, 0).Value = cell.Offset(0, 5).Value\n                        .Range(\"D2\").Offset(0 + lastrow, 0).Value = cell.Offset(0, 7).Value\n                    End With\n                End If\n                ActiveWorkbook.Save\n            Else\n                'does not\n                Set wb = Workbooks.Add(xlWBATWorksheet)\n                With ActiveSheet\n                    .Name = cell.Offset(0, 1).Value\n                    .Range(\"A1\").Value = \"Levels\"\n                    .Range(\"B1\").Value = \"Chart_Value1\"\n                    .Range(\"C1\").Value = \"Chart_Value2\"\n                    .Range(\"D1\").Value = \"Chart_Value3\"\n                    .Range(\"A2\").Value = cell.Offset(0, 2).Value\n                    .Range(\"B2\").Value = cell.Offset(0, 3).Value\n                    .Range(\"C2\").Value = cell.Offset(0, 5).Value\n                    .Range(\"D2\").Value = cell.Offset(0, 7).Value\n                End With\n                ActiveWorkbook.SaveAs f_Path &amp; cell.Value &amp; \".xls\", 56\n            End If\nSkipper:\n        Next\n    End If\nEnd With\n\nFor Each wb In Workbooks\n    If ThisWorkbook.Name &lt;&gt; wb.Name Then\n        For Each ws In wb.Worksheets\n            With ws\n                Set Rng = ws.UsedRange\n                ws.Shapes.AddChart\n            End With\n        Next\n        wb.Close True\n    End If\nNext\n\nEnd Sub\n\nFunction IsWorkBookOpen(FileName As String)\n    Dim ff As Long, ErrNo As Long\n\n    On Error Resume Next\n    ff = FreeFile()\n    Open FileName For Input Lock Read As #ff\n    Close ff\n    ErrNo = Err\n    On Error GoTo 0\n\n    Select Case ErrNo\n    Case 0:    IsWorkBookOpen = False\n    Case 70:   IsWorkBookOpen = True\n    Case Else: Error ErrNo\n    End Select\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": true, "score": 1, "last_activity_date": 1436600869, "creation_date": 1436600869, "answer_id": 31354770, "question_id": 31286667, "link": "https://stackoverflow.com/questions/31286667/split-a-single-workbook-into-multiple-workbooks-containing-multiple-worksheets-u/31354770#31354770", "title": "Split a single workbook into multiple workbooks containing multiple worksheets using Excel VBA", "body": "<p>The following code will parse the data in first two columns create workbooks for each unique cell value from first column and sheet for each unique cell value from second column. It finally adds charts of type <code>xlColumnClustered</code> and saves and closes all the new books. Source data can be <code>un-sorted</code>.</p>\n\n<p><strong>Important</strong>: <em>change the constants <code>TargetPath</code> and/or <code>DataBookName, DataSheetName</code> according to your conditions.</em></p>\n\n<pre><code>Option Explicit\n\n' ---------------------------------------------------------------------------------------\n' Results will be saved 'TargetPath' path. This path must be changed according to your PC\n' Change this path:\nPrivate Const TargetPath As String = \"C:\\Temp\\Abdul_Shiyas\\Results\\\"\n' ---------------------------------------------------------------------------------------\n\n' ---------------------------------------------------------------------------------------\n' Expected data are contain in sheet named \"Data\" in wokbook with the name \"Data.xlsx\"\n' This names can be changed according to your wokbook with data.\nPrivate Const DataBookName As String = \"Data.xlsx\"\nPrivate Const DataSheetName As String = \"Data\"\n' ---------------------------------------------------------------------------------------\n\nPrivate sourceBook As Workbook\nPrivate sht As Worksheet\nPrivate book As Workbook\nPrivate books As Collection\nPrivate header As Range\nPrivate data As Range\nPrivate criteria As Range\nPrivate criteriaRow As Range\nPrivate bookName As String\nPrivate sheetName As String\nPrivate newChart As Shape\n\nPublic Sub ParseToWorkbooks()\n\n    ' Important:\n    ' Data are expected to begin in cell \"A1\" and should not contain any blank rows or blank columns\n    Set sourceBook = Workbooks(DataBookName)\n    Set data = sourceBook.Worksheets(DataSheetName).Range(\"A1\").CurrentRegion\n    Set header = data.Rows(1)\n    Set data = data.Offset(1, 0).Resize(data.Rows.Count - 1, data.Columns.Count)\n    Set criteria = data.Resize(data.Rows.Count, 2)\n    Set header = header.Offset(0, criteria.Columns.Count).Resize(1, header.Columns.Count - criteria.Columns.Count)\n    Set books = New Collection\n\n    For Each criteriaRow In criteria.Rows\n        bookName = Trim(criteriaRow.Cells(1))\n        sheetName = Trim(criteriaRow.Cells(2))\n\n        ' get the book first\n        Set book = Nothing\n        On Error Resume Next\n        Set book = books(bookName)\n        On Error GoTo 0\n\n        If book Is Nothing Then\n            Set book = Workbooks.Add\n            Application.DisplayAlerts = False\n            book.SaveAs Filename:=TargetPath &amp; bookName\n            Application.DisplayAlerts = True\n            books.Add book, bookName\n        End If\n\n        ' get the sheet then\n        Set sht = Nothing\n        On Error Resume Next\n        Set sht = book.Worksheets(sheetName)\n        On Error GoTo 0\n\n        If sht Is Nothing Then\n            Set sht = book.Worksheets.Add\n            sht.Name = sheetName\n            header.Copy Destination:=sht.Range(\"A1\")\n        End If\n\n        ' paste data to the sheet\n        criteriaRow.Cells(2).Offset(0, 1).Resize(1, data.Columns.Count - criteria.Columns.Count).Copy _\n            Destination:=sht.Cells(sht.Rows.Count, 1).End(xlUp).Offset(1, 0)\n\n    Next criteriaRow\n\n    ' finally and chart, save and close each new book\n    For Each book In books\n        For Each sht In book.Worksheets\n            If sht.Range(\"A1\").Value &lt;&gt; \"\" Then\n                Set newChart = sht.Shapes.AddChart\n                newChart.Chart.SetSourceData Source:=sht.Range(\"A1\").CurrentRegion\n                newChart.Chart.ChartType = xlColumnClustered\n            End If\n        Next sht\n\n        book.Close True\n    Next book\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1045, "favorite_count": 1, "accepted_answer_id": 31354770, "answer_count": 2, "score": 2, "last_activity_date": 1436600869, "creation_date": 1436342073, "question_id": 31286667, "link": "https://stackoverflow.com/questions/31286667/split-a-single-workbook-into-multiple-workbooks-containing-multiple-worksheets-u", "title": "Split a single workbook into multiple workbooks containing multiple worksheets using Excel VBA", "body": "<p>I have a workbook with single worksheet as given below.\n<img src=\"https://i.stack.imgur.com/WlPut.jpg\" alt=\"enter image description here\"></p>\n\n<p>I want to split it into many workbooks containing many worksheets according to the values in it.\nI want to make 'n' number of workbooks according to 'n' unique values of column 1 as in the picture. And I want to make 'm' worksheets according to 'm' unique values of column 2 as in the picture. \n<img src=\"https://i.stack.imgur.com/dFTTj.jpg\" alt=\"enter image description here\">\n<img src=\"https://i.stack.imgur.com/JP018.jpg\" alt=\"enter image description here\"></p>\n\n<p>Each worksheet contains values as in the picture.\nActually I want to make a chart with 3 series. So I have to make data table as in the picture with columns 'levels', 'chart_vlaue_1', 'chart_vlaue_2', 'chart_vlaue_3' in each worksheet. \nAlso I want to generate charts in each of the worksheet.\nPlease help me a create a sample chart. I will work on it.\nPlease help me.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "edited": false, "score": 0, "creation_date": 1436362450, "post_id": 31293695, "comment_id": 50579242, "body": "Hi Newd, thank you so much for your answer. I made it a bit different because the whole Form should listen to keypresses and i didn&#39;t want to have another public variables, but your answer helped me solve my problem. Thank you :)"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "edited": false, "score": 0, "creation_date": 1436366208, "post_id": 31293695, "comment_id": 50582395, "body": "@Dorian No problem.  After reviewing your answer history I figured you knew how to handle it once you got past the roadblock of how to tell if you hit the end of the textbox.  It was a very interesting question."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "edited": false, "score": 0, "creation_date": 1436367067, "post_id": 31293695, "comment_id": 50583113, "body": "@Dorian Also, could you post your finalized code, I am interested in reading it."}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "edited": false, "score": 0, "creation_date": 1436367455, "post_id": 31293695, "comment_id": 50583434, "body": "the code is too Long to post it as a comment, so i will add another answer."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "reply_to_user": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "edited": false, "score": 0, "creation_date": 1436367486, "post_id": 31293695, "comment_id": 50583451, "body": "@Dorian even if you want to just edit your main post and throw it in there as an <code>Update</code>."}], "tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": true, "score": 1, "last_activity_date": 1436361299, "last_edit_date": 1436361299, "creation_date": 1436360953, "answer_id": 31293695, "question_id": 31286545, "link": "https://stackoverflow.com/questions/31286545/access-vba-check-if-the-cursor-in-a-textbox-is-in-the-first-or-last-line/31293695#31293695", "title": "Access-VBA check if the cursor in a Textbox is in the first or last line", "body": "<p>I don't currently have the time to write this code out in full to incorporate your code as well.  However I think if you were able to get to the point you are at right now you should be able to utilize it.  </p>\n\n<p>Basically it is just a way to tell if the user has hit the end or beginning of the Multi-line textbox.</p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>Public intOnDown As Integer\nPublic intOnUp As Integer\n\n'When the user presses key down\nPrivate Sub txtProjekt_KeyDown(KeyCode As Integer, Shift As Integer)\n\n    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then\n        'Save the cursor position\n        intOnDown = txtProjekt.SelStart\n    End If\n\nEnd Sub\n\n'When the user lets go of the key\nPrivate Sub txtProjekt_KeyUp(KeyCode As Integer, Shift As Integer)\n\n    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then\n        If intOnDown - txtProjekt.SelStart = 0 Then 'If the SelStart is the same\n            Debug.Print \"Pointer hasn't moved so must be at the end or beginning\"\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>With the above code you listen for when the user has pressed the up or down key on <code>Keydown</code> then you listen again on <code>KeyUp</code> (When they let go of the key). Then you check to see if the <code>SelStart</code> has changed.  If it hasn't then it must mean they are at the beginning or the end of the field and you can perform the record switching. </p>\n\n<p><strong>Note:</strong> Adjust accordingly if you have memo fields that are going to be over the max <code>integer</code> size by changing to a <code>long</code> and you probably want to have error handling for it regardless. </p>\n"}], "owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 977, "favorite_count": 0, "accepted_answer_id": 31293695, "answer_count": 1, "score": 1, "last_activity_date": 1436367908, "creation_date": 1436341660, "last_edit_date": 1436367908, "question_id": 31286545, "link": "https://stackoverflow.com/questions/31286545/access-vba-check-if-the-cursor-in-a-textbox-is-in-the-first-or-last-line", "title": "Access-VBA check if the cursor in a Textbox is in the first or last line", "body": "<p><strong>The Goal:</strong> I've got an Access database with a continuous form and I want to add the functionality that you can go to the next or previous record by pressing the up- or down-arrow. </p>\n\n<p><strong>The Problem:</strong> I've got a multiline TextBox named <code>txtProjekt</code> and I want the database to check if the TextBox is filled with multi-lined text and only jump to the next record if the cursor is in the last line of the TextBox.  Likewise I want it to only jump to the previous record if the cursor is in the first line of the TextBox. </p>\n\n<p>I can only check the current cursor position with <code>SelStart</code>, but I can't find out in which line the cursor is. </p>\n\n<p>Do you have any ideas?</p>\n\n<p><strong>Current code:</strong></p>\n\n<pre><code>Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)\nOn Error GoTo err_Form_KeyDown\n\nIf Me.ActiveControl.Name = \"txtProjekt\" Then\n    If Not (Me.txtProjekt.SelStart = 0 And Me.txtProjekt.SelLength = Len(Me.txtProjekt.Text)) Then\n        GoTo exit_Form_KeyDown\n    End If\nEnd If\n\nIf KeyCode = vbKeyUp Then\n    DoCmd.GoToRecord acActiveDataObject, Record:=acPrevious\n    KeyCode = 0\nElseIf KeyCode = vbKeyDown Then\n    DoCmd.GoToRecord acActiveDataObject, Record:=acNext\n    KeyCode = 0\nEnd If\n\nexit_Form_KeyDown:\nExit Sub\n\nerr_Form_KeyDown:\nMsgBox Err.description\nResume exit_Form_KeyDown\nEnd Sub\n</code></pre>\n\n<p>edit:\n<strong>The Result</strong> (thanks to @Newd):</p>\n\n<p>(be sure to active KeyPreview in your Form, otherwise it won't do anything)</p>\n\n<pre><code>Private Sub Form_KeyUp(KeyCode As Integer, Shift As Integer)\nOn Error GoTo err_Form_KeyUp\n\nIf Shift = False Then\n    keyAction KeyCode, True\nEnd If\n\nexit_Form_KeyUp:\nExit Sub\n\nerr_Form_KeyUp:\nMsgBox Err.description\nResume exit_Form_KeyUp\nEnd Sub\n\nPrivate Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)\nOn Error GoTo err_Form_KeyDown\nDim curPos As Integer\n\nIf Shift = False Then\n    keyAction KeyCode, False\nEnd If\n\nexit_Form_KeyDown:\nExit Sub\n\nerr_Form_KeyDown:\nMsgBox Err.description\nResume exit_Form_KeyDown\nEnd Sub\n\nPrivate Sub keyAction(KeyCode As Integer, KeyUp As Boolean)\nOn Error GoTo err_keyAction\nStatic curPos As Long\n\nIf KeyUp = False Then\n    If Me.ActiveControl.Name = \"txtProjekt\" Then\n        If Not (Me.txtProjekt.SelStart = 0 And Me.txtProjekt.SelLength = Len(Me.txtProjekt.Text)) Then\n            curPos = Me.txtProjekt.SelStart\n            GoTo exit_keyAction\n        End If\n    End If\nElse\n    If Me.ActiveControl.Name = \"txtProjekt\" Then\n        If curPos &gt;= 0 Then\n            If Me.txtProjekt.SelStart &lt;&gt; curPos Then\n                GoTo exit_keyAction\n            End If\n            curPos = -1\n        Else\n            GoTo exit_keyAction\n        End If\n    End If\nEnd If\n\nIf KeyCode = vbKeyUp Then\n    DoCmd.GoToRecord acActiveDataObject, Record:=acPrevious\n    KeyCode = 0\nElseIf KeyCode = vbKeyDown Then\n    DoCmd.GoToRecord acActiveDataObject, Record:=acNext\n    KeyCode = 0\nEnd If\n\n\nexit_keyAction:\nExit Sub\n\nerr_keyAction:\nMsgBox Err.description\nResume exit_keyAction\nEnd Sub\n</code></pre>\n\n<p>(I know, all those <code>GoTo Exit_keyAction</code> is bad style, so don't copy too much from me)</p>\n"}, {"tags": ["excel", "vba", "powerpoint-2010"], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1436350986, "creation_date": 1436350986, "answer_id": 31289858, "question_id": 31286505, "link": "https://stackoverflow.com/questions/31286505/create-a-chart-from-excel-vba-to-powerpoint-and-link-the-source-to-a-specific-ta/31289858#31289858", "title": "Create a chart from Excel VBA to PowerPoint and link the source to a specific table in Excel", "body": "<p>As a work-around to doing this in VBA, have you thought about using linked objects from excel to powerpoint?</p>\n\n<p>You can create the graph in your workbook, and then copy the graph and paste it into powerpoint by doing the following:</p>\n\n<ol>\n<li>Powerpoint -> home ribbon -> clipboard.</li>\n<li>Click drop down arrow -> paste special.</li>\n<li>Click 'Paste link'.</li>\n<li>Click OK.</li>\n</ol>\n\n<p>You will now have a chart linked to the chart in your workbook. This will update whenever you manually refresh the chart (right click -> update link) or when you open the powerpoint presentation.</p>\n\n<p>Documentation can be found on the <a href=\"https://support.office.com/en-us/article/Import-data-from-Excel-into-PowerPoint-3ec295e9-1bfd-47ff-8d7d-8b838caef853#__insert_a_linked\" rel=\"nofollow\">office website</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 5092569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c6ef06fffe3af44b80ada9179a2e42?s=128&d=identicon&r=PG&f=1", "display_name": "ZeLegend", "link": "https://stackoverflow.com/users/5092569/zelegend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 990, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1436350986, "creation_date": 1436341583, "last_edit_date": 1436345525, "question_id": 31286505, "link": "https://stackoverflow.com/questions/31286505/create-a-chart-from-excel-vba-to-powerpoint-and-link-the-source-to-a-specific-ta", "title": "Create a chart from Excel VBA to PowerPoint and link the source to a specific table in Excel", "body": "<p>I would like to:</p>\n\n<p>Create a chart in PowerPoint from VBA Excel\nLink the data source to a range I have in my Excel file\nOr replace the worksheet where PowerPoint store the data source by my data</p>\n\n<p>I am a beginner in VBA (one week trying to learn)</p>\n\n<p>I do this:</p>\n\n<pre><code>Dim ChartDataRange As Excel.Range\nDim myWorksheet As Worksheet\nSet ChartDataRange = Excel.Range(\"Chart_Data_Range\")\nDim ChartRelativePerfBox As PowerPoint.Shape\n\n'Now open PowerPoint\nDim pptApp As New PowerPoint.Application\n\n'Keep it visible because we need to see it and be able to save it\npptApp.Visible = True\n\n'Tell VBA that FinancialSlide is a PowerPoint presentation\nDim FinancialSlide As PowerPoint.Presentation\n\n'Add new presentation\nSet FinancialSlide = pptApp.Presentations.Add\n\n'Tell VBA that firstslide is a PowerPoint slide\nDim Slide1 As PowerPoint.Slide\n\n'Create the first slide\nSet Slide1 = FinancialSlide.Slides.Add(1,PowerPoint.PpSlideLayout.ppLayoutBlank)\n\nSet ChartRelativePerfBox = Slide1.Shapes.AddChart( _\n    Type:=xlLine, _\n    Left:=Application.CentimetersToPoints(12.95), _\n    Top:=Application.CentimetersToPoints(12.6), _\n    Width:=Application.CentimetersToPoints(11.45), _\n    Height:=Application.CentimetersToPoints(5.5))\nSet myWorksheet = ChartRelativePerfBox.Chart.ChartData.Workbook.Worksheet(1)\n\n'Replace data source in the worksheet by desired data\nApplication.DisplayAlerts = False\n'Copy desired data\nChartDataRange.Copy\n'Paste them in the chart worksheet\nmyWorksheet.Range(\"A1\").PasteSpecial (xlPasteValuesAndNumberFormats)\n'Delete extra columns in worksheet\nmyWorksheet.Columns(\"D:E\").Select\nSelection.Delete\n'Resize to used range\nmyWorksheet.ListObjects(\"Table1\").Resize myWorksheet.UsedRange\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>I tried to use:</p>\n\n<pre><code>Set ChartRelativePerfBox.SetSourceData( _\nSource:= ChartDataRange, _\nPlotBy:= xlLine)\n</code></pre>\n\n<p>But it doesn't work. Any guess?</p>\n\n<p>My previous code works but it is so slow..</p>\n"}, {"tags": ["excel", "error-handling", "find", "vba"], "comments": [{"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1436339591, "post_id": 31285648, "comment_id": 50563800, "body": "Can you post the full code(including declarations of variables), not just a <i>piece</i> of it...?"}], "answers": [{"comments": [{"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 1, "creation_date": 1436340578, "post_id": 31285903, "comment_id": 50564422, "body": "<code>isnothing(rFoundCell)</code> was what i found on google, but obvisoly the syntax was <code>rFoundCell is Nothing</code> Now the code work flawless, it copys cells from another workbook if it can not be found in the active one. thanks  @user3819867"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": 1, "last_activity_date": 1436339823, "creation_date": 1436339823, "answer_id": 31285903, "question_id": 31285648, "link": "https://stackoverflow.com/questions/31285648/using-the-find-method-in-excel/31285903#31285903", "title": "Using the find method in excel", "body": "<p>Since <code>rFoundCell</code> is <code>Nothing</code> it doesn't have a <code>.Row</code> property.<br>\n<code>If rFoundCell Is Nothing</code> seems to be more convenient for handling, but in real life situations I wouldn't use handling, the dependent procedure should be based on an <code>If Not rFoundCell Is Nothing Then</code> criterium.</p>\n\n<pre><code>For rCount = Settings.rowHeaderTempFile + 1 To lRow2\n    Set rFoundCell = Range(\"A\" &amp; Settings.rowHeader + 1)\n    Set rFoundCell = ws.Columns(1).Find(What:=ws2.Cells(rCount,\n                     partNumberWs2).Value, After:=rFoundCell, \n                     LookIn:=xlValues, LookAt:=xlPart, \n                     SearchOrder:=xlByRows, SearchDirection:=xlNext,\n                     MatchCase:=False)\nIf Not rFoundCell Is Nothing Then\n    'do stuff\nElse\n    lRow = lRow + 1\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 31285903, "answer_count": 1, "score": 0, "last_activity_date": 1436339823, "creation_date": 1436339026, "last_edit_date": 1531164843, "question_id": 31285648, "link": "https://stackoverflow.com/questions/31285648/using-the-find-method-in-excel", "title": "Using the find method in excel", "body": "<p>I am struggling to figure out how to figure out if the search string is not found in excel, i tried </p>\n\n<pre><code>isnothing(rFoundCell)\n</code></pre>\n\n<p>but this does not work, says method can not be found</p>\n\n<p>and the iserror also does not work</p>\n\n<pre><code>   For rCount = Settings.rowHeaderTempFile + 1 To lRow2\n    Set rFoundCell = Range(\"A\" &amp; Settings.rowHeader + 1)\n    Set rFoundCell = ws.Columns(1).Find(What:=ws2.Cells(rCount,\n                     partNumberWs2).Value, After:=rFoundCell, \n                     LookIn:=xlValues, LookAt:=xlPart, \n                     SearchOrder:=xlByRows, SearchDirection:=xlNext,\n                     MatchCase:=False)\n\n    If IsError(rFoundCell.Row) Then ' fails here\n        lRow = lRow + 1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436340626, "post_id": 31285575, "comment_id": 50564453, "body": "Thanks for the reply. Can you be a bit more clear where to include this function? I am a bit confused what to remove and add and how the final code will look like."}, {"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "reply_to_user": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436340984, "post_id": 31285575, "comment_id": 50564682, "body": "please see Edit above"}, {"owner": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436341363, "post_id": 31285575, "comment_id": 50564916, "body": "It is showing Subscript out of range error now on this line:                                           .AutoFilter.Range.Copy Sheets(rng).Range(&quot;A1&quot;). However when I change rng to rng.text in this line, it says can&#39;t rename a sheet to same name as another sheet. I don&#39;t know where is it going wrong."}, {"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "reply_to_user": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436341639, "post_id": 31285575, "comment_id": 50565091, "body": "Please try updated code - you will need to change the sheet name every where you use it so it is consistent. Also are the cells you are using for sheet name non-blank?"}, {"owner": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436341823, "post_id": 31285575, "comment_id": 50565200, "body": "As you can see in the screenshot: <a href=\"http://bit.ly/1CoHV5j\" rel=\"nofollow noreferrer\">bit.ly/1CoHV5j</a>. My ultimate aim is to separate the data month wise in different sheets whose name would be same as the data of the month they would be containing. So, it is finding unique months from &#39;H&#39; column and using them to rename the sheets"}, {"owner": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "edited": false, "score": 0, "creation_date": 1436446611, "post_id": 31285575, "comment_id": 50623518, "body": "Hi Sir, I did not see your edit earlier. Anyway, I tried running it but it is showing subscript out of range error on: .AutoFilter.Range.Copy Sheets(SheetName).Range(&quot;A1&quot;)."}], "tags": [], "owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "is_accepted": false, "score": 1, "last_activity_date": 1436341591, "last_edit_date": 1436341591, "creation_date": 1436338782, "answer_id": 31285575, "question_id": 31285182, "link": "https://stackoverflow.com/questions/31285182/creating-worksheets-based-on-unique-values/31285575#31285575", "title": "Creating worksheets based on unique values", "body": "<p>the text in some of the cells may have reserved characters... can you try the below, replace the sheeets.add bit with cleaned up string</p>\n\n<p>PS: You should also make sure the cell you are using as a name is not empty</p>\n\n<p>Full Code should look like something below</p>\n\n<pre><code>Sub x()\n    Dim rng As Range\n    Dim SheeetName as string    \n    With ActiveSheet\n    .AutoFilterMode = False\n    Sheets.Add().Name = \"Temp\"\n    .Range(\"H2\", .Range(\"H2\").End(xlDown)).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Sheets(\"Temp\").Range(\"A1\"), Unique:=True\n    For Each rng In Sheets(\"Temp\").UsedRange.Offset(1).Resize(Sheets(\"Temp\").UsedRange.Rows.Count - 1)\n        .Range(\"A1\").CurrentRegion.AutoFilter field:=8, Criteria1:=rng\n        SheeetName = GetGoodSheetName(rng.Text)\n        Sheets.Add(After:=Sheets(Sheets.Count)).Name = SheeetName\n        .AutoFilter.Range.Copy Sheets(SheetName).Range(\"A1\")\n\n    Next rng\n\n    .AutoFilterMode = False\n    Application.DisplayAlerts = False\n    Sheets(\"Temp\").Delete\n    Application.DisplayAlerts = True\n    End With\nEnd Sub\n\nFunction GetGoodSheetName(fromName As String) As String\n    Dim objRegex As Object\n    Set objRegex = CreateObject(\"vbscript.regexp\")\n    With objRegex\n        .Global = True\n        .Pattern = \"[\\&lt;\\&gt;\\*\\\\\\/\\?|]\"\n        GetGoodSheetName = .Replace(fromName, \"_\")\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 5088737, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d3f44d5803e252b21f938d8cc0ea74ec?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Lad", "link": "https://stackoverflow.com/users/5088737/curious-lad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1436341672, "creation_date": 1436337453, "last_edit_date": 1436341672, "question_id": 31285182, "link": "https://stackoverflow.com/questions/31285182/creating-worksheets-based-on-unique-values", "title": "Creating worksheets based on unique values", "body": "<p>I have a data set sorted date wise and I want to copy the data based on month, i.e, data of each month to be copied to a new worksheet and the name of sheet would be the name of month present. \nData set:\n<a href=\"http://bit.ly/1CoHV5j\" rel=\"nofollow\">http://bit.ly/1CoHV5j</a> </p>\n\n<p>I tried running the following code: </p>\n\n<pre><code>Sub x()\nDim rng As Range\n\nWith ActiveSheet\n    .AutoFilterMode = False\n    Sheets.Add().Name = \"Temp\"\n    .Range(\"H2\", .Range(\"H2\").End(xlDown)).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Sheets(\"Temp\").Range(\"A1\"), Unique:=True\n\n    For Each rng In Sheets(\"Temp\").UsedRange.Offset(1).Resize(Sheets(\"Temp\").UsedRange.Rows.Count - 1)\n        .Range(\"A1\").CurrentRegion.AutoFilter field:=8, Criteria1:=rng\n        Sheets.Add(After:=Sheets(Sheets.Count)).Name = rng.Text\n        .AutoFilter.Range.Copy Sheets(rng).Range(\"A1\")\n\n    Next rng\n\n    .AutoFilterMode = False\n    Application.DisplayAlerts = False\n    Sheets(\"Temp\").Delete\n    Application.DisplayAlerts = True\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>But this error keeps coming up:</p>\n\n<p>\"You typed an invalid name for a sheet or chart. Make sure that:\nThe name that you type does not exceed 31 charaters\nThe name does not contain any of thefollowing characters: \\ / ? * [ or ]\nYou do not leave the name blank</p>\n\n<p>Kindly help and tell me where I am going wrong.</p>\n"}, {"tags": ["arrays", "vba", "excel", "multidimensional-array"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1436339134, "post_id": 31285020, "comment_id": 50563518, "body": "Do you need up to six dimensions or do you simply need a two dimensional array with a second rank that is 1 to 6? i.e. redim myArr(1 to 99, 1 to 6) or redim myArr(1 to 9, 1 to 9, 1 to 9, 1 to 9, 1 to 9, 1 to 9)"}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1436339174, "post_id": 31285020, "comment_id": 50563544, "body": "&quot;construct the Redim statement at runtime as a string and execute the string&quot; : This kind of delegation type execution is not possible in VBA. &quot;varying number of dimensions&quot; : So you want to change a single D array to multi D and then change back and forth or continue to change  multi D?"}], "answers": [{"comments": [{"owner": {"reputation": 1240, "user_id": 2775089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b6c629064ce9063f5e65448ed8f0d3?s=128&d=identicon&r=PG&f=1", "display_name": "Q---ten", "link": "https://stackoverflow.com/users/2775089/q-ten"}, "edited": false, "score": 0, "creation_date": 1436411637, "post_id": 31285739, "comment_id": 50604047, "body": "I think you understand the problem correctly. I&#39;ve found that it&#39;s actually possible to do something with variant arrays of variant arrays, but it&#39;s even more hideous than using case statements. One of the problems (that I really should have realised initially) is that if it&#39;s hard to dimension an array with variable dimensions, it will be hard to index into it - even if you know what the indices are. I am going to use the approach suggested here with a fixed max number of dimensions as it will be the cleanest solution."}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": true, "score": 1, "last_activity_date": 1436346389, "last_edit_date": 1495541646, "creation_date": 1436339335, "answer_id": 31285739, "question_id": 31285020, "link": "https://stackoverflow.com/questions/31285020/redim-variable-number-of-dimensions-in-vba/31285739#31285739", "title": "Redim variable number of dimensions in VBA", "body": "<p>I'm pretty sure there is no way of doing this in a single <code>ReDim</code> statement.  <code>Select Case</code> may be marginally neater than \"a bunch of <code>If...Else</code> blocks\", but you're still writing out a lot of separate <code>ReDim</code>s.</p>\n\n<p>Working with arrays in VBA where you don't know in advance how many dimensions they will have is a bit of a PITA - as well as <code>ReDim</code> not being very flexible, there is also no neat way of testing an array to see how many dimensions it has (you have to loop through attempts to access higher dimensions and trap errors, or hack around in the underlying memory structure - <a href=\"https://stackoverflow.com/questions/6901991/how-to-return-the-number-of-dimensions-of-a-variant-variable-passed-to-it-in-v\">see this question</a>).  So you will need to keep track of the number of dimensions, and write long <code>Case</code> statements every time you need to <em>access</em> the array as well, since the syntax will be different.</p>\n\n<p>I would suggest creating the array with the largest number of dimensions you think you'll need, then setting the number of elements in any unused dimensions to 1 - that way you always have the same syntax every time you access the array, and if you need to you can check for this using <code>UBound()</code>.  This is the approach taken by the Excel developers themselves for the <code>Range.Value</code> property - which always returns a 2-dimensional array even for a 1-dimensional <code>Range</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1436339825, "post_id": 31285790, "comment_id": 50563939, "body": "&quot;which you may save it to an array (with the dimensions) you need&quot; - I think this is the bit the OP is asking how to do."}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1436340204, "post_id": 31285790, "comment_id": 50564184, "body": "@aucuparia When OP is iterating through the (transposed range) array, he has the opportunity to have a <i>counter</i> for both rows and cols. So there he gets the chance to find out what dimension to declare his desired array. Or he could simply go on creating new arrays and copying them to another till he gets it done. I am also quite skeptical about his needs for this dimensions: whether it&#39;s 2D with ranks or entirely multi D. <i>Pardon me for my laziness.</i>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436340655, "post_id": 31285790, "comment_id": 50564469, "body": "&quot;You are not allowed to Redim an array, if you are defining an array with a Dim statement initially&quot; That&#39;s not accurate - you can&#39;t Redim unless you initially Dim <b>without dimensions</b>."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1436341430, "post_id": 31285790, "comment_id": 50564955, "body": "@Rory <code>you can&#39;t Redim unless you initially Dim without dimensions</code> If I&#39;m not mistaken, you can provided you do not specify the type. This <code>Redim x(1 To 3)</code>  will work without <code>Dim x</code> up front."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1436341723, "post_id": 31285790, "comment_id": 50565138, "body": "@L42 Yes I should have been more explicit - I meant you can use a Dim statement first, but you can&#39;t include dimensions. You can indeed Redim a Variant without using Dim at all - though I think it&#39;s bad practice."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1436346193, "post_id": 31285790, "comment_id": 50567935, "body": "@bonCodigo - once you have the desired number of dimensions in a counter, there is no concise way to use that in a <code>ReDim</code> statement (which is I believe the point of the question).  I.e. you can&#39;t do <code>ReDim(myArray, upperBound, numberOfDimensions)</code> - the number of dimensions is <i>implicit</i> in the number of parameters passed to <code>ReDim</code>.  I agree that an array with a dynamic number of dimensions is probably not the best way to solve the problem!"}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1436409581, "post_id": 31285790, "comment_id": 50603580, "body": "Let me start with @Rory. <code>Dim vArray(1 to 6) As Variant)</code> can this be <code>Redim</code>? No it can&#39;t because it&#39;s already dimensioned. And that&#39;s what I meant in my sentence by giving an example in the bracket for that declaration prevents user from doing so. Probably I should have <i>explicitly</i> listed down all the combinations (which I updated above) which do not allow <code>Redim</code>. To be precise, not only Dim but also for all private, public arrays under the above criteria, the Redim will not work."}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1436410727, "post_id": 31285790, "comment_id": 50603848, "body": "@aucuparia I agree with most part of it you pointed out. Come to think of it, can you visualize what sort of a collection device the OP is after? One of his option&#39;s could be then, nested arrays but that doesn&#39;t change the fact outer most array will remain at its original dimensions (probably with a Redim preserve on last dimension). But the next question would be, <b>how would you retrieve data from a such a dynamic/ad-hoc structure</b>? <i>10,000</i> loops and Bound checks...perhaps."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1436863890, "post_id": 31285790, "comment_id": 50778182, "body": "@bonCodigo, I can&#39;t really visualise it - there may well be a completely different approach which avoids the problem.  I was just answering the specific question (which, although possibly not widely <i>useful</i> I thought was <i>interesting</i>)!"}], "tags": [], "owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "is_accepted": false, "score": 0, "last_activity_date": 1436409584, "last_edit_date": 1436409584, "creation_date": 1436339465, "answer_id": 31285790, "question_id": 31285020, "link": "https://stackoverflow.com/questions/31285020/redim-variable-number-of-dimensions-in-vba/31285790#31285790", "title": "Redim variable number of dimensions in VBA", "body": "<blockquote>\n  <p>\"Some code needs to run through each combination (one selection from\n  each column) and I'd like to store the results in a multidimensional\n  array.\"</p>\n</blockquote>\n\n<p>To begin with, I would <em>transpose</em> desired Range object into a Variant.</p>\n\n<pre><code>Dim vArray as Variant\n'--as per your defined Sheet, range\n'this creates a two dimensional array\nvArray = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"A1:Z300\").Value2\n</code></pre>\n\n<p>Then you could iterate through this array to possible find the size and data you need, which you may save it to an array (with the dimensions) you need.</p>\n\n<hr>\n\n<p><strong>Little Background:</strong></p>\n\n<blockquote>\n  <p>Redim: Reallocates storage space for an array variable.</p>\n</blockquote>\n\n<p>You are not allowed to Redim an array, if you are defining an array with a Dim statement initially. (e.g. <code>Dim vArray(1 to 6) As Variant</code>).</p>\n\n<p><strong>UPDATE</strong>: to show explicitly what's allowed and what's not under Redim.</p>\n\n<p><img src=\"https://i.stack.imgur.com/cDdxF.png\" alt=\"enter image description here\"></p>\n\n<p>Each time you use <code>Redim</code> it <em>resets</em> your original Array object to the dimensions you are defining next.</p>\n\n<p>There's a way to preserve your data using <code>Redim Preserve</code> but that only allows you to change the last dimension of a multidimensional array, where first dimension remains as the original.</p>\n"}, {"tags": [], "owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "is_accepted": false, "score": 0, "last_activity_date": 1436339915, "last_edit_date": 1495540272, "creation_date": 1436339915, "answer_id": 31285941, "question_id": 31285020, "link": "https://stackoverflow.com/questions/31285020/redim-variable-number-of-dimensions-in-vba/31285941#31285941", "title": "Redim variable number of dimensions in VBA", "body": "<p>As I understood your users can specify dimensions and their seize by filling in the excel-sheet. This means you have to get the last row containing a value and the last column.</p>\n\n<p>Therefore, have a look at: <a href=\"https://stackoverflow.com/q/11926972/4572953\">Excel VBA- Finding the last column with data</a></p>\n\n<p>Use <code>Redim</code> to change the array's size. If you want to keep some kind of entries use <code>Redim Preserve</code></p>\n"}], "owner": {"reputation": 1240, "user_id": 2775089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b6c629064ce9063f5e65448ed8f0d3?s=128&d=identicon&r=PG&f=1", "display_name": "Q---ten", "link": "https://stackoverflow.com/users/2775089/q-ten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2126, "favorite_count": 1, "accepted_answer_id": 31285739, "answer_count": 3, "score": 6, "last_activity_date": 1436409584, "creation_date": 1436336811, "last_edit_date": 1436336924, "question_id": 31285020, "link": "https://stackoverflow.com/questions/31285020/redim-variable-number-of-dimensions-in-vba", "title": "Redim variable number of dimensions in VBA", "body": "<p>I have a case in an Excel macro (VBA) where I'd like to dimension an array where the number of dimensions and the bounds of each dimension are determined at runtime. I'm letting the user specify a series of combinatorial options by creating a column for each option type and filling in the possibilities below. The number of columns and the number of options is determined at run time by inspecting the sheet.</p>\n\n<p>Some code needs to run through each combination (one selection from each column) and I'd like to store the results in a multidimensional array. </p>\n\n<p>The number of dimensions will probably be between about 2 to 6 so I can always fall back to a bunch of if else blocks if I have to but it feels like there should be a better way. </p>\n\n<p>I was thinking it would be possible to do if I could construct the <code>Redim</code> statement at runtime as a string and execute the string, but this doesn't seem possible.</p>\n\n<p>Is there any way to dynamically <code>Redim</code> with a varying number of dimensions?</p>\n"}, {"tags": ["vba", "excel", "thunderbird"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1864610"}, "edited": false, "score": 2, "creation_date": 1436332840, "post_id": 31283948, "comment_id": 50560588, "body": "<a href=\"https://stackoverflow.com\">Stack Overflow</a> is for specific, answerable questions. Your posting here is not actually a question. If we distil it a little we get <i>&#39;Does somebody know...?&#39;</i>, to which the possible answers are <i>&#39;yes&#39;</i>, or <i>&#39;no&#39;</i>. Please be a little more precise. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 1447, "user_id": 4583854, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh4.googleusercontent.com/--sVT5cPJc1Q/AAAAAAAAAAI/AAAAAAAABOo/Yfn69gf8deo/photo.jpg=k-s128", "display_name": "Roger Oliveira", "link": "https://stackoverflow.com/users/4583854/roger-oliveira"}, "edited": false, "score": 1, "creation_date": 1439784252, "post_id": 31283948, "comment_id": 51985405, "body": "I understood I found the solution given very good, It helped me a lot..."}], "answers": [{"comments": [{"owner": {"reputation": 1447, "user_id": 4583854, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh4.googleusercontent.com/--sVT5cPJc1Q/AAAAAAAAAAI/AAAAAAAABOo/Yfn69gf8deo/photo.jpg=k-s128", "display_name": "Roger Oliveira", "link": "https://stackoverflow.com/users/4583854/roger-oliveira"}, "edited": false, "score": 1, "creation_date": 1439784202, "post_id": 31284639, "comment_id": 51985396, "body": "This solution worked well in my version also. @Omar"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 2, "last_activity_date": 1436335312, "creation_date": 1436335312, "answer_id": 31284639, "question_id": 31283948, "link": "https://stackoverflow.com/questions/31283948/excel-macro-sending-through-thunderbird/31284639#31284639", "title": "Excel Macro sending through Thunderbird", "body": "<p>Example</p>\n\n<pre><code>Option Explicit\nSub Thunderbird()\n    Dim sCmd As String      '// Prepare Thunderbird\n    Dim sTo As String       '// Recipient\n    Dim sSubject As String  '// Subject\n    Dim sBody As String     '// Email body\n\n    sTo = \"Test@Email.com\"\n    sSubject = \"Subject\"\n    sBody = \"body text\"\n\n    sCmd = \"C:\\Program Files\\Mozilla Thunderbird\\thunderbird\" '// or\n    'sCmd = \"C:\\Program Files (x86)\\Mozilla Thunderbird\\thunderbird\" '// Path\n    sCmd = sCmd &amp; \" -compose \" &amp; Chr$(34) &amp; \"mailto:\" &amp; sTo &amp; \"?\" '// Chr$(34)=double quote\n    sCmd = sCmd &amp; \"subject=\" &amp; Chr$(34) &amp; sSubject &amp; Chr$(34)\n    sCmd = sCmd &amp; sBody\n\n    Call Shell(sCmd, vbNormalFocus)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5042918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5b1ac1a9f6b8f78fface9b3562e307?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5042918/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3941, "favorite_count": 2, "closed_date": 1436336726, "answer_count": 1, "score": 3, "last_activity_date": 1441954330, "creation_date": 1436332297, "last_edit_date": 1441954330, "question_id": 31283948, "link": "https://stackoverflow.com/questions/31283948/excel-macro-sending-through-thunderbird", "closed_reason": "Needs details or clarity", "title": "Excel Macro sending through Thunderbird", "body": "<p>I was wondering if anyone knew how to build a macro in excel to send the spreadsheet through Thunderbird.</p>\n"}, {"tags": ["vba", "outlook", "office365", "ms-office", "outlook-addin"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1436370360, "creation_date": 1436370360, "answer_id": 31297555, "question_id": 31283157, "link": "https://stackoverflow.com/questions/31283157/outlook-quick-search-folder-structure-by-name/31297555#31297555", "title": "Outlook Quick Search Folder Structure by Name", "body": "<p>The Outlook object model doesn't provide any property of method for that.</p>\n\n<p>You need to develop a VBA macro or add-in to ge the job done. For example, you can iterate over the folders structure to find the required one. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff864011(v=office.15).aspx\" rel=\"nofollow\">Folders</a> property of the Folder class returns the Folders collection that represents all the folders contained in the specified Folder. So, you may walk down to the tree recursively. </p>\n"}], "owner": {"reputation": 9, "user_id": 5017751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc58b06a5b691c37c374d71b9e345e8?s=128&d=identicon&r=PG&f=1", "display_name": "kanda", "link": "https://stackoverflow.com/users/5017751/kanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593156418, "creation_date": 1436327061, "last_edit_date": 1593156418, "question_id": 31283157, "link": "https://stackoverflow.com/questions/31283157/outlook-quick-search-folder-structure-by-name", "title": "Outlook Quick Search Folder Structure by Name", "body": "<p>Is there any easy way to quickly search for the name of a folder in Outlook's inbox folder structure?</p>\n\n<p>I am talking about this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/LMdMo.png\" alt=\"enter image description here\"></p>\n\n<p>I have to categorize emails into this folder structure as they arrive but 99% of the time is looking for the right folder...</p>\n\n<p>We are running our own Exchange and I am using Outlook over rdp </p>\n\n<p><a href=\"https://i.stack.imgur.com/wZDKS.png\" rel=\"nofollow noreferrer\">http://i.stack.imgur.com/wZDKS.png</a></p>\n"}, {"tags": ["vba", "excel", "xslt", "analysis"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1436333380, "post_id": 31283109, "comment_id": 50560811, "body": "I would loop through the data column-wise, left to right."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3549661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c20f455d25069c2510fa8e5cb6b322?s=128&d=identicon&r=PG&f=1", "display_name": "user3549661", "link": "https://stackoverflow.com/users/3549661/user3549661"}, "edited": false, "score": 0, "creation_date": 1436395961, "post_id": 31284447, "comment_id": 50600054, "body": "Thanks so much for the solution. The final Macro needs to handle 10 columns with additional logic to handle NULL cells but after I fully understand the code I should be able to use this"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 31, "user_id": 3549661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c20f455d25069c2510fa8e5cb6b322?s=128&d=identicon&r=PG&f=1", "display_name": "user3549661", "link": "https://stackoverflow.com/users/3549661/user3549661"}, "edited": false, "score": 0, "creation_date": 1436396557, "post_id": 31284447, "comment_id": 50600250, "body": "I believe that all you should have to change is the range referenced within <code>Application.Transpose</code> and the location of the results data."}, {"owner": {"reputation": 31, "user_id": 3549661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c20f455d25069c2510fa8e5cb6b322?s=128&d=identicon&r=PG&f=1", "display_name": "user3549661", "link": "https://stackoverflow.com/users/3549661/user3549661"}, "edited": false, "score": 0, "creation_date": 1436398163, "post_id": 31284447, "comment_id": 50600732, "body": "I&#39;ve gotten that far, the problem is that the production data sometimes contains NULL cells so I need to:"}, {"owner": {"reputation": 31, "user_id": 3549661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c20f455d25069c2510fa8e5cb6b322?s=128&d=identicon&r=PG&f=1", "display_name": "user3549661", "link": "https://stackoverflow.com/users/3549661/user3549661"}, "edited": false, "score": 0, "creation_date": 1436398697, "post_id": 31284447, "comment_id": 50600893, "body": "I&#39;ve gotten that far, the problem is that the production data sometimes contains NULL cells so I need to:  - Check for the event of a NULL cell in the parent loop - When a NULL parent is found, assign the new parent one level higher  I think this can be done in the bottom IF condition, here&#39;s some more sample data to visualize what I mean.   <a href=\"http://i.imgur.com/RVvAR2h.png\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1436334411, "creation_date": 1436334411, "answer_id": 31284447, "question_id": 31283109, "link": "https://stackoverflow.com/questions/31283109/transform-excel-data-into-custom-format/31284447#31284447", "title": "Transform Excel data into custom format", "body": "<p>Stuff the 'Raw Data' into a two dimensional variant array and cycle through each rank, building the children of the parent or sub-parent as the case may be.</p>\n\n<pre><code>Sub collate_family_values()\n    Dim v As Long, w As Long, vVALs As Variant\n    Dim sPAR As String, sTMP As String\n\n    With ActiveSheet    '&lt;-set this worksheet reference properly!\n        .Columns(\"f:g\").EntireColumn.Delete\n        .Cells(1, 6) = \"Output Data\"\n        .Cells(2, 6).Resize(1, 2) = .Cells(2, 1).Resize(1, 2).Value\n\n        vVALs = Application.Transpose(.Range(.Cells(3, 1), .Cells(Rows.Count, 4).End(xlUp)).Value)\n\n        For w = LBound(vVALs, 1) To UBound(vVALs, 1) - 1\n            sTMP = ChrW(8203)\n            sPAR = vVALs(w, LBound(vVALs, 2))\n            For v = LBound(vVALs, 2) To UBound(vVALs, 2)\n                If Not CBool(InStr(1, sTMP, ChrW(8203) &amp; vVALs(w + 1, v) &amp; ChrW(8203), vbTextCompare)) Then\n                    sTMP = sTMP &amp; vVALs(w + 1, v) &amp; ChrW(8203)\n                End If\n                If sPAR &lt;&gt; vVALs(w, Application.Min(v + 1, UBound(vVALs, 2))) Or v = UBound(vVALs, 2) Then\n                    .Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Resize(1, 2) = _\n                      Array(sPAR, Replace(Mid(sTMP, 2, Len(sTMP) - 2), ChrW(8203), \", \"))\n                    sTMP = ChrW(8203)\n                    If v &lt; UBound(vVALs, 2) Then sPAR = vVALs(w, v + 1)\n                End If\n            Next v\n        Next w\n    End With\nEnd Sub\n</code></pre>\n\n<p>I moved the 'Output Dat' results to the right of the 'Raw Data' due to an unknown number of rows to adjust for.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/IpUOY.png\" alt=\"variant array parse children\"></p>\n"}], "owner": {"reputation": 31, "user_id": 3549661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c20f455d25069c2510fa8e5cb6b322?s=128&d=identicon&r=PG&f=1", "display_name": "user3549661", "link": "https://stackoverflow.com/users/3549661/user3549661"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436334411, "creation_date": 1436326675, "last_edit_date": 1436329725, "question_id": 31283109, "link": "https://stackoverflow.com/questions/31283109/transform-excel-data-into-custom-format", "title": "Transform Excel data into custom format", "body": "<p>I'm attempting to transform a large Excel input table into a custom format, also as an Excel table. Visually this is what I need to accomplish: </p>\n\n<p><img src=\"https://i.stack.imgur.com/gj9Vx.png\" alt=\"enter image description here\"></p>\n\n<p>The psuedo-code I've come up with to solve the problem goes as follows:</p>\n\n<ol start=\"2\">\n<li>Pseudo code:</li>\n</ol>\n\n<p>// Column A is of higher level than column B</p>\n\n<pre><code>Initialize dictionary\nRead the entire spreadsheet into system memory \n    While(sheet has records) { \n        Loop through spreadsheet records top-down\n        Start at cell A1 \n        Look to the immediate right of column A \n            if(A:B not already in dictionary){  \n            Dictionary&gt;&gt; Append B as child of A in dictionary // Must find correct entry and append value \n            }\n        Move to cell A+1\n        }\n    Once sheet is out of records {\n            Move one column to the right\n            Repeat while method\n            Do this until entire column is null\n     }\n     while (dictionary has records) {\n       Key = Column A value\n       List of values = Column B value\n       Save values as new Excel sheet\n     }\n    end\n</code></pre>\n\n<p>I'm not sure if there are libraries that exist that would accomplish what I need here, I can use whatever language offers a solution. </p>\n\n<p>Appreciate any input from you all. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "edited": false, "score": 0, "creation_date": 1436326887, "post_id": 31282597, "comment_id": 50558994, "body": "Thanks for the reply Keong, Here&#39;s a copy of my code, I don&#39;t know how to change it to make it work for merged cells.. <code>Sheet1.Range(Cells(a, 4), Cells(a, 10)).Copy         Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial</code> Sheet1 and Sheet2 are declared as variables, they have different values and not declared as &quot;Sheet1&quot; per se, i just changed it up a lil differently."}, {"owner": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "edited": false, "score": 0, "creation_date": 1436327768, "post_id": 31282597, "comment_id": 50559170, "body": "I mean I just changed the values when i posted it here"}, {"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "reply_to_user": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "edited": false, "score": 0, "creation_date": 1436328324, "post_id": 31282597, "comment_id": 50559340, "body": "Just remove <code>PasteSpecial</code> and it worked. Here is what I tried : <code>Sheet1.Range(Cells(9, 4), Cells(9, 10)).Copy Destination:=Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)</code>"}, {"owner": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "edited": false, "score": 0, "creation_date": 1436329624, "post_id": 31282597, "comment_id": 50559655, "body": "It&#39;s not working for me. I still get the &quot;We can&#39;t do that to a merged cell.&quot; I&#39;m pasting it on a range of cells that also has a merged cells"}, {"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "reply_to_user": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "edited": false, "score": 0, "creation_date": 1436330284, "post_id": 31282597, "comment_id": 50559833, "body": "Mind edit your question by pasting your source code?"}], "tags": [], "owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "is_accepted": true, "score": 1, "last_activity_date": 1436323063, "creation_date": 1436323063, "answer_id": 31282597, "question_id": 31282562, "link": "https://stackoverflow.com/questions/31282562/pasting-merged-cells-using-vba/31282597#31282597", "title": "Pasting merged cells using VBA", "body": "<p>For copy a merged cells, you need mention range.<br>\nExample : A9 and B9 were merged, you need use <code>Range(\"A9:B9\").Copy</code> to copy the merged cell</p>\n"}], "owner": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11627, "favorite_count": 0, "accepted_answer_id": 31282597, "answer_count": 1, "score": 0, "last_activity_date": 1436329956, "creation_date": 1436322783, "last_edit_date": 1436329956, "question_id": 31282562, "link": "https://stackoverflow.com/questions/31282562/pasting-merged-cells-using-vba", "title": "Pasting merged cells using VBA", "body": "<p>I'm trying to copy a row of data from an excel sheet and transfer that to another sheet, but the range of row data has a two column merged cell in it and I'm having trouble pasting without any errors. </p>\n\n<p>Any tips would be very helpful,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1436325655, "post_id": 31282460, "comment_id": 50558709, "body": "If you use builtin function within VBA you need to use the right object. <code>Application.WorksheetFunction.Match(...)</code>"}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1436326149, "post_id": 31282460, "comment_id": 50558815, "body": "It gives me a runtime error 438 that&#39;s why I&#39;ve used application.match without worksheetfunction."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1436327923, "post_id": 31282460, "comment_id": 50559223, "body": "I think your <b>Crt. Accrual</b> has a manual line feed in it (Alt-Enter)? If so, the match will NOT find it unless you include it (<code>CHAR(10)</code>). Try remove the line feed or match with a different string."}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1436328191, "post_id": 31282460, "comment_id": 50559293, "body": "What is manual line feed? By the way, when I run my code per line, col gives error 2042."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1436328279, "post_id": 31282460, "comment_id": 50559320, "body": "Have you tried <code>&quot;*Crt.*Accrual*&quot;</code>? Since you have the bracket in the cell but not in the Match string. Which line gives error 2042?"}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1436328546, "post_id": 31282460, "comment_id": 50559393, "body": "@JohnF is this merged cell static? e.g. it will always remain in this range"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1436328893, "post_id": 31282460, "comment_id": 50559486, "body": "@JohnF Next time please include row and column headers in screenshot if you are dealing with rows and/or columns. We can only guess the &quot;Crt. (Accrual&quot; is similar to your highlighted cell."}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1436330112, "post_id": 31282460, "comment_id": 50559791, "body": "@PatricK I&#39;m sorry about that. &quot;Crt. (Accrual)&quot; is at range AG10. But the range is not static. Also &quot;Allotment - Total&quot; is in merged row(9 and 10), &quot;leave pay&quot; is in merged column(AF:AH, row 9)"}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "reply_to_user": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1436330264, "post_id": 31282460, "comment_id": 50559824, "body": "@bonCodigo The cell is not static. Its range changes"}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1436330642, "post_id": 31282460, "comment_id": 50559925, "body": "Check if your code can run without bugs/failing in an non-merged range."}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "edited": false, "score": 0, "creation_date": 1436347115, "post_id": 31282460, "comment_id": 50568545, "body": "Thanks for your help. I&#39;ve fix my own issue by placing the range on the match.      col = Application.Match(&quot;<i>Crt</i>&quot;, Sheets(&quot;COMPAS&quot;).Range(&quot;A10:ZZ10&quot;), 0)"}], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "edited": false, "score": 0, "creation_date": 1436344780, "post_id": 31283754, "comment_id": 50567020, "body": "It doesn&#39;t give me errors but it doesn&#39;t give the correct value. It gives zero. When I run the code per line, col is equals to error 2042"}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "edited": false, "score": 0, "creation_date": 1436347081, "post_id": 31283754, "comment_id": 50568517, "body": "Thanks for your help. I&#39;ve fix my own issue by placing the range on the match.      col = Application.Match(&quot;<i>Crt</i>&quot;, Sheets(&quot;COMPAS&quot;).Range(&quot;A10:ZZ10&quot;), 0)"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "edited": false, "score": 1, "creation_date": 1436357547, "post_id": 31283754, "comment_id": 50575400, "body": "Great ! I&#39;m glad it helped"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1436331503, "last_edit_date": 1436331503, "creation_date": 1436331166, "answer_id": 31283754, "question_id": 31282460, "link": "https://stackoverflow.com/questions/31282460/application-match-not-working-with-merged-cells/31283754#31283754", "title": "Application.match not working with merged cells", "body": "<p>A few issues with your code:</p>\n\n<ol>\n<li><p>This syntax doesn't give you what you'd expect</p>\n\n<p><code>Set rng = Sheets(\"COMPAS\").Range(\"A10:\" &amp; .Range(\"ZZ9\").End(xlToRight).Address)</code></p>\n\n<p>You could use something like this</p>\n\n<p><code>Set rng = Sheets(\"COMPAS\").Range(\"A9:ZZ10\")</code></p></li>\n<li><p>Match can search one array (one row or column), so you'll have to use Match for each row</p>\n\n<ul>\n<li>To search on multiple rows you could use Find</li>\n</ul></li>\n<li><p>\"col\" needs to be declared as a variant (not sure how you have it declared)</p></li>\n<li><p>You need to check for errors every time you perform the Match (in the Else block as well)</p></li>\n</ol>\n\n<p>Notes:</p>\n\n<ul>\n<li>If you merge cell A1 with A2, and place \"Test\" in the merged cells, the \"Test value will be found in row 1 (A1), and A2 will be empty</li>\n</ul>\n\n<p>This (untested) code shows how you can use Match on multiple rows:</p>\n\n<pre><code>Option Explicit\n\nSub SubName()\n    Const HDR1 As String = \"*Crt.*\"\n    Const HDR2 As String = \"*Crt. Accrual*\"\n\n    Dim row1 As Range, row2 As Range\n    Dim col1 As Variant, col2 As Variant\n    Dim lastRow As Long, macroCell As Range\n\n    With Worksheets(\"COMPAS\").UsedRange\n        Set row1 = .Rows(9)\n        Set row2 = .Rows(10)\n    End With\n    With Application\n        col1 = .Match(HDR1, row1, 0)\n        col2 = .Match(HDR2, row1, 0)\n        If IsError(col1) Then col1 = .Match(HDR1, row2, 0)\n        If IsError(col2) Then col2 = .Match(HDR2, row2, 0)\n    End With\n\n    Set macroCell = Worksheets(\"MACRO TEMPLATE\").Cells(2, 2)\n\n    If IsError(col1) Or IsError(col2) Then\n        macroCell.Value2 = 0\n    Else\n        With Worksheets(\"COMPAS\")\n            lastRow = .Cells(.UsedRange.Rows.Count + 1, col2).End(xlUp).Row\n            macroCell.Value2 = .Cells(lastRow, col2).Value2\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1436331503, "creation_date": 1436322047, "last_edit_date": 1531164843, "question_id": 31282460, "link": "https://stackoverflow.com/questions/31282460/application-match-not-working-with-merged-cells", "title": "Application.match not working with merged cells", "body": "<p>I have my code which finds a certain column and go to its last row value and display it. My problem is that the application.match is not working on the merged cells. Here's my code;</p>\n\n<pre><code>Dim rng As Range\nDim LastRow As Long\n\nWith ActiveSheet\n\n    Set rng = Sheets(\"COMPAS\").Range(\"A10:\" &amp; .Range(\"ZZ9\").End(xlToRight).Address)\n    col = Application.Match(\"*Crt.*\", rng, 0)\n\n    If IsError(col) Then\n\n        Sheets(\"MACRO TEMPLATE\").Cells(2, 2) = 0\n\n    Else\n\n        col = Application.Match(\"*Crt. Accrual*\", rng, 0)\n        LastRow = Sheets(\"COMPAS\").Cells(1000000, col).End(xlUp).Row\n        Sheets(\"MACRO TEMPLATE\").Cells(2, 2) = Sheets(\"COMPAS\").Cells(LastRow, col)\n\n    End If\n\nEnd With\n</code></pre>\n\n<p>What I'm trying to find is the \"Crt. Accrual\". Unlike \"Allotment - Total\" which is on row 9 and 10(merged) \"Crt. Accrual\" is on row 10. not merged with row 9.</p>\n\n<p>Any response would be appreciated.</p>\n\n<p><img src=\"https://i.stack.imgur.com/DzUrH.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1436320977, "post_id": 31282005, "comment_id": 50557628, "body": "If <code>Pict.Shapes.Range(Array(&quot;Isosceles Triangle &quot; &amp; i)).Select</code> works and <code>Pict.Shapes.Range(Array(&quot;Freeform &quot; &amp; i)).Select</code> doesn&#39;t then the only difference can be that not all the names <code>Freeform 1</code> through <code>Freeform 27</code> exist.  Otherwise why would the other line work?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1436323141, "last_edit_date": 1436323141, "creation_date": 1436320892, "answer_id": 31282319, "question_id": 31282005, "link": "https://stackoverflow.com/questions/31282005/vba-method-range-of-object-worksheet-failed-shapes-rangearray/31282319#31282319", "title": "VBA method &#39;range of object&#39; _Worksheet failed Shapes.Range(Array", "body": "<p>I'm curious as to what the value of <em>i</em> is when you crash. The code is largely the same as a recorded macro but the syntax is correct if the named shape(s) exist.</p>\n\n<p>First run this small snippet to output all of the shapes' names to the VBE's Immediate Window (Ctrl+G).</p>\n\n<pre><code>Sub List_Shapes()\n    Dim i As Long\n    With Workbooks(\"Well Pictographs2.xlsm\").Worksheets(2)\n        For i = 1 To .Shapes.Count\n            Debug.Print .Shapes(i).Name\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>When you are in the VBE, tap Ctrl+G to open the Immediate Window and check the output. Make sure you have <em>Isosceles Triangle 1</em> through <em>Isosceles Triangle 27</em> (inclusive).</p>\n\n<p>Next run through this modification of your macro.</p>\n\n<pre><code>Sub graphics_mover()\n    Dim SWL_row As Double, PWL_row As Double\n    Dim rng As Variant, i As Integer, colNum As Integer, Data As Worksheet, Pict As Worksheet\n\n    On Error Resume Next\n    Set Data = ThisWorkbook.Worksheets(1)\n\n    With Workbooks(\"Well Pictographs2.xlsm\").Worksheets(2)\n        For i = 1 To 27\n            SWL_row = Data.Cells(2, i + 1).Value\n            SWL_row = Int(SWL_row / 50 + 1)\n            If Not .Shapes(\"Isosceles Triangle \" &amp; i) Is Nothing Then\n                .Shapes(\"Isosceles Triangle \" &amp; i).Top = SWL_row * 15 + 4\n                Debug.Print \"moved \" &amp; .Shapes(\"Isosceles Triangle \" &amp; i).Name\n            End If\n\n            PWL_row = Data.Cells(3, i + 1).Value\n            PWL_row = Int(PWL_row / 50 + 1)\n            If Not .Shapes(\"Freeform \" &amp; i) Is Nothing Then\n                .Shapes(\"Freeform \" &amp; i).Top = PWL_row * 15 + 1\n                Debug.Print \"moved \" &amp; .Shapes(\"Freeform \" &amp; i).Name\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>I'm not a big fan of using <code>On Error Resume Next</code> but you are dealing with an object that is avoiding detection. The VBE's Immediate window will report the shapes that it could move.</p>\n"}], "owner": {"reputation": 123, "user_id": 5091720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b10b1063f78204b0f716d0eff1296e3c?s=128&d=identicon&r=PG&f=1", "display_name": "Shane", "link": "https://stackoverflow.com/users/5091720/shane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 31282319, "answer_count": 1, "score": 1, "last_activity_date": 1436323141, "creation_date": 1436318401, "question_id": 31282005, "link": "https://stackoverflow.com/questions/31282005/vba-method-range-of-object-worksheet-failed-shapes-rangearray", "title": "VBA method &#39;range of object&#39; _Worksheet failed Shapes.Range(Array", "body": "<p>I am trying to move shapes on the 2nd sheet based on the values of the 1st sheet. I keep getting an error with the line....Shapes.Range(Array(.... below is the code.</p>\n\n<pre><code>Sub graphics_mover()\n' graphics_mover Macro\n\nDim SWL_row As Double, PWL_row As Double\nDim rng As Variant, i As Integer, colNum As Integer, Data As Worksheet, Pict As Worksheet\nSet Data = ThisWorkbook.Worksheets(1)\n'Set Pict = ThisWorkbook.Worksheets(2)\nSet Pict = Workbooks(\"Well Pictographs2.xlsm\").Worksheets(2)\ni = 1\nFor i = 1 To 27\n    SWL_row = Data.Cells(2, i + 1).Value\n    SWL_row = Int(SWL_row / 50 + 1)\n    Pict.Shapes.Range(Array(\"Isosceles Triangle \" &amp; i)).Select\n    Selection.Top = SWL_row * 15 + 4\n\n    PWL_row = Data.Cells(3, i + 1).Value\n    PWL_row = Int(PWL_row / 50 + 1)\n    Pict.Shapes.Range(Array(\"Freeform \" &amp; i)).Select\n    Selection.Top = PWL_row * 15 + 1\n    i = i + 1\nNext i\n    '--------------------------\nEnd Sub\n</code></pre>\n\n<p>the line that is causing the error is: </p>\n\n<pre><code>    Pict.Shapes.Range(Array(\"Freeform \" &amp; i)).Select\n</code></pre>\n\n<p>I appreciate any solutions. </p>\n"}]