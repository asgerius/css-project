[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1536196306, "post_id": 52194737, "comment_id": 91339912, "body": "Is all the text in one cell or is each text item in a different cell?"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1536213600, "post_id": 52194737, "comment_id": 91343974, "body": "And are you saying that you want a range of cells to scroll across your excel worksheet or across your entire screen (including beyond the excel application)?"}, {"owner": {"reputation": 13, "user_id": 9027572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/018353136d73a50724795c7d6b56a967?s=128&d=identicon&r=PG&f=1", "display_name": "user9027572", "link": "https://stackoverflow.com/users/9027572/user9027572"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1536287889, "post_id": 52194737, "comment_id": 91378290, "body": "Hey @Ambie, each text item is in a different cell and currently scrolls within the target range designated in the script. I adjust that depending on how much data we want to include but, it currently scrolls perfectly within that designated range as needed with non formatted text - except for it not working for formatted text. I  may be the format used to convert the columns to condensed numbers with K or M for thousand or million."}], "owner": {"reputation": 13, "user_id": 9027572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/018353136d73a50724795c7d6b56a967?s=128&d=identicon&r=PG&f=1", "display_name": "user9027572", "link": "https://stackoverflow.com/users/9027572/user9027572"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536191642, "creation_date": 1536191642, "question_id": 52194737, "link": "https://stackoverflow.com/questions/52194737/excel-scrolling-marquee-vb-script-not-working-with-formatted-text", "title": "Excel Scrolling Marquee vb script not working with formatted text", "body": "<p>We've tried various vb scripts to scroll text in a range of cells in Excel 2010. I found a great one we could tweak but, unfortunately, I can only get this to work with text that has no formatting to it. I also can't seem to get it to repeat the text with no gaps. </p>\n\n<p>I've attached a screen shot of what the text looks like in the format we'd like to scroll it. </p>\n\n<p>It does work with a picture of the copied cells entered into the target range, but, the edge of the excel spreadsheet cuts off the picture scrolling from off screen.</p>\n\n<p>HELP! We're not serious coders by any means. Can anyone point us in the right direction? If it isn't possible, that would be great to know as well. </p>\n\n<p>Thanks for any suggestions. </p>\n\n<p><a href=\"https://i.stack.imgur.com/RQNSg.jpg\" rel=\"nofollow noreferrer\">scrolling marquee text with formatting</a></p>\n\n<pre><code>    Option Explicit\n\nPrivate Type POINTAPI\n    x As Long\n    y As Long\nEnd Type\n\nPrivate Type RECT\n    Left As Long\n    Top As Long\n    Right As Long\n    Bottom As Long\nEnd Type\n\nPrivate Declare Function FindWindow Lib \"user32.dll\" _\nAlias \"FindWindowA\" _\n(ByVal lpClassName As String, _\nByVal lpWindowName As String) As Long\n\nPrivate Declare Function FindWindowEx Lib \"user32.dll\" _\nAlias \"FindWindowExA\" _\n(ByVal hWnd1 As Long, _\nByVal hWnd2 As Long, _\nByVal lpsz1 As String, _\nByVal lpsz2 As String) As Long\n\nPrivate Declare Function GetDeviceCaps Lib \"gdi32\" ( _\nByVal hdc As Long, _\nByVal nIndex As Long) As Long\n\nPrivate Declare Function GetDC Lib \"user32\" _\n(ByVal hwnd As Long) As Long\n\nPrivate Declare Function ReleaseDC Lib \"user32\" ( _\nByVal hwnd As Long, _\nByVal hdc As Long) As Long\n\nPrivate Declare Function CreateCompatibleDC Lib \"gdi32\" _\n(ByVal hdc As Long) As Long\n\nPrivate Declare Function CreateCompatibleBitmap Lib \"gdi32\" _\n(ByVal hdc As Long, _\nByVal nWidth As Long, _\nByVal nHeight As Long) As Long\n\nPrivate Declare Function SelectObject Lib \"gdi32\" _\n(ByVal hdc As Long, _\nByVal hObject As Long) As Long\n\nPrivate Declare Function DeleteObject Lib \"gdi32\" _\n(ByVal hObject As Long) As Long\n\nPrivate Declare Function BitBlt Lib \"gdi32\" _\n(ByVal hDestDC As Long, _\nByVal x As Long, _\nByVal y As Long, _\nByVal nWidth As Long, _\nByVal nHeight As Long, _\nByVal hSrcDC As Long, _\nByVal xSrc As Long, _\nByVal ySrc As Long, _\nByVal dwRop As Long) As Long\n\nPrivate Declare Function ScreenToClient Lib \"user32\" ( _\nByVal hwnd As Long, _\nlpPoint As POINTAPI) As Long\n\n\nPrivate Const SRCCOPY As Long = &amp;HCC0020\nPrivate Const LOGPIXELSX As Long = 88\nPrivate Const LOGPIXELSY As Long = 90\nPrivate Const POINTSPERINCH As Long = 72\n\nPrivate tPrevRect As RECT\nPrivate oTargetCell As Range\nPrivate bStop As Boolean\nPrivate bRangeRectHasChanged As Boolean\nPrivate vNumberFormat As String\nPrivate vHorzAlignment As Long\nPrivate lMemoryDC As Long\nPrivate lWBHwnd As Long\nPrivate i As Long\n\nPublic Sub StartScrollingRow()\n\n    '//Scroll the text in Cell Range from Right to Left.\n    Call ScrollCell(Range(\"B4:R4\"), 0.01, True)\n\nEnd Sub\n\nPrivate Sub TakeCellSnapShot(Target As Range)\n\n    Dim lDC As Long\n    Dim lXLDeskhwnd As Long\n    Dim lBmp As Long\n\n    '//Get the workbook Wnd hwnd.\n    lXLDeskhwnd = _\n    FindWindowEx(FindWindow(\"XLMAIN\", Application.Caption) _\n    , 0, \"XLDESK\", vbNullString)\n    lWBHwnd = FindWindowEx _\n    (lXLDeskhwnd, 0, \"EXCEL7\", vbNullString)\n\n    '//Get the Wbk window DC.\n    lDC = GetDC(lWBHwnd)\n\n    '//Create a memory DC.\n    lMemoryDC = CreateCompatibleDC(lDC)\n\n    '//Get the target cell metrics in pixels.\n    tPrevRect = GetRangeRect(ByVal Target)\n\n    With tPrevRect\n\n        '//create a compatible Bmp the same size as the target cell.\n        lBmp = CreateCompatibleBitmap _\n        (lDC, (.Right - 1 - .Left), (.Bottom - .Top))\n\n        '//Select the Bmp onto our mem DC.\n        DeleteObject SelectObject(lMemoryDC, lBmp)\n\n        '//Copy the target cell image onto the Mem DC.\n        BitBlt lMemoryDC, 0, 0, (.Right - .Left), (.Bottom - .Top), _\n        lDC, .Left, .Top, SRCCOPY\n\n    End With\n\n    '//CleanUp.\n    ReleaseDC 0, lDC\n    ReleaseDC lMemoryDC, 0\n\nEnd Sub\n\nPrivate Sub ScrollCell _\n(ByVal Target As Range, ByVal Delay As Single, _\nOptional ByVal RightToLeft As Boolean)\n\n    '//Make sure the target range is one Cell.\n    If Target.Cells.Count &lt; 1 Then Exit Sub\n\n    bStop = False\n\n    '//Store the target cell for later use.\n    Set oTargetCell = Target\n\n    '//Unselect the target cell to avoid the selection borders.\n    If ActiveCell.Address = _\n    Target.Address Then oTargetCell.Offset(1).Select\n\n    If Not bRangeRectHasChanged Then\n\n        vHorzAlignment = Target.HorizontalAlignment\n\n        Target.HorizontalAlignment = xlLeft\n\n    End If\n\n    '//copy the target cell image onto memory.\n    Call TakeCellSnapShot(Target)\n\n    If Not bRangeRectHasChanged Then\n\n        vNumberFormat = Target.NumberFormat\n\n        Target.NumberFormat = \";;;\"\n\n        '//call the text scrolling routine.\n        Call UpdateCell(Target, Delay, RightToLeft)\n\n    End If\n\n\nEnd Sub\n\nPrivate Sub UpdateCell _\n(ByVal Target As Range, ByVal Delay As Single, _\nOptional ByVal RightToLeft As Boolean)\n\n    Dim lDC As Long\n\n    '//store the Wbk window DC.\n    lDC = GetDC(lWBHwnd)\n\n    '//Scroll the Target Cell Text.\n    Do\n\n        '//Do nothing if not on the target sheet.\n        If ActiveSheet Is oTargetCell.Parent Then\n            '//Update the tPrevRect Struct if the Target Cell\n            '//screen location/size have changed.\n            If tPrevRect.Left &lt;&gt; GetRangeRect(Target).Left Or _\n            tPrevRect.Top &lt;&gt; GetRangeRect(Target).Top Or _\n            tPrevRect.Right &lt;&gt; GetRangeRect(Target).Right Or _\n            tPrevRect.Bottom &lt;&gt; GetRangeRect(Target).Bottom Then\n                bRangeRectHasChanged = True\n                tPrevRect = GetRangeRect(Target)\n                Target.NumberFormat = vNumberFormat\n                ScrollCell oTargetCell, Delay\n                Target.NumberFormat = \";;;\"\n            End If\n\n            '//do the actual text scrolling here.\n            With tPrevRect\n\n                If RightToLeft Then\n                    BitBlt lDC, .Left + 1, .Top, (.Right - .Left), _\n                    (.Bottom - .Top), _\n                    lMemoryDC, i - (.Right - .Left), 0, SRCCOPY\n                Else\n                    BitBlt lDC, .Left, .Top, (.Right - .Left), _\n                    .Bottom - .Top, _\n                    lMemoryDC, (.Right - .Left) - i, 0, SRCCOPY\n                End If\n\n                If i &gt;= (.Right - .Left) * 2 Then i = 0\n\n            End With\n\n            i = i + 1\n            SetDelay Delay  'Secs.\n\n        End If\n\n        DoEvents\n\n    Loop Until bStop\n\n    ReleaseDC 0, lDC\n\n\nEnd Sub\n\n'//===============================\n'// Other Supporting routines...\n'//===============================\nPrivate Function ScreenDPI(bVert As Boolean) As Long\n\n    Static lDPI(1), lDC\n\n    If lDPI(0) = 0 Then\n        lDC = GetDC(0)\n        lDPI(0) = GetDeviceCaps(lDC, LOGPIXELSX)\n        lDPI(1) = GetDeviceCaps(lDC, LOGPIXELSY)\n        lDC = ReleaseDC(0, lDC)\n    End If\n\n    ScreenDPI = lDPI(Abs(bVert))\n\nEnd Function\n\nPrivate Function PTtoPX _\n(Points As Single, bVert As Boolean) As Long\n\n    PTtoPX = Points * ScreenDPI(bVert) / POINTSPERINCH\n\nEnd Function\n\n\nPrivate Function GetRangeRect(ByVal rng As Range) As RECT\n\n    Dim tPt1 As POINTAPI\n    Dim tPt2 As POINTAPI\n    Dim OWnd  As Window\n\n    On Error Resume Next\n\n    Set OWnd = rng.Parent.Parent.Windows(1)\n\n    With rng\n        GetRangeRect.Left = _\n        PTtoPX(.Left * OWnd.Zoom / 100, 0) _\n        + OWnd.PointsToScreenPixelsX(0)\n        GetRangeRect.Top = _\n        PTtoPX(.Top * OWnd.Zoom / 100, 1) _\n        + OWnd.PointsToScreenPixelsY(0)\n        GetRangeRect.Right = _\n        PTtoPX(.Width * OWnd.Zoom / 100, 0) _\n        + GetRangeRect.Left\n        GetRangeRect.Bottom = _\n        PTtoPX(.Height * OWnd.Zoom / 100, 1) _\n        + GetRangeRect.Top\n    End With\n\n     With GetRangeRect\n         tPt1.x = .Left\n         tPt1.y = .Top\n         tPt2.x = .Right\n         tPt2.y = .Bottom\n         ScreenToClient lWBHwnd, tPt1\n         ScreenToClient lWBHwnd, tPt2\n        .Left = tPt1.x + 2\n        .Top = tPt1.y\n        .Right = tPt2.x - 2\n        .Bottom = tPt2.y\n    End With\n\nEnd Function\n\nPrivate Sub SetDelay(TimeOut As Single)\n\n    Dim t As Single\n\n    t = Timer\n\n    Do\n        DoEvents\n    Loop Until Timer - t &gt;= TimeOut\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1536220118, "last_edit_date": 1536220118, "creation_date": 1536218933, "answer_id": 52198697, "question_id": 52194730, "link": "https://stackoverflow.com/questions/52194730/worksheet-change-for-multiple-specific-cells/52198697#52198697", "title": "Worksheet_change for multiple specific cells", "body": "<p>Instead of this stuff </p>\n\n<pre><code>Static IsActive As Boolean\nIf IsActive Then Exit Sub\nIsActive = True\n</code></pre>\n\n<p>you can just use <code>Application.EnableEvents = False</code> to prevent this event re-triggering itself.</p>\n\n<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-intersect-method-excel\" rel=\"nofollow noreferrer\">Application.Intersect Method</a> to test if the cell that was changed is in a specific range.</p>\n\n<p>Also I suggest to use <code>Select Case</code> instead of the multiple <code>ElseIf</code> and finally you can shorten your ranges like I shown below:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n\n    If Not Intersect(Target, Range(\"D2,D5\")) Is Nothing Then\n        'this will only run if cells D2 or D5 was changed\n\n        Select Case Range(\"D2\").Value\n            Case \"Small\":\n                Range(\"A7,A15\").Value = \"Yes\"\n                Range(\"A8,A9,A17,A19,A21\").Value = \"No\"\n                Range(\"A10,A11,A12\").Value = \"\"\n\n            Case \"Medium\":\n                'todo \n            Case \"Large\":\n                'todo\n            Case \"X-Large\":\n                'todo\n            Case \"&lt;Select&gt;\":\n                'todo\n            Case Else:\n                'what happens if no case it true\n        End Select\n\n    End If\n\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9968857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63ddc4453604ee8412dadba6fff2216?s=128&d=identicon&r=PG&f=1", "display_name": "GVJenn", "link": "https://stackoverflow.com/users/9968857/gvjenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549012435, "creation_date": 1536191604, "last_edit_date": 1549012435, "question_id": 52194730, "link": "https://stackoverflow.com/questions/52194730/worksheet-change-for-multiple-specific-cells", "title": "Worksheet_change for multiple specific cells", "body": "<p>I will preface that I spent a lot of time searching and testing, but nothing ever quite worked as expected.</p>\n\n<p>I am essentially creating a task list that will export to CSV in order to import. The tricky part is that the task list is determined by two user-selected variables. </p>\n\n<p>The first (\"C2\") determines if the import is to include the \"Beta tasks\". This is a simple yes/no and populates the \"Include\" column using a simple formula. </p>\n\n<p>The second (\"D2\") determines what Tasks are included based on the list size.</p>\n\n<p>This currently works fine. Here is where I am having trouble. First is that the wokbook_change is watching for all changes on the sheet, so there is no way for me to manually choose to include/exclude tasks. How can I get the sheet to watch only for that cell to change?</p>\n\n<p>Also, ideally, I would like fo the beta release to follow to primary task if I manually change to exclude. For example, set \"C2\" to Yes and \"D2\" to Medium. If I choose to manually exclude \"Task 4\" the corresponding Beta should also be excluded. I have this code in the workbook as a simple If statement, but could not get it to work with workbook_change.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nStatic IsActive As Boolean\nIf IsActive Then Exit Sub\nIsActive = True\n\nIf Range(\"D2\").Value = \"Small\" Then\n    Range(\"A7\").Value = \"Yes\"\n    Range(\"A8\").Value = \"No\"\n    Range(\"A9\").Value = \"No\"\n    Range(\"A10\").Value = \"\"\n    Range(\"A11\").Value = \"\"\n    Range(\"A12\").Value = \"\"\n    Range(\"A15\").Value = \"Yes\"\n    Range(\"A17\").Value = \"No\"\n    Range(\"A19\").Value = \"No\"\n    Range(\"A21\").Value = \"No\"\n\nElseIf Range(\"D2\").Value = \"Medium\" Then\n    Range(\"A7\").Value = \"Yes\"\n    Range(\"A8\").Value = \"Yes\"\n    Range(\"A9\").Value = \"No\"\n    Range(\"A15\").Value = \"Yes\"\n    Range(\"A17\").Value = \"Yes\"\n    Range(\"A19\").Value = \"No\"\n    Range(\"A21\").Value = \"No\"\n\nElseIf Range(\"D2\").Value = \"Large\" Then\n    Range(\"A7\").Value = \"Yes\"\n    Range(\"A8\").Value = \"Yes\"\n    Range(\"A9\").Value = \"Yes\"\n    Range(\"A15\").Value = \"Yes\"\n    Range(\"A17\").Value = \"Yes\"\n    Range(\"A19\").Value = \"Yes\"\n    Range(\"A21\").Value = \"No\"\n\n\nElseIf Range(\"D2\").Value = \"X-Large\" Then\n    Range(\"A7\").Value = \"Yes\"\n    Range(\"A8\").Value = \"Yes\"\n    Range(\"A9\").Value = \"Yes\"\n    Range(\"A15\").Value = \"Yes\"\n    Range(\"A17\").Value = \"Yes\"\n    Range(\"A19\").Value = \"Yes\"\n    Range(\"A21\").Value = \"Yes\"\n\nElseIf Range(\"D2\").Value = \"&lt;Select&gt;\" Then\n    Range(\"A7\").Value = \"Yes\"\n    Range(\"A8\").Value = \"Yes\"\n    Range(\"A9\").Value = \"Yes\"\n    Range(\"A15\").Value = \"Yes\"\n    Range(\"A17\").Value = \"Yes\"\n    Range(\"A19\").Value = \"Yes\"\n    Range(\"A21\").Value = \"Yes\"\n\nEnd If\n\nIf Range(\"A15\").Value = \"No\" Then\n    Range(\"A16\").Value = \"No\"\nEnd If\n\nIf Range(\"A17\").Value = \"No\" Then\n    Range(\"A18\").Value = \"No\"\nEnd If\n\nIf Range(\"A19\").Value = \"No\" Then\n    Range(\"A20\").Value = \"No\"\nEnd If\n\nIf Range(\"A21\").Value = \"No\" Then\n    Range(\"A22\").Value = \"No\"\nEnd If\n\nIsActive = False\n\nEnd Sub\n</code></pre>\n\n<p>Appreciate in advance for any help. Also, I have no doubts that I am not going about this in the most efficient manner, so any suggestions on that front would also be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1536190977, "post_id": 52194651, "comment_id": 91338983, "body": "Which item is &quot;Rectangle 9&quot;?  I also don&#39;t see any show/hide text in your screenshots.  How are the lines to be shown related to the clicked-on line?  Seems like there is a better way to do this if we had a bit more context."}, {"owner": {"reputation": 1, "user_id": 10322586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf7779dfb0fccdb4d2a21033569dd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Jared.O", "link": "https://stackoverflow.com/users/10322586/jared-o"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536192163, "post_id": 52194651, "comment_id": 91339172, "body": "My bad, So there is a transparent rectangle with text matching the colour of the cell (line) it is placed over so it is practically invisible. I will edit the main post with some more context. thanks for the reply @TimWilliams"}], "answers": [{"tags": [], "owner": {"reputation": 296, "user_id": 10297628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ff84ef23bae11a9746ec65cf1c284?s=128&d=identicon&r=PG&f=1", "display_name": "Shelty", "link": "https://stackoverflow.com/users/10297628/shelty"}, "is_accepted": false, "score": 0, "last_activity_date": 1536196196, "last_edit_date": 1536196196, "creation_date": 1536192989, "answer_id": 52194870, "question_id": 52194651, "link": "https://stackoverflow.com/questions/52194651/click-on-cell-have-range-of-data-display-through-linked-picture/52194870#52194870", "title": "Click on cell, Have range of data display through linked picture", "body": "<p>You can create those buttons or shapes with a macro (as you said for example 100 buttons) and move them with a macro so they are in the right place. They are going to use the same macro. It will just do a different thing depending where the button is or maybe better depending on its name.</p>\n\n<p>There is a nice tutorial.\n<a href=\"https://www.youtube.com/watch?v=bF28JhlC7yc&amp;index=18&amp;list=PLpOAvcoMay5SE3XTp2YN2v6NcJuXKM9KX\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=bF28JhlC7yc&amp;index=18&amp;list=PLpOAvcoMay5SE3XTp2YN2v6NcJuXKM9KX</a></p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1536217952, "creation_date": 1536217952, "answer_id": 52198397, "question_id": 52194651, "link": "https://stackoverflow.com/questions/52194651/click-on-cell-have-range-of-data-display-through-linked-picture/52198397#52198397", "title": "Click on cell, Have range of data display through linked picture", "body": "<p>Here's a simple example where a common Sub uses <code>Application.Caller</code> to figure out which shape triggered it.</p>\n\n<pre><code>Sub Tester()\n\n    Dim s As Shape, c, s2 As Shape\n\n    c = Application.Caller        '&lt;&lt; name of your clicked shape\n    Debug.Print c\n\n    Set s = ActiveSheet.Shapes(c) '&lt;&lt; the clicked shape\n\n    With s.TextFrame2.TextRange.Characters\n\n        'here you need some way to transform the name of the clicked\n        '  shape to get the name of the other shape to be shown/hidden/moved\n        Set s2 = ActiveSheet.Shapes(c &amp; \"_linked\")\n\n        s2.Visible = (.Text = \"Show\")\n        .Text = IIf(.Text = \"Show\", \"Hide\", \"Show\") 'toggle text\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10322586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf7779dfb0fccdb4d2a21033569dd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Jared.O", "link": "https://stackoverflow.com/users/10322586/jared-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536217952, "creation_date": 1536190635, "last_edit_date": 1536196218, "question_id": 52194651, "link": "https://stackoverflow.com/questions/52194651/click-on-cell-have-range-of-data-display-through-linked-picture", "title": "Click on cell, Have range of data display through linked picture", "body": "<p>First time posting, hope this all makes sense. I have created a graphic in excel that shows 88 lines <a href=\"https://i.stack.imgur.com/ratWP.png\" rel=\"nofollow noreferrer\">1</a>. In another worksheet there are rows of data documented what is on each line <a href=\"https://i.stack.imgur.com/atHsu.png\" rel=\"nofollow noreferrer\">2</a> When a line is clicked on the graphic I want the corresponding data from the other worksheet to pop up <a href=\"https://i.stack.imgur.com/I3YnF.png\" rel=\"nofollow noreferrer\">3</a> </p>\n\n<p>I have managed it achieve this by making a transparent button/shape over each line to hide and show a linked image <a href=\"https://i.stack.imgur.com/66Wws.png\" rel=\"nofollow noreferrer\">4</a>. However, I've had to create a separate button and macro for each line with 100+ lines this seems every inefficient. this is the code I used :</p>\n\n<pre><code>Sub LINE1A1()\n\n    With ActiveSheet.Shapes(\"Rectangle 9\").TextFrame2.TextRange.Characters\n        If .Text = \"Hide\" Then\n            .Text = \"Show\"\n            ActiveSheet.Shapes(\"Picture 3\").Visible = False\n        Else\n            .Text = \"Hide\"\n            With ActiveSheet.Shapes(\"Rectangle 9\")\n                ActiveSheet.Shapes(\"Picture 3\").Left = .Left + .Width\n                ActiveSheet.Shapes(\"Picture 3\").Top = .Top + .Height\n                ActiveSheet.Shapes(\"Picture 3\").Visible = True\n            End With\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>What would be a better way to achieve this? side not I used linked image as the data and range of data is subject to changes as each line could have more than 1 row of data. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "edited": false, "score": 0, "creation_date": 1536187545, "post_id": 52193908, "comment_id": 91338321, "body": "I recommend you use Excel Tables and Excel formulae using Index/Match. Google Excel Tables and Index:/Match.  Here are a couple of links to get you started.  <a href=\"https://exceljet.net/things-to-know-about-excel-tables\" rel=\"nofollow noreferrer\">23 Things to Know about Excel Tables</a> and <a href=\"https://exceljet.net/formula/basic-index-match-exact\" rel=\"nofollow noreferrer\">Excel Formula Basic Index Match</a>.  I have no affilation with any of these sites. I&#39;ve gotten great help from Stack Overflow over the years, and I&#39;m trying to pay it forward."}], "answers": [{"tags": [], "owner": {"reputation": 152, "user_id": 1265581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe0592ebaa07cf3e44a397e8396a6741?s=128&d=identicon&r=PG", "display_name": "depwl9992", "link": "https://stackoverflow.com/users/1265581/depwl9992"}, "is_accepted": false, "score": 0, "last_activity_date": 1536188829, "creation_date": 1536188829, "answer_id": 52194451, "question_id": 52193908, "link": "https://stackoverflow.com/questions/52193908/excel-macro-that-returns-all-values-for-lookup-for-a-range/52194451#52194451", "title": "Excel macro that returns all values for lookup for a range", "body": "<p>The way I understand: Something like a timecard report generator, or an arbitrary list of names and values in Sheet2, and you want to transpose and consolidate Sheet2 onto Sheet1 in a Pivot Table-like consolidation (sure you can't just use a Pivot?).</p>\n\n<p>Pure VBA-wise I did something like this a few years ago (my use case being that above-mentioned timecard report): </p>\n\n<ol>\n<li>Sort Sheet2 by your name column.</li>\n<li>Calculate the last row using <code>lastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).row</code>.</li>\n<li>Also initialize a row rounter (RCTR) and column counter (CCTR) which will iterate or reset as your output table is written.</li>\n<li>Begin a for-next through this entire, sorted raw list known as Sheet2 (<code>For n = 1 To lastrow ... Next n</code>).</li>\n<li>For each row, compare <code>Range(\"A\" &amp; n)</code> with <code>Range(\"A\" &amp; n-1)</code> to determine when a new name occurs (<em>you'll override this test and just assume a new name for Row 1</em>).</li>\n<li>If a new name occurs per step 4, reset RCTR to 2 and iterate CCTR by 1, then copy that new name into <code>Worksheets(\"Sheet1\").Cells(1,CCTR)</code> (column is the current column counter, row is 1).</li>\n<li>Copy over the the numeric values into <code>Worksheets(\"Sheet1\").Cells(RCTR,CCTR)</code>, then iterate RCTR.</li>\n<li>Loop to Step 5.</li>\n</ol>\n\n<p>Since the worksheet is sorted, we only care when the name column in Sheet2 changes, and therefore can pretty much ignore how many times it occurs in a given dataset.</p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1536224050, "last_edit_date": 1536224050, "creation_date": 1536215938, "answer_id": 52197912, "question_id": 52193908, "link": "https://stackoverflow.com/questions/52193908/excel-macro-that-returns-all-values-for-lookup-for-a-range/52197912#52197912", "title": "Excel macro that returns all values for lookup for a range", "body": "<p>I suggest to loop through all data in Sheet B, match them with the first row in Sheet A and if it matched write the value into the next free row in the matched column.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub SortDataIntoSheetA()\n    Dim wsSrc As Worksheet\n    Set wsSrc = ThisWorkbook.Worksheets(\"Sheet B\") 'define source worksheet\n\n    Dim wsDest As Worksheet\n    Set wsDest = ThisWorkbook.Worksheets(\"Sheet A\") 'define destination worksheet\n\n    Dim LastSrcRow As Long\n    LastSrcRow = wsSrc.Cells(wsSrc.Rows.Count, \"A\").End(xlUp).Row 'find last used row in source\n\n    Dim DestCol As Long, LastDestRow As Long\n\n    Dim iRow As Long\n    For iRow = 1 To LastSrcRow 'loop throug all rows in source\n        DestCol = 0 'initialize\n        On Error Resume Next 'if next row throws error hide it\n        DestCol = WorksheetFunction.Match(wsSrc.Cells(iRow, \"A\").Value, wsDest.Rows(1), 0) 'find correct column\n        On Error GoTo 0 're-enable error reporting!!\n\n        'if nothing matched DestCol will still be 0\n\n        If DestCol &gt; 0 Then\n            LastDestRow = wsDest.Cells(wsDest.Rows.Count, DestCol).End(xlUp).Row 'find last used row in destination column\n            wsDest.Cells(LastDestRow + 1, DestCol).Value = wsSrc.Cells(iRow, \"B\").Value 'write value\n        End If\n    Next iRow\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1536220611, "post_id": 52198478, "comment_id": 91347349, "body": "Don&#39;t ever use <code>GoTo</code> unless it is immediately  behind <code>On Error</code>, using <code>GoTo</code> is a very bad practice and  can easily be avoided by negating the <code>If</code> statement here: <code>If NameCol &lt;&gt; 0 Then \u2026 NextEntryline \u2026 End If</code>."}, {"owner": {"reputation": 71, "user_id": 10237340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bb9ae5e78125f68d9bc449077804f0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryeo", "link": "https://stackoverflow.com/users/10237340/ryeo"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1536220899, "post_id": 52198478, "comment_id": 91347532, "body": "edited as per Peh Advice,  to advocate good Coding Practice !!"}], "tags": [], "owner": {"reputation": 71, "user_id": 10237340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bb9ae5e78125f68d9bc449077804f0?s=128&d=identicon&r=PG&f=1", "display_name": "Ryeo", "link": "https://stackoverflow.com/users/10237340/ryeo"}, "is_accepted": true, "score": 1, "last_activity_date": 1536220866, "last_edit_date": 1536220866, "creation_date": 1536218210, "answer_id": 52198478, "question_id": 52193908, "link": "https://stackoverflow.com/questions/52193908/excel-macro-that-returns-all-values-for-lookup-for-a-range/52198478#52198478", "title": "Excel macro that returns all values for lookup for a range", "body": "<p>I think easiest way is to use collection / dictionary. I am assuming that all your names in sheet A is unique. </p>\n\n<pre><code>Option Explicit\n\nSub RetrieveData()\n\nDim wb As Workbook\nDim ws_A As Worksheet\nDim ws_B As Worksheet\n\nDim HeaderRow As Long\nDim HeaderLastColumn As Long\nDim TableColStart As Long\nDim NameList As Object\nDim i As Long\n\nDim ws_B_lastrow As Long\nDim NextEntryline As Long\nDim NameCol As Long\n\nSet wb = ActiveWorkbook\nSet ws_A = wb.Worksheets(\"Sheet A\")\nSet ws_B = wb.Worksheets(\"Sheet B\")\nSet NameList = CreateObject(\"Scripting.Dictionary\")\n\nWith ws_A\n    HeaderRow = 1  'set the header row in sheet A\n    TableColStart = 1 'Set start col in sheet A\n    HeaderLastColumn = .Cells(HeaderRow, Columns.Count).End(xlToLeft).Column  'Get number of NAMEs you have\n\n    For i = TableColStart To HeaderLastColumn\n        If Not NameList.Exists(UCase(.Cells(HeaderRow, i).Value)) Then  'check if the name exists in the dictionary\n             NameList.Add UCase(.Cells(HeaderRow, i).Value), i 'if does not exist record name as KEY and Column number as value in dictionary\n        End If\n    next i\n\nEnd With\n\n\n\n\nWith ws_B\n    ws_B_lastrow = .Cells(Rows.Count, 1).End(xlUp).Row  ' Get number of DATA you have in sheet B\n    For i = 1 To ws_B_lastrow   'for each data\n        NameCol = NameList(UCase(.Cells(i, 1).Value))  'get the column where the name is in Sheet A from the dictionaary\n        If NameCol &lt;&gt; 0 Then  'if 0 means the name doesnt exists\n            NextEntryline = ws_A.Cells(Rows.Count, NameCol).End(xlUp).Row + 1 'get the next entry line of the particular name in sheet A\n            ws_A.Cells(NextEntryline, NameCol).Value = .Cells(i, 2) 'insert the data\n        End If\n\n    Next i\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 5818496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-9ntOGGGNxfE/AAAAAAAAAAI/AAAAAAAAADU/FrH5SlMK3FQ/photo.jpg?sz=128", "display_name": "Jerremy Leedham", "link": "https://stackoverflow.com/users/5818496/jerremy-leedham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "closed_date": 1536223263, "accepted_answer_id": 52198478, "answer_count": 3, "score": 0, "last_activity_date": 1536224050, "creation_date": 1536184754, "last_edit_date": 1536215160, "question_id": 52193908, "link": "https://stackoverflow.com/questions/52193908/excel-macro-that-returns-all-values-for-lookup-for-a-range", "closed_reason": "Needs more focus", "title": "Excel macro that returns all values for lookup for a range", "body": "<p>I know that heading may seem Ultra confusing but it's the best way I could do.</p>\n\n<p>To give further explaination I have a single work book and two sheets:</p>\n\n<ul>\n<li><p>Sheet A has people's names in row 1 (A1, B1, C1, etc). The number of names changes, sometimes more sometimes less.</p></li>\n<li><p>Sheet B has the list of people's names in Column A and a value in Column B. For example:</p>\n\n<pre><code>A       B\nJohn    22\nJohn    13\nSam     90\n</code></pre></li>\n</ul>\n\n<p>What I need is a macro that looks at the value in the first row in each column in Sheet A and returns pastes all the matching values from the list in Sheet B to the second row in Sheet A.</p>\n\n<p>It would look something like:</p>\n\n<ul>\n<li><p>Sheet A: </p>\n\n<pre><code>A        B\nJohn     Sam\n22       90\n13\n</code></pre></li>\n</ul>\n\n<p>I haven't had the time to test anything up but I was thinking that I might be able to paste a formula in B1:B[X] that looks up the number of times the names occurs in the list and finds its starting position and use that to copy and paste the corresponding range from column B.</p>\n\n<p>I'm not a macro pro but that's the direction my mind is going right now. If anyone could make sense of that dry explanation and could help that would be amazing!  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1536185222, "post_id": 52193753, "comment_id": 91337710, "body": "<code>CELLS()</code> is a range.  Sometimes it works without it, but I always use <code>CELLS(i,j).VALUE</code> to be clear that I am setting or getting the value of the cell.  And I&#39;m not sure why you have <code>.Cells</code>.  Try it without the <code>.</code>"}, {"owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "edited": false, "score": 1, "creation_date": 1536186062, "post_id": 52193753, "comment_id": 91337944, "body": "Welcome to Excel VBA programming.  We all fall into the trap of Cell(row,column) and think &quot;Oh this will be easy&quot;.  What you want to do is to work with Ranges, a cell is a range.  More importantly, learning how to use Named ranges and ListObjects will be critical to your success.  Click here to see <a href=\"https://docs.microsoft.com/en-us/office/vba/excel/concepts/cells-and-ranges/refer-to-named-ranges\" rel=\"nofollow noreferrer\">Microsoft&#39;s Named Range Documentation</a> and <a href=\"http://www.cpearson.com/Excel/DefinedNames.aspx\" rel=\"nofollow noreferrer\">Chip Pearson</a> is my go to for most things VBA."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10322403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5adf6997390a2fdeba10fa6a0f3d683e?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/10322403/omar"}, "edited": false, "score": 0, "creation_date": 1536262617, "post_id": 52194051, "comment_id": 91371506, "body": "Thanks, this was very helpful and worked well. I am curious though why SimulatedValue can&#39;t be set as a variable also? I tried it and it just didn&#39;t work. It doesn&#39;t make any practical distance but would be a little cleaner."}, {"owner": {"reputation": 296, "user_id": 10297628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ff84ef23bae11a9746ec65cf1c284?s=128&d=identicon&r=PG&f=1", "display_name": "Shelty", "link": "https://stackoverflow.com/users/10297628/shelty"}, "reply_to_user": {"reputation": 11, "user_id": 10322403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5adf6997390a2fdeba10fa6a0f3d683e?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/10322403/omar"}, "edited": false, "score": 0, "creation_date": 1536270991, "post_id": 52194051, "comment_id": 91374714, "body": "Well, I have been thinking about it and an easy solution came to my mind. I edited the answer and also explained why your code was wrong and I hope I cleared a few thing out."}], "tags": [], "owner": {"reputation": 296, "user_id": 10297628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ff84ef23bae11a9746ec65cf1c284?s=128&d=identicon&r=PG&f=1", "display_name": "Shelty", "link": "https://stackoverflow.com/users/10297628/shelty"}, "is_accepted": true, "score": 0, "last_activity_date": 1536270879, "last_edit_date": 1536270879, "creation_date": 1536185782, "answer_id": 52194051, "question_id": 52193753, "link": "https://stackoverflow.com/questions/52193753/vba-for-loop-variables/52194051#52194051", "title": "VBA For Loop Variables", "body": "<p>Your code should look something like this.</p>\n\n<pre><code>Sub Simulation()\n\n    Dim i As Long\n    Dim Temperature As Long\n    Dim WindSpeed As Long\n    Dim SolarRadiation As Long\n    Dim Humidity As Long\n    Dim SimulatedValue As Long\n\n    With Worksheets(\"DataLoggerValues\")\n\n        For i = 1 To 100\n\n            Temperature = .Cells(i, 1).Value\n            WindSpeed = .Cells(i, 2).Value\n            SolarRadiation = .Cells(i, 3).Value\n            Humidity = .Cells(i, 4).Value\n\n\n            .Cells(i, 5).Value = (Temperature + SolarRadiation / WindSpeed) ^ 2 + Humidity / 37\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>You can also use something like this. Just use that function as a normal excel function. You can then drag this with autofill. You can use it after you add the code to a module. </p>\n\n<pre><code>Function Simulation(Temperature As Long, WindSpeed As Long, SolarRadiation As Long, Humidity As Long)\n\n    Simulation = (Temperature + SolarRadiation / WindSpeed) ^ 2 + Humidity / 37\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>An answer to the comment below.</p>\n\n<pre><code>Sub Simulation()\n\n    Dim i As Long\n    Dim Temperature As Long\n    Dim WindSpeed As Long\n    Dim SolarRadiation As Long\n    Dim Humidity As Long\n    Dim SimulatedValue As Double\n\n    With Worksheets(\"DataLoggerValues\")\n\n        For i = 1 To 100\n\n            Temperature = .Cells(i, 1).Value\n            WindSpeed = .Cells(i, 2).Value\n            SolarRadiation = .Cells(i, 3).Value\n            Humidity = .Cells(i, 4).Value\n\n            '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n            SimulatedValue = (Temperature + SolarRadiation / WindSpeed) ^ 2 + Humidity / 37\n\n            '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n\n            .Cells(i, 5).Value = SimulatedValue\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I guess you should read something about what objects are in a programming language. You can start with this:</p>\n\n<p><a href=\"https://analysistabs.com/excel-vba/objects-properties-methods/\" rel=\"nofollow noreferrer\">https://analysistabs.com/excel-vba/objects-properties-methods/</a></p>\n\n<p>What a problem was with your code is:</p>\n\n<p><code>Worksheets(\"DataLoggerValues\")</code> is an object. It has some propeties. For example it has a name: \"DataLoggerValues\".</p>\n\n<p>You can check it with </p>\n\n<pre><code>Sub Test()\n\n    MsgBox Worksheets(1).Name\n\nEnd Sub\n</code></pre>\n\n<p>If its index is one. It may be different. You can check it using another property of that object.</p>\n\n<pre><code>Sub Test()\n\n    MsgBox Worksheets(\"DataLoggerValues\").Index\n\nEnd Sub\n</code></pre>\n\n<p>And now we are getting to the problem. <code>Worksheets(\"DataLoggerValues\").Cells(i, 5)</code> is another object. It is a child object (a child class object).</p>\n\n<p>It is not a single value!!! It is an object. It has different properties and methods. This is why: <code>.Cells(i,5) =...</code> doesn't make sense. Are you assigning that value to the <code>.Cells(i,5).Address</code> or <code>.Cells(i,5).Value</code> or maybe some different property? All of them 'store' values. You can read them or change them.</p>\n\n<p>Maybe I should clear out why you have to use <code>SimulatedValue</code> differently.\nWell, with those first four cells it is simple. You create a variable, e.g. <code>Dim Temperature As Long</code>. It can store later assigned value somewhere in the computer's memory!!! Just assign some cell's value to it <code>Temperature = .Cells(i, 1).Value</code>. </p>\n\n<p>You do the same with different variables and perform some calculations. As I did it in the new code, you can store that number (It has to be Double because it has to 'store some numbers after the comma') in another variable (If your Temperature, WindSpeed etc. are not integers then change Long to Double). </p>\n\n<p>Now you can assign that value to the cells value <code>.Cells(i, 5).Value = SimulatedValue</code>. If you would have added the line <code>SimulatedValue = .Cells(i, 5).Value</code> somewhere before the calculations, you would just assign to the variable (SimulatedValue) a cell's value (which is 0 if the cell is empty or doesn't exist, I am not an expert. If you try to print the value, you get nothing but you can multiply anything by its value and you get 0). If you then write something like <code>SimulatedValue = 5</code> you just assign new value to the variable. You don't do anything to that cell object (the cell, the cell's value). </p>\n\n<p>I hope it is clear. I tried to be as concise as I could</p>\n\n<p>I am just a beginner when it comes to vba and I don't know too much about programming so I may have used some terms incorrectly, bear that in mind. Maybe somebody will correct me. :)</p>\n\n<hr>\n\n<p>Important stuff, when it comes to using floating-point variables (e.g. that Double). Read this:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/16707397/whats-wrong-with-this-simple-double-calculation\">Whats wrong with this simple &#39;double&#39; calculation?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/235409/compare-double-in-vba-precision-problem\">Compare double in VBA precision problem</a></p>\n\n<p>I guess that if you assign that value straight to some cell's value the problem persists, although I haven't read that or try that.</p>\n\n<p><code>.Cells(i, 5).Value = (Temperature + SolarRadiation / WindSpeed) ^ 2 + Humidity / 37</code></p>\n\n<p>It may save you some time in the future if you do some calculations with floating-point numbers.</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1536188926, "creation_date": 1536188926, "answer_id": 52194466, "question_id": 52193753, "link": "https://stackoverflow.com/questions/52193753/vba-for-loop-variables/52194466#52194466", "title": "VBA For Loop Variables", "body": "<p>You don't actually need to loop this as Excel is smart enough to increment it then you can just copy and paste as value like so:</p>\n\n<pre><code>Sub Simulation()\nWith Worksheets(\"DataLoggerValues\").Range(\"E2:E184\")\n    .Formula = \"=(A2+C2/B2)^2+D2/37\" 'Excel will increment the row relative to the row the formula is in\n    .Copy\n    .PasteSpecial xlPasteValues\nEnd With\nEnd Sub\n</code></pre>\n\n<p>You should mark Shelty as correct as his answer answers your specific question by moving the variable assignment inside the loop, I am just offering and alternative idea for you which will speed up your code.</p>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1536189960, "post_id": 52194508, "comment_id": 91338788, "body": "Seems over engineered assigning variables then releasing them, also I disagree with your comments regarding not using With..End with, What makes you think it slows the code down as opposed to any other method? if anything using a loop is what would slow this code down (see my answer for how to avoid this)."}, {"owner": {"reputation": 11, "user_id": 10310126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732f1610ff1727a725eb1b80ebd80f30?s=128&d=identicon&r=PG&f=1", "display_name": "Sajy Bhaskaran", "link": "https://stackoverflow.com/users/10310126/sajy-bhaskaran"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1536224011, "post_id": 52194508, "comment_id": 91349337, "body": "Generally &quot;With..End with&quot; is good for small objects but harmful if the referencing object contains more complex objects in it.."}], "tags": [], "owner": {"reputation": 11, "user_id": 10310126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732f1610ff1727a725eb1b80ebd80f30?s=128&d=identicon&r=PG&f=1", "display_name": "Sajy Bhaskaran", "link": "https://stackoverflow.com/users/10310126/sajy-bhaskaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1536189374, "creation_date": 1536189374, "answer_id": 52194508, "question_id": 52193753, "link": "https://stackoverflow.com/questions/52193753/vba-for-loop-variables/52194508#52194508", "title": "VBA For Loop Variables", "body": "<p>There are N number of ways to standardize your code. for the sake of simplicity, you can do like this</p>\n\n<pre><code>     Sub Simulation()\n\n    Dim i As Long\n    Dim Temperature As Range\n    Dim WindSpeed As Range\n    Dim SolarRadiation As Range\n    Dim Humidity As Range\n    Dim SimulatedValue As Range\n\n    With Worksheets(\"DataLoggerValues\")\n\n    'just initialize the header part\n    Set Temperature = .Cells(1, 1)\n    Set WindSpeed = .Cells(1, 2)\n    Set SolarRadiation = .Cells(1, 3)\n    Set Humidity = .Cells(1, 4)\n    Set SimulatedValue = .Cells(1, 5)\n\n\n    End With\n    Dim i As Integer\n\n    For i = 1 To 183\n\n     SimulatedValue.Offset(i, 0) = (Temperature.Offset(i, 0) + SolarRadiation.Offset(i, 0) / WindSpeed.Offset(i, 0)) ^ 2 + Humidity.Offset(i, 0) / 37\n\n     Next i\n\n    ' and finally\n      Set Temperature = Nothing\n      Set WindSpeed = Nothing\n      Set SolarRadiation = Nothing\n      Set Humidity = Nothing\n     Set SimulatedValue = Nothing\n\n    End Sub\n</code></pre>\n\n<p>Few tips: Avoid using With..End with, you can use named range or Tables or constant address for better performance and usability.</p>\n"}], "owner": {"reputation": 11, "user_id": 10322403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5adf6997390a2fdeba10fa6a0f3d683e?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/10322403/omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 52194051, "answer_count": 3, "score": 0, "last_activity_date": 1536270879, "creation_date": 1536183770, "question_id": 52193753, "link": "https://stackoverflow.com/questions/52193753/vba-for-loop-variables", "title": "VBA For Loop Variables", "body": "<p>I'm relatively new to VBA and I'm trying to simulate a complex equation in Excel VBA because my data logger is outputting a CSV, and since the equation is so long and complex with 13 variables and 17 intermediary calculations, I'm trying to make variables to help make the code a lot more readable for both debugging (for now and when I do stuff like this in the future) and for making the modifications I'm making to the simulation more visual. </p>\n\n<p>The basic structure of my code is as follows:</p>\n\n<pre><code>'Temperature = .Cells(i,1)\n'WindSpeed = .Cells(i,2)\n'SolarRadiation = .Cells(i,3)\n'Humidity = .Cells(i,4)\n'SimulatedValue = .Cells(i,5)\n\nSub Simulation()\nWith Worksheets(\"DataLoggerValues\")\nDim i As Integer\n\nFor i = 2 To 184\n\n.Cells(i,5) = (.Cells(i,1)+.Cells(i,3)/.Cells(i,2))^2 + .Cells(i,4)/37\n\nNext i\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I'd like to clean it up so the code line reads more like:</p>\n\n<pre><code>Simulated value = (Temperature+SolarRadiation/WindSpeed)^2 + Humidity/37\n</code></pre>\n\n<p>But every time I try declaring anything with .Cells(i,j) as a variable (I've tried string and array), I'll get a number of different errors, most often \"Runtime Error 1004\", but sometimes \"Syntax Error\" or \"Expected New or type name\" as compile errors.</p>\n\n<p>Is it even possible to turn .Cells(i,j) into a variable, or do I need to take a different approach?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1536186038, "post_id": 52193643, "comment_id": 91337940, "body": "Unfortunately <code>DisplayFormat</code> doesn&#39;t work with UDF&#39;s..."}, {"owner": {"reputation": 95, "user_id": 5070107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10db753601e6e5537c4c83c4a07768c?s=128&d=identicon&r=PG&f=1", "display_name": "Donald Li", "link": "https://stackoverflow.com/users/5070107/donald-li"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536242979, "post_id": 52193643, "comment_id": 91361095, "body": "Really? I thought the not working part is actually to change something, but reading from it doesn&#39;t work as well?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536243073, "post_id": 52193643, "comment_id": 91361171, "body": "I&#39;m not sure I understand your question, but in any case, a UDF when called in a worksheet will not work with <code>DisplayFormat</code>."}, {"owner": {"reputation": 95, "user_id": 5070107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10db753601e6e5537c4c83c4a07768c?s=128&d=identicon&r=PG&f=1", "display_name": "Donald Li", "link": "https://stackoverflow.com/users/5070107/donald-li"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536243820, "post_id": 52193643, "comment_id": 91361664, "body": "Did some research and it actually turns out to be the case... Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5070107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10db753601e6e5537c4c83c4a07768c?s=128&d=identicon&r=PG&f=1", "display_name": "Donald Li", "link": "https://stackoverflow.com/users/5070107/donald-li"}, "edited": false, "score": 0, "creation_date": 1536242439, "post_id": 52194365, "comment_id": 91360713, "body": "Thanks for the fix! I am not sure if that is going to work for me though since I will include in more than 30,000 cells..."}], "tags": [], "owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "is_accepted": false, "score": 0, "last_activity_date": 1536188037, "creation_date": 1536188037, "answer_id": 52194365, "question_id": 52193643, "link": "https://stackoverflow.com/questions/52193643/value-error-in-user-defined-function-vba/52194365#52194365", "title": "#Value Error in User Defined Function VBA", "body": "<p>Just so you're not left feeling like this is impossible, one possible approach to doing what you want to do is to take the entire body of your BlockStart function and put it in the Worksheet's SelectionChange event. Then, instead of the line that says <code>blockStart = startRow</code> you can assign the value to startRow to the cell where you are trying to use the BlockStart function.</p>\n\n<p>If multiples cells use the BlockStart function, assign the value to an unused cell somewhere and have the other cells reference it.</p>\n"}], "owner": {"reputation": 95, "user_id": 5070107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10db753601e6e5537c4c83c4a07768c?s=128&d=identicon&r=PG&f=1", "display_name": "Donald Li", "link": "https://stackoverflow.com/users/5070107/donald-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536188037, "creation_date": 1536183039, "question_id": 52193643, "link": "https://stackoverflow.com/questions/52193643/value-error-in-user-defined-function-vba", "title": "#Value Error in User Defined Function VBA", "body": "<p>I am writing a function to find the first row that has a different interior color (with Conditional Formatting) above the current active cell. The function works when I print it out with <code>debug.print</code> or <code>msgbox</code> but not when I call it directly in the worksheet. The first row is header and that's why I exclude the top row. </p>\n\n<pre><code>Public Function blockStart() As Long\n    Dim currColor As Long\n    currColor = activecell.DisplayFormat.Interior.ColorIndex\n\n    Dim currCol As String\n    currCol = Number2Letter(activecell.Column)\n\n    Dim startRow As Long\n    startRow = activecell.Row\n\n    'Find Ceiling\n    Do While startRow &gt;= 2\n        If Range(currCol &amp; startRow).DisplayFormat.Interior.ColorIndex &lt;&gt; currColor Then\n            startRow = startRow + 1\n            Exit Do\n        End If\n        startRow = startRow - 1\n    Loop\n\n    If startRow = 1 Then startRow = 2   ' at the very top\n\n    blockStart = startRow\n\nEnd Function\n</code></pre>\n\n<p>When I call the function directly in the worksheet, <code>#value</code> is prompted. Please let me know what I am doing wrong, thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 5, "creation_date": 1536182042, "post_id": 52193364, "comment_id": 91336704, "body": "You might want to start by using <code>Application.ScreenUpdating = False</code> and <code>Application.EnableEvents = False</code>. That said this might be better suited to the <a href=\"https://codereview.stackexchange.com/\">Code Review Stack Exchange</a>"}, {"owner": {"reputation": 41, "user_id": 10322257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bb92e21d9650db19fa6f8a497ff288?s=128&d=identicon&r=PG&f=1", "display_name": "Jmeyer", "link": "https://stackoverflow.com/users/10322257/jmeyer"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536182387, "post_id": 52193364, "comment_id": 91336826, "body": "Hi, i tried using those but then the whole workbook is not responding. Thanks for the link i&#39;ll take a look"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 5, "creation_date": 1536182580, "post_id": 52193364, "comment_id": 91336886, "body": "&quot;not responding&quot; means VBA is busy running your code; even the most efficient code can make Excel &quot;not responding&quot; while it&#39;s running. Don&#39;t take &quot;not responding&quot; as an indication of anything. That said, your code can probably be made more efficient indeed, but that&#39;s a job for <a href=\"https://codereview.stackexchange.com\">Code Review</a> - protip: you&#39;ll want to use a post title that describes the purpose of the code, because everybody there wants to &quot;change their code to make it run smoother&quot; ;-)"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1536183215, "post_id": 52193364, "comment_id": 91337105, "body": "<code>Dim p, s, poste, x</code> - These are all Variants. Try Dimming them as what they actually are?"}, {"owner": {"reputation": 41, "user_id": 10322257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bb92e21d9650db19fa6f8a497ff288?s=128&d=identicon&r=PG&f=1", "display_name": "Jmeyer", "link": "https://stackoverflow.com/users/10322257/jmeyer"}, "edited": false, "score": 0, "creation_date": 1536183679, "post_id": 52193364, "comment_id": 91337256, "body": "Without the Application.ScreenUpdating and EnableEvents = False the code take 60 sec to run with them i only tried to wait 10 min but after that i killed excel. I added the dim as Variant"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1536185649, "post_id": 52193364, "comment_id": 91337838, "body": "If your code works, and you&#39;re just looking to have it improved, your question should be asked on <a href=\"https://codereview.stackexchange.com\">Code Review</a> instead."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1536191172, "post_id": 52193364, "comment_id": 91339009, "body": "Please fix your indenting before asking for review"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1536198523, "post_id": 52193364, "comment_id": 91340364, "body": "@Jmeyer  You turned off Application.ScreenUpdating and EnableEvents and then the script took 10 minutes or did you forget to turn them back on?"}, {"owner": {"reputation": 41, "user_id": 10322257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bb92e21d9650db19fa6f8a497ff288?s=128&d=identicon&r=PG&f=1", "display_name": "Jmeyer", "link": "https://stackoverflow.com/users/10322257/jmeyer"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1536236053, "post_id": 52193364, "comment_id": 91356743, "body": "Yeah it was to late sorry, as suggested i moved the whole thing to Code Review : <a href=\"https://codereview.stackexchange.com/questions/203210/automating-the-creation-of-weekly-schedule\" title=\"automating the creation of weekly schedule\">codereview.stackexchange.com/questions/203210/&hellip;</a> @Jerry Jeremiah yes i did turn them back on it didn&#39;t work for some reason. But now with all of Comintern suggestion it works"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1536249347, "post_id": 52193364, "comment_id": 91365311, "body": "I&#39;m voting to close this question as off-topic because question has been moved by OP to code review"}], "owner": {"reputation": 41, "user_id": 10322257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bb92e21d9650db19fa6f8a497ff288?s=128&d=identicon&r=PG&f=1", "display_name": "Jmeyer", "link": "https://stackoverflow.com/users/10322257/jmeyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "closed_date": 1536291156, "answer_count": 0, "score": 4, "last_activity_date": 1536289056, "creation_date": 1536181461, "last_edit_date": 1536289056, "question_id": 52193364, "link": "https://stackoverflow.com/questions/52193364/how-can-i-improve-speed-and-efficiency-of-my-vba-code", "closed_reason": "Needs more focus", "title": "How can I improve speed and efficiency of my VBA code", "body": "<p><strong>I'm trying to build an Excel workbook to automate and aid in the creation of a weekly work schedule.</strong></p>\n\n<p>My current workbook is functional, but it's slow - especially on one task where I have a list of people with an annual schedule that I'm searching two sheets at the same time. </p>\n\n<p><strong><em>I think there's a better and more efficient way than the one I'm using</em></strong>. </p>\n\n<pre><code>Option Explicit\n\n'Global variable that will be in another module where I store all general config\n\nPublic Const PlanningAgentEmptyRange        As String = \"C12:G58,F74:G78\" 'Range agent present\nPublic Const PosteWeekDayRange               As String = \"B12:B72\" 'Range agent present\nPublic Const PosteWeekEndRange               As String = \"B73:B78\" 'Range agent present\n\n\nSub DraftFromCycle()\n\n    'If range is empty (to prevent the lost of approved schedule)\n    If Application.WorksheetFunction.CountA(Range(PlanningAgentEmptyRange)) = 0 Then\n\n        'list of day/col Weekday in weekly schedule\n        Dim aWeekDay(1 To 5) As String\n        aWeekDay(1) = \"C\": aWeekDay(2) = \"D\": aWeekDay(3) = \"E\": aWeekDay(4) = \"F\": aWeekDay(5) = \"G\"\n\n        'List of day/col weekEnd in weekly schedule\n        Dim aWeekEnd(1 To 2) As String\n        aWeekEnd(1) = \"F\": aWeekEnd(2) = \"G\"\n\n        Dim DayDate As Range\n        Dim cel As Range\n        Dim Col As Variant\n        Dim DayRangeCycle As Range\n        Dim DayCycleCol As String\n        Dim DayCycleRow As Integer\n        Dim AgentName\n        Dim p, s, poste, x As Variant\n        Dim Cycle_lastrow As Integer\n        Dim Cycle_lastcol As String\n\n\n        Cycle_lastrow = LastRow(Feuil55)\n        Cycle_lastcol = lastCol(Feuil55)\n\n\n        'Loop col/Day  of weekday\n        For Each Col In aWeekDay\n\n            Set DayDate = Range(Col &amp; \"11\")\n            Set s = Worksheets(\"Cycle\").Range(\"A5:OA5\").Find(What:=DayDate, Lookat:=xlWhole)\n            If Not s Is Nothing Then\n                DayCycleCol = ColLetter(s.Column)\n\n                For Each poste In Worksheets(\"Cycle\").Range(DayCycleCol &amp; \"6:\" &amp; DayCycleCol &amp; Cycle_lastrow)\n\n                    Select Case poste\n                    Case Is = \"AM\"\n                        Set x = ActiveSheet.Range(PosteWeekDayRange).Find(What:=\"Apr\u00e8s-midi\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekDayRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Is = \"N\"\n                        Set x = ActiveSheet.Range(PosteWeekDayRange).Find(What:=\"Nuit\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekDayRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Is = \"R N\"\n                        Set x = ActiveSheet.Range(PosteWeekDayRange).Find(What:=\"R\u00e9cup Nuit\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekDayRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Is = \"R Av\"\n                        Set x = ActiveSheet.Range(PosteWeekDayRange).Find(What:=\"R.H. Avant Garde\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekDayRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Is = \"R Ap\"\n                        Set x = ActiveSheet.Range(PosteWeekDayRange).Find(What:=\"R.H. Apr\u00e8s Garde\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekDayRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Is = \"RTP\"\n                        Set x = ActiveSheet.Range(PosteWeekDayRange).Find(What:=\"R.T.P.\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekDayRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Else\n                    End Select\n\n                Next poste\n            End If\n        Next Col\n\n        'Loop col du Week End\n        For Each Col In aWeekEnd\n\n            Set DayDate = Range(Col &amp; \"73\")\n            Set s = Worksheets(\"Cycle\").Range(\"A5:OA5\").Find(What:=DayDate, Lookat:=xlWhole)\n            If Not s Is Nothing Then\n                DayCycleCol = ColLetter(s.Column)\n\n                For Each poste In Worksheets(\"Cycle\").Range(DayCycleCol &amp; \"6:\" &amp; DayCycleCol &amp; Cycle_lastrow)\n\n                    Select Case poste\n                    Case Is = \"AM\"\n                        Set x = ActiveSheet.Range(PosteWeekEndRange).Find(What:=\"Apr\u00e8s-midi\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekEndRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Is = \"N\"\n                        Set x = ActiveSheet.Range(PosteWeekEndRange).Find(What:=\"Nuit\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekEndRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Is = \"6h25\"\n                        Set x = ActiveSheet.Range(PosteWeekEndRange).Find(What:=\"6h25 - 13h25\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekEndRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Is = \"7h30\"\n                        Set x = ActiveSheet.Range(PosteWeekEndRange).Find(What:=\"7h30 - 14h30\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekEndRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Is = \"7h45\"\n                        Set x = ActiveSheet.Range(PosteWeekEndRange).Find(What:=\"7h45 - 14h45\", Lookat:=xlWhole)\n                        If Not x Is Nothing Then\n                            Do\n                                If ActiveSheet.Range(Col &amp; x.row) = \"\" Then\n                                    ActiveSheet.Range(Col &amp; x.row) = Worksheets(\"Cycle\").Range(\"A\" &amp; poste.row).value\n                                    ActiveSheet.Range(Col &amp; x.row).Font.Italic = True\n                                End If\n                                Set x = ActiveSheet.Range(PosteWeekEndRange).FindNext(x)\n                            Loop While Not x Is Nothing\n                        End If\n\n                    Case Else\n                    End Select\n\n                Next poste\n            End If\n        Next Col\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>Here's a screen of what the sheets look like\nthe module take the data from the annual schedule and autofilled the weekly schedule if it's empty </p>\n\n<p><strong>Annual Schedule (Worksheets(\"Cycle\"))</strong> \n<a href=\"https://i.stack.imgur.com/vngAR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vngAR.png\" alt=\"Annual Schedule (Worksheets(&quot;Cycle&quot;)\"></a></p>\n\n<p><strong>Weekly Schedule (Worksheets(\"1\"))</strong>\n<a href=\"https://i.stack.imgur.com/VAbZb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VAbZb.png\" alt=\"Weekly Schedule (Worksheets(&quot;1&quot;)\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1536187461, "creation_date": 1536187461, "answer_id": 52194296, "question_id": 52193226, "link": "https://stackoverflow.com/questions/52193226/inserting-autotext-as-a-row-in-ms-word-using-vba/52194296#52194296", "title": "Inserting AutoText as a row in MS Word using VBA", "body": "<p>The approach I'd take is to use code like:</p>\n\n<pre><code> With Selection.Tables(1).Rows\n    'Insert an empty paragraph after our table, then replace it with a replica of the last row\n    With .Last.Range\n      .Next.InsertBefore vbCr\n      .Next.FormattedText = .FormattedText\n    End With\n    'Reset all content controls in the new last row\n    For Each CCtrl In .Last.Range.ContentControls\n      With CCtrl\n        If .Type = wdContentControlCheckBox Then .Checked = False\n        If .Type = wdContentControlRichText Or .Type = wdContentControlText Then .Range.Text = \"\"\n        If .Type = wdContentControlDropdownList Then .DropdownListEntries(1).Select\n        If .Type = wdContentControlComboBox Then .DropdownListEntries(1).Select\n        If .Type = wdContentControlDate Then .Range.Text = \"\"\n      End With\n    Next\n  End With\n</code></pre>\n\n<p>For a complete ContentControlOnExit macro implementing this in a situation analogous to yours, see: <a href=\"http://www.msofficeforums.com/word-vba/27809-code-add-new-row-table.html#post87989\" rel=\"nofollow noreferrer\">http://www.msofficeforums.com/word-vba/27809-code-add-new-row-table.html#post87989</a></p>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1536217167, "creation_date": 1536217167, "answer_id": 52198198, "question_id": 52193226, "link": "https://stackoverflow.com/questions/52193226/inserting-autotext-as-a-row-in-ms-word-using-vba/52198198#52198198", "title": "Inserting AutoText as a row in MS Word using VBA", "body": "<p>The attempt is very close - it's trying to insert the new row \"on top of\" or \"in\" the last row. The trick is to get the table's <code>Range</code> then collapse it so that the target insertion point is immediately after the table. When table rows are pasted/inserted immediately after an existing table, inside the same paragraph mark, Word auotomatically incorporates them in the existing table.</p>\n\n<pre><code>Private Sub AddInmate_Click()\n    Dim tmpl As Word.Template\n    Dim rngTbl As Word.Range\n\n    Set rngTbl = ActiveDocument.Tables(2).Range\n    rngTbl.Collapse wdCollapseEnd\n    Set tmpl = NormalTemplate\n    tmpl.BuildingBlockEntries(\"Inmate_Row\").Insert _\n        Where:=rngTbl, RichText:=True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7564070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a11352174c01f1af3163f0bc4979ac2?s=128&d=identicon&r=PG&f=1", "display_name": "mtnbiker1185", "link": "https://stackoverflow.com/users/7564070/mtnbiker1185"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 1, "accepted_answer_id": 52198198, "answer_count": 2, "score": 1, "last_activity_date": 1593415211, "creation_date": 1536180681, "last_edit_date": 1593415211, "question_id": 52193226, "link": "https://stackoverflow.com/questions/52193226/inserting-autotext-as-a-row-in-ms-word-using-vba", "title": "Inserting AutoText as a row in MS Word using VBA", "body": "<p>I am attempting to create an \"Add Row\" button in an MS Word 2016 form that will add another row to the bottom of a table that contains text content controls.</p>\n\n<p>Simply adding a row doesn't include the content controls and copying a previous row will also copy over any text that has been added to those content controls, neither of which I want. </p>\n\n<p>I read somewhere that it is possible to save an unpopulated row as AutoText, then insert the AutoText as a new row. I just am unable to find how to do this. I have the unpopulated row saved as AutoText, I just don't know how to add it to the bottom of the table using VBA. </p>\n\n<p>Also, the form will be edit protected. The VBA code needed to unlock the form then relock it I already have. I am just leaving it off for right now while I attempt to figure this out.</p>\n\n<p>I tried the below code, but keep getting a type mismatch error.</p>\n\n<pre><code>Private Sub AddInmate_Click()\n\nActiveDocument.Tables(2).Select\nNormalTemplate.AutoTextEntries(\"Inmate_Row\").Insert _\n    Where:=ActiveDocument.Tables(2).Range.Rows.Last\n\nEnd Sub\n</code></pre>\n\n<p>Any help you all can provide is greatly appreciated.  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1536180551, "post_id": 52193094, "comment_id": 91336127, "body": "Are you certain that the <code>ActiveSheet</code> at the time this code runs is the one you think it is? Right before that line that throws the error, add <code>Debug.Print ws.name, RowNumber.Value</code> run it again and see what shows up in your VBE&#39;s Immediate output window: View&gt;&gt;&quot;Immediate Window&quot; (if it&#39;s not already shown)."}, {"owner": {"reputation": 1, "user_id": 9978998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41786ed2d250adff6b2daaf9f36a962?s=128&d=identicon&r=PG&f=1", "display_name": "Frankly Dear", "link": "https://stackoverflow.com/users/9978998/frankly-dear"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1536181462, "post_id": 52193094, "comment_id": 91336468, "body": "Yes, I ran the code again with the added debug instructions, and the immediate window showed the correct values (&quot;Sheet1&quot; for name, and &quot;199&quot; for value)."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1536182302, "post_id": 52193094, "comment_id": 91336794, "body": "And, just to confirm, if you change nothing else about your code, but replace that <code>RowNumber.Value</code> with <code>199</code> it works?"}, {"owner": {"reputation": 1, "user_id": 9978998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41786ed2d250adff6b2daaf9f36a962?s=128&d=identicon&r=PG&f=1", "display_name": "Frankly Dear", "link": "https://stackoverflow.com/users/9978998/frankly-dear"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1536241264, "post_id": 52193094, "comment_id": 91359927, "body": "I tried replacing the <code>RowNumber.Value</code> with <code>199</code> today, but I still received the 1004 error when running the code. So I created a new macro with just the"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1536242634, "post_id": 52193094, "comment_id": 91360848, "body": "I think the end of your comment was cut off. That&#39;s interesting news though. Assuming it&#39;s still an issue, what happens you manually try to insert 199 rows on that sheet starting at that row?"}, {"owner": {"reputation": 1, "user_id": 9978998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41786ed2d250adff6b2daaf9f36a962?s=128&d=identicon&r=PG&f=1", "display_name": "Frankly Dear", "link": "https://stackoverflow.com/users/9978998/frankly-dear"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1536242788, "post_id": 52193094, "comment_id": 91360948, "body": "@JNevill, see my edit to the OP as to what I think the error is."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9978998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41786ed2d250adff6b2daaf9f36a962?s=128&d=identicon&r=PG&f=1", "display_name": "Frankly Dear", "link": "https://stackoverflow.com/users/9978998/frankly-dear"}, "edited": false, "score": 0, "creation_date": 1536243574, "post_id": 52194192, "comment_id": 91361497, "body": "Initially F2 was containing a Counta function which did the same thing as <code>=ROWS(Table1)</code>, but I changed it to the <code>=ROWS(Table1)</code> function. I then made your suggested change to the macro code, but still received the same 1004 error. See my edit to the OP, for what I think the problem is."}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "reply_to_user": {"reputation": 1, "user_id": 9978998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41786ed2d250adff6b2daaf9f36a962?s=128&d=identicon&r=PG&f=1", "display_name": "Frankly Dear", "link": "https://stackoverflow.com/users/9978998/frankly-dear"}, "edited": false, "score": 0, "creation_date": 1536270405, "post_id": 52194192, "comment_id": 91374538, "body": "What is the significance of A8? Are you trying to always insert at row 8? Or, are you always trying to insert at the end of the table? Because I think I have an answer for you, but I need to know what you hope to accomplish by this line: <code>Range(&quot;A8&quot;).End(xlDown).Select</code>"}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "reply_to_user": {"reputation": 1, "user_id": 9978998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41786ed2d250adff6b2daaf9f36a962?s=128&d=identicon&r=PG&f=1", "display_name": "Frankly Dear", "link": "https://stackoverflow.com/users/9978998/frankly-dear"}, "edited": false, "score": 0, "creation_date": 1536270851, "post_id": 52194192, "comment_id": 91374681, "body": "See the <b>revised</b> section of my answer. I think that might be what you are trying to do."}], "tags": [], "owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "is_accepted": false, "score": 0, "last_activity_date": 1536270809, "last_edit_date": 1536270809, "creation_date": 1536186744, "answer_id": 52194192, "question_id": 52193094, "link": "https://stackoverflow.com/questions/52193094/run-time-error-1004-while-adding-table-rows/52194192#52194192", "title": "Run-time Error 1004 while adding table rows", "body": "<p>Try This:</p>\n\n<p><code>ActiveCell.EntireRow.Resize(CInt(RowNumber.Value)).Insert Shift:=xlDown</code></p>\n\n<p>I was able to reproduce your error in my own spreadsheet. Range(\"F2\").Value was returning a string value when F2 contained the formula <code>=ROWS(Table1)</code>. The conversion fixed it for me.</p>\n\n<p><strong>Revised Answer</strong></p>\n\n<p>The following code will append the number of rows specified in F2 to the table in which A8 resides:</p>\n\n<pre><code>Dim insertIndex As Integer\nDim insertPosition As Integer\n\nWith Range(\"A8\")\n    insertPosition = .Row - .ListObject.Range.Row\n    With .ListObject.ListRows\n        For insertIndex = 1 To CInt(Range(\"F2\").Value)\n            .Add\n        Next\n    End With\nEnd With\n</code></pre>\n\n<p>That works even if there is a table immediately below the table in which A8 resides.</p>\n"}], "owner": {"reputation": 1, "user_id": 9978998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41786ed2d250adff6b2daaf9f36a962?s=128&d=identicon&r=PG&f=1", "display_name": "Frankly Dear", "link": "https://stackoverflow.com/users/9978998/frankly-dear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 396, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593761546, "creation_date": 1536179979, "last_edit_date": 1593761546, "question_id": 52193094, "link": "https://stackoverflow.com/questions/52193094/run-time-error-1004-while-adding-table-rows", "title": "Run-time Error 1004 while adding table rows", "body": "<p>I am trying to use the following code to add rows to a table. I need the number of rows to be dynamic because I am adding rows from one table to my main table, and the number of rows in the supplementary table can vary.</p>\n\n<p>Currently, cell F2 counts the number of rows in the supplementary table, and this is supposed to be how many rows the macro adds to my main table. However, when referencing the <em>RowNumber</em> variable, I receive the error message \"Insert method of range class failed\".</p>\n\n<p>I tried replacing the variable with different numbers, and then the code runs fine. However, whenever I use the variable, I get the error message.</p>\n\n<p>Appreciate any help.</p>\n\n<pre><code>Sub AddRows()\n\nDim ws As Worksheet\nDim RowNumber As Range\n\nSet ws = ThisWorkbook.ActiveSheet\n\n    With ws\n        Set RowNumber = .Range(\"F2\")\n        Range(\"A8\").End(xlDown).Select\n        ActiveCell.EntireRow.Resize(RowNumber.Value).Insert Shift:=xlDown\n    End With\n\nRange(\"tblDetail\").Select\nRange(\"A10\").Activate\nSelection.FillDown\n\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: I think I am receiving the error because I have a table which starts three rows below my main table (this is an import file for online accounting software, which requires a certain number of tables). I played around with the value in F2: anything greater than \"4\" in F2 results in the 1004 error (assuming the active cell when the macro is run is in the last row of my main table). Anything less than 4, and the code runs fine.</p>\n\n<p>Is there maybe a way to use variables with the <code>listrows.add</code> function, since my main table is a list object?</p>\n"}, {"tags": ["vba", "excel", "paste", "delete-row"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 3, "creation_date": 1536180305, "post_id": 52193060, "comment_id": 91336028, "body": "please share the code you have written and tell us which part of it is not working"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 9254726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9070bdb0341821aed239bfa229c8f43a?s=128&d=identicon&r=PG&f=1", "display_name": "5E4ME", "link": "https://stackoverflow.com/users/9254726/5e4me"}, "is_accepted": false, "score": 0, "last_activity_date": 1536182753, "creation_date": 1536182753, "answer_id": 52193599, "question_id": 52193060, "link": "https://stackoverflow.com/questions/52193060/vba-cut-and-paste-row-to-another-sheet-based-on-cell-value-and-delete-empty-row/52193599#52193599", "title": "VBA cut and paste row to another sheet based on cell value and delete empty row", "body": "<p>In the solution you link in your question, changing</p>\n\n<pre><code>If .Cells(n, \"G\") = \"\" Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If .Cells(n, \"G\") &lt;&gt; \"\" Then\n</code></pre>\n\n<p>should accomplish your objective of copy-paste-deleting rows with data in the given column \"G\"</p>\n"}], "owner": {"reputation": 1, "user_id": 10322249, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3lOnE_VnGGQ/AAAAAAAAAAI/AAAAAAAAAD4/wVL_ilX7xO0/photo.jpg?sz=128", "display_name": "James Ludwig", "link": "https://stackoverflow.com/users/10322249/james-ludwig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536197005, "creation_date": 1536179801, "last_edit_date": 1536197005, "question_id": 52193060, "link": "https://stackoverflow.com/questions/52193060/vba-cut-and-paste-row-to-another-sheet-based-on-cell-value-and-delete-empty-row", "title": "VBA cut and paste row to another sheet based on cell value and delete empty row", "body": "<p>Hi I have almost no experience coding. I took a crappy high school course, but I need to create code to cut rows from one sheet to the next empty line on another \"archive\" sheet when a condition (ex cell F) has data in it. Then delete the now empty row that was cut from. Ideally this would be done once the worksheet was saved as well. I've found a few things that come close but for some reason they won't work\nI'm using Excel 2016 if that helps</p>\n\n<p><a href=\"https://stackoverflow.com/questions/24131874/cutting-row-with-data-and-moving-to-different-sheet-vba\">This solution was close but didn't work for me</a></p>\n\n<p>Any help would be greatly appreciated thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536178528, "post_id": 52192646, "comment_id": 91335315, "body": "Are you able to supply the userform code?"}, {"owner": {"reputation": 29, "user_id": 9989280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1IanxvATT3g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1Qx2XOH6YEYGYiLvPM8Q2G9hyRkQ/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9989280/daniel"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536333379, "post_id": 52192646, "comment_id": 91400080, "body": "@Davesexcel Any ideas on what is causing the runtime error?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536343849, "post_id": 52192646, "comment_id": 91404740, "body": "I don&#39;t see where the userform opens another workbook"}, {"owner": {"reputation": 29, "user_id": 9989280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1IanxvATT3g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1Qx2XOH6YEYGYiLvPM8Q2G9hyRkQ/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9989280/daniel"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536348164, "post_id": 52192646, "comment_id": 91406577, "body": "@Davesexcel Those are additional modules. I can post those as well. One moment."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536348271, "post_id": 52192646, "comment_id": 91406621, "body": "What line does the error occur?"}, {"owner": {"reputation": 29, "user_id": 9989280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1IanxvATT3g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1Qx2XOH6YEYGYiLvPM8Q2G9hyRkQ/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9989280/daniel"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536348395, "post_id": 52192646, "comment_id": 91406681, "body": "@Davesexcel Refer to the first paragraph I posted. Right here <i>Auto_Fill_Form.Show</i>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536581974, "post_id": 52192646, "comment_id": 91462476, "body": "The reason the error shows in that line would be an indication you have an error in the initialize code or activate code. If you can place a stop in the initialize code so you can step through the code to see where it errors."}, {"owner": {"reputation": 29, "user_id": 9989280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1IanxvATT3g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1Qx2XOH6YEYGYiLvPM8Q2G9hyRkQ/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9989280/daniel"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536584108, "post_id": 52192646, "comment_id": 91463753, "body": "<a href=\"https://www.dropbox.com/sh/u94dv2rumi93zvc/AADnFOPJYyDza0yo_OHWB-hpa?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/sh/u94dv2rumi93zvc/AADnFOPJYyDza0yo_OHWB-hpa?dl=&zwnj;&#8203;0</a>"}, {"owner": {"reputation": 29, "user_id": 9989280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1IanxvATT3g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1Qx2XOH6YEYGYiLvPM8Q2G9hyRkQ/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9989280/daniel"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536584179, "post_id": 52192646, "comment_id": 91463803, "body": "@Davesexcel Here is a drop box link. To make this easier. I tried to use the on error resume next but if I did that the for would not open again."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536586246, "post_id": 52192646, "comment_id": 91465224, "body": "The problem is in the <code>Public Property Get Locations() As Workbook</code>, it skips over this line <code>Const sPath As String = &quot;V:\\My Stuff\\Templates\\Work Order Batch Creation Template\\WorkOrderDatabase.xlsm&quot;</code> I don&#39;t know how to fix it. My assumption is the code does not recognize the workbook is closed."}, {"owner": {"reputation": 29, "user_id": 9989280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1IanxvATT3g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1Qx2XOH6YEYGYiLvPM8Q2G9hyRkQ/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9989280/daniel"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536587332, "post_id": 52192646, "comment_id": 91465955, "body": "@Davesexcel Did you change it to the currently location on your computer? That was my personal directory."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536588486, "post_id": 52192646, "comment_id": 91466691, "body": "Yes, like you said, it works the first time, when I closed the userform, it closed the workbook.You can just use a code in the userform initialize code, to open the workbook and collect the data, then close the workbook, instead of having all that confusing code."}, {"owner": {"reputation": 29, "user_id": 9989280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1IanxvATT3g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1Qx2XOH6YEYGYiLvPM8Q2G9hyRkQ/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9989280/daniel"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536589327, "post_id": 52192646, "comment_id": 91467189, "body": "@Davesexcel can you show me I am still new to vba the way I did it was the only way I knew how."}, {"owner": {"reputation": 29, "user_id": 9989280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1IanxvATT3g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1Qx2XOH6YEYGYiLvPM8Q2G9hyRkQ/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9989280/daniel"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536592222, "post_id": 52192646, "comment_id": 91469040, "body": "@Davesexcel I did what you said and removed the module and just manually entered everything now it works no issue. Thank you!!!"}], "answers": [{"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 29, "user_id": 9989280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1IanxvATT3g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1Qx2XOH6YEYGYiLvPM8Q2G9hyRkQ/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9989280/daniel"}, "edited": false, "score": 0, "creation_date": 1536594009, "post_id": 52260798, "comment_id": 91470093, "body": "There are a lot of threads on that, your original question has been answered, continuing on with this thread is just going to clutter it."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1536592303, "creation_date": 1536592303, "answer_id": 52260798, "question_id": 52192646, "link": "https://stackoverflow.com/questions/52192646/run-time-error-2147221080-800401a8-method-worksheets-of-object-workbook/52260798#52260798", "title": "Run-Time error &#39;-2147221080 (800401a8)&#39; Method &#39;Worksheets&#39; of object &#39;_Workbook&#39; failed", "body": "<p>Open the workbook to collect the data.\nIf you close the wb right away, you will have to get rid of the <code>workbook.close</code> line in the \"Quit\" Button</p>\n\n<pre><code>    Private Sub UserForm_Initialize()\n        Dim wb As Workbook\n        Set wb = Workbooks.Open(\"C:\\Users\\dmorrison\\Downloads\\TestRemoveLater\\WorkOrderDatabase-1.xlsm\")\n\n        'Empty Form\n        TextBox1.Value = \"\"\n        TextBox2.Value = \"\"\n        TextBox3.Value = \"\"\n        TextBox4.Value = \"\"\n        ComboBox1.Value = Null\n\n        'Initialized value\n        TextBox5.Value = \"A\"\n        ComboBox2.Value = \"N/A\"\n        ComboBox3.Value = \"N/A\"\n        ComboBox4.Value = \"N/A\"\n        ComboBox5.Value = \"N/A\"\n        ComboBox6.Value = \"N/A\"\n        ComboBox7.Value = \"N/A\"\n\n        With wb\n            Me.ComboBox1.List = .Worksheets(Page).ListObjects(\"Table15\").ListColumns(1).DataBodyRange.Value\n            Me.ComboBox2.List = .Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\n            Me.ComboBox3.List = .Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\n            Me.ComboBox4.List = .Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\n            Me.ComboBox5.List = .Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\n            Me.ComboBox6.List = .Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\n            Me.ComboBox7.List = .Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\n'.close\n        End With\n\n        TextBox7.Value = \"\"\n        TextBox8.Value = \"\"\n        TextBox9.Value = \"\"\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9989280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1IanxvATT3g/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1Qx2XOH6YEYGYiLvPM8Q2G9hyRkQ/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9989280/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 52260798, "answer_count": 1, "score": 1, "last_activity_date": 1593761307, "creation_date": 1536177789, "last_edit_date": 1593761307, "question_id": 52192646, "link": "https://stackoverflow.com/questions/52192646/run-time-error-2147221080-800401a8-method-worksheets-of-object-workbook", "title": "Run-Time error &#39;-2147221080 (800401a8)&#39; Method &#39;Worksheets&#39; of object &#39;_Workbook&#39; failed", "body": "<p>I have a useform that will open another work book when opened and close the workbook when closed. This works well the first time, but when I go to open the userform again it shoots out the runtime error. I can use some help on this issue I have not been able to determine what the issue is. Below is the error line in italics:</p>\n\n<pre><code>Sub Auto_Open()\n    Application.OnKey \"{F3}\", \"ShowForm\"\nEnd Sub\n\nSub ShowForm()\n    *Auto_Fill_Form.Show*\nEnd Sub\n</code></pre>\n\n<p>The button I use to exit the userform is shown below:</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n\nWorkbooks(\"WorkOrderDatabase.xlsm\").Close SaveChanges:=True\nUnload Me\n\nEnd Sub\n</code></pre>\n\n<p>Userform Code:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nCall UserForm_Initialize\n\nEnd Sub\n\nPrivate Sub CommandButton4_Click()\n\n'ComboBox1.Value = \"\"\nWorkbooks(\"WorkOrderDatabase.xlsm\").Close SaveChanges:=True\nUnload Me\n\nEnd Sub\n\nPrivate Sub CommandButton5_Click()\n        Me.Width = 480\n        Me.Height = 520\n            Auto_Fill_Form.Label26.Visible = True\n            Auto_Fill_Form.TextBox15.Visible = True\n            Auto_Fill_Form.CommandButton7.Visible = True\n\n            Auto_Fill_Form.Label22.Visible = False\n            Auto_Fill_Form.TextBox16.Visible = False\n            Auto_Fill_Form.Label23.Visible = False\n            Auto_Fill_Form.TextBox17.Visible = False\n            Auto_Fill_Form.Label24.Visible = False\n            Auto_Fill_Form.TextBox18.Visible = False\n            Auto_Fill_Form.Label25.Visible = False\n            Auto_Fill_Form.TextBox19.Visible = False\n            Auto_Fill_Form.CommandButton8.Visible = False\n\n        TextBox15 = Translate(TextBox10.Value, \"en\", \"es\", True)\n        SortAsc2\n\nEnd Sub\n\nPrivate Sub CommandButton6_Click()\n     Me.Width = 480\n     Me.Height = 520\n            Auto_Fill_Form.Label22.Visible = True\n            Auto_Fill_Form.TextBox16.Visible = True\n            Auto_Fill_Form.Label23.Visible = True\n            Auto_Fill_Form.TextBox17.Visible = True\n            Auto_Fill_Form.Label24.Visible = True\n            Auto_Fill_Form.TextBox18.Visible = True\n            Auto_Fill_Form.Label25.Visible = True\n            Auto_Fill_Form.TextBox19.Visible = True\n            Auto_Fill_Form.CommandButton8.Visible = True\n\n            Auto_Fill_Form.Label26.Visible = False\n            Auto_Fill_Form.TextBox15.Visible = False\n            Auto_Fill_Form.CommandButton7.Visible = False\n\n        TextBox16 = Translate(TextBox11.Value, \"en\", \"es\", True)\n        TextBox17 = Translate(TextBox12.Value, \"en\", \"es\", True)\n        TextBox18 = Translate(TextBox13.Value, \"en\", \"es\", True)\n        TextBox19 = Translate(TextBox14.Value, \"en\", \"es\", True)\n\nEnd Sub\n\nPrivate Sub CommandButton7_Click()\n\nDim rng As Range\nSet rng = Locations.Worksheets(Page).ListObjects(\"Table15\").Range\nDim LastRow As Long\nLastRow = rng.Find(What:=\"*\", _\nAfter:=rng.Cells(1), _\nLookat:=xlPart, _\nLookIn:=xlFormulas, _\nSearchOrder:=xlByRows, _\nSearchDirection:=xlPrevious, _\nMatchCase:=False).Row\n\n    rng.Parent.Cells(LastRow + 1, 1).Value = TextBox10.Value\n    rng.Parent.Cells(LastRow + 1, 2).Value = TextBox15.Value\nSortAsc2\nEnd Sub\n\nPrivate Sub CommandButton8_Click()\n\nDim rng As Range\nSet rng = Locations.Worksheets(Page).ListObjects(\"Table24\").Range\nDim LastRow As Long\nLastRow = rng.Find(What:=\"*\", _\nAfter:=rng.Cells(1), _\nLookat:=xlPart, _\nLookIn:=xlFormulas, _\nSearchOrder:=xlByRows, _\nSearchDirection:=xlPrevious, _\nMatchCase:=False).Row\n\n    rng.Parent.Cells(LastRow + 1, 4).Value = TextBox11.Value\n    rng.Parent.Cells(LastRow + 1, 5).Value = TextBox12.Value\n    rng.Parent.Cells(LastRow + 1, 6).Value = TextBox13.Value\n    rng.Parent.Cells(LastRow + 1, 7).Value = TextBox14.Value\n    rng.Parent.Cells(LastRow + 1, 8).Value = TextBox16.Value\n    rng.Parent.Cells(LastRow + 1, 9).Value = TextBox17.Value\n    rng.Parent.Cells(LastRow + 1, 10).Value = TextBox18.Value\n    rng.Parent.Cells(LastRow + 1, 11).Value = TextBox19.Value\nSortAsc2\nEnd Sub\n\nPrivate Sub OkButton_Click()\n\nThisWorkbook.Sheets(\"WO_Cover\").Cells(1, 9).Value = TextBox1.Value\nThisWorkbook.Sheets(\"First Piece Inspection\").Cells(5, 7).Value = TextBox1.Value\nThisWorkbook.Sheets(\"Production Inspection\").Cells(5, 7).Value = TextBox1.Value\n\nThisWorkbook.Sheets(\"WO_Cover\").Cells(3, 2).Value = TextBox2.Value\nThisWorkbook.Sheets(\"WO_Cover\").Cells(3, 8).Value = TextBox3.Value\nThisWorkbook.Sheets(\"WO_Cover\").Cells(4, 8).Value = TextBox4.Value\nThisWorkbook.Sheets(\"WO_Cover\").Cells(4, 5).Value = TextBox5.Value\n\nThisWorkbook.Sheets(\"WO_Cover\").Cells(5, 2).Value = ComboBox1.Value\n\nThisWorkbook.Sheets(\"WO_Cover\").Cells(10, 1).Value = TextBox7.Value\nThisWorkbook.Sheets(\"WO_Cover\").Cells(10, 3).Value = TextBox8.Value\nThisWorkbook.Sheets(\"WO_Cover\").Cells(20, 3).Value = TextBox9.Value\n\nThisWorkbook.Sheets(\"WO_Cover\").Cells(21, 2).Value = ComboBox2.Value\nThisWorkbook.Sheets(\"WO_Cover\").Cells(24, 2).Value = ComboBox3.Value\nThisWorkbook.Sheets(\"WO_Cover\").Cells(27, 2).Value = ComboBox4.Value\nThisWorkbook.Sheets(\"WO_Cover\").Cells(30, 2).Value = ComboBox5.Value\nThisWorkbook.Sheets(\"WO_Cover\").Cells(33, 2).Value = ComboBox6.Value\nThisWorkbook.Sheets(\"WO_Cover\").Cells(36, 2).Value = ComboBox7.Value\n\nEnd Sub\n\nPrivate Sub OptionButton1_Click()\n    If OptionButton1.Value Then\n        Me.Width = 375\n        Me.Height = 520\n            Auto_Fill_Form.Label17.Visible = True\n            Auto_Fill_Form.TextBox10.Visible = True\n            Auto_Fill_Form.CommandButton5.Visible = True\n\n            Auto_Fill_Form.Label18.Visible = False\n            Auto_Fill_Form.TextBox11.Visible = False\n            Auto_Fill_Form.Label19.Visible = False\n            Auto_Fill_Form.TextBox12.Visible = False\n            Auto_Fill_Form.Label20.Visible = False\n            Auto_Fill_Form.TextBox13.Visible = False\n            Auto_Fill_Form.Label21.Visible = False\n            Auto_Fill_Form.TextBox14.Visible = False\n            Auto_Fill_Form.CommandButton6.Visible = False\n    Else\n        Me.Width = 250\n        Me.Height = 520\n            Auto_Fill_Form.Label17.Visible = False\n            Auto_Fill_Form.TextBox10.Visible = False\n            Auto_Fill_Form.CommandButton5.Visible = False\n    End If\nEnd Sub\n\nPrivate Sub OptionButton2_Click()\n If OptionButton2.Value Then\n        Me.Width = 375\n        Me.Height = 520\n            Auto_Fill_Form.Label18.Visible = True\n            Auto_Fill_Form.TextBox11.Visible = True\n            Auto_Fill_Form.Label19.Visible = True\n            Auto_Fill_Form.TextBox12.Visible = True\n            Auto_Fill_Form.Label20.Visible = True\n            Auto_Fill_Form.TextBox13.Visible = True\n            Auto_Fill_Form.Label21.Visible = True\n            Auto_Fill_Form.TextBox14.Visible = True\n            Auto_Fill_Form.CommandButton6.Visible = True\n\n            Auto_Fill_Form.Label17.Visible = False\n            Auto_Fill_Form.TextBox10.Visible = False\n            Auto_Fill_Form.CommandButton5.Visible = False\n    Else\n        Me.Width = 250\n        Me.Height = 520\n            Auto_Fill_Form.Label18.Visible = False\n            Auto_Fill_Form.TextBox11.Visible = False\n            Auto_Fill_Form.Label19.Visible = False\n            Auto_Fill_Form.TextBox12.Visible = False\n            Auto_Fill_Form.Label20.Visible = False\n            Auto_Fill_Form.TextBox13.Visible = False\n            Auto_Fill_Form.Label21.Visible = False\n            Auto_Fill_Form.TextBox14.Visible = False\n            Auto_Fill_Form.CommandButton6.Visible = False\n    End If\nEnd Sub\n\n\nPrivate Sub UserForm_Activate()\n\nTextBox1.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(1, 9).Value\nTextBox2.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(3, 2).Value\nTextBox3.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(3, 8).Value\nTextBox4.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(4, 8).Value\n'TextBox5.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(4, 5).Value\n\nComboBox1.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(5, 2).Value\n\nTextBox7.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(10, 1).Value\nTextBox8.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(10, 3).Value\nTextBox9.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(20, 3).Value\n\nComboBox2.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(21, 2).Value\nComboBox3.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(24, 2).Value\nComboBox4.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(27, 2).Value\nComboBox5.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(30, 2).Value\nComboBox6.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(33, 2).Value\nComboBox7.Value = ThisWorkbook.Sheets(\"WO_Cover\").Cells(36, 2).Value\n            Auto_Fill_Form.Label17.Visible = False\n            Auto_Fill_Form.TextBox10.Visible = False\n            Auto_Fill_Form.Label18.Visible = False\n            Auto_Fill_Form.TextBox11.Visible = False\n            Auto_Fill_Form.Label19.Visible = False\n            Auto_Fill_Form.TextBox12.Visible = False\n            Auto_Fill_Form.Label20.Visible = False\n            Auto_Fill_Form.TextBox13.Visible = False\n            Auto_Fill_Form.Label21.Visible = False\n            Auto_Fill_Form.TextBox14.Visible = False\n            Auto_Fill_Form.CommandButton5.Visible = False\n            Auto_Fill_Form.CommandButton6.Visible = False\n\n            Auto_Fill_Form.Label26.Visible = False\n            Auto_Fill_Form.TextBox15.Visible = False\n            Auto_Fill_Form.CommandButton7.Visible = False\n\n            Auto_Fill_Form.Label22.Visible = False\n            Auto_Fill_Form.TextBox16.Visible = False\n            Auto_Fill_Form.Label23.Visible = False\n            Auto_Fill_Form.TextBox17.Visible = False\n            Auto_Fill_Form.Label24.Visible = False\n            Auto_Fill_Form.TextBox18.Visible = False\n            Auto_Fill_Form.Label25.Visible = False\n            Auto_Fill_Form.TextBox19.Visible = False\n            Auto_Fill_Form.CommandButton8.Visible = False\n'TextBox10.Value =\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n'Empty Form\nTextBox1.Value = \"\"\nTextBox2.Value = \"\"\nTextBox3.Value = \"\"\nTextBox4.Value = \"\"\nComboBox1.Value = Null\n\n'Initialized value\nTextBox5.Value = \"A\"\nComboBox2.Value = \"N/A\"\nComboBox3.Value = \"N/A\"\nComboBox4.Value = \"N/A\"\nComboBox5.Value = \"N/A\"\nComboBox6.Value = \"N/A\"\nComboBox7.Value = \"N/A\"\n\nMe.ComboBox1.List = Locations.Worksheets(Page).ListObjects(\"Table15\").ListColumns(1).DataBodyRange.Value\nMe.ComboBox2.List = Locations.Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\nMe.ComboBox3.List = Locations.Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\nMe.ComboBox4.List = Locations.Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\nMe.ComboBox5.List = Locations.Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\nMe.ComboBox6.List = Locations.Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\nMe.ComboBox7.List = Locations.Worksheets(Page).ListObjects(\"Table24\").ListColumns(1).DataBodyRange.Value\n\n\nTextBox7.Value = \"\"\nTextBox8.Value = \"\"\nTextBox9.Value = \"\"\nEnd Sub\n</code></pre>\n\n<p>Module 1:</p>\n\n<pre><code>Private wLocations As Workbook\n\nPublic Const Page = \"Description - Processes\"\n\nPublic Property Get Locations() As Workbook\n  Const sPath As String = \"V:\\My Stuff\\Templates\\Work Order Batch Creation Template\\WorkOrderDatabase.xlsm\"\n  Dim sFile As String\n\n  If wLocations Is Nothing Then\n      'extract file name from full path\n      sFile = Dir(sPath)\n\n      On Error Resume Next\n\n      'check if the file is already open\n      Set wLocations = Workbooks(sFile)\n\n      If wLocations Is Nothing Then\n        Set wLocations = Workbooks.Open(sPath)\n      End If\n\n      On Error GoTo 0\n  End If\n  Set Locations = wLocations\nEnd Property\n</code></pre>\n\n<p>Module 2:</p>\n\n<pre><code>Sub Auto_Open()\n    Application.OnKey \"{F3}\", \"ShowForm\"\nEnd Sub\n\nSub ShowForm()\n    Auto_Fill_Form.Show\nEnd Sub\n</code></pre>\n\n<p>Module 3:</p>\n\n<pre><code>Sub SortAsc2()\n\n    Locations.Worksheets(Page).Range(\"A2:B16\").Sort Key1:=Locations.Worksheets(Page).Range(\"A2\"), _\n    Order1:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:=False, _\n    Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\n\n    Locations.Worksheets(Page).Range(\"D2:K16\").Sort Key1:=Locations.Worksheets(Page).Range(\"D2\"), _\n    Order1:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:=False, _\n    Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\n\n'    Locations.Worksheets(\"Description - Processes\").Range(\"A2:B16\").Sort Key1:=Locations.Worksheets(\"Description - Processes\").Range(\"A2\"), _\n'    Order1:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase:=False, _\n'    Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\n'\n'    Locations.Worksheets(\"Description - Processes\").Range(\"D2:K16\").Sort Key1:=Locations.Worksheets(\"Description - Processes\").Range(\"D2\"), _\n'    Order1:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase:=False, _\n'    Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\n\nEnd Sub\n</code></pre>\n\n<p>Module 4:</p>\n\n<pre><code>Public Function Translate(strInput As String, strFromLanguageCode As String, strToLanguageCode As String, blnTargetAlphabet As Boolean) As String\n\n    Dim strURL As String\n    Dim objHTTP As Object\n    Dim objHTML As Object\n    Dim objDivs As Object, objDiv\n    Dim strTranslatedT0 As String\n    Dim strTranslatedO1 As String\n\n    ' send query to web page\n    strURL = \"https://translate.google.com/m?hl=\" &amp; strFromLanguageCode &amp; _\n        \"&amp;sl=\" &amp; strFromLanguageCode &amp; _\n        \"&amp;tl=\" &amp; strToLanguageCode &amp; _\n        \"&amp;ie=UTF-8&amp;prev=_m&amp;q=\" &amp; strInput\n\n    Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n    objHTTP.Open \"GET\", strURL, False\n    objHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n    objHTTP.send \"\"\n\n    ' create a html document\n    Set objHTML = CreateObject(\"htmlfile\")\n    With objHTML\n        .Open\n        .Write objHTTP.responseText\n        .Close\n    End With\n\n    ' o1 has Anglicised translation, t0 as tranlsation in target language\n    Set objDivs = objHTML.getElementsByTagName(\"div\")\n    For Each objDiv In objDivs\n        If objDiv.className = \"o1\" Then\n            strTranslatedO1 = objDiv.innerText\n        End If\n        If objDiv.className = \"t0\" Then\n            strTranslatedT0 = objDiv.innerText\n        End If\n    Next objDiv\n\n    ' choose which to return\n    If blnTargetAlphabet Then\n        Translate = strTranslatedT0\n    Else\n        Translate = strTranslatedO1\n    End If\n\nCleanUp:\n    Set objHTML = Nothing\n    Set objHTTP = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer", "automation", "html-parsing"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1536177129, "post_id": 52192478, "comment_id": 91334716, "body": "Can you share the URL? Or at least the html that is relevant. It is also possible an element is created on the fly. You also declare as InternetExplorer but then Set as New InternetExplorerMeduim. Use one or the other."}, {"owner": {"reputation": 1, "user_id": 10321956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610ca8a3a4e9ec2d52572e9281905484?s=128&d=identicon&r=PG&f=1", "display_name": "L.A. ", "link": "https://stackoverflow.com/users/10321956/l-a"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536177679, "post_id": 52192478, "comment_id": 91334960, "body": "Unfortunately, I cannot share the URL. It is an intranet URL requiring credentials."}, {"owner": {"reputation": 1, "user_id": 10321956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610ca8a3a4e9ec2d52572e9281905484?s=128&d=identicon&r=PG&f=1", "display_name": "L.A. ", "link": "https://stackoverflow.com/users/10321956/l-a"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536177698, "post_id": 52192478, "comment_id": 91334965, "body": "&lt;DIV class=&quot;clip9x9 di-img&quot; onclick=\u201d_Ewa.Gim.tpdfce(event);\u201d&gt;           &lt;INPUT title=Expand class=ewaboot_expand type=image alt=Expand src=&quot;http://.../images/...&quot;&gt;&lt;/DIV&gt;"}, {"owner": {"reputation": 1, "user_id": 10321956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610ca8a3a4e9ec2d52572e9281905484?s=128&d=identicon&r=PG&f=1", "display_name": "L.A. ", "link": "https://stackoverflow.com/users/10321956/l-a"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536177736, "post_id": 52192478, "comment_id": 91334984, "body": "For some reason the HTML code above did not appear in my original question. I hope this might help"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536179025, "post_id": 52192478, "comment_id": 91335506, "body": "Does it really have the \u201d   ? I wonder if that has been changed from &quot; during copy paste. In this part:  onclick=\u201d_Ewa.Gim.tpdfce(event);\u201d  should it be  onclick=&quot;_Ewa.Gim.tpdfce(event);&quot;"}, {"owner": {"reputation": 1, "user_id": 10321956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610ca8a3a4e9ec2d52572e9281905484?s=128&d=identicon&r=PG&f=1", "display_name": "L.A. ", "link": "https://stackoverflow.com/users/10321956/l-a"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536179878, "post_id": 52192478, "comment_id": 91335843, "body": "Actually the &quot; appears only in the DOM Explorer in IE. When I copied-pasted the code, the &quot; was not appearing. Here is the code"}, {"owner": {"reputation": 1, "user_id": 10321956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610ca8a3a4e9ec2d52572e9281905484?s=128&d=identicon&r=PG&f=1", "display_name": "L.A. ", "link": "https://stackoverflow.com/users/10321956/l-a"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536179884, "post_id": 52192478, "comment_id": 91335846, "body": "&lt;DIV class=&quot;clip9x9 di-img&quot; onclick=_Ewa.Gim.tpdfce(event);&gt;&lt;INPUT title=Expand class=ewaboot_expand type=image alt=Expand src=&quot;http://...&quot;&gt;&lt;/DIV&gt;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536184201, "post_id": 52192478, "comment_id": 91337417, "body": "you might want to look into creating a keyboard event and seeing if you can use InitEvent even though deprecated someone in last few days posted an answer saying that worked for them by creating an event and then firing it."}], "owner": {"reputation": 1, "user_id": 10321956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610ca8a3a4e9ec2d52572e9281905484?s=128&d=identicon&r=PG&f=1", "display_name": "L.A. ", "link": "https://stackoverflow.com/users/10321956/l-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1162, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536180354, "creation_date": 1536176983, "last_edit_date": 1536180227, "question_id": 52192478, "link": "https://stackoverflow.com/questions/52192478/vba-automate-ie-element-click-and-element-fireevent-onclick-not-working", "title": "VBA Automate IE: element.click and element.FireEvent (OnClick) Not working", "body": "<p>I am trying to parse a web based pivot table. \nUnfortunately, I need to expand additional lines in the web based pivot table in order to access all the data I need. I think that when I click on the + sign to expand additional lines, a script downloads the additional data from the database.</p>\n\n<p>Anyway, here is the html code of the + sign:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;DIV class=\"clip9x9 di-img\" onclick=_Ewa.Gim.tpdfce(event);&gt;\r\n    &lt;INPUT title=Expand class=ewaboot_expand type=image alt=Expand src=\"http://...\"&gt;\r\n&lt;/DIV&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I manage to get the correct element into an variable using <code>IE.document.getElementsByTagName(\"Div\")</code> and a If Loop (for some reason the <code>GetElementByClassName</code> would crash my IE), but none of the <code>.Click</code> or <code>.FireEvent (OnClick)</code> methods works. I also tried both methods on the Input element below the <code>DIV</code>, and these are not working either. \nHere is the code</p>\n\n<pre><code>Sub Test()\n    Dim IE As InternetExplorer\n    Dim div As Variant\n    Dim Obj As Variant\n    Dim WebUrl As String\n\n    WebUrl = \"http://..../filename.aspx\"\n    Set IE = New InternetExplorerMedium\n    Sleep 1000\n    IE.Visible = True\n    IE.navigate WebUrl\n    Do While IE.Busy Or IE.readyState &lt;&gt; READYSTATE_COMPLETE\n        Sleep 1000\n    Loop\n\n    Set div = IE.document.getElementsByTagName(\"Div\")\n\n    For Each Obj In div\n        If Obj.className = \"clip9x9 di-img\" Then\n            Obj.Click\n            Obj.FireEvent (\"OnClick\")\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>When I look at the onclick attribute of my Obj element in th Spy Window (VBA editor), the onclick property has a + sign aside, and when inspecting inside it, no variable is attributed to it. I find it weird since the HTML code indicates a <code>value =\u201d_Ewa.Gim.tpdfce(event);\u201d</code> which I believe refers to the script that expands the pivot table line.</p>\n\n<p>Any help would be much appreciated </p>\n"}, {"tags": ["excel", "vba", "max", "min"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1536175002, "post_id": 52191966, "comment_id": 91333772, "body": "Where is <code>lastrow</code> assigned? That&#39;s effectively <code>For i = 2 To 0</code>."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7994471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea02db516050d99baff88c31bc63f925?s=128&d=identicon&r=PG&f=1", "display_name": "S. Caruso", "link": "https://stackoverflow.com/users/7994471/s-caruso"}, "edited": false, "score": 0, "creation_date": 1536175799, "post_id": 52192060, "comment_id": 91334140, "body": "I also need to have that min and or max be attached to a ticker symbol from another column. Would you know where to start with that?"}, {"owner": {"reputation": 703, "user_id": 5142585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWQdR.jpg?s=128&g=1", "display_name": "Pm Duda", "link": "https://stackoverflow.com/users/5142585/pm-duda"}, "reply_to_user": {"reputation": 31, "user_id": 7994471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea02db516050d99baff88c31bc63f925?s=128&d=identicon&r=PG&f=1", "display_name": "S. Caruso", "link": "https://stackoverflow.com/users/7994471/s-caruso"}, "edited": false, "score": 0, "creation_date": 1536175975, "post_id": 52192060, "comment_id": 91334219, "body": "Don&#39;t mean to be rude, but google.com ;) Probably you need a Function, not a Sub. And use this function to attache - but it&#39;s only guessing."}, {"owner": {"reputation": 703, "user_id": 5142585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWQdR.jpg?s=128&g=1", "display_name": "Pm Duda", "link": "https://stackoverflow.com/users/5142585/pm-duda"}, "reply_to_user": {"reputation": 31, "user_id": 7994471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea02db516050d99baff88c31bc63f925?s=128&d=identicon&r=PG&f=1", "display_name": "S. Caruso", "link": "https://stackoverflow.com/users/7994471/s-caruso"}, "edited": false, "score": 0, "creation_date": 1536179283, "post_id": 52192060, "comment_id": 91335612, "body": "If you feel that my answer helped you, you could <a href=\"http://meta.stackexchange.com/a/5235\">accept my answer</a>."}], "tags": [], "owner": {"reputation": 703, "user_id": 5142585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWQdR.jpg?s=128&g=1", "display_name": "Pm Duda", "link": "https://stackoverflow.com/users/5142585/pm-duda"}, "is_accepted": true, "score": 3, "last_activity_date": 1536175150, "creation_date": 1536175150, "answer_id": 52192060, "question_id": 52191966, "link": "https://stackoverflow.com/questions/52191966/finding-min-and-max-in-a-range-in-a-column-vba/52192060#52192060", "title": "Finding Min and max in a range in a column Vba", "body": "<p>Try this:</p>\n\n<pre><code>Sub MinMax()\n\n    Dim xmax As Double\n    Dim xmin As Double\n\n    Dim r As Range\n\n    Set r = Range(\"K2:K\" &amp; Rows.Count)\n    xmin = Application.WorksheetFunction.Min(r)\n    xmax = Application.WorksheetFunction.Max(r)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7994471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea02db516050d99baff88c31bc63f925?s=128&d=identicon&r=PG&f=1", "display_name": "S. Caruso", "link": "https://stackoverflow.com/users/7994471/s-caruso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 1, "accepted_answer_id": 52192060, "answer_count": 1, "score": 0, "last_activity_date": 1536175150, "creation_date": 1536174736, "last_edit_date": 1536174929, "question_id": 52191966, "link": "https://stackoverflow.com/questions/52191966/finding-min-and-max-in-a-range-in-a-column-vba", "title": "Finding Min and max in a range in a column Vba", "body": "<p>I have been trying to find the min and max of a column and Cannot seem to get my code to work correctly. I have tried if statements, for loops and cannot seem to make it work. I have also been using application.worksheetfunction.min/max and have not been able to get anything to work. </p>\n\n<pre><code>Sub MinMax()\n    Dim xmax As Double\n    Dim xmin As Double\n    Dim TableRow As Integer\n\n    For i = 2 To lastrow   \n        If cells(\"i,11\").Value &lt; cells(i + 1, 11).Value Then\n            xmin = cells(i, 11).Value\n            cells(3, 16).Value = xmin\n        End If\n\n        If cells(i, 11).Value &gt; cells(i + 1, 11).Value Then\n            cells(2, 16).Value = xmax\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1536173142, "post_id": 52191544, "comment_id": 91332955, "body": "We are unsure if there are duplicated results in table 2. Dlookup will only return 1 result and im not sure what order it uses to pick that one."}, {"owner": {"reputation": 29, "user_id": 10321743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1623d7930dc7247dbad858c679a139a?s=128&d=identicon&r=PG&f=1", "display_name": "mohchu", "link": "https://stackoverflow.com/users/10321743/mohchu"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1536256667, "post_id": 52191544, "comment_id": 91368915, "body": "Thanks for your comment. Duplication was none of my concern as I was using dlookup in a mapping table. Reply provided below helped me."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10321743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1623d7930dc7247dbad858c679a139a?s=128&d=identicon&r=PG&f=1", "display_name": "mohchu", "link": "https://stackoverflow.com/users/10321743/mohchu"}, "edited": false, "score": 0, "creation_date": 1536256588, "post_id": 52191946, "comment_id": 91368883, "body": "Solution provided by you helped me. Thank you. Yes I was trying to replace the value I was looking with new value."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 2, "last_activity_date": 1536174635, "creation_date": 1536174635, "answer_id": 52191946, "question_id": 52191544, "link": "https://stackoverflow.com/questions/52191544/issue-with-dlookup/52191946#52191946", "title": "Issue with Dlookup", "body": "<p>First of all, database notation is <code>Table.Column</code> and not <code>Column.Table</code>. If your tables and or columns have spaces or other special characters you always need brackets (and you have already made a bad start in your database design, never use spaces or other special characters for names).</p>\n\n<p>Assuming your actual logic is correct what you need is:</p>\n\n<pre><code>[Table 1].[Column 1] = DLookup(\"[Column 2]\",\"[Table 2]\",\"[Column 1]='\" &amp; [Table 1].[Column 1] &amp; \"'\")\n</code></pre>\n\n<p>But I don't think your logic itself is correct unless you are really trying to replace the value you are looking up by.</p>\n"}], "owner": {"reputation": 29, "user_id": 10321743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1623d7930dc7247dbad858c679a139a?s=128&d=identicon&r=PG&f=1", "display_name": "mohchu", "link": "https://stackoverflow.com/users/10321743/mohchu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536175259, "creation_date": 1536172668, "last_edit_date": 1536175259, "question_id": 52191544, "link": "https://stackoverflow.com/questions/52191544/issue-with-dlookup", "title": "Issue with Dlookup", "body": "<p>I have two table, say table 1 and table 2. Columns in two table have below heading.</p>\n\n<pre><code>Table 1\n1. ABC\n2. DEF\n3. GHI\n\nTable 2\n1. ABC\n2. FED\n3. IHG\n</code></pre>\n\n<p>As in excel, we use <code>Vlookup</code> between column 1 in table 1 and table 2 and than pick value from column 2 of table 2, I need to update value in column 1 in Table 1 using column 2 in Table 2. and column 1 is common in both table. e.g\n<code>Vlookup(Column1. table 1, [1 and 2].table 2, 2 , )</code></p>\n\n<p>In access, i m using update query and updating Column 1 of Table 1 using below formula. </p>\n\n<pre><code>Column 1.table 1 = Dlookup(\"[Column 2].[Table 2]\", \"Table 2\" , \"[Column 1].Table2  = '[Column 1].table1 '\")\n</code></pre>\n\n<p>I am using <code>Dlookup</code> for type text. So I have applied formula for string one. </p>\n\n<p>I am not getting desired value that I should get in normal <code>Vlookup</code>. Instead, I am getting blank as final result. Why is this happening?</p>\n"}, {"tags": ["excel", "vba", "printing"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536173793, "post_id": 52191446, "comment_id": 91333223, "body": "Unrelated, but <code>Box</code> should be declared as either an <code>Integer</code> or (better) <code>VbMsgBoxResult</code>.  <code>MsgBox</code> doesn&#39;t return a <code>String</code>."}, {"owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536174114, "post_id": 52191446, "comment_id": 91333374, "body": "I just tried many different combinations of VbMsgBoxResult and could not get it to work. Can you please write out the entire line of code?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1536174204, "post_id": 52191446, "comment_id": 91333402, "body": "<code>Dim Box As VbMsgBoxResult</code>"}, {"owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536174874, "post_id": 52191446, "comment_id": 91333722, "body": "I get a Compile Error: User-defined type not defined."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1536175137, "post_id": 52191446, "comment_id": 91333837, "body": "What happens if you set the printer as the default printer in windows? Do you have drivers installed to the printer? Mostly due to IT restrictions, I gave up trying to print on lable printer from Excel on my company computer and bought &quot;sticky&quot; normal paper. Just thought you should know there is paper that can be loaded in normal printers with a sticky backside"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1536175188, "post_id": 52191446, "comment_id": 91333858, "body": "Huh. That&#39;s odd - it&#39;s a member of the `Visual Basic For Applications&quot; library - if that isn&#39;t loaded, nothing&#39;s going to work..."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1536175395, "post_id": 52191446, "comment_id": 91333973, "body": "Also, it&#39;s not that easy to switch printer in Excel. I&#39;m not at work now so I can&#39;t see the code I use to switch to PDF creator. But after googling I found <a href=\"http://pixcels.nl/set-activeprinter-excel/\" rel=\"nofollow noreferrer\">this</a>. I can&#39;t say I recognize the code but the text is and issues explained is something I recognize"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1536175751, "post_id": 52191446, "comment_id": 91334118, "body": "Do you have any broken references? <code>Tools-&gt;References...</code> - they&#39;ll have &quot;MISSING&quot; in front of them."}, {"owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1536179203, "post_id": 52191446, "comment_id": 91335587, "body": "@Andreas - when I manually change the printer to the label printer, every works. I also found that page and tried using it, but it did not work for me."}, {"owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536179214, "post_id": 52191446, "comment_id": 91335591, "body": "@Comintern - There are hundreds of references listed, none of them have &quot;MISSING&quot; including the Visual Basic for Applications."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1536179319, "post_id": 52191446, "comment_id": 91335627, "body": "So changing printer manually works as expected. Let me think on this tomorrow, I&#39;m in bed now"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536179331, "post_id": 52191446, "comment_id": 91335634, "body": "Something is definitely wrong then - Try declaring it as <code>Dim Box As VBA.VbMsgBoxResult</code>. If that still gives you the compile error you might want to rebuild the workbook."}, {"owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "edited": false, "score": 0, "creation_date": 1536179346, "post_id": 52191446, "comment_id": 91335640, "body": "Is it possible to post pictures here?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536179385, "post_id": 52191446, "comment_id": 91335654, "body": "You can edit them into the question. If they don&#39;t render correctly, somebody here will fix them for you."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "edited": false, "score": 0, "creation_date": 1536180348, "post_id": 52193007, "comment_id": 91336051, "body": "That worked, and that brought up a window and showed the printer as: \\\\msp-dc-001\\MSP-Label2 When using <a href=\"https://www.mrexcel.com/forum/excel-questions/1021932-changing-active-printer-macro.html\" rel=\"nofollow noreferrer\">link</a> that brings up a box with \\\\msp-dc-001\\MSP-Label2 on Ne07:"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1536179562, "creation_date": 1536179562, "answer_id": 52193007, "question_id": 52191446, "link": "https://stackoverflow.com/questions/52191446/printing-to-label-printer-using-excel-macro/52193007#52193007", "title": "Printing to Label Printer using Excel Macro", "body": "<p>Try letting your user select a printer, see if this works:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim box As String\nbox = MsgBox(\"Are you sure you want to print this label?\", vbQuestion + vbYesNo)\n\nIf box = vbNo Then\n    Exit Sub\nElse\n    If Application.Dialogs(xlDialogPrinterSetup).Show = False Then Exit Sub\n    ThisWorkbook.Worksheets(\"Label\").PrintOut Copies:=1\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "is_accepted": false, "score": 0, "last_activity_date": 1536247315, "last_edit_date": 1536247315, "creation_date": 1536180998, "answer_id": 52193282, "question_id": 52191446, "link": "https://stackoverflow.com/questions/52191446/printing-to-label-printer-using-excel-macro/52193282#52193282", "title": "Printing to Label Printer using Excel Macro", "body": "<p>I have finally figured it out!\nThe following code worked:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim Box As String\nBox = MsgBox(\"Are you sure you want to print this label \" _\n&amp; \"?\", vbQuestion + vbYesNo)\nIf Box = vbNo Then\nExit Sub\nElse: ThisWorkbook.Worksheets(\"Label\").PrintOut ActivePrinter:=\"\\\\msp-dc-001\\MSP-Label2 on Ne07\"\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1359, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536247315, "creation_date": 1536172298, "last_edit_date": 1536172624, "question_id": 52191446, "link": "https://stackoverflow.com/questions/52191446/printing-to-label-printer-using-excel-macro", "title": "Printing to Label Printer using Excel Macro", "body": "<p>I have been working on a macro that needs to print to a label printer instead of the network printer. No matter what I try, it refuses to switch from the default printer to the label printer.</p>\n\n<p>Please take a look at the following code and let me know if you see anything wrong:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim Box As String\nBox = MsgBox(\"Are you sure you want to print this label \" _\n&amp; \"?\", vbQuestion + vbYesNo)\nIf Box = vbNo Then\nExit Sub\nElse: ThisWorkbook.Worksheets(\"Label\").PrintOut ActivePrinter:=\"MSP-Label2 on msp-dc-001\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1536171486, "post_id": 52191228, "comment_id": 91332231, "body": "Protip: use <i>meaningful identifier names</i>, like <code>lookupSource</code>, <code>lookupColumn</code>, etc.. Thank yourself later. Also, declare an explicit type for them; <code>ByVal lookupSource As Range</code>, and give the function an explicit accessibility and a return type, too: <code>Public&#47;Private Function {name}({args}) As {type}</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1536171652, "post_id": 52191228, "comment_id": 91332306, "body": "Many things could possibly go wrong. Are you getting any specific run-time error? Put a breakpoint (F9) on the first <code>Set</code> statement, then run the code line by line (F8) - which statement is blowing up, and what&#39;s the error?"}, {"owner": {"reputation": 3, "user_id": 10321775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d80164b64ff6a99df8de63420c2b3797?s=128&d=identicon&r=PG&f=1", "display_name": "MetaLogicianWannabe", "link": "https://stackoverflow.com/users/10321775/metalogicianwannabe"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1536171904, "post_id": 52191228, "comment_id": 91332422, "body": "@Mathieu Guindon Well, the only difference between the two programs is in the definition of the range. That kind of definition shown in the second prgram only works for me when  there are no workbook or worksheet variables present.  And thanks for the protip I will do it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1536172007, "post_id": 52191228, "comment_id": 91332480, "body": "Nitpick: it&#39;s an <i>assignment</i>, not a <i>definition</i> - also it&#39;s near-impossible to tell what each parameter stands for, given they&#39;re all random single-letter identifiers without a type."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1536171994, "post_id": 52191346, "comment_id": 91332471, "body": "(Tangential question to your last point - so using <code>i</code> as a variable name is not recommended/best practice? Aw! I use it frequently for a quick counter, i.e. <code>For i = 1 to 10</code>)"}, {"owner": {"reputation": 3, "user_id": 10321775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d80164b64ff6a99df8de63420c2b3797?s=128&d=identicon&r=PG&f=1", "display_name": "MetaLogicianWannabe", "link": "https://stackoverflow.com/users/10321775/metalogicianwannabe"}, "edited": false, "score": 0, "creation_date": 1536172151, "post_id": 52191346, "comment_id": 91332546, "body": "@Mathieu Guindon Thank you, Sir! So do you have any solutions to the problem? I need those variables."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1536172152, "post_id": 52191346, "comment_id": 91332547, "body": "@BruceWayne Without context, <code>i</code> (and <i>maybe</i> <code>j</code>, if you have nested loops) is the <i>only</i> acceptable single-letter variable name, <i>given a <code>For</code> loop</i>. In any other context, it&#39;s meaningless. And it&#39;s only meaningful in a <code>For</code> loop because using <code>i</code> as a &quot;quick counter&quot; has been a programming convention since the dawn of time. And even then, you&#39;d declare it with an explicit type."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3, "user_id": 10321775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d80164b64ff6a99df8de63420c2b3797?s=128&d=identicon&r=PG&f=1", "display_name": "MetaLogicianWannabe", "link": "https://stackoverflow.com/users/10321775/metalogicianwannabe"}, "edited": false, "score": 0, "creation_date": 1536172183, "post_id": 52191346, "comment_id": 91332566, "body": "@MetaLogicianWannabe the solution is to use <code>T</code> to qualify the <code>Cells</code> calls. Edited to clarify."}, {"owner": {"reputation": 3, "user_id": 10321775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d80164b64ff6a99df8de63420c2b3797?s=128&d=identicon&r=PG&f=1", "display_name": "MetaLogicianWannabe", "link": "https://stackoverflow.com/users/10321775/metalogicianwannabe"}, "edited": false, "score": 0, "creation_date": 1536172365, "post_id": 52191346, "comment_id": 91332632, "body": "@Mathieu Guindon Thanks again"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1536172244, "last_edit_date": 1536172244, "creation_date": 1536171898, "answer_id": 52191346, "question_id": 52191228, "link": "https://stackoverflow.com/questions/52191228/what-is-the-mistake-in-this-excel-vba-range-definition/52191346#52191346", "title": "What is the mistake in this excel VBA range definition?", "body": "<blockquote>\n<pre><code>Set U = T.Range(Cells(j, i), Cells(l, k))\n</code></pre>\n</blockquote>\n\n<p>That's accessing a <code>Range</code> on sheet <code>T</code>, using two ranges from whatever the <code>ActiveSheet</code> is, because these two <code>Cells</code> calls aren't <em>qualified</em> with an explicit worksheet object.</p>\n\n<p>In other words, it's doing this:</p>\n\n<pre><code>Set U = SomeSheet.Range(ActiveSheet.Cells(j, i), ActiveSheet.Cells(l, k))\n</code></pre>\n\n<p>That's going to blow up whenever <code>ActiveSheet</code> isn't <code>SomeSheet</code>, or whenever <code>j</code>, <code>i</code>, <code>l</code>, or <code>k</code> is 0.</p>\n\n<p>This would fix it:</p>\n\n<pre><code>Set U = T.Range(T.Cells(j, i), T.Cells(l, k))\n</code></pre>\n\n<p>Because now <code>Cells</code> is guaranteed to be pulling from the same worksheet object.</p>\n\n<p>Side note, avoid single-letter variable names, <em>especially</em> lower-case <code>l</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 10321775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d80164b64ff6a99df8de63420c2b3797?s=128&d=identicon&r=PG&f=1", "display_name": "MetaLogicianWannabe", "link": "https://stackoverflow.com/users/10321775/metalogicianwannabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52191346, "answer_count": 1, "score": 0, "last_activity_date": 1536172244, "creation_date": 1536171368, "last_edit_date": 1536171749, "question_id": 52191228, "link": "https://stackoverflow.com/questions/52191228/what-is-the-mistake-in-this-excel-vba-range-definition", "title": "What is the mistake in this excel VBA range definition?", "body": "<p>Im trying to program a vlookup-like function in excel VBA. In order to do that I need to manipulate range data so a range definition using cells() fits my interest best. But I just don't know what I'm doing wrong. Here is the first code that is working:</p>\n\n<pre><code>Function GLookUp2(a, b, P, Q, R)\n\n    Dim S As Workbook\n\n    Set S = Workbooks(P)\n\n    Dim T As Worksheet\n\n    Set T = S.Sheets(Q)\n\n    Dim U As Range\n\n    Set U = T.Range(R)\n\n    GLookUp2 = Application.VLookup(a, U, b, False)\nEnd Function\n</code></pre>\n\n<p>However this code doesn't seem to work. </p>\n\n<pre><code>Function GLookUp1(a, b, P, Q, i, j, k, l)\n\n    Dim S As Workbook\n\n    Set S = Workbooks(P)\n\n    Dim T As Worksheet\n\n    Set T = S.Sheets(Q)\n\n    Dim U As Range\n\n    Set U = T.Range(Cells(j, i), Cells(l, k))\n\n    GLookUp1 = Application.VLookup(a, U, b, False)\nEnd Function\n</code></pre>\n\n<p>Can you tell me why? Thanks.</p>\n"}, {"tags": ["json", "excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1536169735, "post_id": 52190798, "comment_id": 91331484, "body": "Sort of a &quot;Did you turn it off and on again&quot; type question, but did you load in the <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">jsonconverter</a> module?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10260675, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iu0OesSbMWw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNv8vbpm2RrV1w2EiQB-ole_1WbLA/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10260675/daniel"}, "edited": false, "score": 0, "creation_date": 1536244362, "post_id": 52198546, "comment_id": 91362065, "body": "However, I do see a disadvantage for this out. It did not list each collection in a different columns.... working on it now but any help will be appreciated. Thanks"}, {"owner": {"reputation": 15, "user_id": 10260675, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iu0OesSbMWw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNv8vbpm2RrV1w2EiQB-ole_1WbLA/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10260675/daniel"}, "edited": false, "score": 1, "creation_date": 1536244523, "post_id": 52198546, "comment_id": 91362171, "body": "Yes, sorry I thought you meant the flag. First time user."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 15, "user_id": 10260675, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iu0OesSbMWw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNv8vbpm2RrV1w2EiQB-ole_1WbLA/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10260675/daniel"}, "edited": false, "score": 0, "creation_date": 1536249368, "post_id": 52198546, "comment_id": 91365319, "body": "No worries :-) any questions let me know"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1536218813, "last_edit_date": 1536218813, "creation_date": 1536218419, "answer_id": 52198546, "question_id": 52190798, "link": "https://stackoverflow.com/questions/52190798/extract-element-from-an-array/52198546#52198546", "title": "extract element from an array", "body": "<p>Seeing expected output would help. If you are simply after the items within the collection of collections returned by <code>JsonConverter.ParseJson(strJSON)(\"widget\")(\"text\")(\"size\")</code> then the following will empty them.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim strJSON As String, json As Object, rowNumber As Long, i As Long, j As Long\n    Const PATH As String = \"C:\\Users\\User\\Desktop\\test.JSON\"\n    strJSON = GetJSONFromFile(PATH)\n    Set json = JsonConverter.ParseJson(strJSON)(\"widget\")(\"text\")(\"size\") '&lt;collection of collections\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        For i = 1 To json.Count\n            For j = 1 To json(i).Count\n                rowNumber = rowNumber + 1\n                .Cells(rowNumber, 1) = json(i)(j)\n            Next\n        Next\n    End With\nEnd Sub\nPublic Function GetJSONFromFile(ByVal PATH As String) As String\n    Dim fso As Object, f As Object, outputString As String\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set f = fso.OpenTextFile(PATH)\n\n    Do Until f.AtEndOfStream\n        outputString = f.ReadAll()\n    Loop\n    f.Close\n\n    GetJSONFromFile = outputString\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>JSON structure:</strong></p>\n\n<p>You can see the path down to the collection of collections in the JSON structure below. The <code>{}</code> are dictionaries and the <code>[]</code> are collections.</p>\n\n<p><img src=\"https://i.stack.imgur.com/Q78vh.png\" width=\"200\"></p>\n"}], "owner": {"reputation": 15, "user_id": 10260675, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iu0OesSbMWw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNv8vbpm2RrV1w2EiQB-ole_1WbLA/mo/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10260675/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52198546, "answer_count": 1, "score": 0, "last_activity_date": 1536262882, "creation_date": 1536169472, "last_edit_date": 1536262882, "question_id": 52190798, "link": "https://stackoverflow.com/questions/52190798/extract-element-from-an-array", "title": "extract element from an array", "body": "<p>Hi I asked the similar question before: I have a large JSON file but the information I need is only small part of it. However, that part is a two dimensional array from \"text\".\"size\" part.Is any way I can loop each array and and get the number from what I have already?</p>\n\n<pre><code>{\"widget\": { \"debug\": \"on\", \"window\": { \"title\": \"Sample Konfabulator Widget\", \"name\": \"main_window\", \"width\": 500, \"height\": 500 }, \"image\": { \"src\": \"Images/Sun.png\", \"name\": \"sun1\", \"hOffset\": 250, \"vOffset\": 250, \"alignment\": \"center\" }, \"text\": { \"data\": \"Click Here\", \"size\": [[0,1,2,3,4],[5,6,7,8,9],[10,11,12,13,14]], \"style\": \"bold\", \"name\": \"text1\", \"hOffset\": 250, \"vOffset\": 100, \"alignment\": \"center\", \"onMouseUp\": \"sun1.opacity = (sun1.opacity / 100) * 90;\" } } }\n</code></pre>\n\n<p>I was taught from someone(thank you!) to use the following code</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim strJSON As String, json As Object, rowNumber As Long\n    Application.ScreenUpdating = False\n    Const PATH As String = \"C:\\Users\\User\\Desktop\\test.JSON\"\n    strJSON = GetJSONFromFile(PATH)\n    Set json = JsonConverter.ParseJson(strJSON)\n    Set json = json(\"widget\")(\"text\")\n    Dim key As Variant\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        For Each key In json\n            rowNumber = rowNumber + 1\n            .Cells(rowNumber, 1) = key\n            .Cells(rowNumber, 2) = json(key)\n        Next key\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Many Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1536169515, "post_id": 52190770, "comment_id": 91331356, "body": "It&#39;s a csv file? Is it open in excel when you try to set <code>targetColumn</code> or is it just a csv file in that folder? If it&#39;s not open you&#39;ll have to open it first, then set your Target column."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536170448, "post_id": 52190770, "comment_id": 91331815, "body": "A csv can only have 1 &quot;worksheet&quot; - does it do the same thing if you index it directly?  <code>Workbooks(&quot;RG.csv&quot;).Worksheets(1)</code>"}, {"owner": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "edited": false, "score": 0, "creation_date": 1536170785, "post_id": 52190770, "comment_id": 91331932, "body": "Worked fine using index too. another question- How can I select data from sourceColumn A4 onwards till there is data.  targetColumn functionality stays the same"}, {"owner": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "edited": false, "score": 0, "creation_date": 1536172083, "post_id": 52190770, "comment_id": 91332514, "body": "updated post with working code so far"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1536177445, "post_id": 52190770, "comment_id": 91334860, "body": "@SilverFish I can&#39;t reproduce your issue - Are you sure you&#39;ve got the right workbook and worksheet names?"}], "answers": [{"tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": false, "score": 0, "last_activity_date": 1536212489, "creation_date": 1536212489, "answer_id": 52197197, "question_id": 52190770, "link": "https://stackoverflow.com/questions/52190770/excel-vba-macro-to-copy-certain-columns-to-another-workbook/52197197#52197197", "title": "Excel VBA macro to copy certain columns to another Workbook", "body": "<p>The error is probably because Submission_Form.xlsm isn't opened(?). Your code looks a little inconsistent.  Maybe just open both source and destination, and copy the column. Something like this?</p>\n\n<pre><code>Option Explicit\n\nSub Submit()\n    Dim vSourceWorkbook As Workbook\n    Dim vDestinationWorkbook As Workbook\n\n    Set vSourceWorkbook = Workbooks.Open(\"Submission_Form.xlsm\")\n    Set vDestinationWorkbook = Workbooks.Open(\"I:\\Projects\\...\\Macros\\RG.csv\")\n\n    vSourceWorkbook.Worksheets(\"RGSheet\").Range(\"A:A\").Copy Destination:=vDestinationWorkbook.Worksheets(1).Range(\"A:A\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 444, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536212489, "creation_date": 1536169369, "last_edit_date": 1536177451, "question_id": 52190770, "link": "https://stackoverflow.com/questions/52190770/excel-vba-macro-to-copy-certain-columns-to-another-workbook", "title": "Excel VBA macro to copy certain columns to another Workbook", "body": "<p>I need to copy certain columns of one spreadsheet to another spreadsheet. </p>\n\n<p>In order to do so, I have a macro:</p>\n\n<pre><code>    Sub Submit()\n    Dim sourceColumn As Range, targetColumn As Range\n\n    Set sourceColumn = \n     Workbooks(\"Submission_Form.xlsm\").Worksheets(\"RGSheet\").Columns(\"A\")\n    Set myData = Workbooks.Open(\"I:\\Projects\\...\\Macros\\RG.csv\")\n    Worksheets(1).Select\n    Worksheets(1).Range(\"A1\").Select\n    Set targetColumn = Workbooks(\"RG.csv\").Worksheets(1).Columns(\"A\")\n\n    sourceColumn.Copy Destination:=targetColumn\n    End Sub\n</code></pre>\n\n<p>However, when the cursor hits targetColumn, it gives error:</p>\n\n<pre><code>Run-time error '9':\nSubscript out of range\n</code></pre>\n\n<p>For the sake of simplicity, I have put RG.csv in the same folder as Submission_Form.xlsm. So I am really confused why is it giving error.</p>\n\n<p>I would also like to know how to handle if the RG.csv is located in another directory.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536172014, "post_id": 52191247, "comment_id": 91332484, "body": "You might have changed it to &quot;broken&quot;. The <code>Write</code> statement doesn&#39;t just comma delimit the output - it also text qualifies strings (albeit poorly)."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536172192, "post_id": 52191247, "comment_id": 91332571, "body": "@Comintern: Not sure what you mean but that&#39;s probably because of my command of English."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536172576, "post_id": 52191247, "comment_id": 91332729, "body": "NP - If you have a string - <code>x = &quot;foo&quot;</code> and use <code>Write #1, x</code>, it will wrap it in double quotes in the text file.  You&#39;ll get <code>&quot;foo&quot;</code> instead of simply <code>foo</code>.  Using <code>Join</code> beforehand will wrap the <i>entire line</i> in double quotes. Run your code and look at the output - you&#39;ll see what I mean."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1536172660, "post_id": 52191247, "comment_id": 91332770, "body": "Ah, I see, but that can be fixed easily by using Print, right?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536172942, "post_id": 52191247, "comment_id": 91332881, "body": "If it doesn&#39;t need the double quotes around strings, yes. It would mainly depend on the OP&#39;s output spec. <code>Write</code> was designed to be read with <code>Input</code> - <code>Print</code> doesn&#39;t do the formatting.  In either case, it&#39;s a good idea to escape things like <code>,</code>, <code>&quot;</code>, etc. in strings, but the OP&#39;s data looks fairly simple."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 2, "last_activity_date": 1536172815, "last_edit_date": 1536172815, "creation_date": 1536171458, "answer_id": 52191247, "question_id": 52190696, "link": "https://stackoverflow.com/questions/52190696/write-data-to-text-file-while-skipping-blank-rows/52191247#52191247", "title": "Write data to text file while skipping blank rows", "body": "<p>I changed your code a little bit</p>\n\n<pre><code>Sub ExportTXT()\n\nConst DELIMITER = \",\"\n\nDim myFile As String\nDim rng As Range\nDim cellValue As Variant\nDim i As Integer\nDim j As Integer\nDim sngRow As Range\nDim vDat As Variant    \n\n    myFile = Application.DefaultFilePath &amp; \"\\sales.txt\"\n    With ActiveSheet\n        Set rng = .Range(.Cells(1, 1), .Cells(10, 4))\n    End With\n\n    Dim noCol As Long\n    noCol = rng.Columns.Count    \n\n    Open myFile For Output As #1\n\n    For Each sngRow In rng.Rows\n\n        vDat = WorksheetFunction.Transpose(WorksheetFunction.Transpose(sngRow))\n        vDat = Join(vDat, DELIMITER)\n        If Len(vDat) &gt;= noCol Then\n            Write #1, vDat\n        End If\n\n    Next\n\n    Close #1\n\nEnd Sub\n</code></pre>\n\n<p><strong>Update</strong> Based on one of the comments use the follwoing statement in order to avoid \"text qualification\"</p>\n\n<pre><code>Print #1, vDat\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>Write #1, vDat\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4414181"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549116144, "creation_date": 1536169075, "last_edit_date": 1549116144, "question_id": 52190696, "link": "https://stackoverflow.com/questions/52190696/write-data-to-text-file-while-skipping-blank-rows", "title": "Write data to text file while skipping blank rows", "body": "<p>I'm using the macro below to write a selected range (in Excel) to a .txt file.</p>\n\n<pre><code>Sub ExportTXT()\n\nDim myFile As String\nDim rng As Range\nDim cellValue As Variant\nDim i As Integer\nDim j As Integer\n\nmyFile = Application.DefaultFilePath &amp; \"\\sales.txt\"\nSet rng = Range(Cells(1, 1), Cells(10, 4))\n\nOpen myFile For Output As #1\n\n    For i = 1 To rng.Rows.Count\n        For j = 1 To rng.Columns.Count\n            cellValue = rng.Cells(i, j).Value\n\n            If j = rng.Columns.Count Then\n                Write #1, cellValue\n            Else\n                Write #1, cellValue,\n            End If\n        Next j\n    Next i\n\nClose #1\n\nEnd Sub\n</code></pre>\n\n<p>I'm trying to skip rows 3 and 9.<br>\n<a href=\"https://i.stack.imgur.com/Cqjzc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cqjzc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Current output - the lines circled in red are the lines that shouldn't be written to the txt file.<br>\n<a href=\"https://i.stack.imgur.com/8jv8r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8jv8r.png\" alt=\"enter image description here\"></a></p>\n\n<p>How do I skip blank rows?</p>\n\n<p>I've tried using <strong>Isempty(cellValue) = True ** and empty string **\"\"</strong> conditional statements.</p>\n\n<p>My txt file output should look like this\n<a href=\"https://i.stack.imgur.com/E0QNh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E0QNh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any ideas on how to check the cellValue contents to see if it's empty and write only rows with data.</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536169103, "post_id": 52190658, "comment_id": 91331129, "body": "Remove the quotes from <code>&quot;DestinationPPT&quot;</code> - it&#39;s a variable, not a string literal."}, {"owner": {"reputation": 1, "user_id": 10321645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DDmpU8V0Xrg/AAAAAAAAAAI/AAAAAAAAAlM/LL0Q-AOxabk/photo.jpg?sz=128", "display_name": "Neethi Johnson", "link": "https://stackoverflow.com/users/10321645/neethi-johnson"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536170877, "post_id": 52190658, "comment_id": 91331973, "body": "That didn&#39;t work :("}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1536171537, "post_id": 52190658, "comment_id": 91332253, "body": "make sure <code>DestinationPPT</code> is a valid path. Otherwise, it will fail. To test <code>debug.print DestinationPPT</code> and see what the result is"}, {"owner": {"reputation": 1, "user_id": 10321645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DDmpU8V0Xrg/AAAAAAAAAAI/AAAAAAAAAlM/LL0Q-AOxabk/photo.jpg?sz=128", "display_name": "Neethi Johnson", "link": "https://stackoverflow.com/users/10321645/neethi-johnson"}, "edited": false, "score": 0, "creation_date": 1536171869, "post_id": 52190658, "comment_id": 91332405, "body": "The result gives a valid path to a folder/item on my desktop"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1536172410, "post_id": 52190658, "comment_id": 91332655, "body": "did you triple check the path validility? can you copy / paste into Windows Explorer and it opens the files? Because this: <code>Set myPresentation = PowerPointApp.Presentations.Open(DestinationPPT)</code> will work with a valid path."}], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "is_accepted": false, "score": 0, "last_activity_date": 1536454586, "creation_date": 1536454586, "answer_id": 52240503, "question_id": 52190658, "link": "https://stackoverflow.com/questions/52190658/vba-macros-excel-opening-powerpoint-method-open-of-object-presentations-failed/52240503#52240503", "title": "VBA Macros Excel Opening PowerPoint: method open of object presentations failed", "body": "<p>Assuming that your HOME.Textbox.Value contains a fully qualified file name, the only problem is you have mixed early object binding with late object binding.</p>\n\n<pre><code>'Powerpoint\nSub OpenPowerPoint()\n\nDim DestinationPPT As String\n'You choose early binding, good choice\nDim PowerPointApp As PowerPoint.Application\nDim myPresentation As PowerPoint.Presentation\n\n'Template Location variable\nDestinationPPT = HOME.TextBox2.Value\nDestinationPPT = DestinationPPT &amp; \"\\Gemba Template.pptx\"\n\n'The CreateObject function is for late binding of objects\n'You choose early binding.  In that case use New.\n'Set PowerPointApp = CreateObject(\"PowerPoint.Application\")\nSet PowerPointApp = New PowerPoint.Application\n'Assuming HOME.Textbox.Value contains a fully qualified file string\n'Remove the double quote marks since DestinationPPT is a vaiable not\n'a literal\nSet myPresentation = PowerPointApp.Presentations.Open(DestinationPPT)\n\n'Transition from Excel to PowerPoint\nDim x, lastRow, slideNum As Integer\nDim cellName, shapeName, cellScore As String\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10321645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DDmpU8V0Xrg/AAAAAAAAAAI/AAAAAAAAAlM/LL0Q-AOxabk/photo.jpg?sz=128", "display_name": "Neethi Johnson", "link": "https://stackoverflow.com/users/10321645/neethi-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 766, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536454586, "creation_date": 1536168939, "last_edit_date": 1536169031, "question_id": 52190658, "link": "https://stackoverflow.com/questions/52190658/vba-macros-excel-opening-powerpoint-method-open-of-object-presentations-failed", "title": "VBA Macros Excel Opening PowerPoint: method open of object presentations failed", "body": "<p>I'm working on an excel file that involves opening up PowerPoint as a step. However, when I run it, it produces the error message \"Method Open of Object Presentations Failed\" When I click debug, it highlights the \"Set myPresentation = PowerPointApp.Presentations.Open(\"DestinationPPT\"). Please help. Any advice is sincerely appreciated. </p>\n\n<pre><code>'Powerpoint\nSub OpenPowerPoint()\n\nDim DestinationPPT As String\nDim PowerPointApp As PowerPoint.Application\nDim myPresentation As PowerPoint.Presentation\n\n'Template Location variable\nDestinationPPT = HOME.TextBox2.Value\nDestinationPPT = DestinationPPT &amp; \"\\Gemba Template.pptx\"\n\nSet PowerPointApp = CreateObject(\"PowerPoint.Application\")\nSet myPresentation = PowerPointApp.Presentations.Open(\"DestinationPPT\")\n\n'Transition from Excel to PowerPoint\nDim x, lastRow, slideNum As Integer\nDim cellName, shapeName, cellScore As String\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bmCkB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bmCkB.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "url", "https", "download"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1536168184, "post_id": 52190468, "comment_id": 91330686, "body": "WHY ARE YOU YELLING AT US?!?!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 1, "creation_date": 1536168584, "post_id": 52190468, "comment_id": 91330890, "body": "@rory.ap FEEL FREE TO EDIT THE TITLE."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536168949, "post_id": 52190468, "comment_id": 91331055, "body": "<code>XMLHttpRequest</code> is asynchronous, so you need to wait for the page retrieval. It also doesn&#39;t have a <code>.Select</code> method. What information are you trying to retrieve from the page?"}, {"owner": {"reputation": 13, "user_id": 9780678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "CatCaller", "link": "https://stackoverflow.com/users/9780678/catcaller"}, "edited": false, "score": 0, "creation_date": 1536171443, "post_id": 52190468, "comment_id": 91332218, "body": "Create a code VBA, which open that link (<a href=\"https://sslecal2.forexprostools.com/?columns=exc_flags,exc_currency,exc_importance,exc_actual,exc_forecast,exc_previous&amp;features=datepicker,timezone,timeselector,filters&amp;countries=29,32,27,37,72,22,17,10,35,7,125,26,4,5&amp;calType=day&amp;timeZone=7&amp;lang=1\" rel=\"nofollow noreferrer\">sslecal2.forexprostools.com/&hellip;</a>), copy all the content and paste it in a worksheet. Thanks by your help!"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536596350, "post_id": 52202806, "comment_id": 91471319, "body": "Did you try this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1536232379, "creation_date": 1536232379, "answer_id": 52202806, "question_id": 52190468, "link": "https://stackoverflow.com/questions/52190468/vba-download-data-from-https/52202806#52202806", "title": "VBA: DOWNLOAD DATA FROM HTTPS", "body": "<p>You can copy the entire table to the clipboard using the <code>outerHTML</code> of the table element then write out to the sheet</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTable()\n    Dim sResponse As String, html As New HTMLDocument, clipboard As Object\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://sslecal2.forexprostools.com/?columns=exc_flags,exc_currency,exc_importance,exc_actual,exc_forecast,exc_previous&amp;features=datepicker,timezone,timeselector,filters&amp;countries=29,32,27,37,72,22,17,10,35,7,125,26,4,5&amp;calType=day&amp;timeZone=7&amp;lang=1\", False\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n\n    sResponse = Mid$(sResponse, InStr(1, sResponse, \"&lt;!DOCTYPE \"))\n\n    With html\n        .body.innerHTML = sResponse\n        Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n        clipboard.SetText .querySelector(\"#ecEventsTable\").outerHTML\n        clipboard.PutInClipboard\n        ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 1).PasteSpecial\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9780678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "CatCaller", "link": "https://stackoverflow.com/users/9780678/catcaller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536232379, "creation_date": 1536168083, "last_edit_date": 1536171035, "question_id": 52190468, "link": "https://stackoverflow.com/questions/52190468/vba-download-data-from-https", "title": "VBA: DOWNLOAD DATA FROM HTTPS", "body": "<p>I want to copy all data from this https:</p>\n\n<p><a href=\"https://sslecal2.forexprostools.com/?columns=exc_flags,exc_currency,exc_importance,exc_actual,exc_forecast,exc_previous&amp;features=datepicker,timezone,timeselector,filters&amp;countries=29,32,27,37,72,22,17,10,35,7,125,26,4,5&amp;calType=day&amp;timeZone=7&amp;lang=1\" rel=\"nofollow noreferrer\">https://sslecal2.forexprostools.com/?columns=exc_flags,exc_currency,exc_importance,exc_actual,exc_forecast,exc_previous&amp;features=datepicker,timezone,timeselector,filters&amp;countries=29,32,27,37,72,22,17,10,35,7,125,26,4,5&amp;calType=day&amp;timeZone=7&amp;lang=1</a></p>\n\n<p>And paste it in excel. This is, create a code VBA, which open that link, copy all the content and paste in a worksheet. I was thinking something as:</p>\n\n<pre><code> Sub DownloadFile()\n\n Dim myURL As String\nmyURL = \"https://sslecal2.forexprostools.com/?columns=exc_flags,exc_currency,exc_importance,exc_actual,exc_forecast,exc_previous&amp;features=datepicker,timezone,timeselector,filters&amp;countries=29,32,27,37,72,22,17,10,35,7,125,26,4,5&amp;calType=day&amp;timeZone=7&amp;lang=1\"\n\nDim WinHttpReq As Object\nSet WinHttpReq = CreateObject(\"Microsoft.XMLHTTP\")\nWinHttpReq.Open \"GET\", myURL, False\nWinHttpReq.Send\n\nWinHttpReq.Select\nSelection.Copy\nRange(\"A20\").Select\nActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p>But it isn't working. Does anyone have an idea?</p>\n\n<p>Thanks by your help!</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1536186603, "post_id": 52190354, "comment_id": 91338088, "body": "Actually, the last link in your question answers the basic portion of your question rather thoroughly, IMHO."}, {"owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "reply_to_user": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1536189642, "post_id": 52190354, "comment_id": 91338710, "body": "I don&#39;t believe so, it says that the default encryption provider for post-2007 Access is RC4. That is the default, but it does not say what encryption is used when &quot;legacy encryption&quot; is select"}], "answers": [{"tags": [], "owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "is_accepted": false, "score": 0, "last_activity_date": 1555057031, "creation_date": 1555057031, "answer_id": 55647291, "question_id": 52190354, "link": "https://stackoverflow.com/questions/52190354/in-access-accdb-file-when-you-use-use-legacy-encryption-what-is-the-encrypti/55647291#55647291", "title": "In Access ACCDB file, when you use &quot;Use legacy encryption&quot;, what is the encryption algorithm and how secure is it?", "body": "<p>Since you seem to be possibly interested in 3rd party solutions, NetLib Encryptionizer provides seamless TDE to Access databases.  (Disclaimer: I am from <a href=\"https://netlibsecurity.com\" rel=\"nofollow noreferrer\">NetLib Security</a>).</p>\n"}], "owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 529, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593590018, "creation_date": 1536167581, "last_edit_date": 1593590018, "question_id": 52190354, "link": "https://stackoverflow.com/questions/52190354/in-access-accdb-file-when-you-use-use-legacy-encryption-what-is-the-encrypti", "title": "In Access ACCDB file, when you use &quot;Use legacy encryption&quot;, what is the encryption algorithm and how secure is it?", "body": "<p>I'm in excel/vba, I need to open a password encrypted accdb database file.</p>\n\n<p>According to </p>\n\n<p><a href=\"https://www.connectionstrings.com/access/\" rel=\"nofollow noreferrer\">connectionstrings</a> this feature is broken and always fails with a \"Not a valid password\" error</p>\n\n<p>I have tried saving the same database as an mdb 2000, mdb 2003 and an accdb file each with an added password, they all open except accdb</p>\n\n<p>I would like to know, when using accdb, if you enable legacy encrytion, do you get the cardboard-level protection of previous access version or something in-between ?</p>\n\n<p>thanks !</p>\n\n<p>More links </p>\n\n<p><a href=\"https://stackoverflow.com/questions/51653890/connection-to-protected-access-accdb-file-throws-wrong-password\">Someone else with my problem</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/33045868/connecting-to-an-encrypted-access-database-after-changing-the-encryption-method\">The solution so far</a></p>\n\n<p><a href=\"https://superuser.com/questions/669394/changing-encryption-settings-for-microsoft-office-2010-2013\">A method to change the encryption default with the office customization tool, I can't as I have no admin privileges</a></p>\n\n<p><a href=\"https://www.everythingaccess.com/tutorials.asp?ID=Changing-the-encryption-type-in-Access-2007\" rel=\"nofollow noreferrer\">Another method to change the encryption type in access 2007, using a 3rd party tool</a></p>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5696424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c20097a97945b960d2434eacac8c3d5?s=128&d=identicon&r=PG&f=1", "display_name": "J.Booth", "link": "https://stackoverflow.com/users/5696424/j-booth"}, "edited": false, "score": 0, "creation_date": 1536224578, "post_id": 52197679, "comment_id": 91349728, "body": "Thanks. It still gets the same error but it runs better. It never says that the search term isn&#39;t found. When I comment out the paste special line and just make It bring up a message box saying that the string was found, it runs fine so every string is found. There must be something wrong with the pasting. Is it possible to do it without pasting? Can I set the outcome of the find to be some variable, and then set the relevant cell in my worksheet to be that variable?"}, {"owner": {"reputation": 13, "user_id": 5696424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c20097a97945b960d2434eacac8c3d5?s=128&d=identicon&r=PG&f=1", "display_name": "J.Booth", "link": "https://stackoverflow.com/users/5696424/j-booth"}, "edited": false, "score": 0, "creation_date": 1536224861, "post_id": 52197679, "comment_id": 91349940, "body": "P.S. I changed myWkSht.Range(&quot;A&quot; &amp; i).PasteSpecial xlPasteValues  to myWkSht.Range(&quot;A&quot; &amp; i) = wdRange and it works! Thanks a lot."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1536214962, "creation_date": 1536214962, "answer_id": 52197679, "question_id": 52190023, "link": "https://stackoverflow.com/questions/52190023/finding-and-pasting-string-from-multiple-word-docs-fails-part-way-through-paste/52197679#52197679", "title": "Finding and pasting string from multiple word docs fails part way through (pastespecial method of range class failed)", "body": "<p>There are a number of issues with this code that <em>could</em> be causing problems. I'm not certain any (or the combination) are the cause, but let's see...</p>\n\n<ol>\n<li>In VBA an object shouldn't be declared and instantiated on the same line. This is OK in VB.NET, but not VBA. So declare <code>wdApp</code> in one line, but <code>Set wdApp = New Word.Application</code> in a different one.</li>\n<li>Use a specific <code>Range</code> object for the Find. Currently, the code is telling Word to copy the entire document, on the one hand, but the \"found\" is the search term - this is confusing for VBA.</li>\n<li>Try putting <code>Set myDoc = Nothing</code> just before the <code>Loop</code> statement to explicitly release <code>myDoc</code> before assigning the next document to it.</li>\n<li>It's usually a good idea to test whether the searched term was actually found. Not sure what you want to have happen if this should occur, but it's good to have the test.</li>\n</ol>\n\n<p>Note also that a comment is inaccurate, the code is not looping the Excel files but the Word files. This isn't causing the problem, but it should be corrected to avoid confusion.</p>\n\n<pre><code>Sub readForml()\n\nDim wdApp As Word.Application\nDim myDoc As Word.Document\nDim wdRange as Word.Range\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim i As Integer, bFound as Boolean\nDim myWkSht As Worksheet\n\nSet wdApp = New Word.Application\nwdApp.Visible = False\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n myExtension = \"*.docx*\"\n\nSet myWkSht = ActiveSheet\nmyPath = \"path_to_folder\"\nmyFile = Dir(myPath &amp; myExtension)\n'set i to be first blank row\ni = myWkSht.Cells(myWkSht.Rows.Count, 1).End(xlUp).Row\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n     'Set variable equal to opened workbook\n      Set myDoc = wdApp.Documents.Open(Filename:=myPath &amp; myFile)\n      DoEvents\n\n      Set wdRange = myDoc.Content\n      With wdRange   \n        .Find.ClearFormatting\n        With .Find\n            .Text = \"number[0-9]{4}\"\n            .Format = False\n            .MatchCase = True\n            .MatchWholeWord = False\n            .MatchWildcards = True\n            bFound = .Execute\n         End With\n         If bFound Then\n            .Copy\n            myWkSht.Range(\"A\" &amp; i).PasteSpecial xlPasteValues\n         Else\n             MsgBox \"Search term not found\"\n         End If\n      End With\n\n      myDoc.Close SaveChanges:=False\n      Set myDoc = Nothing\n      i = i + 1\n      'Get next file name\n      myFile = Dir()\n    Loop\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5696424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c20097a97945b960d2434eacac8c3d5?s=128&d=identicon&r=PG&f=1", "display_name": "J.Booth", "link": "https://stackoverflow.com/users/5696424/j-booth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536214972, "creation_date": 1536166087, "last_edit_date": 1536214972, "question_id": 52190023, "link": "https://stackoverflow.com/questions/52190023/finding-and-pasting-string-from-multiple-word-docs-fails-part-way-through-paste", "title": "Finding and pasting string from multiple word docs fails part way through (pastespecial method of range class failed)", "body": "<p>I have a VBA macro which opens up every word document for in a folder and finds a certain string in the document, and then pastes it into the open spreadsheet. All the word documents are of the same template and do contain the string in question.</p>\n\n<p>It runs fine for the first 4 or 5 documents and then I get the error \"pastespecial method of range class failed\". The document it fails on is in no way different to the others and if I delete this document then it fails on another one. Can anyone help please? I'm new to VBA so my code may well be rubbish. \nHere is the full code:</p>\n\n<pre><code>Sub readForml()\n\nDim wdApp As New Word.Application\nDim myDoc As Word.Document\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim i As Integer\nDim myWkSht As Worksheet\n\nwdApp.Visible = False\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n myExtension = \"*.docx*\"\n\nSet myWkSht = ActiveSheet\nmyPath = \"path_to_folder\"\nmyFile = Dir(myPath &amp; myExtension)\n'set i to be furst blank row\ni = myWkSht.Cells(myWkSht.Rows.Count, 1).End(xlUp).Row\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n     'Set variable equal to opened workbook\n      Set myDoc = wdApp.Documents.Open(Filename:=myPath &amp; myFile)\n      DoEvents\n\n\nWith myDoc.Content\n\n        .Find.ClearFormatting\n        With .Find\n            .Text = \"number[0-9]{4}\"\n            .Format = False\n            .MatchCase = True\n            .MatchWholeWord = False\n            .MatchWildcards = True\n            .Execute\n            End With\n        .Copy\n           myWkSht.Range(\"A\" &amp; i).PasteSpecial xlPasteValues\n\n\nEnd With\n\n      myDoc.Close SaveChanges:=False\n\n    i = i + 1\n    'Get next file name\n      myFile = Dir()\n    Loop\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance\"</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": false, "score": 0, "last_activity_date": 1536166400, "last_edit_date": 1536166400, "creation_date": 1536165902, "answer_id": 52189981, "question_id": 52189946, "link": "https://stackoverflow.com/questions/52189946/excel-macro-trying-to-grab-5-rows-place-in-5-horizontal-spaces-and-stack-on-to/52189981#52189981", "title": "Excel Macro - Trying to grab 5 rows place in 5 horizontal spaces and stack on top of each other", "body": "<p>Pretending for a moment that the languages are in order, a few different ways of doing things:</p>\n\n<p>1) Formulas - <code>=Index(A:A,Row()*4+1)</code> (Change the 1 to 2, 3, 4 depending)</p>\n\n<p>2) VBA simple loop basics- </p>\n\n<pre><code>For i = 2 to LastRowA\n    if i mod 4 = 1 then\n          LastRowB = 'LastRow for column B\n          ws.range(\"B\" &amp; LastRowB + 1) = ws.range(\"A\" &amp; i)\n     else if i mod 4 = 2 then\n           LastRowC = 'LastRow for column B\n          ws.range(\"C\" &amp; LastRowC + 1) = ws.range(\"A\" &amp; i)\n     else if i mod 4 = 3 then\n          LastRowD = 'LastRow for column B\n          ws.range(\"D\" &amp; LastRowD + 1) = ws.range(\"A\" &amp; i)\n     else if i mod 4 = 0 then\n          LastRowE = 'LastRow for column B\n          ws.range(\"E\" &amp; LastRowE + 1) = ws.range(\"A\" &amp; i)\n     End if\n\n\nNext i\n</code></pre>\n\n<p>Note that this is just the rough structure of a conditional loop like this - further tweaking and editing is needed for the syntax (and some research on how to find lastrow)</p>\n\n<p>I recommend the formulaic method. </p>\n\n<p>Also note: The methods I listed will preserve the original data, which is my preference when doing this type of work. It lets you get a free \"Do over\" if there's any mistakes.</p>\n"}], "owner": {"reputation": 571, "user_id": 1536383, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/82cd4e0e3d4d768b66627e6fcf4fa201?s=128&d=identicon&r=PG", "display_name": "Rich Stevens", "link": "https://stackoverflow.com/users/1536383/rich-stevens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593761600, "creation_date": 1536165749, "last_edit_date": 1593761600, "question_id": 52189946, "link": "https://stackoverflow.com/questions/52189946/excel-macro-trying-to-grab-5-rows-place-in-5-horizontal-spaces-and-stack-on-to", "title": "Excel Macro - Trying to grab 5 rows place in 5 horizontal spaces and stack on top of each other", "body": "<p>I have one column of data which has 1 word translated under it 4 times. Then this repeats all down the column. What I want to have is 4 columns with each language translation in each one. They are stacked on top of each other at the moment. I have tried a Macro but can't seem to get it to loop.</p>\n\n<pre><code>Range(\"B3\").Select\nSelection.Cut\nRange(\"C2\").Select\nActiveSheet.Paste\nRange(\"B4\").Select\nSelection.Cut\nRange(\"D2\").Select\nActiveSheet.Paste\nRange(\"B5\").Select\nSelection.Cut\nRange(\"E2\").Select\nActiveSheet.Paste\nRange(\"B6\").Select\nSelection.Cut\nRange(\"B3\").Select\nActiveSheet.Paste\nRange(\"B7\").Select\nSelection.Cut\nRange(\"C3\").Select\nActiveSheet.Paste\nRange(\"B8\").Select\nSelection.Cut\n</code></pre>\n\n<p>Is it best to use cut and then move the first column up and repeat the same action?</p>\n\n<p>Attached image of data on left and how it should look on right. Appreciate any pointers, thanks.<a href=\"https://i.stack.imgur.com/2n118.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2n118.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 3, "creation_date": 1536165880, "post_id": 52189942, "comment_id": 91329647, "body": "Do you know what specific privilege issue you encountered?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1536166183, "post_id": 52189942, "comment_id": 91329794, "body": "Are you planning to leave the access DB open 24/7/365?"}, {"owner": {"reputation": 5, "user_id": 10321414, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6NyzCWSY3H0/AAAAAAAAAAI/AAAAAAAACkk/xJSmC_0guzQ/photo.jpg?sz=128", "display_name": "Pankil Patel", "link": "https://stackoverflow.com/users/10321414/pankil-patel"}, "edited": false, "score": 0, "creation_date": 1536166958, "post_id": 52189942, "comment_id": 91330150, "body": "@ jeremyHi, i am having priviledge issue of operation code 2, my workplace is not allowing to run batch based job....when i manually run my batch file it runs perfectly and create outlook mail but the same thing is not happening with scheduler, i am not able to do schedule on &quot;highest priviledge&quot;, so i thought of using ontime function"}, {"owner": {"reputation": 5, "user_id": 10321414, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6NyzCWSY3H0/AAAAAAAAAAI/AAAAAAAACkk/xJSmC_0guzQ/photo.jpg?sz=128", "display_name": "Pankil Patel", "link": "https://stackoverflow.com/users/10321414/pankil-patel"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1536167081, "post_id": 52189942, "comment_id": 91330218, "body": "@nathan_sav, i can open the same on daily basis so that during day it can run once, say i can make it open from 9 a.m to 9 p.m and want to run at  say 6 p.m., once in a day"}, {"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 0, "creation_date": 1536167188, "post_id": 52189942, "comment_id": 91330265, "body": "If you are doing this from your workplace, and the privilege is denied, and it is legitimate work, then can your IT department modify your privileges? email is a sensitive thing, and has extra security because it has been abused in the past."}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1536167667, "post_id": 52189942, "comment_id": 91330479, "body": "Check <a href=\"https://stackoverflow.com/questions/40910634/schedule-ms-access-module/40911304#40911304\">my answer here</a> it may help"}, {"owner": {"reputation": 5, "user_id": 10321414, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6NyzCWSY3H0/AAAAAAAAAAI/AAAAAAAACkk/xJSmC_0guzQ/photo.jpg?sz=128", "display_name": "Pankil Patel", "link": "https://stackoverflow.com/users/10321414/pankil-patel"}, "edited": false, "score": 0, "creation_date": 1536168184, "post_id": 52189942, "comment_id": 91330687, "body": "Hi, jeremy and thomas G, let me try to solve priviledge issue with IT. It seems task scheduler is better option....thank you so very much for prompt help....will get back in case of further help on this"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10321414, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6NyzCWSY3H0/AAAAAAAAAAI/AAAAAAAACkk/xJSmC_0guzQ/photo.jpg?sz=128", "display_name": "Pankil Patel", "link": "https://stackoverflow.com/users/10321414/pankil-patel"}, "edited": false, "score": 0, "creation_date": 1536215306, "post_id": 52191481, "comment_id": 91344707, "body": "Hello guys, i am done with priviledge part and my code is running perfectly but a new issue i encountered is my db is opened all the time, now i want to make some changes in my module but it shows me error that i cannot save changes probably due to db is opened. I am not able to close it via task manager it shows me you nees admin rights to perform the task. As i am on company machine, i do not have admin rights."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 5, "user_id": 10321414, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6NyzCWSY3H0/AAAAAAAAAAI/AAAAAAAACkk/xJSmC_0guzQ/photo.jpg?sz=128", "display_name": "Pankil Patel", "link": "https://stackoverflow.com/users/10321414/pankil-patel"}, "edited": false, "score": 0, "creation_date": 1536247438, "post_id": 52191481, "comment_id": 91364106, "body": "What is probably happening is that either you missed the step where your macro has to close the database as its final act, or whatever code you used to accomplish that is not working properly. You can test that by running your batch script manually and making sure the database closes at the end with no errors. This is not the kind of thing you can troubleshoot without admin rights. You will probably need some help by your company&#39;s IT support."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1536173672, "last_edit_date": 1536173672, "creation_date": 1536172414, "answer_id": 52191481, "question_id": 52189942, "link": "https://stackoverflow.com/questions/52189942/how-to-run-vba-code-everyday-say-at-630-p-m/52191481#52191481", "title": "How to run vba code everyday say at 6:30 p.m", "body": "<p>Here is how you do it:</p>\n\n<ul>\n<li>Set up your VBA code as function (not sub).</li>\n<li>Create a macro that runs that function and then closes the database.</li>\n<li>Create a command prompt batch file that runs your MS Access file with\nthe /x switch (see example below).</li>\n<li>Set up the batch file as a scheduled task on your server or any\ncomputer you want that VBA code to run on. If not a server make sure\nit stays on and there is no power saving on network card, no sleep/suspend. <strong>Make sure the scheduled task's user has any required privileges.</strong></li>\n</ul>\n\n<p>You can set up a scheduled task to run with admin privileges. Generally if the user set up as the user for the task can run it, then the scheduled task will run as well. It does not have to be the user creating the scheduled task. If necessary create a user account with the required permissions and use that.</p>\n\n<p>Batch file example:</p>\n\n<pre><code>\"C:\\Program Files\\Microsoft Office\\Office16\\MSACCESS.EXE\" \"C:\\Databases\\MyDatabase.accdb\" /x Daily\nEXIT\n</code></pre>\n\n<p>This will run Access 2016, 64-bit, open the MyDatabase.accdb file and run the macro named \"Daily\" .</p>\n\n<p>As an addition: It is possible to do scheduled tasks and use Outlook as a sender. But if you don't need to use Outlook as a sender you can make your life a little easier and use <code>Swithmail</code>.</p>\n\n<p>If you absolutely need to use Outlook, check this:\n<a href=\"https://support.microsoft.com/en-us/help/3189806/a-program-is-trying-to-send-an-e-mail-message-on-your-behalf-warning-i\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/3189806/a-program-is-trying-to-send-an-e-mail-message-on-your-behalf-warning-i</a></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 0, "last_activity_date": 1536725693, "creation_date": 1536725693, "answer_id": 52287411, "question_id": 52189942, "link": "https://stackoverflow.com/questions/52189942/how-to-run-vba-code-everyday-say-at-630-p-m/52287411#52287411", "title": "How to run vba code everyday say at 6:30 p.m", "body": "<p>Just use Windows Task Scheduler.  Even if you have a batch file, which you don't need for this kind of thing, you would still fire it off with WTS.</p>\n\n<ol>\n<li><p>Press the Windows + R keys to open the Run dialog, type taskschd.msc, and press Enter.\nNOTE: This will open Task Scheduler. This file is located at:\nC:\\Windows\\system32\\taskschd.msc.</p></li>\n<li><p>While having Task Scheduler Library selected in the left pane, click/tap on Create task in the far right pane. (see screenshot below)</p></li>\n<li><p>Under the General tab, type in the \"Name\" of the program you want to create this shortcut for. (see screenshot below)\nNOTE: This will be the name of the task. As an example, I will use CCleaner for that program. Make note of this name, you will need it later in step 12 and 14 below.</p></li>\n<li><p>Check the Run with highest privileges box. (See screenshot below)</p></li>\n<li><p>Click/tap on the Configure for drop down box to open it, and select Windows\u00ae 7, Windows Server\u2122 2008 R2 or the Windows you are currently in. (see screenshot above and below)\nNOTE: This is like compatibility mode. If the program does not support running in Windows 7 normally, then you can select the OS that is does support running in instead to have it run in compatibility mode as if it was running in that OS instead of Windows 7.</p>\n\n<p>Elevated Program Shortcut without UAC Prompt - Create-drop_down_box.jpg</p></li>\n<li><p>Click/tap on the Actions tab, then on the New button. (see screenshot below)</p></li>\n<li><p>In the Program/script: box in the Actions tab, copy and paste the path below. (see screenshot below step 9)\nNOTE: Thank you to chillz for the updated steps 7 and 8.</p>\n\n<p>%windir%\\System32\\cmd.exe</p></li>\n<li><p>In the Add arguments (optional): box in the Actions tab, type in the argument below. (see screenshot below step 9)</p></li>\n</ol>\n\n<p>NOTE: Substitute Task Name in the argument below with the name you entered in step 3 (ex: CCleaner) within quotes, and substitute Full Path of Program in the argument below with the actual full path of the program's .exe file within quote.\nc start \"Task Name\" \"Full Path of Program\"\nFor example:\nCode:\nc start \"CCleaner\" \"C:\\Program Files\\CCleaner\\CCleaner64.exe\"</p>\n\n<ol start=\"9\">\n<li><p>Click/tap on OK. (see screenshot below)</p></li>\n<li><p>Click/tap on the Conditions tab, and uncheck the Stop if the computer switches to battery power box first, then uncheck the Start the task only if the computer is on AC power box. (see screenshots below)\nNOTE: This step is mostly for laptops, so that you will be able to run the program when the laptop is running on battery power.</p></li>\n<li><p>Click/tap on OK. (See screenshots above)</p></li>\n<li><p>You will now see your new task created with the name (ex: CCleaner) you gave it in step 3. Close Task Scheduler. (see screenshot below)</p></li>\n<li><p>Right click or press and hold on an empty area of your desktop, then click/tap on New and Shortcut.</p></li>\n<li><p>Type in the target below for the location field, then click/tap on the Next button. (see screenshot below)\nNOTE: Subsitute task-name in the target with the name (ex: CCleaner) within quotes that you used in step 3.</p>\n\n<p>schtasks /run /tn \"task-name\"</p>\n\n<p>For example: For my task name CCleaner I used from step 3, I would type:\nschtasks /run /tn \"CCleaner\"</p></li>\n<li><p>Type in a name you want for the shortcut (ex: CCleaner), then click/tap on the Finish button. (see screenshot below)</p></li>\n<li><p>Right click on the new shortcut (ex: CCleaner) on the desktop, then click/tap on Properties.</p></li>\n<li><p>Click/tap on the Shortcut tab, and on the Change Icon button. (see screenshot below)</p></li>\n<li><p>Click/tap on OK. (see screenshot below)</p></li>\n<li><p>Click/tap on the Browse button. (see screenshot below)</p></li>\n<li><p>Navigate to the .exe file of the program that you have created this shortcut with, select it, and click/tap on Open. (see screenshot below)\nNOTE: If you have a icon of your own that you would prefer to use instead, then navigate to where you have that icon saved at instead.</p></li>\n<li><p>Select the icon you want for the shortcut, then click/tap on OK. (see screenshot below)</p></li>\n<li><p>Click/tap on OK. (see screenshot below)</p></li>\n<li><p>You can now use this elevated shortcut to run at startup in your \"Startup\" folder, run at startup as a task, Pin to Start Menu, Pin to Taskbar, assign a keyboard shortcut, or move to where you like for easy use.</p></li>\n<li><p>When you run this new elevated shortcut, you will now no longer have to click/tap on YES to approve the UAC prompt to allow the program run as administrator.</p></li>\n</ol>\n\n<p><a href=\"https://www.sevenforums.com/tutorials/11949-elevated-program-shortcut-without-uac-prompt-create.html\" rel=\"nofollow noreferrer\">https://www.sevenforums.com/tutorials/11949-elevated-program-shortcut-without-uac-prompt-create.html</a></p>\n\n<p>Finally, see this.</p>\n\n<p><a href=\"https://support.office.com/en-us/article/create-a-macro-that-runs-when-you-open-a-database-98ba1508-dcc6-4e0f-9698-a4755e548124\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/create-a-macro-that-runs-when-you-open-a-database-98ba1508-dcc6-4e0f-9698-a4755e548124</a></p>\n"}], "owner": {"reputation": 5, "user_id": 10321414, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6NyzCWSY3H0/AAAAAAAAAAI/AAAAAAAACkk/xJSmC_0guzQ/photo.jpg?sz=128", "display_name": "Pankil Patel", "link": "https://stackoverflow.com/users/10321414/pankil-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 1, "accepted_answer_id": 52287411, "answer_count": 2, "score": 0, "last_activity_date": 1536725693, "creation_date": 1536165733, "question_id": 52189942, "link": "https://stackoverflow.com/questions/52189942/how-to-run-vba-code-everyday-say-at-630-p-m", "title": "How to run vba code everyday say at 6:30 p.m", "body": "<p>I want to run vba code at specified time say at 6.30 p.m. everyday.\nI tried scheduler with batch file but it didnt work due to privillage issue.\nI want to use ontime function for that in access.\nI am done with outlook part to send mail but issue is to run at everyday at specified time.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "ms-access", "dao", "recordset"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1536165779, "post_id": 52189880, "comment_id": 91329597, "body": "You don&#39;t have a default value for <code>Payroll</code> if there are no records.  Also, how are you accessing the values?  You are returning a recordset to a textbox as your comment on the line suggests."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1536168214, "post_id": 52189880, "comment_id": 91330708, "body": "You assign <i>strSQL</i> but never use it. Is the <code>OpenRecordSet</code> line missing? What is the end goal of function? And how is it called from textbox?"}, {"owner": {"reputation": 11, "user_id": 5418765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f04d792453368e99c94faec072c996a?s=128&d=identicon&r=PG", "display_name": "diplomatika", "link": "https://stackoverflow.com/users/5418765/diplomatika"}, "edited": false, "score": 0, "creation_date": 1536169702, "post_id": 52189880, "comment_id": 91331465, "body": "Sorry, yeah - it was edited too quickly before submission. I&#39;m trying to get a single currency value returned from the query as a result of the overall function."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1536170089, "post_id": 52189880, "comment_id": 91331647, "body": "Where are you seeing <code>#Name?</code>?  I guess that you see the error value in a form field?  The function you shared returns a RecordSet object, so technically it will not return what you say it returns... it should either be a valid object or Nothing.  Anything else would result in an error, so what you are seeing is likely the result of Access automatically &quot;handling&quot; the error and displaying the error value back to you."}, {"owner": {"reputation": 11, "user_id": 5418765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f04d792453368e99c94faec072c996a?s=128&d=identicon&r=PG", "display_name": "diplomatika", "link": "https://stackoverflow.com/users/5418765/diplomatika"}, "edited": false, "score": 0, "creation_date": 1536170152, "post_id": 52189880, "comment_id": 91331674, "body": "#Name? is the result of the textbox with this in the controlsource: <code>=payrollVar(#7&#47;1&#47;2017#,&quot;CE_013&quot;,&quot;ODE&quot;)</code>"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1536170395, "post_id": 52189880, "comment_id": 91331786, "body": "There are a variety of problems with the code. 1) You cannot return an entire RecordSet object from a function and display it in a form control.  2)  The function says that it will return a RecordSet object, but the updated code is returning an array of values from the GetRows() function.  3) If you want a single value from the query, you need to get the value using other RecordSet methods like <code>rsSQL.Field(0)</code> or <code>rsSQL.Field(&quot;*Quantity&quot;)</code> or something."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1536170514, "post_id": 52189880, "comment_id": 91331833, "body": "Also, a hint for future use of StackOverflow.  In replying to a particular comment, using the &#39;@&#39; symbol followed by a user name.  Otherwise the user to which you reply will <b>not</b> get a notification and may never reply.  Click on the <code>help</code> link next to the Comment box for more information."}, {"owner": {"reputation": 11, "user_id": 5418765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f04d792453368e99c94faec072c996a?s=128&d=identicon&r=PG", "display_name": "diplomatika", "link": "https://stackoverflow.com/users/5418765/diplomatika"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1536170859, "post_id": 52189880, "comment_id": 91331961, "body": "@CPerkins I changed the code to <code>rsSQL.Field(&quot;*Quantity&quot;)</code>, but same error. I&#39;ll keep hacking at it."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1536171230, "post_id": 52189880, "comment_id": 91332131, "body": "That&#39;s a step forward, but you need to address each and every issue that I mentioned.  What about the function return type?  It should be something like <code>As Currency</code>, not <code>As DAO.Recordset</code>."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1536171328, "post_id": 52189880, "comment_id": 91332174, "body": "I suggest <a href=\"https://www.techonthenet.com/access/tutorials/vbadebug2010/debug01.php\" rel=\"nofollow noreferrer\">VBA Debugging</a>.  It is also useful to create a new module separate from a form and create stand-alone functions for testing code like this.  You can execute a public stand-alone function within the VBA Editor by either calling the test function from <i>Immediate Window</i> or pressing F5 while inside the function code.  If the function has parameters, you can create a separate test function which passes in dummy arguments.  Combine that technique with Debug.Print statements, breakpoints, etc.  Best of luck!"}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1536173313, "last_edit_date": 1536173313, "creation_date": 1536172804, "answer_id": 52191569, "question_id": 52189880, "link": "https://stackoverflow.com/questions/52189880/vba-function-returning-recordset-value-from-sql-query/52191569#52191569", "title": "VBA function returning recordset value from SQL Query", "body": "<p>Consider the <a href=\"https://support.office.com/en-us/article/dlookup-function-8896cb03-e31f-45d1-86db-bed10dca5937\" rel=\"nofollow noreferrer\">DLookUp</a> function instead of a DAO recordset retrieval which is not available directly to form controls like textboxes. Then, directly assign the value to your textbox in VBA and be sure to remove any <code>ControlSource</code> as textbox should be blank for VBA assignment.</p>\n\n<p>Available in Access SQL and VBA, DLookUp's <em>criteria</em> argument can take any compliant SQL <code>WHERE</code> condition. Hence, you can reuse parts of your <code>SELECT</code> statement. Also, the function returns the first instance of a lookup if multiple values should return.</p>\n\n<pre><code>Public Function payrollVar(dateVar As Date, roleidVar As String, typeVar As String)\n    Dim val As Variant\n\n    If typeVar = \"Actual\" Or typeVar = \"Forecast\" Then\n\n        val = DLookUp(\"[*Quantity]\", \"[Master Data]\", _\n                      \"[*Category] = 'Payroll' AND \" _\n                       &amp; \"[*Date] = #\" &amp; dateVar &amp; \"#) AND \" _\n                       &amp; \"[*Role ID] = '\" &amp; roleidVar &amp; \"' AND \" _\n                       &amp; \"[*Type] = '\" &amp; typeVar &amp; \"'\")\n\n    ElseIf typeVar = \"ODE\" Then\n\n        val = DLookUp(\"[*Quantity]\", \"[Master Data]\", _\n                      \"[*Category] = 'Resource_Detail_Cost_Increase_Projections_Table' AND \" _\n                       &amp; \"[*Date] = #\" &amp; dateVar &amp; \"#) AND  \" _\n                       &amp; \"[*Role ID] = '\" &amp; roleidVar &amp; \"' AND \" _\n                       &amp; \"[*Type] = '\" &amp; typeVar &amp; \"'\")\n\n    End If\n\n    ' ASSIGN TO UNBOUND TEXTBOX \n    Me.[myTextbox] = val\n\nEnd Function\n</code></pre>\n\n<p>Then on the event trigger be it <code>OnClick</code>, <code>OnOpen</code>, <code>AfterUpdate</code>, etc. call the non-returned method: </p>\n\n<pre><code>Call payrollVar(param1, param2, param3)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1536175730, "creation_date": 1536175730, "answer_id": 52192191, "question_id": 52189880, "link": "https://stackoverflow.com/questions/52189880/vba-function-returning-recordset-value-from-sql-query/52192191#52192191", "title": "VBA function returning recordset value from SQL Query", "body": "<p>First of all, I too recommend using <code>DLookup</code> like Parfait suggests. I would go one step further and combine it with <code>IIF</code> so that a function is not even necessary, but that also depends on other factors. But if you do want to use recordset and assuming your SQL is correct this is what you are missing:</p>\n\n<p>Instead of</p>\n\n<pre><code>payrollVar = rsSQL.GetRows(0)\n</code></pre>\n\n<p>you need:</p>\n\n<pre><code>rsSQL.MoveFirst\npayrollVar=rsSQL![*Quantity]\nrsSQL.Close\n</code></pre>\n\n<p>This generally is not enough! It is only good enough if you are assured that your query will return a value. If there is a chance it will find no record to return you need to enclose it in an if statement like this:</p>\n\n<pre><code>if rsSQL.EOF=False OR rsSQL.BOF=False Then\n  rsSQL.MoveFirst\n  payrollVar=rsSQL![*Quantity]\nElse\n  payrollVar=0 (or whatever value indicates no result found)\nEnd If\nrsSQL.Close\n</code></pre>\n\n<p>Finally, why on earth would you use <code>*</code> on a column name?? SQL is so much easier to work and read if you don't use spaces and symbols in names.</p>\n"}], "owner": {"reputation": 11, "user_id": 5418765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f04d792453368e99c94faec072c996a?s=128&d=identicon&r=PG", "display_name": "diplomatika", "link": "https://stackoverflow.com/users/5418765/diplomatika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2099, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536175730, "creation_date": 1536165447, "last_edit_date": 1536170105, "question_id": 52189880, "link": "https://stackoverflow.com/questions/52189880/vba-function-returning-recordset-value-from-sql-query", "title": "VBA function returning recordset value from SQL Query", "body": "<p>I'm trying to return a currency value from a table, and I need to pass variables into a VBA defined function that contains a query in order to get the right one. I have the function used in a text box on a form, but it's returning:</p>\n\n<pre><code>#Name?\n</code></pre>\n\n<p>Any help is appreciated. Code below:</p>\n\n<pre><code>Option Compare Database\n\nPublic Function payrollVar(dateVar As Date, roleidVar As String, typeVar As String) As DAO.Recordset\n\nDim dbs As DAO.Database\nDim rsSQL As DAO.Recordset\nDim strSQL As String\n\nSet dbs = CurrentDb\n\n'typeVar must either be ODE, Actual, or Forecast\n\nIf typeVar = \"Actual\" Or \"Forecast\" Then\n    strSQL = \"SELECT [Master Data].[*Quantity]\" &amp; _\n             \"FROM [Master Data]\" &amp; _\n             \"WHERE ((([Master Data].[*Category])='Payroll') AND (([Master Data].[*Date])= \" &amp; dateVar &amp; \") AND (([Master Data].[*Role ID])= '\" &amp; roleidVar &amp; \"' ) AND (([Master Data].[*Type])= '\" &amp; typeVar &amp; \"' ));\"\nElseIf typeVar = \"ODE\" Then\n    strSQL = \"SELECT [Master Data].[*Quantity]\" &amp; _\n             \"FROM [Master Data]\" &amp; _\n             \"WHERE ((([Master Data].[*Data Version])='Resource_Detail_Cost_Increase_Projections_Table') AND (([Master Data].[*Category])='Payroll') AND (([Master Data].[*Date])= \" &amp; dateVar &amp; \") AND (([Master Data].[*Role ID])= '\" &amp; roleidVar &amp; \"' ));\"\nEnd If\n\nSet rsSQL = dbs.OpenRecordset(strSQL)\n\npayrollVar = rsSQL.GetRows(0)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1536165273, "creation_date": 1536165273, "answer_id": 52189841, "question_id": 52189598, "link": "https://stackoverflow.com/questions/52189598/find-first-non-blank-row-above-selected-cell/52189841#52189841", "title": "Find first non-blank row above selected cell", "body": "<p>This will find the first non-blank cell (which will indicate the row is not blank) above the selected cell.</p>\n\n<p>You need to check for:  </p>\n\n<ul>\n<li>If the rest of the sheet is empty it will return the same address as your selection. </li>\n<li>If all cells above the selection are empty it will start from the bottom of the sheet until it reaches your selection again.   </li>\n</ul>\n\n<p>As you said the first non-blank cell it's using the <code>*</code> wildcard to search, and to make it look up from the selection it uses <code>xlPrevious</code>.  </p>\n\n<p>Still need to check if <code>rng</code> is nothing in case the entire sheet is empty.</p>\n\n<pre><code>Sub Test()\n\n    Dim Rng As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A:Z\")\n        Set Rng = .Cells.Find(What:=\"*\", _\n                              After:=Selection, _\n                              LookIn:=xlValues, _\n                              LookAt:=xlWhole, _\n                              SearchOrder:=xlByRows, _\n                              SearchDirection:=xlPrevious)\n\n        If Not Rng Is Nothing Then\n            If Rng.Address = Selection.Address Or Rng.Row &gt; Selection.Row Then\n                MsgBox \"Nothing found\"\n            Else\n                Rng.Select\n            End If\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1536165315, "creation_date": 1536165315, "answer_id": 52189850, "question_id": 52189598, "link": "https://stackoverflow.com/questions/52189598/find-first-non-blank-row-above-selected-cell/52189850#52189850", "title": "Find first non-blank row above selected cell", "body": "<p>I'm not sure I understand your code, but I think you are looking for something like this:</p>\n\n<pre><code>...\n...\nIf Not Rng Is Nothing Then\n    Do While Rng.Row &gt; 1 And Rng.Offset(-1, 0).Value &lt;&gt; \"\"\n        Set Rng = Rng.Offset(-1, 0)\n    Loop\n...\n</code></pre>\n\n<p>Once the cell is found, it works its way up until it finds an empty cell and stops just before.         </p>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1536322371, "post_id": 52190472, "comment_id": 91393226, "body": "Could you tick @Sams answer as the accepted answer?"}, {"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1536337166, "post_id": 52190472, "comment_id": 91402083, "body": "I&#39;m sorry, I would do that with pleasure, but @Sam&#39;s answer does not solve the topic."}], "tags": [], "owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "is_accepted": true, "score": 0, "last_activity_date": 1536576469, "last_edit_date": 1536576469, "creation_date": 1536168103, "answer_id": 52190472, "question_id": 52189598, "link": "https://stackoverflow.com/questions/52189598/find-first-non-blank-row-above-selected-cell/52190472#52190472", "title": "Find first non-blank row above selected cell", "body": "<p>I managed to get what I need based on @Sam 's answer</p>\n\n<pre><code>    If Not Rng Is Nothing Then\n                    Do While Rng.Row &gt; 1 And Rng.Offset(-1, 0).Value &lt;&gt; \"\"\n                        Set Rng = Rng.Offset(-1, 0)\n                    Loop\n                    grupo = Rng.Offset(-1, -1).Value\n                    Lcell.Value = grupo\n                End If\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 52190472, "answer_count": 3, "score": 0, "last_activity_date": 1536576469, "creation_date": 1536164211, "question_id": 52189598, "link": "https://stackoverflow.com/questions/52189598/find-first-non-blank-row-above-selected-cell", "title": "Find first non-blank row above selected cell", "body": "<p>I would like to select the first non-blank row above the selected cell (minus offset). For example, if a find <code>Machine 1</code> in the sheet <code>Grupos Produ\u00e7\u00e3o</code> I want to return the <code>******* Grupo 1 *******</code> string.</p>\n\n<pre><code>********** Grupo  1  ********** \n    Machine 1\n    Machine 2\n</code></pre>\n\n<p>I have the following so far, but it's not returning what I need.</p>\n\n<pre><code>    Dim FindString As String\n    Dim Rng As Range\n    FindString = Lcell.Value\n    If Trim(FindString) &lt;&gt; \"\" Then\n        With Sheets(\"Grupos Produ\u00e7\u00e3o\").Range(\"A:Z\")\n            Set Rng = .Find(What:=FindString, _\n                            After:=.Cells(.Cells.Count), _\n                            LookIn:=xlValues, _\n                            LookAt:=xlWhole, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlNext, _\n                            MatchCase:=False)\n            If Not Rng Is Nothing Then\n                Application.Goto Rng, True\n                upperRow = .Cells(Rng.Row, Rng.Column - 1).End(xlDown).Row\n            Else\n                MsgBox \"Nothing found\"\n            End If\n        End With\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536163934, "post_id": 52189466, "comment_id": 91328713, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21834701/use-autofilter-on-more-than-2-criteria\">use autofilter on more than 2 criteria</a>"}, {"owner": {"reputation": 21, "user_id": 10316829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Hqvy0crfps/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNVd9T4M4pF0qchka92liPj9bhlrA/mo/photo.jpg?sz=128", "display_name": "Mac MacDonald", "link": "https://stackoverflow.com/users/10316829/mac-macdonald"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536164013, "post_id": 52189466, "comment_id": 91328760, "body": "@BigBen I tried that method and it did not seem to work for me."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1536164169, "post_id": 52189466, "comment_id": 91328838, "body": "you could move to a multi key sort . . . if it suits your purposes."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536164360, "post_id": 52189466, "comment_id": 91328934, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.autofilter\" rel=\"nofollow noreferrer\"><code>Range.Autofilter</code></a> doesn&#39;t have a 3rd criterion. Can you <a href=\"https://stackoverflow.com/posts/52189466/edit\">edit</a> your question with the attempt to use an <code>Array</code> like in the linked question?"}, {"owner": {"reputation": 21, "user_id": 10316829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Hqvy0crfps/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNVd9T4M4pF0qchka92liPj9bhlrA/mo/photo.jpg?sz=128", "display_name": "Mac MacDonald", "link": "https://stackoverflow.com/users/10316829/mac-macdonald"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536164886, "post_id": 52189466, "comment_id": 91329184, "body": "@BigBen see edit above."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536166482, "post_id": 52189466, "comment_id": 91329924, "body": "<code>Field</code> should be 5 based on your original code, right?"}, {"owner": {"reputation": 21, "user_id": 10316829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Hqvy0crfps/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNVd9T4M4pF0qchka92liPj9bhlrA/mo/photo.jpg?sz=128", "display_name": "Mac MacDonald", "link": "https://stackoverflow.com/users/10316829/mac-macdonald"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536166985, "post_id": 52189466, "comment_id": 91330167, "body": "@BigBen yes it should"}], "owner": {"reputation": 21, "user_id": 10316829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--Hqvy0crfps/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNVd9T4M4pF0qchka92liPj9bhlrA/mo/photo.jpg?sz=128", "display_name": "Mac MacDonald", "link": "https://stackoverflow.com/users/10316829/mac-macdonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536164855, "creation_date": 1536163777, "last_edit_date": 1536164855, "question_id": 52189466, "link": "https://stackoverflow.com/questions/52189466/adding-a-third-criteria-to-autofilter-vba", "title": "Adding a third criteria to autofilter VBA", "body": "<p>I would like to add an additional 3rd criteria to the code i wrote that autofilters the values \"RENT\" and \"emprent\" in the set range. I would like to add \"rtna\" as the third criteria. </p>\n\n<pre><code>Sheets(\"Filter\").Activate\nWith ActiveSheet\n    .AutoFilterMode = False\n    .Range(\"P1:W10000\").AutoFilter Field:=1, Criteria1:=Array(\"RENT\", \"rtna\", _\n                                    \"emprent\"), _\n                    Operator:=xlFilterValues\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1536166196, "post_id": 52189436, "comment_id": 91329802, "body": "What is the value of <code>RowSelect</code> when the error occurs?  You could step through using F8 or setup that line as a debug point."}, {"owner": {"reputation": 1, "user_id": 10312152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202ac6dd8d7f5f16ba46fe6ca76f2fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Shisho", "link": "https://stackoverflow.com/users/10312152/shisho"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1536176146, "post_id": 52189436, "comment_id": 91334293, "body": "492 (LastRow+1)"}], "answers": [{"comments": [{"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 1, "user_id": 10312152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202ac6dd8d7f5f16ba46fe6ca76f2fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Shisho", "link": "https://stackoverflow.com/users/10312152/shisho"}, "edited": false, "score": 0, "creation_date": 1536177271, "post_id": 52189838, "comment_id": 91334783, "body": "If that&#39;s the case, then maybe verify that RowSelect is not being passed a value &lt; 1."}, {"owner": {"reputation": 1, "user_id": 10312152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202ac6dd8d7f5f16ba46fe6ca76f2fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Shisho", "link": "https://stackoverflow.com/users/10312152/shisho"}, "edited": false, "score": 0, "creation_date": 1536182204, "post_id": 52189838, "comment_id": 91336760, "body": "As I wrote above - No.  RowSelect=492."}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": false, "score": 0, "last_activity_date": 1536171632, "last_edit_date": 1536171632, "creation_date": 1536165264, "answer_id": 52189838, "question_id": 52189436, "link": "https://stackoverflow.com/questions/52189436/run-time-error-2147417848-80010108-method-cells-of-object-worksheet-fa/52189838#52189838", "title": "Run-time error &#39;-2147417848 (80010108)&#39;: Method &#39;Cells&#39; of object&#39;_Worksheet&#39; failed", "body": "<p>Try replacing references to the \"Sheets\" with \"Worksheets\". Also, use a with block to reduce redundant code.</p>\n\n<pre><code>With Worksheets(vCustomersShName)\n    .Cells(RowSelect, 1) = vCustomerID\n    .Cells(RowSelect, 2) = UF_NewCustomer.TB_Shem.Value\n    .Cells(RowSelect, 3) = UF_NewCustomer.TB_Mishpacha.Value\n    .Cells(RowSelect, 4) = UF_NewCustomer.TB_LName.Value\n    .Cells(RowSelect, 5) = UF_NewCustomer.TB_FName.Value\n    .Cells(RowSelect, 6) = UF_NewCustomer.TB_Tel.Value\n    .Cells(RowSelect, 7) = UF_NewCustomer.TB_Mail.Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10312152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202ac6dd8d7f5f16ba46fe6ca76f2fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Shisho", "link": "https://stackoverflow.com/users/10312152/shisho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536171632, "creation_date": 1536163651, "last_edit_date": 1536164997, "question_id": 52189436, "link": "https://stackoverflow.com/questions/52189436/run-time-error-2147417848-80010108-method-cells-of-object-worksheet-fa", "title": "Run-time error &#39;-2147417848 (80010108)&#39;: Method &#39;Cells&#39; of object&#39;_Worksheet&#39; failed", "body": "<p>I have this bug when i tried to put data to cell from textbox.</p>\n\n<p>The debug Marks this line:</p>\n\n<pre><code>Sheets(vCustomersShName).Cells(RowSelect, 1) = vCustomerID\n</code></pre>\n\n<p>(CustomerID is a timestamp string i.e 050918190442 (\"ddmmyyhhmmss\"))</p>\n\n<p>Here my code:</p>\n\n<pre><code>Private Sub CB_Save_Click()\n\n'Get Customer SheetName\nDim vCustomersShName As String\nvCustomersShName = GetShName(\"Tb_Customers\")\n\n\nDim vCustomerID As String\nvCustomerID = UF_NewCustomer.TB_CustomerID.Value\n\n'Clear filter\nSheets(vCustomersShName).Range(\"A1\").AutoFilter\n\n\n'Sort By CustomerID Asc\nSheets(vCustomersShName).ListObjects(\"Customers\").Sort.SortFields _\n        .Add Key:=Range(\"Customers[Customer_ID]\"), SortOn:=xlSortOnValues, Order:= _\n        xlAscending, DataOption:=xlSortNormal\nWith Sheets(vCustomersShName).ListObjects(\"Customers\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\nEnd With\n\n'Filtering By CustomerID\nSheets(vCustomersShName).ListObjects(\"Customers\").Range.AutoFilter Field:=1, Criteria1:=vCustomerID 'Column 1=CustomerID\n\n'Verify if the first row contain CustomerID\nDim FirstRowCustomer As Integer ' First row after filtering\nFirstRowCustomer = Sheets(vCustomersShName).AutoFilter.Range.Offset(1).SpecialCells(xlCellTypeVisible).Cells(1, 2).Row\n\nDim ExistCustomerID As String\nExistCustomerID = Sheets(vCustomersShName).Cells(FirstRowCustomer, 1).Value\n\nDim RowSelect As Integer\nIf Len(ExistCustomerID) = 0 Then 'If FirstRow is empty = It's a new customer --&gt; insert row\n    Dim LastRowCustomer As Integer\n    LastRowCustomer = Sheets(vCustomersShName).Range(\"Customers\").Rows.Count + 1 ' +1 for the header\n    RowSelect = LastRowCustomer + 1 'Insert to new row in Customers table\nElse 'If FirstRow is not empty = It's a new customer --&gt; Update row\n    RowSelect = FirstRowCustomer\nEnd If\n\n'Fill data from TextBoxs to Customers table\nSheets(vCustomersShName).Cells(RowSelect, 1) = vCustomerID\nSheets(vCustomersShName).Cells(RowSelect, 2) = UF_NewCustomer.TB_Shem.Value\nSheets(vCustomersShName).Cells(RowSelect, 3) = UF_NewCustomer.TB_Mishpacha.Value\nSheets(vCustomersShName).Cells(RowSelect, 4) = UF_NewCustomer.TB_LName.Value\nSheets(vCustomersShName).Cells(RowSelect, 5) = UF_NewCustomer.TB_FName.Value\nSheets(vCustomersShName).Cells(RowSelect, 6) = UF_NewCustomer.TB_Tel.Value\nSheets(vCustomersShName).Cells(RowSelect, 7) = UF_NewCustomer.TB_Mail.Value\n\nIf Len(ExistCustomerID) = 0 Then 'Insert new row\n    MsgBox UF_NewCustomer.TB_Shem.Value &amp; \" \" &amp; UF_NewCustomer.TB_Mishpacha.Value &amp; \" was ADDED successfully (:\"\n\n    Room.Lb_Customers.ListIndex = Room.Lb_Customers.ListCount - 1\n\nElse                        'Update exist row\n    MsgBox UF_NewCustomer.TB_Shem.Value &amp; \" \" &amp; UF_NewCustomer.TB_Mishpacha.Value &amp; \" was UPDATED successfully (:\"\nEnd If\nUnload Me\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1536164277, "post_id": 52189238, "comment_id": 91328889, "body": "The error message suggests that you are doing something invalid - which can be just about anything. The first thing to try is to see if you can set the cell values the way you are doing at line starting with <code>Current_QN = </code> in a small and clean sub."}, {"owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1536165671, "post_id": 52189238, "comment_id": 91329541, "body": "Yes what is invalid is that I am trying to pull data when it cannot find an object to grab (end of column) The thing is that I am using this on purpose to stop the action when an error is reached. I have added to my original post and included the section above the code I first provided. It uses an identical approach in a different loop. Without the on error goto, it gives me the same error but when I use the on error goto, it does its job properly."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1536165937, "post_id": 52189238, "comment_id": 91329679, "body": "Ok. The next step is to reduce the code you have posted here down to a minimal example that still produces the problem."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1536221928, "post_id": 52189238, "comment_id": 91348124, "body": "You&#39;re not using <code>On Error GoTo No_More_In_Lot</code> correctly - when it jumps to the <code>No_More_In_Lot</code> label it won&#39;t have cleared the error flag.  You should have the error handler at the end of the code - after an <code>Exit Sub</code> and before the <code>End Sub</code> once the error has been dealt with you can <code>Resume No_More_In_Lot</code>.  The same goes for <code>Skip</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1536222127, "post_id": 52189238, "comment_id": 91348227, "body": "You don&#39;t need to write <code>Else:End If</code> - just <code>End If</code> will do.  There&#39;s also <code>ElseIf</code> rather than embedding another <code>If</code> after an <code>Else</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": false, "score": 0, "last_activity_date": 1536219534, "creation_date": 1536219534, "answer_id": 52198864, "question_id": 52189238, "link": "https://stackoverflow.com/questions/52189238/on-error-goto-getting-error-message-2147024809/52198864#52198864", "title": "On Error GoTo: Getting Error message-2147024809", "body": "<p>It could be that VB has problems with the reserved keyword SKIP.</p>\n\n<pre><code>...\nOn Error GoTo Skip_\n...\nSkip_:\n...\n</code></pre>\n\n<p>Regards, ScriptMan</p>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536219534, "creation_date": 1536162926, "last_edit_date": 1536165744, "question_id": 52189238, "link": "https://stackoverflow.com/questions/52189238/on-error-goto-getting-error-message-2147024809", "title": "On Error GoTo: Getting Error message-2147024809", "body": "<p>I am using VBA to pull data from SAP and separate status based on if a string contains certain words. I need it to exit the loop when an error occurs as this means that there is no more data in the SAP interface and it is trying to pull something that is not there. I used this earlier in this macro with no problems however now it is acting like the on error goto command is not active and instead pops up Error message -2147024809.</p>\n\n<p>Here is the 1st section where on error goto is working properly</p>\n\n<pre><code>'Total Number in lot loop\n'========================================================\nFor C = 0 To 20\n\n'Exits loop when no more are found in column\nOn Error GoTo No_More_In_Lot\n\n'Use Required end column since there is always data here (C does not include the current QN)\nplace_holder = session.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\").getcellvalue(C, \"LTRMN\") ' LTRMN=Name of column in recording\n\nNotification_Status = session.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\").getcellvalue(C, \"STTXT\")\n\n'Exits when no more data\nIf place_holder = \"\" Then\nExit For\nElse\nEnd If\n\n'Counts Each valid complaint\nIf InStr(1, Notification_Status, \"BIMP\") Then\n'Do nothing\nElse\n\nIf InStr(1, Notification_Status, \"CC04\") Then\n'do nothing\nElse\nNumber_In_Lot = Number_In_Lot + 1\nEnd If\nEnd If\n\nNext C\n\nNo_More_In_Lot:\n\n'Places # in lot in excel\nCells(i + 2, 8) = Number_In_Lot\n</code></pre>\n\n<p>Below that, I have the following code where on error goto is not working properly.</p>\n\n<p>Does anyone see anything wrong with the code that I wrote for this?</p>\n\n<pre><code>'Begins separating the notification statuses\n'========================================================\nNumber_Substantiated = 0\nNumber_Not_Substantiated = 0\nNumber_Counterfeit = 0\nNumber_Cancelled = 0\n\nCurrent_QN = Cells(i + 2, 2)\n\nFor C = 0 To 20\n\n'Resets the Notification Status\nNotification_Status = \"\"\n\n'Exits loop when no more are found in column\nOn Error GoTo Skip\n\nNotification_Number = session.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\").getcellvalue(C, \"QMNUM\")\n\nIf Current_QN = Notificaiton_Number Then\n'Do nothing (To not include the current notification status in the report)\nElse\n'Pull Notification status\nNotification_Status = session.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\").getcellvalue(C, \"STTXT\") ' STTXT=Name of column in recording\n\n\n\nIf InStr(1, Notification_Status, \"CC01\") Then\nNumber_Substantiated = Number_Substantiated + 1\nElse: End If\n\n'Include the notifcation status in the report\nIf InStr(1, Notification_Status, \"CC02\") Then\nNumber_Not_Substantiated = Number_Not_Substantiated + 1\nElse: End If\n\n'Include the notifcation status in the report\nIf InStr(1, Notification_Status, \"CC03\") Then\nNumber_Counterfeit = Number_Counterfeit + 1\nElse: End If\n\n'Include the notifcation status in the report\nIf InStr(1, Notification_Status, \"CC04\") Then\nNumber_Cancelled = Number_Cancelled + 1\nElse: End If\n\n\nEnd If\n\nNext C\n\nSkip:\n\n'Passes values to sheet\nCells(i + 2, 9) = Number_Substantiated\nCells(i + 2, 10) = Number_Not_Substantiated\nCells(i + 2, 11) = Number_Counterfeit\nCells(i + 2, 12) = Number_Cancelled\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1536163156, "post_id": 52189193, "comment_id": 91328292, "body": "Can you simply have a &quot;submit&quot; button on the combo box, or something similar?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1536163574, "post_id": 52189193, "comment_id": 91328509, "body": "Have a look here: <a href=\"https://stackoverflow.com/questions/1083603/vba-using-withevents-on-userforms\" title=\"vba using withevents on userforms\">stackoverflow.com/questions/1083603/&hellip;</a>"}], "owner": {"reputation": 3, "user_id": 7908498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee297b049b32ba3f301cde519beedb0?s=128&d=identicon&r=PG&f=1", "display_name": "MajesticMadman", "link": "https://stackoverflow.com/users/7908498/majesticmadman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536242814, "creation_date": 1536162811, "last_edit_date": 1536242814, "question_id": 52189193, "link": "https://stackoverflow.com/questions/52189193/excel-vba-how-to-call-on-change-for-a-dynamically-created-object", "title": "Excel VBA: How to call &quot;on change&quot; for a dynamically created Object?", "body": "<p>I'm trying to call a change event for any Combo Box on a userform.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>So following what others have said (For Text Boxes, which I've tested and works for Textboxes), I've create a Class Module Called: 'clsCombo_Update'</p>\n\n<pre><code>Private WithEvents MyComboBox As MSForms.comboBox\n\nPublic Property Set Control(cb As MSForms.comboBox)\n    Set MyComboBox = cb\nEnd Property\n\nPrivate Sub MyComboBox_Change()\n    Debug.Print \"Change\"\nEnd Sub\n</code></pre>\n\n<p>And in the UserForm I have:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Dim ctrl As MSForms.Control\n    Dim obj As clsCombo_Update\n\n    Set cbCollection = New Collection\n        For Each ctrl In Me.Controls\n            If TypeOf ctrl Is MSForms.comboBox Then\n                Set obj = New clsCombo_Update\n                Set obj.Control = ctrl\n                cbCollection.Add obj\n            End If\n        Next ctrl\n    Set obj = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>This setup worked for textboxes but doesn't when I tried to make it work for Combo Boxes</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8098011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6029ad3539c80a2f3f944743546035?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Morais", "link": "https://stackoverflow.com/users/8098011/dennis-morais"}, "edited": false, "score": 0, "creation_date": 1536173416, "post_id": 52191478, "comment_id": 91333064, "body": "I tested my code and if I use the vlookup formula without Worksheets(I) and use for example directly Sheet2.Range(&quot;A5:AB401&quot;) it works fine. But I need to look all my 82 sheets so I need to use the conter in my vlookup."}], "tags": [], "owner": {"reputation": 756, "user_id": 2040023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3781c26eee05ffc874b134ea0e55762f?s=128&d=identicon&r=PG", "display_name": "John Joseph", "link": "https://stackoverflow.com/users/2040023/john-joseph"}, "is_accepted": false, "score": 0, "last_activity_date": 1536172724, "last_edit_date": 1536172724, "creation_date": 1536172407, "answer_id": 52191478, "question_id": 52189104, "link": "https://stackoverflow.com/questions/52189104/vba-doing-application-vlookup-in-all-sheets-and-counting-when-matches/52191478#52191478", "title": "VBA - Doing Application.VLookup in all sheets and counting when matches", "body": "<p>TRUE is tricky in Excel, as it may represent the positive boolean, 1.  Try changing \"True\" in your code to 1 and re-run.</p>\n\n<p>A more isolated test would be to explicitly test if the contents of a cell containing True equals the string True.  </p>\n\n<p>e.g. </p>\n\n<pre><code>    =IF(AB3 = \"True\", 1, 0)\n</code></pre>\n\n<p>...or, conversely, </p>\n\n<pre><code>    =IF(AB3 = TRUE, 1, 0)\n</code></pre>\n\n<p>...and observe the outcome of that test.</p>\n\n<p>If that doesn't work, is it practical for you to replace the contents in column 28 with something less unpredictable than \"TRUE\"?</p>\n"}], "owner": {"reputation": 1, "user_id": 8098011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6029ad3539c80a2f3f944743546035?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Morais", "link": "https://stackoverflow.com/users/8098011/dennis-morais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536172724, "creation_date": 1536162486, "question_id": 52189104, "link": "https://stackoverflow.com/questions/52189104/vba-doing-application-vlookup-in-all-sheets-and-counting-when-matches", "title": "VBA - Doing Application.VLookup in all sheets and counting when matches", "body": "<p>I have a workbook with 82 worksheets.</p>\n\n<p>I need to do a Vlookup in all sheets and count when I get the value that I need.\nI did a code to count the number of sheets and start a \"for\" from 1 to the maximum number of sheets but it doesn't work when I refer this count in the Application.vlookup.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Function NUMBEROFTIMES(lookup_value)\n NUMBEROFTIMES = 0\n         Dim WS_Count As Integer\n         Dim I As Integer\n         ' Set WS_Count equal to the number of worksheets in the active\n         ' workbook.\n         WS_Count = ActiveWorkbook.Worksheets.Count\n         ' Begin the loop.\n         For I = 1 To WS_Count\n        If Application.VLookup(lookup_value, Worksheets(I).Range(\"A5:AB401\"), 28, False) = \"True\" Then\n        NUMBEROFTIMES = NUMBEROFTIMES + 1\n        End If\n        Next I\n      End Function\n</code></pre>\n\n<p>In all the sheets I have to search for the value that I put in the \"lookup_value\" and the return is the word \"True\".</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 1, "creation_date": 1536162818, "post_id": 52189005, "comment_id": 91328094, "body": "Should be For instead of From, I believe"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 1, "creation_date": 1536162961, "post_id": 52189005, "comment_id": 91328170, "body": "Well, that&#39;s what I get for coding first thing in the morning"}, {"owner": {"reputation": 25, "user_id": 7458390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe30b930caefd8a015b28245d262f3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Dufresne", "link": "https://stackoverflow.com/users/7458390/andy-dufresne"}, "edited": false, "score": 0, "creation_date": 1536169028, "post_id": 52189005, "comment_id": 91331101, "body": "I&#39;ll look into this, but I&#39;m struggling. I also struggle to find the flaw in my code. Run the formula until A=null. Should be simple and I feel like I&#39;m missing something simple. The logic flow seems easy. Thank you for your reply. <i>Edit</i> AM I missing something with the very easy excel formula???"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1536172951, "post_id": 52189005, "comment_id": 91332883, "body": "I mean, your formula is bad in and of itself - it won&#39;t work as per <a href=\"https://support.office.com/en-us/article/lookup-function-446d94af-663b-451d-8251-369d5e3864cb\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a> . Try vlookup instead, you might have better results"}, {"owner": {"reputation": 25, "user_id": 7458390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe30b930caefd8a015b28245d262f3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Dufresne", "link": "https://stackoverflow.com/users/7458390/andy-dufresne"}, "edited": false, "score": 0, "creation_date": 1536173638, "post_id": 52189005, "comment_id": 91333163, "body": "Well, my formula and VLOOKUP both work. Literally the only issue is that it&#39;s looping through Column E in it&#39;s entirety, not Column A. I interrupt the macro using CTRL Break, and the data I need is there....it just needs to stop when column A is empty. It is not stopping at the last entry in Column A."}], "tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": false, "score": 2, "last_activity_date": 1536162947, "last_edit_date": 1536162947, "creation_date": 1536162132, "answer_id": 52189005, "question_id": 52188977, "link": "https://stackoverflow.com/questions/52188977/looping-a-formula-in-a-column-while-data-exists-in-another-column/52189005#52189005", "title": "Looping a formula in a column while data exists in another column", "body": "<p>There are a few ways you can go about this - I tend to dislike DoUntil:</p>\n\n<p>1) Could you simply turn your data into a table? It'll auto-expand column E as needed, no need to be in VBA.  </p>\n\n<p>2) Write your loop to first find the end of your data (Hint: Google for LastRow Excel VBA), then loop</p>\n\n<pre><code>For I = 1 to LastRow\n    'Code here\nNext I\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7458390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe30b930caefd8a015b28245d262f3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Dufresne", "link": "https://stackoverflow.com/users/7458390/andy-dufresne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593761587, "creation_date": 1536162026, "last_edit_date": 1593761587, "question_id": 52188977, "link": "https://stackoverflow.com/questions/52188977/looping-a-formula-in-a-column-while-data-exists-in-another-column", "title": "Looping a formula in a column while data exists in another column", "body": "<p>I'm stuck and I'm sure it's simple. I need to run a LOOKUP formula in Column E while data exists in Column A. Column A will have varying amounts of data/rows, it will never be a set number. The problem is that my code wants to loop through ALL of Column E and it takes the macro 20 minutes to run.</p>\n\n<p>Here is what I have: </p>\n\n<pre><code>Sub Run_Lookup()\n      Range(\"A1\").Select\n      Do Until IsEmpty(ActiveCell)\n         Range(\"E:E\").Formula = \"=lookup(A1, G:H)\"\n         ActiveCell.Offset(1, 0).Select\n      Loop\n   End Sub\n</code></pre>\n\n<p>I appreciate any advice.</p>\n\n<p>EDIT: A Visual of my issue...</p>\n\n<p><a href=\"https://i.stack.imgur.com/s1v6K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s1v6K.png\" alt=\"EDIT: A visual of my issue...\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 6, "creation_date": 1536160553, "post_id": 52188501, "comment_id": 91326794, "body": "Are you looking for <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Worksheet.Copy\" rel=\"nofollow noreferrer\">Worksheet.Copy</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536162576, "post_id": 52188630, "comment_id": 91327976, "body": "Hi Rik, Thanks for your tip. The problem that I am having is that the original &quot;Template&quot; worksheet disappears, and a new one is created &quot;Template(2)&quot; along with the the new duplicate worksheet (which I was looking to do). Then when trying to duplicate &quot;Template&quot; again for my next input, it doesn&#39;t work as it is now called &quot;Template(2)&quot;. This is my code now:"}, {"owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536162601, "post_id": 52188630, "comment_id": 91327986, "body": "ActiveWorkbook.Sheets(&quot;Template&quot;).Name = compName &amp; &quot;-&quot; &amp; financing     ActiveWorkbook.Sheets(compName &amp; &quot;-&quot; &amp; financing).Visible = xlSheetVisible"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536173048, "post_id": 52188630, "comment_id": 91332920, "body": "With the <code>.Copy</code> method, the original worksheet remains exactly where it is. It just gets copied and that&#39;s all. Can you give your entire code while using <code>.Copy</code> see we can see what&#39;s going wrong? Probably you&#39;re changing workbook references (<code>ActiveWorkbook</code>?)"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536239528, "post_id": 52188630, "comment_id": 91358904, "body": "@IBAndy You&#39;re first changing the name. Obviously on a second run you won&#39;t find that sheet anymore. You should do the Copy first, then do <code>ActiveWorkbook.Sheets(&quot;Template (2)&quot;).Name = compName</code> etc. etc."}, {"owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536316887, "post_id": 52188630, "comment_id": 91390039, "body": "HBi Rik, Sorry for my late reply. You are absolutely correct, a new worksheet gets produced with the name &quot;Template(2)&quot;, along with the worksheet that I was hoping for. So now i have to somehow figure out how to keep the name in the &quot;template&quot; worksheet the same, instead of &quot;template(2)&quot;."}, {"owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536317031, "post_id": 52188630, "comment_id": 91390126, "body": "When I add ActiveWorkbook.Sheets(&quot;Template (2)&quot;).Name = compName i get an error...This is my code so far:"}, {"owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536334566, "post_id": 52188630, "comment_id": 91400776, "body": "Hi again Rik, Figured it out. I forgot to put in a space between Template and (2). All sorted out, thanks again!"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536337277, "post_id": 52188630, "comment_id": 91402127, "body": "No worries happy to help"}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 3, "last_activity_date": 1536160795, "creation_date": 1536160795, "answer_id": 52188630, "question_id": 52188501, "link": "https://stackoverflow.com/questions/52188501/creating-a-new-worksheet-duplicate-with-vba/52188630#52188630", "title": "Creating a new worksheet duplicate with VBA", "body": "<p>Copy the entire worksheet named \"Template\":</p>\n\n<pre><code>Sub Test()\n    Worksheets(\"Template\").Copy Before:=Worksheets(\"Template\")\nEnd Sub\n</code></pre>\n\n<p>Will create a copy named \"Template (2)\" left of \"Template\". Alternatively use <code>After:=</code> instead of <code>Before:=</code> to place it to the right.\nWhen you omit the argument, it will copy to a new workbook.</p>\n"}], "owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 52188630, "answer_count": 1, "score": 0, "last_activity_date": 1536160934, "creation_date": 1536160440, "last_edit_date": 1536160934, "question_id": 52188501, "link": "https://stackoverflow.com/questions/52188501/creating-a-new-worksheet-duplicate-with-vba", "title": "Creating a new worksheet duplicate with VBA", "body": "<p>Im currently working on a code in which I am creating a new worksheet for every \"case\" that gets entered using a command button. However, the worksheets that are being created are blank, and I would like them to duplicate another worksheet that is in my workbook (lets call it \"template\"). Does anybody have any knowledge on how to do this? I will be thankful for any input!</p>\n\n<p>This is my code so far (i have added hyperlinks between the worksheets as well):</p>\n\n<pre><code>financing = ws.Range(\"F2\").Value\ncompName = ws.Range(\"F3\").Value\nfortnr = compName &amp; \"-\" &amp; financing\n\nlastRow = ws.Cells(Rows.Count, \"B\").End(xlUp).Row + 1\nws.Cells(lastRow, \"B\") = financing\nws.Cells(lastRow, \"C\") = compName\n\n\nActiveWorkbook.Sheets.Add After:=Worksheets(Worksheets.Count)\nActiveWorkbook.Sheets(Worksheets.Count).Name = compName &amp; \"-\" &amp; financing\nActiveWorkbook.Sheets(compName &amp; \"-\" &amp; financing).Visible = xlSheetVisible\n\nActiveSheet.Hyperlinks.Add Anchor:=ws.Cells(lastRow, 1), Address:=\"\", SubAddress:= _\n    \"'\" &amp; fortnr &amp; \"'\" &amp; \"!A1\", TextToDisplay:=\"Check\"                                  'Anchor: the place where the link will be\n\nActiveSheet.Hyperlinks.Add ActiveCell, \"\", Sheets(\"INPUT\").Name &amp; \"!A1\", TextToDisplay:=\"Back to Input-sheet\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "conditional"], "answers": [{"comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1539846207, "post_id": 52198325, "comment_id": 92650724, "body": "Provided you have a field in Excel that you can test for the colouring conditions, you don&#39;t need a macro for this. Instead, see Conditionally Shade Table Cells in the Mailmerge Tips and Tricks thread at: <a href=\"http://www.msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html\" rel=\"nofollow noreferrer\">msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.ht&zwnj;&#8203;ml</a> or: <a href=\"http://windowssecrets.com/forums/showthread.php/163017-Word-Mailmerge-Tips-amp-Tricks\" rel=\"nofollow noreferrer\">windowssecrets.com/forums/showthread.php/&hellip;</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1539861858, "post_id": 52198325, "comment_id": 92659239, "body": "@macropod If you want the OP to see it, you should comment on the Question, itself, rather than my answer. Or &quot;ping&quot; the person using the @ symbol, as I did for your name. In this case, I got &quot;pinged&quot; automatically because you posted the comment to the Answer."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1536217665, "creation_date": 1536217665, "answer_id": 52198325, "question_id": 52188454, "link": "https://stackoverflow.com/questions/52188454/using-a-macro-to-create-conditional-formatting-in-word-as-per-excel/52198325#52198325", "title": "Using a macro to create conditional formatting in Word as per Excel", "body": "<p>It's possible (likely) that Word is finding a character combination outside a table cell. Safest is to test whether the found term is actually <em>in</em> a table. (Note: I've also put the variable declaration <code>Dim r</code> inside the Function...)</p>\n\n<pre><code>Sub UBC()\n    color \"No\", wdRed\n    color \"Yes\", wdGreen\n    color \"Unknown\", wdYellow\n    color \"Not Applicable\", wdGray50\nEnd Sub\n\nFunction color(text As String, backgroundColor As WdColorIndex)\n    Dim r As Word.Range\n\n    Set r = ActiveDocument.content\n\n    With r.Find\n       Do While .Execute(findText:=text, MatchWholeWord:=True, Forward:=True) = True\n          If r.Tables.Count &gt; 0 Then\n            r.Cells(1).Shading.BackgroundPatternColorIndex = backgroundColor\n          End If\n       Loop\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10320641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311a2842ae5bc6c7e1b81645f194969e?s=128&d=identicon&r=PG&f=1", "display_name": "Jim68Flem", "link": "https://stackoverflow.com/users/10320641/jim68flem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1287, "favorite_count": 0, "accepted_answer_id": 52198325, "answer_count": 1, "score": 1, "last_activity_date": 1539792627, "creation_date": 1536160279, "last_edit_date": 1539792627, "question_id": 52188454, "link": "https://stackoverflow.com/questions/52188454/using-a-macro-to-create-conditional-formatting-in-word-as-per-excel", "title": "Using a macro to create conditional formatting in Word as per Excel", "body": "<p>I have an Excel doc that has conditional formatting that changes the background colour of a cell, dependant upon the specific [dropdown] text that is selected. E.g Yes, changes cell background to Green, No to Red, Unknown to Yellow and Not applicable to Grey. </p>\n\n<p>All easy stuff. </p>\n\n<p>I then need to mailmerge to a Word doc to populate the Word doc with the Excel table - the Word doc also has other non-excel related text.</p>\n\n<p>As conditional formatting of the cells does not come across, I have used the under noted code in a macro to change the background colour in Word. It runs, but seems after the first loop, it seems to crash with the error - <code>Runtime error 5907 - there is no table at this location</code>.</p>\n\n<p>the line in the code <code>r.Cells(1).Shading.BackgroundPatternColorIndex = backgroundColor</code> is highlighted yellow.</p>\n\n<p>My level of coding is basic so I don't know what's going wrong.</p>\n\n<p>If anyone is able to offer an insight to a simple solution, I would appreciate it.</p>\n\n<p>Thank</p>\n\n<pre><code>Dim r As Range\n\nSub UBC()\n    color \"No\", wdRed\n    color \"Yes\", wdGreen\n    color \"Unknown\", wdYellow\n    color \"Not Applicable\", wdGray50\nEnd Sub\n\nFunction color(text As String, backgroundColor As WdColorIndex)\n    Set r = ActiveDocument.Range\n\n    With r.Find\n       Do While .Execute(FindText:=text, MatchWholeWord:=True, Forward:=True) = True\n    r.Cells(1).Shading.BackgroundPatternColorIndex = backgroundColor\n       Loop\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "if-statement", "vba", "isnull"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8321239, "user_type": "registered", "profile_image": "https://graph.facebook.com/269500530194021/picture?type=large", "display_name": "Robert M. Smith", "link": "https://stackoverflow.com/users/8321239/robert-m-smith"}, "edited": false, "score": 0, "creation_date": 1536175442, "post_id": 52188525, "comment_id": 91333992, "body": "Bundle of thanks bro :) :) :) i was stuck here from last week and you code worked like a charm. just one more question. can you help me in one more VBA code? if yes i will post it in next comment.   thanks again bro :)"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 15, "user_id": 8321239, "user_type": "registered", "profile_image": "https://graph.facebook.com/269500530194021/picture?type=large", "display_name": "Robert M. Smith", "link": "https://stackoverflow.com/users/8321239/robert-m-smith"}, "edited": false, "score": 0, "creation_date": 1536178251, "post_id": 52188525, "comment_id": 91335205, "body": "Great! But post a new question with your second request."}, {"owner": {"reputation": 15, "user_id": 8321239, "user_type": "registered", "profile_image": "https://graph.facebook.com/269500530194021/picture?type=large", "display_name": "Robert M. Smith", "link": "https://stackoverflow.com/users/8321239/robert-m-smith"}, "edited": false, "score": 0, "creation_date": 1536247960, "post_id": 52188525, "comment_id": 91364421, "body": "sure i will bro"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1536160504, "creation_date": 1536160504, "answer_id": 52188525, "question_id": 52187864, "link": "https://stackoverflow.com/questions/52187864/use-if-condition-with-isnull-microsoft-access/52188525#52188525", "title": "Use IF condition with ISNULL - Microsoft Access", "body": "<p>That could be:</p>\n\n<pre><code>Final = Total / (8 + Abs(Not IsNull([Field9])) + Abs(Not IsNull([Field10])))\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8321239, "user_type": "registered", "profile_image": "https://graph.facebook.com/269500530194021/picture?type=large", "display_name": "Robert M. Smith", "link": "https://stackoverflow.com/users/8321239/robert-m-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 52188525, "answer_count": 1, "score": 0, "last_activity_date": 1536160504, "creation_date": 1536158477, "question_id": 52187864, "link": "https://stackoverflow.com/questions/52187864/use-if-condition-with-isnull-microsoft-access", "title": "Use IF condition with ISNULL - Microsoft Access", "body": "<p>I am trying to calculate a formula but its not workig or i am doing it wrong (obiviously). The scenario is that i have 10 textboxes and a calculation field. I want access to apply a formula on that calculated field (total) according to the data input in those 10 fields.</p>\n\n<p>e.g if the field 9 and 10 is empty then (total) will be divided by 8. Else it should be divided by 9 or ten respectivly. any help in this regard will be appreciated. thanks in advance</p>\n\n<p>what i am expecting\nif sub9 is null then total/8\nif sub10 is null then total/9\nelse total/10</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1536158145, "post_id": 52187631, "comment_id": 91325085, "body": "It looks like you are using the cells in column <b>C</b>.  What columns do you want to loop over??"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1536158448, "post_id": 52187631, "comment_id": 91325292, "body": "look at using <code>OFFSET</code> so another loop say xcol and then <code>Range(xcell).offset(0,xcol)</code> where xcol will be like 1=A,2=B,3=C and so on."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1536158796, "post_id": 52187631, "comment_id": 91325562, "body": "Just a note, but I recommend to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. Also avoid <code>GoTo</code>, instead negate your <code>If</code> statement with <code>Not</code> like <code>If Not ActiveCell.Comment Is Nothing Then {do autosize} End If</code>"}], "answers": [{"tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": false, "score": 3, "last_activity_date": 1536158921, "last_edit_date": 1536158921, "creation_date": 1536158536, "answer_id": 52187890, "question_id": 52187631, "link": "https://stackoverflow.com/questions/52187631/attempting-to-step-through-columns-in-a-search/52187890#52187890", "title": "Attempting to step through columns in a search", "body": "<p>This will resize all comments on the specified worksheet.  [Update] included option for password protected sheets.  As well as the Finished Msgbox.</p>\n\n<pre><code>Sub test()\n    Call ResizeComments(Sheet1)\n    MsgBox (\"Finished!\")\nEnd Sub\n\nPrivate Sub ResizeComments(ByVal ws As Worksheet, Optional ByVal Pass As String = \"\")\n    If Pass &lt;&gt; \"\" Then ws.Unprotect Pass\n\n    Dim oComment As Comment\n    For Each oComment In ws.Comments\n        oComment.Shape.TextFrame.AutoSize = True\n    Next\n\n    If Pass &lt;&gt; \"\" Then ws.Protect Pass\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10320680, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212701901886778/picture?type=large", "display_name": "Hap", "link": "https://stackoverflow.com/users/10320680/hap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536158921, "creation_date": 1536157837, "last_edit_date": 1536158867, "question_id": 52187631, "link": "https://stackoverflow.com/questions/52187631/attempting-to-step-through-columns-in-a-search", "title": "Attempting to step through columns in a search", "body": "<p>I am attempting to create a module in Excel 2016 that will scan through a sheet and auto size any comments found.  My current code requires me to adjust the Column Letter each time I run it.  I am looking for a method to step through the columns in my loop. My current code is listed below and I am thanking anyone ahead of time for any assistance I can get.  My current sheet only uses columns A through P.</p>\n\n<pre><code>Sub cmtsize()\n    ActiveSheet.Unprotect pswd\n\n    Range(\"a7:I7\").Select\n    lrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    For xrow = 7 To lrow\n        xcell = \"c\" &amp; lrow\n        Range(xcell).Select\n        If ActiveCell.Comment Is Nothing Then\n            GoTo nxt\n        Else\n            With Range(xcell).Comment.Shape\n                .TextFrame.AutoSize = True\n            End With\nnxt:\n        End If\n    Next xrow\n\n    ActiveSheet.Protect pswd\n    Range(\"A6\").Select\n    MsgBox \"Finished!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1536157979, "post_id": 52187511, "comment_id": 91324999, "body": "Sometimes (not always), the error <i>message</i> is more useful than its <i>number</i>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1536158026, "post_id": 52187511, "comment_id": 91325027, "body": "Also I&#39;d suggest redacting Daniel and Simon&#39;s actual email addresses from the post."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536158322, "post_id": 52187511, "comment_id": 91325202, "body": "That error message is basically &quot;An object could not be found&quot;.  Do you actually have a folder named &quot;Test&quot;?"}, {"owner": {"reputation": 27, "user_id": 10069305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cae97443a5fda836517e7f381cfb7a1?s=128&d=identicon&r=PG&f=1", "display_name": "AzraelJiraco", "link": "https://stackoverflow.com/users/10069305/azraeljiraco"}, "edited": false, "score": 0, "creation_date": 1536158332, "post_id": 52187511, "comment_id": 91325207, "body": "Thanks for the suggestion."}, {"owner": {"reputation": 27, "user_id": 10069305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cae97443a5fda836517e7f381cfb7a1?s=128&d=identicon&r=PG&f=1", "display_name": "AzraelJiraco", "link": "https://stackoverflow.com/users/10069305/azraeljiraco"}, "edited": false, "score": 0, "creation_date": 1536158352, "post_id": 52187511, "comment_id": 91325223, "body": "Yes, I do have a folder named &quot;Test&quot;. It was working before."}, {"owner": {"reputation": 27, "user_id": 10069305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cae97443a5fda836517e7f381cfb7a1?s=128&d=identicon&r=PG&f=1", "display_name": "AzraelJiraco", "link": "https://stackoverflow.com/users/10069305/azraeljiraco"}, "edited": false, "score": 0, "creation_date": 1536158762, "post_id": 52187511, "comment_id": 91325535, "body": "An update: I&#39;m now getting a new error message: Run-time error &#39;462&#39;: The remote server machine does not exist or is unavailable.  As far as I know, nothing has been changed."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1536159016, "post_id": 52187511, "comment_id": 91325726, "body": "FYI I&#39;ve flagged the post for a moderator to redact the email addresses out of revision 1, so it&#39;ll be just like they were never there to begin with :)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536159037, "post_id": 52187511, "comment_id": 91325744, "body": "If the server can&#39;t be reached, that would certainly explain the errors..."}, {"owner": {"reputation": 27, "user_id": 10069305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cae97443a5fda836517e7f381cfb7a1?s=128&d=identicon&r=PG&f=1", "display_name": "AzraelJiraco", "link": "https://stackoverflow.com/users/10069305/azraeljiraco"}, "edited": false, "score": 0, "creation_date": 1536159663, "post_id": 52187511, "comment_id": 91326196, "body": "That&#39;s a good point. It seems to be connected. I&#39;ll have a play around."}, {"owner": {"reputation": 27, "user_id": 10069305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cae97443a5fda836517e7f381cfb7a1?s=128&d=identicon&r=PG&f=1", "display_name": "AzraelJiraco", "link": "https://stackoverflow.com/users/10069305/azraeljiraco"}, "edited": false, "score": 0, "creation_date": 1536160218, "post_id": 52187511, "comment_id": 91326570, "body": "Okay, I&#39;ve restarted my PC and I&#39;m back to the original error message."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1536162382, "creation_date": 1536162382, "answer_id": 52189077, "question_id": 52187511, "link": "https://stackoverflow.com/questions/52187511/getting-run-time-error-2147221233-8004010f-then-getting-run-time-error-46/52189077#52189077", "title": "Getting Run-Time Error &#39;-2147221233 (8004010f)&#39;, then getting Run-time error &#39;462&#39; The remote server machine does not exist or is unavailable", "body": "<p>The error code is <code>MAPI_E_NOT_FOUND</code>. Make sure the folder named \"Test\" exist under Inbox.</p>\n"}, {"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1536162533, "creation_date": 1536162533, "answer_id": 52189114, "question_id": 52187511, "link": "https://stackoverflow.com/questions/52187511/getting-run-time-error-2147221233-8004010f-then-getting-run-time-error-46/52189114#52189114", "title": "Getting Run-Time Error &#39;-2147221233 (8004010f)&#39;, then getting Run-time error &#39;462&#39; The remote server machine does not exist or is unavailable", "body": "<p>The folders you are looking for, are most likely missing (not according to your Outlook, but according to your code). One reason this can happen is if your Inbox changes name, which it can do if you aren't using an English Outlook. Try this:</p>\n\n<pre><code>Set objFolder = objNS.Folders.GetFirst\nFor Each folder In objFolder.Folders\n    Debug.Print folder.Name\nNext\n</code></pre>\n\n<p>It lists all folders where the Inbox should be. Hopefully you'll find something that you can identify as your Inbox. Replace that name in your code.</p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1536777435, "creation_date": 1536777435, "answer_id": 52301497, "question_id": 52187511, "link": "https://stackoverflow.com/questions/52187511/getting-run-time-error-2147221233-8004010f-then-getting-run-time-error-46/52301497#52301497", "title": "Getting Run-Time Error &#39;-2147221233 (8004010f)&#39;, then getting Run-time error &#39;462&#39; The remote server machine does not exist or is unavailable", "body": "<p>To reliably reference the default Inbox:</p>\n\n<pre><code>Option Explicit\n\nSub ListMailsInDefaultAccountFolder()\n\n    Dim objNS As Namespace\n    Dim objFolder As Folder\n    Dim defInboxFolder As Folder\n\n    Dim itmCount As Long\n    Dim i As Long\n\n    Set objNS = GetNamespace(\"MAPI\")\n\n    Set defInboxFolder = objNS.GetDefaultFolder(olFolderInbox)\n    Set objFolder = defInboxFolder.Folders(\"Test\")\n\n    itmCount = objFolder.Items.Count\n\n    For i = 1 To itmCount\n        Debug.Print objFolder.Items(i).Subject\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10069305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cae97443a5fda836517e7f381cfb7a1?s=128&d=identicon&r=PG&f=1", "display_name": "AzraelJiraco", "link": "https://stackoverflow.com/users/10069305/azraeljiraco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 52301497, "answer_count": 3, "score": 0, "last_activity_date": 1536777435, "creation_date": 1536157532, "last_edit_date": 1536158740, "question_id": 52187511, "link": "https://stackoverflow.com/questions/52187511/getting-run-time-error-2147221233-8004010f-then-getting-run-time-error-46", "title": "Getting Run-Time Error &#39;-2147221233 (8004010f)&#39;, then getting Run-time error &#39;462&#39; The remote server machine does not exist or is unavailable", "body": "<p>The following code used to work but has suddenly started producing the above error message. It's designed to take contact details from each email in a folder, then send a new email out. I've run bug checks and yhe line that fails is:\nSet objFolder = objFolder.Folders(\"Inbox\").Folders(\"Test\")\nHere's the code:</p>\n\n<pre><code>Sub ListMailsInFolder()\n\n    Dim objNS As Outlook.Namespace\n    Dim objFolder As Outlook.MAPIFolder\n    Dim Lines() As String\n\n    Set objNS = GetNamespace(\"MAPI\")\n    Set objFolder = objNS.Folders.GetFirst ' folders of your current account\n    Set objFolder = \n objFolder.Folders(\"Inbox\").Folders(\"Test\")\n Worksheets(\"Sheet2\").Cells.ClearContents\n a = 1\n    For Each Item In objFolder.Items\n        If TypeName(Item) = \"MailItem\" Then\n            Item.Display\n            Worksheets(\"Sheet2\").Cells(1, a).Value = \n Item.Body\n            Item.Close 1\n            a = a + 1\n            Debug.Print Item.ConversationTopic\n        End If\n    Next\n\n For x = 1 To 208\n If Worksheets(\"Sheet2\").Cells(1, x) = \"\" Then\n Exit For\n End If\n  Set OutApp = CreateObject(\"Outlook.Application\")\n  Set objOutlookMsg = OutApp.CreateItem(olMailItem)\n\n  Set Recipients = objOutlookMsg.Recipients\n  Set objOutlookRecip = \n Recipients.Add(\"&lt;email removed for forum&gt;\")\n  objOutlookRecip.Type = 1\n\n  objOutlookMsg.SentOnBehalfOfName = \n \"&lt;email removed for forum&gt;\"\n  objOutlookMsg.Subject = \"Fleet Insurance\"\n  objOutlookMsg.Body = \"Testing this macro\" &amp; vbCrLf &amp; \n vbCrLf &amp; \"First Name: \" &amp; Worksheets(\"Sheet3\").Cells(7, x) &amp; vbCrLf &amp; \"Last Name: \" &amp; Worksheets(\"Sheet3\").Cells(10, x) &amp; vbCrLf &amp; \"Email Address: \" &amp; Worksheets(\"Sheet3\").Cells(14, x)\n  'Fleet client relationship team in signature\n  'Resolve each Recipient's name.\n  For Each objOutlookRecip In objOutlookMsg.Recipients\n    objOutlookRecip.Resolve\n  Next\n  objOutlookMsg.Send\n  'objOutlookMsg.Display\n\n  Set OutApp = Nothing\n  Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "colors", "cell"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1536158420, "post_id": 52187508, "comment_id": 91325264, "body": "Wouldn&#39;t conditional formatting be easier? Or do I miss something?"}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1536158620, "post_id": 52187508, "comment_id": 91325428, "body": "Conditional formatting sounds what I am looking for. Could I get a simple example?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1536158791, "post_id": 52187508, "comment_id": 91325560, "body": "Maybe <a href=\"https://exceljet.net/conditional-formatting-with-formulas\" rel=\"nofollow noreferrer\">here</a> or <a href=\"https://support.office.com/en-us/article/Enter-and-format-data-fef13169-0a84-4b92-a5ab-d856b0d7c1f7#ID0EAABAAA=Conditional_formatting\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1536159338, "post_id": 52187508, "comment_id": 91325983, "body": "Allow me to look for some VBA examples and apply it to my case. If i get stuck somewhere I will try to look for help here. Thnk you"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1536243634, "post_id": 52188473, "comment_id": 91361544, "body": "Firstly, the code runs into an error. Secondly, the code marks the rows B,C and D as well."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1536160331, "creation_date": 1536160331, "answer_id": 52188473, "question_id": 52187508, "link": "https://stackoverflow.com/questions/52187508/vba-marking-cells-based-on-keywords/52188473#52188473", "title": "VBA marking cells Based on keywords", "body": "<p>How about the following:</p>\n\n<pre><code>Sub Schaltfl\u00e4che2_Klicken()\n Dim cell As Range\n\n For Each cell In ws.Range(\"A1:A100\")\n    If cell.Value = \"Auto\" Then\n        Range(\"A\" &amp; cell.Row, \"E\" &amp; cell.Row, \"G\" &amp; cell.Row, \"I\" &amp; cell.Row, \"K\" &amp; cell.Row).Interior.Color = vbRed\n    ElseIf cell.Value = \"Mutti\" Then\n        Range(\"A\" &amp; cell.Row, \"E\" &amp; cell.Row, \"G\" &amp; cell.Row, \"I\" &amp; cell.Row, \"K\" &amp; cell.Row).Interior.Color = vbRed\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 52188473, "answer_count": 1, "score": 0, "last_activity_date": 1593761613, "creation_date": 1536157525, "last_edit_date": 1593761613, "question_id": 52187508, "link": "https://stackoverflow.com/questions/52187508/vba-marking-cells-based-on-keywords", "title": "VBA marking cells Based on keywords", "body": "<p>I have defined a range which is filled with color based on the cell text. In the first example it searches the word \"Auto\" and marks the cell red. Where I get stuck is to extent the \"if\" command such as that the search criteria carries onto the column E (however stays at the same row as the word \" Auto\" states) looks after the word \"Mortgage\" and marks it red. Then it moves further the column up and marks the values red that are under 4yr, 6yr,7yr. The next step would be the same with the word \"preferred\". For simplicity I have included a picture. It seems to be a bit tricky and a hint would be appreciated. </p>\n\n<p><a href=\"https://i.stack.imgur.com/l03W6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l03W6.jpg\" alt=\"enter image description here\"></a>  </p>\n\n<pre><code> Sub Schaltfl\u00e4che2_Klicken()\n Dim cell As Range\n\n For Each cell In ws.Range(\"A1:A100\")\n     If cell.Value = \"Auto\" Then\n     cell.Interior.Color = XlRgbColor.rgbRed\n\n     ElseIf cell.Value = \"Mutti\" Then\n     cell.Interior.Color = XlRgbColor.rgbRed\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1536162701, "post_id": 52187404, "comment_id": 91328031, "body": "You&#39;re not really giving a lot to go on, but by the looks of it you mean <code>R2C2</code> rather than <code>L2C2</code>?  Go to <code>File~Options</code> and select the <code>Formula</code> tab.  Is <code>R1C1 reference style</code> ticked?  If it&#39;s not that then can you give more info please - is it just a <code>VBA</code> tag?"}, {"owner": {"reputation": 25, "user_id": 9947376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af264511d808466e1dbe17929e31039a?s=128&d=identicon&r=PG&f=1", "display_name": "Luis de Souza", "link": "https://stackoverflow.com/users/9947376/luis-de-souza"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1536168084, "post_id": 52187404, "comment_id": 91330656, "body": "When I get home I&#39;ll try to explain better, please wait a little."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1536168517, "post_id": 52187404, "comment_id": 91330859, "body": "Just thought... might be <code>L2C2</code> if it&#39;s not English. Solution will be the same though."}, {"owner": {"reputation": 25, "user_id": 9947376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af264511d808466e1dbe17929e31039a?s=128&d=identicon&r=PG&f=1", "display_name": "Luis de Souza", "link": "https://stackoverflow.com/users/9947376/luis-de-souza"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1536236734, "post_id": 52187404, "comment_id": 91357187, "body": "Hi! I edited and tried to explain it better. Please have a look."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1536237877, "post_id": 52187404, "comment_id": 91357894, "body": "<code>L2C2</code> is looking at row 2, column 2 - or <code>B2</code>.  Find the <code>Options</code> menu (in 2010 it&#39;s under <code>File</code>) and follow my first comment.  I guess it will be labelled <i>L1C1 estilo de refer&#234;ncia</i> in Portuguese."}, {"owner": {"reputation": 25, "user_id": 9947376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af264511d808466e1dbe17929e31039a?s=128&d=identicon&r=PG&f=1", "display_name": "Luis de Souza", "link": "https://stackoverflow.com/users/9947376/luis-de-souza"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1536238579, "post_id": 52187404, "comment_id": 91358312, "body": "Unfortunately, it wasn&#39;t ticked. I actually ticked and tried to run it with no sucess, then unticked it again, no sucess."}], "owner": {"reputation": 25, "user_id": 9947376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af264511d808466e1dbe17929e31039a?s=128&d=identicon&r=PG&f=1", "display_name": "Luis de Souza", "link": "https://stackoverflow.com/users/9947376/luis-de-souza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536236705, "creation_date": 1536157174, "last_edit_date": 1536236705, "question_id": 52187404, "link": "https://stackoverflow.com/questions/52187404/defined-names-changing-reference-of-formula-unable-to-set-the-formula-property", "title": "Defined names changing reference of formula. Unable to set the Formula property of the picture class", "body": "<p>I have a strange problem. I have a formula to choose between graphics that I put in a picture.<br>\nIt is <code>=choose(Dashboard!B2;A;B...)</code> and so on.<br>\nFor some reason, it changes the <code>b2</code> to <code>l2c2</code> and I have no idea how to correct this problem or what caused it in the first place.</p>\n\n<p>EDIT:\nOkay, I'll explain it better:\nThe language is portuguese, but I prefer to come here.</p>\n\n<p>So, I have a sheet where I can select, through a dropdown and buttons, what area I want to view certain charts.</p>\n\n<p><a href=\"https://i.stack.imgur.com/P2mHC.png\" rel=\"nofollow noreferrer\">Picture 1</a></p>\n\n<p>(Hopefully you get the picture through this picture :))\nTo make this work, I put a serious of Defined Names (Ranges?) and put some =CHOOSE() with all these defined names.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1wq9D.png\" rel=\"nofollow noreferrer\">Picture 2</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ngfcV.png\" rel=\"nofollow noreferrer\">Picture 3</a></p>\n\n<p>And It was working, until recently. I don't know what changed, don't know what went wrong, but when I click in the buttons, it keeps giving the following alert:</p>\n\n<p><a href=\"https://i.stack.imgur.com/or1dw.png\" rel=\"nofollow noreferrer\">Picture 4: alert</a>\nRun-time error '1004': Unable to set the Formula property of the picture class.</p>\n\n<p>And while debugging the code, if I check the defined names, it shows this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0bN6T.png\" rel=\"nofollow noreferrer\">Picture 5</a></p>\n"}, {"tags": ["vba", "excel", "progress-bar"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1536157325, "post_id": 52187379, "comment_id": 91324557, "body": "you cab either optimize the speed or create an illusion of progressbar. Both of them together doesn&#39;t happen. Not easily."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1536157604, "post_id": 52187379, "comment_id": 91324744, "body": "You&#39;ll get a lot more traction by actually improving the code. For example, you repeatedly call <code>Sheets(&quot;Data-KM&quot;)</code> in a loop. Add a <code>With</code> block. Hard code the sheet references of deterministic calls (like <code>Sheets(&quot;Data-KM&quot;)</code>). Use arrays instead of cell ranges. Stopping screen updating and displaying how slow it is in the progress bar doesn&#39;t strike me as a solution."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1536158528, "post_id": 52187379, "comment_id": 91325350, "body": "Your form is running the show. <a href=\"https://rubberduckvba.wordpress.com/2018/01/12/progress-indicator/\" rel=\"nofollow noreferrer\">This article</a> describes how a progress indicator can be written, that doesn&#39;t know about any worker code - thus making the indicator fully reusable. (disclaimer: I wrote it)"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1536160461, "post_id": 52187379, "comment_id": 91326728, "body": "Custom progress bar = overhead = more execution time. It&#39;s probably better to look at actual optimizations. Some nice ones for the beginner are listed <a href=\"https://www.ozgrid.com/VBA/SpeedingUpVBACode.htm\" rel=\"nofollow noreferrer\">here at Ozgrid</a> Another big win will be to stop looping and look at ways to do copy-paste operations at once instead of line by line."}], "owner": {"reputation": 1, "user_id": 10224370, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0qjYv_VJs-Q/AAAAAAAAAAI/AAAAAAAAGp0/mVcnZpQ-rqY/photo.jpg?sz=128", "display_name": "Tristan", "link": "https://stackoverflow.com/users/10224370/tristan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1996, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536166632, "creation_date": 1536157106, "last_edit_date": 1536166632, "question_id": 52187379, "link": "https://stackoverflow.com/questions/52187379/excel-vba-progress-bar-display-macro-progress-based-on-active-worksheets", "title": "Excel VBA Progress Bar Display Macro Progress based on Active Worksheets", "body": "<p>I am an apprentice software developer in my third week at the company and they've decided to start me off with excel macro's and VBA. It's been a nice challenge so far, and I'm learning more and more about reading code\nMy current task is understanding an excel splitter the company uses to bill their clients. I have manged to understand the code, manipulate it in certain ways, and even add further clients and and companies.</p>\n\n<p>They are now asking me to make some optimizations to the code and to try make it run faster. \nMy idea is to turn off screen updates and all that and to try and display a progress bar for the macro. I had first hoped to run the progress bar based on the different sub's/functions but that doesn't seem to be too easy.</p>\n\n<p><strong>So</strong>: I was hoping one of you could please assist/advise me on how I could make the progress bar run based on the amount of active sheets, as each time the splitter finishes with a client, it creates a new sheet.</p>\n\n<p><strong>Here is the code for the first company:</strong></p>\n\n<pre><code>'Calling the functions\nPrivate Sub CommandButton1_Click()\n\n    UserForm1.Show\n\n    code\n\n    Dim lastrow As Long\n\n        lastrow = Sheets(\"Koh\").Range(\"A\" &amp; Rows.count).End(xlUp).row\n\n    For i = 2 To lastrow\n        Call GenericFindAndSplit(Sheets(\"Koh\").Range(\"A\" &amp; i), Sheets(\"Koh\").Range(\"B\" &amp; i), Sheets(\"Koh\").Range(\"C\" &amp; i))\n    Next i\n\nEnd Sub\n\nFunction GenericFindAndSplit(SheetName As String, LowExt As Integer, HighExt As Integer)\n\n    Dim count As Integer\n        count = 2\n\n'Add a new sheet to the workbook\n'Worksheet name is obtained from the \"Koh\" tab\n\n    Sheets.Add(After:=Sheets(Sheets.count)).Name = SheetName\n\n'Copy first row of the Data sheet and paste to the newly created sheet\n    Sheets(\"Data-KM\").Rows(1).EntireRow.Copy\n    Sheets(SheetName).Rows(1).PasteSpecial Paste:=xlPasteFormulas\n\n'Search the Data sheet for the selected extensions and paste them on the newly created sheet\n    For r = Sheets(\"Data-KM\").UsedRange.Rows.count To 1 Step -1\n        If Sheets(\"Data-KM\").Cells(r, \"L\") &gt;= LowExt And Sheets(\"Data-KM\").Cells(r, \"L\") &lt;= HighExt Then\n                Sheets(\"Data-KM\").Rows(r).EntireRow.Copy\n                Sheets(SheetName).Range(\"A\" &amp; count).PasteSpecial Paste:=xlPasteFormulas\n            count = count + 1\n        End If\n    Next\n\nEnd Function\n\nSub ExportSheetsToCSV()\n\n'If Dir(\"C:\\Temp\\\", vbDirectory) = \"\" Then\n\n    'Kill (\"C:\\Temp\\\") &amp; \"*.*\"\n\n'End If\n\nDim xWs As Worksheet\nDim xcsvFile As String\n\n    For Each xWs In Application.ActiveWorkbook.Worksheets\n    'Loop for each worksheet on the workbook\n\n        If xWs.Name &lt;&gt; \"Sheet1\" And xWs.Name &lt;&gt; \"Data-KM\" And xWs.Name &lt;&gt; \"Koh\" Then\n            xWs.Copy\n            'Copy worksheet\n            xcsvFile = \"GlobalCDR_\" &amp; ActiveSheet.Name &amp; \".csv\"\n            'Copies files into the C Drive under Temp\n                Application.ActiveWorkbook.SaveAs Filename:=\"C:\\Temp\\\" &amp; xcsvFile, FileFormat:=xlCSV\n                ThisWorkbook.Saved = True\n                Application.DisplayAlerts = False\n                Application.ActiveWorkbook.Close\n        End If\n    Next\n\n'Automatically saves and closes workbook\nThisWorkbook.Saved = False\nApplication.DisplayAlerts = False\n'Application.Quit\nEnd Sub\n</code></pre>\n\n<p><strong>The following is my attempt at trying to code progress based on active sheets</strong></p>\n\n<pre><code>Sub code()\n\nDim i As Integer, j As Integer, pctCompl As Single\n\nFor i = 1 To 100\n    For ActiveWorkbook = 1 To 7\n        ActiveWorkbook.Value = j\n    Next j\n    pctCompl = i\n    progress pctCompl\nNext i\n\nEnd Sub\n\nSub progress(pctCompl As Single)\n\nUserForm1.Text.Caption = pctCompl &amp; \"% Completed\"\nUserForm1.Bar.Width = pctCompl * 2\n\nDoEvents\n\nEnd Sub\n</code></pre>\n\n<p><strong>And then finally this is my code for the UserForm I created:</strong></p>\n\n<pre><code>Private Sub UserForm_Activate()\ncode\nEnd Sub\n</code></pre>\n\n<p>Any advice you could provide would be greatly appreciated, thanks in advance, and thank you also for your previous contributions, they have been invaluable to me over this three week period :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536156743, "post_id": 52187192, "comment_id": 91324190, "body": "Can you <a href=\"https://stackoverflow.com/posts/52187192/edit\">edit</a> your post to add some sample data, your expected output and how it differs from what you get at the moment?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536157130, "post_id": 52187192, "comment_id": 91324437, "body": "The code above doesn&#39;t compile. Is this the actual code you&#39;re using?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1536157148, "post_id": 52187192, "comment_id": 91324447, "body": "Here <code>ElseIf Len(Cells(1, GR.Value) &lt;&gt; 6 Then</code> you are always looking at Row 1. No matter what he value in cell you are picking up and using it&#39;s column number.  The conitional setting for <code>GR = col</code> is just a sham. Actually non of your procs are working."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 1, "creation_date": 1536157212, "post_id": 52187192, "comment_id": 91324487, "body": "For future reference, please use something like <a href=\"http://rubberduckvba.com/Indentation\" rel=\"nofollow noreferrer\">this tool</a> to ensure proper indentation - it makes code so much easier to look at."}, {"owner": {"reputation": 11, "user_id": 10132744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d70f5ee5b886f775b3c673a0f38ccae?s=128&d=identicon&r=PG&f=1", "display_name": "koofrith", "link": "https://stackoverflow.com/users/10132744/koofrith"}, "edited": false, "score": 0, "creation_date": 1536158099, "post_id": 52187192, "comment_id": 91325054, "body": "Thank you @Xabier for your helpful reply :)"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1536157124, "creation_date": 1536157124, "answer_id": 52187384, "question_id": 52187192, "link": "https://stackoverflow.com/questions/52187192/vba-populating-column-with-value-from-len-formula/52187384#52187384", "title": "VBA Populating column with value from Len formula", "body": "<p>I believe the following will do what you expect it to, there was a typo on the following line <code>ElseIf Len(Cells(1, GR.Value) &lt;&gt; 6 Then</code>, I've also re-wrote some of your code, so instead of looping with a For Loop, I used the .Find method to find the relevant columns:</p>\n\n<pre><code>Sub InsertDefinePopulate()\n\nColumns(\"B:B\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"B1\").Value = \"Precision\"\n\nSet GRFound = Range(\"1:1\").Find(What:=\"GRIDREF\", LookIn:=xlValues, LookAt:=xlWhole)\nIf Not GRFound Is Nothing Then GR = GRFound.Column\n\nSet PrecisionFound = Range(\"1:1\").Find(What:=\"Precision\", LookIn:=xlValues, LookAt:=xlWhole)\nIf Not PrecisionFound Is Nothing Then Precision = PrecisionFound.Column\n\nlast = Cells(Rows.Count, GR).End(xlUp).Row\n\nFor i = last To 1 Step -1\n    If Len(Cells(i, GR).Value) = 6 Then\n        Cells(i, Precision).Value = \"1 km\"\n    ElseIf Len(Cells(i, GR)) &lt;&gt; 6 Then\n        Cells(i, Precision).Value = \"not 1km\"\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10132744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d70f5ee5b886f775b3c673a0f38ccae?s=128&d=identicon&r=PG&f=1", "display_name": "koofrith", "link": "https://stackoverflow.com/users/10132744/koofrith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536157818, "creation_date": 1536156528, "last_edit_date": 1536157818, "question_id": 52187192, "link": "https://stackoverflow.com/questions/52187192/vba-populating-column-with-value-from-len-formula", "title": "VBA Populating column with value from Len formula", "body": "<p>I have a column in my spreadsheet called 'GRIDREF' that contains string values of variable length. I would like to add an additional column in the same sheet called 'Precision' and populate it with values depending on the value returned for the length of the string GRID REF. The first two subs in my VBA code seem to be ok. But not the last, and I wondered why?</p>\n\n<p>Initial table example before macro:</p>\n\n<pre><code>ANIMAL  GRIDREF\nCAT     NZ3344\nRABBIT  NZ5566\nCHIMP   NZ45\nTURTLE  NZ22345\n</code></pre>\n\n<p>Desired Outcome;</p>\n\n<pre><code>ANIMAL  PRECISION   GRIDREF\nCAT      1 Km      NZ3344\nRABBIT   1 Km      NZ5566\nCHIMP    Not 1 Km  NZ45\nTURTLE   Not 1 Km  NZ22345 \n</code></pre>\n\n<p>Actual Outcome      </p>\n\n<pre><code>ANIMAL  PRECISION   GRIDREF\nCAT                NZ3344\nRABBIT             NZ5566\nCHIMP              NZ45\nTURTLE             NZ22345 \n</code></pre>\n\n<p>My code is as follows:</p>\n\n<pre><code>'Insert Col\nSub InsertColumn()\n    Columns(\"B:B\").Insert Shift:=xlToRight,\n    CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"B1\").Value = \"Precision\"\nEnd Sub\n\nSub Definecolnames()\n\n    lastUsedColumn = Cells(1, Columns.Count).End(xlToLeft).Column\n\n    For col = 1 To lastUsedColumn\n        If Cells(1, col).Value = \"GRIDREF\" Then\n            GR = col\n        End If\n        If Cells(1, col).Value = \"Precision\" Then\n            Precision = col\n        End If\n    Next col\n\nEnd Sub\n\nSub Populate()\n    last = Cells(Rows.Count, GR).End(xlUp).Row\n\n    For i = last To 1 Step -1\n        If Len(Cells(i, GR).Value) = 6 Then\n            Cells(i, Precision).Value = \"1 km\"\n        ElseIf Len(Cells(1, GR.Value) &lt;&gt; 6 Then\n            Cells(i, Precision).Value = \"not 1km\"\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1536155701, "post_id": 52186861, "comment_id": 91323495, "body": "That&#39;s a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Outlook.Recipients\" rel=\"nofollow noreferrer\">recipient object</a>, I think you might need to move that to after <code>emItem</code> is set, and use instead <code>emItem.Recipients.Add (&quot;dennis...&quot;)</code>?"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1536156129, "post_id": 52186861, "comment_id": 91323810, "body": "I think this line should just be .To = Recipient , you don&#39;t have to write =&quot;&quot;."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1536156443, "post_id": 52186861, "comment_id": 91323994, "body": "Can you clarify which line is causing the issue? I didn&#39;t notice the last one @ImranMalek points out, which would error as well. (Not sure if the one I mean is causing your error...)"}, {"owner": {"reputation": 5, "user_id": 10320310, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLdiKR79wxQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNSpTufGXjayfIJ7Agb0rRN7kff4Q/mo/photo.jpg?sz=128", "display_name": "Dennis Aikens", "link": "https://stackoverflow.com/users/10320310/dennis-aikens"}, "edited": false, "score": 0, "creation_date": 1536159507, "post_id": 52186861, "comment_id": 91326104, "body": "Thanks for the responses! The line: Recipient = &quot;dennis.aikens@fedex.com&quot;  is causing the error."}], "answers": [{"tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 1, "last_activity_date": 1536156848, "creation_date": 1536156848, "answer_id": 52187289, "question_id": 52186861, "link": "https://stackoverflow.com/questions/52186861/how-to-assign-a-recipient-to-to/52187289#52187289", "title": "How to assign a recipient to .To?", "body": "<p>I would dim recipient as string and update the .to assignment:</p>\n\n<p>Change</p>\n\n<pre><code>Dim Recipient As Outlook.Recipient\n\n.To = Recipient = \"dennis.aikens@fedex.com\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Dim Recipient As string\n\n.To = Recipient\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 0, "last_activity_date": 1536167532, "creation_date": 1536167532, "answer_id": 52190333, "question_id": 52186861, "link": "https://stackoverflow.com/questions/52186861/how-to-assign-a-recipient-to-to/52190333#52190333", "title": "How to assign a recipient to .To?", "body": "<p>This line </p>\n\n<p>.To = Recipient = \"dennis.aikens@fedex.com\"</p>\n\n<p>Should be just</p>\n\n<p>.To = Recipient </p>\n"}], "owner": {"reputation": 5, "user_id": 10320310, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLdiKR79wxQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNSpTufGXjayfIJ7Agb0rRN7kff4Q/mo/photo.jpg?sz=128", "display_name": "Dennis Aikens", "link": "https://stackoverflow.com/users/10320310/dennis-aikens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 52187289, "answer_count": 2, "score": 0, "last_activity_date": 1605464943, "creation_date": 1536155605, "last_edit_date": 1605464943, "question_id": 52186861, "link": "https://stackoverflow.com/questions/52186861/how-to-assign-a-recipient-to-to", "title": "How to assign a recipient to .To?", "body": "<p>I convert a worksheet into a PDF and am trying to have that PDF emailed to me and copied to another person. All of this will be assigned to an action button/trigger.</p>\n<pre><code>Option Explicit\n\nSub SendExcelFileAsPDF()\n\nDim OutlookApp As Outlook.Application\nDim emItem As Object\nDim Receipt As String, Subject As String\nDim Message As String, Fname As String\n\nDim Recipient As Outlook.Recipient\nRecipient = &quot;xxxxx.xxxxx@fedex.com&quot;\nSubject = &quot;Weekly Critical Items&quot; &amp; &quot; &quot; &amp; Range(&quot;L1&quot;)\nMessage = Range(&quot;D2&quot;) &amp; Range(&quot;J2&quot;) &amp; &quot;Weekly Critical Items submitted&quot; &amp; \nRange(&quot;L1&quot;) &amp; &quot; &quot; &amp; &quot;in PDF Format&quot;\nMessage = Message &amp; vbNewLine &amp; vbNewLine &amp; &quot;Offload Ops&quot;\nFname = Application.DefaultFilePath &amp; &quot;/&quot; &amp; ActiveWorkbook.Name &amp; &quot;.pdf&quot;\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=Fname\n\nSet OutlookApp = New Outlook.Application\n\nSet emItem = OutlookApp.CreateItem(olMailItem)\nWith emItem\n    .To = Recipient = &quot;xxxxx.xxxxx@fedex.com&quot;\n    .Subject = Subject\n    .Body = Message\n    .Attachements.Add Fname\n    .Send\nEnd With\nSet OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n<p>The recipient line is where I am having issues. When I run the debugger, it's giving</p>\n<blockquote>\n<p>Run-Time error '91: Object variable or with block variable not set</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1536155394, "post_id": 52186683, "comment_id": 91323266, "body": "You most certainly can do that! It&#39;s unlikely that anyone will be willing to write it for you though, but if you run into trouble with your code and have a specific issue, you&#39;re sure to get help fixing it. You may want to try the Macro Recorder if you&#39;re not sure where to start. It writes functional, but horrible code, but it will give you a good kick-off point. In the meantime, take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read the <a href=\"https://stackoverflow.com/help\">help center</a> to find out what makes for a good question."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1536155442, "post_id": 52186683, "comment_id": 91323299, "body": "Split that second number from the formula, increment it by one, re-write the formula to the cell."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536155497, "post_id": 52186683, "comment_id": 91323340, "body": "Also, search here for how to find the last used row, and use that technique to completely rewrite the formula. Either would work."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1536155503, "post_id": 52186683, "comment_id": 91323346, "body": "Create a dynamic named range and refer to that in your vba"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1536155528, "post_id": 52186683, "comment_id": 91323368, "body": "Select any cell in your range, click &quot;Format as table&quot; from the &quot;Home&quot; Ribbon; pick any style (doesn&#39;t matter which) - and now you have an actual <i>table</i> presumably named <code>Table1</code>. Change your formula to <code>=AVERAGE(Table1[NameOfThe6thColumn])</code> and you never need to update it ever again, manually or through VBA."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1536155530, "post_id": 52186683, "comment_id": 91323371, "body": "Look at using <code>dynamic named ranges</code>  will sort itself out"}, {"owner": {"reputation": 19, "user_id": 10320517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a4b230a76e64904ea60b2770f754de?s=128&d=identicon&r=PG&f=1", "display_name": "user10320517", "link": "https://stackoverflow.com/users/10320517/user10320517"}, "edited": false, "score": 0, "creation_date": 1536159530, "post_id": 52186683, "comment_id": 91326123, "body": "did think of that but i&#39;m using previous years data also that is already available, that&#39;s why i wanted to be able to just drop down a row each time a new week is added from the current year and the previous year so i am comparing like for like etc"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10320517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a4b230a76e64904ea60b2770f754de?s=128&d=identicon&r=PG&f=1", "display_name": "user10320517", "link": "https://stackoverflow.com/users/10320517/user10320517"}, "edited": false, "score": 0, "creation_date": 1536159523, "post_id": 52186982, "comment_id": 91326116, "body": "did think of that but i&#39;m using previous years data also that is already available, that&#39;s why i wanted to be able to just drop down a row each time a new week is added from the current year and the previous year so i am comparing like for like etc."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1536155942, "creation_date": 1536155942, "answer_id": 52186982, "question_id": 52186683, "link": "https://stackoverflow.com/questions/52186683/vba-increase-the-selected-formula-by-one-row/52186982#52186982", "title": "VBA- increase the selected formula by one row", "body": "<p>One option is to use:</p>\n\n<pre><code>=AVERAGE(F67:F9999)\n</code></pre>\n\n<p>and insure that the values in F88 through F9999 are all <strong>blank</strong> until they are assigned new values.</p>\n\n<p>This is because <code>AVERAGE()</code> will ignore all the blanks in its range.</p>\n\n<p>This way you can add data on a weekly basis and not have to update the formula each week.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1536156477, "creation_date": 1536156477, "answer_id": 52187175, "question_id": 52186683, "link": "https://stackoverflow.com/questions/52186683/vba-increase-the-selected-formula-by-one-row/52187175#52187175", "title": "VBA- increase the selected formula by one row", "body": "<p>You don't need VBA code to automate this. Excel handles it \"natively\". Have column headings in the first row of your \"table\":</p>\n\n<p><img src=\"https://i.stack.imgur.com/v4vbK.png\" alt=\"columns A-C contain data in rows 2-4; headings in row 1\"></p>\n\n<p>Now select \"Format as Table\" from the \"Home\" tab of the Ribbon. Excel selects the whole area and infers that there are column headers:</p>\n\n<p><img src=\"https://i.stack.imgur.com/1Fg7G.png\" alt=\"&quot;where is the data for your table?&quot; dialog\"></p>\n\n<p>Now you're looking at an actual <em>table</em> that Excel understands as such. And you can name it whatever you want:</p>\n\n<p><img src=\"https://i.stack.imgur.com/gwTAz.png\" alt=\"Table Name is in the &quot;Table Tools&quot; Ribbon tab\"></p>\n\n<p>Use <em>table references</em> instead of plain range addresses:</p>\n\n<p><img src=\"https://i.stack.imgur.com/QNcNJ.png\" alt=\"=AVERAGE(TableName[ColumnName])\"></p>\n\n<p>And now when you add a new table row, the formula doesn't need to be adjusted in any way:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Gp7dk.png\" alt=\"average recalculates automatically after adding a new value\"></p>\n"}], "owner": {"reputation": 19, "user_id": 10320517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a4b230a76e64904ea60b2770f754de?s=128&d=identicon&r=PG&f=1", "display_name": "user10320517", "link": "https://stackoverflow.com/users/10320517/user10320517"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536156477, "creation_date": 1536155077, "last_edit_date": 1536155445, "question_id": 52186683, "link": "https://stackoverflow.com/questions/52186683/vba-increase-the-selected-formula-by-one-row", "title": "VBA- increase the selected formula by one row", "body": "<p>Cell <code>O21</code> has the formula <code>=AVERAGE(F67:F88)</code> in it.</p>\n\n<p>I want to use VBA code to automate this to update each week to include the next row of data below, so next week it would be <code>=AVERAGE(F67:F89)</code> week after <code>=AVERAGE(F67:F90)</code>.</p>\n\n<p>I don't have a last row as  the data sheet is pretty big - can I do this?</p>\n"}, {"tags": ["excel", "vba", "cell"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1536155113, "post_id": 52186622, "comment_id": 91323068, "body": "What is happening/the error?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1536155149, "post_id": 52186622, "comment_id": 91323085, "body": "<code>Call DrawArrows(rngstart, rngend, RGB(0, 0, 255), &quot;Single&quot;)</code> maybe?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1536155273, "post_id": 52186622, "comment_id": 91323179, "body": "BTW, you should avoid using <code>.Select</code> if possible (I see no reason to use it in your code)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1536155762, "post_id": 52186622, "comment_id": 91323544, "body": "Use <code>cell.offset(0,x).value</code> instead of select."}, {"owner": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "edited": false, "score": 0, "creation_date": 1536159244, "post_id": 52186622, "comment_id": 91325905, "body": "I may have been delusional when I added select but until I did add it active row didn&#39;t seem to be picking up the right value. Having said that, I may have been delusional when I added select ;)"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "edited": false, "score": 0, "creation_date": 1536159054, "post_id": 52186974, "comment_id": 91325756, "body": "Thank you. That works perfectly and the explanation was also extremely helpful. It will give me some food for thought next time I am editing anything in a similar fashion to ensure I get it right. Thank you"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 3, "last_activity_date": 1536155930, "creation_date": 1536155930, "answer_id": 52186974, "question_id": 52186622, "link": "https://stackoverflow.com/questions/52186622/how-do-extract-a-range-from-a-cell-where-the-cell-contains-the-range-value/52186974#52186974", "title": "How do extract a range from a cell (where the cell contains the range value)", "body": "<p>You are using <code>rngstart</code> and <code>rngend</code> as if they were strings in your call to <code>DrawArrows</code>...</p>\n\n<blockquote>\n<pre><code>        Call DrawArrows(Range(rngstart), Range(rngend), RGB(0, 0, 255), \"Single\")\n</code></pre>\n</blockquote>\n\n<p>...but you're treating them as objects here:</p>\n\n<blockquote>\n<pre><code>        Set rngstart = Range(\"K\" &amp; (ActiveCell.Row)).Value\n        Set rngend = Range(\"H\" &amp; (ActiveCell.Row)).Value\n</code></pre>\n</blockquote>\n\n<p>This should be a run-time error 424, because you're retrieving a <code>Variant</code> (which based on your question is a <code>String</code> sub-type) and attempting to assign it to a variable declared as a <code>Range</code>.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim rng As Range, cell As Range\n\n    With Sheet1 '&lt;-- you should be explicitly referencing a worksheet. replace as required.\n        Set rng = .Range(\"E5:E100\")\n        For Each cell In rng\n            If cell.Value = \"Yes\" Then\n                Dim rngstart As String, rngend As String\n                rngstart = .Cells(cell.Row, 11).Text\n                rngend = .Cells(cell.Row, 8).Text\n                'ditto with the explicit reference.\n                Call DrawArrows(.Range(rngstart), .Range(rngend), RGB(0, 0, 255), \"Single\")\n            End If\n        Next cell\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "edited": false, "score": 0, "creation_date": 1536159165, "post_id": 52187042, "comment_id": 91325850, "body": "Thank you for taking the time to respond to my problem."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "edited": false, "score": 0, "creation_date": 1536159364, "post_id": 52187042, "comment_id": 91326004, "body": "@KarlGriffiths - you&#39;re welcome. the normal way of saying &quot;thanks&quot; is to click the &quot;up arrow&quot; button next to the answer. That lets others know that the answer is useful, even though it may not have been the &quot;best&quot; answer or your final solution."}, {"owner": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "edited": false, "score": 0, "creation_date": 1536174332, "post_id": 52187042, "comment_id": 91333462, "body": "I can only select one. If I set yours it removes it from the other one"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "edited": false, "score": 0, "creation_date": 1536174405, "post_id": 52187042, "comment_id": 91333500, "body": "@KarlGriffiths, not the check mark (which is fine where it is, Comintern provided a much more complete answer), but the up arrow above the number."}, {"owner": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "edited": false, "score": 0, "creation_date": 1536174482, "post_id": 52187042, "comment_id": 91333531, "body": "Gotcha. I have done that. But I have such a low rep currently (not used the site much) that apparently it doesn&#39;t change the score"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1536156120, "creation_date": 1536156120, "answer_id": 52187042, "question_id": 52186622, "link": "https://stackoverflow.com/questions/52186622/how-do-extract-a-range-from-a-cell-where-the-cell-contains-the-range-value/52187042#52187042", "title": "How do extract a range from a cell (where the cell contains the range value)", "body": "<p>The line <code>Set rngstart = Range(\"K\" &amp; (ActiveCell.Row)).Value</code> is assigning the <code>.Value</code> stored in column <code>K</code>, row <code>ActiveCell.Row</code> to the <code>Range</code> variable <code>rngstart</code>. You want to assign the <code>range</code> to pass in.</p>\n\n<p>Doing some quick \"air-coding\", something like this should work:</p>\n\n<pre><code>Set rngstart = ActiveSheet.Range(\"K\" &amp; (ActiveCell.Row))\n</code></pre>\n\n<p>Note: I've specified <code>ActiveSheet</code>, because that's what the otherwise unquilified <code>Range</code> points to - at least this way it's explicit. Also, this could easily break if someone were to click on another sheet, or the button is on a different sheet than the one where you're looking to pick up the cell address from.</p>\n"}], "owner": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 52186974, "answer_count": 2, "score": 0, "last_activity_date": 1536156225, "creation_date": 1536154874, "last_edit_date": 1536156049, "question_id": 52186622, "link": "https://stackoverflow.com/questions/52186622/how-do-extract-a-range-from-a-cell-where-the-cell-contains-the-range-value", "title": "How do extract a range from a cell (where the cell contains the range value)", "body": "<p>I am basically using a script that somebody else designed which draws arrows on the excel sheet between various points. I have data in my spreadsheet which shows the cells that need linking and I am trying to call the value of this cells into the call for the macro script that I am using and running it as a loop so that it creates all the arrows I want</p>\n\n<p>It fails every time on the lines where I am adding .value. I have tried different ways following similar issues but none doing exactly what i am asking so i am no at a loss</p>\n\n<p>the stored range value that i am trying to extract looks like this $B$5 . </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim rng As Range, cell As Range, rngstart As Range, rngend As Range\n\nSet rng = Range(\"E5:E100\")\n    For Each cell In rng\n        If cell.Value = \"Yes\" Then\n            cell.Select\n            Set rngstart = Range(\"K\" &amp; (ActiveCell.Row)).Value\n            Set rngend = Range(\"H\" &amp; (ActiveCell.Row)).Value\n            Call DrawArrows(Range(rngstart), Range(rngend), RGB(0, 0, 255), \"Single\")\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>the original code before  for calling the script looked like this</p>\n\n<pre><code>Call DrawArrows(Range(\"b1\"), Range(\"c4\"), RGB(0, 0, 255), \"Double\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1536154836, "post_id": 52186541, "comment_id": 91322880, "body": "Why break up the date into pieces? Why not just look for an exact match of <code>mm&#47;dd&#47;yyyy</code> etc.?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536154967, "post_id": 52186541, "comment_id": 91322977, "body": "...or cast it to a <code>Date</code> and use that?"}, {"owner": {"reputation": 43, "user_id": 10212607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eca3cc94d44122e3c8f048b21c46b38c?s=128&d=identicon&r=PG&f=1", "display_name": "S. Deans", "link": "https://stackoverflow.com/users/10212607/s-deans"}, "edited": false, "score": 0, "creation_date": 1536155200, "post_id": 52186541, "comment_id": 91323129, "body": "The date is broken up to divvy out information later on so I can just call the month etc. I was trying to make this easier for me as I go along"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1536155674, "post_id": 52186541, "comment_id": 91323477, "body": "@S.Deans I think you&#39;re making it harder - if you have a date in <code>mm&#47;dd&#47;yyyy</code> you can always call the month from that by doing <code>Month(mm&#47;dd&#47;yyyy)</code>, or the day by <code>Day(mm&#47;dd&#47;yyyy)</code> etc..."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1536155797, "post_id": 52186541, "comment_id": 91323566, "body": "You&#39;re also using invalid quotation marks in your lines <code>Sheets(\u201cDay Report\u201d).Cells(yreport, i) = Sheets(\u201cProcess\u201d).Cells(y, i)</code> and <code>Sheets(\u201cDay Report\u201d).Cells(yreport + 1, i) = Sheets(\u201cProcess\u201d).Cells(y + 1, i)</code> - change those to normal <code>&quot;</code>."}, {"owner": {"reputation": 43, "user_id": 10212607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eca3cc94d44122e3c8f048b21c46b38c?s=128&d=identicon&r=PG&f=1", "display_name": "S. Deans", "link": "https://stackoverflow.com/users/10212607/s-deans"}, "edited": false, "score": 0, "creation_date": 1536155865, "post_id": 52186541, "comment_id": 91323612, "body": "There is a time component associated to the date too. I was trying to get the difference in time across days to the second. I used DateSerial in the sub which populated the Process sheet, but couldnt find anything which included the time too, so I just broke it up and handled it manually"}, {"owner": {"reputation": 43, "user_id": 10212607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eca3cc94d44122e3c8f048b21c46b38c?s=128&d=identicon&r=PG&f=1", "display_name": "S. Deans", "link": "https://stackoverflow.com/users/10212607/s-deans"}, "edited": false, "score": 1, "creation_date": 1536156101, "post_id": 52186541, "comment_id": 91323781, "body": "That was it! the quotation marks! Thank you!  I have no idea why my keyboard entered those kinds of quotation marks, but I copied yours in and that&#39;s it now (buggily) copying things over"}], "owner": {"reputation": 43, "user_id": 10212607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eca3cc94d44122e3c8f048b21c46b38c?s=128&d=identicon&r=PG&f=1", "display_name": "S. Deans", "link": "https://stackoverflow.com/users/10212607/s-deans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536155642, "creation_date": 1536154659, "last_edit_date": 1536155642, "question_id": 52186541, "link": "https://stackoverflow.com/questions/52186541/trying-to-copy-rows-from-one-sheet-if-it-has-the-entered-date", "title": "Trying to copy rows from one sheet if it has the entered date", "body": "<p>I'm trying to copy rows from one sheet to another if they have dates that match. I've used this method before and it worked fine. I can't work out where I'm going wrong here for the life of me.</p>\n\n<pre><code>Public Sub dayreport()\n    Dim enteredday As Variant\n    Dim clockinday As Variant\n    Dim y As Integer\n    Dim yreport As Integer\n    Dim yrow As Integer\n    Dim daystring As String\n    Dim datecheck As Boolean\n    'Collect the entered date\n    enteredday = CVar(Sheets(\"Process\").Cells(3, 3)) 'get the datestring out of the date cell\n    'Only progress if a date is entered\n    If IsDate(enteredday) = True Then\n        datecheck = True    'a usable date has been entered\n    Else\n        datecheck = False\n        MsgBox \"Entered date must be a real date of the format dd/mm/yyyy\"\n    End If\n    If datecheck = True Then\n        'Delete the day report if it already exists\n        Call Delete_Sheet(\"Day Report\")\n        'create a new sheet\n        Worksheets.Add.name = \"Day Report\"\n\n        y = 7\n        yreport = 7\n        yrow = 7\n        'While there is data in any of the cells of the investigated row, loop\n        Do While Sheets(\"Process\").Cells(y, 1) &lt;&gt; \"\" _\n                    Or Sheets(\"Process\").Cells(y, 2) &lt;&gt; \"\" _\n                    Or Sheets(\"Process\").Cells(y, 3) &lt;&gt; \"\" _\n                    Or Sheets(\"Process\").Cells(y, 4) &lt;&gt; \"\" _\n                    Or Sheets(\"Process\").Cells(y, 5) &lt;&gt; \"\" _\n                    Or Sheets(\"Process\").Cells(y, 6) &lt;&gt; \"\" _\n                    Or Sheets(\"Process\").Cells(y, 7) &lt;&gt; \"\" _\n                    Or Sheets(\"Process\").Cells(y, 8) &lt;&gt; \"\" _\n\n            'breakdown entered date\n            year = CInt(Right(enteredday, 4))   'take the year component from the date and convert it to an integer\n            month = CInt(Mid(enteredday, 4, 2))     'take the month component from the date and convert it to an integer\n            day = CInt(Left(enteredday, 2))     'take the day component from the date and convert it to an integer\n            enteredday = DateSerial(year, month, day)\n\n            'Breakdown investigated date\n            clockinday = CVar(Sheets(\"Process\").Cells(y, 2)) 'get the datestring out of the date cell\n            sheetyear = CInt(Right(clockinday, 4))\n            sheetmonth = CInt(Mid(clockinday, 4, 2))\n            sheetday = CInt(Left(clockinday, 2))\n            clockinday = DateSerial(sheetyear, sheetmonth, sheetday)\n\n            'copy the row pairs into the day report sheet if the entered date matches the date in the row\n            If enteredday = clockinday Then\n\n\n\n                For i = 1 To 9\n\n                    Sheets(\u201cDay Report\u201d).Cells(yreport, i) = Sheets(\u201cProcess\u201d).Cells(y, i)\n                    Sheets(\u201cDay Report\u201d).Cells(yreport + 1, i) = Sheets(\u201cProcess\u201d).Cells(y + 1, i)\n                    yreport = yreport + 2\n                Next i\n            End If\n            yrow = yrow + 2\n            y = y + 2\n        Loop\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Instead of the for-loop copying dates, I also tried,</p>\n\n<pre><code>Worksheets(\"Process\").Range(CVar(\"A\" &amp; yrow &amp; \":\" &amp; \"I\" &amp; yrow + 1)).Copy Worksheets(\u201cDay Report\u201d).Range(CVar(\"A\" &amp; yreport &amp; \":\" &amp; \"I\" &amp; yreport + 1))\n</code></pre>\n\n<p>It seems as though it is not able to see my Process sheet, yet it was populated by another sub which runs perfectly</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 6, "creation_date": 1536154544, "post_id": 52186457, "comment_id": 91322665, "body": "Would be worth looking at <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">FIND</a> to find the <code>partno</code> and then offset from the returned range reference."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1536154929, "post_id": 52186457, "comment_id": 91322950, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.lookup\" rel=\"nofollow noreferrer\">Lookup</a> will return the value of the cell, not the cell itself."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1536155149, "post_id": 52186457, "comment_id": 91323086, "body": "Also your <code>Lookup</code> syntax looks wrong, did you mean to use <code>vlookup</code> instead? Because <code>Lookup</code> only has 3 parameters but you used 4."}, {"owner": {"reputation": 53, "user_id": 10283722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc3f3620c52d7567cde20fd4747f204?s=128&d=identicon&r=PG&f=1", "display_name": "MarkHav", "link": "https://stackoverflow.com/users/10283722/markhav"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1536156016, "post_id": 52186457, "comment_id": 91323724, "body": "@P\u1d07\u029c yeah that was just a typo"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1536155310, "post_id": 52186603, "comment_id": 91323203, "body": "I think you must match column A not B: <code>Range(&quot;A5:A46&quot;)</code>. Also it would throw an error if there is no match, so some error handling would be a good idea."}, {"owner": {"reputation": 53, "user_id": 10283722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc3f3620c52d7567cde20fd4747f204?s=128&d=identicon&r=PG&f=1", "display_name": "MarkHav", "link": "https://stackoverflow.com/users/10283722/markhav"}, "edited": false, "score": 0, "creation_date": 1536155981, "post_id": 52186603, "comment_id": 91323695, "body": "was just about to say it didnt work then you editted B to A and now it works exactly as intended, thanks"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1536157176, "post_id": 52186603, "comment_id": 91324462, "body": "If you use <code>With Range(&quot;A5:A46&quot;): Debug.Print .Cells(WorksheetFunction.Match(partno, .Cells, 0), 2).Address : End With</code> you don&#39;t have to care about the beginning row and don&#39;t have to think about the  <code>+4</code> at all (because all row counting is relative to the range, but <code>.Address</code> still returns the absolute address)."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 3, "last_activity_date": 1536155443, "last_edit_date": 1536155443, "creation_date": 1536154816, "answer_id": 52186603, "question_id": 52186457, "link": "https://stackoverflow.com/questions/52186457/returning-the-address-of-a-vlookup-function-in-vba/52186603#52186603", "title": "Returning the address of a vlookup function in vba", "body": "<p>as well as using <code>find</code> </p>\n\n<p><code>cells(worksheetfunction.match(partno,range(\"a5:a46\"),0)+4,2).address</code></p>\n\n<p>The plus 4 is due to the start row of the range being 5, for example a match in row 5 will return 1.</p>\n"}, {"tags": [], "owner": {"reputation": 1722, "user_id": 563231, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2rzat.jpg?s=128&g=1", "display_name": "David Metcalfe", "link": "https://stackoverflow.com/users/563231/david-metcalfe"}, "is_accepted": false, "score": 0, "last_activity_date": 1581201762, "creation_date": 1581201762, "answer_id": 60131906, "question_id": 52186457, "link": "https://stackoverflow.com/questions/52186457/returning-the-address-of-a-vlookup-function-in-vba/60131906#60131906", "title": "Returning the address of a vlookup function in vba", "body": "<p>Per the comments, using Find and an offset should be just fine.</p>\n\n<pre><code>Function getAddress(itemToFind As Variant, lookupRange As Range, columnOffset As Integer)\n\n    getAddress = lookupRange.Find(What:=itemToFind).Offset(0, columnOffset).address\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Example()\n\n    Dim batch1add As String\n\n    Set batch1add = getAddress(partno, Sheet3.Range(\"A5:B46\"), 2)\n\nEnd Sub\n</code></pre>\n\n<p>As PEH advised in the prior answer's comments: Incorporating some error handling would be wise, as both implementations assume the value exists whenever they're called.</p>\n"}], "owner": {"reputation": 53, "user_id": 10283722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc3f3620c52d7567cde20fd4747f204?s=128&d=identicon&r=PG&f=1", "display_name": "MarkHav", "link": "https://stackoverflow.com/users/10283722/markhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4597, "favorite_count": 0, "accepted_answer_id": 52186603, "answer_count": 2, "score": 0, "last_activity_date": 1581201762, "creation_date": 1536154387, "question_id": 52186457, "link": "https://stackoverflow.com/questions/52186457/returning-the-address-of-a-vlookup-function-in-vba", "title": "Returning the address of a vlookup function in vba", "body": "<p>I've looked through all guides I can find on this subject but not a single one solves my problem.\nI want to find the cell address of this vlookup function:</p>\n\n<pre><code>vlookadd = Application.Lookup(partno, Sheet3.Range(\"A5:B46\"), 2, False)\n</code></pre>\n\n<p>(Currently dimmed as variant incase that needs to be changed)\nI want to find the address of the value found and make it equal a variable so something like this:</p>\n\n<pre><code>batch1add = vlookadd.Address\n</code></pre>\n\n<p>The value found by the lookup function works fine but the address always comes up empty after trying lots of different possible solutions</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1536154291, "post_id": 52186342, "comment_id": 91322516, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31477319/excel-vba-loop-rows-until-empty-cell\">Excel VBA Loop Rows Until Empty Cell</a>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1536155065, "post_id": 52186342, "comment_id": 91323045, "body": "Can you explain what&#39;s going on in row 9?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10227884, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nfhGeJ6rJiQ/AAAAAAAAAAI/AAAAAAAABsE/l8G7Q7Y8hqI/photo.jpg?sz=128", "display_name": "Jenita Kurlawala", "link": "https://stackoverflow.com/users/10227884/jenita-kurlawala"}, "edited": false, "score": 0, "creation_date": 1538379493, "post_id": 52186998, "comment_id": 92107897, "body": "Hello Domenic, this code works for 5 code only , after running 5th statement. The code stops and rest of the Code are left without performing this function. I cant figure out where is the issue"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 31, "user_id": 10227884, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nfhGeJ6rJiQ/AAAAAAAAAAI/AAAAAAAABsE/l8G7Q7Y8hqI/photo.jpg?sz=128", "display_name": "Jenita Kurlawala", "link": "https://stackoverflow.com/users/10227884/jenita-kurlawala"}, "edited": false, "score": 0, "creation_date": 1538400632, "post_id": 52186998, "comment_id": 92119192, "body": "Which line gives you the error?  And which error are you getting?"}, {"owner": {"reputation": 31, "user_id": 10227884, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nfhGeJ6rJiQ/AAAAAAAAAAI/AAAAAAAABsE/l8G7Q7Y8hqI/photo.jpg?sz=128", "display_name": "Jenita Kurlawala", "link": "https://stackoverflow.com/users/10227884/jenita-kurlawala"}, "edited": false, "score": 0, "creation_date": 1538460069, "post_id": 52186998, "comment_id": 92139579, "body": "Hello Domenic, I tweaked the code a little and works fine. No issue now !!!. Thank you so much for this"}, {"owner": {"reputation": 31, "user_id": 10227884, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nfhGeJ6rJiQ/AAAAAAAAAAI/AAAAAAAABsE/l8G7Q7Y8hqI/photo.jpg?sz=128", "display_name": "Jenita Kurlawala", "link": "https://stackoverflow.com/users/10227884/jenita-kurlawala"}, "edited": false, "score": 0, "creation_date": 1542092106, "post_id": 52186998, "comment_id": 93433006, "body": "Hello Domenic, my worksheet has stopped recalculating suddenly, which worked fine before. Any possible reason"}], "tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": true, "score": 0, "last_activity_date": 1536159279, "last_edit_date": 1536159279, "creation_date": 1536156003, "answer_id": 52186998, "question_id": 52186342, "link": "https://stackoverflow.com/questions/52186342/vba-loop-help-required/52186998#52186998", "title": "VBA loop help required", "body": "<p>I haven't tested it, but try the following code...</p>\n\n<pre><code>Option Explicit\n\nSub MultipleSOA()\n\n    Dim varItemsToReplace As Variant\n    Dim varItem As Variant\n    Dim wksSource As Worksheet\n    Dim wksDest As Worksheet\n    Dim rngSource As Range\n    Dim rngCell As Range\n\n    varItemsToReplace = Array(\"PCL-\", \"SCL-\", \"PSI-\", \"CL-\")\n\n    Set wksSource = Worksheets(\"Sheet1\")\n    Set wksDest = Worksheets(\"Loc\")\n\n    With wksSource\n        Set rngSource = .Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\n    End With\n\n    For Each rngCell In rngSource\n        With wksDest\n            .Range(\"C2\").Value = rngCell.Value\n            .Calculate\n            For Each varItem In varItemsToReplace\n                .Range(\"B9:G9\").Replace _\n                    What:=varItem, _\n                    Replacement:=\"\", _\n                    LookAt:=xlPart, _\n                    SearchOrder:=xlByRows, _\n                    MatchCase:=False, _\n                    SearchFormat:=False, _\n                    ReplaceFormat:=False\n            Next varItem\n            .Columns(\"C:C\").ColumnWidth = 44.29\n            .ExportAsFixedFormat _\n                Type:=xlTypePDF, _\n                Filename:=\"C:\\Users\\XXXX\\Desktop\\SOA\\\" &amp; .Range(\"B9\").Value &amp; \" - \" &amp; .Range(\"C2\").Value &amp; \".pdf\", _\n                Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, _\n                IgnorePrintAreas:=False, _\n                OpenAfterPublish:=False\n        End With\n    Next rngCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10227884, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nfhGeJ6rJiQ/AAAAAAAAAAI/AAAAAAAABsE/l8G7Q7Y8hqI/photo.jpg?sz=128", "display_name": "Jenita Kurlawala", "link": "https://stackoverflow.com/users/10227884/jenita-kurlawala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 52186998, "answer_count": 1, "score": 0, "last_activity_date": 1536159279, "creation_date": 1536154053, "question_id": 52186342, "link": "https://stackoverflow.com/questions/52186342/vba-loop-help-required", "title": "VBA loop help required", "body": "<p>I have 2 sheets in a workbook\nSheet 1 - Where A2 and onwards I have numbers\nSheet named \"LOC\" , where i put 1 number at a time recalculate and formate and save it</p>\n\n<p>the process has to repeat for all number entered in Sheet 1 - A2 and Below till the end of Column</p>\n\n<p>Please help me loop this</p>\n\n<p>I have to copy each number from Sheet 1 and paste it in heet named \"LOC\" in C2 and repeat the process again</p>\n\n<pre><code>Sub MultipleSOA()\n '1st SOA\n\nSheets(\"Sheet1\").Select\nRange(\"A2\").Select\nSelection.Copy\nSheets(\"Loc \").Select\nRange(\"C2\").Select\nActiveSheet.Paste\n\nActiveSheet.Calculate\n\nRange(\"B9:G9\").Select\nCells.Replace What:=\"PCL-\", Replacement:=\"\", LookAt:=xlPart, SearchOrder _\n    :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\nCells.Replace What:=\"SCL-\", Replacement:=\"\", LookAt:=xlPart, SearchOrder _\n    :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\nCells.Replace What:=\"PSI-\", Replacement:=\"\", LookAt:=xlPart, SearchOrder _\n    :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\nCells.Replace What:=\"CL-\", Replacement:=\"\", LookAt:=xlPart, SearchOrder _\n    :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\nRange(\"B9:G9\").Select\n\nRange(\"C4\").Select\nColumns(\"C:C\").ColumnWidth = 44.29\nRange(\"C4\").Select\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"C:\\Users\\XXXX\\Desktop\\SOA\\\" &amp; ActiveSheet.Range(\"B9\").Value &amp; \" - \" &amp; ActiveSheet.Range(\"C2\").Value &amp; \".pdf\" _\n, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n:=False, OpenAfterPublish:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 1, "creation_date": 1536153870, "post_id": 52185916, "comment_id": 91322236, "body": "I&#39;ve found <code>Screen.ActiveForm</code> to generally be used when something more robust could be employed. So what is the objective of your code here, from a higher level perspective ?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1536153978, "post_id": 52185916, "comment_id": 91322316, "body": "Is there any need for the use of <code>screen</code> or <code>af</code> can you not replace <code>af</code> with <code>me</code> or rather than the form object <code>me.name</code>?"}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1536155587, "post_id": 52185916, "comment_id": 91323403, "body": "In this particular example @Minty - it&#39;s setting the RecordSource of a subform based on variables selected on said form. The error does occur on various modules though. I can&#39;t use Me unfortunately as the code isn&#39;t in a Private Sub."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1536160937, "post_id": 52185916, "comment_id": 91327026, "body": "I&#39;m still not following why you need to know the active form. If the goal is to have a subform communicate with a parent form then it&#39;s not needed. You can either reference the child form directly from the parent (or vice versa) or, if there&#39;s a possibility of reusing the child form somewhere else, you can use events to move data between the forms. There is also a much looser coupling between forms with events facilitating the communication."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1536177423, "post_id": 52185916, "comment_id": 91334848, "body": "Are you making sure the form is actually open before trying to make it active?"}], "owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536152788, "creation_date": 1536152788, "question_id": 52185916, "link": "https://stackoverflow.com/questions/52185916/access-run-time-error-2475-occasionally-occuring", "title": "Access Run-time Error 2475 *occasionally* occuring", "body": "<p>I have an error log that logs in the access table whenever a runtime error occurs for a user in the error trapper, and a particular error seems to occur for 10 random users, every hour at least.</p>\n\n<p>This error appears to occur completely at random, on a random module with the Set ActiveForm code, with random users at random intervals. As far as I can see, there is no pattern between the users.  </p>\n\n<blockquote>\n  <p>2475 - \"You entered an expression that requires a form to be the active window\".</p>\n</blockquote>\n\n<p>This appears to occur in any of the modules that contain any of the setting of a form. I am using the following lines:</p>\n\n<pre><code>Dim af as Object\nSet af = Screen.ActiveForm\n</code></pre>\n\n<p>I have tried using alternatives, such as declaring it as Form, and also tried the below:</p>\n\n<pre><code>Dim sstatus as String\nDim ps as String\n\nIf DLookup(\"[TM_UserType]\", \"[SD_Teams]\", \"[TM_username]= '\" &amp; usernm &amp; \"'\") = \"adj\" Then\n    sstatus = \"adj\"\nElse\n    sstatus = \"tm\"\nEnd If\n\nps = \"frmProdSubmit_\" &amp; sstatus\n</code></pre>\n\n<p>Then referencing the form this way:</p>\n\n<pre><code>Forms(ps).cmbTeam.Value = \"\"\n</code></pre>\n\n<p>But this <strong>still</strong> causes the same issue, even removing the ActiveForm part.</p>\n\n<p>The last thing to mention (as I believe they could be factors) is that the front end is accessed through a shortcut, which minimises the Access window. Not sure if this could be the culprit, or if the user clicking another application can remove the focus.</p>\n\n<p>The back-end of the database is also accessed by up to around 700 users each day.</p>\n\n<p>As it stands, the error trapper pops up with the message, but the front end continues working correctly. It's just an annoying issue to resolve, but am slowly running out of ideas now, and any help would be hugely appreciated!</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 4, "creation_date": 1536152460, "post_id": 52185769, "comment_id": 91321248, "body": "The compiler will object to you referring to an object that doesn&#39;t exist yet. You could try: <code>Userforms.add(&quot;LOGIN&quot;).Show</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1536152720, "post_id": 52185769, "comment_id": 91321405, "body": "@Rory Not exactly the compiler objecting so much as the run-time objecting to a reference to a pre-declared instance of a form that hasn&#39;t been compiled. If the <code>UserForms.Add</code> doesn&#39;t work, you might need to show it via simple sub called by <code>Application.OnTime</code>."}, {"owner": {"reputation": 57, "user_id": 5708543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ldnir.jpg?s=128&g=1", "display_name": "27560", "link": "https://stackoverflow.com/users/5708543/27560"}, "edited": false, "score": 0, "creation_date": 1536152883, "post_id": 52185769, "comment_id": 91321515, "body": "Userforms.add(&quot;LOGIN&quot;).Show worked PERFECTLY! Thank you so much for the immediate response!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1536215986, "post_id": 52185769, "comment_id": 91345022, "body": "@Rory please post this as an Answer..."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1536218942, "creation_date": 1536218942, "answer_id": 52198700, "question_id": 52185769, "link": "https://stackoverflow.com/questions/52185769/run-time-error-424-object-required-when-doing-userform-show-on-imported-userfo/52198700#52198700", "title": "Run-time error &#39;424&#39; Object Required when doing userform.show on imported userform", "body": "<p>The run-time (thanks @Comintern!) won't like you referring to an object that doesn't exist yet. You could use:</p>\n\n<pre><code>Userforms.add(\"LOGIN\").Show\n</code></pre>\n\n<p>to avoid that direct reference.</p>\n"}], "owner": {"reputation": 57, "user_id": 5708543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ldnir.jpg?s=128&g=1", "display_name": "27560", "link": "https://stackoverflow.com/users/5708543/27560"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 1, "accepted_answer_id": 52198700, "answer_count": 1, "score": 2, "last_activity_date": 1536218942, "creation_date": 1536152362, "question_id": 52185769, "link": "https://stackoverflow.com/questions/52185769/run-time-error-424-object-required-when-doing-userform-show-on-imported-userfo", "title": "Run-time error &#39;424&#39; Object Required when doing userform.show on imported userform", "body": "<p>I am attempting to import a userform, and show it on initial startup. The userform imports just fine, however, when attempting to show it, I keep getting a Run-time error '424' Object Required.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Workbook_Open()\n\nDim wkbTarget As Excel.Workbook\nDim szTargetWorkbook As String\nDim cmpComponents As VBIDE.VBComponents\nApplication.ScreenUpdating = False\nszTargetWorkbook = ActiveWorkbook.Name\nSet wkbTarget = Application.Workbooks(szTargetWorkbook)\nSet cmpComponents = wkbTarget.VBProject.VBComponents\n\n' IMPORT FORM\ncmpComponents.Import \"\\\\myserver.domain\\Application\\Forms\\LOGIN.frm\"\n\nLOGIN.Show\n\nEnd Sub\n</code></pre>\n\n<p>When I click End on the error, I can then show the userform just fine.</p>\n"}, {"tags": ["database", "ms-access", "vba", "ms-access-2016"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10320130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5dc3c22086e157db566f14da094ddee?s=128&d=identicon&r=PG", "display_name": "B McNabb", "link": "https://stackoverflow.com/users/10320130/b-mcnabb"}, "edited": false, "score": 0, "creation_date": 1536156000, "post_id": 52185920, "comment_id": 91323714, "body": "The only problem I&#39;m having is it pops up a message box asking for the employee name now. The employee name box is a dropdown list of names, maybe that&#39;s the issue?"}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "reply_to_user": {"reputation": 13, "user_id": 10320130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5dc3c22086e157db566f14da094ddee?s=128&d=identicon&r=PG", "display_name": "B McNabb", "link": "https://stackoverflow.com/users/10320130/b-mcnabb"}, "edited": false, "score": 0, "creation_date": 1536156994, "post_id": 52185920, "comment_id": 91324355, "body": "Yes, you&#39;ll have to adjust the last part of <code>sFilter</code> to reflect the actual employee field name. Also, if the employee field is a number rather than text, you&#39;ll need to adjust it accordingly."}, {"owner": {"reputation": 13, "user_id": 10320130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5dc3c22086e157db566f14da094ddee?s=128&d=identicon&r=PG", "display_name": "B McNabb", "link": "https://stackoverflow.com/users/10320130/b-mcnabb"}, "edited": false, "score": 0, "creation_date": 1536157731, "post_id": 52185920, "comment_id": 91324833, "body": "Awesome thank you so much. It was my fault actually. I misspelled the field name, it was right the first time. :)"}], "tags": [], "owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "is_accepted": true, "score": 0, "last_activity_date": 1536152802, "creation_date": 1536152802, "answer_id": 52185920, "question_id": 52185207, "link": "https://stackoverflow.com/questions/52185207/adding-name-to-date-range-search-ms-access-vba/52185920#52185920", "title": "Adding Name to Date Range Search. MS Access VBA", "body": "<p>Assuming that your <code>EmployeeNameBox</code> will always be populated when searching, you just need to add it to your filter. I've found it's easier to store your filter in a variable, then assign it to <code>Me.Filter</code> at the end. So something like:</p>\n\n<pre><code>Private Sub Searchbtn_Click()\n    Dim sFilter as String\n\n    sFilter = _\n            \"[DayMonthYear] BETWEEN \" &amp; _\n                \"#\" &amp; Me.Date1Filt &amp; \"# AND \" &amp; _\n                \"#\" &amp; Me.Date2Filt &amp; \"# \" &amp; _\n            \" AND [EmployeeName] = \"\"\" &amp; Me.EmployeeNameBox &amp; \"\"\"\"\n\n    Me.Filter = sFilter\n    Me.FilterOn = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10320130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5dc3c22086e157db566f14da094ddee?s=128&d=identicon&r=PG", "display_name": "B McNabb", "link": "https://stackoverflow.com/users/10320130/b-mcnabb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 52185920, "answer_count": 1, "score": 1, "last_activity_date": 1594629626, "creation_date": 1536150715, "last_edit_date": 1594629626, "question_id": 52185207, "link": "https://stackoverflow.com/questions/52185207/adding-name-to-date-range-search-ms-access-vba", "title": "Adding Name to Date Range Search. MS Access VBA", "body": "<p>So I am making a defects database in MS Access for work and I am working on a search form to find a specific employees defects between specific dates. I already have the date range search working with a button, but I haven't figured out how to add my EmployeeNameBox into the filter results. This is what I have.</p>\n\n<pre><code>Private Sub Searchbtn_Click()\n    Me.Filter = \"[DayMonthYear] BETWEEN #\" &amp; Me.Date1Filt &amp; \"# AND #\" &amp; Me.Date2Filt &amp; \"#\"\n    Me.FilterOn = True\nEnd Sub\n</code></pre>\n\n<p>Works great for the date range I want, but I need to add in the employee name as well. Any help would be much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 2, "last_activity_date": 1536150880, "creation_date": 1536150880, "answer_id": 52185264, "question_id": 52184958, "link": "https://stackoverflow.com/questions/52184958/excel-vba-loop-through-numbered-userform-elements/52185264#52185264", "title": "Excel VBA || Loop through numbered userform elements", "body": "<p>Try the following...</p>\n\n<pre><code>For l = 1 To 8\n    Rng.Parent.Cells(LastRow + l, 8).Value = Me.Controls(\"textBoxTask\" &amp; l).Value\nNext l\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8951759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da872f8f661ec6aaa8e46a2b5bc11307?s=128&d=identicon&r=PG&f=1", "display_name": "YellowSkin", "link": "https://stackoverflow.com/users/8951759/yellowskin"}, "edited": false, "score": 0, "creation_date": 1536152002, "post_id": 52185325, "comment_id": 91320935, "body": "I like the For...Next loop the most. Thank you for this."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1536151042, "creation_date": 1536151042, "answer_id": 52185325, "question_id": 52184958, "link": "https://stackoverflow.com/questions/52184958/excel-vba-loop-through-numbered-userform-elements/52185325#52185325", "title": "Excel VBA || Loop through numbered userform elements", "body": "<p>Two ways I can think of doing it.</p>\n\n<p>The first is following your <code>For...Next</code> loop version:  </p>\n\n<pre><code>Dim l As Long\nFor l = 1 To 8\n    Sheet1.Cells(l, 8) = UserForm1.Controls(\"TextBox\" &amp; l)\nNext l  \n</code></pre>\n\n<p>The second way is to do it in one hit with an array:  </p>\n\n<pre><code>With UserForm1\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"H1:H8\") = _\n        Application.Transpose(Array(.TextBox1, .TextBox2, .TextBox3, .TextBox4, _\n                                    .TextBox5, .TextBox6, .TextBox7, .TextBox8))\nEnd With  \n</code></pre>\n\n<p>(you can remove the <code>Application.Transpose</code> if you're copying the values to a single row rather than column).</p>\n"}], "owner": {"reputation": 15, "user_id": 8951759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da872f8f661ec6aaa8e46a2b5bc11307?s=128&d=identicon&r=PG&f=1", "display_name": "YellowSkin", "link": "https://stackoverflow.com/users/8951759/yellowskin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1536151261, "creation_date": 1536149960, "last_edit_date": 1536151261, "question_id": 52184958, "link": "https://stackoverflow.com/questions/52184958/excel-vba-loop-through-numbered-userform-elements", "title": "Excel VBA || Loop through numbered userform elements", "body": "<p>I am looking to make my already working code more efficient. </p>\n\n<p>This is the code that I have and works:</p>\n\n<pre><code>rng.Parent.Cells(LastRow + 1, 8).Value = textBoxTask1.Value\nrng.Parent.Cells(LastRow + 2, 8).Value = textBoxTask2.Value\nrng.Parent.Cells(LastRow + 3, 8).Value = textBoxTask3.Value\nrng.Parent.Cells(LastRow + 4, 8).Value = textBoxTask4.Value\nrng.Parent.Cells(LastRow + 5, 8).Value = textBoxTask5.Value\nrng.Parent.Cells(LastRow + 6, 8).Value = textBoxTask6.Value\nrng.Parent.Cells(LastRow + 7, 8).Value = textBoxTask7.Value\nrng.Parent.Cells(LastRow + 8, 8).Value = textBoxTask8.Value\n</code></pre>\n\n<p>This is what I am trying but doesn't seem to work. </p>\n\n<pre><code>For l = 1 To 8\n    rng.Parent.Cells(LastRow + l, 8).Value = \"textBoxTask\" &amp; l.Value\nNext l\n</code></pre>\n"}, {"tags": ["vba", "dll", "coreldraw"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1536149967, "post_id": 52184853, "comment_id": 91319643, "body": "Can you edit your question to include your code?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1536150399, "post_id": 52184853, "comment_id": 91319932, "body": "Specifying the DLL file (where it came from, what software package) might be really handy too, someone else may have experience with it. Of course, if it&#39;s something proprietary/written in-house, that may not be the case."}, {"owner": {"reputation": 1, "user_id": 10319936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe9edf8a98e11eb23c8c9e50f4cad19?s=128&d=identicon&r=PG&f=1", "display_name": "pankaj kumar", "link": "https://stackoverflow.com/users/10319936/pankaj-kumar"}, "edited": false, "score": 0, "creation_date": 1536151580, "post_id": 52184853, "comment_id": 91320655, "body": "it is created from vb C++  since i am beginner in vba so please let me know basics of dll file to be used in vba and how to call"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1536151972, "post_id": 52184853, "comment_id": 91320911, "body": "There will be a lot of articles on the net about using DLL&#39;s, without any information, the answer would be what the poster thinks and of no use to you.  Please supply DLL details name etc, function you&#39;re calling, the underlying code of that function etc."}, {"owner": {"reputation": 126499, "user_id": 1531124, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zw18i.png?s=128&g=1", "display_name": "GhostCat", "link": "https://stackoverflow.com/users/1531124/ghostcat"}, "edited": false, "score": 1, "creation_date": 1536153773, "post_id": 52184853, "comment_id": 91322160, "body": "Welcome to Stack Overflow! Other users marked your question for low quality and need for improvement. I re-worded/formatted your input to make it easier to read/understand. Please review my changes to ensure they reflect your intentions. But I think your question is still not answerable. <b>You</b> should <a href=\"https://stackoverflow.com/posts/52184853/edit\">edit</a> your question now, to add missing details (see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> ). Feel free to drop me a comment in case you have further questions or feedback for me."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 102407, "user_id": 2670892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4iPV5.png?s=128&g=1", "display_name": "greg-449", "link": "https://stackoverflow.com/users/2670892/greg-449"}, "edited": false, "score": 0, "creation_date": 1536222214, "post_id": 52198055, "comment_id": 91348278, "body": "@greg-449 The OP posted this instead of editing their question. You should have flagged it as not an answer, not fix the formatting."}], "tags": [], "owner": {"reputation": 1, "user_id": 10319936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe9edf8a98e11eb23c8c9e50f4cad19?s=128&d=identicon&r=PG&f=1", "display_name": "pankaj kumar", "link": "https://stackoverflow.com/users/10319936/pankaj-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1536219335, "last_edit_date": 1536219335, "creation_date": 1536216501, "answer_id": 52198055, "question_id": 52184853, "link": "https://stackoverflow.com/questions/52184853/runtime-error-48-while-using-function-in-dll-in-vba/52198055#52198055", "title": "runtime error 48 while using function in dll in VBA?", "body": "<pre><code>Option Explicit\nPublic x As Integer\nPrivate Declare Function XYZ Lib \" H:\\google drive\\laser machine\\software\\Development\\delete\\squareDLL\\x64\\Debug\\squareDLL.dll\" (ByVal x As Double) As Double\n\nSub main()\nx = 20\nCall XYZ(x)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10319936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe9edf8a98e11eb23c8c9e50f4cad19?s=128&d=identicon&r=PG&f=1", "display_name": "pankaj kumar", "link": "https://stackoverflow.com/users/10319936/pankaj-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536219335, "creation_date": 1536149622, "last_edit_date": 1536216651, "question_id": 52184853, "link": "https://stackoverflow.com/questions/52184853/runtime-error-48-while-using-function-in-dll-in-vba", "title": "runtime error 48 while using function in dll in VBA?", "body": "<p>I have to use a DLL file in VBA code. </p>\n\n<p>After  declaring in code I am unable to use or call the function. The error is: <code>file not found</code> and error code is <code>runtime 48</code>.</p>\n\n<p>The help I need is to know how the function in dll will be called and initialized. </p>\n\n<pre><code>Option Explicit\n\nPublic x As Integer\n\nPrivate Declare Function XYZ Lib \" H:\\google drive\\laser machine\\software\\Development\\delete\\squareDLL\\x64\\Debug\\squareDLL.dll\" (ByVal x As Double) As Double\n\nSub main()\n    x = 20\n    Call XYZ(x)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1536218753, "post_id": 52184835, "comment_id": 91346360, "body": "We need more information in order to test this. Can you supply a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, please? Just the bare bones, plus any explanation required to set this up in both Word and Excel."}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1536330675, "post_id": 52184835, "comment_id": 91398378, "body": "I updated the question with the complete &quot;minimal&quot; code.  See above."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1536335088, "post_id": 52184835, "comment_id": 91401023, "body": "Not having tested anything yet I notice a problem in <code>cmdDone_Click</code>: You refer to <code>ActiveWorkbook</code> but there&#39;s no reference to the Excel application. This can&#39;t run...? The code also uses a functoin <code>getName</code>, but that&#39;s not in the code you provide."}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1536340819, "post_id": 52184835, "comment_id": 91403551, "body": "The function getName returns the filename from the string that contains the full path.  It&#39;s been working fine.  Being a VBA novice I thought that adding the code below to define the Property for the form would allow we to reference wb_open object which was defined in the calling routine as an Excel application.  Can you provide me code changes to fix the issue you address?  Much appreciated."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1536208542, "post_id": 52185243, "comment_id": 91342334, "body": "Thanks for your suggestion.  But I must be missing something.  No matter what I tried <code>wb_open.ActiveSheet.PasteSpecial...</code> is nothing in the cmdDone code. The suggested properties code compiles without error.  What suggestions do you have to find where the object is being dropped?  The object wb_open is open in the calling routine just before I load the <code>frmModeLessForInput</code> form."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 1, "last_activity_date": 1536158402, "last_edit_date": 1536158402, "creation_date": 1536150819, "answer_id": 52185243, "question_id": 52184835, "link": "https://stackoverflow.com/questions/52184835/how-do-i-pass-an-object-to-a-form/52185243#52185243", "title": "How do I pass an object to a form?", "body": "<p>This can be done by adding a new <code>Property</code> to your form.  In your form, add the following code:</p>\n\n<pre><code>Private m_Book As WorkBook\n\nPublic Property Get Book() As WorkBook\n   Set Book = m_Book\nEnd Property\n\nPublic Property Set Book(ByRef Value As WorkBook)\n   Set m_Book = Value\nEnd Property\n</code></pre>\n\n<p>Then in your calling code, add the Workbook you want to use, something like this:</p>\n\n<pre><code>Set frmModelessForInput.Book = wb_open\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>Set frmModelessForInput.Book = ActiveWorkbook\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1536416038, "post_id": 52232968, "comment_id": 91420762, "body": "I have modified my VBA code with your suggestions.  It compiles fine.  However, when I run it I get a runtime error on <code>Me.Book.ActiveSheet.PasteSpecial Format:=&quot;Text&quot;, Link:=False, DisplayAsIcon:=False, NoHTMLFormatting:=True</code> of &#39;Automation Error: The callee (server [not server application]) is not available and disappeared; all connections are invalid. The call may have executed.&#39;  Any ideas of the fix?"}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1536420428, "post_id": 52232968, "comment_id": 91421950, "body": "I also tried changing the form property declaration from &quot;object&quot; to &quot;workbook&quot; as suggested by Brian Stafford and received exactly the same error."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1536391144, "creation_date": 1536391144, "answer_id": 52232968, "question_id": 52184835, "link": "https://stackoverflow.com/questions/52184835/how-do-i-pass-an-object-to-a-form/52232968#52232968", "title": "How do I pass an object to a form?", "body": "<p>The basic problem is that the code in the question is not working with the correct Excel objects. Since everything to do with Excel is declared as data type <code>Object</code> VBA isn't able to provide more exact error messages - it's having to <em>guess</em> what is meant. It might help to set a reference to the Excel object library (Tools/References) and declare the exact data types until the code is working correctly. Then, if you want to use late-binding instead, the declarations can be changed to <code>Object</code>.</p>\n\n<p>Here are some examples of how the incorrect object types are being passed around, which is causing VBA to get confused.</p>\n\n<p>In the following procedure I've added an <code>Excel.Workbook</code> object declaration and instantiate it when the workbook is opened. Since the UserForm needs to work with a workbook object <em>this</em> is passed to <code>Select_Sentence_Form_Test</code>... </p>\n\n<pre><code>Sub Master_Module_Test()\n    Dim oExcel As Object\n    Dim wb As Excel.Workbook 'Object\n    Set oExcel = New Excel.Application\n    str_Excel_Filename = \"C:\\Test\\Excel_Template.xlsx\"\n    str_active_document = \"C\\Test\\Doc_to_process.docx\"\n    Documents.Open (str_active_document)\n\n    oExcel.Visible = True\n    oExcel.ScreenUpdating = True\n    Set wb = oExcel.Workbooks.Open(str_Excel_Filename)\n    Call Check_Excel_RTM_Template(oExcel)\n    i_how_many_sentences = 0\n    Call Select_Sentence_Form_Test(wb)\nEnd Sub\n</code></pre>\n\n<p>In the question in the code the <em>Excel application</em> is being passed and is being assigned to the <code>Book</code> property. VBA is allowing it because everything is typed as <code>Object</code>. But when it comes time to <em>use</em> the workbook, it doesn't work (logically not).</p>\n\n<pre><code>Sub Select_Sentence_Form_Test(wb_open As Object) 'As Excel.Workbook\n    Dim frm As frmModelessForInput\n    Set frm = New frmModelessForInput\n' Here is where I set the property of the frmModelessForInput to open Excel workbook as suggested in the response\n    Set frmModelessForInput.Book = wb_open\n    With frmModelessForInput\n        .str_word_doc_filename = str_active_document\n        .str_no_copied = \"0\"\n        .Show False\n    End With\n    Set frm = Nothing\nEnd Sub\n</code></pre>\n\n<p>Then <code>cmdDone_Click</code> does not work with the property <em>and</em> it tries to access <code>ActiveWorkbook</code> even though there's no <code>Excel.Application</code> object qualifier, nor available in this procedure. This is Word VBA, it doesn't \"know\" <code>ActiveWorkbook</code>.</p>\n\n<p>Instead, the code should use the <code>Book</code> property (that's why it was created, after all).</p>\n\n<pre><code>Private Sub cmdDone_Click()\n    Unload frmModelessForInput\n '  When the \"Done\" button is pressed the contents of the str_clipboard variable is copied to the Windows clipboard\n    Dim str_filename As String\n    str_filename = getName(str_Excel_Filename)\n    MsgBox \"I will now copy the data to the Excel file.\"\n'''        Dim wb_open As Object\n'''        Set wb_open = ActiveWorkbook 'can' work without Excel.Application\n    Call SendToClipboard(str_clipboard) 'This sub puts the contents of str_clipboard into the Windows clipboard\n    ' Uses the Book property \n    Me.Book.ActiveSheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False, NoHTMLFormatting:=True\n    MsgBox \"Done pasting data to: \" &amp; getName(str_Excel_Filename)\nEnd Sub\n</code></pre>\n\n<p>Note that I haven't tested this since it would take too much time to set up the environment.</p>\n"}], "owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536391144, "creation_date": 1536149550, "last_edit_date": 1536342462, "question_id": 52184835, "link": "https://stackoverflow.com/questions/52184835/how-do-i-pass-an-object-to-a-form", "title": "How do I pass an object to a form?", "body": "<p>I am working on a VBA script with Microsoft Word that allows the user to select text that will be be copied to the clipboard so that it can exported to an Excel file. The user will make a number of selections and finally indicate he/she is done when the contents of the clipboard will be copied to a template Excel file.</p>\n\n<p>The form <code>frmModelessForInput</code> allows the user to select text which is copied to a string variable (<code>str_clipboard</code>), press the \"Continue\" button to repeat selecting other text and then press \"Done\" when the text string is copied to the clipboard and then pasted to the Excel file opened earlier.  </p>\n\n<p>The problem is that when I try to paste the contents of the Windows clipboard to the Excel file in the cmdDone sub of the frmModelessForInput form the wb_open object gives me an error 91 about half the time. I had the same problem, I believe, in the Check_Excel_RTM_Template_Test sub and solved it by passing the oExcel object to sub.  I am trying to pass the oExcel object to the form but it is presenting the same error as with the previous sub even though I incorporated the Property for the form as suggested below.</p>\n\n<p>I have created the \"minimal\" code and have added comments to explain key tasks that each sub is accomplishing. I have run this code and it fails in the same manner as my \"production\" code.</p>\n\n<p>Thanks in advance for helping me solve my problem.</p>\n\n<p>Main Module</p>\n\n<pre><code>' This is the minimal master module where I open the Excel Template and Word document to process\nOption Explicit\nPublic str_clipboard As String\nPublic i_how_many_sentences, i_starting_row_ID As Integer\nPublic str_active_document As String\nPublic str_Excel_Filename As String\nPublic b_abort As Boolean\nPublic i_rows_of_data As Integer\n\n\nSub Master_Module_Test()\nDim oExcel As Object\nSet oExcel = New Excel.Application\nstr_Excel_Filename = \"C:\\Test\\Excel_Template.xlsx\"\nstr_active_document = \"C\\Test\\Doc_to_process.docx\"\nDocuments.Open (str_active_document)\n\noExcel.Visible = True\noExcel.ScreenUpdating = True \noExcel.Workbooks.Open str_Excel_Filename\nCall Check_Excel_RTM_Template(oExcel)\ni_how_many_sentences = 0\nCall Select_Sentence_Form_Test(oExcel)\nEnd Sub\n</code></pre>\n\n<p>Sub in main module</p>\n\n<pre><code>   ' This sub now works without errors\n    ' The calling routine passes the object oExcel....this approach works\n    ' Previously I didn't pass oExcel but used the following statements\n    ' Dim wb_open as Workbook\n    ' Set Wb_open = ActiveWorkBook\n    ' This also worked sometimes and failed about half the time\n\n    ' This sub checks the Excel file whether it is of the expected format and then selects the cell where the new data will be pasted\n    ' I have only included the statement to do the selection\n    ' This sub works without any errors\n    Sub Check_Excel_RTM_Template_Test(oExcel As Object)\n        oExcel.ActiveSheet.range(\"A6\").Select\n    End Sub\n</code></pre>\n\n<p>Sub in main module</p>\n\n<pre><code>' This sub activates the frmModelessForInput so that the user can select sentences; the form executes and works as expected\nSub Select_Sentence_Form_Test(wb_open As Object)\n    Dim frm As frmModelessForInput\n    Set frm = New frmModelessForInput\n' Here is where I set the property of the frmModelessForInput to open Excel workbook as suggested in the response \n    Set frmModelessForInput.Book = wb_open\n    With frmModelessForInput\n        .str_word_doc_filename = str_active_document\n        .str_no_copied = \"0\"\n        .Show False\n    End With\n    Set frm = Nothing\nEnd Sub\n</code></pre>\n\n<p>function to extract the filename from the full pathname.</p>\n\n<pre><code>Function getName(pf)\ngetName = Split(Mid(pf, InStrRev(pf, \"\\\") + 1), \".\")(0) &amp; \".xlsx\"\nEnd Function\n</code></pre>\n\n<p>frmModelessForInput form code</p>\n\n<pre><code>' Here I implemented the suggested property for the form \n' I changed the declaration to \"Object\" since oExcel in Master_Module_Test is declared as an object\nOption Explicit\nPrivate m_Book As Object\n\nPublic Property Get Book() As Object\n   Set Book = m_Book\nEnd Property\n\nPublic Property Set Book(ByRef Value As Object)\n   Set m_Book = Value\nEnd Property\n\n\n\n' This sub works without errors\nPrivate Sub cmdContinue_Click()\n    Dim str_clipboard_line As String\n    Dim i_row_number As Integer\n\n    ' When the \"Continue\" button is pressed the code selects the sentence at the cursor and adds the contents to str_clipboard variable\n    i_row_number = i_how_many_sentences + i_starting_row_ID\n    i_how_many_sentences = i_how_many_sentences + 1\n    Call Highlight_Sentence(str_clipboard_line, i_row_number)\n    frmModelessForInput.str_no_copied = i_how_many_sentences\n    str_clipboard = str_clipboard + str_clipboard_line\nEnd Sub\n\nPrivate Sub cmdDone_Click()\n    Unload frmModelessForInput\n '  When the \"Done\" button is pressed the contents of the str_clipboard variable is copied to the Windows clipboard\n    Dim str_filename As String\n    str_filename = getName(str_Excel_Filename)\n    MsgBox \"I will now copy the data to the Excel file.\"\n    Dim wb_open As Object\n    Set wb_open = ActiveWorkbook\n    Call SendToClipboard(str_clipboard) 'This sub puts the contents of str_clipboard into the Windows clipboard\n    ' The following statement works sometimes but other times it has runtime error 91: Object variable or With block variable not set\n    wb_open.ActiveSheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False, NoHTMLFormatting:=True\n    MsgBox \"Done pasting data to: \" &amp; getName(str_Excel_Filename)    \nEnd Sub\n\n\n' This sub works without errors\nPrivate Sub Highlight_Sentence_Test(clipboard As String, i_row_no As Integer)\n    Dim txt_sentence, txt_page_no As String \n    Dim txt_section_index As String\n    With Selection\n     ' Collapse current selection.\n     .Collapse\n     ' Expand selection to current sentence.\n     .Expand Unit:=wdSentence\n    End With\n    txt_sentence = Selection.Text\n    txt_page_no = Selection.Information(wdActiveEndPageNumber)\n'I Use tabs to line up data in the correct columns in template file\n    clipboard = i_row_no &amp; vbTab &amp; str_active_document &amp; vbTab &amp; txt_page_no &amp; vbTab &amp; vbTab &amp; vbTab &amp; vbTab &amp; txt_sentence &amp; vbCrLf\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 9806568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c38280fd3a2e7ca9aeca31188eea200?s=128&d=identicon&r=PG&f=1", "display_name": "AHMAD", "link": "https://stackoverflow.com/users/9806568/ahmad"}, "edited": false, "score": 0, "creation_date": 1536146808, "post_id": 52183992, "comment_id": 91317585, "body": "i need to delete the row if the value and alphabet is duplicate from the other"}, {"owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 1, "creation_date": 1536146823, "post_id": 52183992, "comment_id": 91317597, "body": "Welcome to the site! Please first try it on your own, and then post what you have."}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1536147276, "post_id": 52183992, "comment_id": 91317889, "body": "Excel has a built-in remove-duplicates feature. You might want to explore that feature."}, {"owner": {"reputation": 1, "user_id": 9806568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c38280fd3a2e7ca9aeca31188eea200?s=128&d=identicon&r=PG&f=1", "display_name": "AHMAD", "link": "https://stackoverflow.com/users/9806568/ahmad"}, "edited": false, "score": 0, "creation_date": 1536147659, "post_id": 52183992, "comment_id": 91318134, "body": "we cannot delete row 4 because the value is not the same eventhough the alphabet is duplicated"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9806568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c38280fd3a2e7ca9aeca31188eea200?s=128&d=identicon&r=PG&f=1", "display_name": "AHMAD", "link": "https://stackoverflow.com/users/9806568/ahmad"}, "edited": false, "score": 0, "creation_date": 1536149294, "post_id": 52184307, "comment_id": 91319233, "body": "i did try this solution but the thing is that i cannot select two columns. For exemple,if the value is on the columns C, i cannot delete the duplicate data"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 9806568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c38280fd3a2e7ca9aeca31188eea200?s=128&d=identicon&r=PG&f=1", "display_name": "AHMAD", "link": "https://stackoverflow.com/users/9806568/ahmad"}, "edited": false, "score": 0, "creation_date": 1536149581, "post_id": 52184307, "comment_id": 91319427, "body": "@ahmad Then you asked the wrong question and your example data is insufficient. Your example clearly states that your data is in column A and B. And my answer is exactly for the example in your question \u2022 Please edit your original question and clarify. Add an example of data that represents your actual data. \u2022 If your data is in column A and C then select A1 to C6 and remove duplicates. In the upcoming dialog choose column A and C then."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1536147708, "creation_date": 1536147708, "answer_id": 52184307, "question_id": 52183992, "link": "https://stackoverflow.com/questions/52183992/removing-duplicate-data/52184307#52184307", "title": "Removing duplicate data", "body": "<p>The manual solution is to select your desired range A1 to B6 and click <em>\"Remove Duplicates\"</em> of the menu <em>\"Data\"</em> \u00bb <em>\"Data Tools\"</em>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HTyTh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HTyTh.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>For further information see <a href=\"https://support.office.com/en-us/article/filter-for-unique-values-or-remove-duplicate-values-ccf664b0-81d6-449b-bbe1-8daaec1e83c2\" rel=\"nofollow noreferrer\">Filter for unique values or remove duplicate values</a>.</p>\n\n<p>If you need to automate this with VBA use the <a href=\"https://support.office.com/en-us/article/automate-tasks-with-the-macro-recorder-974ef220-f716-4e01-b015-3ea70e64937b\" rel=\"nofollow noreferrer\">Macro Recorder</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9806568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c38280fd3a2e7ca9aeca31188eea200?s=128&d=identicon&r=PG&f=1", "display_name": "AHMAD", "link": "https://stackoverflow.com/users/9806568/ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1556263676, "creation_date": 1536146661, "last_edit_date": 1556263676, "question_id": 52183992, "link": "https://stackoverflow.com/questions/52183992/removing-duplicate-data", "title": "Removing duplicate data", "body": "<p>The objective is to remove duplicate data. In the image, I need to delete rows 5 and 6 but not row 4 because the value is different.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yOglB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yOglB.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "loops", "transpose"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1536148322, "post_id": 52183920, "comment_id": 91318597, "body": "Depends what your requirement is. If you are happy to have the values in text format, simple solution would be to add apostrophe at the start and excel will take your values as text and wont change anything. On the other hand, if you want it in date format.. bit more complicated"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1536148721, "post_id": 52183920, "comment_id": 91318845, "body": "Dates are in fact integer values, so it&#39;s simply a matter of changing the numberformat of the target cell. Small note - your <code>With Wf</code> is obsolete, you only reference it once in the whole block."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1536174453, "post_id": 52184904, "comment_id": 91333520, "body": "Okay, I must correct what I wrote. It doesn&#39;t change the format, it just swaps date and month, but it will then show as the 8th of February. No matter how many times I&#39;ll try to change the format, it will still be the 8th of February."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1536180327, "post_id": 52184904, "comment_id": 91336038, "body": "@Patrick S - try the 2 snippets I wrote, the first one literally does what you are saying."}, {"owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1536218632, "post_id": 52184904, "comment_id": 91346296, "body": "I just cannot see how it should work, since you name the strings as &quot;02/08/2018&quot;. It won&#39;t be that every time, next month it will be 06-09-2018 turning into 09-06-2018, and the month after that another one again."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1536218748, "post_id": 52184904, "comment_id": 91346357, "body": "@PatrickS - try it twice. The first piece replicates exactly the problem you are facing."}, {"owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1536218904, "post_id": 52184904, "comment_id": 91346441, "body": "Meaning that 02-08-2018 is just to show VBA, how it should be &quot;formatted&quot;? How would you then put it in? Before I transpose the 3 cells? :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1536219184, "post_id": 52184904, "comment_id": 91346572, "body": "@PatrickS - the transpose does not have to do with it. Have you tried copy+paste the code above?"}, {"owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1536219513, "post_id": 52184904, "comment_id": 91346735, "body": "The transpose is made, since my loop stores the unique lines within the transpose. The perfect thing about the transpose, is that my loop &quot;vR()&quot; stores the unique values from date to amount. Meaning that the transpose just inserts the values I need on the other sheet. But if I understand you correctly, your suggestion is that I drop the transpose, and add something to my loop that whenever it finds a unique value, it should copy from date to amount and insert it on the other sheet?"}, {"owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1536219584, "post_id": 52184904, "comment_id": 91346769, "body": "On the other hand, the one sheet, that the has all of my data (Date, ColB, Amount etc.), has the right date, but whenever I transpose it, it converts into what I&#39;ve described above."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1536220718, "post_id": 52184904, "comment_id": 91347431, "body": "@PatrickS - the issue with the date, that is faced is irrelevant to the transpose. E.g., the first part of the code I have posted replicates it completely. If you try to solve it locally, then you can build up later with transpose and etc."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1536149785, "creation_date": 1536149785, "answer_id": 52184904, "question_id": 52183920, "link": "https://stackoverflow.com/questions/52183920/month-and-day-in-a-date-are-sometimes-reversed-when-copied-in-excel/52184904#52184904", "title": "Month and Day in a Date are Sometimes Reversed when Copied in Excel", "body": "<p>Replicating the problem with minimal code:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim val1 As String: val1 = \"02/08/2018\"\n    Dim val2 As String: val2 = \"13/08/2018\"\n    Dim myInput1 As Date\n    Dim myInput2 As Date\n\n    myInput1 = val1\n    myInput2 = val2\n\n    Range(\"A1\") = myInput1\n    Range(\"A2\") = myInput2\n\nEnd Sub\n</code></pre>\n\n<p>Gets this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1SyEq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1SyEq.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>One possible solution is using <code>DateSerial()</code>:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim val1 As String: val1 = \"02/08/2018\"\n    Dim val2 As String: val2 = \"13/08/2018\"\n    Dim myInput1 As Date\n    Dim myInput2 As Date\n\n    myInput1 = DateSerial(Split(val1, \"/\")(2), Split(val1, \"/\")(1), Split(val1, \"/\")(0))\n    myInput2 = DateSerial(Split(val2, \"/\")(2), Split(val2, \"/\")(1), Split(val2, \"/\")(0))\n\n    Range(\"A1\") = myInput1\n    Range(\"A2\") = myInput2\n\nEnd Sub\n</code></pre>\n\n<p>For some advanced solution, you may consider either writing a customized function or changing a bit the regional settings. The latter is dangerous.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8930387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CT8fa.jpg?s=128&g=1", "display_name": "Caius_Cosades", "link": "https://stackoverflow.com/users/8930387/caius-cosades"}, "is_accepted": false, "score": 0, "last_activity_date": 1536154127, "creation_date": 1536154127, "answer_id": 52186362, "question_id": 52183920, "link": "https://stackoverflow.com/questions/52183920/month-and-day-in-a-date-are-sometimes-reversed-when-copied-in-excel/52186362#52186362", "title": "Month and Day in a Date are Sometimes Reversed when Copied in Excel", "body": "<p>It depends on your local settings. Anyway, macro doesn't look into local at all.\nSo you can overpass it by using format function.\nFor example:</p>\n\n<pre><code>val1=\"02/08/2018\"\nval2=format(cdate(val1),\"ddmmyyyy\"))\n</code></pre>\n\n<p>It's gonna work</p>\n"}, {"tags": [], "owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1536329085, "creation_date": 1536329085, "answer_id": 52224191, "question_id": 52183920, "link": "https://stackoverflow.com/questions/52183920/month-and-day-in-a-date-are-sometimes-reversed-when-copied-in-excel/52224191#52224191", "title": "Month and Day in a Date are Sometimes Reversed when Copied in Excel", "body": "<p><strong>I found a solution myself.</strong></p>\n\n<p>First of all, thank you for you efforts, but I couldn't really get myself to try them, since I needed to change to much in my formula...</p>\n\n<p>Before looping through the cells, I removed the date format from the date columns.\nWhereas turning it into to general, the transpose won't swap the numbers around.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>RngNavRange = \"A3:A\" &amp; LastRowA\r\nRngKvikRange = \"F3:F\" &amp; LastRowF\r\n\r\nRange(RngNavRange).NumberFormat = \"General\"\r\nRange(RngKvikRange).NumberFormat = \"General\"</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1331, "favorite_count": 0, "accepted_answer_id": 52224191, "answer_count": 3, "score": 1, "last_activity_date": 1536329085, "creation_date": 1536146460, "last_edit_date": 1536176429, "question_id": 52183920, "link": "https://stackoverflow.com/questions/52183920/month-and-day-in-a-date-are-sometimes-reversed-when-copied-in-excel", "title": "Month and Day in a Date are Sometimes Reversed when Copied in Excel", "body": "<p><strong>My Problem:</strong>  </p>\n\n<p>I have made a For Each loop, which Loops through 2 different columns in the same sheet.<br>\nThis loop copies the desired columns, and the unique values.<br>\nAlthought the macro works, it will paste a wrong date.<br>\nHow it pastes a wrong date, is specified under the section \"Goal:\".</p>\n\n<p><strong>My Table:</strong></p>\n\n<p><code>|    Date    |    ColB     |    Amount   |    Date    |    ColG     |    Amount   |</code><br>\n<code>| 02-08-2018 |   V584753   |     500     | 02-08-2018 |   V584753   |     -500    |</code><br>\n<code>| 11-08-2018 |   486542    |    1.000    | 21-08-2018 |   439857    |   -30.547   |</code><br>\n<code>| 21-08-2018 |   439857    |   30.547    | 31-08-2018 |   V587742   |    -1.059   |</code></p>\n\n<p><strong>My Code:</strong></p>\n\n<pre><code>Sub PasteCellsWithoutMatch()\n\nDim ColB As Range, ColG As Range, c As Range\nDim Wf As WorksheetFunction\nSet Wf = WorksheetFunction\nDim vR() As Variant\nDim k As Long, j As Integer\n\nFor Each c In ColB.Cells\n    If Not IsEmpty(c) Then\n        With Wf\n            n = .CountIfs(ColG, c)\n            If n = 0 Then\n                k = k + 1\n                ReDim Preserve vR(1 To 3, 1 To k)\n                For j = 1 To 3\n                    vR(j, k) = c.Offset(0, j - 2)\n                Next j\n            End If\n        End With\n    End If\nNext\n\nSheet(\"Match\").Range(\"A1\").Resize(k, 3) = Wf.Transpose(vR)\n</code></pre>\n\n<p><strong>Goal:</strong></p>\n\n<p>What I mean by \"pasting the wrong date\", the code will swaps the \"dd-mm-yyyy\" to \"mm-dd-yyyy\" whenever the first value is below 12.</p>\n\n<p>Meaning that: 02-08-2018<br>\nBecomes: <strong>08-02-2018</strong>  </p>\n\n<p>Whereas: 13-08-2018<br>\nRemains: <strong>13-08-2018</strong></p>\n\n<p>How can I correct this error?<br>\nIf there is any correction to it.</p>\n\n<p><em>Thank you in advance, for your help.</em></p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3662, "user_id": 1281901, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3785ec1489202606b4526c29a4e148b?s=128&d=identicon&r=PG", "display_name": "bendataclear", "link": "https://stackoverflow.com/users/1281901/bendataclear"}, "edited": false, "score": 1, "creation_date": 1536146635, "post_id": 52183883, "comment_id": 91317501, "body": "A function sounds possible, I&#39;ll take the performance hit over having hundreds of strings scattered all over my code!"}, {"owner": {"reputation": 3662, "user_id": 1281901, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3785ec1489202606b4526c29a4e148b?s=128&d=identicon&r=PG", "display_name": "bendataclear", "link": "https://stackoverflow.com/users/1281901/bendataclear"}, "edited": false, "score": 0, "creation_date": 1536150514, "post_id": 52183883, "comment_id": 91320025, "body": "This was a bit fiddly to setup but worked, performance hit is very low, thank you."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1536146361, "creation_date": 1536146361, "answer_id": 52183883, "question_id": 52183708, "link": "https://stackoverflow.com/questions/52183708/defining-complex-static-data-in-vba/52183883#52183883", "title": "Defining complex static data in VBA", "body": "<p>No, this can't be done. For one, this: <code>Public Const g_Columns As Variant = Array(\"1\", \"2\", \"3\")</code> already doesn't work. <code>Array()</code> is a function. You can't have constant arrays.</p>\n\n<p>VBA only supports simple data types as constants.</p>\n\n<p>You can use a function that returns your constant instead of a constant, and accept the minor performance hit your application will take.</p>\n"}], "owner": {"reputation": 3662, "user_id": 1281901, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3785ec1489202606b4526c29a4e148b?s=128&d=identicon&r=PG", "display_name": "bendataclear", "link": "https://stackoverflow.com/users/1281901/bendataclear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 52183883, "answer_count": 1, "score": 1, "last_activity_date": 1536146361, "creation_date": 1536145856, "question_id": 52183708, "link": "https://stackoverflow.com/questions/52183708/defining-complex-static-data-in-vba", "title": "Defining complex static data in VBA", "body": "<p>I have an MS Access project where I am trying to define a lot of static data, I have details to load into a single very complex form.</p>\n\n<p>I have setup types for this data:</p>\n\n<pre><code>Public Type ColumnData\n\n    Name As String\n    Width As Single\n    Search As String * 1\n\nEnd Type\n\nPublic Type FormData\n    Form_Title As String\n    View_Name As String\n    Edit_Form As String\n    ObjectSingular As String\n    ObjectPlural As String\n    Columns() As ColumnData\nEnd Type\n</code></pre>\n\n<p>Is there a way I can add this data to a global variable in a module? The same way I would with basic data types:</p>\n\n<pre><code>Public Const g_LoggedIn As Boolean = False\nPublic Const g_APIKey As String = \"ABC123\"\nPublic Const g_TablePrefix as String = \"auyhso_\"\nPublic Const g_Columns As Variant = Array(\"1\", \"2\", \"3\")\n</code></pre>\n\n<p>Something like:</p>\n\n<pre><code>Public g_FormData as Collection\ng_FormData.Add New FormData(Form_Title:=\"My Title\", View_Name:=\"My View\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "checkbox", "userform"], "comments": [{"owner": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 1, "creation_date": 1536146894, "post_id": 52183404, "comment_id": 91317647, "body": "What&#39;s the problem with using <code>.Shapes(ws.Name)</code>?"}, {"owner": {"reputation": 180, "user_id": 8584483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e38bf2f14cb8bc6768d791ca19fc452?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/8584483/george"}, "reply_to_user": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 0, "creation_date": 1536148134, "post_id": 52183404, "comment_id": 91318464, "body": "&quot;Object doesn&#39;t support this property or method&quot;"}, {"owner": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 0, "creation_date": 1536148259, "post_id": 52183404, "comment_id": 91318547, "body": "Well, we don&#39;t see in your code where <code>ws</code> comes from. Where and how is <code>ws</code> initialized?"}, {"owner": {"reputation": 180, "user_id": 8584483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e38bf2f14cb8bc6768d791ca19fc452?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/8584483/george"}, "reply_to_user": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 0, "creation_date": 1536149874, "post_id": 52183404, "comment_id": 91319585, "body": "I have updated the code, so you can see more easily what I have done/ what I am trying to do. I have tried changing the Shapes(ws.Name) to CheckBoxes(ws.Name)... but i still get an error message: &quot;Unable to get the checkboxes property of the worksheet class&quot;"}, {"owner": {"reputation": 180, "user_id": 8584483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e38bf2f14cb8bc6768d791ca19fc452?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/8584483/george"}, "reply_to_user": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 0, "creation_date": 1536317588, "post_id": 52183404, "comment_id": 91390454, "body": "I have again updated the code, I am pretty convinced there is nothing wrong with the loops etc. The only thing I can think is that the following doesn&#39;t work for form control checkboxes (only for ActiveX).   <code>CheckBox.name = ws.name Then             If CheckBox.Value = False Then                 ClearContent = True</code>"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1536331399, "post_id": 52183404, "comment_id": 91398838, "body": "What is it that you selected and that should be deleted?"}], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 8584483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e38bf2f14cb8bc6768d791ca19fc452?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/8584483/george"}, "edited": false, "score": 0, "creation_date": 1536146141, "post_id": 52183740, "comment_id": 91317221, "body": "Is there a way to replicate this for form control checkboxes?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 180, "user_id": 8584483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e38bf2f14cb8bc6768d791ca19fc452?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/8584483/george"}, "edited": false, "score": 0, "creation_date": 1536151516, "post_id": 52183740, "comment_id": 91320618, "body": "@George I&#39;ve updated my answer to do the same with Form Controls, hope this helps.. .:)"}, {"owner": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 0, "creation_date": 1536332179, "post_id": 52183740, "comment_id": 91399325, "body": "Comapring <code>Value</code> with <code>False</code> will not work. One has to use the <code>xlOff</code> constant instead."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1536151536, "last_edit_date": 1536151536, "creation_date": 1536145962, "answer_id": 52183740, "question_id": 52183404, "link": "https://stackoverflow.com/questions/52183404/dynamically-checking-for-checkboxes-with-the-same-name-as-worksheets-vba-excel/52183740#52183740", "title": "Dynamically Checking for Checkboxes with the same name as Worksheets -VBA Excel", "body": "<p>The following code below will show you how to loop through ActiveX checkboxes on your worksheet and verify whether they are checked or unchecked:</p>\n\n<pre><code>Sub Test()\n    Dim obj As OLEObject\n\n    For Each obj In Sheets(\"Summary\").OLEObjects\n    'loop through ActiveX Checkboxes on Worksheet \"Summary\"\n        If obj.progID = \"Forms.CheckBox.1\" Then\n        'is it a Checkbox?\n            If obj.Object = False Then\n            'is the checkbox unchecked\n                ClearContent = True\n            End If\n        End If\n    Next obj\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong>\nFor Form Control Checkboxes the following will do:</p>\n\n<pre><code>Sub Test2()\n    Dim cb As CheckBox\n\n    For Each cb In Sheets(\"Summary\").CheckBoxes\n        If cb.Value = False Then\n            ClearContent = True\n        End If\n    Next cb\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 180, "user_id": 8584483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e38bf2f14cb8bc6768d791ca19fc452?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/8584483/george"}, "edited": false, "score": 0, "creation_date": 1536147184, "post_id": 52183957, "comment_id": 91317824, "body": "How would I go about doing this?"}, {"owner": {"reputation": 99, "user_id": 2377055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96568fb5a00599ba633e7037a35a97d5?s=128&d=identicon&r=PG", "display_name": "matley", "link": "https://stackoverflow.com/users/2377055/matley"}, "reply_to_user": {"reputation": 180, "user_id": 8584483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e38bf2f14cb8bc6768d791ca19fc452?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/8584483/george"}, "edited": false, "score": 0, "creation_date": 1536148564, "post_id": 52183957, "comment_id": 91318739, "body": "<code>code</code> Private Sub CheckBox1_Click()         ClearContent = IIf(CheckBox1.Value, True, False)     End Sub"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1536148767, "post_id": 52183957, "comment_id": 91318880, "body": "@matley I would recommend modifying your answer to include the code contained in your comment."}, {"owner": {"reputation": 180, "user_id": 8584483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e38bf2f14cb8bc6768d791ca19fc452?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/8584483/george"}, "edited": false, "score": 0, "creation_date": 1536150325, "post_id": 52183957, "comment_id": 91319887, "body": "The problem is with that, I have lots of checkboxes and even if I wanted to code manually for each one, I have a system in place where someone can add a new sheet and it automatically generates a new checkbox with the caption/name of the new worksheet, so i guess I would need to write a new bit of code to loop accross all of the checkboxes to change their properties?"}, {"owner": {"reputation": 99, "user_id": 2377055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96568fb5a00599ba633e7037a35a97d5?s=128&d=identicon&r=PG", "display_name": "matley", "link": "https://stackoverflow.com/users/2377055/matley"}, "edited": false, "score": 0, "creation_date": 1536154454, "post_id": 52183957, "comment_id": 91322604, "body": "Try <code>ActiveWorkbook.Sheets(&quot;Summary&quot;).Shapes(ws.name).OLEFormat.O&zwnj;&#8203;bject.Value</code> instead of <code>ActiveWorkbook.Sheets(&quot;Summary&quot;).CheckBoxes(ws.name).Value</code>"}], "tags": [], "owner": {"reputation": 99, "user_id": 2377055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96568fb5a00599ba633e7037a35a97d5?s=128&d=identicon&r=PG", "display_name": "matley", "link": "https://stackoverflow.com/users/2377055/matley"}, "is_accepted": false, "score": 1, "last_activity_date": 1536146568, "creation_date": 1536146568, "answer_id": 52183957, "question_id": 52183404, "link": "https://stackoverflow.com/questions/52183404/dynamically-checking-for-checkboxes-with-the-same-name-as-worksheets-vba-excel/52183957#52183957", "title": "Dynamically Checking for Checkboxes with the same name as Worksheets -VBA Excel", "body": "<p>Your code definitely treat \"ws.name\" as literal string because it is enclosed in double quotes. You can directly set <em>ClearContent</em> variable to true or false upon clicking the Checkbox. This way you don't have to test its value.</p>\n"}, {"tags": [], "owner": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "is_accepted": true, "score": 1, "last_activity_date": 1536330812, "last_edit_date": 1536330812, "creation_date": 1536330188, "answer_id": 52224549, "question_id": 52183404, "link": "https://stackoverflow.com/questions/52183404/dynamically-checking-for-checkboxes-with-the-same-name-as-worksheets-vba-excel/52224549#52224549", "title": "Dynamically Checking for Checkboxes with the same name as Worksheets -VBA Excel", "body": "<p>There are two problems with your code:</p>\n\n<h2>Aspect 1: Name or Text?</h2>\n\n<p>What I think might be a problem here is understanding what the name of a checkbox is in Excel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tvrrJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tvrrJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>The text you see besides the checkbox is not the actual name of the checkbox. You can give the checkbox a name by selecting it with a right mouse click and entering the desired name in the top left box for selection name.</p>\n\n<p>Use this sample code to see the names and display texts your checkboxes actually use:</p>\n\n<pre><code>For Each CheckBox In Sheets(\"Summary\").CheckBoxes\n    MsgBox \"Name: \" &amp; CheckBox.Name &amp; \" Text: \" &amp; CheckBox.Text\nNext CheckBox\n</code></pre>\n\n<p>It will produce something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4Do5g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Do5g.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I am correct, to solve your problem you have to either give the checkboxes the correct name (the names of the worksheets) or instead of comparing <code>Name</code>, compare using the <code>Text</code> property of the checkbox.</p>\n\n<h2>Aspect 2: Value is not true / false</h2>\n\n<p>The value of the checkbox is not <code>True</code> or <code>False</code>, but the checkbox value can be either <code>xlOn</code> or <code>xlOff</code>. So, don't test for <code>True</code> or <code>False</code>, but use the correct constants.</p>\n\n<h2>Working code using displayed Text instead of Name and using correct value constants</h2>\n\n<pre><code>Dim ws As Worksheet\nDim ClearContent  As Boolean\nDim CheckBox As CheckBox\n\nFor Each ws In ActiveWorkbook.Worksheets\n\n    ' Reset ClearContent for each Sheet\n    ClearContent = False\n\n    For Each CheckBox In Sheets(\"Summary\").CheckBoxes\n        ' Depending on your requests, compare either with Name or with Text\n        If CheckBox.Text = ws.Name Then\n            ' Use xlOff constant instead of False\n            If CheckBox.Value = xlOff Then\n                ClearContent = True\n            End If\n\n            ' We can exit the foreach loop when we found the correct checkbox\n            Exit For\n        End If\n    Next CheckBox\n\n    If ClearContent Then\n        MsgBox \"Going to clear \" &amp; ws.Name\n    End If\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 8584483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e38bf2f14cb8bc6768d791ca19fc452?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/8584483/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 972, "favorite_count": 0, "accepted_answer_id": 52224549, "answer_count": 3, "score": 1, "last_activity_date": 1536330812, "creation_date": 1536144884, "last_edit_date": 1536152613, "question_id": 52183404, "link": "https://stackoverflow.com/questions/52183404/dynamically-checking-for-checkboxes-with-the-same-name-as-worksheets-vba-excel", "title": "Dynamically Checking for Checkboxes with the same name as Worksheets -VBA Excel", "body": "<p>I am on excel, I have about 30 UserForm checkboxes, each of the checkboxes are located on a page called \"Summary\" in a big column. Each of which corresponds to a worksheet. I am attempting to loop through these checkboxes to see which are ticked and not ticked. I have put some code within a loop of all worksheets, this is the bit that is not working:</p>\n\n<pre><code>  Private Sub Run_Click()\nDim SummaryFirstBlankRow As Integer\nDim LastRow As Integer\nDim LastRowH As Integer\nDim rng As Range\nDim SumOfHours As Variant\nDim EndLoop As Boolean\nDim DupeRowNo As Integer\nDim RowNo2 As Integer\nDim ClearContent As Boolean\nDim cbtrue As Boolean\nDim ws As Worksheet\n\n\ncbtrue = False\n    For Each ws In ActiveWorkbook.Worksheets\n\n\n\n        LastRowH = ws.Cells(Rows.Count, 8).End(xlUp).Offset(1, 0).Row\n\n\n    'If ActiveWorkbook.Sheets(\"Summary\").CheckBoxes(ws.name).Value = False Then ' looks to see if ws.names' checkbox is checked or not\n     '               ClearContent = True 'if not checked, sets clear content to true\n    'End If\n\n    For Each CheckBox In Sheets(\"Summary\").CheckBoxes\n        If CheckBox.name = ws.name Then\n            If CheckBox.Value = False Then\n                ClearContent = True\n            End If\n        End If\n    Next CheckBox\n        If ClearContent = True Then\n            For c = 1 To LastRowH   'if not checked, looks on current worksheet (within loop) and if any \"Y\" or \"y\" vals, clears them\n                If ws.Range(\"H\" &amp; c).Value = \"Y\" Or ws.Range(\"H\" &amp; c).Value = \"y\" Then\n                    ws.Range(\"H\" &amp; c).ClearContents\n                End If\n            Next\n        End If\n    ...\n</code></pre>\n\n<p>cbtrue is just a variable to see if the checkbox exists, hence if it does it will then go to the if statement, at which point it will determine whether that checkbox is ticked or not, depending on this it saves the ClearContent variable (which I use later on in the code).</p>\n\n<p>The problem is when it comes to 'Shapes(\"ws.Name\")', ws.name is simply the name of the worksheet on each loop. So on the first round of the loop, it will be \"Summary\"... However, I think it is physically searching for the sheet \"ws.name\" which obviously doesn't exist. I have tried removing it from the quotation marks and also various other methods such as 'Checkboxes(\"ws.Name\")' but it seems they all have the same problem.</p>\n\n<p>I am posting to see if someone could offer me another method, or perhaps show me where I have gone wrong, as I think I am not fully understanding the syntax.</p>\n\n<p>Any Help is appreciated. Thanks in advance :)</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I have changed the code with the help of @Xabier (I have added in an extra if statement to ensure that the CheckBox has the same name as the worksheet. I am now getting no errors, but when i run it, it isn't clearing the contents of any of the cells i requested. I cannot seem to spot why it is doing this, If anyone could spot it and let me know, that'd be great. Thanks :) </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1536143849, "post_id": 52182982, "comment_id": 91315853, "body": "You might be able to access them through<code>Me.Controls</code> - example: <a href=\"https://stackoverflow.com/q/25423755/2877364\">stackoverflow.com/q/25423755/2877364</a>  (I suspect there&#39;s a better dupe but am not finding it at the moment)"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1536144265, "post_id": 52182982, "comment_id": 91316097, "body": "Another candidate, but not check boxes - <a href=\"https://stackoverflow.com/a/40816151/2877364\">stackoverflow.com/a/40816151/2877364</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1536150114, "post_id": 52183287, "comment_id": 91319752, "body": "How do I assign the Caption to the ctrl @ FInal &amp; ctrl.Caption? In other words, how to ensure that me.CheckBox7 is assigned to string Val7?"}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1536150664, "post_id": 52183287, "comment_id": 91320108, "body": "To elaborate my comment - caption is what I show the users. But to each checkbox - I have to assign another value (SQL string) to that checkbox. This is why I was assigning Me.CheckBox1 = Val1..."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1536151379, "post_id": 52183287, "comment_id": 91320524, "body": "@OdaySalim I&#39;ve updated my answer to let you add the values to an array, hope that helps.. :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 3, "last_activity_date": 1536151354, "last_edit_date": 1536151354, "creation_date": 1536144482, "answer_id": 52183287, "question_id": 52182982, "link": "https://stackoverflow.com/questions/52182982/loop-through-checkboxes-to-see-which-ones-are-checked/52183287#52183287", "title": "Loop through checkboxes to see which ones are checked", "body": "<p>I believe the following will do what you expect:</p>\n\n<pre><code>Private Sub Submit_Click()\nDim Final As String\nDim ctrl As Control\n\nFor Each ctrl In Me.Controls\n'loop through controls in your UserForm\n If TypeName(ctrl) = \"CheckBox\" Then 'if control is a CheckBox then\n    If ctrl.Value = True Then 'if the checkbox is checked\n        Final = Final &amp; ctrl.Caption 'add the caption to the variable\n    End If\n End If\nNext ctrl\n\nMsgBox (Final)\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>If what you need is to assign the caption of the given checkbox to a variable, you can do so like below, using an Array to store values for each checkbox, this example will only store values for checkboxes that are checked:</p>\n\n<pre><code>Private Sub Submit_Click()\nDim Final() As String\nDim ctrl As Control\nDim counter As Integer\n\ncounter = 0\nFor Each ctrl In Me.Controls\n'loop through controls in your UserForm\ncounter = counter + 1\nReDim Preserve Final(counter)\n If TypeName(ctrl) = \"CheckBox\" Then 'if control is a CheckBox then\n    If ctrl.Value = True Then 'if the checkbox is checked\n        Final(counter) = ctrl.Caption 'add the caption to the variable\n    End If\n End If\nNext ctrl\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1496, "favorite_count": 0, "accepted_answer_id": 52183287, "answer_count": 1, "score": 1, "last_activity_date": 1536151354, "creation_date": 1536143535, "question_id": 52182982, "link": "https://stackoverflow.com/questions/52182982/loop-through-checkboxes-to-see-which-ones-are-checked", "title": "Loop through checkboxes to see which ones are checked", "body": "<p>I have a userform that contains 10x check boxes.</p>\n\n<p>Each of these check boxes should have a value. Say check box 1 should contain value \"Medicine\", check box 2 should contain value \"Water\".</p>\n\n<p>I am giving the users the option to check any of these and press submit. On pressing submit, I would like to check which check boxes were ticked and combine the values.</p>\n\n<p>I.e. if user ticks only check box 1 and 2, then the output will be \"MedicineWater\".</p>\n\n<p>Rather than doing 10 nested IF statements and then doing all the possible permutations, which would take very long. I wonder if it is possible to loop through the check boxes and see which one is ticked (marked as True) and then store the value that should be assigned to it.</p>\n\n<p>My simplified code is:</p>\n\n<pre><code>Private Sub Submit_Click()\nDim i as Long\nDim Val1 as String\nDim Val2 as String\nDim Array()\nDim Final as String\n\nVal1 = \"Medicine\"\nVal2 = \"Water\"\n\nFor i = 1 to 2\n   If Me.CheckBox &amp; i  = True Then\n      Array = Val &amp; i\n      Final = Join(Array, \"\")\n   End If\nNext i\n\nMsgbox (Final)\nEnd Sub\n</code></pre>\n\n<p>Can someone please advise me how to do this properly?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "replace"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1536181170, "post_id": 52182638, "comment_id": 91336359, "body": "so you want to loop thru materials in sheet2 and if there is a match paste the material description under material in sheet2?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1536181476, "post_id": 52182638, "comment_id": 91336474, "body": "your code does not do much, it just finds the range of the headers, which is not crucial, do you have many rows like 10k or sth? You need to simplify the question and step by step, this is not a difficult code, but since you have asked for 1-2-3 etc members did not get involved with much of work that you are demanding"}, {"owner": {"reputation": 171, "user_id": 8462345, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6vLxu.jpg?s=128&g=1", "display_name": "El_1988", "link": "https://stackoverflow.com/users/8462345/el-1988"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1536214116, "post_id": 52182638, "comment_id": 91344167, "body": "@Ibo thanks for the feedback, I edited and added a simple example which should clarify the code&#39;s use and output, I have 10k+ columns and over 30 rows, but as the code is to be generalized to sheets with columns containing those headers, I need to do it in VBA"}, {"owner": {"reputation": 171, "user_id": 8462345, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6vLxu.jpg?s=128&g=1", "display_name": "El_1988", "link": "https://stackoverflow.com/users/8462345/el-1988"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1536215973, "post_id": 52182638, "comment_id": 91345011, "body": "@Ibo sorry, 30 columns and 10k+ rows"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1536254421, "post_id": 52182638, "comment_id": 91367839, "body": "@EI_1988 you have many rows so it is better to use arrays and dictionaries to make it a lot faster. I assume all of your headers in all of the sheets are in ROW 1 and all of these specific columns are column 1,2,3 or they are in different columns that should be found first?"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 8462345, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6vLxu.jpg?s=128&g=1", "display_name": "El_1988", "link": "https://stackoverflow.com/users/8462345/el-1988"}, "is_accepted": true, "score": 0, "last_activity_date": 1536240806, "creation_date": 1536240806, "answer_id": 52205291, "question_id": 52182638, "link": "https://stackoverflow.com/questions/52182638/vba-merge-tables-in-sheets-based-on-identifier-column-in-specified-sheet/52205291#52205291", "title": "VBA, Merge Tables in sheets based on identifier column in specified sheet", "body": "<p>I was able to do by using the code in the following link contributed by Mumps:</p>\n\n<p><a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/138286-vba-to-join-tables-with-unique-key-in-first-column\" rel=\"nofollow noreferrer\">https://www.ozgrid.com/forum/forum/help-forums/excel-general/138286-vba-to-join-tables-with-unique-key-in-first-column</a></p>\n\n<pre><code>Sub CopyRange()\nApplication.ScreenUpdating = False\nDim LastRow As Long\nLastRow = Sheets(\"OCData\").Cells.Find(\"*\", SearchOrder:=xlByRows,      SearchDirection:=xlPrevious).Row\nDim ID As Range\nDim foundID As Range\nFor Each ID In Sheets(\"OCData\").Range(\"C2:C\" &amp; LastRow)\n    Set foundID = Sheets(\"NamesList\").Range(\"B:B\").Find(ID, LookIn:=xlValues, lookat:=xlWhole)\n    If Not foundID Is Nothing Then\n        Sheets(\"NamesList\").Range(\"B\" &amp; foundID.Row &amp; \":E\" &amp; foundID.Row).Copy Sheets(\"OCData\").Range(\"J\" &amp; ID.Row)\n    End If\nNext ID\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Awesome code, saved me loads of time.</p>\n"}], "owner": {"reputation": 171, "user_id": 8462345, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6vLxu.jpg?s=128&g=1", "display_name": "El_1988", "link": "https://stackoverflow.com/users/8462345/el-1988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 52205291, "answer_count": 1, "score": 0, "last_activity_date": 1536240806, "creation_date": 1536142481, "last_edit_date": 1536233728, "question_id": 52182638, "link": "https://stackoverflow.com/questions/52182638/vba-merge-tables-in-sheets-based-on-identifier-column-in-specified-sheet", "title": "VBA, Merge Tables in sheets based on identifier column in specified sheet", "body": "<p>I am new to VBA. I have two sheets containing two Tables sheet 1 is a glossary of abbreviations in a column under header \"Material\" and the descriptions in a column under header \"Material Description\". Sheet 2 is a data set containing a column under header \"Customer Names\", a column under header \"Material\", and a column under header \"Invoiced Values\". </p>\n\n<p>Example:</p>\n\n<pre><code>Sheet 1      \nMaterial    Material Description\n   X               Hot\n   B               Cold\n   C               Temp\n-------------------------------------\nSheet 2       \nMaterial       Invoice Value\n   X               2.7645  \n   X               3.9\n   B               4.6\n</code></pre>\n\n<p>Desired output:</p>\n\n<pre><code>Sheet 3\nMaterial        Invoice Value\n   Hot               2.7645  \n   Hot               3.9\n  Cold               4.6\n</code></pre>\n\n<p>I am trying to:</p>\n\n<ol>\n<li>Find columns with specified headers in respective sheets</li>\n<li>For each row column \"Material\" of sheet 1, find the \"Material\" in  sheet 2 that corresponds to same \"Material\" in sheet 1</li>\n<li>Replace the text in the row of column \"Material\" in sheet 2, with the corresponding value of \"Material Description\" in sheet 1</li>\n</ol>\n\n<p>For item 1 I have gotten as far as :</p>\n\n<pre><code>Sub Replace()\n\n    Dim startrow As Long\n    Dim custrng As Range\n    Dim matdatrng As Range\n    Dim valrng As Range\n    Dim dscrng As Range\n    Dim matname As Range\n\n    startrow = 2\n\n    Set rcustrng = Worksheets(\"Data\").UsedRange.Find(\"Customer Name\", , xlValues, xlWhole)\n    Set matdatrng = Worksheets(\"Data\").UsedRange.Find(\"Material\", xlValues, xlWhole)\n    Set valrng = Worksheets(\"Data\").UsedRange.Find(\"Invoiced Value\", xlValues, xlWhole)\n    Set matname = Worksheets(\"Names\").UsedRange.Find(\"Material\", xlValues, xlWhole)\n    Set dscrng = Worksheets(\"Names\").UsedRange.Find(\"Material Description\", xlValues, xlWhole)\n\nEnd Sub\n</code></pre>\n\n<p>Any and all help/suggestions is appreciated, I am hoping to expand this to three data sets.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 84, "user_id": 7489442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b58c475359a809cffe9ba487dd8c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Srijan", "link": "https://stackoverflow.com/users/7489442/srijan"}, "edited": false, "score": 0, "creation_date": 1536142024, "post_id": 52182442, "comment_id": 91314764, "body": "can you post some sample of desired output?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1536142428, "post_id": 52182442, "comment_id": 91315005, "body": "is <a href=\"https://i.stack.imgur.com/NmGbH.png\" rel=\"nofollow noreferrer\">this</a> what you are trying to accomplish?"}, {"owner": {"reputation": 1, "user_id": 10187654, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156402306710320/picture?type=large", "display_name": "Nuno Miguel Meira", "link": "https://stackoverflow.com/users/10187654/nuno-miguel-meira"}, "edited": false, "score": 0, "creation_date": 1536142482, "post_id": 52182442, "comment_id": 91315034, "body": "I want to group all the Detector and count them all in a single cell. Making a list of general products and counting all but CO2 detector are the same only changing the place they are. Soo I will count all using a char counter in VBA Excel  <b>Detector CO2 - (X numbers)</b>"}, {"owner": {"reputation": 1, "user_id": 10187654, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156402306710320/picture?type=large", "display_name": "Nuno Miguel Meira", "link": "https://stackoverflow.com/users/10187654/nuno-miguel-meira"}, "edited": false, "score": 0, "creation_date": 1536142829, "post_id": 52182442, "comment_id": 91315237, "body": "@Jeeped from the column A i want to count the total CO2 Detectors in another Column but in a single cell using a char function. Like: if it is a CO2 Detector doesn&#39;t mather if it is Posto 077, Posto 078, Posto 080, etc.."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1536144037, "post_id": 52182442, "comment_id": 91315959, "body": "Reaarange your data so that the <code>Product Name</code> and <code>Identifier</code> are in separate columns; then use a Pivot Table."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1536143034, "creation_date": 1536143034, "answer_id": 52182828, "question_id": 52182442, "link": "https://stackoverflow.com/questions/52182442/how-to-group-text-with-words-in-common/52182828#52182828", "title": "How to group text with words in common?", "body": "<p>You say you want to count CO2 Detectors but all of your CO2 Detectors are listed as Detector CO2s. Try,</p>\n\n<pre><code>=countifs(a:a, \"*detector*\", a:a, \"*co2*\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1536144729, "last_edit_date": 1592644375, "creation_date": 1536144729, "answer_id": 52183362, "question_id": 52182442, "link": "https://stackoverflow.com/questions/52182442/how-to-group-text-with-words-in-common/52183362#52183362", "title": "How to group text with words in common?", "body": "<p>You don't provide a lot of information.  My approach would be to split off the &quot;identifier&quot; for the product type, and then construct a pivot table.</p>\n<p>But you'll have to figure out how to do the splitting.</p>\n<p>As a quick and easy example, I used <code>Power Query</code> (aka <code>Get&amp;Transform</code> in Excel 2016), to split by space but only the rightmost space. Then I closed and loaded it to a Pivot Table Report.</p>\n<p>I then dragged the first column to the Rows area, and the Second column to the Values area.</p>\n<p>A little formatting and:</p>\n<p><a href=\"https://i.stack.imgur.com/jlC64.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jlC64.png\" alt=\"enter image description here\" /></a></p>\n<p>Of course, you may need a more appropriate method of splitting your data, but this approach should get you started.</p>\n<p>Also, if you also drag the 2nd column to the rows area, you can develop a pivot table in which you can drill down to the individual items, should you want.</p>\n"}], "owner": {"reputation": 1, "user_id": 10187654, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156402306710320/picture?type=large", "display_name": "Nuno Miguel Meira", "link": "https://stackoverflow.com/users/10187654/nuno-miguel-meira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1610887138, "creation_date": 1536141862, "last_edit_date": 1610887138, "question_id": 52182442, "link": "https://stackoverflow.com/questions/52182442/how-to-group-text-with-words-in-common", "title": "How to group text with words in common?", "body": "<p>I have a list of unique values.<br />\nThe list reports some different cases of the same products, like CO2 Detector 077, CO2 Detector 078, ...<br />\nHow can I group them in one cell, counting all of the Detectors in the first cell that appears in the list? Probably using a counter of number of characters.</p>\n<p>List of products:</p>\n<pre><code>Sonda Produto\nSonda Aspira\u00e7\u00e3o NTC060WF\nDisplay CX660\nXM679K Sonda 5/6\nXM679K Sonda 3\nParagem Moveis Negativos\nDetector CO2 Posto 077\nDetector CO2 Posto 078\nDetector CO2 Posto 080\nDetector CO2 Posto 081\nInterruptor Local\nResist\u00eancia Desemb.\nCortina Automatica\nDetector CO2 Posto 320\nDetector CO2 Posto 321\nResist\u00eancia Bateria\nSonda Humidade XH20P\nSeguran\u00e7a KP69\nDetector CO2 Posto 322\nDetector CO2 Posto 323\nDetector CO2 Posto 324\nDetector CO2 Posto 326\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1536141777, "post_id": 52182221, "comment_id": 91314616, "body": "You probably need to specify in which workbook <code>Sheets(2)</code> is. Like: <code>ThisWorkbook.Sheets(2)</code> also you probably meant to use <code>ThisWorkbook.Path</code> instead of <code>ActiveWorkbook.Path</code>. \u2022 <code>ThisWorkbook</code> is the workbook the code is written in but <code>ActiveWorkbook</code> is the workbook that has the focus (is on top) at the moment the code runs."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10314057, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6OjxvaPhi4I/AAAAAAAAAAI/AAAAAAAAALE/jL8R7L-mjtQ/photo.jpg?sz=128", "display_name": "Kartiki Jagtap", "link": "https://stackoverflow.com/users/10314057/kartiki-jagtap"}, "edited": false, "score": 1, "creation_date": 1536146515, "post_id": 52182803, "comment_id": 91317431, "body": "awesome!!! That worked perfect. Do you know any way an embedded OLE object can be opened read only?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31, "user_id": 10314057, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6OjxvaPhi4I/AAAAAAAAAAI/AAAAAAAAALE/jL8R7L-mjtQ/photo.jpg?sz=128", "display_name": "Kartiki Jagtap", "link": "https://stackoverflow.com/users/10314057/kartiki-jagtap"}, "edited": false, "score": 0, "creation_date": 1536146629, "post_id": 52182803, "comment_id": 91317497, "body": "@KartikiJagtap -  try to pass it like this <code>Workbooks.Open str, readonly:=True</code> - <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Workbooks.Open\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/Excel.Workbooks.Open</a>"}, {"owner": {"reputation": 31, "user_id": 10314057, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6OjxvaPhi4I/AAAAAAAAAAI/AAAAAAAAALE/jL8R7L-mjtQ/photo.jpg?sz=128", "display_name": "Kartiki Jagtap", "link": "https://stackoverflow.com/users/10314057/kartiki-jagtap"}, "edited": false, "score": 0, "creation_date": 1536147395, "post_id": 52182803, "comment_id": 91317962, "body": "ok @Vityata. If I understand correctly, workbooks.open would open a workbook with a specific path. To open an embedded OLE object can we use &#39;OLEobject.open WDObj, readonly:=True&#39; instead of &#39;WDObj.Verb xlOpen&#39;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31, "user_id": 10314057, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6OjxvaPhi4I/AAAAAAAAAAI/AAAAAAAAALE/jL8R7L-mjtQ/photo.jpg?sz=128", "display_name": "Kartiki Jagtap", "link": "https://stackoverflow.com/users/10314057/kartiki-jagtap"}, "edited": false, "score": 0, "creation_date": 1536148022, "post_id": 52182803, "comment_id": 91318380, "body": "@KartikiJagtap - nope, actually I was thinking you wanted to open the <code>str</code> one.  For the OleObject readonly, check some info here, there is a way to change the readonly status and open it - <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/73da844e-312e-4b73-a68a-30dd4664437d/how-to-open-an-ole-object-by-readonly\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>"}, {"owner": {"reputation": 31, "user_id": 10314057, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6OjxvaPhi4I/AAAAAAAAAAI/AAAAAAAAALE/jL8R7L-mjtQ/photo.jpg?sz=128", "display_name": "Kartiki Jagtap", "link": "https://stackoverflow.com/users/10314057/kartiki-jagtap"}, "edited": false, "score": 1, "creation_date": 1536148952, "post_id": 52182803, "comment_id": 91319012, "body": "Thanks. I want to open the oleobject as read only to avoid any changes in the parent file. Seems like there is no way to set this attribute to readonly for these ole objects, hence I am saving the file in another location and opening that instead of the OLE object."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1536142952, "creation_date": 1536142952, "answer_id": 52182803, "question_id": 52182221, "link": "https://stackoverflow.com/questions/52182221/unable-to-get-oleobjects-property-error-when-running-the-same-code-twice-in-exce/52182803#52182803", "title": "Unable to get OLEObjects Property error when running the same code twice in Excel VBA", "body": "<p>This is your revised code:</p>\n\n<pre><code>Private Sub M113_Click()\n\n    Dim WDObj As Object\n    Dim WDApp As Object\n    Dim str As String\n\n    With ThisWorkbook\n        str = .Path &amp; \"\\CND Scaled Template.xlsm\"\n        Set WDObj = .Worksheets(2).OLEObjects(\"CNDS\")\n        WDObj.Verb xlOpen\n    End With\n\n    Dim i As Long\n    i = Workbooks.Count\n    Workbooks(i).SaveCopyAs str\n    Workbooks(i).Close\n    Workbooks.Open str\n\nEnd Sub\n</code></pre>\n\n<p>As mentioned in the comments by @PEH, most probably the error is in referring <code>ThisWorkbook</code> and the <code>ActiveWorkbook</code>.</p>\n\n<p>I have removed the <code>Set WDObj = Nothing</code>, because they are local variables and would be destroyed anyway after the end.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\">Why Use Integer Instead of Long?</a></p>\n"}], "owner": {"reputation": 31, "user_id": 10314057, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6OjxvaPhi4I/AAAAAAAAAAI/AAAAAAAAALE/jL8R7L-mjtQ/photo.jpg?sz=128", "display_name": "Kartiki Jagtap", "link": "https://stackoverflow.com/users/10314057/kartiki-jagtap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 757, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536142952, "creation_date": 1536141237, "question_id": 52182221, "link": "https://stackoverflow.com/questions/52182221/unable-to-get-oleobjects-property-error-when-running-the-same-code-twice-in-exce", "title": "Unable to get OLEObjects Property error when running the same code twice in Excel VBA", "body": "<p>I am running the same code line son multiple command buttons that open assigned excel templates embedded in the parent spreadsheet.</p>\n\n<pre><code>Private Sub M113_Click()\nDim WDObj As Object\nDim WDApp As Object\nDim str As String\n\nstr = ActiveWorkbook.Path &amp; \"\\CND Scaled Template.xlsm\"\n\nSet WDObj = Sheets(2).OLEObjects(\"CNDS\")\nWDObj.Verb xlOpen\n\nDim i As Integer\ni = Workbooks.Count\n\nWorkbooks(i).SaveCopyAs str\nWorkbooks(i).Close\n\nWorkbooks.Open (str)\n\nSet WDObj = Nothing\nSet WDApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>this is the line where I get error message \"Unable to get OLEObjects property of worksheet class\"</p>\n\n<pre><code>Set WDObj = Sheets(2).OLEObjects(\"CNDS\")\n</code></pre>\n\n<p>Running it the first time after opening excel does not give any errors but running it second time is issue. Also going to VBA editor through debug mode and pressing F5 works fine and the entire code executes well. What could be the issue? Also this doesn't happen with Ole objects other than excel.</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1536149361, "last_edit_date": 1536149361, "creation_date": 1536141567, "answer_id": 52182341, "question_id": 52182119, "link": "https://stackoverflow.com/questions/52182119/take-a-specific-document-for-a-mail-in-vba-on-mac/52182341#52182341", "title": "Take a specific document for a mail in VBA on MAC", "body": "<p>MacOS/OSX uses a different path separator than Windows <code>\"\\\"</code>.</p>\n\n<p>So if you have your path hard coded in VBA like this</p>\n\n<pre><code>Path = \"Z:\\Reporting\\\" &amp; ext3 &amp; \"\\\" &amp; ext &amp; \" - \" &amp; ext2 &amp; \".pdf\"\n</code></pre>\n\n<p>you can check the operating system and use </p>\n\n<pre><code>If Application.OperatingSystem Like \"*Mac*\" Then\n    Path = \"your mac path\"\nElse\n    Path = \"Z:\\Reporting\\\" &amp; ext3 &amp; \"\\\" &amp; ext &amp; \" - \" &amp; ext2 &amp; \".pdf\"\nEnd If\n</code></pre>\n\n<p>Note that <code>Application.PathSeparator</code> returns the actual path separator used by the operating system.</p>\n"}], "owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 52182341, "answer_count": 1, "score": 0, "last_activity_date": 1593598919, "creation_date": 1536141006, "last_edit_date": 1593598919, "question_id": 52182119, "link": "https://stackoverflow.com/questions/52182119/take-a-specific-document-for-a-mail-in-vba-on-mac", "title": "Take a specific document for a mail in VBA on MAC", "body": "<p>I am on MAC so even if I know VBA i dont know how to translate it on MAC. I have this code but I have a problem about the path </p>\n\n<p>I want a macro who join a specific document (already existing) in this path :</p>\n\n<pre><code>Path = \"Z:\\Reporting\\\" &amp; ext3 &amp; \"\\\" &amp; ext &amp; \" - \" &amp; ext2 &amp; \".pdf\"\n</code></pre>\n\n<p>(with ext1/2/3 are cells value)\nand sending it by mail with Outlook MAC.</p>\n\n<p>This is my code :</p>\n\n<pre><code>Sub SaveMailRangeAsPDFIn2016()\n    Dim FilePathName As String\n    Dim strbody As String\n\n        FilePathName = ?\n\n\n'Create the body text in the strbody string\n    strbody = \"&lt;FONT size=\"\"3\"\" face=\"\"Calibri\"\"&gt;\"\n    strbody = strbody &amp; \"Hi there\" &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; _\n        \"This is line 1\" &amp; \"&lt;br&gt;\" &amp; _\n        \"This is line 2\" &amp; \"&lt;br&gt;\" &amp; _\n        \"This is line 3\" &amp; \"&lt;br&gt;\" &amp; _\n        \"This is line 4\"\n    strbody = strbody &amp; \"&lt;/FONT&gt;\"\n\n\nMacExcel2016WithMacOutlookPDF _\n    subject:=\"test\", _\n    mailbody:=strbody, _\n    toaddress:=\"xxxxx@xxxx.xx\", _\n    ccaddress:=\"\", _\n    bccaddress:=\"\", _\n    displaymail:=\"yes\", _\n    accounttype:=\"\", _\n    accountname:=\"\", _\n    attachment:=FilePathName\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>with the fonction :</p>\n\n<pre><code>Function MacExcel2016WithMacOutlookPDF(subject As String, mailbody As String, _\n    toaddress As String, ccaddress As String, _\n    bccaddress As String, displaymail As String, _\n    accounttype As String, accountname As String, _\n    attachment As String)\n    Dim ScriptStr As String, RunMyScript As String\n\n    ScriptStr = subject &amp; \";\" &amp; mailbody &amp; \";\" &amp; toaddress &amp; \";\" &amp; ccaddress &amp; \";\" &amp; _\n                bccaddress &amp; \";\" &amp; displaymail &amp; \";\" &amp; accounttype &amp; \";\" &amp; _\n                accountname &amp; \";\" &amp; attachment\n\n    'Call the RDBMacOutlook.scpt script file with the AppleScriptTask function\n    RunMyScript = AppleScriptTask(\"RDBMacOutlook.scpt\", \"CreateMailInOutlook\", CStr(ScriptStr))\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "database", "vba", "excel"], "comments": [{"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1536141360, "post_id": 52182083, "comment_id": 91314363, "body": "Change <code>With Sheets(&quot;Customers&quot;)</code> to <code>With Sheets(&quot;Test&quot;)</code> or <code>With Sheets(&quot;Information&quot;)</code>."}, {"owner": {"reputation": 33, "user_id": 6829107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aba9366abdb0a5083f0d43fc34d093f?s=128&d=identicon&r=PG&f=1", "display_name": "love-to-code", "link": "https://stackoverflow.com/users/6829107/love-to-code"}, "reply_to_user": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1536142353, "post_id": 52182083, "comment_id": 91314957, "body": "@PaichengWu So do I need to create new Models in the vba? Can&#39;t I do it under one Sub? Because I would like to know is there anyway, I can define all 3 sheets under 1 function? For example( &quot;Customers&quot; AND &quot;Infromation&quot; AND &quot;Test&quot;) and then push all the data to database after pressing the button - something like this."}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1536143423, "post_id": 52182083, "comment_id": 91315626, "body": "Of course you can put all three in 1 sub.  Without more information about the layout of your three sheets and the schema of your database, I cannot give you more help.  You should learn how sheet <code>Customers</code> is inserted, then expand to 2nd, and 3rd sheets."}, {"owner": {"reputation": 33, "user_id": 6829107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aba9366abdb0a5083f0d43fc34d093f?s=128&d=identicon&r=PG&f=1", "display_name": "love-to-code", "link": "https://stackoverflow.com/users/6829107/love-to-code"}, "reply_to_user": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1536145633, "post_id": 52182083, "comment_id": 91316919, "body": "Thanks @PaichengWu"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1536157625, "post_id": 52182083, "comment_id": 91324765, "body": "Since you have a sub do the job on sheet <code>Customers</code> alone, modify it for sheet <code>test</code> and modify for sheet <code>information</code>.  Then combine the three subs into one."}, {"owner": {"reputation": 33, "user_id": 6829107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aba9366abdb0a5083f0d43fc34d093f?s=128&d=identicon&r=PG&f=1", "display_name": "love-to-code", "link": "https://stackoverflow.com/users/6829107/love-to-code"}, "reply_to_user": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1536239143, "post_id": 52182083, "comment_id": 91358668, "body": "Hi @PaichengWu, I have found another way and that is to select multiple sheets by creating an array. Haven&#39;t tested it yet, but will give it a try. Dim MultipleSheets(2) As String MultipleSheets(0) = &quot;Customers&quot; MultipleSheets(1) = &quot;Test&quot; MultipleSheets(2) = &quot;Information&quot; Sheets(myarray()).Select"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6829107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aba9366abdb0a5083f0d43fc34d093f?s=128&d=identicon&r=PG&f=1", "display_name": "love-to-code", "link": "https://stackoverflow.com/users/6829107/love-to-code"}, "edited": false, "score": 0, "creation_date": 1536142175, "post_id": 52182357, "comment_id": 91314856, "body": "Thanks @RoverRoll, but is there any way I can do this using VBA code instead of the straightforward SQL Server Import. Because, I am currently learning"}], "tags": [], "owner": {"reputation": 115, "user_id": 8835940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dacdb07d748784229bc081155ff88c1?s=128&d=identicon&r=PG&f=1", "display_name": "RoverRoll", "link": "https://stackoverflow.com/users/8835940/roverroll"}, "is_accepted": false, "score": 0, "last_activity_date": 1536141603, "creation_date": 1536141603, "answer_id": 52182357, "question_id": 52182083, "link": "https://stackoverflow.com/questions/52182083/how-to-export-excel-data-from-different-sheets-to-sql-server-database/52182357#52182357", "title": "How to export Excel data from different sheets to SQL-SERVER Database?", "body": "<p>Use <strong>Sql Server Import and Export Data 64 Bit or 32 Bit</strong> </p>\n\n<p>STEP 1 :<a href=\"https://i.stack.imgur.com/ZlceQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZlceQ.jpg\" alt=\"screenshot1\"></a></p>\n\n<p>STEP 2: <a href=\"https://i.stack.imgur.com/3xNGi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3xNGi.jpg\" alt=\"Screenshot2\"></a></p>\n\n<p>STEP 3: <a href=\"https://i.stack.imgur.com/MRXQH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MRXQH.jpg\" alt=\"Screenshot3\"></a></p>\n\n<p>STEP 4: <a href=\"https://i.stack.imgur.com/O9Y8z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O9Y8z.jpg\" alt=\"Screenshot4\"></a></p>\n\n<p>Step 5 :<a href=\"https://i.stack.imgur.com/oyrEg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oyrEg.jpg\" alt=\"Screenshot5\"></a></p>\n\n<p>Follow the next steps</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6829107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aba9366abdb0a5083f0d43fc34d093f?s=128&d=identicon&r=PG&f=1", "display_name": "love-to-code", "link": "https://stackoverflow.com/users/6829107/love-to-code"}, "edited": false, "score": 0, "creation_date": 1536419547, "post_id": 52183688, "comment_id": 91421704, "body": "Hi @Erik von Asmuth, thank you for the explanation. I haven&#39;t executed your solution yet. I have a question for my understanding. In ur solution, I can see you are using select statement. My question is, why instead of INSERT, a SELECT statement should be used, because I will be taking the excel data and then transport it to SQL server? Another question I have 3 more tables with 2 foreign keys. If I want to export the data, then should I just push the data to the first table where the primary key is? Will it also link to the other foreign keys?Will I execute all the functions under one sub?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 33, "user_id": 6829107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aba9366abdb0a5083f0d43fc34d093f?s=128&d=identicon&r=PG&f=1", "display_name": "love-to-code", "link": "https://stackoverflow.com/users/6829107/love-to-code"}, "edited": false, "score": 0, "creation_date": 1536425696, "post_id": 52183688, "comment_id": 91423377, "body": "Those are a whole lot of questions for a comment. The select statement opens up a recordset, and the other code adds rows to that. Those further questions are not related to this answer thus I won&#39;t answer them as a comment here."}, {"owner": {"reputation": 33, "user_id": 6829107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aba9366abdb0a5083f0d43fc34d093f?s=128&d=identicon&r=PG&f=1", "display_name": "love-to-code", "link": "https://stackoverflow.com/users/6829107/love-to-code"}, "edited": false, "score": 0, "creation_date": 1536436232, "post_id": 52183688, "comment_id": 91426314, "body": "von Asumth thank you for the explanation, now it makes sense. Thanks again"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1536145812, "creation_date": 1536145812, "answer_id": 52183688, "question_id": 52182083, "link": "https://stackoverflow.com/questions/52182083/how-to-export-excel-data-from-different-sheets-to-sql-server-database/52183688#52183688", "title": "How to export Excel data from different sheets to SQL-SERVER Database?", "body": "<p>You shouldn't use insert queries for every row you want to export. Instead, if you want to do it manually, open a recordset:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Button1_Click()\n\nDim conn As New ADODB.Connection\nDim rs As New ADODB.Recordset\nDim iRowNo As Integer\nDim sCustomerId, sFirstName, sLastName As String\n\nWith Sheets(\"Customers\")\n\n    'Open a connection to SQL Server\n    conn.Open \"Provider=SQLOLEDB;Data Source=TESTpc\\SQLEXPRESS;Initial Catalog=ExcelSQLServerDemo;Trusted_connection=yes\"\n    conn.CursorLocation = adUseClient 'Use a client-side cursor\n    rs.Open \"SELECT * FROM dbo.Customers\", conn, adOpenDynamic, adLockOptimistic 'Open the table into a recordset\n\n   'Skip the header row\n    iRowNo = 2\n\n    'Loop until empty cell in CustomerId\n    Do Until .Cells(iRowNo, 1) = \"\"\n        rs.AddNew 'Add a new row\n        rs!CustomerId = .Cells(iRowNo, 1) 'Set row values\n        rs!FirstName = .Cells(iRowNo, 2)\n        rs!LastName = .Cells(iRowNo, 3)\n        rs.Update 'Commit changes to database, you can try running this once, or once every X rows\n        iRowNo = iRowNo + 1\n    Loop\n\n    MsgBox \"Customers Exported To Database\"\n\n    conn.Close\n    Set conn = Nothing\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>This has several advantages, including but not limited to increased performance, the ability to insert quoted values and increased stability.</p>\n"}], "owner": {"reputation": 33, "user_id": 6829107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aba9366abdb0a5083f0d43fc34d093f?s=128&d=identicon&r=PG&f=1", "display_name": "love-to-code", "link": "https://stackoverflow.com/users/6829107/love-to-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 52183688, "answer_count": 2, "score": 1, "last_activity_date": 1606161828, "creation_date": 1536140909, "last_edit_date": 1606161828, "question_id": 52182083, "link": "https://stackoverflow.com/questions/52182083/how-to-export-excel-data-from-different-sheets-to-sql-server-database", "title": "How to export Excel data from different sheets to SQL-SERVER Database?", "body": "<p>I am new in Excel VBA and SQL. I have managed to create a macro button and push Excel cell data to SQL server tables. However, I am a bit puzzled:</p>\n<p>How can I take Excel cell data from different sheets and then push them to different tables in SQL Server database? (Currently, I have 3 sheets - Customers, Test, Information - in one Excel file.)</p>\n<p>Current working code:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Button1_Click()\n \nDim conn As New ADODB.Connection\nDim iRowNo As Integer\nDim sCustomerId, sFirstName, sLastName As String\n\nWith Sheets(&quot;Customers&quot;)\n        \n    'Open a connection to SQL Server\n    conn.Open &quot;Provider=SQLOLEDB;Data Source=TESTpc\\SQLEXPRESS;Initial Catalog=ExcelSQLServerDemo;Trusted_connection=yes&quot;\n        \n   'Skip the header row\n    iRowNo = 2\n        \n    'Loop until empty cell in CustomerId\n    Do Until .Cells(iRowNo, 1) = &quot;&quot;\n        sCustomerId = .Cells(iRowNo, 1)\n        sFirstName = .Cells(iRowNo, 2)\n        sLastName = .Cells(iRowNo, 3)\n            \n        'Generate and execute sql statement to import the excel rows to SQL Server table\n        conn.Execute &quot;INSERT into dbo.Customers (CustomerId, FirstName, LastName) values ('&quot; &amp; sCustomerId &amp; &quot;', '&quot; &amp; sFirstName &amp; &quot;', '&quot; &amp; sLastName &amp; &quot;')&quot;\n\n        iRowNo = iRowNo + 1\n    Loop\n    \n    MsgBox &quot;Customers Exported To Database&quot;\n        \n    conn.Close\n    Set conn = Nothing\n    \n    End With\nEnd Sub\n</code></pre>\n<p>Do I need to store the data in arrays and then push them to the database?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10319386, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X6xVqY5fC_o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOTlV_3fk08OuojIL0a6qB4ROD2tA/mo/photo.jpg?sz=128", "display_name": "Rory Sadler", "link": "https://stackoverflow.com/users/10319386/rory-sadler"}, "edited": false, "score": 0, "creation_date": 1536141505, "post_id": 52182111, "comment_id": 91314438, "body": "Thank you! The code is now deleting the specified row. However, it seems to be causing errors for formulae involving the rows below. The &quot;add row&quot; buttton is working well, I&#39;ve included the code below. Perhaps the &quot;delete row&quot; code needs something similar to change to row numbers? Thanks again."}, {"owner": {"reputation": 1, "user_id": 10319386, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X6xVqY5fC_o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOTlV_3fk08OuojIL0a6qB4ROD2tA/mo/photo.jpg?sz=128", "display_name": "Rory Sadler", "link": "https://stackoverflow.com/users/10319386/rory-sadler"}, "edited": false, "score": 1, "creation_date": 1536141509, "post_id": 52182111, "comment_id": 91314440, "body": "For Each ws In Worksheets rowbefore = rownumber - 1         ws.Rows(rownumber).Insert         ws.Rows(rowbefore).Copy ws.Rows(rownumber)         On Error Resume Next       ws.Rows(rownumber).SpecialCells(xlCellTypeConstants).ClearCo&zwnj;&#8203;ntents     Next ws"}, {"owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "reply_to_user": {"reputation": 1, "user_id": 10319386, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X6xVqY5fC_o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOTlV_3fk08OuojIL0a6qB4ROD2tA/mo/photo.jpg?sz=128", "display_name": "Rory Sadler", "link": "https://stackoverflow.com/users/10319386/rory-sadler"}, "edited": false, "score": 0, "creation_date": 1536142275, "post_id": 52182111, "comment_id": 91314919, "body": "What exactly do you want to achieve with this macro? Do you want to &quot;delete&quot; the specific row, but keep everything below this row untouched? If so, maybe try to change in my code <code>ws.Rows(rownumber).Delete</code> to <code>ws.Rows(rownumber).ClearContents</code>, because using Delete method make everything shift up one row."}, {"owner": {"reputation": 1, "user_id": 10319386, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X6xVqY5fC_o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOTlV_3fk08OuojIL0a6qB4ROD2tA/mo/photo.jpg?sz=128", "display_name": "Rory Sadler", "link": "https://stackoverflow.com/users/10319386/rory-sadler"}, "edited": false, "score": 0, "creation_date": 1536143288, "post_id": 52182111, "comment_id": 91315541, "body": "Thanks again for you help!"}, {"owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "reply_to_user": {"reputation": 1, "user_id": 10319386, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X6xVqY5fC_o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOTlV_3fk08OuojIL0a6qB4ROD2tA/mo/photo.jpg?sz=128", "display_name": "Rory Sadler", "link": "https://stackoverflow.com/users/10319386/rory-sadler"}, "edited": false, "score": 0, "creation_date": 1536144464, "post_id": 52182111, "comment_id": 91316219, "body": "No problem! Just please mark my answer as &quot;accepted&quot; if you think that it solved your problem :)"}], "tags": [], "owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "is_accepted": false, "score": 1, "last_activity_date": 1536140992, "creation_date": 1536140992, "answer_id": 52182111, "question_id": 52182014, "link": "https://stackoverflow.com/questions/52182014/delete-specified-row-in-edexcel/52182111#52182111", "title": "Delete specified row in Edexcel", "body": "<p>Your code is working, but it is deleting only the 86th row.\nYou need to pass the variable <code>rownumber</code> to <code>Rows().Delete</code> function.</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub Button1_Click()\nDim ws As Worksheet\nDim wb As Workbook\n\nrownumber = InputBox(\"What row would you like to delete ?\")\nSet wb = ThisWorkbook\n\nFor Each ws In wb.Worksheets\n    ws.Rows(rownumber).Delete\nNext ws\nSet wb = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10319386, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X6xVqY5fC_o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOTlV_3fk08OuojIL0a6qB4ROD2tA/mo/photo.jpg?sz=128", "display_name": "Rory Sadler", "link": "https://stackoverflow.com/users/10319386/rory-sadler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536141689, "creation_date": 1536140703, "last_edit_date": 1536141689, "question_id": 52182014, "link": "https://stackoverflow.com/questions/52182014/delete-specified-row-in-edexcel", "title": "Delete specified row in Edexcel", "body": "<p>Sorry if this isn't an appropriate question to ask but I'm looking for any help I can get. \nThe \"Delete Row\" button doesn't seem to be working on an Excel document I'm using. </p>\n\n<p>The code is:</p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim ws As Worksheet\n    Dim wb As Workbook\n\n    rownumber = InputBox(\"What row would you like to delete ?\")\n\n    Set wb = ThisWorkbook\n\n    For Each ws In wb.Worksheets\n         ws.Rows(86).Delete\n    Next ws\n\n    Set wb = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone see a problem? Many thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536144677, "post_id": 52182386, "comment_id": 91316336, "body": "Hi Lucas, thanks for your answer. I have already been able to link the module to the button. The question was regarding adding another button automatically within the code, to easily get access to the hidden worksheet initially created. May not have explained it that well. I am looking at the option to store a reference instead of creating a new button for every &quot;case&quot;."}], "tags": [], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "is_accepted": false, "score": 0, "last_activity_date": 1536141692, "last_edit_date": 1592644375, "creation_date": 1536141692, "answer_id": 52182386, "question_id": 52182012, "link": "https://stackoverflow.com/questions/52182012/vba-code-to-create-button-that-leads-to-hidden-worksheet/52182386#52182386", "title": "VBA code to create button that leads to hidden worksheet", "body": "<h1>1 Create a button</h1>\n<p>You can create a button using the development-tab in excel. There is a button called &quot;insert&quot; and then you insert a &quot;Active-X Button&quot; note there are also commandbuttons but they are for the compatibility with older versions. Do not use them. By clicking on the Design Mode Button in the development-tab in Excel you enter the design mode.</p>\n<h1>2 Enter the Code in the CommandButton_Click() module</h1>\n<p>When you are in the design mode double click on the button and it will show you something like this:</p>\n<pre><code>Private Sub BUTTONNAME_click()\n' Enter Code here OR even better call code from module\nSub End\n</code></pre>\n<p>You can then do ahead and enter the code OR even better call the code from a modul. Button code will then look like this:</p>\n<pre><code>Private Sub BUTTONNAME_click()\ncall modulename.subname()\nSub End\n</code></pre>\n<p>And the module code will look like this:</p>\n<pre><code>Sub Subname() \nSet ws = Sheets(&quot;INPUT&quot;)\n\nfinancing = ws.Range(&quot;E2&quot;).Value\ncompName = ws.Range(&quot;E3&quot;).Value\n\nlastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row + 1\nws.Cells(lastRow, 1) = financing\nws.Cells(lastRow, 2) = compName\n\nActiveWorkbook.Sheets.Add after:=Worksheets(Worksheets.Count)\nActiveWorkbook.Sheets(Worksheets.Count).Name = compName &amp; &quot;-&quot; &amp; financing\nActiveWorkbook.Sheets(compName &amp; &quot;-&quot; &amp; financing).Visible = xlSheetHidden\nEnd Sub\n</code></pre>\n<p>Note here: As I understood your problem you do not know how to run code with a button.  I assume your code works.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 1, "creation_date": 1536143671, "post_id": 52182583, "comment_id": 91315771, "body": "Thanks Darren, highly appreciate your help."}, {"owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536155622, "post_id": 52182583, "comment_id": 91323430, "body": "Hi again Darren, This code worked well, but as you mentioned, it is probably better using a reference or a hyperlink to the &quot;hidden&quot; worksheet in the new cell that was created on the initial worksheet. Do you have any tips how to create a hyperlink to the new &quot;hidden&quot; worksheet in the cell that was created on the initial worksheet (&quot;INPUT&quot;)?"}, {"owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536159907, "post_id": 52182583, "comment_id": 91326379, "body": "Nvm Darren, figured it out!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536160314, "post_id": 52182583, "comment_id": 91326637, "body": "Good stuff.  I was thinking about hyperlinks after your comment but you&#39;d need to catch the <code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)</code> event so it can unhide the sheet first - not sure what problems you&#39;d run into as haven&#39;t had time to look into it too far."}, {"owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "edited": false, "score": 0, "creation_date": 1536160669, "post_id": 52182583, "comment_id": 91326864, "body": "Exactly. I decided to keep the worksheets visible, as the only negative effects would be the aesthetics of the workbook. I am now trying to code the process of duplicating another worksheet when using my command button, instead of creating a blank worksheet (just posted another thread). As I mentioned, quite new to this, but extremely fascinating!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1536142344, "creation_date": 1536142344, "answer_id": 52182583, "question_id": 52182012, "link": "https://stackoverflow.com/questions/52182012/vba-code-to-create-button-that-leads-to-hidden-worksheet/52182583#52182583", "title": "VBA code to create button that leads to hidden worksheet", "body": "<p>It's generally better to store a reference to your new worksheet within a variable.  You don't need to rely on the position or the name of the worksheet then - both of which can be changed by the user.</p>\n\n<p>This code gives the button the same name as the worksheet it's meant to be pointing to <em>(I'm hoping that won't cause any problems with naming conventions)</em>.<br>\nThe code that runs when you press the button looks at the button name and activates that sheet.  </p>\n\n<pre><code>Sub AddButton()\n\n    Dim btn As Button\n    Dim wrkSht As Worksheet\n\n    Set wrkSht = ThisWorkbook.Worksheets.Add\n    With wrkSht\n        .Name = \"compNameValue - FinancingValue\"\n        .Move After:=Sheets(ThisWorkbook.Worksheets.Count)\n        .Visible = xlSheetVeryHidden\n    End With\n\n    Set btn = ThisWorkbook.Worksheets(\"Sheet1\").Buttons.Add(20, 20, 20, 20)\n    With btn\n        .ShapeRange.IncrementTop 100\n        .ShapeRange.IncrementLeft 100\n        .OnAction = \"MacroTest\"\n        .Name = wrkSht.Name\n    End With\n\nEnd Sub\n\nSub MacroTest()\n\n    With ThisWorkbook.Worksheets(Application.Caller)\n        .Visible = xlSheetVisible\n        .Activate\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>You may want to update <code>ThisWorkbook</code> to <code>ActiveWorkbook</code> depending on your needs.<br>\n<code>ThisWorkbook</code> is always the book containing the code that's running.<br>\n<code>ActiveWorkbook</code> is, as it says, the workbook that's currently active.</p>\n"}], "owner": {"reputation": 33, "user_id": 10319223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c351010b6126105be558f2bddc2bb74e?s=128&d=identicon&r=PG&f=1", "display_name": "IB Andy", "link": "https://stackoverflow.com/users/10319223/ib-andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 52182583, "answer_count": 2, "score": 1, "last_activity_date": 1536142344, "creation_date": 1536140696, "question_id": 52182012, "link": "https://stackoverflow.com/questions/52182012/vba-code-to-create-button-that-leads-to-hidden-worksheet", "title": "VBA code to create button that leads to hidden worksheet", "body": "<p>I have created a module that creates a new hidden worksheet with a specific name with the click of a button. The specific name is also added on a list in the initial worksheet. I would like the module to automatically create a new button in the initial worksheet, that when clicked, opens the hidden worksheet that was initially created. I am a novice in this area, so I do apologize if this question is not up to Stack Overflow's standard.\nThe current code I have is:</p>\n\n<pre><code>Set ws = Sheets(\"INPUT\")\n\nfinancing = ws.Range(\"E2\").Value\ncompName = ws.Range(\"E3\").Value\n\nlastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row + 1\nws.Cells(lastRow, 1) = financing\nws.Cells(lastRow, 2) = compName\n\nActiveWorkbook.Sheets.Add after:=Worksheets(Worksheets.Count)\nActiveWorkbook.Sheets(Worksheets.Count).Name = compName &amp; \"-\" &amp; financing\nActiveWorkbook.Sheets(compName &amp; \"-\" &amp; financing).Visible = xlSheetHidden\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-addins"], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1536153791, "creation_date": 1536153791, "answer_id": 52186251, "question_id": 52181827, "link": "https://stackoverflow.com/questions/52181827/open-a-worksheet-in-addin-by-default/52186251#52186251", "title": "Open a worksheet in addin by default", "body": "<p>If the sheet is in the add-in then within code running in the add-in it can be referred to as </p>\n\n<pre><code> ThisWorkBook.Worksheets(\"DashBoard\")\n</code></pre>\n\n<p>You can copy this to the ActiveWorkbook and make it the first sheet by </p>\n\n<pre><code> ThisWorkBook.Worksheets(\"DashBoard\").Copy Before:=ActiveWorkBook.Worksheets(1)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10319310, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vdb-PKlHOS0/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNgp3Zx3mAYtRF-_3SNS7of-f-zFw/mo/photo.jpg?sz=128", "display_name": "Mathangi Ramachandran", "link": "https://stackoverflow.com/users/10319310/mathangi-ramachandran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 52186251, "answer_count": 1, "score": -1, "last_activity_date": 1549134188, "creation_date": 1536140053, "last_edit_date": 1549134188, "question_id": 52181827, "link": "https://stackoverflow.com/questions/52181827/open-a-worksheet-in-addin-by-default", "title": "Open a worksheet in addin by default", "body": "<p>I have an addin named SWERP, and worksheet within this addin named Dashboard. I have generated the necessary graphs in this dashboard worksheet. </p>\n\n<p>How do I load the Dashboard worksheet by default (which is in my addin), whenever the addin is accessed?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7251741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17b51268e6e87d8b5743c1cab2efb79b?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/7251741/ahmed"}, "edited": false, "score": 0, "creation_date": 1536143420, "post_id": 52182153, "comment_id": 91315622, "body": "I actually got that script over the web, i&#39;m not an expert or any near to as of VBA :) if you have an idea of what i&#39;m intending to get would you let me know plz?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 7251741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17b51268e6e87d8b5743c1cab2efb79b?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/7251741/ahmed"}, "edited": false, "score": 0, "creation_date": 1536146953, "post_id": 52182153, "comment_id": 91317694, "body": "@Ahmed Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and update your original question, not in a comment (use the edit button below your question). All questions and code need to be in your question part. I&#39;m far from understanding what your actual issue is and what your goal is, because now you are asking something completely different. Please be very clear and specific about what is your goal and what are your difficulties."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1536141080, "creation_date": 1536141080, "answer_id": 52182153, "question_id": 52181572, "link": "https://stackoverflow.com/questions/52181572/insert-new-row-when-a-cell-has-a-value-within-cells-range/52182153#52182153", "title": "Insert new Row when a cell has a value within cells range", "body": "<p>To add (copy and insert) a specific row when you change a value in the range F2:F12 you must use the <code>Worksheet_Change</code> event.</p>\n\n<p>You probably must adjust <code>Rows(1).Copy</code> to the row number you want to copy.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"F2:F12\")) Is Nothing Then 'if changed cell is within the range\n        If Not IsEmpty(Target) Then\n            Rows(1).Copy 'copy row number 1\n            Application.EnableEvents = False 'prevent the following line to trigger the change event again\n            Target.Offset(RowOffset:=1).EntireRow.Insert Shift:=xlShiftDown 'insert copied row\n            Application.EnableEvents = True 're enable events\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<ul>\n<li>I recommend you to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. Using <code>Select</code> is a bad practice and makes your code slow, so it is highly recommended to avoid it.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 7251741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17b51268e6e87d8b5743c1cab2efb79b?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/7251741/ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536223611, "creation_date": 1536139311, "last_edit_date": 1536223611, "question_id": 52181572, "link": "https://stackoverflow.com/questions/52181572/insert-new-row-when-a-cell-has-a-value-within-cells-range", "title": "Insert new Row when a cell has a value within cells range", "body": "<p>I need a macro to copy and insert a row below an existing when a cell had a value within a cell range, below macro insert a blank rows without coping cell value,</p>\n\n<p>to be more specific, I need to when I fill in a cell within a range copy and insert a certain row below of it with this new cell value</p>\n\n<pre><code>Sub new-macro()\n    Dim rng As Range\n    Dim cell As Range\n\n    Set rng = Range(\"F2:F12\")\n\n    For Each cell In rng\n        If Not IsEmpty(cell.Value) Then\n            ActiveCell.Offset(1, 0).Select\n            ActiveCell.EntireRow.Insert\n            ActiveCell.Offset(1, 0).Select\n        Else\n            ActiveCell.Offset(1, 0).Select\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I found this script but it gives me \"subscript out of range\", any idea why plz? </p>\n\n<pre><code>Sub insertRowFormatFromAbove() \n\nWorksheets(\"Insert row\").Rows(27).Insert Shift:=xlShiftDown, CopyOrigin:=xlFormatFromLeftOrAbove \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "input", "user-controls"], "comments": [{"owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "edited": false, "score": 0, "creation_date": 1536455816, "post_id": 52181431, "comment_id": 91429847, "body": "Could you show us what you have tried so far?"}, {"owner": {"reputation": 699, "user_id": 3016287, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rZREk.png?s=128&g=1", "display_name": "levraininjaneer", "link": "https://stackoverflow.com/users/3016287/levraininjaneer"}, "reply_to_user": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "edited": false, "score": 0, "creation_date": 1536595136, "post_id": 52181431, "comment_id": 91470712, "body": "@JamieRiis, the only way I have found to truly tell the difference is as suggested by Kirzsu below. Another possibility would have been to use the third positional argument to specify a default value of <code>&quot; &quot;</code>, and then I could have checked if the returned value was equal to <code>&quot; &quot;</code> (enter pressed), or <code>&quot;&quot;</code> (cancel pressed), but there was no guarantee that a user would not just delete the default value and then press OK..."}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 3016287, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rZREk.png?s=128&g=1", "display_name": "levraininjaneer", "link": "https://stackoverflow.com/users/3016287/levraininjaneer"}, "edited": false, "score": 0, "creation_date": 1536147886, "post_id": 52184266, "comment_id": 91318280, "body": "Thanks, this solves my problem. However, as you say: it&#39;s a bit sketchy. If I have no better answers by then, I&#39;ll mark this one as the answer."}], "tags": [], "owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "is_accepted": true, "score": 2, "last_activity_date": 1536147580, "creation_date": 1536147580, "answer_id": 52184266, "question_id": 52181431, "link": "https://stackoverflow.com/questions/52181431/how-to-tell-the-difference-between-cancel-and-ok-with-an-empty-textbox-of-an/52184266#52184266", "title": "How to tell the difference between &quot;cancel&quot; and &quot;OK&quot; with an empty textbox of an InputBox?", "body": "<p>There is a way to check if user clicked \"Cancel\" or just entered empty string.\nTry this:</p>\n\n<pre><code>test = InputBox(\"Enter a value\")\nIf StrPtr(test) = 0 Then\n    MsgBox \"Cancel\"\nElseIf Len(test) = 0 Then\n    MsgBox \"No entry\"\nElse\n    MsgBox \"Correct\"\nEnd If\n</code></pre>\n\n<p>However it is quite sketchy solution. You can read more about StrPtr function here: \n<a href=\"https://stackoverflow.com/questions/42015700/what-are-the-benefits-and-risks-of-using-the-strptr-function-in-vba\">What are the benefits and risks of using the StrPtr function in VBA?</a></p>\n"}, {"tags": [], "owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "is_accepted": false, "score": 0, "last_activity_date": 1536609853, "creation_date": 1536609853, "answer_id": 52264732, "question_id": 52181431, "link": "https://stackoverflow.com/questions/52181431/how-to-tell-the-difference-between-cancel-and-ok-with-an-empty-textbox-of-an/52264732#52264732", "title": "How to tell the difference between &quot;cancel&quot; and &quot;OK&quot; with an empty textbox of an InputBox?", "body": "<p>I believe that the code below will provide you a robust solution that works.  More information the Application.InputBox method and function can be found at <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.inputbox\" rel=\"nofollow noreferrer\">Microsoft Docs</a>.</p>\n\n<pre><code>Option Explicit\n\n'Type Parameter of the Application.InputBox method tells\n'the method to return a value of that type.  Below I've shown\n'having it return a text string\nPublic Const A_TEXT_STRING As Variant = 2\n\nSub Button1_Click()\n    Dim myVal As Variant\n\n    myVal = Application.InputBox(\"Enter Record Name\", _\n                           Title:=\"RECORD NAME\", _\n                           Type:=A_TEXT_STRING)\n    'If myVal equals the vbNullString type then\n    'the person pressed OK without entering any data\n    If myVal = vbNullString Then\n        MsgBox \"Please Select a record\", Buttons:=vbOKOnly, Title:=\"SELECT RECORD\"\n    'if myVal is equal to False (boolean value) then the user pressed\n    'the Cancel button.  By checking for not equal, that means that the user pressed\n    'Ok and entered a value.  You'll need to handle the condition of valid values\n    ElseIf myVal &lt;&gt; False Then\n        Range(\"A1\").Value2 = myVal\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 3016287, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rZREk.png?s=128&g=1", "display_name": "levraininjaneer", "link": "https://stackoverflow.com/users/3016287/levraininjaneer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1984, "favorite_count": 0, "accepted_answer_id": 52184266, "answer_count": 2, "score": 0, "last_activity_date": 1607905026, "creation_date": 1536138923, "last_edit_date": 1607905026, "question_id": 52181431, "link": "https://stackoverflow.com/questions/52181431/how-to-tell-the-difference-between-cancel-and-ok-with-an-empty-textbox-of-an", "title": "How to tell the difference between &quot;cancel&quot; and &quot;OK&quot; with an empty textbox of an InputBox?", "body": "<p>A VBA inputBox returns an empty string when the cancel button is pressed.<br />\nWhen OK is pressed, it the text in its textbox.<br />\nThe inputBox's third positional argument is the initial text in its textbox. The default value for this argument is &quot;&quot;.</p>\n<p>I use an inputBox to ask a user to specify the name for a new record when he clicks an &quot;Add Record&quot; button. If he presses &quot;cancel&quot;, I exit the sub.</p>\n<p>If he fails to enter a name, or enters one and deletes it, I want a msgBox to tell him he must specify a unique record name.</p>\n<p>How do I tell the difference between &quot;cancel&quot; and &quot;OK&quot; with an empty textbox?</p>\n<p>I found several similar questions but none solved my problem.</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "xmlhttprequest", "screen-scraping"], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1536153557, "post_id": 52182184, "comment_id": 91321979, "body": "very nice answer"}, {"owner": {"reputation": 33, "user_id": 10316585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb827dc2937e25ce0286ddca7518386?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice", "link": "https://stackoverflow.com/users/10316585/maurice"}, "edited": false, "score": 1, "creation_date": 1536158596, "post_id": 52182184, "comment_id": 91325408, "body": "Thanks for your very detailed answer! this is great!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 4, "last_activity_date": 1536165554, "last_edit_date": 1536165554, "creation_date": 1536141149, "answer_id": 52182184, "question_id": 52181293, "link": "https://stackoverflow.com/questions/52181293/scrape-website-with-xml-http-request-with-excel-vba-wait-for-the-page-to-fully/52182184#52182184", "title": "Scrape website with XML HTTP request with Excel VBA: wait for the page to fully load", "body": "<h2>REST API HTTP Request:</h2>\n\n<p>Your current method does not allow for the page to load fully as you have noted. You can formulate a REST API <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">XMLHTTPrequest</a>, using URLEncode to pass an encoded URL string to the API. The server sends back a JSON response containing the value you are after and lots of other info as well.</p>\n\n<p>I demonstrate two methods of extracting the price info from the returned JSON string: \u2460 Using the <code>Split</code> function to extract the price by generating substrings until the required string is left; \u2461 Using a <code>JSONParser</code> to navigate the JSON structure and return the required value.</p>\n\n<p><strong>Code:</strong></p>\n\n<p>The following uses <code>Split</code> to extract the value.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetPrice()\n    Const BASE_URL As String = \"https://www.ah.nl/service/rest/delegate?url=\"\n    Dim URL As String, sResponse As String, price As String\n    URL = BASE_URL &amp; Application.WorksheetFunction.EncodeURL(\"/producten/product/wi3640/lu-bastogne-biscuits-original\")\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", URL, False\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n    price = Split(Split(sResponse, \"\"\"now\"\":\")(1), \"}\")(0)\n    Debug.Print price\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2><strong>Parsing the JSON response:</strong></h2>\n\n<p><strong>Using <code>Split</code>:</strong></p>\n\n<p>You could read the whole JSON response into a JSON object using a JSON parser, for example <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">JSONConverter.bas</a>. Then parse that object for price. I found it simpler to use <a href=\"https://support.office.com/en-us/article/Split-Function-876F246A-5144-44FA-889F-10078C7878F5\" rel=\"nofollow noreferrer\">Split</a> function to extract the required info shown below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/AShSom.png\" width=\"300\"></p>\n\n<p>Split returns a zero-based, one-dimensional array containing a specified number of substrings based on splitting the input string on a specified delimiter.</p>\n\n<p>In the line,</p>\n\n<pre><code>price = Split(Split(sResponse, \"\"\"now\"\":\")(1), \"}\")(0)\n</code></pre>\n\n<p>I have two nested Split statements. These consecutively split the response JSON string to extract the price <code>1.55</code>.</p>\n\n<p>The first split is using <code>\"now\":</code> as the delimiter resulting in an array as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XN2Bu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XN2Bu.png\" alt=\"enter image description here\"></a></p>\n\n<p>The target price you can see is in the string at position 1.</p>\n\n<p>So, that string is extracted with:</p>\n\n<pre><code>Split(sResponse, \"\"\"now\"\":\")(1)\n</code></pre>\n\n<p>We then need to get just the price so use <code>Split</code> again to grab the <code>1.55</code> by using the delimiter <code>\"}\"</code>:</p>\n\n<pre><code>Split(Split(sResponse, \"\"\"now\"\":\")(1), \"}\")\n</code></pre>\n\n<p>This results in the following array (shortened as quite long):</p>\n\n<p><a href=\"https://i.stack.imgur.com/NDPWE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NDPWE.png\" alt=\"enter image description here\"></a></p>\n\n<p>The price we want is now at position 0 in the new array which is why we can use the following to extract the response.</p>\n\n<pre><code>price = Split(Split(sResponse, \"\"\"now\"\":\")(1), \"}\")(0)\n</code></pre>\n\n<p><strong>Using JSON parser:</strong></p>\n\n<p>If you want to traverse the json structure you would use the following:</p>\n\n<pre><code>Dim json As Object\nSet json = JsonConverter.ParseJson(sResponse)(\"_embedded\")(\"lanes\")(5)(\"_embedded\")(\"items\")(1)(\"_embedded\")(\"product\")(\"priceLabel\")\nDebug.Print json(\"now\")\n</code></pre>\n\n<p>After downloading and adding the <code>JSONConverter.bas</code>, you then add a reference to <code>Microsoft Scripting Runtime</code> via <code>VBE &gt; Tools &gt; References</code>. The \nabove <code>Set json</code> code statement represents the path to the price, as seen in the JSON structure below. I have collapsed some detail to make the path clearer. You would insert the above couple of lines, into the original code, in place of the <code>Split</code> line.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7fPf3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7fPf3.png\" alt=\"JSON Path\"></a></p>\n\n<p>In the diagram above <code>[]</code> denotes a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/collection-object\" rel=\"nofollow noreferrer\"><code>collection</code></a> object which needs to be accessed via index, e.g.  <code>JsonConverter.ParseJson(sResponse)(\"_embedded\")(\"lanes\")(5)</code>. The <code>{}</code> denotes a <a href=\"https://msdn.microsoft.com/es-es/vba/language-reference-vba/articles/dictionary-object\" rel=\"nofollow noreferrer\"><code>dictionary</code></a> object which can be accessed by key e.g. <code>JsonConverter.ParseJson(sResponse)(\"_embedded\")(\"lanes\")(5)(\"_embedded\")</code>. The syntax in my line,</p>\n\n<pre><code>Set json = JsonConverter.ParseJson(sResponse)(\"_embedded\")(\"lanes\")(5)(\"_embedded\")(\"items\")(1)(\"_embedded\")(\"product\")(\"priceLabel\")\n</code></pre>\n\n<p>demonstrates the different syntax to navigate these two object types.</p>\n"}], "owner": {"reputation": 33, "user_id": 10316585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb827dc2937e25ce0286ddca7518386?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice", "link": "https://stackoverflow.com/users/10316585/maurice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1974, "favorite_count": 0, "accepted_answer_id": 52182184, "answer_count": 1, "score": 1, "last_activity_date": 1581020313, "creation_date": 1536138534, "last_edit_date": 1581020313, "question_id": 52181293, "link": "https://stackoverflow.com/questions/52181293/scrape-website-with-xml-http-request-with-excel-vba-wait-for-the-page-to-fully", "title": "Scrape website with XML HTTP request with Excel VBA: wait for the page to fully load", "body": "<p>I'm trying to scrape a product price from a webpage using Excel VBA. The following code is working when using VBA Internet Explorer navigate request. However I would like to use an XML HTTP request instead to speed up the scraping process. </p>\n\n<p>In the IE request code I tell the application to wait for 3 seconds to have the page fully load and be able to scrape the product price. If this line is not included it won't find the price.</p>\n\n<p>I tried to change this with an XML HTTP request (see the second code) but without success. No price output was found. It seems that the code tries to scrape the page before it has been fully loaded. </p>\n\n<p>How can I adjust the XML HTTP request code so that it will find the product price (and only start searching/scraping when the page (and scripts) are fully loaded?</p>\n\n<p>The following IE request code is working:\n(immediate debug.prints a price of the product)</p>\n\n<pre><code>Sub Get_Product_Price_AH_IE()\n\nDim IE As New SHDocVw.InternetExplorer\nDim HTMLDoc As MSHTML.HTMLDocument\n\nDim AHArticles As MSHTML.IHTMLElementCollection\nDim AHArticle As MSHTML.IHTMLElement\n\nDim AHEuros As MSHTML.IHTMLElementCollection\nDim AHCents As MSHTML.IHTMLElementCollection\n\nDim AHPriceEuro As Double\nDim AHPriceCent As Double\nDim AHPrice As Double\n\n\nIE.Visible = False\nIE.navigate \"https://www.ah.nl/producten/product/wi3640/lu-bastogne-biscuits-original\"\n\n\n    Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE\n    Loop\n\n    Set HTMLDoc = IE.document\n\n'wait for the page to fully load to be able to get price data\nApplication.Wait Now + #12:00:03 AM#\n\n\nSet AHArticles = HTMLDoc.getElementsByTagName(\"article\")\n\nFor Each AHArticle In AHArticles\n\n If AHArticle.getAttribute(\"data-sku\") = \"wi3640\" Then\n\n        Set AHEuros = AHArticle.getElementsByClassName(\"price__integer\")\n        Set AHCents = AHArticle.getElementsByClassName(\"price__fractional\")\n\n       AHPriceEuro = AHEuros.Item(0).innerText\n       AHPriceCent = AHCents.Item(0).innerText\n\n      AHPrice = AHPriceEuro + (AHPriceCent / 100)\n\nDebug.Print AHPrice\n\n            Exit For\n        End If\n\n\nNext AHArticle\n\nIE.Quit\n\nEnd Sub\n</code></pre>\n\n<p>The following XML HTTP request is not giving the desired output (no price is printed in the immediate debug screen):</p>\n\n<pre><code>Sub Get_Product_Price_AH_XML()\n\nDim XMLReq As New MSXML2.XMLHTTP60\nDim HTMLDoc As New MSHTML.HTMLDocument\n\nDim AHArticles As MSHTML.IHTMLElementCollection\nDim AHArticle As MSHTML.IHTMLElement\n\nDim AHEuros As MSHTML.IHTMLElementCollection\nDim AHCents As MSHTML.IHTMLElementCollection\n\nDim AHPriceEuro As Double\nDim AHPriceCent As Double\nDim AHPrice As Double\n\n\nXMLReq.Open \"GET\", \"https://www.ah.nl/producten/product/wi3640/lu-bastogne-biscuits-original\", False\nXMLReq.send\n\n\nIf XMLReq.Status &lt;&gt; 200 Then\n    MsgBox \"Problem\" &amp; vbNewLine &amp; XMLReq.Status &amp; \" - \" &amp; XMLReq.statusText\n    Exit Sub\n    End If\n\nHTMLDoc.body.innerHTML = XMLReq.responseText\n\n\nApplication.Wait Now + #12:00:03 AM#\n\n\nSet AHArticles = HTMLDoc.getElementsByTagName(\"article\")\n\nFor Each AHArticle In AHArticles\n\n If AHArticle.getAttribute(\"data-sku\") = \"wi3640\" Then\n\n        Set AHEuros = AHArticle.getElementsByClassName(\"price__integer\")\n        Set AHCents = AHArticle.getElementsByClassName(\"price__fractional\")\n\n       AHPriceEuro = AHEuros.Item(0).innerText\n       AHPriceCent = AHCents.Item(0).innerText\n\n      AHPrice = AHPriceEuro + (AHPriceCent / 100)\n\nDebug.Print AHPrice\n\n            Exit For\n        End If\n\n\nNext AHArticle\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "compare"], "comments": [{"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "edited": false, "score": 0, "creation_date": 1536149552, "post_id": 52181200, "comment_id": 91319405, "body": "I might be bit slow today, but what exactly do you mean by &quot;This code works fine but it does not work when both columns A in Sheet 1 and column C in Sheet 2 has tables&quot;? I thought you mean that both columns are part of range formated as table, but when I tried that the code worked ok for me... Also - what does it mean that it doesnt work? It shows error or runs without error, but gives wrong data?"}, {"owner": {"reputation": 11, "user_id": 9631590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdee2a52cfb4e09915274a64b15beb8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/9631590/abhishek"}, "reply_to_user": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "edited": false, "score": 0, "creation_date": 1536157184, "post_id": 52181200, "comment_id": 91324466, "body": "yes, i meant when the range is formatted as table. The code runs without any errors but does not delete the rows from the table."}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "edited": false, "score": 0, "creation_date": 1536172063, "post_id": 52181200, "comment_id": 91332503, "body": "I recreated the file again to make sure and again it works as intended although my data sets are formatted as table. Is there anything else on the Sheet 1? Did you try stepping through the code to see what happens when the delete line is executed?"}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "edited": false, "score": 0, "creation_date": 1536172531, "post_id": 52181200, "comment_id": 91332710, "body": "I am wondering what might cause this behaviour - if there was anything in sheet 1 that prevented the deletion of line, then it would most probably cause an error. For example if there was a pivot table. So if you see no error I would guess it is more likely that match is not found. Again - stepping through the code to see how it behaves would be the best course of action - does it recognize a match? If no - why? If yes - why doesnt it delete the line? That is how I would proceed."}, {"owner": {"reputation": 11, "user_id": 9631590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdee2a52cfb4e09915274a64b15beb8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/9631590/abhishek"}, "reply_to_user": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "edited": false, "score": 0, "creation_date": 1536214957, "post_id": 52181200, "comment_id": 91344533, "body": "Hi, Thanks! its working for me after changing the sheet references. Also, i would want this code to delete no matches from other worksheets as well except first two sheets."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9631590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdee2a52cfb4e09915274a64b15beb8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/9631590/abhishek"}, "edited": false, "score": 0, "creation_date": 1538590708, "post_id": 52198601, "comment_id": 92199962, "body": "Hi, thanks for your help on previous query. Now i need to run this code only on filtered rows from column A. However, this code is considering the unfiltered rows and deleting the no matches. I want it to delete no matches only from the filtered rows. Thanks in advance!"}, {"owner": {"reputation": 11, "user_id": 9631590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdee2a52cfb4e09915274a64b15beb8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/9631590/abhishek"}, "edited": false, "score": 0, "creation_date": 1538590936, "post_id": 52198601, "comment_id": 92200053, "body": "ThisWorkbook.Worksheets(&quot;Sheet2&quot;).Activate ActiveSheet.ListObjects(&quot;Table1&quot;).Range.AutoFilter Field:=3, Criteria1:= _         Array(&quot;Num&quot;, &quot;ID&quot;, &quot;S&quot;), Operator:= _         xlFilterValues                  lr = sh.Cells(Rows.Count, 1).End(xlUp).Row         For x = lr To 7 Step -1              If Application.WorksheetFunction.CountIf(wn.Range(&quot;B:B&quot;), sh.Cells(x, 1).Value) = 0 Then             sh.Rows(x).EntireRow.Delete                 End If             Next x             ActiveSheet.ListObjects(&quot;Table1&quot;).Range.AutoFilter Field:=3"}], "tags": [], "owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1538633628, "last_edit_date": 1538633628, "creation_date": 1536218570, "answer_id": 52198601, "question_id": 52181200, "link": "https://stackoverflow.com/questions/52181200/compare-table-to-a-list-in-other-worksheet-and-remove-no-matches/52198601#52198601", "title": "Compare table to a list in other worksheet and remove no matches", "body": "<p>In order to have it run through more sheets you can use code like this</p>\n\n<pre><code>Sub cycle_sheets()\nFor Each sh In Worksheets\n    If sh.Name &lt;&gt; \"Sheet2\" Then\n        'your code to cycle through the data where instead of Sheets(\"SheetX\"). you use sh. like this\n        sh.Rows(x).EntireRow.Delete\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>this will go through all worksheets and for all that are named differently than \"Sheet2\" it will perform what is inside the if. So you only need to take your code, change the Sheet reference and put it inside the if.</p>\n\n<p>Edit:\nif you want it to skip rows that are not visible due to filtering you can check the row before determining if you want to delete it using</p>\n\n<pre><code>If sh.Rows(x).Hidden = False Then\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9631590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cdee2a52cfb4e09915274a64b15beb8?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/9631590/abhishek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538633628, "creation_date": 1536138237, "last_edit_date": 1536215400, "question_id": 52181200, "link": "https://stackoverflow.com/questions/52181200/compare-table-to-a-list-in-other-worksheet-and-remove-no-matches", "title": "Compare table to a list in other worksheet and remove no matches", "body": "<p>I have the following code which compares two lists (Column A in Sheet 1 and Column C in Sheet 2) and deletes the values which are not present in the list of Sheet 2. This code works fine but it does not work when both columns A in Sheet 1 and column C in Sheet 2 has tables. Please let me know how I can modify this code to work for tables as well. Also, how to delete no matches from multiple worksheets having a list in Column C (Sheet 2) constant?</p>\n\n<pre><code>Sub Stridhan()\n\nDim lr As Integer, x As Integer   \nlr = ThisWorkbook.Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\nApplication.ScreenUpdating = False  \nFor x = lr To 2 Step -1  \n    If Application.WorksheetFunction.CountIf(Sheets(\"Sheet2\").Range(\"C:C\"), Sheets(\"Sheet1\").Cells(x, 1).Value) = 0 Then  \n        Sheets(\"Sheet1\").Rows(x).EntireRow.Delete  \n    End If  \nNext x  \nApplication.ScreenUpdating = True  \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1536137674, "post_id": 52180904, "comment_id": 91311956, "body": "seems like you&#39;re storing <code>left1()</code> updated values in Sheet5 column E: can&#39;t you read its values from there at the beginning of your sub (i.e. <code>start1 = Sheet3.Range(&quot;E&quot; &amp; m)</code>)?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1536137749, "creation_date": 1536137749, "answer_id": 52181060, "question_id": 52180904, "link": "https://stackoverflow.com/questions/52180904/keeping-values-in-an-array-after-loop-so-the-values-can-be-used-again/52181060#52181060", "title": "Keeping values in an array after loop so the values can be used again", "body": "<p>If you change <code>Dim left1(5 To 248) As Integer</code> to <code>Static left1(5 To 248) As Integer</code>, left1 will already be instantiated and populated the second time you run the btnEnter_click sub procedure with the values left in the array after the first time the sub procedure was run.</p>\n\n<p>I cannot determine from your code what you plan to do with the repeated values.</p>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 1, "last_activity_date": 1536139071, "creation_date": 1536139071, "answer_id": 52181492, "question_id": 52180904, "link": "https://stackoverflow.com/questions/52180904/keeping-values-in-an-array-after-loop-so-the-values-can-be-used-again/52181492#52181492", "title": "Keeping values in an array after loop so the values can be used again", "body": "<p>You could make a variable as <code>Static</code>, as @Jeeped answered, or you could create a public variable outside procedure:</p>\n\n<pre><code>Public left1(5 To 248) As Integer\n\nSub MySub\n    'Your code here\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10283722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc3f3620c52d7567cde20fd4747f204?s=128&d=identicon&r=PG&f=1", "display_name": "MarkHav", "link": "https://stackoverflow.com/users/10283722/markhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 52181060, "answer_count": 2, "score": 0, "last_activity_date": 1536139071, "creation_date": 1536137221, "question_id": 52180904, "link": "https://stackoverflow.com/questions/52180904/keeping-values-in-an-array-after-loop-so-the-values-can-be-used-again", "title": "Keeping values in an array after loop so the values can be used again", "body": "<p>I am using an array which values are calculated in a loop as shown: </p>\n\n<pre><code>Sub btnEnter_click()\nDim partno As String\nDim batch1 As String\nDim start1 As Integer\nDim left1(5 To 248) As Integer\nDim m As Integer\nDim taken(5 To 248) As Integer\nDim vlookres As String\n\nOn Error Resume Next\nFor m = 5 To 248\n    partno = Sheet5.Range(\"A\" &amp; m)\n    batch1 = Sheet5.Range(\"B\" &amp; m)\n    start1 = Sheet5.Range(\"D\" &amp; m)\n    vlookres = Application.VLookup(partno, Sheet3.Range(\"A5:C46\"), 3, False)\n    If vlookres = \"\" Then\n        vlookres = 0\n    End If\n\n    taken(m) = taken(m) + vlookres\n    vlookres = 0\n    If taken(m) &gt;= batch1 Then\n        taken(m) = 0\n    End If\n    If left1(m) = 0 Then\n        left1(m) = start1 - taken(m)\n    Else\n        left1(m) = left1(m) - taken(m)\n    End If\n    Sheet5.Range(\"E\" &amp; m) = left1(m)\n Next m\n\nSheet3.Cells.Range(\"C5:C46\").ClearContents     \n</code></pre>\n\n<p>End Sub</p>\n\n<p>The array <strong>left1</strong> is the amount left in a batch and its purpose is to display how much is left in a batch to the user. I am using this if statement to calculate what should be displayed.</p>\n\n<pre><code>If left1(m) = 0 Then\n        left1(m) = start1 - taken(m)\n    Else\n        left1(m) = left1(m) - taken(m)\n    End If\n</code></pre>\n\n<p>So on the first run through the value of <strong>left1</strong> is always 0 and it will take it away from the start amount in the batch (<strong>start1</strong>). Then what I want to do, is if it isn't the first run through then the value left should be stored so that the value taken can be subtracted from the last value of <strong>left1</strong>. eg. batch starts at 100 (<strong>start1</strong> = 100), user takes 10 (<strong>taken(m)</strong> = 10) and then <strong>left1</strong> = 90.This works fine as it's the first run through. But then if the user takes another 15 at another time after this, then it should take the 15 from 90 resulting in 75. This is not the case as <strong>left1(m)</strong> is reset after the sub has ended meaning the result shown is 85. Is there anyway to store the values in <strong>left1</strong> to get it do work as described?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "edited": false, "score": 0, "creation_date": 1536137390, "post_id": 52180852, "comment_id": 91311755, "body": "How do you update your Access file? Is there a macro inside the Access file that you need to run for the updates to be done?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1536137424, "post_id": 52180852, "comment_id": 91311783, "body": "I would rather try to modify my connections to Access. I am quite sure you CAN read from Access even if db is open (as long it&#39;s not opened in exclusive mode)"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "edited": false, "score": 0, "creation_date": 1536137523, "post_id": 52180852, "comment_id": 91311844, "body": "@Teasel The main Access file is updated by other users. However it is very inconvenient for them to always close the main file so I need to make duplicates based on the main Access file that will keep updating periodically."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1536137592, "post_id": 52180852, "comment_id": 91311891, "body": "@PatrickHonorez I am actually searching for a way to do so. I have actually asked 2 related questions in superuser: <a href=\"https://superuser.com/questions/1355046/how-can-a-read-only-purpose-data-connection-to-ms-excel-access-from-ms-excel-pre/1355100?noredirect=1#comment2034060_1355100\" title=\"how can a read only purpose data connection to ms excel access from ms excel pre\">superuser.com/questions/1355046/&hellip;</a> and <a href=\"https://superuser.com/questions/1355402/how-to-make-a-read-only-data-connection-to-a-read-write-locked-ms-access-using-m\" title=\"how to make a read only data connection to a read write locked ms access using m\">superuser.com/questions/1355402/&hellip;</a> but there might be no option. I tried disabling the <code>record-locking-level</code> but it didn&#39;t work"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1536141327, "post_id": 52180852, "comment_id": 91314339, "body": "@Pherdindy first step is to make sure the db is not open in exclusive mode. You can easily test it by opening 2 instances of Access on the same pc. 2d point is HOW do you read that data ? You should perhaps provide details on your data connection properties?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1536141433, "post_id": 52180852, "comment_id": 91314402, "body": "btw I can&#39;t see your images from my workplace (firewalled)"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1536155579, "post_id": 52180852, "comment_id": 91323398, "body": "How are you connecting to your DB from Excel?  I&#39;ve just checked, and an old Workbook using an ADODB connection to an Access DB seems to work fine when someone has the DB open - even when the specific <i>Table</i> is open in Access."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1536156740, "post_id": 52180852, "comment_id": 91324187, "body": "@PatrickHonorez I&#39;ll check whether it&#39;s in exclusive mode tomorrow at work. Although I saw in the settings something like <code>Default open mode = Shared</code>--which is the default, the other option is <code>Exclusive</code> which isn&#39;t selected."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1536156810, "post_id": 52180852, "comment_id": 91324233, "body": "I connect by going to the <code>Data</code> tab -&gt; <code>From Database</code> -&gt; <code>From Microsoft Access Database</code> in MS Excel then I just refresh the data through the connection"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1536207634, "post_id": 52180852, "comment_id": 91342148, "body": "@PatrickHonorez I am able to open 2 instances of Access in my computer. However, when I try to open the file that I want to connect to, I can only open one instance. When I try to open it again on the same PC, it will only go to the window of the first instance, but that&#39;s about it."}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1536138443, "post_id": 52181047, "comment_id": 91312457, "body": "Right. I didn&#39;t consider that but I might be able to work with that although the issue is what if there are many different users on different computers? I believe the personal macro workbook won&#39;t carry over. All files is shared over a network/cloud and has to be robust when anyone uses it"}, {"owner": {"reputation": 654, "user_id": 10092563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0cbf709786e4a23121420c2a6b000d?s=128&d=identicon&r=PG&f=1", "display_name": "iamanigeeit", "link": "https://stackoverflow.com/users/10092563/iamanigeeit"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1536139409, "post_id": 52181047, "comment_id": 91313106, "body": "Actually, after thinking about it, @Patrick Honorez makes the most sense. It does not make sense to design concurrency support like this.."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1536139800, "post_id": 52181047, "comment_id": 91313398, "body": "Yeah that was the solution I thought about at first, but I cannot seem to find a way to do it. My access options is defaulted to be shared to begin with: under <code>Client Settings</code> -&gt; <code>Advanced</code> -&gt; <code>Default open mode = Shared</code> and <code>Default record locking = No locks</code> but still cannot establish a connection when in use by another user."}], "tags": [], "owner": {"reputation": 654, "user_id": 10092563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0cbf709786e4a23121420c2a6b000d?s=128&d=identicon&r=PG&f=1", "display_name": "iamanigeeit", "link": "https://stackoverflow.com/users/10092563/iamanigeeit"}, "is_accepted": false, "score": 0, "last_activity_date": 1536137699, "creation_date": 1536137699, "answer_id": 52181047, "question_id": 52180852, "link": "https://stackoverflow.com/questions/52180852/how-to-run-a-macro-that-is-stored-in-a-module-in-a-workbook-after-the-workbook-c/52181047#52181047", "title": "How to run a macro that is stored in a module in a workbook after the Workbook.Close method?", "body": "<p>If you don't need data from <code>Excel-file.xlsm</code> anymore, you can put the macro in your Personal Macro Workbook.</p>\n"}, {"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1536210561, "post_id": 52188193, "comment_id": 91342946, "body": "I tried on both of the computers at office one with Excel 2007 and Excel 2016 changing the connection string value of <code>JET OLEDB:Database Locking Mode</code> to 1 still makes me unable to make a data connection with an open Access file. A person was able to offer a code to actually extract data from an Access file as seen in this superuser post: <a href=\"https://superuser.com/questions/1355402/how-to-make-a-read-only-data-connection-to-a-read-write-locked-ms-access-using-m/1355468#1355468\" title=\"how to make a read only data connection to a read write locked ms access using m\">superuser.com/questions/1355402/&hellip;</a> but I am still interested in making a more conventional data connection first before using VBA."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1536210733, "post_id": 52188193, "comment_id": 91343000, "body": "Not sure if it has anything to do with my Access being exclusive or not, I added the connection string on the main post--as well as a comment regarding my Access being exclusive or not."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1536159412, "creation_date": 1536159412, "answer_id": 52188193, "question_id": 52180852, "link": "https://stackoverflow.com/questions/52180852/how-to-run-a-macro-that-is-stored-in-a-module-in-a-workbook-after-the-workbook-c/52188193#52188193", "title": "How to run a macro that is stored in a module in a workbook after the Workbook.Close method?", "body": "<p>I tried to reproduce your situation, and indeed, I couldn't refresh the table once the db was open.  So I went to the Connection Properties, Definition tab, Connection String, and I changed:</p>\n\n<pre><code>Jet OLEDB:Database Locking Mode=0\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Jet OLEDB:Database Locking Mode=1\n</code></pre>\n\n<p>Now I can refresh the table in Excel even if it is open in Access.</p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536208782, "creation_date": 1536137055, "last_edit_date": 1536208782, "question_id": 52180852, "link": "https://stackoverflow.com/questions/52180852/how-to-run-a-macro-that-is-stored-in-a-module-in-a-workbook-after-the-workbook-c", "title": "How to run a macro that is stored in a module in a workbook after the Workbook.Close method?", "body": "<p>I have a data connection from my Excel file to an Access file. The issue is that, you cannot establish a data connection to an Access file if it's being used. So the workaround is to actually copy the Access file that is being used and store it in a different location, then the Excel file will connect to that copy.</p>\n\n<p>However, the duplicated Access file will need to be updated eventually, but it cannot be updated when the Excel file that is connecting to it is open. So the only way to actually update the duplicated Access file is to close the Excel file then overwrite it. I plan to achieve this by using 2 steps:</p>\n\n<p>1.) Close the Excel file</p>\n\n<pre><code>Workbooks(\"Excel-file.xlsm\").Close\n</code></pre>\n\n<p>2.) Run a batch file that will update the Access file:</p>\n\n<pre><code>Sub TryShell()\n\n  Dim PathCrnt As String\n\n  PathCrnt = ActiveWorkbook.Path\n  Call Shell(PathCrnt &amp; \"\\TryShell.bat \" &amp; PathCrnt)\n\nEnd Sub\n</code></pre>\n\n<p>The issue is that the lines after closing the excel file won't run anymore (for example):</p>\n\n<pre><code>Workbooks(\"Excel-file.xlsm\").Close\nMsgBox \"Hello\"\n</code></pre>\n\n<p>Hello will not display anymore.</p>\n\n<p>For those interested in seeing my connection string to MS Access: </p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0;\nUser ID=Admin;\nData Source=C:\\Users\\ACER\\Desktop\\Test.MDB;\nMode=Share Deny Write;\nExtended Properties=\"\";\nJet OLEDB:System database=\"\";\nJet OLEDB:Registry Path=\"\";\nJet OLEDB:Engine Type=5;\nJet OLEDB:Database Locking Mode=0; (changing to a value of 1 still results to an error to connect)\nJet OLEDB:Global Partial Bulk Ops=2;\nJet OLEDB:Global Bulk Transactions=1;\nJet OLEDB:New Database Password=\"\";\nJet OLEDB:Create System Database=False;\nJet OLEDB:Encrypt Database=False;\nJet OLEDB:Don't Copy Locale on Compact=False;\nJet OLEDB:Compact Without Replica Repair=False;\nJet OLEDB:SFP=False;\nJet OLEDB:Support Complex Data=False\n</code></pre>\n"}, {"tags": ["vba", "excel", "module", "label", "caption"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536137100, "post_id": 52180121, "comment_id": 91311592, "body": "Declare your module sub as public. Also, what is Friend Sub?"}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536137739, "post_id": 52180121, "comment_id": 91311994, "body": "The Freind Sub is the code to clear all check marks afterwards. I have renamed &quot;Private&quot; to &quot; Public&quot; in the code modul but the  sheet module still doesnt get activated."}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1536138980, "post_id": 52180121, "comment_id": 91312819, "body": "OK.. I am very sorry to be this guy but I have no idea what your issue is. Please make sure that in the problem description the current behaviour and the desired behaviour is clearly distinguishable and that the problem is clear. A problem is always the difference between desired and current behaviour."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536139349, "post_id": 52180121, "comment_id": 91313081, "body": "What do you mean by activated? And prefix the sub with the module name."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1536140004, "post_id": 52180121, "comment_id": 91313521, "body": "Thanks to  Lucas Raphael Pianegonda i have rephrased the the porblem a bit. By activated I mean when the button is pushed the label (which is reponsible for the check mark) doesnt run as the link  between the codemodul for the button and the sheet modul for the label is missing perhaps."}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "is_accepted": true, "score": 0, "last_activity_date": 1536224742, "creation_date": 1536224742, "answer_id": 52200447, "question_id": 52180121, "link": "https://stackoverflow.com/questions/52180121/how-to-put-the-vba-code-contained-in-code-module-in-sheet-module/52200447#52200447", "title": "How to put the VBA code contained in code module in sheet module", "body": "<p>The answer ist simple this:</p>\n\n<pre><code> Sub Schaltfl\u00e4che2_Klicken()\n Call prcResetLabels\n With Sheets(\"Table1\")\n .Range(\"A1\").End(xlUp).Offset(1, 0).Value = Environ(\"USERNAME\")\n End With\n Call prcSetLabel(probjLabel:=Table1.Label1)\n End Sub\n\n Private Sub prcSetLabel(ByVal probjLabel As Object)\n With probjLabel\n .Object.Caption = \"P\"\n End With\n End Sub\n Public Sub prcResetLabels()\n Dim objOLEObject As OLEObject\n\n For Each objOLEObject In Table1.OLEObjects\n With objOLEObject\n     If .progID = \"Forms.Label.1\" Then _\n        .Object.Caption = vbNullString\n End With\n Next\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 52200447, "answer_count": 1, "score": 0, "last_activity_date": 1536224742, "creation_date": 1536134574, "last_edit_date": 1536139639, "question_id": 52180121, "link": "https://stackoverflow.com/questions/52180121/how-to-put-the-vba-code-contained-in-code-module-in-sheet-module", "title": "How to put the VBA code contained in code module in sheet module", "body": "<p>I have a button in the \"code module\" which runs a request. Next to the Button is a label included which shows a check mark a soon as the button has finished running.</p>\n\n<p>The button code is in the code modul. The codes for the label with the check mark is inlcuded in the workbook and sheet modul.</p>\n\n<p>Now, the issue is when I push the button it runs perfectly fine and does what it supposed to but the label with the check mark does not get activated. The reason might be because I have not included/referenced the workbook/sheet modul in my code modul. Hope for a bit help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IgaBY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IgaBY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Code in workbook Module:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Workbook_Open()\nCall Tabelle1.prcResetLabels\nEnd Sub\n</code></pre>\n\n<p>Code in Sheet Module:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Schaltfl\u00e4che2_Klicken()\nCall prcSetLabel(probjLabel:=Label1)\nEnd Sub\n\nPrivate Sub prcSetLabel(ByRef probjLabel As MSForms.Label)\nWith probjLabel\n.Caption = \"P\"\nEnd With\nEnd Sub\n\nFriend Sub prcResetLabels()\nDim objOLEObject As OLEObject\nFor Each objOLEObject In OLEObjects\n   With objOLEObject\n        If .progID = \"Forms.Label.1\" Then _\n           .Object.Caption = vbNullString\n   End With\nNext\nEnd Sub\n</code></pre>\n\n<p>Code in Codemodul:</p>\n\n<pre><code>Public Sub Schaltfl\u00e4che2_Klicken()\nWith Sheets(\"Table1\")\n  .Range(\"A1\").End(xlUp).Offset(1, 0).Value = Environ(\"USERNAME\")\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10318905, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156119313908952/picture?type=large", "display_name": "user10318905", "link": "https://stackoverflow.com/users/10318905/user10318905"}, "edited": false, "score": 0, "creation_date": 1537429697, "post_id": 52181617, "comment_id": 91783314, "body": "Hi, I need a code for the browse button to select the file and then when i click the start button it will get the file from the browse button to run the macro."}], "tags": [], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "is_accepted": false, "score": 0, "last_activity_date": 1536139436, "last_edit_date": 1592644375, "creation_date": 1536139436, "answer_id": 52181617, "question_id": 52180068, "link": "https://stackoverflow.com/questions/52180068/how-to-to-code-on-browse-button-run-button/52181617#52181617", "title": "How to to code on browse button &amp; run button", "body": "<p>There are two ways to get to the code of a userform:</p>\n<h1>1 double-click on button you want the code to be run with</h1>\n<h1>2 right-click on userform and select &quot;Show Code&quot;</h1>\n<p><strong>Extra Tip:</strong></p>\n<p>Put the code you want to run in a seperate module and do this:</p>\n<pre><code>Private Sub CommandButton1_Click()\nCall modulename.subname ' this is your code\nEnd Sub\n</code></pre>\n<p>In this way you will be able to reuse your code.</p>\n<p><strong>Another Tip <a href=\"https://stackoverflow.com/help/how-to-ask\">HERE</a></strong></p>\n"}], "owner": {"reputation": 1, "user_id": 10318905, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156119313908952/picture?type=large", "display_name": "user10318905", "link": "https://stackoverflow.com/users/10318905/user10318905"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536139436, "creation_date": 1536134432, "last_edit_date": 1536135703, "question_id": 52180068, "link": "https://stackoverflow.com/questions/52180068/how-to-to-code-on-browse-button-run-button", "title": "How to to code on browse button &amp; run button", "body": "<p><a href=\"https://i.stack.imgur.com/3bFER.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3bFER.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I link the code for the run button with the file browse via the browse button?</p>\n"}, {"tags": ["vba", "password-protection", "salt"], "answers": [{"tags": [], "owner": {"reputation": 654, "user_id": 10092563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0cbf709786e4a23121420c2a6b000d?s=128&d=identicon&r=PG&f=1", "display_name": "iamanigeeit", "link": "https://stackoverflow.com/users/10092563/iamanigeeit"}, "is_accepted": true, "score": 0, "last_activity_date": 1536139741, "creation_date": 1536139741, "answer_id": 52181717, "question_id": 52179915, "link": "https://stackoverflow.com/questions/52179915/how-to-disable-save-as-excel-97-2003-using-vba-to-prevent-bypassing-salt/52181717#52181717", "title": "How to Disable Save As Excel 97-2003 using VBA to prevent bypassing salt?", "body": "<p>This is not possible if they can create their own file (they can copy the data out anyway).</p>\n\n<p>But if you're going to provide them a file, you can give it to them as xlsm and block them from doing SaveAs. Put this in <code>ThisWorkbook</code>:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    If SaveAsUI Then Cancel = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10318832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lh5k5dJGCcI/AAAAAAAAAAI/AAAAAAAANgQ/RvH0_5yfn3I/photo.jpg?sz=128", "display_name": "Nick Elbers", "link": "https://stackoverflow.com/users/10318832/nick-elbers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52181717, "answer_count": 1, "score": 0, "last_activity_date": 1536139741, "creation_date": 1536133975, "question_id": 52179915, "link": "https://stackoverflow.com/questions/52179915/how-to-disable-save-as-excel-97-2003-using-vba-to-prevent-bypassing-salt", "title": "How to Disable Save As Excel 97-2003 using VBA to prevent bypassing salt?", "body": "<p>I would like to disable the possibility to save a workbook (specifically) to an Excel 97-2003 workbook. So users cant disable the stronger protection salt, which is introduced in office 2013, and break the password easily.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 1, "last_activity_date": 1536134689, "creation_date": 1536134689, "answer_id": 52180143, "question_id": 52179813, "link": "https://stackoverflow.com/questions/52179813/data-validation-with-indirect-formula/52180143#52180143", "title": "Data Validation with Indirect formula", "body": "<p>Setting an <code>INDIRECT</code> Validation throws an error if the <code>INDIRECT</code> does not evaluate to a proper range <strong>at the time you create it</strong> - if you do it manually, you get a pop-up saying \"do you want to continue anyway\", but in VBA it just fails.  Testing with <code>DisplayAlerts = False</code> does not seem to fix this.</p>\n\n<p>The only options I can think of are to either populate BD2 with a temporary, valid, value, or to have a \"Null\" range included in an <code>IF</code> statement inside your <code>INDIRECT</code>, e.g. <code>Formula1:=\"=INDIRECT(IF(LEN(BD2)&gt;0,BD2,\"\"DropDown_Default\"\"))\"</code>, where <code>DropDown_Default</code> is a Named Range which contains a single blank cell.</p>\n"}], "owner": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 52180143, "answer_count": 1, "score": 0, "last_activity_date": 1593589865, "creation_date": 1536133674, "last_edit_date": 1593589865, "question_id": 52179813, "link": "https://stackoverflow.com/questions/52179813/data-validation-with-indirect-formula", "title": "Data Validation with Indirect formula", "body": "<p>I have created a VBA for Data Validation with indirect formula, but throws an error while running the macro. Am I missing something?</p>\n\n<pre><code>     With Selection.Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=\"=INDIRECT(BD2)\"\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 0, "last_activity_date": 1536134851, "creation_date": 1536134851, "answer_id": 52180198, "question_id": 52179811, "link": "https://stackoverflow.com/questions/52179811/removing-cells-with-duplicate-values-from-range-object/52180198#52180198", "title": "Removing cells with duplicate values from Range object", "body": "<p>Record a macro while issuing the Data, Remove duplicates command as that is precisely what that does.</p>\n"}], "owner": {"reputation": 525, "user_id": 2979741, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2aa7ff3d80cfe8dcbef20f5d238d157b?s=128&d=identicon&r=PG&f=1", "display_name": "Auberon", "link": "https://stackoverflow.com/users/2979741/auberon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536134851, "creation_date": 1536133670, "question_id": 52179811, "link": "https://stackoverflow.com/questions/52179811/removing-cells-with-duplicate-values-from-range-object", "title": "Removing cells with duplicate values from Range object", "body": "<p>I've a <code>Range</code> object which its cells contains duplicate values.</p>\n\n<p>How can I obtain a <code>Range</code> object with all duplicate values left out?</p>\n\n<p>Although not required, assume that every first unique occurrence should be in the resulting <code>Range</code> object.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1536133864, "post_id": 52179700, "comment_id": 91309711, "body": "What is the value of strTable ?"}, {"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 2, "creation_date": 1536134014, "post_id": 52179700, "comment_id": 91309796, "body": "does your database table name contain any spaces? if yes than add your database name in [  strTable ] (Square bracket). From where you get the Specification ID ? I cannot find any integer variable here .."}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1536136422, "post_id": 52179700, "comment_id": 91311188, "body": "@VincentG : strTable is same as strFile except the .xlsx extension."}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "reply_to_user": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1536136463, "post_id": 52179700, "comment_id": 91311212, "body": "@Tarun.P : the table names have underscores and no spaces. :) and i want to delete the row where spec id id a string called specification id, there are other rows which has integers which i want to retain."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1536137699, "post_id": 52179700, "comment_id": 91311971, "body": "There are many reasons why an unbracketed table name might be invalid becides spaces. Just bracket it, like Tarun P said, that should avoid most (but not all) possible invalid table names."}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1536137770, "post_id": 52179700, "comment_id": 91312018, "body": "@ErikvonAsmuth : do you mean : DoCmd.RunSQL (&quot;DELETE * FROM &quot; &amp; [strTable] &amp; &quot; WHERE SPEC_ID = &#39;Specification ID&#39;&quot;)  ??"}, {"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 3, "creation_date": 1536137827, "post_id": 52179700, "comment_id": 91312058, "body": "try this <code>DoCmd.RunSQL (&quot;DELETE * FROM [&quot; &amp; strTable &amp; &quot;] WHERE SPEC_ID = &#39;Specification ID&#39;&quot;)</code>"}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "reply_to_user": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1536137936, "post_id": 52179700, "comment_id": 91312128, "body": "@Tarun: thanks a lot that works :), however throws me a warning popup  which needs to be ignored, any advice for that?"}], "answers": [{"comments": [{"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "edited": false, "score": 0, "creation_date": 1536138085, "post_id": 52181147, "comment_id": 91312216, "body": "Thanks a lot. God bless you. :)"}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "edited": false, "score": 1, "creation_date": 1536211174, "post_id": 52181147, "comment_id": 91343124, "body": "the answer provided below is more safe to use , just incase any user wants to copy paste this code. Hence changing the accepted answer to the below one. But thanks for your help. :)"}], "tags": [], "owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1536138049, "creation_date": 1536138049, "answer_id": 52181147, "question_id": 52179700, "link": "https://stackoverflow.com/questions/52179700/dynamically-delete-a-row-from-every-table-inside-for-loop-in-access-vba/52181147#52181147", "title": "dynamically delete a row from every table inside for loop in access vba", "body": "<p>do like this</p>\n\n<pre><code>Docmd.SetWarnings False\n\nDoCmd.RunSQL (\"DELETE * FROM [\" &amp; strTable &amp; \"] WHERE SPEC_ID = 'Specification ID'\")\n\nDocmd.SetWarnings True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "edited": false, "score": 0, "creation_date": 1536164351, "post_id": 52188727, "comment_id": 91328930, "body": "Thanks @Brad. Would it not give me a pop-up before executing the delete in each table since there are almost 30 tables on which I am executing this on. Sorry but it&#39;s late night here and I am just being lazy in asking this question. ;) I have written a Python script post which I am calling this script so I am sure that no other table other than these would contain multiple rows containing &#39;Specification ID&#39;"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "edited": false, "score": 1, "creation_date": 1536165042, "post_id": 52188727, "comment_id": 91329258, "body": "Using <code>CurrentDb.Execute</code> does not show a popup when inserting/deleting/updating data. Second advantage: you can also call <code>CurrentDb.RecordsAffected</code> immediately after to check how many records were deleted. It seems like you know there will only be one but you can use this to confirm."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "edited": false, "score": 0, "creation_date": 1536165116, "post_id": 52188727, "comment_id": 91329283, "body": "You&#39;re calling this from Python?"}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "edited": false, "score": 1, "creation_date": 1536165170, "post_id": 52188727, "comment_id": 91329305, "body": "Wow that&#39;s cool if you can check logs with a command. Thanks a lot. I will check if this runs tomorrow early morning and let you know. :) Thanks a lot for taking your time out to reply. I don&#39;t use vba much I just search and edit whatever I find. Thanks for letting me know this I have a clearer concept. Yep I am executing this after I have some data from Python. Not exactly integrating it. However you can call a vba script via Python too. :)"}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "edited": false, "score": 0, "creation_date": 1536211110, "post_id": 52188727, "comment_id": 91343112, "body": "Hi @Brad I tested this and its working fine. :) Thanks a lot."}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": true, "score": 2, "last_activity_date": 1536161788, "last_edit_date": 1536161788, "creation_date": 1536161166, "answer_id": 52188727, "question_id": 52179700, "link": "https://stackoverflow.com/questions/52179700/dynamically-delete-a-row-from-every-table-inside-for-loop-in-access-vba/52188727#52188727", "title": "dynamically delete a row from every table inside for loop in access vba", "body": "<p>Using <code>DoCmd.SetWarnings</code> is a recipe for trouble. What if there is an error in the sql and your code exits without setting the warnings back to true? All sorts of weird stuff happens. Instead use the simpler and just as easy</p>\n\n<pre><code>CurrentDb.Execute \"DELETE * FROM [\" &amp; strTable &amp; \"] WHERE SPEC_ID = 'Specification ID'\"\n</code></pre>\n\n<p>You'll still need to check that strTable doesn't have <code>[</code> or <code>]</code> in the name (otherwise the bracketing won't be effective) and you'll need to either remove them or escape them (depending on how your actual table is named).</p>\n"}], "owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 52188727, "answer_count": 2, "score": 0, "last_activity_date": 1536161788, "creation_date": 1536133374, "last_edit_date": 1536136875, "question_id": 52179700, "link": "https://stackoverflow.com/questions/52179700/dynamically-delete-a-row-from-every-table-inside-for-loop-in-access-vba", "title": "dynamically delete a row from every table inside for loop in access vba", "body": "<p>I am trying to match excel files which is placed in a folder with tables which exist in access database (with the same name as my excel files) and trying to import data which is in excel to access.</p>\n\n<pre><code>Sub import()\n\nDim blnHasFieldNames As Boolean\nDim strWorksheet As String, strTable As String\nDim strPath As String, strPathFile As String\n\nblnHasFieldNames = True\n\n\nstrPath = \"D:\\PersonalData\\working_table\\\"\n\nstrWorksheet = \"Sheet1\"\n\n' Import the data from each workbook file in the folder\nstrFile = Dir(strPath &amp; \"*.xlsx\")\nDo While Len(strFile) &gt; 0\n      strPathFile = strPath &amp; strFile\n      strTable = Left(strFile, InStrRev(strFile, \".xlsx\") - 1)\n\n      DoCmd.TransferSpreadsheet acImport, _\n            acSpreadsheetTypeExcel9, strTable, strPathFile, _\n            blnHasFieldNames, strWorksheet &amp; \"$\"\n\n      DoCmd.RunSQL (\"DELETE * FROM \" &amp; strTable &amp; \" WHERE SPEC_ID = 'Specification ID'\")\n\n\n\n      strFile = Dir()\nLoop\n\n\n\nEnd Sub\n</code></pre>\n\n<p>I am successfully able to get the data into my access database tables, however my requirement is to delete the row from all such tables where <code>SPEC_ID = 'Specification ID'</code> . I am getting an error in line: </p>\n\n<pre><code>DoCmd.RunSQL (\"DELETE * FROM \" &amp; strTable &amp; \" WHERE SPEC_ID = 'Specification ID'\")\n</code></pre>\n\n<p>which states:</p>\n\n<p>Run-time error: '3131'\nSyntax error in FROM clause.</p>\n\n<p>Kindly guide me what I may have been doing wrong. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["regex", "vba", "outlook"], "comments": [{"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 1, "creation_date": 1536136288, "post_id": 52179355, "comment_id": 91311095, "body": "Currently, you are not asking a question. Please add one so people can try to help you. Try to be clear where the problem lies and spell out any error messages you might encounter."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536136647, "post_id": 52179355, "comment_id": 91311318, "body": "Also please clarify what you mean by &quot;catch&quot;: Do you want to simply match the pattern? Do you want to capture the next line in a capture group to subsequently process it? You might want to include an example of how the input looks and what part you want to match/capture."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1536147940, "post_id": 52179355, "comment_id": 91318317, "body": "Also relevant is which body?  Locating strings in the Html body will probably be much more difficult than locating them in the text body."}, {"owner": {"reputation": 49, "user_id": 5982075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2464f8db522c401829a683c191494a70?s=128&d=identicon&r=PG&f=1", "display_name": "Lispeenium", "link": "https://stackoverflow.com/users/5982075/lispeenium"}, "edited": false, "score": 0, "creation_date": 1536148073, "post_id": 52179355, "comment_id": 91318418, "body": "Thank You very much for Your replies, really apreciate it."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1536153939, "post_id": 52179355, "comment_id": 91322286, "body": "There are those who can apply regex in VBA but cannot work out a valid &quot;myString&quot;. As previously requested &quot; You might want to include an example of how the input looks&quot;."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1536158549, "post_id": 52179355, "comment_id": 91325371, "body": "I just realized something. If the current edit is an answer then revert back to a question and put the answer into an answer post."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1536167173, "post_id": 52179355, "comment_id": 91330258, "body": "You have confirmed, as I suspected, you are using the text body (.Body) and not the Html Body (.HtmlBody).  I believe text bodies are created by Outlook since every email I have examined has a text version of the Html body and these text versions are total consistent in their structure.  To create a text body: replace any existing white space with a single space, insert CRLFCRLF at the end of every block element and table cell and then delete all Html tags.  That is why, the text body is composed of lines."}, {"owner": {"reputation": 49, "user_id": 5982075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2464f8db522c401829a683c191494a70?s=128&d=identicon&r=PG&f=1", "display_name": "Lispeenium", "link": "https://stackoverflow.com/users/5982075/lispeenium"}, "edited": false, "score": 0, "creation_date": 1536221940, "post_id": 52179355, "comment_id": 91348132, "body": "Okay thank You. Actually the use of text body is usefull for me as it is composed of lines."}, {"owner": {"reputation": 10920, "user_id": 3390419, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/cXKh9.jpg?s=128&g=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/3390419/paolo"}, "edited": false, "score": 0, "creation_date": 1536222406, "post_id": 52179355, "comment_id": 91348383, "body": "I edited the question but then realized you inteded to have it this way and answered your own question. Please consider adding more information to help future readers."}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 5982075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2464f8db522c401829a683c191494a70?s=128&d=identicon&r=PG&f=1", "display_name": "Lispeenium", "link": "https://stackoverflow.com/users/5982075/lispeenium"}, "is_accepted": false, "score": 0, "last_activity_date": 1536222051, "creation_date": 1536222051, "answer_id": 52199607, "question_id": 52179355, "link": "https://stackoverflow.com/questions/52179355/how-can-use-regex-to-catch-the-next-line-that-follows-a-specific-string-in-vba/52199607#52199607", "title": "How can use RegEx to catch the next line that follows a specific string in VBA (Outlook)?", "body": "<p>Edit : Here is what I've found and did and that seems to work. This code will \n check if a specific string exists and You can do something with the line that \n follows it.</p>\n\n<pre><code> Function TestRegExp(myString As String)\n\n'Create objects.\nDim objRegExp As RegExp\nDim objMatch As Match\nDim colMatches   As MatchCollection\nDim RetStr As String\nDim result As String\n\n\n' Create a regular expression object.\nSet objRegExp = New RegExp\n\n'Set the pattern by using the Pattern property.\nobjRegExp.Pattern = \"Order[\\r\\n]+([^\\r\\n]+)\"\n\n' Set Case Insensitivity.\nobjRegExp.IgnoreCase = True\n\n'Set global applicability.\nobjRegExp.Global = True\n\n'Test whether the String can be compared.\nIf (objRegExp.Test(myString) = True) Then\n\nFor Each objMatch In colMatches   ' Iterate Matches collection.\nMsgBox objMatch.SubMatches(0)\nresult = objMatch.SubMatches(0)\n\nNext\nEnd If\nEnd If\n\nTestRegExp = result\n\n\nEnd Function \n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5982075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2464f8db522c401829a683c191494a70?s=128&d=identicon&r=PG&f=1", "display_name": "Lispeenium", "link": "https://stackoverflow.com/users/5982075/lispeenium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1592942639, "creation_date": 1536132182, "last_edit_date": 1592942639, "question_id": 52179355, "link": "https://stackoverflow.com/questions/52179355/how-can-use-regex-to-catch-the-next-line-that-follows-a-specific-string-in-vba", "title": "How can use RegEx to catch the next line that follows a specific string in VBA (Outlook)?", "body": "<p>I need to take the following line in a string included in the text body of an email. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10299132, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0D1ZvjBPREo/AAAAAAAAAAI/AAAAAAAAAD8/kbH28qkuLR0/photo.jpg?sz=128", "display_name": "gracie", "link": "https://stackoverflow.com/users/10299132/gracie"}, "edited": false, "score": 0, "creation_date": 1536633977, "post_id": 52179771, "comment_id": 91483473, "body": "Thank you for your help @curveball but this isn&#39;t working if the textbox and combo box are embedded in excel."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 1, "user_id": 10299132, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0D1ZvjBPREo/AAAAAAAAAAI/AAAAAAAAAD8/kbH28qkuLR0/photo.jpg?sz=128", "display_name": "gracie", "link": "https://stackoverflow.com/users/10299132/gracie"}, "edited": false, "score": 0, "creation_date": 1536644302, "post_id": 52179771, "comment_id": 91485918, "body": "@AgapeCantuba Are you saying that the Textbox and Combo box are in a Worksheet instead of the UserForm?"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1536739351, "last_edit_date": 1536739351, "creation_date": 1536133565, "answer_id": 52179771, "question_id": 52179229, "link": "https://stackoverflow.com/questions/52179229/disable-a-command-button-if-mandatory-fields-are-empty/52179771#52179771", "title": "Disable a command button if mandatory fields are empty", "body": "<p>\nUse the <code>*_Change</code> event for each control (and optionally the <code>UserForm_Activate</code> event) to set the <code>.Enabled</code> property for the Control Button.</p>\n\n<p>For example, on a simple UserForm with 1 ComboBox (<code>ComboBox1</code>), 2 TextBoxes (<code>TextBox1</code> and <code>TextBox2</code>) and 1 CommandButton (<code>CommandButton1</code>), the following code will ensure that <code>CommandButton1</code> is disabled unless there is data in each of the other 3 controls:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Sub CheckMandatoryFields()\n    'Is a separate sub to make it easy to edit for all Controls at the same time\n    If Len(TextBox1.Value) &gt; 0 And Len(TextBox2.Value) &gt; 0 And Len(ComboBox1.Value) &gt; 0 Then\n        CommandButton1.Enabled = True\n    Else\n        CommandButton1.Enabled = False\n    End If\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n    MsgBox \"Button is enabled!\"\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n    CheckMandatoryFields\nEnd Sub\n\nPrivate Sub TextBox1_Change()\n    CheckMandatoryFields\nEnd Sub\n\nPrivate Sub TextBox2_Change()\n    CheckMandatoryFields\nEnd Sub\n\nPrivate Sub UserForm_Activate()\n    CheckMandatoryFields\nEnd Sub\n</code></pre>\n\n<p>If your Buttons and Controls are in a Worksheet, then you need to change <code>UserForm_Activate</code> to <code>Worksheet_Activate</code>.  If they are in different worksheets, or some in a Worksheet and others in a UserForm, then you will need to Fully Qualify your references (e.g. <code>Sheet1.Textbox1.Value</code>)</p>\n\n<p>If you are using Form Controls in a Worksheet instead of ActiveX controls, then you can't use the <code>_Change</code> events, and the way you Reference the objects is different:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sheet1.Shapes(\"TextBox1\").TextFrame2.TextRange.Text 'The value of TextBox1\nSheet1.Shapes(\"ComboBox1\").ControlFormat.Value 'Which Number item in ComboBox1 is selected\nSheet1.Shapes(\"ComboBox1\").ControlFormat.List(n) 'The value of the nth item in ComboBox1\n</code></pre>\n\n<p>A Form Control button does not have an <code>Enabled</code> property - however, if you have a \"Do Nothing\" macro, you can bodge it like so:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub DoNothing()\n    'As it says\nEnd Sub\n\nSub MakeASound()\n    Beep\nEnd Sub\n\nSub ToggleButton()\n    If Sheet1.Shapes(\"Button 1\").OnAction = \"Sheet1!DoNothing\" Then 'Disable Button 1\n        Sheet1.Shapes(\"Button 1\").OLEFormat.Object.Font.ColorIndex = 16 'Font colour = Grey\n        Sheet1.Shapes(\"Button 1\").OnAction = \"Sheet1!DoNothing\"\n    Else 'Enable Button 1\n        Sheet1.Shapes(\"Button 1\").OLEFormat.Object.Font.ColorIndex = 1 'Font colour = Black\n        Sheet1.Shapes(\"Button 1\").OnAction = \"Sheet1!MakeASound\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10299132, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0D1ZvjBPREo/AAAAAAAAAAI/AAAAAAAAAD8/kbH28qkuLR0/photo.jpg?sz=128", "display_name": "gracie", "link": "https://stackoverflow.com/users/10299132/gracie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1796, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593761116, "creation_date": 1536131817, "last_edit_date": 1593761116, "question_id": 52179229, "link": "https://stackoverflow.com/questions/52179229/disable-a-command-button-if-mandatory-fields-are-empty", "title": "Disable a command button if mandatory fields are empty", "body": "<p>I am creating a form out of excel-ActiveX but I have no idea how I can make the command button disabled if all mandatory fields (textbox and combobox) are empty. I've attached the sample form for your reference. </p>\n\n<p><a href=\"https://i.stack.imgur.com/z7vtX.png\" rel=\"nofollow noreferrer\">sample LA Form</a> </p>\n"}, {"tags": ["vba", "excel", "text", "copy"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 1, "creation_date": 1536132616, "post_id": 52179184, "comment_id": 91308939, "body": "What have you researched / tried so far, and why isn&#39;t it working?"}], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1536167803, "creation_date": 1536167803, "answer_id": 52190398, "question_id": 52179184, "link": "https://stackoverflow.com/questions/52179184/excel-copying-text-from-1-cell-and-adding-it-to-the-top-of-the-cell-next-to-it/52190398#52190398", "title": "Excel: Copying text from 1 cell and ADDING it to the top of the cell next to it", "body": "<p>This'll do it. It loops on the column set as <code>columnChecked</code> and if the top entry in the cell to the right of it (\"archived\") does not match the \"current\" entry, it inserts that entry into the adjacent \"archived\" cell. You can/may have to adjust <code>sheetName</code>, <code>columnChecked</code>, <code>rowStart</code>, and <code>rowEnd</code> to fit your data. </p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim sheetName As String\n    sheetName = \"Sheet1\"\n\n    Dim columnChecked As String\n    columnChecked = \"B\"\n\n    Dim rowStart As Long\n    rowStart = 2\n\n    Dim rowEnd As Long\n    rowEnd = sheets(sheetName).Range(columnChecked &amp; Rows.count).End(xlUp).row\n\n\n    Dim cell As Range\n    For Each cell In sheets(sheetName).Range(columnChecked &amp; rowStart &amp; \":\" &amp; columnChecked &amp; rowEnd).Cells\n        If Split(cell.offset(0, 1).Value2, Chr(10))(0) &lt;&gt; cell.Value2 Then\n            cell.offset(0, 1).Value2 = cell.Value2 &amp; Chr(10) &amp; cell.offset(0, 1).Value2\n        End If\n    Next cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10318661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3783a3e9da2a566b58c973f2ff4f3d97?s=128&d=identicon&r=PG&f=1", "display_name": "Ash.Kind", "link": "https://stackoverflow.com/users/10318661/ash-kind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536167803, "creation_date": 1536131677, "last_edit_date": 1536132578, "question_id": 52179184, "link": "https://stackoverflow.com/questions/52179184/excel-copying-text-from-1-cell-and-adding-it-to-the-top-of-the-cell-next-to-it", "title": "Excel: Copying text from 1 cell and ADDING it to the top of the cell next to it", "body": "<p>I have the following scenario:</p>\n\n<p>I have about 200 rows of data and two columns. The first column contains \"latest updates\". The second column contains \"archived updates\"</p>\n\n<p>Example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/JCSQh.jpg\" alt=\"Example\"></p>\n\n<p>I want to be able to select one CELL, then click a macro button. What that would do is take the TEXT in that cell and cut it to the cell on the right, INSERTING the contents on the top of that cells contents. </p>\n\n<p>The end result in the cell on the right would be TEXT from selected cell (e.g. B2) + TEXT from the original cell (e.g. C2)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "edited": false, "score": 0, "creation_date": 1536133719, "post_id": 52179163, "comment_id": 91309603, "body": "Your code should work. Are you sure that those Workbooks are open before you call Workbooks().Activate method?"}, {"owner": {"reputation": 51, "user_id": 8060406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c64c922c0fa5d2d46a5342275e432781?s=128&d=identicon&r=PG&f=1", "display_name": "Shaumyabrata", "link": "https://stackoverflow.com/users/8060406/shaumyabrata"}, "reply_to_user": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "edited": false, "score": 0, "creation_date": 1536134452, "post_id": 52179163, "comment_id": 91310035, "body": "Yes the workbook is already open as here is the screenshot of the code where the file gets open take data from one sheet then again tries to activate the workbook with this method but it does not work. here is what i tried Workbooks(FlName).Worksheets(&quot;RS Confirm&quot;).Activate shows subscript out of range"}, {"owner": {"reputation": 51, "user_id": 8060406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c64c922c0fa5d2d46a5342275e432781?s=128&d=identicon&r=PG&f=1", "display_name": "Shaumyabrata", "link": "https://stackoverflow.com/users/8060406/shaumyabrata"}, "reply_to_user": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "edited": false, "score": 0, "creation_date": 1536136808, "post_id": 52179163, "comment_id": 91311416, "body": "@Kirszu the worksheet name i was using had a space included hence was not working now its working fine."}, {"owner": {"reputation": 342, "user_id": 7576646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0d2547b5a848b22deb649edb8feb34?s=128&d=identicon&r=PG&f=1", "display_name": "Kirszu", "link": "https://stackoverflow.com/users/7576646/kirszu"}, "edited": false, "score": 0, "creation_date": 1536137158, "post_id": 52179163, "comment_id": 91311626, "body": "Cool! Glad you solved this"}], "answers": [{"comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1536140032, "post_id": 52180765, "comment_id": 91313543, "body": "Avoid selections and activations &#39;cause it bloats code and makes reader keep all those selections in memory. <i>Most</i> of the time it&#39;s unnecessary."}], "tags": [], "owner": {"reputation": 51, "user_id": 8060406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c64c922c0fa5d2d46a5342275e432781?s=128&d=identicon&r=PG&f=1", "display_name": "Shaumyabrata", "link": "https://stackoverflow.com/users/8060406/shaumyabrata"}, "is_accepted": false, "score": 1, "last_activity_date": 1536136739, "creation_date": 1536136739, "answer_id": 52180765, "question_id": 52179163, "link": "https://stackoverflow.com/questions/52179163/using-a-variable-name-within-the-workbook-command-in-vba/52180765#52180765", "title": "Using a Variable name within the Workbook command in VBA", "body": "<p>My logic works fine its just that when I typed in the sheet name that had a space included which i did not take hence the subscript out of range error. So dynamically one can use workbook name as variable..</p>\n\n<pre><code>Workbooks(\"Code_Activator\").Worksheets(\"Activator\").Activate\n    FolderPath = Range(\"C7\").Value &amp; \"\\\"\n    FilePath3 = FolderPath &amp; FlName\n    Set wb3 = Workbooks.Open(FilePath3)\n\n    'Parts Confirm Data\n    Worksheets(\"Parts upload template\").Activate\n    Range(Range(\"A1\"), Range(\"A1\").End(xlToRight).End(xlDown)).Select\n    Selection.Copy\n    Workbooks(\"Blank_Template\").Worksheets(\"Parts\").Activate\n    Range(\"A1\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, operation:=xlNone, skipblanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n    Range(\"A1\").Select\n\n    'RS Confirm Data\n    Workbooks(FlName).Worksheets(\"RS upload\").Activate\n    Worksheets(\"RS upload\").Activate\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8060406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c64c922c0fa5d2d46a5342275e432781?s=128&d=identicon&r=PG&f=1", "display_name": "Shaumyabrata", "link": "https://stackoverflow.com/users/8060406/shaumyabrata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536136739, "creation_date": 1536131597, "question_id": 52179163, "link": "https://stackoverflow.com/questions/52179163/using-a-variable-name-within-the-workbook-command-in-vba", "title": "Using a Variable name within the Workbook command in VBA", "body": "<p>I am trying to make the syntax Workbooks(\"Some_Name\").Activate using variable workbook name such as,\nvar = 1260\nname = \"Report_\" &amp; var\nSo that i can use\nWorkbooks(name).activate</p>\n\n<p>but this is not working for me. How can i use it in correct way to achieve this. </p>\n\n<p>I need this as I have a set list through which i loop through to get the model numbers like {1260, 1760...} and i have same set of report file with names already in my hard disc as Report_1260, Report_1760 so I want to make the name as variable so that I can use it in a loop.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1536131479, "post_id": 52179078, "comment_id": 91308280, "body": "I am not able to understand the outcome by reading your code and description. Can you post a snapshot of &quot;desired result&quot; and some sample data to copy and test."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1536131983, "post_id": 52179078, "comment_id": 91308576, "body": "I&#39;ve edited the question and added the desired result. This will be in sheet 2."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1536137085, "post_id": 52180103, "comment_id": 91311580, "body": "Thank you it is working. How about when I need to do something after all the accounts are listed to sheet2 under each bank? As I tried, I inserted a message box after copying &quot;B&quot;, it pops every time it list the account number."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1536149794, "post_id": 52180103, "comment_id": 91319540, "body": "Thank you! But what I meant is, after copying list of account numbers for each bank, it will prompt me that it already copied all account number for that bank before proceeding to another bank. How can I achieve it? Thanks again.."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1536152371, "post_id": 52180103, "comment_id": 91321177, "body": "Hi shrivallabha.redij, thanks again. But sorry to confuse. What I would like to achieve is that, after copying the list of account numbers, it will prompt a message box that account numbers has been copied for the Bank. For example for Bank 1, from 12345 to 12351, after copying to the sheet 2, it will prompt done copying account numbers for Bank 1. And so on..continue to bank 2.. and so on..Thank you."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1536153103, "post_id": 52180103, "comment_id": 91321653, "body": "@Sevpoint what did you try? SO expects person to put in some efforts. See edited code."}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1536155810, "post_id": 52180103, "comment_id": 91323574, "body": "Hi shrivallabha.redij. Thank you! Sorry as I am only occasionally creating automation and not really well versed. Thank you for the help! It works as expected. :)"}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": true, "score": 1, "last_activity_date": 1536152992, "last_edit_date": 1536152992, "creation_date": 1536134516, "answer_id": 52180103, "question_id": 52179078, "link": "https://stackoverflow.com/questions/52179078/excel-vba-get-list-of-data-in-another-column/52180103#52180103", "title": "Excel VBA: Get list of data in another column", "body": "<p>You can try code below. Update sheet references where needed!</p>\n\n<pre><code>Public Sub CopyToSecondSheet()\n    Dim wksSource As Worksheet: Set wksSource = ThisWorkbook.Sheets(\"Sheet1\")\n    Dim wksDestin As Worksheet: Set wksDestin = ThisWorkbook.Sheets(\"Sheet2\")\n    Dim i As Long\n    Dim strBankName as String\n    Application.ScreenUpdating = False\n    wksDestin.Range(\"A1:A\" &amp; wksDestin.Range(\"A\" &amp; wksDestin.Rows.Count).End(xlUp).Row).Delete xlUp\n    For i = 2 To wksSource.Range(\"B\" &amp; wksSource.Rows.Count).End(xlUp).Row\n        If Len(wksSource.Range(\"A\" &amp; i).Value) &gt; 0 Then\n            If Len(strBankName) &gt; 0 Then Msgbox \"Finished copying records for : \" &amp; strBankName, vbOKOnly\n            strBankName = wksSource.Range(\"A\" &amp; i).Value\n            wksSource.Range(\"A\" &amp; i).Copy wksDestin.Range(\"A\" &amp; wksDestin.Rows.Count).End(xlUp).Offset(1, 0)\n        End If\n        wksSource.Range(\"B\" &amp; i).Copy wksDestin.Range(\"A\" &amp; wksDestin.Rows.Count).End(xlUp).Offset(1, 0)\n    Next\n    Msgbox \"Update completed!\", vbInformation\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 52180103, "answer_count": 1, "score": 0, "last_activity_date": 1594055038, "creation_date": 1536131228, "last_edit_date": 1594055038, "question_id": 52179078, "link": "https://stackoverflow.com/questions/52179078/excel-vba-get-list-of-data-in-another-column", "title": "Excel VBA: Get list of data in another column", "body": "<p>I'm currently creating an automation to automate some task. Basically, I have this data: </p>\n\n<p><a href=\"https://i.stack.imgur.com/mx9gv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mx9gv.png\" alt=\"enter image description here\"></a></p>\n\n<p>My goal is to transfer all of the account in another sheet (Sheet2).</p>\n\n<p>Problem: I can't seem to display the bank name along with the account number under them. As the bank name is always blank. </p>\n\n<p>The bank and account number can grow, in this case I wanted it to be dynamic. However, when I tried to add an account number in the last bank it stopped pasting the additional account number. Also if the code can also be improved?</p>\n\n<p>To summarize, I wanted to get the list of account number under a bank. After getting it, I will be doing some other tasks before it loop to another bank and account number. But I haven't yet included in the code below: </p>\n\n<pre><code>Sub test1()\n\nDim lRow As Long\n\nlRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nRange(\"B2\").Select\n\nFor i = 2 To lRow\n\n    ActiveSheet.Cells(i, 2).Select\n\n    If ActiveCell.Offset(1, -1).Value = \"\" Then\n\n            ActiveCell.Copy\n            Sheets(\"Sheet2\").Select\n            ActiveSheet.Paste\n            ActiveCell.Offset(1.1).Select\n            Sheets(\"Sheet1\").Select\n\n\n    Else\n        ActiveCell.Copy\n        Sheets(\"Sheet2\").Select\n        ActiveSheet.Paste\n        ActiveCell.Offset(1.1).Select\n        Sheets(\"Sheet1\").Select\n\n        'I need to to insert other steps here\n        MsgBox \"New Bank. Need to do other steps\"\n\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Desired Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OlC4d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OlC4d.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1536130082, "post_id": 52178750, "comment_id": 91307535, "body": "What is an <i>&#39;outcome cell&#39;</i> ?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1536130519, "post_id": 52178750, "comment_id": 91307759, "body": "Each event can only have one event handler, you need to put both your code in the same sub."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1536130605, "post_id": 52178750, "comment_id": 91307807, "body": "Please edit your post and add the code you want to insert."}, {"owner": {"reputation": 1, "user_id": 10318462, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_btQZjE1gOY/AAAAAAAAAAI/AAAAAAAAAKE/XYKW7IYDJbA/photo.jpg?sz=128", "display_name": "TPC Travel Picnic Camping", "link": "https://stackoverflow.com/users/10318462/tpc-travel-picnic-camping"}, "edited": false, "score": 0, "creation_date": 1536205760, "post_id": 52178750, "comment_id": 91341792, "body": "This is a form for the testing result and too many parameters. I need to get notify before finish the job if result failed and review it for reason."}], "owner": {"reputation": 1, "user_id": 10318462, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_btQZjE1gOY/AAAAAAAAAAI/AAAAAAAAAKE/XYKW7IYDJbA/photo.jpg?sz=128", "display_name": "TPC Travel Picnic Camping", "link": "https://stackoverflow.com/users/10318462/tpc-travel-picnic-camping"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536205721, "creation_date": 1536129983, "last_edit_date": 1536205721, "question_id": 52178750, "link": "https://stackoverflow.com/questions/52178750/vba-code-message-box-in-excel-when-closing-if-a-cell-value-equals-fail", "title": "VBA code message box in excel when closing if a cell value equals: &quot;FAIL&quot;", "body": "<p>I currently using the following code in my workbook:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Not Application.Intersect(Target, [B3]) Is Nothing Then\n    [b64] = Date\n  End If\nEnd Sub\n</code></pre>\n\n<p>I need to pop up a message box on exit if the outcome cell changed to \"FAIL\" and warn me to notice it.</p>\n\n<p>If I want to use Worksheet_Change again, I get an \"ambiguous name detected worksheet_change\" error and if I want to insert inside the other one, I get \"sub or function not defined\" error.\nThe code is: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim A As Range\nSet A = Range(\"I64\")\nIf Intersect(Target, A) Is \"PASS\" Then Exit Sub\nIf Target.Value = \"FAIL\" Then\n    MsgBox \"Analysis Outcome is Failed \" &amp; Target.Address\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n\n<p>What can I do?\nHow can I use it on exit? would be great too.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1536130748, "post_id": 52178634, "comment_id": 91307876, "body": "Please show us what you tried."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1536141471, "post_id": 52178634, "comment_id": 91314424, "body": "Which version of Office are you using?  Office 365 has the <code>MINIFS</code> / <code>MAXIFS</code> functions, which would simplify this greatly."}], "owner": {"reputation": 1, "user_id": 7760028, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SehAck35F9I/AAAAAAAAAAI/AAAAAAAAEBQ/rEgJR7hOe8M/photo.jpg?sz=128", "display_name": "Rajeev Ranjan", "link": "https://stackoverflow.com/users/7760028/rajeev-ranjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536131992, "creation_date": 1536129601, "last_edit_date": 1536131992, "question_id": 52178634, "link": "https://stackoverflow.com/questions/52178634/delete-row-by-condition-check-in-vba", "title": "Delete row by condition check in VBA", "body": "<p>I have similar data as I have shown below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/wJeiL.png\" alt=\"Screenshot\"></p>\n\n<p>I want to delete rows containing similar date containing greater time mentioned in column E for the same date using VBA. For example user data is available for different time on same date. but I want to keep row having minimum time than others.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1536130470, "post_id": 52178575, "comment_id": 91307736, "body": "you have &quot;Worksheets(&quot;Vectori&quot;).Select&quot; but the varaible defined as &quot;vector&quot; do you need a new variable?&quot;"}, {"owner": {"reputation": 1, "user_id": 10316714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91fd738ca618793685fb13c35f376ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Elys", "link": "https://stackoverflow.com/users/10316714/elys"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1536131484, "post_id": 52178575, "comment_id": 91308285, "body": "in the &quot;vector&quot; variable i want to keep the values of the whole column, but starting from cell A2."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1536132673, "post_id": 52178575, "comment_id": 91308982, "body": "In one place you have VECTORI and the other VECTOR ..."}, {"owner": {"reputation": 1, "user_id": 10316714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91fd738ca618793685fb13c35f376ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Elys", "link": "https://stackoverflow.com/users/10316714/elys"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1536133134, "post_id": 52178575, "comment_id": 91309274, "body": "i edited it...&quot;Vectori&quot; is the sheet that contains the values i need to paste in the &quot;TABEL&quot; sheet. sorry for misunderstanding"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10316714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91fd738ca618793685fb13c35f376ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Elys", "link": "https://stackoverflow.com/users/10316714/elys"}, "edited": false, "score": 0, "creation_date": 1536131862, "post_id": 52179121, "comment_id": 91308509, "body": "it doesn&#39;t work...and i want, if it&#39;s possible, to keep the values from A2 to the last used row"}], "tags": [], "owner": {"reputation": 616, "user_id": 8194922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AT4t9jEkYSc/AAAAAAAAAAI/AAAAAAAAANY/NlgdS5WVxjY/photo.jpg?sz=128", "display_name": "Paresh", "link": "https://stackoverflow.com/users/8194922/paresh"}, "is_accepted": false, "score": 0, "last_activity_date": 1536131426, "creation_date": 1536131426, "answer_id": 52179121, "question_id": 52178575, "link": "https://stackoverflow.com/questions/52178575/copy-values-from-a-sheet-to-other-sheet-only-into-blank-cell/52179121#52179121", "title": "Copy values from a sheet to other sheet only into blank cell", "body": "<p>Just increase the <em>Range</em> to suit your needs. </p>\n\n<p>Replace:</p>\n\n<pre><code>Range(\"A2\")\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>Range(\"A2:Z100\")\n</code></pre>\n\n<p>Just select the range that covers your entire data.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10316714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91fd738ca618793685fb13c35f376ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Elys", "link": "https://stackoverflow.com/users/10316714/elys"}, "is_accepted": false, "score": 0, "last_activity_date": 1536218038, "creation_date": 1536218038, "answer_id": 52198416, "question_id": 52178575, "link": "https://stackoverflow.com/questions/52178575/copy-values-from-a-sheet-to-other-sheet-only-into-blank-cell/52198416#52198416", "title": "Copy values from a sheet to other sheet only into blank cell", "body": "<p>I solved it :) </p>\n\n<pre><code>Sub test()\n\nDim thisarray As Variant\nDim lastrow As Long\nDim index As Integer\nindex = 1\n\nlastrow = Cells(Rows.count, 1).End(xlUp).Row\nthisarray = Worksheets(\"Vectori\").Range(\"A2:A\" &amp; lastrow).value\n\nWhile index &lt;= UBound(thisarray)\n        Worksheets(\"TABEL\").Select\n        Range(\"A2\").Select\n        ActiveCell.End(xlDown).Select\n        ActiveCell.Offset(1, 0).Select\n        ActiveCell.value = thisarray(index, 1)\n index = index + 1\nWend\n\nEnd Sub\n</code></pre>\n\n<p>Have a nice day!</p>\n"}], "owner": {"reputation": 1, "user_id": 10316714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91fd738ca618793685fb13c35f376ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Elys", "link": "https://stackoverflow.com/users/10316714/elys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536218038, "creation_date": 1536129425, "last_edit_date": 1536133056, "question_id": 52178575, "link": "https://stackoverflow.com/questions/52178575/copy-values-from-a-sheet-to-other-sheet-only-into-blank-cell", "title": "Copy values from a sheet to other sheet only into blank cell", "body": "<p>I'm new on VBA and also on this site. I found and adapted this code to my needs,  but it copy only the first row from column A(sheet \"Vectori\") in the blank cells of \"TABEL\" sheet(column A), and i want to copy all values from column A(sheet \"Vectori\"), not only one.</p>\n\n<pre><code>Sub test()\n    Dim myvalue As String\n    Dim lastrow As Long\n\n    lastrow = Rows(Rows.count).End(xlUp).Row\n\n    Worksheets(\"Vectori\").Select\n\n    myvalue = Range(\"A2\").value\n\n    Worksheets(\"TABEL\").Select\n\n    Range(\"A2\").Select\n\n    'go to first blank cell\n\n    ActiveCell.End(xlDown).Select\n\n    ActiveCell.Offset(1, 0).Select\n\n    'write variable values into this blank row\n\n    ActiveCell.value = myvalue\n\n\n    Range(ActiveCell.Offset(-1, 0), ActiveCell.Offset(-1, 1)).copy\n\n    ActiveCell.PasteSpecial xlPasteFormats\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 4127490, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001522278401/picture?type=large", "display_name": "Arran Pritchard", "link": "https://stackoverflow.com/users/4127490/arran-pritchard"}, "is_accepted": false, "score": 0, "last_activity_date": 1536209999, "creation_date": 1536209999, "answer_id": 52196799, "question_id": 52178224, "link": "https://stackoverflow.com/questions/52178224/webbrowser-control-on-multipage-control-disappears-when-switching-between-the-pa/52196799#52196799", "title": "Webbrowser control on multipage control disappears when switching between the pages", "body": "<p>web browser control not working on the multipage control seems a common problem, and so far I did not see a solution.</p>\n\n<p>Here is the solution I devised.  It merely re-creates the web browser control each time the page is selected.</p>\n\n<pre><code>Dim wbr As SHDocVw.WebBrowser\n\nPrivate Sub MultiPage1_Change()\n    If MultiPage1.SelectedItem.Name = \"Page 1\" Then\n\n        Set wbr = Nothing\n        Set wbr = Me.MultiPage1.SelectedItem.Controls.Add(\"Shell.Explorer.2\")\n\n        wbr.Height = 700\n        wbr.Left = 96\n        wbr.Top = 24\n        wbr.Width = 570\n        wbr.Navigate \"About:Blank\"\n        wbr.Document.write \"&lt;HTML&gt;&lt;Body&gt;&lt;embed src=\"\"file:///C:\\Users\\User\\File.pdf\"\" width=100% height=100%/&gt;&lt;/Body&gt;&lt;/HTML&gt;\"\n        wbr.Document.body.scroll = \"no\"\n    End If\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n    Set wbr = Me.MultiPage1.SelectedItem.Controls.Add(\"Shell.Explorer.2\")\n\n    wbr.Height = 700\n    wbr.Left = 96\n    wbr.Top = 24\n    wbr.Width = 570\n    wbr.Navigate \"About:Blank\"\n    wbr.Document.write \"&lt;HTML&gt;&lt;Body&gt;&lt;embed src=\"\"file:///C:\\Users\\User\\File.pdf\"\" width=100% height=100%/&gt;&lt;/Body&gt;&lt;/HTML&gt;\"\n    wbr.Document.body.scroll = \"no\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11828064, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219968147502971/picture?type=large", "display_name": "Alain Carignan", "link": "https://stackoverflow.com/users/11828064/alain-carignan"}, "is_accepted": false, "score": 1, "last_activity_date": 1563943265, "creation_date": 1563943265, "answer_id": 57175382, "question_id": 52178224, "link": "https://stackoverflow.com/questions/52178224/webbrowser-control-on-multipage-control-disappears-when-switching-between-the-pa/57175382#57175382", "title": "Webbrowser control on multipage control disappears when switching between the pages", "body": "<p>You can also use the tab control with several webbrowser. This option has the advantage of keeping the last loaded web page of the gadget.Just create a tab control with the desired web page number. For the dimensions of webbrowser, I suggest you visually create one and take its coordinates before destroying it. Here is the code to use.</p>\n\n<pre><code>enter code here\nDim webbrowser(3)\nDim actuelpage\n\nPrivate Sub TabStrip1_Change()\n    webbrowser(actuelpage).Visible = False\n    actuelpage = Me.TabStrip1.SelectedItem.Index\n    webbrowser(actuelpage).Visible = True\nEnd Sub\n\nPrivate Sub UserForm_Activate()\n    Dim pages As Variant\n    pages = Array(\"www.google.com\", \"www.allo.com\", \"www.microsoft.com\")\n    For a = 0 To UBound(webbrowser) - 1\n        Set webbrowser(a) = Me.Controls.Add(\"Shell.Explorer.2\")\n        webbrowser(a).Height = 306\n        webbrowser(a).Left = 30\n        webbrowser(a).Top = 42\n        webbrowser(a).Width = 684\n        webbrowser(a).Silent = True\n        webbrowser(a).navigate pages(a)\n        webbrowser(a).Visible = False        \n    Next a\n    actuelpage = 0\n    webbrowser(actuelpage).Visible = True\nEnd Sub\nenter code here\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4127490, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001522278401/picture?type=large", "display_name": "Arran Pritchard", "link": "https://stackoverflow.com/users/4127490/arran-pritchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1579536218, "creation_date": 1536127979, "last_edit_date": 1579536218, "question_id": 52178224, "link": "https://stackoverflow.com/questions/52178224/webbrowser-control-on-multipage-control-disappears-when-switching-between-the-pa", "title": "Webbrowser control on multipage control disappears when switching between the pages", "body": "<p>When using a webbrowser control on a multipage control, why does switching between the pages and then back again cause the webbrowser control to disappear?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10317956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e07a24504de527a8179b7466d56d81?s=128&d=identicon&r=PG&f=1", "display_name": "MGUrso", "link": "https://stackoverflow.com/users/10317956/mgurso"}, "edited": false, "score": 0, "creation_date": 1536277964, "post_id": 52182225, "comment_id": 91376451, "body": "Thank you. I usually do turn on manual update, but for debugging purposes leave it out. I did try the solution with the counter, but it dose not work. The problem is, that if the value that we are searching for is not in the selection filter, when the cycle reaches the end of the filter seletion script fails with an error, because Pivot table can not set False, deselect all the values. The only solution I have so far, is to run the cycle 2 times. First using your soltion to check if the values are in the selection, if they are then run the selection cycle."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1536141259, "creation_date": 1536141259, "answer_id": 52182225, "question_id": 52177545, "link": "https://stackoverflow.com/questions/52177545/excel-vba-privot-table-filter-multiple-uncertain-criteria/52182225#52182225", "title": "Excel VBA - Privot table filter multiple uncertain criteria", "body": "<p></p>\n\n<h2>Before we start:</h2>\n\n<p>1 way to make your PivotTable update faster is to set <code>PVT.ManualUpdate = True</code> before you start messing with the PivotItems, then set it to <code>PVT.ManualUpdate = False</code> and run <code>PVT.Update</code> after they are all set.</p>\n\n<p>This will stop Excel trying to rebuild the PivotTable <em>every time</em> you change an item, and instead do 1 big update at the end.</p>\n\n<h2>So, on to the actual issue!</h2>\n\n<p>Have you tried just adding a checksum?  Start with a <code>Long</code> set to 0, then add 1 to it every time you set <code>PivotItem.Visible = True</code>.  If it is 0, then there are no items to show.  If it is <em>not</em> 0, then you know how many matches there were.  As a rough guide, you're looking for something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>For k = 1 To 10\n    conv = Cells(k, 24)\n    arr(k) = conv\nNext\nSet PVT = ActiveSheet.PivotTables(\"PivotTable1\")\nDim lCounter As Long\nlCounter = 0\n\nPVT.ManualUpdate = True\n\nFor Each PivotItem In PVT.PivotFields(\"Project ID\").PivotItems\n    If Not IsError(Application.Match(PivotItem.Caption, arr, 0)) Then ' check if current item is not in the filter array\n        PivotItem.Visible = True\n        lCounter = lCounter + 1\n    Else\n        PivotItem.Visible = False\n    End If\nNext PivotItem\n\nIf lCounter &lt; 1 Then\n    PVT.PivotFields(\"Project ID\").ClearAllFilters 'Show EVERYTHING\n    MsgBox \"None of the specified Projects were found.\", vbCritical, \":(\"\nEnd If\n\nPVT.Update\nPVT.ManualUpdate = False\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10317956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e07a24504de527a8179b7466d56d81?s=128&d=identicon&r=PG&f=1", "display_name": "MGUrso", "link": "https://stackoverflow.com/users/10317956/mgurso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536141259, "creation_date": 1536124716, "last_edit_date": 1536140600, "question_id": 52177545, "link": "https://stackoverflow.com/questions/52177545/excel-vba-privot-table-filter-multiple-uncertain-criteria", "title": "Excel VBA - Privot table filter multiple uncertain criteria", "body": "<p>I have 2 tables, one contains list of projects, the other one is a pivot table with details of those projects. What I need to do is take several prject numbers that fom a group from one table, filter the Pivot table based on that number, copy he presented data and then move to next Project number from the first table.<br>\nI use parts of the code from  <a href=\"https://stackoverflow.com/questions/42505991/excel-vba-privot-table-filter-multiple-criteria\">Excel VBA - Privot table filter multiple criteria</a>\nby Shai Rado</p>\n\n<pre><code>For k = 1 To  10\nconv = Cells(k, 24)\narr(k) = conv\nNext\nSet PVT = ActiveSheet.PivotTables(\"PivotTable1\")\n\nFor Each PivotItem In PVT.PivotFields(\"Project ID\").PivotItems\n    If Not IsError(Application.Match(PivotItem.Caption, arr, 0)) Then ' check if current item is not in the filter array\n        PivotItem.Visible = True\n    Else\n        PivotItem.Visible = False\n    End If\nNext PivotItem\n</code></pre>\n\n<p>The problem I have is when there is no Project Id present in the pivot table.  </p>\n\n<p>For example I have project Id 118 and 156, they get assigned to the arr, but the Pivot table does not hold those values I get an error.  </p>\n\n<p>One solution would beto run a comparison script to check if the pivot table has that value before running the filter, but using vlook up or another FOR command for that takes too long. Is there any easier solution to just skip the filter if the value is not found? Or trigger a different command?     </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1536140079, "post_id": 52177518, "comment_id": 91313573, "body": "Generally speaking you shouldn&#39;t have circular relationships, which is probably the root cause of your angst. I am however struggling to see how I would correct your relationships, but I think they should be more linear. I think your contacts maybe shouldn&#39;t be linked to a site, or more likely that the facility shouldn&#39;t be  linked to a contact..."}], "answers": [{"comments": [{"owner": {"reputation": 710, "user_id": 1145832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4af5e65252eb11473a792df42e855eb?s=128&d=identicon&r=PG", "display_name": "katzenversteher", "link": "https://stackoverflow.com/users/1145832/katzenversteher"}, "edited": false, "score": 0, "creation_date": 1536218990, "post_id": 52187432, "comment_id": 91346487, "body": "Thank you very much, this seems to work quite well! I also had restrict the combo box to contacts that aren&#39;t already associated with the same Site/Facility."}], "tags": [], "owner": {"reputation": 22156, "user_id": 154439, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/63c2ea30cedb0e3a9488df1e1861d1e7?s=128&d=identicon&r=PG", "display_name": "mwolfe02", "link": "https://stackoverflow.com/users/154439/mwolfe02"}, "is_accepted": true, "score": 1, "last_activity_date": 1536157262, "creation_date": 1536157262, "answer_id": 52187432, "question_id": 52177518, "link": "https://stackoverflow.com/questions/52177518/i-want-to-constrain-what-i-can-enter-in-forms-for-a-relatively-complex-many-to-m/52187432#52187432", "title": "I want to constrain what I can enter in forms for a relatively complex many-to-many relationship (more complex than in most examples)", "body": "<p>I would use an unbound combo box to add new site and facility contacts.  Restrict the combo box to show only Contacts with a matching CustomerID.  </p>\n\n<p>For your Site form, use your current setup, but set the sub-datasheet to AllowAdditions = False.  Place an unbound Contact selection combo box on the form.  Place an [Add Contact] button next to the combo box.  When [Add Contact] is clicked, use VBA to create the record in the ContactsCustomerSite table.  Requery the sub-datasheet to display the new record.</p>\n\n<p>Do the same thing on the Facility form.</p>\n"}], "owner": {"reputation": 710, "user_id": 1145832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4af5e65252eb11473a792df42e855eb?s=128&d=identicon&r=PG", "display_name": "katzenversteher", "link": "https://stackoverflow.com/users/1145832/katzenversteher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 1, "accepted_answer_id": 52187432, "answer_count": 1, "score": 0, "last_activity_date": 1536157262, "creation_date": 1536124538, "last_edit_date": 1536130688, "question_id": 52177518, "link": "https://stackoverflow.com/questions/52177518/i-want-to-constrain-what-i-can-enter-in-forms-for-a-relatively-complex-many-to-m", "title": "I want to constrain what I can enter in forms for a relatively complex many-to-many relationship (more complex than in most examples)", "body": "<p>First of all: I'm using Access 2016</p>\n\n<p>The basic setup I have is as follows:</p>\n\n<ul>\n<li>Customers (with name and business related information etc.)</li>\n<li>Contacts (contact information, each contact belongs to ONE customer)</li>\n<li>CustomerSite (address etc, each site belongs to ONE customer)</li>\n<li>Facilities (facility related information, each facility belongs to ONE CustomerSite)</li>\n</ul>\n\n<p>These relations are implemented using a foreign key to a customer/site id. This works pretty well. </p>\n\n<p>However, what I want in addition though is the following:</p>\n\n<p>MANY of the Contacts can be responsible for MANY of the Sites and/or MANY of the Facilities.</p>\n\n<p>Therefore I made the following junction tables:</p>\n\n<ul>\n<li>ContactsCustomerSite (foreign keys to Contact-ID and Site-ID)</li>\n<li>ContactsFacility (foreign keys to Contact-ID and Facility-ID)</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/49mAv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/49mAv.png\" alt=\"enter image description here\"></a></p>\n\n<p>This works as long as I carefully enter the data manually into the junction tables.</p>\n\n<p>However, I want to offer forms to assign contacts to sites/facilities and this is where I have my problem.</p>\n\n<p>So far I tried auto-generated forms with a little customization. They show e.g. facility information and then related contacts in a datasheet-subform (with links to a contact detail form).</p>\n\n<p>The datasheets aren't properly constrained though. I can enter new contacts there but with several problems:</p>\n\n<ul>\n<li>The contacts I enter there become NEW contacts</li>\n<li>I have to manually select the customer to which the contact belongs, this is a source for errors (e.g. contacts of different customers could be entered as responsible)</li>\n</ul>\n\n<p>I would like to select only from existing contacts that belong to the same customer. </p>\n\n<p>How can I do this?</p>\n\n<p>I don't really get what kind of form would be right to enter this, I also don't really understand what access does \"below the surface\" :(</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1536123741, "post_id": 52176942, "comment_id": 91304876, "body": "Welcome... looks like you are working with a range <code>oRng</code> but resetting the selection..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1536130440, "post_id": 52176942, "comment_id": 91307725, "body": "Your code is incomplete, which makes it impossible for us to discover exactly <i>how</i> it&#39;s failing. According to site policy, a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> should be provided. In this case, specifically, everything to do with setting and handling <code>oRng</code> would be relevant."}, {"owner": {"reputation": 13, "user_id": 10308318, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156227384578889/picture?type=large", "display_name": "Chris Ford", "link": "https://stackoverflow.com/users/10308318/chris-ford"}, "edited": false, "score": 0, "creation_date": 1536141753, "post_id": 52176942, "comment_id": 91314601, "body": "Apologies for that Cindy. I have edited the text to clarify the definition of oRng."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1536133583, "creation_date": 1536133583, "answer_id": 52179776, "question_id": 52176942, "link": "https://stackoverflow.com/questions/52176942/removing-subscript-superscript-from-whitespace/52179776#52179776", "title": "Removing subscript/superscript from whitespace", "body": "<p>The problem is that, by the time you've finished processing whichever series you put first, the range defined by Rng has collapsed to the last Found instance. Regardless, you don't need a loop. Try:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \" \"\n    .Replacement.Text = \"^&amp;\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .Font.Superscript = True\n    .Replacement.Font.Superscript = False\n    .Execute Replace:=wdReplaceAll\n    .Font.Subscript = True\n    .Replacement.Font.Subscript = False\n    .Execute Replace:=wdReplaceAll\n  End With\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10308318, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156227384578889/picture?type=large", "display_name": "Chris Ford", "link": "https://stackoverflow.com/users/10308318/chris-ford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 52179776, "answer_count": 1, "score": -1, "last_activity_date": 1593415227, "creation_date": 1536120718, "last_edit_date": 1593415227, "question_id": 52176942, "link": "https://stackoverflow.com/questions/52176942/removing-subscript-superscript-from-whitespace", "title": "Removing subscript/superscript from whitespace", "body": "<p>I'm aiming to remove subscript or superscript formatting from spaces.</p>\n\n<p>When I run the below code, only the top function works, while the lower function fails to do anything. If I switch the positions of the functions, still only the top function works. The functions are almost identical and I don't know where to start with fixing this. Please could someone point me in the right direction?</p>\n\n<pre><code>Dim oRng As Word.Range\nSet oRng = ActiveDocument.Range\n\n'For subscripted spaces\n\nSelection.HomeKey unit:=wdStory\nWith oRng.Find\n .ClearFormatting\n .Replacement.ClearFormatting\n.Forward = True\n.Text = \"[A-z0-9] \"\n.Replacement.Text = \"\"\n.MatchWholeWord = False\n    While .Execute\n        If oRng.Characters(2).Font.Subscript = True Then\n        oRng.Characters(2).Font.Subscript = False\n        End If\n    oRng.Collapse direction:=wdCollapseEnd\n    Wend\nEnd With\n\n'For superscripted spaces\n\n Selection.HomeKey unit:=wdStory\nWith oRng.Find\n .ClearFormatting\n .Replacement.ClearFormatting\n.Forward = True\n.Text = \"[A-z0-9] \"\n.Replacement.Text = \"\"\n.MatchWholeWord = False\n    While .Execute\n        If oRng.Characters(2).Font.Superscript = True Then\n        oRng.Characters(2).Font.Superscript = False\n        End If\n    oRng.Collapse direction:=wdCollapseEnd\n    Wend\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "dom", "web-scraping"], "comments": [{"owner": {"reputation": 39, "user_id": 9939182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tkllR992FuE/AAAAAAAAAAI/AAAAAAAAEy4/dZdzFaREFas/photo.jpg?sz=128", "display_name": "Justin Sun", "link": "https://stackoverflow.com/users/9939182/justin-sun"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536120983, "post_id": 52176918, "comment_id": 91304186, "body": "@Comintern I&#39;ve post the full code here. <a href=\"https://gist.github.com/SUNJIANZHI/c193b4936db4ce3851858df9dfee0f83\" rel=\"nofollow noreferrer\">gist.github.com/SUNJIANZHI/c193b4936db4ce3851858df9dfee0f83</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536121027, "post_id": 52176918, "comment_id": 91304193, "body": "Please include the relevant HTML in your question. Not as an image by the way but using the snippet tool. There could be parent frame/iframe/form tags to consider, or a dynamically constructed element...."}, {"owner": {"reputation": 39, "user_id": 9939182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tkllR992FuE/AAAAAAAAAAI/AAAAAAAAEy4/dZdzFaREFas/photo.jpg?sz=128", "display_name": "Justin Sun", "link": "https://stackoverflow.com/users/9939182/justin-sun"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536121153, "post_id": 52176918, "comment_id": 91304212, "body": "@Comintern I am not sure if you could access the website I embedded. Seems that it is an internal website. If you cannot access the website, I will also copy the front-ended code for you. Thanks in advance."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536121301, "post_id": 52176918, "comment_id": 91304236, "body": "Please don&#39;t use the page source but actually right click inspect and copy the html body element/entire document. If it is really long then include the relevant parts bearing in mind my comment above."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536121460, "post_id": 52176918, "comment_id": 91304259, "body": "Is the page completely loaded when you call <code>.getElementsByName(&quot;username&quot;)</code>? It isn&#39;t clear from the code, but you&#39;re jamming on the <code>overridelink</code> button(?). Do you just need a wait (<code>ieBusy ie</code>) to ensure that any navigation caused by the click is completed?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536121588, "post_id": 52176918, "comment_id": 91304288, "body": "@Comintern It should throw an element not found error in that case, no? But yes, absolutely should be another wait for page load after click event ( While IE.Busy Or IE.readyState &lt; 4: DoEvents: Wend)"}, {"owner": {"reputation": 39, "user_id": 9939182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tkllR992FuE/AAAAAAAAAAI/AAAAAAAAEy4/dZdzFaREFas/photo.jpg?sz=128", "display_name": "Justin Sun", "link": "https://stackoverflow.com/users/9939182/justin-sun"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536121725, "post_id": 52176918, "comment_id": 91304321, "body": "@QHarr &lt;input name=&quot;username&quot; type=&quot;text&quot; class=&quot;login_field_frame font_11_grey&quot;&gt; I think this is the input box related to my question. <a href=\"https://10.130.44.140:5461/hkwp/CP\" rel=\"nofollow noreferrer\">10.130.44.140:5461/hkwp/CP</a> This is the website I would like to log in. I could not copy the whole form code here due to the character limit."}, {"owner": {"reputation": 39, "user_id": 9939182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tkllR992FuE/AAAAAAAAAAI/AAAAAAAAEy4/dZdzFaREFas/photo.jpg?sz=128", "display_name": "Justin Sun", "link": "https://stackoverflow.com/users/9939182/justin-sun"}, "edited": false, "score": 0, "creation_date": 1536121836, "post_id": 52176918, "comment_id": 91304348, "body": "The overridelink is to bypass the certificate error, since this website does not have a valid certificate."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536121864, "post_id": 52176918, "comment_id": 91304357, "body": "You would post html using <a href=\"https://stackoverflow.com/posts/52176918/edit\">edit</a> into your question. @Comintern is right about adding a wait for page load after a click event. You may then try IE.document.querySelector(&quot;[name=&#39;username&#39;]&quot;).Value = &quot;xyz&quot;   , but this is guesswork without seeing the html structure."}, {"owner": {"reputation": 39, "user_id": 9939182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tkllR992FuE/AAAAAAAAAAI/AAAAAAAAEy4/dZdzFaREFas/photo.jpg?sz=128", "display_name": "Justin Sun", "link": "https://stackoverflow.com/users/9939182/justin-sun"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536121947, "post_id": 52176918, "comment_id": 91304372, "body": "@Comintern I tried another ieBusy, but it still return the run time error 91 Object variable not set"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536121986, "post_id": 52176918, "comment_id": 91304383, "body": "Have you tried loading it in a browser? I&#39;m getting a gateway timeout on your link."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536122071, "post_id": 52176918, "comment_id": 91304405, "body": "When you right click inspect is the element in question inside a parent frame/iframe/form tag?"}, {"owner": {"reputation": 39, "user_id": 9939182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tkllR992FuE/AAAAAAAAAAI/AAAAAAAAEy4/dZdzFaREFas/photo.jpg?sz=128", "display_name": "Justin Sun", "link": "https://stackoverflow.com/users/9939182/justin-sun"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1536122592, "post_id": 52176918, "comment_id": 91304535, "body": "@Comintern I\u2019ve loaded this web in IE and Chrome. The address could be an internal use and that\u2019s why you could not access this web. I will post the web source code later for your reference."}, {"owner": {"reputation": 39, "user_id": 9939182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tkllR992FuE/AAAAAAAAAAI/AAAAAAAAEy4/dZdzFaREFas/photo.jpg?sz=128", "display_name": "Justin Sun", "link": "https://stackoverflow.com/users/9939182/justin-sun"}, "edited": false, "score": 0, "creation_date": 1536130146, "post_id": 52176918, "comment_id": 91307573, "body": "You could access through this link<a href=\"https://hk.member.cigna.com/hkwp/HKWPCAP/unsecure/ForwardToLoginPage.do?actionParam=forwardToLoginPage&amp;ssoId=unauthenticated&amp;ssoId=a4wong\" rel=\"nofollow noreferrer\">link</a>"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536596447, "post_id": 52180553, "comment_id": 91471366, "body": "Did you try this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1536136424, "last_edit_date": 1536136424, "creation_date": 1536136047, "answer_id": 52180553, "question_id": 52176918, "link": "https://stackoverflow.com/questions/52176918/getelementsbyname-returned-nothing/52180553#52180553", "title": "GetElementsByName returned Nothing", "body": "<p>There is a parent <code>form</code> tag to navigate first. After navigating that I use a CSS attribute selector of <code>[name='username']</code> to target the element by its <code>name</code> attribute and value.</p>\n\n<pre><code>Option Explicit\nPublic Sub LoginPage()\n    Dim IE As New InternetExplorer\n    With IE\n        .Visible = True\n        .navigate \"https://hk.member.cigna.com/hkwp/HKWPCAP/unsecure/ForwardToLoginPage.do?actionParam=forwardToLoginPage&amp;ssoId=unauthenticated&amp;ssoId=a4wong\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document.getElementsByTagName(\"form\")(0) '&lt;==Navigate parent form tag\n            .querySelector(\"[name='username']\").Value = \"myUserName\"\n            .querySelector(\"[name='password']\").Value = \"myPassword\"\n        End With\n        Stop                                     '&lt;==Delete me after inspecting\n        '.Quit '&lt;== Remember to quit application\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9939182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tkllR992FuE/AAAAAAAAAAI/AAAAAAAAEy4/dZdzFaREFas/photo.jpg?sz=128", "display_name": "Justin Sun", "link": "https://stackoverflow.com/users/9939182/justin-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536136424, "creation_date": 1536120568, "last_edit_date": 1536127018, "question_id": 52176918, "link": "https://stackoverflow.com/questions/52176918/getelementsbyname-returned-nothing", "title": "GetElementsByName returned Nothing", "body": "<p>I am trying to use VBA to log into some website. And I would like to fill in the username input box. But the getElementsByName returns Nothing: </p>\n\n<pre><code>Sub login()\n    Const Url$ = \"https://10.130.44.140:5461/hkwp/CP\"\n\n    Dim UserName As String, Password As String\n\n    UserName = \"qwe\"\n    Password = \"qwe\"\n\n    Dim ie As Object\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    With ie\n        .navigate Url\n        ieBusy ie\n\n        On Error Resume Next\n        For i = 1 To 10 'Loop ten times to ensure the certifiacate will be bypassed.\n        .Document.getElementsByName(\"overridelink\").Item.Click\n        Next i\n        On Error GoTo 0\n\n       .Visible = True\n\n        Set objInputs = ie.Document.getElementsByName(\"username\")\n        For Each ele In objInputs\n            Debug.Print ele.Value\n        Next\n\n        Dim oLogin As Object, oPassword As Object\n        Set oLogin = .Document.getElementsByName(\"username\")(0)\n        Set oPassword = .Document.getElementsByName(\"Password\")(0)\n\n        oLogin.Value = UserName\n        oPassword.Value = Password\n        .Document.forms(0).submit\n    End With\nEnd Sub\n\nSub ieBusy(ie As Object)\n    Do While ie.Busy Or ie.readyState &lt; 4\n        DoEvents\n    Loop\nEnd Sub\n</code></pre>\n\n<p>And The web source</p>\n\n<pre><code>&lt;body&gt;\n&lt;form method=\"post\" action=\"https://webportaluat.cigna.com.hk/pkmslogin.form\"&gt;\n&lt;input type=\"HIDDEN\" name=\"login-form-type\" value=\"pwd\"&gt;\n&lt;div align=\"center\"&gt;\n&lt;div class=\"outer_container\"&gt;\n&lt;div class=\"\"&gt;\n&lt;table width=\"968px\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bordercolor=\"#FFFFFF\" vspace=\"0\"&gt;\n    &lt;tbody&gt;&lt;tr&gt;\n        &lt;td width=\"968\" height=\"68\" bgcolor=\"#FFFFFF\"&gt;\n        &lt;div style=\"float: left\"&gt;&lt;/div&gt;\n        &lt;div style=\"float: right\" class=\"link_11_grey header_line\"&gt;\n            &lt;a href=\"/hkwp/HKWPCAP/unsecure/ForwardToLoginPage.do?actionParam=forwardToLoginPage&amp;amp;localeId=zh_HK\"&gt;\u4e2d\u6587&lt;/a&gt;\n         &lt;/div&gt;\n        &lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n&lt;table height=\"51\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\n    &lt;tbody&gt;&lt;tr&gt;\n        &lt;td width=\"322\" class=\"left_menu_nav\"&gt;\n        &lt;table width=\"278\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"left\"&gt;\n            &lt;tbody&gt;&lt;tr&gt;\n                &lt;td colspan=\"4\" align=\"left\"&gt;&lt;img src=\"/hkwp/HKWPCAP/images/en/login_cignaHK.png\"&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr valign=\"left\"&gt;\n                &lt;td height=\"10\" colspan=\"4\"&gt;&amp;nbsp;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr valign=\"left\"&gt;\n                &lt;td width=\"23\"&gt;&amp;nbsp;&lt;/td&gt;\n                &lt;td width=\"71\" align=\"left\" valing=\"middle\"&gt;&lt;span class=\"font_11_grey_b\"&gt;Username&lt;/span&gt;&lt;/td&gt;\n                &lt;td width=\"161\"&gt;&lt;input name=\"username\" type=\"text\" class=\"login_field_frame font_11_grey\"&gt;&lt;/td&gt;\n                &lt;td width=\"32\"&gt;&amp;nbsp;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr valign=\"left\"&gt;\n                &lt;td&gt;&amp;nbsp;&lt;/td&gt;\n                &lt;td align=\"left\" valing=\"middle\"&gt;&lt;span class=\"font_11_grey_b\"&gt;Password&lt;/span&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;input name=\"password\" type=\"password\" class=\"login_field_frame font_11_grey\" onkeyup=\"javascript:forwardToLogin(event);\"&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;a href=\"javascript:submitForm()\" onmouseout=\"MM_swapImgRestore()\" onmouseover=\"MM_swapImage('go','','/HKWPCAP/images/en/common/com_btnGoR.gif',1)\"&gt;&lt;img src=\"https://webportaluat.cigna.com.hk/hkwp/HKWPCAP/images/en/common/com_btnGo.gif\" name=\"go\" width=\"19\" height=\"19\" border=\"0\" id=\"go\"&gt;&lt;/a&gt; &lt;img src=\"/hkwp/HKWPCAP/images/en/common/com_btnGoR.gif\" width=\"19\" height=\"19\" border=\"0\" name=\"goR\" id=\"goR\" style=\"display: none\"&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td colspan=\"4\"&gt;&lt;img src=\"/hkwp/HKWPCAP/images/en/login_line.gif\" width=\"287\" height=\"2\" vspace=\"10\"&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td&gt;&amp;nbsp;&lt;/td&gt;\n                &lt;td colspan=\"3\"&gt;\n                &lt;table width=\"154\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"left_menu_nav_box\"&gt;\n                    &lt;tbody&gt;&lt;tr&gt;\n                        &lt;td width=\"12\"&gt;&lt;img src=\"/hkwp/HKWPCAP/images/en/common/com_greenArrow.gif\"&gt;&lt;/td&gt;\n                        &lt;td width=\"142\" class=\"link_11_blue\"&gt;&lt;a href=\"/hkwp/HKWPCAP/unsecure/Registration.do?actionParam=forwordToRegistration\" class=\"font_11_grey_b\"&gt;Registration&lt;/a&gt;&lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;&lt;img src=\"/hkwp/HKWPCAP/images/en/common/com_greenArrow.gif\"&gt;&lt;/td&gt;\n                        &lt;td class=\"link_11_blue\"&gt;&lt;a href=\"/hkwp/HKWPCAP/unsecure/guideLineEn.do\" target=\"_blank\"&gt;User Guide&lt;/a&gt;&lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;&lt;img src=\"/hkwp/HKWPCAP/images/en/common/com_greenArrow.gif\"&gt;&lt;/td&gt;\n                        &lt;td class=\"link_11_blue\"&gt;&lt;a href=\"/hkwp/HKWPCAP/unsecure/ForgotPassword.do?actionParam=forward\"&gt;Forget Password&lt;/a&gt;&lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/tbody&gt;&lt;/table&gt;\n                &lt;/td&gt;\n            &lt;/tr&gt;\n        &lt;/tbody&gt;&lt;/table&gt;\n        &lt;/td&gt;\n        &lt;td&gt;&lt;img src=\"/hkwp/HKWPCAP/images/en/HKWP_MAIN_LR.jpg\"&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n&lt;/div&gt;\n\n\n\n\n\n\n&lt;div class=\"footer_container\"&gt;\n&lt;table width=\"100%\"&gt;\n    &lt;tbody&gt;&lt;tr class=\"font_11_grey link_11_grey\"&gt;\n        &lt;td width=\"11%\" align=\"center\"&gt;\u00a9 2012 Cigna&lt;/td&gt;\n        &lt;td width=\"78%\" align=\"center\" class=\"footer_font\"&gt;&lt;a href=\"../unsecure/ConditionViewStandalone.do\" target=\"_blank\"&gt;Terms and Conditions&lt;/a&gt; | &lt;a href=\"../unsecure/Faq.do\" class=\"footer_font\" target=\"_blank\"&gt;FAQ&lt;/a&gt;&lt;/td&gt;\n        &lt;td width=\"11%\"&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>Based on my understanding, I inspected the two input boxes, which with Name username and password, but when the getElement method return Nothing. I also tried to print out the inputbox, but it also have no effect. It seems that username is not the correct index I should look for.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1536130326, "post_id": 52176727, "comment_id": 91307684, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23853547/unable-to-add-listrow-to-listobject-with-worksheet-protected-using-userinterface\">Unable to add ListRow to ListObject with worksheet protected using UserInterfaceOnly:=true</a>"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1536139898, "last_edit_date": 1536139898, "creation_date": 1536135401, "answer_id": 52180368, "question_id": 52176727, "link": "https://stackoverflow.com/questions/52176727/adding-a-listrow-into-a-table-of-a-protected-worksheet/52180368#52180368", "title": "Adding a ListRow into a table of a protected worksheet", "body": "<p>That's an issue with Excel that it doesn't allow to edit tables in <code>UserInterFaceOnly:=True</code> mode. Unfortunately, the only workaround I've found is to unprotect before any table methods are applied and then reprotect after:</p>\n\n<pre><code>.Unprotect Password:=SHEET_PW 'unprotect sheet          \n'edit table         \n.Protect Password:=SHEET_PW, UserInterFaceOnly:=True 'reprotect \n</code></pre>\n\n<p>Additionally I suggest the following improvement to shorten your code:</p>\n\n<ul>\n<li>Use arrays <code>Dim tbl(1 To 5)</code> instead of multiple variables <code>tbl1, tbl2, tbl3, \u2026</code></li>\n<li>Or better use an array to list your worksheet names only.</li>\n<li>Use more descriptive variable names (makes your life easier to maintain and read the code)</li>\n<li>If your table names are <em>always</em> <code>T_</code> followed by the worksheet name you can easily generate them out of your worksheet name.</li>\n<li>Use a constant for your worksheet password <code>SHEET_PW</code> to have it stored in only one place (easier to change, prevents typos).</li>\n<li>Use loops to do repetitive things.</li>\n</ul>\n\n<p>So we end up with:</p>\n\n<pre><code>Option Explicit\n\nConst SHEET_PW As String = \"Secret\" 'global password for protecting worksheets\n\nPublic Sub AddDataToTableImproved()\n    Dim AddValue As String\n    AddValue = InputBox(\"Add To Table, this cannot be undone\")\n\n    If StrPtr(AddValue) = 0 Then 'cancel button\n        MsgBox \"You clicked the Cancel button\"\n        Exit Sub\n    ElseIf AddValue = \"\" Then 'no input\n        MsgBox \"There is no Text Input\"\n        Exit Sub\n    End If\n\n    Dim NewRow As ListRow\n\n    Dim SheetNameList() As Variant\n    SheetNameList = Array(\"Setting\", \"R_Buy\", \"R_Sell\", \"S_Buy\", \"S_Sell\")\n\n    Dim SheetName As Variant\n    For Each SheetName In SheetNameList\n        With ThisWorkbook.Worksheets(SheetName)\n            .Unprotect Password:=SHEET_PW 'unprotect sheet\n\n            Set NewRow = .ListObjects(\"T_\" &amp; SheetName).ListRows.Add\n            NewRow.Range(1) = AddValue\n\n            .Protect Password:=SHEET_PW, UserInterFaceOnly:=True 'reprotect it\n        End With\n    Next SheetName\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10317948, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Mp_toOChY-U/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOHvM1k3BpKGQ852iJuDHhoHtUylw/mo/photo.jpg?sz=128", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10317948/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1574173757, "creation_date": 1536118931, "last_edit_date": 1574173757, "question_id": 52176727, "link": "https://stackoverflow.com/questions/52176727/adding-a-listrow-into-a-table-of-a-protected-worksheet", "title": "Adding a ListRow into a table of a protected worksheet", "body": "<p>I want to add data to last row in each table in each worksheet when the worksheet is protected.</p>\n\n<p>I have this code in ThisWorkbook to protect the worksheets</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim wSheet As Worksheet\n    For Each wSheet In Worksheets\n        wSheet.Protect Password:=\"Secret\", _\n        UserInterFaceOnly:=True\n    Next wSheet\nEnd Sub\n</code></pre>\n\n<p>and the following code to add the data. It throws</p>\n\n<blockquote>\n  <p>Error 1004 \"Application-defined or Object-defined error\"</p>\n</blockquote>\n\n<p>at the <code>Set newrow1 = tbl.ListRows.Add</code> when the worksheet is protected.</p>\n\n<pre><code>Sub AddDataToTable()\n    Application.ScreenUpdating = False\n    Dim MyValue As String\n    Dim sh As Worksheet\n    Dim ws1 As Worksheet\n    Dim ws2 As Worksheet\n    Dim ws3 As Worksheet\n    Dim ws4 As Worksheet\n    Dim ws5 As Worksheet\n    Set ws1 = Sheets(\"Setting\")\n    Set ws2 = Sheets(\"R_Buy\")\n    Set ws3 = Sheets(\"R_Sell\")\n    Set ws4 = Sheets(\"S_Buy\")\n    Set ws5 = Sheets(\"S_Sell\")\n    Dim tbl As ListObject\n    Dim tb2 As ListObject\n    Dim tb3 As ListObject\n    Dim tb4 As ListObject\n    Dim tb5 As ListObject\n    Set tbl = ws1.ListObjects(\"T_Setting\")\n    Set tb2 = ws2.ListObjects(\"T_R_Buy\")\n    Set tb3 = ws3.ListObjects(\"T_R_Sell\")\n    Set tb4 = ws4.ListObjects(\"T_S_Buy\")\n    Set tb5 = ws5.ListObjects(\"T_S_Sell\")\n    Dim newrow1 As ListRow\n    Dim newrow2 As ListRow\n    Dim newrow3 As ListRow\n    Dim newrow4 As ListRow\n    Dim newrow5 As ListRow\n\n    MyValue = InputBox(\"Add To Table, this cannot be undone\")\n\n    'check if user clicked Cancel button and, if appropriate, execute statements\n    If StrPtr(MyValue) = 0 Then\n        'display message box confirming that user clicked Cancel button\n        MsgBox \"You clicked the Cancel button\"\n        'check if user entered no input and, if appropriate, execute statements\n    ElseIf MyValue = \"\" Then\n        'display message box confirming that user entered no input\n        MsgBox \"There is no Text Input\"\n    Else\n        Set newrow1 = tbl.ListRows.Add\n        With newrow1\n            .Range(1) = MyValue\n        End With\n\n        Set newrow2 = tb2.ListRows.Add\n        With newrow2\n            .Range(1) = MyValue\n        End With\n\n        Set newrow3 = tb3.ListRows.Add\n        With newrow3\n            .Range(1) = MyValue\n        End With\n\n        Set newrow4 = tb4.ListRows.Add\n        With newrow4\n            .Range(1) = MyValue\n        End With\n\n        Set newrow5 = tb5.ListRows.Add\n        With newrow5\n            .Range(1) = MyValue\n        End With\n    End If\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-office"], "comments": [{"owner": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "edited": false, "score": 0, "creation_date": 1536116908, "post_id": 52176356, "comment_id": 91303347, "body": "I once had an issue with Excel being slow and it was due to a default printer not being set up."}, {"owner": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536117452, "post_id": 52176356, "comment_id": 91303459, "body": "@Comintern I use copy because I want to copy not only the value but also cell format. This code here is just an example for ease of understanding. In my real code, I use loop to divide data into different sheets."}, {"owner": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "reply_to_user": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "edited": false, "score": 0, "creation_date": 1536117632, "post_id": 52176356, "comment_id": 91303501, "body": "@HilaDG Thanks for the suggestion, I also read this on another website but it didn&#39;t help me in this case."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536117952, "post_id": 52176356, "comment_id": 91303568, "body": "Shouldnt you only be specifying the range on the right side of that function call? As in only <code>Worksheets(&quot;Sheet2&quot;).Range(&quot;A&quot; &amp; i).Copy Worksheets(&quot;Sheet2&quot;).Range(&quot;A&quot; &amp; i)</code>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536117986, "post_id": 52176356, "comment_id": 91303578, "body": "Also, is this the only code in this subroutine? It doesn&#39;t seem like copying maybe 10 values should really slow things down much"}, {"owner": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536120084, "post_id": 52176356, "comment_id": 91303996, "body": "@Marcucciboy2 I&#39;m sorry, It was just like you said, the value should not be there, I edited the post. The problem is only copying 10 range to another sheet would take half a minute."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536121902, "post_id": 52176356, "comment_id": 91304364, "body": "Just for a frame of reference on the performance, how many rows are there (a typical value for <code>lRow1</code>)?"}, {"owner": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536122922, "post_id": 52176356, "comment_id": 91304622, "body": "@Comintern lRow1 should be about 300-600. And the operation took a bout 5 sec when I was using office 2010. Now it takes forever..."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536146583, "post_id": 52176356, "comment_id": 91317463, "body": "How much of the rest of the code is reasonable to post? What you\u2019ve dropped in seems totally fine but I\u2019m suspicious of the surrounding code. How have you narrowed the slow part down to this?"}, {"owner": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536146888, "post_id": 52176356, "comment_id": 91317640, "body": "@Marcucciboy2 yeah, I&#39;m 100% percent sure it&#39;s the copy, the first section of code I posted is the code of the whole test sub that I created. And it took half a minute to copy 10 times ..."}], "owner": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1536122675, "creation_date": 1536115740, "last_edit_date": 1536122675, "question_id": 52176356, "link": "https://stackoverflow.com/questions/52176356/excel-2016-vba-copy-is-extremely-slow", "title": "Excel 2016 VBA - Copy is extremely slow", "body": "<p>I recently upgraded excel from 2010 to 2016(32bits) and suddenly the code that took 5sec to complete now takes forever. Even simple copy operation like the code below takes about half a minute to run.</p>\n\n<pre><code>For i = 1 To 10\n    Worksheets(\"Sheet2\").Range(\"A\" &amp; i).Copy Worksheets(\"Sheet2\").Range(\"A\" &amp; i)\nNext i\n</code></pre>\n\n<p>Is there anyway to fix this?</p>\n\n<p>EDIT: Below is the \"real\" code that @Comintern requested, there are about 1000 copies but it takes forever to run:</p>\n\n<pre><code>For i = 3 To lRow1        \n     Select Case Range(cType &amp; i).Value\n        Case \"Order\"\n            ws1.Rows(i).Copy wsOrder.Rows(lRowOrder + 1)\n            lRowOrder = lRowOrder + 1\n        Case \"UP\"\n            ws1.Rows(i).Copy wsUP.Rows(lRowUP + 1)\n            lRowUP = lRowUP + 1\n        Case \"Cancel\"\n            ws1.Rows(i).Copy wsCancel.Rows(lRowCancel + 1)\n            lRowCancel = lRowCancel + 1\n        Case \"Edit\"\n            ws1.Rows(i).Copy wsEdit.Rows(lRowEdit + 1)\n            lRowEdit = lRowEdit + 1\n        Case \"\"\n            ws1.Rows(i).Copy wsOther.Rows(lRowOther + 1)\n            lRowOther = lRowOther + 1\n    End Select\n\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536120696, "post_id": 52176309, "comment_id": 91304108, "body": "What research have you tried and what didn&#39;t work?   Here is a link that may help if you are stuck with researching: <a href=\"http://dailydoseofexcel.com/archives/2014/08/16/sync-pivots-from-dropdown/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2014/08/16/&hellip;</a>"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1536133795, "post_id": 52176309, "comment_id": 91309661, "body": "Have you tried using the &quot;Record a Macro&quot; option, setting the filter manually, the hitting &quot;Stop Recording&quot; and then adjusting the code it writes for you?"}, {"owner": {"reputation": 9, "user_id": 10317796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-peJn4L74n7s/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOUdm0W_PJfVsjMWzW9A-vEK5UNZg/mo/photo.jpg?sz=128", "display_name": "Stanley Low -", "link": "https://stackoverflow.com/users/10317796/stanley-low"}, "edited": false, "score": 0, "creation_date": 1536140162, "post_id": 52176309, "comment_id": 91313618, "body": "Yes I&#39;ve tried recording but I can&#39;t get the recorder to change the pivot filter based on cell A1. Any idea how I can do so?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1536154724, "post_id": 52176309, "comment_id": 91322790, "body": "Either by running a <code>For Each</code> on the  <code>PivotItems</code> and comparing each <code>.Caption</code> to A1, or by using <code>PivotFilters.Add2 Type:=xlCaptionEquals, Value1:=Range(&quot;A1&quot;).Value</code>"}], "owner": {"reputation": 9, "user_id": 10317796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-peJn4L74n7s/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOUdm0W_PJfVsjMWzW9A-vEK5UNZg/mo/photo.jpg?sz=128", "display_name": "Stanley Low -", "link": "https://stackoverflow.com/users/10317796/stanley-low"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536160468, "creation_date": 1536115199, "question_id": 52176309, "link": "https://stackoverflow.com/questions/52176309/macro-to-set-pivot-field-based-on-cell-value", "title": "Macro to set pivot field based on cell value", "body": "<p>I'm trying to figure out how can I write my macro to set my pivot filter based on a cell value</p>\n\n<p>A1=today()</p>\n\n<p>I want to set my pivot filter to automatically select the filter based on cell A1 when I run the macro. Can someone teach me the right code to do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1536121015, "post_id": 52176283, "comment_id": 91304191, "body": "Well for starters, <code>Sub Plus 50_Click()</code> isn&#39;t syntactically valid, so it wouldn&#39;t even compile. For the sake of the inquiry here, could you post the actual code that you&#39;re using?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1536129447, "post_id": 52176283, "comment_id": 91307185, "body": "One way I can think of is for you to have a generic <i>procedure</i>. This procedure will be called by all your shapes. You will just have to determine what shape called the procedure. You can either: 1) Assign a name that will relate the shape to the cell you want to manipulate. 2) Get the coordinates of the shape (top, left) to distinguish which cell to manipulate."}, {"owner": {"reputation": 15, "user_id": 8991350, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqUYI3TuIlw/AAAAAAAAAAI/AAAAAAAACK0/EZcM7tEjVH0/photo.jpg?sz=128", "display_name": "Abe M", "link": "https://stackoverflow.com/users/8991350/abe-m"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536162455, "post_id": 52176283, "comment_id": 91327898, "body": "@comintern that code did function the way I needed it to for one picture only."}, {"owner": {"reputation": 15, "user_id": 8991350, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqUYI3TuIlw/AAAAAAAAAAI/AAAAAAAACK0/EZcM7tEjVH0/photo.jpg?sz=128", "display_name": "Abe M", "link": "https://stackoverflow.com/users/8991350/abe-m"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1536162577, "post_id": 52176283, "comment_id": 91327977, "body": "@L42 that k you for this! I was thinking along those lines as well, but the issue is that I don&#39;t know how to go about generating a new picture, assigning a new macro to it, and linking a unique cell to each one... That&#39;s my challenge."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1536163214, "post_id": 52176283, "comment_id": 91328325, "body": "@AbeM Finding that hard to believe - <code>Plus 50_Click</code> isn&#39;t a valid name for a <code>Sub</code>. VBA identifiers can&#39;t contain spaces."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8991350, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqUYI3TuIlw/AAAAAAAAAAI/AAAAAAAACK0/EZcM7tEjVH0/photo.jpg?sz=128", "display_name": "Abe M", "link": "https://stackoverflow.com/users/8991350/abe-m"}, "edited": false, "score": 0, "creation_date": 1536162767, "post_id": 52188305, "comment_id": 91328065, "body": "that k you for this, I&#39;ll give it a try this evening as I&#39;m at work as it may prove to be a simple work around. Ideally though, what I&#39;d like to do, with code, is duplicate the +/- images you have in the image, one set for each row, and hav the buttons increase/decrease the values for their respective rows."}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 15, "user_id": 8991350, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqUYI3TuIlw/AAAAAAAAAAI/AAAAAAAACK0/EZcM7tEjVH0/photo.jpg?sz=128", "display_name": "Abe M", "link": "https://stackoverflow.com/users/8991350/abe-m"}, "edited": false, "score": 0, "creation_date": 1536163123, "post_id": 52188305, "comment_id": 91328265, "body": "That could also be done, but then you are storing extra shapes. Depending on how many times you replicate them, that could make your file size very large. In this implementation the buttons follow the selected cell, i.e. if you select B3, the buttons will move next to that cell. If you want to keep all the buttons, then remove the delete calls and the selection_change event. Then you can call the drawButtons manually, or by some other macro OR just copy/paste the buttons on the sheet (after the first  set is drawn)"}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 15, "user_id": 8991350, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqUYI3TuIlw/AAAAAAAAAAI/AAAAAAAACK0/EZcM7tEjVH0/photo.jpg?sz=128", "display_name": "Abe M", "link": "https://stackoverflow.com/users/8991350/abe-m"}, "edited": false, "score": 0, "creation_date": 1536163588, "post_id": 52188305, "comment_id": 91328516, "body": "if you change the position of the buttons, (i.e. assuming you remove the delete and copy/paste buttons) you may need to update the target range derivation. currently it assumes that the target cell is 1 to the left of the cell that the buttons are in: Set rng = getShapeRange(shp).Offset(0, -1)"}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 0, "last_activity_date": 1536159778, "creation_date": 1536159778, "answer_id": 52188305, "question_id": 52176283, "link": "https://stackoverflow.com/questions/52176283/duplicating-shape-with-linked-macro/52188305#52188305", "title": "Duplicating shape with linked macro", "body": "<p>I previously wrote a module to add custom buttons to add/delete rows from a table. I have modified it slightly for your use case, to increment/decrement the value of a target cell. It's not exactly what you asked for because the buttons float to the right of the target cell, but its pretty close and you can modify the draw method to fit your use case.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JsmKw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JsmKw.png\" alt=\"enter image description here\"></a></p>\n\n<p>The buttons draw on selection_change and are deleted if the selection is outside of the table (or target column). There is only ever 1 set of buttons - for my original use case we didn't want to balloon the file size with shapes (probably the same issue you are having with scroll bars.)</p>\n\n<ul>\n<li>You must be using a table on the target worksheet (i.e. listobject)</li>\n<li>There is an option in drawButtons() to restrict the buttons to a specific column - uncomment and add the correct column name if you want to use this.</li>\n<li>After adding the following code, just click anywhere in the table (or target table column) and the buttons will appear.</li>\n</ul>\n\n<p><strong>Add this in your target worksheet module:</strong></p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Call drawButtons(Target)\nEnd Sub\n</code></pre>\n\n<p><strong>Add a code module and paste the following:</strong></p>\n\n<pre><code>Option Explicit\n\n'Author:        Valon Miller\n'Description:   This module draws custom increment and decrement\n'               buttons on a list object that is intersected by the\n'               supplied target range.\n'Usgage:        Simply Call drawButtons(Target) from the\n'               selection_Change event of any worksheet.\n\nPrivate Const btnDiameter As Integer = 21\nPrivate Const btnPadding As Integer = 3\nPrivate btnLeft As Integer\n\nPublic Sub drawButtons(Target As Range)\n    Dim sh As Worksheet\n\n    Dim btnTop As Integer\n\n    Dim rng As Range\n    Dim objrow As ListRow\n\n    Dim appScreenUpdating As Boolean\n    Dim appCalculation As XlCalculation\n    Dim appEnableEvents As Boolean\n\n    On Error GoTo uhoh\n\n    With Application\n        'Remember Settings\n        appScreenUpdating = .ScreenUpdating\n        appCalculation = .Calculation\n        appEnableEvents = .EnableEvents\n        'Modify Settings\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n    End With\n\n    Set sh = Target.Parent\n\n    'delete buttons if they exist\n    deleteButtons sh\n\n    'Check if the target intersects a DataBodyRange\n    Set objrow = Range_getListRow(Target)\n    If objrow Is Nothing Then GoTo getout\n\n    'Uncomment to restrict the buttons to appear only when a specificed column is selected, by name\n    'If Intersect(Target, objrow.Parent.ListColumns(\"Column1\").DataBodyRange) Is Nothing Then GoTo getout\n\n    'Derive the target range of the buttons\n    Set rng = Intersect(Target, objrow.Range)\n    Set rng = rng.Cells(1, 1).Offset(0, rng.Columns.Count)\n\n    'Initialize Position Variables\n    btnTop = rng.Top + ((rng.Height - btnDiameter) / 2)\n    btnLeft = rng.Left + 3 + IIf(Range_getValidationType(rng.Cells(1, -1)) = 3, 16, btnPadding)\n\n    'Draw Increment Button\n    getNewButton sh, \"IncrementButton\", \"+\", \"add_Click\", btnLeft, btnTop, btnDiameter, msoShapeStylePreset37\n\n    'Draw Decrement Button\n    getNewButton sh, \"DecrementButton\", ChrW(&amp;H2212), \"sub_Click\", nextLeft, btnTop, btnDiameter, msoShapeStylePreset37\n\ngetout:\n\n    With Application\n        'Restore Settings\n        .ScreenUpdating = appScreenUpdating\n        .Calculation = appCalculation\n        .EnableEvents = appEnableEvents\n    End With\n\n    Exit Sub\n\nuhoh:\n\n    On Error Resume Next\n\n    deleteButtons sh\n\n    GoTo getout\n\nEnd Sub\n\n'************************************************************\n'*                     Custom Methods                       *\n'************************************************************\n\nPrivate Function nextLeft() As Integer\n    btnLeft = btnLeft + btnDiameter + btnPadding\n    nextLeft = btnLeft\nEnd Function\n\nPrivate Function getNewButton(sh As Worksheet, strName As String, strCaption As String, macro As String, _\n    intLeft As Integer, intTop As Integer, intDiameter As Integer, shpStyle As MsoShapeStyleIndex) As Shape\n\n    Dim shp As Shape\n\n    Set shp = sh.Shapes.AddShape(msoShapeOval, intLeft, intTop, intDiameter, intDiameter)\n\n    With shp\n\n        .name = strName\n        .TextFrame.Characters.Text = strCaption\n        .TextFrame.VerticalAlignment = xlVAlignCenter\n        .TextFrame.HorizontalAlignment = xlHAlignCenter\n        .TextEffect.FontBold = msoTrue\n        .TextEffect.FontSize = 15\n        .OnAction = macro\n        .Placement = xlFreeFloating\n        .shapeStyle = shpStyle\n\n        'msoShapeStylePreset    Theme\n        '---------------------------------\n        'msoShapeStylePreset36  Black\n        'msoShapeStylePreset37  Light Blue\n        'msoShapeStylePreset38  Orange\n        'msoShapeStylePreset39  Grey\n        'msoShapeStylePreset40  Yellow\n        'msoShapeStylePreset41  Dark Blue\n        'msoShapeStylePreset42  Green\n\n    End With\n\nEnd Function\n\nPrivate Sub deleteButtons(sh As Worksheet)\n    Dim shp As Shape\n    Dim buttonNames() As String\n    buttonNames = Split(\"IncrementButton,DecrementButton\", \",\")\n    On Error Resume Next\n    For Each shp In sh.Shapes\n        If Array_containsValue(buttonNames, shp.name) Then shp.Delete\n    Next shp\nEnd Sub\n\n'************************************************************\n'*                          Events                          *\n'************************************************************\n\nPublic Sub add_Click()\n    Dim newRecord As ListRow\n    Dim objList As ListObject\n    Dim sh As Worksheet\n    Dim rng As Range\n    Dim shp As Shape\n\n    On Error GoTo uhoh\n\n    Set sh = ActiveSheet\n    Set shp = getShapeByName(\"IncrementButton\", , sh)\n    Set rng = getShapeRange(shp).Offset(0, -1)\n    Set objList = rng.ListObject\n\n    'Do Stuff\n    rng = rng + 1\n\n    Exit Sub\n\nuhoh:\n\n    MsgBox \"Oops, unable to increment!\", vbCritical, \"Uhoh\"\n\nEnd Sub\n\nPublic Sub sub_Click()\n    Dim selectedRecord As ListRow\n    Dim objList As ListObject\n    Dim sh As Worksheet\n    Dim rng As Range\n    Dim shp As Shape\n\n    On Error GoTo uhoh\n\n    Set sh = ActiveSheet\n    Set shp = getShapeByName(\"DecrementButton\", , sh)\n    Set rng = getShapeRange(shp).Offset(0, -1)\n    Set objList = rng.ListObject\n\n    'Do Stuff\n    rng = rng - 1\n\n    Exit Sub\n\nuhoh:\n\n    MsgBox \"Oops, unable to decrement!\", vbCritical, \"Uhoh\"\n\nEnd Sub\n\n'************************************************************\n'*                     Generic Methods                      *\n'************************************************************\n\nPrivate Function Array_isEmpty(arr As Variant)\n' This function returns true if array is empty\n\n  Dim l As Long\n\n  On Error Resume Next\n  l = Len(Join(arr))\n  If l = 0 Then\n    Array_isEmpty = True\n  Else\n    Array_isEmpty = False\n  End If\n\n  If Err.Number &gt; 0 Then\n      Array_isEmpty = True\n  End If\n\n  On Error GoTo 0\n\nEnd Function\n\nPrivate Function Array_containsValue(myArray As Variant, item As Variant)\n    Dim i As Integer\n    If Array_isEmpty(myArray) Then Array_containsValue = False: Exit Function\n    For i = LBound(myArray) To UBound(myArray)\n        If item = myArray(i) Then Array_containsValue = True: Exit Function\n    Next i\n    Array_containsValue = False\nEnd Function\n\nPrivate Function getListObjectByName(strName As String) As ListObject\n    Dim sh As Worksheet\n    Dim tbl As ListObject\n    For Each sh In ThisWorkbook.Sheets\n        For Each tbl In sh.ListObjects\n            If tbl.name = strName Then Set getListObjectByName = tbl: Exit Function\n        Next tbl\n    Next sh\n    Set getListObjectByName = Nothing\nEnd Function\n\nPrivate Function Range_getListRow(Target As Range) As ListRow\n    'Check if target intersects with a list object\n    If Not Target.ListObject Is Nothing Then\n        'Check if the list object has a DataBodyRange\n        If Not Target.ListObject.DataBodyRange Is Nothing Then\n            'Check if the first row of the target range is in the DataBodyRange\n            If Not Intersect(Target.Rows(1), Target.ListObject.DataBodyRange) Is Nothing Then\n                'Return ListRow that intersects with the first row in the target range\n                Set Range_getListRow = Target.ListObject.ListRows(Target.Rows(1).Row - Target.ListObject.Range.Row)\n                Exit Function\n            End If\n        End If\n    End If\n    'No intersect, return nothing\n    Set Range_getListRow = Nothing\nEnd Function\n\nPrivate Function Range_getValidationType(rng As Range) As Integer\n    'Name                   Value   Description\n    'xlValidateInputOnly    0       Validate only when user changes the value.\n    'xlValidateWholeNumber  1       Whole numeric values.\n    'xlValidateDecimal      2       Numeric values.\n    'xlValidateList         3       Value must be present in a specified list.\n    'xlValidateDate         4       Date values.\n    'xlValidateTime         5       Time values.\n    'xlValidateTextLength   6       Length of text.\n    'xlValidateCustom       7       Data is validated using an arbitrary formula.\n    Dim t As XlDVType\n    On Error GoTo uhoh\n    Range_getValidationType = rng.Validation.Type\n    Exit Function\nuhoh:\n    Range_getValidationType = -1\nEnd Function\n\nPrivate Function getShapeByName(nm As String, Optional inWb As Workbook, Optional inSh As Worksheet) As Shape\n    Dim shp As Shape\n    Dim wb As Workbook\n    Dim sh As Worksheet\n    Dim mySheets As Collection\n    Dim i As Integer\n\n    On Error GoTo uhoh\n\n    'Get sheets to search\n    Set wb = IIf(inWb Is Nothing, ThisWorkbook, inWb)\n    Set mySheets = New Collection\n    If inSh Is Nothing Then\n        For Each sh In wb.Sheets\n            mySheets.Add sh\n        Next sh\n    Else\n        mySheets.Add inSh\n    End If\n\n    'Search for shape\n    For i = 1 To mySheets.Count\n        For Each shp In mySheets(i).Shapes\n            If shp.name = nm Then Set getShapeByName = shp: Exit Function\n        Next shp\n    Next i\n\nuhoh:\n\n    Set getShapeByName = Nothing\n\nEnd Function\n\nPrivate Function getShapeRange(shp As Shape) As Range\n    Dim x As Integer\n    Dim y As Integer\n    x = shp.Left + (shp.Width / 2)\n    y = shp.Top + (shp.Height / 2)\n    Set getShapeRange = Range_getByCoordinate(shp.Parent, x, y)\nEnd Function\n\nPrivate Function Range_getByCoordinate(sh As Worksheet, x As Integer, y As Integer) As Range\n    Dim nCol, nRow As Range\n    For Each nCol In sh.Columns\n        If nCol.Left &lt; x And nCol.Left + nCol.Width &gt; x Then\n            For Each nRow In sh.Rows\n                If nRow.Top &lt; y And nRow.Top + nRow.Height &gt; y Then\n                    Set Range_getByCoordinate = sh.Cells(nRow.Row, nCol.Column): Exit Function\n                End If\n            Next nRow\n        End If\n    Next nCol\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8991350, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqUYI3TuIlw/AAAAAAAAAAI/AAAAAAAACK0/EZcM7tEjVH0/photo.jpg?sz=128", "display_name": "Abe M", "link": "https://stackoverflow.com/users/8991350/abe-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 52188305, "answer_count": 1, "score": 0, "last_activity_date": 1536159778, "creation_date": 1536114901, "last_edit_date": 1536128524, "question_id": 52176283, "link": "https://stackoverflow.com/questions/52176283/duplicating-shape-with-linked-macro", "title": "Duplicating shape with linked macro", "body": "<p>I've been trying to automate a table to live calculate some values and have it prepared to add rows in the future. The simple item I'd like to add to this table is a '+' &amp; '-' symbol (shape or image) linked to a macro which can change a value in another column. Doing this once is quite simple, but I'd like my population macro to essentially copy/paste the shape, along with its macro, linked to the next row.</p>\n\n<p>For example:\na. Plus sign with macro assigned exists in A1 to click increases the value in B1 by 1\nb. initiating another macro would copy/paste the image from A1 to A2, and the assigned macro should increase the value in B2</p>\n\n<p>So far, I've been able to copy/paste the image, but unfortunately, all this does is enable both images to increase the value in B1.</p>\n\n<p>Any ideas or possibilities if this is possible at all?</p>\n\n<p>This is part of the code:\nFor the sake of the inquiry here, let's assume that there is working macro on the shape \"Plus 50\" which increases the value in B1 by an increment of 1.</p>\n\n<pre><code>For i = 1 to 50\n   ActiveSheet.Shapes(\"Plus 50\").Copy\n   Cells(i, 1).PasteSpecial\nNext i\n</code></pre>\n\n<p>Incremental macro for reference.</p>\n\n<pre><code>Sub Plus 50_Click()\n   Dim a As Integer\n   a = Cells(1, 2)\n   Cells(1, 2) = a + 1\nEnd Sub\n</code></pre>\n\n<p>Would love any help on this at all, it would drastically speed up my excel sheet as I'm currently using a bunch of scrollbars that are taking a lot of time to load.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536116349, "post_id": 52176196, "comment_id": 91303231, "body": "I&#39;d take anything you read on docs.microsoft.com with a grain of salt. The &quot;new&quot; documentation is complete trash."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536117191, "post_id": 52176196, "comment_id": 91303411, "body": "Adding what &quot;None of my tests work&quot; means <i>might</i> be useful e.g. any error messages?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1536117335, "post_id": 52176196, "comment_id": 91303441, "body": "@QHarr It&#39;s an error 1004, but I&#39;ve verified that in fact none of them work (all error 1004s). I don&#39;t remember ever seeing <code>Range</code> referred to as a parameter on the old MSDN Excel object model documentation."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536123604, "post_id": 52176855, "comment_id": 91304837, "body": "Wow, that&#39;s some obscure information there... I&#39;ll have to remember that next time I open up a workbook created around 1992. #TIL and hats off on that answer."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 2, "last_activity_date": 1536120009, "creation_date": 1536120009, "answer_id": 52176855, "question_id": 52176196, "link": "https://stackoverflow.com/questions/52176196/for-the-application-run-method-what-is-a-range-object-indicating-where-the-fun/52176855#52176855", "title": "For the Application.Run method, what is &quot;a Range object indicating where the function is&quot;?", "body": "<p>The option for a range parameter for <code>Application.Run</code> refers to an <code>Excel 4 Macro</code> ie a <code>Range</code> set to the first cell of a macro on a <code>Macro</code> Sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/k3swt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k3swt.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 290, "user_id": 6387947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68bd3078f0f802c7e8769ecfd63878d8?s=128&d=identicon&r=PG&f=1", "display_name": "scenography", "link": "https://stackoverflow.com/users/6387947/scenography"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 52176855, "answer_count": 1, "score": 0, "last_activity_date": 1536120009, "creation_date": 1536113951, "question_id": 52176196, "link": "https://stackoverflow.com/questions/52176196/for-the-application-run-method-what-is-a-range-object-indicating-where-the-fun", "title": "For the Application.Run method, what is &quot;a Range object indicating where the function is&quot;?", "body": "<p>What does it mean that a <strong>Range</strong> object can be a parameter of the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.run\" rel=\"nofollow noreferrer\">Application.Run Method (Excel)</a>?</p>\n\n<p>The documentation says the first parameter is \"the macro to run. This can be either a string with the macro name, a <strong>Range</strong> object indicating where the function is, or a register ID for a registered DLL (XLL) function. If a string is used, the string will be evaluated in the context of the active sheet.\"</p>\n\n<p>Does it mean a range with a function name or with code? None of my tests work:</p>\n\n<pre><code>Public Function TestFunctionA()\n    MsgBox \"It works!\"\nEnd Function\n\nSub FirstTestOfRunFromRange()\n'Function name in a cell\n    Dim rngA As Range\n    Set rngA = ActiveSheet.Range(\"A1\")\n    rngA = \"TestFunctionA\"\n    Application.Run \"TestFunctionA\"\n    Application.Run rngA\nEnd Sub\n\nSub SecondTestOfRunFromRange()\n'Function code in a cell\n    Dim rngA As Range\n    Set rngA = ActiveSheet.Range(\"A1\")\n    rngA = \"Public Function TestFunctionB()\" &amp; _\n        vbCrLf &amp; \"MsgBox \"\"It works!\"\"\" &amp; _\n        vbCrLf &amp; \"End Function\"\n    Application.Run rngA\nEnd Sub\n\nSub ThirdTestOfRunFromRange()\n'Function code as one line per cell\n    Dim rngA As Range\n    Set rngA = ActiveSheet.Range(\"A1\")\n    rngA.Offset(0, 0) = \"Public Function TestFunctionB()\"\n    rngA.Offset(1, 0) = \"MsgBox \"\"It works!\"\"\"\n    rngA.Offset(2, 0) = \"End Function\"\n    Set rngA = rngA.CurrentRegion\n    Application.Run rngA\nEnd Sub\n\nSub FourthTestOfRunFromRange()\n'Function code as one line in one cell\n    Dim rngA As Range\n    Set rngA = ActiveSheet.Range(\"A1\")\n    rngA = \"Public Function TestFunctionB(): MsgBox \"\"It works!\"\": End Function\"\n    Application.Run rngA\nEnd Sub\n\nSub FifthTestOfRunFromRange()\n'Code step in a cell\n    Dim rngA As Range\n    Set rngA = ActiveSheet.Range(\"A1\")\n    rngA = \"MsgBox \"\"It works!\"\"\"\n    Application.Run rngA\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1536112899, "post_id": 52175964, "comment_id": 91302648, "body": "There <i>can&#39;t</i> be a <code>Workbook_Anything</code> in <code>Module1</code>, <code>Workbook_EventName</code> would be in <code>ThisWorkbook</code>, or in a class module with a <code>Private WithEvents Workbook As workbook</code> field; standard modules can&#39;t handle events."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1536113108, "post_id": 52175964, "comment_id": 91302679, "body": "That said, it&#39;s pretty hard to tell what&#39;s going on without seeing the code. Try parsing the project with <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (disclaimer: I own this OSS project) - use the <i>Code Explorer</i> toolwindow (Ctrl+R) to drill down to each invididual member of each module - if a module has code, you&#39;ll see a little &quot;expand&quot; arrow next to it; you don&#39;t get that birds&#39; eye view of a VBA project without a VBE add-in."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1536113314, "post_id": 52175964, "comment_id": 91302709, "body": "If the project doesn&#39;t have any class modules, any worksheet&#39;s code-behind module could act as one and declare a <code>WithEvents</code> workbook object and handles that object&#39;s <code>BeforeSave</code> event by invoking a method in Module1. Wouldn&#39;t be standard, but then, I&#39;m out of ideas."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1536113775, "post_id": 52175964, "comment_id": 91302779, "body": "One way that might help you find what&#39;s happening: put a break in the code you know runs, then trigger it by saving the WB.  In the VBA IDE, look at the Call Stack (access via Ctrl-L) to see whats calling the Module1 code."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536119973, "post_id": 52175964, "comment_id": 91303967, "body": "Are there any volatile UDFs in the workbook?"}, {"owner": {"reputation": 67, "user_id": 2187575, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/340f3df256ec8060eb31e77783a83b0c?s=128&d=identicon&r=PG", "display_name": "Edward Chien", "link": "https://stackoverflow.com/users/2187575/edward-chien"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1536453015, "post_id": 52175964, "comment_id": 91429556, "body": "@MathieuGuindon, thanks very much for your suggestions and sorry for my delay. I was trying out what you said. There is nothing in ThisWorkbook and there are no WithEvents declarations in other modules. However, when I inserted break points and then tried to step out, I ended up with the message box &quot;Calculation is incomplete. Recalculate before saving?&quot;. This led me to discover some additional information which I am now going to put in my edited question."}, {"owner": {"reputation": 67, "user_id": 2187575, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/340f3df256ec8060eb31e77783a83b0c?s=128&d=identicon&r=PG", "display_name": "Edward Chien", "link": "https://stackoverflow.com/users/2187575/edward-chien"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1536453709, "post_id": 52175964, "comment_id": 91429630, "body": "@chrisneilsen Thank you very much for the suggestion. I did put a break in a function CalcSourcePoints and look at the call stack, but there was nothing in the stack except CalcSourcePoints, and none of the other functions in the project call CalcSourcePoints. So it is still a mystery to me how it is getting called."}], "owner": {"reputation": 67, "user_id": 2187575, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/340f3df256ec8060eb31e77783a83b0c?s=128&d=identicon&r=PG", "display_name": "Edward Chien", "link": "https://stackoverflow.com/users/2187575/edward-chien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536454352, "creation_date": 1536111906, "last_edit_date": 1536454352, "question_id": 52175964, "link": "https://stackoverflow.com/questions/52175964/excel-macro-is-running-on-workbook-save-without-vba", "title": "Excel macro is running on Workbook_Save without VBA?", "body": "<p>I have inherited an Excel workbook with a fair amount of VBA in a single module, \"Module1\". </p>\n\n<ul>\n<li>There is no Workbook_BeforeSave or Workbook_AfterSave event in Module1</li>\n<li>There is no VBA code at all in the ThisWorkbook object or any other module</li>\n<li>There is nothing listed under Developer > Macros</li>\n<li>There are no add-ins</li>\n<li>There are no data connections</li>\n</ul>\n\n<p>However, when I save the workbook, it is triggering code to run out of Module1. Where would the workbook be set up to do that if not in the VBA?</p>\n\n<p>In the name manager, I discovered named ranges with references in the format <code>='Workbook name.xlsm'!Function1('Sheet1'!A1:A10)</code>, and their scope is <code>ThisWorkbook</code>. Since auto-calculate is on, I suppose this is why Function1 is getting called when the workbook (and by extension, range <code>Sheet1!A1:A10</code>) gets saved? However, all the named ranges refer to Function1 and the VBA in Function1 does not explicitly call any other function, so I'm still not sure how it can be that the other functions in Module1 are running when I save the workbook. The first line in Function1 is <code>Application.Volatile</code>, if that makes a difference.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1536133295, "post_id": 52175715, "comment_id": 91309365, "body": "There can&#39;t be more than 1,048,576 unique items per fields in a Pivot Table, You probably have more."}, {"owner": {"reputation": 11, "user_id": 4304699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9kwg.jpg?s=128&g=1", "display_name": "MarBoTJ", "link": "https://stackoverflow.com/users/4304699/marbotj"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1536160890, "post_id": 52175715, "comment_id": 91326989, "body": "I have 45k rows. I created an index for each, using 3 columns. That may have made, in the worst case scenario, each row a unique record, not even close to the limit you mention."}], "owner": {"reputation": 11, "user_id": 4304699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9kwg.jpg?s=128&g=1", "display_name": "MarBoTJ", "link": "https://stackoverflow.com/users/4304699/marbotj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 755, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593761652, "creation_date": 1536109260, "last_edit_date": 1593761652, "question_id": 52175715, "link": "https://stackoverflow.com/questions/52175715/why-is-the-error-about-unique-items-showing", "title": "Why is the error about Unique items showing?", "body": "<p>I'm having an error that says: A field in your source data has more unique items that can be used in a PivotTable report.</p>\n\n<p>Basically, if choosing this field it won't create the report. I've just tried it manually since I get the VBA code from that manual step, but the error pops.</p>\n\n<p>My source data has ~45k rows.</p>\n\n<p>This is the code I'm using</p>\n\n<pre><code>Dim pt As PivotTable\nDim wrkSht As Worksheet\nDim pvtSht As Worksheet\nDim PTCache As PivotCache\nDim PRange As Range\nDim finalRow As Long\nDim finalCol As Long\n\nSet wrkSht = Worksheets(\"Data\")\nSet pvtSht = Worksheets(\"Pivot\")\n\nfinalRow = wrkSht.Cells(Application.Rows.Count, 1).End(xlDown).Row\nfinalCol = wrkSht.Cells(1, Application.Columns.Count).End(xlToLeft).Column\n\nSet PRange = wrkSht.UsedRange\nSet PTCache = ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, SourceData:=PRange)\n\nSet pt1 = PTCache.CreatePivotTable(TableDestination:=pvtSht.Cells(1, 1), TableName:=\"Pivot\")\npt1.RowAxisLayout xlCompactRow\n</code></pre>\n\n<p>Any help will be appreciated.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "sap"], "comments": [{"owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "edited": false, "score": 0, "creation_date": 1536103888, "post_id": 52174907, "comment_id": 91301163, "body": "I identified that the first column with ADAC_ value is under <code>session.findById(&quot;wnd[0]&#47;usr&#47;lbl[1,7]&quot;).caretPosition = 16</code> but I am still trying to figure out how to approach such a situation."}, {"owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "edited": false, "score": 0, "creation_date": 1536103995, "post_id": 52174907, "comment_id": 91301186, "body": "When the table has lines with values they start with <code>Session.findById(&quot;wnd[0]&#47;usr&#47;lbl[6,8]&quot;)</code>"}, {"owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "edited": false, "score": 0, "creation_date": 1536104350, "post_id": 52174907, "comment_id": 91301249, "body": "The pop up window says &quot;Control cannot be find by ID&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1536123033, "post_id": 52174907, "comment_id": 91304653, "body": "Posting the problem code increases your chances of getting an answer..."}, {"owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536163386, "post_id": 52174907, "comment_id": 91328417, "body": "@TimWilliams I added the code to the post (I specified in CAPS where my code get to the table content."}, {"owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536171085, "post_id": 52174907, "comment_id": 91332074, "body": "I tried to embed If Then Else statement: <code>If Session.findById(&quot;wnd[0]&#47;usr&#47;lbl[6,8]&quot;) Then Session.findById(&quot;wnd[0]&#47;usr&#47;lbl[6,8]&quot;).SetFocus Session.findById(&quot;wnd[0]&#47;usr&#47;lbl[6,8]&quot;).caretPosition = 1  Else Session.findById(&quot;wnd[0]&#47;tbar[0]&#47;btn[3]&quot;).press Session.findById(&quot;wnd[0]&#47;tbar[0]&#47;btn[3]&quot;).press GoTo NextIteration End If</code> But it says object does not support this method. What&#39;s wrong with it?"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1536172096, "post_id": 52174907, "comment_id": 91332519, "body": "Please look at this link: <a href=\"https://archive.sap.com/discussions/thread/3502273\" rel=\"nofollow noreferrer\">archive.sap.com/discussions/thread/3502273</a>     So you could either use the variable childcount or totscrol for the query. Unfortunately, I can not test it now because I&#39;m already at home."}, {"owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "reply_to_user": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1536183864, "post_id": 52174907, "comment_id": 91337302, "body": "@ScriptMan thanks for the hint! I will try to figure out how to implement it. I am getting into it but very slowly..."}, {"owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "reply_to_user": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1536212570, "post_id": 52174907, "comment_id": 91343618, "body": "@ScriptMan I did a little progress in terms of understanding how to set i. I need lbl[6,8] to have in the table to double click on a line. If I don&#39;t have that line I am just going back to the tree. What childcount is for?"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1536249327, "post_id": 52174907, "comment_id": 91365296, "body": "Related <a href=\"https://stackoverflow.com/q/52172874/692942\">My code cannot set a new session when a window appears</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "edited": false, "score": 0, "creation_date": 1536269562, "post_id": 52198221, "comment_id": 91374261, "body": "Hi @ScriptMan thank you so much for the guidance. I am definitely going to learn the theory to understand it at the deeper level. At this moment, as a beginner, I am just snowed under trials and errors..."}], "tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": false, "score": 0, "last_activity_date": 1536217238, "creation_date": 1536217238, "answer_id": 52198221, "question_id": 52174907, "link": "https://stackoverflow.com/questions/52174907/how-to-declare-the-window-with-zero-values/52198221#52198221", "title": "how to declare the window with zero values", "body": "<p>From the link I found out the following variables for you:</p>\n\n<pre><code>...\n'WE REACHED THE TABLE\n\nset sapusr = session.findById(\"wnd[0]/usr\")\nsapusr.VerticalScrollbar.Position = 0\nchildcount = sapusr.Children.Count\nlastchildID = sapusr.Children(childcount - 1).ID\nvisrow = CLng(Right(Left(lastchildID, Len(lastchildID) - 1), _\n        Len(lastchildID) - InStr(1, lastchildID, \",\") - 1))\ntotscrol = sapusr.VerticalScrollbar.Maximum\n'msgbox lastchildID\n'msgbox ChildCount\n'msgbox totscrol\n'msgbox visrow\nIf visrow &gt; 7 Then \n   Session.findById(\"wnd[0]/usr/lbl[6,8]\").SetFocus \n   Session.findById(\"wnd[0]/usr/lbl[6,8]\").caretPosition = 1\nElse \n   Session.findById(\"wnd[0]/tbar[0]/btn[3]\").press     \n   Session.findById(\"wnd[0]/tbar[0]/btn[3]\").press \n   GoTo NextIteration \nEnd If\n...\n</code></pre>\n\n<p>Regards,\nScriptMan</p>\n"}], "owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 395, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536249251, "creation_date": 1536101337, "last_edit_date": 1536249251, "question_id": 52174907, "link": "https://stackoverflow.com/questions/52174907/how-to-declare-the-window-with-zero-values", "title": "how to declare the window with zero values", "body": "<p>I have a situation when a table in SAP does not have fields and I have to go back to the main table and start on a next iteration. I do not know how to declare this event in VBA. In other cases, I just double-click on lines. This table calls a debug window and script stops. Can anyone give a hint on how to stop the debugger mode and go to the next iteration? My problem is I do not know how to declare such an event within VBA.</p>\n\n<p>TBL with zero lines</p>\n\n<p><a href=\"https://i.stack.imgur.com/gvSwR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gvSwR.png\" alt=\"enter image description here\"></a></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Looping_Tree()\r\n\r\nDim Application, Connection, Session As Object\r\nSet SapGuiAuto = GetObject(\"SAPGUI\")\r\nSet Application = SapGuiAuto.GetScriptingEngine\r\nSet Connection = Application.Children(0)\r\nSet Session = Connection.Children(0)\r\n\r\nIf Not IsObject(Application) Then\r\n   Set SapGuiAuto = GetObject(\"SAPGUI\")\r\n   Set Application = SapGuiAuto.GetScriptingEngine\r\nEnd If\r\nIf Not IsObject(Connection) Then\r\n   Set Connection = Application.Children(0)\r\nEnd If\r\nIf Not IsObject(Session) Then\r\n   Set Session = Connection.Children(0)\r\nEnd If\r\nIf IsObject(WScript) Then\r\n   WScript.ConnectObject Session, \"on\"\r\n   WScript.ConnectObject Application, \"on\"\r\nEnd If\r\n\r\nSession.findById(\"wnd[0]\").maximize\r\nSession.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nCT04\"\r\nSession.findById(\"wnd[0]/tbar[0]/btn[0]\").press\r\n\r\nSet objExcel = GetObject(, \"Excel.Application\")\r\nSet objSheet = objExcel.ActiveWorkbook.ActiveSheet\r\n\r\nCOL3 = Trim(CStr(objSheet.Range(\"C2\").Value)) 'Column3\r\nCOL4 = Trim(CStr(objSheet.Range(\"D2\").Value)) 'Column4\r\n\r\nSession.findById(\"wnd[0]/usr/subCHARACT:SAPLCTMV:2000/subHEADER:SAPLCTMV:1100/ctxtRCTAV-ATNAM\").Text = COL3\r\nSession.findById(\"wnd[0]/usr/subCHARACT:SAPLCTMV:2000/subHEADER:SAPLCTMV:1100/ctxtRCTAV-ATNAM\").caretPosition = 13\r\nSession.findById(\"wnd[0]/usr/subCHARACT:SAPLCTMV:2000/subHEADER:SAPLCTMV:1100/btnDISPLAY\").press\r\nSession.findById(\"wnd[0]/mbar/menu[4]/menu[0]\").Select\r\nSession.findById(\"wnd[0]/usr/chkGF_DEP\").Selected = True\r\nSession.findById(\"wnd[0]/usr/ctxtCAWN-ATWRT\").Text = COL4\r\nSession.findById(\"wnd[0]/usr/chkGF_DEP\").SetFocus\r\nSession.findById(\"wnd[0]/tbar[1]/btn[8]\").press\r\n\r\nDim myTree As Object\r\nDim RowCount, rows, i, j As Integer\r\n\r\nSet myTree = Session.findById(\"wnd[0]/usr/cntlUSAGE_TREE_CONTAINER/shellcont/shell/shellcont[1]/shell[1]\")\r\nRowCount = myTree.GetColumnCol(myTree.GetColumnNames.Item(0)).Length\r\nrows = RowCount - 1\r\n\r\nFor i = 5 To rows\r\n\r\n j = i - 3\r\n \r\n myTree.selectedNode Right(\"          \" + CStr(i), 11)\r\n myTree.doubleClickNode Right(\"          \" + CStr(i), 11)\r\n \r\nSession.findById(\"wnd[0]/mbar/menu[4]/menu[0]\").Select\r\n\r\nIf Session.ActiveWindow.Name = \"wnd[1]\" Then\r\n'Session.findById(\"wnd[1]/tbar[0]/btn[0]\").press\r\nSession.findById(\"wnd[1]\").sendVKey 0\r\nSession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\r\nGoTo NextIteration\r\nEnd If\r\n\r\n'WE REACHED THE TABLE\r\n\r\nSession.findById(\"wnd[0]/usr/lbl[6,8]\").SetFocus\r\nSession.findById(\"wnd[0]/usr/lbl[6,8]\").caretPosition = 1\r\n\r\nSession.findById(\"wnd[0]\").sendVKey 2\r\nSession.findById(\"wnd[0]/usr/tabsTS_ITEM/tabpPHPT/ssubSUBPAGE:SAPLCSDI:0830/ctxtRC29P-IDNRK\").SetFocus\r\nSession.findById(\"wnd[0]/usr/tabsTS_ITEM/tabpPHPT/ssubSUBPAGE:SAPLCSDI:0830/ctxtRC29P-IDNRK\").caretPosition = 5\r\nSession.findById(\"wnd[0]\").sendVKey 2\r\nSession.findById(\"wnd[0]/usr/tabsTABSPR1/tabpSP27\").Select\r\nSession.findById(\"wnd[1]/usr/ctxtRMMG1-WERKS\").Text = \"0600\"\r\nSession.findById(\"wnd[1]/usr/ctxtRMMG1-WERKS\").caretPosition = 4\r\nSession.findById(\"wnd[1]/tbar[0]/btn[0]\").press\r\n\r\n\r\nIf Session.ActiveWindow.Name = \"wnd[2]\" Then\r\n'Session.findById(\"wnd[2]/tbar[0]/btn[0]\").press\r\nSession.findById(\"wnd[2]\").sendVKey 0\r\nEnd If\r\n\r\n\r\nSession.findById(\"wnd[0]/usr/tabsTABSPR1/tabpSP27/ssubTABFRA1:SAPLMGMM:2000/subSUB3:SAPLMGD1:2953/txtMBEW-STPRS\").SetFocus\r\nSession.findById(\"wnd[0]/usr/tabsTABSPR1/tabpSP27/ssubTABFRA1:SAPLMGMM:2000/subSUB3:SAPLMGD1:2953/txtMBEW-STPRS\").caretPosition = 0\r\n\r\ncost = Session.findById(\"wnd[0]/usr/tabsTABSPR1/tabpSP27/ssubTABFRA1:SAPLMGMM:2000/subSUB3:SAPLMGD1:2953/txtMBEW-STPRS\").Text\r\nRange(\"G\" &amp; j) = cost 'Returns the most recent cost of a production part\r\n\r\nSession.findById(\"wnd[0]/usr/tabsTABSPR1/tabpSP27/ssubTABFRA1:SAPLMGMM:2000/subSUB1:SAPLMGD1:1009/ctxtRMMG1-MATNR\").SetFocus\r\nSession.findById(\"wnd[0]/usr/tabsTABSPR1/tabpSP27/ssubTABFRA1:SAPLMGMM:2000/subSUB1:SAPLMGD1:1009/ctxtRMMG1-MATNR\").caretPosition = 7\r\n\r\nmaterial = Session.findById(\"wnd[0]/usr/tabsTABSPR1/tabpSP27/ssubTABFRA1:SAPLMGMM:2000/subSUB1:SAPLMGD1:1009/ctxtRMMG1-MATNR\").Text\r\nRange(\"E\" &amp; j) = material 'Returns a production part number\r\n\r\nSession.findById(\"wnd[0]/usr/tabsTABSPR1/tabpSP27/ssubTABFRA1:SAPLMGMM:2000/subSUB1:SAPLMGD1:1009/txtMAKT-MAKTX\").SetFocus\r\nSession.findById(\"wnd[0]/usr/tabsTABSPR1/tabpSP27/ssubTABFRA1:SAPLMGMM:2000/subSUB1:SAPLMGD1:1009/txtMAKT-MAKTX\").caretPosition = 8\r\n\r\ndescription = Session.findById(\"wnd[0]/usr/tabsTABSPR1/tabpSP27/ssubTABFRA1:SAPLMGMM:2000/subSUB1:SAPLMGD1:1009/txtMAKT-MAKTX\").Text\r\nRange(\"F\" &amp; j) = description 'Returns production part description\r\n\r\nSession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\r\nSession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\r\nSession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\r\nSession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\r\n    \r\nNextIteration:\r\nNext i\r\n\r\n    \r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}]