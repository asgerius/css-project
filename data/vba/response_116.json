[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1490831637, "post_id": 43106102, "comment_id": 73293551, "body": "It&#39;s possible to do what you want - it looks like there is no sheet matching the value of <code>sheet_name</code> though."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1490831739, "post_id": 43106102, "comment_id": 73293574, "body": "Should it be <code>With sheet_name ... End With</code>?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1490833805, "post_id": 43106102, "comment_id": 73294121, "body": "Your code definitely works <i>provided</i> the list of names on sheet <code>Data</code> <i>exactly</i> match the sheet names (they are case insensitive).  Check for things like extra spaces on the beginning or end of the names (both in <code>data</code> and actual sheet names).  Any blanks in <code>Data!A2:A10</code> will also cause this error."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1490841759, "creation_date": 1490841759, "answer_id": 43107588, "question_id": 43106102, "link": "https://stackoverflow.com/questions/43106102/excel-vba-subscript-out-of-range-sheets-name-as-a-variable/43107588#43107588", "title": "Excel VBA - Subscript out of range - Sheets name as a variable", "body": "<p>The reason for your error was given in the comments above by @chris neilsen</p>\n\n<p>You could use the code below to check or avoid having these kind of errors:</p>\n\n<pre><code>Option Explicit\n\nSub CheckShtExists()\n\nDim data As Worksheet\nDim sheet_name As String\n\nSet data = ThisWorkbook.Sheets(\"Data\")\n\nDim ws As Worksheet\nDim ShtNamesArr() As String\nDim i As Long\n\nReDim ShtNamesArr(0 To ThisWorkbook.Worksheets.Count - 1) ' resize array to number of worksheets in This Workbook\n\n' loop thourgh all worksheets and store their names in array\nFor Each ws In ThisWorkbook.Worksheets\n    ShtNamesArr(i) = ws.Name\n    i = i + 1\nNext ws\n\nFor i = 2 To 10\n    If data.Range(\"A\" &amp; i).Value &lt;&gt; \"\" Then ' ignore blank cells\n        sheet_name = data.Range(\"A\" &amp; i).Value\n        If Not IsError(Application.Match(sheet_name, ShtNamesArr, 0)) Then ' use Application.Match to see there is a sheet with this name\n            With ThisWorkbook.Sheets(sheet_name)\n                'Operations on the worksheet\n            End With\n        Else ' No Match\n            MsgBox sheet_name &amp; \" doesn't exists in your workbook\"\n        End If\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7788729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61aabaf495900bdbbaa9103925fff9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Clem", "link": "https://stackoverflow.com/users/7788729/clem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2704, "favorite_count": 0, "accepted_answer_id": 43107588, "answer_count": 1, "score": 1, "last_activity_date": 1490841759, "creation_date": 1490831154, "last_edit_date": 1531164843, "question_id": 43106102, "link": "https://stackoverflow.com/questions/43106102/excel-vba-subscript-out-of-range-sheets-name-as-a-variable", "title": "Excel VBA - Subscript out of range - Sheets name as a variable", "body": "<p>I am trying to work on a Worksheet whose name is a variable.</p>\n\n<p>I have a main sheet, called \"data\" where I go to catch a list of names of existing sheets.</p>\n\n<p>My code is as follows :</p>\n\n<pre><code>Dim data as Worksheet\ndim sheet_name as String\nDim i as Integer\nSet data = ThisWorkbook.Sheets(\"Data\")\n\nFor i = 2 to 10\n    sheet_name = data.Range(\"A\"&amp;i).Value\n    With ThisWorkbook.Sheets(sheet_name)\n        'Operations on the worksheet\n    End With\nNext i\n</code></pre>\n\n<p>The error prompted is \"Runtime Error 9 : Subscript Out of Range\" for the specific line :</p>\n\n<pre><code>With This Workbook.Sheets(sheet_name)\n</code></pre>\n\n<p>It is as if the object Sheets didn't understand the string sheet_name.\nThe Sheet \"sheet_name\" exists for sure, I double-checked.</p>\n\n<p>Unfortunately, I cannot call the sheet by its name because I have too many sheets to operate on, this is why I wanted to do a loop.</p>\n\n<p>I tried not working with the \"With\" clause but just referring to every object of the sheets with \"ThisWorkbook.Sheets(sheet_name) in front but doesn't work either.</p>\n\n<p>Do you know if it is possible to call a string variable inside a Sheets()?</p>\n\n<p>Thanks a lot for your help !</p>\n\n<p>Kind regards,</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1490830830, "post_id": 43105925, "comment_id": 73293304, "body": "This seems to work, but now if I hit the command button, it pastes whatever I currently have on my clipboard into the new row. I need it to either exit the sub if the bookmark doesn&#39;t exist with an error message to inform the user, or pop up a new input box saying that&#39;s an invalid number, please try again, and automatically rerun that portion of the sub."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1490886196, "post_id": 43105925, "comment_id": 73322424, "body": "I edited the code to make it more complete. It pops ups a message box when the number is invalid. It doesn&#39;t do automatic retry, but you could modify the code for that. It also doesn&#39;t handle when the user hit&#39;s Cancel."}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 1, "last_activity_date": 1490886047, "last_edit_date": 1490886047, "creation_date": 1490830075, "answer_id": 43105925, "question_id": 43105625, "link": "https://stackoverflow.com/questions/43105625/error-handling-on-goto-bookmark-if-bookmark-doesnt-exist/43105925#43105925", "title": "Error handling on GoTo Bookmark if bookmark doesn&#39;t exist", "body": "<p>You could do something like this:</p>\n\n<pre><code>Dim bm As Word.Bookmark\nDim bm_name As String\n.\n.\nbm_name = \"A\" &amp; InputBox(\"119f, 979, 981a...\", \"Enter Number and Letter as Shown\")\n' TODO: if user hits Cancel, bm_name = \"\", need to trap with If bm_name=\"\"\nOn Error Resume Next\nSet bm = oSourceDoc.Bookmarks(bm_name)\nIf Err.Number = 0 Then\n    bm.Select\n    Selection.Tables(1).Select\n    Selection.Copy\n    ' Paste-to-target code goes here\n\nElse\n    Err.Clear\n    MsgBox \"Didn't find \" bm_name, vbOKOnly, \"Not found\"\nEnd If\n</code></pre>\n\n<p>Hope that helps</p>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1490887524, "post_id": 43115383, "comment_id": 73323397, "body": "Ok, so I pasted this code into the command button. When I run the code, it deletes the information from the fourth row from the bottom (when I actually need a new row inserted at that point), and it leaves the row blank. I tried it with several bookmarks, and same thing. The target document has a table on it that I need to add to, but the bottom four rows of that table are final information (user name, notes, etc.) and have to stay at the bottom. I need to add rows to import the data from the source doc. I will usually add between 2-7 rows."}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "edited": false, "score": 0, "creation_date": 1490888868, "post_id": 43115383, "comment_id": 73324349, "body": "Is it easier to just grab the table from the source document (each table is just one row) corresponding to the bookmark and insert that row into the target document table at a point 4 rows up from the bottom? That would clear up any issues with adding new rows, then pasting text into those rows."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1490870208, "creation_date": 1490870208, "answer_id": 43115383, "question_id": 43105625, "link": "https://stackoverflow.com/questions/43105625/error-handling-on-goto-bookmark-if-bookmark-doesnt-exist/43115383#43115383", "title": "Error handling on GoTo Bookmark if bookmark doesn&#39;t exist", "body": "<p>Please try this code. I have added some comments which I hope you will find useful.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n    ' Copy table from source document and add to table in target document\n\n    Dim TarDoc As Document, SourDoc As Document\n    Dim Tbl As Table\n    Dim NewRow As Row\n    Dim Mark As String, MarkText As String\n\n    Set SourDoc = Documents.Open(\"H:\\Test Documents\\Tables.docx\")\n    Set TarDoc = Documents.Open(\"H:\\Test Documents\\Product.docm\")\n\n    Application.ScreenUpdating = False\n\n'    TarDoc.Activate                            ' no need to activate\n    ' actually, since ScreenUpdating is off, Activate is without effect\n    Set Tbl = TarDoc.Tables(2)\n    Set NewRow = Tbl.Rows(Tbl.Rows.Count - 3)   ' this is an existing row\n    ' this code inserts a row before the existing row(3)\n    ' With Tbl\n    '    .Rows.Add BeforeRow:=.Rows(3)\n    ' End With\n    ' use Tbl.Rows.Add to append a row at the end\n'    SourDoc.Activate                           ' no need to activate\n\n    Do\n        Mark = InputBox(\"119f, 979, 981a...\", \"Enter Number and Letter as Shown\")\n        If Len(Mark) Then              ' do nothing if user enters nothing\n            Mark = \"A\" &amp; Mark\n            If SourDoc.Bookmarks.Exists(Mark) Then\n                MarkText = SourDoc.Bookmarks(Mark).Range.Text\n                ' This seems to serve no purpose:\n                '    With SourDoc.Bookmarks\n                '        .DefaultSorting = wdSortByName\n                '        .ShowHidden = False\n                '    End With\n                '    Selection.Tables(1).Select ' no need to select\n                '    Selection.Copy             ' MarktText already got the text\n                '    TarDoc.Activate            ' no need to activate\n                '    NewRow.Select              ' no need to select\n                '    Selection.Paste            ' no need to paste\n                NewRow.Cells(1).Range.Text = MarkText\n                Mark = vbNullString    ' to enable existing the loop\n            Else\n                MsgBox \"Bookmark \"\"\" &amp; Mark &amp; \"\"\" doesn't exist.\", vbInformation, _\n                       \"Invalid entry\"\n            End If\n        End If\n    Loop While Len(Mark)               ' the user entered a wrong mark\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>If the user enters a non-existing mark name he gets an error message and another chance. To exit the InputBox without entering a valid bookmark just leave it blank.</p>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1490935554, "creation_date": 1490935554, "answer_id": 43132637, "question_id": 43105625, "link": "https://stackoverflow.com/questions/43105625/error-handling-on-goto-bookmark-if-bookmark-doesnt-exist/43132637#43132637", "title": "Error handling on GoTo Bookmark if bookmark doesn&#39;t exist", "body": "<p>You didn't amend your code for adding the row as I had suggested. It was your own previous code which caused the error. The following code is tested and works as you now describe.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n    ' Copy table from source document and add to table in target document\n\n    Dim TarDoc As Document, SourDoc As Document\n    Dim Tbl As Table\n    Dim NewRow As Row\n    Dim Mark As String, MarkText As String\n\n    Set SourDoc = Documents.Open(\"H:\\Test Documents\\Tables.docx\")\n    Set TarDoc = Documents.Open(\"H:\\Test Documents\\Product.docm\")\n\n    Application.ScreenUpdating = False\n\n    Set Tbl = TarDoc.Tables(2)\n    With Tbl\n       Set NewRow = .Rows.Add(BeforeRow:=.Rows(.Rows.Count - 2))\n    End With\n\n    Do\n        Mark = InputBox(\"119f, 979, 981a...\", \"Enter Number and Letter as Shown\")\n        If Len(Mark) Then              ' do nothing if user enters nothing\n            Mark = \"A\" &amp; Mark\n            If SourDoc.Bookmarks.Exists(Mark) Then\n                MarkText = SourDoc.Bookmarks(Mark).Range.Text\n                NewRow.Cells(1).Range.Text = MarkText\n                Mark = vbNullString    ' to enable existing the loop\n            Else\n                MsgBox \"Bookmark \"\"\" &amp; Mark &amp; \"\"\" doesn't exist.\", vbInformation, _\n                       \"Invalid entry\"\n            End If\n        End If\n    Loop While Len(Mark)               ' the user entered a wrong mark\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "accepted_answer_id": 43132637, "answer_count": 3, "score": 0, "last_activity_date": 1490935554, "creation_date": 1490828159, "question_id": 43105625, "link": "https://stackoverflow.com/questions/43105625/error-handling-on-goto-bookmark-if-bookmark-doesnt-exist", "title": "Error handling on GoTo Bookmark if bookmark doesn&#39;t exist", "body": "<p>I'm working on a macro to copy and paste bookmarked tables from one word document to another. It works fine as long as the value I put in the input box matches an existing bookmark, but if I mistype the value, it simply pulls in the top table from my source document. I understand why it does that (because it selects table 1 if it doesn't find a bookmark), but I can't figure out how to fix it. I tried putting in error handling, but since it doesn't trigger an error, what I added doesn't work. Can someone show me how to edit the code below to fix this issue? Also, is there a way to use relative pathways for the source document and target document? They will always be in the same folder, but each different user will have a copy of them in their own folder, and I don't want to rewrite the macro every time. Any other improvements or edits would be appreciated, such as how to not use the selection event so much here. Or how to not reopen the documents if they are already open. The command button (and code) is in the Target document (Product.docm)</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n' Copy table from source document and add to table in target document\n\n  Dim oTarDoc As Document, oSourceDoc As Document   \n  Dim oTable As Table   \n  Dim oNewRow As Row\n\n    Set oSourceDoc = Documents.Open(\"H:\\Test Documents\\Tables.docx\")   \n    Set oTarDoc = Documents.Open(\"H:\\Test Documents\\Product.docm\")\n\n    Application.ScreenUpdating = False\n\n    oTarDoc.Activate\n    Set oTable = oTarDoc.Tables(2)\n    Set oNewRow = oTable.Rows(oTable.Rows.Count - 3)\n\n    oSourceDoc.Activate\n    Selection.GoTo What:=wdGoToBookmark, Name:=\"A\" &amp; InputBox(\"119f, 979, 981a...\", \"Enter Number and Letter as Shown\")\n    With oSourceDoc.Bookmarks\n        .DefaultSorting = wdSortByName\n        .ShowHidden = False\n    End With\n    Selection.Tables(1).Select\n    Selection.Copy\n\n    oTarDoc.Activate\n    oNewRow.Select\n    Selection.Paste\n       Application.ScreenUpdating = True    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 53, "user_id": 7769218, "user_type": "registered", "profile_image": "https://graph.facebook.com/1451423001597526/picture?type=large", "display_name": "Mar&#237;a Pilar Alcalde", "link": "https://stackoverflow.com/users/7769218/mar%c3%ada-pilar-alcalde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1490830368, "creation_date": 1490827187, "last_edit_date": 1490830368, "question_id": 43105457, "link": "https://stackoverflow.com/questions/43105457/apply-various-graphs-in-multiple-excel-sheets-acording-to-the-number-rows-in-ea", "title": "Apply various graphs in multiple Excel sheets (acording to the number rows in each sheet)", "body": "<p>I have created a pivot chart showing main cities as \"filter\" (80 in total) and certain performance numbers as \"sum of values\". In an Excel file, I have 26 sheets corresponding to the countries of those cities, and in every sheet a table with the list of cities (for some countries it could be 1 row (1 city), 5 rows or whatever..)</p>\n\n<p>In each country sheet, I\u00b4m supposed to show that table (already done) together with a graph for each row of the table performance (again, it could be 1, 5 or whatever).  </p>\n\n<p>I thought that the easiest way to perform it was to paste the pivot chart in every sheet and then select automatically every row with the city name and apply it to the filter of the pivot.</p>\n\n<p>By far, that\u00b4s the code I wrote:</p>\n\n<pre><code>Sub PastPivot() \n    Dim sht As Worksheet\n        ActiveSheet.ChartObjects(\"Chart 1\").Activate\n        ActiveChart.ChartArea.Copy\n    For Each sht In Worksheets\n        sht.Range(\"a16\").PasteSpecial\n    Next\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>but I have several issues:</p>\n\n<ol>\n<li><p>It pump up \"error 5\" when running the code</p></li>\n<li><p>I\u00b4m not sure on how to write the code for it to perform in each sheet as many charts as rows (and how to determine the location of the chart considering that I won\u00b4t have the same number of charts on each sheet).</p></li>\n</ol>\n\n<p>Maybe the solution is to use another type of graph and not a pivot one.</p>\n\n<p>Any advice on how to perform it?</p>\n"}, {"tags": ["vba", "href"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4466762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1516819922/picture?type=large", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/4466762/emanuele"}, "edited": false, "score": 0, "creation_date": 1490908072, "post_id": 43107914, "comment_id": 73335533, "body": "I will try this, but I thought there may have been a way without actually extracting the reference, to select (or activate) the link. In thesame way I can search by tag the search bottom of google my expectation is that I could .click the link once I pointed to it through a getelementbyclass function.. ah I am using excel 2013 to pull data out finace site (if this add info to the request)"}, {"owner": {"reputation": 57, "user_id": 4466762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1516819922/picture?type=large", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/4466762/emanuele"}, "edited": false, "score": 0, "creation_date": 1490909897, "post_id": 43107914, "comment_id": 73336334, "body": "Actually, after a better seach I found this link <a href=\"http://stackoverflow.com/questions/24638533/how-do-i-use-excel-vba-to-click-a-link-on-a-web-page\" title=\"how do i use excel vba to click a link on a web page\">stackoverflow.com/questions/24638533/&hellip;</a>. The last comment seems to point at hte solution i was proposing but seems not to work.."}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 57, "user_id": 4466762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1516819922/picture?type=large", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/4466762/emanuele"}, "edited": false, "score": 0, "creation_date": 1490930785, "post_id": 43107914, "comment_id": 73341796, "body": "Remove the click, make it as <code>Dim obj As Object</code>  <code>Set obj = objIE.document.getElementByClassName(&quot;msDataText searchLink&quot;)</code> Assign it to an object and in watch window see the details of the object. It will give you some hint."}, {"owner": {"reputation": 57, "user_id": 4466762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1516819922/picture?type=large", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/4466762/emanuele"}, "edited": false, "score": 0, "creation_date": 1491086283, "post_id": 43107914, "comment_id": 73400228, "body": "out of context...  I attach the full code till the point it crashes..  pleae let me know."}], "tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": false, "score": 1, "last_activity_date": 1490844037, "last_edit_date": 1495540461, "creation_date": 1490844037, "answer_id": 43107914, "question_id": 43105044, "link": "https://stackoverflow.com/questions/43105044/click-on-a-href-in-vba/43107914#43107914", "title": "Click on a href in VBA", "body": "<p>Not sure if it is a duplicate question.\nA good function <code>GetHTTPResult</code> is already available from the <a href=\"https://stackoverflow.com/questions/18163560/excel-vba-http-request-download-data-from-yahoo-finance\">link</a>. You need to just pass the url for the GET request to fetch the data. For POST request (this function will not work), you need to make a POST request with postdata.</p>\n\n<p>Also there is a sample for XMLHttpRequest at <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">link</a></p>\n\n<pre><code>Function GetHTTPResult(sURL As String) As String\n    Dim XMLHTTP As Variant, sResult As String\n\n    Set XMLHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n    XMLHTTP.Open \"GET\", sURL, False\n    XMLHTTP.Send\n    Debug.Print \"Status: \" &amp; XMLHTTP.Status &amp; \" - \" &amp; XMLHTTP.StatusText\n    sResult = XMLHTTP.ResponseText\n    Debug.Print \"Length of response: \" &amp; Len(sResult)\n    Set XMLHTTP = Nothing\n    GetHTTPResult = sResult\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4466762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1516819922/picture?type=large", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/4466762/emanuele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490844037, "creation_date": 1490825319, "question_id": 43105044, "link": "https://stackoverflow.com/questions/43105044/click-on-a-href-in-vba", "title": "Click on a href in VBA", "body": "<p>I want to click on the following link</p>\n\n<p><a href=\"https://i.stack.imgur.com/VsJ7j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VsJ7j.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have the class name and the line code I was trying ot use is the following:</p>\n\n<pre><code>objIE.document.getElementByClassName(\"msDataText searchLink\").Click\n</code></pre>\n\n<p>This may well be a very basic question.. any guidance</p>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490825589, "post_id": 43104920, "comment_id": 73291637, "body": "What have you tried so far? I see you tagged with <code>conditional-formatting</code>, what formatting rules have you tried? What has worked, or hasn&#39;t worked?"}, {"owner": {"reputation": 1727, "user_id": 546439, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0291fbbcbedcf6032465d6793596eacc?s=128&d=identicon&r=PG", "display_name": "Dv_MH", "link": "https://stackoverflow.com/users/546439/dv-mh"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490826510, "post_id": 43104920, "comment_id": 73291974, "body": "I have a lot of excel conditional formatting rules applied to another sheet. I am trying to do it in VBA this time. I know about the function to check when a change has occured in VBA which is: &quot;Private Sub Worksheet_Change(ByVal Target As Range)&quot; and I know how to check for intersection using &quot;If ((Not Intersect(Target, Range(&quot;B:B&quot;)) Is Nothing)) Then&quot;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490827435, "post_id": 43104920, "comment_id": 73292284, "body": "Can you please edit the code into your OP, and tag with the code tags (<code>{}</code>)? Thanks!"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1490839249, "post_id": 43104920, "comment_id": 73295423, "body": "The provided code is not related to the requirements..."}, {"owner": {"reputation": 1727, "user_id": 546439, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0291fbbcbedcf6032465d6793596eacc?s=128&d=identicon&r=PG", "display_name": "Dv_MH", "link": "https://stackoverflow.com/users/546439/dv-mh"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1491052672, "post_id": 43104920, "comment_id": 73389932, "body": "@RobinMackenzie yes it&#39;s just to show what I have so far. That&#39;s why I am asking for an answer"}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 5, "last_activity_date": 1491236608, "last_edit_date": 1491236608, "creation_date": 1491059869, "answer_id": 43158549, "question_id": 43104920, "link": "https://stackoverflow.com/questions/43104920/autoformat-row-based-on-values-in-each-cell-using-excel-vba/43158549#43158549", "title": "Autoformat row based on values in each cell using Excel VBA?", "body": "<p>Try this code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim Rng As Range, R As Range\n    Dim fCol As Long, bCol As Long\n\n    Set Rng = Application.Intersect(Target, Columns(\"A:C\"))\n\n    If Not Rng Is Nothing Then\n\n     Set Rng = Application.Intersect(Rng.EntireRow, Columns(\"A:C\"))\n     fCol = vbWhite\n\n     For Each R In Rng.Rows\n\n       If R.Cells(1, 1).Value &lt;&gt; vbNullString And R.Cells(1, 1).Value &lt; Now Then\n         bCol = vbRed\n       ElseIf R.Cells(1, 2).Value &lt;&gt; vbNullString And R.Cells(1, 2).Value = \"Success\" Then\n         bCol = vbGreen\n       ElseIf R.Cells(1, 3).Value &lt;&gt; vbNullString And R.Cells(1, 3).Value &lt; 500 Then\n         bCol = vbBlue\n       Else\n         bCol = xlNone\n         fCol = vbBlack\n       End If\n\n       R.EntireRow.Interior.Color = bCol\n       R.EntireRow.Font.Color = fCol\n\n     Next\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong>:</p>\n\n<blockquote>\n  <blockquote>\n    <p>I have Table1</p>\n  </blockquote>\n</blockquote>\n\n<p>If Table1 is a <code>ListObject</code> (<a href=\"https://support.office.com/en-us/article/Overview-of-Excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c?ui=en-US&amp;rs=en-US&amp;ad=US&amp;fromAR=1\" rel=\"nofollow noreferrer\">Excel tables</a>) then we can modify the above code to make it watch first three columns of this table regardless of where the first column is starting (in column \"A\" or \"B\" or etc..), and format only the table row not the EntireRow :  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n  Dim LObj As ListObject\n  Dim RngToWatch As Range\n  Dim Rng As Range, R As Range\n  Dim fCol As Long, bCol As Long\n\n  Set LObj = ListObjects(\"Table1\") ' the name of the table\n  Set RngToWatch = Range(LObj.ListColumns(1).DataBodyRange, LObj.ListColumns(3).DataBodyRange)\n  Set Rng = Application.Intersect(Target, RngToWatch)\n\n  If Not Rng Is Nothing Then\n\n    Set Rng = Application.Intersect(Target.EntireRow, RngToWatch)\n    fCol = vbWhite\n\n    For Each R In Rng.Rows\n\n       If R.Cells(1, 1).Value &lt;&gt; vbNullString And R.Cells(1, 1).Value &lt; Now Then\n         bCol = vbRed\n       ElseIf R.Cells(1, 2).Value &lt;&gt; vbNullString And R.Cells(1, 2).Value = \"Success\" Then\n         bCol = vbGreen\n       ElseIf R.Cells(1, 3).Value &lt;&gt; vbNullString And R.Cells(1, 3).Value &lt; 500 Then\n         bCol = vbBlue\n       Else\n         bCol = xlNone\n         fCol = vbBlack\n       End If\n\n       With Application.Intersect(LObj.DataBodyRange, R.EntireRow)\n          .Interior.Color = bCol\n          .Font.Color = fCol\n       End With\n\n    Next\n\n  End If\n\nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 216, "user_id": 7034705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U1yFv.jpg?s=128&g=1", "display_name": "ArindamD", "link": "https://stackoverflow.com/users/7034705/arindamd"}, "is_accepted": false, "score": 3, "last_activity_date": 1491212599, "creation_date": 1491212599, "answer_id": 43181327, "question_id": 43104920, "link": "https://stackoverflow.com/questions/43104920/autoformat-row-based-on-values-in-each-cell-using-excel-vba/43181327#43181327", "title": "Autoformat row based on values in each cell using Excel VBA?", "body": "<p>I am assuming your table (having three columns) are present in Sheet1.\nSo, add following code in Sheet1 (not in separate module)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  Dim irow As Variant\n\n  ' First identify the row changed\n  irow = Target.Row\n\n  ' Invoke row formatter routine\n  Call DefineFormat(irow)\n\nEnd Sub\n</code></pre>\n\n<p>Then add following piece of code in a module (you may add under Sheet1 as well but it will limit the uses of this module)</p>\n\n<pre><code>Sub DefineFormat(irow) ' Receive the row number for processing\n\n    Dim vVal As Variant\n    Dim Rng As Range\n    Dim lFont, lFill As Long\n\n    ' Define the basis for validation\n    Dim Current, Success, limit As Variant ' Can be defined as constant as well\n        Current = Date ' Set today's date\n        Success = \"Success\" ' Set success status check\n        limit = 500 ' Set limit for value check\n\n    ' Set range for the entire row - Columns A(index 1) to Column C (index 3)\n    Set Rng = Range(Application.ActiveSheet.Cells(irow, 1).Address, Application.ActiveSheet.Cells(irow, 3).Address)\n    lFont = vbWhite\n\n    ' Assuming columns A, B and C needs to be formatted\n    If Application.ActiveSheet.Cells(irow, 1) &lt; Current Then\n        lFill = vbRed  ' Check for col A\n        Else:\n            If Application.ActiveSheet.Cells(irow, 2) = Success Then\n            lFill = vbGreen   ' Check for col B\n            Else\n                If Application.ActiveSheet.Cells(irow, 3) &lt; limit Then\n                 lFill = vbBlue   ' Check for col C\n                 Else     ' Default formatting\n                    lFill = xlNone\n                    lFont = vbBlack\n                End If\n            End If\n    End If\n\n        Rng.Interior.Color = lFill\n        Rng.Font.Color = lFont\nEnd Sub\n</code></pre>\n\n<p>This will format the row as the data is modified (just like conditional formatting)</p>\n\n<p>Also, if you need to format the entire table in one go, then you may call DefineFormat routine in a loop for each row of the table as illustrated by Fadi in his reply.</p>\n"}], "owner": {"reputation": 1727, "user_id": 546439, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0291fbbcbedcf6032465d6793596eacc?s=128&d=identicon&r=PG", "display_name": "Dv_MH", "link": "https://stackoverflow.com/users/546439/dv-mh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1587, "favorite_count": 2, "accepted_answer_id": 43158549, "answer_count": 2, "score": 6, "last_activity_date": 1491657371, "creation_date": 1490824742, "last_edit_date": 1491052724, "question_id": 43104920, "link": "https://stackoverflow.com/questions/43104920/autoformat-row-based-on-values-in-each-cell-using-excel-vba", "title": "Autoformat row based on values in each cell using Excel VBA?", "body": "<p>I have Table1</p>\n\n<p>Column A has a Date e.g. 30/5/2017</p>\n\n<p>Column B has Status e.g \"Success\"</p>\n\n<p>Column C has Value e.g 500</p>\n\n<p>Requirement: Apply custom Conditional formatting in VBA when a cell is changed</p>\n\n<p>Let's say the change happened in Columns A, B or C in row 5</p>\n\n<p>Regardless whether the change happened in Columns A, B, or C, the same logic should be executed.</p>\n\n<p>If column A value is less than Now(), then row 5 should be red background and white text. No further checks should run.</p>\n\n<p>Else If column B is \"Success\", then row 5 should be green background and white text. No further checks should run.</p>\n\n<p>Else If column C has value less than 500, then row 5 should be blue background and white text. No further checks should run.</p>\n\n<p>The VBA code below is to check for change on a cell - it autoformats cell in column b with a hyperlink. </p>\n\n<p>What I need now is to autoformat the whole row based on the criteria above.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n          If ((Not Intersect(Target, Range(\"B:B\")) Is Nothing) Or (Not Intersect(Target, Range(\"F:F\")) Is Nothing) Or (Not Intersect(Target, Range(\"G:G\")) Is Nothing) Or (Not Intersect(Target, Range(\"I:I\")) Is Nothing)) Then    \n\n          End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "formula", "textjoin"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490825670, "post_id": 43104790, "comment_id": 73291663, "body": "What have you tried so far?  At the very least, a nested <code>IF()</code> statement looks like it would work."}, {"owner": {"reputation": 49, "user_id": 7788442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bac8e7018dfae78c4c2d346d755e332?s=128&d=identicon&r=PG&f=1", "display_name": "Elissa", "link": "https://stackoverflow.com/users/7788442/elissa"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490826910, "post_id": 43104790, "comment_id": 73292095, "body": "I tried an IF function but was getting errors that it had too many arguments"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1490826025, "post_id": 43105199, "comment_id": 73291799, "body": "Clever! I was playing with <code>TextJoin()</code> but couldn&#39;t find a nice way to only fill cells with a value."}, {"owner": {"reputation": 49, "user_id": 7788442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bac8e7018dfae78c4c2d346d755e332?s=128&d=identicon&r=PG&f=1", "display_name": "Elissa", "link": "https://stackoverflow.com/users/7788442/elissa"}, "edited": false, "score": 0, "creation_date": 1490826648, "post_id": 43105199, "comment_id": 73292018, "body": "I&#39;m using Excel 2010 and it&#39;s not recognizing the TEXTJOIN formula.  But looks like that is exactly what I want to do.  Any similar formula for my version of excel?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1490827048, "post_id": 43105199, "comment_id": 73292141, "body": "That would depend on how many <b>actual</b> columns you want to examine. Seven columns is not out of scope for even seven nested IF conditions but there are shorter formulas."}, {"owner": {"reputation": 49, "user_id": 7788442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bac8e7018dfae78c4c2d346d755e332?s=128&d=identicon&r=PG&f=1", "display_name": "Elissa", "link": "https://stackoverflow.com/users/7788442/elissa"}, "edited": false, "score": 0, "creation_date": 1490827192, "post_id": 43105199, "comment_id": 73292186, "body": "There are 10 columns"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 7, "last_activity_date": 1490828042, "last_edit_date": 1490828042, "creation_date": 1490825936, "answer_id": 43105199, "question_id": 43104790, "link": "https://stackoverflow.com/questions/43104790/concatenate-column-headers-if-value-in-rows-below-is-non-blank/43105199#43105199", "title": "Concatenate column headers if value in rows below is non-blank", "body": "<p>Use\u00b9 the following as an <strong>array formula</strong>.</p>\n\n<pre><code>=TEXTJOIN(\"--&gt;\", TRUE, IF(LEN(C3:I3), C$2:I$2, \"\"))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/rBOq8.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/rBOq8.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Pre-Excel 2016 versions</strong></p>\n\n<p>While you could just string together a series of IF statements, a cleaner alternate might be to write a user defined function (aka UDF).</p>\n\n<p>In a standard VBA module code sheet:</p>\n\n<pre><code>Function udf_Stitch_Together(r As Range, _\n                             h As Range, _\n                             Optional d As String = \"--&gt;\", _\n                             Optional blnks As Boolean = False) As String\n    Dim s As String, c As Long\n    For c = 1 To r.Cells.Count\n        If CBool(Len(r.Cells(c).Text)) Then _\n            s = s &amp; IIf(Len(s), d, vbNullString) &amp; h.Cells(c).Text\n    Next c\n    udf_Stitch_Together = s\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/CVojb.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/CVojb.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>\u00b9 <sub>The <a href=\"https://support.office.com/en-us/article/TEXTJOIN-function-357b449a-ec91-49d0-80c3-0e8fc845691c\" rel=\"noreferrer\">TEXTJOIN</a> was introduced with Excel 2016 in the following versions:<em>Excel for Android phones, Excel Mobile, Excel 2016 with Office 365, Excel 2016 for Mac, Excel Online, Excel for iPad, Excel for iPhone and Excel for Android tablet.</em></sub></p>\n"}], "owner": {"reputation": 49, "user_id": 7788442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bac8e7018dfae78c4c2d346d755e332?s=128&d=identicon&r=PG&f=1", "display_name": "Elissa", "link": "https://stackoverflow.com/users/7788442/elissa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3908, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1491324858, "creation_date": 1490824216, "last_edit_date": 1490828312, "question_id": 43104790, "link": "https://stackoverflow.com/questions/43104790/concatenate-column-headers-if-value-in-rows-below-is-non-blank", "title": "Concatenate column headers if value in rows below is non-blank", "body": "<p>I have table with data in the format below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zD6km.jpg\" rel=\"nofollow noreferrer\">Data</a><br/>\n<a href=\"https://i.stack.imgur.com/zD6km.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zD6km.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I want the finished table to have the blank column to be populated like the highlighted one below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JHun2.jpg\" rel=\"nofollow noreferrer\">Finished Table</a><br/>\n<a href=\"https://i.stack.imgur.com/JHun2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JHun2.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So, I need a formula or VBA that will return and concatenate the headers of non-blank cells in each row.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 0, "creation_date": 1490823553, "post_id": 43104587, "comment_id": 73290846, "body": "Would you be interested in a non-VBA worksheet formula solution?"}, {"owner": {"reputation": 1873, "user_id": 3893729, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/dae6e19fc9f20b5452627fa2fe22d6fc?s=128&d=identicon&r=PG&f=1", "display_name": "MFR", "link": "https://stackoverflow.com/users/3893729/mfr"}, "reply_to_user": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 0, "creation_date": 1490823608, "post_id": 43104587, "comment_id": 73290867, "body": "Yes, it is even more appreciated."}, {"owner": {"reputation": 1873, "user_id": 3893729, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/dae6e19fc9f20b5452627fa2fe22d6fc?s=128&d=identicon&r=PG&f=1", "display_name": "MFR", "link": "https://stackoverflow.com/users/3893729/mfr"}, "reply_to_user": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 0, "creation_date": 1490824332, "post_id": 43104587, "comment_id": 73291158, "body": "Thank you Adam for pointing this out. My bad. The image is updated."}], "answers": [{"comments": [{"owner": {"reputation": 1873, "user_id": 3893729, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/dae6e19fc9f20b5452627fa2fe22d6fc?s=128&d=identicon&r=PG&f=1", "display_name": "MFR", "link": "https://stackoverflow.com/users/3893729/mfr"}, "edited": false, "score": 0, "creation_date": 1490825267, "post_id": 43105002, "comment_id": 73291501, "body": "Thanks Scott, seems a wise idea. However, it doesn&#39;t work for cell with two name. For instance, it doesn&#39;t replace cell with this value &quot;city name&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1873, "user_id": 3893729, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/dae6e19fc9f20b5452627fa2fe22d6fc?s=128&d=identicon&r=PG&f=1", "display_name": "MFR", "link": "https://stackoverflow.com/users/3893729/mfr"}, "edited": false, "score": 0, "creation_date": 1490833034, "post_id": 43105002, "comment_id": 73293927, "body": "@MFR see inputs and outputs.  Sheet2 is what happens when I ran the code above."}, {"owner": {"reputation": 1873, "user_id": 3893729, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/dae6e19fc9f20b5452627fa2fe22d6fc?s=128&d=identicon&r=PG&f=1", "display_name": "MFR", "link": "https://stackoverflow.com/users/3893729/mfr"}, "edited": false, "score": 0, "creation_date": 1490833426, "post_id": 43105002, "comment_id": 73294028, "body": "thank you, I tried a few times and it didn&#39;t give me the correct results for some cells. Not sure what I&#39;m missing. I&#39;ll come back shortly and will try again to find out the issue. I have <code>A</code> correctly but the second row is <code>City Name</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1490832974, "last_edit_date": 1490832974, "creation_date": 1490825100, "answer_id": 43105002, "question_id": 43104587, "link": "https://stackoverflow.com/questions/43104587/copy-a-template-each-time-and-replace-using-excel-macro/43105002#43105002", "title": "Copy a Template each time and replace using Excel Macro", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim rng1() As Variant, rng2 As Range, rng3() As Variant,k&amp;\nWith Worksheets(\"Sheet1\")\n    rng1 = .Range(.Cells(1, 1), .Cells(.Rows.Count, 2).End(xlUp)).Value\nEnd With\nWith Worksheets(\"Sheet3\")\n    rng3 = .Range(.Cells(1, 1), .Cells(.Rows.Count, 2).End(xlUp)).Value\nEnd With\nWith Worksheets(\"Sheet2\")\n    For k = LBound(rng1, 1) To UBound(rng1, 1)\n        Set rng2 = .Range(\"A1\").Offset(UBound(rng3, 1) * (k - 1)).Resize(UBound(rng3, 1), UBound(rng3, 2))\n        With rng2\n            .Value = rng3\n            .Replace \"City\", rng1(k, 2)\n            .Replace \"Name\", rng1(k, 1)\n        End With\n    Next k\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Inputs:</p>\n\n<p>Sheet1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/D2gS4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D2gS4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet3:</p>\n\n<p><a href=\"https://i.stack.imgur.com/d70Ig.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d70Ig.png\" alt=\"enter image description here\"></a></p>\n\n<p>Output:</p>\n\n<p>Sheet2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aaugu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aaugu.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 1873, "user_id": 3893729, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/dae6e19fc9f20b5452627fa2fe22d6fc?s=128&d=identicon&r=PG&f=1", "display_name": "MFR", "link": "https://stackoverflow.com/users/3893729/mfr"}, "edited": false, "score": 0, "creation_date": 1490833554, "post_id": 43105336, "comment_id": 73294057, "body": "Thank you Adam it was very wise solution. However, is difficult if I want to reproduce for a larger dataset with a slight difference in the patterns."}], "tags": [], "owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "is_accepted": true, "score": 2, "last_activity_date": 1490829384, "last_edit_date": 1490829384, "creation_date": 1490826595, "answer_id": 43105336, "question_id": 43104587, "link": "https://stackoverflow.com/questions/43104587/copy-a-template-each-time-and-replace-using-excel-macro/43105336#43105336", "title": "Copy a Template each time and replace using Excel Macro", "body": "<p>This isn't what you asked for, but you can accomplish this entirely with cell formulas.  It is a little complicated, and VBA is probably a better approach, but in case you're curious:</p>\n\n<p>I am assuming your Name/City pairs are in <code>Sheet1!$A$1:$B$9</code> <em>**</em> </p>\n\n<p><a href=\"https://i.stack.imgur.com/8RaWJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8RaWJ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>On sheet 2, in column A, I will build a list that indicates which row to grab data from. (1,1,1,2,2,2,3,3,3,4,4,4, etc)</p>\n\n<p>On sheet 2, column B, I will build a list that shows which type of result this destination row should have (Name - City Name is <code>1</code>, Name City - City is <code>2</code>, and Name - City is <code>3</code>) There are various ways of doing this.  I filled Column A with <code>=INT((ROW()-1)/3)+1</code> and column B with <code>=MOD(ROW()-1,3)+1</code></p>\n\n<p>Now my first two columns on Sheet 2 look like</p>\n\n<p><a href=\"https://i.stack.imgur.com/zPLqr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zPLqr.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Now I can use those to build indexed lookups against the original data.  Column C will have 2 different types of behavior.  It always starts with the Name, but if Column B is 2, it is followed by the City.</p>\n\n<p><code>=INDEX(Sheet1!$A$1:$B$9,S A1,1)&amp;IF(B1=2,\" \" &amp; INDEX(Sheet1!$A$1:$B$9, A1,2),\"\")</code></p>\n\n<p>Column D will also have two types of entries.  Always start with the City, but if Column B is <code>1</code>, follow with the name. </p>\n\n<p><code>=INDEX(Sheet1!$A$1:$B$9,A1,2)&amp;IF(B1=1,\" \" &amp; INDEX(Sheet1!$A$1:$B$9,A1,1),\"\")</code></p>\n\n<p>Voila</p>\n\n<p><a href=\"https://i.stack.imgur.com/35nR6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/35nR6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If you wanted to, you could replace all of the references to Columns A &amp; B with the actual formulas that are in them. </p>\n\n<p>Then Column C would have: </p>\n\n<pre><code>=INDEX(Sheet1!$A$1:$B$9,INT((ROW()-1)/3)+1,1)&amp;\" \"&amp;IF(MOD(ROW()-1,3)+1=2,INDEX(Sheet1!$A$1:$B$9,INT((ROW()-1)/3)+1,2),\"\")\n</code></pre>\n\n<p>Make the corresponding substitutions in Column D and you can leave out Columns A&amp;B. </p>\n\n<p><a href=\"https://i.stack.imgur.com/j2UOX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j2UOX.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>One small inconvenience with this approach is that because it relies on <code>row()</code>, it can't be moved to any other row without adjusting the two index formulas ( <code>INT((ROW()-1)/3)+1</code> &amp;<code>MOD(ROW()-1,3)+1</code>)</p>\n\n<hr>\n\n<p><em>**</em> In the real world, I would also give your source data table a name, like <code>NameCityTable</code>  Then your first result column could look like:</p>\n\n<pre><code>=INDEX(NameCityTable,INT((ROW()-1)/3)+1,1)&amp;\" \"&amp;IF(MOD(ROW()-1,3)+1=2,INDEX(NameCityTable,INT((ROW()-1)/3)+1,2),\"\")\n</code></pre>\n"}], "owner": {"reputation": 1873, "user_id": 3893729, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/dae6e19fc9f20b5452627fa2fe22d6fc?s=128&d=identicon&r=PG&f=1", "display_name": "MFR", "link": "https://stackoverflow.com/users/3893729/mfr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 43105336, "answer_count": 2, "score": 2, "last_activity_date": 1490832974, "creation_date": 1490823422, "last_edit_date": 1490826830, "question_id": 43104587, "link": "https://stackoverflow.com/questions/43104587/copy-a-template-each-time-and-replace-using-excel-macro", "title": "Copy a Template each time and replace using Excel Macro", "body": "<p>I have the following data set in my <code>sheet 1</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/LfQqQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LfQqQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>And this template in <code>sheet 3</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/hY5Ql.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hY5Ql.png\" alt=\"enter image description here\"></a></p>\n\n<p>I wish to </p>\n\n<ol>\n<li>Copy the template from <code>sheet 3</code> to <code>sheet2</code></li>\n<li>Read the city and name from row 1 in <code>sheet1</code> </li>\n<li>Replace the <code>City</code> and <code>Name</code> in sheet 2</li>\n<li>Repeat it for every row in <code>sheet 1</code></li>\n</ol>\n\n<p>So my ideal output will be:</p>\n\n<p><a href=\"https://i.stack.imgur.com/f8WcK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f8WcK.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see because we have three rows in sheet 1 the template is copied three times. </p>\n\n<p>I tried this code, but it doesn't go to loop for 'sheet1' </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nApplication.ScreenUpdating = False\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\nDim ii As Long\n\nSet copySheet = Worksheets(\"Sheet3\")\nSet pasteSheet = Worksheets(\"Sheet2\")\n\nFor ii = 1 To 10\n copySheet.Range(\"A1:E3\").Copy\n pasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n Application.CutCopyMode = False\n Application.ScreenUpdating = True\n\n\nDim j, k, L, b As String\n   Dim i As Long\n   Dim wb As Workbook\n   Dim sht1 As Worksheet\n   Dim sht2 As Worksheet\n\n  Set wb = ThisWorkbook\n  Set sht1 = wb.Sheets(\"Sheet1\")\n  Set sht2 = wb.Sheets(\"Sheet2\")\n\n   j = \"Name\"\n   b = \"City\"\n\n   For i = 1 To 3\n\n    k = sht1.Range(\"A\" &amp; i)\n    L = sht1.Range(\"B\" &amp; i)\n\n    sht2.Cells.Replace what:=j, replacement:=k, lookat:=xlWhole, MatchCase:=False\n    sht2.Cells.Replace what:=b, replacement:=L, lookat:=xlWhole, MatchCase:=False\n\n   Next i\n\nNext ii\n\n End Sub\n</code></pre>\n\n<p>Any guidance is really appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 0, "creation_date": 1490823182, "post_id": 43104182, "comment_id": 73290691, "body": "?  The only difference I see between Picture2 and Picture3 is the spacing of the words &quot;Chicken Italia&quot; in Column A, but they don&#39;t appear at all on the sheet you say you are copying from.  Can you clarify what it is you are copying?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1490829861, "post_id": 43104182, "comment_id": 73292991, "body": "It would help us correct your code if we could actually see it.  Please paste it into the question."}, {"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490954632, "post_id": 43104182, "comment_id": 73352689, "body": "It s like pic2 I try to make. But my result ends like pic3. 1 recipe name and several produce. So the 2nd recipe must be at the last row of produce list. I managed to get the space. Bu would like underline where a recipes ends. I ve tried with column end but no succes"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490822952, "post_id": 43104434, "comment_id": 73290583, "body": "oow no pictures."}, {"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490823110, "post_id": 43104434, "comment_id": 73290656, "body": "let me try like this. In column A i have the recipe name. From column B i have multiple rows of data. the ingredients. The second recipe, The recipe name should be below the several ingredients."}], "tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": false, "score": 1, "last_activity_date": 1490822739, "creation_date": 1490822739, "answer_id": 43104434, "question_id": 43104182, "link": "https://stackoverflow.com/questions/43104182/copy-paste-excel-vba/43104434#43104434", "title": "copy paste excel vba", "body": "<p>I can't see the pictures unfortunately, so I'm not sure how on the mark I am.</p>\n\n<p>In general, you want to start something like this:</p>\n\n<pre><code>Sheets(\"Sheet 7\").Activate\nRange(\"A1:N8\").Copy\nSheets(\"Sheet 9\").Activate\nRange(\"A1\").Paste\n</code></pre>\n\n<p>To select your data, and move it over. Now let's get a bit fancy.</p>\n\n<pre><code>Dim I as long\nDim J as long\nDum K as long\nDim L as long\n\nDim O as long\nDim P as long\nI = WorkSheetFunction.Vlookup(you know how a vlookup works)\nJ = WorksheetFunction.Sum(You really should know this one)\n.....\nP = 7\nSheets(\"Sheet 7\").Activate\nRange(I&amp;J:O&amp;P).Copy\nSheets(\"Sheet 9\").Activate\nRange(K&amp;L).Paste\n</code></pre>\n\n<p>Where you can specify the starting and ending corner of your copy range, and the starting cell of your pasting range. Use macro recorder to find out exactly how a paste values, or other type of fancy paste works. </p>\n"}, {"comments": [{"owner": {"reputation": 182, "user_id": 5966084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/--z05xOgneCU/AAAAAAAAAAI/AAAAAAAALjo/bFnR_9eJ-rY/photo.jpg?sz=128", "display_name": "Aly Abdelaziz", "link": "https://stackoverflow.com/users/5966084/aly-abdelaziz"}, "edited": false, "score": 1, "creation_date": 1490830432, "post_id": 43105943, "comment_id": 73293175, "body": "You are better off including this in your original question."}], "tags": [], "owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "is_accepted": false, "score": 1, "last_activity_date": 1490840630, "last_edit_date": 1490840630, "creation_date": 1490830185, "answer_id": 43105943, "question_id": 43104182, "link": "https://stackoverflow.com/questions/43104182/copy-paste-excel-vba/43105943#43105943", "title": "copy paste excel vba", "body": "<p>this is the code i have for so far</p>\n\n<pre><code>Sub Test1()\nDim lrow As Long\nDim scr1 As Range 'source range\nDim scr2 As Range\nDim drng As Range 'destination range\nDim drng2 As Range\nApplication.ScreenUpdating = False\n\nSheet7.Activate\nSet drng = Sheet9.Range(\"A3\")\nSet drng2 = Sheet9.Range(\"D3\")\n\nSet scr1 = Sheet7.Range(\"RecipeHeader\")\nscr1.Select\nSelection.Copy\nSheet9.Activate\ndrng.End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nSheet7.Activate\nSet scr2 = Sheet7.Range(\"FoodCost_full\")\nscr2.Select\nSelection.Copy\nSheet9.Activate\ndrng2.End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nSheet7.Range(\"ClearHeader\").ClearContents\nSheet7.Range(\"Clearfood\").ClearContents\n\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = False\n\n\n'lrow = Range(\"F\" &amp; Rows.Count).End(xlUp).Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3653, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1490840630, "creation_date": 1490821642, "last_edit_date": 1490829776, "question_id": 43104182, "link": "https://stackoverflow.com/questions/43104182/copy-paste-excel-vba", "title": "copy paste excel vba", "body": "<p>I have those sheets.\nThe second sheet is how I would it to be.\nI am now trying for hours how I would do this.\nPlease can anyone help me on the right track.</p>\n\n<p>I am copying from sheet 7(pic1) to sheet 9(pic2).\nThe lastrow to look for should be range F.</p>\n\n<p>But I always end up like in pic3.</p>\n\n<p><a href=\"https://i.stack.imgur.com/VkP9P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VkP9P.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/4n0Gp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4n0Gp.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Fa1pf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fa1pf.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7788237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5eb246b9a0bc9e4bd018c4fcdd63192?s=128&d=identicon&r=PG&f=1", "display_name": "Derrick", "link": "https://stackoverflow.com/users/7788237/derrick"}, "edited": false, "score": 0, "creation_date": 1490821886, "post_id": 43104001, "comment_id": 73290034, "body": "I made the changes you suggested @ScottHoltzman. However, now my I18 value is always cleared, regardless of Case value. Suggestions?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490822148, "post_id": 43104001, "comment_id": 73290175, "body": "<i>(+1)</i> I like especially your approach with <code>Case ... sellect</code>. Normally, I&#39;d check with <code>If Target.Value &gt;= 6 and Target.Value &lt;= 10 Then</code>. But this does not take into consideration the possibility that <code>Target.Value</code> could be a string or <code>Empty</code> or an error value. With <code>Case .... Select</code> you don&#39;t care and don&#39;t have to make sure that <code>Target.Value</code> actually <code>IsNumeric()</code> before the <code>If</code> I normally use. Much cleaner, easier and more direct this way."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 11, "user_id": 7788237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5eb246b9a0bc9e4bd018c4fcdd63192?s=128&d=identicon&r=PG&f=1", "display_name": "Derrick", "link": "https://stackoverflow.com/users/7788237/derrick"}, "edited": false, "score": 0, "creation_date": 1490880929, "post_id": 43104001, "comment_id": 73318153, "body": "@Derrick - did you step through the code line-by-line to test the behavoir versus that expected?"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1490821275, "last_edit_date": 1490821275, "creation_date": 1490820892, "answer_id": 43104001, "question_id": 43103859, "link": "https://stackoverflow.com/questions/43103859/clearing-a-cell-based-on-a-dependent-drop-down-box-in-vba/43104001#43104001", "title": "Clearing a cell based on a dependent drop down box in VBA", "body": "<p>A few issues. See notes in refactored code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n'On Error Resume Next -&gt;&gt; delete this, it will not allow you to see real errors in your code\n\nIf Target.Address = \"$I$8\" Then\n\n    'you ask it define Target.Address = 6, etc. Wrong property. You need Target.Value (\n    'think about it, you just checked for Address = $I$8, so how can it also be 6 - 10\n    'also if you do want to use IF, syntax is Target.Value = 6 or Target.Value = 7 ... not 6 or 7 or ...\n\n    Select Case Target.value 'used this as it more efficient\n\n          Case 6 to 10\n\n             If Target.Validation.Type = 3 Then\n                 Application.EnableEvents = False\n                 Target.Offset(10, 0).ClearContents\n             End If\n\n    End Select\n\nEnd If\n\nexitHandler:\nApplication.EnableEvents = True\nExit Sub\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7788237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5eb246b9a0bc9e4bd018c4fcdd63192?s=128&d=identicon&r=PG&f=1", "display_name": "Derrick", "link": "https://stackoverflow.com/users/7788237/derrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490821275, "creation_date": 1490820467, "question_id": 43103859, "link": "https://stackoverflow.com/questions/43103859/clearing-a-cell-based-on-a-dependent-drop-down-box-in-vba", "title": "Clearing a cell based on a dependent drop down box in VBA", "body": "<p>I have a drop down box in I8, and I have a dependent drop down box in I18 that is directing to I8. If perhaps apple1 is chosen in I8, I will get fruits 1-10 listed in I18 when I click on that box. Say I chose Fruit 9 for the box in I18. Well, the problem is that say I decide to change my I8 answer to apple2, Fruits 1-5 will appear in I18 but 6-10 will not. Now in I18, Fruit 9 is still chosen, and I will have to click to change it. </p>\n\n<p>I want to make it to where if I have chosen Fruits 6-10 while apple1 is chosen, and I decide to change it to apple2, my I18 will go blank.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error Resume Next\nIf Target.Address = \"$I$8\" Then\n    If Target.Address = \"6\" Or \"7\" Or \"8\" Or \"9\" Or \"10\" Then\n    If Target.Validation.Type = 3 Then\n    Application.EnableEvents = False\n    Target.Offset(10, 0).ClearContents\n    End If\n    End If\nEnd If\n\nexitHandler:\nApplication.EnableEvents = True\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "owner": {"reputation": 587, "user_id": 7782626, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/117df6c0c6be63273f424ad2a28f0d64?s=128&d=identicon&r=PG&f=1", "display_name": "Arman", "link": "https://stackoverflow.com/users/7782626/arman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 609, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1593678819, "creation_date": 1490819473, "last_edit_date": 1593678819, "question_id": 43103581, "link": "https://stackoverflow.com/questions/43103581/how-to-send-email-of-the-excel-worksheet-from-excel-for-mac", "title": "How to send email of the Excel worksheet from Excel for Mac", "body": "<p>I want to send out automatic email from excel at a specific time in the day daily with the worksheet as message in the email body. I'm using Excel for Mac, but I'm unable to find Send Email to Recipient option in this. Neither are the following vba scripts working:</p>\n\n<pre><code>Function MailFromMacwithOutlook(bodycontent As String, mailsubject As String, _\n            toaddress As String, ccaddress As String, bccaddress As String, _\n            attachment As String, displaymail As Boolean)\n\n\n\n    Dim scriptToRun As String\n\n    scriptToRun = scriptToRun &amp; \"tell application \" &amp; _\n                  Chr(34) &amp; \"Microsoft Outlook\" &amp; Chr(34) &amp; Chr(13)\n\n    scriptToRun = scriptToRun &amp; _\n     \"set NewMail to make new outgoing message with properties\" &amp; _\n       \"{content:\"\"\" &amp; bodycontent &amp; \"\"\", subject:\"\"\" &amp; mailsubject &amp; \"\"\"}\" &amp; Chr(13)\n\n    If toaddress &lt;&gt; \"\" Then scriptToRun = scriptToRun &amp; _\n       \"make new to recipient at NewMail with properties\" &amp; _\n       \"{email address:{address:\"\"\" &amp; toaddress &amp; \"\"\"}}\" &amp; Chr(13)\n\n    If ccaddress &lt;&gt; \"\" Then scriptToRun = scriptToRun &amp; _\n       \"make new cc recipient at NewMail with properties\" &amp; _\n       \"{email address:{address:\"\"\" &amp; ccaddress &amp; \"\"\"}}\" &amp; Chr(13)\n\n    If bccaddress &lt;&gt; \"\" Then scriptToRun = scriptToRun &amp; _\n       \"make new bcc recipient at NewMail with properties\" &amp; _\n       \"{email address:{address:\"\"\" &amp; bccaddress &amp; \"\"\"}}\" &amp; Chr(13)\n\n    If attachment &lt;&gt; \"\" Then\n     scriptToRun = scriptToRun &amp; \"make new attachment at NewMail with properties\" &amp; _\n              \"{file:\"\"\" &amp; attachment &amp; \"\"\" as alias}\" &amp; Chr(13)\n    End If\n\n    If displaymail = False Then\n        scriptToRun = scriptToRun &amp; \"send NewMail\" &amp; Chr(13)\n    Else\n        scriptToRun = scriptToRun &amp; \"open NewMail\" &amp; Chr(13)\n    End If\n    scriptToRun = scriptToRun &amp; \"end tell\" &amp; Chr(13)\n\n    If Len(toaddress) + Len(ccaddress) + Len(bccaddress) = 0 Or mailsubject = \"\" Then\n        MsgBox \"There is no To, CC or BCC address or Subject for this mail\"\n        Exit Function\n    Else\n        On Error Resume Next\n        MacScript (scriptToRun)\n        On Error GoTo 0\n    End If\nEnd Function\n\nFunction MailFromMacWithMail(bodycontent As String, mailsubject As String, _\n           toaddress As String, ccaddress As String, bccaddress As String, _\n                attachment As String, displaymail As Boolean)\n\n\n\n    Dim scriptToRun As String\n\n    scriptToRun = scriptToRun &amp; \"tell application \" &amp; _\n                  Chr(34) &amp; \"Mail\" &amp; Chr(34) &amp; Chr(13)\n\n    scriptToRun = scriptToRun &amp; _\n         \"set NewMail to make new outgoing message with properties \" &amp; _\n            \"{content:\"\"\" &amp; bodycontent &amp; \"\"\", subject:\"\"\" &amp; _\n               mailsubject &amp; \"\"\" , visible:true}\" &amp; Chr(13)\n\n    scriptToRun = scriptToRun &amp; \"tell NewMail\" &amp; Chr(13)\n\n    If toaddress &lt;&gt; \"\" Then scriptToRun = scriptToRun &amp; _\n       \"make new to recipient at end of to recipients with properties \" &amp; _\n       \"{address:\"\"\" &amp; toaddress &amp; \"\"\"}\" &amp; Chr(13)\n\n    If ccaddress &lt;&gt; \"\" Then scriptToRun = scriptToRun &amp; _\n       \"make new cc recipient at end of cc recipients with properties \" &amp; _\n       \"{address:\"\"\" &amp; ccaddress &amp; \"\"\"}\" &amp; Chr(13)\n\n    If bccaddress &lt;&gt; \"\" Then scriptToRun = scriptToRun &amp; _\n       \"make new bcc recipient at end of bcc recipients with properties \" &amp; _\n       \"{address:\"\"\" &amp; bccaddress &amp; \"\"\"}\" &amp; Chr(13)\n\n    If attachment &lt;&gt; \"\" Then\n        scriptToRun = scriptToRun &amp; \"tell content\" &amp; Chr(13)\n        scriptToRun = scriptToRun &amp; \"make new attachment with properties \" &amp; _\n                      \"{file name:\"\"\" &amp; attachment &amp; \"\"\" as alias} \" &amp; _\n                      \"at after the last paragraph\" &amp; Chr(13)\n        scriptToRun = scriptToRun &amp; \"end tell\" &amp; Chr(13)\n    End If\n\n    If displaymail = False Then scriptToRun = scriptToRun &amp; \"send\" &amp; Chr(13)\n    scriptToRun = scriptToRun &amp; \"end tell\" &amp; Chr(13)\n    scriptToRun = scriptToRun &amp; \"end tell\"\n\n    If Len(toaddress) + Len(ccaddress) + Len(bccaddress) = 0 Or mailsubject = \"\" Then\n        MsgBox \"There is no To, CC or BCC address or Subject for this mail\"\n        Exit Function\n    Else\n        On Error Resume Next\n        MacScript (scriptToRun)\n        On Error GoTo 0\n    End If\nEnd Function\n\nFunction KillFileOnMac(Filestr As String)\n\n\n'The VBA Kill command on a Mac will not work with long file names(28+ characters)\n    Dim ScriptToKillFile As String\n    ScriptToKillFile = ScriptToKillFile &amp; \"tell application \" &amp; Chr(34) &amp; _\n                       \"Finder\" &amp; Chr(34) &amp; Chr(13)\n    ScriptToKillFile = ScriptToKillFile &amp; _\n                       \"do shell script \"\"rm \"\" &amp; quoted form of posix path of \" &amp; _\n                       Chr(34) &amp; Filestr &amp; Chr(34) &amp; Chr(13)\n    ScriptToKillFile = ScriptToKillFile &amp; \"end tell\"\n\n    On Error Resume Next\n    MacScript (ScriptToKillFile)\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>And this:</p>\n\n<pre><code>Sub Mail_workbook_Excel2011_1()\n'For Excel 2011 for the Mac and Apple Mail\n'Note: The workbook must be saved once\n    Dim wb As Workbook\n\n    If Val(Application.Version) &lt; 14 Then Exit Sub\n\n    Set wb = ActiveWorkbook\n    With wb\n        MailFromMacwithOutlook bodycontent:=\"Hi there\", _\n                    mailsubject:=\"Testing\", _\n                    toaddress:=\"something@something.com\", _\n                    ccaddress:=\"\", _\n                    bccaddress:=\"\", _\n                    attachment:=.FullName, _\n                    displaymail:=True\n    End With\n    Set wb = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Could anyone help me with how this can be done in Excel for mac?</p>\n"}, {"tags": ["vba", "excel", "sorting", "copy"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1490819324, "post_id": 43103470, "comment_id": 73288642, "body": "You need to qualify your references to <code>Range</code>, etc, to refer to which worksheet you want to use."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 7601046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51e6db7da3eb0a1989ca7485c0df442b?s=128&d=identicon&r=PG&f=1", "display_name": "Danilo Imbimbo", "link": "https://stackoverflow.com/users/7601046/danilo-imbimbo"}, "edited": false, "score": 0, "creation_date": 1490819991, "post_id": 43103593, "comment_id": 73289023, "body": "didn&#39;t work. the code stops in worksheets(I).Range(&quot;CW269:CX294&quot;).Copy, error 438 &quot;object doesn&#39;t support this property or method"}], "tags": [], "owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "is_accepted": true, "score": 8, "last_activity_date": 1490820295, "last_edit_date": 1490820295, "creation_date": 1490819524, "answer_id": 43103593, "question_id": 43103470, "link": "https://stackoverflow.com/questions/43103470/sorting-all-worksheets-in-the-workbook/43103593#43103593", "title": "Sorting all worksheets in the workbook", "body": "<p>You never tell the code to go to the next worksheet. Also, your selections don't look necessary. </p>\n\n<pre><code> Sub copy_paste_sort()\n\nDim oneRange As Range\nDim aCell As Range\nDim WS_Count As Integer\nDim I As Integer\n\n         ' Set WS_Count equal to the number of worksheets in the active\n         ' workbook.\nWS_Count = ActiveWorkbook.Worksheets.Count\n\n         ' Begin the loop.\n    For I = 1 To WS_Count\n\nSet oneRange = worksheets(I).Range(\"CZ269:DA294\")\nSet aCell = worksheets(I).Range(\"DA269\")\n\nworksheets(I).Range(\"CW269:CX294\").Copy  worksheets(I).Range(\"CZ269:DA294\")\n\noneRange.Sort Key1:=aCell, Order1:=xlDescending, Header:=xlNo\n\n\n    Next I\n\nEnd Sub\n</code></pre>\n\n<p>Also  - Since you are sorting the range, I am guessing that it containsvalues, rather than formulas.  If that is the case, you can replace </p>\n\n<p><code>worksheets(I).Range(\"CW269:CX294\").Copy  worksheets(I).Range(\"CZ269:DA294\")</code></p>\n\n<p>with</p>\n\n<p><code>worksheets(I).Range(\"CZ269:DA294\").Value = worksheets(I).Range(\"CW269:CX294\").Value</code></p>\n\n<p>The advantage of this is that it is slightly faster, and doesn't use your clipboard.  </p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1490819978, "last_edit_date": 1490819978, "creation_date": 1490819712, "answer_id": 43103647, "question_id": 43103470, "link": "https://stackoverflow.com/questions/43103470/sorting-all-worksheets-in-the-workbook/43103647#43103647", "title": "Sorting all worksheets in the workbook", "body": "<p>Try it as,</p>\n\n<pre><code>Sub copy_paste_sort()\n\n    Dim I As Long\n\n    ' Begin the loop.\n    For I = 1 To ActiveWorkbook.Worksheets.Count\n        With Worksheets(I)\n\n            With .Range(\"CW269:CX294\")\n                .Copy destination:=.Range(\"CZ269\")\n                .Offset(0, 3).Cells.Sort Key1:=aCell, Order1:=xlDescending, Header:=xlNo\n            End With\n        End With\n    Next I\n\n\nEnd Sub\n</code></pre>\n\n<p>You were looping through <code>I</code> as the index number of the workshjeets but not doing anything with it. The <code>With Worksheets(I) ... End With</code> references eac h worksheet in turn. Note that <code>Range(...)</code> becomes <code>.Range(...)</code> so that it knows what worksheet is its parent.</p>\n"}], "owner": {"reputation": 195, "user_id": 7601046, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51e6db7da3eb0a1989ca7485c0df442b?s=128&d=identicon&r=PG&f=1", "display_name": "Danilo Imbimbo", "link": "https://stackoverflow.com/users/7601046/danilo-imbimbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 43103593, "answer_count": 2, "score": 3, "last_activity_date": 1490820295, "creation_date": 1490819124, "last_edit_date": 1490820129, "question_id": 43103470, "link": "https://stackoverflow.com/questions/43103470/sorting-all-worksheets-in-the-workbook", "title": "Sorting all worksheets in the workbook", "body": "<p>I have this code that actually do exactly what I want to:</p>\n\n<p>goes to the specific range, copy the table in a new range and reorder the table.</p>\n\n<p>Here is the code:</p>\n\n<pre><code> Sub copy_paste_sort()\n\nDim oneRange As Range\nDim aCell As Range\nDim WS_Count As Integer\nDim I As Integer\n\n         ' Set WS_Count equal to the number of worksheets in the active\n         ' workbook.\nWS_Count = ActiveWorkbook.Worksheets.Count\n\n         ' Begin the loop.\n    For I = 1 To WS_Count\n\nSet oneRange = Range(\"CZ269:DA294\")\nSet aCell = Range(\"DA269\")\n\nRange(\"CW269:CX294\").Select\nSelection.Copy\n\nRange(\"CZ269:DA294\").Select\nActiveSheet.Paste\n\noneRange.Sort Key1:=aCell, Order1:=xlDescending, Header:=xlNo\n\n\n    Next I\n\nEnd Sub\n</code></pre>\n\n<p>The problem is: the code is not working in all worksheets, it is repeating n times in the first worksheet.</p>\n"}, {"tags": ["vba", "numbers", "format", "concatenation", "long-integer"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490817758, "post_id": 43102933, "comment_id": 73287819, "body": "<i>&quot;adding &quot;&#39;&quot; before all the numbers will protect them from Excel auto changing them&quot;</i>. No, Excel does not &quot;Auto-Change&quot; anything if not <i>instructed</i> to do so, via some formula or some connection. Adding <code>&#39;</code> only forces the cell to be interpreted as a string"}, {"owner": {"reputation": 69, "user_id": 7681900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f262d5942a0cded58e75c4f9309afa63?s=128&d=identicon&r=PG&f=1", "display_name": "Scott H", "link": "https://stackoverflow.com/users/7681900/scott-h"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490819737, "post_id": 43102933, "comment_id": 73288882, "body": "I&#39;ve seen articles to the contrary when the number strings are in excess of some threshold.  Regardless if &quot;someone&quot; gets into the file will adding &quot; &#39; &quot; forcing the string interpretation prevent them from hitting any formatting changes that will cause the changing phenomenon?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1490823738, "post_id": 43102933, "comment_id": 73290917, "body": "Excel doesn&#39;t handle numbers beyond 15 digits. Anything beyond position 15 becomes a 0. Can&#39;t imagine there would be any issue caused by any particular digit. What happens when you run that code?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1490824254, "post_id": 43102933, "comment_id": 73291126, "body": "You should change the column E to <b>Text</b> format before getting the data from CSV as June7 points out 15 digit limit. Or may be whole worksheet to be Text format. e.g. <code>Columns(&quot;E&quot;).NumberFormat = &quot;@&quot;</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1490824427, "post_id": 43102933, "comment_id": 73291195, "body": "When bringing in data from a CSV where there might be issues with (eg) large numeric values which get truncated or lose precision or leading zeros, it&#39;s best to use the data &gt;&gt; from text function, which allows you to specify data types per-column <i>before</i> the data is populated on the sheet.  It&#39;s often too late to fix things after the data is on the worksheet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1490824539, "post_id": 43102933, "comment_id": 73291233, "body": "@A.S.H - yes we might say this behavior is &quot;as designed/expected&quot; but we should also keep in mind that the vast majority of Excel users do not expect it."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1490825391, "post_id": 43102933, "comment_id": 73291554, "body": "@TimWilliams you&#39;re right, I wasn&#39;t expecting OP was talking about such big numbers during the import phase."}, {"owner": {"reputation": 69, "user_id": 7681900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f262d5942a0cded58e75c4f9309afa63?s=128&d=identicon&r=PG&f=1", "display_name": "Scott H", "link": "https://stackoverflow.com/users/7681900/scott-h"}, "edited": false, "score": 0, "creation_date": 1490902564, "post_id": 43102933, "comment_id": 73332539, "body": "Thanks guys.  it seems that the macro I built to convert from CSV to XLSX circumnavigates the problem.  All workbooks converted don&#39;t display the problem.  It looks like just parsing as text seems to have solved it.  However on the first workbook, for posterity sake, adding ANY character before the number was the only way to make it stop.  altering Data type didn&#39;t have a permanent effect."}], "owner": {"reputation": 69, "user_id": 7681900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f262d5942a0cded58e75c4f9309afa63?s=128&d=identicon&r=PG&f=1", "display_name": "Scott H", "link": "https://stackoverflow.com/users/7681900/scott-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490817239, "creation_date": 1490817239, "question_id": 43102933, "link": "https://stackoverflow.com/questions/43102933/need-to-add-before-number-string", "title": "Need to add &quot; &#39; &quot; before number string", "body": "<p>I'm trying to select a column of numbers and append\"'\" to the front of them.  The reason is that the number strings are large and for some reason in similar files the numbers start changing on their own.  Particularly \"0\", \"4\" and \"7\".  Now I'm getting the data right from a CSV and when reformatting and parsing the data it SEEMS to be ok and not showing that issue BUT my understanding is that adding \"'\" before all the numbers will protect them from Excel auto changing them. What I'm trying to do is create a columns beside it that appends the values then delete the original column.  This works BUT creates the problem of changing the numbers to scientific and doesn't let me fix them.   All I'm trying to do is make it so the numbers cant get reformatted and start changing on their own.  So I'm open to all solutions.  The one below was an attempt to concatenate \"'\" to the front of the string.  IE \"=\"'\"&amp;F2\"</p>\n\n<p>SO I have the following:</p>\n\n<pre><code> Stop\n Columns(\"F\").Select\n Selection.Insert Shift:=xlToRight\n    For Each cel In Range(\"E:E\" &amp; lastRow)\n         If cel &lt;&gt; \"\" Then cel.Offset(0, 1).Value = \"'\" &amp; cel\n        On Error Resume Next\n    Next cel\n</code></pre>\n\n<p>Where am I going wrong?</p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490816068, "post_id": 43102456, "comment_id": 73286889, "body": "In your update string, try removing the <code>ICN = &quot; &amp; Me.txtICN</code> part, as there&#39;s no need to update that field (since you&#39;ve selected that record already).   That&#39;s just a guess."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1490816169, "post_id": 43102456, "comment_id": 73286954, "body": "You have two potential issues. One is whether any of your fields are either set up as unique (in which case you have to make sure your new record is indeed unique for these fields) and the other is that you are not protecting your SQL code from special characters like <code>&#39; (single quotes)</code>."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1490816291, "post_id": 43102456, "comment_id": 73287022, "body": "Why are you not using a bound form where recordsource is table? There will be no need for an append/update queries."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1490816518, "post_id": 43102456, "comment_id": 73287150, "body": "You are saving date values as strings in a text field? Doubt I would design an inventory database that deletes inventory records. Is this tracking individual assets or bulk quantities?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1490818507, "post_id": 43102456, "comment_id": 73288207, "body": "Why do keep on punishing yourself? Change the form to be bound to the table, and you can <i>erase all this stuff</i> and get done with it."}], "owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490815474, "creation_date": 1490815474, "question_id": 43102456, "link": "https://stackoverflow.com/questions/43102456/access-wont-insert-record-to-table-from-form-if-table-already-has-a-record-in-i", "title": "Access won&#39;t insert record to table from form if table already has a record in it", "body": "<p>Essentially I have a table with the data and then I want a form that has a text box for each field in the table with a subtable of the main table incorporated into the form. The user fills in the text boxes with the information and then either adds it to the table or they can click on a record and edit it or delete it with the corresponding buttons on the form.</p>\n\n<p>I was having some issues with some syntax and recently fixed that today, so now I'm finally fine tuning stuff on my form. The only issue I'm having now is that if there is already a record in the table, the form won't insert a new record once I click the add button. I fill the text boxes in and click the 'Add' button and the form refreshes like the add command worked, but then the new record doesn't show up in the table. However if I go back to the table and delete any record that is already in the table and then go back to the form and fill the boxes in again and click the 'Add' button, then a new record is inserted into the form.</p>\n\n<p>I created a database before the one I'm currently working on and it works fine. It is very similar to the database that I'm working on now, so I just copied it and then renamed the fields and text boxes and everything to match the information that this database will be handling.</p>\n\n<p>I have </p>\n\n<p>Any ideas what's going on here and how I could fix?</p>\n\n<p>Here's a link to some screenshots of the database: <a href=\"https://imgur.com/a/QvCY2\" rel=\"nofollow noreferrer\">https://imgur.com/a/QvCY2</a></p>\n\n<p>Here's my code:</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub cmdAdd_Click()\n    'when we click on button Add there are two options\n    '1. for insert\n    '2. for update\n    If Me.txtICN.Tag &amp; \"\" = \"\" Then\n        'this is for insert new\n        'add data to table\n        CurrentDb.Execute \"INSERT INTO tblInventory(ICN, manu, model, serial, descr, dateRec, dateRem, dispo, flgDispo, project, AMCA, UL, comments) \" &amp; _\n        \" VALUES(\" &amp; Me.txtICN &amp; \", '\" &amp; Me.txtManu &amp; \"', '\" &amp; Me.txtModel &amp; \"', '\" &amp; Me.txtSerial &amp; \"', '\" &amp; Me.txtDescr &amp; \"', '\" &amp; Me.txtDateRec &amp; \"', '\" &amp; Me.txtDateRem &amp; \"', '\" &amp; Me.txtDispo &amp; \"', '\" &amp; Me.chkFlg &amp; \"', '\" &amp; Me.txtProject &amp; \"', '\" &amp; Me.txtAMCA &amp; \"', '\" &amp; Me.txtUL &amp; \"', '\" &amp; Me.txtComments &amp; \"')\"\n    Else\n        'otherwise (Tag of txtICN stores the ICN of item to be modified)\n        CurrentDb.Execute \"UPDATE tblInventory \" &amp; _\n        \" SET ICN = \" &amp; Me.txtICN &amp; _\n        \", manu = '\" &amp; Me.txtManu &amp; \"'\" &amp; _\n        \", model = '\" &amp; Me.txtModel &amp; \"'\" &amp; _\n        \", serial = '\" &amp; Me.txtSerial &amp; \"'\" &amp; _\n        \", descr = '\" &amp; Me.txtDescr &amp; \"'\" &amp; _\n        \", dateRec = '\" &amp; Me.txtDateRec &amp; \"'\" &amp; _\n        \", dateRem = '\" &amp; Me.txtDateRem &amp; \"'\" &amp; _\n        \", dispo = '\" &amp; Me.txtDispo &amp; \"'\" &amp; _\n        \", flgDispo = '\" &amp; Me.chkFlg &amp; \"'\" &amp; _\n        \", project = '\" &amp; Me.txtProject &amp; \"'\" &amp; _\n        \", AMCA = '\" &amp; Me.txtAMCA &amp; \"'\" &amp; _\n        \", UL = '\" &amp; Me.txtUL &amp; \"'\" &amp; _\n        \", comments = '\" &amp; Me.txtComments &amp; \"'\" &amp; _\n        \" WHERE ICN = \" &amp; Me.txtICN.Tag\n    End If\n\n    'clear form\n    cmdClear_Click\n    'refresh data in list on form\n    frmInventorySub.Form.Requery\n\nEnd Sub\n\nPrivate Sub cmdClear_Click()\n    Me.txtICN = \"\"\n    Me.txtManu = \"\"\n    Me.txtModel = \"\"\n    Me.txtSerial = \"\"\n    Me.txtDescr = \"\"\n    Me.txtDateRec = \"\"\n    Me.txtDateRem = \"\"\n    Me.txtDispo = \"\"\n    Me.chkFlg = \"\"\n    Me.txtProject = \"\"\n    Me.txtAMCA = \"\"\n    Me.txtUL = \"\"\n    Me.txtComments = \"\"\n\n    'focus on ID text box\n    Me.txtICN.SetFocus\n    'set button edit to enable\n    Me.cmdEdit.Enabled = True\n    'change caption of button add to Add\n    Me.cmdAdd.Caption = \"Add\"\n    'clear tag on txtICN for reset new\n    Me.txtICN.Tag = \"\"\nEnd Sub\n\nPrivate Sub cmdClose_Click()\n    DoCmd.Close\nEnd Sub\n\nPrivate Sub cmdDelete_Click()\n    'delete record\n    'check existing selected record\n    If Not (Me.frmInventorySub.Form.Recordset.EOF And Me.frmInventorySub.Form.Recordset.BOF) Then\n        'confirm delete\n        If MsgBox(\"Are you sure you want to delete this item?\", vbYesNo) = vbYes Then\n            'delete now\n            CurrentDb.Execute \"DELETE FROM tblInventory \" &amp; _\n                \"WHERE ICN =\" &amp; Me.frmInventorySub.Form.Recordset.Fields(\"ICN\")\n            'refresh data in list\n            Me.frmInventorySub.Form.Requery\n        End If\n    End If\nEnd Sub\n\nPrivate Sub cmdEdit_Click()\n    'check whether there exists data in list\n    If Not (Me.frmInventorySub.Form.Recordset.EOF And Me.frmInventorySub.Form.Recordset.BOF) Then\n        'get data to text box control\n        With Me.frmInventorySub.Form.Recordset\n            Me.txtICN = .Fields(\"ICN\")\n            Me.txtManu = .Fields(\"manu\")\n            Me.txtModel = .Fields(\"model\")\n            Me.txtSerial = .Fields(\"serial\")\n            Me.txtDescr = .Fields(\"descr\")\n            Me.txtDateRec = .Fields(\"dateRec\")\n            Me.txtDateRem = .Fields(\"dateRem\")\n            Me.txtDispo = .Fields(\"dispo\")\n            Me.chkFlg = .Fields(\"flgDispo\")\n            Me.txtProject = .Fields(\"project\")\n            Me.txtAMCA = .Fields(\"AMCA\")\n            Me.txtUL = .Fields(\"UL\")\n            Me.txtComments = .Fields(\"comments\")\n            'store id of item in Tag of txtICN in case ICN is modified\n            Me.txtICN.Tag = .Fields(\"ICN\")\n            'change caption of button add to Update\n            Me.cmdAdd.Caption = \"Update\"\n            'disable button edit\n            Me.cmdEdit.Enabled = False\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1490815590, "post_id": 43102343, "comment_id": 73286589, "body": "<code>xlApp.Quit</code> will do it"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 7416624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cd6e64c64d413c5d0f7093ae40acf7?s=128&d=identicon&r=PG", "display_name": "Tom Scott", "link": "https://stackoverflow.com/users/7416624/tom-scott"}, "is_accepted": false, "score": 2, "last_activity_date": 1490815675, "creation_date": 1490815675, "answer_id": 43102523, "question_id": 43102343, "link": "https://stackoverflow.com/questions/43102343/powerpoint-vba-dont-close-excel/43102523#43102523", "title": "Powerpoint VBA dont close Excel", "body": "<p>Try <code>xlApp.Quit</code> before <code>Set xlApp = Nothing</code></p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1490817191, "last_edit_date": 1495542326, "creation_date": 1490817191, "answer_id": 43102915, "question_id": 43102343, "link": "https://stackoverflow.com/questions/43102343/powerpoint-vba-dont-close-excel/43102915#43102915", "title": "Powerpoint VBA dont close Excel", "body": "<blockquote>\n<pre><code>Set xlApp = Nothing\n</code></pre>\n</blockquote>\n\n<p>That instruction sets the <code>xlApp</code> object reference to <code>Nothing</code>. It doesn't destroy the object it's referring to, but it prevents further code from using <em>that</em> reference.</p>\n\n<p>Excel is a rather complex application; creating an instance of an <code>Excel.Application</code> object has many implications, and in order to properly shut itself down, it needs to run through a certain sequence of instructions (unload Excel and COM add-ins, close any opened file, tear down the VBE if it was initialized - which in turn may need to tear down its own add-ins, etc.) - by setting your reference to <code>Nothing</code>, you say \"I don't need it anymore\" - but what of the COM add-ins that still use it? That workbook that's still open is a <code>Workbook</code> object with an <code>Application</code> property that also references the very same object you were referring to - and <em>these</em> references aren't gone yet!</p>\n\n<p>As <a href=\"https://stackoverflow.com/questions/43102343/powerpoint-vba-dont-close-excel#comment73286589_43102343\">Tim</a> and <a href=\"https://stackoverflow.com/a/43102523/1188513\">Tom</a> said, you need to call the <code>Quit</code> method of the <code>Excel.Application</code> instance, so that it can clean itself up.</p>\n\n<p>And if that's the last thing your code does, then you probably don't even need to <code>Set xlApp = Nothing</code>, since the VBA runtime will know that it doesn't need to hold on to the <code>xlApp</code> reference after it's out of scope; <code>Set xlWorkbook = Nothing</code> is superfluous as well.</p>\n\n<p>Quitting Excel will close the unmodified workbook you've opened, but since <em>you</em> opened it, I'd argue that it's good form to close it yourself - just call <code>xlWorkbook.Close</code> before you call <code>xlApp.Quit</code>.</p>\n"}], "owner": {"reputation": 99, "user_id": 7685995, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a6e14fe531a99a01563aa19f4369f41?s=128&d=identicon&r=PG&f=1", "display_name": "ante011", "link": "https://stackoverflow.com/users/7685995/ante011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "accepted_answer_id": 43102915, "answer_count": 2, "score": 1, "last_activity_date": 1490817191, "creation_date": 1490815123, "question_id": 43102343, "link": "https://stackoverflow.com/questions/43102343/powerpoint-vba-dont-close-excel", "title": "Powerpoint VBA dont close Excel", "body": "<p>My VBA code in Powerpoint wont \"kill\" my excel application.\nit still runs if i have a look in task manager.</p>\n\n<p>I would like to close it the right way rather than kill.</p>\n\n<p>Anyone that could help me? I already searched and tried to get it working but with no luck.</p>\n\n<pre><code>Public Sub OnSlideShowPageChange(ByVal Wn As SlideShowWindow)\nIf Wn.View.CurrentShowPosition = 2 Then\n\n    Dim xlApp As Object\n    Dim xlWorkBook As Object\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    xlApp.Visible = False\n    Set xlWorkBook = xlApp.Workbooks.Open(\"D:\\ELE_powerpoint\\book1.xlsx\", True, False)\n\n    With xlWorkBook.ActiveSheet\n    txt1 = xlWorkBook.sheets(1).Range(\"A2\")\n    txt2 = xlWorkBook.sheets(1).Range(\"A3\")\n    txt3 = xlWorkBook.sheets(1).Range(\"A4\")\n    End With\n\n    ActivePresentation.Slides(2).Shapes(\"a2\").TextFrame.TextRange = txt1\n    ActivePresentation.Slides(2).Shapes(\"a3\").TextFrame.TextRange = txt2\n    ActivePresentation.Slides(2).Shapes(\"a4\").TextFrame.TextRange = txt3\n\n    Set xlApp = Nothing\n    Set xlWorkBook = Nothing\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1490816685, "post_id": 43102310, "comment_id": 73287257, "body": "Yes, of course there is &#39;<i>a VBA (or even just functions) to achieve this</i>&#39;. What a silly question! Hire a programmer and he/she will tell you the same thing."}, {"owner": {"reputation": 19, "user_id": 7787905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dadab6520bb1f9c11a4dcd09759ca02b?s=128&d=identicon&r=PG&f=1", "display_name": "L Vermeulen", "link": "https://stackoverflow.com/users/7787905/l-vermeulen"}, "edited": false, "score": 0, "creation_date": 1491212809, "post_id": 43102310, "comment_id": 73435554, "body": "A bit of an uncalled for response there, @Jeeped, as asking questions is after all the purpose of the forum."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7787905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dadab6520bb1f9c11a4dcd09759ca02b?s=128&d=identicon&r=PG&f=1", "display_name": "L Vermeulen", "link": "https://stackoverflow.com/users/7787905/l-vermeulen"}, "edited": false, "score": 0, "creation_date": 1491213526, "post_id": 43103362, "comment_id": 73436005, "body": "Thanks Jonathan - it&#39;s still proving difficult to complete the end result of returning only first invoices per customer though. Have moved the data to MySQL for better manipulation."}], "tags": [], "owner": {"reputation": 983, "user_id": 6753444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9a4459e9cb4ab680f510b698e7002eca?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/6753444/jonathan"}, "is_accepted": false, "score": 1, "last_activity_date": 1491218795, "last_edit_date": 1491218795, "creation_date": 1490818757, "answer_id": 43103362, "question_id": 43102310, "link": "https://stackoverflow.com/questions/43102310/finding-min-invoice-number-per-customer-and-removing-all-rows-that-dont-match/43103362#43103362", "title": "Finding MIN Invoice Number Per Customer and Removing All Rows That Don&#39;t Match", "body": "<p>Use COUNTIFS to count the number of times the customer number has appeared. Use a reference that is anchored to the first cell and changes as you drag down. </p>\n\n<p>Assuming your customer numbers are in column A, insert this into B1 and copy down:</p>\n\n<pre><code>=COUNTIFS($A$1:A1,A1)\n</code></pre>\n\n<p>Filter on 1 or 2 accordingly.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I didn't realise that you only wanted the first row. You can exploit the fact that MATCH will return the first result and check if it equals the row number:</p>\n\n<pre><code>=MATCH(A1,A:A,0)=ROW(A1)\n</code></pre>\n\n<p>Note that you may need to offset <code>MATCH</code> slightly if your data doesn't start from row 1. For example, if your data starts in row 3, you will need to offset your <code>MATCH</code> result by 2:</p>\n\n<pre><code>=MATCH(A1,A:A,0)+2=ROW(A1)\n</code></pre>\n\n<p>Now you can filter on the first column equalling 1 or 2 and the second column equalling <code>TRUE</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 7787905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dadab6520bb1f9c11a4dcd09759ca02b?s=128&d=identicon&r=PG&f=1", "display_name": "L Vermeulen", "link": "https://stackoverflow.com/users/7787905/l-vermeulen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491218795, "creation_date": 1490815024, "last_edit_date": 1490827089, "question_id": 43102310, "link": "https://stackoverflow.com/questions/43102310/finding-min-invoice-number-per-customer-and-removing-all-rows-that-dont-match", "title": "Finding MIN Invoice Number Per Customer and Removing All Rows That Don&#39;t Match", "body": "<p>I have an Excel file that shows online sales data. There are multiple columns, as you would expect, two of which are Customer ID and Invoice Number.</p>\n\n<p>My aim is to only keep rows where the Invoice Number is the first (or MIN) Invoice Number for each Customer.</p>\n\n<p>On a duplicate tab, we want the same thing, but only for the second Invoice Number per Customer (i.e. the second purchase).</p>\n\n<p>On a side note, there can be multiple rows for the same Customer ID and same Invoice Number because the rows are at Item level, so it may look like this:</p>\n\n<pre><code>Row 1: Customer ID = 24; Invoice Number = 1014; Item = Jelly Beans\nRow 2: Customer ID = 24; Invoice Number = 1014; Item = Candy Bars\n</code></pre>\n\n<p>So, that's okay. We just want to make sure any rows where the Customer's Invoice Number does not reflect their first purchase (or second purchase, in the second instance) is removed from the spreadsheet.</p>\n\n<p>Is there a VBA (or even just functions) to achieve this? Even in steps: such as first highlighting those rows and then using another VBA to delete rows that are highlighted?</p>\n\n<p>Again, in a nutshell I'm looking to only keep rows with the MIN(Invoice Number) per Customer ID.</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 0, "creation_date": 1490817267, "post_id": 43102290, "comment_id": 73287562, "body": "I just answered a very similar question  on this question.  <a href=\"http://stackoverflow.com/questions/43095155/vba-to-complete-a-internet-form/43096864?noredirect=1#comment73287084_43096864\" title=\"vba to complete a internet form\">stackoverflow.com/questions/43095155/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "edited": false, "score": 0, "creation_date": 1490820831, "post_id": 43103158, "comment_id": 73289477, "body": "thank you, but i&#39;m getting an error 424. I tried setting dados as an object but it didn&#39;t help. I do have my references set correctly"}, {"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "reply_to_user": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "edited": false, "score": 0, "creation_date": 1490822895, "post_id": 43103158, "comment_id": 73290556, "body": "@andrew, my fault copy paste got me again. Try one more time. I Fixed the on the for each loop I had the wrong <code>Var</code>"}, {"owner": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "edited": false, "score": 0, "creation_date": 1490878184, "post_id": 43103158, "comment_id": 73315847, "body": "Thank you! it works great. I changed Debug.print mybtn(i).innerText  to    Sheets(&quot;sheet1&quot;).Range(&quot;A&quot; &amp; i + 1) = mybtn(i).innerText. otherwise nothing printed.  But i wish to have the webpage visible as well. I tried setting HTMLDocument.visible = true in the with loop but it didn&#39;t work. I&#39;m use to using IE for these type of applications. Should i rewrite the code fro IE or is there a short cut im missing? Thank you again, you have been very helpful!"}, {"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "reply_to_user": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "edited": false, "score": 0, "creation_date": 1490878355, "post_id": 43103158, "comment_id": 73315970, "body": "@Andrew, glad to help. Don&#39;t forget to set it as  the answer!"}], "tags": [], "owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "is_accepted": false, "score": 1, "last_activity_date": 1490822867, "last_edit_date": 1490822867, "creation_date": 1490818021, "answer_id": 43103158, "question_id": 43102290, "link": "https://stackoverflow.com/questions/43102290/want-to-select-button-on-website-using-excel-vba/43103158#43103158", "title": "Want to select button on website using excel vba", "body": "<p>I can access the button by doing this.</p>\n\n<pre><code>Sub test()\n\n\nDim oHtml As HTMLDocument\nDim oElement As Object\n\nSet oHtml = New HTMLDocument\n\nWith CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\n    .Open \"GET\", \"http://www.scoopmae.com/\", False\n    .send\n    oHtml.body.innerHTML = .responseText\nEnd With\n\nSet mybtn = oHtml.getElementsByClassName(\"sf-button large orange default  dropshadow\")(0).getElementsByTagName(\"span\")\n\ni = 0\nFor Each oElement In mybtn\n    Debug.Print mybtn(i).innerText\n    i = i + 1\nNext oElement\n\nEnd Sub\n</code></pre>\n\n<p>Make certain that you go to Tools -> References and add a reference to the Microsoft HTML Object Library [MSHTML.TLB]\nThanks\nMiguel</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1491659038, "creation_date": 1491659038, "answer_id": 43294872, "question_id": 43102290, "link": "https://stackoverflow.com/questions/43102290/want-to-select-button-on-website-using-excel-vba/43294872#43294872", "title": "Want to select button on website using excel vba", "body": "<p>You are basically right there!!  Make sure you add 2 references:\n1 Microsoft Internet Controls\n2. Microsoft HTML Object Library\nRead more at <a href=\"http://vbadud.blogspot.com/2009/08/how-to-login-to-website-using-v\" rel=\"nofollow noreferrer\">http://vbadud.blogspot.com/2009/08/how-to-login-to-website-using-v</a></p>\n\n<p>See this link.</p>\n\n<p><a href=\"http://vbadud.blogspot.com/2009/08/how-to-login-to-website-using-vba.html\" rel=\"nofollow noreferrer\">http://vbadud.blogspot.com/2009/08/how-to-login-to-website-using-vba.html</a></p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub test()\n\n\nDim oHtml As HTMLDocument\nDim oElement As Object\n\nSet oHtml = New HTMLDocument\n\nWith CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\n    .Open \"GET\", \"http://www.scoopmae.com/\", False\n    .send\n    oHtml.body.innerHTML = .responseText\nEnd With\n\nSet mybtn = oHtml.getElementsByClassName(\"sf-button large orange default  dropshadow\")(0).getElementsByTagName(\"span\")\n\ni = 0\nFor Each oElement In mybtn\n    Debug.Print mybtn(i).innerText\n    oElement.Click\n    i = i + 1\nNext oElement\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1491659038, "creation_date": 1490814978, "question_id": 43102290, "link": "https://stackoverflow.com/questions/43102290/want-to-select-button-on-website-using-excel-vba", "title": "Want to select button on website using excel vba", "body": "<p>I want to use excel to navigate a webpage. yet the website doesn't use ID's like a normal site does (amazon,google,ect). the website is <a href=\"http://www.scoopmae.com/\" rel=\"nofollow noreferrer\">http://www.scoopmae.com/</a>. how would i select the \"book a demo\" button. I would normally use getelementbyID, but i don't know the id. I've also tried tag and class but no luck.</p>\n\n<pre><code>Sub scoop()\nSet objie = CreateObject(\"InternetExplorer.Application\")\nobjie.Top = 0\nobjie.Left = 0\nobjie.Width = 1600\nobjie.Height = 900\nobjie.Visible = True 'We can see IE\n\nOn Error Resume Next\nobjie.navigate (\"http://scoopmae.com\")\nDo\nDoEvents\nLoop Until objue.readystate = 4\n\nApplication.Wait (Now + TimeValue(\"0:00:02\"))\n'MsgBox (\"wait\")\n'click button\n'objie.document.getElementsById(\"scoop-sort\").Click\n\n\n\n x = objie.document.getElementsByClassName(\"a\")\nCells(1, 2) = x\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490816880, "post_id": 43102139, "comment_id": 73287367, "body": "How/why doesn&#39;t it work? Does it give an error, if so what error where? FYI you should be sure to specify what sheet you want <code>Rows.Count</code> to run on, like you do with <code>Range()</code>: <code>Sheets(&quot;Registration&quot;).Range(&quot;C&quot; &amp; Sheets(&quot;Registration&quot;).Rows.Count).End(xlUp).Row</code> Also, to clarify, if <code>Cells(1,r)</code> <i>doesn&#39;t</i> equal <code>Date</code>, then you want what to happen? Your loop there I believe is a little out of order. Because, if I understand, it&#39;ll only run ONCE <code>if Cells(1,27)</code> doesn&#39;t equal <code>Date</code>, then you&#39;re going to go to the end of the sub, is that what&#39;s happening? Step through with <code>F8</code> to check."}, {"owner": {"reputation": 49, "user_id": 7559074, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GdZKFsPUDOY/AAAAAAAAAAI/AAAAAAAAAKk/OVPoc65DtJ8/photo.jpg?sz=128", "display_name": "Pourya Ashena", "link": "https://stackoverflow.com/users/7559074/pourya-ashena"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490819108, "post_id": 43102139, "comment_id": 73288518, "body": "Hi Bruce. Thank you for your reply. I get an error on the line for Next r  and it says Next without for.   I am not really that advance with VBA. i want to run row.count on both sheet1 and sheet2. I want the first loop to check the first row in sheet1. and then when it finds the head that is equal to date. then i want to collect the information from column N,O,P in sheet2 and paste them in the column that has a eader that is equals to Date."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 7559074, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GdZKFsPUDOY/AAAAAAAAAAI/AAAAAAAAAKk/OVPoc65DtJ8/photo.jpg?sz=128", "display_name": "Pourya Ashena", "link": "https://stackoverflow.com/users/7559074/pourya-ashena"}, "edited": false, "score": 0, "creation_date": 1490869375, "post_id": 43105357, "comment_id": 73309572, "body": "Hi John Thank you for your response."}, {"owner": {"reputation": 49, "user_id": 7559074, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GdZKFsPUDOY/AAAAAAAAAAI/AAAAAAAAAKk/OVPoc65DtJ8/photo.jpg?sz=128", "display_name": "Pourya Ashena", "link": "https://stackoverflow.com/users/7559074/pourya-ashena"}, "edited": false, "score": 0, "creation_date": 1490869393, "post_id": 43105357, "comment_id": 73309584, "body": "What I am trying to do is actually like this:                                           Sub test()      ActiveCell.Offset(1, 12).Range(&quot;A1&quot;).Select     ActiveCell.FormulaR1C1 = &quot;=SUM(Sheet2!RC:RC[2])&quot;     ActiveCell.Select     Selection.AutoFill Destination:=ActiveCell.Range(&quot;A1:A49&quot;), Type:= _         xlFillDefault     ActiveCell.Range(&quot;A1:A49&quot;).Select     ActiveWindow.SmallScroll Down:=-18     ActiveCell.Select End Sub"}, {"owner": {"reputation": 49, "user_id": 7559074, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GdZKFsPUDOY/AAAAAAAAAAI/AAAAAAAAAKk/OVPoc65DtJ8/photo.jpg?sz=128", "display_name": "Pourya Ashena", "link": "https://stackoverflow.com/users/7559074/pourya-ashena"}, "edited": false, "score": 0, "creation_date": 1490869693, "post_id": 43105357, "comment_id": 73309790, "body": "I need that the code searches in the first row to find the cell that contains the current Date. and then in this macro the destination should select from that cell to last row."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1490826683, "creation_date": 1490826683, "answer_id": 43105357, "question_id": 43102139, "link": "https://stackoverflow.com/questions/43102139/collect-information-from-one-sheet-and-place-it-to-a-different-sheet-in-vba/43105357#43105357", "title": "collect information from one sheet and place it to a different sheet in vba", "body": "<p>The <code>Next r</code> is misplaced. It should be after the <code>End If</code></p>\n\n<p>The resulting code looks like this:</p>\n\n<pre><code>Sub registrereren()\n    Dim FirstDate As Date\n    Dim LastDate As Date\n    Dim NextDate As Date\n    Dim r As Long\n    Dim j As Long\n    Dim lastrow1 As Long\n\n    FirstDate = DateSerial(Year(Date), Month(Date), 1)\n    LastDate = DateSerial(Year(Date), Month(Date) + 1, 0)\n    lastrow1 = Sheets(\"Registration\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n    For r = 27 To LastDate\n        If Cells(1, r) = Date Then\n            For j = 2 To lastrow1\n                Sheets(\"Sheet1\").Cells(j, r).Value = WorksheetFunction.VLookup(Sheets(\"Sheet1\").Range(\"C\" &amp; j).Value * 1, Sheets(\"Sheet2\").Range(\"C2 : P3000\"), 11 + 12 + 13, 0)\n            Next j\n        End If\n    Next r\nEnd Sub\n</code></pre>\n\n<p>The VBA editor makes it easy to indent code. Whenever you start a sub, function, loop, select case, or if statement, get in the habit of indenting the next line by hitting the tab key. When you are done with the block, use the backspace key to get you back to the previous levels of indentation. Furthermore, there are options on the editor ribbon which allows you to indent or dedent whole blocks of code.</p>\n\n<p>Once you get in the habit of doing this, it should jump out at you when a block isn't terminated the correct way. On the other hand, your sporadic and inconsistent indentation made it hard to perceive what was the problem with <code>Next r</code>.</p>\n\n<p>The above code compiles, but I wasn't able to test it in any easy way since I'm not sure how your spreadsheet is laid out. If it still doesn't work, you have another problem with the code and could either edit your question or perhaps ask another question if you need to (once you isolate what the problem is).</p>\n"}], "owner": {"reputation": 49, "user_id": 7559074, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-GdZKFsPUDOY/AAAAAAAAAAI/AAAAAAAAAKk/OVPoc65DtJ8/photo.jpg?sz=128", "display_name": "Pourya Ashena", "link": "https://stackoverflow.com/users/7559074/pourya-ashena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490826683, "creation_date": 1490814522, "last_edit_date": 1531161705, "question_id": 43102139, "link": "https://stackoverflow.com/questions/43102139/collect-information-from-one-sheet-and-place-it-to-a-different-sheet-in-vba", "title": "collect information from one sheet and place it to a different sheet in vba", "body": "<p>I have two excel sheets in the same workbook. sheet1 and sheet2.\nin sheet1 i generate dates for each month. for example column z1 will be 3/1/2017, AA1 will be 3/2/2017, AB1 will be 3/3/2017 etc. till the end date of a month. </p>\n\n<p>Then in sheet2 i have some numbers in column N,O,P. every day these numbers could be different.</p>\n\n<p>In column C of both sheet1 and sheet2 are SN stored.</p>\n\n<p>Now I am trying to collect the values from column N,O,P from sheet2 (N+O+P), and store them in sheet1 in column that head = Date   by the same SN.\ni am trying to use the following code but this does not work.</p>\n\n<p>could anyone help me with this</p>\n\n<pre><code>Sub registrereren()\nDim FirstDate As Date\nDim LastDate As Date\nDim NextDate As Date\nDim r As Long\n\nDim j As Long\nDim lastrow1 As Long\n\nFirstDate = DateSerial(Year(Date), Month(Date), 1)\nLastDate = DateSerial(Year(Date), Month(Date) + 1, 0)\nlastrow1 = Sheets(\"Registration\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nFor r = 27 To LastDate\n\nIf Cells(1, r) = Date Then\n Next r\n\n   For j = 2 To lastrow1\n\n   Sheets(\"Sheet1\").Cells(j, r).Value = WorksheetFunction.VLookup(Sheets(\"Sheet1\").Range(\"C\" &amp; j).Value * 1, Sheets(\"Sheet2\").Range(\"C2 : P3000\"), 11 + 12 + 13, 0)\n\n\n    Next j\n End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1490813767, "post_id": 43101876, "comment_id": 73285388, "body": "Why not use a list in Data Validation? Then only those in the list can be entered."}, {"owner": {"reputation": 125, "user_id": 7732221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/005be318d923721f12a075c9e332091d?s=128&d=identicon&r=PG&f=1", "display_name": "VBABeginner", "link": "https://stackoverflow.com/users/7732221/vbabeginner"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490814402, "post_id": 43101876, "comment_id": 73285871, "body": "I have that. There are so many products that the names inside the drop down are tiny. I would also like to copy and paste and have the code tell me if one of them is spelled wrong and where. Faster"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490814524, "post_id": 43101876, "comment_id": 73285929, "body": "Then use Conditional Formatting, and only paste the values."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 7732221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/005be318d923721f12a075c9e332091d?s=128&d=identicon&r=PG&f=1", "display_name": "VBABeginner", "link": "https://stackoverflow.com/users/7732221/vbabeginner"}, "edited": false, "score": 0, "creation_date": 1490883650, "post_id": 43102421, "comment_id": 73320297, "body": "OMG genius. no other way to describe you"}, {"owner": {"reputation": 125, "user_id": 7732221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/005be318d923721f12a075c9e332091d?s=128&d=identicon&r=PG&f=1", "display_name": "VBABeginner", "link": "https://stackoverflow.com/users/7732221/vbabeginner"}, "edited": false, "score": 0, "creation_date": 1490885136, "post_id": 43102421, "comment_id": 73321618, "body": "but if you were to copy and paste (paste anyway) why won&#39;t it work?"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 125, "user_id": 7732221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/005be318d923721f12a075c9e332091d?s=128&d=identicon&r=PG&f=1", "display_name": "VBABeginner", "link": "https://stackoverflow.com/users/7732221/vbabeginner"}, "edited": false, "score": 0, "creation_date": 1490956563, "post_id": 43102421, "comment_id": 73353991, "body": "Glad it worked. That&#39;s because you might be copying and pasting to the multiple cells at once and the code will will track the changes only if you change the content of one cell. Posting another solution considering you make changes to multiple cells at once."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 3, "last_activity_date": 1490956859, "last_edit_date": 1490956859, "creation_date": 1490815359, "answer_id": 43102421, "question_id": 43101876, "link": "https://stackoverflow.com/questions/43101876/value-in-cell-to-match-in-a-list-i-have-and-do-it-to-every-cell-under-that-toot/43102421#43102421", "title": "Value in cell to match in a List I have and do it to every cell under that too(Title Not Good)", "body": "<p>Right click on Sheet Tab --> View Code --> and paste the code given below into the opened code window --> Close the VB Editor --> Save your workbook as Macro-Enabled Workbook.\nThe following code assumes that you have a named range called \"List\" on Sheet2 (code name not the tab name).\nIf you input a value in column A starting from row2, the code will automatically check if the value you entered is found in the named range List and if it doesn't find that value, a msgbox will be popped up to give you some information.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.CountLarge &gt; 1 Then Exit Sub\nIf Target.Column = 1 And Target.Row &gt; 1 Then\n    If Target &lt;&gt; \"\" Then\n        If Application.CountIf(Sheet2.Range(\"List\"), Target.Value) = 0 Then\n            MsgBox \"The value \" &amp; Target.Value &amp; \" you entered in cell \" &amp; Target.Address(0, 0) &amp; \" was not found in the List\", vbExclamation, \"Item Not Found!\"\n        End If\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>Replace the above proposed code with the following code.\nThe following code will be useful if you change multiple cells at once and will provide you a list of all the values which were not found in the List named range.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim cell As Range\nDim str As String\nDim Found As Boolean\nstr = \"The following values were not found in the List.\" &amp; vbNewLine &amp; vbNewLine\nIf Target.Column = 1 And Target.Row &gt; 1 Then\n    For Each cell In Target\n        If cell &lt;&gt; \"\" Then\n            If Application.CountIf(Sheet2.Range(\"List\"), cell.Value) = 0 Then\n                Found = True\n                str = str &amp; cell.Address(0, 0) &amp; \" : \" &amp; cell.Value &amp; vbNewLine\n            End If\n        End If\n    Next cell\nEnd If\nIf Found Then MsgBox str, vbExclamation, \"Values Not Found!\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7416624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cd6e64c64d413c5d0f7093ae40acf7?s=128&d=identicon&r=PG", "display_name": "Tom Scott", "link": "https://stackoverflow.com/users/7416624/tom-scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1490819764, "last_edit_date": 1490819764, "creation_date": 1490816533, "answer_id": 43102738, "question_id": 43101876, "link": "https://stackoverflow.com/questions/43101876/value-in-cell-to-match-in-a-list-i-have-and-do-it-to-every-cell-under-that-toot/43102738#43102738", "title": "Value in cell to match in a List I have and do it to every cell under that too(Title Not Good)", "body": "<p>You could use a formula get what you want. </p>\n\n<pre><code>=IFERROR(MATCH(PRODUCT,LISTofPRODUCTS,0),\"Not Found In List\")\n</code></pre>\n\n<p>Same formula using actual cell references:</p>\n\n<pre><code>=IFERROR(MATCH(A1,$B$1:$B$500,0),\"Not Found In List\")\n</code></pre>\n\n<p>Where the value you want to look for is in cell A1, and the list you want to look in is B1:B500</p>\n\n<p>To know what row the un-matched value is in, you could use this formula</p>\n\n<pre><code>=IF(ISERROR(MATCH(A1,$B$1:$B$500,0)),\"Found\",\"Value in row \" &amp; ROW(A1) &amp; \" not found\")\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 7732221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/005be318d923721f12a075c9e332091d?s=128&d=identicon&r=PG&f=1", "display_name": "VBABeginner", "link": "https://stackoverflow.com/users/7732221/vbabeginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 43102421, "answer_count": 2, "score": 1, "last_activity_date": 1490956859, "creation_date": 1490813677, "last_edit_date": 1490813905, "question_id": 43101876, "link": "https://stackoverflow.com/questions/43101876/value-in-cell-to-match-in-a-list-i-have-and-do-it-to-every-cell-under-that-toot", "title": "Value in cell to match in a List I have and do it to every cell under that too(Title Not Good)", "body": "<p>I would like the macro/code to take the Product that was entered in that cell (relative reference I guess) and scan a list of Products I have. If it doesn't match I would like the message box to tell me which product entered doesn't match with one in my product list and to return its row number where it was entered.</p>\n\n<p>So to give you another example. Lets say we'll enter a number \"1\" in a cell. I need the macro to search my list of numbers 1-100, if 1 isn't in there I would like it to tell me. Let's say the next number entered (in the following cell under) was a 101. A message box would tell me 101 is not in my number list and its located in row 2.</p>\n\n<p>It probably needs loops. As I will have a range of about 500 cells going down in that column that I would like it to search that product with a list.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7160114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae579b1ae73db541f4c612c18c063177?s=128&d=identicon&r=PG&f=1", "display_name": "Kshitij Chhikara", "link": "https://stackoverflow.com/users/7160114/kshitij-chhikara"}, "edited": false, "score": 0, "creation_date": 1490819142, "post_id": 43103116, "comment_id": 73288529, "body": "It doesn&#39;t work the way I want it to work after using the else statement. After adding the else statement, if I click on Pallet (Packing Frame) the Palet frame gets activated (Which is what I want) but when I click on Box again it gives me a run time error saying &quot;You can&#39;t lock control while it has unsaved changes&quot; instead of deactivating the Pallet Frame."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 17, "user_id": 7160114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae579b1ae73db541f4c612c18c063177?s=128&d=identicon&r=PG&f=1", "display_name": "Kshitij Chhikara", "link": "https://stackoverflow.com/users/7160114/kshitij-chhikara"}, "edited": false, "score": 0, "creation_date": 1490824054, "post_id": 43103116, "comment_id": 73291048, "body": "Try the <code>AfterUpdate</code> event of the control."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 17, "user_id": 7160114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae579b1ae73db541f4c612c18c063177?s=128&d=identicon&r=PG&f=1", "display_name": "Kshitij Chhikara", "link": "https://stackoverflow.com/users/7160114/kshitij-chhikara"}, "edited": false, "score": 0, "creation_date": 1490832575, "post_id": 43103116, "comment_id": 73293814, "body": "See edit using <code>Me.Dirty = False</code> to save form changes getting it out of edit mode."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1490832592, "last_edit_date": 1490832592, "creation_date": 1490817826, "answer_id": 43103116, "question_id": 43101766, "link": "https://stackoverflow.com/questions/43101766/interlinking-two-option-groups-in-ms-access-form/43103116#43103116", "title": "Interlinking two option groups in MS Access form", "body": "<p>Simply add an <em>Else</em> condition to deactivate the lock:</p>\n\n<pre><code>Private Sub Frame_Packing_AfterUpdate()\n   If Frame_Packing.Value = 3 Then\n      Me.Dirty = False\n      Frame_Palet.Locked = False\n   Else\n      Frame_Palet.Locked = True\n   End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7160114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae579b1ae73db541f4c612c18c063177?s=128&d=identicon&r=PG&f=1", "display_name": "Kshitij Chhikara", "link": "https://stackoverflow.com/users/7160114/kshitij-chhikara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 43103116, "answer_count": 1, "score": 1, "last_activity_date": 1490832592, "creation_date": 1490813349, "last_edit_date": 1490817657, "question_id": 43101766, "link": "https://stackoverflow.com/questions/43101766/interlinking-two-option-groups-in-ms-access-form", "title": "Interlinking two option groups in MS Access form", "body": "<p>I have two option groups with frames on a form: <em>Packing</em> and <em>Pallet</em>. <em>Packing</em> contains 3 values: <em>Box, Rack</em> and <em>Pallet</em>. I wish to connect the frames such that if a person clicks on <em>Pallet</em> option in <em>Packing</em> Frame, the <em>Pallet</em> frame activates and remains deactivated for the remaining two options. </p>\n\n<pre><code>Private Sub Frame_Packing_BeforeUpdate(Cancel As Integer)\n   If Frame_Packing.Value = 3 Then\n      Frame_Palet.Locked = False\n   End If\nEnd Sub\n</code></pre>\n\n<p>I tried this code, but it only works once. So, if I click on <em>Pallet</em> the <em>Pallet</em> frame gets unlocked but if I change the value to <em>Box</em>, it doesn't deactivate. I want the <em>Pallet</em> frame to be active only when the pallet option is active under the <em>Packing</em> frame. </p>\n\n<p>By frame I mean Option Group, which has option boxes underneath it. For example, <em>Gender</em>, you can either Select <em>MALE</em> or <em>FEMALE</em>.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1490815185, "post_id": 43101479, "comment_id": 73286323, "body": "Try deleting it and then reinsert it after you make your changes"}, {"owner": {"reputation": 21, "user_id": 7782143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1e58dcccf2a9715983b12a20c547e7?s=128&d=identicon&r=PG&f=1", "display_name": "sefi a", "link": "https://stackoverflow.com/users/7782143/sefi-a"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1491305635, "post_id": 43101479, "comment_id": 73483449, "body": "sorry it didnwt help it happens again. when I changing the layout of the form the picture in background geting smaller and smaller."}], "owner": {"reputation": 21, "user_id": 7782143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1e58dcccf2a9715983b12a20c547e7?s=128&d=identicon&r=PG&f=1", "display_name": "sefi a", "link": "https://stackoverflow.com/users/7782143/sefi-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491305749, "creation_date": 1490812438, "last_edit_date": 1531164843, "question_id": 43101479, "link": "https://stackoverflow.com/questions/43101479/fit-picture-to-user-form-layout", "title": "Fit picture to user form layout", "body": "<p><a href=\"https://i.stack.imgur.com/r7k8j.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r7k8j.jpg\" alt=\"enter image description here\"></a>I'm having a hard time tring to fit the picture into the userform background when I change the layout.</p>\n\n<p>The picture just minimized and not filling the userform.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1490811495, "post_id": 43101125, "comment_id": 73283996, "body": "What error are you getting and what line are you getting it on?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 5, "creation_date": 1490811547, "post_id": 43101125, "comment_id": 73284039, "body": "Did you mean <code>wbCopyTo.Worksheet(&quot;Investigation Summary&quot;).Cells(8045 + j, 5).Value</code> instead of <code>activesheet</code>? To elaborate, you can either do <code>Workbook.Activesheet.Range...</code> or <code>Workbook.Worksheet(&quot;worksheet&quot;).range</code>, but you can&#39;t do <code>workbook.activesheet(&quot;worksheetname&quot;).range</code> because that&#39;s silly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490811664, "post_id": 43101125, "comment_id": 73284109, "body": "@BruceWayne - I see a <code>Set wbCopyTo = ActiveWorkbook</code> near the top."}], "owner": {"reputation": 1, "user_id": 7787525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6783313289a066f0ab1dc4bb5c6deb4?s=128&d=identicon&r=PG&f=1", "display_name": "arif", "link": "https://stackoverflow.com/users/7787525/arif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490811408, "creation_date": 1490811335, "last_edit_date": 1531161705, "question_id": 43101125, "link": "https://stackoverflow.com/questions/43101125/i-want-to-compare-two-excel-workbook-data-i-wrote-the-code-but-giving-run-time-e", "title": "I want to compare two excel workbook data i wrote the code but giving run time error, give me grife on w value", "body": "<pre><code>Sub Click()\nDim vFile As Variant\nDim wbCopyTo As Workbook\nDim wsCopyTo As Worksheet\nDim wbCopyFrom As Workbook\nDim wsCopyFrom As Worksheet\nSet wbCopyTo = ActiveWorkbook\nSet wsCopyTo = ActiveSheet\n'-------------------------------------------------------------\n'Open file with data to be copied\nvFile = Application.GetOpenFilename(\"Excel Files (*.xlsx*),\" &amp; _\"*.xlsx*\", 1, \"Select Excel File\", \"Open\", False)\n'If Cancel then Exit\nIf TypeName(vFile) = \"Boolean\" Then\nExit Sub\nElse\nSet wbCopyFrom = Workbooks.Open(vFile)\nSet wsCopyFrom = wbCopyFrom.Worksheets(\"Corrosion\")\nEnd If\n '--------------------------------------------------------------\n'comparing data and copy range\nDim n, i, j, k, l, o, w, s As Double\nn = wbCopyFrom.Worksheets(\"Corrosion\").Cells(12, 3).Value\ns = wbCopyFrom.Worksheets(\"Corrosion\").Cells(22 + k, 3).Value\nw = wbCopyTo.ActiveSheet(\"Investigation Summary\").Cells(8045 + j, 5).Value\nIf (w = s) Then\no = 8 + j\ndbln = \"Y\" &amp; o\ndblq = \"BB\" &amp; o\ndblt = \"BK\" &amp; o\ndblu = \"BM\" &amp; o\nwsCopyFrom.Range(dblm, dblp).Copy\nwsCopyTo.Range(dbln, dblq).PasteSpecial Paste:=xlPasteValues\ni = i + 1\nk = k + 1\nl = l + 1\no = 8 + j\nEnd If\n'----------------------------------------\nj = j + 1\nLoop\nwbCopyFrom.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "fonts", "colors", "ms-project"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1490810898, "post_id": 43100830, "comment_id": 73283645, "body": "<i>Future you</i> (and/or future maintainers of your code) will be <i>delighted</i> with such indentation... check out my OSS project&#39;s <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">Smart Indenter port</a>, which automatically fixes this for you."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490812001, "post_id": 43100830, "comment_id": 73284311, "body": "@Mat&#39;sMug gotta love the Ducky :)"}], "answers": [{"comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1490819814, "post_id": 43101358, "comment_id": 73288937, "body": "Looping through the task collection and using <code>SelectRow</code> with the task&#39;s UniqueID only works if no tasks were ever deleted (Task ID = Task Unique ID), no external tasks are present, and the tasks in the view are sorted by Task ID. The OP&#39;s version of selecting the tasks and looping through the selection works better."}, {"owner": {"reputation": 113, "user_id": 4173591, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f44d24d475b5206c26c7158e44d9388c?s=128&d=identicon&r=PG&f=1", "display_name": "vbvirg20", "link": "https://stackoverflow.com/users/4173591/vbvirg20"}, "edited": false, "score": 0, "creation_date": 1490884565, "post_id": 43101358, "comment_id": 73321126, "body": "Many thanks for your help, if i need to add a line to say change font to red if todays date is greater than finish date.  Would it be something like the following.?"}, {"owner": {"reputation": 113, "user_id": 4173591, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f44d24d475b5206c26c7158e44d9388c?s=128&d=identicon&r=PG&f=1", "display_name": "vbvirg20", "link": "https://stackoverflow.com/users/4173591/vbvirg20"}, "edited": false, "score": 0, "creation_date": 1490884603, "post_id": 43101358, "comment_id": 73321157, "body": "If ActiveSelection.Tasks(1).finish &lt; currentdate Then                 Font Color:=pjRed"}, {"owner": {"reputation": 113, "user_id": 4173591, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f44d24d475b5206c26c7158e44d9388c?s=128&d=identicon&r=PG&f=1", "display_name": "vbvirg20", "link": "https://stackoverflow.com/users/4173591/vbvirg20"}, "edited": false, "score": 0, "creation_date": 1490887912, "post_id": 43101358, "comment_id": 73323689, "body": "For some reason the teal just would not work so i used the following."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1491312827, "last_edit_date": 1491312827, "creation_date": 1490812140, "answer_id": 43101358, "question_id": 43100830, "link": "https://stackoverflow.com/questions/43100830/ms-project-find-strings-in-text10-and-change-font-color/43101358#43101358", "title": "MS (Project) Find Strings in text10 and change font color", "body": "<p>Change:</p>\n\n<pre><code>If ActiveSelection.Tasks(1).Text10 = (\"David\") &amp; (\"Darren\") Then\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>If ActiveSelection.Tasks(1).Text10 = \"David\" Or ActiveSelection.Tasks(1).Text10 = \"Darren\" Then\n</code></pre>\n\n<hr>\n\n<p><strong>Edit 1:</strong> Better style of coding (untested as I don't have MS-Project installed at home - can test it tomorrow morning)</p>\n\n<pre><code>Option Explicit\n\nSub text()\n\nViewApply \"Gantt Chart\"\nOutlineShowAllTasks\nFilterApply \"All Tasks\"\n\nDim T As Task\n\nFor Each T In ActiveProject.Tasks\n    If Not T Is Nothing Then\n        SelectRow T.UniqueID, RowRelative:=False '&lt;-- there's no escape, in Ms-Project you need to select the Task's row in order to modify it's Font color\n        If T.Text10 = \"David\" Or T.Text10 = \"Darren\" Then\n            Font Color:=pjTeal\n        Else\n            Select Case T.PercentComplete\n                Case 100\n                    Font Color:=pjGreen\n                Case 0\n                    Font Color:=pjBlack\n                Case Else\n                    Font Color:=pjBlue\n            End Select\n        End If\n    End If\nNext T\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h1>Edit 2: added a new logics for added information by PO.</h1>\n\n<pre><code>Option Explicit\n\nSub ColorTasks()\n\nViewApply \"Gantt Chart\"\nOutlineShowAllTasks\nFilterApply \"All Tasks\"\n\nDim T As Task\n\nFor Each T In ActiveProject.Tasks\n    If Not T Is Nothing Then\n        SelectRow T.ID, RowRelative:=False\n\n        Select Case T.Text10\n            Case \"David\"\n                 Font Color:=pjBlue\n            Case \"Mary\"\n                Font Color:=pjTeal\n            Case \"Bill\"\n                Font Color:=pjBlack\n            Case \"Sandra\"\n                Font Color:=pjPurple\n        End Select\n\n        ' I think you wanted this outside the case of the people in Text10\n        If T.PercentComplete = 100 Then\n            Font Color:=pjGreen\n        Else\n            If DateDiff(\"d\", T.Finish, ActiveProject.CurrentDate) &gt; 0 Then\n                Font Color:=pjRed\n            End If\n        End If\n    End If\nNext T\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 4173591, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f44d24d475b5206c26c7158e44d9388c?s=128&d=identicon&r=PG&f=1", "display_name": "vbvirg20", "link": "https://stackoverflow.com/users/4173591/vbvirg20"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491229707, "post_id": 43122470, "comment_id": 73447706, "body": "The code is working with exeption of being able to highlight the font as red if todays date is great than the finish date and the percentage complete is less than 100.  I would be very grateful if you could assist with that or point me somewhere where i can work it out please?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491312864, "post_id": 43122470, "comment_id": 73489015, "body": "Try the code under <b>EDIT 2</b> in my answer above - I think this is what you wanted"}, {"owner": {"reputation": 113, "user_id": 4173591, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f44d24d475b5206c26c7158e44d9388c?s=128&d=identicon&r=PG&f=1", "display_name": "vbvirg20", "link": "https://stackoverflow.com/users/4173591/vbvirg20"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491380689, "post_id": 43122470, "comment_id": 73521448, "body": "That works like a dream, many thanks for your help i was going insane trying to get it to work.  Kind Regards VBvirg20"}], "tags": [], "owner": {"reputation": 113, "user_id": 4173591, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f44d24d475b5206c26c7158e44d9388c?s=128&d=identicon&r=PG&f=1", "display_name": "vbvirg20", "link": "https://stackoverflow.com/users/4173591/vbvirg20"}, "is_accepted": false, "score": 0, "last_activity_date": 1490888603, "creation_date": 1490888603, "answer_id": 43122470, "question_id": 43100830, "link": "https://stackoverflow.com/questions/43100830/ms-project-find-strings-in-text10-and-change-font-color/43122470#43122470", "title": "MS (Project) Find Strings in text10 and change font color", "body": "<pre><code>Sub test()\n\nDim Ctr As Integer\n\nViewApply \"Gantt Chart\"\nOutlineShowAllTasks\nFilterApply \"All Tasks\"\nSelectAll\nFor Ctr = 1 To ActiveSelection.Tasks.Count\n    SelectRow Row:=Ctr, rowrelative:=False\n    If Not ActiveSelection.Tasks(1) Is Nothing Then\n        If ActiveSelection.Tasks(1).Text10 = \"David\" Then\n            Font Color:=pjBlue\n        Else\n        If ActiveSelection.Tasks(1).Text10 = \"Mary\" Then\n            Font Color:=pjTeal\n        Else\n        If ActiveSelection.Tasks(1).Text10 = \"Bill\" Then\n            Font Color:=pjBlack\n        Else\n        If ActiveSelection.Tasks(1).Text10 = \"Sandra\" Then\n            Font Color:=pjPurple\n        Else\n        If ActiveSelection.Tasks(1).PercentComplete = 100 Then\n            Font Color:=pjGreen\n        Else    \n        If ActiveSelection.Tasks(1).finish &lt; currentdate Then \n            Font Color:=pjRed\n        End If\n        End If\n        End If\n        End If\n        End If\n        End If\n        End If\n    Next Ctr\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 4173591, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f44d24d475b5206c26c7158e44d9388c?s=128&d=identicon&r=PG&f=1", "display_name": "vbvirg20", "link": "https://stackoverflow.com/users/4173591/vbvirg20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 43101358, "answer_count": 2, "score": 2, "last_activity_date": 1593559379, "creation_date": 1490810402, "last_edit_date": 1593559379, "question_id": 43100830, "link": "https://stackoverflow.com/questions/43100830/ms-project-find-strings-in-text10-and-change-font-color", "title": "MS (Project) Find Strings in text10 and change font color", "body": "<p>I'm changing the color of font in MS Project based on Percentage complete and Names in text10 column.  The percentages work however can someone give me a steer on the names I would be grateful, I want to highlight in teal if for example \"David\" or \"Darren\" or both are in <code>Text10</code> field. </p>\n\n<p>Any help gratefully received. </p>\n\n<pre><code>Sub text()\n\nDim Ctr As Integer\n\nViewApply \"Gantt Chart\"\nOutlineShowAllTasks\nFilterApply \"All Tasks\"\nSelectAll\n\nFor Ctr = 1 To ActiveSelection.Tasks.Count\n    SelectRow Row:=Ctr, rowrelative:=False\n    If Not ActiveSelection.Tasks(1) Is Nothing Then\n        If ActiveSelection.Tasks(1).Text10 = (\"David\") &amp; (\"Darren\") Then\n            Font Color:=pjTeal\n        Else\n            If ActiveSelection.Tasks(1).PercentComplete = 100 Then\n                Font Color:=pjGreen\n            Else\n                If ActiveSelection.Tasks(1).PercentComplete = 0 Then\n                    Font Color:=pjBlack\n                Else\n                    If ActiveSelection.Tasks(1).PercentComplete &gt; 0 &lt; 100 Then\n                        Font Color:=pjBlue\n                    Else\n                    End If\n                End If\n            End If\n        End If\n    End If\nNext Ctr\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1490810365, "post_id": 43100778, "comment_id": 73283328, "body": "<code>wb.SaveAs &quot;C:\\workspace\\1. Sem-1 Accounts\\macrotest1&quot; &amp; i &amp; &quot;.xlsx&quot;</code> ought to do the trick."}], "owner": {"reputation": 11, "user_id": 7787533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b76b70ba5ed91ab4eb4f059f9395e16?s=128&d=identicon&r=PG&f=1", "display_name": "abishekviyer", "link": "https://stackoverflow.com/users/7787533/abishekviyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490810174, "creation_date": 1490810174, "last_edit_date": 1531164843, "question_id": 43100778, "link": "https://stackoverflow.com/questions/43100778/excel-vba-generating-a-set-of-30-invoices-with-different", "title": "Excel VBA generating a set of 30 invoices with different", "body": "<p>I have a simple question. I have an excel file with an invoice format being linked to around 30 odd invoice details from a table in a different sheet. I have already devised a macro to save each iteration as a separate excel file. But i want the 'filename' to be automated. For eg, if i select to print invoices for records 1-15, filenames should be saved as 1,2,3 and so on. The existing code is as follows - </p>\n\n<pre><code>Sub PrintForms()\nDim StartRow As Integer\nDim EndRow As Integer\nDim Msg As String\nDim i As Integer\n\nSheets(\"Invoice\").Activate\nStartRow = Range(\"StartRow\")\nEndRow = Range(\"EndRow\")\n\nIf StartRow &gt; EndRow Then\n    Msg = \"ERROR\" &amp; vbCrLf &amp; \"The starting row must be less than the ending row!\"\n    MsgBox Msg, vbCritical, APPNAME\nEnd If\n\nFor i = StartRow To EndRow\n    Range(\"rowindex\") = i\n    If Range(\"Preview\") Then\n            Dim wb As Workbook\n            Set wb = Workbooks.Add\n            ThisWorkbook.Sheets(\"Invoice\").Copy Before:=wb.Sheets(1)\n            wb.SaveAs \"C:\\workspace\\1. Sem-1 Accounts\\macrotest1.xlsx\"\n    Else\n        ActiveSheet.PrintOut\n    End If\nNext i\nEnd Sub\n\nSub EditData()\nWorksheets(\"Invoice Format\").Activate\nRange(\"A1\").Select\nEnd Sub\n\nSub ReturnToForm()\nWorksheets(\"Invoice\").Activate\nRange(\"rowindex\").Select\nEnd Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1490813034, "post_id": 43101002, "comment_id": 73284931, "body": "Nice answer! Nothing to add! ;-)"}, {"owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "edited": false, "score": 0, "creation_date": 1490813704, "post_id": 43101002, "comment_id": 73285355, "body": "Very clear, thanks a lot for your prompt help. Highly appreciated! It works perfectly now."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 3, "last_activity_date": 1490812965, "last_edit_date": 1490812965, "creation_date": 1490810929, "answer_id": 43101002, "question_id": 43100696, "link": "https://stackoverflow.com/questions/43100696/add-collection-as-an-item-within-another-collection-class-excel-vba/43101002#43101002", "title": "Add Collection as an item within another collection - Class - Excel VBA", "body": "<p>You are missing a <code>Get TestC1B</code> property in your <code>Class1</code> class module: </p>\n\n<pre><code>Property Get TestC1B() As Collection\n    Set TestC1B = pTestC1B\nEnd Property\n</code></pre>\n\n<p>Once that is present you will be able to make calls to <code>col1(1).TestC1B(1)</code> and access it's <code>.TestC2A</code> property</p>\n\n<hr>\n\n<p><em>Background</em></p>\n\n<p>You did the right thing by using private variables in your classes and using properties to give read/write access to your private variables. You'll get a lot more control this way.</p>\n\n<p>Property <code>Get</code> gives read access to that property (and broadly speaking, the underlying private variable). For example you can use <code>Range.Address</code> to return (<em>read</em>) the address of a range object.</p>\n\n<p>Property <code>Let</code> and <code>Set</code> give write access to the property. Use <code>Set</code> for objects. For example <code>Range.Value = 1</code> will <em>write</em> the new value to the range. </p>\n\n<p>Consider, <code>Range.Address = $A$1</code>. Since there is no <code>Property Set</code> for the address of a range, this will not change the address of the range. It will consider the <code>Range.Address</code> part a <code>Get</code> call and evaluate something like <code>$A$1 = $A$1</code> returning <code>TRUE</code> in this example </p>\n"}], "owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 0, "accepted_answer_id": 43101002, "answer_count": 1, "score": 2, "last_activity_date": 1490812965, "creation_date": 1490809944, "last_edit_date": 1490811100, "question_id": 43100696, "link": "https://stackoverflow.com/questions/43100696/add-collection-as-an-item-within-another-collection-class-excel-vba", "title": "Add Collection as an item within another collection - Class - Excel VBA", "body": "<p>I'm currently trying to build a collection of items wherein a collection might contain an another collection as an Item within.</p>\n\n<p>I've set two collections and created a class module for each:\ncol1 - (linked to Class1); and col2 - (linked to Class2)</p>\n\n<p>Below are my Class Modules:</p>\n\n<p><strong>Class1:</strong></p>\n\n<pre><code>Option Explicit\nPrivate pTestC1A As String\nPrivate pTestC1B As Collection\n\nPublic Property Let TestC1A(Value As String)\npTestC1A = Value\nEnd Property\n\nPublic Property Get TestC1A() As String\nTestC1A = pTestC1A\nEnd Property\n\nProperty Set TestC1B(col2 As Collection)\nSet pTestC1B = col2\nEnd Property\n\nProperty Get TestC1BElements(v As Integer) As String\n    TestC1B = pTestC1B(v)\nEnd Property\n</code></pre>\n\n<p><strong>Class2:</strong></p>\n\n<pre><code>Option Explicit\nPrivate pTestC2A  As String\n\nPublic Property Let TestC2A(Value As String)\npTestC2A = Value\nEnd Property\n\nPublic Property Get TestC2A() As String\nTestC2A = pTestC2A\nEnd Property\n</code></pre>\n\n<p>Below is my <strong>Module</strong> code</p>\n\n<pre><code>Sub Test()\n\nSet col1 = New Collection\nSet col2 = New Collection\n\nSet cV = New Class1\ncV.TestC1A = \"First Collection\"\n\nSet aV = New Class2\naV.TestC2A = \"Second Collection\"\nsKey1 = CStr(aV.TestC2A)\ncol2.Add aV, sKey1\n\nSet cV.TestC1B = col2\n\nsKey2 = CStr(cV.TestC1A)\ncol1.Add cV, sKey2\n    If Err.Number = 457 Then\n      MsgBox \"Error Occured\"\n    ElseIf Err.Number &lt;&gt; 0 Then Stop\n    End If\n    Err.Clear\n\nMsgbox col1(1).TestC1A ' works fine\nMsgbox col2(1).TestC2A ' works file  \nMsgBox col1(1).TestC1B(1).TestC2A ' does not work - 450 run-time error\n\nEnd Sub\n</code></pre>\n\n<p>As per the above code, I'm successfully able to get the values of the items if I reference each collection respectively, however I'm getting a <em>\"Wrong number of arguments or invalid property assignment\"</em> run-time error if I try to get the item value in a nested fashion.</p>\n\n<p>It would be appreciated if someone can help point out where I'm going wrong, and perhaps shed some light on the way the class module handles the Property Set &amp; Get parameters for a collection.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 29, "user_id": 4638680, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5b7a10859e152baa23eed6be99d5b8df?s=128&d=identicon&r=PG&f=1", "display_name": "schalld", "link": "https://stackoverflow.com/users/4638680/schalld"}, "edited": false, "score": 0, "creation_date": 1490809908, "post_id": 43100490, "comment_id": 73283058, "body": "triplestate is yes"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1490814824, "post_id": 43100490, "comment_id": 73286101, "body": "Half your code does nothing and the other half is wrong, and it is all unbelievably messy. On top of all that, checkboxes do not have <code>String</code> type values."}, {"owner": {"reputation": 29, "user_id": 4638680, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5b7a10859e152baa23eed6be99d5b8df?s=128&d=identicon&r=PG&f=1", "display_name": "schalld", "link": "https://stackoverflow.com/users/4638680/schalld"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1490818904, "post_id": 43100490, "comment_id": 73288408, "body": "that is not very helpful"}, {"owner": {"reputation": 346, "user_id": 6524338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sje7.png?s=128&g=1", "display_name": "billyhoes", "link": "https://stackoverflow.com/users/6524338/billyhoes"}, "edited": false, "score": 0, "creation_date": 1490823491, "post_id": 43100490, "comment_id": 73290829, "body": "You have .ControlSource = string values, but no context. You have a bunch of commented out code which makes parsing difficult.  You are setting you string variable FieldValue to &quot;&quot; initially, then assigning it to the value of your checkbox which would be -1, 0 (datatype mismatch) if it isn&#39;t null (which will produce a different error since the one-option if/then/else check statement is commented out), and then checking it against &quot;N&quot;, &quot;Y&quot;, and Null which are values that FieldValue will never be. Clean it up and clarify what you&#39;re trying to do and maybe someone can help.  Good luck!"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1490861566, "post_id": 43100490, "comment_id": 73304168, "body": "A Yes/No type field cannot have Null. A Yes/No field has only 1 of two states - 0 or -1 (Yes/No, True/False). So checkbox bound to Yes/No field cannot be set for triple state."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1490978563, "post_id": 43100490, "comment_id": 73368844, "body": "@June7 helped me with this the other day.  I created an unbound checkbox and then updated the field after.  If you need a triple state value, then use an integer type, and assign the value of the checkbox control to that field after updating."}], "owner": {"reputation": 29, "user_id": 4638680, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5b7a10859e152baa23eed6be99d5b8df?s=128&d=identicon&r=PG&f=1", "display_name": "schalld", "link": "https://stackoverflow.com/users/4638680/schalld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490809182, "creation_date": 1490809182, "question_id": 43100490, "link": "https://stackoverflow.com/questions/43100490/check-box-not-working-with-null", "title": "check box not working with null", "body": "<p>i am using a checkbox with a Null, N , Y field it doesnt appear to be working. I don't seem to be able to uncheck it.  here is my code, any help thank you in advance.  Also, the beforeupdate never fires</p>\n\n<pre><code>Private Sub Chk_Complete_BeforeUpdate(Cancel As Integer)\nMsgBox Chk_Complete.Value\nEnd Sub\n\nPrivate Sub Chk_Complete_Click()\nDim FieldValue  As String\n''\nMe.Chk_Complete.ControlSource = \"Complete\"\nFieldValue = \"\"\nIf Me.Chk_Complete.ControlSource = \"\" Then\n    End\nEnd If\n'\n'If IsNull(Me.Chk_Complete.Value) Then\n'Else\n    FieldValue = Me.Chk_Complete.Value\n'End If\n'\nMe.Chk_Complete.ControlSource = \"\"\nSelect Case FieldValue\nCase \"N\"\nMe.Chk_Complete = 0\nCase \"Y\"\nMe.Chk_Complete = -1\nCase Null\nMe.Chk_Complete = 0\nEnd Select\n'Me.Chk_Complete = FieldValue\nEnd Sub\n\nPrivate Sub Chk_Complete_GotFocus()\n\nDim FieldValue  As String\n\n''\nMe.Chk_Complete.ControlSource = \"Complete\"\nFieldValue = \"\"\nIf Me.Chk_Complete.ControlSource = \"\" Then\n    End\nEnd If\n'\n'If IsNull(Me.Chk_Complete.Value) Then\n'Else\n   FieldValue = Me.Chk_Complete.Value\n'End If\nMe.Chk_Complete.ControlSource = \"\"\nMe.Chk_Complete = FieldValue\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "edited": false, "score": 0, "creation_date": 1490810045, "post_id": 43100588, "comment_id": 73283145, "body": "Thanks @Jeeped. I knew it was a simple fix. I can&#39;t believe I missed the name method!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "edited": false, "score": 0, "creation_date": 1490810234, "post_id": 43100588, "comment_id": 73283254, "body": "@BWMustang13 technically <code>Name</code> is a <i>property</i>, not a method ;-)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1490809517, "creation_date": 1490809517, "answer_id": 43100588, "question_id": 43100363, "link": "https://stackoverflow.com/questions/43100363/how-to-use-address-function-in-excel-vba/43100588#43100588", "title": "How to use address function in Excel VBA?", "body": "<p>Did you rename your worksheets? You cannot use a codename in a worksheet formula but you can retrieve the name from the codename.</p>\n\n<pre><code>Sheet7.Cells(3, i).Formula = _\n   \"='\" &amp; Sheet6.Name &amp; \"'!\" &amp; bSpr.Address() &amp; \"*'\" &amp; Sheet7.Name &amp; \"'!\" &amp; bSpr.Address()\n</code></pre>\n\n<p>I've added wrapping single quotes to the worksheet names in case they contain spaces; there is no detriment if they do not.</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1490809604, "creation_date": 1490809604, "answer_id": 43100611, "question_id": 43100363, "link": "https://stackoverflow.com/questions/43100363/how-to-use-address-function-in-excel-vba/43100611#43100611", "title": "How to use address function in Excel VBA?", "body": "<p>I'd go as follows</p>\n\n<pre><code>With Sheet7\n    With .Range(\"CU2\")\n        colCount = .Range(.Cells, .End(xlToRight)).Columns.Count\n    End With\n\n    startCount = 98\n\n    For i = 1 To colCount\n\n        If IsNumeric(.Cells(2, startCount + i)) Then\n            Set bSum = .Cells(3, colCount + startCount)\n            Set bSpr = Sheet6.Cells(3, startCount + i)\n\n            .Cells(3, i).Formula = \"=\" &amp; Sheet6.Name &amp; \"!\" &amp; bSpr.Address() &amp; \"*\" &amp; .Name &amp; \"!\" &amp; bSpr.Address()\n\n        Else\n            'Do some stuff\n        End If\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1319, "favorite_count": 0, "accepted_answer_id": 43100588, "answer_count": 2, "score": 1, "last_activity_date": 1490809604, "creation_date": 1490808813, "question_id": 43100363, "link": "https://stackoverflow.com/questions/43100363/how-to-use-address-function-in-excel-vba", "title": "How to use address function in Excel VBA?", "body": "<p>I am trying to use VBA to dynamically add a formula to a few cells using the address function. When I run the following scripts I get a file explorer window that opens. I am not sure why that happens. What am I doing wrong?</p>\n\n<p>Here is one of the solutions I tried:</p>\n\n<pre><code>Sub AddFormulas()\n\nSet countBase = Sheet7.Range(\"CU2\")\ncolCount = Sheet7.Range(countBase, countBase.End(xlToRight)).Columns.Count\n\nDim startCount As Integer\nstartCount = 98\n\n    For i = 1 To colCount\n\n        If IsNumeric(Sheet7.Cells(2, startCount + i)) Then\n            Set bSum = Sheet7.Cells(3, colCount + startCount)\n            Set bSpr = Sheet6.Cells(3, startCount + i)\n\n            Sheet7.Cells(3, i).Formula = \"=Sheet6!\" &amp; bSpr.Address() &amp; \"*\" &amp; \"Sheet7!\" &amp; bSpr.Address()\n\n         Else\n            'Do some stuff\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I also tried this:</p>\n\n<pre><code>Sub AddFormulas()\n\nSet countBase = Sheet7.Range(\"CU2\")\ncolCount = Sheet7.Range(countBase, countBase.End(xlToRight)).Columns.Count\n\nDim startCount As Integer\nstartCount = 98\n\n    For i = 1 To colCount\n\n        If IsNumeric(Sheet7.Cells(2, startCount + i)) Then\n\n            Sheet7.Cells(3, i).Formula = \"=Sheet6!\" &amp; Cells(3, startCount + i).Address() &amp; \"*\" &amp; \"Sheet7!\" &amp; Cells(3, colCount + startCount).Address() \n\n         Else\n            'Do some stuff\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-office"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1490810108, "creation_date": 1490810108, "answer_id": 43100752, "question_id": 43100316, "link": "https://stackoverflow.com/questions/43100316/position-textbox-in-chart-in-excel-to-the-top-left-4/43100752#43100752", "title": "Position TextBox in Chart in Excel to the top / left -4", "body": "<p>Seems like you can't set Top/Left to negative numbers.</p>\n\n<p>But you <em>can</em> increment the position to achieve that:</p>\n\n<pre><code>Sub TextBoxPositionUpperLeftCorner()\nDim cho As ChartObject\nDim sh As Shape\n\nFor Each cho In ActiveSheet.ChartObjects\n    For Each sh In cho.Chart.Shapes\n\n        'reading out the position\n        Debug.Print \"Top: \" &amp; sh.Top\n        Debug.Print \"Left: \" &amp; sh.Left\n\n        sh.IncrementTop -(sh.Top + 4)\n        sh.IncrementLeft -(sh.Left + 4)\n\n         'reading out the position\n        Debug.Print \"Top: \" &amp; sh.Top\n        Debug.Print \"Left: \" &amp; sh.Left\n\n    Next\nNext\n</code></pre>\n\n<p><strong>EDIT:</strong> after a little more testing, <em>the most negative you can go</em> even with this approach is -4/-4.  </p>\n"}], "owner": {"reputation": 100, "user_id": 7176707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6174776c4dbfbb74d21e08c4ccae1a9b?s=128&d=identicon&r=PG&f=1", "display_name": "JackTheFruit", "link": "https://stackoverflow.com/users/7176707/jackthefruit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "accepted_answer_id": 43100752, "answer_count": 1, "score": 1, "last_activity_date": 1490810108, "creation_date": 1490808663, "last_edit_date": 1531164843, "question_id": 43100316, "link": "https://stackoverflow.com/questions/43100316/position-textbox-in-chart-in-excel-to-the-top-left-4", "title": "Position TextBox in Chart in Excel to the top / left -4", "body": "<p>I have a chart in excel. Inside this chart there is a textbox. I want to position this textbox to the upper left corner of the chart.</p>\n\n<p>When I do this manually and read out the properties <code>.Top</code> and <code>.Left</code> I get <code>-4</code> as a response.</p>\n\n<p>If I try setting these two properties to <code>-4</code> the textbox goes to positions <code>0</code> and not <code>-4</code>. \nWhy cant I position the texbox to the upper left corner of the chart? \nIs here some outer margin of the textbox or an inner margin of the chart / chartarea? </p>\n\n<p>Here is some code to test it with any chart, in which you inserted a textbox:</p>\n\n<pre><code>Sub TextBoxPositionUpperLeftCorner()\n    Dim cho As ChartObject\n    Dim sh As Shape\n\n    For Each cho In ActiveSheet.ChartObjects\n        For Each sh In cho.Chart.Shapes\n\n            'reading out the position\n            Debug.Print \"Top: \" &amp; sh.Top\n            Debug.Print \"Left: \" &amp; sh.Left\n\n            'setting the position\n            sh.Top = -4\n            sh.Left = -4\n\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6351497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a68437a7832a35dc8b644f5e68352d9?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Wilson", "link": "https://stackoverflow.com/users/6351497/brad-wilson"}, "edited": false, "score": 0, "creation_date": 1490823654, "post_id": 43101973, "comment_id": 73290888, "body": "I tried both sub listed above. Each one gave me a pop up with the store changing each time. But nothing updated, i needed to hit &quot;Ok&quot; 40 times to get through all of the locations. I ran this on a test file that was only looking at one file per location. If I had ran it on the master file I believe that it would of required me to select &quot;OK&quot; for ever location and ever link within the file. Looking for a way for the file to ask which file needs to be updated."}, {"owner": {"reputation": 2003, "user_id": 6414203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b25f1c657b4306a0d459c874e859789?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6414203/alan"}, "reply_to_user": {"reputation": 1, "user_id": 6351497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a68437a7832a35dc8b644f5e68352d9?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Wilson", "link": "https://stackoverflow.com/users/6351497/brad-wilson"}, "edited": false, "score": 0, "creation_date": 1490894756, "post_id": 43101973, "comment_id": 73328185, "body": "The examples are provided <i>as examples</i>. You are meant to adapt the code for your own purposes. Links to the official documentation has been provided for you to follow up on. You asked how to update links - answered. You asked how to test for which links need to be updated - answered. If you now also want to know how to get user input, there are many different ways to do this, and would be question 3 of 3 - which I have already partially answered in the second part of my answer by showing you how to build a test string."}, {"owner": {"reputation": 2003, "user_id": 6414203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b25f1c657b4306a0d459c874e859789?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6414203/alan"}, "reply_to_user": {"reputation": 1, "user_id": 6351497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a68437a7832a35dc8b644f5e68352d9?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Wilson", "link": "https://stackoverflow.com/users/6351497/brad-wilson"}, "edited": false, "score": 0, "creation_date": 1490895311, "post_id": 43101973, "comment_id": 73328518, "body": "For example, you could have the location stored in a cell in a worksheet, in which case My_file_name would point to a cell reference. You could include a form control in a worksheet, in which case the variable would point to the control. You could use an inputbox (similar to the msgbox in the example) to pop-up and get the name. On-the-fly user interaction is a complex issue and you need to be very specific as to how you are looking to achieve this."}], "tags": [], "owner": {"reputation": 2003, "user_id": 6414203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b25f1c657b4306a0d459c874e859789?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6414203/alan"}, "is_accepted": false, "score": 0, "last_activity_date": 1490813984, "creation_date": 1490813984, "answer_id": 43101973, "question_id": 43100258, "link": "https://stackoverflow.com/questions/43100258/how-do-you-update-links-in-excel-based-on-specific-text-in-the-link-using-vba/43101973#43101973", "title": "How do you update links in excel based on specific text in the link using VBA?", "body": "<p>These two subroutines below show you how to view / manipulate links in a file.\nThe key part you are looking for is <code>ActiveWorkbook.LinkSources(xlExcelLinks)</code> to get an array with the list of links, and <code>ActiveWorkbook.ChangeLink</code> to ... change the link.</p>\n\n<pre><code>Sub gen_links()\naLinks = ActiveWorkbook.LinkSources(xlExcelLinks)\nIf Not IsEmpty(aLinks) Then\n    For i = 1 To UBound(aLinks)\n        MsgBox \"Link \" &amp; i &amp; \":\" &amp; Chr(13) &amp; aLinks(i)\n    Next i\nEnd If\nEnd Sub\n\nSub swap_links1()\naLinks = ActiveWorkbook.LinkSources(xlExcelLinks)\nIf Not IsEmpty(aLinks) Then\n    For i = 1 To UBound(aLinks)\n    If aLinks(i) = \"C:\\tests\\2017(1)\\Test1.xlsx\" Then\n        ActiveWorkbook.ChangeLink \"C:\\tests\\2017(1)\\Test1.xlsx\", \"C:\\tests\\2017(2)\\Test2.xlsx\", xlExcelLinks\n    End If\n    If aLinks(i) = \"C:\\tests\\2017(2)\\Test2.xlsx\" Then\n        ActiveWorkbook.ChangeLink \"C:\\tests\\2017(2)\\Test2.xlsx\", \"C:\\tests\\2017(1)\\Test1.xlsx\", xlExcelLinks\n    End If\n    MsgBox \"Link \" &amp; i &amp; \":\" &amp; Chr(13) &amp; aLinks(i)\n    Next i\nEnd If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff836537.aspx\" rel=\"nofollow noreferrer\">ChangeLink documentation</a><br>\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff821922.aspx\" rel=\"nofollow noreferrer\">LinkSources documentation</a></p>\n\n<p>You can utilise this by building an if-test for every possible option, or more sensibly, creating a variable and doing an if-not-test. E.g.</p>\n\n<pre><code>My_Store_Name = \"Store 1\"\nMy_Year_Name = \"2017\"\nMy_File_Name = \"04_01_17\"\nMy_Test_file = My_Store_Name &amp; \"\\Schedules\\\"  &amp; My_Year_Name &amp; \"\\\" &amp; My_File_Name &amp; \".xlxb\"\nIf aLinks(i) &lt;&gt; My_Test_file Then\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6351497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a68437a7832a35dc8b644f5e68352d9?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Wilson", "link": "https://stackoverflow.com/users/6351497/brad-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490813984, "creation_date": 1490808498, "last_edit_date": 1490812812, "question_id": 43100258, "link": "https://stackoverflow.com/questions/43100258/how-do-you-update-links-in-excel-based-on-specific-text-in-the-link-using-vba", "title": "How do you update links in excel based on specific text in the link using VBA?", "body": "<p>How do you update links in excel based on specific text in the link using VBA?\nUsing Office 2016</p>\n\n<p>I have 40 locations with independent servers for each location.</p>\n\n<p>All of the file names are the same at each location and saved in the same folder with only the location name being different.</p>\n\n<p>For example: </p>\n\n<pre><code>Store 1\\Schedules\\2017\\04_01_17.xlxb\nStore 2\\Schedules\\2017\\04_01_17.xlxb\nStore 3\\Schedules\\2017\\04_01_17.xlxb\n</code></pre>\n\n<p>Each location has a schedule for each week of the year as well as several previous years.</p>\n\n<p>The issue is that the Master recap file that reaches out to each one of these files has to be manipulated currently by editing links one at a time if I wanted to retrieve data for only the 04_01_17 week.</p>\n\n<p>If the entire file was to be enabled it would pull every linked file for the entire year and several previous years and take hours to complete.</p>\n\n<p>What I was looking for was VBA code that would ask for text that is contained in the link and would pull all files that matched. </p>\n\n<p>For Example</p>\n\n<pre><code>\"Contains\" \nAnswer=04_01_17\n</code></pre>\n\n<p>Thanks in Advance</p>\n\n<p>Brad</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490849218, "post_id": 43100012, "comment_id": 73297879, "body": "have you read my answer and code below ? any feedback ?"}, {"owner": {"reputation": 3, "user_id": 7787226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7a67a281035cb8d12cb5c62f40b8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Hepk1211", "link": "https://stackoverflow.com/users/7787226/hepk1211"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490890132, "post_id": 43100012, "comment_id": 73325194, "body": "yes, It work now. But I didn&#39;t use     res as you have in your code. Thanks alot."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490890934, "post_id": 43100012, "comment_id": 73325756, "body": "Then please mark as &quot;ANSWER&quot; by clicking on the check-mark next to my answer, it will turn green"}, {"owner": {"reputation": 3, "user_id": 7787226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7a67a281035cb8d12cb5c62f40b8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Hepk1211", "link": "https://stackoverflow.com/users/7787226/hepk1211"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490896443, "post_id": 43100012, "comment_id": 73329148, "body": "why the match function sometime is work but sometime is not?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490897141, "post_id": 43100012, "comment_id": 73329559, "body": "it depends how the values you are looking for formatted, in your case with very long numbers stored as text, it can get tricky. You can edit your post and add a screen shot of the data you are trying toMatch with"}, {"owner": {"reputation": 3, "user_id": 7787226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7a67a281035cb8d12cb5c62f40b8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Hepk1211", "link": "https://stackoverflow.com/users/7787226/hepk1211"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490933823, "post_id": 43100012, "comment_id": 73342636, "body": "have you seen my data? what do you think?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7787226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7a67a281035cb8d12cb5c62f40b8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Hepk1211", "link": "https://stackoverflow.com/users/7787226/hepk1211"}, "edited": false, "score": 0, "creation_date": 1490955567, "post_id": 43100535, "comment_id": 73353343, "body": "this solution could answer my problem, but sometimes I still get error for <code>match</code> function."}, {"owner": {"reputation": 3, "user_id": 7787226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7a67a281035cb8d12cb5c62f40b8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Hepk1211", "link": "https://stackoverflow.com/users/7787226/hepk1211"}, "edited": false, "score": 0, "creation_date": 1491026880, "post_id": 43100535, "comment_id": 73383309, "body": "I found the problem actually with <code>countif</code> function, which only read 15 characters. When I use that function to find the data on collum H, <code>countif</code> find it on column G, thats where the <code>match</code> function become error. Any suggestion to fix it?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 7787226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7a67a281035cb8d12cb5c62f40b8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Hepk1211", "link": "https://stackoverflow.com/users/7787226/hepk1211"}, "edited": false, "score": 0, "creation_date": 1491030178, "post_id": 43100535, "comment_id": 73384061, "body": "@Hepk1211 let&#39;s do this, open a new post, put your screen-shot of your data, add you modified code, and describe what is the issue - this will allow other users (besides me) to assist you."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1490809318, "creation_date": 1490809318, "answer_id": 43100535, "question_id": 43100012, "link": "https://stackoverflow.com/questions/43100012/index-match-function-doesnt-recognize-texted-format-cell/43100535#43100535", "title": "Index, match function doesn&#39;t recognize texted format cell", "body": "<p>Try the code below (explanation inside the code comments):</p>\n\n<pre><code>Option Explicit\n\nSub IndexMatchConv()\n\nDim b As String\nDim Res As Variant\n\n' for my test format and set a value with 21 digits as Text in cell \"G2\"\nSheet2.Range(\"G2\").NumberFormat = \"@\" ' format as Text\nSheet2.Range(\"G2\").Value = \"123456789112233445566\"\nb = Sheet2.Range(\"G2\").Value\nMsgBox Len(b) ' &lt;-- result 21\n\nWith Application.WorksheetFunction\n    Res = .CountIf(Sheet2.Range(\"G:G\"), b)\n    If .CountIf(Sheet2.Range(\"G:G\"), b) = 1 Then\n        Res = .Match((b), Sheet2.Range(\"G:G\"), 0) &lt; --Res = 2\n        'TxtCVId.Text = .Index(Sheet2.Range(\"A:A\"), .Match((b), Sheet2.Range(\"G:G\"), 0))\n    Else\n        ' do something\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7787226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7a67a281035cb8d12cb5c62f40b8ef?s=128&d=identicon&r=PG&f=1", "display_name": "Hepk1211", "link": "https://stackoverflow.com/users/7787226/hepk1211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 43100535, "answer_count": 1, "score": 0, "last_activity_date": 1490898641, "creation_date": 1490807721, "last_edit_date": 1531164843, "question_id": 43100012, "link": "https://stackoverflow.com/questions/43100012/index-match-function-doesnt-recognize-texted-format-cell", "title": "Index, match function doesn&#39;t recognize texted format cell", "body": "<p>I have <code>TextBox</code> which contain number over 15 digits. When I copy the textbox value into excel cell, starting from digit 15th excel will change it zero number. This is Excel's way if cell format as number. I change the cell format from number to text, and input manually the number, and its work.</p>\n\n<p>But when I use <code>Index</code>, <code>Match</code> function on macros, it doesn't work and I get</p>\n\n<blockquote>\n  <p>Run-time error 1004 \"Unable to get match property of the\n  WorksheetFunction class</p>\n</blockquote>\n\n<p>This is the code I use for index, match function</p>\n\n<pre><code>Dim b As Double\n\nb = TxtCvNo.Text\n\nWith Application.WorksheetFunction    \n    If .CountIf(Sheet2.Range(\"G:G\"), b) = 1 Then    \n        TxtCVId.Text = .Index(Sheet2.Range(\"A:A\"), .Match((b), Sheet2.Range(\"G:G\"), 0))     \n    Else\n</code></pre>\n\n<p><code>b</code> is the <code>TextBox</code> value.</p>\n\n<p><code>Match</code> function doesn't recognize <code>b</code> as this value were input as 'text' in Excel cell</p>\n\n<p>How can I copy the textbox value into cell as text to avoid digit 15th, 16th and so on change to zero. How can I fix the index, match function after it.</p>\n\n<p>this screen shot of my Data. I use <code>Index</code> and <code>Match</code> to identify whether the coupon 1,2,3 has been use as coupon ref, and then tell me the ID Respondent use that Coupon.\n<a href=\"https://i.stack.imgur.com/umysW.png\" rel=\"nofollow noreferrer\">screen shot data</a></p>\n"}, {"tags": ["mysql", "vba", "ms-access", "odbc", "runtime"], "comments": [{"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490813495, "post_id": 43099982, "comment_id": 73285226, "body": "if you only want to give the user ReadOnly privilege to that table then open the recordset as a snapshot <code>dbs.openrecordset(stSQL1, dbopensnapshot)</code>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1490837586, "post_id": 43099982, "comment_id": 73295027, "body": "Why not use linked tables which you build from ODBC connection (see External Data tab on Ribbon)? Once you link table, simply bound form to that table."}, {"owner": {"reputation": 36, "user_id": 7599919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bd7a0cca1c5e598d935f78615cbee78?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7599919/adam"}, "edited": false, "score": 0, "creation_date": 1490878887, "post_id": 43099982, "comment_id": 73316395, "body": "The user should only have ReadOnly privilege already. I don&#39;t believe that&#39;s the problem. The table is already linked in the database using that method, but when I try to open it through a Runtime computer it tells me that the server cannot be found."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1491233570, "post_id": 43099982, "comment_id": 73450474, "body": "<code>DSN=&#39;servername&#39;</code> won&#39;t work. Your question is a bit confusing, have you created the System DSN on the user computer? Then the DSN name (not server name) goes into the connect string."}, {"owner": {"reputation": 36, "user_id": 7599919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bd7a0cca1c5e598d935f78615cbee78?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7599919/adam"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1491235037, "post_id": 43099982, "comment_id": 73451463, "body": "@Andre The System DSN is set up on the user computer. The name for the DSN is the same as the server&#39;s name if that helps clear up the confusion."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 7599919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bd7a0cca1c5e598d935f78615cbee78?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7599919/adam"}, "is_accepted": true, "score": 0, "last_activity_date": 1491389042, "last_edit_date": 1495535445, "creation_date": 1491389042, "answer_id": 43228897, "question_id": 43099982, "link": "https://stackoverflow.com/questions/43099982/successful-odbc-connection-but-cant-load-the-table-in-runtime/43228897#43228897", "title": "Successful ODBC connection, but can&#39;t load the table in Runtime", "body": "<p>This ended up being a bit issue. Despite using the ODBC connection tool in Control Panel --> Administrative Tools. I needed a 32 bit connection. This is answered in another SO question.</p>\n\n<p>HOWEVER, I will note that the only way I ended up getting an useful error message was by creating a backend. Then it displayed the error message in the linked question below:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/8895823/the-specified-dsn-contains-an-architecture-mismatch-between-the-driver-and-appli\">Related Question on SO</a></p>\n"}], "owner": {"reputation": 36, "user_id": 7599919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bd7a0cca1c5e598d935f78615cbee78?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7599919/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2076, "favorite_count": 0, "accepted_answer_id": 43228897, "answer_count": 1, "score": 0, "last_activity_date": 1491389042, "creation_date": 1490807636, "last_edit_date": 1491235628, "question_id": 43099982, "link": "https://stackoverflow.com/questions/43099982/successful-odbc-connection-but-cant-load-the-table-in-runtime", "title": "Successful ODBC connection, but can&#39;t load the table in Runtime", "body": "<p>Update: I ran a SQL connection test function in my VBA and it reads open from my main workstation, I ran the same connection script at the client workstation and Runtime crashed. I also checked to make sure it was using a 32-bit rather than 62-bit driver and that the credentials were identical to another station that does work.</p>If I run a connection test Runtime crashes, if I try to only run the query it says the connection can't be found. Both attempted from the user computer.</p></p>\n\n<hr>\n\n<p>I successfully opened an ODBC Unicode connection to the MySQL database from the client computer at System DSN level. When I open the Access Runtime file and try to use a form to query the database I receive the error: \"ODBC--connection to 'servername' failed.\" I have tried numerous names including changing the case sensitivity. I verified that the TCPIP address I used was indeed to the host for this database, and that the name using ipconfig /all - was of the appropriate case sensitivity. I have not been able to figure out if it is an issue with Access vs. Runtime, but I can't really see that being the problem here. The name of the table is \"tbl_panel,\" and it is definitely within the database I connected to with ODBC with that exact name. </p>The user requirements for the connection I used has basically \"Read-Only\" privilege, but that is all it should need as I am only checking the data. Unless creating a recordset is beyond the scope of SELECT, SHOW VIEW, CREATE TEMP TABLES. Furthermore, the fact that it can't find the server itself tells me its probably not to do with my SQL/VBA coding. Hovering over the tbl_panel in the Navigation Pane of Access shows \"ODBC;DSN='servername';;TABLE=tbl_panel\".</p></p>\n\n<hr>\n\n<p>Here is the SQL string for creating the record set (truncated for space since the statement itself works fine):</p>\n<code>stSQL1 = \"SELECT tbl_panel.PNL_SN_ID FROM tbl_panel \" &amp; _ etc.\nSet qryList = dbsInspect.OpenRecordset(stSQL1)</code></p>\n\n<hr>\n\n<p>This has me pretty stumped, and I am a rookie when it comes to ODBC, so if it is something obvious please be kind. I did do a lot of searching, but most ODBC queries return issues with the initial setting up of the Data Source, or opening the connection in code. Is that a possibly for what I have to do? Include an opening statement for the table in VBA so that Runtime knows what to do? I'm going to feel silly if that is what the problem likely is and I typed all this for nothing.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1490808281, "post_id": 43099781, "comment_id": 73282005, "body": "Consider toggling  settings: <code>application.screenupdating=false</code>, <code>application.calculation=xlManual</code>, and <code>application.enableevents=true</code>. Just make sure to set those back to false at the end of your VBA. Those will keep the screen from updating, the application from updating formulas, and will keep any worksheet or workbook vba events from firing while your code is executing."}, {"owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1490830095, "post_id": 43099781, "comment_id": 73293063, "body": "Thanks. But it&#39;s nothing like that all the settings are as you describe the common denominator seems to be the file size"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1498413130, "creation_date": 1498413130, "answer_id": 44749023, "question_id": 43099781, "link": "https://stackoverflow.com/questions/43099781/does-file-size-effect-the-speed-of-vba-execution/44749023#44749023", "title": "does file size effect the speed of vba execution?", "body": "<p>Macros run Slow (#slowmacros)</p>\n\n<pre><code>\u00ab Turn off calculation and screen refresh while macro is running.  Be sure to restore settings when the macro ends.  Some supposedly reset automatically but later releases tend to require you to reset.  Macros may terminate abnormally so don\u2019t use without that thought in mind.  The examples below do not save current settings and restore them but assume normal usage is in effect.\n\nScreen flickering is usually the result of bad coding, but turning off Screen Updating will eliminate the blinking, and speed up a macro.  Turning off calculation can have a more dramatic effect on improving performance.  Use of Special Cells and restriction to used range will greatly improve coding.\n\nTurning off ScreenUpdating and Calculation are the easiest changes to implement.\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n      '    ooo   Your code here   ooo\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\n\n    Prior to XL97 (Excel 5 and Excel 97) use\n    Application.Calculation = xlManual          'prior to XL97\n    Application.Calculation = xlAutomatic     'prior to XL97\n                alternative coding: restores previous settings:\n\n      Dim savCalc As Long, savScrnUD As Boolean\n      savCalc = Application.Calculation\n      savScrnUD = Application.ScreenUpdating\n      Application.Calculation = xlCalculationAutomatic\n      Application.ScreenUpdating = True\n      '    ooo   Your code here   ooo\n    done:\n      Application.Calculation = savCalc\n      Application.ScreenUpdating = savScrnUD\n\nI always want calculation on and there are too many bad macros that fail and macro of my own that fail during testing so I use the version on the left above.  The code on the right above is more correct but prone to problems of leaving calculation off.\n\nFor most VBA actions, you don\u2019t have to select the sheet or cell.  Look for such coding to be reworked/removed, you might even be able to remove the need to suppress screen updating if the appearance of the screen is not changed. (Brian Wilson Example: 2000-12-28)\n\nAre there any Worksheet_Change events.\n\nRelated to last row problems, macros can take forever to run if they loop through all possible columns and rows instead of restricting activity to the used area.   Examples where such failures commonly occur:  deleting rows with certain content,  inserting rows or columns, selecting an entire column and macro processes entire column instead of cells in the active area.\n\nIn a test of one macro adding DIM statements appeared to increase time 30% contrary to good coding practices.  Nevertheless, by dimensioning variables you simplify code writing and maintenance and avoid some additional problems.  Turning off screenupdating saved about 12%, but turning off calculation saved an additional whopping 75%.\n\nUse SpecialCells to reduce selection to cell types of interest (constants, formulas, comments, visible, etc.).  SpecialCells is automatically limited to the used range, which eliminates processing every single cell in a selected column, if a column is selected.  Examples range from 366 seconds without using SpecialCells, to .040 seconds by reducing selection with SpecialCells as seen on Proper, and other Text changes -- Use of Special Cells also see notations on same page.\n\nDimensioning variables for use with Options Explicit. (#dimensioning)  If you have simply used Dim xyz as variant you can find out the actual type that you used with  MsgBox typename(xyz)  so you can replace variant by its actual type.  (see vba.htm for more information). \n</code></pre>\n\n<p>Speeding up VBA code   (#speedupvba)</p>\n\n<pre><code>The biggest things were in the previous topic turning off calculation and display. Here are some additional tips.\n\nDeclare variables with their datatype [see table]:  Byte, Boolean, Long, Long, Currency, Decimal, Single, Double, Date, String, Object, Variant (default), and user-defined types, as well as specific types of objects.  A common pitfall is failing to include attributes for each variable on a DIM statement resulting in a data type of variant.\n\nUse long in preference to integer and use double in preference to single as these are what the system actually has to use, and use String instead of Byte.  Also note that anything referring to rows should be immediately changed to long, since 65,536 exceeds the limit of the integer datatype.\n\nAvoid changing the activecell or the active page, unless that is the desired result.  Example to create a new entry after last entry in Column A, not to be confused with last cell row (Ctrl+End), which can in itself be problematic.   (#samplesub)\n\n Sub SampleSub()\n   Cells(Rows.Count,Range(\"A1\").Column).End(xlUp).Offset(1,0).Value _\n     =\"** New Entry**\"\n End Sub\n</code></pre>\n\n<p><strong>Does saving the file as .XLSB help at all?</strong></p>\n\n<p>Finally, consider the following links.</p>\n\n<p><a href=\"http://professor-excel.com/15-ways-to-speed-up-excel/\" rel=\"nofollow noreferrer\">http://professor-excel.com/15-ways-to-speed-up-excel/</a></p>\n\n<p><a href=\"http://dmcritchie.mvps.org/excel/slowresp.htm\" rel=\"nofollow noreferrer\">http://dmcritchie.mvps.org/excel/slowresp.htm</a></p>\n\n<p><a href=\"http://chandoo.org/wp/2014/01/17/big-trouble-in-little-spreadsheet/\" rel=\"nofollow noreferrer\">http://chandoo.org/wp/2014/01/17/big-trouble-in-little-spreadsheet/</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff726673(v=office.14).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff726673(v=office.14).aspx</a></p>\n"}], "owner": {"reputation": 143, "user_id": 5216811, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-qDyMdQVEiHQ/AAAAAAAAAAI/AAAAAAAAAAA/PSOH7CF3vYg/photo.jpg?sz=128", "display_name": "Don Desrosiers", "link": "https://stackoverflow.com/users/5216811/don-desrosiers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498413130, "creation_date": 1490806917, "last_edit_date": 1531164843, "question_id": 43099781, "link": "https://stackoverflow.com/questions/43099781/does-file-size-effect-the-speed-of-vba-execution", "title": "does file size effect the speed of vba execution?", "body": "<p>I have a complex Excel workbook with hundreds of macros.  All runs well.  It is 9mb in size.  when I add additional sheets (they are complex charts), the file size jumps to 14mb.  This wouldn't be a problem, but some code runs very very slowly.  In particular, this is a copy sequence that copies around 60 cells from one sheet to another.  It usually happens in around 5 seconds, but when the file size becomes 14mb, the code takes around 60 seconds...intolerable.  deleting the sheet fixes the problem.  the copy sequence has no connection whatsoever to the sheet that I delete.  What am I missing?</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 141, "user_id": 4663401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac32b68acf50cf217119913894e7f2a6?s=128&d=identicon&r=PG&f=1", "display_name": "amg", "link": "https://stackoverflow.com/users/4663401/amg"}, "edited": false, "score": 1, "creation_date": 1490806341, "post_id": 43099511, "comment_id": 73280706, "body": "Where is the problem?"}, {"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "reply_to_user": {"reputation": 141, "user_id": 4663401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac32b68acf50cf217119913894e7f2a6?s=128&d=identicon&r=PG&f=1", "display_name": "amg", "link": "https://stackoverflow.com/users/4663401/amg"}, "edited": false, "score": 0, "creation_date": 1490806453, "post_id": 43099511, "comment_id": 73280771, "body": "@amg Not sure. It doesn&#39;t loop. Only opens the first PDF. I&#39;m thinking its because the active program changes to the PDF. Would I be able to add <code>, vbNormalNoFocus</code> somewhere to keep Excel the active program."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1490806575, "post_id": 43099511, "comment_id": 73280866, "body": "you&#39;re not updating <code>pdfPath</code> inside the loop. See my answer"}], "answers": [{"comments": [{"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "edited": false, "score": 0, "creation_date": 1490806901, "post_id": 43099636, "comment_id": 73281079, "body": "Works perfect, Thx so much."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 3, "last_activity_date": 1490806453, "creation_date": 1490806453, "answer_id": 43099636, "question_id": 43099511, "link": "https://stackoverflow.com/questions/43099511/excel-loop-thru-cells-to-open-pdf/43099636#43099636", "title": "excel loop thru cells to open pdf", "body": "<pre><code>Sub Cutsheets()\n    Application.ScreenUpdating = False\n    On Error GoTo whoa\n\n    Dim I As Integer\n    Dim finalrow As Integer\n    Dim pdfPath As String\n\n    'loop through the rows to find PDFs\n    With Sheet1\n        finalrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        For I = 9 To finalrow\n            pdfPath = \"P:\\ESO\\1790-ORL\\OUC\\_Materials\\Material Cutsheets\\\" &amp; Cells(I, 1).Value &amp; \".pdf\"\n            Call OpenAnyFile(pdfPath)\n        Next I\n    End With\n\nwhoa:\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 43099636, "answer_count": 1, "score": 0, "last_activity_date": 1490813290, "creation_date": 1490806002, "last_edit_date": 1490813290, "question_id": 43099511, "link": "https://stackoverflow.com/questions/43099511/excel-loop-thru-cells-to-open-pdf", "title": "excel loop thru cells to open pdf", "body": "<p>I can get my code to open the selected cells PDF. How can I loop this to run from <code>A9 to finalrow</code>? This is what I have working but only for selected cell.</p>\n\n<pre><code>Function OpenAnyFile(strPath As String)\nSet objShell = CreateObject(\"Shell.Application\")\nobjShell.Open (strPath)\nEnd Function\n\nSub Cutsheets()\nApplication.ScreenUpdating = False\nOn Error GoTo whoa\n\nDim ordersheet As Worksheet\nDim I As Integer\nDim finalrow As Integer\nDim pdfPath As String\nSet ordersheet = Sheet1\n\nfinalrow = Cells(Rows.Count, 1).End(xlUp).Row\npdfPath = \"P:\\ESO\\1790-ORL\\OUC\\_Materials\\Material Cutsheets\\\" &amp; ActiveCell &amp; \".pdf\"\n\n'loop through the rows to find PDFs\nFor I = 9 To finalrow\n    If Cells(I, 1) = Application.Intersect(ActiveCell, Range(\"A9:A\" &amp; finalrow)) Then\n    Call OpenAnyFile(pdfPath)\n    End If\n    ordersheet.Select\nNext I\n\nwhoa:\nExit Sub\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "oracle", "vba", "adodb"], "comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1490805890, "post_id": 43099344, "comment_id": 73280417, "body": "Try <code>objMyCmd.CommandText = &quot;{begin ...end;}&quot;</code> or <code>objMyCmd.CommandText = &quot;{call scheme1.function1...}</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1490807505, "post_id": 43099344, "comment_id": 73281489, "body": "Your date strings and date format strings look like they don&#39;t match.  Is table1 created by the stored procedure?"}], "answers": [{"tags": [], "owner": {"reputation": 1181, "user_id": 2671057, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/00680c4bf8ca27072a51049728508807?s=128&d=identicon&r=PG", "display_name": "user2671057", "link": "https://stackoverflow.com/users/2671057/user2671057"}, "is_accepted": true, "score": 0, "last_activity_date": 1490806185, "creation_date": 1490806185, "answer_id": 43099560, "question_id": 43099344, "link": "https://stackoverflow.com/questions/43099344/multiple-procedures-in-oracle-sql-excel-vba/43099560#43099560", "title": "Multiple procedures in Oracle SQL Excel VBA", "body": "<p>Is this table in your schema? \nIf no - is there a public synonym ?\nTry schema.table1\nMaybe there is no public synonym.</p>\n"}], "owner": {"reputation": 196, "user_id": 6335499, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5cf29790a93b5e67bf6f94642c3f3a85?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6335499/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 43099560, "answer_count": 1, "score": 1, "last_activity_date": 1490806185, "creation_date": 1490805507, "question_id": 43099344, "link": "https://stackoverflow.com/questions/43099344/multiple-procedures-in-oracle-sql-excel-vba", "title": "Multiple procedures in Oracle SQL Excel VBA", "body": "<p><strong>Excel version</strong>: 2013</p>\n\n<p><strong>SQL Oracle</strong> with ADODB</p>\n\n<p>I am rather new to ADODB and SQL. I have the following code:</p>\n\n<pre><code>objMyCmd.CommandText = \"begin \" &amp; Chr(10) &amp; _\n\"scheme1.function1(to_date('2017.01.01','YYYY-MM-DD'), to_date('2017.03.01','YYYY-MM-DD'),'ALEX'); \" &amp; Chr(10) &amp; \"commit; \" &amp; Chr(10) &amp; \"end; \"\n\nobjMyCmd.CommandType = adCmdText\n\nobjMyCmd.Execute\n\nobjMyCmd.CommandText = \"SELECT * from table1\"\n\nobjMyCmd.CommandType = adCmdText\n\nobjMyCmd.Execute\n</code></pre>\n\n<p>The code in SQL interpretator would look like this:</p>\n\n<pre><code>begin \nscheme1.function1(to_date('2017.01.01','YYYY-MM-DD'),to_date('2017.03.01','YYYY-MM-DD'),'ALEX'); \ncommit; \nend;  \n\nSELECT * from table1\n</code></pre>\n\n<p>When running the 2nd <code>objMyCmd.Execute</code> I get:</p>\n\n<p><code>[Oracle][ODBC][Ora]ORA-00903: invalid table name</code></p>\n\n<p>I guess the problem arises from combining the first and the second procedures in a single <code>objMyCmd.CommandText</code>.</p>\n\n<p>Please, help me solve this problem and make a VBA script work correctly.</p>\n"}, {"tags": ["arrays", "excel", "vba", "dictionary"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1576421188, "last_edit_date": 1576421188, "creation_date": 1490805182, "answer_id": 43099243, "question_id": 43099051, "link": "https://stackoverflow.com/questions/43099051/how-to-access-an-array-of-dictionaries/43099243#43099243", "title": "How to access an array of dictionaries?", "body": "<p>May be this?</p>\n\n<pre><code>Dim d, k\nFor Each d in aRows\n    For Each k in d.keys \n        Debug.Print k, d(k),\n    Next\n    Debug.Print vbCrLf\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1490805696, "creation_date": 1490805696, "answer_id": 43099412, "question_id": 43099051, "link": "https://stackoverflow.com/questions/43099051/how-to-access-an-array-of-dictionaries/43099412#43099412", "title": "How to access an array of dictionaries?", "body": "<p>you could use</p>\n\n<pre><code>Dim myRow as Variant, key as variant\nFor Each myRow In aRows\n    With myRow \n        For Each key In .Keys\n            Debug.Print key, .Item(key)\n        Next\n    End With\nNext\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 5362533, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ef65a4875b02d1220c719de70ec4767e?s=128&d=identicon&r=PG&f=1", "display_name": "TMikonos", "link": "https://stackoverflow.com/users/5362533/tmikonos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2498, "favorite_count": 0, "accepted_answer_id": 43099243, "answer_count": 2, "score": 1, "last_activity_date": 1579586383, "creation_date": 1490804583, "last_edit_date": 1579586383, "question_id": 43099051, "link": "https://stackoverflow.com/questions/43099051/how-to-access-an-array-of-dictionaries", "title": "How to access an array of dictionaries?", "body": "<p>I want to use an array of dictionaries to store all the content of an Excel workbook to later process it and make operations in memory.</p>\n\n<p>I have defined that the first row of the Excel workbook is the key and the rest of rows are content. As I have one key for many values, I need to store them in a different container (this would be the array).</p>\n\n<p>A sample of the content</p>\n\n<pre>\nCode Name Surname\n1    a     b\n2    c     d\n</pre>\n\n<p>The code:</p>\n\n<pre><code>For Each rcell In ws.UsedRange.Cells\n   If rcell.Row &gt; 1 Then\n        ReDim Preserve aRows(rcell.Row - 2)\n        'Set aRows(rcell.Row - 2) = CreateObject(\"scripting.dictionary\")\n        Set pInfo = New Scripting.Dictionary\n        pInfo.Add Key:=Cells(1, rcell.Column).Value, Item:=rcell.Value\n        'aRows(rcell.Row - 2).Add Key:=Cells(1, rcell.Column).Value, Item:=rcell.Value\n        Set aRows(rcell.Row - 2) = pInfo\n    End If\nNext rcell\n</code></pre>\n\n<p>This code creates an array of dictionaries.</p>\n\n<p>When I try to access the data I get an error.</p>\n\n<p>I know that at least it is storing values because when I use:</p>\n\n<pre><code>debug.print(ubound(aRows))\n</code></pre>\n\n<p>I am getting the value (1) in this case.</p>\n\n<p>I tried accessing the content with</p>\n\n<pre><code>for each row in aRows\n    debug.print(row.key)\nnext row\n</code></pre>\n\n<p>However, this is not accepted. How do I access the data?</p>\n\n<p>An alternative or something more simple would be great.</p>\n"}, {"tags": ["vba", "excel", "matrix"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490805326, "post_id": 43098922, "comment_id": 73280055, "body": "Please can you post your code here rather than a picture?"}, {"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490805485, "post_id": 43098922, "comment_id": 73280154, "body": "I&#39;d love to, but I&#39;m not sure how to. It&#39;s my first question. Where can I add it? <b>Found it, code is now added</b>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490806116, "post_id": 43098922, "comment_id": 73280567, "body": "If you use <code>application.inputbox</code> method you can specify a type of input - check vba help for details. So you could specify type=1 which is a number. For 3 you need to add =, e.g. <code>RefersToR1C1:=&quot;=Ark&quot;</code> etc."}, {"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490806913, "post_id": 43098922, "comment_id": 73281092, "body": "Wonderful, that&#39;s two problems solved, thank you very much"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490807014, "post_id": 43098922, "comment_id": 73281146, "body": "I don&#39;t think I understand 4 - how are the boundaries determined?"}, {"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490807312, "post_id": 43098922, "comment_id": 73281366, "body": "I&#39;ve added a picture of Sheet1 and Sheet2. The defined areas in sheet1 should be A-m&#229;l = C10, HF = D13, Bundvolumen = K8, Tank_Tabel = B19:L32 and Int_Tabel = B37:L47. I&#39;ve added that to the code manually, but that doesn&#39;t work for Sheet2 as the position of the needed areas is different. I don&#39;t know how to, but I need some clever way to make the macro determine where the correct cells are, but I don&#39;t know if that is even possible. One easier solution would be to make sure that all sheets are identical, but I&#39;m not in charge of making the sheets."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490810420, "post_id": 43098922, "comment_id": 73283355, "body": "You need to explain the basis for determining these areas. If there is identifying text then you could use the Find method to find these and define your areas."}, {"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490811486, "post_id": 43098922, "comment_id": 73283991, "body": "There should always be the same text around the areas at least. The tables will always have cm, and the individual cells will always have the name of what is in that cell directly to the left of them. I haven&#39;t gotten it to work yet, but I think the answer below has at least some of what I am looking for. I&#39;m sorry for not being clear about my needs."}, {"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490878100, "post_id": 43098922, "comment_id": 73315778, "body": "@SJR I&#39;ve added a sample code to the end of the question of what the solution could look like, but there&#39;s a problem with that code somewhere. It doesn&#39;t return any values at all. I tried testing with both a textbox and defining an area from the result, but it just turns out blank. Am I using the for each wrong?"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490810749, "post_id": 43100674, "comment_id": 73283540, "body": "This looks very promising, I will try to work it into the code and then return"}, {"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490877370, "post_id": 43100674, "comment_id": 73315164, "body": "I&#39;ve tried to rework the code to my document, but it seems there&#39;s something wrong. While there&#39;s no error, it doesnt return a value of any sort. I&#39;ve added the current code to the bottom of the post."}, {"owner": {"reputation": 41, "user_id": 2309746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eRmK.jpg?s=128&g=1", "display_name": "Aditya Deo", "link": "https://stackoverflow.com/users/2309746/aditya-deo"}, "reply_to_user": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490894375, "post_id": 43100674, "comment_id": 73327955, "body": "You may use msgbox, breakpoints or immediate window to check if any variable actually has a expected value or not. My favorite is msgbox. Like, before first &#39;ElseIf&#39;, you may use &#39;MsgBox A2&#39; to check which value this variable holds."}, {"owner": {"reputation": 41, "user_id": 2309746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eRmK.jpg?s=128&g=1", "display_name": "Aditya Deo", "link": "https://stackoverflow.com/users/2309746/aditya-deo"}, "reply_to_user": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490894791, "post_id": 43100674, "comment_id": 73328204, "body": "I must acknowledge that, rather than looping through each cell in a range, Find method described by SJR will be a lot faster!"}, {"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490895748, "post_id": 43100674, "comment_id": 73328788, "body": "I got it to work using the find method, and everything runs smoothly now. I&#39;ll update the code in the original question. Thank you very much for your suggestion too. I&#39;d upvote if I could, but I dont have reputation to do so"}, {"owner": {"reputation": 41, "user_id": 2309746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eRmK.jpg?s=128&g=1", "display_name": "Aditya Deo", "link": "https://stackoverflow.com/users/2309746/aditya-deo"}, "reply_to_user": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490897636, "post_id": 43100674, "comment_id": 73329850, "body": "Hahaha! No need!"}], "tags": [], "owner": {"reputation": 41, "user_id": 2309746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eRmK.jpg?s=128&g=1", "display_name": "Aditya Deo", "link": "https://stackoverflow.com/users/2309746/aditya-deo"}, "is_accepted": false, "score": 1, "last_activity_date": 1490811388, "last_edit_date": 1490811388, "creation_date": 1490809855, "answer_id": 43100674, "question_id": 43098922, "link": "https://stackoverflow.com/questions/43098922/how-to-create-a-macro-in-vba-that-can-automatically-determine-the-boundaries-of/43100674#43100674", "title": "How to create a macro in VBA that can automatically determine the boundaries of a matrix", "body": "<p>I am not sure, if my understanding is correct. You may iterate a loop through starting range of Sheet 2, to get the addresses.\nFor example, if the labels like \"A_M\u00e5l\", \"HF\",\"Bundvolumen\" will remain same in Sheet 2, you may use:</p>\n\n<pre><code>Sub GetRanges()\nDim A2, HF2, BV2, TT2, IT\nFor Each c In Range(\"A1:Z100\")\n' A1:Z100 is Random range, which might contain the ranges required\n    If c.Value = \"A_M\u00e5l\" Then\n    ' Check if this cell value matches A_M\u00e5l\n        A2 = c.Offset(rowOffset:=0, columnOffset:=1).Address\n        ' Use Offset to take the one cell to right of matching cell\n    ElseIf c.Value = \"HF\" Then\n    ' Check if this cell value matches HF\n        HF2 = c.Offset(rowOffset:=0, columnOffset:=1).Address\n        ' Use Offset to take the one cell to right of matching cell\n    ElseIf c.Value = \"Bundvolumen\" Then\n    ' Check if this cell value matches Bundvolumen\n        BV2 = c.Offset(rowOffset:=0, columnOffset:=1).Address\n        ' Use Offset to take the one cell to right of matching cell\n    ElseIf c.Value = \"CM\" Then\n    ' Check if this cell value matches HF\n        TT2 = c.CurrentRegion.Address\n        ' Use CurrentRegion to take the current continous data of matching cell\n    ElseIf c.Value = \"INTERPOLCATIONSTABEL\" Then\n    ' Check if this cell value matches INTERPOLCATIONSTABEL\n        IT2 = c.Offset(rowOffset:=0, columnOffset:=1).CurrentRegion.Address\n        ' Use Offset to take the one cell to right of matching cell\n        ' Use CurrentRegion to take the current continous data of matching cell\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note: These variables gives you addresses of ranges in string data type\nIf you want actual ranges, simply remove \".address\" from each line wherever mentions it.</p>\n\n<p>Note2: A checked, label \"Bundvolumen\" has changed to \"Volume\" in Sheet 2.\nThe macro given above wont work in such cases.\nBut if you know the exhaustive list of names, which can be used to refer, it can be included with \"OR\" conditions in \"IF\" statements. Such as:</p>\n\n<pre><code>ElseIf c.Value = \"Bundvolumen\" or c.Value = \"Volume\" Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490887591, "post_id": 43121756, "comment_id": 73323442, "body": "Brilliant, you&#39;re a lifesaver. For the Tanktabel and Interpolationstabel, I&#39;m thinking of just looking for the name the same way, but how do I define an area larger than one cell? Does .Current.Region do that for me?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490887668, "post_id": 43121756, "comment_id": 73323500, "body": "Use <code>Resize</code>. E.g. <code>range(&quot;a1&quot;).resize(2,2)</code> is equivalent to <code>range(&quot;a1:b2&quot;)</code>. Does that help? The possible problem with <code>currentregion</code> is that it will include all contiguous cells so may include the text as well."}, {"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490887970, "post_id": 43121756, "comment_id": 73323723, "body": "It looks like resize requires me to know beforehand how large i want the table to be? If that&#39;s the case then I can&#39;t use that option sadly. There will never be more than one instance of Tanktabel or Interpolationstabel in the sheet, there will only be numbers or blank spaces inside the table, and there will always be at least one blank space around the table."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490888111, "post_id": 43121756, "comment_id": 73323823, "body": "If it&#39;s the table headed &quot;TANKTABEL&quot; then perhaps you can use <code>currentregion</code> and then resize by removing the first row if necessary."}, {"owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "edited": false, "score": 0, "creation_date": 1490888196, "post_id": 43121756, "comment_id": 73323879, "body": "I will try it out. Thank you very much for all your help."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 3, "last_activity_date": 1490886631, "creation_date": 1490886631, "answer_id": 43121756, "question_id": 43098922, "link": "https://stackoverflow.com/questions/43098922/how-to-create-a-macro-in-vba-that-can-automatically-determine-the-boundaries-of/43121756#43121756", "title": "How to create a macro in VBA that can automatically determine the boundaries of a matrix", "body": "<p>Here's the approach I would use. It's only an example, for HF, but hopefully you get the idea and can extend to the other ranges. I've assumed the named range is the cell to the right of the one containing \"HF\".</p>\n\n<pre><code>Sub OptimalSolution()\n\nDim TankNr As Integer, rHF As Range\n\nIf MsgBox(\"Do you wish to define new areas for a container?\", vbYesNo, \"Confirm\") = vbYes Then\n    TankNr = Application.InputBox(\"Please enter the container number\", \"Container Number\", , , , , , 1)\n    Set rHF = Sheets(\"Ark\" &amp; TankNr).Cells.Find(What:=\"HF\", LookAt:=xlWhole, MatchCase:=True, SearchFormat:=False)\n    If Not rHF Is Nothing Then\n        rHF.Offset(, 1).Name = \"HF_\" &amp; TankNr\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 7780010, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uAl_ULgtlHc/AAAAAAAAAAI/AAAAAAAAAbk/DqZTTAJirE8/photo.jpg?sz=128", "display_name": "Christian Emil Johansen", "link": "https://stackoverflow.com/users/7780010/christian-emil-johansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 43121756, "answer_count": 2, "score": 1, "last_activity_date": 1490896501, "creation_date": 1490804207, "last_edit_date": 1490896501, "question_id": 43098922, "link": "https://stackoverflow.com/questions/43098922/how-to-create-a-macro-in-vba-that-can-automatically-determine-the-boundaries-of", "title": "How to create a macro in VBA that can automatically determine the boundaries of a matrix", "body": "<p>I've started programing in VBA yesterday, and as such I am still quite the newbie at it. </p>\n\n<p>I've tried to make a macro that automatically defines certain areas for me, and while it works quite well in my sheet, it is still limited in the sense that all sheets I use it on have to be identical in setup. </p>\n\n<p>I am currently defining 5 areas</p>\n\n<ul>\n<li>A_m\u00e5l - Single Cell</li>\n<li>Tank_Tabel - Matrix</li>\n<li>Int_Tabel - Matrix</li>\n<li>Bund - Single Cell</li>\n<li>HF - Single Cell</li>\n</ul>\n\n<p>The optimal macro for my problem would be one that prompts the user to enter a number of a container, and then uses that number to automatically determine what sheet the information of said container can be found on, and the automatically determine where the listed areas are, and define them with the given names and the number that the user has entered.</p>\n\n<p>The code can be seen here:</p>\n\n<pre><code>Option Compare Text\nSub Definer()\n    Dim TankNr As Integer, rHF As Range, rAM As Range, rBV As Range, rTT As Range, rIT As Range\n\n    If MsgBox(\"Vil du definere nye omr\u00e5der for en tank\", vbYesNo, \"Confirm\") = vbYes Then\n\n        TankNr = Application.InputBox(\"Indtast tank nr p\u00e5 den tank du vil definere omr\u00e5der for\", \"Tank Nummer\", Type:=1)\n        If TankNr &lt;&gt; 0 Then\n\n            Set rHF = Sheets(\"Tank \" &amp; TankNr).Cells.Find(What:=\"H\u00d8JESTE FYLDEGR\u00c6NSE =\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n            If Not rHF Is Nothing Then\n                rHF.Offset(, 3).Name = \"HF_\" &amp; TankNr\n            End If\n\n            Set rTT = Sheets(\"Tank \" &amp; TankNr).Cells.Find(What:=\"Enhed i tabellen : Liter\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n            If Not rTT Is Nothing Then\n                rTT.CurrentRegion.Offset(2, 0).Resize(rTT.CurrentRegion.Rows.Count - 2).Name = \"Tabel_tank\" &amp; TankNr\n            End If\n\n            Set rIT = Sheets(\"Tank \" &amp; TankNr).Cells.Find(What:=\"Interpolationstabel\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n            If Not rIT Is Nothing Then\n                rIT.Resize(11, 11).Offset(1, 0).Name = \"Int_tank\" &amp; TankNr\n            End If\n\n            Set rBV = Sheets(\"Tank \" &amp; TankNr).Cells.Find(What:=\"Bundvolumen =\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n            If Not rBV Is Nothing Then\n                rBV.Offset(, 2).Name = \"Bund\" &amp; TankNr\n            End If\n\n            Set rAM = Sheets(\"Tank \" &amp; TankNr).Cells.Find(What:=\"A-M\u00c5L =\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n            If Not rAM Is Nothing Then\n                rAM.Offset(, 1).Name = \"A_m\u00e5l\" &amp; TankNr\n            End If\n\n            MsgBox \"Omr\u00e5der er blevet defineret\"\n\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>There are several problems with this:</p>\n\n<ol>\n<li><strike>If the user enters a non integer in the input box, the code ends up with an error, rather than just ending the macro.</strike> <strong>Solved</strong></li>\n<li><strike>If the user hits cancel in the input box, the code also ends up with an error rather than ending the macro.</strike> <strong>Solved</strong></li>\n<li><strike>I tried to use the input \"TankNr\" as a reference, but it doesn't return the value of the cell, <a href=\"https://i.stack.imgur.com/DVlFi.png\" rel=\"nofollow noreferrer\">but just what I've written as the reference</a></strike> <strong>Solved</strong></li>\n<li><strike>Finally, the current boundaries of each defined area is determined by me manually, and it works fine if the values I am looking for <strong>is</strong> actually in those specific cells. Sometimes the setup of the sheets might vary, and as such I need the macro to be able to automatically determine where the boundaries of the defined areas should be </strike> <strong>Solved</strong></li>\n</ol>\n\n<p>The sheets in question can be seen <a href=\"https://i.stack.imgur.com/KEehe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KEehe.png\" alt=\"here\"></a></p>\n\n<p>Due to my reputation, I can only include these two links, but if there's a way to provide more documentation of my work, tell me and I'll happily do so.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1490805913, "post_id": 43098885, "comment_id": 73280429, "body": "you may want to add some examples of how your data (filtered and unfiltered) look like"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490806519, "post_id": 43098885, "comment_id": 73280819, "body": "It&#39;s hard to follow the logic of your code, please load a screen-shot sample of your data and desired result"}, {"owner": {"reputation": 1, "user_id": 7354674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f71c2da325b2d2ed36de877feaafd96e?s=128&d=identicon&r=PG&f=1", "display_name": "Luisxv", "link": "https://stackoverflow.com/users/7354674/luisxv"}, "edited": false, "score": 0, "creation_date": 1490813197, "post_id": 43098885, "comment_id": 73285029, "body": "Thank you, I just added a sample of may data unfiltered and filtered."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7354674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f71c2da325b2d2ed36de877feaafd96e?s=128&d=identicon&r=PG&f=1", "display_name": "Luisxv", "link": "https://stackoverflow.com/users/7354674/luisxv"}, "edited": false, "score": 0, "creation_date": 1490814240, "post_id": 43100514, "comment_id": 73285764, "body": "Oh I don&#39;t get any error on it, but it doesn&#39;t do what I need. Your code don&#39;t solve it, I&#39;m working on a filtered range. I added in the original post a sample of my data unfiltered an filtered, maybe that can give you a better idea about what I want. Thank you."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 1, "user_id": 7354674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f71c2da325b2d2ed36de877feaafd96e?s=128&d=identicon&r=PG&f=1", "display_name": "Luisxv", "link": "https://stackoverflow.com/users/7354674/luisxv"}, "edited": false, "score": 0, "creation_date": 1490814866, "post_id": 43100514, "comment_id": 73286130, "body": "Tested my code on filtered rows and as far as I can tell, it works. The hidden records are ignored and the output fits your example."}, {"owner": {"reputation": 1, "user_id": 7354674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f71c2da325b2d2ed36de877feaafd96e?s=128&d=identicon&r=PG&f=1", "display_name": "Luisxv", "link": "https://stackoverflow.com/users/7354674/luisxv"}, "edited": false, "score": 0, "creation_date": 1490816628, "post_id": 43100514, "comment_id": 73287226, "body": "Sorry, but it doesn&#39;t works. It&#39;s close, but, it take only the visible records to be counted, however on each counter of those visible records include the records hidden that match. That means if one of the visible records has 1 rows visible and 2 hidden, your code counts 3 and highlight that record when really it should not be considers. I&#39;ll figure out if I can modify it to bring me exactly what I need. Thank you so much, your code is a possible way."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 1, "user_id": 7354674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f71c2da325b2d2ed36de877feaafd96e?s=128&d=identicon&r=PG&f=1", "display_name": "Luisxv", "link": "https://stackoverflow.com/users/7354674/luisxv"}, "edited": false, "score": 0, "creation_date": 1490819579, "post_id": 43100514, "comment_id": 73288784, "body": "Interesting, wonder how I was getting it to ignore hidden rows on initial tests? Did a quick search and apparently doing a count that ignores hidden rows requires a custom function and looks complicated, which is essentially what you are attempting with your code. Sorry."}, {"owner": {"reputation": 1, "user_id": 7354674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f71c2da325b2d2ed36de877feaafd96e?s=128&d=identicon&r=PG&f=1", "display_name": "Luisxv", "link": "https://stackoverflow.com/users/7354674/luisxv"}, "edited": false, "score": 0, "creation_date": 1490819692, "post_id": 43100514, "comment_id": 73288841, "body": "It&#39;s fine, for now I&#39;ll add a temporal sheet with the filtered data and do there what I need and delete it later, because is complicated dealing with filtered data. Thank you"}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1490812327, "last_edit_date": 1490812327, "creation_date": 1490809245, "answer_id": 43100514, "question_id": 43098885, "link": "https://stackoverflow.com/questions/43098885/loop-through-a-filtered-range-excel-vba/43100514#43100514", "title": "loop through a filtered range excel vba", "body": "<p>I can't get your code to work. Right off I get \"Application-defined or object-defined\" run-time error on <code>firstRow = vRange.Areas(2).Rows(1).Row</code>. </p>\n\n<p>So what I did is a CountIf formula in column E:\n<code>=COUNTIF(D$2:D$7,D2)</code> then set Conditional Formatting. If the range is dynamic, use VBA to determine limits and propagate the formula and Conditional Formatting. Something like:</p>\n\n<pre><code>Dim rCount As Integer\nrCount = Range(\"D1\", Range(\"D2\").End(xlDown)).Rows.Count\nRange(\"D2:D\" &amp; rCount).Select\nSelection.Cells.FormatConditions.Delete\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$E2=3\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 65535\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\nRange(\"E2:E\" &amp; rCount).Select\nSelection.Formula = \"=CountIf($D$2:$D$\" &amp; rCount &amp; \", $D2)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1490820690, "creation_date": 1490820690, "answer_id": 43103928, "question_id": 43098885, "link": "https://stackoverflow.com/questions/43098885/loop-through-a-filtered-range-excel-vba/43103928#43103928", "title": "loop through a filtered range excel vba", "body": "<p>You may try something like this to see if that works for you.\nThe code will place a CountIFs formula in column F and delete it in the end.\nYou may tweak the code as per your requirement.</p>\n\n<pre><code>Sub HighlightFilteredCells()\nDim sws As Worksheet\nDim lr As Long\nDim cell As Range\nSet sws = Sheets(\"Sheet1\")\nIf sws.FilterMode Then sws.ShowAllData\nlr = Cells(Rows.Count, 1).End(xlUp).Row\nsws.Range(\"F2:F\" &amp; lr).Formula = \"=COUNTIFS($D$2:$D$\" &amp; lr &amp; \",D2,$E$2:$E$\" &amp; lr &amp; \",\"\"Active\"\")\"\nsws.Columns(5).Interior.ColorIndex = xlNone\nWith sws.Rows(1)\n    .AutoFilter field:=5, Criteria1:=\"Active\"\n    If sws.Range(\"A1\").CurrentRegion.SpecialCells(xlCellTypeVisible).Rows.Count &gt; 1 Then\n        For Each cell In sws.Range(\"F2:F\" &amp; lr).SpecialCells(xlCellTypeVisible)\n            If cell.Value &gt;= 3 Then cell.Offset(0, -1).Interior.Color = vbYellow\n        Next cell\n    End If\nEnd With\nsws.Columns(6).Clear\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7354674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f71c2da325b2d2ed36de877feaafd96e?s=128&d=identicon&r=PG&f=1", "display_name": "Luisxv", "link": "https://stackoverflow.com/users/7354674/luisxv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1047, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490820690, "creation_date": 1490804073, "last_edit_date": 1490813040, "question_id": 43098885, "link": "https://stackoverflow.com/questions/43098885/loop-through-a-filtered-range-excel-vba", "title": "loop through a filtered range excel vba", "body": "<p>I want to highlight cells when there are 3 or more with the same value, I have the bellow code but it isn't working right because it loop twice into each range. Can someone tell me what is wrong?</p>\n\n<pre><code>Sub HighlightCells()\nDim k As Integer, myCounter As Integer, firstRow As Integer\nDim myClientExport As Worksheet, myTemplate As Variant\nDim vRange As Range, myRange As Range \nDim myAddr As String\n\nSet myClientExport = Excel.ActiveSheet \nSet vRange = myClientExport.UsedRange.SpecialCells(xlCellTypeVisible) \n\n\nfirstRow = vRange.Areas(2).Rows(1).Row\nmyAddr = Cells(firstRow, 4).Value\nmyCounter = 0\nFor Each myRange In vRange.Rows \n    k = myRange.Row\n\n    If k &gt; firstRow Then\n        If myAddr = Cells(k, 4).Value Then\n            myCounter = myCounter + 1\n        Else\n            myAddr = Cells(k, 4).Value\n            myCounter = 0\n        End If\n        Select Case myCounter\n            Case 3\n\n                For i = 0 To 2\n                    OId = Cells(k - i, 1).Value\n                 Next i\n                Cells(k, 4).Interior.ColorIndex = 27\n                Cells(k - 1, 4).Interior.ColorIndex = 27\n                Cells(k - 2, 4).Interior.ColorIndex = 27\n            Case Is &gt; 3\n                Cells(k, 4).Interior.ColorIndex = 27\n        End Select\n    End If\nNext myRange\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/hyMw7.jpg\" rel=\"nofollow noreferrer\">My data unfiltered look like:</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/hqSKo.jpg\" rel=\"nofollow noreferrer\">My data filtered look like</a></p>\n\n<p>I want to highlight all Address with 3 or more Active order status. </p>\n"}, {"tags": ["vba", "excel", "user-defined-functions", "udf"], "answers": [{"comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1490804581, "post_id": 43098734, "comment_id": 73279570, "body": "Of course I would, but the formatting is dependant on an intermediate result, so it&#39;s a pain to do from outside the UDF. I was toying with using <code>Application.Caller</code> to try and cheat the system, it&#39;s proving relatively fruitless. Are there any loopholes of that sort? How does Excel know to stop that line of code from executing and can I turn off that awareness? Would there be repercussions?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 1, "creation_date": 1490804724, "post_id": 43098734, "comment_id": 73279673, "body": "Excel doesn&#39;t stop anything from executing; however it knows it&#39;s in the middle of calculating a worksheet, and if a cell invokes a UDF then it knows what the execution context is, and if it&#39;s hard-wired to throw an error when such or such method is invoked in the context of a UDF computation, then there&#39;s not much you can do about it. If what you need is a macro, why not write a macro?"}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1490807343, "post_id": 43098734, "comment_id": 73281388, "body": "You can change format from within a general macro, just not from a function  that&#39;s been called from a cell value. You could have your function set some sort of global variable that is inspected by a sub that&#39;s run after-the-fact, so the sub could do the formatting for you. Maybe even hooked to the worksheet_change event?"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1490803589, "creation_date": 1490803589, "answer_id": 43098734, "question_id": 43098569, "link": "https://stackoverflow.com/questions/43098569/udf-to-return-formatted-number/43098734#43098734", "title": "UDF to return formatted number", "body": "<p>No.</p>\n\n<p>You're confusing a cell's <em>value</em> with its <em>number format</em>. A UDF can compute a <em>value</em>, and the cell is free to format that value as needed.</p>\n\n<p>So if a UDF returns a number, the cell's value is the result of that function - a number.</p>\n\n<p>Just format the cell as needed. A function doesn't format anything.</p>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "accepted_answer_id": 43098734, "answer_count": 1, "score": 1, "last_activity_date": 1490803589, "creation_date": 1490803133, "question_id": 43098569, "link": "https://stackoverflow.com/questions/43098569/udf-to-return-formatted-number", "title": "UDF to return formatted number", "body": "<p>Sometimes I like to display numbers along with text in the same cell. To do this, I custom format the cell to something like 0.00\" test\", e.g. a cell <code>A1</code> with formula <code>=PI()</code>, but formatted with custom format <code>0.00\" test\"</code> would return a displayed result of <code>3.14 test</code>. </p>\n\n<p>Crucially, the value of the cell is unchanged by the formatting - you can still do <code>=A1 * 3</code> in another cell and get the result - since the <em>value</em> of <code>A1</code> is still Pi, only it's display has changed.</p>\n\n<p><strong>For a UDF</strong> that returns a numerical value (in my case, <code>Long</code>, but it could be any number), is there a way of returning a cell such that it is displayed 1 way, but it's actual value (<code>.Value2</code> in VBA I believe) is a number, not text.</p>\n\n<p>I've tried <code>Format(</code> in VBA, but it returns a text string. I would just format my cell how I want it manually, but as you can see from the below code, the formatting is dependent on intermediate results (I'm trying to return the value formatted with the time the calculation took).</p>\n\n<pre><code>UDF_RESULT = Format(valueResult.Length, IIf(tElapsed &lt; timeout, \"0\" &amp; \" \"\"\" &amp; Round(tElapsed, 2) &amp; \"s\"\"\", \"0\"))\n</code></pre>\n\n<p>This would be easy to do with a Macro, but within a UDF it's harder. I could declare all of the intermediate values at a module level, then a <code>Worksheet_Calculate()</code> macro can access those values and apply the custom formatting, but a UDF-wrapped approach would be much better.</p>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1490803092, "post_id": 43098316, "comment_id": 73278500, "body": "<i>This is called fully qualifying an object in VBA</i> - and consistently doing it will spare you many, many, many easily avoidable run-time errors! +1"}, {"owner": {"reputation": 53, "user_id": 6748714, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/658e976d4c48def9afa67d1b846ef87c?s=128&d=identicon&r=PG&f=1", "display_name": "gekko2670", "link": "https://stackoverflow.com/users/6748714/gekko2670"}, "edited": false, "score": 0, "creation_date": 1490805940, "post_id": 43098316, "comment_id": 73280451, "body": "Thanks - Hi. The macro runs if I run it from sheet &#39;Mailinfo&#39;. However, it does not work if I run it from sheet &#39;UKX Trade&#39;. How come this is and how can I fix that please? Thanks"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1490822114, "post_id": 43098316, "comment_id": 73290156, "body": "Store the code in a module, not in the sheet, and fully qualify your objects like I show in my answer... no reason that shouldn&#39;t work?"}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 1, "last_activity_date": 1490858252, "last_edit_date": 1490858252, "creation_date": 1490802501, "answer_id": 43098316, "question_id": 43098007, "link": "https://stackoverflow.com/questions/43098007/retrieve-values-from-two-separate-sheets-in-excel/43098316#43098316", "title": "Retrieve values from two separate sheets in Excel", "body": "<p>You just need to specify where <code>cell</code> is in this line:</p>\n\n<pre><code>For Each cell In Columns(\"P\").Cells.SpecialCells(xlCellTypeConstants)\n' ... add contacts code\nNext cell\n</code></pre>\n\n<p>Do this by:</p>\n\n<pre><code>For Each cell In ThisWorkbook.Sheets(\"Mailinfo\").Columns(\"P\").Cells.SpecialCells(xlCellTypeConstants)\n' ... add contacts code\nNext cell\n</code></pre>\n\n<p>This is called <em>fully qualifying</em> an object in VBA.</p>\n\n<hr>\n\n<p><strong>Edit</strong></p>\n\n<p>So here is your sub, but with things fully qualified. You'll notice that the code you got from Ron de Bruin (RangetoHTML) was already fully qualified. Put this in a <strong>module</strong> not a sheet.</p>\n\n<pre><code>Sub ZC_Collar()\nDim rng As Range\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\nDim StrBody As String\n\nSet rng = Nothing\nOn Error Resume Next\n' Remove this next line, it doesn't do anything because you set rng again anyway\n' Set rng = Selection.SpecialCells(xlCellTypeVisible)\n' only visible cells in ZCCollar range, specifying the sheet (put the correct sheet in)\nSet rng = ThisWorkbook.Sheets(\"UKX Trade\").Range(\"ZCCollar\").SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n    MsgBox \"The selection is not a range or the sheet is protected\" &amp; vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n    Exit Sub\nEnd If\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nWith ThisWorkbook.Sheets(\"UKX Trade\")\n    StrBody = .Range(\"body_line1\").Value &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n              .Range(\"body_line2\").Value &amp; \"&lt;br&gt;\" &amp; _\n              .Range(\"body_line3\").Value\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nOn Error Resume Next\nFor Each cell In ThisWorkbook.Sheets(\"Mailinfo\").Columns(\"P\").Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value Like \"?*@?*.?*\" And LCase(ThisWorkbook.Sheets(\"Mailinfo\").Cells(cell.Row, \"Q\").Value) = \"yes\" Then\n\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n        With OutMail\n            .To = cell.Value\n            .Subject = \"Index Option RFQ\"\n            .CC = ThisWorkbook.Sheets(\"Mailinfo\").Range(\"cc_email\").Value\n            .HTMLBody = StrBody &amp; RangetoHTML(rng) &amp; \"&lt;br&gt;\" &amp; \"Thanks\"\n            .Display  'Or use Send to send each email without displaying it first\n        End With\n        Set OutMail = Nothing\n    End If\nNext cell\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6748714, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/658e976d4c48def9afa67d1b846ef87c?s=128&d=identicon&r=PG&f=1", "display_name": "gekko2670", "link": "https://stackoverflow.com/users/6748714/gekko2670"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490891343, "creation_date": 1490801727, "last_edit_date": 1531164843, "question_id": 43098007, "link": "https://stackoverflow.com/questions/43098007/retrieve-values-from-two-separate-sheets-in-excel", "title": "Retrieve values from two separate sheets in Excel", "body": "<p>I send an email to a list of people. The email is generated by copying a range from one Excel sheet into the body of the email. This works fine. </p>\n\n<p>All the code is below. The sheet that the body of the mail is selected from is called 'UKX Trade\". I want to retrieve the email address data from a separate sheet called \"Mailinfo\". How can I adjust the code for this to work?</p>\n\n<pre><code>Sub ZC_Collar()\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n'Don't forget to copy the function RangetoHTML in the module.\n'Working in Excel 2000-2016\nDim rng As Range\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\nDim StrBody As String\n\nSet rng = Nothing\nOn Error Resume Next\n'Only the visible cells in the selection\nSet rng = Selection.SpecialCells(xlCellTypeVisible)\n'You can also use a fixed range if you want\nSet rng = Range(\"ZCCollar\").SpecialCells(xlCellTypeVisible)\n\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n    MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n           vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n    Exit Sub\nEnd If\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\n\n StrBody = Sheets(\"UKX Trade\").Range(\"body_line1\").Value &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n          Sheets(\"UKX Trade\").Range(\"body_line2\").Value &amp; \"&lt;br&gt;\" &amp; _\n          Sheets(\"UKX Trade\").Range(\"body_line3\").Value\n\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nOn Error Resume Next\nFor Each cell In Columns(\"P\").Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value Like \"?*@?*.?*\" And _\n        LCase(Cells(cell.Row, \"Q\").Value) = \"yes\" Then\n\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n        With OutMail\n            .To = cell.Value\n            .Subject = \"Index Option RFQ\"\n            .CC = Range(\"cc_email\").Value           \n\n            .HTMLBody = StrBody &amp; RangetoHTML(rng) &amp; \"&lt;br&gt;\" &amp; \"Thanks\"\n\n            'You can add files also like this\n            '.Attachments.Add (\"C:\\test.txt\")\n            .Display  'Or use Send\n        End With\n        On Error GoTo 0\n        Set OutMail = Nothing\n    End If\nNext cell\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n\n\nFunction RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2016\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\n\nTempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.readall\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\n\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490802073, "post_id": 43097934, "comment_id": 73277725, "body": "See if this helps you: <a href=\"http://stackoverflow.com/questions/17194105/how-can-i-color-dots-in-a-xy-scatterplot-according-to-column-value/17195673#17195673\" title=\"how can i color dots in a xy scatterplot according to column value\">stackoverflow.com/questions/17194105/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 7468985, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211910060685576/picture?type=large", "display_name": "Diego Luiz", "link": "https://stackoverflow.com/users/7468985/diego-luiz"}, "edited": false, "score": 0, "creation_date": 1530198592, "post_id": 43175120, "comment_id": 89160889, "body": "Thanks for ColorCharts()!"}], "tags": [], "owner": {"reputation": 47, "user_id": 7514313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/75985244251c7f73581aa5abc5137d82?s=128&d=identicon&r=PG&f=1", "display_name": "Planet_Z", "link": "https://stackoverflow.com/users/7514313/planet-z"}, "is_accepted": true, "score": 1, "last_activity_date": 1491180764, "creation_date": 1491180764, "answer_id": 43175120, "question_id": 43097934, "link": "https://stackoverflow.com/questions/43097934/change-color-on-colors-on-pie-chart-based-on-cell-value/43175120#43175120", "title": "Change Color on Colors on Pie Chart Based on Cell Value", "body": "<p>First set in conditional formatting with vba to color each of the chart input cells (% Complete Column) according to the color represented by the Status Column (if Status \"R\" then %Complete color Red) - sample below<br>\n** Note - regular conditional formatting will not work    </p>\n\n<pre><code>Dim status_value As Range\nSet status_value = Sheets(\"Sheet 1\").Cells(20, 3) - \n    If mycell.Value = \"B\" Then\n        mycell2.Interior.color = RGB(0, 112, 192) 'Blue\n    ElseIf mycell.Value = \"R\" Then\n        mycell2.Interior.color = RGB(255, 0, 0) ' Red\n    ElseIf mycell.Value = \"A\" Then\n        mycell2.Interior.color = RGB(255, 192, 0) 'Amber\n    ElseIf mycell.Value = \"G\" Then\n        mycell2.Interior.color = RGB(0, 176, 80) ' Green\n    ElseIf mycell.Value = \"NA\" Then\n        mycell2.Interior.color = RGB(166, 166, 166) 'Grey\n    End If\n</code></pre>\n\n<p>The below code will color the chart according to the interior color of the cells providing the values for the chart</p>\n\n<pre><code>Sub ColorCharts()\n        For Each ch In ActiveSheet.ChartObjects\n            For Each ser In ch.Chart.SeriesCollection\n            s = Split(ser.Formula, \",\")\n                For i = 1 To UBound(ser.Values)\n                    ser.Points(i).Interior.color = Range(s(2)).Cells(i).Interior.color\n                Next i\n            Next ser\n        Next ch\n        End Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7514313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/75985244251c7f73581aa5abc5137d82?s=128&d=identicon&r=PG&f=1", "display_name": "Planet_Z", "link": "https://stackoverflow.com/users/7514313/planet-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5860, "favorite_count": 1, "accepted_answer_id": 43175120, "answer_count": 1, "score": 0, "last_activity_date": 1544800043, "creation_date": 1490801554, "last_edit_date": 1490801998, "question_id": 43097934, "link": "https://stackoverflow.com/questions/43097934/change-color-on-colors-on-pie-chart-based-on-cell-value", "title": "Change Color on Colors on Pie Chart Based on Cell Value", "body": "<p>Hi just getting started with VBA excel - is there a way to color segments of a pie chart based on a value that does not directly feed into the Pie Chart?\nMy sample data would look like this :</p>\n\n<pre><code>        Steps   % Complete    Status\n        Step1         100%          B  (Blue)\n        Step2         50%           R  (Red)\n        Step3         30%           G  (Green)\n        Step4         15%           A  (Yellow)\n</code></pre>\n\n<p>The Pie Chart will be generated only using the first two columns (Steps and % Complete). But I want each of the segments for the pie chart to be colored based on the Status column.</p>\n"}, {"tags": ["excel", "highlight", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490799532, "post_id": 43097176, "comment_id": 73275719, "body": "Why not use Conditional Formating?"}, {"owner": {"reputation": 3, "user_id": 7786651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99109469b75a5b5f60d622f6c4182697?s=128&d=identicon&r=PG&f=1", "display_name": "zach123", "link": "https://stackoverflow.com/users/7786651/zach123"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490799593, "post_id": 43097176, "comment_id": 73275777, "body": "when I tried using conditional formatting it only highlighted the date and not everything else"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490799796, "post_id": 43097176, "comment_id": 73275935, "body": "You need to apply the rule to all the columns and make the reference to column I absolute."}, {"owner": {"reputation": 3, "user_id": 7786651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99109469b75a5b5f60d622f6c4182697?s=128&d=identicon&r=PG&f=1", "display_name": "zach123", "link": "https://stackoverflow.com/users/7786651/zach123"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490799880, "post_id": 43097176, "comment_id": 73275999, "body": "I am fairly new with using conditional formatting. Can you give me an example of what that would look like?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1490800073, "post_id": 43097176, "comment_id": 73276171, "body": "Highlight columns B through I.  Click on conditional formatting.  Add new rule.  Use formula.  Put in this formula: <code>=$I1 = Today()</code>.  Choose your desired formatting, click ok on both screens."}, {"owner": {"reputation": 3, "user_id": 7786651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99109469b75a5b5f60d622f6c4182697?s=128&d=identicon&r=PG&f=1", "display_name": "zach123", "link": "https://stackoverflow.com/users/7786651/zach123"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490800479, "post_id": 43097176, "comment_id": 73276489, "body": "Nothing happens when I do that"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1490801059, "post_id": 43097176, "comment_id": 73276899, "body": "Try this formula: <code>=INT($I1)=INT(TODAY())</code>  If that does not work then your dates are not true dates but text that look like dates."}, {"owner": {"reputation": 3, "user_id": 7786651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99109469b75a5b5f60d622f6c4182697?s=128&d=identicon&r=PG&f=1", "display_name": "zach123", "link": "https://stackoverflow.com/users/7786651/zach123"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490801376, "post_id": 43097176, "comment_id": 73277149, "body": "Thanks Scott, that got it done!"}], "owner": {"reputation": 3, "user_id": 7786651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99109469b75a5b5f60d622f6c4182697?s=128&d=identicon&r=PG&f=1", "display_name": "zach123", "link": "https://stackoverflow.com/users/7786651/zach123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490997323, "creation_date": 1490799472, "last_edit_date": 1531164843, "question_id": 43097176, "link": "https://stackoverflow.com/questions/43097176/vba-to-highlight-the-entire-column-with-the-current-date", "title": "VBA to highlight the entire column with the current date", "body": "<p>I have information running through (\"B:I\"). The dates are located in I.</p>\n\n<p>I wanted to make a VBA code that will find the current date and highlight that entire column. </p>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 2847, "user_id": 382588, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f52bc4ad81523f13d2275097f925a367?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/382588/asaf"}, "edited": false, "score": 0, "creation_date": 1490799227, "post_id": 43096795, "comment_id": 73275440, "body": "my solution was to join all the ranges in a new worksheet and than send the entire rng (sheet) as one block"}, {"owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "reply_to_user": {"reputation": 2847, "user_id": 382588, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f52bc4ad81523f13d2275097f925a367?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/382588/asaf"}, "edited": false, "score": 0, "creation_date": 1490799499, "post_id": 43096795, "comment_id": 73275687, "body": "I thought of that, but it seems cumbersome to me, especially since I have several text headers for the ranges which I am manually adding in the body of the email."}, {"owner": {"reputation": 2847, "user_id": 382588, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f52bc4ad81523f13d2275097f925a367?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/382588/asaf"}, "edited": false, "score": 0, "creation_date": 1490805928, "post_id": 43096795, "comment_id": 73280438, "body": "copy paste and keep track of the last line for headers last line +=2 for range last line += range. rows. count. sorry for not remembering the right code"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1490831524, "post_id": 43096795, "comment_id": 73293512, "body": "Can you share an example of your spreadsheet?"}], "answers": [{"tags": [], "owner": {"reputation": 360, "user_id": 3368499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b423054f8db73de88e1c7643354f96b?s=128&d=identicon&r=PG&f=1", "display_name": "sten", "link": "https://stackoverflow.com/users/3368499/sten"}, "is_accepted": false, "score": 0, "last_activity_date": 1490805886, "creation_date": 1490805886, "answer_id": 43099479, "question_id": 43096795, "link": "https://stackoverflow.com/questions/43096795/send-email-with-multiple-rangetohtml-ranges/43099479#43099479", "title": "Send Email With Multiple RangeToHTML Ranges", "body": "<p>It appears that you're pulling both ranges from the same sheet, it's the same sheet only with filtering.</p>\n\n<p>Set input to Completed\nSet input to Incomplete</p>\n\n<p>completed = RangetoHTML(input) //you're reading the incompletes\nincomplete = RangetoHTML(input) //you're reading the incompletes again</p>\n\n<p>Instead try this</p>\n\n<p>Set input to Completed\nhtmlBodyBuffer = RangetoHTML(input) </p>\n\n<p>Set input to Incomplete\n.HTMLBody = htmlBodyBuffer &amp; RangetoHTML(input)</p>\n"}, {"tags": [], "owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "is_accepted": true, "score": 0, "last_activity_date": 1491232052, "creation_date": 1491232052, "answer_id": 43188163, "question_id": 43096795, "link": "https://stackoverflow.com/questions/43096795/send-email-with-multiple-rangetohtml-ranges/43188163#43188163", "title": "Send Email With Multiple RangeToHTML Ranges", "body": "<p>This was solved using the suggestion from @Asaf to use a \"holding\" sheet to combine the ranges and then pasting the HTML to email.</p>\n\n<pre><code>Sub Monthly_Close_Daily_Report()\n'\n'\nDim yearMonth As String\nDim closeDay As String\nDim currTime As String\nDim summaryRange As Range\nDim completedTasks As Range\nDim incompleteTasks As Range\nDim placeholderRange As Range\nDim emailRng As Range, cl As Range\nDim lastRow As Long, x As Long\nDim sTo As String\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nSheets(\"Inputs\").Select\n\n'Check to make sure there are no errors, then proceed\nIf Not IsError(Sheets(\"Inputs\").Range(\"B12\")) Then\n    If Sheets(\"Inputs\").Range(\"B12\") = \"Yes\" Then\n        'Store the YY-MM as a variable\n        Sheets(\"Inputs\").Select\n        yearMonth = Range(\"B4\").Value\n\n        'Store the MM/DD/YYYY as a variable\n        Sheets(\"Inputs\").Select\n        closeDay = Range(\"B5\").Value\n\n        'Store the current time as a variable\n        Sheets(\"Inputs\").Select\n        currTime = Format(Now(), \"h:mmAM/PM\")\n\n        'Unfilter the Task Listing tab\n        Sheets(\"Task Listing\").Select\n        Range(\"A1\").Select\n        Selection.AutoFilter\n\n        'Refresh the table with new Sharepoint data\n        ActiveWorkbook.Connections(\"SharePoint\").Refresh\n\n            'Create a new email with the Email Listing tab in the \"To\" line, and Alan and Tim cc'd\n            Set OutApp = CreateObject(\"Outlook.Application\")\n            Set OutMail = OutApp.CreateItem(0)\n\n            'Determine the email addresses to send to\n            Set emailRng = Worksheets(\"Email Listing\").Range(\"B2:B50\")\n            For Each cl In emailRng\n                sTo = sTo &amp; \";\" &amp; cl.Value\n            Next\n            sTo = Mid(sTo, 2)\n\n            'Set the Summary range to be copied into the email\n            Set summaryRange = Sheets(\"Summary\").Range(\"A1:G11\")\n            summaryRange.Copy\n\n            'Filter the table for \"Completed\" and then add it to the placeholder tab to be converted to HTML\n            Sheets.Add(After:=Worksheets(Worksheets.Count)).Name = \"Placeholder\"\n            Range(\"A1\").Select\n            ActiveCell.FormulaR1C1 = \"Completed Tasks\"\n            With Selection.Font\n                .Name = \"Arial\"\n                .Size = 18\n                .ThemeColor = xlThemeColorLight1\n            End With\n            Selection.Font.Bold = True\n            Sheets(\"Task Listing\").Select\n            ActiveSheet.ListObjects(\"Close_Tasks\").Range.AutoFilter Field:=1, Criteria1:=yearMonth, Operator:=xlFilterValues\n            ActiveSheet.ListObjects(\"Close_Tasks\").Range.AutoFilter Field:=6, Criteria1 _\n                :=\"Completed\"\n            ActiveSheet.UsedRange.Select\n            Selection.SpecialCells(xlCellTypeVisible).Select\n            Selection.Copy\n            Sheets(\"Placeholder\").Select\n            Range(\"A3\").Select\n            ActiveSheet.Paste\n\n            'Find the last row of the \"Placeholder\" sheet\n            lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n            'Copy the format to the \"Incomplete\" section header\n            Range(\"A1\").Select\n            Selection.Copy\n            Range(\"A\" &amp; lastRow + 3).Select\n            ActiveSheet.Paste\n            ActiveCell.FormulaR1C1 = \"Incomplete Tasks\"\n\n            'Filter the table for \"Incomplete\" and then add it to the placeholder tab to be converted to HTML\n            Sheets(\"Task Listing\").Select\n            ActiveSheet.ListObjects(\"Close_Tasks\").Range.AutoFilter Field:=6, Criteria1 _\n                :=\"=In Progress\", Operator:=xlOr, Criteria2:=\"=Not Started\"\n            ActiveSheet.UsedRange.Select\n            Selection.SpecialCells(xlCellTypeVisible).Select\n            Selection.Copy\n            Sheets(\"Placeholder\").Select\n\n            'Find the new last row of the \"Placeholder\" tab\n            lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n            'Paste the incomplete tasks to the \"Placeholder\" tab\n            Range(\"A\" &amp; lastRow + 1).Select\n            ActiveSheet.Paste\n\n            'Format the \"Placeholder\" tab\n            Cells.Select\n            With Selection\n                .WrapText = False\n                .Orientation = 0\n                .AddIndent = False\n                .IndentLevel = 0\n                .ShrinkToFit = False\n                .ReadingOrder = xlContext\n                .MergeCells = False\n            End With\n            Cells.EntireColumn.AutoFit\n\n            'Find the new last row of the \"Placeholder\" tab\n            lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n            'Make the entire \"Placeholder\" sheet the placeholderRange\n            Set placeholderRange = Range(\"A1:G\" &amp; lastRow)\n\n            'On Error Resume Next\n            With OutMail\n                .To = sTo\n                .CC = \"\"\n                .BCC = \"\"\n                .Subject = \"Month End Close Status for \" &amp; yearMonth &amp; \" As Of \" &amp; currTime &amp; \" on \" &amp; closeDay\n                '.HTMLBody = RangetoHTML(summaryRange) &amp; \"&lt;br&gt;&lt;br&gt;&lt;strong&gt;Completed Tasks\" &amp; RangetoHTML(completedTasks) &amp; \"&lt;br&gt;&lt;br&gt;&lt;strong&gt;Incomplete Tasks\" &amp; RangetoHTML(incompleteTasks)\n                .HTMLBody = RangetoHTML(summaryRange) &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; RangetoHTML(placeholderRange)\n                .Display 'Can also use .Send which will send the email.  We want to preview before sending, though.\n            End With\n\n            Set OutMail = Nothing\n            Set OutApp = Nothing\n\n    Else\n        'If tasks are missing Due Dates, flag those for the user and exit the macro\n        MsgBox (\"There are \"\"Due Dates\"\" missing for some tasks.  Please correct the issue and run the macro again.\")\n    End If\n\nEnd If\n\n    'Delete the Placeholder tab\n    Sheets(\"Placeholder\").Delete\n\n    'Filter the \"Task Listing\" tab for the current month\n    Sheets(\"Task Listing\").Select\n    Range(\"A2\").Select\n    Selection.AutoFilter\n    ActiveSheet.ListObjects(\"Close_Tasks\").Range.AutoFilter Field:=1, Criteria1:=yearMonth, Operator:=xlFilterValues\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\n'\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1986, "favorite_count": 1, "accepted_answer_id": 43188163, "answer_count": 2, "score": 2, "last_activity_date": 1491232052, "creation_date": 1490798584, "last_edit_date": 1490831072, "question_id": 43096795, "link": "https://stackoverflow.com/questions/43096795/send-email-with-multiple-rangetohtml-ranges", "title": "Send Email With Multiple RangeToHTML Ranges", "body": "<p>I am using some code copied from Ron de Bruin's website (awesome, btw) and am running into a snag.  </p>\n\n<p>The email that's generated will paste only the header to the <code>completedTasks</code> range.  </p>\n\n<p>It will correctly paste the <code>Summary</code> and <code>incompletedTasks</code> ranges to the body of the email.  </p>\n\n<p>If I remove all code dealing with <code>incompletedTasks</code> then it will correctly paste the <code>Summary</code> and <code>completedTasks</code> HTML to the email body.  </p>\n\n<p>Thanks in advance for any help.</p>\n\n<pre><code>Function RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2016\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    'Read all data from the htm file into RangetoHTML\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    'Close TempWB\n    TempWB.Close savechanges:=False\n\n    'Delete the htm file we used in this function\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function\n\n\nSub Monthly_Close_Daily_Report()\n'\n'\n\nDim yearMonth As String\nDim closeDay As String\nDim currTime As String\nDim summaryRange As Range\nDim completedTasks As Range\nDim incompleteTasks As Range\nDim emailRng As Range, cl As Range\nDim sTo As String\n\nApplication.ScreenUpdating = False\nSheets(\"Inputs\").Select\n\n'Check to make sure there are no errors, then proceed\nIf Not IsError(Sheets(\"Inputs\").Range(\"B12\")) Then\n    If Sheets(\"Inputs\").Range(\"B12\") = \"Yes\" Then\n        'Store the YY-MM as a variable\n        Sheets(\"Inputs\").Select\n        yearMonth = Range(\"B4\").Value\n\n        'Store the MM/DD/YYYY as a variable\n        Sheets(\"Inputs\").Select\n        closeDay = Range(\"B5\").Value\n\n        'Store the current time as a variable\n        Sheets(\"Inputs\").Select\n        currTime = Format(Now(), \"h:mmAM/PM\")\n\n        'Unfilter the Task Listing tab\n        Sheets(\"Task Listing\").Select\n        Activesheet.ShowAllData\n\n        'Refresh the table with new Sharepoint data\n        ActiveWorkbook.Connections(\"SharePoint\").Refresh\n\n            'Create a new email with the Email Listing tab in the \"To\" line\n            Set OutApp = CreateObject(\"Outlook.Application\")\n            Set OutMail = OutApp.CreateItem(0)\n\n            'Determine the email addresses to send to\n            Set emailRng = Worksheets(\"Email Listing\").Range(\"B2:B50\")\n            For Each cl In emailRng\n                sTo = sTo &amp; \";\" &amp; cl.Value\n            Next\n            sTo = Mid(sTo, 2)\n\n            'Set the Summary range to be copied into the email\n            Set summaryRange = Sheets(\"Summary\").Range(\"A1:G11\")\n            summaryRange.Copy\n\n            'Filter the Task Listing tab for this month's completed tasks &amp; copy to range\n            Sheets(\"Task Listing\").Select\n            ActiveSheet.ListObjects(\"Close_Tasks\").Range.AutoFilter Field:=1, Criteria1:=yearMonth, Operator:=xlFilterValues\n            ActiveSheet.ListObjects(\"Close_Tasks\").Range.AutoFilter Field:=6, Criteria1 _\n                :=\"Completed\"\n            Set completedTasks = Application.Intersect(ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible), Range(\"A:G\"))\n            'Set completedTasks = Sheets(\"Task Listing\").UsedRange.SpecialCells(xlCellTypeVisible)\n            Worksheets(\"Task Listing\").ShowAllData\n\n            'Filter the Task Listing tab for this month's non-completed tasks &amp; copy to range\n            ActiveSheet.ListObjects(\"Close_Tasks\").Range.AutoFilter Field:=1, Criteria1:=yearMonth, Operator:=xlFilterValues\n            ActiveSheet.ListObjects(\"Close_Tasks\").Range.AutoFilter Field:=6, Criteria1:=\"&lt;&gt;Completed\"\n            Set incompleteTasks = Application.Intersect(ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible), Range(\"A:G\"))\n\n            'On Error Resume Next\n            With OutMail\n                .To = sTo\n                .CC = \"\"\n                .BCC = \"\"\n                .Subject = \"Month End Close Status for \" &amp; yearMonth &amp; \" As Of \" &amp; currTime &amp; \" on \" &amp; closeDay\n                .HTMLBody = RangetoHTML(summaryRange) &amp; \"&lt;br&gt;&lt;br&gt;&lt;strong&gt;Completed Tasks\" &amp; RangetoHTML(completedTasks) &amp; \"&lt;br&gt;&lt;br&gt;&lt;strong&gt;Incomplete Tasks\" &amp; RangetoHTML(incompleteTasks)\n                .Display 'Can also use .Send which will send the email.  We want to preview before sending, though.\n            End With\n\n            Set OutMail = Nothing\n            Set OutApp = Nothing\n\n    Else\n        'If tasks are missing Due Dates, flag those for the user and exit the macro\n        MsgBox (\"There are \"\"Due Dates\"\" missing for some tasks.  Please correct the issue and run the macro again.\")\n    End If\n\nEnd If\n\n    'Filter the \"Task Listing\" tab for the current month\n    Sheets(\"Task Listing\").Select\n    Range(\"A2\").Select\n    Selection.AutoFilter\n    ActiveSheet.ListObjects(\"Close_Tasks\").Range.AutoFilter Field:=1, Criteria1:=yearMonth, Operator:=xlFilterValues\n\n'\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1490798678, "post_id": 43096639, "comment_id": 73274961, "body": "I&#39;m not getting any compile errors for your code. What version of Excel are you using? One issue I can see is that the <code>RangetoHTML</code> function does not specify a return type (but it defaults to <code>Variant</code>, so it&#39;s not giving an error)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490798881, "post_id": 43096639, "comment_id": 73275135, "body": "I don&#39;t see any issues with the code actually. It just run fine with a test sheet."}, {"owner": {"reputation": 1, "user_id": 7786454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0615b5ee71914da84e1136bfe7964728?s=128&d=identicon&r=PG&f=1", "display_name": "LogieBear", "link": "https://stackoverflow.com/users/7786454/logiebear"}, "edited": false, "score": 0, "creation_date": 1490799779, "post_id": 43096639, "comment_id": 73275921, "body": "It is really frustrating as it used to work fine and in the last week it has stopped working. do you think it could be a version of excel thing?  There must be an answer"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1490802660, "post_id": 43096639, "comment_id": 73278177, "body": "You&#39;ve almost certainly created a function or other routine called <code>Format</code>. Put the cursor on the word <code>Format</code> and press Shift+f2"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1490807420, "post_id": 43096639, "comment_id": 73281433, "body": "perhaps one of your Tools -&gt; References is unchecked?"}, {"owner": {"reputation": 1, "user_id": 7786454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0615b5ee71914da84e1136bfe7964728?s=128&d=identicon&r=PG&f=1", "display_name": "LogieBear", "link": "https://stackoverflow.com/users/7786454/logiebear"}, "edited": false, "score": 0, "creation_date": 1490863631, "post_id": 43096639, "comment_id": 73305470, "body": "Rory nailed it on the head. Thanks guys"}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1490808546, "creation_date": 1490808546, "answer_id": 43100272, "question_id": 43096639, "link": "https://stackoverflow.com/questions/43096639/rangetohtml-no-longer-working/43100272#43100272", "title": "RangetoHTML no longer working", "body": "<pre><code>Sub testFunction()\n'   Try testing the function like this to pinpoint the problem\n'   It works fine for me on Excel 2013\n'   Cool function, btw\nDim rng As Range\nDim someString As String\n\n    Set rng = Sheets(\"ERC NPA\").Range(\"B2:H23\").SpecialCells(xlCellTypeVisible)\n    someString = RangetoHTML(rng)\n    Debug.Print someString\n\nSet rng = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14738599, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5db4de2d4925b44e4336f5f9d27eedc4?s=128&d=identicon&r=PG", "display_name": "Arun Yadav", "link": "https://stackoverflow.com/users/14738599/arun-yadav"}, "is_accepted": false, "score": 0, "last_activity_date": 1606781942, "creation_date": 1606781942, "answer_id": 65083020, "question_id": 43096639, "link": "https://stackoverflow.com/questions/43096639/rangetohtml-no-longer-working/65083020#65083020", "title": "RangetoHTML no longer working", "body": "<p>Change the name of Macro Coding named &quot;Format&quot; to something else. In the &quot;Function&quot; it is calling that macro however it is meant for temp file.</p>\n"}], "owner": {"reputation": 1, "user_id": 7786454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0615b5ee71914da84e1136bfe7964728?s=128&d=identicon&r=PG&f=1", "display_name": "LogieBear", "link": "https://stackoverflow.com/users/7786454/logiebear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3332, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1606781942, "creation_date": 1490798204, "last_edit_date": 1531164843, "question_id": 43096639, "link": "https://stackoverflow.com/questions/43096639/rangetohtml-no-longer-working", "title": "RangetoHTML no longer working", "body": "<p>When I run the macro I get </p>\n\n<blockquote>\n  <p>Compile Error: Wrong number of arguements or invalid property assignment</p>\n</blockquote>\n\n<p>the <code>Function RangetoHTML(rng As Range)</code> is highlighted yellow and format in the <code>TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"</code> line is highlighted gray</p>\n\n<pre><code>Sub GenerateEmail()\n\n    Dim rng As Range\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    MsgBox \"This will generate an email, please check Outlook\"\n\n    Set rng = Sheets(\"ERC NPA\").Range(\"B2:H23\").SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .To = \"\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = Range(\"G13\") &amp; \" : Payment Request\"\n        .HTMLBody = \"Please find below payment request form\" &amp; RangetoHTML(rng)\n        .display\n    End With\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Function RangetoHTML(rng As Range)\n\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    'Read all data from the htm file into RangetoHTML\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    'Close TempWB\n    TempWB.Close savechanges:=False\n\n    'Delete the htm file we used in this function\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 4, "creation_date": 1490798108, "post_id": 43096523, "comment_id": 73274471, "body": "You can&#39;t clear an exception without a Resume statement, your code ending, or <code>On Error Goto -1</code>. See: <a href=\"http://excelmatters.com/2015/03/17/on-error-wtf/\" rel=\"nofollow noreferrer\">excelmatters.com/2015/03/17/on-error-wtf</a>  You could just use <code>Dir</code> to check if the files exist though."}], "answers": [{"comments": [{"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "edited": false, "score": 0, "creation_date": 1490799859, "post_id": 43096995, "comment_id": 73275989, "body": "@ Robin The <code>MsgBox</code> will pop up if it cant find anything but it does nothing when it should find a PDF."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "edited": false, "score": 0, "creation_date": 1490800018, "post_id": 43096995, "comment_id": 73276118, "body": "I pretty much followed your logic except for a few checks you are doing... what isn&#39;t working?"}, {"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "edited": false, "score": 0, "creation_date": 1490800318, "post_id": 43096995, "comment_id": 73276362, "body": "@ Robin No Hyperlinks are opening. Any idea why?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "edited": false, "score": 1, "creation_date": 1490800521, "post_id": 43096995, "comment_id": 73276513, "body": "@MattTaylor why not use a <code>Shell</code> command to open the PDF instead of hacking it up with <code>FollowHyperlink</code> and <code>SendKeys</code>?"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1490800657, "post_id": 43096995, "comment_id": 73276599, "body": "Nope - sorry - just copied that bit from your code. I was just trying to show you a better way to do the control flow and avoid the multiple On Error statements. HTH"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 2, "last_activity_date": 1490799045, "last_edit_date": 1495540449, "creation_date": 1490799045, "answer_id": 43096995, "question_id": 43096523, "link": "https://stackoverflow.com/questions/43096523/excel-multiple-on-error-goto/43096995#43096995", "title": "excel multiple on error goto", "body": "<p>Using multiple <code>On Error Goto XYZ</code> handlers for control flow is over-complicating some easy validation checks you can do and then simply use the error handling for actual errors.</p>\n\n<p>As @Rory pointed out in a comment you can use the <a href=\"https://stackoverflow.com/questions/11573914/check-if-the-file-exists-using-vba\"><code>Dir</code></a> function. You can combine the use of <code>Dir</code> with an <code>If...ElseIf...Else...End If</code> construct to control what you code does:</p>\n\n<pre><code>Option Explicit\n\nSub Cutsheets()\n\n    On Error GoTo ErrHandler\n\n    Dim strLocalCheck As String\n    Dim strNetworkCheck As String\n\n    'check for files - Dir will return \"\" if file not found\n    strLocalCheck = Dir(\"C:\\Local\" &amp; ActiveCell.Value &amp; \".pdf\")\n    strNetworkCheck = Dir(\"P:\\Network\" &amp; ActiveCell.Value &amp; \".pdf\")\n\n    'control flow\n    If strLocalCheck &lt;&gt; \"\" Then\n        ActiveWorkbook.FollowHyperlink strLocalCheck\n        Application.SendKeys \"{ENTER}\", True\n\n    ElseIf strNetworkCheck &lt;&gt; \"\" Then\n        ActiveWorkbook.FollowHyperlink strNetworkCheck\n        Application.SendKeys \"{ENTER}\", True\n\n    Else\n        MsgBox \"No cutsheet can be found for this item.\"\n\n    End If\n\n    Exit Sub\n\nErrHandler:\n    Debug.Print \"A real error occurred: \" &amp; Err.Description\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1506018748, "last_edit_date": 1506018748, "creation_date": 1490799872, "answer_id": 43097321, "question_id": 43096523, "link": "https://stackoverflow.com/questions/43096523/excel-multiple-on-error-goto/43097321#43097321", "title": "excel multiple on error goto", "body": "<blockquote>\n  <p><em>I am trying to get multiple on error statements to work</em></p>\n</blockquote>\n\n<p>Don't.</p>\n\n<p>Imagine you're the VBA runtime. You're executing a procedure called <code>Cutsheets</code>, and you come across this instruction:</p>\n\n<pre><code>On Error GoTo net1\n</code></pre>\n\n<p>From that point on, before you blow up in the user's face, you're going to jump to the <code>net1</code> label if you ever encounter a run-time error. So you keep running instructions. Eventually you run this line:</p>\n\n<pre><code>ActiveWorkbook.FollowHyperlink \"C:\\Local\" &amp; ActiveCell &amp; \".pdf\"\n</code></pre>\n\n<p>And when the <code>FollowHyperlink</code> method responds with \"uh nope, can't do that\" and raises a run-time error, your execution context changes.</p>\n\n<p>You're in \"error handling\" mode.</p>\n\n<p>So you jump to the <code>net1</code> label. <strong>You're in \"error handling\" mode</strong>. There are certain things you can do in \"normal execution mode\" that you can't (or <em>shouldn't</em>) do in \"error handling mode\". Raising and handling more errors is one of these things.</p>\n\n<pre><code>On Error GoTo whoa\n</code></pre>\n\n<p>You're <em>already</em> handling a run-time error: what should you do when you encounter that statement in an error handler subroutine? Jump to the <code>whoa</code> right away?</p>\n\n<p>When the VBA runtime is in \"error handling mode\", your job as a programmer is to <em>handle runtime errors</em> and do everything you can to get back to \"normal execution mode\" <strong>as soon as possible</strong> - and that's normally done with a <code>Resume</code> instruction, or by leaving the current scope.</p>\n\n<p>Copying a chunk of code from the \"normal execution path\" and trying to run it (slightly altered) in \"error handling mode\" isn't <em>handling errors and getting back to normal execution mode as soon as possible</em>.</p>\n\n<p>Error handling or not, <em>copy-pasting</em> chunks of code is poorly written code anyway.</p>\n\n<p>Extract a procedure instead:</p>\n\n<pre><code>Private Sub OpenPortableDocumentFile(ByVal path As String)\n    On Error GoTo ErrHandler\n    ActiveWorkbook.FollowHyperlink path\n    Application.SendKeys \"{ENTER}\", True\n    Exit Sub\nErrHandler:\n    MsgBox \"Could not open file '\" &amp; path &amp; \"'.\"\nEnd Sub\n</code></pre>\n\n<p>Now that that's out of the way, clean up your control flow by verifying if the file exists before you pass an invalid <code>path</code> to the <code>OpenPortableDocumentFile</code> procedure.</p>\n\n<p>The best error handling strategy is to avoid raising run-time errors in the first place.</p>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2164, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1506018748, "creation_date": 1490797903, "question_id": 43096523, "link": "https://stackoverflow.com/questions/43096523/excel-multiple-on-error-goto", "title": "excel multiple on error goto", "body": "<p>I am trying to get multiple on error statements to work and can't figure it out.</p>\n\n<p>If pdf can be found in local then open, if not then open network location. If there is no PDF in then return msgbox.</p>\n\n<pre><code>Sub Cutsheets()\nApplication.ScreenUpdating = False\n\nDim finalrow As Integer\n\nfinalrow = Cells(Rows.Count, 1).End(xlUp).Row\nOn Error GoTo net1\n\nIf Not Application.Intersect(ActiveCell, Range(\"A9:A\" &amp; finalrow)) Is Nothing Then\n    'Local Location\nActiveWorkbook.FollowHyperlink \"C:\\Local\" &amp; ActiveCell &amp; \".pdf\"\nApplication.SendKeys \"{ENTER}\", True\nEnd If\nExit Sub\n\nnet1:\nIf Not Application.Intersect(ActiveCell, Range(\"A9:A\" &amp; finalrow)) Is Nothing Then\n    'Network Location\nOn Error GoTo whoa\nActiveWorkbook.FollowHyperlink \"P:\\Network\" &amp; ActiveCell &amp; \".pdf\"\nApplication.SendKeys \"{ENTER}\", True\nEnd If\nExit Sub\n\nwhoa:\nMsgBox (\"No cutsheet can be found for this item.\")\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Also I don't remember why I put <code>sendkeys</code> in there but it doesn't work without it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1490798192, "post_id": 43096447, "comment_id": 73274551, "body": "How about inserting a <code>ListBox</code> into the form and the setting the <code>RowSource</code> to the data you want to display? <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251646.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg251646.aspx</a> If you prefer you can also use a <code>ListView</code>: <a href=\"http://www.xl-central.com/fill-a-listview-on-a-userform.html\" rel=\"nofollow noreferrer\">xl-central.com/fill-a-listview-on-a-userform.html</a> Alternative answers are here: <a href=\"http://stackoverflow.com/questions/5904696/put-a-user-form-directly-on-the-excel-sheet\" title=\"put a user form directly on the excel sheet\">stackoverflow.com/questions/5904696/&hellip;</a> AND here: <a href=\"http://stackoverflow.com/questions/13527540/how-to-display-part-of-excel-on-vba-form\" title=\"how to display part of excel on vba form\">stackoverflow.com/questions/13527540/&hellip;</a>"}, {"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490798732, "post_id": 43096447, "comment_id": 73275017, "body": "when i use the ListBox  it&#39;s only displaying me the first column. For the ListView i get the error &quot;,ethod or data member not found&quot;. and for the two other link you post i tryed to adapt the code from the last one to my needs, but isn&#39;t working."}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 1, "creation_date": 1490801966, "post_id": 43096447, "comment_id": 73277629, "body": "you can use the property of a listbox, &quot;ColumnCount&quot;, and give it the number of the columns in your sheet."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 0, "creation_date": 1490861792, "post_id": 43099806, "comment_id": 73304285, "body": "still there it&#39;s a problem i notice just now the listbox isn&#39;t showing all the columns. i was trying the lines code for another sheet wich have 17 columns and it&#39;s only show me 15 columns. I also added this ListBox1.ColumnCount = 17, but it&#39;s not working"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 1, "creation_date": 1490885161, "post_id": 43099806, "comment_id": 73321631, "body": "Open the form in the editor.  Look at the properties box.  You have physiclaly change the property in the properties box to 17.  You can&#39;t do it with code."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": true, "score": 0, "last_activity_date": 1490807033, "creation_date": 1490807033, "answer_id": 43099806, "question_id": 43096447, "link": "https://stackoverflow.com/questions/43096447/how-to-display-a-worksheet-on-a-form-in-excel-vba/43099806#43099806", "title": "How to display a worksheet on a form in excel-vba", "body": "<p>Build a form with a listbox on it, and also a button.  Then put this code into the form module.  The button should have the name CommandButton1 and the listbox should be named ListBox1.</p>\n\n<p>Finally on the listbox control change the columncount to 15.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Unload Me\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n    ' Activate the sheet that has the data you want displayed in the listbox\n    Sheet1.Activate\n    ' Put the range of the data you want displayed.\n    ' Here I used columns \"A\" to \"O\" and 2000 rows\n    ListBox1.RowSource = \"A1:O2000\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4415, "favorite_count": 0, "accepted_answer_id": 43099806, "answer_count": 1, "score": 0, "last_activity_date": 1490807033, "creation_date": 1490797750, "last_edit_date": 1531164843, "question_id": 43096447, "link": "https://stackoverflow.com/questions/43096447/how-to-display-a-worksheet-on-a-form-in-excel-vba", "title": "How to display a worksheet on a form in excel-vba", "body": "<p>I'm trying to display a worksheet on a form, but until now i did not succeed. The worksheet it contain 15 columns and about 2000 rows. Can someone help me? </p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "edited": false, "score": 0, "creation_date": 1490798715, "post_id": 43096336, "comment_id": 73275001, "body": "Is ICN definitely a numeric field and the other fields strings? Do you have any sample data?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "edited": false, "score": 0, "creation_date": 1490802915, "post_id": 43097015, "comment_id": 73278363, "body": "That did it man, thank you so much! You have no idea how long I&#39;ve been banging my head against the wall with this."}, {"owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "edited": false, "score": 0, "creation_date": 1490811626, "post_id": 43097015, "comment_id": 73284083, "body": "Running into one small issue now that that is fixed. It will only let me add one record. If I fill in the text boxes and add a record and then try to repeat the process and add another, once I click Add it flashes like it runs the process, but then nothing happens - no record is added. Any idea what I can do to fix that?"}, {"owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "edited": false, "score": 0, "creation_date": 1490811970, "post_id": 43097015, "comment_id": 73284298, "body": "Ignore my previous comment, this is the issue I&#39;m having now:Running into one small issue now that that is fixed. It will only let me add one record. If there is already a record in the main table, it won&#39;t add a record. If the table is blank and then I try to add a record then it works. Any idea how I can fix that?"}, {"owner": {"reputation": 11, "user_id": 5024422, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-z7hSGmDNlsg/AAAAAAAAAAI/AAAAAAAAEVQ/nqsvw8AMyw8/photo.jpg?sz=128", "display_name": "Satoru Kishi", "link": "https://stackoverflow.com/users/5024422/satoru-kishi"}, "reply_to_user": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "edited": false, "score": 0, "creation_date": 1490874524, "post_id": 43097015, "comment_id": 73313130, "body": "No ideia, man. Try debugging the cmdAdd_Click method and make sure it is running the INSERT part twice."}], "tags": [], "owner": {"reputation": 11, "user_id": 5024422, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-z7hSGmDNlsg/AAAAAAAAAAI/AAAAAAAAEVQ/nqsvw8AMyw8/photo.jpg?sz=128", "display_name": "Satoru Kishi", "link": "https://stackoverflow.com/users/5024422/satoru-kishi"}, "is_accepted": false, "score": 1, "last_activity_date": 1490799083, "creation_date": 1490799083, "answer_id": 43097015, "question_id": 43096336, "link": "https://stackoverflow.com/questions/43096336/getting-a-syntax-error-in-insert-into-statement/43097015#43097015", "title": "Getting a Syntax error in INSERT INTO statement", "body": "<p>The problem may be:\nYour new table <code>tblInventory</code> has a column <code>DESC</code> which is a SQL reserved keyword. You have two options:</p>\n\n<ol>\n<li>Drop the column <code>DESC</code> and create a new column with different name OR;</li>\n<li>Add brackets to your script like this: <code>INSERT INTO tblInventory([ICN], [manu], [model], [serial], [desc], [dateRec], [dateRem], [dispo], [project], [AMCA], [UL], [comments])</code>.</li>\n</ol>\n\n<p>Please check a full list of SQL reserved keywords: <a href=\"https://docs.microsoft.com/en-us/sql/t-sql/language-elements/reserved-keywords-transact-sql\" rel=\"nofollow noreferrer\">Reserved Keywords-Transact-SQL</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490799083, "creation_date": 1490797482, "question_id": 43096336, "link": "https://stackoverflow.com/questions/43096336/getting-a-syntax-error-in-insert-into-statement", "title": "Getting a Syntax error in INSERT INTO statement", "body": "<p>I need help figuring out why I'm getting this syntax error when trying to run this code in Microsoft Access. I am working on this database for work and have some experience with it, but not a whole lot.</p>\n\n<p>I created a database before the one I'm currently working on and it works fine. It is very similar to the database that I'm working on now, so I just copied it and then renamed the fields and text boxes and everything to match the information that this database will be handling.</p>\n\n<p>Essentially I have a table with the data and then I want a form that has a text box for each field in the table with a subtable of the main table incorporated into the form. The user fills in the text boxes with the information and then either adds it to the table or they can click on a record and edit it or delete it with the corresponding buttons on the form.</p>\n\n<p>Now I'm getting a runtime error '3134': syntax error in INSERT INTO statement when trying to click the add button on one of my forms. This only happens on the add button and consequently the update button if it is set to update, but all of the other buttons work fine.</p>\n\n<p>Here is the code for the new database:</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub cmdAdd_Click()\n    'when we click on button Add there are two options\n    '1. for insert\n    '2. for update\n    If Me.txtICN.Tag &amp; \"\" = \"\" Then\n        'this is for insert new\n        'add data to table\n        CurrentDb.Execute \"INSERT INTO tblInventory(ICN, manu, model, serial, desc, dateRec, dateRem, dispo, project, AMCA, UL, comments) \" &amp; _\n        \" VALUES(\" &amp; Me.txtICN &amp; \", '\" &amp; Me.txtManu &amp; \"', '\" &amp; Me.txtModel &amp; \"', '\" &amp; Me.txtSerial &amp; \"', '\" &amp; Me.txtDesc &amp; \"', '\" &amp; Me.txtDateRec &amp; \"', '\" &amp; Me.txtDateRem &amp; \"', '\" &amp; Me.txtDispo &amp; \"', '\" &amp; Me.txtProject &amp; \"', '\" &amp; Me.txtAMCA &amp; \"', '\" &amp; Me.txtUL &amp; \"', '\" &amp; Me.txtComments &amp; \"')\"\n    Else\n        'otherwise (Tag of txtICN store the ICN of item to be modified)\n        CurrentDb.Execute \"UPDATE tblInventory \" &amp; _\n        \" SET ICN = \" &amp; Me.txtICN &amp; _\n        \", manu = '\" &amp; Me.txtManu &amp; \"'\" &amp; _\n        \", model = '\" &amp; Me.txtModel &amp; \"'\" &amp; _\n        \", serial = '\" &amp; Me.txtSerial &amp; \"'\" &amp; _\n        \", desc = '\" &amp; Me.txtDesc &amp; \"'\" &amp; _\n        \", dateRec = '\" &amp; Me.txtDateRec &amp; \"'\" &amp; _\n        \", dateRem = '\" &amp; Me.txtDateRem &amp; \"'\" &amp; _\n        \", dispo = '\" &amp; Me.txtDispo &amp; \"'\" &amp; _\n        \", project = '\" &amp; Me.txtProject &amp; \"'\" &amp; _\n        \", AMCA = '\" &amp; Me.txtAMCA &amp; \"'\" &amp; _\n        \", UL = '\" &amp; Me.txtUL &amp; \"'\" &amp; _\n        \", comments = '\" &amp; Me.txtComments &amp; \"'\" &amp; _\n        \" WHERE ICN = \" &amp; Me.txtICN.Tag\n    End If\n\n    'clear form\n    cmdClear_Click\n    'refresh data in list on form\n    frmInventorySub.Form.Requery\nEnd Sub\n\nPrivate Sub cmdClear_Click()\n    Me.txtICN = \"\"\n    Me.txtManu = \"\"\n    Me.txtModel = \"\"\n    Me.txtSerial = \"\"\n    Me.txtDesc = \"\"\n    Me.txtDateRec = \"\"\n    Me.txtDateRem = \"\"\n    Me.txtDispo = \"\"\n    Me.txtProject = \"\"\n    Me.txtAMCA = \"\"\n    Me.txtUL = \"\"\n    Me.txtComments = \"\"\n\n    'focus on ID text box\n    Me.txtICN.SetFocus\n    'set button edit to enable\n    Me.cmdEdit.Enabled = True\n    'change caption of button add to Add\n    Me.cmdAdd.Caption = \"Add\"\n    'clear tag on txtICN for reset new\n    Me.txtICN.Tag = \"\"\nEnd Sub\n\nPrivate Sub cmdClose_Click()\n    DoCmd.Close\nEnd Sub\n\nPrivate Sub cmdDelete_Click()\n    'delete record\n    'check existing selected record\n    If Not (Me.frmInventorySub.Form.Recordset.EOF And Me.frmInventorySub.Form.Recordset.BOF) Then\n        'confirm delete\n        If MsgBox(\"Are you sure you want to delete this item?\", vbYesNo) = vbYes Then\n            'delete now\n            CurrentDb.Execute \"DELETE FROM tblInventory \" &amp; _\n                \"WHERE ICN =\" &amp; Me.frmInventorySub.Form.Recordset.Fields(\"ICN\")\n            'refresh data in list\n            Me.frmInventorySub.Form.Requery\n        End If\n    End If\nEnd Sub\n\nPrivate Sub cmdEdit_Click()\n    'check whether there exists data in list\n    If Not (Me.frmInventorySub.Form.Recordset.EOF And Me.frmInventorySub.Form.Recordset.BOF) Then\n        'get data to text box control\n        With Me.frmInventorySub.Form.Recordset\n            Me.txtICN = .Fields(\"ICN\")\n            Me.txtManu = .Fields(\"manu\")\n            Me.txtModel = .Fields(\"model\")\n            Me.txtSerial = .Fields(\"serial\")\n            Me.txtDesc = .Fields(\"desc\")\n            Me.txtDateRec = .Fields(\"dateRec\")\n            Me.txtDateRem = .Fields(\"dateRem\")\n            Me.txtDispo = .Fields(\"dispo\")\n            Me.txtProject = .Fields(\"project\")\n            Me.txtAMCA = .Fields(\"AMCA\")\n            Me.txtUL = .Fields(\"UL\")\n            Me.txtComments = .Fields(\"comments\")\n            'store id of item in Tag of txtICN in case ICN is modified\n            Me.txtICN.Tag = .Fields(\"ICN\")\n            'change caption of button add to Update\n            Me.cmdAdd.Caption = \"Update\"\n            'disable button edit\n            Me.cmdEdit.Enabled = False\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>And here is the code for the old database:</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub cmdAdd_Click()\n    'when we click on button Add there are two options\n    '1. for insert\n    '2. for update\n    If Me.txtID.Tag &amp; \"\" = \"\" Then\n        'this is for insert new\n        'add data to table\n        CurrentDb.Execute \"INSERT INTO tblEquipmentList(equipID, equipDesc, equipManu, equipModelNum, equipSerNum, lastCalDate, calDue) \" &amp; _\n        \" VALUES(\" &amp; Me.txtID &amp; \", '\" &amp; Me.txtDesc &amp; \"', '\" &amp; Me.txtManu &amp; \"', '\" &amp; Me.txtModelNum &amp; \"', '\" &amp; Me.txtSerNum &amp; \"', '\" &amp; Me.txtLastCalDate &amp; \"', '\" &amp; Me.txtCalDueDate &amp; \"')\"\n    Else\n        'otherwise (Tag of txtID store the id of equipment to be modified)\n        CurrentDb.Execute \"UPDATE tblEquipmentList \" &amp; _\n        \" SET equipID = \" &amp; Me.txtID &amp; _\n        \", equipDesc = '\" &amp; Me.txtDesc &amp; \"'\" &amp; _\n        \", equipManu = '\" &amp; Me.txtManu &amp; \"'\" &amp; _\n        \", equipModelNum = '\" &amp; Me.txtModelNum &amp; \"'\" &amp; _\n        \", equipSerNum = '\" &amp; Me.txtSerNum &amp; \"'\" &amp; _\n        \", lastCalDate = '\" &amp; Me.txtLastCalDate &amp; \"'\" &amp; _\n        \", calDue = '\" &amp; Me.txtCalDueDate &amp; \"'\" &amp; _\n        \" WHERE equipID = \" &amp; Me.txtID.Tag\n    End If\n\n    'clear form\n    cmdClear_Click\n    'refresh data in list on form\n    frmEquipmentListSub.Form.Requery\nEnd Sub\n\nPrivate Sub cmdClear_Click()\n    Me.txtID = \"\"\n    Me.txtDesc = \"\"\n    Me.txtManu = \"\"\n    Me.txtModelNum = \"\"\n    Me.txtSerNum = \"\"\n    Me.txtLastCalDate = \"\"\n    Me.txtCalDueDate = \"\"\n\n    'focus on ID text box\n    Me.txtID.SetFocus\n    'set button edit to enable\n    Me.cmdEdit.Enabled = True\n    'change caption of button add to Add\n    Me.cmdAdd.Caption = \"Add\"\n    'clear tag on txtID for reset new\n    Me.txtID.Tag = \"\"\nEnd Sub\n\nPrivate Sub cmdClose_Click()\n    DoCmd.Close\nEnd Sub\n\nPrivate Sub cmdDelete_Click()\n    'delete record\n    'check existing selected record\n    If Not (Me.frmEquipmentListSub.Form.Recordset.EOF And Me.frmEquipmentListSub.Form.Recordset.BOF) Then\n        'confirm delete\n        If MsgBox(\"Are you sure you want to delete this piece of equipment?\", vbYesNo) = vbYes Then\n            'delete now\n            CurrentDb.Execute \"DELETE FROM tblEquipmentList \" &amp; _\n                \"WHERE equipID =\" &amp; Me.frmEquipmentListSub.Form.Recordset.Fields(\"equipID\")\n            'refresh data in list\n            Me.frmEquipmentListSub.Form.Requery\n        End If\n    End If\nEnd Sub\n\nPrivate Sub cmdEdit_Click()\n    'check whether there exists data in list\n    If Not (Me.frmEquipmentListSub.Form.Recordset.EOF And Me.frmEquipmentListSub.Form.Recordset.BOF) Then\n        'get data to text box control\n        With Me.frmEquipmentListSub.Form.Recordset\n            Me.txtID = .Fields(\"equipID\")\n            Me.txtDesc = .Fields(\"equipDesc\")\n            Me.txtManu = .Fields(\"equipManu\")\n            Me.txtModelNum = .Fields(\"equipModelNum\")\n            Me.txtSerNum = .Fields(\"equipSerNum\")\n            Me.txtLastCalDate = .Fields(\"lastCalDate\")\n            Me.txtCalDueDate = .Fields(\"calDue\")\n            'store id of equipment in Tag of txtID in case id is modified\n            Me.txtID.Tag = .Fields(\"equipID\")\n            'change caption of button add to Update\n            Me.cmdAdd.Caption = \"Update\"\n            'disable button edit\n            Me.cmdEdit.Enabled = False\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>As you can see, I'm pretty confident that they're pretty much identical except for the field names.</p>\n\n<p>I'm also linking an album of screenshots of the database here: <a href=\"https://imgur.com/a/xLV3Q\" rel=\"nofollow noreferrer\">http://imgur.com/a/xLV3Q</a></p>\n\n<p>Thanks for any help you guys can provide.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490798035, "post_id": 43096153, "comment_id": 73274399, "body": "Are you sure that it changes when you save the document? Because the last printing date also changes when you use the print preview (without actually printing) but it doesn&#39;t change on saving a document. I assume you check the footer by using the preview and this changes the print date."}, {"owner": {"reputation": 11, "user_id": 7786340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e39098a1d2be36c9a5a2b8fd932b17e?s=128&d=identicon&r=PG&f=1", "display_name": "R.Haughey", "link": "https://stackoverflow.com/users/7786340/r-haughey"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1490888119, "post_id": 43096153, "comment_id": 73323831, "body": "Perfect, I didn&#39;t know that but it makes sense now. That is the mistake that I have been making. Thank you Peh!"}], "owner": {"reputation": 11, "user_id": 7786340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e39098a1d2be36c9a5a2b8fd932b17e?s=128&d=identicon&r=PG&f=1", "display_name": "R.Haughey", "link": "https://stackoverflow.com/users/7786340/r-haughey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490797087, "creation_date": 1490797029, "last_edit_date": 1490797087, "question_id": 43096153, "link": "https://stackoverflow.com/questions/43096153/excel-macro-that-creates-footer-containing-last-print-date-last-save-date", "title": "Excel macro that creates footer containing last print date &amp; last save date", "body": "<p>I'm trying to write a macro using vba in excel 2013 which puts the last save date and the last print date in a footer. When I only print the document, the last print date changes in the correct manner. However, when I save the document my last save date and last print date are altered. </p>\n\n<p>How do I stop my last print date from being affected when I save the document? </p>\n\n<p>This is the code that I have been using:</p>\n\n<pre><code>Sub Footer()\n\nActiveSheet.PageSetup.LeftFooter = \"&amp;9\" &amp; \"Last Saved: \" &amp; ThisWorkbook.BuiltinDocumentProperties(12) &amp; Chr(13) &amp; \"Last Printed: \" &amp; ThisWorkbook.BuiltinDocumentProperties(10)     \nActiveSheet.PageSetup.RightFooter = \"&amp;9\" &amp; ActiveWorkbook.Path &amp; Chr(13) &amp; ActiveWorkbook.Name &amp; Chr(13) &amp; ActiveSheet.Name\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1490796261, "post_id": 43095695, "comment_id": 73272851, "body": "A similar question was asked here today: <a href=\"http://stackoverflow.com/questions/43093675/how-to-compare-excel-files?noredirect=1#comment73268822_43093675\" title=\"how to compare excel files\">stackoverflow.com/questions/43093675/&hellip;</a>"}, {"owner": {"reputation": 107, "user_id": 7204779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6de773b36a9b0f54e10a0de48b4be2ef?s=128&d=identicon&r=PG&f=1", "display_name": "GoodCat", "link": "https://stackoverflow.com/users/7204779/goodcat"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1490801674, "post_id": 43095695, "comment_id": 73277397, "body": "Thanks Callum - will take a look although on surface level it looks like only works with one file comparison in reality I may have 50 to compare but this looks like a good starting point, thank you!"}], "owner": {"reputation": 107, "user_id": 7204779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6de773b36a9b0f54e10a0de48b4be2ef?s=128&d=identicon&r=PG&f=1", "display_name": "GoodCat", "link": "https://stackoverflow.com/users/7204779/goodcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490795917, "creation_date": 1490795917, "last_edit_date": 1531164843, "question_id": 43095695, "link": "https://stackoverflow.com/questions/43095695/vba-check-columns-match-previous-version", "title": "VBA Check columns match previous version", "body": "<p>Have almost no experience with VBA but wondering if there is a way to validate if a Excel worksheet has the same column structure as another. Additionally do this for multiple Excel sheets with different structures at the same time in a single script.</p>\n\n<p>Example worksheet A1 columns [A,B,C] needs to reconcile with Worksheet A2 and Worksheet B1 columns [D,E,F] need to reconcile with Worksheet B2. Flagging an error if any of the columns do not match with their previous version. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490796506, "post_id": 43095653, "comment_id": 73273033, "body": "Does it also come up if you don&#39;t save the Word document (If you comment out the <code>WordDocument.SaveAs2</code> line)? Or try to save the Excel file as MacroEnabled <code>ActiveWorkbook.SaveAs Filename:=ExcelExport FileFormat:=xlOpenXMLWorkbookMacroEnabled</code>"}, {"owner": {"reputation": 1, "user_id": 7786158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de1aeb688998b9913ac60e953c4f340?s=128&d=identicon&r=PG&f=1", "display_name": "Lars", "link": "https://stackoverflow.com/users/7786158/lars"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490796879, "post_id": 43095653, "comment_id": 73273328, "body": "@Peh Yes it happens with the commented out too. First one shows as Filetype &quot;(<i>.docx)&quot; and second shows Filetype &quot;(</i>.xlsm&quot;)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490797027, "post_id": 43095653, "comment_id": 73273462, "body": "Did you try to save the Excel file as MacroEnabled <code>ActiveWorkbook.SaveAs Filename:=ExcelExport FileFormat:=xlOpenXMLWorkbookMacroEnabled</code>?"}, {"owner": {"reputation": 1, "user_id": 7786158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de1aeb688998b9913ac60e953c4f340?s=128&d=identicon&r=PG&f=1", "display_name": "Lars", "link": "https://stackoverflow.com/users/7786158/lars"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490797206, "post_id": 43095653, "comment_id": 73273635, "body": "Doesn&#39;t work either, same result as before.."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490797474, "post_id": 43095653, "comment_id": 73273888, "body": "Then you will have to show us a minimal example where it fails. I can&#39;t see any issues and the code works."}], "owner": {"reputation": 1, "user_id": 7786158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de1aeb688998b9913ac60e953c4f340?s=128&d=identicon&r=PG&f=1", "display_name": "Lars", "link": "https://stackoverflow.com/users/7786158/lars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 418, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490795890, "creation_date": 1490795832, "last_edit_date": 1490795890, "question_id": 43095653, "link": "https://stackoverflow.com/questions/43095653/vba-macro-save-copy-of-active-workbook-without-opening-the-windows-explorer", "title": "VBA Macro - Save Copy of Active Workbook without opening the windows Explorer", "body": "<p>I'm saving a Word Document in my Excel Macro, The User defines the Export Path with the SaveAs2() Function (Windows Explorer opens up etc.).  </p>\n\n<p>Now my Problem is that I want to save a copy of my Current Workbook to the same directory with the same Filename as the Word Document.<br>\n<strong>BUT</strong> everytime the User chooses the Export Path of the Word File, another Windows Explorer Window comes up and asks the User where to save the Excel File.</p>\n\n<p>So how can i disable this second Windows Explorer Window?</p>\n\n<p>I tried it like this:</p>\n\n<pre><code>Dim ExportPath As String\nDim ExcelExport As String\n\nExportPath = Application.GetSaveAsFilename(ActiveWorkbook.Names(\"AccountName\").RefersToRange.Text &amp; \"_LD_Vertrag_DE.docx\", FileFilter:=\"Word Files (*.docx), *.docx\")\nWordDocument.SaveAs2 (ExportPath)\n\nExcelExport = Replace(ExportPath, \".docx\", \".xlsm\")\n\nApplication.DisplayAlerts = False\nActiveWorkbook.SaveAs (ExcelExport)\nApplication.DisplayAlerts = True\n</code></pre>\n"}, {"tags": ["r", "vba", "excel", "xlsx"], "comments": [{"owner": {"reputation": 19627, "user_id": 4474157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/10628046affca059c34e1f7eda163f8b?s=128&d=identicon&r=PG&f=1", "display_name": "NicE", "link": "https://stackoverflow.com/users/4474157/nice"}, "edited": false, "score": 0, "creation_date": 1490974777, "post_id": 43095645, "comment_id": 73366542, "body": "Have you tried <a href=\"http://stackoverflow.com/questions/19404270/run-vba-script-from-r\">this</a>?"}, {"owner": {"reputation": 5040, "user_id": 1759499, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/353a8ead76febf7aec24d8f90cdc56b2?s=128&d=identicon&r=PG", "display_name": "Anthony Damico", "link": "https://stackoverflow.com/users/1759499/anthony-damico"}, "reply_to_user": {"reputation": 19627, "user_id": 4474157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/10628046affca059c34e1f7eda163f8b?s=128&d=identicon&r=PG&f=1", "display_name": "NicE", "link": "https://stackoverflow.com/users/4474157/nice"}, "edited": false, "score": 0, "creation_date": 1490978736, "post_id": 43095645, "comment_id": 73368940, "body": "thanks @nice !  i believe that requires the macro to already be embedded in the <code>.xlsx</code> file, but we are creating those dynamically hundreds of times.  this might work if we could auto-add the macro inside the R-generated <code>.xlsx</code> files as well?  thank you"}, {"owner": {"reputation": 1222, "user_id": 3827188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19259c9f79320635f04e28b0801da38b?s=128&d=identicon&r=PG&f=1", "display_name": "Bishops_Guest", "link": "https://stackoverflow.com/users/3827188/bishops-guest"}, "edited": false, "score": 1, "creation_date": 1490981332, "post_id": 43095645, "comment_id": 73370294, "body": "Is there some reason pictures of excel files are better than the html format tables created by either <code>xtable</code> or <code>shiny</code>? From the little information that you have provided it seems like there might be a better way to achieve your primary goal."}, {"owner": {"reputation": 5040, "user_id": 1759499, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/353a8ead76febf7aec24d8f90cdc56b2?s=128&d=identicon&r=PG", "display_name": "Anthony Damico", "link": "https://stackoverflow.com/users/1759499/anthony-damico"}, "reply_to_user": {"reputation": 1222, "user_id": 3827188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19259c9f79320635f04e28b0801da38b?s=128&d=identicon&r=PG&f=1", "display_name": "Bishops_Guest", "link": "https://stackoverflow.com/users/3827188/bishops-guest"}, "edited": false, "score": 0, "creation_date": 1490984834, "post_id": 43095645, "comment_id": 73372072, "body": "hi, @Bishops_Guest thanks.  we need the excel files to send to researchers and reporters, so those tables need to be constructed either way.  we could potentially re-do everything, but it would save time to simply take a snapshot of the excel range that we already have."}, {"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1491247499, "post_id": 43095645, "comment_id": 73458401, "body": "You might have more luck with <code>openxlsx</code>"}, {"owner": {"reputation": 5040, "user_id": 1759499, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/353a8ead76febf7aec24d8f90cdc56b2?s=128&d=identicon&r=PG", "display_name": "Anthony Damico", "link": "https://stackoverflow.com/users/1759499/anthony-damico"}, "reply_to_user": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1491260969, "post_id": 43095645, "comment_id": 73464170, "body": "hi @Carl would love an <code>openxlsx</code> solution.."}], "answers": [{"tags": [], "owner": {"reputation": 3159, "user_id": 7384676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bE5F.png?s=128&g=1", "display_name": "Ian Wesley", "link": "https://stackoverflow.com/users/7384676/ian-wesley"}, "is_accepted": false, "score": 7, "last_activity_date": 1491024130, "last_edit_date": 1491024130, "creation_date": 1491000307, "answer_id": 43150719, "question_id": 43095645, "link": "https://stackoverflow.com/questions/43095645/how-to-export-an-excel-sheet-range-to-a-picture-from-within-r/43150719#43150719", "title": "How to export an Excel sheet range to a picture, from within R", "body": "<p>You can do this with vbs.  Most vbs is identical to vba so you can write out your dynamic vbs script which includes your macro as text and then call it with shell. </p>\n\n<p>Here is a working example:</p>\n\n<pre><code>fileConn&lt;-file(\"c:/rworking/test/test.vbs\")\nwriteLines(c(\"Dim xlApp, xlBook, xlSht\",\n    \"Dim filename\",\n    \"filename = \\\"c:\\\\Rworking\\\\test\\\\test_import.xlsx\\\"\",\n    \"Set xlApp = CreateObject(\\\"Excel.Application\\\")\",\n    \"xlApp.Visible = True\",\n    \"set xlBook = xlApp.WorkBooks.Open(filename)\",\n    \"set xlSht = xlApp.Worksheets(1)\",\n    \"set rng = xlSht.Range(\\\"A8:J36\\\")\",\n    \"rng.CopyPicture\",\n    \"Set oCht = xlApp.Charts\",\n    \"oCht.Add() \",\n    \"Set oCht = oCht(1)\",\n    \"oCht.paste\",\n    \"oCht.Export \\\"C:\\\\rworking\\\\test\\\\Test.jpg\\\", \\\"JPG\\\"\"), \n    fileConn)\n\nclose(fileConn)\n\nshell.exec(\"c:/rworking/test/test.vbs\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14933, "user_id": 3502164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5HD1b.jpg?s=128&g=1", "display_name": "Tonio Liebrand", "link": "https://stackoverflow.com/users/3502164/tonio-liebrand"}, "is_accepted": false, "score": 3, "last_activity_date": 1491038437, "creation_date": 1491038437, "answer_id": 43155003, "question_id": 43095645, "link": "https://stackoverflow.com/questions/43095645/how-to-export-an-excel-sheet-range-to-a-picture-from-within-r/43155003#43155003", "title": "How to export an Excel sheet range to a picture, from within R", "body": "<p>Hmm, not sure about posting, maybe it got redundant through Ian\u00b4s post. Its a bit more generic, but I can also remove it.</p>\n\n<pre><code>library(xlsx)\n\nOutputPicFileName &lt;- \"Chart.jpg\"\nScriptFileName &lt;- \"Chart.vbs\"\nxclFileName &lt;- \"test_import.xlsx\"\nxclRng &lt;- \"A8:J36\"\nfile &lt;- system.file(\"tests\", xclFileName, package = \"xlsx\")\nfileDirec &lt;- unlist(strsplit(file, xclFileName))\n\nCreateChart &lt;- function(fileDirec, OutputPicFileName, ScriptFileName, xclRng){\n  setwd(fileDirec)\n  filePath &lt;- file(paste0(fileDirec, ScriptFileName))\n  writeLines(\n    c(\n      \"Dim App, WBook, Sht, Rng, FileName, ChartObj, Chart\",\n       paste0(\"FileName = \\\"\", gsub(\"/\", \"\\\\\\\\\", fileDirec), xclFileName ,\"\\\"\"),\n       \"Set App = CreateObject(\\\"Excel.Application\\\")\",\n       \"Set WBook = App.WorkBooks.Open(FileName)\",\n       \"Set Sht = App.Worksheets(1)\",\n       paste0(\"Set Rng = Sht.Range(\\\"\", xclRng,\"\\\")\"),\n       \"Rng.CopyPicture\",\n       \"Set ChartObj = App.Charts\",\n       \"Set Chart = ChartObj.Add() \",\n       \"Chart.paste\",\n       paste0(\"Chart.Export \\\"\", gsub(\"/\", \"\\\\\\\\\", fileDirec) , OutputPicFileName ,\"\\\", \\\"JPG\\\"\")\n    ), \n    filePath\n  )\n  close(filePath)\n  shell.exec(ScriptFileName)\n}\n\nCreateChart(fileDirec, OutputPicFileName, ScriptFileName, xclRng)\n\n# Result in: fileDirec\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ZDjOr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZDjOr.jpg\" alt=\"Chart.jpg\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 11, "last_activity_date": 1491151763, "creation_date": 1491151763, "answer_id": 43170897, "question_id": 43095645, "link": "https://stackoverflow.com/questions/43095645/how-to-export-an-excel-sheet-range-to-a-picture-from-within-r/43170897#43170897", "title": "How to export an Excel sheet range to a picture, from within R", "body": "<p>Consider having R do exactly as VBA does in your macro: making a COM interface to the Excel object library. You can do so with the <code>RDCOMClient</code> package, retaining nearly same code as macro in the R syntax. </p>\n\n<pre><code>library(RDCOMClient)\n\nxlApp &lt;- COMCreate(\"Excel.Application\")\nxlWbk &lt;- xlApp$Workbooks()$Open(\"C:\\\\Path\\\\To\\\\test_import.xlsx\")\nxlScreen = 1\nxlBitmap = 2\n\nxlWbk$Worksheets(\"deletedFields\")$Range(\"A8:J36\")$CopyPicture(xlScreen, xlBitmap)\n\nxlApp[['DisplayAlerts']] &lt;- FALSE\n\noCht &lt;- xlApp[['Charts']]$Add()\noCht$Paste()\noCht$Export(\"C:\\\\Temp\\\\SavedRange.jpg\", \"JPG\")\noCht$Delete()\n\n# CLOSE WORKBOOK AND APP\nxlWbk$Close(FALSE)\nxlApp$Quit()\n\n# RELEASE RESOURCES\noCht &lt;- xlWbk &lt;- xlApp &lt;- NULL    \nrm(oCht, xlWbk, xlApp)\ngc()\n</code></pre>\n\n<p><strong>Output</strong> <em>(random data/chart)</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/JHVuS.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/JHVuS.jpg\" alt=\"Data and Chart Output Image\"></a></p>\n"}], "owner": {"reputation": 5040, "user_id": 1759499, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/353a8ead76febf7aec24d8f90cdc56b2?s=128&d=identicon&r=PG", "display_name": "Anthony Damico", "link": "https://stackoverflow.com/users/1759499/anthony-damico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3370, "favorite_count": 4, "accepted_answer_id": 43170897, "answer_count": 3, "score": 11, "last_activity_date": 1535702105, "creation_date": 1490795803, "last_edit_date": 1491026781, "question_id": 43095645, "link": "https://stackoverflow.com/questions/43095645/how-to-export-an-excel-sheet-range-to-a-picture-from-within-r", "title": "How to export an Excel sheet range to a picture, from within R", "body": "<p>We are trying to automate the creation of some picture files within an <strong><code>R</code></strong> Script.  </p>\n\n<p>We have the Excel files looking the way that we want them to, but now need to make a JPG or PNG picture-copy of those excel tables for easier web posting.  </p>\n\n<p>We've been using the <code>library(xlsx)</code> package for most of our interactions between <strong><code>R</code></strong> and Excel, and it looks like we should be able to send specific java commands through something like <code>?.jmethods</code> but it's unclear how we would pass as many lines as we need to.</p>\n\n<p>In an <strong><code>R</code></strong> session, here's a minimal reproducible example... </p>\n\n<p>Here's an example Excel file with a range to print</p>\n\n<pre><code>library(xlsx)\nfile &lt;- system.file(\"tests\", \"test_import.xlsx\", package = \"xlsx\")\nfile\n</code></pre>\n\n<p>And here's the Excel macro that exports the Excel range to a picture file</p>\n\n<pre><code>Sub Tester()\n\n    Worksheets(\"deletedFields\").Range(\"A8:J36\").CopyPicture xlScreen, xlBitmap\n\n    Application.DisplayAlerts = False\n    Set oCht = Charts.Add\n    With oCht\n        .Paste\n        .Export Filename:=\"C:\\temp\\SavedRange.jpg\", Filtername:=\"JPG\"\n        .Delete\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p><em>Any help automating this would be much appreciated!</em></p>\n"}, {"tags": ["excel", "vba", "outlook", "concatenation"], "comments": [{"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 0, "creation_date": 1490796106, "post_id": 43095564, "comment_id": 73272715, "body": "what line are you getting the error? line number?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1490796446, "post_id": 43095564, "comment_id": 73272993, "body": "The <code>Next</code> you have is a <code>Next aCell</code>. You need a <code>Next wsname</code> underneath it."}, {"owner": {"reputation": 25, "user_id": 7786106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9aed7d47205beccda64e2a61ed173f?s=128&d=identicon&r=PG&f=1", "display_name": "Shabbash18", "link": "https://stackoverflow.com/users/7786106/shabbash18"}, "reply_to_user": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 0, "creation_date": 1490802512, "post_id": 43095564, "comment_id": 73278069, "body": "@Miguel - code as is produces no errors, but e.g. the second email contains the string for the first sheet and second sheet, rather than just the second sheet."}, {"owner": {"reputation": 25, "user_id": 7786106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9aed7d47205beccda64e2a61ed173f?s=128&d=identicon&r=PG&f=1", "display_name": "Shabbash18", "link": "https://stackoverflow.com/users/7786106/shabbash18"}, "edited": false, "score": 0, "creation_date": 1490802518, "post_id": 43095564, "comment_id": 73278074, "body": "@Jeeped There is a Next at the bottom already, it correctly writes the email from each sheet, but the issue is as described above."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7786106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9aed7d47205beccda64e2a61ed173f?s=128&d=identicon&r=PG&f=1", "display_name": "Shabbash18", "link": "https://stackoverflow.com/users/7786106/shabbash18"}, "edited": false, "score": 0, "creation_date": 1490803568, "post_id": 43098426, "comment_id": 73278847, "body": "Thank you sir, this solution does the trick for me! Greatly appreciated."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1490802782, "creation_date": 1490802782, "answer_id": 43098426, "question_id": 43095564, "link": "https://stackoverflow.com/questions/43095564/making-unambiguous-concatenate-when-retrieving-info-for-email/43098426#43098426", "title": "Making unambiguous concatenate when retrieving info for email", "body": "<p>Zero the string before going into the second iteration of the loop.</p>\n\n<pre><code>For Each wsName In Array(\"sheet1\", \"sheet2\", \"sheet3\")\n\n    Set ws = Worksheets(wsName)\n    string1  = vbNullString    'reset string1 to a zero-length string for each ws\n\n     'retrieve all missing dates\n     For Each aCell In ws.Range(\"Aa1:Aa1000\")\n       'all the rest of the concatenation code\n     next aCell\n\n    'all the rest of the email code\nNext wsName\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7786106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9aed7d47205beccda64e2a61ed173f?s=128&d=identicon&r=PG&f=1", "display_name": "Shabbash18", "link": "https://stackoverflow.com/users/7786106/shabbash18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 43098426, "answer_count": 1, "score": 1, "last_activity_date": 1610972123, "creation_date": 1490795632, "last_edit_date": 1610972123, "question_id": 43095564, "link": "https://stackoverflow.com/questions/43095564/making-unambiguous-concatenate-when-retrieving-info-for-email", "title": "Making unambiguous concatenate when retrieving info for email", "body": "<p>The aim is to check individual worksheets for a list of dates in a range, and then send an email listing these dates to an email address located in the sheet.</p>\n<p>The current code concatenates the dates in the current sheet as well as the dates on the previous sheet, instead of just the dates found on this sheet.</p>\n<p>I'm struggling to make it uni-vocal,  tried putting &quot;ws.&quot; before each aCell instruction but get compile error.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Mail_Outlook()\n        \n    Dim ws As Worksheet\n    Dim wsName As Variant\n    \n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim cell As Range\n    Dim strbody As String\n    Dim string1 As String\n    Dim aCell As Range\n    Dim i As Integer\n    i = 0\n       \n    For Each wsName In Array(&quot;sheet1&quot;, &quot;sheet2&quot;, &quot;sheet3&quot;)\n        \n        Set ws = Worksheets(wsName)\n            \n        'retrieve all missing dates\n        For Each aCell In ws.Range(&quot;Aa1:Aa1000&quot;)\n    \n            If aCell.Value &lt;&gt; &quot;&quot; Then\n                i = i + 1\n                If i &lt;&gt; 1 Then\n                    string1 = string1 &amp; &quot;,   &quot; &amp; aCell.Value\n    \n                Else\n                    string1 = aCell.Value\n                End If\n                    \n            End If\n            \n        Next\n    \n        'send email\n        Set OutApp = CreateObject(&quot;Outlook.Application&quot;)\n        Set OutMail = OutApp.CreateItem(0)\n    \n        strbody = &quot;Good day &quot; &amp; ws.Range(&quot;E3&quot;).Cells &amp; vbNewLine &amp; vbNewLine &amp; _\n          &quot;&quot; &amp; vbNewLine &amp; vbNewLine &amp; _\n          &quot;&quot; &amp; vbNewLine &amp; vbNewLine &amp; _\n          string1 &amp; vbNewLine &amp; vbNewLine &amp; vbNewLine &amp; vbNewLine &amp; _\n          &quot;(This is an automated message)&quot; &amp; vbNewLine &amp; vbNewLine &amp; _\n          &quot;Best regards&quot; &amp; vbNewLine &amp; vbNewLine &amp; _\n        \n        On Error Resume Next\n        \n        With OutMail\n            .To = ws.Range(&quot;E5&quot;).Text\n            .CC = &quot;&quot;\n            .BCC = &quot;&quot;\n            .Subject = &quot;&quot;\n            .Body = strbody\n            'You can add a file like this\n            '.Attachments.Add (&quot;C:\\test.txt&quot;)\n            .Display   'or use .Send\n        End With\n        \n        On Error GoTo 0\n    \n        Set OutMail = Nothing\n        Set OutApp = Nothing\n    \n    Next\n    \nEnd Sub\n</code></pre>\n<p>From the OP's comments:<br />\ncode as is produces no errors, but e.g. the second email contains the string for the first sheet and second sheet, rather than just the second sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490796821, "post_id": 43095553, "comment_id": 73273273, "body": "You should add also the other parts of this code to let us help you"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1490799578, "post_id": 43095553, "comment_id": 73275762, "body": "Check <a href=\"http://stackoverflow.com/a/22075626/1652222\"><b>this</b></a> answer."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9559018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Vco8Uq8ZNDY/AAAAAAAAAAI/AAAAAAAAEg8/wQpkEoCOHos/photo.jpg?sz=128", "display_name": "kimerin", "link": "https://stackoverflow.com/users/9559018/kimerin"}, "is_accepted": false, "score": 0, "last_activity_date": 1522163331, "creation_date": 1522163331, "answer_id": 49516520, "question_id": 43095553, "link": "https://stackoverflow.com/questions/43095553/vba-resize-pasted-imaged-to-entire-width-height-of-cell/49516520#49516520", "title": "VBA resize pasted imaged to entire width/height of cell?", "body": "<p>adapt this code to your problem</p>\n\n<pre><code>   ima = activecell.Top 'take the active cell top margin\n   imb = activecell.Left 'take thee activecell left margin\n   imc = activecell.Height 'take the activecell height\n   imd = activecell.Width 'take the activecell width\n   With Selection.ShapeRange\n        .LockAspectRatio = msoFalse 'ignore aspect ratio of the image\n        .Top = ima 'align image to the top margin of the activecell\n        .Left = imb 'align image to the left margin of the activecell\n        .Height = imc 'resize height to the activecell height\n        .Width = imd 'resize width to the activecell width\n   End With\n   nam = Selection.ShapeRange.Name\n   ActiveSheet.Shapes(nam).Placement = xlMoveAndSize 'resize image with the cell\n</code></pre>\n\n<p>I expect this can help you.</p>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 584, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522163331, "creation_date": 1490795616, "last_edit_date": 1490796025, "question_id": 43095553, "link": "https://stackoverflow.com/questions/43095553/vba-resize-pasted-imaged-to-entire-width-height-of-cell", "title": "VBA resize pasted imaged to entire width/height of cell?", "body": "<p>I am using the below code to resize an image when pasted into the active cell.</p>\n\n<p>I want the image to scale to 100% width and height of the cell.\nAt the moment i can't seem to get this to work. The code does scale the image, but not 100%.</p>\n\n<p>Please can someone show me where i am going wrong?</p>\n\n<pre><code> Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Application.DisplayAlerts = False\n\n\n'Image Script\n\nIf Not Intersect(Target, Range(\"L:L\")) Is Nothing Then ' &lt;-- run this code only if a value in column L has changed\nOn Error GoTo 0\n     'paste excel table as enhanced metafile, then resize to full width\n\n    ActiveCell.Select\n    ActiveSheet.Paste\n    Selection.ShapeRange.ScaleWidth ActiveCell.Width, _\n    msoFalse, msoScaleFromTopLeft\n    Selection.ShapeRange.ScaleHeight ActiveCell.Height, _\n    msoFalse, msoScaleFromTopLeft\n\n\n    End If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": true, "score": 5, "last_activity_date": 1490796096, "last_edit_date": 1490796096, "creation_date": 1490795514, "answer_id": 43095498, "question_id": 43095386, "link": "https://stackoverflow.com/questions/43095386/delete-duplicates-if-they-are-together-in-a-column-excel/43095498#43095498", "title": "Delete duplicates if they are together in a column excel", "body": "<p>Doesn't something simple like </p>\n\n<pre><code>Dim LastRow As Long\nApplication.screenUpdating=False\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nFor i = LastRow To 2 Step -1\n    If Cells(i, 1).Value = Cells(i - 1, 1).Value Then\n        Cells(i, 1).EntireRow.Delete\n    End If\nNext i\nApplication.screenUpdating=True\n</code></pre>\n\n<p>solve this?</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1490795543, "creation_date": 1490795543, "answer_id": 43095517, "question_id": 43095386, "link": "https://stackoverflow.com/questions/43095386/delete-duplicates-if-they-are-together-in-a-column-excel/43095517#43095517", "title": "Delete duplicates if they are together in a column excel", "body": "<p>Work from the bottom up and only delete if the cell above is the same value.</p>\n\n<pre><code>dim r as long\n\nwith worksheets(\"sheet1\")\n    for r = .cells(.rows.count, \"A\").end(xlup).row to 2 step -1\n        if lcase(.cells(r, \"A\").value2) = lcase(.cells(r - 1, \"A\").value2) then\n            .rows(r).entirerow.delete\n        end if\n    next r\nend with\n</code></pre>\n\n<p>If you do not want the comparison to be case-insensitive then remove the <code>lcase</code> functions.</p>\n"}], "owner": {"reputation": 57, "user_id": 6267570, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0becacd4664c34c95c8046a03bf03868?s=128&d=identicon&r=PG&f=1", "display_name": "Kuma", "link": "https://stackoverflow.com/users/6267570/kuma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 43095498, "answer_count": 2, "score": 3, "last_activity_date": 1537540894, "creation_date": 1490795204, "last_edit_date": 1537540894, "question_id": 43095386, "link": "https://stackoverflow.com/questions/43095386/delete-duplicates-if-they-are-together-in-a-column-excel", "title": "Delete duplicates if they are together in a column excel", "body": "<p>I am trying to delete entire row if duplicates are found together. If not found together I want to keep it without deleting. </p>\n\n<pre><code>For an example Column A:\nApple,\nApple,\nOrange,\nOrange,\nApple,\nApple,\n</code></pre>\n\n<p>I need to have the output as;</p>\n\n<pre><code>Apple,\nOrange,\nApple, \n</code></pre>\n\n<p>I'm using the following code but have not achieved the desired output yet (only get Apple, Orange).</p>\n\n<pre><code>   Sub FindDuplicates()\n   Dim LastRow, matchFoundIndex, iCntr As Long\n   LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n   For iCntr = 1 To LastRow      \n   If Cells(iCntr, 1) &lt;&gt; \"\" Then\n   matchFoundIndex = WorksheetFunction.Match(Cells(iCntr, 1), Range(\"A1:A\" &amp;      LastRow), 0)\n   If iCntr &lt;&gt; matchFoundIndex Then\n   Cells(iCntr, 10) = \"Duplicate\"\n   End If\n   End If\n   Next\n\n   last = Cells(Rows.Count, \"J\").End(xlUp).Row ' check results col for values\n   For i = last To 2 Step -1\n   If (Cells(i, \"J\").Value) = \"\" Then\n   Else\n   Cells(i, \"J\").EntireRow.Delete  ' if values then delete\n   End If\n   Next i\n   End Sub \n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1490796463, "creation_date": 1490796463, "answer_id": 43095923, "question_id": 43095373, "link": "https://stackoverflow.com/questions/43095373/cut-string-at-special-position-vba/43095923#43095923", "title": "Cut String at Special Position VBA", "body": "<p>Here's a general solution to reduce any consecutive repetitions of a given character:</p>\n\n<pre><code>Sub RemoveRepetitions(s As String, c As String)\n    Dim len1 As Long, len2 As Long\n    Do\n        len1 = Len(s)\n        s = Replace(s, c &amp; c, c)\n        len2 = Len(s)\n    Loop Until len2 = len1\nEnd Sub\n\nSub testing()\n    Dim s As String: s = \"\\\\server\\\\\\\\\\\\Documents\\\\\\\\\\test\\\\954076\"\n    RemoveRepetitions s, \"\\\"\n    Debug.Print s\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>\\server\\Documents\\test\\954076</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1490807553, "creation_date": 1490807553, "answer_id": 43099951, "question_id": 43095373, "link": "https://stackoverflow.com/questions/43095373/cut-string-at-special-position-vba/43099951#43099951", "title": "Cut String at Special Position VBA", "body": "<p>if you're worried about <em>double</em> repetitions then it suffices </p>\n\n<pre><code>Dim strng As String\n\nstrng = \"\\server\\Documents\\test\\\\\\954076\"\n\nstrng = Replace(strng, \"\\\\\", \"\\\")\n</code></pre>\n\n<p>if you want to handle <code>multiple</code> repetitions then:</p>\n\n<pre><code>Dim strng As String\n\nstrng = \"\\server\\Documents\\test\\\\\\954076\"\n\nDo While Len(strng) - Len(Replace(strng, \"\\\\\", \"\\\")) &gt; 0\n    strng = Replace(strng, \"\\\\\", \"\\\")\nLoop\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 43095923, "answer_count": 2, "score": 1, "last_activity_date": 1594640178, "creation_date": 1490795179, "last_edit_date": 1594640178, "question_id": 43095373, "link": "https://stackoverflow.com/questions/43095373/cut-string-at-special-position-vba", "title": "Cut String at Special Position VBA", "body": "<p>I got this string here: \\server\\Documents\\test\\\\954076 \nhow i check if there is a \\ a second time and how i cut it then off?\nSo that \\server\\Documents\\test\\\\954076 is gonna be \\server\\Documents\\test\\954076</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "textjoin"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490795809, "post_id": 43095235, "comment_id": 73272441, "body": "You will need to show your code you already have, because StackOverflow is not a free code writing service."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1490797660, "post_id": 43095235, "comment_id": 73274060, "body": "It looks like you are trying to make a list of all the non-blank values in column B. The list is separated by line feeds so that all the values can go into a single cell. Are you trying to create a number of lists from teh groups of values in column B separated by blanks or just one list?"}, {"owner": {"reputation": 1, "user_id": 5947844, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205423273972574/picture?type=large", "display_name": "Alexan Topalian", "link": "https://stackoverflow.com/users/5947844/alexan-topalian"}, "edited": false, "score": 0, "creation_date": 1490797989, "post_id": 43095235, "comment_id": 73274359, "body": "@Jeeped Some context I have a list of suppliers and multiple POs(Purchase orders) I have the data organized to be one column suppliers and another POs. The goal is to copy the supplier and all corresponding pos in one cell, till the script finds a new supplier. hence a new non blank and it copys all cells above because those POs correspond to that supplier.I want a Non blank list in column B with all the blanks in B creating an action to copy all the cells in the next column. Hope that helps."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5947844, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205423273972574/picture?type=large", "display_name": "Alexan Topalian", "link": "https://stackoverflow.com/users/5947844/alexan-topalian"}, "edited": false, "score": 0, "creation_date": 1491246902, "post_id": 43099574, "comment_id": 73458066, "body": "I have attached what the data should like like in the question. Please click on the link. Basically the goal is to automate the copy and pasting of POs per supplier. So when the code finds a new supplier is copys all the POs above. Hope that helps."}, {"owner": {"reputation": 11, "user_id": 5487137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gJI9F.png?s=128&g=1", "display_name": "Colin Tindle", "link": "https://stackoverflow.com/users/5487137/colin-tindle"}, "reply_to_user": {"reputation": 1, "user_id": 5947844, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205423273972574/picture?type=large", "display_name": "Alexan Topalian", "link": "https://stackoverflow.com/users/5947844/alexan-topalian"}, "edited": false, "score": 0, "creation_date": 1491248352, "post_id": 43099574, "comment_id": 73458816, "body": "So I think what you&#39;re doing would be more easily achieved with a PivotTable. Or you could modify what I&#39;ve written to concatenate the values into your column F. If you can&#39;t modify what I&#39;ve written, then I&#39;d be doing your homework for you and you&#39;d be unable to amend it when things change."}], "tags": [], "owner": {"reputation": 11, "user_id": 5487137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gJI9F.png?s=128&g=1", "display_name": "Colin Tindle", "link": "https://stackoverflow.com/users/5487137/colin-tindle"}, "is_accepted": false, "score": 0, "last_activity_date": 1490810015, "last_edit_date": 1490810015, "creation_date": 1490806239, "answer_id": 43099574, "question_id": 43095235, "link": "https://stackoverflow.com/questions/43095235/copy-a-list-using-non-blank-and-blank-rows-as-a-head-and-tail-loop/43099574#43099574", "title": "Copy a list using Non blank and Blank rows as a head and tail loop", "body": "<p>I'm having difficulty understanding the structure of your data, but using <code>For Each x In Selection</code> might help you. I'm assuming that your data at least similar the below, where the supplier names are in column A, and POs are in column B</p>\n\n<pre>\n     |   A   |   B   |   C   |   D   |\n-----|-------|-------|-------|-------|\n  1  |   s1  |  PO1  |       |       |\n-----|-------|-------|-------|-------|\n  2  |   s2  |  PO2  |       |       |\n-----|-------|-------|-------|-------|\n  3  |   s3  |       |       |       |\n-----|-------|-------|-------|-------|\n  4  |   s4  |  PO3  |       |       |\n-----|-------|-------|-------|-------|\n</pre>\n\n<p>This code will copy any supplier and PO (where PO isn't blank) to columns C and D:</p>\n\n<pre><code>outRow = 1  ' Set this to the index of the first row you want to output to\n\n' Run through each cell in Selection, left to right, top to bottom\nFor Each selCell In Selection\n  ' Check for non-blank, but only if we're looking at column 2 (B)\n  If selCell.Column = 2 &amp; selCell &lt;&gt; \"\" then\n    ' Store the selected Row and Column\n    sRow = selCell.Row\n    sCol = selCell.Column\n\n    ' Has the effect of prefixing ActiveSheet to any values that start with \".\"\n    With ActiveSheet\n      ' Copy value from cols 1 and 2 (A &amp; B) to col 3 and 4 (C &amp; D)\n      .Cells(outRow, 3).Value = .Cells(sRow, sCol - 1).Value\n      .Cells(outRow, 4).Value = selCell.Value\n    End With\n\n    outRow = outRow +1  ' Moves to next output row\n  End If\nNext\n</code></pre>\n\n<p>In my example, assuming you selected A1:B4 before running the function, you will get the below output. </p>\n\n<pre>\n     |   A   |   B   |   C   |   D   |\n-----|-------|-------|-------|-------|\n  1  |   s1  |  PO1  |   s1  |  PO1  |\n-----|-------|-------|-------|-------|\n  2  |   s2  |  PO2  |   s2  |  PO2  |\n-----|-------|-------|-------|-------|\n  3  |   s3  |       |   s4  |  PO3  |\n-----|-------|-------|-------|-------|\n  4  |   s4  |  PO3  |       |       |\n-----|-------|-------|-------|-------|\n</pre>\n\n<p>I'm guessing that you're using the Macro recording option to produce the code you have; this is a great way to learn how VBA works (most of us have done this at some point), but doesn't produce nice code. The built in documentation in Excel is actually really good and is worth looking at when you hit the limitations of the recorder. </p>\n\n<p>Edit: <i>The more I look at your question, the less sure I am about what you're asking, but hopefully the above at least pushes you in the right direction. </i></p>\n"}], "owner": {"reputation": 1, "user_id": 5947844, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205423273972574/picture?type=large", "display_name": "Alexan Topalian", "link": "https://stackoverflow.com/users/5947844/alexan-topalian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1491246823, "creation_date": 1490794877, "last_edit_date": 1491246823, "question_id": 43095235, "link": "https://stackoverflow.com/questions/43095235/copy-a-list-using-non-blank-and-blank-rows-as-a-head-and-tail-loop", "title": "Copy a list using Non blank and Blank rows as a head and tail loop", "body": "<p>HI so I have a set of data that I would like to copy. Basically I would like to create an if function. If we search for a blank row in column B and it is blank, loop to the next row, and continue until the first non blank row. If we hit a non blank copy all the cells from all the blank rows in column c.</p>\n\n<pre><code>    Sub NotReadys()\n\n ' NotReadys Macro'\nDim Z As Integer 'Supplier Beginning Row'\nDim X As Integer 'Next Non Blank row'\nDim Q As Integer '# of suppliers'\nDim Y As Integer 'Paste Row'\nY = 6\n'For T = 1 To 195\n\n\nActiveWindow.SmallScroll Down:=-33\n\n\nRange(\"B\" &amp; Y).Select\nSelection.Copy\n\nRange(\"E\" &amp; Y).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"F\" &amp; Y).Select\nApplication.CutCopyMode = False\nActiveCell.FormulaR1C1 = \"=TEXTJOIN(CHAR(10),FALSE,RC[-3]:R[30]C[-3])\"\nRange(\"F\" &amp; Y).Select\nActiveWindow.SmallScroll Down:=-30\nRange(\"F\" &amp; Y).Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    Y = Y + 1\n    Next T\n\n    End Sub\n</code></pre>\n\n<p><a href=\"https://imgur.com/XGwB4XR\" rel=\"nofollow noreferrer\">http://imgur.com/XGwB4XR</a></p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 0, "creation_date": 1490795020, "post_id": 43095155, "comment_id": 73271751, "body": "May I suggest a different approach.  Did you see this post <a href=\"http://stackoverflow.com/questions/158633/how-can-i-send-an-http-post-request-to-a-server-from-excel-using-vba\" title=\"how can i send an http post request to a server from excel using vba\">stackoverflow.com/questions/158633/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1490795051, "post_id": 43095155, "comment_id": 73271780, "body": "Try <code>While ie.Busy Or ie.READYSTATE &lt;&gt; 4</code>"}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490795972, "post_id": 43095155, "comment_id": 73272589, "body": "@Jeeped thanks for your help. Unfortunately it didn&#39;t work :("}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "reply_to_user": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 0, "creation_date": 1490796122, "post_id": 43095155, "comment_id": 73272727, "body": "@Miguel thanks for your help. I don&#39;t understand how I can applicate the code that you suggest"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490801088, "post_id": 43096864, "comment_id": 73276921, "body": "Miguel, when I copy and paste your code and run it, I have this error: 424: object required :("}, {"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "reply_to_user": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490801978, "post_id": 43096864, "comment_id": 73277635, "body": "Anna did you add the reference as I told you above?"}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490803934, "post_id": 43096864, "comment_id": 73279137, "body": "Set Elements = Document.getElementById(&quot;footer- menu&quot;).getElementsByTagName(&quot;div&quot;)"}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490803965, "post_id": 43096864, "comment_id": 73279157, "body": "Thanks in advance for all your help (:"}, {"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "reply_to_user": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490805634, "post_id": 43096864, "comment_id": 73280249, "body": "@ Ana try again there was a space between footer and menu that I most have inserted while copy and paste. I apologize. Make sure that your immediate window is open so you can see the results."}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490809821, "post_id": 43096864, "comment_id": 73283004, "body": "now your code works :) thanks. but when I try to change and use to my website I get the same error!"}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490809916, "post_id": 43096864, "comment_id": 73283063, "body": "The html code for box that I want to fill up is : &lt;input name=&quot;q20_yourEmail&quot; class=&quot;form-textbox validate[required, Email] form-validation-error&quot; id=&quot;input_20&quot; type=&quot;email&quot; size=&quot;30&quot; placeholder=&quot;ex: myname@example.com&quot; value=&quot;&quot; data-component=&quot;email&quot;&gt;  so i need to use the line like this right?  Set elements = document.getElementById(&quot;input_20&quot;).getElementsByTagName(&quot;in&zwnj;&#8203;put&quot;)"}, {"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "reply_to_user": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490810832, "post_id": 43096864, "comment_id": 73283597, "body": "Ana what is your website I can&#39;t help you working in the blind... and please post that html with code tags in your initial post."}, {"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "reply_to_user": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490812475, "post_id": 43096864, "comment_id": 73284561, "body": "@Ana, I added a comment in code. If you are targeting an input box like the one you suggested you would need to do this instead <code>IEApp.Document.getElementsByName(&quot;q20_yourEmail&quot;)(0).Value = &quot;hello&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490813594, "post_id": 43096864, "comment_id": 73285290, "body": "Miguel, I can&#39;t give you the website because ti&#39;s confidencial. But I applied your new code and now I get a different error: code 91 - object variable or with block variable not set.  Thanks so much for your time"}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490814131, "post_id": 43096864, "comment_id": 73285688, "body": "<a href=\"https://iam.pearson.com/auth/XUI/#login/\" rel=\"nofollow noreferrer\">iam.pearson.com/auth/XUI/#login</a>  you can use this site as example. I need to fill the user name box and password and then click login :) thanks again"}, {"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "reply_to_user": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490814176, "post_id": 43096864, "comment_id": 73285715, "body": "@Anna, I changed the code to an example of navigating to google and then putting my name on the google search box. That is equivalent to what you are trying to do. Please try it and replace the <code>getElementsByName</code> with the name of your <code>input</code> that should work barring that your webpage has the input box  in the page you are calling."}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490815188, "post_id": 43096864, "comment_id": 73286324, "body": "it can be a problem if my form is inside another form?"}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490815375, "post_id": 43096864, "comment_id": 73286428, "body": "i&#39;m asking because when I use your code for another pages, it works  ;/"}, {"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "reply_to_user": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490815512, "post_id": 43096864, "comment_id": 73286540, "body": "@Anna, you gave me an example and that&#39;s what I used to give you an answer. Yes it matters, because you are targeting individual nodes in a webpage,every web page is different and different things are named differently in other pages. Therefore  your &#39;FORM(0)&#39; might be <code>FORM(01)</code> in your code etc."}, {"owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "edited": false, "score": 0, "creation_date": 1490816400, "post_id": 43096864, "comment_id": 73287084, "body": "Thanks for your explanation Miguel. when I run the new code I have an error on this line Set form = IEApp.Document.getElementsByTagName(&quot;FORM&quot;)(0) &#39;1st table  compile error: expected function or variable :("}], "tags": [], "owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "is_accepted": true, "score": 0, "last_activity_date": 1490815109, "last_edit_date": 1490815109, "creation_date": 1490798780, "answer_id": 43096864, "question_id": 43095155, "link": "https://stackoverflow.com/questions/43095155/vba-to-complete-a-internet-form/43096864#43096864", "title": "VBA to complete a Internet form", "body": "<p>Ana,\nHere is a working example. You can easily customized this little bit of code to work for you. One time you must be aware of is that I added a reference to my project under <strong>TOOLS -> Preferences -> Microsoft Internet Controls</strong>. Also another word of caution is on this line <code>Set Elements</code> on this line, if you are looking for something that does not exists you will end up with an error. This working example I put together goes to stack overflow and finds the elements below  <code>footer-menu</code>.\nLet me know if something does not make sense.</p>\n\n<pre><code>Sub TryInternetExplorer()\n 'Reference to system32\\shdocvw.dll  'Microsoft Internet Controls\nDim IEApp As InternetExplorer\nSet IEApp = New InternetExplorer\nIEApp.Visible = True\nIEApp.Navigate \"https://iam.pearson.com/auth/XUI/#login/\"\nWhile IEApp.ReadyState &lt;&gt; READYSTATE_COMPLETE And IEApp.ReadyState &lt;&gt; READYSTATE_LOADED\n    DoEvents\nWend\n\n'wait for the form to load\nDo\nSet form = IEApp.Document.getElementsByTagName(\"FORM\")(0) '1st table\nDoEvents\nLoop While form Is Nothing\n\n IEApp.Document.getElementsByName(\"callback_0\")(0).Value = \"Miguel\"\n IEApp.Document.getElementsByName(\"callback_1\")(0).Value = \"pass\"\n IEApp.Document.getElementsByName(\"callback_2\")(0).Click\n\n\nSet Document = Nothing\nSet IEApp = Nothing\n\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7786133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154166687201652/picture?type=large", "display_name": "Ana Catarina Sabino", "link": "https://stackoverflow.com/users/7786133/ana-catarina-sabino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 43096864, "answer_count": 1, "score": 0, "last_activity_date": 1490815109, "creation_date": 1490794682, "question_id": 43095155, "link": "https://stackoverflow.com/questions/43095155/vba-to-complete-a-internet-form", "title": "VBA to complete a Internet form", "body": "<p>I'm looking for a code to put values from an Excel to a Webpage.</p>\n\n<pre><code>Sub FillInternetForm()\n  Dim IE As Object\n  Set IE = CreateObject(\"InternetExplorer.Application\")\n\n  IE.navigate \"http://xxxxxxxx/\"\n  IE.Visible = True\n  While IE.Busy\n    DoEvents  \n  Wend\n  IE.document.getElementById(\"xxxxx\").Value = \"xxxx\"\nEnd Sub\n</code></pre>\n\n<p>The error comes in on IE.document.getElementById(\"xxxxx\").Value = \"xxxx line and it says Method 'Document' of object 'IWebBrowser 2' failed. </p>\n\n<p>I'm looking for suggstions to solve this question: I made a lot of research and nothing works :/</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490794756, "post_id": 43095147, "comment_id": 73271509, "body": "Please show your code. StackOverflow is not a free code writing service."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1490794983, "post_id": 43095147, "comment_id": 73271709, "body": "&quot;I have no issues copying the entire last row&quot; - show us how you do this and we can show you how to copy the range you want."}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "edited": false, "score": 0, "creation_date": 1490795189, "post_id": 43095147, "comment_id": 73271911, "body": "Apologies about earlier yes. I have now included code for copying entire row. When I enter a range however it does not work. I suspect i need to define the lastrow?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 4, "last_activity_date": 1490795314, "creation_date": 1490795314, "answer_id": 43095428, "question_id": 43095147, "link": "https://stackoverflow.com/questions/43095147/copying-selection-from-last-row/43095428#43095428", "title": "Copying selection from last row", "body": "<p>Instead of the entire row set the range:</p>\n\n<pre><code>Dim lastRow as long\n\nWith Activesheet \n    lastRow = .cells(.rows.count,1).end(xlup).Row\n    .Range(.Cells(lastrow,\"A\"),.Cells(lastrow,\"P\")).copy \nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1490809103, "creation_date": 1490809103, "answer_id": 43100454, "question_id": 43095147, "link": "https://stackoverflow.com/questions/43095147/copying-selection-from-last-row/43100454#43100454", "title": "Copying selection from last row", "body": "<p>you can use:</p>\n\n<pre><code>With ActiveSheet\n    .Cells(.Rows.Count, 1).End(xlUp).EntireRow.Columns(\"A:P\").Copy\nEnd With\n</code></pre>\n\n<p>or, since <code>ActiveSheet</code> is the default sheet, simply:</p>\n\n<pre><code>Cells(Rows.Count, 1).End(xlUp).EntireRow.Columns(\"A:P\").Copy\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1490809103, "creation_date": 1490794671, "last_edit_date": 1531164843, "question_id": 43095147, "link": "https://stackoverflow.com/questions/43095147/copying-selection-from-last-row", "title": "Copying selection from last row", "body": "<p>I have a table, with headers in the range <code>A2:V2</code> and the data in the range <code>A3:VXX</code>, where <code>XX</code> is the last row number.</p>\n\n<p>I am trying to write a macro which duplicates the values of the last row, but only for columns <code>A:P</code>. So Duplicating the values in <code>AXX:PXX</code>. I have no issues finding and copying the <em>entire</em> last row, however I cannot copy a limited range within it.</p>\n\n<p>Apologies earlier for not including the code I have used.</p>\n\n<pre><code>With Activesheet \n    .cells(.rows.count,1).end(xlup).entirerow.copy \nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1490793675, "post_id": 43094693, "comment_id": 73270605, "body": "Some sample data would be very useful too!"}, {"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 3, "creation_date": 1490794269, "post_id": 43094693, "comment_id": 73271090, "body": "Hello Jethro, can you post up some sample data, it could be very useful for us to help you. Perhaps even a picture of the worksheet you are working with. Your are close to the problem, so it is easy for you to conceptualize, but we need a little more help from you, to help you."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1490794864, "post_id": 43094693, "comment_id": 73271600, "body": "Are you looking at a contiguous series of data of more than one truck like: <code>-4,-4,-3,-2,-3,-4,-4,-1,0,1,2,3,2,1,0,-4,-4,-3,-2,-3,-4,-4,-&zwnj;&#8203;4,-4,-3,-2,-3,-4,-4,&zwnj;&#8203;0,2,4,5,4,2,0</code> - and you are just looking for the <code>3</code> and the <code>5</code> ?"}, {"owner": {"reputation": 25, "user_id": 4864613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UOeV4S_WTy4/AAAAAAAAAAI/AAAAAAAAAI0/qDdB0tw4xLE/photo.jpg?sz=128", "display_name": "Jethro Land", "link": "https://stackoverflow.com/users/4864613/jethro-land"}, "edited": false, "score": 0, "creation_date": 1490799984, "post_id": 43094693, "comment_id": 73276085, "body": "Robin, spot on. Basically there&#39;s a lot of garbage data at the lower end (mine is like -30,000 and yours is like -4, same difference) and a bit of good data near the top (40,000 and 5). I need the highest value of each discrete &quot;peak&quot; summed. In your case, there are 2 peaks, one with a max at 3 and one with a max at 5. The function I wish to create would return 8"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4864613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UOeV4S_WTy4/AAAAAAAAAAI/AAAAAAAAAI0/qDdB0tw4xLE/photo.jpg?sz=128", "display_name": "Jethro Land", "link": "https://stackoverflow.com/users/4864613/jethro-land"}, "edited": false, "score": 0, "creation_date": 1490804510, "post_id": 43096117, "comment_id": 73279522, "body": "Seems to work well, though I seriously think my data is bad to the point where I&#39;ll need to massage your code to get it to work. A rough estimate puts us at around 900,000lbs according to the entirety of the graph. My inventory guy says it should be around 300,000lbs (not sure how much stock I put in this, he&#39;s crazy busy and I didn&#39;t ask any followup questions). Your code is 214,000lbs. I&#39;m not willing to definitively say this is the answer until I get a result that is more consistent across the board (not trying to insult your code if it came across like that)."}, {"owner": {"reputation": 151, "user_id": 1399616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMsUc.jpg?s=128&g=1", "display_name": "Matt M", "link": "https://stackoverflow.com/users/1399616/matt-m"}, "reply_to_user": {"reputation": 25, "user_id": 4864613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UOeV4S_WTy4/AAAAAAAAAAI/AAAAAAAAAI0/qDdB0tw4xLE/photo.jpg?sz=128", "display_name": "Jethro Land", "link": "https://stackoverflow.com/users/4864613/jethro-land"}, "edited": false, "score": 0, "creation_date": 1490806787, "post_id": 43096117, "comment_id": 73281001, "body": "No offense taken.  Depending on the data, there can certainly be some scenarios that my function hasn&#39;t accounted for.  Perhaps there is a scenario where trucks are measured within succession, and the scale never measures below 0 (or the noise factor), for example.  Good luck, and feel free to ask for help in accounting for any specific scenarios you encounter."}, {"owner": {"reputation": 25, "user_id": 4864613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UOeV4S_WTy4/AAAAAAAAAAI/AAAAAAAAAI0/qDdB0tw4xLE/photo.jpg?sz=128", "display_name": "Jethro Land", "link": "https://stackoverflow.com/users/4864613/jethro-land"}, "edited": false, "score": 0, "creation_date": 1490807707, "post_id": 43096117, "comment_id": 73281637, "body": "I think I solved it, I just looked for where the weight dropped significantly (5000lbs or more in 15s but I&#39;ll tweak this) and took the max value of the 10 previous cells. I summed these max weights and got a touch over a million pounds, compared to my estimate of just over 900,000lbs I&#39;m happy with this, and I already can see some errors that&#39;ll bring these numbers closer. Your code can definitely still be useful, even if only for documentation. Can I get your ok in including it in my final product? It&#39;s for purely internal use and I can credit you however you&#39;d like."}, {"owner": {"reputation": 151, "user_id": 1399616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMsUc.jpg?s=128&g=1", "display_name": "Matt M", "link": "https://stackoverflow.com/users/1399616/matt-m"}, "reply_to_user": {"reputation": 25, "user_id": 4864613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UOeV4S_WTy4/AAAAAAAAAAI/AAAAAAAAAI0/qDdB0tw4xLE/photo.jpg?sz=128", "display_name": "Jethro Land", "link": "https://stackoverflow.com/users/4864613/jethro-land"}, "edited": false, "score": 0, "creation_date": 1490816956, "post_id": 43096117, "comment_id": 73287414, "body": "I seek no credit. That code belongs to the world and you can use it however you&#39;d like. I&#39;m happy it helped you find your solution."}], "tags": [], "owner": {"reputation": 151, "user_id": 1399616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMsUc.jpg?s=128&g=1", "display_name": "Matt M", "link": "https://stackoverflow.com/users/1399616/matt-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1490796949, "creation_date": 1490796949, "answer_id": 43096117, "question_id": 43094693, "link": "https://stackoverflow.com/questions/43094693/excel-vba-determining-mass-of-truck-shipments/43096117#43096117", "title": "Excel VBA Determining Mass of Truck Shipments", "body": "<p>My understanding of the data is in line with Robin's comment.  There are a couple of ways to solve this problem.  I've written a function loops through data range looking for the 'next zero' in the data set, and calculates the max value between the current row and the row that the 'next zero' is in.  If the max value is above the value of your noise filter, the value will be added to the running total.  </p>\n\n<pre><code>Option Explicit\n\nPrivate Const NOISE_FILTER As Double = 5000\n\nPublic Function TruckLoad(rngData As Range) As Double\n\n    Dim r As Integer\n    Dim runningTruckLoad As Double\n    Dim maxLoadReading As Double\n    Dim nextZeroRow As Integer\n\n    For r = 1 To rngData.Rows.Count\n\n        nextZeroRow = FindNextZeroRow(r, rngData)\n\n        maxLoadReading = Application.WorksheetFunction.Max(Range(rngData.Cells(r, 1), rngData.Cells(nextZeroRow, 1)))\n\n        If maxLoadReading &gt; NOISE_FILTER Then\n            runningTruckLoad = runningTruckLoad + maxLoadReading\n        End If\n\n        r = nextZeroRow 'skip the loop counter ahead to our new 0 row\n\n    Next r\n\n    TruckLoad = runningTruckLoad\n\nEnd Function\n\nPrivate Function FindNextZeroRow(startRow As Integer, searchRange As Range) As Integer\n\n    Dim nextZeroRow As Range\n\n    Set nextZeroRow = searchRange.Find(0, searchRange.Rows(startRow))\n\n    If nextZeroRow.Row &lt; startRow Then 'we've hit the end of the data range\n        FindNextZeroRow = startRow\n    ElseIf nextZeroRow.Value &lt;&gt; 0 Then  'we've found a data point with a zero in it, not interested in this row\n        FindNextZeroRow = FindNextZeroRow(nextZeroRow.Row, searchRange)\n    Else\n        FindNextZeroRow = nextZeroRow.Row 'we've found our next zero data point\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4864613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UOeV4S_WTy4/AAAAAAAAAAI/AAAAAAAAAI0/qDdB0tw4xLE/photo.jpg?sz=128", "display_name": "Jethro Land", "link": "https://stackoverflow.com/users/4864613/jethro-land"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 43096117, "answer_count": 1, "score": 1, "last_activity_date": 1490800245, "creation_date": 1490793508, "last_edit_date": 1490800245, "question_id": 43094693, "link": "https://stackoverflow.com/questions/43094693/excel-vba-determining-mass-of-truck-shipments", "title": "Excel VBA Determining Mass of Truck Shipments", "body": "<p>I have a system where I have a list of data from a truck scale reading the weight of a truck on a scale. This data ranges from -30,000lbs or so due to the scale being tared but truckless, to 40,000lbs with a full and tared truck on it. My task is to determine the total weight that has left our facility via truck. The problem is some days only a few trucks leave our facility and others a dozen leave, all with slightly different weights.</p>\n\n<p>The graph of these weights looks like a saw tooth pattern. It is a largely negative value (due to tare), quickly reaches approximately zero as a truck pulls onto the scale, and slowly builds to a final weight. After the final weight is reached the weight quickly goes back to the largely negative value as the truck pulls away.</p>\n\n<p>My idea on how to approach this is look for where the data is less than zero and return the max weight of the sensor between zeros. If the max weight is above some noise filter value (say, 5000lbs) then add the max weight to some counter. In theory, not bad, in practice, a bit out of my league.</p>\n\n<p>Here's my code so far, as I know I need to show my effort so far. I recommend ignoring it as it's mostly just a failed start after a few days of restarting work.</p>\n\n<pre><code>Public Function TruckLoad(rngData As Range)\nDim intCount As Integer\nintCount = 0\nFor Each cell In rngData\n    intCount = intCount + 1\nNext cell\nDim n As Integer\nn = 1\nDim x As Integer\nx = 1\nDim arr() As Double\nFor i = 1 To intCount\n    If rngData(i, 1) &lt; 0 Then\n        arr(n) = x\n        n = n + 1\n        x = x + 1\n    Else\n        x = x + 1\n    End If\nNext\nTruckLoad = arr(1)\n\nEnd Function\n</code></pre>\n\n<p>If anyone could give me advice on how to proceed it would be extremely valuable. I'm not a computer programmer outside of the very basics.</p>\n\n<p>Edit: Sorry, I should have said this initially. I can't post the entirety of the raw sample data but I can post a photo of a graph. There is a degree to which I can't post publicly (not that you can do anything particularly nefarious with the data, it's a corporate rule).</p>\n\n<p>www.imgur.com/a/LGQY9</p>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1490793210, "post_id": 43094557, "comment_id": 73270210, "body": "General rule: <b>never</b> change a user&#39;s desktop settings just to make your code work."}, {"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1490793314, "post_id": 43094557, "comment_id": 73270285, "body": "haha, thank you for the insight @Rory"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1490795011, "post_id": 43094557, "comment_id": 73271739, "body": "The instruction separator / colon is superfluous at the end of the <code>On Error</code> statement. <code>On Error GoTo ErrorHandler</code> is all you need. That said, @Rory&#39;s recommendation wasn&#39;t a joke - it&#39;s not clear what problem you&#39;re trying to solve, but tampering with the user&#39;s local settings is a sloppy work-around for sloppy code. Write code that isn&#39;t locale-dependent instead. Treat numbers as numbers, not strings, for a start."}], "answers": [{"comments": [{"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1490796954, "post_id": 43095910, "comment_id": 73273390, "body": "thank you for the recommendation and again for the insight, Now I will have to seriously think a huge change for my code then. My excuse: I treat numbers as string because I write them to a text file. Basically I make an operation x = 3*0.1, now x is 0.3 and I have to write in the text file 0.3 not 0,3 ..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1490797172, "post_id": 43095910, "comment_id": 73273587, "body": "When you read the file back, convert numeric values to numeric types as soon as possible; a file is just another form of input, and all inputs require validation."}, {"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1490797379, "post_id": 43095910, "comment_id": 73273800, "body": "I am not the one to read the file, and the file has very strong formatting requirement coming from clients."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1490797473, "post_id": 43095910, "comment_id": 73273887, "body": "Well then, it&#39;s pretty simple: the only code that needs to be concerned with the file&#39;s format is the code that&#39;s writing to it! Everything else works with numbers - the file-writing code&#39;s job is to format these numbers per the file format&#39;s specifications."}, {"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1490798043, "post_id": 43095910, "comment_id": 73274406, "body": "Indeed you are right it is simple like this, the problem is just that this code writes quite a lot, now I have to go through a few ~300 <code>Replace(Number, &quot;,&quot;, &quot;.&quot;) </code> I was hopping for a proper turn around. For my own usage it was ok to only change the settings."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1490798254, "post_id": 43095910, "comment_id": 73274599, "body": "If your code is minimally modularized and cohesive, that stringifying code should be very very very close to where you&#39;re writing the file, and no other code should be consuming the strings. I would use <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (my VBE add-in OSS project) to easily locate all usages of <code>VBA.Strings.Replace</code> in your code."}, {"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1490798731, "post_id": 43095910, "comment_id": 73275014, "body": "Rubberduck looks Interesting, I will have a deeper look later"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 1, "creation_date": 1490806821, "post_id": 43095910, "comment_id": 73281022, "body": "@Jonathan awesome! feel free to report issues (a number of 2.0.13 issues are already fixed and pending release though) and make feature requests on our GitHub repository - and star us if you like! =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1490797440, "last_edit_date": 1490797440, "creation_date": 1490796425, "answer_id": 43095910, "question_id": 43094557, "link": "https://stackoverflow.com/questions/43094557/vba-on-error-statement-safety/43095910#43095910", "title": "Vba: \u2018On error\u2019 statement safety", "body": "<p>There are many ways VBA code can get interrupted, some not even involving a clever user that would break on a <code>MsgBox</code> and hit the <kbd>Stop</kbd> button: If the host crashes for of something completely unrelated to your code (some KB updates come to mind), in the middle of a procedure's execution, then your error handlers won't be jumped into and there's nothing you can do to prevent that.</p>\n\n<p>Don't tamper with user's local settings. Fix your code instead.</p>\n\n<blockquote>\n  <p><em>I already know I can convert all my numbers using <code>String = Replace(Number, \",\", \".\")</code></em></p>\n</blockquote>\n\n<p>Your code is treating numbers as strings, or vice-versa. If the number came from a cell in a worksheet, you can read it into a <code>Double</code> without having to think about what the user's decimal separator is.</p>\n\n<pre><code>Dim myNumber As Double\nWith ActiveSheet\n    If IsNumeric(.Range(\"A1\").Value) And Not IsError(.Range(\"A1\").Value) Then myNumber = CDbl(.Range(\"A1\").Value)\n    'myNumber contains a valid numeric value\nEnd With\n</code></pre>\n\n<p>If the number came from a textbox on a UserForm you crafted, and you allowed the user to enter a comma when your code requires that to be a dot, then you need to fix your data entry code and add some input validation to prevent that. One way to do this is to handle the <code>KeyPress</code> event of the <code>TextBox</code> control that's receiving the user's input - and \"swallow\" any invalid keys:</p>\n\n<pre><code>Private Sub txtInput_KeyPress(ByVal keyAscii As MSForms.ReturnInteger)\n    If Not IsValidKeyAscii(keyAscii, txtInput.Value) Then keyAscii = 0\nEnd Sub\n\nPrivate Function IsValidKeyAscii(ByVal keyAscii As Integer, ByVal value As String) As Boolean\n'returns true if specified keyAscii is a number, or if it's a dot and value doesn't already contain one\n    IsValidKeyAscii = (keyAscii = vbKeyDot And InStr(1, value, Chr$(vbKeyDot)) = 0) Or (keyAscii &gt;= vbKey0 And keyAscii &lt;= vbKey9)\nEnd Function\n</code></pre>\n\n<p>If the number came from an <code>InputBox</code>, you won't be able to prevent the user from entering whatever they want, but you can still validate the input and prevent bad input from being propagated further into your code.</p>\n\n<pre><code>Private Function PromptForNumber() As Double\n    Dim isValid As Boolean\n    Dim userInput As String\n    Do\n        userInput = InputBox(\"Enter a decimal number:\")\n        isValid = IsNumeric(userInput) And InStr(userInput, \",\") = 0\n        If Not isValid Then MsgBox \"Value '\" &amp; userInput &amp; \"' is not numeric. Please make sure to use [en-US] decimal separator.\"\n    While Not isValid\n    PromptForNumber = CDbl(userInput)\nEnd Function\n</code></pre>\n\n<p>There's simply no excuse for messing with the user's Control Panel settings.</p>\n"}, {"comments": [{"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 1, "creation_date": 1490798126, "post_id": 43096125, "comment_id": 73274485, "body": "Thank you for the clear example! I was also expecting to overlook some issues, in the code I am using, there is fortunately no <code>End</code> statements. From looking at the reactions I think I also need to review my code entirely."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1490796968, "last_edit_date": 1495540920, "creation_date": 1490796968, "answer_id": 43096125, "question_id": 43094557, "link": "https://stackoverflow.com/questions/43094557/vba-on-error-statement-safety/43096125#43096125", "title": "Vba: \u2018On error\u2019 statement safety", "body": "<p>If the <a href=\"https://stackoverflow.com/questions/36491908/whats-the-deference-between-end-and-exit-sub-in-vba\"><code>End</code></a> command is encountered anywhere in the code then this will foil your plan.</p>\n\n<p>Take a look at the example below. If <code>A</code> calls <code>B</code> then no problem, errors are handled and when control returns to <code>A</code> the handler will still execute your locale reset. But uncomment the call to <code>C</code> and run the code again. Execution simply stops and control never returns to <code>A</code> so the reset is not performed.</p>\n\n<p>So your scenario is that you send the workbook to your colleague and then they to add on some more logic which uses the <code>End</code> command for whatever reason. </p>\n\n<pre><code>Option Explicit\n\nSub A()\n    On Error GoTo ErrHandler\n\n    Dim foo As Long\n\n    'call B\n    B\n    ' call C - uncomment to see impact\n    'C\n\nErrHandler:\n    Debug.Print \"Error occurred in A\"\n    Debug.Print \"Fixing locale stuff...\"\n\nEnd Sub\n\nSub B()\n    On Error GoTo ErrHandler\n\n    Dim foo As Long\n\n    'cause an error\n    foo = \"bar\"\n\nErrHandler:\n    Debug.Print \"Error occurred in B\"\n    Debug.Print Err.Description\n\nEnd Sub\n\nSub C()\n    On Error GoTo ErrHandler\n\n    Dim foo As Long\n\n    'cause an error\n    foo = \"bar\"\n\nErrHandler:\n    Debug.Print \"Error occurred in C\"\n    Debug.Print Err.Description\n    End\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 43095910, "answer_count": 2, "score": 1, "last_activity_date": 1490797440, "creation_date": 1490793136, "last_edit_date": 1531164843, "question_id": 43094557, "link": "https://stackoverflow.com/questions/43094557/vba-on-error-statement-safety", "title": "Vba: \u2018On error\u2019 statement safety", "body": "<p>I made a macro that records, then changes the local settings (in my case the decimal separator). At the end of the macro it would restore the settings.</p>\n\n<p>When there is an error I make the program also restore the local settings using the \u2018on error\u2019 statement.\n(A simplified  example of the program is given below)</p>\n\n<p>So far I got no issues; however, as I am now planning to transfer the program to my working colleagues, I really wish to not interfere with them and overwrite their own local settings.</p>\n\n<p>Does the <code>On error</code> statement is here safe enough to use and make sure that the settings are restored?</p>\n\n<p>Is there any case where the program could run into an error that the <code>On error</code> would fail to redirect to the error handler?</p>\n\n<p>PS: I already know I can convert all my numbers using <code>String = Replace(Number, \",\", \".\")</code> but for some reasons I cannot afford to go through all the many variables of the macro.</p>\n\n<p>Example Code:</p>\n\n<pre><code>Private Declare Function GetUserDefaultLCID% Lib \"kernel32\" ()\nPrivate Declare Function GetLocaleInfoA Lib \"kernel32\" (ByVal Locale As Long, ByVal LCType As Long, ByVal lpLCData As String, ByVal cchData As Long) As Long\nPrivate Declare Function SetLocaleInfoA Lib \"kernel32\" (ByVal Locale As Long, ByVal LCType As Long, ByVal lpLCData As String) As Boolean\n\nSub test()\n  ' what to do on error\n  On Error GoTo ErrorHandler:\n  ' define a number (Your local settings are set up to\n  Dim MyNumber As Single\n  MyNumber = 0.03\n  MsgBox (\"Number is 0,03 -&gt;\" &amp; MyNumber)\n  ' record the settings in the variable LocalSettingsDecimal\n  Dim LocalSettingsDecimal As String\n  Dim Buffer As String\n  Buffer = String(256, 0)\n  Dim le As Integer\n  le = GetLocaleInfoA(GetUserDefaultLCID(), 14, Buffer, Len(Buffer))\n  LocalSettingsDecimal = Left(Buffer, le - 1)\n\n  ' force decimal settings to '.'\n  Call SetLocaleInfoA(GetUserDefaultLCID(), 14, \".\")\n\n  ' Now is the program body\n  MsgBox (\"Number is now 0.03 -&gt;\" &amp; MyNumber)\n  ' an unfortunate error:\n  MyNumber = \"aa\"\n\n  Call SetLocaleInfoA(GetUserDefaultLCID(), 14, LocalSettingsDecimal)\n  MsgBox (\"Number should be back 0,03 -&gt;\" &amp; MyNumber)\n  Exit Sub\n  ErrorHandler:\n  Call SetLocaleInfoA(GetUserDefaultLCID(), 14, LocalSettingsDecimal)\n  MsgBox (\"There was an error but it's ok, it should be back to 0,03 -&gt;\" &amp; MyNumber)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490790983, "post_id": 43093643, "comment_id": 73268392, "body": "Your worksheet example did not get attached"}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490790997, "post_id": 43093643, "comment_id": 73268403, "body": "I tried to upload an image to help explain this but it won&#39;t let me, I&#39;ll try again"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1490791095, "post_id": 43093643, "comment_id": 73268485, "body": "It would be better if you could &quot;fake a table&quot; in text, that can be copied/pasted into a worksheet.  Can&#39;t do that with an image."}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490791208, "post_id": 43093643, "comment_id": 73268566, "body": "Ok, don&#39;t give up on me... I did make a fake table, and I have it in a worksheet, I&#39;m just trying to figure out how to get it attached to this question... I&#39;m sorry I&#39;m obviously very new here :(  I&#39;m thankful you answered me!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490791421, "post_id": 43093643, "comment_id": 73268709, "body": "Try <a href=\"https://senseful.github.io/web-tools/text-table\" rel=\"nofollow noreferrer\">Senseful Solutions</a>"}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490791804, "post_id": 43093643, "comment_id": 73269008, "body": "Almost done, I got it to make my table.  I&#39;m going to try to add the link"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490792478, "post_id": 43093643, "comment_id": 73269556, "body": "Don&#39;t add a link -- just copy/paste the results from SS into your original post."}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490792718, "post_id": 43093643, "comment_id": 73269766, "body": "Copy and paste the Output?  I really can&#39;t apologize enough for my ignorance"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490792997, "post_id": 43093643, "comment_id": 73270014, "body": "Use the MySQL or Unicode Art style output,  NOT the HTML"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490793521, "post_id": 43093643, "comment_id": 73270460, "body": "Then you use the <code>Code Sample</code> button so it will scroll, as I did."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490793791, "post_id": 43093643, "comment_id": 73270678, "body": "Your pasted example shows commas after each entry in Column P, even if there are more than four."}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490793873, "post_id": 43093643, "comment_id": 73270750, "body": "But there are no spaces after the comma once it hits line 3 between Q90.28 and B15"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490793946, "post_id": 43093643, "comment_id": 73270815, "body": "If you use the comma as the delimiter, your function seems to work OK. Your UDF is trimming the extraneous spaces anyway."}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490794698, "post_id": 43093643, "comment_id": 73271456, "body": "So maybe the commas aren&#39;t the problem then, when I run the VBA on column P it doesn&#39;t remove the duplicates, so I thought maybe the comma space issue was throwing it off"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490794880, "post_id": 43093643, "comment_id": 73271617, "body": "When I put your UDF into column Q, it returned the list originally in column P, without duplicates"}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490795113, "post_id": 43093643, "comment_id": 73271837, "body": "That makes me want to cry a bit, because I don&#39;t know what I&#39;m doing wrong.  I&#39;ve been doing this for 2 days"}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490796750, "post_id": 43093643, "comment_id": 73273212, "body": "Thank you so much for trying to help me Ron, I wish I could send you candy or flowers or something.  I don&#39;t know why it won&#39;t work for me, it just returns what I added to the original post :("}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490796846, "post_id": 43093643, "comment_id": 73273292, "body": "Perhaps you can upload a copy of your workbook to some file sharing site,and post the link to it here."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490797202, "post_id": 43093643, "comment_id": 73273630, "body": "What&#39;s the forumla you&#39;re using in column <code>Q</code>? You might be using it wrong?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490797543, "post_id": 43093643, "comment_id": 73273951, "body": "That&#39;s it, it should be <code>=RemoveDupes2(P2, &quot;,&quot;)</code> ... specify your delimiter bc the default delimiter of your UDF is the space!"}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "edited": false, "score": 0, "creation_date": 1490797556, "post_id": 43093643, "comment_id": 73273966, "body": "I probably am using it wrong.  I put the VBA in using F11, insert module, and then in Q I just typed =removedups2 which is the name of the thing and it comes up, so I double click it and I thought that would make it work..."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490797597, "post_id": 43093643, "comment_id": 73274003, "body": "As in my previous comment, specify the delimiter as comma: <code>=RemoveDupes2(P2, &quot;,&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "edited": false, "score": 0, "creation_date": 1490797628, "post_id": 43093643, "comment_id": 73274034, "body": "OH MY LANTA I COULD LITERALLY COME THROUGH MY COMPUTER AND HUG YOU.  THANK YOU THANK YOU THANK YOU THANK YOU THANK YOU!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"}, {"owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "edited": false, "score": 0, "creation_date": 1490797755, "post_id": 43093643, "comment_id": 73274147, "body": "Thank you both, you don&#39;t even understand.  I&#39;ll educate myself further before I come back and bother anyone again.  I honestly can not thank you both enough"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490797850, "post_id": 43093643, "comment_id": 73274234, "body": "@KLM You did not bother anyone, you&#39;re welcome anytime and we are glad to help :)"}], "owner": {"reputation": 11, "user_id": 7781891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mzag6N-PocY/AAAAAAAAAAI/AAAAAAAAADk/paZz9Ompk0c/photo.jpg?sz=128", "display_name": "KLM", "link": "https://stackoverflow.com/users/7781891/klm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490795773, "creation_date": 1490790789, "last_edit_date": 1490795773, "question_id": 43093643, "link": "https://stackoverflow.com/questions/43093643/progressive-column-grouping-spacing-issue", "title": "Progressive column grouping spacing issue", "body": "<p>I have four columns of Ident codes corresponding to a single individual with multiple entries.  I need to get a list of all unique Ident codes corresponding to each individual on one line with a comma followed by a space between them. \nI have a VBA to remove the duplicates, but the VBA won't work - I think because the commas don't have a space after them in the final row of Ident code data that I'm asking it to look at.  I feel like there is an easy solution and I'm just not seeing it. I'm VERY new to VBA and moderately good with Excel.</p>\n\n<p>This is the statement I'm using to return the progressive values of codes pertaining to each person, the final row being the culmination of all of their codes in one cell</p>\n\n<pre><code>=IF(A12=A11,P11&amp;\",\" &amp;O12, O12)\n</code></pre>\n\n<p>See the attached file column P - when it gets to four or more codes there's no space after the comma any longer and the VBA duplicate remover doesn't work.</p>\n\n<p>[Sample of my Worksheet</p>\n\n<p>After I get that formula down I should be able to run this VBA to get rid of the duplicates in the line with the culmination of all the codes... I think...</p>\n\n<pre><code>Function RemoveDupes2(txt As String, Optional delim As String = \" \") As String\nDim x\n'Updateby20140924\nWith CreateObject(\"Scripting.Dictionary\")\n    .CompareMode = vbTextCompare\n    For Each x In Split(txt, delim)\n        If Trim(x) &lt;&gt; \"\" And Not .exists(Trim(x)) Then .Add Trim(x), Nothing\n    Next\n    If .Count &gt; 0 Then RemoveDupes2 = Join(.keys, delim)\nEnd With\nEnd Function\n</code></pre>\n\n<p>I don't know what else to try, there are hundreds of thousands of these that I need to go through</p>\n\n<p>Any help anyone can give me would be amazing and I would be so thankful.  I found the formulas and VBA on this site and modified them to my need, but I think I don't quite understand it enough to modify it correctly. </p>\n\n<pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Number \u2551 First Name \u2551 MI \u2551 Last Name \u2551 Suffix \u2551 Patient DOB \u2551 Sex \u2551 Zip Code \u2551  Home Phone  \u2551 Ident Code 1 \u2551 Ident Code 2 \u2551 Ident Code 3 \u2551 Ident Code 4 \u2551 Service Date \u2551         Row Groups          \u2551                                                          Individual Code Set                                                          \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551      5 \u2551 Jane       \u2551 D  \u2551 Doe       \u2551        \u2551 1/1/1999    \u2551 F   \u2551    44444 \u2551 333-333-3333 \u2551 G10          \u2551 T76          \u2551              \u2551              \u2551 2/5/1995     \u2551 G10, T76                    \u2551 G10, T76                                                                                                                              \u2551\n\u2551      5 \u2551 Jane       \u2551 D  \u2551 Doe       \u2551        \u2551 1/1/1999    \u2551 F   \u2551    44444 \u2551 333-333-3333 \u2551 G10          \u2551 E78.5        \u2551 D70.6        \u2551 Q90.28       \u2551 2/3/2017     \u2551 G10, E78.5, D70.6, Q90.28   \u2551 G10, T76,G10, E78.5, D70.6, Q90.28                                                                                                    \u2551\n\u2551      5 \u2551 Jane       \u2551 D  \u2551 Doe       \u2551        \u2551 1/1/1999    \u2551 F   \u2551    44444 \u2551 333-333-3333 \u2551 B15          \u2551              \u2551              \u2551              \u2551 5/7/2017     \u2551 B15                         \u2551 G10, T76,G10, E78.5, D70.6, Q90.28,B15                                                                                                \u2551\n\u2551      5 \u2551 Jane       \u2551 D  \u2551 Doe       \u2551        \u2551 1/1/1999    \u2551 F   \u2551    44444 \u2551 333-333-3333 \u2551 B15          \u2551              \u2551              \u2551              \u2551 6/5/2015     \u2551 B15                         \u2551 G10, T76,G10, E78.5, D70.6, Q90.28,B15,B15                                                                                            \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 I10          \u2551 K21.0        \u2551 E03.9        \u2551 M77.11       \u2551 5/5/2015     \u2551 I10, K21.0, E03.9, M77.11   \u2551 I10, K21.0, E03.9, M77.11                                                                                                             \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 H44.256      \u2551              \u2551              \u2551              \u2551 3/3/1995     \u2551 H44.256                     \u2551 I10, K21.0, E03.9, M77.11,H44.256                                                                                                     \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 H44.256      \u2551              \u2551              \u2551              \u2551 2/8/1978     \u2551 H44.256                     \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256                                                                                             \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 H44.256      \u2551              \u2551              \u2551              \u2551 3/8/2014     \u2551 H44.256                     \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256                                                                                     \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 M22.58       \u2551              \u2551              \u2551              \u2551 6/1/1956     \u2551 M22.58                      \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58                                                                              \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 Z78.563      \u2551 N35          \u2551 Z12.39       \u2551 J23.5        \u2551 5/4/2016     \u2551 Z78.563, N35, Z12.39, J23.5 \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58,Z78.563, N35, Z12.39, J23.5                                                  \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 E03.9        \u2551 N35          \u2551 R19.7        \u2551 O22.3        \u2551 2/2/1998     \u2551 E03.9, N35, R19.7, O22.3    \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58,Z78.563, N35, Z12.39, J23.5,E03.9, N35, R19.7, O22.3                         \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 H26.9        \u2551 Z01.818      \u2551 B23.356      \u2551              \u2551 3/5/2017     \u2551 H26.9, Z01.818, B23.356     \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58,Z78.563, N35, Z12.39, J23.5,E03.9, N35, R19.7, O22.3,H26.9, Z01.818, B23.356 \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\n\n\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Number \u2551 First Name \u2551 MI \u2551 Last Name \u2551 Suffix \u2551 Patient DOB \u2551 Sex \u2551 Zip Code \u2551  Home Phone  \u2551 Ident Code 1 \u2551 Ident Code 2 \u2551 Ident Code 3 \u2551 Ident Code 4 \u2551 Service Date \u2551         Row Groups          \u2551                                                          Individual Code Set                                                          \u2551                                                               VBA                                                                \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551      5 \u2551 Jane       \u2551 D  \u2551 Doe       \u2551        \u2551 1/1/1999    \u2551 F   \u2551    44444 \u2551 333-333-3333 \u2551 G10          \u2551 T76          \u2551              \u2551              \u2551 2/5/1995     \u2551 G10, T76                    \u2551 G10, T76                                                                                                                              \u2551 G10, T76                                                                                                                         \u2551\n\u2551      5 \u2551 Jane       \u2551 D  \u2551 Doe       \u2551        \u2551 1/1/1999    \u2551 F   \u2551    44444 \u2551 333-333-3333 \u2551 G10          \u2551 E78.5        \u2551 D70.6        \u2551 Q90.28       \u2551 2/3/2017     \u2551 G10, E78.5, D70.6, Q90.28   \u2551 G10, T76,G10, E78.5, D70.6, Q90.28                                                                                                    \u2551 G10, T76,G10, E78.5, D70.6, Q90.28                                                                                               \u2551\n\u2551      5 \u2551 Jane       \u2551 D  \u2551 Doe       \u2551        \u2551 1/1/1999    \u2551 F   \u2551    44444 \u2551 333-333-3333 \u2551 B15          \u2551              \u2551              \u2551              \u2551 5/7/2017     \u2551 B15                         \u2551 G10, T76,G10, E78.5, D70.6, Q90.28,B15                                                                                                \u2551 G10, T76,G10, E78.5, D70.6, Q90.28,B15                                                                                           \u2551\n\u2551      5 \u2551 Jane       \u2551 D  \u2551 Doe       \u2551        \u2551 1/1/1999    \u2551 F   \u2551    44444 \u2551 333-333-3333 \u2551 B15          \u2551              \u2551              \u2551              \u2551 6/5/2015     \u2551 B15                         \u2551 G10, T76,G10, E78.5, D70.6, Q90.28,B15,B15                                                                                            \u2551 G10, T76,G10, E78.5, D70.6, Q90.28,B15,B15                                                                                       \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 I10          \u2551 K21.0        \u2551 E03.9        \u2551 M77.11       \u2551 5/5/2015     \u2551 I10, K21.0, E03.9, M77.11   \u2551 I10, K21.0, E03.9, M77.11                                                                                                             \u2551 I10, K21.0, E03.9, M77.11                                                                                                        \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 H44.256      \u2551              \u2551              \u2551              \u2551 3/3/1995     \u2551 H44.256                     \u2551 I10, K21.0, E03.9, M77.11,H44.256                                                                                                     \u2551 I10, K21.0, E03.9, M77.11,H44.256                                                                                                \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 H44.256      \u2551              \u2551              \u2551              \u2551 2/8/1978     \u2551 H44.256                     \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256                                                                                             \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256                                                                                        \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 H44.256      \u2551              \u2551              \u2551              \u2551 3/8/2014     \u2551 H44.256                     \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256                                                                                     \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256                                                                                \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 M22.58       \u2551              \u2551              \u2551              \u2551 6/1/1956     \u2551 M22.58                      \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58                                                                              \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58                                                                         \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 Z78.563      \u2551 N35          \u2551 Z12.39       \u2551 J23.5        \u2551 5/4/2016     \u2551 Z78.563, N35, Z12.39, J23.5 \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58,Z78.563, N35, Z12.39, J23.5                                                  \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58,Z78.563, N35, Z12.39, J23.5                                             \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 E03.9        \u2551 N35          \u2551 R19.7        \u2551 O22.3        \u2551 2/2/1998     \u2551 E03.9, N35, R19.7, O22.3    \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58,Z78.563, N35, Z12.39, J23.5,E03.9, N35, R19.7, O22.3                         \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58,Z78.563, N35, Z12.39, J23.5,E03.9, R19.7, O22.3                         \u2551\n\u2551      2 \u2551 Bob        \u2551 L  \u2551 Man       \u2551        \u2551 5/5/2007    \u2551 M   \u2551    44444 \u2551 333-333-3333 \u2551 H26.9        \u2551 Z01.818      \u2551 B23.356      \u2551              \u2551 3/5/2017     \u2551 H26.9, Z01.818, B23.356     \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58,Z78.563, N35, Z12.39, J23.5,E03.9, N35, R19.7, O22.3,H26.9, Z01.818, B23.356 \u2551 I10, K21.0, E03.9, M77.11,H44.256,H44.256,H44.256,M22.58,Z78.563, N35, Z12.39, J23.5,E03.9, R19.7, O22.3,H26.9, Z01.818, B23.356 \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490790708, "post_id": 43093496, "comment_id": 73268224, "body": "How have you defined <code>CFin</code>? (as well as your other variables)?  And what are their data types?  Also, although VBA may interpret it correctly, the <code>Row</code> property returns a <code>Long</code>, and you are looking for a <code>String</code>."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1490790878, "post_id": 43093496, "comment_id": 73268329, "body": "You need to post all the code in the sub!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490790916, "post_id": 43093496, "comment_id": 73268350, "body": "I suspect <code>CFin</code> has a zero or empty value at run-time, and therefore the <code>Range(cfin)</code> will raise a 1004 error."}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1490790939, "post_id": 43093496, "comment_id": 73268366, "body": "Cfin is defined as string. Do you think it&#39;s the problem? What I do not understand is that this part works... It&#39;s the first possibility that crashes."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490790964, "post_id": 43093496, "comment_id": 73268380, "body": "What value of <code>cfin</code>?"}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1490791045, "post_id": 43093496, "comment_id": 73268440, "body": "CFin represents the last cell of a range --&gt; i.e. : $A$2"}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1490791047, "post_id": 43093496, "comment_id": 73268443, "body": "Your work-around suggests that your error has to do with the way VBA evaluates logical expressions. In VBA, the entire expression is evaluated even if the answer could be determined early. So, even if Total_Account = &quot;OUI&quot; evaluates to True, the other parts of the expression are still evaluated."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490791098, "post_id": 43093496, "comment_id": 73268487, "body": "I don&#39;t need an &quot;i.e.&quot;, I need a precise value. What value is <code>cfin</code> <i>when the error occurs</i>?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490791106, "post_id": 43093496, "comment_id": 73268496, "body": "What exactly do you mean when you say <code>If Total_account = &quot;OUI&quot;</code> errors?"}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490791168, "post_id": 43093496, "comment_id": 73268535, "body": "@David : Value of Cfin is $C$2"}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490791400, "post_id": 43093496, "comment_id": 73268690, "body": "@SJR : If you take the code I&#39;m having an error with, When Total_Account = &quot;OUI&quot; is TRUE, I get an error. On the other side, if Total_account = &quot;NON&quot; is TRUE And Range(Cfin).Row = &quot;2&quot; is TRUE, I don&#39;t get an error."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490791409, "post_id": 43093496, "comment_id": 73268698, "body": "OK. When you press the <i>Debogage</i> button, can you place the query <code>?Range(cfin).Row</code> in the Immediate pane and attempt to evaluate that part?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490791477, "post_id": 43093496, "comment_id": 73268751, "body": "I think you need to provide more code, as well as example data necessary to run the procedure. From what you describe, there is no possible error in your code, the range is valid, and there is not a short-circuit problem with the boolean expression."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1490791548, "post_id": 43093496, "comment_id": 73268813, "body": "Please can you just post all your code because otherwise we&#39;re all somewhat in the dark?"}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490792224, "post_id": 43093496, "comment_id": 73269341, "body": "I got my problem. Wrong definition of Cfin... -__- @David, I used your code and I get (translated) &quot;Compilation error, incorrect method or inapropriate object&quot;. Actually, posting the code would&#39;ve been hard because I&#39;m Calling different macros. Thanks for your help !"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490792677, "post_id": 43093496, "comment_id": 73269733, "body": "Perhaps your computer does not like shorthand <code>CFin$</code> instead using <code>CFin As String</code> and <code>Total_account As String</code>. In any case, wrong definition of <code>CFin</code> would cause that error for reason I mentioned in my answer. If <code>CFin</code> isn&#39;t a valid range <i>Address</i> or identifier, then the 1004 error is expected."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1490792525, "last_edit_date": 1490792525, "creation_date": 1490791731, "answer_id": 43093997, "question_id": 43093496, "link": "https://stackoverflow.com/questions/43093496/vba-error-1004-runtime/43093997#43093997", "title": "VBA error 1004 - Runtime", "body": "<p>Put this code in a standard module in a new workbook. I guarantee it cannot cause an error, no matter what value you have for <code>Total_account</code>.</p>\n\n<pre><code>Sub foo()\nDim Total_account as String\nDim CFin as String\nCFin = \"$C$2\"\nTotal_account = \"OUI\"\n\nIf Total_account = \"OUI\" Or (Total_account = \"NON\" And Range(CFin).Row = \"2\") Then GoTo fin\n\nfin:\nEnd Sub\n</code></pre>\n\n<p>This suggest a problem elsewhere in your code. Judging from the 1004 message, if the error raises on your boolean expression, this can only be because <code>CFin</code> is unassigned (empty string, empty/zero numeric value).</p>\n\n<p>If <code>CFin</code> has a zero or empty value at run-time, therefore the <code>Range(cfin)</code> will raise a 1004 error, since <code>Range(\"\").Row</code> is not valid.</p>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 2625176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NdFdz.jpg?s=128&g=1", "display_name": "KannanRG", "link": "https://stackoverflow.com/users/2625176/kannanrg"}, "is_accepted": false, "score": 0, "last_activity_date": 1490792216, "creation_date": 1490792216, "answer_id": 43094201, "question_id": 43093496, "link": "https://stackoverflow.com/questions/43093496/vba-error-1004-runtime/43094201#43094201", "title": "VBA error 1004 - Runtime", "body": "<p>Its always good to put workSheet.Range(Cfin).Row instead of Range(Cfin).Row as Perhaps your code is behind Sheet1, so when you change the focus to Sheet2 the objects cannot be found issue will happen.</p>\n\n<p>Please try below code.</p>\n\n<pre><code>Sub your_sub\n\nDim workSheet As Worksheet\nSet workSheet = ActiveWorkbook.Sheets(\"Sheet1\") 'guessing your looking at Sheet1\n\nDim Cfin As String\nCfin = \"$C$2\"\n\n\nIf Total_account = \"OUI\" Or (Total_account = \"NON\" And workSheet.(Cfin).Row = \"2\") Then GoTo fin\n\nMsgBox \"no\" 'your code\n\nfin:\n\nMsgBox \"yes\" ' your code\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490792525, "creation_date": 1490790406, "question_id": 43093496, "link": "https://stackoverflow.com/questions/43093496/vba-error-1004-runtime", "title": "VBA error 1004 - Runtime", "body": "<p>I'm having a little 'error 1004' with my project and I can't find a way to correct it \"properly\".</p>\n\n<p>I get an error when I use this code :</p>\n\n<pre><code>If Total_account = \"OUI\" Or (Total_account = \"NON\" And Range(Cfin).Row = \"2\") Then GoTo fin\n</code></pre>\n\n<p>I am getting the error when the first condition is met:</p>\n\n<pre><code>If Total_account = \"OUI\"\n</code></pre>\n\n<p>When I have Total_account = \"NON\" and Range(Cfin).Row = 2, no error.</p>\n\n<p>The only way to fix I found was to do it like that, but it does not look good :</p>\n\n<pre><code>If Total_account = \"OUI\" Then GoTo fin\nIf (Total_account = \"NON\" And Range(Cfin).Row = \"2\") Then GoTo fin\n</code></pre>\n\n<p>I also read the Microsoft support for this error but I don't get it : <a href=\"https://support.microsoft.com/fr-fr/help/963259/runtime-error-1004-method-range-of-object-global-failed\" rel=\"nofollow noreferrer\">https://support.microsoft.com/fr-fr/help/963259/runtime-error-1004-method-range-of-object-global-failed</a></p>\n\n<p>Could you help me understand/ find a way to correct this?\nThe error screenshot is attached to my post.</p>\n\n<p>Thanks in advance !</p>\n\n<p>Jean</p>\n\n<p><a href=\"https://i.stack.imgur.com/TduH9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TduH9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 0, "creation_date": 1490790642, "post_id": 43093465, "comment_id": 73268170, "body": "does each created <code>tab</code> get a number on cell <code>E13</code> and what is that number? a random number?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490791267, "post_id": 43093465, "comment_id": 73268610, "body": "Why not use the <code>i</code> and multiply it with the value in <code>Worksheets(&quot;Batch 1&quot;).</code> (which is copied anyway), try inputting to cell &quot;A3&quot; in with:  <code>Sheet1.Range(&quot;A3&quot;).Value = i * Worksheets(&quot;Batch 1&quot;).Range(&quot;E13&quot;).Value</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490795409, "post_id": 43093465, "comment_id": 73272076, "body": "@ShaiRado Because I guess the E13 within the sheets Batch 1 to x will be different from Batch 1 after some time when data has changed/was filled into the Batch sheets."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7785727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73271dab5185ece330ec6be17eba5d8?s=128&d=identicon&r=PG&f=1", "display_name": "djmurray363", "link": "https://stackoverflow.com/users/7785727/djmurray363"}, "edited": false, "score": 0, "creation_date": 1490795217, "post_id": 43094328, "comment_id": 73271929, "body": "Works like a charm!  Thanks for the help."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1490792544, "creation_date": 1490792544, "answer_id": 43094328, "question_id": 43093465, "link": "https://stackoverflow.com/questions/43093465/create-x-number-of-new-tabs-then-in-main-tab-sum-all-e13s-from-sheet1sheetx/43094328#43094328", "title": "Create &quot;x&quot; number of new tabs. Then in main tab, sum all E13s from sheet1:sheetX", "body": "<p>You will need to create the <code>SUM</code> formula with VBA within the loop.</p>\n\n<pre><code>Sub Create()\n    Dim i As Integer, SumFormula As String\n    For i = 1 To Sheet1.Range(\"A15\").Value\n        Sheets(\"Resource Estimator\").Copy After:=Sheets(Sheets.Count)\n        ActiveSheet.Name = \"Batch \" &amp; i\n\n        If i = 1 Then\n            SumFormula = \"=SUM('\" &amp; ActiveSheet.Name &amp; \"'!E13\" 'begin sum formula\n        Else\n            SumFormula = SumFormula &amp; \",'\" &amp; ActiveSheet.Name &amp; \"'!E13\" 'iterate sum formula\n        End If\n    Next i\n\n    SumFormula = SumFormula &amp; \")\" 'end sum formula\n    Sheet1.Range(\"A16\").Formula = SumFormula 'write sum formula to cell A16\nEnd Sub\n</code></pre>\n\n<p>Here in the first iteration (<code>i = 1</code>) of the <code>for</code> loop the creation of the sum formula begins with <code>=SUM('Batch 1'!E13</code> for all other sheets the sum formula is extended by <code>,'Batch i'!E13</code> where <code>i</code> is the sheet number. And in the end the formula is ended with a bracket <code>)</code> and written into range <code>A16</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 7785727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e73271dab5185ece330ec6be17eba5d8?s=128&d=identicon&r=PG&f=1", "display_name": "djmurray363", "link": "https://stackoverflow.com/users/7785727/djmurray363"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 43094328, "answer_count": 1, "score": 0, "last_activity_date": 1490792544, "creation_date": 1490790339, "last_edit_date": 1531164843, "question_id": 43093465, "link": "https://stackoverflow.com/questions/43093465/create-x-number-of-new-tabs-then-in-main-tab-sum-all-e13s-from-sheet1sheetx", "title": "Create &quot;x&quot; number of new tabs. Then in main tab, sum all E13s from sheet1:sheetX", "body": "<p>We need a macro that will create \"X\" number of tabs that will be titled \"batch 1\" to \"batch \"X\"\".  An integer is entered in cell \"A15\" that will say how many tabs will be made.  Then in a cell in the first tab we need to take the sum of all of the E13 cells created from the number inputted in \"A15.\"  The code below creates \"X\" number of tabs but we're stuck on how to add the E13 values together.  <code>=SUM(\"Batch 1\":\"Batch X\"!E13)</code> is my best guess but I am trying to figure out how to define a variable \"X\" to be equal to the integer in cell \"A15.\"  Thanks in advance!</p>\n\n<pre><code>Dim i As Integer\nFor i = 1 To Sheet1.Range(\"A15\").Value\n    Sheets(\"Resource Estimator\").Copy After:=Sheets(Sheets.Count)\n    ActiveSheet.Name = \"Batch\" &amp; \" \" &amp; i\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490790096, "post_id": 43093353, "comment_id": 73267770, "body": "Yes, you have a <b>Typo</b> , change <code>If Cells.ColorIndex = 3 Then</code> to <code>If cell.ColorIndex = 3 Then</code> , that&#39;s why you need to think of good variable names, not to make confusions like this."}, {"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490790712, "post_id": 43093353, "comment_id": 73268230, "body": "unfortunately this still displays runtime error 438"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1490791863, "creation_date": 1490791863, "answer_id": 43094050, "question_id": 43093353, "link": "https://stackoverflow.com/questions/43093353/loop-through-cols-rows-with-if-statement-vba/43094050#43094050", "title": "Loop through Cols &amp; Rows with IF statement vba", "body": "<p><code>cell.ColorIndex</code> is not a valid <code>Range</code> property.</p>\n\n<p>If you mean to check the font's color then use <code>If cell.Font.ColorIndex = 3 Then</code></p>\n\n<p>If you mean to check the Fill color, then use <code>If cell.Interior.ColorIndex = 3 Then</code></p>\n\n<p>When you type in the editor, <code>Cell.</code> the VBA autocompletes it with the following options:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FVMyO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FVMyO.png\" alt=\"enter image description here\"></a></p>\n\n<p>There's no <code>cell.ColorIndex</code> in the list:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7FiZ1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7FiZ1.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 43094050, "answer_count": 1, "score": 0, "last_activity_date": 1490791930, "creation_date": 1490790010, "last_edit_date": 1531164843, "question_id": 43093353, "link": "https://stackoverflow.com/questions/43093353/loop-through-cols-rows-with-if-statement-vba", "title": "Loop through Cols &amp; Rows with IF statement vba", "body": "<p>All, </p>\n\n<p>I have written the below code to check if cells in the variable range have conditional formatting. However the code falls over at  \"If Cells.ColorIndex = 3 Then\" can anyone suggest why the error is occurring and if there is a better solution than the below code to achieve a loop through cols &amp; rows (variable length)</p>\n\n<pre><code>Sub Check_Conditional()\n\nDim rng As Range\nDim row As Range\nDim cell As Range\n\nDim RW As Long\nRW = ActiveSheet.Range(\"Total\").Offset(rowOffset:=-1).row\nSet rng = Range(\"O7:AB\" &amp; RW)\n\nFor Each row In rng.Rows\n    For Each cell In row.Cells\n        If Cells.ColorIndex = 3 Then\n            MsgBox \"Not all the cells have been filled out\"\n            Exit For\n        End If\n    Next cell\nNext row\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490795030, "post_id": 43092978, "comment_id": 73271760, "body": "Where are the instructions saved?"}, {"owner": {"reputation": 1, "user_id": 6903675, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157520826800710/picture?type=large", "display_name": "Matthew Risidor", "link": "https://stackoverflow.com/users/6903675/matthew-risidor"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490799806, "post_id": 43092978, "comment_id": 73275942, "body": "The instruction is in the cell.  The user reads the instruction, deletes it. then types the answer in the same cell.  When they save and clear I want to put the instruction back in the cell before it saves, for the next user"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490802727, "post_id": 43092978, "comment_id": 73278212, "body": "You should recopy them from some safe place, i.e. some hidden worksheet."}, {"owner": {"reputation": 1, "user_id": 6903675, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157520826800710/picture?type=large", "display_name": "Matthew Risidor", "link": "https://stackoverflow.com/users/6903675/matthew-risidor"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490853699, "post_id": 43092978, "comment_id": 73299615, "body": "What would the code be for this? I&#39;m an amateur when it comes to code.  I have had help with the code above.  Could you insert the line of code into my example above?"}], "owner": {"reputation": 1, "user_id": 6903675, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157520826800710/picture?type=large", "display_name": "Matthew Risidor", "link": "https://stackoverflow.com/users/6903675/matthew-risidor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490789746, "creation_date": 1490788944, "last_edit_date": 1531164843, "question_id": 43092978, "link": "https://stackoverflow.com/questions/43092978/can-a-macro-insert-instruction-after-clearing-cell-data", "title": "Can a macro insert instruction after clearing cell data?", "body": "<p>I have a worksheet that contains several cells that instruct the user what to write in each cell.  In order to do this, the user deletes the instruction after reading it and inputs data.  They then hit a macro button which saves and clears data.  My problem is I want the instruction to be there for the next user and not a blank cell.</p>\n\n<p>Here's what I have:</p>\n\n<pre><code>Sub NEXTINVOICE()\n    Range(\"C7\").value = Range(\"C7\").value + 1\n    Range(\"A13:A13, A16:C42, C9:D9\").ClearContents\n    Sheets(\"PROCESS SHEET\").Range(\"B7:C9, A15:G67, B71:B75, G84:G204\").ClearContents\n    Sheets(\"PROCESS SHEET (2)\").Range(\"B7:C9, A15:G67, B71:B75, G84:G204\").ClearContents\n    Sheets(\"PROCESS SHEET (3)\").Range(\"B7:C9, A15:G67, B71:B75, G84:G204\").ClearContents\n    Sheets(\"PROCESS SHEET (4)\").Range(\"B7:C9, A15:G67, B71:B75, G84:G204\").ClearContents\n    Sheets(\"PROCESS SHEET (5)\").Range(\"B7:C9, A15:G67, B71:B75, G84:G204\").ClearContents\n    Sheets(\"DOOR &amp; LINER PRICES\").Range(\"B18:B105, B123:B211, B228:B243, B247:B251, B256:B264\").ClearContents\n    Sheets(\"TIMBER CALCULATOR\").Range(\"A5:A5, A8:A8, A12:B12, A16:B16, A23:B23, E12:E12, E16:E16, E23:E23\").ClearContents\nEnd Sub\n\nSub SaveInvWithNewName()\n    Dim NewFN As Variant\n    ActiveWorkbook.Sheets.Copy\n    NewFN = \"\\\\NASDE8FB1\\MCM Cloud\\Estimating\\Quote Numbers\\QUOTE_MR_\" &amp; ThisWorkbook.Sheets(\"QUOTE SHEET\").Range(\"C7\").value &amp; \".xlsx\"\n    ActiveWorkbook.SaveAs NewFN, FileFormat:=xlOpenXMLWorkbook\n    ActiveWorkbook.Close\n    NEXTINVOICE\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490793299, "post_id": 43093522, "comment_id": 73270271, "body": "Thanks @Shai - didn&#39;t even notice that I was still using <code>shp</code> within the <code>With..End With</code> block."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1490792390, "last_edit_date": 1490792390, "creation_date": 1490790471, "answer_id": 43093522, "question_id": 43092910, "link": "https://stackoverflow.com/questions/43092910/vba-fit-all-shapes-in-a-column-to-the-corresponding-cell/43093522#43093522", "title": "VBA fit all shapes in a column to the corresponding cell?", "body": "<p>You're nearly there.<br>\nYou're just missing telling it what shape in the shapes collection you're working with and telling it to go through each shape on the sheet. </p>\n\n<p>This code will use a <code>For Each....Next</code> to cycle through the shapes collection and reference each shape using the <code>shp</code> variable. </p>\n\n<pre><code>Sub FitImageToCell()\n\n    Dim shp As Shape\n\n    For Each shp In Sheet1.Shapes\n        With shp\n            .Left = .TopLeftCell.Left\n            .Top = .TopLeftCell.Top\n            .Height = .TopLeftCell.Height\n            .Width = .TopLeftCell.Width\n        End With\n    Next shp\n\nEnd Sub\n</code></pre>\n\n<p>If you want to move just one shape then you can use:  </p>\n\n<pre><code>Sub FitImageToCell1()\n\n    With Sheet1.Shapes(\"Rectangle 1\")\n        .Left = .TopLeftCell.Left\n        .Top = .TopLeftCell.Top\n        .Height = .TopLeftCell.Height\n        .Width = .TopLeftCell.Width\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Finally, if you want to move specific types of shape you can use:  </p>\n\n<pre><code>Sub FitImageToCell()\n\n    Dim shp As Shape\n\n    For Each shp In Sheet1.Shapes\n        With shp\n            If .Type = msoAutoShape Then\n                If .AutoShapeType = msoShapeRectangle Then\n                    .Left = .TopLeftCell.Left\n                    .Top = .TopLeftCell.Top\n                    .Height = .TopLeftCell.Height\n                    .Width = .TopLeftCell.Width\n                End If\n            End If\n        End With\n    Next shp\n\nEnd Sub\n</code></pre>\n\n<p>There's a list of shape types here:  <a href=\"https://msdn.microsoft.com/en-us/library/aa432678(v=office.12).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/aa432678(v=office.12).aspx</a>  </p>\n\n<p>And a list of autoshape types here:  <a href=\"https://msdn.microsoft.com/en-us/library/aa432469(v=office.12).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/aa432469(v=office.12).aspx</a></p>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 43093522, "answer_count": 1, "score": 0, "last_activity_date": 1490792390, "creation_date": 1490788734, "question_id": 43092910, "link": "https://stackoverflow.com/questions/43092910/vba-fit-all-shapes-in-a-column-to-the-corresponding-cell", "title": "VBA fit all shapes in a column to the corresponding cell?", "body": "<p>I have a workbook like so:</p>\n\n<pre><code>     Column L\n\nL5 = Image\nL6 = Image\nL7 = Image\nL8 = Image\n</code></pre>\n\n<p>Column L has images copied and pasted into each cell. The images are all looking a bit mismatched if i'm honest.</p>\n\n<p>I'd like to fit each image to the cell exactly. Is there a way of doing this for all images in the column without having to define the name of each image?</p>\n\n<p>Here's what i've tried:</p>\n\n<pre><code>Sub FitImageToCell()\n    With Sheet1.Shapes\n        .Left = .TopLeftCell.Left\n        .Top = .TopLeftCell.Top\n        .Height = .TopLeftCell.Height\n        .Width = .TopLeftCell.Width\n    End With\nEnd Sub\n</code></pre>\n\n<p>But i get a object doesn't support this property or method error.</p>\n\n<p>Please can someone show me how to do this?</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490789610, "post_id": 43092315, "comment_id": 73267424, "body": "If you don&#39;t want to use VBA and a simple <code>Hyperlink()</code> function call in a separate helper-column would be fine then you can also go with a solution similar to this one: <a href=\"http://stackoverflow.com/questions/42977982/automatically-link-to-a-cell-in-another-sheet-if-value-is-the-same/42984060#42984060#\" title=\"automatically link to a cell in another sheet if value is the same\">stackoverflow.com/questions/42977982/&hellip;</a>"}, {"owner": {"reputation": 1727, "user_id": 546439, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0291fbbcbedcf6032465d6793596eacc?s=128&d=identicon&r=PG", "display_name": "Dv_MH", "link": "https://stackoverflow.com/users/546439/dv-mh"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490822132, "post_id": 43092315, "comment_id": 73290168, "body": "Thanks Ralph but I wanted the Hyperlink to be on the same cell"}], "answers": [{"comments": [{"owner": {"reputation": 1727, "user_id": 546439, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0291fbbcbedcf6032465d6793596eacc?s=128&d=identicon&r=PG", "display_name": "Dv_MH", "link": "https://stackoverflow.com/users/546439/dv-mh"}, "edited": false, "score": 0, "creation_date": 1490822171, "post_id": 43092707, "comment_id": 73290189, "body": "Simplest and neat solution"}, {"owner": {"reputation": 1727, "user_id": 546439, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0291fbbcbedcf6032465d6793596eacc?s=128&d=identicon&r=PG", "display_name": "Dv_MH", "link": "https://stackoverflow.com/users/546439/dv-mh"}, "edited": false, "score": 0, "creation_date": 1490823615, "post_id": 43092707, "comment_id": 73290870, "body": "use Target.ClearHyperlinks instead of Target.Hyperlinks.Delete"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1727, "user_id": 546439, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0291fbbcbedcf6032465d6793596eacc?s=128&d=identicon&r=PG", "display_name": "Dv_MH", "link": "https://stackoverflow.com/users/546439/dv-mh"}, "edited": false, "score": 1, "creation_date": 1490825122, "post_id": 43092707, "comment_id": 73291450, "body": "@Dv_MH good suggestion, ClearHyperlinks conserves the formatting."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1490825193, "last_edit_date": 1490825193, "creation_date": 1490788280, "answer_id": 43092707, "question_id": 43092315, "link": "https://stackoverflow.com/questions/43092315/excel-vba-how-to-autocreate-hyperlink-from-cell-value/43092707#43092707", "title": "Excel VBA: How to autocreate hyperlink from cell value?", "body": "<p>Add this event handler to your worksheet's code module:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column &lt;&gt; 2 Then Exit Sub\n    Target.Hyperlinks.Delete ' or Target.ClearHyperlinks to conserve the formatting\n    Me.Hyperlinks.Add Target, \"http://example.com/id=\" &amp; Target.value\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1756, "user_id": 1008588, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ijUnZ.jpg?s=128&g=1", "display_name": "Nicolaesse", "link": "https://stackoverflow.com/users/1008588/nicolaesse"}, "is_accepted": false, "score": 0, "last_activity_date": 1490788499, "creation_date": 1490788499, "answer_id": 43092806, "question_id": 43092315, "link": "https://stackoverflow.com/questions/43092315/excel-vba-how-to-autocreate-hyperlink-from-cell-value/43092806#43092806", "title": "Excel VBA: How to autocreate hyperlink from cell value?", "body": "<pre><code>=HYPERLINK(E14&amp;F14,\"Name\")\n</code></pre>\n\n<p>where cell E14 contains \"<a href=\"http://www.example.com/id=\" rel=\"nofollow noreferrer\">http://www.example.com/id=</a>\" and cell F14 contains \"76537434\".\nThis soultions doesn't need VBA macros.</p>\n"}, {"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 2, "last_activity_date": 1490788555, "creation_date": 1490788555, "answer_id": 43092828, "question_id": 43092315, "link": "https://stackoverflow.com/questions/43092315/excel-vba-how-to-autocreate-hyperlink-from-cell-value/43092828#43092828", "title": "Excel VBA: How to autocreate hyperlink from cell value?", "body": "<p>The following <code>Worksheet_Change</code> event should be able to solve your problem:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nDim cell As Range\nDim tmp As String\nIf Intersect(Range(\"B:B\"), Target) Is Nothing Then Exit Sub\n\nFor Each cell In Target\n    If cell.Column = 2 Then\n        Application.EnableEvents = False\n        tmp = cell.Value2\n        cell.Parent.Hyperlinks.Add _\n            Anchor:=Cells(cell.Row, 2), _\n            Address:=\"http://example.com/id=\" &amp; tmp, _\n            TextToDisplay:=tmp\n        Application.EnableEvents = True\n    End If\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>Note, that you must copy it to the sheet and <strong>not</strong> into a separate module.</p>\n"}], "owner": {"reputation": 1727, "user_id": 546439, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0291fbbcbedcf6032465d6793596eacc?s=128&d=identicon&r=PG", "display_name": "Dv_MH", "link": "https://stackoverflow.com/users/546439/dv-mh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3251, "favorite_count": 0, "accepted_answer_id": 43092707, "answer_count": 3, "score": 3, "last_activity_date": 1490825193, "creation_date": 1490787203, "question_id": 43092315, "link": "https://stackoverflow.com/questions/43092315/excel-vba-how-to-autocreate-hyperlink-from-cell-value", "title": "Excel VBA: How to autocreate hyperlink from cell value?", "body": "<p>I have a table called Table1</p>\n\n<p>In Column B, I have the ticket number. e.g: 76537434</p>\n\n<p>Requirement: when any change happens in any cell in column B, that cell (Target cell) to be changed into a hyperlink such that the hyperlink address would be example.com/id=76537434</p>\n\n<p>Cell value i.e. 76537434 must remain the same</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 7533979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98522f0d4a1596fd621996f52659f04f?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius B", "link": "https://stackoverflow.com/users/7533979/vinicius-b"}, "is_accepted": true, "score": 2, "last_activity_date": 1490787568, "creation_date": 1490787568, "answer_id": 43092434, "question_id": 43092209, "link": "https://stackoverflow.com/questions/43092209/scrolling-while-message-box-is-running/43092434#43092434", "title": "Scrolling while message box is running", "body": "<p>There is not a application.MessageBox function just the MsgBox, but you can create a form that looks like a MsgBox and set the ShowModal property to False</p>\n"}, {"tags": [], "owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "is_accepted": false, "score": 0, "last_activity_date": 1490790302, "last_edit_date": 1490790302, "creation_date": 1490788787, "answer_id": 43092933, "question_id": 43092209, "link": "https://stackoverflow.com/questions/43092209/scrolling-while-message-box-is-running/43092933#43092933", "title": "Scrolling while message box is running", "body": "<p>There's API alternative! Declare in a top of module this function:</p>\n\n<pre><code>#If VBA7 Then\n    Public Declare PtrSafe Function ModelessMsgBox Lib \"User32\" Alias \"MessageBoxA\" (Optional ByVal hWnd As Long, _\n            Optional ByVal prompt As String, _\n            Optional ByVal title As String, _\n            Optional ByVal buttons As Long) As Long\n#Else\n    Public Declare Function ModelessMsgBox Lib \"User32\" Alias \"MessageBoxA\" (Optional ByVal hWnd As Long, _\n            Optional ByVal prompt As String, _\n            Optional ByVal title As String, _\n            Optional ByVal buttons As Long) As Long\n#End If\n</code></pre>\n\n<p>And use it like this:</p>\n\n<pre><code>Call ModelessMsgBox(prompt:=\"MsgBox!!!!\", buttons:=vbYesNo)\n</code></pre>\n\n<p>However, this MsgBox stops code execution (when modeless forms doesn't, dooming you to use another garbage set of global/static variables and/or to supress events just to control execution flow), so it can be used like this:</p>\n\n<pre><code>If ModelessMsgBox(prompt:=\"MsgBox!!!!\", buttons:=vbYesNo) = vbYes Then\n    'do smth\nElse\n    'do smth else\nEnd If\n</code></pre>\n\n<p>More <a href=\"http://allapi.mentalis.org/apilist/MessageBox.shtml\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1006, "favorite_count": 0, "accepted_answer_id": 43092434, "answer_count": 2, "score": 0, "last_activity_date": 1490790302, "creation_date": 1490786827, "last_edit_date": 1531161705, "question_id": 43092209, "link": "https://stackoverflow.com/questions/43092209/scrolling-while-message-box-is-running", "title": "Scrolling while message box is running", "body": "<p>I have the following macro to show a message box to the user:</p>\n\n<pre><code>Sub Messageboxtest()\nTest = MsgBox(\"Do you want to continue\", vbYesNo)\nIf Answer = vbYes Then\nSheets(1).Range(\"A2\").Value = 1\nElse\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The macro itself works perfectly. However, once the message box is shown on the excel screen the user cannot scroll down in the Excel File anymore.</p>\n\n<p>For an input box I know there is the function <code>Application.InputBox</code> but is there also something like <code>Application.MessageBox</code>?</p>\n"}, {"tags": ["vba", "excel", "worksheet"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1490788854, "post_id": 43092040, "comment_id": 73266884, "body": "Why do you copy-paste twice?"}], "answers": [{"comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 1, "creation_date": 1490788820, "post_id": 43092309, "comment_id": 73266859, "body": "Is there a reason why you left one hard-coded &quot;Cycle&quot;? <code>C.EntireColumn.Copy Destination:=Sheets(&quot;Cycle&quot;).Columns(col)</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1490788880, "post_id": 43092309, "comment_id": 73266894, "body": "@Jean-Fran&#231;oisCorbett just forgot to modify it , thanks :) , actualy not sure it&#39;s needed, cause he is doing <code>PasteSpecial</code> again later, waiting for PO feedback"}, {"owner": {"reputation": 5, "user_id": 7629741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c485af564b2b4a663b4220f3e4a7989?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/7629741/dave"}, "edited": false, "score": 0, "creation_date": 1490792856, "post_id": 43092309, "comment_id": 73269879, "body": "Hi Both thanks for the response. The copy-paste twice was left over from code which I forgot to tidy up. The code works except the location where it pastes the column within the new worksheet is in random column rather than from A1 onwards,"}, {"owner": {"reputation": 5, "user_id": 7629741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c485af564b2b4a663b4220f3e4a7989?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/7629741/dave"}, "edited": false, "score": 0, "creation_date": 1490802389, "post_id": 43092309, "comment_id": 73277984, "body": "@ShaiRado Perfect thank you very much Shai you are very helpful. Helps me learn new methods as well. Much appreciated."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1490796563, "last_edit_date": 1490796563, "creation_date": 1490787184, "answer_id": 43092309, "question_id": 43092040, "link": "https://stackoverflow.com/questions/43092040/loop-code-with-different-worksheet-names/43092309#43092309", "title": "Loop code with different worksheet names", "body": "<p>Try the code below, let me know if that's what you meant:</p>\n\n<pre><code>Option Explicit\n\nSub Cycle()\n\nDim C               As Range\nDim StringsArr      As Variant\nDim col As Long, lastCol As Long\n\nStringsArr = Array(\"cycle\", \"run\", \"walk\", \"jog\")\n\nWith Worksheets(\"fast\")\n    lastCol = .Cells(2, .Columns.Count).End(xlToLeft).Column\n    For Each C In .Range(.Cells(2, 1), .Cells(2, lastCol))\n        ' check per cell if value is one of the values in StringsArr array\n        If Not IsError(Application.Match(C.value, StringsArr, 0)) Then\n            col = Sheets(C.value).Cells(2, Sheets(C.value).Columns.Count).End(xlToLeft).Column + 1 ' find first empty column in relevant sheet\n            C.EntireColumn.Copy\n            Sheets(C.value).Columns(col).PasteSpecial xlPasteValues\n        End If\n    Next C\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7629741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c485af564b2b4a663b4220f3e4a7989?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/7629741/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 43092309, "answer_count": 1, "score": 0, "last_activity_date": 1490796563, "creation_date": 1490786336, "last_edit_date": 1490786579, "question_id": 43092040, "link": "https://stackoverflow.com/questions/43092040/loop-code-with-different-worksheet-names", "title": "Loop code with different worksheet names", "body": "<p>I am running below code. The worksheet named \"fast\" contains names such as cycle, run, walk, jog, etc. The code currently searches for the word \"cycle\" in a particular row and if found it copies the whole column and pastes it in a worksheet called \"cycle\". At the moment I am just repeating the script and changing \"Cycle\" for names like \"run\" \"walk\" etc. Is there I can make this shorter and more efficient by not simply just repeating the same script over and over. </p>\n\n<pre><code>Sub Cycle()\n\nDim C As Range\nDim col As Long, lastCol As Long\n\nWith Worksheets(\"fast\")\n    lastCol = .Cells(2, .Columns.Count).End(xlToLeft).Column\n    col = 1\n    For Each C In .Range(.Cells(2, 1), .Cells(2, lastCol))\n        If C.value = \"Cycle\" Then\n            C.EntireColumn.Copy Destination:=Sheets(\"Cycle\").Columns(col)\n            C.EntireColumn.Copy\n            Sheets(\"Cycle\").Columns(col).PasteSpecial xlPasteValues\n            col = col + 1\n        End If\n    Next C\nEnd With\nWorksheets(\"Cycle\").Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2013"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1490786558, "post_id": 43091727, "comment_id": 73265305, "body": "The decimal separator is determined by your Windows settings. There is no simple way to alter that in your report."}, {"owner": {"reputation": 35, "user_id": 7639379, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/0063649fd423b8f47af7ca0f3a556956?s=128&d=identicon&r=PG&f=1", "display_name": "Mitra", "link": "https://stackoverflow.com/users/7639379/mitra"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1490786807, "post_id": 43091727, "comment_id": 73265470, "body": "in Excel we can change dot to comma . if I open option there is possibilty to change it. but in access i couldnt find anything."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1490786883, "post_id": 43091727, "comment_id": 73265535, "body": "Is it the decimal or the thousand separator?"}, {"owner": {"reputation": 35, "user_id": 7639379, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/0063649fd423b8f47af7ca0f3a556956?s=128&d=identicon&r=PG&f=1", "display_name": "Mitra", "link": "https://stackoverflow.com/users/7639379/mitra"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1490787628, "post_id": 43091727, "comment_id": 73266043, "body": "thousand seperator"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1490787309, "creation_date": 1490787309, "answer_id": 43092349, "question_id": 43091727, "link": "https://stackoverflow.com/questions/43091727/currency-with-comma-as-a-seperator-not-dot-in-access/43092349#43092349", "title": "currency with comma as a seperator not dot in access", "body": "<p>If you environment doesn't change too much, you may get away with:</p>\n\n<pre><code>Amount = 4300\nCommaSeparatedAmount = Replace(Format(Amount, \"#,##0\"), \".\", \",\")\n\n' Returns 4,300\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7639379, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/0063649fd423b8f47af7ca0f3a556956?s=128&d=identicon&r=PG&f=1", "display_name": "Mitra", "link": "https://stackoverflow.com/users/7639379/mitra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1188, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490787309, "creation_date": 1490785425, "last_edit_date": 1490786488, "question_id": 43091727, "link": "https://stackoverflow.com/questions/43091727/currency-with-comma-as-a-seperator-not-dot-in-access", "title": "currency with comma as a seperator not dot in access", "body": "<p>I am designing dataentry form and I am preparing tables. later I want to get report according to my data.\nin the table one field is for amount of fee , it should be at most 8 digits. without decimal . (this amount can be in 3 currency EUR, USD, pound so I have another field with combo box for it) </p>\n\n<p>what I did is, I chose currency as a data type and I chose standard as a format ( I dont want to see any $ or eruo sign as I said I have another field to define it thats why I chose standard) and changed decimal to 0 ( I dont have any decimal) and limited input mask to 9999999.\nI want to have , (comma) as a seperator not (.)dot . how should I change dot to comma ?\nI want to see 4,300 not 4.300 </p>\n\n<p>Go to the top of the pageReport Post </p>\n"}, {"tags": ["vba", "excel", "excel-addins"], "comments": [{"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 1, "creation_date": 1490789524, "post_id": 43091514, "comment_id": 73267353, "body": "Though I know is painful and I speak from experience, have you try VSTO and Click once? and signing your code?"}, {"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "reply_to_user": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 0, "creation_date": 1490857035, "post_id": 43091514, "comment_id": 73301384, "body": "I have not. I think VSTO will be much slower compared to the lightweight VBA."}, {"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 0, "creation_date": 1490877554, "post_id": 43091514, "comment_id": 73315307, "body": "I beg the differ, but I do understand where you coming from. Microsoft has been pushing VSTO for while now and they encourage this type of work to be done in .Net."}, {"owner": {"reputation": 3844, "user_id": 165034, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e4cd88ee8e08972785d3b6711735aae4?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/165034/josh"}, "edited": false, "score": 0, "creation_date": 1490968029, "post_id": 43091514, "comment_id": 73361780, "body": "What version of Office is it? I&#39;ve written a few add-ins with pure VBA code, and password protected the source, and haven&#39;t seen this error before."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1490969865, "post_id": 43091514, "comment_id": 73363078, "body": "Are you getting the error on all machines, including the one you developed it on? Is it possibly 32bit/64bit differences?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1491004691, "post_id": 43091514, "comment_id": 73379395, "body": "Have you tried adding the Network Location as a Trusted Location in the Trust Center?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1491027870, "post_id": 43091514, "comment_id": 73383474, "body": "What you need it better Error handling on your code"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1491064707, "post_id": 43091514, "comment_id": 73393757, "body": "Does the code compile whilst unlocked?"}, {"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "reply_to_user": {"reputation": 3844, "user_id": 165034, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e4cd88ee8e08972785d3b6711735aae4?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/165034/josh"}, "edited": false, "score": 0, "creation_date": 1491202872, "post_id": 43091514, "comment_id": 73429896, "body": "@Josh i am using Office 13, but some users have different versions, but it still works very well."}, {"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1491202984, "post_id": 43091514, "comment_id": 73429946, "body": "@CLR I do not get an error on the machine i developed on. I will look into the 32-64 bit difference, but i suspect it is not the reason because it works perfectly without the password"}, {"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1491203056, "post_id": 43091514, "comment_id": 73429973, "body": "@EEM i have not tried, given that it works perfectly without password, and the addin is still loaded normally loaded on open"}, {"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1491203119, "post_id": 43091514, "comment_id": 73429999, "body": "@0m3r there is no error raised without password, this is not about error handling"}, {"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1491203158, "post_id": 43091514, "comment_id": 73430016, "body": "@SMeaden Yes it compiles whilst unlocked"}, {"owner": {"reputation": 216, "user_id": 7034705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U1yFv.jpg?s=128&g=1", "display_name": "ArindamD", "link": "https://stackoverflow.com/users/7034705/arindamd"}, "edited": false, "score": 0, "creation_date": 1491205420, "post_id": 43091514, "comment_id": 73431180, "body": "Are you password protecting only the code? Are workbook/ worksheet are also protected? Since we don&#39;t know the function of the add-in, it appears your password is preventing the code to do its usual operation. What happens if you dont put it in t he network?"}, {"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "reply_to_user": {"reputation": 216, "user_id": 7034705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U1yFv.jpg?s=128&g=1", "display_name": "ArindamD", "link": "https://stackoverflow.com/users/7034705/arindamd"}, "edited": false, "score": 0, "creation_date": 1491209003, "post_id": 43091514, "comment_id": 73433094, "body": "@ArindamD Yes only the code is password protected. AFAIK workbook and worksheet are not protected. I updated question to describe addin. I cannot remove from network, to deploy updates regularly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3904868"}, "edited": false, "score": 0, "creation_date": 1491346585, "post_id": 43091514, "comment_id": 73509307, "body": "Long shot, is it related to this? <a href=\"http://stackoverflow.com/questions/14162483/excel-vba-userinterfaceonly-true-not-working\" title=\"excel vba userinterfaceonly true not working\">stackoverflow.com/questions/14162483/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491351097, "post_id": 43091514, "comment_id": 73510548, "body": "What happens when you debug it on one of the problem machines?"}], "answers": [{"comments": [{"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "edited": false, "score": 0, "creation_date": 1491212644, "post_id": 43180772, "comment_id": 73435437, "body": "Thank you for helping. I confirm all are 64-bit. I made sure of this when i installed the oracle client. There are no missing references. I generally avoid adding references for this reason."}, {"owner": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "reply_to_user": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "edited": false, "score": 0, "creation_date": 1491216305, "post_id": 43180772, "comment_id": 73437781, "body": "Okay. Have you tried running the addin locally on one of the machines where the error is thrown? Just to confirm it&#39;s not a network/firewall/... problem."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "edited": false, "score": 0, "creation_date": 1491216845, "post_id": 43180772, "comment_id": 73438163, "body": "@Kelaref Re: 32bit/64bit - I was referring to the version of <b>Office</b>, not the version of <i>Windows</i>. Your Oracle comment makes me think you might be referring to <i>Windows</i> ? Just wanted to be clear in case we&#39;d made an assumption there."}, {"owner": {"reputation": 234, "user_id": 7709026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207000596713279/picture?type=large", "display_name": "Danny James", "link": "https://stackoverflow.com/users/7709026/danny-james"}, "edited": false, "score": 0, "creation_date": 1491492134, "post_id": 43180772, "comment_id": 73587294, "body": "i back this answer, id always compile in 32bit, no matter what version it runs on its very unlikely to cause problems like this."}], "tags": [], "owner": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "is_accepted": false, "score": 3, "last_activity_date": 1491210942, "creation_date": 1491210942, "answer_id": 43180772, "question_id": 43091514, "link": "https://stackoverflow.com/questions/43091514/secure-vba-excel-addin-code/43180772#43180772", "title": "Secure VBA Excel Addin Code", "body": "<p>I know of two situations in which this error occurs:</p>\n\n<p>1: 32bit vs. 64bit issues (already mentioned in the comments). If you've developed a 32bit addin and try to deploy/use it within a 64bit Excel, then your quoted error message will appear.</p>\n\n<p>2: Missing references. </p>\n\n<p>I think the second option is more likely to be the cause of the problem, because usually all client PCs in a company will have the identical version of MS Office installed and this error occurs only on <code>some machines</code>.</p>\n\n<p>So I suggest to check your references. In the VBA-Editor (Alt+F11) go to tools --> references and note down any ticked modules. Then compare this to a client where the error is occuring (go to client PC and repeat the procedure). </p>\n\n<p>If the ticked modules don't match between development and client PC, this is most likely the cause of this issue. You might also encounter modules with a \"MISSING\" written in front of their name on the client PC. In this case, remove the tick from the missing module and try to execute your addin. </p>\n\n<p>If it works flawlessly you should be good to go, if not you'll have to manually install the missing modules on the clients PC.</p>\n\n<p>Hope this will help you.</p>\n"}], "owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1491210942, "creation_date": 1490784863, "last_edit_date": 1491209742, "question_id": 43091514, "link": "https://stackoverflow.com/questions/43091514/secure-vba-excel-addin-code", "title": "Secure VBA Excel Addin Code", "body": "<p>I have an Excel addin, developed in VBA, deployed on the network.</p>\n\n<p>The addin reads from an Oracle database, and pastes tables  in a new worksheet, which will also contain a button (triangle shape) to refresh the table.</p>\n\n<p>Everything works great, but I must protect code with password.</p>\n\n<p>When i do, the following error appears on some machines:</p>\n\n<blockquote>\n  <p>Compile error in hidden module: Main.\n  This error commonly occurs when code is incompatible with the version, platform, or architecture of this application.</p>\n</blockquote>\n\n<p><em>Although it compiles perfectly when unlocked.</em> </p>\n\n<p>On other machines it requires VBA password on close, even though i have nothing of the sort defined under close event.</p>\n\n<p>I am hoping to secure my code, without running into above problems.\nAny suggestions are appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490785166, "post_id": 43091449, "comment_id": 73264357, "body": "What&#39;s wrong with a simple worksheet formula using right or mid?  What have you tried and where have you run into problems?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1490785607, "post_id": 43091449, "comment_id": 73264665, "body": "<code>FIND</code> the position of the | bar in the text (won&#39;t be the 4th character if it says <code>10th|</code>), get the <code>LEN</code>gth of the whole text string.  Return everything to the <code>RIGHT</code> of the Length minus the Find position."}], "answers": [{"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 1, "last_activity_date": 1490785084, "creation_date": 1490785084, "answer_id": 43091597, "question_id": 43091449, "link": "https://stackoverflow.com/questions/43091449/how-to-scan-a-column-for-a-certain-word-and-when-triggered-remove-the-first-4-c/43091597#43091597", "title": "How to scan a column for a certain word and when triggered, remove the first 4 characters", "body": "<p>Just a formula in <code>D2</code> will do the trick</p>\n\n<pre><code>=RIGHT(C2,LEN(C2)-4)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7689918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b7327bbc33fddbb1581bf96ef433bba?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Mc Donagh", "link": "https://stackoverflow.com/users/7689918/brian-mc-donagh"}, "is_accepted": false, "score": 1, "last_activity_date": 1490785297, "creation_date": 1490785297, "answer_id": 43091686, "question_id": 43091449, "link": "https://stackoverflow.com/questions/43091449/how-to-scan-a-column-for-a-certain-word-and-when-triggered-remove-the-first-4-c/43091686#43091686", "title": "How to scan a column for a certain word and when triggered, remove the first 4 characters", "body": "<p><a href=\"https://www.mrexcel.com/forum/excel-questions/375502-remove-first-letter-each-cell-column.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/375502-remove-first-letter-each-cell-column.html</a></p>\n\n<p>on the forum here they mention that you can use =RIGHT(A1,LEN(A1)-1), for you it would look more like =RIGHT(C1,LEN(C1)-1) and you would place it in the D column and then just grap the bottom right hand corner and drag it down the will give you all the values you need in the D column, hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 1, "last_activity_date": 1499741371, "last_edit_date": 1499741371, "creation_date": 1490785628, "answer_id": 43091802, "question_id": 43091449, "link": "https://stackoverflow.com/questions/43091449/how-to-scan-a-column-for-a-certain-word-and-when-triggered-remove-the-first-4-c/43091802#43091802", "title": "How to scan a column for a certain word and when triggered, remove the first 4 characters", "body": "<p>If there is only sometimes a prefix or if it can be larger than 9, you can use:</p>\n\n<pre><code>=RIGHT(C2,LEN(C2)-IFERROR(FIND(\"|\",C2),0))\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3663068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/919c77ff4b2863f07f34b208a503bc48?s=128&d=identicon&r=PG&f=1", "display_name": "user3663068", "link": "https://stackoverflow.com/users/3663068/user3663068"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 43091597, "answer_count": 3, "score": 1, "last_activity_date": 1499741371, "creation_date": 1490784688, "last_edit_date": 1490785433, "question_id": 43091449, "link": "https://stackoverflow.com/questions/43091449/how-to-scan-a-column-for-a-certain-word-and-when-triggered-remove-the-first-4-c", "title": "How to scan a column for a certain word and when triggered, remove the first 4 characters", "body": "<p>Hey everyone so here is my setup</p>\n\n<p><a href=\"https://i.stack.imgur.com/QWFMH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QWFMH.png\" alt=\"enter image description here\"></a></p>\n\n<p>My issue is regarding the \"C\" column and how to remove the \"2nd|\" and \"3rd|\" portions so it ONLY shows \"Mikes Auto Shop\" \"Carls Auto Repair\" etc</p>\n\n<p>Like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/pcpvt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pcpvt.png\" alt=\"http://imgur.com/a/ddpYq\"></a></p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1490783880, "post_id": 43091025, "comment_id": 73263449, "body": "Your <code>inputbottomrow = Worksheets(&quot;Sheet2&quot;).Cells(Rows.Count, inputcolumn).End(xlUp).Row</code> is not fully qualified, modify to <code>inputbottomrow = Worksheets(&quot;Sheet2&quot;).Cells(Worksheets(&quot;Sheet2&quot;).Rows.Count, inputcolumn).End(xlUp).Row</code> , same goes for <code>outputbottomrow = Worksheets(&quot;Sheet3&quot;).Cells(Rows.Count, outputcolumn).End(xlUp).Row</code>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1490783902, "post_id": 43091025, "comment_id": 73263471, "body": "You need to correct everywhere you have <code>Worksheets(&quot;foo&quot;).Range(Cells...)</code> to <code>Worksheets(&quot;foo&quot;).Range(Worksheets(&quot;foo&quot;).Cells(...)</code>. You are better off defiining the worksheets like <code>Dim ws1 As Worksheet: Set ws1 = ThisWorkbook.Worksheets(&quot;Sheet1&quot;)</code> Then it is easier to quickly refer to <code>ws1</code> instead of typing out <code>Worksheets(&quot;Sheet1&quot;)</code> all the time.."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1490789228, "post_id": 43091025, "comment_id": 73267134, "body": "why not use a formula to do this? Use a combination of Index &amp; Match to do this."}, {"owner": {"reputation": 53, "user_id": 7507390, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/996c9ed6b1affcb31cf572a29f51ce59?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Blyth", "link": "https://stackoverflow.com/users/7507390/colin-blyth"}, "edited": false, "score": 0, "creation_date": 1490804529, "post_id": 43091025, "comment_id": 73279535, "body": "Hi Shai/Robin, thanks for both your speedy input.  It looks as though there are two slightly different syntaxes in your replies.  I&#39;ve amended the first line of code to match both of your suggestions."}, {"owner": {"reputation": 53, "user_id": 7507390, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/996c9ed6b1affcb31cf572a29f51ce59?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Blyth", "link": "https://stackoverflow.com/users/7507390/colin-blyth"}, "edited": false, "score": 0, "creation_date": 1490804657, "post_id": 43091025, "comment_id": 73279628, "body": "Set rngFindin = sh2.Range(sh2.Cells.Find(&quot;nameinput&quot;, LookIn:=xlValues, lookat:=xlWhole))"}, {"owner": {"reputation": 53, "user_id": 7507390, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/996c9ed6b1affcb31cf572a29f51ce59?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Blyth", "link": "https://stackoverflow.com/users/7507390/colin-blyth"}, "edited": false, "score": 0, "creation_date": 1490804781, "post_id": 43091025, "comment_id": 73279711, "body": "Set rngFindin = sh2.Cells(sh2.Find(&quot;nameinput&quot;, LookIn:=xlValues, lookat:=xlWhole))"}, {"owner": {"reputation": 53, "user_id": 7507390, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/996c9ed6b1affcb31cf572a29f51ce59?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Blyth", "link": "https://stackoverflow.com/users/7507390/colin-blyth"}, "edited": false, "score": 0, "creation_date": 1490804844, "post_id": 43091025, "comment_id": 73279740, "body": "however both of these are returning the error message suggesting they cannot find the &quot;nameinput&quot; text in the worksheet sh2 (where sh2 = ThisWorkbook.Worksheets(&quot;Sheet2&quot;))"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490849284, "post_id": 43093073, "comment_id": 73297903, "body": "@Colin Blyth have you tested my code above ? any feedback ?"}, {"owner": {"reputation": 53, "user_id": 7507390, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/996c9ed6b1affcb31cf572a29f51ce59?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Blyth", "link": "https://stackoverflow.com/users/7507390/colin-blyth"}, "edited": false, "score": 0, "creation_date": 1490911994, "post_id": 43093073, "comment_id": 73337134, "body": "Hello Shai, the code works perfectly, really appreciate your comments and very comprehensive explanation. Thanks again for your help"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1490789587, "last_edit_date": 1490789587, "creation_date": 1490789226, "answer_id": 43093073, "question_id": 43091025, "link": "https://stackoverflow.com/questions/43091025/vlookup-across-two-worksheets-using-vba/43093073#43093073", "title": "Vlookup across two worksheets using VBA", "body": "<p>The Answer (code and explanation) are a little long, but I wanted to share some of the reasons your code didn't work, and what I've done in my updated version below:</p>\n\n<p><strong>First</strong>, organzied data related to your InputSheet (\"Sheet2\") in one section, under <code>With Worksheets(\"Sheet2\")</code>. The same for your OutputSheet (\"Sheet3\"), under <code>With Worksheets(\"Sheet3\")</code>. </p>\n\n<p><strong>Second</strong>, I've replaced your double <code>For</code> loop and <code>Application.WorksheetFunction.VLookup</code> with one <code>For</code> and a <code>Application.Match</code> - that will save you a lot of run time.</p>\n\n<p>Some of the errors you have:</p>\n\n<ul>\n<li>Since you aready Set <code>outputrange</code> before, when you run this line <code>For Each Y in Worksheets(\"Sheet3\").outputrange</code> will raise an error, instead you can use <code>For Each Y In OutputRange</code></li>\n<li>Some of your \"lastrow\" and \"lastcolumn\" value are not fully qualified, <code>inputbottomrow = Worksheets(\"Sheet2\").Cells(Rows.Count, inputcolumn).End(xlUp).Row</code> needs to be <code>inputbottomrow = Worksheets(\"Sheet2\").Cells(Worksheets(\"Sheet2\").Rows.Count, inputcolumn).End(xlUp).Row</code>. That's why I either defined a variable of type <code>Worksheet</code> and assign it to it, or use a <code>With</code> statement.</li>\n</ul>\n\n<p><em>Side-Note</em>: I've modified the variables with CAPITAL letters in the begining (it's my way to debug I don't have any <strong>Typos</strong> when coding)</p>\n\n<p><strong>Code</strong>  </p>\n\n<pre><code>Option Explicit\n\nSub colincrosssheet()\n\nOn Error Resume Next\n\nDim InputtopRow As Long\nDim InputbottomRow As Long\nDim Inputcolumn As Long\nDim OutputtopRow As Long\nDim OutputbottomRow As Long\nDim OutputColumn As Long\n\nDim rngFindin As Range\nDim rngFindout As Range\nDim VlookupRange As Range\nDim InputRange As Range\nDim OutputRange As Range\nDim X As Range\nDim Y As Range\n\n' set input column, which contains the line item ids from Pacing Tool, and also sets bottom row\nWith Worksheets(\"Sheet2\")\n    Set rngFindin = .Cells.Find(\"nameinput\", LookIn:=xlValues, lookat:=xlWhole)\n    If rngFindin Is Nothing Then\n        MsgBox \"Could not find 'Line Item Id' column in your SDF. Please review file.\", vbOKOnly, \"Column not found\"\n    Else\n        InputtopRow = rngFindin.Row + 1\n        Inputcolumn = rngFindin.Column\n        InputbottomRow = .Cells(.Rows.Count, Inputcolumn).End(xlUp).Row\n    End If\n\n    ' define input range which contain line item ids\n    Set InputRange = .Range(.Cells(InputtopRow, Inputcolumn), .Cells(InputbottomRow, Inputcolumn))\nEnd With\n\n'set output column, which contains the line item ids in the SDF, and also sets bottom row\nWith Worksheets(\"Sheet3\")\n    Set rngFindout = .Cells.Find(\"nameoutput\", LookIn:=xlValues, lookat:=xlWhole)\n    If rngFindout Is Nothing Then\n        MsgBox \"Could not find 'Line Item Id' column in your SDF. Please review file.\", vbOKOnly, \"Column not found\"\n    Else\n        OutputtopRow = rngFindout.Row + 1\n        OutputColumn = rngFindout.Column\n        OutputbottomRow = .Cells(.Rows.Count, OutputColumn).End(xlUp).Row\n    End If\n    ' define output range which contain line item ids\n    Set OutputRange = .Range(.Cells(OutputtopRow, OutputColumn), .Cells(OutputbottomRow, OutputColumn))\nEnd With\n\nDim MatchRow As Variant\n' loop through outputrange and update relevant column in SDF with new bid values\nFor Each Y In OutputRange\n    If Not IsError(Application.Match(Y.value, InputRange, 0)) Then ' check if Y is found anywhere in inputrange using the Match\n        MatchRow = Application.Match(Y.value, InputRange, 0) + rngFindin.Row\n\n        Y.Offset(, 1).Value = Worksheets(\"Sheet2\").Cells(MatchRow, Inputcolumn + 1)\n        Y.Offset(, 1).Interior.ColorIndex = 28\n    End If\nNext Y\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7507390, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/996c9ed6b1affcb31cf572a29f51ce59?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Blyth", "link": "https://stackoverflow.com/users/7507390/colin-blyth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 43093073, "answer_count": 1, "score": 1, "last_activity_date": 1490789587, "creation_date": 1490783435, "last_edit_date": 1490783999, "question_id": 43091025, "link": "https://stackoverflow.com/questions/43091025/vlookup-across-two-worksheets-using-vba", "title": "Vlookup across two worksheets using VBA", "body": "<p><a href=\"https://i.stack.imgur.com/o64a4.png\" rel=\"nofollow noreferrer\">Source sheet (\"Sheet2\")</a>\n<a href=\"https://i.stack.imgur.com/KkCtW.png\" rel=\"nofollow noreferrer\">Output sheet (\"Sheet3\")</a></p>\n\n<p>I have a list of names and associated values in \"Sheet2\".  I have another list of names in \"Sheet3\".  Where the name in sheet2 can also be found in Sheet3, i would like to add in the associated value in the column adjacent to the name in Sheet3.</p>\n\n<p>To do this, I've created a nested loop which behaves as follows;  </p>\n\n<ul>\n<li>Loops over all names (\"X\") in \"sheet2\" </li>\n<li>For each of these names iterate over all names (\"Y\") in \"sheet 3\"</li>\n<li>where the values match, perform a <code>VLookup</code> on \"Sheet2\" and highlight the cell to flag that a value was added.</li>\n</ul>\n\n<p>This code worked fine when the two tables were hosted in the same worksheet.  On attempting to replicate this behaviour across two different worksheets (by ensuring that explicit worksheet references were added to all ranges) it doesnt do anything.</p>\n\n<p>Any help would be much appreciated</p>\n\n<pre><code>Sub colincrosssheet()\n\nOn Error Resume Next\n\nDim inputrange As Range\nDim outputrange As Range\nDim X As Range\nDim Y As Range\nDim inputtoprow As Integer\nDim inputbottomrow As Integer\nDim inputcolumn As Integer\nDim outputtoprow As Integer\nDim outputbottomrow As Integer\nDim outputcolumn As Integer\nDim rngFindin As Range\nDim rngFindout As Range\nDim vlookuprange As Range\n\n'set input column, which contains the line item ids from Pacing Tool, and also sets bottom row\nSet rngFindin = Worksheets(\"Sheet2\").Cells.Find(\"nameinput\", LookIn:=xlValues, lookat:=xlWhole)\nIf rngFindin Is Nothing Then\n    MsgBox \"Could not find 'Line Item Id' column in your SDF. Please review file.\", vbOKOnly, \"Column not found\"\nElse\n    inputtoprow = Worksheets(\"Sheet2\").rngFindin.Row + 1\n    inputcolumn = Worksheets(\"Sheet2\").rngFindin.Column\n    inputbottomrow = Worksheets(\"Sheet2\").Cells(Rows.Count, inputcolumn).End(xlUp).Row\nEnd If\n\n'set output column, which contains the line item ids in the SDF, and also sets bottom row\nSet rngFindout = Worksheets(\"Sheet3\").Cells.Find(\"nameoutput\", LookIn:=xlValues, lookat:=xlWhole)\nIf rngFindout Is Nothing Then\n    MsgBox \"Could not find 'Line Item Id' column in your SDF. Please review file.\", vbOKOnly, \"Column not found\"\nElse\n    outputtoprow = Worksheets(\"Sheet3\").rngFindout.Row + 1\n    outputcolumn = Worksheets(\"Sheet3\").rngFindout.Column\n    outputbottomrow = Worksheets(\"Sheet3\").Cells(Rows.Count, outputcolumn).End(xlUp).Row\nEnd If\n\n'define Vlookup range'\nSet vlookuprange = Worksheets(\"Sheet2\").Range(Cells(inputtoprow, inputcolumn), Cells(inputbottomrow, inputcolumn + 1))\n\n'defines input and output range which contain line item ids\nSet inputrange = Worksheets(\"Sheet2\").Range(Cells(inputtoprow, inputcolumn), Cells(inputbottomrow, inputcolumn))\nSet outputrange = Worksheets(\"Sheet3\").Range(Cells(outputtoprow, outputcolumn), Cells(outputbottomrow, outputcolumn))\n\n'loop through input range and update relevant column in SDF with new bid values\nFor Each X In Worksheets(\"Sheet2\").inputrange\n    For Each Y In Worksheets(\"Sheet3\").outputrange\n        If Worksheets(\"Sheet3\").Y.Value = Worksheets(\"Sheet2\").X.Value Then\n            Worksheets(\"Sheet3\").Y.Offset(ColumnOffset:=1).Value = Application.WorksheetFunction.VLookup(Worksheets(\"Sheet2\").X.Value, Worksheets(\"Sheet2\").vlookuprange, 2, False)\n            Worksheets(\"Sheet3\").Y.Offset(ColumnOffset:=1).Interior.ColorIndex = 28\n        End If\n    Next Y\nNext X\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "class", "methods"], "comments": [{"owner": {"reputation": 21, "user_id": 7785129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ymeoigiZaYs/AAAAAAAAAAI/AAAAAAAAAHw/LmAz-3SRyGg/photo.jpg?sz=128", "display_name": "Jose Adame", "link": "https://stackoverflow.com/users/7785129/jose-adame"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490784143, "post_id": 43090943, "comment_id": 73263638, "body": "Sorry for being a noob but I&#39;m not sure where you got that code from."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490786631, "post_id": 43090943, "comment_id": 73265357, "body": "sorry, that was my code :)  Is it happening on this <code>dailyWF.SetProcessMatrixValue 0, 0, 30</code> line"}, {"owner": {"reputation": 21, "user_id": 7785129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ymeoigiZaYs/AAAAAAAAAAI/AAAAAAAAAHw/LmAz-3SRyGg/photo.jpg?sz=128", "display_name": "Jose Adame", "link": "https://stackoverflow.com/users/7785129/jose-adame"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1490787867, "post_id": 43090943, "comment_id": 73266192, "body": "I actually figured it out. My class wasn&#39;t properly instantiating because of an error in the constructor code, but because I used the <code>Private dailyWF As New OpsFloor</code> instead of <code>Dim dailyWF As OpsFloor:Set dailyWF = New OpsFloor</code> Once I switched it it pointed me to the error within the constructor (unnecessary parenthesis when adding to a collection) and now it runs perfectly."}], "answers": [{"comments": [{"owner": {"reputation": 466, "user_id": 8173666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nd8Pa.png?s=128&g=1", "display_name": "TechingCrewMatt", "link": "https://stackoverflow.com/users/8173666/techingcrewmatt"}, "edited": false, "score": 0, "creation_date": 1524000300, "post_id": 43092777, "comment_id": 86791397, "body": "&quot;Break in Class Modules&quot; just save me hour I&#39;m sure. Thanks"}], "tags": [], "owner": {"reputation": 21, "user_id": 7785129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ymeoigiZaYs/AAAAAAAAAAI/AAAAAAAAAHw/LmAz-3SRyGg/photo.jpg?sz=128", "display_name": "Jose Adame", "link": "https://stackoverflow.com/users/7785129/jose-adame"}, "is_accepted": false, "score": 1, "last_activity_date": 1490788435, "creation_date": 1490788435, "answer_id": 43092777, "question_id": 43090943, "link": "https://stackoverflow.com/questions/43090943/cant-call-method-of-custom-class-object-excel-vba/43092777#43092777", "title": "Can&#39;t Call Method of Custom Class Object Excel VBA", "body": "<p>So I had a couple issues which I managed to uncover after piecing together a lot of different posts.</p>\n\n<p>Firstly the way I originally declared my class variable:</p>\n\n<pre><code>Private dailyWF As New OpsFloor\n</code></pre>\n\n<p>This didn't properly instantiate the class object. When I tried to change it to the following:</p>\n\n<pre><code>Private dailyWF As New OpsFloor\nSet dailyWf = New Operations_Floor\n</code></pre>\n\n<p>I got an error which pointed me to the class constructor. It ended up being an issue with how I was assigning objects to a collection. </p>\n\n<pre><code>newCollection.Add(new Object) //WRONG!\nnewCollection.Add new Object //Right!\n</code></pre>\n\n<p>For other newbs like me I found a post that recommended turning on \"Break in Class Modules\" by going to Tools>Options>General>Break in Class Modules. This showed me the error was inside the class constructor and not actually an issue with the way I was making my call. </p>\n"}], "owner": {"reputation": 21, "user_id": 7785129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ymeoigiZaYs/AAAAAAAAAAI/AAAAAAAAAHw/LmAz-3SRyGg/photo.jpg?sz=128", "display_name": "Jose Adame", "link": "https://stackoverflow.com/users/7785129/jose-adame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1267, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524000279, "creation_date": 1490783218, "question_id": 43090943, "link": "https://stackoverflow.com/questions/43090943/cant-call-method-of-custom-class-object-excel-vba", "title": "Can&#39;t Call Method of Custom Class Object Excel VBA", "body": "<p>I'm in the middle of writing some code for scheduling automation. I am relatively new to VBA programming but have been programming in other languages for years. For my project I've created a class called OpsFloor which is supposed to simulate the operations floor. I'm parsing user information into an array and trying to pass that array (I've tried both passing the whole array and by individual values) into an instance of the OpsFloor object. I'm worried I have some fundamental misunderstanding about how classes work in VBA. Below is the sub from within the Class</p>\n\n<pre><code>Public Sub SetProcessMatrixValue(x As Integer, y As Integer, value As Integer)\n    ProcessMatrix(x, y) = value\nEnd Sub\n</code></pre>\n\n<p>Here is the call from within the worksheet object sub in Excel:</p>\n\n<pre><code>Option Explicit\nPrivate OperationMatrix(18, 8) As Integer\nPrivate dailyWF As New OpsFloor\nPublic Sub StartingWorksheet()\n...\ndailyWF.SetProcessMatrixValue 0, 0, 30\nEnd Sub\n</code></pre>\n\n<p>When I try to run the sub to assign those values to the class instance through the SetProcessMatrixValue method I get Run-time Error '438' Object Doesn't Support this property or method.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1490783114, "post_id": 43090703, "comment_id": 73262944, "body": "When <code>S21</code> = 2 what would the value of <code>S20</code> be? and vica versa when <code>S20</code> = 1?"}], "answers": [{"tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 0, "last_activity_date": 1490784625, "last_edit_date": 1495540000, "creation_date": 1490784321, "answer_id": 43091317, "question_id": 43090703, "link": "https://stackoverflow.com/questions/43090703/running-different-macros-based-on-values-in-range/43091317#43091317", "title": "Running Different Macros Based on Values in Range", "body": "<p>Your <code>CopyPriceOver</code> sub has some issues, I've pointed them out in comments below</p>\n\n<pre><code>Sub CopyPriceOver()\n    Application.ScreenUpdating = False\n    ' Number = Range(\"S20:S22\").Value\n    ' You're trying to assign 3 cells' values to one number!\n    ' You should declare Number first, declaring it as an integer would quickly flag to you\n    ' the error caused by assigning 3 cells to it. I've opted to not use the\n    ' variable at all, since you're checking different values anyway...\n\n    ' You should full qualify ranges to a specific sheet, this example uses a With block:\n    With ThisWorkbook.Sheets(\"SheetNameHere\")\n        ' Test for individual cells' values, you specified values for S20 and S21...\n        If .Range(\"S20\").Value = 1 Then    \n            ' You don't need the \"Call\" command, see my comment after the code\n            Macro1    \n        ElseIf .Range(\"S21\").Value = 2 Then    \n            Macro2    \n        End If\n    End With\n\n    ' You called ScheduleCopyPriceOver in every If condition, simply call it afterwards\n    ScheduleCopyPriceOver   \n\n    ' You disabled screen updating and never re-enabled it\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>With respect to the <code>Call</code> command, see this SO question: <a href=\"https://stackoverflow.com/questions/2573597/should-i-use-call-keyword-in-vb-vba\">Should I use Call keyword in VB/VBA?</a></p>\n\n<p>Your catch-all use of <code>On Error Resume Next</code> also raises red flags in <code>auto_close</code>, you should diagnose and fix errors rather than hide them!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5624509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a328602f225e9156dc11209f6402f9?s=128&d=identicon&r=PG&f=1", "display_name": "Biju John", "link": "https://stackoverflow.com/users/5624509/biju-john"}, "is_accepted": false, "score": 0, "last_activity_date": 1490784707, "creation_date": 1490784707, "answer_id": 43091459, "question_id": 43090703, "link": "https://stackoverflow.com/questions/43090703/running-different-macros-based-on-values-in-range/43091459#43091459", "title": "Running Different Macros Based on Values in Range", "body": "<p>use the below code</p>\n\n<pre><code>If range(\"S20\") = 1 Then\n\nCall Macro1\nCall ScheduleCopyPriceOver\n\nElseIf range(\"S21\") = 2 Then\n\nCall Macro2\nCall ScheduleCopyPriceOver\n\nElse\nCall ScheduleCopyPriceOver\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7761234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7205e235fd2cc33c447c194092a0022?s=128&d=identicon&r=PG&f=1", "display_name": "colin111", "link": "https://stackoverflow.com/users/7761234/colin111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 43091317, "answer_count": 2, "score": 0, "last_activity_date": 1490784707, "creation_date": 1490782635, "last_edit_date": 1490782962, "question_id": 43090703, "link": "https://stackoverflow.com/questions/43090703/running-different-macros-based-on-values-in-range", "title": "Running Different Macros Based on Values in Range", "body": "<p>Im busy trying to write code that calls different macros based on the value of a cell across an entire range on VBA.</p>\n\n<p>So for the example I have a range S20:S21.</p>\n\n<p>When the value in cell S20 is equal to 1, I want to call macro1.\nWhen the value in cell S21 is equal to 2, I want to call macro2.</p>\n\n<p>When there is no match I have a time that it will test it in the next 5 seconds again where it will start from the top checking if cell S20 is 1 or of S20 is 2.</p>\n\n<p>This is currently the code I have.</p>\n\n<pre><code>    Dim TimeToRun\n\nSub auto_open()\n    Call ScheduleCopyPriceOver\nEnd Sub\n\n\nSub ScheduleCopyPriceOver()\n    TimeToRun = Now + TimeValue(\"00:00:05\")\n    Application.OnTime TimeToRun, \"CopyPriceOver\"\nEnd Sub\n\nSub CopyPriceOver()\nApplication.ScreenUpdating = False\n\n    Number = Range(\"S20:S22\").Value\n\n    If Number = 1 Then\n\n    Call Macro1\n    Call ScheduleCopyPriceOver\n\n    ElseIf Number = 2 Then\n\n    Call Macro2\n    Call ScheduleCopyPriceOver\n\n    Else\n\n    Call ScheduleCopyPriceOver\n    End If\n\n\nEnd Sub\n\nSub auto_close()\n    On Error Resume Next\n    Application.OnTime TimeToRun, \"CopyPriceOver\", , False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7647813, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-X_aHsvInOM4/AAAAAAAAAAI/AAAAAAAAAes/FuLlVX_M0qo/photo.jpg?sz=128", "display_name": "Shawn Cartwright", "link": "https://stackoverflow.com/users/7647813/shawn-cartwright"}, "edited": false, "score": 0, "creation_date": 1490784769, "post_id": 43090902, "comment_id": 73264064, "body": "Im getting a runtime error 1004 - The name that you entered is not valid?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 7647813, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-X_aHsvInOM4/AAAAAAAAAAI/AAAAAAAAAes/FuLlVX_M0qo/photo.jpg?sz=128", "display_name": "Shawn Cartwright", "link": "https://stackoverflow.com/users/7647813/shawn-cartwright"}, "edited": false, "score": 0, "creation_date": 1490784833, "post_id": 43090902, "comment_id": 73264111, "body": "where ? first line ? do you have any value in your  <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;)</code> ? what is it ?"}, {"owner": {"reputation": 13, "user_id": 7647813, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-X_aHsvInOM4/AAAAAAAAAAI/AAAAAAAAAes/FuLlVX_M0qo/photo.jpg?sz=128", "display_name": "Shawn Cartwright", "link": "https://stackoverflow.com/users/7647813/shawn-cartwright"}, "edited": false, "score": 0, "creation_date": 1490787717, "post_id": 43090902, "comment_id": 73266101, "body": "First line A1 contains 1234"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 7647813, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-X_aHsvInOM4/AAAAAAAAAAI/AAAAAAAAAes/FuLlVX_M0qo/photo.jpg?sz=128", "display_name": "Shawn Cartwright", "link": "https://stackoverflow.com/users/7647813/shawn-cartwright"}, "edited": false, "score": 0, "creation_date": 1490787759, "post_id": 43090902, "comment_id": 73266133, "body": "@ShawnCartwright in &quot;Sheet1&quot; ? is it a value ? or formula ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 7647813, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-X_aHsvInOM4/AAAAAAAAAAI/AAAAAAAAAes/FuLlVX_M0qo/photo.jpg?sz=128", "display_name": "Shawn Cartwright", "link": "https://stackoverflow.com/users/7647813/shawn-cartwright"}, "edited": false, "score": 0, "creation_date": 1490791464, "post_id": 43090902, "comment_id": 73268744, "body": "@ShawnCartwright I can&#39;t see any reason why it&#39;s not running for you, try my edited code under <b>Edit 1</b> for debugging this"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1490791438, "last_edit_date": 1490791438, "creation_date": 1490783109, "answer_id": 43090902, "question_id": 43090492, "link": "https://stackoverflow.com/questions/43090492/vba-name-excel-table-range-and-paste-into-sheet-2/43090902#43090902", "title": "VBA - Name Excel Table Range and Paste Into Sheet 2", "body": "<p>To add a <code>Named Range</code> (workbook scope) that refers to <code>Range(\"O1:AG15\")</code> in \"Sheet1\" use the line below:</p>\n\n<pre><code>ThisWorkbook.Names.Add _\n            Name:=Worksheets(\"Sheet1\").Range(\"A1\").Value, _\n            RefersTo:=Worksheets(\"Sheet1\").Range(\"O1:AG15\")\n</code></pre>\n\n<p>To copy this <code>Range</code> to \"Sheet2\" use the code line below:</p>\n\n<pre><code>Range(Worksheets(\"Sheet1\").Range(\"A1\").Value).Copy Destination:=Worksheets(\"Sheet2\").Range(\"A1\")\n</code></pre>\n\n<hr>\n\n<p><strong>Edit 1</strong>: for Debug</p>\n\n<pre><code>Dim RangeName As String\n\nRangeName = Worksheets(\"Sheet1\").Range(\"A1\").value\nMsgBox RangeName\n\nThisWorkbook.Names.Add Name:=RangeName, RefersTo:=Worksheets(\"Sheet1\").Range(\"O1:AG15\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7647813, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-X_aHsvInOM4/AAAAAAAAAAI/AAAAAAAAAes/FuLlVX_M0qo/photo.jpg?sz=128", "display_name": "Shawn Cartwright", "link": "https://stackoverflow.com/users/7647813/shawn-cartwright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 43090902, "answer_count": 1, "score": 0, "last_activity_date": 1490791438, "creation_date": 1490782103, "last_edit_date": 1490783356, "question_id": 43090492, "link": "https://stackoverflow.com/questions/43090492/vba-name-excel-table-range-and-paste-into-sheet-2", "title": "VBA - Name Excel Table Range and Paste Into Sheet 2", "body": "<p>Can you name a Range(\"O1:AG15\") with a specific cell text. </p>\n\n<p>IE A1 contains \"1234\" ... name Range(\"O1:AG15\") \"1234\" then copy that range into Worksheet2 (Not important where).</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 3, "creation_date": 1490781985, "post_id": 43090338, "comment_id": 73262223, "body": "You got apostrophes <code>&#39;</code> in the <code>strFormulas(1)</code> where there should be quotation marks <code>&quot;</code>. So, it should be more something like <code>&quot;=IF(NOT(IMPORT!A4=&quot;&quot;&quot;&quot;),VLOOKUP(IMPO....</code> Just replace all <code>&#39;</code> <b>within</b> the formula with two quotation marks <code>&quot;&quot;</code>."}, {"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490782208, "post_id": 43090338, "comment_id": 73262356, "body": "fixed! thanks a lot."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490782686, "post_id": 43090338, "comment_id": 73262662, "body": "@Ralph you should post as answer"}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 2, "last_activity_date": 1490784064, "creation_date": 1490784064, "answer_id": 43091242, "question_id": 43090338, "link": "https://stackoverflow.com/questions/43090338/run-time-error-1004-application-defined-or-object-defined-error-when-setting-for/43091242#43091242", "title": "Run-time error 1004 Application-defined or Object-defined error when setting Formula property", "body": "<p>You got apostrophes <code>'</code> in the <code>strFormulas(1)</code> where there should be quotation marks <code>\"</code>. So, it should be more something like </p>\n\n<pre><code>strFormulas(1) = \"=IF(NOT(IMPORT!A4=\"\"\"\"),VLOOKUP(IMPORT!A4,\"\"VL1\"\"!$Q$4:$R$26,2,FALSE),\"\"-\"\")\"\n</code></pre>\n\n<p>Just replace all <code>'</code> <strong>within</strong> the formula with <strong>two</strong> quotation marks <code>\"\"</code>.</p>\n"}], "owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 43091242, "answer_count": 1, "score": 1, "last_activity_date": 1490784568, "creation_date": 1490781690, "last_edit_date": 1490784568, "question_id": 43090338, "link": "https://stackoverflow.com/questions/43090338/run-time-error-1004-application-defined-or-object-defined-error-when-setting-for", "title": "Run-time error 1004 Application-defined or Object-defined error when setting Formula property", "body": "<p>This works fine:</p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim strFormulas(1 To 3) As Variant\n\n    With ThisWorkbook.Sheets(\"TRANSFORM\")\n        strFormulas(1) = \"=SUM(A2:B2)\"\n        strFormulas(2) = \"=PRODUCT(A2:B2)\"\n        strFormulas(3) = \"=A2/B2\"\n\n        .Range(\"A4:G4\").Formula = strFormulas\n        .Range(\"A4:G20\").FillDown\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>But this doesn't work - everything is the same besides <code>strFormulas(1)</code>: </p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim strFormulas(1 To 3) As Variant\n\n    With ThisWorkbook.Sheets(\"TRANSFORM\")\n        strFormulas(1) = \"=IF(NOT(IMPORT!A4=''),VLOOKUP(IMPORT!A4,'VL1'!$Q$4:$R$26,2,FALSE),'-')\"\n        strFormulas(2) = \"=PRODUCT(A2:B2)\"\n        strFormulas(3) = \"=A2/B2\"\n\n        .Range(\"A4:G4\").Formula = strFormulas\n        .Range(\"A4:G20\").FillDown\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>Run-time error 1004 Application-defined or Object-defined error </p>\n</blockquote>\n\n<p>I think it may be because I'm trying to pull values from another worksheet in <code>strFormulas(1)</code>. </p>\n\n<p>I did my research and couldn't find a solution. Can anyone see what the problem is?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1490784209, "post_id": 43090934, "comment_id": 73263675, "body": "That works but the first row still has all the data in it that you have copied down onto the rows..."}], "tags": [], "owner": {"reputation": 61, "user_id": 3061876, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AlF1O.png?s=128&g=1", "display_name": "user3061876", "link": "https://stackoverflow.com/users/3061876/user3061876"}, "is_accepted": false, "score": 1, "last_activity_date": 1490783191, "creation_date": 1490783191, "answer_id": 43090934, "question_id": 43090163, "link": "https://stackoverflow.com/questions/43090163/move-to-new-row-every-4th-column/43090934#43090934", "title": "Move to new row every 4th column", "body": "<p>I made a macro:</p>\n\n<pre><code>Sub dela_igen()\nDim i As Integer, j As Integer, cur_column As Integer\n\ncur_column = 1\nFor i = 1 To 100\n    For j = 1 To 4\n        Cells(i, j).Value = Cells(1, cur_column).Value\n        cur_column = cur_column + 1\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Worked like a charm!</p>\n"}], "owner": {"reputation": 61, "user_id": 3061876, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AlF1O.png?s=128&g=1", "display_name": "user3061876", "link": "https://stackoverflow.com/users/3061876/user3061876"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490783191, "creation_date": 1490781264, "last_edit_date": 1531161705, "question_id": 43090163, "link": "https://stackoverflow.com/questions/43090163/move-to-new-row-every-4th-column", "title": "Move to new row every 4th column", "body": "<p>I got data that is stored in one row of columns in an excel sheet.\nIs there a way to move data to next row every 4th column? Is there a built in function for this?\nFor example:</p>\n\n<p>Data:</p>\n\n<pre><code>Actinium | Ac | 89 | 227.0278* | Aluminum | Al | 13 | 26,981539 ...\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Actinium |Ac | 89 | 227.0278*\nAluminum |Al | 13 | 26,981539\n</code></pre>\n"}, {"tags": ["arrays", "excel", "wildcard", "select-case", "vba"], "comments": [{"owner": {"reputation": 386, "user_id": 7781307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sW6ol.jpg?s=128&g=1", "display_name": "SLWS", "link": "https://stackoverflow.com/users/7781307/slws"}, "edited": false, "score": 1, "creation_date": 1490781328, "post_id": 43090029, "comment_id": 73261819, "body": "This seems to be what you&#39;re looking for: <a href=\"http://stackoverflow.com/questions/30175061/wildcard-search-in-array\" title=\"wildcard search in array\">stackoverflow.com/questions/30175061/wildcard-search-in-arra&zwnj;&#8203;y</a>"}, {"owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "reply_to_user": {"reputation": 386, "user_id": 7781307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sW6ol.jpg?s=128&g=1", "display_name": "SLWS", "link": "https://stackoverflow.com/users/7781307/slws"}, "edited": false, "score": 0, "creation_date": 1490784886, "post_id": 43090029, "comment_id": 73264143, "body": "Yes and no. Some of my strings are not wildcards while others are. the one you linked to does not seem to distinguish between it. That being said, i guess the easy way would be to use two arrays one with and one without wildcards"}], "answers": [{"tags": [], "owner": {"reputation": 386, "user_id": 7781307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sW6ol.jpg?s=128&g=1", "display_name": "SLWS", "link": "https://stackoverflow.com/users/7781307/slws"}, "is_accepted": true, "score": 1, "last_activity_date": 1490785408, "creation_date": 1490785408, "answer_id": 43091723, "question_id": 43090029, "link": "https://stackoverflow.com/questions/43090029/check-if-string-is-in-array-or-not-including-wildcards-with-excel-vba/43091723#43091723", "title": "Check if string is in array or not including wildcards with Excel VBA", "body": "<p>Or something like:</p>\n\n<pre><code>Function IsInArray2(StringToBeFound As String, MyArray As Variant) As Boolean\nIsInArray2 = False\nwildCard = \"*\"\nIf InStr(StringToBeFound, wildCard) &gt; 0 Then\n    For i = LBound(MyArray) To UBound(MyArray)\n        If \"*\" &amp; MyArray(i) &amp; \"*\" Like StringToBeFound Then IsInArray2 =    True 'will match MyArray to any substring of StringToBeFound\n    Next\nElse\n    For i = LBound(MyArray) To UBound(MyArray)\n            If MyArray(i) == StringToBeFound Then IsInArray2 =  True 'will exactly match MyArray to StringToBeFound\n    Next\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "is_accepted": false, "score": 0, "last_activity_date": 1490792517, "creation_date": 1490792517, "answer_id": 43094315, "question_id": 43090029, "link": "https://stackoverflow.com/questions/43090029/check-if-string-is-in-array-or-not-including-wildcards-with-excel-vba/43094315#43094315", "title": "Check if string is in array or not including wildcards with Excel VBA", "body": "<p>Thank you SLWS. I modified the code you referenced to a bit in order to fit my need.<br>\n<strong>This works for me:</strong></p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, MyArray As Variant) As Boolean\n\n    Dim i As Long\n    Dim WildCard As String\n    WildCard = \"*\"\n\n    IsInArray = False\n\n    For i = LBound(MyArray) To UBound(MyArray)\n        If InStr(MyArray(i), WildCard) &gt; 0 Then\n            If LCase(stringToBeFound) Like LCase(\"*\" &amp; Replace(MyArray(i), \" \", \"*\") &amp; \"*\") Then\n                IsInArray = True\n                Exit Function\n            End If\n        Else\n            If LCase(stringToBeFound) = LCase(MyArray(i)) Then\n                IsInArray = True\n                Exit Function\n            End If\n        End If\n    Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1103, "favorite_count": 0, "accepted_answer_id": 43091723, "answer_count": 2, "score": 0, "last_activity_date": 1490792517, "creation_date": 1490780921, "last_edit_date": 1531161705, "question_id": 43090029, "link": "https://stackoverflow.com/questions/43090029/check-if-string-is-in-array-or-not-including-wildcards-with-excel-vba", "title": "Check if string is in array or not including wildcards with Excel VBA", "body": "<p>I found this function to identify whether a string is in a given array, however it does not seem to be able to handle wildcards (or atleast not the way i do it).</p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n  IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\nEnd Function\n</code></pre>\n\n<p>My use of the function:</p>\n\n<pre><code>Dim BannedWildcards() As Variant\n\nBannedWildcards = Array(\"\", \"-\", \"?\", 0, \"na\", \"n/a\", _\n\"*account*\", \"*hse*\", \"*defined*\", \"*applicable*\", \"*operation*\", \"*action*\", \"*manager*\")\n\n            Select Case True\n            Case IsInArray(LCase(Sht_Tracker.Cells(RowCounter_CRCT, 17)), BannedWildcards) = True\n                Arr_Dashboard_Current(10, ArrC_Dashboard_Current) = \"#N/A\"\n            Case Else: Arr_Dashboard_Current(10, ArrC_Dashboard_Current) = Sht_Tracker.Cells(RowCounter_CRCT, 17)\n            End Select\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1490785705, "post_id": 43089890, "comment_id": 73264736, "body": "What does &quot;doesn&#39;t work&quot; mean? Start by commenting out your On Error lines and debugging any errors."}, {"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490788515, "post_id": 43089890, "comment_id": 73266627, "body": "@SJR without &#39;On Error Resume Next&#39; I get the error message &quot;Runtime Error 91: Object variable or with block variable not set&quot;"}, {"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490788626, "post_id": 43089890, "comment_id": 73266700, "body": "it highlights the line x = Lookup_Range.Find(&quot;10 - 19 days&quot;, range(&quot;A1&quot;), xlValues, xlWhole, xlByColumns, xlNext).Row , I suppose, because it cannot find the cell with &quot;10 - 19 days&quot;"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1490789493, "post_id": 43089890, "comment_id": 73267325, "body": "Why not just use the normal vlookup function in the worksheet?"}, {"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1490790142, "post_id": 43089890, "comment_id": 73267804, "body": "@Luuklag how? I need the information from the second column, and since I have State1, State2 and so on for every category (see &quot;1 - 9 days&quot; etc.), I thought I have to find first the right range of data to do a VLookup."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490791233, "post_id": 43089890, "comment_id": 73268590, "body": "Yes I think it probably does mean that. You should add a check to avoid errors, but you need to find out why it doesn&#39;t find the value. First, use <code>sheets(&quot;Duration&quot;).range(&quot;a1&quot;)</code> in your Find statement."}, {"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490791812, "post_id": 43089890, "comment_id": 73269017, "body": "@SJR it doesn&#39;t find the value, because when I run the code - I get a new data from the external excel file, and there is no &quot;10 - 19 days&quot; anymore"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490791899, "post_id": 43089890, "comment_id": 73269072, "body": "So what should happen if the value is not found?"}, {"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "edited": false, "score": 0, "creation_date": 1490792053, "post_id": 43089890, "comment_id": 73269200, "body": "From time to time some values will be absent. I want in case when the FIND function cannot find the given value, to get 0 in the second table (second table is on the same worksheet)."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490792249, "post_id": 43089890, "comment_id": 73269357, "body": "OK I see now. I have tidied up your code a little below so let me know how you get on."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "edited": false, "score": 0, "creation_date": 1490793810, "post_id": 43094242, "comment_id": 73270703, "body": "You have just saved my project. Thank you very much! It works like I want."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1490792332, "creation_date": 1490792332, "answer_id": 43094242, "question_id": 43089890, "link": "https://stackoverflow.com/questions/43089890/find-the-text-and-return-its-value-return-0-if-the-text-is-not-found/43094242#43094242", "title": "find the text and return its value, return 0 if the text is not found", "body": "<p>This adds some checks that the values are found which should avoid the errors.</p>\n\n<pre><code>Sub xy()\n\nDim x As Long, r As Range\n\nDim Lookup_Range, RangeA As Range\n\nWith Worksheets(\"Duration\")\n    Set Lookup_Range = .Range(\"A1:B56\")\n    Set r = Lookup_Range.Find(\"1 - 9 days\", .Range(\"A1\"), xlValues, xlWhole, xlByColumns, xlNext)\n    If Not r Is Nothing Then\n        x = r.Row\n        Set RangeA = .Range(.Cells(x, 1), .Cells(x + 4, 2))\n        .Cells(30, 7) = Application.VLookup(\"State1\", RangeA, 2, False)\n        .Cells(31, 7) = Application.VLookup(\"State2\", RangeA, 2, False)\n        .Cells(32, 7) = Application.VLookup(\"State3\", RangeA, 2, False)\n        .Cells(33, 7) = Application.VLookup(\"State4\", RangeA, 2, False)\n    Else\n        .Cells(30, 7) = 0\n        .Cells(31, 7) = 0\n        .Cells(32, 7) = 0\n        .Cells(33, 7) = 0\n    End If\n    Set r = Lookup_Range.Find(\"10 - 19 days\")\n    If Not r Is Nothing Then\n        x = r.Row\n        Set RangeA = .Range(.Cells(x, 1), .Cells(x + 4, 2))\n        .Cells(34, 7) = Application.VLookup(\"State1\", RangeA, 2, False)\n        .Cells(35, 7) = Application.VLookup(\"State2\", RangeA, 2, False)\n        .Cells(36, 7) = Application.VLookup(\"State3\", RangeA, 2, False)\n        .Cells(37, 7) = Application.VLookup(\"State4\", RangeA, 2, False)\n    Else\n        .Cells(34, 7) = 0\n        .Cells(35, 7) = 0\n        .Cells(36, 7) = 0\n        .Cells(37, 7) = 0\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 43094242, "answer_count": 1, "score": 0, "last_activity_date": 1490792332, "creation_date": 1490780575, "last_edit_date": 1531164843, "question_id": 43089890, "link": "https://stackoverflow.com/questions/43089890/find-the-text-and-return-its-value-return-0-if-the-text-is-not-found", "title": "find the text and return its value, return 0 if the text is not found", "body": "<p>I need your help. Cannot figure out why the piece of code below doesn't work. I have a PivotTable where I look for a specific value with a function FIND and VLOOKUP and add it to a specific cell:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iJhIb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iJhIb.png\" alt=\"enter image description here\"></a> </p>\n\n<p>After the data update - there is no information about States duration of 10 - 19 days anymore. In this case when some category values are absent - I want to assign the 0 value to a specific cells.\nI tried to achive it writing the following: </p>\n\n<pre><code>Dim x As Long\nDim Lookup_Range, RangeA As range\n\nWith Worksheets(\"Duration\")\n\nSet Lookup_Range = Worksheets(\"Duration\").range(\"A1:B56\")\n\nOn Error Resume Next\nx = Lookup_Range.Find(\"1 - 9 days\", range(\"A1\"), xlValues, xlWhole, xlByColumns, xlNext).Row\n\nSet RangeA = .range(.Cells(x, 1), .Cells(x + 4, 2))\n\nIf Not x &lt;&gt; \"\" Then\n\n   .Cells(30, 7) = Application.VLookup(\"State1\", RangeA, 2, False)\n   .Cells(31, 7) = Application.VLookup(\"State2\", RangeA, 2, False)\n   .Cells(32, 7) = Application.VLookup(\"State3\", RangeA, 2, False)\n   .Cells(33, 7) = Application.VLookup(\"State4\", RangeA, 2, False)\n\nElse\n\n   .Cells(30, 7) = 0\n   .Cells(31, 7) = 0\n   .Cells(32, 7) = 0\n   .Cells(33, 7) = 0\n\nEnd If\n\nOn Error Resume Next\nx = Lookup_Range.Find(\"10 - 19 days\", range(\"A1\"), xlValues, xlWhole, xlByColumns, xlNext).Row\n\nSet RangeA = .range(.Cells(x, 1), .Cells(x + 4, 2))\n\nIf Not x &lt;&gt; \"\" Then\n\n   .Cells(34, 7) = Application.VLookup(\"State1\", RangeA, 2, False)\n   .Cells(35, 7) = Application.VLookup(\"State2\", RangeA, 2, False)\n   .Cells(36, 7) = Application.VLookup(\"State3\", RangeA, 2, False)\n   .Cells(37, 7) = Application.VLookup(\"State4\", RangeA, 2, False)\n\nElse\n\n.Cells(34, 7) = 0\n.Cells(35, 7) = 0\n.Cells(36, 7) = 0\n.Cells(37, 7) = 0\n\nEnd If\n\nEnd With\n</code></pre>\n\n<p>It only returns the right values when the first condition of IF is fulfilled.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 11, "user_id": 7773617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f26f615081f369660439721bdd5c4e?s=128&d=identicon&r=PG&f=1", "display_name": "JooMa", "link": "https://stackoverflow.com/users/7773617/jooma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 581, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1493118457, "creation_date": 1490779967, "last_edit_date": 1493118457, "question_id": 43089655, "link": "https://stackoverflow.com/questions/43089655/excel-vba-find-match-and-copy-by-multiple-variables", "title": "Excel VBA: find, match and copy by multiple variables", "body": "<p>I\u2019m a total beginner what comes to VBA coding, so please bear with me. The problem at hand is that I need to create an \u201cautomated\u201d and easy to use report creation excel.</p>\n\n<p>I've tried different VLOOKUP, MATCH &amp; INDEX configurations etc. and nothing seems to work the way I need. I\u2019ve searched and searched for a solution, but all the answers seem to be so case specific that they only brush on my issue.</p>\n\n<blockquote>\n  <p>In short, I need a macro that can find, match and copy data rows <em>(by\n  date and product number)</em> from a workbook <em>(located in a specific\n  <strong>source folder</strong>)</em> to a new worksheet and/or workbook and save it named\n  as the search criteria <em>(like \u201cproductno 1-1-2017_31-1-2017.xlsx\u201d)</em></p>\n</blockquote>\n\n<p>E.g. I could search all the entries for \u201cProductABC\u201d between 1.1.2017 and 31.1.2017 and save the data as a new separate report file.</p>\n\n<p>Products and product numbers are being stored to a sub sheet \u201cProduct list\u201d in the report creation workbook.</p>\n\n<p><strong>Source folder</strong> has reports sorted by year: \u201c\u2026\\Products\\Reports\\2017.xlsx\u201d And report data is being displayed like this:</p>\n\n<pre><code>      A           B             C           D            E\n1     Productno   Product       Attribute   Date         Time\n2     123456      ProductABC    1,05        1.1.2017     10:30\n3     654321      ProductCBA    1,10        1.1.2017     14:01\n4     999999      ProductXYZ    1,15        3.1.2017     09:17\n</code></pre>\n\n<p>Report creation sheet looks roughly something like this:</p>\n\n<pre><code>       A                 B\n1      Create Report\n2      Starting date:    d/m/yyyy\n3      End date:         d/m/yyyy\n4      Product:          Dropdown list\n5                        Search product data button\n6                        Create report button\n</code></pre>\n\n<p>Among bunch of other failed experiments, I found this snippet of code online and tried to fiddle around with it for it to suit my needs. I know it\u2019s not complete and probably not even close to what I need, but this is as far as I got with it:</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\nDim Source As Workbook\nDim Target As Workbook\nDim NewSh As Worksheet\n\n'## Open both workbooks first:\nSet Source = Workbooks.Open(ThisWorkbook.Path &amp; \"\\2016\")\nSet Target = Workbooks.Open(ThisWorkbook.Path &amp; \"\\New_report\")\nSet NewSh = Worksheets.Add\n\n    Dim FindString As String\n    Dim Rng As Range\n    Workbooks(\"Create_report\").Activate\n    FindString = Sheets(\"Functions\").Range(\"C2\").Value\n    If Trim(FindString) &lt;&gt; \"\" Then\n        Workbooks(\"2016\").Activate\n        With Sheets(\"Sheet1\").Range(\"A:A\")\n            Set Rng = .Find(What:=FindString, _\n                            After:=.Cells(.Cells.Count), _\n                            LookIn:=xlValues, _\n                            LookAt:=xlWhole, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlNext, _\n                            MatchCase:=False)\n            If Not Rng Is Nothing Then\n                Application.Goto Rng, True\n            Rng.Copy Target.Range(\"A\" &amp; Rcount)    \n            Else\n                MsgBox \"No products found!\"\n            End If\n        End With\n    End If\n\n'Save Target worksheet changes:\nTarget.SaveAs (ThisWorkbook.Path &amp; \"\\New report 1\")\n\n\u2018Close workbooks\nSource.Close\nTarget.Close\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<h1><strong>!!! UPDATE !!!</strong></h1>\n\n<p>I've made some progress with my code, here's the newest edition:</p>\n\n<pre><code>Sub Etsiva_click()\n\n    'Optimazation\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n\n'Dimensions and definitions\n    'Source folder etc.\n    Dim FolderPath As String, FileName As String\n    FolderPath = \"C:\\Users\\MYUSERNAME\\Documents\\Projects\\Excel\\Tests\\Data\\\"\n    FileName = Dir(FolderPath &amp; \"*.xl*\")\n\n    'Workbooks and sheets\n    Dim WorkBk As Workbook\n\n    Dim wbok1 As Workbook\n    Set wbok1 = ThisWorkbook\n\n    Dim WSS As Sheets\n    Set WSS = wbok1.Worksheets\n\n    Dim DemPest As Worksheet\n    Set DemPest = WSS(\"Temp\")\n\n    Dim ACtion As Worksheet\n    Set ACtion = WSS(\"Functions\")\n\n    Dim nRows As Long, LastRow As Long\n    Dim CurYear As Date, StartDate As Date, EndDate As Date\n    Dim ProDuct As String\n\n    'Count last row for product and date columns\n    LastRow = Cells(Rows.Count, 1).End(xlUp).Row And Cells(Rows.Count, 4).End(xlUp).Row\n\n    'Starting row\n    nRows = 3\n\n    'Search variables\n    StartDate = ACtion.Range(\"A2\").Value\n    EndDate = ACtion.Range(\"A3\").Value\n    ProDuct = ACtion.Range(\"A4\").Value\n\n    'Empty \"Temp\" sheet before pasting new data\n    DemPest.Range(\"2:7\").ClearContents\n\n'THE Code\n    'Loop folder/files\n    Do While FileName &lt;&gt; \"\"\n        'Open a workbook in the folder\n        Set WorkBk = Workbooks.Open(FolderPath &amp; FileName)\n     'Inner loop (below) does the copy/pasting\n        Do\n            If WorkBk.Worksheets(\"Sheet1\").Cells(nRows, 4).Value &lt; EndDate And WorkBk.Worksheets(\"Sheet1\").Cells(nRows, 4) &gt; StartDate And WorkBk.Worksheets(\"Sheet1\").Cells(nRows, 1) = ProDuct Then\n                DemPest.Cells(nRows, 1).Value = WorkBk.Worksheets(\"Sheet1\").Cells(nRows, 1).Value   'Product number\n                DemPest.Cells(nRows, 2).Value = WorkBk.Worksheets(\"Sheet1\").Cells(nRows, 2).Value   'Product\n                DemPest.Cells(nRows, 3).Value = WorkBk.Worksheets(\"Sheet1\").Cells(nRows, 3).Value   'Data\n                DemPest.Cells(nRows, 4).Value = WorkBk.Worksheets(\"Sheet1\").Cells(nRows, 4).Value   'Date\n                DemPest.Cells(nRows, 5).Value = WorkBk.Worksheets(\"Sheet1\").Cells(nRows, 5).Value   'Time\n                DemPest.Columns(\"A:A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete      'Delete empty rows\n            End If\n            nRows = nRows + 1\n        Loop Until nRows = LastRow + 1\n\n        'Close the source workbook without saving changes.\n        WorkBk.Close savechanges:=False\n\n        'Use Dir to get the next file name.\n        FileName = Dir()\n    Loop\n\n    'Optimization off\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The copy part of this snippet works within one workbook/sheets, but there's been no luck when I've tried to expand it over multiple workbooks. Please help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490780368, "post_id": 43089484, "comment_id": 73261156, "body": "Why don&#39;t you just put into the output column <code>Name</code> the formula <code>=LastName&amp;&quot;, &quot;&amp;FirstName</code> and in the age column you can use <code>=Age</code> (from the column further to the left)."}, {"owner": {"reputation": 601, "user_id": 6644975, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-oYqlkA6i_dI/AAAAAAAAAAI/AAAAAAAAAKM/GW7Fbgs0GqA/photo.jpg?sz=128", "display_name": "Sean Reyes", "link": "https://stackoverflow.com/users/6644975/sean-reyes"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490780671, "post_id": 43089484, "comment_id": 73261359, "body": "@Ralph let us say that I&#39;m not the one who inputs this data, I&#39;m just here to compare this data."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 7070633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713a1c8ea9547c528548aaa5694d5bd8?s=128&d=identicon&r=PG&f=1", "display_name": "JoseS", "link": "https://stackoverflow.com/users/7070633/joses"}, "is_accepted": false, "score": 0, "last_activity_date": 1490780222, "creation_date": 1490780222, "answer_id": 43089760, "question_id": 43089484, "link": "https://stackoverflow.com/questions/43089484/compare-3-columns-in-excel-using-vba/43089760#43089760", "title": "Compare 3 Columns in Excel using VBA", "body": "<p>You can use this pseudocode to guide you:</p>\n\n<pre><code>If LASTNAME = Left(NAME,LASTNAME.Length) And _\nFIRSTNAME = Right(NAME,FIRSTNAME.Length) Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 601, "user_id": 6644975, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-oYqlkA6i_dI/AAAAAAAAAAI/AAAAAAAAAKM/GW7Fbgs0GqA/photo.jpg?sz=128", "display_name": "Sean Reyes", "link": "https://stackoverflow.com/users/6644975/sean-reyes"}, "edited": false, "score": 1, "creation_date": 1491025206, "post_id": 43104923, "comment_id": 73382961, "body": "this code isn&#39;t what I&#39;m looking for but the Idea is here, so yeah I got it. thanks by the way..I consider this the answer :) Thanks a lot"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1506018789, "last_edit_date": 1506018789, "creation_date": 1490824746, "answer_id": 43104923, "question_id": 43089484, "link": "https://stackoverflow.com/questions/43089484/compare-3-columns-in-excel-using-vba/43104923#43104923", "title": "Compare 3 Columns in Excel using VBA", "body": "<p>Work with a a simple Do Until Loop:</p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim B As Range, _\n        C As Range, _\n        D As Range, _\n        F As Range, _\n        G As Range\n\n    Dim i%, x% ' Dim as long\n\n    Set B = Columns(2)\n    Set C = Columns(3)\n    Set D = Columns(4)\n    Set F = Columns(6)\n    Set G = Columns(7)\n\n    i = 2\n    x = 2\n\n    Do Until IsEmpty(B.Cells(i))\n\n        Debug.Print B.Cells(i).Value &amp; \", \" &amp; _\n                    C.Cells(i).Value ' Print on Immed Win\n\n        Do Until IsEmpty(F.Cells(x))\n            DoEvents ' For testing\n\n            If F.Cells(x).Value = B.Cells(i).Value &amp; \", \" &amp; _\n                                  C.Cells(i).Value Then\n\n               Debug.Print F.Cells(i).Value = B.Cells(i).Value &amp; \", \" &amp; _\n                           C.Cells(i).Value ' Print on Immed Win\n\n                G.Cells(x) = D.Cells(i)\n                x = 2 ' Reset Loop\n                Exit Do\n            End If\n\n            x = x + 1\n        Loop\n\n        i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><em>Other info</em></p>\n\n<blockquote>\n  <p><em><sub>\n  <strong><a href=\"https://msdn.microsoft.com/en-us/library/aa262728(v=vs.60).aspx\" rel=\"nofollow noreferrer\">DoEvents</a></strong> is most useful for simple things like allowing a user to cancel a process after it has started, for example a search for a file. For long-running processes, yielding the processor is better accomplished by using a Timer or delegating the task to an ActiveX EXE component.. In the latter case, the task can continue completely independent of your application, and the operating system takes case of multitasking and time slicing.</sub></em></p>\n  \n  <hr>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><em><sub><strong><a href=\"https://msdn.microsoft.com/en-us/library/f177hahy.aspx\" rel=\"nofollow noreferrer\">Debug.Print Immediate Window</a></strong> is used to debug and evaluate expressions, execute statements, print variable values, and so forth. It allows you to enter expressions to be evaluated or executed by the development language during debugging. To display the Immediate window, open a project for editing, then choose Windows from the Debug menu and select Immediate, or press CTRL+ALT+I.</sub></em></p>\n</blockquote>\n"}], "owner": {"reputation": 601, "user_id": 6644975, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-oYqlkA6i_dI/AAAAAAAAAAI/AAAAAAAAAKM/GW7Fbgs0GqA/photo.jpg?sz=128", "display_name": "Sean Reyes", "link": "https://stackoverflow.com/users/6644975/sean-reyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1136, "favorite_count": 0, "accepted_answer_id": 43104923, "answer_count": 2, "score": 2, "last_activity_date": 1506018789, "creation_date": 1490779487, "last_edit_date": 1490823695, "question_id": 43089484, "link": "https://stackoverflow.com/questions/43089484/compare-3-columns-in-excel-using-vba", "title": "Compare 3 Columns in Excel using VBA", "body": "<p>I want to compare 2 to 1 Columns in Excel using VBA..</p>\n\n<p>I already achieve 2 to 2 Columns using this code </p>\n\n<pre><code>Sub LIST1_LIST2()\n    Dim list1 As Range\n    Dim LIST2 As Range\n    Set list1 = Range(\"B3:C181\")\n    Set LIST2 = Range(\"G3:H729\")\n\n    For Each row1 In list1.Rows\n        For Each row2 In LIST2.Rows\n          If (row1.Cells(1) = row2.Cells(1) And row1.Cells(2) = row2.Cells(2)) Then\n              row1.Cells(1).Offset(0, 2) = row1.Cells(1)\n              row1.Cells(2).Offset(0, 2) = row1.Cells(2)\n              Exit For\n          End If\n        Next row2\n\n    Next row1\n\nEnd Sub\n</code></pre>\n\n<p>But now I need something VBA scripts that works somehow like the image below\n<a href=\"https://i.stack.imgur.com/rg3Nh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rg3Nh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 2, "creation_date": 1490779411, "post_id": 43089128, "comment_id": 73260455, "body": "<code>.Send  &#39;Or use Display</code> ???"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 2, "creation_date": 1490780547, "post_id": 43089128, "comment_id": 73261286, "body": "@0m3r: Modern programmers attitude: Simply c &amp; p code, try it and be satisfied if &quot;it works&quot;, but in no way spend some time trying to understand how it works."}, {"owner": {"reputation": 53, "user_id": 6748714, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/658e976d4c48def9afa67d1b846ef87c?s=128&d=identicon&r=PG&f=1", "display_name": "gekko2670", "link": "https://stackoverflow.com/users/6748714/gekko2670"}, "edited": false, "score": 0, "creation_date": 1490789713, "post_id": 43089128, "comment_id": 73267498, "body": "thanks for your help, sorry!"}], "answers": [{"tags": [], "owner": {"reputation": 301, "user_id": 4551492, "user_type": "registered", "profile_image": "https://graph.facebook.com/1534368113/picture?type=large", "display_name": "Leonardo Atalla", "link": "https://stackoverflow.com/users/4551492/leonardo-atalla"}, "is_accepted": false, "score": -1, "last_activity_date": 1490778891, "creation_date": 1490778891, "answer_id": 43089249, "question_id": 43089128, "link": "https://stackoverflow.com/questions/43089128/vba-macro-outlook-generating-email/43089249#43089249", "title": "VBA macro outlook generating email", "body": "<p>Change </p>\n\n<p><code>.Send</code></p>\n\n<p>to </p>\n\n<p><code>.Display</code></p>\n\n<p>inside the <code>With OutMail</code> block.</p>\n\n<p>In this way the email will be generated, displayed, but not sent, waiting for you to click send</p>\n"}], "owner": {"reputation": 53, "user_id": 6748714, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/658e976d4c48def9afa67d1b846ef87c?s=128&d=identicon&r=PG&f=1", "display_name": "gekko2670", "link": "https://stackoverflow.com/users/6748714/gekko2670"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1490779129, "creation_date": 1490778566, "last_edit_date": 1490779129, "question_id": 43089128, "link": "https://stackoverflow.com/questions/43089128/vba-macro-outlook-generating-email", "title": "VBA macro outlook generating email", "body": "<p>I have the below code, which send an outlook email by grabbing data from my Excel sheet. </p>\n\n<p>This email is sent automatically as soon as I click the button to allow access to my email. </p>\n\n<p>I would like to change this so that the email is generated and I have to physically press send on each email before it is sent. </p>\n\n<p>Can someone please help as to how I need to change the code to do this, code below,</p>\n\n<pre><code>Sub Mail_Selection_Range_Outlook_Body()\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n'Don't forget to copy the function RangetoHTML in the module.\n'Working in Excel 2000-2016\n    Dim rng As Range\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim cell As Range\n    Dim StrBody As String\n\n    Set rng = Nothing\n    On Error Resume Next\n    'Only the visible cells in the selection\n    Set rng = Selection.SpecialCells(xlCellTypeVisible)\n    'You can also use a fixed range if you want\n    Set rng = Range(\"ZCCollar\").SpecialCells(xlCellTypeVisible)\n\n    On Error GoTo 0\n\n    If rng Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n               vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n        Exit Sub\n    End If\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n\n     StrBody = Sheets(\"MailInfo\").Range(\"E1\").Value &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n              Sheets(\"MailInfo\").Range(\"E2\").Value &amp; \"&lt;br&gt;\" &amp; _\n              Sheets(\"MailInfo\").Range(\"E3\").Value\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\nOn Error Resume Next\nFor Each cell In Sheets(\"MailInfo\").Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value Like \"?*@?*.?*\" And _\n       LCase(Cells(cell.Row, \"C\").Value) = \"yes\" Then\n\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n        With OutMail\n            .To = cell.Value\n            .Subject = \"Index Option RFQ\"\n\n\n            .HTMLBody = StrBody &amp; RangetoHTML(rng) &amp; \"&lt;br&gt;\" &amp; \"Thanks\"\n\n\n\n            'You can add files also like this\n            '.Attachments.Add (\"C:\\test.txt\")\n            .Send  'Or use Display\n        End With\n        On Error GoTo 0\n        Set OutMail = Nothing\n    End If\nNext cell\n\n\n\n\n\n\n\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n\n\nFunction RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2016\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    'Read all data from the htm file into RangetoHTML\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    'Close TempWB\n    TempWB.Close savechanges:=False\n\n    'Delete the htm file we used in this function\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "module", "intersection"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 5, "creation_date": 1490778039, "post_id": 43088873, "comment_id": 73259496, "body": "What exactly does &quot;not working&quot; mean?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 3, "creation_date": 1490779070, "post_id": 43088873, "comment_id": 73260241, "body": "To further investigate the problem you might want to remove <code>On Error GoTo bm_Safe_Exit</code>. Also, you might want to include a <code>Case Else</code> into your code to catch possible errors or problematic cases: <a href=\"https://msdn.microsoft.com/en-us/library/cy37t14y.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/cy37t14y.aspx</a>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490783528, "post_id": 43088873, "comment_id": 73263241, "body": "Out of curiousity, why are you looking at <code>Range(&quot;C2&quot;).Value2</code> , and not <code>Range(&quot;C2&quot;).Value</code> ?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490820654, "post_id": 43088873, "comment_id": 73289383, "body": "@ShaiRado Some people believe that there might be a small speed benefit (compared to <code>.Value</code>) because it does not require the additional overhead of <i>format conversion</i>. Anyhow, we both know that <code>.Value2</code> should be the default and not <code>.Value</code> and since <code>C2</code> does not contain a date nor a currency it doesn&#39;t matter either way."}], "answers": [{"comments": [{"owner": {"reputation": 657, "user_id": 5994620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjudG.jpg?s=128&g=1", "display_name": "BerticusMaximus", "link": "https://stackoverflow.com/users/5994620/berticusmaximus"}, "edited": false, "score": 1, "creation_date": 1490801788, "post_id": 43089360, "comment_id": 73277482, "body": "Using .Range it could be completed in one line <code>.Range(&quot;......&quot;).EntireColumn.Hidden = True</code>"}], "tags": [], "owner": {"reputation": 41, "user_id": 7784048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865886e0646d0828b24f74ac42b810f0?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7784048/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1490784006, "last_edit_date": 1490784006, "creation_date": 1490779148, "answer_id": 43089360, "question_id": 43088873, "link": "https://stackoverflow.com/questions/43088873/select-case-vba-not-working/43089360#43089360", "title": "Select Case VBA not working", "body": "<p>When I tried</p>\n\n<pre><code>Columns(\"AQ:DC,DR:GD,GS:JE\").Hidden = True\n</code></pre>\n\n<p>I get an error (Type mismatch), so try to split the hide commands like this: </p>\n\n<pre><code>Columns(\"AQ:DC\").Hidden = True\nColumns(\"DR:GD\").Hidden = True\nColumns(\"GS:JE\").Hidden = True\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490784006, "creation_date": 1490777881, "last_edit_date": 1531164843, "question_id": 43088873, "link": "https://stackoverflow.com/questions/43088873/select-case-vba-not-working", "title": "Select Case VBA not working", "body": "<p>I have the below code which I wish to hide columns based on the case. However it is not working. I suspect it may be to do with the groupings and layout of the sheet however have never come across an issue when using this code before. </p>\n\n<pre><code>Private Sub worksheet_Change(ByVal Target As Range)\n  If Not Intersect(Target, Range(\"C2\")) Is Nothing Then\n    On Error GoTo bm_Safe_Exit\n    ActiveSheet.Unprotect Password:=\"Password\"\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Columns(\"AD:JF\").Hidden = False\n\n    Select Case Range(\"C2\").Value2\n        Case 1\n            Columns(\"AQ:DC,DR:GD,GS:JE\").Hidden = True\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=3\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=2\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=1\n        Case 2\n            Columns(\"BD:DC,EE:GD,HF:JE\").Hidden = True\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=3\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=2\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=1\n        Case 3\n            Columns(\"BQ:DC,ER:GD,HS:JE\").Hidden = True\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=3\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=2\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=1\n        Case 4\n            Columns(\"CD:DC,FE:GD,IF:JE\").Hidden = True\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=3\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=2\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=1\n        Case 5\n            Columns(\"CQ:DC,FR:GD,IS:JE\").Hidden = True\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=3\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=2\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=1\n        Case 6\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=3\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=2\n            ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=1\n    End Select\nEnd If\n\nbm_Safe_Exit:\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nActiveSheet.Protect Password:=\"password\"\n\nEnd Sub\n</code></pre>\n\n<p>Picture included of spreadsheet layout\n<a href=\"https://i.stack.imgur.com/HxdKy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HxdKy.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490778873, "post_id": 43088858, "comment_id": 73260108, "body": "Here is a post which is quite recent and gets you to open your text file: <a href=\"http://stackoverflow.com/questions/43088103/line-input-error-excel-vba\" title=\"line input error excel vba\">stackoverflow.com/questions/43088103/line-input-error-excel-&zwnj;&#8203;vba</a> Each line of text will be pulled into the string variable <code>textline</code>. Then you can check the length of the string with <code>Len(textline)</code> if it is greater than 20 and check with <code>InStr</code> if there are any quotation marks in there to remove. Yet, I am not sure what you want to do once the quotation marks are gone. Do you want to write back to the text file or put it into an Excel sheet?"}, {"owner": {"reputation": 520, "user_id": 1199443, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/27372d76e2ce94ae12dd3ecc3b2d9a3f?s=128&d=identicon&r=PG", "display_name": "davidjwest", "link": "https://stackoverflow.com/users/1199443/davidjwest"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490779044, "post_id": 43088858, "comment_id": 73260219, "body": "Thanks, I just want to remove the quotes so leave everything else as-is."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1490779180, "post_id": 43088858, "comment_id": 73260310, "body": "Do you have some example data for us to use?"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1490779459, "post_id": 43088858, "comment_id": 73260482, "body": "we would need to an example of the text"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1490781720, "post_id": 43088858, "comment_id": 73262047, "body": "so is the text always so structured? You can do a left until the first quote, then a right from the second quote and a mid for the text within the quote. essentially left&amp;mid&amp;right, while removing the quotes."}], "answers": [{"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 2, "last_activity_date": 1490783369, "creation_date": 1490783369, "answer_id": 43091001, "question_id": 43088858, "link": "https://stackoverflow.com/questions/43088858/remove-first-two-quotes-from-lines-more-than-20-characters-long/43091001#43091001", "title": "Remove first two quotes from lines more than 20 characters long", "body": "<p>Something like this will go through Column A and use a variant array to remove the first two <code>\"</code> in strings longer than 20 characters.</p>\n\n<p>The code dumps the updated strings to Column B.</p>\n\n<pre><code>Sub CrankyKohli()\nDim rng1 As Range\nDim lngCnt As Long\nDim x\n\nSet rng1 = Range([a1], Cells(Rows.Count, \"A\").End(xlUp))\nx = rng1.Value\n\nFor lngCnt = 1 To UBound(x)\n    If Len(x(lngCnt, 1)) &gt; 20 Then x(lngCnt, 1) = Replace(x(lngCnt, 1), \"\"\"\", vbNullString, , 2)\nNext\n\nrng1.Offset(0, 1) = x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 520, "user_id": 1199443, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/27372d76e2ce94ae12dd3ecc3b2d9a3f?s=128&d=identicon&r=PG", "display_name": "davidjwest", "link": "https://stackoverflow.com/users/1199443/davidjwest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 43091001, "answer_count": 1, "score": 2, "last_activity_date": 1490783369, "creation_date": 1490777842, "last_edit_date": 1490780201, "question_id": 43088858, "link": "https://stackoverflow.com/questions/43088858/remove-first-two-quotes-from-lines-more-than-20-characters-long", "title": "Remove first two quotes from lines more than 20 characters long", "body": "<p>I've not written any VBA for a few years so am rusty and would apprecite some help.</p>\n\n<p>I have a file with around 9k lines of text, I need a script that will go through and remove the first two quotation marks from any rows with more than 20 characters.</p>\n\n<p>How can I do that?</p>\n\n<p>Update:</p>\n\n<p>I have this that picks out the rows with more than 20 chars but not sure how to remove the first two quotes:</p>\n\n<pre><code>Sub Sanitise()\n\nDim sh As Worksheet\nDim rw As Range\n\nRowCount = 0\n\nSet sh = ActiveSheet\nFor Each rw In sh.Rows\n\n    If Len(sh.Cells(rw.Row, 1).Value) &gt; 20 Then\n    ' Need to remove the first two quotes\n    End If\n\nNext rw\n\nEnd Sub\n</code></pre>\n\n<p>Data:</p>\n\n<blockquote>\n  <p>A00,408,\"UXS\",201309,10X641,00110 U02,99400,\"200X601\",\"E\",\"N\",\"38418\",\"       064X09\",\"00\",\"\",\"\",\"\",\"\",\"\n  \",\"\",\"\",\"E\",\"\",\"\" S72,\"MXRE0042\" S72,\"MRE0047\" S72,\"MRE0047\"\n  U02,7514100,\"201613\",\"E\",\"N\",\"66620\",\"<br>\n  21011X\",\"00\",\"\",\"\",\"\",\"\",\"  \",\"\",\"\",\"E\",\"\",\"\" S72,\"MRE00432\"\n  S72,\"MRE00457\" S72,\"MRE00417\" U02,7513770602,\"20X12\",\"E\",\"N\",\"40761\",\"\n  12775X\",\"00\",\"\",\"\",\"\",\"\",\"  \",\"\",\"\",\"E\",\"\",\"\" S72,\"MRE00432\"\n  S72,\"MRE00X47\" S72,\"MRE004X7\"</p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "wireshark"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490777904, "post_id": 43088707, "comment_id": 73259405, "body": "If SeqN is always the last group of numbers you could extract into another column and then do a pivot table showing min and max time and calculate the difference."}], "owner": {"reputation": 33, "user_id": 7784480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad3073acb60f1cb90b307106cdfd74ab?s=128&d=identicon&r=PG&f=1", "display_name": "HGod", "link": "https://stackoverflow.com/users/7784480/hgod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1490849285, "creation_date": 1490777447, "last_edit_date": 1490781261, "question_id": 43088707, "link": "https://stackoverflow.com/questions/43088707/excel-calculate-time-difference-based-on-max-and-min-values-in-other-cells", "title": "Excel: Calculate time difference based on max and min values in other cells", "body": "<p>I have an excel document based on a Wireshark extract that looks like this:</p>\n\n<pre><code>|No.|Time |Source  |Destination|Protocol|Length|Info                      | \n|1  |1.111|10.1.1.1|10.1.1.2   |UDP     |12    |Blah 11 blah blah SeqN: 13|  \n|2  |7.456|10.1.1.2|10.1.1.1   |UDP     |12    |Blah 11 blah blah SeqN: 13|  \n|3  |8.426|10.1.1.1|10.1.1.2   |UDP     |12    |Blah 11 blah blah SeqN: 14|  \n|4  |9.356|10.1.1.2|10.1.1.1   |UDP     |12    |Blah 11 blah blah SeqN: 13|  \n|5  |17.45|10.1.1.2|10.1.1.1   |UDP     |12    |Blah 11 blah blah SeqN: 14|  \n|6  |18.46|10.1.1.1|10.1.1.2   |UDP     |12    |Blah 11 blah blah SeqN: 14|    \n|7  |27.56|10.1.1.1|10.1.1.2   |UDP     |12    |Blah 11 blah blah SeqN: 15|  \n</code></pre>\n\n<p>I have extracted the SeqN using a VBA script using RegEX , SeqN can cover 2-6 lines. What I want to do is determine the cycle time. That is the difference in time between the earliest and latest entry for a given SeqN for the first and last entry for a given SeqN (Which can be between 0 and 255).</p>\n\n<p>I'm just not sure how to approach selecting the time variable based on identical entries in another cell.  </p>\n\n<p>This is what I am hoping for, SeqN I get using the below script and then an additional column CycleTime</p>\n\n<p>Example output:</p>\n\n<pre><code>  SeqN     CycleTime\n SeqN:13     8.245          (or 9.356-1.111)\n</code></pre>\n\n<p>My script for extracting SeqN:</p>\n\n<hr>\n\n<pre><code>Sub GetLastDigits()\n    Dim Entries As Range, entry As Range\n    Dim RegEx As Object, Matches As Object, Match As Object\n\n    Set Entries = Range(\"G2:G1029\")\n    Set RegEx = CreateObject(\"vbscript.regexp\")\n\n    With RegEx\n        .MultiLine = False\n        .Global = True\n        .IgnoreCase = True\n        .Pattern = \"SeqN: \\d+\"\n    End With\n\n    For Each entry In Entries\n        Set Matches = RegEx.Execute(entry)\n        If VBA.Left(Matches(Matches.Count - 1), 1) = 0 Then\n            entry.Offset(0, 1) = VBA.Right(Matches(Matches.Count - 1), Len(Matches(Matches.Count - 1)) - 1)\n        Else\n            entry.Offset(0, 1) = Matches(Matches.Count - 1)\n        End If\n    Next entry\nEnd Sub\n</code></pre>\n\n<hr>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 10397, "user_id": 2144048, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1WlzH.jpg?s=128&g=1", "display_name": "JohnHC", "link": "https://stackoverflow.com/users/2144048/johnhc"}, "edited": false, "score": 0, "creation_date": 1490777255, "post_id": 43088570, "comment_id": 73258964, "body": "<code>IntervaloDias</code> vs <code>DayInterval</code>... Is this in your code or just an error putting the question up?"}, {"owner": {"reputation": 175, "user_id": 3993827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4fe8aa4f7628700a6ed3942dd6ffebdd?s=128&d=identicon&r=PG&f=1", "display_name": "Vitor Barreto", "link": "https://stackoverflow.com/users/3993827/vitor-barreto"}, "reply_to_user": {"reputation": 10397, "user_id": 2144048, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1WlzH.jpg?s=128&g=1", "display_name": "JohnHC", "link": "https://stackoverflow.com/users/2144048/johnhc"}, "edited": false, "score": 0, "creation_date": 1490777411, "post_id": 43088570, "comment_id": 73259081, "body": "An error. Already corrected it. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1490798134, "post_id": 43088740, "comment_id": 73274494, "body": "DateValue(DueDate) would return a date in the same local regional settings, intrigued as to why would you use Date Serial?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 1, "creation_date": 1490798728, "post_id": 43088740, "comment_id": 73275011, "body": "It was to keep the style - and we might only see a snippet. But you are right, as is, DateSerial here is superfluous."}, {"owner": {"reputation": 175, "user_id": 3993827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4fe8aa4f7628700a6ed3942dd6ffebdd?s=128&d=identicon&r=PG&f=1", "display_name": "Vitor Barreto", "link": "https://stackoverflow.com/users/3993827/vitor-barreto"}, "edited": false, "score": 0, "creation_date": 1490871194, "post_id": 43088740, "comment_id": 73310772, "body": "Both work (and thanks for the feedback), but my problem is not getting any results when running the function in SQL code, because no results appear."}, {"owner": {"reputation": 175, "user_id": 3993827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4fe8aa4f7628700a6ed3942dd6ffebdd?s=128&d=identicon&r=PG&f=1", "display_name": "Vitor Barreto", "link": "https://stackoverflow.com/users/3993827/vitor-barreto"}, "edited": false, "score": 0, "creation_date": 1490874031, "post_id": 43088740, "comment_id": 73312792, "body": "Already solved it. I was missing this at the end of the function: DayInterval = DueDate"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1490798793, "last_edit_date": 1490798793, "creation_date": 1490777523, "answer_id": 43088740, "question_id": 43088570, "link": "https://stackoverflow.com/questions/43088570/access-vba-function-doesnt-return-any-value-on-query/43088740#43088740", "title": "Access VBA Function doesn&#39;t return any value on query", "body": "<p>You must use a true date value:</p>\n\n<pre><code>ConvertDate = DateSerial(Year(DateValue(DueDate)), Month(DateValue(DueDate)), Day(DateValue(DueDate)))\n</code></pre>\n\n<p>Or just (see Minty's comment):</p>\n\n<pre><code>ConvertDate = DateValue(DueDate)\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 3993827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4fe8aa4f7628700a6ed3942dd6ffebdd?s=128&d=identicon&r=PG&f=1", "display_name": "Vitor Barreto", "link": "https://stackoverflow.com/users/3993827/vitor-barreto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 43088740, "answer_count": 1, "score": 0, "last_activity_date": 1490947930, "creation_date": 1490777076, "last_edit_date": 1490947930, "question_id": 43088570, "link": "https://stackoverflow.com/questions/43088570/access-vba-function-doesnt-return-any-value-on-query", "title": "Access VBA Function doesn&#39;t return any value on query", "body": "<p>I have the following Access VBA Module (which returns info as needed as i tested it via Debug.Print), i then use it the following way in the SQL code.</p>\n\n<pre><code>Public Function DayInterval(DueDate As String) As String\nDim Today As Date\nDim ConvertData As Date\n\nToday = Date\nConvertDate = DateSerial(Year(DueDate), Month(DueDate), Day(DueDate))\n\nSelect Case DateDiff(\"d\", ConvertDate, Today)\n    Case 1 To 10\n      DueDate = \"0-10\"\n    Case 11 To 30\n      DueDate = \"11-30\"\n    Case 31 To 60\n      DueDate = \"31-60\"\n    Case 61 To 90\n      DueDate = \"61-90\"\n   Case 91 To 180\n      DueDate = \"91-180\"\n   Case 181 To 365\n      DueDate = \"181-365\"\n   Case 366 To 540\n      DueDate = \"366-540\"\n   Case 541 To 730\n      DueDate = \"541-730\"\n   Case Else\n      DueDate = \"&gt;730\"\nEnd Select\n\nDayInterval = DueDate \n\nEnd Function\n\nSELECT \nDueDate AS [Date], \nDayInterval([DUE_DATE]) AS [Interval]\nFROM Invoices;\n</code></pre>\n\n<p>The problem is that when i run the above query, i get no results.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9fmGK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9fmGK.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any light on why this happens?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1490776388, "post_id": 43088103, "comment_id": 73258387, "body": "It seems strange that the IDE hasn&#39;t inserted a space in between <code>#1,</code> and <code>textline</code>.  The code as posted compiles for me, so perhaps there is an unprintable character on that line which has disappeared as you posted it here.  Try deleting the line (and perhaps the next line) and retyping it.  Maybe the line includes actual tab characters at the start - that might explain the strange indentation."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490776453, "post_id": 43088103, "comment_id": 73258427, "body": "You only need <code>myFile = &quot;E:\\output.txt&quot;</code> <b>OR</b> <code>myFile = Application.GetOpenFilename()</code> but not both. And this code works. If you still get an error please say what error you get."}, {"owner": {"reputation": 1, "user_id": 7762737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f974a63a39165a2aabeb41729f83daf4?s=128&d=identicon&r=PG&f=1", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/7762737/claudiu"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1490776966, "post_id": 43088103, "comment_id": 73258753, "body": "@YowE3K  , I deleted that line and wrote it again and it worked! Thank you very much!"}], "owner": {"reputation": 1, "user_id": 7762737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f974a63a39165a2aabeb41729f83daf4?s=128&d=identicon&r=PG&f=1", "display_name": "Claudiu", "link": "https://stackoverflow.com/users/7762737/claudiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 497, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490775668, "creation_date": 1490775668, "last_edit_date": 1531164843, "question_id": 43088103, "link": "https://stackoverflow.com/questions/43088103/line-input-error-excel-vba", "title": "Line Input error excel VBA", "body": "<p>I'm having this compile error : \"Expected: End of statement\" and I just don't understand why\nThe code:</p>\n\n<pre><code>Private Sub CommandButton8_Click()\nDim myFile As String, text As String, textline As String, posLat As Integer, posLong As Integer\nmyFile = \"E:\\output.txt\"\nmyFile = Application.GetOpenFilename()\nOpen myFile For Input As #1\nDo Until EOF(1)\n\u00a0\u00a0\u00a0\u00a0   Line Input #1,textline\n   text = text &amp; textline\nLoop\nClose #1\n\nEnd Sub\n</code></pre>\n\n<p>The error is at line \"Line Input #1,textline\"\nCan anybody help me, please?</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490777045, "post_id": 43088407, "comment_id": 73258809, "body": "You should read his question. This was not what he asked for."}], "tags": [], "owner": {"reputation": 1, "user_id": 7779268, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gcec1-wukec/AAAAAAAAAAI/AAAAAAAAABc/CBVyqNhFjiI/photo.jpg?sz=128", "display_name": "Jorge Molina", "link": "https://stackoverflow.com/users/7779268/jorge-molina"}, "is_accepted": false, "score": -1, "last_activity_date": 1490776594, "creation_date": 1490776594, "answer_id": 43088407, "question_id": 43087818, "link": "https://stackoverflow.com/questions/43087818/how-to-display-desired-text-in-hyperlink-using-vba-code/43088407#43088407", "title": "How to display desired text in hyperlink using VBA code", "body": "<p>If you have </p>\n\n<blockquote>\n  <p>\\maroon\\cgm images\\mech.pdf</p>\n</blockquote>\n\n<p>in a cell and you wanna get only the name of the pdf with \".pdf\" you can do the next code:</p>\n\n<pre><code>Dim spliter() as String\nDim str_pdf as String\n\nstr = \\maroon\\cgm images\\mech.pdf ' Cells(a,b).value\nspliter = Split(str, \" \") 'To do the first split (You can delete ', \" \"' )\nspliter = Split(spliter(1), \"\\\")\n'Now spliter(1) == mech.pdf so...\nstr_pdf = spliter(1) ' spliter(0) == images , spliter(1) == mech.pdf\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1490777304, "last_edit_date": 1490777304, "creation_date": 1490776994, "answer_id": 43088544, "question_id": 43087818, "link": "https://stackoverflow.com/questions/43087818/how-to-display-desired-text-in-hyperlink-using-vba-code/43088544#43088544", "title": "How to display desired text in hyperlink using VBA code", "body": "<p>You need to specify <code>TextToDisplay</code></p>\n\n<pre><code>ActiveSheet.Hyperlinks.Add Anchor:=Range(\"e\" &amp; i), Address:=Str, TextToDisplay:=pn &amp; \".pdf\"\n</code></pre>\n\n<p>Sometimes the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee861528.aspx\" rel=\"nofollow noreferrer\">Excel VBA reference</a> is indeed helpful to find out on your own how functions and methods work: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822490(v=office.15).aspx\" rel=\"nofollow noreferrer\">Hyperlinks.Add Method (Excel)</a></p>\n"}], "owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4647, "favorite_count": 1, "accepted_answer_id": 43088544, "answer_count": 2, "score": 0, "last_activity_date": 1490777304, "creation_date": 1490774831, "last_edit_date": 1490776638, "question_id": 43087818, "link": "https://stackoverflow.com/questions/43087818/how-to-display-desired-text-in-hyperlink-using-vba-code", "title": "How to display desired text in hyperlink using VBA code", "body": "<p>I have displayed my hyperlink in the column E as shown\n<code>\\\\maroon\\cgm images\\mech.pdf</code></p>\n\n<p>But I want to display only <code>mech.pdf</code> in the cell how to modify my code.</p>\n\n<p>my code used for displaying above hyperlink is shown below:</p>\n\n<pre><code>str = \"\\\\maroon\\CGM Images\\\" &amp; pn &amp; \".pdf\"\nActiveSheet.Hyperlinks.Add Range(\"e\" &amp; i), str\n</code></pre>\n\n<p>In this I want to show only <code>pn</code> &amp; <code>str</code>.</p>\n"}, {"tags": ["excel", "image", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7784264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24560060a1599d023030409718e420d?s=128&d=identicon&r=PG&f=1", "display_name": "Agata Powalka", "link": "https://stackoverflow.com/users/7784264/agata-powalka"}, "edited": false, "score": 0, "creation_date": 1490853156, "post_id": 43087796, "comment_id": 73299365, "body": "unfortunately problem occurs during saving not closing the file."}], "tags": [], "owner": {"reputation": 51, "user_id": 4543830, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb341b906a4e036583bff1b82585bf14?s=128&d=identicon&r=PG&f=1", "display_name": "Dinesh", "link": "https://stackoverflow.com/users/4543830/dinesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1490774735, "creation_date": 1490774735, "answer_id": 43087796, "question_id": 43087341, "link": "https://stackoverflow.com/questions/43087341/excel-2016-on-mac-missing-pictures-after-save/43087796#43087796", "title": "Excel 2016 on MAC missing pictures after save", "body": "<p>I'm not sure whether it helps, But you can give a try</p>\n\n<p>Try using Workbook_BeforeClose event.</p>\n\n<p>or else try to acheive the same using your code like switching to the sheet whatever you need </p>\n\n<p>Sheets(\"activesheet\").Select</p>\n"}], "owner": {"reputation": 11, "user_id": 7784264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24560060a1599d023030409718e420d?s=128&d=identicon&r=PG&f=1", "display_name": "Agata Powalka", "link": "https://stackoverflow.com/users/7784264/agata-powalka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490774735, "creation_date": 1490773342, "question_id": 43087341, "link": "https://stackoverflow.com/questions/43087341/excel-2016-on-mac-missing-pictures-after-save", "title": "Excel 2016 on MAC missing pictures after save", "body": "<p>I have an application created on Excel file with macros. It needs to be compatible with all Excel versions starting from 2007, both PC and MAC.</p>\n\n<p>I have problem with pictures on MAC 2016. Whenever I save file, close it and reopen again I can't see pictures on the sheet which was active one during saving. Do anyone know what the problem is and how to deal with it?</p>\n\n<p>My end users are not experienced enough and they get panicked if they can't see proper buttons...</p>\n\n<p>My solution is to change active sheet using Workbook_BeforeSave event, but on MAC 2016 version I can't get back, because Workbook_AfterSave event doesn't work at all. As you can imagine it is not very convenient for end user to change active sheet when you just want to save your work.</p>\n\n<p>I will be very grateful for any suggestion.</p>\n"}, {"tags": ["arrays", "vba", "excel", "loops"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490779344, "post_id": 43087037, "comment_id": 73260413, "body": "I just realized that you have already found / accepted an answer. So, there is no point on me updating my answer."}, {"owner": {"reputation": 25, "user_id": 7084869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e35daf9c1e6bade28455f0d7864931?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas HD", "link": "https://stackoverflow.com/users/7084869/andreas-hd"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490782821, "post_id": 43087037, "comment_id": 73262749, "body": "Your post was very informative - a great resource. Shouldn&#39;t be removed"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490789194, "post_id": 43087037, "comment_id": 73267109, "body": "My mind works pretty simple: you like one of my posts <code>--&gt;</code> you up-vote it (to show your appreciation) and the post stays. No up-votes tells me that my post is of no use and it gets removed. Simple. Just upon some rare occasions I still leave my post around whenever I want to keep them as a personal note. So, next time you like a post on this site just make sure you up-vote it and I&#39;m pretty sure the post will not get removed."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1490776350, "post_id": 43087763, "comment_id": 73258362, "body": "Although this probably works just fine, you are accessing a cell on the worksheet three times for every one cell in column B. That could add up very quickly and slow things down a lot."}], "tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 0, "last_activity_date": 1490774631, "creation_date": 1490774631, "answer_id": 43087763, "question_id": 43087037, "link": "https://stackoverflow.com/questions/43087037/how-to-loop-through-columns-and-calculate-averages/43087763#43087763", "title": "How to loop through columns and calculate averages?", "body": "<p>You can get your result in a simpler way:</p>\n\n<pre><code>Sub tenthavg()\n\nDim LastRow As Long\nLastRow = ThisWorkbook.Sheets(\"Your Sheet Name\").Columns(2).Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row\nDim myArray(1 To 10) As Double\n\nIf LastRow &lt; 10 Then\n    MsgBox \"There's not enough data!\"\nElse\n    On Error Resume Next\n    For x = 1 To LastRow - 9\n        For y = 1 To 10\n            myArray(y) = ThisWorkbook.Sheets(\"Your Sheet Name\").Cells(y + x - 1, 2).Value\n        Next y\n        ThisWorkbook.Sheets(\"Your Sheet Name\").Cells(x, 20).FormulaR1C1 = 0\n        ThisWorkbook.Sheets(\"Your Sheet Name\").Cells(x, 20).FormulaR1C1 = Application.Average(myArray)\n    Next x\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Please note: I'm assuming you're data starts at <code>B1</code> and you want the output on column <code>T</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": true, "score": 3, "last_activity_date": 1490774738, "creation_date": 1490774738, "answer_id": 43087798, "question_id": 43087037, "link": "https://stackoverflow.com/questions/43087037/how-to-loop-through-columns-and-calculate-averages/43087798#43087798", "title": "How to loop through columns and calculate averages?", "body": "<p>IMHO it's not quite the successful approach ... instead of <code>Select</code>ing <code>EndDown</code> and other concepts borrowed from interactive working make use of VBA's own mechanisms.</p>\n\n<p>A \"generic\" approch takes Range start address, batch size and offsets where to put the result as arguments ...</p>\n\n<pre><code>Sub AvgX(MyR As Range, S As Integer, ORow As Integer, OCol As Integer)\n' MyR = start of range\n' S   = batch size\n' OCol, ORow = Offsets to place result in relation to last batch value\nDim Idx As Integer, Jdx As Integer, RSum As Variant\n\n    Idx = 1\n    RSum = 0\n    Do\n        For Jdx = 1 To S\n            RSum = RSum + MyR(Idx, 1)\n            Idx = Idx + 1\n            If MyR(Idx, 1) = \"\" Then Exit Do\n        Next Jdx\n        MyR(Idx - 1, 1).Offset(ORow, OCol) = RSum / (Jdx - 1)\n        RSum = 0\n    Loop\nEnd Sub\n</code></pre>\n\n<p>and is called by</p>\n\n<pre><code>Sub Test()\n    AvgX [C4], 10, 0, 1\nEnd Sub\n</code></pre>\n\n<p>to give you this result ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/f9Eka.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f9Eka.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 7084869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e35daf9c1e6bade28455f0d7864931?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas HD", "link": "https://stackoverflow.com/users/7084869/andreas-hd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 43087798, "answer_count": 2, "score": 1, "last_activity_date": 1490779106, "creation_date": 1490772389, "last_edit_date": 1490779106, "question_id": 43087037, "link": "https://stackoverflow.com/questions/43087037/how-to-loop-through-columns-and-calculate-averages", "title": "How to loop through columns and calculate averages?", "body": "<p><a href=\"https://i.stack.imgur.com/dF6cL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dF6cL.png\" alt=\"Data series\"></a><a href=\"https://i.stack.imgur.com/B5S4g.png\" rel=\"nofollow noreferrer\">data series</a></p>\n\n<p>I want to find the average for each segment of ten values down a column. (See data series picture) \nContinuously all the way to the bottom of the data set. The data set can vary in length, and the code has to be \"generic\" of sorts. </p>\n\n<p>Based on other code segments I have tried to do this: </p>\n\n<pre><code>Sub tenthavg()\n\nDim currentIndex As Long\nDim myArray() As Variant\nDim rng As Range\n\nReDim myArray(1 To 10)     \n\nRange(\"b1\", Range(\"b1\").End(xlDown)).Select\nSet myArray = Selection        \ncurrentIndex = 1\n\nDo Until currentIndex + 1 &gt; UBound(myArray)\n    ActiveSheet.Cells(currentIndex, \"T\") = AverageOfSubArray(myArray, currentIndex, 10)\n    currentIndex = currentIndex + 1\nLoop                   \n\nEnd Sub\n\n'=================================================================\n\nFunction AverageOfSubArray(myArray As Variant, startIndex As Long,   elementCount As Long) As Double\nDim runningTotal As Double\nDim i As Long\n\nFor i = startIndex To (startIndex + elementCount - 1)\n    runningTotal = runningTotal + val(myArray(i))\nNext i\nAverageOfSubArray = runningTotal / elementCount\nEnd Function\n</code></pre>\n\n<p>Unfortunately I can't make it work. Am I approaching this the right way? </p>\n\n<p>If so, what am I doing wrong? </p>\n"}, {"tags": ["vba", "unc", "filesystemobject"], "comments": [{"owner": {"reputation": 166, "user_id": 4232245, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/23a21840b17a1eebb6a2573ff27742b4?s=128&d=identicon&r=PG&f=1", "display_name": "Kinimod", "link": "https://stackoverflow.com/users/4232245/kinimod"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1490773656, "post_id": 43086812, "comment_id": 73256752, "body": "It&#39;s VBA but this does not matter."}], "answers": [{"tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1490774253, "last_edit_date": 1490774253, "creation_date": 1490773845, "answer_id": 43087491, "question_id": 43086812, "link": "https://stackoverflow.com/questions/43086812/vba-deny-long-response-by-using-unc-path-and-filesystemobject/43087491#43087491", "title": "VBA: Deny long response by using UNC Path and FileSystemObject", "body": "<p>I've added a file check (and an example of it being called from a subroutine), then a folder check.  Both are called in the same way, and both utilise the <code>Dir</code> function.  I added an error handler in the filecheck, it's worth adding this for the folder checker too:</p>\n\n<pre><code>Sub Main()\n    if FileExists(\"O:\\Filenamehere\") = TRUE then\n        'do stuff\n    end if\nEnd Sub\n\n'For a file\nFunction FileExists(ByVal FullPath As String) As Boolean\n    On Error GoTo Hand\n    If Dir(FullPath) &lt;&gt; \"\" Then\n        FileExists = True\n    Else\n        FileExists = False\n    End If\n    Exit Function\nHand:\n    Select Case Err.Number\n        Case 52\n            FileExists = False\n    End Select\nEnd Function\n\n'For a directory\nFunction DirectoryExists(ByVal FullPath As String) As Boolean\n    If Dir(FullPath, vbDirectory) &lt;&gt; \"\" Then DirectoryExists = True Else DirectoryExists = False\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 166, "user_id": 4232245, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/23a21840b17a1eebb6a2573ff27742b4?s=128&d=identicon&r=PG&f=1", "display_name": "Kinimod", "link": "https://stackoverflow.com/users/4232245/kinimod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490774253, "creation_date": 1490771787, "last_edit_date": 1490773678, "question_id": 43086812, "link": "https://stackoverflow.com/questions/43086812/vba-deny-long-response-by-using-unc-path-and-filesystemobject", "title": "VBA: Deny long response by using UNC Path and FileSystemObject", "body": "<p>I try to get a directory which is in the network by using a UNC Path and the FileSystemObject, but if the network directory is not available the response takes so much time. I guess this is because of scanning the a lot of the network and or sends some more pings at this point.\nSo is there a method which I could use for check faster the exist of a network-directory before using the FSO?</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "excel-2007"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490771968, "post_id": 43086802, "comment_id": 73255690, "body": "VBA is not meant to be used as automation for other programs. Why don&#39;t you just use a mass file renamer (e.g. <a href=\"http://portableapps.com/apps/utilities/ant_renamer_portable\" rel=\"nofollow noreferrer\">Ant Renamer</a>) to rename the tsv files into txt files?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1490772159, "post_id": 43086802, "comment_id": 73255821, "body": "Save as csv file  <code>FileFormat:=xlCSV</code>"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490772281, "post_id": 43086802, "comment_id": 73255906, "body": "@Peh if im directly renaming it there are some bug forming which is affecting the data. Hence, we have to open in Notepadd++."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1490772414, "post_id": 43086802, "comment_id": 73256000, "body": "@0m3r if we are saving it in CSV format alignment of the data get collapsed :("}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490775886, "post_id": 43086802, "comment_id": 73258089, "body": "@Linga If you need to use Notepad++ then VBA might be the wrong tool, because VBA was made to to handle things in Excel and <b>not</b> in Notepad++. You should concentrate on removing the bug you are talking about, because .tsv files are .txt files. tsv only means that this is a text file containing tab separated values. Therefore if renaming doesn&#39;t work you got the wrong approach. Please describe the bug you have."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1490780792, "post_id": 43086802, "comment_id": 73261448, "body": "More no of rows has been added into one cell while opening it in excel or converting it to CSV. Not sure why this is happening however the above approach is not having any problem.."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490795073, "post_id": 43086802, "comment_id": 73271804, "body": "how do you define &quot;More no of rows have been added&quot; was it a random number of rows? was it a random row position? Was it every second row? You have to be a bit more precise if you expect a good answer. You need to figure out where the error comes from. Solving a problem by treating the symptoms but not finding the error is always a bad idea."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490859882, "post_id": 43086802, "comment_id": 73303182, "body": "@Peh we are unable predict it, that&#39;s really the problem here. Its happening in 39th row where its getting added 250 rows in it from 40th row normally data has been seated as expected...  Its keep changing against every file 200th row, 150th row etc..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490860701, "post_id": 43086802, "comment_id": 73303673, "body": "I think this has something to do with the charset of the files (which maybe gets changed when you save it in Notepad++). I can say that Excel is definitely not the right tool to solve this in combination with Notepad++. Also the question is a bit too broad to be solved on StackOverflow because it is based on question/answer system and very different from a forum where you can discuss different things and maybe provide sample files. I suggest to try it at a good forum to solve this issue. Try to solve the real issue with the files. Using N++ only fights the symptoms but doesn&#39;t cure the cancer."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1490861243, "post_id": 43086802, "comment_id": 73303978, "body": "@Peh Thank you your feedback :) If its not possible then i need to look for something else.. I&#39;m new to this scenario tsv to N++ and excel hence want to know is there way..."}], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1490772518, "post_id": 43087023, "comment_id": 73256069, "body": "Sorry FLex its not only for renaming the file :("}], "tags": [], "owner": {"reputation": 414, "user_id": 6019241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2b93f6aca9585eb836cdeacd81df772?s=128&d=identicon&r=PG", "display_name": "FLeX", "link": "https://stackoverflow.com/users/6019241/flex"}, "is_accepted": false, "score": 1, "last_activity_date": 1490772343, "creation_date": 1490772343, "answer_id": 43087023, "question_id": 43086802, "link": "https://stackoverflow.com/questions/43086802/opening-tsv-file-via-notepad-and-save-it-in-text-format/43087023#43087023", "title": "Opening tsv file via Notepad++ and save it in text format", "body": "<p>If you only want to rename the files from *.tsv to *.txt you could use the command line</p>\n\n<pre><code>ren *.tsv *.txt\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1490773640, "post_id": 43087132, "comment_id": 73256740, "body": "Thank you for sharing this :)"}], "tags": [], "owner": {"reputation": 25, "user_id": 7084869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e35daf9c1e6bade28455f0d7864931?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas HD", "link": "https://stackoverflow.com/users/7084869/andreas-hd"}, "is_accepted": false, "score": 0, "last_activity_date": 1490772701, "last_edit_date": 1495539998, "creation_date": 1490772701, "answer_id": 43087132, "question_id": 43086802, "link": "https://stackoverflow.com/questions/43086802/opening-tsv-file-via-notepad-and-save-it-in-text-format/43087132#43087132", "title": "Opening tsv file via Notepad++ and save it in text format", "body": "<p>There is another thread which touched upon the general aspect of calling shell commands. Maybe it can be of help to you:\n<a href=\"https://stackoverflow.com/questions/17956651/execute-a-command-in-command-prompt-using-excel-vba\">Execute a command in command prompt using excel VBA</a></p>\n"}, {"tags": [], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "is_accepted": true, "score": 1, "last_activity_date": 1491224456, "creation_date": 1491224456, "answer_id": 43185343, "question_id": 43086802, "link": "https://stackoverflow.com/questions/43086802/opening-tsv-file-via-notepad-and-save-it-in-text-format/43185343#43185343", "title": "Opening tsv file via Notepad++ and save it in text format", "body": "<p>Finally found a remedy by exporting via Data => From Text option the above issue can be tackled..</p>\n\n<p>Below is code for the same..</p>\n\n<pre><code> Do While fname &lt;&gt; \"\"\nWorkbooks.Add\nSet wBook = ActiveWorkbook\nSet wksht = ActiveSheet\n   With wksht.QueryTables.Add(Connection:=\"TEXT;\" &amp; folder_name &amp; fname, Destination:=Range(\"$A$1\"))\n    .Name = fname\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 65001\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierNone\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = True\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1903, "favorite_count": 1, "accepted_answer_id": 43185343, "answer_count": 3, "score": 0, "last_activity_date": 1491224456, "creation_date": 1490771771, "last_edit_date": 1531164843, "question_id": 43086802, "link": "https://stackoverflow.com/questions/43086802/opening-tsv-file-via-notepad-and-save-it-in-text-format", "title": "Opening tsv file via Notepad++ and save it in text format", "body": "<p>I'm trying to automate a process that where in a folder there are 50+ tsv files. They have to be opened via notepad++ and save it as .txt file in the same folder.</p>\n\n<p>Using the below code i'm opening the tsv file in notepad++. </p>\n\n<pre><code>MyTxtFile = Shell(\"C:\\Program Files (x86)\\Notepad++\\notepad++.exe I:\\Test\\Sample.tsv\", 1)\n</code></pre>\n\n<p>However, i have no idea how to save it as txt file by using VBA. Is it doable? If yes kindly teach me how.</p>\n\n<p>Thank you in advance :)</p>\n"}, {"tags": ["vba", "excel", "pivot-table", "pivot-chart"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1490778209, "creation_date": 1490778209, "answer_id": 43089010, "question_id": 43086707, "link": "https://stackoverflow.com/questions/43086707/use-of-variable-in-adding-data-to-values-field-of-pivot-chart-using-vba/43089010#43089010", "title": "Use of variable in adding data to Values field of Pivot Chart using VBA", "body": "<p>It would be:</p>\n\n<pre><code>For i = 1 To ProjDur    \n    ActiveChart.PivotLayout.PivotTable.AddDataField ActiveChart.PivotLayout. _\n    PivotTable.PivotFields(\"Day \" &amp; i), \"Sum of Day \" &amp; i, xlSum\nNext i\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7784123, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154491268773549/picture?type=large", "display_name": "Suraj Shenoy Nagar", "link": "https://stackoverflow.com/users/7784123/suraj-shenoy-nagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 627, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490778209, "creation_date": 1490771504, "last_edit_date": 1490771915, "question_id": 43086707, "link": "https://stackoverflow.com/questions/43086707/use-of-variable-in-adding-data-to-values-field-of-pivot-chart-using-vba", "title": "Use of variable in adding data to Values field of Pivot Chart using VBA", "body": "<p>I have a data set which looks something like this\n<a href=\"https://i.stack.imgur.com/uh4GS.jpg\" rel=\"nofollow noreferrer\">Dataset</a>\nHowever my number of days is a variable and will keep on changing.</p>\n\n<p>I want to use VBA to create a Pivot Chart, the code as below:</p>\n\n<pre><code>Sheets(\"Initialize\").Select\nNoRes = Cells(6, 3).Value\nSheets(\"Metric Calculations\").Select\nProjDur = Cells(31, 4).Value\nRange(Cells(31, 61), Cells(30 + NoRes, 61 + ProjDur)).Select\nSelection.Copy\nSheets(\"Resource Histogram Data\").Select\nRange(\"A2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(Cells(1, 1), Cells(1 + NoRes, 1 + ProjDur)).Select\nApplication.CutCopyMode = False\nr = 1 + NoRes\np = 1 + ProjDur\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=Sheets(\"Resource Histogram Data\").Range(Cells(1, 1), Cells(r, p)), Version:=6). _\n    CreatePivotTable TableDestination:=\"Sheet1!R1C1\", TableName:=\"PivotTable1\", DefaultVersion:=6\nSheets(\"Sheet1\").Select\nCells(1, 1).Select\nActiveWorkbook.ShowPivotTableFieldList = True\nActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\nActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$1:$C$18\")\nWith ActiveChart.PivotLayout.PivotTable.PivotFields(\"Resources\")\n    .Orientation = xlPageField\n    .Position = 1\nEnd With\n    ActiveChart.PivotLayout.PivotTable.AddDataField ActiveChart.PivotLayout. _\n        PivotTable.PivotFields(\"Day 1\"), \"Sum of Day 1\", xlSum\n    ActiveChart.PivotLayout.PivotTable.AddDataField ActiveChart.PivotLayout. _\n        PivotTable.PivotFields(\"Day 2\"), \"Sum of Day 2\", xlSum\n    ActiveChart.PivotLayout.PivotTable.AddDataField ActiveChart.PivotLayout. _\n        PivotTable.PivotFields(\"Day 3\"), \"Sum of Day 3\", xlSum\nActiveChart.PivotLayout.PivotTable.AddDataField ActiveChart.PivotLayout. _\n    PivotTable.PivotFields(\"Day 4\"), \"Sum of Day 4\", xlSum\nActiveChart.PivotLayout.PivotTable.AddDataField ActiveChart.PivotLayout. _\n    PivotTable.PivotFields(\"Day 5\"), \"Sum of Day 5\", xlSum\nActiveChart.PivotLayout.PivotTable.AddDataField ActiveChart.PivotLayout. _\n    PivotTable.PivotFields(\"Day 6\"), \"Sum of Day 6\", xlSum\nActiveChart.PivotLayout.PivotTable.AddDataField ActiveChart.PivotLayout. _\n    PivotTable.PivotFields(\"Day 7\"), \"Sum of Day 7\", xlSum\nActiveChart.ShowValueFieldButtons = False\n</code></pre>\n\n<p>In the last part of the code in which the AddDataField is repeated for seven time. When the number of days will vary (between 1 to 200) this ideally should be in a for loop. However doing this obviously doesnt work.</p>\n\n<pre><code>For i = 1 To ProjDur    \n    ActiveChart.PivotLayout.PivotTable.AddDataField ActiveChart.PivotLayout. _\n    PivotTable.PivotFields(\"Day i\"), \"Sum of Day i\", xlSum    \nNext i\n</code></pre>\n\n<p>How do i get this for loop function included in my code?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1490773835, "post_id": 43086560, "comment_id": 73256843, "body": "I&#39;ve edited your code to <b>properly indent it</b> (it was almost unreadable), also take the habit of <b>specifying your variable on the <code>Next</code> statements</b> (ie <code>For Each olkMsg In ...</code> =&gt; <code>Next olkMsg</code>).  And we won&#39;t be able to answer your question <b>without rewriting almost everything, if you don&#39;t tell us what are the functions <code>GetCells</code> and <code>ParseTextLinePair</code></b>. Furthermore, why do you <code>Dim i As String</code>, put 1 in it and don&#39;t use it??"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1490774882, "post_id": 43086560, "comment_id": 73257434, "body": "Hi, thank you for editing. I added the GetCells , ParseTextLinePair , GetFolderPatharchive. i was  from a previous attempt ."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1490775054, "post_id": 43086560, "comment_id": 73257541, "body": "Can you edit with image of the your email without sensitive  information?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1490780171, "post_id": 43086560, "comment_id": 73261001, "body": "@R3uK If you do more than indenting code in an edit, there is the risk of having nothing to answer. It would be unlikely to have been approved."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1490780820, "post_id": 43086560, "comment_id": 73261467, "body": "@niton : I know, I&#39;ve started modifying it in the objective to answer but discovered the custom functions in the mean time. I haven&#39;t done much (nothing meaningful), but I see in the edit history that it has changed a lot of keywords&#39; case!"}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1490788454, "post_id": 43088277, "comment_id": 73266591, "body": "You, SIR, are AWESOME !"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1490780843, "last_edit_date": 1490780843, "creation_date": 1490776201, "answer_id": 43088277, "question_id": 43086560, "link": "https://stackoverflow.com/questions/43086560/parse-right-of-last-found-from-email-body/43088277#43088277", "title": "Parse right of last found from email body", "body": "<p>I would do it like this :</p>\n\n<pre><code>Sub Problems()\n    Dim myOlApp As New Outlook.Application\n    Dim myNameSpace As Outlook.NameSpace\n    Dim myInbox As Outlook.MAPIFolder\n    Dim myitems As Outlook.items\n    Dim myitem As Object\n    Dim Found As Boolean\n\n    Set myNameSpace = myOlApp.GetNamespace(\"MAPI\")\n    Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n    Set myitems = GetFolderPatharchive(\"aaa\\bbb\").items\n    Found = False\n\n    Dim olkMsg As Object, _\n        olkFld As Object, _\n        excApp As Object, _\n        excWkb As Object, _\n        excWks As Object, _\n        intRow As Integer, _\n        intCnt As Integer, _\n        data_email As String, _\n        strFilename As String, _\n        arrCells As Variant, _\n        varB As Variant, varD As Variant, varF As Variant\n\n    strFilename = \"C:\\OVERVIEW\\EXTRACT EMAIL1\"\n    If strFilename &lt;&gt; vbNullString Then\n        Set excApp = CreateObject(\"Excel.Application\")\n        Set excWkb = excApp.Workbooks.Add()\n        Set excWks = excWkb.ActiveSheet\n        excApp.DisplayAlerts = False\n        With excWks\n            .Cells(1, 1) = \"SENDER\"\n            .Cells(1, 2) = \"SUBJECT\"\n            .Cells(1, 3) = \"CITY\"\n            .Cells(1, 4) = \"DATE\"\n            .Cells(1, 5) = \"HOUR\"\n            .Cells(1, 6) = \"FIELD\"\n            .Cells(1, 7) = \"PROBLEM\"\n        End With 'excWks\n\n        intRow = 2\n\n        For Each olkMsg In myitems\n            If olkMsg.Class &lt;&gt; olMail Then\n            Else\n                arrCells = Split(GetCells(olkMsg.HTMLBody), Chr(255))\n                For intCnt = LBound(arrCells) To UBound(arrCells) Step 1\n\nOn Error GoTo Handler\n                    varB = arrCells(intCnt)\n                    Dim LgLocCell As Long\n                    LgLocCell = InStr(1, olkMsg.Body, varB)\n                    Dim LgLocReason As Long\n                    LgLocReason = InStr(LgLocCell + Len(varB), olkMsg.Body, \"because\", vbTextCompare) + 6\n\n                    Dim line As Integer\n                    line = InStr(olkMsg.Subject, \"-\")\n                    With excWks\n                        .Cells(intRow, 1) = olkMsg.SenderName\n                        .Cells(intRow, 2) = Left(olkMsg.Subject, line - 1)\n                        .Cells(intRow, 3) = Left(olkMsg.Subject, 4)\n                        .Cells(intRow, 4) = Format(olkMsg.ReceivedTime, \"dd.mm.yyyy\")\n                        .Cells(intRow, 5) = Format(olkMsg.ReceivedTime, \"Hh:Nn:Ss\")\n                        .Cells(intRow, 6) = varB\n                        .Cells(intRow, 7) = Trim(Mid(olkMsg.Body, LgLocReason, InStr(LgLocReason + 1, olkMsg.Body, \".\") - LgLocReason))\n                    End With 'excWks\n                    intRow = intRow + 1\n                Next intCnt\n            End If\nLabel1:\n        Next olkMsg\n\n        Set olkMsg = Nothing\n        excWkb.SaveAs strFilename, 52\n        excWkb.Close\n    End If\n\n    Set olkFld = Nothing\n    Set excWks = Nothing\n    Set excWkb = Nothing\n    Set excApp = Nothing\n\n    MsgBox \"TA DAM! EMAILS EXPORTED\", vbInformation + vbOKOnly\n    Call opexlN\nExit Sub\nHandler:\n    Resume Label1\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Your function wasn't right, in case you didn't find <code>vbCrLf</code> you were putting a string inside the integer <code>intLocLabel</code> which would cause a Type Mismatch error! <br>\nI'm not sure what you want to do when you don't find the line return, because your <code>Mid()</code> in that case is only returning 1 character after the text you were looking for!<br>\nI set it to return an empty string! ;)</p>\n\n<pre><code>Function ParseTextLinePair _\n  (strSource As String, strLabel As String)\n    Dim intLocLabel As Integer\n    Dim intLocCRLF As Integer\n    Dim intLenLabel As Integer\n    Dim strText As String\n    intLocLabel = InStr(strSource, strLabel)\n    intLenLabel = Len(strLabel)\n        If intLocLabel &gt; 0 Then\n        intLocCRLF = InStr(intLocLabel, strSource, vbCrLf)\n        If intLocCRLF &gt; 0 Then\n            intLocLabel = intLocLabel + intLenLabel\n            strText = Mid(strSource, _\n                            intLocLabel, _\n                            intLocCRLF - intLocLabel)\n        Else\n            'strText = _\n              Mid(strSource, intLocLabel + intLenLabel)\n            strText = vbNullString\n        End If\n    End If\n    ParseTextLinePair = Trim(strText)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 43088277, "answer_count": 1, "score": 1, "last_activity_date": 1592694067, "creation_date": 1490771032, "last_edit_date": 1592694067, "question_id": 43086560, "link": "https://stackoverflow.com/questions/43086560/parse-right-of-last-found-from-email-body", "title": "Parse right of last found from email body", "body": "<p>I have emails with the following type:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Uo2ka.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uo2ka.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I am extracting the NAME and CITY but I want to extract also the problem for each field : NAME Because is WRONG and CITY Because it can't be READ</p>\n\n<p>Until now I can extract one problem overall for each email - the first encounter.  </p>\n\n<pre><code>Sub Problems()\n    Dim myOlApp As New Outlook.Application\n    Dim myNameSpace As Outlook.NameSpace\n    Dim myInbox As Outlook.MAPIFolder\n    Dim myitems As Outlook.items\n    Dim myitem As Object\n    Dim Found As Boolean\n\n    Set myNameSpace = myOlApp.GetNamespace(\"MAPI\")\n    Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n    Set myitems = GetFolderPatharchive(\"aaa\\bbb\").items\n    Found = False\n\n    Dim olkMsg As Object, _\n        olkFld As Object, _\n        excApp As Object, _\n        excWkb As Object, _\n        excWks As Object, _\n        intRow As Integer, _\n        intCnt As Integer, _\n        data_email As String, _\n        strFilename As String, _\n        arrCells As Variant, _\n        varb As Variant, varD As Variant, varF As Variant\n\n    strFilename = \"C:\\OVERVIEW\\EXTRACT EMAIL1\"\n    If strFilename &lt;&gt; vbNullString Then\n        Set excApp = CreateObject(\"Excel.Application\")\n        Set excWkb = excApp.Workbooks.Add()\n        Set excWks = excWkb.ActiveSheet\n        excApp.DisplayAlerts = False\n        With excWks\n            .Cells(1, 1) = \"SENDER\"\n            .Cells(1, 2) = \"SUBJECT\"\n            .Cells(1, 3) = \"CITY\"\n            .Cells(1, 4) = \"DATE\"\n            .Cells(1, 5) = \"HOUR\"\n            .Cells(1, 6) = \"FIELD\"\n            .Cells(1, 7) = \"PROBLEM\"\n        End With\n\n        intRow = 2\n\n        For Each olkMsg In myitems\n            If olkMsg.Class &lt;&gt; olMail Then\n            Else\n                arrCells = Split(GetCells(olkMsg.HTMLBody), Chr(255))\n                For intCnt = LBound(arrCells) To UBound(arrCells) Step 1\n\nOn Error GoTo Handler\n                    varb = arrCells(intCnt)\n                    Dim line As Integer\n                    line = InStr(olkMsg.Subject, \"-\")\n\n                    excWks.Cells(intRow, 1) = olkMsg.SenderName\n                    excWks.Cells(intRow, 2) = Left(olkMsg.Subject, line - 1)\n                    excWks.Cells(intRow, 3) = Left(olkMsg.Subject, 4)\n                    excWks.Cells(intRow, 4) = Format(olkMsg.ReceivedTime, \"dd.mm.yyyy\")\n                    excWks.Cells(intRow, 5) = Format(olkMsg.ReceivedTime, \"Hh:Nn:Ss\")\n                    excWks.Cells(intRow, 6) = varb\n\n                    Dim strAddr As String\n                    strAddr = ParseTextLinePair(olkMsg.Body, \"WRONG\")\n                    If strAddr &lt;&gt; vbNullString Then excWks.Cells(intRow, 7) = \"WRONG\"\n\n                    intRow = intRow + 1\n                Next intCnt\n            End If\nLabel1:\n        Next olkMsg\n\n        Set olkMsg = Nothing\n        excWkb.SaveAs strFilename, 52\n        excWkb.Close\n    End If\n\n    Set olkFld = Nothing\n    Set excWks = Nothing\n    Set excWkb = Nothing\n    Set excApp = Nothing\n\n    MsgBox \"TA DAM! EMAILS EXPORTED\", vbInformation + vbOKOnly\n    Call opexlN\nExit Sub\nHandler:\n    Resume Label1\nEnd Sub\n\n\n\nFunction ParseTextLinePair _\n  (strSource As String, strLabel As String)\n    Dim intLocLabel As Integer\n    Dim intLocCRLF As Integer\n    Dim intLenLabel As Integer\n    Dim strText As String\n    intLocLabel = InStr(strSource, strLabel)\n    intLenLabel = Len(strLabel)\n        If intLocLabel &gt; 0 Then\n        intLocCRLF = InStr(intLocLabel, strSource, vbCrLf)\n        If intLocCRLF &gt; 0 Then\n            intLocLabel = intLocLabel + intLenLabel\n            strText = Mid(strSource, _\n                            intLocLabel, _\n                            intLocCRLF - intLocLabel)\n        Else\n            intLocLabel = _\n              Mid(strSource, intLocLabel + intLenLabel)\n        End If\n    End If\n    ParseTextLinePair = Trim(strText)\nEnd Function\n\n\n\nFunction GetFolderPatharchive(ByVal FolderPath As String) As Outlook.Folder\n    Dim oFolder As Outlook.Folder\n    Dim FoldersArray As Variant\n    Dim i As Integer\n\n    On Error GoTo GetFolderPatharchive_Error\n    If Left(FolderPath, 2) = \"\\\\\" Then\n        FolderPath = Right(FolderPath, Len(FolderPath) - 2)\n    End If\n    'Convert folderpath to array\n    FoldersArray = Split(FolderPath, \"\\\")\n    Set oFolder = Application.Session.Folders.Item(FoldersArray(0))\n    If Not oFolder Is Nothing Then\n        For i = 1 To UBound(FoldersArray, 1)\n            Dim SubFolders As Outlook.Folders\n            Set SubFolders = oFolder.Folders\n            Set oFolder = SubFolders.Item(FoldersArray(i))\n            If oFolder Is Nothing Then\n                Set GetFolderPatharchive = Nothing\n            End If\n        Next\n    End If\n    'Return the oFolder\n    Set GetFolderPatharchive = oFolder\n    Exit Function\n\nGetFolderPatharchive_Error:\n    Set GetFolderPatharchive = Nothing\n    Exit Function\nEnd Function\n\n\nPrivate Function GetCells(strHTML As String) As String\n    Const READYSTATE_COMPLETE = 4\n    Dim objIE As Object, objDoc As Object, colCells As Object, objCell As Object\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    objIE.Navigate \"about:blank\"\n    Do Until objIE.ReadyState = READYSTATE_COMPLETE\n    DoEvents\n    Loop\n    objIE.Document.body.innerHTML = strHTML\n    Set objDoc = objIE.Document\n    Set colCells = objDoc.getElementsByTagName(\"td\")\n    If colCells.Length &gt; 0 Then\n        For Each objCell In colCells\n            GetCells = GetCells &amp; objCell.innerText &amp; Chr(255)\n        Next\n        GetCells = Left(GetCells, Len(GetCells) - 1)\n    Else\n        GetCells = \"\"\n    End If\nSet objCell = Nothing\nSet colCells = Nothing\nSet objDoc = Nothing\nobjIE.Quit\nSet objIE = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "time", "duration"], "comments": [{"owner": {"reputation": 1182, "user_id": 3639687, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c93d8e07b0e0ba4ebeacf0305691cdc9?s=128&d=identicon&r=PG&f=1", "display_name": "Pratham", "link": "https://stackoverflow.com/users/3639687/pratham"}, "edited": false, "score": 0, "creation_date": 1490771189, "post_id": 43086550, "comment_id": 73255208, "body": "Convert the string into time, take the diff and format the diff into &quot;hh:mm:ss&quot; format."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490771872, "post_id": 43086550, "comment_id": 73255627, "body": "I am not familiar with the time <code>&quot;27:08:03&quot;</code> , something new ?"}, {"owner": {"reputation": 11, "user_id": 7064243, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ubi3XTuArc/AAAAAAAAAAI/AAAAAAAACWk/d2qnzI2Gxyo/photo.jpg?sz=128", "display_name": "Francesco Audisio", "link": "https://stackoverflow.com/users/7064243/francesco-audisio"}, "reply_to_user": {"reputation": 1182, "user_id": 3639687, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c93d8e07b0e0ba4ebeacf0305691cdc9?s=128&d=identicon&r=PG&f=1", "display_name": "Pratham", "link": "https://stackoverflow.com/users/3639687/pratham"}, "edited": false, "score": 0, "creation_date": 1490772044, "post_id": 43086550, "comment_id": 73255744, "body": "is  not time of day, this two strings are counter duration formatted in &quot;hh:mm:ss&quot;, @Pratham is not possible to convert in time because is not a time of a day =D"}, {"owner": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490772509, "post_id": 43086550, "comment_id": 73256064, "body": "@ShaiRado - I think the Excel format is <code>[h]:mm:ss</code>, which can display total hours &gt; 1 day."}, {"owner": {"reputation": 11, "user_id": 7064243, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ubi3XTuArc/AAAAAAAAAAI/AAAAAAAACWk/d2qnzI2Gxyo/photo.jpg?sz=128", "display_name": "Francesco Audisio", "link": "https://stackoverflow.com/users/7064243/francesco-audisio"}, "reply_to_user": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "edited": false, "score": 0, "creation_date": 1490772858, "post_id": 43086550, "comment_id": 73256277, "body": "@Joe is it possible to have format [h]:mm:ss like excel into vba? yes if you put function = TEXT(D5-D4;&quot;[h]:mm:ss&quot;) you have 3:49:00  as output"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 11, "user_id": 7064243, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ubi3XTuArc/AAAAAAAAAAI/AAAAAAAACWk/d2qnzI2Gxyo/photo.jpg?sz=128", "display_name": "Francesco Audisio", "link": "https://stackoverflow.com/users/7064243/francesco-audisio"}, "edited": false, "score": 0, "creation_date": 1490814023, "post_id": 43098941, "comment_id": 73285600, "body": "You are welcome. Given no built-in time function could be used, the 1-60-3600 splitting was the only way to go. My solution implements it with a special eye to code reusability and maintenance. Should you appreciate and adopt it, then you may also want to mark this answer as accepted. Thank you!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1490804260, "creation_date": 1490804260, "answer_id": 43098941, "question_id": 43086550, "link": "https://stackoverflow.com/questions/43086550/difference-time-between-two-string-not-time-of-day-in-vba/43098941#43098941", "title": "Difference time between two string not time of day in vba", "body": "<p>you could use this helper function</p>\n\n<pre><code>Function GetDiffTime(string1 As String, string2 As String) As String\n    GetDiffTime = GetTime(GetSeconds(string2) - GetSeconds(string1))\nEnd Function\n</code></pre>\n\n<p>which, on its turn, uses the following functions:</p>\n\n<pre><code>Function GetTime(seconds As Long) As String\n    Dim rest As Long\n\n    rest = seconds \\ 3600\n    GetTime = GetTime &amp; Format(rest, \"00\")\n    seconds = seconds - rest * 3600\n\n    rest = seconds \\ 60\n    GetTime = GetTime &amp; \":\" &amp; Format(rest, \"00\")\n    seconds = seconds - rest * 60\n\n    GetTime = GetTime &amp; \":\" &amp; Format(seconds, \"00\")\nEnd Function\n\nFunction GetSeconds(strng As String) As Long\n    Dim timeParts As Variant\n    Dim iPart As Integer\n\n    timeParts = Split(strng, \":\")\n    For iPart = UBound(timeParts) To LBound(timeParts) Step -1\n        GetSeconds = GetSeconds + CInt(timeParts(iPart)) * 60 ^ (UBound(timeParts) - iPart)\n    Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7064243, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ubi3XTuArc/AAAAAAAAAAI/AAAAAAAACWk/d2qnzI2Gxyo/photo.jpg?sz=128", "display_name": "Francesco Audisio", "link": "https://stackoverflow.com/users/7064243/francesco-audisio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490804260, "creation_date": 1490770982, "last_edit_date": 1490792900, "question_id": 43086550, "link": "https://stackoverflow.com/questions/43086550/difference-time-between-two-string-not-time-of-day-in-vba", "title": "Difference time between two string not time of day in vba", "body": "<p>I don't find a solution for this problem, I have two string with this format :</p>\n\n<pre><code>string1 = \"23:19:03\" (hh:mm:ss)\nstring2 = \"27:08:03\" (hh:mm:ss)\n</code></pre>\n\n<p>I'll need calculate time difference between this two string like</p>\n\n<pre><code>string1 = \"23:19:03\" \nstring2 = \"27:08:03\" \ndiff = 3:49:00   (h:m:s)\n</code></pre>\n\n<p><strong>UPDATE</strong>\n<strong>I found a solution :</strong></p>\n\n<p>fell free to use my code with mention me, thanks</p>\n\n<pre><code>Public Function timediff(ByVal time1 As String, ByVal time2 As String) As String\n'Author: \u00a9 Copyright 2017 Audisio Francesco **************************\n'Description: Time diffence betweem two string no time of day!!,the format of this two string is ([h]:mm:ss) like excel function\n'             time2 must be greater than time1\nDim ore1, ore2, min1, min2, sec1, sec2, tot1, tot2, tot, ore, apsec, min, sec As Double\nDim aladin1() As String\nDim aladin2() As String\n'Dim time1, time2 As String\n'genero secondi totali\naladin1 = Split(time1, \":\")\n    ore1 = Val(aladin1(0)) 'Ore\n    ore1 = ore1 * 3600\n    min1 = Val(aladin1(1)) 'minuti\n    min1 = min1 * 60\n    sec1 = Val(aladin1(2)) 'secondi\n    sec1 = sec1\naladin2 = Split(time2, \":\")\n    ore2 = Val(aladin2(0)) 'Ore\n    ore2 = ore2 * 3600\n    min2 = Val(aladin2(1)) 'minuti\n    min2 = min2 * 60\n    sec2 = Val(aladin2(2)) 'secondi\n    sec2 = sec2\n'prendo i totali\ntot1 = ore1 + min1 + sec1\ntot2 = ore2 + min2 + sec2\ntot = tot2 - tot1\n\nore = Int(tot / 3600)\napsec = tot - (3600 * ore)\nmin = Int(apsec / 60)\nsec = apsec - (min * 60)\nresult = (ore &amp; \":\" &amp; min &amp; \":\" &amp; sec)\ntimediff = result\nEnd Function\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code>string1 = \"23:19:03\" \nstring2 = \"27:08:03\"\nore1 = timediff(time1, time2)\nore1 = 3:49:0\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1490770829, "last_edit_date": 1490770829, "creation_date": 1490770454, "answer_id": 43086379, "question_id": 43086288, "link": "https://stackoverflow.com/questions/43086288/find-email-adresses-in-excel-workbook/43086379#43086379", "title": "Find email adresses in excel workbook", "body": "<p>The recommended way to use the <code>Find</code> function, is by setting a <code>Range</code> type variable to the result. This way you can trap the scenario <code>Find</code> was unable to find <code>@</code> throughout your worksheet's Cells with <code>If Not EmailRng Is Nothing Then</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub emialy()\n\nDim EmailRng As Range\n\nSet EmailRng = Cells.Find(What:=\"@\", LookIn:=xlValues, Lookat:=xlPart, SearchOrder:=xlByRows)    \nIf Not EmailRng Is Nothing Then ' succesful find\n    EmailRng.Copy\nElse\n    MsgBox \"Could not find the @ symbol\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7245509, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bb34da845a1087b7741698d1275c0dc?s=128&d=identicon&r=PG&f=1", "display_name": "Jozef Fujka", "link": "https://stackoverflow.com/users/7245509/jozef-fujka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 43086379, "answer_count": 1, "score": 0, "last_activity_date": 1490770829, "creation_date": 1490770147, "last_edit_date": 1531164843, "question_id": 43086288, "link": "https://stackoverflow.com/questions/43086288/find-email-adresses-in-excel-workbook", "title": "Find email adresses in excel workbook", "body": "<p>I have a excel sheet which containts an emails in exact one column(the order of the column is not exact and changing).</p>\n\n<p>I used the find function looking like this.</p>\n\n<pre><code>Sub emialy()\n\nCells.Find (\"@\",,xlValues,xlPart,xlByRows,,,,) ActiveCell.Copy \n\nEnd Sub\n</code></pre>\n\n<p>but I am recieving an error...</p>\n\n<p>Then if a program finds where the emails list are beginning i want to copy that very first email and open an email client (outlook), create an new email and paste the exact copied email to the \"to:\" row.</p>\n"}, {"tags": ["vba", "excel", "loops", "primitive"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1490764921, "post_id": 43084868, "comment_id": 73252260, "body": "Easier and Better with Formula? As you can change one variable at a time? Imagine you want to know the results of 1 to 5 years with fixed CashFlow and DiscRate? Or convert it into a UDF (User Defined Function) and use within the worksheet with 3 input ranges?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5716047, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e42b7571785c8033ad8e77634f5b14e4?s=128&d=identicon&r=PG&f=1", "display_name": "user5716047", "link": "https://stackoverflow.com/users/5716047/user5716047"}, "edited": false, "score": 0, "creation_date": 1490766808, "post_id": 43085020, "comment_id": 73252995, "body": "Thanks for helping out. As a last question, what is the &quot;#&quot; that&#39;s next to &quot;1&#39; and &quot;0&quot; in the code?"}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "reply_to_user": {"reputation": 33, "user_id": 5716047, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e42b7571785c8033ad8e77634f5b14e4?s=128&d=identicon&r=PG&f=1", "display_name": "user5716047", "link": "https://stackoverflow.com/users/5716047/user5716047"}, "edited": false, "score": 0, "creation_date": 1490767058, "post_id": 43085020, "comment_id": 73253111, "body": "If just shows the number is a double - see this <a href=\"http://stackoverflow.com/questions/2829128/funny-notation-with\">post</a>"}], "tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": true, "score": 2, "last_activity_date": 1490765952, "last_edit_date": 1490765952, "creation_date": 1490765174, "answer_id": 43085020, "question_id": 43084868, "link": "https://stackoverflow.com/questions/43084868/how-to-improve-primitive-vba-code-for-dcf-model/43085020#43085020", "title": "How to improve primitive VBA code for DCF model?", "body": "<p>The code you have is fine and only requires a loop to create the discounted cash flow.  This should do what you want:</p>\n\n<pre><code>Sub DCF()\n\n  Dim z As Double, CashFlow As Double, DiscRate As Double, Periods As Double: z = 0#\n\n  CashFlow = InputBox(\"Enter initial cash flow: \", \"Cash Flow\")\n  DiscRate = InputBox(\"Enter discount rate in decimal form: \", \"Discount Rate\")\n  Periods = InputBox(\"How many periods (in years) are there?\", \"Periods\")\n\n  Dim i As Integer\n  For i = 1 To Periods:\n    z = z + CashFlow / (1# + DiscRate) ^ i\n  Next\n\n  MsgBox Format(z, \"$0.00\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5716047, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e42b7571785c8033ad8e77634f5b14e4?s=128&d=identicon&r=PG&f=1", "display_name": "user5716047", "link": "https://stackoverflow.com/users/5716047/user5716047"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1067, "favorite_count": 0, "accepted_answer_id": 43085020, "answer_count": 1, "score": 1, "last_activity_date": 1490765952, "creation_date": 1490764373, "question_id": 43084868, "link": "https://stackoverflow.com/questions/43084868/how-to-improve-primitive-vba-code-for-dcf-model", "title": "How to improve primitive VBA code for DCF model?", "body": "<p>I'm new to VBA and I've been trying to create a program that allows me to take a starting cash amount, discount that amount by a certain discount rate, and also multiply the discount rate by n years to find a given discounted cash flow based upon a given number of years. Does anyone have any tips for how I could make this code more efficient? Also, what are some tips for using a loop to sum together different sums of cash, such as \"(100/1.01) + (100/1.01^2) + (100/1.01^3)?\" Thanks in advance!     </p>\n\n<pre><code>Sub DCF()\n\nDim z As Double, CashFlow As Double, DiscRate As Double, Periods As Double\n\nCashFlow = InputBox(\"Enter initial cash flow: \", \"Cash Flow\")\nDiscRate = InputBox(\"Enter discount rate in decimal form: \", \"Discount Rate\")\nPeriods = InputBox(\"How many periods (in years) are there?\", \"Periods\")\n\nz = CashFlow / (1 + DiscRate) ^ Periods\n\nMsgBox Format(z, \"$0.00\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vlookup", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1490769072, "post_id": 43084394, "comment_id": 73254037, "body": "So you want the <b>address</b> of the cell?  Or the <b>range name</b> associated with the cell?  And how do you then intend to subtract something from that address or name?"}, {"owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "edited": false, "score": 0, "creation_date": 1490770085, "post_id": 43084394, "comment_id": 73254563, "body": "Would <code>MATCH()</code> function give you the result you need?"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1490771612, "creation_date": 1490771612, "answer_id": 43086745, "question_id": 43084394, "link": "https://stackoverflow.com/questions/43084394/vlookup-but-the-name-of-the-cell-that-will-return-not-the-value-in-the-cell/43086745#43086745", "title": "vlookup but the name of the cell that will return not the value in the cell", "body": "<p><code>VLookup</code> only returns a value. You will need the <code>match</code> function. This will return the row number which you can use to access the desired cells.</p>\n\n<pre><code>Sub purchase()\n    Dim Name As String\n    Name = ActiveSheet.Range(\"C3\")\n\n    Dim MatchedRow As Long\n    MatchedRow = Application.WorksheetFunction.Match(Name, Sheet2.Range(\"Table6\").Columns(1), 0)\n      'Find the row number (relative to the range table6) of the found name\n\n    Dim Sal As Double\n    Sal = Sheet2.Range(\"Table6\").Cells(MatchedRow, 5).Value - ActiveSheet.Range(\"D3\").Value\n\n    Sheet2.Range(\"Table6\").Cells(MatchedRow, 5).Value = Sal\n      'Write the calculated Sal back\n\n    MsgBox \" remaining: \" &amp; Sal\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7783608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb654b23d60cfb5edd3caa71e7cb7e3f?s=128&d=identicon&r=PG&f=1", "display_name": "pats", "link": "https://stackoverflow.com/users/7783608/pats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490771612, "creation_date": 1490761975, "last_edit_date": 1531161705, "question_id": 43084394, "link": "https://stackoverflow.com/questions/43084394/vlookup-but-the-name-of-the-cell-that-will-return-not-the-value-in-the-cell", "title": "vlookup but the name of the cell that will return not the value in the cell", "body": "<p>just like to ask if you know a formula like in the vlookup style but the cell name that it will return not the value of the cell? thanks! </p>\n\n<p>I want to put the value of <code>sal</code> in the <code>Application.WorksheetFunction.VLookup(name, Sheet2.Range(\"Table6\"), 5, False)</code> but in this function the value inside the cell will return not the name of the cell</p>\n\n<pre><code>Sub purchase()\n\nDim name As String\nname = ActiveSheet.Range(\"C3\")\nsal = Application.WorksheetFunction.VLookup(name, Sheet2.Range(\"Table6\"), 5, False) - ActiveSheet.Range(\"d3\").Value\n\nMsgBox \" remaining: \" &amp; sal   \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c++", "vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1490761149, "post_id": 43084175, "comment_id": 73251077, "body": "There&#39;s exactly one thread available to any VBA code, and Excel itself is running an STA thread. &quot;simultaneously&quot; or &quot;parallel&quot; isn&#39;t a possibility."}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1490765366, "post_id": 43084175, "comment_id": 73252435, "body": "instead of calling the c++ DLL separately for each use in a cell, could you call the DLL function on a timed basis and get the information for all of the cells in one go? The cell functions could then refer to the most recent set of data returned."}], "answers": [{"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1490778613, "creation_date": 1490778613, "answer_id": 43089149, "question_id": 43084175, "link": "https://stackoverflow.com/questions/43084175/multiple-dll-calls-in-vba/43089149#43089149", "title": "Multiple DLL calls in VBA", "body": "<p>You need to make your C++ functions directly callable multi-threaded UDFs in an XLL: then Excel's calculation engine will exploit multi-threading using multiple cores.</p>\n\n<p>To do this you will need to use the Excel 'C' Api SDK</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/bb687829.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/bb687829.aspx</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/bb687883.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/bb687883.aspx</a></p>\n"}], "owner": {"reputation": 43, "user_id": 5309900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8293a0b59d73e134cd3a74c39e274c5?s=128&d=identicon&r=PG&f=1", "display_name": "Quant Invest", "link": "https://stackoverflow.com/users/5309900/quant-invest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1490778613, "creation_date": 1490760658, "question_id": 43084175, "link": "https://stackoverflow.com/questions/43084175/multiple-dll-calls-in-vba", "title": "Multiple DLL calls in VBA", "body": "<p>I've created a C++ DLL with many Functions and I call them from excel sheet through VBA. The Problem I'm facing is the following:</p>\n\n<p>I have many spreadsheet cells calling the same function at the same time every N seconds,it is taking a while to update the excel book. If called separately each run is very efficient however when multiple cells calls the function it runs serialized and takes too long.</p>\n\n<p>My question is, how can I get better solution?  I thought if its possible the same function be called simultaneously and run on parallel or something like that, so I can the routine faster.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1490764441, "post_id": 43084102, "comment_id": 73252078, "body": "How would you known when <code>Name</code> is <code>Hotel A</code> or <code>Hotel B</code> ??"}, {"owner": {"reputation": 1873, "user_id": 3893729, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/dae6e19fc9f20b5452627fa2fe22d6fc?s=128&d=identicon&r=PG&f=1", "display_name": "MFR", "link": "https://stackoverflow.com/users/3893729/mfr"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1490764706, "post_id": 43084102, "comment_id": 73252190, "body": "@RobinMackenzie  The first <code>Name</code> in <code>sheet 2</code> is <code>hotel A</code> because it is the first row in <code>Sheet 1</code> and the second <code>Name</code> is <code>hotel B</code> because it is the second row in <code>sheet 1</code>.  In other words, The number of <code>Name</code> in <code>Sheet 2</code> is equal to the number of rows in <code>sheet 1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1490771217, "post_id": 43086392, "comment_id": 73255228, "body": "I tested the code. Hotel A and Hotel B end up in reversed positions. The cities are correct."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1490771676, "post_id": 43086392, "comment_id": 73255505, "body": "@June7 - I was worried about that - I was hoping that you would have headings in the first row and therefore the first match wouldn&#39;t be in cell A1.  Give me a few minutes and I will update the answer to start the search at Cells(Rows.Count, Columns.Count)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1490771855, "post_id": 43086392, "comment_id": 73255614, "body": "@June7 - OK - I have forced the <code>Find</code> to start from the very last cell on the sheet.  That way, if the first match is in cell A1, it will still find it."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1490771799, "last_edit_date": 1490771799, "creation_date": 1490770483, "answer_id": 43086392, "question_id": 43084102, "link": "https://stackoverflow.com/questions/43084102/find-and-replace-in-a-loop-using-macro-in-excel/43086392#43086392", "title": "Find and replace in a loop using macro in Excel", "body": "<p><code>Cells.Replace</code> will change <strong>all</strong> occurrences of <code>What</code> with <code>Replacement</code>.</p>\n\n<p>You need to <code>Find</code> the cell you are looking for, and then replace the value in just that cell:</p>\n\n<pre><code>Sub testLoopPaste()\n    'Note: existing code was declaring j, k and L as Variant\n    Dim j As String, k As String, L As String, b As String\n    Dim i As Long\n    Dim wb As Workbook\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim found As Range\n\n    Set wb = ThisWorkbook\n    Set sht1 = wb.Sheets(\"Sheet1\")\n    Set sht2 = wb.Sheets(\"Sheet2\")\n\n    j = \"Name\"\n    b = \"City\" \n\n    For i = 1 To 2\n        ' always advisable to specify .Value rather than assuming it will be the default property    \n        k = sht1.Range(\"A\" &amp; i).Value\n        L = sht1.Range(\"B\" &amp; i).Value\n\n        Set found = sht2.Cells.Find(What:=j, _\n                                    LookIn:=xlValues, _\n                                    LookAt:=xlWhole, _\n                                    After:=sht2.Cells(sht2.Rows.Count, sht2.Cells.Count), _\n                                    SearchOrder:=xlByRows, _\n                                    SearchDirection:=xlNext, _\n                                    MatchCase:=False, _\n                                    SearchFormat:=False)\n        If Not found Is Nothing Then\n            found.Value = k\n        End If\n\n        Set found = sht2.Cells.Find(What:=b, _\n                                    LookIn:=xlValues, _\n                                    LookAt:=xlWhole, _\n                                    After:=sht2.Cells(sht2.Rows.Count, sht2.Cells.Count), _\n                                    SearchOrder:=xlByRows, _\n                                    SearchDirection:=xlNext, _\n                                    MatchCase:=False, _\n                                    SearchFormat:=False)\n        If Not found Is Nothing Then\n            found.Value = L\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": false, "score": 1, "last_activity_date": 1490771206, "last_edit_date": 1490771206, "creation_date": 1490770871, "answer_id": 43086504, "question_id": 43084102, "link": "https://stackoverflow.com/questions/43084102/find-and-replace-in-a-loop-using-macro-in-excel/43086504#43086504", "title": "Find and replace in a loop using macro in Excel", "body": "<p>This should work.  The loop searches for each Name and City in sht1 and replaces the first occurrence in columns \"A\" and \"C\" of sht2:</p>\n\n<pre><code>Sub testLoopPaste()\n  Dim i As Long\n  Dim wb As Workbook\n  Dim sht1 As Worksheet, sht2 As Worksheet\n\n  Set wb = ThisWorkbook\n  Set sht1 = wb.Sheets(\"Sheet1\")\n  Set sht2 = wb.Sheets(\"Sheet2\")\n\n  Dim Loc As Range\n  For i = 1 To sht1.Range(\"A\" &amp; sht1.Rows.Count).End(xlUp).row\n   Set Loc = sht2.Columns(1).Find(What:=\"Name\")\n   If Not Loc Is Nothing Then Loc.Value = sht1.Cells(i, \"A\")\n   Set Loc = sht2.Columns(3).Find(What:=\"City\")\n   If Not Loc Is Nothing Then Loc.Value = sht1.Cells(i, \"B\")\n  Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1873, "user_id": 3893729, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/dae6e19fc9f20b5452627fa2fe22d6fc?s=128&d=identicon&r=PG&f=1", "display_name": "MFR", "link": "https://stackoverflow.com/users/3893729/mfr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2543, "favorite_count": 0, "accepted_answer_id": 43086392, "answer_count": 2, "score": 2, "last_activity_date": 1490771799, "creation_date": 1490760205, "last_edit_date": 1490765904, "question_id": 43084102, "link": "https://stackoverflow.com/questions/43084102/find-and-replace-in-a-loop-using-macro-in-excel", "title": "Find and replace in a loop using macro in Excel", "body": "<p>I have two sheets. Sheet 1 contains the following data</p>\n\n<p><strong>Sheet 1:</strong></p>\n\n<pre><code>Column 1  column 2 \nHotel A   New York \nHotel B   Melbourne \n</code></pre>\n\n<p>And I wish to replace the value in sheet 2 with this value </p>\n\n<p><strong>Sheet 2 is like that :</strong></p>\n\n<pre><code>Column 1    Column 2   Column 3\n\nName        ....        .....\n.....       ....        City \n....        ....        ....\nName        ....        .....\n....        .....       City \n</code></pre>\n\n<p>My ideal output will be :</p>\n\n<pre><code>Column1     Column 2    Column 3\n\nHotel A     ....        .....\n.....       ....        New York \n....        ....        ....\nHotel B     ....        .....\n....        ....        Melbourne  \n</code></pre>\n\n<p>So, I wish to go through a loop in <code>sheet 1</code> and read the name and city of hotels and go to <code>sheet 2</code> and find the words <code>Name</code> and <code>City</code> and replace them with what I read in <code>sheet 1</code>. I'm very new in VBA and started my code like that and it even goes to loop. Why is it so? </p>\n\n<pre><code>Sub testLoopPaste()\n   Dim j, k, L, b As String\n   Dim i As Long\n   Dim wb As Workbook\n   Dim sht1 As Worksheet\n   Dim sht2 As Worksheet\n\n  Set wb = ThisWorkbook\n  Set sht1 = wb.Sheets(\"Sheet1\")\n  Set sht2 = wb.Sheets(\"Sheet2\")\n\n   j = \"Name\"\n   b = \"City\" \n\n   For i = 1 To 2\n\n    k = sht1.Range(\"A\" &amp; i)\n    L = sht1.Range(\"B\" &amp; i)\n\n    sht2.Cells.Replace what:=j, replacement:=k, lookat:=xlWhole, MatchCase:=False\n    sht2.Cells.Replace what:=b, replacement:=L, lookat:=xlWhole, MatchCase:=False\n\n  Next i\n\n End Sub\n</code></pre>\n\n<p>Any tips or guidance is appreciated. </p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1490763839, "post_id": 43084010, "comment_id": 73251891, "body": "If the array is declared as string type then do you want to concatenate?Try &amp; instead of + for concatenation. If you want to save number data then why isn&#39;t the array a number type?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1490765324, "post_id": 43084010, "comment_id": 73252417, "body": "What did you <code>Dim myarray() As ?</code> Assuming it&#39;s arithmetic with Double data type, you can <code>myarray(1) = CDbl(myarray(1)) + Cells(2,4).Value</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1490765807, "post_id": 43084010, "comment_id": 73252596, "body": "If your <code>myarray</code> is declared as <code>String</code>, then you meant to use <code>myarray(1) = myarray(1) &amp; Cells(2,4)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1490820127, "post_id": 43086983, "comment_id": 73289113, "body": "<i>(+1)</i> In any other programming language you&#39;d get a dozen upvotes for this. In VBA it is considered kind of common sense that string additions require an <code>&amp;</code> and not a <code>+</code>."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1490772271, "creation_date": 1490772271, "answer_id": 43086983, "question_id": 43084010, "link": "https://stackoverflow.com/questions/43084010/having-an-array-receive-its-own-value/43086983#43086983", "title": "Having an array receive its own value", "body": "<p>If your <code>myarray</code> is declared as <code>String</code>, then you meant to use:</p>\n\n<pre><code>myarray(1) = myarray(1) &amp; Cells(2,4)\n</code></pre>\n\n<p><strong>If</strong> you want to add <code>Numeric</code> values, then first you need to declare:</p>\n\n<pre><code>Dim myarray() As Long\n</code></pre>\n\n<p>And afterwards, you can add with <code>+</code>, by :</p>\n\n<pre><code>myarray(1) = myarray(1) + Cells(2,4)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7724817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e14c542f36b66f3db1f4864fa978c3?s=128&d=identicon&r=PG&f=1", "display_name": "Isoka", "link": "https://stackoverflow.com/users/7724817/isoka"}, "is_accepted": false, "score": 0, "last_activity_date": 1490792839, "creation_date": 1490792839, "answer_id": 43094442, "question_id": 43084010, "link": "https://stackoverflow.com/questions/43084010/having-an-array-receive-its-own-value/43094442#43094442", "title": "Having an array receive its own value", "body": "<p>Thank you, declaring the array as Long did the job. I wanted to add numeric values but was confused with all variable types. I thought String would cover all. Beginner...\nBest regards,</p>\n"}], "owner": {"reputation": 31, "user_id": 7724817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e14c542f36b66f3db1f4864fa978c3?s=128&d=identicon&r=PG&f=1", "display_name": "Isoka", "link": "https://stackoverflow.com/users/7724817/isoka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1490792839, "creation_date": 1490759728, "last_edit_date": 1490764096, "question_id": 43084010, "link": "https://stackoverflow.com/questions/43084010/having-an-array-receive-its-own-value", "title": "Having an array receive its own value", "body": "<p>I am trying to have an array receive its own value plus a specific cell value:</p>\n\n<pre><code>myarray(1) = myarray(1) + Cells(2,4)\n</code></pre>\n\n<p>But I get error \"13\": Incompatible types (translated from Portuguese)</p>\n\n<p>I have verified that if I make it:</p>\n\n<pre><code>myarray(1) = Cells(2,4)\n</code></pre>\n\n<p>It works.</p>\n\n<p>The array has been declared as string.</p>\n\n<p>Please help me out figuring out how to do this.\nBest regards,</p>\n"}]