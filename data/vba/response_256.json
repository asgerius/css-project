[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1575501794, "post_id": 59185950, "comment_id": 104592153, "body": "Int limit in VBA is about 32,000"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1575501986, "post_id": 59185950, "comment_id": 104592206, "body": "<code>Case Is &gt;= 1, Is &lt;= 30</code> could be <code>Case 1 To 30</code>"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1575502040, "post_id": 59185950, "comment_id": 104592222, "body": "Intergers are signed in <code>VBA</code> so the range is much lower than you suspect: <code>-32768</code> to <code>+32768</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575502193, "post_id": 59185950, "comment_id": 104592270, "body": "^ Technically the upper limit is <code>32767</code>. OP - worth giving <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/data-type-summary\" rel=\"nofollow noreferrer\">this</a> a read."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1575503072, "post_id": 59185950, "comment_id": 104592533, "body": "As soon as <code>Is &gt;= 1</code> evaluates to true, the other test on that line is not evaluated that&#39;s the category you get"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "edited": false, "score": 3, "creation_date": 1575503520, "post_id": 59185950, "comment_id": 104592647, "body": "According to <a href=\"https://www.techonthenet.com/excel/formulas/case.php\" rel=\"nofollow noreferrer\">link</a>[link], &quot;Conditions that are evaluated in the order listed. Once a condition is found to be true, it will execute the corresponding code and not evaluate the conditions any further.&quot;, so as Tim said, once <code>Is &gt;= 1</code>, it stops."}, {"owner": {"reputation": 23450, "user_id": 1119621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1c27460726e749686f8765822d9b570c?s=128&d=identicon&r=PG", "display_name": "Metafaniel", "link": "https://stackoverflow.com/users/1119621/metafaniel"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1575579583, "post_id": 59185950, "comment_id": 104624245, "body": "@All Thank you. I changed the variable to be <code>Long</code> instead of <code>Integer</code> and as @Tim Williams said, my syntaxis was wrong; what I meant was: <code>Case 1 To 30</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23450, "user_id": 1119621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1c27460726e749686f8765822d9b570c?s=128&d=identicon&r=PG", "display_name": "Metafaniel", "link": "https://stackoverflow.com/users/1119621/metafaniel"}, "edited": false, "score": 0, "creation_date": 1575579734, "post_id": 59186236, "comment_id": 104624312, "body": "My syntaxis was wrong. What I meant was <code>Case 1 To 30</code> as @Tim Williams commented above, in the question. So that&#39;s why I always got &quot;Category B&quot;, because it always was evaluated to 1. Thanks again!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1575503427, "creation_date": 1575503427, "answer_id": 59186236, "question_id": 59185950, "link": "https://stackoverflow.com/questions/59185950/how-to-write-a-select-case-condition-for-an-interval-of-integers/59186236#59186236", "title": "How to write a Select Case condition for an interval of integers?", "body": "<p>You <code>Case</code> evaluation ends as soon as the first test passes.</p>\n\n<p>For example: </p>\n\n<pre><code>Sub Tester()\n\n    Dim a As Long\n\n    a = 20\n\n    Select Case a\n        Case Is &lt;= 0: Debug.Print \"zero or less\"\n        Case Is &gt;= v1, Is &lt;= v15: Debug.Print \"1-15\"\n        Case Is &gt;= 16, Is &lt;= 30: Debug.Print \"16-30\"\n    End Select\nEnd Sub\n\nFunction v1()\n    Debug.Print \"Called v1\"\n    v1 = 1\nEnd Function\n\nFunction v15()\n    Debug.Print \"Called v15\"\n    v15 = 15\nEnd Function\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Called v1\n1-15\n</code></pre>\n\n<p>So v15 is never called because that test is skipped.</p>\n"}], "owner": {"reputation": 23450, "user_id": 1119621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1c27460726e749686f8765822d9b570c?s=128&d=identicon&r=PG", "display_name": "Metafaniel", "link": "https://stackoverflow.com/users/1119621/metafaniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 59186236, "answer_count": 1, "score": 0, "last_activity_date": 1578761500, "creation_date": 1575501365, "last_edit_date": 1578761500, "question_id": 59185950, "link": "https://stackoverflow.com/questions/59185950/how-to-write-a-select-case-condition-for-an-interval-of-integers", "title": "How to write a Select Case condition for an interval of integers?", "body": "<p>I'm trying to read the values of every row in an Excel sheet in a certain column and set a text in another column depending on the numeric value.</p>\n\n<p>I'm facing an overflow error using <code>CInt</code> function. I want to be certain the value I get is used as an Integer. The greatest value I have in that column is <em>43803</em> so Integer should be enough. However, I read I need to use Long for referring to columns/rows in code, so I changed <code>CInt</code> to <code>CLng</code>. Now the overflow error is gone but <em>ALL</em> rows are considered <em>Category B</em>.</p>\n\n<p>My lowest numeric value in the column is <em>329</em>.</p>\n\n<pre><code>Sub insertColumnCategory()\n    Dim cellValue As Long\n    Dim lastColumn As Long\n    Dim lastRow As Long\n    Dim i As Long\n\n    lastColumn = ActiveSheet.Range(\"A1\").CurrentRegion.Columns.Count + 1\n\n    Columns(lastColumn).Insert\n    ActiveSheet.Columns(lastColumn).NumberFormat = \"General\"\n\n    With ActiveSheet\n       lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    End With\n\n    For i = 2 To lastRow\n        cellValue = CLng(Cells(i, 21).Value)\n\n        Select Case cellValue\n        Case Is &lt;= 0\n            Cells(i, 22).Value = \"Category A\"\n        Case Is &gt;= 1, Is &lt;= 30\n            Cells(i, 22).Value = \"Category B\"\n        Case Is &gt;= 31, Is &lt;= 60\n            Cells(i, 22).Value = \"Category C\"\n        Case Is &gt;= 61, Is &lt;= 90\n            Cells(i, 22).Value = \"Category D\"\n        Case Is &gt;= 91, Is &lt;= 180\n            Cells(i, 22).Value = \"Category E\"\n        Case Is &gt;= 181, Is &lt;= 365\n            Cells(i, 22).Value = \"Category F\"\n        Case Is &gt; 365\n            Cells(i, 22).Value = \"Category G\"\n        End Select\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "foreach", "range", "union"], "comments": [{"owner": {"reputation": 2323, "user_id": 579123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5681309a3b72965a9e5e4651fd38416b?s=128&d=identicon&r=PG&f=1", "display_name": "ItsPete", "link": "https://stackoverflow.com/users/579123/itspete"}, "edited": false, "score": 0, "creation_date": 1575501127, "post_id": 59185893, "comment_id": 104591983, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/44164753/method-union-of-object-global-failed\">Method &#39;Union&#39; of Object &#39;_Global&#39; failed</a>"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "edited": false, "score": 0, "creation_date": 1575517701, "post_id": 59185893, "comment_id": 104595665, "body": "try changing it to <code>Set allRG = Union(chuteRG, stowRG, pickRG, shipdockRG)</code>, so omit the <code>.Cells</code> part, because that works on my sheet."}, {"owner": {"reputation": 1, "user_id": 12161409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3882d62bf584d4822ed7be2107249d40?s=128&d=identicon&r=PG&f=1", "display_name": "SJD", "link": "https://stackoverflow.com/users/12161409/sjd"}, "edited": false, "score": 0, "creation_date": 1575545164, "post_id": 59185893, "comment_id": 104606570, "body": "Still not working :/ .. By chance a specific reference I would need for this?"}], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "edited": false, "score": 0, "creation_date": 1575517638, "post_id": 59186275, "comment_id": 104595650, "body": "Ok try changing it to <code>Set allRG = Union(chuteRG, stowRG, pickRG, shipdockRG)</code>, so omit the <code>.Cells</code> part, because that works on my sheet."}], "tags": [], "owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "is_accepted": false, "score": 0, "last_activity_date": 1575503774, "creation_date": 1575503774, "answer_id": 59186275, "question_id": 59185893, "link": "https://stackoverflow.com/questions/59185893/looping-through-ranges-union/59186275#59186275", "title": "Looping through Ranges - Union", "body": "<p>This should do the trick. You need to add <code>ApXL.</code> before calling <code>Union</code>. </p>\n\n<pre><code>Dim chuteRG As Range, stowRG As Range, pickRG As Range, shipdockRG As Range, allRG As Range\nDim cell As Range\n\nSet chuteRG = shChuteBowler.Range(\"F4:S18\")\nSet stowRG = shStowBowler.Range(\"F4:S14\")\nSet pickRG = shPickBowler.Range(\"F4:S12\")\nSet shipdockRG = shShipDockBowler.Range(\"F4:S17\")\n\nSet allRG = ApXL.Union(chuteRG, stowRG, pickRG, shipdockRG).Cells 'AMENDED\n\nFor Each cell In allRG\n    If cell = \"0\" Then\n        cell = \"X\"\n    End If\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12161409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3882d62bf584d4822ed7be2107249d40?s=128&d=identicon&r=PG&f=1", "display_name": "SJD", "link": "https://stackoverflow.com/users/12161409/sjd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575515343, "creation_date": 1575500956, "last_edit_date": 1575515343, "question_id": 59185893, "link": "https://stackoverflow.com/questions/59185893/looping-through-ranges-union", "title": "Looping through Ranges - Union", "body": "<p>I am getting an error while trying to loop through my ranges.. \"Method 'Union' of '_Global' failure\". Please someone help...After the update code I got, \"Unable to get the Union property of the Application class\"</p>\n\n<pre><code>    Dim chuteRG As Range, stowRG As Range, pickRG As Range, shipdockRG As Range, allRG As Range\n    Dim cell As Range\n\n    Set chuteRG = shChuteBowler.Range(\"F4:S18\")\n    Set stowRG = shStowBowler.Range(\"F4:S14\")\n    Set pickRG = shPickBowler.Range(\"F4:S12\")\n    Set shipdockRG = shShipDockBowler.Range(\"F4:S17\")\n    Set allRG = Union(chuteRG, stowRG, pickRG, shipdockRG).Cells\n\n    For Each cell In allRG\n        If cell = \"0\" Then\n            cell = \"X\"\n        End If\n    Next cell\n\n\nUPDATED - Still not working\n\n    Dim chuteRG As Range, stowRG As Range, pickRG As Range, shipdockRG As Range, allRG As Range\n    Dim cell As Range\n    Dim ApXL As Object\n\n    Set ApXL = CreateObject(\"Excel.Application\")\n    Set chuteRG = shChuteBowler.Range(\"F4:S18\")\n    Set stowRG = shStowBowler.Range(\"F4:S14\")\n    Set pickRG = shPickBowler.Range(\"F4:S12\")\n    Set shipdockRG = shShipDockBowler.Range(\"F4:S17\")\n\n    Set allRG = ApXL.Union(chuteRG, stowRG, pickRG, shipdockRG).Cells\n\n    For Each cell In allRG\n        If cell = \"0\" Then\n            cell = \"X\"\n        End If\n    Next cell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1575504998, "creation_date": 1575504998, "answer_id": 59186430, "question_id": 59185879, "link": "https://stackoverflow.com/questions/59185879/extract-graph-as-image/59186430#59186430", "title": "Extract graph as image", "body": "<pre><code>Dim objCht As ChartObject\nFor Each objCht In ActiveSheet.ChartObjects\n    If objCht.Chart.ChartTitle.Text = \"Tuesday\" Then\n        'Use your code to export \nNext objCht\n</code></pre>\n\n<p>It would be simpler if you simply named your chart \"Tuesday\".  You could just export it immediately without looping thru every other chart on the sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/EASXR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EASXR.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 12482627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e94e186234928775752733e94fc9830?s=128&d=identicon&r=PG&f=1", "display_name": "julian.green", "link": "https://stackoverflow.com/users/12482627/julian-green"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1607456659, "creation_date": 1575500826, "last_edit_date": 1607456659, "question_id": 59185879, "link": "https://stackoverflow.com/questions/59185879/extract-graph-as-image", "title": "Extract graph as image", "body": "<p>I'm trying to extract graphs from a sheet, based on the title of the graph.</p>\n<p>For example, I have five sets of graphs on a sheet, each named by every working day of the week. I would like to extract for only the graphs which have &quot;tuesday&quot; in the graph title.</p>\n<p>After researching online and finding how to extract all graphs as image I tried:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Dim objCht as ChartObject\nFor each objCht in Activesheet.Chartobjects\nobjCht.Chart.ChartTitle(&quot;Tuesday&quot;).Export &quot;C:\\folder\\&quot; &amp; objcht.topleftcell.Value &amp; &quot;.jpg&quot;, &quot;JPG&quot;\nnext objCht\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "tabs"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1575552410, "post_id": 59187572, "comment_id": 104610548, "body": "Buddy, I can&#39;t thank you enough! It worked perfectly! I even could add more tabs and the codes are working! May god bless you!! I tried to give you a vote but this message appeared &quot;Thanks for the feedback! Votes cast by those with less than 15 reputation are recorded, but do not change the publicly displayed post score&quot;. If there is anything I can do to help you, please let me know. And again, THANK YOU, you saved me!"}, {"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1575554212, "post_id": 59187572, "comment_id": 104611523, "body": "Hi again, buddy. I add more tabs and I noticed that, sometimes, specially when the website is taking more time to open, the code &quot;jump&quot; that tab to the next (I add On Error Resume Next, before that, it was an 424 error) without add the numbers. Do you have any idea how to solve this? Thanks again!"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1575602884, "post_id": 59187572, "comment_id": 104630452, "body": "Try to wait for some more seconds and check whether it helps or not. For that you need to modify the value in this line. Application.Wait (Now + TimeValue(&quot;0:00:05&quot;))  Try to wait for more then loading time of the page. Also I suggest you to wait before opening every new tab."}, {"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1575911048, "post_id": 59187572, "comment_id": 104716727, "body": "Hi, buddy! I&#39;m sorry to take too long to answer, I had a rough weekend. I tried different delays, as you said, but even so, sometimes it works and sometimes it doesn&#39;t work. Do you have any other idea about how to solve this issue? I don&#39;t know very well about the rules here, but may I post the full code, by clicking on &quot;Answer Your Question&quot;, sou you can see the full code? Thanks and have a great week!"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1575960560, "post_id": 59187572, "comment_id": 104731734, "body": "You can try to edit your original post and post your full code or you can try to create a new thread with your full code as this thread is already answered. Please make sure that you remove all the confidential information in your code and replace it with dummy values. If you edit the original post then please try to inform us via posting the comment. We will try to check it. Thanks for your understanding."}, {"owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1576001700, "post_id": 59187572, "comment_id": 104753390, "body": "Hi, buddy. Thank you so much for your attention again! I posted the full code and my other problems in other topic. It would be a tremendous help if you could take a look again. Have a great day! Here&#39;s the link <a href=\"https://stackoverflow.com/questions/59273161/vba-automation-macro-isnt-working-very-well-on-ie-tabs\" title=\"vba automation macro isnt working very well on ie tabs\">stackoverflow.com/questions/59273161/&hellip;</a>"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "edited": false, "score": 0, "creation_date": 1576032449, "post_id": 59187572, "comment_id": 104763158, "body": "I tried to provide suggestion on new thread. Please check it in new thread. Thanks for your understanding."}], "tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": true, "score": 0, "last_activity_date": 1575514903, "creation_date": 1575514903, "answer_id": 59187572, "question_id": 59185805, "link": "https://stackoverflow.com/questions/59185805/vba-automation-macro-isnt-working-on-ie-tabs/59187572#59187572", "title": "VBA Automation (macro) isn&#39;t working on IE tabs?", "body": "<p>I tried to test your code on my side and found that after you open the second tab, your IE object still referring the first tab and inserting the value in it.</p>\n\n<p>I try to modify your code added some code in it to find and move to the second tab and insert the value in that tab.</p>\n\n<pre><code>Sub demo()\n\n    Dim i As Long\n    Dim URL As String\n    Dim IE As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n\n    IE.Visible = True\n\n\n    URL = \"https://servicos.ibama.gov.br/ctf/publico/areasembargadas/ConsultaPublicaAreasEmbargadas.php\"\n\n\n    IE.Navigate2 URL\n\n    Do While IE.readyState = 4: DoEvents: Loop   'Do While\n    Do Until IE.readyState = 4: DoEvents: Loop   'Do Until\n\n\n    IE.document.getElementById(\"num_cpf_cnpj\").Value = \"demo\" 'Sheets(\"Main\").Range(\"C10\")\n    IE.document.getElementById(\"Emitir_Certificado\").Click\n\n\n    IE.Navigate2 \"http://www.cnj.jus.br/improbidade_adm/consultar_requerido.php?validar=form\", 2048&amp;\n\n\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\n\n    Set IE = GetIE(\"http://www.cnj.jus.br/improbidade_adm/consultar_requerido.php?validar=form\")\n\n\n    IE.document.getElementById(\"num_cpf_cnpj\").Value = \"demo1\"\n    'Unload IE\n   ' Set IE = Nothing\n   ' Set objElement = Nothing\n   ' Set objCollection = Nothing\n\nEnd Sub\n\n\nFunction GetIE(sLocation As String) As Object\n\n    Dim objShell As Object, objShellWindows As Object, o As Object\n    Dim sURL As String\n    Dim retVal As Object\n\n    Set retVal = Nothing\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objShellWindows = objShell.Windows\n\n    For Each o In objShellWindows\n        sURL = \"\"\n        On Error Resume Next  'because may not have a \"document\" property\n        'Check the URL and if it's the one you want then\n        ' assign the window object to the return value and exit the loop\n        sURL = o.document.Location\n        On Error GoTo 0\n        If sURL Like sLocation &amp; \"*\" Then\n            Set retVal = o\n            Exit For\n        End If\n    Next o\n\n    Set GetIE = retVal\n\nEnd Function\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LyRWF.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LyRWF.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Further, you can try to modify the code example as per your requirement.</p>\n"}], "owner": {"reputation": 47, "user_id": 12391978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef612bae163af4155bba8c4a6d1033ff?s=128&d=identicon&r=PG&f=1", "display_name": "Nilton", "link": "https://stackoverflow.com/users/12391978/nilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 59187572, "answer_count": 1, "score": 0, "last_activity_date": 1575514903, "creation_date": 1575500325, "last_edit_date": 1575500785, "question_id": 59185805, "link": "https://stackoverflow.com/questions/59185805/vba-automation-macro-isnt-working-on-ie-tabs", "title": "VBA Automation (macro) isn&#39;t working on IE tabs?", "body": "<p>I'm new here, I don't speak english very well, it's my first question and I'm new on VBA so, please, take easy on me =D</p>\n\n<p>I was trying to run a macro to automatize some procedures on IE. My macro worked very well when opened on <strong>windows</strong>, but when I tried to run the same macro on <strong>tabs</strong> it didn't work. It seems (maybe) the macro isn't recognizing the actual tab. Could you help me, please, guys? I'm kinda desperate and my boss is almost killing me o deliver this solution. Thanks!</p>\n\n<pre><code>Dim ie As Object\nDim dic As HTMLDocument\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\nie.Visible = True\nOn Error Resume Next\nie.navigate \"https://servicos.ibama.gov.br/ctf/publico/areasembargadas/ConsultaPublicaAreasEmbargadas.php\"\n\nDo While ie.Busy\n  Application.Wait DateAdd(\"s\", 1, Now)\nLoop        \nSet doc = ie.document    \n'IE.document.getElementById(\"num_cpf_cnpj\").Value = \"1234\"\nOn Error Resume Next\ndoc.getElementById(\"num_cpf_cnpj\").Value = Sheets(\"Main\").Range(\"C10\")\ndoc.getElementById(\"Emitir_Certificado\").Click\n\n                                       *until here works fine*                 \n\nie.Visible = True\nie.navigate \"http://www.cnj.jus.br/improbidade_adm/consultar_requerido.php?validar=form\", CLng(2048)\n\nDo While ie.Busy\n  Application.Wait DateAdd(\"s\", 1, Now)\nLoop\n\nSet doc = ie.document\ndocument.getElementById(\"num_cpf_cnpj\").Value = Sheets(\"Main\").Range(\"C10\")    ---&gt;&gt;&gt;&gt;&gt;&gt;    *but this line doesn't work, the tab opens but nothing happens*  \n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 8302747, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0DMdgAgEpt8/AAAAAAAAAAI/AAAAAAAAAPs/AaoNXf_Fih4/photo.jpg?sz=128", "display_name": "Rachel Organist", "link": "https://stackoverflow.com/users/8302747/rachel-organist"}, "edited": false, "score": 0, "creation_date": 1575556852, "post_id": 59185824, "comment_id": 104613089, "body": "What a silly thing to miss (the newline)... I think I had been staring at it for too long :) However, I fixed that and I&#39;m getting the same error. The lack of a closing <code>&#39;</code> does look a bit odd, but you can see it&#39;s contained in the second <code>.Replace</code> line in the section <code>&quot;&#39;!$&quot;</code> (although I did notice there were extra spaces just now... I removed those and I&#39;m still getting the error)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 97, "user_id": 8302747, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0DMdgAgEpt8/AAAAAAAAAAI/AAAAAAAAAPs/AaoNXf_Fih4/photo.jpg?sz=128", "display_name": "Rachel Organist", "link": "https://stackoverflow.com/users/8302747/rachel-organist"}, "edited": false, "score": 0, "creation_date": 1575560863, "post_id": 59185824, "comment_id": 104615295, "body": "You still need to be able to set a valid formula in the first place - if the inserted formula is not valid then it will throw an error."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1575500483, "creation_date": 1575500483, "answer_id": 59185824, "question_id": 59185655, "link": "https://stackoverflow.com/questions/59185655/formulaarray-produces-error-1004-and-error-424/59185824#59185824", "title": "FormulaArray produces error 1004 and error 424", "body": "<p>You need a newline before the <code>.FormulaArray</code></p>\n\n<pre><code>For k = LastRow + 4 To LastRow + 3 + KeyListIndex\n  FormulaArrayString = \"=MIN(IF('\" &amp; KeyDataRange &amp; \"='\" &amp; DataFindingsTab &amp; \"'!$A\" &amp; CStr(k) &amp; \",'\" &amp; DateDataRange &amp; \"))\"\n  With Sheets(DataFindingsTab).Cells(k, 2)\n    .FormulaArray = \"=MIN(IF('KeyDataRange='\" &amp; DataFindingsTab &amp; \"'!$A\" &amp; CStr(k) &amp; \",'DateDataRange))\"\n    .Replace \"KeyDataRange\", TabName &amp; \" '!$\" &amp; Number2Letter(KeyCol) &amp; \"$2:$\" &amp; Number2Letter(KeyCol) &amp; \"$\" &amp; CStr(LastDetailRow)\n    .Replace \"DateDataRange\", TabName &amp; \" '!$\" &amp; Number2Letter(DateCol) &amp; \"$2:$\" &amp; Number2Letter(DateCol) &amp; \"$\" &amp; CStr(LastDetailRow)\n  End With\nNext k\n</code></pre>\n\n<p>...but your formula looks off on that line (missing an ending <code>'</code> ?)</p>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 8302747, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0DMdgAgEpt8/AAAAAAAAAAI/AAAAAAAAAPs/AaoNXf_Fih4/photo.jpg?sz=128", "display_name": "Rachel Organist", "link": "https://stackoverflow.com/users/8302747/rachel-organist"}, "is_accepted": false, "score": 0, "last_activity_date": 1575558498, "creation_date": 1575558498, "answer_id": 59198029, "question_id": 59185655, "link": "https://stackoverflow.com/questions/59185655/formulaarray-produces-error-1004-and-error-424/59198029#59198029", "title": "FormulaArray produces error 1004 and error 424", "body": "<p>I solved it!</p>\n\n<p>I had forgotten something I read when about using <code>.Replace</code> to shorten array formulas--the shortened version with your placeholders still needs to be syntactically correct. Tim Williams' question about the closing <code>'</code> actually was part of the issue--even though everything looked OK once the <code>.Replace</code>s were done, Excel didn't like that what I was putting into <code>.ArrayFormula</code> wasn't syntactically correct.</p>\n\n<p>Here's the code that works:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    For k = LastRow + 4 To LastRow + 3 + KeyListIndex\n      With Sheets(DataFindingsTab).Cells(k, 2)\n        .FormulaArray = \"=MIN(IF(KeyDataRange='\" &amp; DataFindingsTab &amp; \"'!$A\" &amp; CStr(k) &amp; \",DateDataRange))\"\n        .Replace \"KeyDataRange\", \"'\" &amp; TabName &amp; \"'!$\" &amp; Number2Letter(KeyCol) &amp; \"$2:$\" &amp; Number2Letter(KeyCol) &amp; \"$\" &amp; CStr(LastDetailRow)\n        .Replace \"DateDataRange\", \"'\" &amp; TabName &amp; \"'!$\" &amp; Number2Letter(DateCol) &amp; \"$2:$\" &amp; Number2Letter(DateCol) &amp; \"$\" &amp; CStr(LastDetailRow)\n      End With\n    Next k\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 8302747, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0DMdgAgEpt8/AAAAAAAAAAI/AAAAAAAAAPs/AaoNXf_Fih4/photo.jpg?sz=128", "display_name": "Rachel Organist", "link": "https://stackoverflow.com/users/8302747/rachel-organist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 59185824, "answer_count": 2, "score": 1, "last_activity_date": 1579887968, "creation_date": 1575499456, "last_edit_date": 1579887968, "question_id": 59185655, "link": "https://stackoverflow.com/questions/59185655/formulaarray-produces-error-1004-and-error-424", "title": "FormulaArray produces error 1004 and error 424", "body": "<p>When trying to use an array formula I was getting:</p>\n\n<blockquote>\n  <p>Error 1004: \"Unable to set the formulaarray property of the range class\"</p>\n</blockquote>\n\n<p>Research indicated that it was because my formula was too long, so I tried a \"Replace\" trick described by others.</p>\n\n<p>I now get:</p>\n\n<blockquote>\n  <p>Runtime error '424': \"Object required\"</p>\n</blockquote>\n\n<p>on my first <code>.Replace</code> line.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>For k = LastRow + 4 To LastRow + 3 + KeyListIndex\n    FormulaArrayString = \"=MIN(IF('\" &amp; KeyDataRange &amp; \"='\" &amp; DataFindingsTab &amp; \"'!$A\" &amp; CStr(k) &amp; \",'\" &amp; DateDataRange &amp; \"))\"\n    With Sheets(DataFindingsTab).Cells(k, 2).FormulaArray = \"=MIN(IF('KeyDataRange='\" &amp; DataFindingsTab &amp; \"'!$A\" &amp; CStr(k) &amp; \",'DateDataRange))\"\n        .Replace \"KeyDataRange\", TabName &amp; \" '!$\" &amp; Number2Letter(KeyCol) &amp; \"$2:$\" &amp; Number2Letter(KeyCol) &amp; \"$\" &amp; CStr(LastDetailRow)\n        .Replace \"DateDataRange\", TabName &amp; \" '!$\" &amp; Number2Letter(DateCol) &amp; \"$2:$\" &amp; Number2Letter(DateCol) &amp; \"$\" &amp; CStr(LastDetailRow)\n    End With\nNext k\n</code></pre>\n\n<p>Variable <code>FormulaArrayString</code> is in there to check my work, and watching it confirms that it matches the working array formula lin my worksheet.</p>\n\n<p>Update: I've fixed the newline issue and also a few errant spaces I noticed, so now my code looks like this but I'm still getting the error:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    For k = LastRow + 4 To LastRow + 3 + KeyListIndex\n      FormulaArrayString = \"=MIN(IF('\" &amp; KeyDataRange &amp; \"='\" &amp; DataFindingsTab &amp; \"'!$A\" &amp; CStr(k) &amp; \",'\" &amp; DateDataRange &amp; \"))\"\n      With Sheets(DataFindingsTab).Cells(k, 2)\n        .FormulaArray = \"=MIN(IF('KeyDataRange='\" &amp; DataFindingsTab &amp; \"'!$A\" &amp; CStr(k) &amp; \",'DateDataRange))\"\n        .Replace \"KeyDataRange\", TabName &amp; \"'!$\" &amp; Number2Letter(KeyCol) &amp; \"$2:$\" &amp; Number2Letter(KeyCol) &amp; \"$\" &amp; CStr(LastDetailRow)\n        .Replace \"DateDataRange\", TabName &amp; \"'!$\" &amp; Number2Letter(DateCol) &amp; \"$2:$\" &amp; Number2Letter(DateCol) &amp; \"$\" &amp; CStr(LastDetailRow)\n      End With\n    Next k\n</code></pre>\n\n<p>Is there a way to directly watch what's being passed to <code>.FormulaArray</code> so I can make certain it is what it is supposed to be?</p>\n\n<p>The formula I'm aiming for is:</p>\n\n<p><code>=MIN(IF('1| Labor'!$B$2:$B$585='BOE Post-DoD Data Findings'!$A14,'1| Labor'!$E$2:$E$585))</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1575498442, "post_id": 59185511, "comment_id": 104591231, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.replace\" rel=\"nofollow noreferrer\"><code>Range.Replace</code></a>."}, {"owner": {"reputation": 27, "user_id": 12335251, "user_type": "registered", "profile_image": "https://graph.facebook.com/1295003820671851/picture?type=large", "display_name": "Tyler Burr", "link": "https://stackoverflow.com/users/12335251/tyler-burr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575498819, "post_id": 59185511, "comment_id": 104591348, "body": "@BigBen Thanks! got it figured out."}], "owner": {"reputation": 27, "user_id": 12335251, "user_type": "registered", "profile_image": "https://graph.facebook.com/1295003820671851/picture?type=large", "display_name": "Tyler Burr", "link": "https://stackoverflow.com/users/12335251/tyler-burr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1575508542, "creation_date": 1575498390, "last_edit_date": 1575508542, "question_id": 59185511, "link": "https://stackoverflow.com/questions/59185511/how-do-i-clear-contents-of-cells-in-a-range", "title": "How do I clear contents of cells = + in a range?", "body": "<p>I'm trying to clear the contents of any cell with a value equal to + in range C1:AG2500 but I'm not quite sure how to do it. could anyone point me in the right direction?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575498560, "post_id": 59185444, "comment_id": 104591265, "body": "Important note: <code>Column</code> is not defined. Add <code>Option Explicit</code> to the top of the module and declare all variables. Also, perhaps consider using a different variable name."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1575541739, "post_id": 59185444, "comment_id": 104604679, "body": "Note that <code>Dim rowC, columnC As Integer</code> only declares <code>columnC As Integer</code> but <code>rowC As Variant</code>. In VBA you need to specify a type for <b>every</b> variable, otherwise it is <code>Variant</code> by default: <code>Dim rowC As Long, columnC As Long</code>. Additionally row counting variables need to be <code>Long</code> because Excel has more rows than fit into <code>Integer</code>. I recommend <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long/26409520#26409520\">always to use <code>Long</code> instead of <code>Integer</code></a> as there is no benefit at all in using <code>Integer</code> in VBA."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8217676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc85839441187da034597c9982dcaef?s=128&d=identicon&r=PG&f=1", "display_name": "Viola", "link": "https://stackoverflow.com/users/8217676/viola"}, "edited": false, "score": 0, "creation_date": 1575559686, "post_id": 59186677, "comment_id": 104614663, "body": "I&#39;m not seeing an area for me to accept the answer but after modified my code with the suggestions from the 3 replies, it is working now. Thanks a lot everyone!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1575507335, "creation_date": 1575507335, "answer_id": 59186677, "question_id": 59185444, "link": "https://stackoverflow.com/questions/59185444/excel-vba-worksheet-range-reference-does-not-work-properly/59186677#59186677", "title": "Excel VBA - worksheet/range reference does not work properly", "body": "<pre><code>With wsSource\n    '...\n    Set rnSource = .Range(Cells(1, 1), Cells(rowC, columnC))\nEnd With\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>With wsSource\n    '...\n    Set rnSource = .Range(.Cells(1, 1), .Cells(rowC, columnC))\nEnd With\n</code></pre>\n\n<p>...otherwise your <code>Cells()</code> calls default to the activesheet, which may not be <code>wsSource</code></p>\n"}], "owner": {"reputation": 11, "user_id": 8217676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc85839441187da034597c9982dcaef?s=128&d=identicon&r=PG&f=1", "display_name": "Viola", "link": "https://stackoverflow.com/users/8217676/viola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 59186677, "answer_count": 1, "score": 0, "last_activity_date": 1575541599, "creation_date": 1575498063, "last_edit_date": 1575541599, "question_id": 59185444, "link": "https://stackoverflow.com/questions/59185444/excel-vba-worksheet-range-reference-does-not-work-properly", "title": "Excel VBA - worksheet/range reference does not work properly", "body": "<p>I have problem with the worksheet/range initiating and I can't see why my code doesn't work. I was debugging and it seems like I had to be on a certain worksheet to make the related references to work. Can anyone please let me know what did I do wrong?</p>\n\n<pre><code>Sub salesImport()\n\nApplication.ScreenUpdating = False\n\n'Excel workbook, the source and target worksheets, and the source and target ranges.\nDim wbBook As Workbook\nDim wsSource As Worksheet\nDim wsTarget As Worksheet\nDim rnSource As Range\nDim rnTarget As Range\nDim rng As Range\nDim cIndex, rIndex1, rIndex2, rIndex3, iR, iC As Integer\nDim rowC, columnC As Integer\n\n\n'Initialize the Excel objects\nSet wbBook = ThisWorkbook\nWith wbBook\n    Set wsSource = .Worksheets(\"Sales\")\n    Set wsTarget = .Worksheets(\"Summary-Official\")\nEnd With\n\n\n'On the source worksheet, set the range to the data stored\nWith wsSource\n    rowC = .Cells.SpecialCells(xlCellTypeLastCell).row\n    columnC = .Range(\"A1\").SpecialCells(xlCellTypeLastCell).Column\n    Set rnSource = .Range(Cells(1, 1), Cells(rowC, columnC))\nEnd With\n\nWith wsTarget\n    Set rnTarget = .Range(\"B98:AM122\")\nEnd With\n\nrIndex1 = 6 'month\nrIndex2 = 10 'plant\nrIndex3 = 17 'sales\niR = 0\niC = 0\n\nFor Each Column In rnSource\n    Column.Cells(rIndex1, 1).Select\n    Dim m As String: m = Column.Cells(rIndex1, 1).Value\n    Select Case Month(DateValue(\"01 \" &amp; m &amp; \" 2012\"))\n        Case 1\n            iC = 6\n        Case 2\n            iC = 7\n        Case 3\n            iC = 8\n        Case 4\n            iC = 9\n    End Select\n    iR = findrow2(Column.Cells(rIndex2, 1), rnTarget)\n    If iR &lt;&gt; 0 Then\n        rnTarget.Cells(iR - 97, iC).Value = Column.Cells(rIndex3, 1).Value\n    End If\n    'MsgBox (\"got here\")\nNext Column\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12482520, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAsSc3UG4fnKIAFXq4S-47rlylIV57nUZwreueXLg=k-s128", "display_name": "Hassaan Butt", "link": "https://stackoverflow.com/users/12482520/hassaan-butt"}, "edited": false, "score": 0, "creation_date": 1575882113, "post_id": 59186196, "comment_id": 104701102, "body": "Hey @PuravTheGreat, yes this is really useful. One more question, what if I have to get the month name against the top 5 months? For example, in this case, how can it return me &quot; April, November, January, February&quot;? Is it possible to get them in the descending order?"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 11, "user_id": 12482520, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAsSc3UG4fnKIAFXq4S-47rlylIV57nUZwreueXLg=k-s128", "display_name": "Hassaan Butt", "link": "https://stackoverflow.com/users/12482520/hassaan-butt"}, "edited": false, "score": 0, "creation_date": 1575929626, "post_id": 59186196, "comment_id": 104724207, "body": "I&#39;m not 100% sure, but I&#39;d recommend going to the website I&#39;ve linked as it might have what you need. I personally would probably use VBA for that. Also, if you the solution helped you I&#39;d love it if you could vote for it as the best answer!"}], "tags": [], "owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "is_accepted": false, "score": 0, "last_activity_date": 1575503141, "creation_date": 1575503141, "answer_id": 59186196, "question_id": 59185373, "link": "https://stackoverflow.com/questions/59185373/match-function-returning-na/59186196#59186196", "title": "Match function returning NA", "body": "<p>Here's the tutorial I followed: <a href=\"https://www.xelplus.com/return-multiple-match-values-in-excel/\" rel=\"nofollow noreferrer\">https://www.xelplus.com/return-multiple-match-values-in-excel/</a></p>\n\n<p>I have tried to recreated your situation below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3S8iT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3S8iT.png\" alt=\"Pic of how I&#39;ve set it up\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/f6Jky.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f6Jky.png\" alt=\"Formula and output\"></a></p>\n\n<p>The formula is: <code>=IFERROR(INDEX($AY$4:$BJ$4,1,AGGREGATE(15,3,(MAX($AY$5:$BJ$5)=$AY$5:$BJ$5)/(MAX($AY$5:$BJ$5)=$AY$5:$BJ$5)*COLUMN($AY$5:$BJ$5)-COLUMN($AX$5),COLUMNS($AY$5:AY5))),\"BLANK\")</code></p>\n\n<p>The formula should be entered from column AY to BJ, and all the cases with the highest numbers will show up in one single row. I recommend recreating the solution using that website, it definitely helped a lot. </p>\n"}], "owner": {"reputation": 11, "user_id": 12482520, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAsSc3UG4fnKIAFXq4S-47rlylIV57nUZwreueXLg=k-s128", "display_name": "Hassaan Butt", "link": "https://stackoverflow.com/users/12482520/hassaan-butt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575541747, "creation_date": 1575497576, "last_edit_date": 1575541747, "question_id": 59185373, "link": "https://stackoverflow.com/questions/59185373/match-function-returning-na", "title": "Match function returning NA", "body": "<p>I have been trying to get month name against highest number of bookings but the issue is that two months have same number of bookings and a simple nested <code>INDEX MATCH</code> function returns the first month with that number of bookings. I need names for both months in different cells.</p>\n\n<p><strong>Formula:</strong></p>\n\n<pre><code>=INDEX(AY4:BJ4,1,LARGE(IF(ISNUMBER(MATCH(AY5:BJ5,LARGE(AY5:BJ5,1),0)),MATCH(COLUMN(AY5:BJ5),COLUMN(AY5:BJ5)),\"-\"),COLUMNS(BK1:BK1)))\n</code></pre>\n\n<p><strong>Table:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/wi19V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wi19V.png\" alt=\"Click on the image to view the Table\"></a></p>\n"}, {"tags": ["arrays", "excel", "vba", "array-formulas"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11511020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98d6db4c91dd70fc8d0f914e7598a3f4?s=128&d=identicon&r=PG&f=1", "display_name": "AustinM", "link": "https://stackoverflow.com/users/11511020/austinm"}, "edited": false, "score": 0, "creation_date": 1575659723, "post_id": 59185665, "comment_id": 104653678, "body": "I could be wrong, but wouldn&#39;t that entail manually entering in the data to Column1? I&#39;d be looking for a solution to work with data thousands of rows long."}, {"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "reply_to_user": {"reputation": 1, "user_id": 11511020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98d6db4c91dd70fc8d0f914e7598a3f4?s=128&d=identicon&r=PG&f=1", "display_name": "AustinM", "link": "https://stackoverflow.com/users/11511020/austinm"}, "edited": false, "score": 0, "creation_date": 1575909755, "post_id": 59185665, "comment_id": 104716133, "body": "No, you would use the formula shown in the post to populate column1.   By using absolute referencing and relative referencing, the COUNTIF figures out how many previous rows share the same as is in the current row, and appropriately labels it as &#39;payment 1&#39;, &#39;payment 2&#39;, etc."}, {"owner": {"reputation": 1, "user_id": 11511020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98d6db4c91dd70fc8d0f914e7598a3f4?s=128&d=identicon&r=PG&f=1", "display_name": "AustinM", "link": "https://stackoverflow.com/users/11511020/austinm"}, "edited": false, "score": 1, "creation_date": 1575930470, "post_id": 59185665, "comment_id": 104724489, "body": "That&#39;s pretty effective, kudos. I got it work that way."}], "tags": [], "owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1575499499, "creation_date": 1575499499, "answer_id": 59185665, "question_id": 59185367, "link": "https://stackoverflow.com/questions/59185367/how-to-horizontally-return-looked-up-values-from-duplicates-w-vba-pic/59185665#59185665", "title": "How to horizontally return looked up values from duplicates w VBA [pic]", "body": "<p>I'm sure there are very performant VBA solutions, but why not just skip all that and do it in a pivot table?</p>\n\n<p>Given your data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ARXup.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ARXup.png\" alt=\"enter image description here\"></a></p>\n\n<p>where the additional field 'Column 1' is built from the formula </p>\n\n<pre><code>=\"Payment_\" &amp; COUNTIF($A$2:A2,A2)\n</code></pre>\n\n<p>It's a snap to \"summarize as pivot table\" to this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gVCtR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gVCtR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1575916303, "creation_date": 1575916303, "answer_id": 59254703, "question_id": 59185367, "link": "https://stackoverflow.com/questions/59185367/how-to-horizontally-return-looked-up-values-from-duplicates-w-vba-pic/59254703#59254703", "title": "How to horizontally return looked up values from duplicates w VBA [pic]", "body": "<p>Ok, here's some vba code that I did over lunch.  Performs over 5000 records in less than a second.</p>\n\n<p>You will need to customize in some degree to set source and target positions in your workbook.</p>\n\n<pre><code>Sub vbaJaggedPivot()\n\n\n    'replace the Range with however you want to define your source range.\n    SourceData = Range(Cells(2, 1), Cells(5000, 2))\n\n    'set up a dictionary object  We'll collect the row's name as key, and use a collection of payments for the item\n    Dim dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    'Iterate over the spreadsheet range\n    For i = 1 To UBound(SourceData)\n\n        'add a new dictionary key and instantiate a payment collection for it if we haven't seen the current name before\n        If Not dict.Exists(SourceData(i, 1)) Then\n            Set paymentCol = New Collection\n            paymentCol.Add SourceData(i, 2)\n\n            dict.Add SourceData(i, 1), paymentCol\n\n        Else\n\n            'if we have this key, add the payment to the corresponding payment collection\n            dict(SourceData(i, 1)).Add (SourceData(i, 2))\n        End If\n\n\n    Next i\n\n\n    'identify the top left of the output area\n    Dim targetRow, targetCol\n    targetRow = 1\n    targetCol = 5\n\n    'some temporary placeholders for within the loop\n    Dim tempArray() As Variant\n    Dim key\n\n    'iterate over the dictionary keys\n    For i = 0 To dict.Count - 1\n\n        'write out the key value to the output area\n        key = dict.Keys()(i)\n        Cells(targetRow + i, targetCol) = key\n\n        'convert our collections to arrays, as these can be output with better peformance\n        '      (* a 2D array would have been best, but the jagged nature of the data makes this awkward)\n        ReDim tempArray(dict(key).Count - 1)\n        For j = 0 To dict(key).Count - 1\n            tempArray(j) = dict(key)(j + 1)\n        Next j\n\n        'write the payments out to the appropriate rows\n        Range(Cells(targetRow + i, targetCol + 1), Cells(targetRow + i, targetCol + j)) = tempArray\n\n\n    Next i\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11511020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98d6db4c91dd70fc8d0f914e7598a3f4?s=128&d=identicon&r=PG&f=1", "display_name": "AustinM", "link": "https://stackoverflow.com/users/11511020/austinm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1575916303, "creation_date": 1575497533, "last_edit_date": 1575541760, "question_id": 59185367, "link": "https://stackoverflow.com/questions/59185367/how-to-horizontally-return-looked-up-values-from-duplicates-w-vba-pic", "title": "How to horizontally return looked up values from duplicates w VBA [pic]", "body": "<p>See pic related. I'm trying to return values corresponding to duplicate cells in an array ==>horizontally. So the first instance of a lookup goes in Column E, the second instance in Column F, third in G; and so-on. I can do that with an array formula for this small bit of data:</p>\n\n<p><strong>Array Formula for Duplicates</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/bhoWn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bhoWn.png\" alt=\"enter image description here\"></a></p>\n\n<p>But here's the issue.</p>\n\n<p>Using array formulas for 5, 10, or 15,000+ rows takes quite a bit of time. <strong>Is there a VBA solution to return values corresponding to duplicate cells in an array by columns?</strong></p>\n"}, {"tags": ["excel", "xml", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1575497683, "post_id": 59185287, "comment_id": 104591017, "body": "Set <code>objResultRU.async = false</code> before <code>objResultRU.LoadXML</code>? Then again, you already have <code>objXMLHTTP.responseXML</code>, so no need to reparse."}, {"owner": {"reputation": 11, "user_id": 7727539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38b0b8ba88c72e9bda21d0f6a6f1e8b?s=128&d=identicon&r=PG&f=1", "display_name": "2borg", "link": "https://stackoverflow.com/users/7727539/2borg"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1575673828, "post_id": 59185287, "comment_id": 104658188, "body": "OK, GSerg, that might work, thank you. objResultRU is of type MSXML2.DOMDocument60. objXMLHTTP.responseXML is DOMDocument. How do I typecast objXMLHTTP.responseXML to MSXML2.DOMDocument60 so I would be able to use its properties (DocumentElement in particular)? The property exists in objXMLHTTP, but it is empty for some reason..."}, {"owner": {"reputation": 11, "user_id": 7727539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38b0b8ba88c72e9bda21d0f6a6f1e8b?s=128&d=identicon&r=PG&f=1", "display_name": "2borg", "link": "https://stackoverflow.com/users/7727539/2borg"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1575674315, "post_id": 59185287, "comment_id": 104658293, "body": "The property exists in objXMLHTTP, but it is empty for some reason. At the same time objResultRU has a value in that property after its .LoadXML works out. Alternatively, if you could explain how do I use ODataReadFeed with objXMLHTTP.responseXML as an input, that would probably resolve my questions."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1575674475, "post_id": 59185287, "comment_id": 104658316, "body": "Use <code>= New MSXML2.XMLHTTP60</code> instead of <code>= CreateObject(&quot;MSXML2.XMLHTTP&quot;)</code>."}], "owner": {"reputation": 11, "user_id": 7727539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38b0b8ba88c72e9bda21d0f6a6f1e8b?s=128&d=identicon&r=PG&f=1", "display_name": "2borg", "link": "https://stackoverflow.com/users/7727539/2borg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575497572, "creation_date": 1575497141, "last_edit_date": 1575497572, "question_id": 59185287, "link": "https://stackoverflow.com/questions/59185287/vba-msxml2-domdocument60-loadxml-loads-only-up-to-300-entry-items", "title": "VBA MSXML2.DOMDocument60 LoadXML loads only up to 300 &quot;entry&quot; items", "body": "<p>I am trying to build a report based on data from MS Project Online/SharePoint database. I am using the approach described <a href=\"https://blogs.msdn.microsoft.com/marcelolr/2010/02/17/consuming-odata-with-office-vba-part-ii/\" rel=\"nofollow noreferrer\">here</a> and it works perfectly until I encounter a table which has more than 300 records. When that happens I am getting exactly 300 \"entry\" items in my <code>objResultRF</code> collection. After some debugging it seems like if there are more than 300 records in the table, there are exactly 300 \"entry\" nodes in the <code>MSXML2.DOMDocument60</code> object after I am using its <code>.LoadXML</code> method. Could anyone please give me a hint where to look?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function ODataReadUrl(ByVal strUrl As String) As MSXML2.DOMDocument60\nDim objXMLHTTP As Object\nDim objResultRU As MSXML2.DOMDocument60\nSet objXMLHTTP = CreateObject(\"MSXML2.XMLHTTP\")\nobjXMLHTTP.Open \"GET\", strUrl, False\nobjXMLHTTP.send\nIf objXMLHTTP.Status &lt;&gt; 200 Then\n    Err.Raise ODataCannotReadUrlError, \"ODataReadUrl\", \"Unable to get \" &amp; strUrl &amp; \" \u2013 status code: \" &amp; objXMLHTTP.Status\n    Set ODataReadUrl = Nothing\nElse\n    Set objResultRU = New MSXML2.DOMDocument60\n    objResultRU.LoadXML objXMLHTTP.responseText\n    Set objXMLHTTP = Nothing\n\n    If objResultRU.parseError.ErrorCode &lt;&gt; 0 Then\n        Err.Raise ODataParseError, \"ODataReadUrl\", \"Unable to load \" &amp; strUrl &amp; \" \u2013 \" &amp; objResultRU.parseError.reason\n    End If\n    Set ODataReadUrl = objResultRU\nEnd If\nEnd Function\n\nFunction ODataReadFeed(ByVal objFeed As MSXML2.IXMLDOMElement) As Collection\n    Dim objResultRF As Collection\n    Dim objChildRF As MSXML2.IXMLDOMNode\n\n    Set objResultRF = New Collection\n\n    Set objChildRF = objFeed.FirstChild\n    While Not objChildRF Is Nothing\n        If objChildRF.NodeType = NODE_ELEMENT And _\n            objChildRF.NamespaceURI = AtomNamespace And _\n            objChildRF.baseName = \"entry\" Then\n            objResultRF.Add ODataReadEntry(objChildRF)\n        End If\n        Set objChildRF = objChildRF.NextSibling\n    Wend\n\n    Set ODataReadFeed = objResultRF\nEnd Function\n\nPrivate Function ODataReadEntry(ByVal objEntry As MSXML2.IXMLDOMElement) As Scripting.Dictionary\n    Dim objResultRE As Scripting.Dictionary\n    Dim objChildRE As MSXML2.IXMLDOMNode\n    Dim baseName As String\n\n    Set objResultRE = New Scripting.Dictionary\n\n    Set objChildRE = objEntry.FirstChild\n    While Not objChildRE Is Nothing\n        If objChildRE.NodeType = NODE_ELEMENT And _\n            objChildRE.NamespaceURI = AtomNamespace Then\n            baseName = objChildRE.baseName\n            If baseName = \"id\" Or baseName = \"title\" Or baseName = \"updated\" Then\n                Key = \"odata_\" &amp; baseName\n                Item = objChildRE.Text\n                objResultRE.Add Key, Item\n            ElseIf baseName = \"content\" Then\n                ODataReadContent objChildRE, objResultRE\n            End If\n        End If\n        Set objChildRE = objChildRE.NextSibling\n    Wend\n\n    Set ODataReadEntry = objResultRE\nEnd Function\n\nPrivate Sub ODataReadContent( _\n        ByVal objContent As MSXML2.IXMLDOMElement, _\n        ByVal objEntryDictionary As Scripting.Dictionary)\n    Dim objChildRC As MSXML2.IXMLDOMElement\n    Dim objProperties As MSXML2.IXMLDOMElement\n\n    Set objProperties = Nothing\n    Set objChildRC = objContent.FirstChild\n    While Not objChildRC Is Nothing\n        If objChildRC.NodeType = NODE_ELEMENT And _\n            objChildRC.NamespaceURI = ODataMetadataNamespace And _\n            objChildRC.baseName = \"properties\" Then\n            Set objProperties = objChildRC\n        End If\n        Set objChildRC = objChildRC.NextSibling\n    Wend\n\n    If Not objProperties Is Nothing Then\n        Set objChildRC = objProperties.FirstChild\n        While Not objChildRC Is Nothing\n            If objChildRC.NodeType = NODE_ELEMENT And _\n                objChildRC.NamespaceURI = ODataNamespace Then\n                objEntryDictionary.Add objChildRC.baseName, objChildRC.Text\n            End If\n            Set objChildRC = objChildRC.NextSibling\n        Wend\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access", "adodb", "ms-access-forms"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1575495662, "post_id": 59184996, "comment_id": 104590406, "body": "That looks like a DAO connection string, not an ADODB one. Also, this is far from a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1575496199, "post_id": 59184996, "comment_id": 104590578, "body": "<a href=\"https://stackoverflow.com/q/44030063/11683\">stackoverflow.com/q/44030063/11683</a>? <a href=\"https://stackoverflow.com/a/9703912/11683\">stackoverflow.com/a/9703912/11683</a>?"}, {"owner": {"reputation": 695, "user_id": 6524396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c2a01a7e85d6353e3c0b59481517b7c4?s=128&d=identicon&r=PG&f=1", "display_name": "sedioben", "link": "https://stackoverflow.com/users/6524396/sedioben"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1575534303, "post_id": 59184996, "comment_id": 104601026, "body": "@ErikA - This is an ADODB connectionstring."}, {"owner": {"reputation": 695, "user_id": 6524396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c2a01a7e85d6353e3c0b59481517b7c4?s=128&d=identicon&r=PG&f=1", "display_name": "sedioben", "link": "https://stackoverflow.com/users/6524396/sedioben"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1575534372, "post_id": 59184996, "comment_id": 104601040, "body": "@GSerg - Thanks, but I tried this solution to close the recordset or the connection, but the problem still persists."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1575536738, "post_id": 59184996, "comment_id": 104602084, "body": "@sedioben It isn&#39;t a valid one... Please provide your full code. ADODB strings don&#39;t start with <code>ODBC;</code>, that&#39;s a DAO thing, and you shouldn&#39;t specify a DSN and then specify driver as well as driver is already specified in the DSN. It&#39;s all sorts of weird."}, {"owner": {"reputation": 695, "user_id": 6524396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c2a01a7e85d6353e3c0b59481517b7c4?s=128&d=identicon&r=PG&f=1", "display_name": "sedioben", "link": "https://stackoverflow.com/users/6524396/sedioben"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1575543278, "post_id": 59184996, "comment_id": 104605572, "body": "@ErikA - Thanks for your comment. I corrected it and edited the post.However, I still have the same problem. Do you have an idea to solve it ?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1575543904, "post_id": 59184996, "comment_id": 104605925, "body": "Not really, only that I&#39;ve got dubious experience with the MSDASQL provider and I&#39;d try a SQL server OLEDB provider instead. I&#39;ve cast a reopen vote since now you actually have code that could work"}], "owner": {"reputation": 695, "user_id": 6524396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c2a01a7e85d6353e3c0b59481517b7c4?s=128&d=identicon&r=PG&f=1", "display_name": "sedioben", "link": "https://stackoverflow.com/users/6524396/sedioben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594233804, "creation_date": 1575495439, "last_edit_date": 1594233804, "question_id": 59184996, "link": "https://stackoverflow.com/questions/59184996/ado-inserts-causes-error-in-previous-records-on-continuous-forms-vba", "title": "ADO inserts causes #error in previous records on continuous forms vba", "body": "<p>I have a Ms Access application frontend which uses ADO to access a SQL Server 14 Database.<br>\nThere is a continuous form that is bounded with an ADODB recordset.</p>\n\n<p>I have a function for the connection string</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Function getConnectionString() As ADODB.Connection\n\n    Set getConnectionString = CreateObject(\"ADODB.connection\")\n    ' Set Connection String here!\n    getConnectionString.ConnectionString = \"Provider=MSDASQL;DRIVER=ODBC Driver 13 for SQL Server;SERVER=localhost;Trusted_Connection=Yes;DATABASE=DBNAME;Encrypt=Yes;TrustServerCertificate=Yes;\"\n    getConnectionString.CursorLocation = adUseClient\n    getConnectionString.Mode = adModeReadWrite\n\nEnd Function\n</code></pre>\n\n<p>The Cursor set up</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set Rs = New ADODB.Recordset\nRs.CursorType = adOpenKeyset\nRs.CursorLocation = adUseClient\nRs.LockType = adLockOptimistic`\n</code></pre>\n\n<p>I have a function that binds the recordset to the form. If the user is about to enter a new record, this happens:</p>\n\n<p>Form1</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>**ROWIDVENDOR**           **TICKET**\n3           LAFARGE          123654789\n4           HALTON           852369741\n5           DUFFERIN         852741639\n6           MILTON\n</code></pre>\n\n<p><em>User is about to enter data</em></p>\n\n<p>Form1</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>**ROWIDVENDOR**           **TICKET**\n3           LAFARGE          123654789\n4           HALTON           852369741\n6           #ERROR           #ERROR\n6           MILTON           123\n</code></pre>\n\n<p>Does anyone know how to handle that issue or has a workaround?</p>\n"}, {"tags": ["excel", "vba", "visibility", "onchange"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1575498145, "post_id": 59184986, "comment_id": 104591139, "body": "can you share the url or is the page behind a login? And have you tried parentWindow.execScript to fire the function or attach an htmlevent for change and dispatch it?"}, {"owner": {"reputation": 59, "user_id": 12391795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCCNqJfv0sH8NHBif37ObuD00Qm2l2QgbGsrzysXA=k-s128", "display_name": "SelpaqM", "link": "https://stackoverflow.com/users/12391795/selpaqm"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1575525647, "post_id": 59184986, "comment_id": 104597769, "body": "actually site is behind login and also behind the corporate firewall.  I have changed name of items. by the way, I did not tried parentWindow.execScript to fire the function. just tried to find fireevent &quot;onChange&quot; and cant succeed."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 12391795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCCNqJfv0sH8NHBif37ObuD00Qm2l2QgbGsrzysXA=k-s128", "display_name": "SelpaqM", "link": "https://stackoverflow.com/users/12391795/selpaqm"}, "is_accepted": true, "score": 0, "last_activity_date": 1575573574, "creation_date": 1575573574, "answer_id": 59201951, "question_id": 59184986, "link": "https://stackoverflow.com/questions/59184986/activate-onchange-function-with-vba-in-url/59201951#59201951", "title": "Activate Onchange function with VBA in URL", "body": "<p>First please make comment and help instead of editting my english grammar to earn badges etc.\nthanks to user @QHarr. I followed his foot steps. below code is solved my problem.</p>\n\n<pre><code>        Dim CurrentWindow As HTMLWindowProxy: Set CurrentWindow = ie.document.parentWindow\n        Call CurrentWindow.execScript(\"muratonChange(this)\")\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 12391795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCCNqJfv0sH8NHBif37ObuD00Qm2l2QgbGsrzysXA=k-s128", "display_name": "SelpaqM", "link": "https://stackoverflow.com/users/12391795/selpaqm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 59201951, "answer_count": 1, "score": 0, "last_activity_date": 1575573574, "creation_date": 1575495407, "last_edit_date": 1575533371, "question_id": 59184986, "link": "https://stackoverflow.com/questions/59184986/activate-onchange-function-with-vba-in-url", "title": "Activate Onchange function with VBA in URL", "body": "<p>I have to fill forms inside a web site using excel. \nThe site works like this - when choosing something from a combobox then new input boxes are activated with onchange function as below code.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;select name=\"murat\" id=\"murat\" class=\"normalText\" onchange=\"muratonChange(this);\"&gt;\n</code></pre>\n\n<pre class=\"lang-js prettyprint-override\"><code>function muratonChange(source) {\n  var muratIndex, Visibility;\n  muratIndex=source.selectedIndex\n  document.all.ayaz.style.visibility=\"visible\";\n</code></pre>\n\n<p>I can select anything inside combobox. However, input boxes are not becoming visible so I cannot change them.\nUsing below vba code to assign value to combobox</p>\n\n<pre><code>While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Do\n            DoEvents\n            On Error Resume Next\n            Set ele = ie.document.querySelector(\"murat\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While ele Is Nothing\n        If Not ele Is Nothing Then\n            ele.Click                            \n            ie.document.getElementsByName(\"murat\")(0).Value = Application.VLookup(Sheets(\"fener\").Range(\"D3\").Text, Sheets(\"bahce\").Range(\"A:B\"), 2, False)\n        End If\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "filenames", "file-copying", "save-as"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575495273, "post_id": 59184933, "comment_id": 104590294, "body": "Your <code>FileFilter</code> is off."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575495280, "post_id": 59184933, "comment_id": 104590297, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/37418708/vba-saveas-saving-as-file-type-instead-of-xlsm\">VBA SaveAs saving as File type instead of .xlsm</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1575495459, "post_id": 59184933, "comment_id": 104590349, "body": "You can&#39;t use SaveCopyAs to change the file type."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575495488, "post_id": 59184933, "comment_id": 104590358, "body": "^^^ That too :)"}], "owner": {"reputation": 3, "user_id": 11904356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06057dd2815c3c1b1c751750b661df1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/11904356/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575495100, "creation_date": 1575495100, "question_id": 59184933, "link": "https://stackoverflow.com/questions/59184933/is-there-a-way-to-use-savecopyas-with-the-dialog-custom-name-and-choosing-the-c", "title": "Is there a way to use SaveCopyAs with the dialog, custom name and choosing the current file type (format) (52 or .xlsm)", "body": "<p>I need code that will save a copy of the active workbook with a custom name, specifying the file type (.xlsm). </p>\n\n<p>I have used ActiveWorkbook.SaveCopyAs with a custom name. This will save a copy but there isn't a dialog box for the user to change the name or location if they need to and I can't seem to get it to save with the correct file extension. </p>\n\n<p>I have also used Application.GetSaveAsFileName with a custom name. This will bring up the dialog box so the user can change the location and name however it doesn't give the option to save it as .xlsm and it doesn't save a copy so the user has to reopen the original file.</p>\n\n<p>Is there a way to get the dialog box with the custom name and have it save as .xlsm? I can't seem to find anything out there with this question.</p>\n\n<p>Here is the code I have. </p>\n\n<pre><code>Private Sub cbsave_Click()\n\nDim fn As Variant\nDim wb1 As Workbook\nDim qn As String\nDim fe As String\n\nqn = \"Copy of \" &amp; Sheet11.Range(\"QN\") &amp; \" \" &amp; Format(Now, \"dd-mmm-yy h-mm-ss\")\nSet wb1 = ActiveWorkbook\nfe = \".\" &amp; LCase(Right(wb1.Name, Len(wb1.Name) - InStrRev(wb1.Name, \".\", , 1)))\n\nfn = Application.GetSaveAsFilename(InitialFileName:=\"Copy of \" &amp; Sheet11.Range(\"QN\") &amp; Format(Now, \n\"dd-mmm-yy h-mm-ss\"), filefilter:=\"Excel Files (*.xlsm), *.xlmx\")\n\n'ActiveWorkbook.SaveCopyAs FileName:=\"Copy of \" &amp; Sheet11.Range(\"QN\") &amp; Format(Now, \"dd-mmm-yy h-mm- \n ss\" &amp; \"fe\")\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "vba", "autofill"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575495150, "post_id": 59184867, "comment_id": 104590250, "body": "You&#39;d need to use <code>Application.InputBox</code>."}, {"owner": {"reputation": 1, "user_id": 12345473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NlVF753dVQw/AAAAAAAAAAI/AAAAAAAAAFs/UJoyK8BdSe0/photo.jpg?sz=128", "display_name": "user692315", "link": "https://stackoverflow.com/users/12345473/user692315"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575496910, "post_id": 59184867, "comment_id": 104590798, "body": "There isn&#39;t anyway to have the user fill in each row in a particular column with values, and use one consolidated button to output the rows? There are a lot of employees and the input box wouldn&#39;t be ideal for workflow."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575497383, "post_id": 59184867, "comment_id": 104590927, "body": "That is also an option, yes."}], "owner": {"reputation": 1, "user_id": 12345473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NlVF753dVQw/AAAAAAAAAAI/AAAAAAAAAFs/UJoyK8BdSe0/photo.jpg?sz=128", "display_name": "user692315", "link": "https://stackoverflow.com/users/12345473/user692315"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575494697, "creation_date": 1575494681, "last_edit_date": 1575494697, "question_id": 59184867, "link": "https://stackoverflow.com/questions/59184867/vba-code-to-autofill-a-variable-number-of-columns", "title": "VBA code to Autofill a variable number of Columns", "body": "<p>I'm new to using VBA, I understand how to autofill a predefined number of columns/rows, however, I'd like the user to be able to input a number into a cell, and starting with a static column/row, the code autofills however many columns the user wants(in this instance how many pay periods an employee would work.) This is what I have so far.</p>\n\n<pre><code>Option Explicit\nSub AutoFill_Test()\n'A1 here being where the total number of payperiods are found\n\nRange(\"A1\").AutoFill Destination:=Range(\"A2:D2\"), Type:=xlFillCopy\n\nEnd Sub\n</code></pre>\n\n<p>How would I modify this to achieve the desired result?\nmany thanks,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575494060, "post_id": 59184683, "comment_id": 104589878, "body": "Which is it, button or hyperlink?"}, {"owner": {"reputation": 13, "user_id": 11673152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a44dfdeade59bca88787f09b79e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Beck", "link": "https://stackoverflow.com/users/11673152/alex-beck"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575494194, "post_id": 59184683, "comment_id": 104589911, "body": "Hyperlink will work fine"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575494225, "post_id": 59184683, "comment_id": 104589918, "body": "I already have a button solution :)"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1575494242, "post_id": 59184683, "comment_id": 104589927, "body": "You can use this type of strategy to get the row number of the pressed button <a href=\"https://www.ozgrid.com/forum/index.php?thread/23933-get-column-number-of-clicked-button/\" rel=\"nofollow noreferrer\">ozgrid.com/forum/index.php?thread/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 11673152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a44dfdeade59bca88787f09b79e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Beck", "link": "https://stackoverflow.com/users/11673152/alex-beck"}, "edited": false, "score": 0, "creation_date": 1575494276, "post_id": 59184683, "comment_id": 104589940, "body": "OK, button works too :)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575494292, "post_id": 59184683, "comment_id": 104589945, "body": "Hyperlink might be better actually: <a href=\"https://stackoverflow.com/questions/32660492/running-vba-from-a-hyperlink\" title=\"running vba from a hyperlink\">stackoverflow.com/questions/32660492/&hellip;</a>. You&#39;ll just need to rewrite your sub with the parameters you need."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1575494295, "post_id": 59184683, "comment_id": 104589949, "body": "Are you looking to have one macro to loop through each row?  If so, a loop is in your future..."}, {"owner": {"reputation": 13, "user_id": 11673152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a44dfdeade59bca88787f09b79e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Beck", "link": "https://stackoverflow.com/users/11673152/alex-beck"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1575494746, "post_id": 59184683, "comment_id": 104590093, "body": "@Cyril I&#39;m looking to write one macro and have it run only on a specific row in the table. I don&#39;t want to write a separate macro for each row, so I&#39;m wondering if there is a way to scale my code to say &quot;if button A is clicked, use row 10 to generate variables; if button B is clicked, use row 11...and so on"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1575550517, "post_id": 59188274, "comment_id": 104609452, "body": "Small side note - if the HYPERLINK formula goes in P5 then you could just do ROW()."}, {"owner": {"reputation": 317, "user_id": 2113672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2uII.jpg?s=128&g=1", "display_name": "Noah Bridge", "link": "https://stackoverflow.com/users/2113672/noah-bridge"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575556520, "post_id": 59188274, "comment_id": 104612920, "body": "@BigBen, you are absolutely right! Adding the P5 was overkill. ROW() is enough to get the formula cell&#39;s current row. Thanks."}, {"owner": {"reputation": 317, "user_id": 2113672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2uII.jpg?s=128&g=1", "display_name": "Noah Bridge", "link": "https://stackoverflow.com/users/2113672/noah-bridge"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575558404, "post_id": 59188274, "comment_id": 104613973, "body": "@BigBen, as it turns out, I was wrong to use Excel&#39;s ROW function in the HYPERLINK formula. I modified the answer so that the HYPERLINK formula will call a VBA function without passing it the row number, since the function can get the row on its own from <code>ActiveCell</code>."}, {"owner": {"reputation": 13, "user_id": 11673152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a44dfdeade59bca88787f09b79e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Beck", "link": "https://stackoverflow.com/users/11673152/alex-beck"}, "edited": false, "score": 0, "creation_date": 1575590866, "post_id": 59188274, "comment_id": 104627928, "body": "@NoahBridge Thank you so much this answer was extremely helpful in getting me closer to solving this problem and also for teaching me more about VBA."}, {"owner": {"reputation": 13, "user_id": 11673152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a44dfdeade59bca88787f09b79e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Beck", "link": "https://stackoverflow.com/users/11673152/alex-beck"}, "edited": false, "score": 0, "creation_date": 1575590994, "post_id": 59188274, "comment_id": 104627961, "body": "@NoahBridge I do have one issue: I am using the HYPERLINK solution you suggested. When I click the hyperlink I get the error &quot;Reference isn&#39;t valid&quot;. However, in the VBA editor I can step-thru the SendMailByHLink function and everything works. I can&#39;t figure out the missing link, any help?"}, {"owner": {"reputation": 13, "user_id": 11673152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a44dfdeade59bca88787f09b79e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Beck", "link": "https://stackoverflow.com/users/11673152/alex-beck"}, "edited": false, "score": 1, "creation_date": 1575595087, "post_id": 59188274, "comment_id": 104628919, "body": "@NoahBridge I figured out the missing link. I had all my code on the PERSONAL.XLSB workbook (where I keep all my global macros). Once I moved the code to a module on the active workbook - it worked. Thank you so much!"}, {"owner": {"reputation": 317, "user_id": 2113672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2uII.jpg?s=128&g=1", "display_name": "Noah Bridge", "link": "https://stackoverflow.com/users/2113672/noah-bridge"}, "reply_to_user": {"reputation": 13, "user_id": 11673152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a44dfdeade59bca88787f09b79e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Beck", "link": "https://stackoverflow.com/users/11673152/alex-beck"}, "edited": false, "score": 0, "creation_date": 1575601924, "post_id": 59188274, "comment_id": 104630272, "body": "@Alex, I am glad it worked :) I think that changing the formula to <code>=HYPERLINK(&quot;#PERSONAL.XLSB!SendMailByHLink()&quot;, &quot;Send email&quot;)</code> would have resolved the &quot;Reference isn&#39;t valid&quot; message, but you may prefer to keep the code in the same workbook as the links anyway (unless you plan to use the same code across multiple workbooks)."}], "tags": [], "owner": {"reputation": 317, "user_id": 2113672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2uII.jpg?s=128&g=1", "display_name": "Noah Bridge", "link": "https://stackoverflow.com/users/2113672/noah-bridge"}, "is_accepted": true, "score": 2, "last_activity_date": 1575557917, "last_edit_date": 1575557917, "creation_date": 1575520027, "answer_id": 59188274, "question_id": 59184683, "link": "https://stackoverflow.com/questions/59184683/how-do-i-run-an-excel-macro-using-values-from-different-rows-in-a-table/59188274#59188274", "title": "How do I run an Excel macro using values from different rows in a table?", "body": "<p>This answer attempts to combine many of the good answers and comments everyone has already given. The code below contains the functionality for both buttons and hyperlinks in a condensed way. </p>\n\n<p>This code could go in one separate module:</p>\n\n<pre><code>Sub SendMailByButton()\n  SendMailForRow ActiveSheet.Buttons(Application.Caller).TopLeftCell.Row\nEnd Sub\n\nSub SendMailForRow(ByVal r As Long)\n  If r &lt; 1 Then Exit Sub 'Failsafe in case the row number is invalid\n\n  Dim xContractNumber As String, xValueInColumnM As String, xValueInColumnN As String\n\n  xContractNumber = ActiveSheet.Cells(r, 12).Value 'Col 12 is col \"L\"\n  xValueInColumnM = ActiveSheet.Cells(r, 13).Value\n  xValueInColumnN = ActiveSheet.Cells(r, 14).Value\n  '...etc.\n  '...Rest of code to send the actual email\nEnd Sub\n</code></pre>\n\n<p>If buttons are used, <code>SendMailByButton</code> must be attached to every button's click event, and the above code would be enough.</p>\n\n<p>If manually-added hyperlinks are used, the above code would need to be complemented with the following code in <strong>the sheet module</strong> for every sheet that uses the hyperlinks (in your case, you may only need to add this code in one sheet's module) ...</p>\n\n<pre><code>'This event is fired when the hyperlink is clicked\nPrivate Sub Worksheet_FollowHyperlink(ByVal target As Hyperlink)\n  On Error Resume Next\n  SendMailForRow target.Range.Row\nEnd Sub\n</code></pre>\n\n<p>Each manual hyperlink would have to link to the same cell it is sitting on (i.e. to a \"Place in This Document\" with the cell reference set to its current cell).</p>\n\n<p>The problem remains that you will need to manually create a button or hyperlink for every row in your table, which can be a hassle, especially if there are many rows or if the number of rows can grow in future.</p>\n\n<p>A way to circumvent this problem is to have an extra button at the top of the table that allows the user to automatically create the buttons and/or hyperlinks for each row of data (removing excess buttons or hyperlinks if the table shrinks in size). This may require that you post a separate question.</p>\n\n<p>Another way to circumvent this problem is to forego buttons altogether and, instead, use Excel formulas with the native <a href=\"https://exceljet.net/excel-functions/excel-hyperlink-function\" rel=\"nofollow noreferrer\">HYPERLINK</a> function (replacing the \"regular\" links). In that case, the FollowHyperlink event handler above would no longer be needed, but you would need to add the following function (which can go in the same module where <code>SendMailForRow</code> would reside) ...</p>\n\n<pre><code>Function SendMailByHLink()\n  SendMailForRow ActiveCell.Row\n  Set SendMailByHLink = ActiveCell\nEnd Function\n</code></pre>\n\n<p>You would then have to create an Excel formula such as the following in each row (in the column where you want the hyperlink) ...</p>\n\n<pre><code>=HYPERLINK(\"#SendMailByHLink()\", \"Send email\")\n</code></pre>\n\n<p>Entering this formula will auto-generate a hyperlink in the cell, and it will tell Excel to execute function <code>SendMailByHLink</code> when the hyperlink is clicked. The function after the \"#\" is supposed to return the link's target, which is why <code>SendMailByHLink</code> returns <code>ActiveCell</code> to ensure that the focus remains on that cell (if you prefer, you could return another cell such as <code>ActiveCell.Offset(, -2)</code> so that the user is taken to the cell 2 columns back in the same row after the link is clicked). Before returning <code>ActiveCell</code> to Excel, <code>SendMailByHLink</code> will execute the email-sending code.</p>\n\n<p>The nice thing about using a HYPERLINK formula is that you can easily copy/paste the formula up and down the all the rows in the table. Therefore, if your table increases in size, all the user has to do is to copy/paste the HYPERLINK formula into the new rows. The user can also delete excess HYPERLINK formulas if the table shrinks. It may even be possible to have Excel automatically copy the formula if the data is sitting on <a href=\"https://support.office.com/en-us/article/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c\" rel=\"nofollow noreferrer\">an official Excel table</a> by <a href=\"https://support.office.com/en-us/article/use-calculated-columns-in-an-excel-table-873fbac6-7110-4300-8f6f-aafa2ea11ce8\" rel=\"nofollow noreferrer\">using a calculated column</a>.</p>\n\n<p>Sorry for all the extra explanation. If you focus on the code blocks, you will see that the solution is simpler than it looks.</p>\n"}], "owner": {"reputation": 13, "user_id": 11673152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a44dfdeade59bca88787f09b79e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Beck", "link": "https://stackoverflow.com/users/11673152/alex-beck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59188274, "answer_count": 1, "score": 1, "last_activity_date": 1575557917, "creation_date": 1575493547, "last_edit_date": 1575494219, "question_id": 59184683, "link": "https://stackoverflow.com/questions/59184683/how-do-i-run-an-excel-macro-using-values-from-different-rows-in-a-table", "title": "How do I run an Excel macro using values from different rows in a table?", "body": "<p>I am writing an Excel macro to send emails from data in a spreadsheet. The data are in a table with each column providing different variables to create the email (to:, cc:, subject, attachments, etc).</p>\n\n<p>I've got the macro to do what I want on one line of the table. My question is:</p>\n\n<p>How do I scale the VBA code to work for each line of my table? I would like a hyperlink in each row to run the macro using the data in that row. Below is a small snippet of my code as an example:</p>\n\n<pre><code>Sub SendMail()\nDim xContractNumber As String\nxContractNumber = Worksheets(\"Program Info\").Range(\"L10\").Value\nEnd Sub\n</code></pre>\n\n<p>In the above example, I would like a hyperlink that runs the macro using the data in row 10 of the 'Program Info' sheet... And another button or link that would run the macro using data in row 11, and so on.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575492365, "post_id": 59184380, "comment_id": 104589251, "body": "Hmm. No repro in Office 2016 (but not 365). Does this not work in a new workbook (make sure to save first)."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1575492505, "post_id": 59184380, "comment_id": 104589320, "body": "Surely it complains about Application.Workbooks.Open(), the procedure name must be provided as a string and can&#39;t take arguments.  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.ontime\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1575493627, "post_id": 59184380, "comment_id": 104589735, "body": "At what code line does this error appear?"}], "answers": [{"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 0, "last_activity_date": 1575494011, "last_edit_date": 1575494011, "creation_date": 1575493531, "answer_id": 59184681, "question_id": 59184380, "link": "https://stackoverflow.com/questions/59184380/vba-application-ontime-error-438-object-doesnt-support-this-property-or-method/59184681#59184681", "title": "VBA Application.Ontime error 438. Object doesn&#39;t support this property or method", "body": "<p><code>Application.OnTime</code>'s second parameter is <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.ontime\" rel=\"nofollow noreferrer\">explicitly declared</a> as string, so this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Application.OnTime Now + TimeValue(\"00:00:01\"), Application.Workbooks.Open(FILENAME:=pth, Notify _\n        :=False)\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/18051644/11683\">is actually</a>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Application.OnTime Now + TimeValue(\"00:00:01\"), Application.Workbooks.Open(FILENAME:=pth, Notify _\n        :=False).DefaultPropertyOfWorkbook\n</code></pre>\n\n<p>A workbook does not have a default property, hence the \"Object doesn't support this property or method\" error.</p>\n\n<p>You have to put the code into a method and provide its name to <code>OnTime</code> as a string.</p>\n\n<p>You want to pass the already closed workbook's full path to that method, so normally you would have to register the <code>OnTime</code> call <a href=\"https://stackoverflow.com/q/31439866/11683\">with parameters</a>.</p>\n\n<p>In your case, though, you don't have to do that because all you want to do is open the workbook, and Excel remembers in which workbook the registered macro resides, and if scheduled to be called on time, it will reopen the workbook automatically just to call the macro, which is already the effect that you want. So your complete code would be:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub reopen2()\n  Application.OnTime Now + TimeValue(\"00:00:01\"), \"DoNothing\"\n\n  ThisWorkbook.Close False\nEnd Sub\n\nPublic Sub DoNothing()\nEnd Sub\n</code></pre>\n\n<p>provided it's in a regular module.</p>\n"}], "owner": {"reputation": 3, "user_id": 8564207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9fDS.jpg?s=128&g=1", "display_name": "MilaB", "link": "https://stackoverflow.com/users/8564207/milab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 59184681, "answer_count": 1, "score": 0, "last_activity_date": 1575494011, "creation_date": 1575492068, "question_id": 59184380, "link": "https://stackoverflow.com/questions/59184380/vba-application-ontime-error-438-object-doesnt-support-this-property-or-method", "title": "VBA Application.Ontime error 438. Object doesn&#39;t support this property or method", "body": "<p>I've got a macro that has been working absolutely fine in Excel 2010. I'm now trying to run this file using Excel 2016 / 365 and the macro pops up with a run time error 438: Object doesn't support this property or method. It basically closes and re-opens the current Excel file that I'm working on ignoring any messages to save along the way and regardless of whether I'm read-only or not. If anyone can help then that would be fantastic. The code is below. Thanks in advance.</p>\n\n<pre><code>Sub reopen2()\n\nApplication.DisplayAlerts = False\nDim wb As Excel.Workbook\nSet wb = ThisWorkbook\n\nDim pth As String\npth = wb.FullName\n\nApplication.OnTime Now + TimeValue(\"00:00:01\"), Application.Workbooks.Open(FILENAME:=pth, Notify _\n        :=False)\nwb.Close (False)\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1575501492, "post_id": 59184284, "comment_id": 104592086, "body": "Does calling <code>MsgBox (ctl)</code> take the focus away from the form? Try to comment this out."}, {"owner": {"reputation": 1, "user_id": 9596986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380f1462b1162f40fbbba5966d8ea596?s=128&d=identicon&r=PG&f=1", "display_name": "T. Zacher", "link": "https://stackoverflow.com/users/9596986/t-zacher"}, "reply_to_user": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1575549963, "post_id": 59184284, "comment_id": 104609125, "body": "<code>MsgBox(ctl)</code> was added while I was trying to troubleshoot it, all it does is give the values of the controls that I&#39;m checking through. I added it to see if it was making it just through the first record or if it kept going at all"}], "owner": {"reputation": 1, "user_id": 9596986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380f1462b1162f40fbbba5966d8ea596?s=128&d=identicon&r=PG&f=1", "display_name": "T. Zacher", "link": "https://stackoverflow.com/users/9596986/t-zacher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594233816, "creation_date": 1575491626, "last_edit_date": 1594233816, "question_id": 59184284, "link": "https://stackoverflow.com/questions/59184284/ms-access-error-2105-you-cant-go-to-the-specified-record-after-adding-new-fie", "title": "MS Access Error 2105 &quot;You can&#39;t go to the specified record&quot; after adding new fields", "body": "<p>I have an Access database that I maintain that tracks user daily production with a form and continuous subform. Each record in the continuous subform tracks the information from a production order that the user completes - parts, quantity, etc. </p>\n\n<p>Due to some overloading of the tablets that they're currently used on, I tried adding more fields to the backend tables to keep fields from holding \"temporary\" information. Since then, the function that I use to calculate task time has not been working and I can't figure out why. </p>\n\n<p>Every time you click to calculate it gives the error 2105 when it tries to move to the second record. This is a piece of code that I've used in several other databases with no issue and previously worked up until I added the new fields. These were fields that were previously temporary but are now stored as data.</p>\n\n<p>The code below shows the iteration process that it uses to check. It goes through the fields of each subform before moving to the next record, checking to see if controls with information in the tag field are empty or not. As far as I'm aware, nothing is different about the newly added fields in the Property Sheet. I retried an older version of this database file and found no problems running this calculation with the new fields.</p>\n\n<pre><code>If Me.NewRecord = 0 Then\n\n    DoCmd.GoToControl \"Record_Subform\"\n    subform_count = Forms!Record![Record_Subform].Form.RecordsetClone.RecordCount\n\n    For x = 1 To subform_count\n        Me.Record_Subform.SetFocus\n        DoCmd.GoToRecord , , acGoTo, x\n\n        For Each ctl In Forms!Record![Record_Subform].Form.Controls\n\n            If ctl.ControlType = acTextBox Or ctl.ControlType = acComboBox Then\n                If ctl.Tag &lt;&gt; \"\" Then\n                MsgBox (ctl)\n                    If IsNull(ctl.Value) = True Or Len(ctl.Value) = 0 Then\n                        msg1_bool = True\n                        i = i + 1\n                        ReDim Preserve field_array(i - 1)\n                        field_array(i - 1) = ctl.Tag\n                    End If\n                End If\n            End If\n\n        Next ctl\n\n        If IsNull(Me!Record_Subform.Form!Suspension_PN) = True And Me!Record_Subform.Form!NoSuspension.Value = False Then\n            msg1_bool = True\n            i = i + 1\n            ReDim Preserve field_array(i - 1)\n            field_array(i - 1) = \"Suspension PN\"\n        End If\n\n    Next x\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "runtime-error", "with-statement"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1575490345, "post_id": 59183972, "comment_id": 104588404, "body": "Don&#39;t use <code>Selection</code> - you don&#39;t need to <code>Select</code>. You&#39;re also missing a period in front of <code>Sheets(&quot;Changes&quot;).Unprotect &quot;Swarf&quot;</code>."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 3, "creation_date": 1575490372, "post_id": 59183972, "comment_id": 104588422, "body": "^^^^^^^ <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this may help</a>"}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575490513, "post_id": 59183972, "comment_id": 104588491, "body": "@BigBen what is an alternative to using Select? and from my understanding, I purposely left out the period in front of Sheets(&quot;Changes&quot;).Unprotect &quot;Swarf&quot; because it only needs to be inside the with statement (I tested this)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1575490544, "post_id": 59183972, "comment_id": 104588506, "body": "No. The period <i>must</i> be there. Being inside the with statement doesn&#39;t mean anything. It &quot;works&quot; - not really, there is an implicit <code>ActiveWorkbook</code> - you&#39;re not actually qualifying that the sheet is indeed in <code>y</code>. Adding the period actually qualifies this."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "edited": false, "score": 0, "creation_date": 1575491070, "post_id": 59184027, "comment_id": 104588745, "body": "Okay I have made those suggested changes, my only issue is that it&#39;s giving me a Run-time error on the .Save for some reason? any help with this?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "edited": false, "score": 1, "creation_date": 1575491121, "post_id": 59184027, "comment_id": 104588770, "body": "That should be <code>y.Save</code> - because it is <code>Workbook.Save</code>. Same for <code>y.Close</code>. See the edit."}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "edited": false, "score": 0, "creation_date": 1575491520, "post_id": 59184027, "comment_id": 104588919, "body": "You are correct, thank you for your patience! One last issue (if you know about this), when I open the second workbook to check it, the very first time I attempt to open it, it automatically says &quot;The password you supplied is not correct. Verify that the CAPS LOCK key is off and be sure to use the correct capitalization&quot; This is weird because I literally don&#39;t click or type anything, I don&#39;t even see the Password prompt on the first try (or after I close it and try to reopen, I get this caps lock message then have to click the workbook again to open it and get the Password prompt)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "edited": false, "score": 0, "creation_date": 1575491587, "post_id": 59184027, "comment_id": 104588953, "body": "Hmm I&#39;m not sure, this seems like an unrelated issue, but still an issue for sure."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "edited": false, "score": 1, "creation_date": 1575491652, "post_id": 59184027, "comment_id": 104588980, "body": "@Handreen the <code>Workbooks.Open</code> function call is supplying a hard-coded &quot;Swarf&quot; password. Remove this <code>Password: &quot;Swarf&quot;</code> argument, or change the string literal to match the actual password."}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1575636938, "post_id": 59184027, "comment_id": 104643299, "body": "@MathieuGuindon thanks for your explanation, how can I avoid the hard-coded password and change the string literal to become my password?"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1575491161, "last_edit_date": 1575491161, "creation_date": 1575490487, "answer_id": 59184027, "question_id": 59183972, "link": "https://stackoverflow.com/questions/59183972/with-statement-produces-run-time-error-438/59184027#59184027", "title": "With statement produces Run-Time Error 438", "body": "<p>Don't use (or attempt to use) <code>Selection</code>. A <code>Worksheet</code> or <code>Sheet</code> does not have a <code>Selection</code> property.</p>\n\n<p>Change </p>\n\n<pre><code>.Sheets(\"Changes\").Rows(\"2:2\").Select\n'Inserts a new row and shifts the other rows down\n.Sheets(\"Changes\").Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrBelow\n</code></pre>\n\n<p>to</p>\n\n<pre><code>.Sheets(\"Changes\").Rows(\"2:2\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrBelow\n</code></pre>\n\n<hr>\n\n<p>Side note, you use <code>Sheets(\"Changes\")</code> so frequently that you could just use that with your <code>With...End With</code> and save a lot of typing.</p>\n\n<pre><code>Set y = Workbooks.Open(Filename:=\"\\\\FILEPATH\\Technology_Changes\\Changes_Database_IRR_200-2S_New.xlsm\", Password:=\"Swarf\")\n\nWith y.Sheets(\"Changes\")\n    .Rows(\"2:2\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrBelow\n    ' and so on\nEnd With\n\ny.Save\ny.Close False\n</code></pre>\n\n<p><strong>Very Important</strong>: Make sure you qualify <code>Rows</code> and <code>Range</code> calls within the <code>With...End With</code> by adding a period <code>.</code> beforehand.</p>\n"}], "owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 59184027, "answer_count": 1, "score": 0, "last_activity_date": 1580459676, "creation_date": 1575490264, "last_edit_date": 1580459676, "question_id": 59183972, "link": "https://stackoverflow.com/questions/59183972/with-statement-produces-run-time-error-438", "title": "With statement produces Run-Time Error 438", "body": "<p>I get</p>\n\n<blockquote>\n  <p>Run-time error '438'<br>\n  \"Object doesn't support this property or method.\"</p>\n</blockquote>\n\n<p>I was using a code that activated <strong>another workbook (Changes_Database Workbook)</strong>, then (inside of the Changes_Database Workbook there is a sheet called <strong><em>Changes</em></strong>) the code inserts a row and shifts the others down, copies the format of the cells below, and then inputs a key, part and process name (descriptions basically, unimportant) alongside the date and time.</p>\n\n<p>The code below is very slow:</p>\n\n<pre><code>Sub NewPart2()\n\n'Sets Changes_Database as active contents and unprotects\n\n    Set Cd = Workbooks.Open(Filename:=\"\\\\FILEPATH\\Technology_Changes\\Changes_Database_IRR_200-2S_New.xlsm\", Password:=\"Swarf\")\n    Set Changes = Cd.Sheets(\"Changes\")\n\nChanges.Activate\nActiveSheet.Unprotect \"Swarf\"\n\n'Selects the 2nd row of the database, which is the row after the headings\nActiveSheet.Rows(\"2:2\").Select\n\n'Inserts a new row and shifts the other rows down\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrBelow\n\n'Inputs the key that is being added to the new row\nActiveSheet.Range(\"A2\").Value = Sheet1.Range(\"H4\").Value\n\n'Inputs the part and process name to the new row\nActiveSheet.Range(\"D2\").Value = UCase(Sheet1.Range(\"E4\").Value)\nActiveSheet.Range(\"E2\").Value = Sheet1.Range(\"E5\").Value\n\n'Inputs the date and time for when it was added\nActiveSheet.Range(\"B2\").Value = Now\nActiveSheet.Range(\"C2\").Value = Now\nActiveSheet.Range(\"C2\").NumberFormat = \"h:mm:ss AM/PM\"\nActiveSheet.Range(\"B2\").NumberFormat = \"dd/mm/yyyy\"\n\n'On Error Resume Next\n\n            ActiveSheet.Protect \"Swarf\"\n            ActiveWorkbook.Save\n            ActiveWorkbook.Close SaveChanges:=True\n\nOn Error Resume Next\n\nEnd Sub\n</code></pre>\n\n<p>Activating the other sheet is taking quite a long time for this module to execute it's function, so I attempted a <strong>With statement</strong> but I get that error.</p>\n\n<p>I am trying to <strong>improve the speed</strong> of this code with my second code: (<strong>SCREENSHOTS OF BOTH CODES AS WELL CAN BE FOUND BELOW</strong>)</p>\n\n<pre><code>Sub NewPart2()\n\nApplication.ScreenUpdating = False\n\nSet y = Workbooks.Open(Filename:=\"\\\\FILEPATH\\Technology_Changes\\Changes_Database_IRR_200-2S_New.xlsm\", Password:=\"Swarf\")\n\n    With y\n\n      Sheets(\"Changes\").Unprotect \"Swarf\"\n\n        .Sheets(\"Changes\").Rows(\"2:2\").Select\n        'Inserts a new row and shifts the other rows down\n        .Sheets(\"Changes\").Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrBelow\n\n        'Inputs the key that is being added to the new row\n        .Sheets(\"Changes\").Range(\"A2\").Value = Sheet1.Range(\"H4\").Value\n\n        'Inputs the part and process name to the new row\n        .Sheets(\"Changes\").Range(\"D2\").Value = UCase(Sheet1.Range(\"E4\").Value)\n        .Sheets(\"Changes\").Range(\"E2\").Value = Sheet1.Range(\"E5\").Value\n\n        'Inputs the date and time for when it was added\n        .Sheets(\"Changes\").Range(\"B2\").Value = Now\n        .Sheets(\"Changes\").Range(\"C2\").Value = Now\n        .Sheets(\"Changes\").Range(\"C2\").NumberFormat = \"h:mm:ss AM/PM\"\n        .Sheets(\"Changes\").Range(\"B2\").NumberFormat = \"dd/mm/yyyy\"\n\n      Password = \"Swarf\"\n\n        .Save\n        .Close False\n\n    End With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/u4ACs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u4ACs.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/VUt1x.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VUt1x.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1575489539, "post_id": 59183768, "comment_id": 104588103, "body": "You are still using Microsoft.ACE.OLEDB.12.0 which is Access. Have you gone through <a href=\"https://stackoverflow.com/q/58832269/11683\">stackoverflow.com/q/58832269/11683</a>?"}, {"owner": {"reputation": 51, "user_id": 3340983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab58432ea50bfda27e6bae9b245f5862?s=128&d=identicon&r=PG&f=1", "display_name": "user3340983", "link": "https://stackoverflow.com/users/3340983/user3340983"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1575491741, "post_id": 59183768, "comment_id": 104589011, "body": "It did not help me. I searched &quot;KB4484119&quot; in order to uninstall it but did not find it. I didn&#39;t find any recent update relevant to Office. I keep getting this error in Excel."}, {"owner": {"reputation": 51, "user_id": 3340983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab58432ea50bfda27e6bae9b245f5862?s=128&d=identicon&r=PG&f=1", "display_name": "user3340983", "link": "https://stackoverflow.com/users/3340983/user3340983"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1575491832, "post_id": 59183768, "comment_id": 104589053, "body": "The error number  is 2147467259 (800040005)"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1575492587, "post_id": 59183768, "comment_id": 104589352, "body": "Have you tried the suggested workarounds?"}, {"owner": {"reputation": 51, "user_id": 3340983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab58432ea50bfda27e6bae9b245f5862?s=128&d=identicon&r=PG&f=1", "display_name": "user3340983", "link": "https://stackoverflow.com/users/3340983/user3340983"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1575495047, "post_id": 59183768, "comment_id": 104590209, "body": "You mean replace: Update TableName .... with &quot;Update (SELECT * FROM TableName&quot;?. I will try it."}], "owner": {"reputation": 51, "user_id": 3340983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab58432ea50bfda27e6bae9b245f5862?s=128&d=identicon&r=PG&f=1", "display_name": "user3340983", "link": "https://stackoverflow.com/users/3340983/user3340983"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575489327, "creation_date": 1575489327, "question_id": 59183768, "link": "https://stackoverflow.com/questions/59183768/excel-vba-error-query-is-corrupt-while-executing-update-query-using-adodb", "title": "Excel VBA error &quot;Query &#39; &#39; is corrupt&quot; while executing update query using ADODB.Connection &amp; Microsoft.ACE.OLEDB.12.0", "body": "<p>I have an update query in Excel 2013 vba.\nTill recently it worked.\nNow I got the error \"Query ' ' is corrupt\" in the \"adoConn1.Execute\" command.\nI know there is an <a href=\"https://support.office.com/en-us/article/access-error-query-is-corrupt-fad205a5-9fd4-49f1-be83-f21636caedec\" rel=\"nofollow noreferrer\">Access Issue</a> caused by November Office update.\nThe problem is that I got the error in Excel and the problematic Office updates\nwhere not installed in my PC. \nCan you help me?</p>\n\n<pre><code>strUpdateQuery= \"Update [Table$] \" &amp; \" SET FieldName = \" &amp; FieldValue\n\nsConn1 = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n\"Data Source=\" &amp; PathDB &amp; \"\\\" &amp; FileNameDB &amp; \";\" &amp; _\n\"Extended Properties=\"\"Excel 12.0;HDR=YES\"\"\"\n\nSet adoConn1 = New ADODB.Connection\nadoConn1.Open sConn1\nadoConn1.Execute strUpdateQuery, flagUpdateResult, adExecuteNoRecords\n\nadoConn1.Close\nIf Not adoConn1 Is Nothing Then Set adoConn1 = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1575492035, "post_id": 59183172, "comment_id": 104589116, "body": "You don&#39;t want any blank rows in the &quot;Summary&quot; worksheet?"}, {"owner": {"reputation": 177, "user_id": 12469023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db8650a2bf5b80503a1307217640204f?s=128&d=identicon&r=PG&f=1", "display_name": "EmmaG", "link": "https://stackoverflow.com/users/12469023/emmag"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1575494045, "post_id": 59183172, "comment_id": 104589872, "body": "@GMalc You can say that, but more accurately, when a row has a value &quot;No&quot; in column A of Budget Setup sheet, I want the VBA code to skip it"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1575494334, "post_id": 59183172, "comment_id": 104589962, "body": "In order to understand what you  do not like it, I think, it will be good to also show us how it looks now. What should be eliminated from the existing appearance?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1575494382, "post_id": 59183172, "comment_id": 104589980, "body": "You could filter for &quot;Yes&quot; in column A, and then copy the column range using <code>SpecialCells(xlCellTypeVisible)</code> and paste to the column in the second worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 12469023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db8650a2bf5b80503a1307217640204f?s=128&d=identicon&r=PG&f=1", "display_name": "EmmaG", "link": "https://stackoverflow.com/users/12469023/emmag"}, "edited": false, "score": 0, "creation_date": 1575507072, "post_id": 59185026, "comment_id": 104593489, "body": "Thank you! This is exactly what I needed!"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 1, "last_activity_date": 1575495557, "creation_date": 1575495557, "answer_id": 59185026, "question_id": 59183172, "link": "https://stackoverflow.com/questions/59183172/vba-copy-and-paste-certain-columns-of-a-sheet-to-specific-columns-on-another-she/59185026#59185026", "title": "VBA Copy and Paste Certain Columns of a sheet to specific columns on another sheet", "body": "<p>Here is a basic copy_paste using <code>AutoFilter</code> and <code>SpecialCells(xlCellTypeVisible)</code></p>\n\n<pre><code>'Assign and set your variables\nDim ws1 As Worksheet, ws2 As Worksheet, lRow As Long\n\nSet ws1 = ThisWorkbook.Sheets(\"Budget Setup\")\nSet ws2 = ThisWorkbook.Sheets(\"Summary\")\n\nlRow = ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row\n\n    With ws1\n        .Range(\"A1\").AutoFilter Field:=1, Criteria1:=\"Yes\" 'set your filter\n\n        'copy the visible cells in each column from row 2 and resize to the last row\n        'paste to the the cell you want your copied range to start in your second worksheet\n        .Range(\"C2\").Resize(lRow - 1).SpecialCells(xlCellTypeVisible).Copy Destination:=ws2.Range(\"B2\")\n        .Range(\"F2\").Resize(lRow - 1).SpecialCells(xlCellTypeVisible).Copy Destination:=ws2.Range(\"C2\")\n        .Range(\"H2\").Resize(lRow - 1).SpecialCells(xlCellTypeVisible).Copy Destination:=ws2.Range(\"H2\")\n\n        .Range(\"A1\").AutoFilter 'clear the filter\n    End With\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 12469023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db8650a2bf5b80503a1307217640204f?s=128&d=identicon&r=PG&f=1", "display_name": "EmmaG", "link": "https://stackoverflow.com/users/12469023/emmag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 0, "accepted_answer_id": 59185026, "answer_count": 1, "score": 1, "last_activity_date": 1602495626, "creation_date": 1575486746, "last_edit_date": 1575519779, "question_id": 59183172, "link": "https://stackoverflow.com/questions/59183172/vba-copy-and-paste-certain-columns-of-a-sheet-to-specific-columns-on-another-she", "title": "VBA Copy and Paste Certain Columns of a sheet to specific columns on another sheet", "body": "<p>So, I have two sheets, \u201cBudget Setup\u201d and \u201cSummary\u201d. I need to use VBA to copy and paste CERTAIN columns (NOT entire row) of the Budget Setup to specific columns of the Summary sheet, based on one criterion. </p>\n\n<p>This is how the Budget Setup sheet looks like:\n<a href=\"https://i.stack.imgur.com/6VQeW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6VQeW.png\" alt=\"Budget Sheet\"></a></p>\n\n<p>And this is how my Summary sheet looks like for now (after running the VBA code I wrote):</p>\n\n<p><a href=\"https://i.stack.imgur.com/UtLiy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UtLiy.png\" alt=\"Summary Sheet\"></a></p>\n\n<p>So, if the value is \u201cYes\u201d in Column A of Budget Setup sheet, I want to transfer the value in Column B of Budget Setup to Column A of Summary, Column C of Budget Setup to Column B of Summary, Column F of Budget Setup to Column C of Summary, and Column G of Budget Setup to Column H of Summary. </p>\n\n<p>This code will do the trick:</p>\n\n<pre><code>Sub PCAMMatching()\n\na = Worksheets(\"Budget Setup\").Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To a\n\n    If Worksheets(\"Budget Setup\").Cells(i, 1).Value = \"Yes\" Then\n\n        Worksheets(\"Budget Setup\").Cells(i, 2).Copy\n        Worksheets(\"Summary\").Cells(i, 1).Select\n        ActiveSheet.Paste\n\n    End If\n\n    If Worksheets(\"Budget Setup\").Cells(i, 1).Value = \"Yes\" Then\n\n        Worksheets(\"Budget Setup\").Cells(i, 3).Copy\n        Worksheets(\"Summary\").Cells(i, 2).Select\n        ActiveSheet.Paste\n    End If\n\n    If Worksheets(\"Budget Setup\").Cells(i, 1).Value = \"Yes\" Then\n\n        Worksheets(\"Budget Setup\").Cells(i, 6).Copy\n        Worksheets(\"Summary\").Cells(i, 3).Select\n        ActiveSheet.Paste\n    End If\n\n    If Worksheets(\"Budget Setup\").Cells(i, 1).Value = \"Yes\" Then\n\n        Worksheets(\"Budget Setup\").Cells(i, 7).Copy\n        Worksheets(\"Summary\").Cells(i, 8).Select\n        ActiveSheet.Paste\n    End If\n\nNext\n\nApplication.CutCopyMode = False\n\n\nEnd Sub\n</code></pre>\n\n<p>However, as you can see on my Summary sheet, this code is creating 3 blank rows because the top 3 rows on the Budget Setup sheet have a status of \u201cNo\u201d in Column A. What I really want is, if the status is \u201cNo\u201d, simply skip that row (instead of creating a blank row) and copy the rows with a status of \u201cYes\u201d one by one to the Summary sheet.</p>\n\n<p>So, ideally, I want my Summary sheet to look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tRlt0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tRlt0.png\" alt=\"Ideal End Result\"></a></p>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1575485505, "post_id": 59182879, "comment_id": 104586528, "body": "If you&#39;re deleting, you want to loop from the bottom up."}, {"owner": {"reputation": 1113, "user_id": 5941476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b87a1f7240a965261b7abab5950c0fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacko", "link": "https://stackoverflow.com/users/5941476/jacko"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575597904, "post_id": 59182879, "comment_id": 104629512, "body": "Thanks BigBen - I appreciate the tip!"}], "answers": [{"tags": [], "owner": {"reputation": 1113, "user_id": 5941476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b87a1f7240a965261b7abab5950c0fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacko", "link": "https://stackoverflow.com/users/5941476/jacko"}, "is_accepted": false, "score": 0, "last_activity_date": 1575492257, "creation_date": 1575492257, "answer_id": 59184433, "question_id": 59182879, "link": "https://stackoverflow.com/questions/59182879/how-do-i-copy-and-paste-cells-and-then-delete-certain-rows-in-a-specific-way-usi/59184433#59184433", "title": "How do I copy and paste cells and then delete certain rows in a specific way using excel VBA?", "body": "<p>I think I actually just figured it out. I'm sure this isn't the most elegant solution but it works. Curious if anyone has a better way of solving this. Thanks!</p>\n\n<p>Sub Clean()</p>\n\n<p>Range(\"A1\").Activate</p>\n\n<p>Do Until IsEmpty(ActiveCell.Value)</p>\n\n<pre><code>Selection.Offset(1, 0).Copy\nSelection.Offset(0, 1).Select\nActiveCell.PasteSpecial xlPasteAll\nActiveCell.Offset(1, 0).EntireRow.Delete xlShiftUp\nSelection.Offset(1, -1).Select\nActiveCell.Copy\nSelection.Offset(-1, 2).Select\nActiveCell.PasteSpecial xlPasteAll\nActiveCell.Offset(1, 0).EntireRow.Delete xlShiftUp\nSelection.Offset(1, -2).Select\n</code></pre>\n\n<p>Loop</p>\n\n<p>End Sub</p>\n"}, {"comments": [{"owner": {"reputation": 1113, "user_id": 5941476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b87a1f7240a965261b7abab5950c0fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacko", "link": "https://stackoverflow.com/users/5941476/jacko"}, "edited": false, "score": 0, "creation_date": 1575597767, "post_id": 59186784, "comment_id": 104629486, "body": "This is awesome, thank you so much for your thoughts. Really cool way to think about doing this."}], "tags": [], "owner": {"reputation": 164, "user_id": 12093214, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SbDXaD9tqz4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc9-fZuGs9pT4cQsuUGpeSpJzkzyQ/photo.jpg?sz=128", "display_name": "Vba noob", "link": "https://stackoverflow.com/users/12093214/vba-noob"}, "is_accepted": false, "score": 2, "last_activity_date": 1575508997, "last_edit_date": 1575508997, "creation_date": 1575508185, "answer_id": 59186784, "question_id": 59182879, "link": "https://stackoverflow.com/questions/59182879/how-do-i-copy-and-paste-cells-and-then-delete-certain-rows-in-a-specific-way-usi/59186784#59186784", "title": "How do I copy and paste cells and then delete certain rows in a specific way using excel VBA?", "body": "<p>This could help you do what you want. Not the best solution out there but this will loop through all the cells slightly faster than what you have done.</p>\n\n<pre><code>Sub test()\n    Dim lRow As Long, i As Long\n    Dim ws As Worksheet\n    Dim RowsToDelete As Range\n\n    Set ws = ActiveSheet\n    With ws\n        lRow = .Cells(.Rows.Count, 1).End(xlUp).Row ' Get the last row\n        For i = lRow To 1 Step -3 \n            .Cells(i - 2, 3) = .Cells(i, 1)\n            .Cells(i - 2, 2) = .Cells(i - 1, 1)\n\n            If RowsToDelete Is Nothing Then 'first 2 rows to be deleted\n                Set RowsToDelete = Range(.Rows(i).EntireRow, .Rows(i - 1).EntireRow)\n            Else 'append more rows with union\n                Set RowsToDelete = Application.Union(RowsToDelete, .Rows(i).EntireRow, .Rows(i - 1).EntireRow)\n            End If\n\n        Next i\n\n        If Not RowsToDelete Is Nothing Then 'if there is something to be deleted\n            RowsToDelete.Delete\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1113, "user_id": 5941476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b87a1f7240a965261b7abab5950c0fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacko", "link": "https://stackoverflow.com/users/5941476/jacko"}, "edited": false, "score": 1, "creation_date": 1575597849, "post_id": 59186967, "comment_id": 104629500, "body": "Thanks Judge, I appreciate the clarification - very helpful and I will definitely keep this in mind as I continue my VBA journey. Really cool of you to lend a hand, I am a total noob and your advice helps me build my framework going forward."}], "tags": [], "owner": {"reputation": 146, "user_id": 8322319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dxVRvoIP6Hg/AAAAAAAAAAI/AAAAAAAADGU/G_AU_h2mTAU/photo.jpg?sz=128", "display_name": "Judge", "link": "https://stackoverflow.com/users/8322319/judge"}, "is_accepted": false, "score": 2, "last_activity_date": 1575509774, "creation_date": 1575509774, "answer_id": 59186967, "question_id": 59182879, "link": "https://stackoverflow.com/questions/59182879/how-do-i-copy-and-paste-cells-and-then-delete-certain-rows-in-a-specific-way-usi/59186967#59186967", "title": "How do I copy and paste cells and then delete certain rows in a specific way using excel VBA?", "body": "<p>You should try to avoid using ActiveCell and Selection in most cases. User input while the code is running can mess up your position and yields unpredictable results.</p>\n\n<p>Its best to pull the data into an array, process your changes and output the data. This method also happens to be faster as you're not constantly reading and writing data to the sheet.</p>\n\n<p>Something like the below will perform better for large data sets and will not be affected by user input during runtime:</p>\n\n<pre><code>Sub GatherCompanyData()\n\n  Dim Temp As Variant, Target As Range\n  Dim x As Long, c As Long, MyOutput As Variant\n\n'First cell containing data [UPDATE THIS AS NEEDED]\n  Set Target = Sheets(\"SHEET NAME HERE\").Range(\"A1\")\n\n'Get all the data in specified column\n  With Target.Parent\n    Temp = .Range(Target.Cells(1, 1).Address, .Cells(.Rows.Count, Target.Column).End(xlUp).Address).Value\n  End With\n\n'Build Output Data\n  ReDim MyOutput(1 To Int(UBound(Temp, 1) / 3), 1 To 3)\n  For x = 3 To UBound(Temp, 1) Step 3\n    c = c + 1\n    MyOutput(c, 1) = Temp(x - 2, 1)\n    MyOutput(c, 2) = Temp(x - 1, 1)\n    MyOutput(c, 3) = Temp(x, 1)\n  Next x\n\n'Clear existing data and output new data\n  Target.Value = Empty\n  Target.Resize(c, 3).Value = MyOutput\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1113, "user_id": 5941476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b87a1f7240a965261b7abab5950c0fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacko", "link": "https://stackoverflow.com/users/5941476/jacko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1581926508, "creation_date": 1575485437, "last_edit_date": 1581926508, "question_id": 59182879, "link": "https://stackoverflow.com/questions/59182879/how-do-i-copy-and-paste-cells-and-then-delete-certain-rows-in-a-specific-way-usi", "title": "How do I copy and paste cells and then delete certain rows in a specific way using excel VBA?", "body": "<p>I have to preface this by saying I am below the lowest level of novice when it comes to VBA. I currently have a single column of data in excel where information about companies is stored in groups of three rows as you descend down the column. The data is grouped as follows (no empty rows between the data): </p>\n\n<p>CompanyA</p>\n\n<p>www.CompanyA.com</p>\n\n<p>CompanyA location</p>\n\n<p>CompanyB</p>\n\n<p>www.CompanyB.com</p>\n\n<p>CompanyB location... etc.</p>\n\n<p>I need to create a code that will copy the cell below, paste it to cell to the right, then delete the row below. Then copy the cell that is now below, and paste it two to the right, then select the next cell down and repeat for the next three row dataset. I've included my terrible first draft below if this helps explain my thinking. Any help would be very much appreciated. Thank you!</p>\n\n<pre><code>Sub Clean()\n\nDo Until IsEmpty(ActiveCell.Value)\n\nRange(\"A1\").Activate\n\nSelection.Offset(1, 0).Copy\n\nSelection.Offset(0, 1).Paste\n\nActiveCell.Offset(1, 0).EntireRow.Delete xlShiftUp\n\nSelection.Offset(1, 0).Copy\n\nSelection.Offset(0, 2).Paste\n\nActiveCell.Offset(1, 0).EntireRow.Delete xlShiftUp\n\nActiveCell.Offset(1, 0).Select\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1575484432, "post_id": 59182455, "comment_id": 104586102, "body": "What would happen when you have <code>Combine-1</code> and <code>Combined-3</code>? Would the next one be <code>Combined-2</code> or <code>Combined-4</code>? Or do you need to rename sheets first?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1575484434, "post_id": 59182455, "comment_id": 104586104, "body": "Consider using an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> to make (and keep) your indentation consistent. Lined-up <code>For</code> and <code>Next</code> (vs <code>For</code> and <code>End If</code>) make a huge difference in terms of readability."}, {"owner": {"reputation": 37, "user_id": 12177348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5108b2a1333bb7a7765414eeee8bd8?s=128&d=identicon&r=PG&f=1", "display_name": "chrisphils26", "link": "https://stackoverflow.com/users/12177348/chrisphils26"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575484616, "post_id": 59182455, "comment_id": 104586175, "body": "@JvdV Sorry I should have clarified. Any sheet name &quot;Combined-n&quot; would only exist if I added it with this macro. So after I run it the first time, only &quot;Combined-1&quot; would exist and after the 2nd time, &quot;Combined-1&quot; and &quot;Combined-2&quot; would also exist."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1575484695, "post_id": 59182455, "comment_id": 104586204, "body": "One problem is that &quot;after the 2nd time&quot; may or may not be in the same host session (e.g. Excel was closed &amp; re-opened between the two runs), and no global or static variable is going to remember what the last value was."}, {"owner": {"reputation": 37, "user_id": 12177348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5108b2a1333bb7a7765414eeee8bd8?s=128&d=identicon&r=PG&f=1", "display_name": "chrisphils26", "link": "https://stackoverflow.com/users/12177348/chrisphils26"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1575484850, "post_id": 59182455, "comment_id": 104586273, "body": "@MathieuGuindon I see what you mean. I think I can say confidently though that based on the model I am building, the macro would only be used the first time the file was opened. In this case, it is safe to assume Excel closing doesn&#39;t need to be taken into account."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 12177348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5108b2a1333bb7a7765414eeee8bd8?s=128&d=identicon&r=PG&f=1", "display_name": "chrisphils26", "link": "https://stackoverflow.com/users/12177348/chrisphils26"}, "edited": false, "score": 0, "creation_date": 1575488309, "post_id": 59182826, "comment_id": 104587591, "body": "I appreciate it Mathieu. I tried running the code, but I&#39;m getting an error with the GetNextCombinedSheetName function. I get the errors &quot;While without wend&quot; and &quot;Do without loop&quot;. Could you help me figure out how to fix these errors?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 37, "user_id": 12177348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5108b2a1333bb7a7765414eeee8bd8?s=128&d=identicon&r=PG&f=1", "display_name": "chrisphils26", "link": "https://stackoverflow.com/users/12177348/chrisphils26"}, "edited": false, "score": 1, "creation_date": 1575488417, "post_id": 59182826, "comment_id": 104587631, "body": "@chrisphils26 sorry, untested air-code - that <code>While {condition}</code> should have been <code>Loop While {condition}</code>; edited. Also the <code>Not</code> was wrong."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1575488388, "last_edit_date": 1575488388, "creation_date": 1575485183, "answer_id": 59182826, "question_id": 59182455, "link": "https://stackoverflow.com/questions/59182455/adding-sheets-with-sequential-names/59182826#59182826", "title": "Adding Sheets With Sequential Names", "body": "<p>Write a function whose only job is to return the name of the next \"Combined-N\" sheet. I'd do this by counting the number of sheets that have a name that starts with \"Combined-\", and adding 1 to that number, and then incrementing until \"Combined-\" concatenated with that number is a sheet name that doesn't already exist.</p>\n\n<p>So, I'd have a <code>GetNextCombinedSheetName</code> function to do this, and a <code>SheetNameExists</code> function to determine whether a given sheet name exists in an optionally-specified <code>Workbook</code>'s <code>Worksheets</code> collection.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Public Function GetNextCombinedSheetName() As String\n    Const namePrefix As String = \"Combined-\"\n\n    Dim currentcount As Long\n\n    Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n        If Left(ws.Name, Len(namePrefix)) = namePrefix Then\n            currentCount = currentCount + 1\n        End If\n    Next\n\n    Dim nextName As String\n    Do 'ensure the name doesn't already exist - increment if it does:\n        nextName = namePrefix &amp; currentCount + 1\n    Loop While SheetNameExists(nextName)\n\n    GetNextCombinedSheetName = nextName\nEnd Function\n\nPrivate Function SheetNameExists(ByVal sheetName As String, Optional ByVal wb As Workbook = Nothing) As Boolean\n    If wb Is Nothing Then Set wb = ThisWorkbook\n    Dim ws As Worksheet\n    On Error Resume Next ' swallow index out of bounds error 9\n    Set ws = wb.Worksheets(sheetName)\n    On Error GoTo 0\n    SheetNameExists = Not ws Is Nothing\nEnd Function\n</code></pre>\n\n<p>With that, you can add a new sheet and just name it:</p>\n\n<pre><code>Dim newSheet As Worksheet\nSet newSheet = ThisWorkbook.Worksheets.Add\nnewSheet.Name = GetNextCombinedSheetName\n</code></pre>\n\n<p>Note how every <code>Worksheets</code> member call (or <code>Sheets</code> - but why are you using the two interchangeably and inconsistently?) is properly qualified with a <code>Workbook</code> object: your code appears to have several <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveWorkbookReference\" rel=\"nofollow noreferrer\">implicit ActiveWorkbook references</a>, and this only works because the <code>ActiveWorkbook</code> <em>happens to be</em> the host <code>ThisWorkbook</code> document - it may not always be the case (especially as you learn to stop <code>Activate</code>-ing and <code>Select</code>-ing things), and you don't want your code to assume it is: life is much simpler when we systematically qualify workbook and worksheet member calls.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12470441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35eb550af3e2ab1e1dc563b8ba3e4da6?s=128&d=identicon&r=PG", "display_name": "Nandu Tayade", "link": "https://stackoverflow.com/users/12470441/nandu-tayade"}, "is_accepted": false, "score": 1, "last_activity_date": 1575493894, "creation_date": 1575493894, "answer_id": 59184734, "question_id": 59182455, "link": "https://stackoverflow.com/questions/59182455/adding-sheets-with-sequential-names/59184734#59184734", "title": "Adding Sheets With Sequential Names", "body": "<p>@chrisphils26 - you can try below code also </p>\n\n<pre>\nOption Explicit\n\nSub GetAvailableSheeName()\n\nDim sht As Worksheet\nDim temp_sht\nDim sht_name, last_sht As String\nDim shtNumber\nDim temp_counter, loop_i, counter, num As Integer\n\nConst Available_sht As String = \"Combined-\"\n\ntemp_counter = 0\nFor Each sht In ThisWorkbook.Worksheets\n\n    If LCase(Left(sht.name, Len(Available_sht))) = LCase(Available_sht) Then\n\n        shtNumber = Split(sht.name, \"-\")(1)\n\n        If IsNumeric(shtNumber) Then\n            If shtNumber > temp_counter Then\n                temp_counter = shtNumber\n                last_sht = sht.name\n            End If\n\n        Else\n            sht_name = sht.name\n\n        End If\n\n    Else\n            sht_name = sht.name\n    End If\n\nNext sht\n\nIf temp_counter = 0 Then\n\n   ThisWorkbook.Sheets.Add(After:=Sheets(sht_name)).name = \"Combined-1\"\nElse\n\n   ThisWorkbook.Sheets.Add(After:=Sheets(last_sht)).name = \"Combined-\" & temp_counter + 1\n\n    For loop_i = 1 To temp_counter + 1\n\n        For Each sht In ThisWorkbook.Worksheets\n             counter = 0\n             If LCase(\"Combined-\") & loop_i = LCase(sht.name) Then\n\n               counter = 1\n               Exit For\n             End If\n\n        Next sht\n\n         If counter = 0 Then\n            If loop_i = 1 Then\n              ThisWorkbook.Sheets.Add(Before:=Sheets(1)).name = \"Combined-\" & loop_i\n            Else\n              num = loop_i - 1\n              ThisWorkbook.Sheets.Add(After:=Sheets(\"Combined-\" & num)).name = \"Combined-\" & loop_i\n            End If\n\n         End If\n\n        Next loop_i\nEnd If\n\nEnd Sub\n</pre>\n"}], "owner": {"reputation": 37, "user_id": 12177348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5108b2a1333bb7a7765414eeee8bd8?s=128&d=identicon&r=PG&f=1", "display_name": "chrisphils26", "link": "https://stackoverflow.com/users/12177348/chrisphils26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 59182826, "answer_count": 2, "score": 1, "last_activity_date": 1575493894, "creation_date": 1575483547, "last_edit_date": 1575483713, "question_id": 59182455, "link": "https://stackoverflow.com/questions/59182455/adding-sheets-with-sequential-names", "title": "Adding Sheets With Sequential Names", "body": "<p>I need to write a macro that adds a new sheet when executed. The sheet name will be \"Combined-n\" where n is an integer. I want it to try add a new sheet named \"Combined-1\". However, if the sheet \"Combined-1\" already exists (since this macro can be executed multiple times), I want it to add a sheet called \"Combined-2\" and so on. I tried a few different things including the code below, but when I execute it nothing happens.</p>\n\n<pre><code>Dim i As Integer\nDim WS As Worksheet\n\nFor Each WS In ThisWorkbook.Worksheets\nWS.Activate\nFor i = 1 To Worksheets.Count\nIf WS.Name = \"Combined-\" &amp; i Then\nSheets.Add(Before:=Sheets(\"Sheet1\")).Name = \"Combined-\" &amp; i + 1\nEnd If\nNext i\nNext WS\n</code></pre>\n\n<p>I also tried:</p>\n\n<pre><code>Dim i As Integer\n\nFor i = 1 To Worksheets.Count\n   If Worksheets(i).Name = \"Combined-\" &amp; i Then\n   Sheets.Add(Before:=Sheets(\"Sheet1\")).Name = \"Combined-\" &amp; i + 1\nEnd If\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1575480045, "post_id": 59181541, "comment_id": 104583870, "body": "<code>If Application.Evaluate(rcell &amp; oper &amp; Val) Then</code>"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1575480667, "post_id": 59181640, "comment_id": 104584204, "body": "Consider using the <code>Worksheet.Evaluate</code> method where you can specify the context in which the formula gets evaluated. <code>Application.Evaluate</code> uses the Active sheet, which might meet your needs right now but will come back to bite you later..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1575480971, "post_id": 59181640, "comment_id": 104584378, "body": "<code>rng.Parent.Evaluate(...)</code> will ensure Excel calculates the result using the correct worksheet as the source of the cell values."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1575480976, "post_id": 59181640, "comment_id": 104584383, "body": "@FreeSoftwareServers he is saying use : <code>If ActiveSheet.Evaluate(rcell &amp; oper &amp; Val) Then</code> instead.  If refering to cells use the sheets."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1575481149, "post_id": 59181640, "comment_id": 104584476, "body": "@FreeSoftwareServers if using <code>rng.Parent.Evaluate(...)</code> does not solve your current issue, ask a new question showing the actual code."}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1575481530, "post_id": 59181640, "comment_id": 104584679, "body": "@ScottCraner The issue is that the <code>Val</code> doesn&#39;t accept <code>0.#</code> as it sets <code>Val = 0</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 1, "creation_date": 1575481646, "post_id": 59181640, "comment_id": 104584722, "body": "@FreeSoftwareServers then change the declaration from <code>Integer</code> to <code>Double</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1575480278, "creation_date": 1575480278, "answer_id": 59181640, "question_id": 59181541, "link": "https://stackoverflow.com/questions/59181541/get-math-operator-from-inputbox/59181640#59181640", "title": "Get Math Operator from InputBox", "body": "<p>Create a string and use Application.Evaluate:</p>\n\n<pre><code>Sub NumTest()\n    Dim Val As Integer\n    Val = Application.InputBox(\"Value\", \"Value\", Type:=1)\n    Dim oper As String\n    oper = Application.InputBox(\"Op\")\n    Dim rcell As String\n    rcell = ActiveSheet.Range(\"D2\")\n\n    If Application.Evaluate(rcell &amp; oper &amp; Val) Then\n        MsgBox \"True\"\n    Else\n        MsgBox \"False\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1575487059, "creation_date": 1575487059, "answer_id": 59183245, "question_id": 59181541, "link": "https://stackoverflow.com/questions/59181541/get-math-operator-from-inputbox/59183245#59183245", "title": "Get Math Operator from InputBox", "body": "<p>Operators are syntactic language elements, and they're not up for grabs: you can't just decide to use some identifier / string variable, and in the name of its string content being some operator, treat it as an operator: syntactically, it's a variable, not an operator.</p>\n\n<p>So the compiler has no idea what you mean here:</p>\n\n<pre><code>If rcell oper Val = True Then\n</code></pre>\n\n<p>Because the expression <code>rcell oper Val = True</code> makes no sense, syntatically:</p>\n\n<pre><code>If variable1 variable2 variable3 = True Then\n</code></pre>\n\n<p>Note that the <code>= True</code> part is redundant: a Boolean expression can only ever be <code>True</code> or <code>False</code>; if the expression is <code>True</code>, it won't be truer if you compare it to the literal value <code>True</code>.</p>\n\n<p>Using <code>Application.Evaluate</code> will work, so long as you're willing to let Excel do the work. If your code needs to be ported over to any other VBA host application, then you can't do that. Well you <em>could</em>, but it <em>could</em> be overkill to reference the Excel object model only to leverage its calc engine to evaluate simple expressions.</p>\n\n<p>What you <em>can</em> do, is map the legal <code>oper</code> values to functions. Make some <code>ExpressionEvaluator</code> class module for this.</p>\n\n<pre><code>Public Function AddOperator(ByVal LHS As Variant, ByVal RHS As Variant) As Variant\n    AddOperator = LHS + RHS ' let VBA deal with type mismatches &amp; other issues\nEnd Function\n\nPublic Function SubtractOperator(ByVal LHS As Variant, ByVal RHS As Variant) As Variant\n    SubtractOperator = LHS - RHS ' let VBA deal with type mismatches &amp; other issues\nEnd Function\n\nPublic Function LessThanOperator(ByVal LHS As Variant, ByVal RHS As Variant) As Boolean\n    LessThanOperator = LHS &lt; RHS ' let VBA deal with type mismatches &amp; other issues\nEnd Function\n\n'...\n\nPublic Property Get BinaryOperatorMap() As Scripting.Dictionary\n    Static map As Scripting.Dictionary\n    If map Is Nothing Then\n        Set map = New Scripting.Dictionary\n        map.Add \"+\", \"AddOperator\"\n        map.Add \"-\", \"SubtractOperator\"\n        map.Add \"&lt;\", \"LessThanOperator\"\n        '...\n    End If\n    Set BinaryOperatorMap = map\nEnd Property\n</code></pre>\n\n<p>And then you can parse the user-provided inputs and use <code>CallByName</code> to invoke the mapped function and feed it the <code>LHS</code> and <code>RHS</code> arguments:</p>\n\n<pre><code>Public Function Evaluate(ByVal LHS As Variant, ByVal oper As String, ByVal RHS As Variant) As Variant\n    Dim operation As String\n    operation = BinaryOperatorMap(oper)\n\n    Dim instance As Object\n    Set instance = Me\n    Evaluate = CallByName(instance, operation, vbMethod, LHS, RHS)\nEnd Function\n</code></pre>\n\n<p>Note that <code>CallByName</code> needs an object instance; that's why you need the operations to be implemented in a class module.</p>\n"}], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 1, "accepted_answer_id": 59181640, "answer_count": 2, "score": 2, "last_activity_date": 1582499573, "creation_date": 1575479945, "last_edit_date": 1582499573, "question_id": 59181541, "link": "https://stackoverflow.com/questions/59181541/get-math-operator-from-inputbox", "title": "Get Math Operator from InputBox", "body": "<p>I am trying to use InputBox to get a math operator</p>\n\n<p>E.g.: <code>+</code>. When I replace the operator with the variable it gives an error </p>\n\n<blockquote>\n  <p>Expected Then or GoTo</p>\n</blockquote>\n\n<p><strong>This doesn't work:</strong></p>\n\n<pre><code>Sub NumTest()\nDim Val As Integer\n\nVal = Application.InputBox(\"Value\", \"Value\", Type:=1)\noper = Application.InputBox(\"Op\")\nrcell = Range(\"D2\")\n\nIf rcell oper Val = True Then\n    MsgBox \"True\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>This does work:</strong></p>\n\n<pre><code>Sub NumTest()\nDim Val As Integer\n\nVal = Application.InputBox(\"Value\", \"Value\", Type:=1)\noper = Application.InputBox(\"Op\")\nrcell = Range(\"D2\")\n\nIf rcell &gt; Val = True Then\n    MsgBox \"True\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "immediate-window"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 4, "creation_date": 1575478031, "post_id": 59180892, "comment_id": 104582733, "body": "You might consider commenting out your error handler and see what error message might get thrown."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 4, "creation_date": 1575478122, "post_id": 59180892, "comment_id": 104582788, "body": "In addition, there are two statements where you are addressing the Sheets collection without the  ThisWorkbook qualifier, thus calling Sheets in the active workbook which is not necessarily the same as ThisWorkbook."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1575478141, "post_id": 59180892, "comment_id": 104582799, "body": "<code>EH</code> can&#39;t be both an error-handling subroutine label <i>and</i> an invocable procedure that you can <code>Call</code>. And if it can, then it shouldn&#39;t. Don&#39;t use conflicting names like this."}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1575478182, "post_id": 59180892, "comment_id": 104582824, "body": "Hmm...interesting.  Thanks.  Also, I forgot to mention the error.  RT-1004 Visible not able to be set in this class"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1575478235, "post_id": 59180892, "comment_id": 104582875, "body": "Is workbook structure protected?"}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1575478453, "post_id": 59180892, "comment_id": 104582996, "body": "I didn&#39;t think so, the prompt page itself wasn&#39;t protected either but I added the unprotect/protect just in case.  Can I do the same with the workbook?  Never protected workbook before."}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1575478875, "post_id": 59180892, "comment_id": 104583257, "body": "The RT1004 error seems intermittent.  Sometimes its thrown, sometimes not."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1575479144, "post_id": 59180892, "comment_id": 104583413, "body": "On the &quot;Review&quot; Ribbon tab, under the &quot;Protect&quot; group; there&#39;s a &quot;Protect Sheet&quot; button, and a &quot;Protect Workbook&quot; button next to it. Workbook protection deals with the ability to add/remove/hide/unhide worksheets. If workbook structure is protected, that would be why unhiding a sheet is throwing error 1004."}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1575479342, "post_id": 59180892, "comment_id": 104583530, "body": "@Matheiu Guindon - I&#39;ll check on that.  Apparently, my excel crashed and i&#39;ve been testing without the code I posted above.  So, give me a moment to rework the code and some of the suggestions and I&#39;ll post about any errors.  I say that, because at one point it seemed like there were no errors it just didn&#39;t work (I had the error handling commented out).  But, when I went to double-check before posting here, I checked with old code that still had that RT error."}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1575480573, "post_id": 59180892, "comment_id": 104584150, "body": "Ok so...1. The workbook is unprotected.  2. I changed the error-handling labels so they aren&#39;t duplicated. 3. Testing the code repeatedly no longer reveals any RT errors.  It still works fine when called from the Immediate Window, it ALSO works fine when manually stepped through in the debugger.  But, when I put a break in my save routines and step through the whole process, when I get to the hidesheets sub (the idea is to reset the sheets to the prompt sheet prior to save) it steps through without errors but does NOT hide any sheets."}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1575484856, "post_id": 59180892, "comment_id": 104586277, "body": "Well, I&#39;m stumped!  If I copy the sub code directly into where its called, it still doesn&#39;t error but doesn&#39;t do anything.  I&#39;m trying to see if I have a system setting toggled that I&#39;m unaware of but I can&#39;t see anything either."}], "owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1575483736, "creation_date": 1575477851, "last_edit_date": 1575483736, "question_id": 59180892, "link": "https://stackoverflow.com/questions/59180892/why-does-my-sub-not-work-when-it-runs-fine-in-immediate-window-excel-vba", "title": "Why does my sub not work when it runs fine in immediate window excel vba", "body": "<p>I've been trying to get the typical hide sheets/unhide sheets code to work for encouraging Macro enabling.  Since I lock down saving, I needed to do it slightly differently than putting it in the Workbook_BeforeClose Sub as usually is done.</p>\n\n<p>But...my hide sub</p>\n\n<pre><code>Sub HideSheets()\n'Error Handling when workbook is unprotected.\nOn Error GoTo EH\n'Unprotect the workbook to allow conditional formatting changes.\nThisWorkbook.Sheets(\"Field Service Report\").Unprotect Password:=\"x\"\nThisWorkbook.Sheets(\"Prompt\").Unprotect Password:=\"x\"\n\n'Main Sub Code\n    Application.EnableCancelKey = xlDisabled\n    Sheets(\"Prompt\").Visible = xlSheetVisible\n    Sheets(\"Field Service Report\").Visible = xlSheetVeryHidden\n    Application.EnableCancelKey = xlInterrupt\n\n'Reprotect worksheet before ending sub.\nThisWorkbook.Sheets(\"Field Service Report\").Protect Password:=\"x\", UserInterfaceOnly:=True\nThisWorkbook.Sheets(\"Prompt\").Protect Password:=\"x\"\n\nExit Sub\nEH:\nCall EH\nResume Next\n\nEnd Sub\n</code></pre>\n\n<p>and my unhide sub</p>\n\n<pre><code>Sub UnhideSheets()\n'Error Handling\nOn Error GoTo EH\n'Unprotect the workbook to allow conditional formatting changes.\nThisWorkbook.Sheets(\"Field Service Report\").Unprotect Password:=\"x\"\nThisWorkbook.Sheets(\"Prompt\").Unprotect Password:=\"x\"\n\n'Main Sub Code\n    Application.EnableCancelKey = xlDisabled\n    Sheets(\"Field Service Report\").Visible = xlSheetVisible\n    Sheets(\"Prompt\").Visible = xlSheetVeryHidden\n    Application.EnableCancelKey = xlInterrupt\n\n'Reprotect worksheet before ending sub.\nThisWorkbook.Sheets(\"Field Service Report\").Protect Password:=\"x\", UserInterfaceOnly:=True\nThisWorkbook.Sheets(\"Prompt\").Protect Password:=\"x\"\n\nExit Sub\nEH:\nCall EH\nResume Next\n\nEnd Sub\n</code></pre>\n\n<p>....works fine when called form the immediate window.  Sheets hide and unhide appropriately.</p>\n\n<p>But, when I step through the sub it doesn't actually do anything.  The idea is to set the sheets to the \"prompt\" sheet before saving, save, then revert to usable after saving.  But I can't even see if that code is working correctly (it appears to) because stepping through the actual hide/unhide subs doesn't do anything.</p>\n\n<p>Edit: No errors, just doesn't change any settings to hide or unhide sheets.</p>\n\n<p>Thoughts?</p>\n\n<p>Edit: So given the comments below, my subs work when run from the immediate window and when stepped through via debugger.  They hide and unhide the worksheets appropriately.  So, the only thing that can be wrong is the code that calls these subs.  So, here are two more subs.  One is the button code for a save button, and the other is the Workbook_BeforeSave Sub.</p>\n\n<pre><code>Sub Save_Form()\n\n'Error Handling ...\nOn Error GoTo EH\n\n'Unprotect the workbook ...\nThisWorkbook.Sheets(\"Field Service Report\").Unprotect Password:=\"x\"\n\n'Variable to disable any other save but this button.\nModule1.SaveChk = 1\n\n'Code to automatically save a copy ...\nModule1.UserPath = Environ(\"USERPROFILE\")\nModule1.Path = UserPath &amp; \"\\Desktop\\\"\nIf Module1.EditChk = \"Y\" Then\n    Module1.SaveName = \"FSR Master\"\nElse\n    Module1.SaveName = Range(\"AF6\").Value\nEnd If\n\nThisWorkbook.SaveAs _\n    Filename:=Path &amp; SaveName &amp; \".xlsm\", _\n    FileFormat:=52\n\nIf Module1.SaveError &lt;&gt; 1 Then\n    'User Display of Save Success\n    MsgBox \"Filename = \" &amp; SaveName &amp; vbNewLine _\n    &amp; \"File is saved to your desktop.\"\nElse\n    Module1.SaveError = 0\nEnd If\n\n'Reset SaveChk variable\nModule1.SaveChk = 0\n\n'Reprotect Worksheet\nThisWorkbook.Sheets(\"Field Service Report\").Protect Password:=\"x\", UserInterfaceOnly:=True\n\nExit Sub\n\nEH:\nCall ErHa\nResume Next\n\nEnd Sub\n</code></pre>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n'Error Handling ...\nOn Error GoTo EH\n\n'Save Initiation Check\nIf Module1.SaveChk &lt;&gt; 1 Then\n    Cancel = True\n    MsgBox \"Please Use Form Save Button\", vbOKCancel + vbExclamation, \"SAVE CANCELLED\"\n    Exit Sub\nEnd If\n\nIf Module1.EditChk &lt;&gt; \"Y\" Then 'Skips the whole block if EditChk = Y\n\n    'Create the final range of cells for checking\n    Set Module1.Required = Application.Union(Module1.Fixed, Module1.Drive, Module1.Stage)\n    'Check if all required cells are filled in\n    If WorksheetFunction.CountA(Module1.Required) &lt; Module1.Required.Count Then\n        Cancel = True\n        MsgBox \"Please Completed Shaded Cells!\", vbOK + vbExclamation, \"SAVE CANCELLED\"\n        Module1.SaveError = 1\n    Else\n        'Set the report date before saving\n        Application.EnableEvents = False\n        Range(\"AE59\") = Format(Now(), \"mm-dd-yyyy hh:mm:ss AM/PM\")\n        Application.EnableEvents = True\n    End If\nEnd If\n'Renable Macro Splash Screen Before Save\nCall HideSheets\n\nExit Sub\n\nEH:\nCall ErHa\nResume Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "named-ranges", "listobject"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575476642, "post_id": 59180201, "comment_id": 104581933, "body": "Why not just use <code>ListRows.Count</code>?"}, {"owner": {"reputation": 25, "user_id": 12480853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1211fbb56660f2081205db080b8d67?s=128&d=identicon&r=PG&f=1", "display_name": "NakoNachev", "link": "https://stackoverflow.com/users/12480853/nakonachev"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575476894, "post_id": 59180201, "comment_id": 104582105, "body": "I&#39;ve tried it already, only leaves the total number of rows within listobject, regardless of whether they are with our without data. What i need is the number of rows WITH data, i dont care for such that are empty."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575477434, "post_id": 59180201, "comment_id": 104582404, "body": "Side note: use <code>Long</code> instead of <code>Integer</code>. Follow-up question: which column of the table should be used to determine what is the last filled row?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1575477661, "post_id": 59180201, "comment_id": 104582530, "body": "Are the empty rows continuos?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 2, "creation_date": 1575477867, "post_id": 59180201, "comment_id": 104582640, "body": "Could any <i>&quot;empty&quot;</i> cell contain a formula (i.e.: = if( x, y, &quot;&quot; )"}, {"owner": {"reputation": 25, "user_id": 12480853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1211fbb56660f2081205db080b8d67?s=128&d=identicon&r=PG&f=1", "display_name": "NakoNachev", "link": "https://stackoverflow.com/users/12480853/nakonachev"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1575487805, "post_id": 59180201, "comment_id": 104587391, "body": "@EEM Always the first column. The data, which is in the table, is reference to another tab. I use the &quot;IF&quot; formula, if no data in the other tab - leaves blank, otherwise the referenced data"}, {"owner": {"reputation": 25, "user_id": 12480853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1211fbb56660f2081205db080b8d67?s=128&d=identicon&r=PG&f=1", "display_name": "NakoNachev", "link": "https://stackoverflow.com/users/12480853/nakonachev"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1575488280, "post_id": 59180201, "comment_id": 104587582, "body": "@EEM The empty rows are always continous, since i am importing dynamic data from java program and can happen, that not all fields are filled with data. It has a upper range though, meaning max. number of rows."}], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1575483960, "post_id": 59181271, "comment_id": 104585894, "body": "What if there is data in other columns? What if the cell value is <code>&quot;&quot;</code>?"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1575485645, "last_edit_date": 1575485645, "creation_date": 1575479031, "answer_id": 59181271, "question_id": 59180201, "link": "https://stackoverflow.com/questions/59180201/vba-excel-getting-total-number-of-rows-with-data-inside-listobject/59181271#59181271", "title": "VBA Excel getting total number of rows with data inside ListObject", "body": "<p>Try this function, pass the table object and the col number to base the count from:</p>\n\n<pre><code>Function countNonBlankListObjectRows(t as ListObject, col as Long) as Long\n\n   Dim totalRows as Long\n   totalRows = t.ListRows.Count\n\n   Dim blankRows as Long\n   On Error Resume Next 'in case no blank rows\n   blankRows = t.DataBodyRange.Columns(col).SpecialCells(xlCellTypeBlanks).Cells.Count\n   On Error GoTo 0\n\n   'to include zero length cell values as blanks\n   Dim zeroLength as Long\n   zeroLength = Application.WorksheetFunction.Countif(t.DataBodyRange.Columns(col).Cells,\"\"\"\")\n\n   countNonBlankListObjectRows = totalRows - blankRows - zeroLength\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1575514306, "last_edit_date": 1575514306, "creation_date": 1575512417, "answer_id": 59187272, "question_id": 59180201, "link": "https://stackoverflow.com/questions/59180201/vba-excel-getting-total-number-of-rows-with-data-inside-listobject/59187272#59187272", "title": "VBA Excel getting total number of rows with data inside ListObject", "body": "<p>Suggest to avoid the use of <code>ActiveWorkbook</code>, instead use variables <code>Objetcs</code>.</p>\n\n<p>Instead of:</p>\n\n<pre><code>   For counter = 1 To ActiveWorkbook.Worksheets.Count\n       If ActiveWorkbook.Worksheets(counter).ListObjects.Count = 0 Then\n           counter = counter + 1\n       ElseIf ActiveWorkbook.Worksheets(counter).ListObjects.Count &gt; 0 Then\n</code></pre>\n\n<p>Use <code>Object</code> variables</p>\n\n<pre><code>Dim wb As Workbook, ws As Worksheet, lo As ListObject\n</code></pre>\n\n<p>Then do something like:</p>\n\n<pre><code>For Each ws In wbInput.Worksheets\n    For Each lo In ws.ListObjects\n        With lo\n</code></pre>\n\n<p>The function <code>Workbook_ListObjects_Properties_ToArray</code>\nProcess the workbook <code>wbInput</code> and generates an Array <code>aOutput</code> with the required <code>ListObject</code> properties and a string message <code>sOutput</code> with any Error encountered, including when the ListObject has not Body.\nIt also return True if the process was successfully completed.</p>\n\n<p>Note that the line function <code>CountIf</code> with the criteria <code>vbNullString</code> counts the <code>Empty</code> cells and also the cells with formulas returning the value <code>=\"\"</code></p>\n\n<pre><code>WorksheetFunction.CountIf(.ListColumns(1).DataBodyRange, vbNullString)\n</code></pre>\n\n<p>This is the procedure:</p>\n\n<pre><code>Function Workbook_ListObjects_Properties_ToArray( _\n    aOutput As Variant, sOutput As String, wbInput As Workbook) As Boolean\nDim ws As Worksheet, lo As ListObject, lRowsVld As Long\nDim dt As Object, aRcrd As Variant\naRcrd = Array(\"Workbook\", \"Worksheet\", \"ListObject\", \"Total.Rows\", \"Valid.Rows\")\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n        .Calculation = xlCalculationManual\n    End With\n\n    Rem Validate Input\n    aOutput = vbNullString\n    sOutput = \"Input workbook is nothing\"\n    If wbInput Is Nothing Then GoTo Exit_Function\n    sOutput = vbNullString\n\n    Rem Set Dictionary to Collect ListObjects Properties\n    Set dt = CreateObject(\"Scripting.Dictionary\")\n    dt.Add \"Header\", aRcrd\n\n    For Each ws In wbInput.Worksheets\n        For Each lo In ws.ListObjects\n            With lo\n\n                Rem Validates ListObject DataBodyRange\n                If .ListColumns(1).DataBodyRange Is Nothing Then\n\n                    Rem ListObject with NO DataBodyRange\n                    aRcrd = Array(wbInput.Name, ws.Name, lo.Name, \"N/A\", \"N/A\")\n\n                Else\n\n                    Rem Process ListObject\n                    lRowsVld = .ListRows.Count - WorksheetFunction.CountIf(.ListColumns(1).DataBodyRange, vbNullString)\n\n                    Rem Set ListObject Properties Array\n                    aRcrd = Array(wbInput.Name, ws.Name, lo.Name, .ListRows.Count, lRowsVld)\n\n                End If\n\n                Rem Add Record to Dictionary\n                dt.Add 1 + dt.Count, aRcrd\n\n    End With: Next: Next\n\n    Rem Set Results\n    If dt.Count = 1 Then\n\n        sOutput = \"Input Workbook does not contain any ListObject\"\n        GoTo Exit_Function\n\n    Else\n\n        Rem Dictionary To Array\n        aOutput = dt.items\n\n    End If\n    Workbook_ListObjects_Properties_ToArray = True\n\nExit_Function:\n    With Application\n        .Calculation = xlCalculationAutomatic\n        .DisplayAlerts = True\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\n    End Function\n</code></pre>\n\n<p>It should be called like this:</p>\n\n<pre><code>Sub Workbook_ListObjects_ValidRows_ToArray()\nDim aLoProps As Variant\nDim sMsg As String\n\n    If Workbook_ListObjects_Properties_ToArray(aLoProps, sMsg, ThisWorkbook) Then\n        MsgBox \"Post the output array!\", vbInformation, \"ListObjects Properties\"\n: Stop\n\n    Else\n        MsgBox sMsg, vbCritical, \"ListObjects Properties\"\n\n    End If\n\n    End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/SZDfH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SZDfH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Suggest to read the following pages for details about the resources used:  </p>\n\n<p><a href=\"http://www.excelfunctions.net/Excel-Objects.html\" rel=\"nofollow noreferrer\">Excel Objects</a><br>\n<a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264596.aspx\" rel=\"nofollow noreferrer\">For Each...Next Statement</a><br>\n<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.listobject\" rel=\"nofollow noreferrer\">ListObject object (Excel)</a><br>\n<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/msgbox-function\" rel=\"nofollow noreferrer\">MsgBox function</a><br>\n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg251688.aspx\" rel=\"nofollow noreferrer\">On Error Statement</a><br>\n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg251519.aspx\" rel=\"nofollow noreferrer\">Using Arrays</a>     </p>\n"}], "owner": {"reputation": 25, "user_id": 12480853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba1211fbb56660f2081205db080b8d67?s=128&d=identicon&r=PG&f=1", "display_name": "NakoNachev", "link": "https://stackoverflow.com/users/12480853/nakonachev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 809, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1575514306, "creation_date": 1575475673, "last_edit_date": 1575477124, "question_id": 59180201, "link": "https://stackoverflow.com/questions/59180201/vba-excel-getting-total-number-of-rows-with-data-inside-listobject", "title": "VBA Excel getting total number of rows with data inside ListObject", "body": "<p>I am currently working on a small project of mine, where I have a bunch of tabs and a register tab. The idea of the register tab is to set default parameters for existing tables in the other tabs and to display how much data each of the tables has ( meaning the total number of rows with data inside ). This will later be used to resize the tables and to correct the charts coming from the tables. So far I've done the following:</p>\n\n<p><code>findRowObject()</code> is just returning the row of the table in the register tab and overwriting the data in the corresponding column to actualize the current amount of rows with data. What I can't do is actually calculate the non-empty rows in the specific range of <code>listobject</code> a.k.a the table, because <code>lastrow</code> doesn't leave the correct value, possibly because my logic is incorrect. I hope the explanation was ok.</p>\n\n<pre><code>Sub updateCurrentDataColumn()\n\n   Dim counter As Integer\n   Dim lastRow As Integer\n   Dim innerCounter As Integer\n   Dim currentDataNumber As Integer\n   Dim ws As Worksheet\n   Dim ob As ListObject\n   Dim rangeTo As Range\n\n   For counter = 1 To ActiveWorkbook.Worksheets.Count\n       If ActiveWorkbook.Worksheets(counter).ListObjects.Count = 0 Then\n           counter = counter + 1\n       ElseIf ActiveWorkbook.Worksheets(counter).ListObjects.Count &gt; 0 Then\n           For innerCounter = 1 To \n               ActiveWorkbook.Worksheets(counter).ListObjects.Count        \n               Set ob = ActiveWorkbook.Worksheets(counter).ListObjects(innerCounter)\n               lastRow = ActiveWorkbook.Worksheets(counter).Range(ob).End(xlUp).Rows.Count       \n               Worksheets(1).Cells(findRowObject(ob.Name), 5).Value = currentDataNumber       \n           Next innerCounter\n       End If\n   Next counter\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "powerpoint", "userform"], "answers": [{"comments": [{"owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "edited": false, "score": 0, "creation_date": 1575477529, "post_id": 59180614, "comment_id": 104582455, "body": "Thanks for the reply! To clarify, are you saying I should have <code>Public startOn As Integer</code> above the <code>SlideSorter</code> sub? If so, this doesn&#39;t fix the error. /// I don&#39;t quite understand the second point you&#39;re making - I know it&#39;s about error handling, but don&#39;t get the implementation."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "edited": false, "score": 0, "creation_date": 1575477927, "post_id": 59180614, "comment_id": 104582672, "body": "@TheveshTheva the <code>startOn</code> variable that&#39;s declared, is local to the <code>Okay1</code> button&#39;s <code>Click</code> handler procedure, and effectively an undeclared <code>Variant</code> inside your Ribbon callback procedure: <code>Option Explicit</code> will catch these accidental undeclared variables and force you to properly declare them. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> code inspections can also help here (likely more than the VBA compiler itself)."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "edited": false, "score": 0, "creation_date": 1575479151, "post_id": 59180614, "comment_id": 104583415, "body": "@TheveshTheva: @Mathieu Guidon explaind exactly what I meant. The <code>startOn</code> variable must be declared at a standard module level. I mean in such a module... If `SlideSorter&#39; sub runs in a standard module, it should be OK. If it runs at a form level, it is not OK. If you do not have a standard module in your project, you must create one."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1575479377, "post_id": 59180614, "comment_id": 104583549, "body": "@FaneDuru except, that makes a global variable, and no global variables are <i>actually</i> needed (see other answer)"}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 0, "last_activity_date": 1575477046, "creation_date": 1575477046, "answer_id": 59180614, "question_id": 59180163, "link": "https://stackoverflow.com/questions/59180163/excel-userform-input-going-haywire/59180614#59180614", "title": "Excel Userform Input going haywire", "body": "<p>Your <code>startOn</code> variable must be declared as Public at a module level.\nIt takes the value you set only for <code>Okay1_Click()</code> event.</p>\n\n<p>You should also use <code>Option Explicit' in the module where</code>Sub SlideSorter' runs. In this way an error regarding the <code>startOn</code> variable not being declared will be raised. </p>\n"}, {"comments": [{"owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "edited": false, "score": 3, "creation_date": 1575478520, "post_id": 59180858, "comment_id": 104583041, "body": "Read through your entire post on Rubberduck and the context-specific stuff you said in this answer. Incredible learning experience - I&#39;m very grateful."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1575477778, "creation_date": 1575477778, "answer_id": 59180858, "question_id": 59180163, "link": "https://stackoverflow.com/questions/59180163/excel-userform-input-going-haywire/59180858#59180858", "title": "Excel Userform Input going haywire", "body": "<p><a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show</a> strikes again!</p>\n\n<p>You're showing the form's <em>default instance</em>, and inside that form's code, you're referring to the default instance of that form:</p>\n\n<pre><code>Dim startOn As Integer\nstartOn = SlideSorterStart.Input1\nUnload SlideSorterStart\n</code></pre>\n\n<p>The <code>SlideSorterStart</code> identifier is dual-purposed here: it's the data type name of a <code>UserForm</code> class, <em>and</em> it's a project-scoped global object variable named after that form class.</p>\n\n<p>You should NEVER refer to a form's <em>default instance</em> within that form's code-behind. Use the <code>Me</code> reserved identifier to refer to the <em>current instance</em> (could be the default one, but could be any other too).</p>\n\n<pre><code>startOn = Me.Input1\n</code></pre>\n\n<p>And whatever you do, NEVER <code>Unload</code> a form while that form is being shown and you need to later access its instance state (for example, the user-provided contents of a control).</p>\n\n<p>Change your form's code behind as follows:</p>\n\n<pre><code>Option Explicit\nPrivate StartAtSlideIndex As Long\nPrivate HasCancelled As Boolean\n\nPublic Property Get StartSlideIndex() As Long\n    StartSlideIndex = StartAtSlideIndex\nEnd Property\n\nPublic Property Get IsCancelled() As Boolean\n    IsCancelled = HasCancelled\nEnd Property\n\nPrivate Sub Input1_Change()\n    On Error Resume Next 'index will be 0 if can't convert text value\n    StartAtSlideIndex = CLng(Input1.Text)\n    On Error GoTo 0\nEnd Sub\n\nPrivate Sub Okay1_Click()\n    Me.Hide\nEnd Sub\n\nPrivate Sub OnCancel()\n    HasCancelled = True\n    Me.Hide\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = VbQueryClose.vbFormControlMenu Then\n        Cancel = True\n        OnCancel\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note that <em>nowhere</em> in the form's code-behind does the form get destroyed, or gets any opportunity to be destroyed: that's why we need to handle <code>QueryClose</code>, to prevent the form instance from being destroyed if the user cancels the dialog by clicking the red \"X\" button - and since the user is always free to cancel any dialog by doing that, the code that's showing the form needs to know whether the dialog was cancelled. If you decide to add a <kbd>Cancel</kbd> button, you only need to make its <code>Click</code> handle invoke the <code>OnCancel</code> method.</p>\n\n<p>So, regardless of how the form gets closed, we only ever <code>Hide</code> it, and let the calling code destroy it.</p>\n\n<pre><code>SlideSorterStart.Show\n</code></pre>\n\n<p>That's showing the form's default instance. Avoid doing that.</p>\n\n<pre><code>With New SlideSorterStart '&lt;~ form instance gets created here\n    .Show\n    If .IsCancelled Then Exit Sub\n\n    Dim startOn As Long\n    startOn = .StartSlideIndex\nEnd With '&lt;~ form instance gets destroyed here\n</code></pre>\n\n<p>The <code>Initialize</code> handler of the form, if present will be invoked at <code>New SlideSorterStart</code> (before the object reference is yielded to the <code>With</code> block); if present, the <code>Terminate</code> handler of the form will be invoked at <code>End With</code>.</p>\n\n<p>Exactly when these two critical object lifecycle events are fired when you use the form's default instance, is non-deterministic: that's why you need to avoid it at all costs, and take full control of what objects you're using, and when and how you're destroying them.</p>\n\n<p>The reason why you're getting <code>0</code> is because the form is systematically unloading itself; the default instance gets destroyed along with its state, and then it gets re-created again next time it's referenced, but then it's re-created with the default initial state, ...which means you effectively lose the user's input.</p>\n"}], "owner": {"reputation": 975, "user_id": 4544928, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0eIk3.png?s=128&g=1", "display_name": "Thev", "link": "https://stackoverflow.com/users/4544928/thev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 1, "accepted_answer_id": 59180858, "answer_count": 2, "score": 1, "last_activity_date": 1582096354, "creation_date": 1575475530, "last_edit_date": 1582096354, "question_id": 59180163, "link": "https://stackoverflow.com/questions/59180163/excel-userform-input-going-haywire", "title": "Excel Userform Input going haywire", "body": "<p>I have the following code for a userform called <strong>SlideSorterStart</strong>:</p>\n\n<pre><code>Private Sub Okay1_Click()\n\nDim startOn As Integer\nstartOn = SlideSorterStart.Input1\nUnload SlideSorterStart\n\nEnd Sub\n</code></pre>\n\n<p><strong>Okay1</strong> is the OK button here below, while <strong>Input1</strong> is the name of the text box.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MttqV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MttqV.png\" alt=\"enter image description here\"></a></p>\n\n<p>I use the variable <code>startOn</code> in a module as follows:</p>\n\n<p>Sub SlideSorter(ByVal control As IRibbonControl)</p>\n\n<pre><code>Dim first As Long: first = ActiveWindow.Selection.SlideRange.SlideIndex\nDim last As Long: last = ActivePresentation.Slides.Count\n\nSlideSorterStart.Show\n\nFor i = first To last\n\n    With ActivePresentation.Slides(i)\n\n        On Error Resume Next\n        .Shapes(\"Squort\").Delete\n\n        Dim square As Shape\n        Set square = .Shapes.AddShape(msoShapeRectangle, 400, 360, 150, 150)\n\n        With square\n            .Name = \"Squort\"\n\n            With .TextFrame.TextRange\n              .Text = startOn\n           End With   ' TextFrame\n\n        End With ' Square itself\n\n    End With\n\n    startOn = startOn + 1\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>For some reason, instead of giving an output equal to the number filled into the UserForm, it always starts the first one at 0, and then the next time the function is run, increments by the number of slides. </p>\n\n<p>For instance, if there are 5 slides to put this box on, then the first time, Slide 1 will have a 0. The next time at 5. Then a 10, and so on.</p>\n\n<p>What is causing this?</p>\n"}, {"tags": ["excel", "vba", "function", "mouseover"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1575478612, "post_id": 59180088, "comment_id": 104583112, "body": "I copied the VBA code exactly as shown in the post you linked to and then entered a similar formula as you showed and it worked instantly. I suggest you to follow the entire instruction in the original post."}, {"owner": {"reputation": 11, "user_id": 11898000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9213c62096a84af757710f59d72fb5e3?s=128&d=identicon&r=PG&f=1", "display_name": "Highlander", "link": "https://stackoverflow.com/users/11898000/highlander"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1575548256, "post_id": 59180088, "comment_id": 104608206, "body": "jkpieterse, thank you for taking the time to try the link code and respond, I know it works for the(.Pictures.Insert) method but I&#39;m not working with Pictures! instead I am trying to associate other files with the (OLEObjects.Add) Function, maybe I&#39;m going about this the wrong way?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1575563601, "post_id": 59180088, "comment_id": 104616908, "body": "What precisely are you trying to achieve?"}, {"owner": {"reputation": 11, "user_id": 11898000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9213c62096a84af757710f59d72fb5e3?s=128&d=identicon&r=PG&f=1", "display_name": "Highlander", "link": "https://stackoverflow.com/users/11898000/highlander"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1575626388, "post_id": 59180088, "comment_id": 104638305, "body": "jkpieterse, Firstly I do appreciate your patience; I have produced a TREE search of all departmental .dwg files (10,500) which reside in many different folder locations, I migrated the results to an excel spreadsheet, where I searched for identical file names, I now want to preview all these files to see there contents, as is the case a matching name does not expressly mean matching content, so after I get the spreadsheet working it will be time to refine the folder structure and drawing content. My last piece of code works if I step through it, but I cant  get the Hyperlnk formula to work."}, {"owner": {"reputation": 11, "user_id": 11898000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9213c62096a84af757710f59d72fb5e3?s=128&d=identicon&r=PG&f=1", "display_name": "Highlander", "link": "https://stackoverflow.com/users/11898000/highlander"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1575627323, "post_id": 59180088, "comment_id": 104638734, "body": "jkpieterse, a plus side to using the preview method, is that it will hopefully help the departmental engineers view the refined files as well as to preview the contents of any excel based drawing register; one thing that may pose an issue for me further down the line, is that not all the engineers will have AutoCAD and I will need to trial a working spreadsheet on computers with Autodesk\u2019s free viewer <a href=\"https://www.autodesk.co.uk/products/dwg/viewers\" rel=\"nofollow noreferrer\">autodesk.co.uk/products/dwg/viewers</a> Drawing Trueview, as i believe the package and the OLE function are connected while adding the object to the spreadsheet?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1575637867, "post_id": 59180088, "comment_id": 104643734, "body": "I think the method you&#39;re using can only display a picture object so the files must be of a format that Insert, Picture is able to handle"}], "owner": {"reputation": 11, "user_id": 11898000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9213c62096a84af757710f59d72fb5e3?s=128&d=identicon&r=PG&f=1", "display_name": "Highlander", "link": "https://stackoverflow.com/users/11898000/highlander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1575559985, "creation_date": 1575475303, "last_edit_date": 1575559985, "question_id": 59180088, "link": "https://stackoverflow.com/questions/59180088/how-to-create-a-mouseover-for-the-oleobjects-add-function", "title": "How to create a Mouseover for the OLEObjects.Add Function", "body": "<p>I am trying to move on from a working SUB and change it into a working FUNCTION, I have recently read:\nExcel-vba-for-dummies-3rd-edition\nand started reading:\nExcel_VBA_Macro_Programming-Richard_Shepherd-Mc_Graw_Hill._MS_Excel_2016\nand the post on Stack overflow for picture insertion:\n<a href=\"https://stackoverflow.com/questions/43923102/hover-preview-over-excel-image-link/43925918\">Hover preview over excel image link</a></p>\n\n<p>But the SUB; Function and Hyperlink methods for altering a cell contents are currently bewildering?</p>\n\n<p>What I am trying to achieve; Hovering over a cell shows an OLE object preview (whilst hovering), my example is an AutoCAD drawing object.</p>\n\n<p>My working Sub:</p>\n\n<pre><code>Sub DWGPreview()\nDim ol As OLEObject\n    Set ol = ActiveSheet.OLEObjects.Add(Filename:=\"C:\\Users\\myname\\Desktop\\Test.dwg\", _\n        Link:=False, DisplayAsIcon:=False)\n            With ol\n                .Left = ActiveCell.Offset(0, 1).Left\n                .Top = ActiveCell.Offset(0, 1).Top\n                .Width = 800\n            End With\nEnd Sub\n</code></pre>\n\n<p>So, as a little Sub everything seems to work as intended.\nWhen I try to define a function as below, all I get is an active hyperlink if the cell is clicked?</p>\n\n<pre><code>Public Function OnMouseOver(URL As String)\n'Dim DoOnce As Boolean\nDim ol As OLEObject\n'If Not DoOnce Then\n    'DoOnce = True\n    Set ol = ActiveSheet.OLEObjects.Add(URL)\n        'With ol\n            '.Left = ActiveCell.Offset(0, 1).Left\n            '.Top = ActiveCell.Offset(0, 1).Top\n            '.Width = 800\n        'End With\n'End If\nEnd Function\n</code></pre>\n\n<p>Called via (cell A1):</p>\n\n<pre><code>=IFERROR(HYPERLINK(OnMouseOver(\"C:\\Users\\myname\\Desktop\\Test.dwg\",A1),\"C:\\Users\\myname\\Desktop\\Test.dwg\"), \"C:\\Users\\myname\\Desktop\\Test.dwg\")\n</code></pre>\n\n<p>As an update (5-Dec19), the code below works when i step through it but i can't seem to call it via the cell address (HYPERLINK)</p>\n\n<pre><code>Public Function OnMouseOver()\nDim DoOnce As Boolean\nDim ol As OLEObject\nDim URL As Range\nSet URL = Range(\"A1\")\nSet ol = ActiveSheet.OLEObjects.Add(Filename:=URL, _\n        Link:=False, DisplayAsIcon:=False)\n\nIf Not DoOnce Then\n    DoOnce = True\n            With ol\n                With .ShapeRange\n                    .LockAspectRatio = msoTrue\n                    .Width = 800\n                End With\n                .Left = ActiveCell.Offset(0, 1).Left\n                .Top = ActiveCell.Offset(0, 1).Top\n                .Placement = 1\n                .PrintObject = True\n            End With\nEnd If\nEnd Function\n</code></pre>\n\n<p>Any direction would be greatly appreciated</p>\n\n<p>Thank you in advance\nS.</p>\n"}, {"tags": ["excel", "vba", "loops", "for-loop", "do-loops"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1575474715, "post_id": 59179809, "comment_id": 104580754, "body": "You only need to unprotect the sheet once. do it outside the loop. If your code works and you just want to improve it, then this question may be better suited to <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1575474784, "post_id": 59179809, "comment_id": 104580807, "body": "Are you just transposing values? If so, there&#39;s no need for any loop at all."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1575474960, "post_id": 59179809, "comment_id": 104580929, "body": "In the first case (while), in each loop, both i and j  are incremented once, so there will be 11 runs. in the second case (for), you have two loops one inside the other, so you will have 11 (j=1-&gt;11) x 11 (i=6-&gt;16) runs. They don&#39;t do the same thing, and I doubt the second one can be faster."}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1575474973, "post_id": 59179809, "comment_id": 104580934, "body": "@cybernetic.nomad I appreciate the suggestion but my second code is not working so that&#39;s why I posted it here. and would I just put &quot;  .Sheets(&quot;MyTest2&quot;).Unprotect &quot;Swarf&quot;  &quot; just above the with statement or above Do While?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1575475161, "post_id": 59179809, "comment_id": 104581053, "body": "Range <code>K1-K10</code> contains 10 cells and you are pasting them into range <code>F2-P2</code>, which is 11 cells...Anyways, why don&#39;t you just copy the 10/11 values and then paste them transposed into cell <code>F2</code>?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1575475186, "post_id": 59179809, "comment_id": 104581064, "body": "If you want it faster, don&#39;t copy data cell by cell, copy them by bloc."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1575475206, "post_id": 59179809, "comment_id": 104581083, "body": "@Handreen <code>.Sheets(&quot;MyTest2&quot;).Unprotect &quot;Swarf&quot;</code> the <code>.</code> at the beginning means it is being referenced by a <code>With</code> statement, so it needs to go just after the <code>With</code> for example."}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575475254, "post_id": 59179809, "comment_id": 104581101, "body": "@BigBen Yes essentially I am transposing values now that I think about it, is there an easier way to do this?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575475274, "post_id": 59179809, "comment_id": 104581119, "body": "I fully agree with @BigBen here, transposing doesn&#39;t have to be done with a loop. If you do insist doing it this way, you should put <code>application.screenupdating = false</code> at the start and <code>application.screenupdating = true</code> at the end of your code. This will stop displaying everything you do on screen until it is done, which will increase performance."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1575475297, "post_id": 59179809, "comment_id": 104581136, "body": "@Handreen you can <code>.Copy</code> and then <code>.PasteSpecial xlPasteValues, Transpose:=True</code> and that would do it."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1575475461, "post_id": 59179809, "comment_id": 104581228, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.copy\" rel=\"nofollow noreferrer\">Copy</a> then <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.pastespecial\" rel=\"nofollow noreferrer\">PasteSpecial</a> with the transpose argument? Or Copy to an array, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.transpose\" rel=\"nofollow noreferrer\">Transpose</a> the array, and then copy back?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1575475930, "post_id": 59179809, "comment_id": 104581519, "body": "Hint: <code>destination.Range(&quot;F2:O2&quot;) = Application.Transpose(source.Range(&quot;K1:K10&quot;))</code>, given destination and source are set to the right (unprotected) worksheets."}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "edited": false, "score": 0, "creation_date": 1575476502, "post_id": 59179809, "comment_id": 104581852, "body": "Thank you all for the excellent answers"}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575476582, "post_id": 59179809, "comment_id": 104581893, "body": "@Plutian Do I just put the application.screenupdating=false right after my Private Sub and the application.screenupdating=true right before my End sub? and I am having a hard time writing the function to transpose for some reason"}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1575476829, "post_id": 59179809, "comment_id": 104582056, "body": "@VincentG how would I incorporate that into my code and remove the loop statement? would you mind showing me, thanks in advance"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575476836, "post_id": 59179809, "comment_id": 104582061, "body": "Anywhere before your first operation will do. Common practise is to put it just after your <code>Dim</code> statements, and the <code>True</code> one just before <code>End Sub</code>"}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1575476889, "post_id": 59179809, "comment_id": 104582101, "body": "@Damian I currently have ~~~Private Sub CommandButton1_Click()  Application.ScreenUpdating = False  Dim y As Workbook  Set y = Workbooks.Open(Filename:=&quot;\\\\schaeffler.com\\stratford\\DATA\\NE&zwnj;&#8203;A-FBA-P\\Projects\\Set&zwnj;&#8203;upSheets\\Databases\\T&zwnj;&#8203;est 2.xlsm&quot;, Password:=&quot;Swarf&quot;)     With y                 Sheets(&quot;MyTest2&quot;).Unprotect &quot;Swarf&quot;                 .Sheet1.Range(&quot;K1:K10&quot;).Copy                 .Sheets(&quot;Mytest2&quot;).Range(&quot;F2-P2&quot;).PasteSpecial xlPasteValues, Transpose:=True         Password = &quot;Swarf&quot;         .Save         .Close False     End With  Application.ScreenUpdating = True End Sub"}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575476986, "post_id": 59179809, "comment_id": 104582161, "body": "@Plutian thank you for clarifying what the common practice is, could you please let me know what the code is supposed to look like by just simply transposing in my case?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "edited": false, "score": 0, "creation_date": 1575481499, "post_id": 59179809, "comment_id": 104584653, "body": "It doesn&#39;t seem to be that slow. Remove some dots. See <a href=\"https://stackoverflow.com/questions/29596432/pointers-needed-for-speeding-up-nested-loop-macro-in-vba/29597193#29597193\" title=\"pointers needed for speeding up nested loop macro in vba\">stackoverflow.com/questions/29596432/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "edited": false, "score": 0, "creation_date": 1575477691, "post_id": 59180645, "comment_id": 104582551, "body": "The password seems to be giving me some type of error, any solutions to this?"}, {"owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "edited": false, "score": 0, "creation_date": 1575483991, "post_id": 59180645, "comment_id": 104585912, "body": "I have just slightly modified your code, thank you for the help"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1575477153, "creation_date": 1575477153, "answer_id": 59180645, "question_id": 59179809, "link": "https://stackoverflow.com/questions/59179809/improving-the-speed-of-a-loops-performance/59180645#59180645", "title": "Improving the speed of a Loop&#39;s performance?", "body": "<p>To much code to write in a comment, but here you go:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    With Workbooks.Open(Filename:=\"\\\\FILEPATH\\Databases\\Test 2.xlsm\", Password:=\"Swarf\").Sheets(\"MyTest2\")\n        .Unprotect \"Swarf\"\n        .Range(\"F2:O2\") = Application.Transpose(Sheet1.Range(\"K1:K10\"))\n        .Protect \"Swarf\"\n        .Password = \"Swarf\"\n        .Save\n        .Close False\n    End With\nEnd Sub\n</code></pre>\n\n<p>Not sure about the Protect / Password thing.</p>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "is_accepted": false, "score": 0, "last_activity_date": 1575484204, "creation_date": 1575484204, "answer_id": 59182612, "question_id": 59179809, "link": "https://stackoverflow.com/questions/59179809/improving-the-speed-of-a-loops-performance/59182612#59182612", "title": "Improving the speed of a Loop&#39;s performance?", "body": "<p>This is <strong>@Vincent G</strong> answer slightly modified (I have accepted his answer)- just fixed the password error I was getting, I am now using this code and it is working flawlessly! </p>\n\n<p>Leaving this here incase someone else reads this post and wants to know what the end result of everyone's suggestions is, thanks to everyone who contributed.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim y As Workbook\n\nApplication.ScreenUpdating = False\n\nSet y = Workbooks.Open(Filename:=\"\\\\FILEPATH\\Databases\\Test 2.xlsm\", Password:=\"Swarf\")\n\n    With y\n        Sheets(\"MyTest2\").Unprotect \"Swarf\"\n\n        .Sheets(\"Mytest2\").Range(\"F2:O2\") = Application.Transpose(Sheet1.Range(\"K1:K10\"))\n\n        Password = \"Swarf\"\n        .Save\n        .Close False\n\n    End With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 12373922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySizE.jpg?s=128&g=1", "display_name": "Handreen", "link": "https://stackoverflow.com/users/12373922/handreen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59180645, "answer_count": 2, "score": 0, "last_activity_date": 1575484204, "creation_date": 1575474485, "last_edit_date": 1575474767, "question_id": 59179809, "link": "https://stackoverflow.com/questions/59179809/improving-the-speed-of-a-loops-performance", "title": "Improving the speed of a Loop&#39;s performance?", "body": "<p>I currently have to workbooks, <strong>Test 1</strong> (the name of the first workbook where the code is written) and <strong>Test 2</strong> (where values are pasted into from <strong>Test 1</strong>). My current code takes the values from <strong>Rows K1-K10 (Column 11, Rows 1-10)</strong> from the <strong>Test 1</strong> workbook and pastes them into <strong>Columns F2-P2 (Row 2, Columns 6-16)</strong> of the <strong>Test 2</strong> workbook (<strong>THE FIRST CODE IS WORKING</strong>).</p>\n\n<p>I am trying to make this <strong>code run faster</strong> as when I use it for my other applications, I feel as if the loop makes it laggy and sluggish. I am trying to <strong>replace</strong> the <strong><em>Do (While) Loop</em></strong> with a <strong><em>Double (For) Loop statement</em></strong>. Please let me know if you have a suggestion as my <strong><em>Double (For) Loop</em></strong> is not pasting any values into the <strong>Test 2</strong> workbook (Also how do I measure the time it takes for each function to run).</p>\n\n<p>Here are both codes and screenshots as well for visual aid:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim y As Workbook\nDim i As Integer\nDim j As Integer\ni = 6\nj = 1\n\nSet y = Workbooks.Open(Filename:=\"\\\\FILEPATH\\Databases\\Test 2.xlsm\", Password:=\"Swarf\")\n\n    With y\n\n\n\n        Do While j &lt;= 11\n            If (Cells(j, 11).Value &lt;&gt; \"\") Then\n\n                .Sheets(\"MyTest2\").Unprotect \"Swarf\"\n                .Sheets(\"Mytest2\").Cells(2, i).Value = Sheet1.Cells(j, 11).Value\n\n            End If\n\n        i = i + 1\n        j = j + 1\n\n        Loop\n\n\n\n        .Password = \"Swarf\"\n        .Save\n        .Close False\n\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>Here is my attempted code at a Double (for) Loop:</p>\n\n<pre><code>\nPrivate Sub CommandButton1_Click()\n\nDim y As Workbook\nDim i As Integer\nDim j As Integer\n\nSet y = Workbooks.Open(Filename:=\"\\\\FILEPATH\\Databases\\Test 2.xlsm\", Password:=\"Swarf\")\n\n    With y\n\n        For i = 6 To 16\n          For j = 1 To 10\n\n\n            If (Cells(i, 11).Value &lt;&gt; \"\") Then\n\n                .Sheets(\"MyTest2\").Unprotect \"Swarf\"\n                .Sheets(\"Mytest2\").Cells(2, i).Value = Sheet1.Cells(j, 11).Value\n\n            End If\n\n          Next j\n        Next i\n\n        .Password = \"Swarf\"\n        .Save\n        .Close False\n\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6Y3dm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6Y3dm.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/nPpYh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nPpYh.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/dqZZS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dqZZS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/CZFKY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CZFKY.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575474153, "post_id": 59179665, "comment_id": 104580382, "body": "That&#39;s a lot of code. Can you slim it down to just the relevant section and the line throwing the error?"}, {"owner": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575529404, "post_id": 59179665, "comment_id": 104599062, "body": "It gets stuck at &#39;3 Pages     If Range(&quot;B16&quot;) = &quot;3   page Statement&quot; Then      Range - it then says &quot;Wrong number of arguments or invalid properrty assignment&quot; Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575563063, "post_id": 59195566, "comment_id": 104616620, "body": "Thank you evry much for your input, I have made the corrections but as a novice I&#39;m getting a new error message at the end saying &quot;For without next&quot; - could you advise further please"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575563124, "post_id": 59195566, "comment_id": 104616663, "body": "You&#39;re probably missing an End If"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575563505, "post_id": 59195566, "comment_id": 104616866, "body": "No, <a href=\"https://stackoverflow.com/posts/59179665/edit\">edit</a> your <i>question</i>"}, {"owner": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575563923, "post_id": 59195566, "comment_id": 104617080, "body": "I HAVE IMOVED: ws.Activate FROM UNDER: DestFolder = Sheets(&quot;Dashboard&quot;).Range(&quot;M4&quot;) TO  UNDER: Sheets(sheet_name.Value).Select And removed the last:    End With"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575565093, "post_id": 59195566, "comment_id": 104617669, "body": "Click this link: <a href=\"https://stackoverflow.com/posts/59179665/edit\">stackoverflow.com/posts/59179665/edit</a> - and edit your original question with your code, please, thanks."}, {"owner": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575565587, "post_id": 59195566, "comment_id": 104617903, "body": "Thank you very much, have just updated it. Error says for without next now"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575565660, "post_id": 59195566, "comment_id": 104617938, "body": "Yes, because you have a <code>For</code> but no <code>Next</code>. Check out this <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">smart indenter</a> to indent your code properly."}, {"owner": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575565990, "post_id": 59195566, "comment_id": 104618105, "body": "Wow thats good, was not aware of this - still have message For but no Next though?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575566138, "post_id": 59195566, "comment_id": 104618175, "body": "You still have a <code>For</code>, but no <code>Next</code>. There&#39;s no <code>Next</code> to close the <code>For Each sheet_name In Sheets(&quot;Info&quot;).Range(&quot;A:A&quot;)</code> loop."}, {"owner": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575566709, "post_id": 59195566, "comment_id": 104618452, "body": "Sorry I&#39;m just not understanding this. What I am trying to achieve is to create a pdf from a sheet range and save it to a folder and then do the same on all subsequent sheets in the specified range (Col A on &#39;Info&#39; sheet) and then stop when it reaches a sheet with no value in cell B8 - Sorry for not grasping this"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575566747, "post_id": 59195566, "comment_id": 104618474, "body": "When you have a <code>For</code> loop, it needs to be closed with a <code>Next</code>. You have the <code>For</code> portion, but you don&#39;t have a <code>Next</code>. Add the <code>Next</code> to close the loop."}, {"owner": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575567301, "post_id": 59195566, "comment_id": 104618748, "body": "Have tried various attempts like  Next ws but just ca&#39;t get this right"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575567363, "post_id": 59195566, "comment_id": 104618769, "body": "<code>Next sheet_name</code>, or just <code>Next</code>."}, {"owner": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "edited": false, "score": 0, "creation_date": 1575568374, "post_id": 59195566, "comment_id": 104619235, "body": "I really appreiate you helpand guidance but I think I need help with the whole code / challenge as I now have an ELSE without an IF"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1575550120, "creation_date": 1575550120, "answer_id": 59195566, "question_id": 59179665, "link": "https://stackoverflow.com/questions/59179665/error-assigning-to-a-range-wrong-number-of-arguments/59195566#59195566", "title": "Error assigning to a Range: Wrong number of arguments", "body": "<p>Distilling the error message...</p>\n\n<blockquote>\n  <p>\"Wrong number of arguments or invalid property assignment\"</p>\n</blockquote>\n\n<p>... the problem is that you are trying to pass 3+ arguments to <code>Range</code>, which can at most take 2. You want to combine each different area within a <em>single</em> range reference.</p>\n\n<p>Change</p>\n\n<pre><code>Range(\"B2:I50\", \"K2:R50\")\n...\nRange(\"B2:I50\", \"K2:R50\", \"T2:AA50\")\n...\nRange(\"B2:I50\", \"K2:R50\", \"T2:AA50\", \"AC2:AJ50\")\n...\nRange(\"B2:I50\", \"K2:R50\", \"T2:AA50\", \"AC2:AJ50\", \"AL2:AS50\")\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Range(\"B2:I50,K2:R50\")\n...\nRange(\"B2:I50,K2:R50,T2:AA50\")\n...\nRange(\"B2:I50,K2:R50,T2:AA50,AC2:AJ50\")\n...\nRange(\"B2:I50,K2:R50,T2:AA50,AC2:AJ50,AL2:AS50\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5098381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66779684d75cae91e1ee83c6d6864eb?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/5098381/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578783620, "creation_date": 1575474085, "last_edit_date": 1578783620, "question_id": 59179665, "link": "https://stackoverflow.com/questions/59179665/error-assigning-to-a-range-wrong-number-of-arguments", "title": "Error assigning to a Range: Wrong number of arguments", "body": "<p>I need to loop through named worksheets creating a pdf from each sheet and saving it to a folder.</p>\n\n<p>Have so far created the below and its getting stuck saying wrong number of arguments.</p>\n\n<p>It gets stuck at '3 Pages If Range(\"B16\") = \"3 page Statement\" Then Range - it then says</p>\n\n<blockquote>\n  <p>\"Wrong number of arguments or invalid property assignment\"</p>\n</blockquote>\n\n<p>Using Win 7 and Excel 2010</p>\n\n<pre><code>Sub CreatePDFs_Click()\n' CreatePDF_Statements\n'\n\n' Create a PDF from the current sheet and save to folder\n\nDim DestFolder As String, PDFFile As String\nDim OpenPDFAfterCreating As Boolean, AlwaysOverwritePDF As Boolean, DisplayEmail As Boolean\nDim OverwritePDF As VbMsgBoxResult\nDim ws As Worksheet\nDim sheet_name As Range\n\n'Loop\nFor Each sheet_name In Sheets(\"Info\").Range(\"A:A\")\nIf sheet_name.Value = \"\" Then\nExit For\nElse\nSheets(sheet_name.Value).Select\n\nws.Activate\n\n    OpenPDFAfterCreating = False    'Change this if you want to open the PDF after creating it : TRUE or FALSE\n    AlwaysOverwritePDF = False      'Change this if you always want to overwrite a PDF that already exists :TRUE or FALSE\n\nDestFolder = Sheets(\"Dashboard\").Range(\"M4\")\n\n\n    'Customer Name stored in B8\n    CustomerName = Left(ActiveSheet.Range(\"B8\").Value, InStr(1, ActiveSheet.Range(\"B8\").Value, \" \") + 50)\n\n    'Create new PDF file name including path and file extension\n    PDFFile = DestFolder &amp; Application.PathSeparator &amp; CustomerName &amp; \".pdf\"\n\n    'If the PDF already exists\n    If Len(Dir(PDFFile)) &gt; 0 Then\n        If AlwaysOverwritePDF = False Then\n\n            OverwritePDF = MsgBox(PDFFile &amp; \" already exists.\" &amp; vbCrLf &amp; vbCrLf &amp; \"Do you want to overwrite it?\", vbYesNo + vbQuestion, \"File Exists\")\n\n            On Error Resume Next\n            'If you want to overwrite the file then delete the current one\n            If OverwritePDF = vbYes Then\n                 Kill PDFFile\n                     Else\n\n                MsgBox \"OK then, if you don't overwrite the existing PDF, I can't continue.\" _\n                    &amp; vbCrLf &amp; vbCrLf &amp; \"Press OK to exit this macro.\", vbCritical, \"Exiting Macro\"\n                Exit Sub\n            End If\n        Else\n            On Error Resume Next\n            Kill PDFFile\n        End If\n        If Err.Number &lt;&gt; 0 Then\n\n            MsgBox \"Unable to delete existing file.  Please make sure the file is not open or write protected.\" _\n                    &amp; vbCrLf &amp; vbCrLf &amp; \"Press OK to exit this macro.\", vbCritical, \"Unable to Delete File\"\n            Exit Sub\n        End If\n    End If\n\n    'Create the PDF\n'0 Page\n\n    If Range(\"B16\") = \"0   page Statement\" Then\n\n    Range(\"B2:I50\").Select\n    Selection.ExportAsFixedFormat Type:=xlTypePDF, Filename:=PDFFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n        :=False, OpenAfterPublish:=OpenPDFAfterCreating\n\n    End If\n\n'1 Page\n\n    If Range(\"B16\") = \"1   page Statement\" Then\n\n    Range(\"B2:I50\").Select\n    Selection.ExportAsFixedFormat Type:=xlTypePDF, Filename:=PDFFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n        :=False, OpenAfterPublish:=OpenPDFAfterCreating\n\n    End If\n\n'2 Pages\n    If Range(\"B16\") = \"2   page Statement\" Then\n\n    Range(\"B2:I50,K2:R50\").Select\nSelection.ExportAsFixedFormat Type:=xlTypePDF, Filename:=PDFFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n        :=False, OpenAfterPublish:=OpenPDFAfterCreating\n\n    End If\n\n'3 Pages\n    If Range(\"B16\") = \"3   page Statement\" Then\n\n    Range(\"B2:I50,K2:R50,T2:AA50\").Select\nSelection.ExportAsFixedFormat Type:=xlTypePDF, Filename:=PDFFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n        :=False, OpenAfterPublish:=OpenPDFAfterCreating\n\n    End If\n\n'4 Pages\n    If Range(\"B16\") = \"4   page Statement\" Then\n\n    Range(\"B2:I50,K2:R50,T2:AA50,AC2:AJ50\").Select\n    Selection.ExportAsFixedFormat Type:=xlTypePDF, Filename:=PDFFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n        :=False, OpenAfterPublish:=OpenPDFAfterCreating\n\n    End If\n\n'5 Pages\n    If Range(\"B16\") = \"5   page Statement\" Then\n\n    Range(\"B2:I50,K2:R50,T2:AA50,AC2:AJ50,AL2:AS50\").Select\n    Selection.ExportAsFixedFormat Type:=xlTypePDF, Filename:=PDFFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n        :=False, OpenAfterPublish:=OpenPDFAfterCreating\n\n\n    End If\n\n          Cancel = True\n\n\n        End If\n\nSheets(\"Dashboard\").Select\nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1575474018, "post_id": 59179434, "comment_id": 104580288, "body": "<code>dw = dw1 dw = dw2 dl = dl1 dl = dl2</code> neither dl1, dl2, dw1 nor dw2 are initialized. What are the point of setting dw and dl? and why twice?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1575474170, "post_id": 59179434, "comment_id": 104580401, "body": "Instead of calculating the width, have you considered using <code>Range.Left</code> and <code>Range.Width</code> to get the positions based on the cells?  (i.e. <code>.Left = R.Cells(1,db1).Left</code> and <code>.Width = R.Cells(1,db2).Left + R.Cells(1,db2).Width - R.Cells(1,db1).Left</code>)"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1575474188, "post_id": 59179434, "comment_id": 104580415, "body": "Also db1 and db2 are undefined. And dl1 and dl2 are never used after being set."}, {"owner": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575474377, "post_id": 59179434, "comment_id": 104580524, "body": "sorry but i am new to vba , as i thought that i will use match for dw1 and dw2 to R ; and dl1 and dl2 are constant so i dont changed anything for both. it will be great help if you have new code."}, {"owner": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1575549071, "post_id": 59179434, "comment_id": 104608638, "body": "@Chronocidal hey it worked absolutely correct as i wanted . Can we use the below code and variable using your calculation. Means using below logic case ie. for and next , LastRow and LastCol . i tried using above formula in below code , but i was not able to tackle the error. can you please use it and post your code as answer?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575548705, "post_id": 59190682, "comment_id": 104608439, "body": "hey i tried using it, i got some problems i.e., when i expand any cell it doesn&#39;t take any Reference from it, EG: expand column P and then also the result is same, but as now it should take the reference of it and end at the shape at the column P. and one more if there is blank row in middle it gets MATCH error. can you help me this problem"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575549017, "post_id": 59190682, "comment_id": 104608615, "body": "What do You mean by saying &quot;expand&quot;?"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575550315, "post_id": 59190682, "comment_id": 104609351, "body": "Ok, I modified width parameter of rectangle from <code>(eDat - sDat) * widthCell</code> to this <code>.Cells(i, eDat).Left - .Cells(i, sDat).Left</code>, check it now :) I also checked my sheet with empty header and its working ok, can You explain it more if it is still the case?"}, {"owner": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575551633, "post_id": 59190682, "comment_id": 104610092, "body": "Super. Working Perfectly. Any idea for empty Cell or if there is only data in one cell and not in the next cell. EG : B11 = &quot;JAN 20&quot; and C11 = &quot;Empty&quot;. If there is only one input then it should not show rectangle and must go to another row."}, {"owner": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575552173, "post_id": 59190682, "comment_id": 104610399, "body": "Because for every single data i am going to use it as milestone. EG: B11 : Jan 20; which should show triangle in center of cell D11 (JAN 20) using match from Range(D4:AF4). that is my next task. It will be great help if you helpme out. and nothing to be shown if both are empty."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575552303, "post_id": 59190682, "comment_id": 104610481, "body": "I already edited code. Added conditional which will skip row if there is no date in column B or C. Check now :) Create new question for this task with triangle :)"}, {"owner": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575553372, "post_id": 59190682, "comment_id": 104611134, "body": "ok Thanks . it is now working but when i don&#180;t have data in column C ; it is still showing MATCH ERROR. and every time i run the code i need to delete first every shape which is already there. Is there any code which will help me for it(somewhat refresh or delete old shapes); if there is already shape there for that cell first delete it and have new one created after every run."}, {"owner": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575553423, "post_id": 59190682, "comment_id": 104611157, "body": "Sure i will create new questions for New Task. Thanks for the help."}, {"owner": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575554859, "post_id": 59190682, "comment_id": 104611919, "body": "Or in simple word i want to replace those shape every time i run the program."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575559784, "post_id": 59190682, "comment_id": 104614717, "body": "Did You tried version of code with <code>If .Cells(i, 2) = &quot;&quot; Or .Cells(i, 3) = &quot;&quot; Then</code> conditional? That will skip rows when column B or C is empty. So there can&#39;t be MATCH ERROR :)"}, {"owner": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "edited": false, "score": 0, "creation_date": 1575561320, "post_id": 59190682, "comment_id": 104615567, "body": "yeah its working thanks. and for replace i have used <code>For Each myRectangle In ActiveSheet.Shapes   If myRectangle.Type &lt;&gt; msoChart And myRectangle.Type &lt;&gt; msoComment Then myRectangle.Delete Next myRectangle</code>"}], "tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": true, "score": 1, "last_activity_date": 1575552224, "last_edit_date": 1575552224, "creation_date": 1575533122, "answer_id": 59190682, "question_id": 59179434, "link": "https://stackoverflow.com/questions/59179434/resize-shape-according-to-cell-data/59190682#59190682", "title": "Resize shape according to cell data", "body": "<p>I'm not really sure if I got your point in 100%, but take a look at my approach to this:</p>\n\n<pre><code>Option Explicit\n\nSub Rectanglematch()\n\nDim lastRow As Long\nDim lastCol As Long\nDim heightCell As Long\nDim widthCell As Long\nDim rngDates As Range\nDim i As Long\nDim sDat As Long\nDim eDat As Long\nDim myRectangle As Shape\n\nWith ThisWorkbook.Sheets(\"Tabelle1\")\n\n    lastRow = .Cells(Rows.Count, 2).End(xlUp).Row\n    lastCol = .Cells(4, Columns.Count).End(xlToLeft).Column\n\n    For i = 6 To lastRow\n\n        If .Cells(i, 2) = \"\" Or .Cells(i, 3) = \"\" Then\n\n        Else\n            heightCell = .Cells(i, 2).RowHeight\n            widthCell = .Cells(i, 2).Width\n\n            Set rngDates = .Range(.Cells(4, 4), .Cells(4, lastCol))\n\n            sDat = Application.WorksheetFunction.Match(.Cells(i, 2), rngDates, 0) + 3\n            eDat = Application.WorksheetFunction.Match(.Cells(i, 3), rngDates, 0) + 3\n\n            Set myRectangle = .Shapes.AddShape(msoShapeRectangle, .Cells(i, sDat).Left, .Cells(i, sDat).Top, .Cells(i, eDat).Left - .Cells(i, sDat).Left, heightCell)\n        End If\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>And the result looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/r9SgF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r9SgF.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope it will help You :)</p>\n"}], "owner": {"reputation": 21, "user_id": 12226040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9551749daa3f9991abc04c8826235a?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/12226040/akshay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 59190682, "answer_count": 1, "score": 1, "last_activity_date": 1575552224, "creation_date": 1575473373, "last_edit_date": 1575474405, "question_id": 59179434, "link": "https://stackoverflow.com/questions/59179434/resize-shape-according-to-cell-data", "title": "Resize shape according to cell data", "body": "<p>I want to resize the shape of rectangle according to cell data, were height(width) of rectangle is constant and length changes according to cell References.</p>\n\n<p>For EG (please refer image) : DW1 is starting side which should have Reference data from range(\"B13\") and move along or match data to range(\"D4:AF4\") and it should be same for another end side DW2.\nDW2 should have reference from range(\"C13\") and match data to range(\"D4:AF4\").</p>\n\n<p><a href=\"https://i.stack.imgur.com/boHbn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/boHbn.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have worked on some code but it is not having proper output. </p>\n\n<p>Please have a look for my code below.</p>\n\n<p>new code will also be helpfull</p>\n\n<pre><code>Sub Rectanglematch()\nDim dl1 As Double\nDim dl2 As Double\nDim dw1 As Double\nDim dw2 As Double\nDim dw As Double\nDim dl As Double\nDim d As Date\nDim R As Excel.Range\n\ndw = dw1\ndw = dw2\ndl = dl1\ndl = dl2\n\nd = CDate(Sheets(\"Tabelle1\").Range(\"b13\"))\nSet R = Sheets(\"Tabelle1\").Range(\"d4:AF4\")\ndl1 = 10 * Range(\"A1\").Value\ndl2 = 10 * Range(\"A1\").Value\n\ndw1 = Application.WorksheetFunction.Match(CDbl(CDate(Sheets(\"Tabelle1\").Range(\"b13\"))), R, 0)\ndw2 = Application.WorksheetFunction.Match(CDbl(CDate(Sheets(\"Tabelle1\").Range(\"c13\"))), R, 0)\nWith ActiveSheet.Shapes(\"Rechteck 2\")\n        .Top = .Top - dw + .Height\n        .Height = dw\n        .Width = dl\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium", "popup"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1575475531, "post_id": 59179091, "comment_id": 104581267, "body": "I can&#39;t remember vba implementation but do you have the equivalent of driver.switch_to.alert  that you can use to focus on that then sendkeys the required info? Python example: <a href=\"https://www.techbeamers.com/handle-alert-popup-selenium-python/\" rel=\"nofollow noreferrer\">techbeamers.com/handle-alert-popup-selenium-python</a>"}, {"owner": {"reputation": 23, "user_id": 11808108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa42bec8abe1aac38adb35d563f6062?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/11808108/jimmy"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1575479686, "post_id": 59179091, "comment_id": 104583700, "body": "@QHarr I&#39;ve tested with obj.SwitchToAlert.SendKeys and obj.SwitchToNextWindow but it appears a error message saying &quot;NoAlertPresentError no such alert...&quot;"}], "owner": {"reputation": 23, "user_id": 11808108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa42bec8abe1aac38adb35d563f6062?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/11808108/jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 719, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1583744143, "creation_date": 1575472313, "last_edit_date": 1583744143, "question_id": 59179091, "link": "https://stackoverflow.com/questions/59179091/how-to-handle-webpage-pop-up-with-vba-and-selenium", "title": "How to handle webpage pop-up with VBA and Selenium?", "body": "<p>I have a problem with a code that I am developing in VBA. I am trying to access a web page through the Excel macro. This web page is to access a camera connected to my network, due to its brand (Axis), when accessing I have to enter the username and password, and these text boxes appear in a pop-up window. I am using Google Chrome and the Selenium library.</p>\n\n<p>I have no way of finding out their \"id\" by pressing F12 or by right clicking and pressing \"Inspect element\" as can be done on the website itself. Finding out their \"id\" could handle them. It seems that handling pop-up windows is more complicated. I found some information about this, but it didn't help me much. </p>\n\n<p>For now I can open Google Chrome and access the website, but I cannot enter data in this window. I have tried several Selenium functions, such as writing on the active element, but I don't give any results. Any information on this would help me a lot.</p>\n\n<p>These are my few lines of functional code and a image of the pop-up window:</p>\n\n<pre><code>Public Sub OpenUrl()\n\nDim obj As New WebDriver\n\nobj.Start \"chrome\", \"\"\nobj.Get (\"webpage\")\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/oELlx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oELlx.jpg\" alt=\"The pop-up window\"></a></p>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575472518, "post_id": 59179022, "comment_id": 104579466, "body": "Possibly an easier approach - do you have any sheets with names starting with <code>&quot;File-&quot;</code> that you <i>don&#39;t</i> want to consider?"}, {"owner": {"reputation": 37, "user_id": 12177348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5108b2a1333bb7a7765414eeee8bd8?s=128&d=identicon&r=PG&f=1", "display_name": "chrisphils26", "link": "https://stackoverflow.com/users/12177348/chrisphils26"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575472733, "post_id": 59179022, "comment_id": 104579564, "body": "@BigBen No, all sheets with the name &quot;File-&quot; would be relevant in this case."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1575472760, "post_id": 59179022, "comment_id": 104579578, "body": "Then just use <code>InStr</code> (see the posted answer), or <code>Left</code> even."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1575643684, "post_id": 59179022, "comment_id": 104646601, "body": "Try to avoid <code>.Activate</code> and <code>.Select</code> if not expressly needed for user communication - c.f. <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?r=SearchResults&amp;s=1|191.2192\">How to avoid using Select in Excel VBA?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575474432, "post_id": 59179156, "comment_id": 104580564, "body": "If you were to do this approach, the outer loop should be the worksheet loop, and the inner loop should be <code>i</code>. But... it&#39;s really inefficient and there are way better approaches."}], "tags": [], "owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1575472500, "creation_date": 1575472500, "answer_id": 59179156, "question_id": 59179022, "link": "https://stackoverflow.com/questions/59179022/using-vba-to-loop-through-sheets-with-a-specific-name/59179156#59179156", "title": "Using VBA to Loop Through Sheets with a Specific Name", "body": "<p>Add one more loop for indx</p>\n\n<pre><code>Dim WS As Worksheet\nDim indx As Integer\nFor i = 1 to 30\n    indx  = i\nFor Each WS In ThisWorkbook.Worksheets\n    WS.Activate\n    If WS.Name = \"File-\" &amp; i Then\n       userform1.show\n    End If\nNext WS\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": true, "score": 3, "last_activity_date": 1575472559, "creation_date": 1575472559, "answer_id": 59179172, "question_id": 59179022, "link": "https://stackoverflow.com/questions/59179022/using-vba-to-loop-through-sheets-with-a-specific-name/59179172#59179172", "title": "Using VBA to Loop Through Sheets with a Specific Name", "body": "<p>You can use <code>Like</code> as @BigBen mentioned in comment or use <code>Instr</code> like below:</p>\n\n<pre><code>Option Explicit\nSub test()\n\nDim WS As Worksheet\nDim indx As Integer\n\nFor Each WS In ThisWorkbook.Worksheets\n    WS.Activate\n\n    If InStr(1, LCase(WS.Name), \"file\") Then\n        WS.Select\n        UserForm1.Show\n    End If\n\nNext WS\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 2, "creation_date": 1575472860, "post_id": 59179201, "comment_id": 104579630, "body": "This would compare each Worksheet against an incremental indx number, so I doubt it would work as expected..."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1575473239, "post_id": 59179201, "comment_id": 104579829, "body": "@Xabier thank you for pointing this out. I see where the mistake is! I have corrected the code."}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 2, "last_activity_date": 1575473182, "last_edit_date": 1575473182, "creation_date": 1575472632, "answer_id": 59179201, "question_id": 59179022, "link": "https://stackoverflow.com/questions/59179022/using-vba-to-loop-through-sheets-with-a-specific-name/59179201#59179201", "title": "Using VBA to Loop Through Sheets with a Specific Name", "body": "<p>See if below code helps</p>\n\n<pre><code>Dim WS As Worksheet\n\nFor Each WS In ThisWorkbook.Worksheets\n    WS.Activate\n    If WS.Name Like \"File-*\" Then\n        WS.Select\n        userform1.show\n    End If\nNext WS\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 12177348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a5108b2a1333bb7a7765414eeee8bd8?s=128&d=identicon&r=PG&f=1", "display_name": "chrisphils26", "link": "https://stackoverflow.com/users/12177348/chrisphils26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 59179172, "answer_count": 3, "score": 1, "last_activity_date": 1575475673, "creation_date": 1575472035, "last_edit_date": 1575475673, "question_id": 59179022, "link": "https://stackoverflow.com/questions/59179022/using-vba-to-loop-through-sheets-with-a-specific-name", "title": "Using VBA to Loop Through Sheets with a Specific Name", "body": "<p>I am trying to build a macro to run through a file and open a userform for every sheet that has the name \"File-n\" where n is an integer. I've tried this code, but it doesn't work:</p>\n\n<pre><code>Dim WS As Worksheet\nDim indx As Integer\n\nFor Each WS In ThisWorkbook.Worksheets\n    WS.Activate\n\n    If WS.Name = \"File-\" &amp; indx Then\n        WS.Select\n        userform1.show\n    End If\n\nNext WS\n</code></pre>\n\n<p>This macro doesn't recognize any sheets. The code below works, but I was hoping to clean it up if possible. I don't like listing out the potential number of sheets up to thirty.</p>\n\n<pre><code>If WS.Name = \"File-0\" or WS.Name = \"File-1\" or WS.Name = \"File-2\" or ... Then\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1575479689, "post_id": 59178925, "comment_id": 104583702, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">This may help</a> you to clean up your code a bit"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1575495378, "post_id": 59178925, "comment_id": 104590325, "body": "Copy/pasting ranges is not recommended. Assign the values from one range to another using (e.g.) <code>Sheets(&quot;sheet2&quot;).range(&quot;A1:A10).value = Sheets(&quot;sheet1&quot;).range(&quot;B1:B10).value</code>"}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1575495724, "post_id": 59184890, "comment_id": 104590426, "body": "I would use worksheetfunction.vlookup to find the associated Prod ID or HS Code and then pass that string resulting from the vlookup into the function to return the net weight next to the corresponding row."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1575495954, "post_id": 59184890, "comment_id": 104590496, "body": "index/match for HS code, since that field is to the right of the pallet field."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1575497278, "post_id": 59184890, "comment_id": 104590895, "body": "So <code>Sheets(&quot;Sheet2&quot;).Range(&quot;D4&quot;) = CalculateNetWeight(worksheetfunction.vlookup(Sheets(&quot;Sheet2&quot;&zwnj;&#8203;).Range(&quot;B4&quot;),Sheets&zwnj;&#8203;(&quot;Sheet1&quot;).Range(&quot;B:&zwnj;&#8203;G&quot;),4,False))</code>...loop through list as required to process all."}, {"owner": {"reputation": 286, "user_id": 6119995, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fc6ac6626a0d0c0bd60c19006ee0664a?s=128&d=identicon&r=PG&f=1", "display_name": "Tamal Banerjee", "link": "https://stackoverflow.com/users/6119995/tamal-banerjee"}, "edited": false, "score": 0, "creation_date": 1575552804, "post_id": 59184890, "comment_id": 104610818, "body": "how can I do this dynamically without manually writing the range? also how do I loop through your function dynamically without doing a fill down of the formula?"}], "tags": [], "owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "is_accepted": false, "score": 0, "last_activity_date": 1575566339, "last_edit_date": 1575566339, "creation_date": 1575494819, "answer_id": 59184890, "question_id": 59178925, "link": "https://stackoverflow.com/questions/59178925/using-a-udf-in-a-vba-copy-paste-macro/59184890#59184890", "title": "Using a UDF in a VBA copy paste macro", "body": "<p>This should do it...adjust ranges as required.</p>\n\n<pre><code>Sub PopulateNetWeightColumn()\n    Sheets(\"Sheet2\").Activate\n    Range(\"C4\").Select\n    While Range(\"C\" &amp; ActiveCell.Row) &lt;&gt; \"\"\n        Range(\"E\" &amp; ActiveCell.Row) = CalculateNetWeight(WorksheetFunction.VLookup(Range(\"C\" &amp; ActiveCell.Row), Sheets(\"Sheet1\").Range(\"B3:G12\"), 4, False))\n        ActiveCell.Offset(1, 0).Select\n    Wend\nEnd Sub\nFunction CalculateNetWeight(palletString)\n    Dim mult_1, mult_2\n    palletString = Mid(palletString, InStr(palletString, \"(\") + 1, 100)\n    palletString = Trim(Replace(Replace(Replace(palletString, \" ml\", \"\"), \" gm\", \"\"), \")\", \"\"))\n    mult_1 = CLng(Left(palletString, InStr(palletString, \"x\") - 1))\n    mult_2 = CLng(Replace(palletString, mult_1 &amp; \"x\", \"\"))\n    CalculateNetWeight = (mult_1 * mult_2) / 1000\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 286, "user_id": 6119995, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fc6ac6626a0d0c0bd60c19006ee0664a?s=128&d=identicon&r=PG&f=1", "display_name": "Tamal Banerjee", "link": "https://stackoverflow.com/users/6119995/tamal-banerjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575566339, "creation_date": 1575471644, "last_edit_date": 1575541843, "question_id": 59178925, "link": "https://stackoverflow.com/questions/59178925/using-a-udf-in-a-vba-copy-paste-macro", "title": "Using a UDF in a VBA copy paste macro", "body": "<p>In a workbook of mine there are 2 worksheets (Sheet1 &amp; Sheet2) and Sheet1 has some data like</p>\n\n<p><a href=\"https://i.stack.imgur.com/z93Et.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z93Et.png\" alt=\"s1\"></a></p>\n\n<p>I'm trying to copy the data from columns SERIAL NO., HS CODE and PALLET MMT to Sheet2's columns PROD. ID, HS CODE &amp; NET WT. respectively. Now the first two copies are pretty straight forward but the problem I'm having is generating NET WT. (it is the product of two numbers inside the brackets &amp; divided by 1000)</p>\n\n<p>Default Sheet2 looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xnPKp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xnPKp.png\" alt=\"s2\"></a></p>\n\n<p>Result Sheet2 data should look like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DnQxy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DnQxy.png\" alt=\"s2Result\"></a></p>\n\n<p>I've done:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\n'\n    Cells.Find(What:=\"SERIAL\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).Activate\n    ActiveCell.Offset(1, 0).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Cells.Find(What:=\"PROD\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).Activate\n    Range(\"B4\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Sheets(\"Sheet1\").Select\n    Range(\"A1\").Select\n    Cells.Find(What:=\"CODE\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).Activate\n    ActiveCell.Offset(1, 0).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"C4\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n' @@@@@@@@@@ NET WT. ?????? @@@@@@@@@@@@@\nEnd Sub\n</code></pre>\n\n<p>I've also made a function to calculate NET WT. &amp; but struggling to figure out how to use it in my code without making it too complicated</p>\n\n<pre><code>Function netWT(CellRef As String)\n    Dim i As Long, Result As String, ch As String\n    For i = 1 To Len(CellRef)\n        ch = Mid(CellRef, i, 1)\n        Result = Result &amp; IIf(ch Like \"[0-9]\", ch, \" \")\n    Next i\n    Result = Application.Trim(Result)\n    netWT = (Split(Result, \" \")(1) * Split(Result, \" \")(2)) / 1000\nEnd Function\n</code></pre>\n\n<p>Help please. Different approach than mine are also welcome...It just has to do the job efficiently.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 14219954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bacTs8b-HBQ/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclOWjBEnVG3485Zt1g9Lk1iG4lVzQ/photo.jpg?sz=128", "display_name": "Keeeeeeeee", "link": "https://stackoverflow.com/users/14219954/keeeeeeeee"}, "is_accepted": false, "score": 1, "last_activity_date": 1599258940, "last_edit_date": 1599258940, "creation_date": 1599211738, "answer_id": 63738478, "question_id": 59178837, "link": "https://stackoverflow.com/questions/59178837/vba-downloading-files-from-ie-second-popup-appears-after-clicking-save/63738478#63738478", "title": "VBA downloading files from IE: Second popup appears after clicking &quot;Save&quot;", "body": "<p>As this is the second popup notification bar, you cannot invoke your <code>AutomationElement</code> which is <code>Button</code> in your code because there is no &quot;save&quot; button to find in IE.</p>\n<p>You need to reset your <code>AutomationCodition</code> <code>iCnd</code> to &quot;Retry&quot; and find the button to invoke it. <code>Button</code> will be <code>Nothing</code> if you cannot find the save button.</p>\n<pre><code>While Not filefound\n    If Dir(file_path) &lt;&gt; &quot;&quot; Then filefound = True\n    Application.Wait (Now + TimeValue(&quot;0:00:01&quot;))\n\n    Dim o As IUIAutomation\n    Dim e As IUIAutomationElement\n    Set o = New CUIAutomation\n\n    Dim h As Long\n    h = ie.Hwnd\n    h = FindWindowEx(h, 0, &quot;Frame Notification Bar&quot;, vbNullString)\n\n    If h &lt;&gt; 0 Then\n        On Error Resume Next\n\n        Set e = o.ElementFromHandle(ByVal h)\n        Dim iCnd As IUIAutomationCondition\n        Set iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, &quot;Save&quot;)\n\n        Dim Button As IUIAutomationElement\n        Set Button = e.FindFirst(TreeScope_Subtree, iCnd)\n        If Button Is Nothing Then\n            Set iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, &quot;Retry&quot;)\n            Set Button = e.FindFirst(TreeScope_Subtree, iCnd)\n        End If\n\n        Dim InvokePattern As IUIAutomationInvokePattern\n        Set InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId)\n        InvokePattern.Invoke\n\n        On Error GoTo 0\n    End If\nWend\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 12087170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f568c5e58502990f033ba51b26364a?s=128&d=identicon&r=PG&f=1", "display_name": "Su314", "link": "https://stackoverflow.com/users/12087170/su314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1599258940, "creation_date": 1575471326, "last_edit_date": 1575477688, "question_id": 59178837, "link": "https://stackoverflow.com/questions/59178837/vba-downloading-files-from-ie-second-popup-appears-after-clicking-save", "title": "VBA downloading files from IE: Second popup appears after clicking &quot;Save&quot;", "body": "<p>I am automating a process where I have to download files from a website in internet explorer I have the following code which clicks the \"Save\" button once the download pops up.</p>\n\n<pre><code>Sub thing()\n\n'Find download message and click Save to download file\nDim o As IUIAutomation\nSet o = New CUIAutomation\nDim Completed As String\nDim h As Long\nDim ie As InternetExplorer\nDim html As HTMLDocument\n\nSleep 1000\nSet ie = CreateObject(\"InternetExplorer.application\")\nDo\n    h = ie.hwnd\n    h = FindWindowEx(h, 0, \"Frame Notification Bar\", vbNullString)\n\n    If h &lt;&gt; 0 Then\n        Dim count As Long\n        count = 0\n        Exit Do\n    Else\n        Sleep 100\n        count = count + 1\n    End If\nLoop\n\nDim e As IUIAutomationElement\nSet e = o.ElementFromHandle(ByVal h)\n\nDim iCnd As IUIAutomationCondition\nSet iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, \"Save\")\n\nDim Button As IUIAutomationElement\nSet Button = e.FindFirst(TreeScope_Subtree, iCnd)\n\nSleep 1000\n\nDo\n    On Error Resume Next\n    Dim InvokePattern As IUIAutomationInvokePattern\n    Set InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId)\n\n    If Err.Number = 0 Then\n        On Error GoTo 0\n        Exit Do\n    Else\n        Sleep 100\n        count = count + 1\n    End If\n    On Error GoTo 0\nLoop\n\nInvokePattern.Invoke\n\nDo\n    Sleep 1000\n    Completed = DownloadComplete()\n    If Completed = \"Yes\" Then\n        Exit Do\n    Else\n    End If\nLoop\n\nSendMessage h, WM_CLOSE, 0, 0\n\nEnd Sub\n</code></pre>\n\n<p>However when I run this automation at home, sometimes the following popup appears after clicking \"Save\":\n<a href=\"https://i.stack.imgur.com/SLLDU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SLLDU.png\" alt=\"DialogBox\"></a></p>\n\n<p>How should I tell VBA to click \"Retry\" if this button pops up?\nThank you for your help! </p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "edited": false, "score": 1, "creation_date": 1575472754, "post_id": 59178825, "comment_id": 104579574, "body": "@BigBen - Done.  As the code shows, the result should replace the value in the <code>Dist_Sht</code> <code>L</code> column."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575473013, "post_id": 59178825, "comment_id": 104579718, "body": "Your VLOOKUP formula uses column M - <code>M3</code> for the lookup value. Is one of your screenshots supposed to include column M?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1575473111, "post_id": 59178825, "comment_id": 104579772, "body": "The contents of your <code>With Dist_Sht</code> block are not qualified. There&#39;s a typo in the <code>lse</code> condition :) (should be <code>Else</code>) that would prevent the code from compiling. Assuming that&#39;s a copy/paste error here only and not in your code. If you put a breakpoint on <code>VL_Rslt = Application.VLookup(VL_Find, VL_Srch_Rng, 2, False)</code>, and evaluate that statement in the Immediate pane &amp; examine the variables in the Locals pane in the IDE, what do you see?"}, {"owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575473550, "post_id": 59178825, "comment_id": 104580009, "body": "@BigBen - I&#39;m an idiot.  <code>Set VL_Srch_Rng = Mvmt_Sht.Range(Mvmt_Sht.Cells(4, 8), Mvmt_Sht.Cells(Mvmt_LR, 9))</code> should have been the line.  That said, I am still receiving <code>#N?A</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575473650, "post_id": 59178825, "comment_id": 104580063, "body": "No that line seems fine. This seems problematic. <code>VL_Find = Cells(v, w).Value</code>. You can use column letters within cells, if that helps: <code>Cells(Mvmt_LR, &quot;H&quot;)</code>. Always help to <code>Debug.Print</code> the <code>Address</code> of the cell to make sure you&#39;ve got the right one. <code>w</code> starts at 12, which is column <code>L</code>?"}, {"owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1575473668, "post_id": 59178825, "comment_id": 104580075, "body": "@DavidZemens That was a copy/paste error.  The code does say <code>Else</code>."}, {"owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575474667, "post_id": 59178825, "comment_id": 104580722, "body": "@BigBen - <code>VL_Find</code> shows the expected value when the code is in break mode and you hover over it.  The next line <code>VL_Rslt = Application.VLookup(VL_Find, VL_Srch_Rng, 2, False)</code> shows <code>Error 2042</code>.  <code>VL_Rslt</code> is a <code>Variant</code> as you suggested yesterday; should <code>VL_Find</code> be something other than a <code>String</code>?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575475771, "post_id": 59178825, "comment_id": 104581419, "body": "Try <code>Variant</code> but it&#39;s really hard to debug without your data."}, {"owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575476678, "post_id": 59178825, "comment_id": 104581950, "body": "@BigBen THIS WAS IT!  Thank you so much for all of your help!  Between your help yesterday and today, I&#39;d give you all of the internet points if I could!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575476720, "post_id": 59178825, "comment_id": 104581978, "body": "Happy to help out, cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1575489672, "post_id": 59180820, "comment_id": 104588155, "body": "You might still be able to get this to work with a stricter type than <code>Variant</code>, perhaps <code>Double</code> (assuming all of the values are numeric in nature). It looks like you&#39;ve got numeric values. But Excel is sometimes finicky about strings that look like numbers (e.g., numbers that are stored as strings)."}], "tags": [], "owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "is_accepted": false, "score": 1, "last_activity_date": 1575477678, "creation_date": 1575477678, "answer_id": 59180820, "question_id": 59178825, "link": "https://stackoverflow.com/questions/59178825/application-vlookup-passes-but-doesnt-return-value/59180820#59180820", "title": "Application.VLookup passes, but doesn&#39;t return value", "body": "<p>Shout out to @BigBen The main issue was that <code>VL_Find</code> needed to be a <code>variant</code>, other issues included a typo that resulted in setting the <code>Mvmt_srch_Rng</code> across the wrong array.\n    Dim VL_Find as Variant</p>\n\n<pre><code>Mvmt_Bk.Activate\nMvmt_Sht.Activate\nWith ActiveSheet\n   Range(\"H:H\").Insert Shift:=xlToLeft\n   For o = 4 To Cells(Rows.Count, 2).End(xlUp).Row\n      Range(\"H\" &amp; o).Value = Range(\"A\" &amp; o) &amp; \".\" &amp; Range(\"C\" &amp; o).Value\n   Next o\n   Range(\"H3\").Value = \"Lookup Value\"\n   Range(\"H4\").ColumnWidth = 14\n   Range(\"H:H\").NumberFormat = \"000.000000000000\"\n   Range(\"H:I\").Value = Range(\"H:I\").Value\n\n   Mvmt_LR = .Cells(Rows.Count, 2).End(xlUp).Row\n   Mvmt_LC = .Cells(3, Columns.Count).End(xlToLeft).Column\n   Set VL_Srch_Rng = Mvmt_Sht.Range(Mvmt_Sht.Cells(4, \"H\"), Mvmt_Sht.Cells(Mvmt_LR, \"I\"))\nEnd With\nActiveWindow.WindowState = xlMinimized\n\nSource_Bk.Activate\nDist_Sht.Activate\nWith ActiveSheet\n   For u = Dist_LR To 2 Step -1\n      If Range(\"J\" &amp; u).Value = \"0\" Then\n         Range(\"J\" &amp; u).EntireRow.Delete\n      Else\n      For s = 12 To Dist_LC\n         If Cells(u, s).Value &lt;&gt; \"0\" Then\n            Cells(u, s).Value = Mid(Cells(1, s), Len(Cells(1, s)) - 7, 3) &amp; \".\" &amp; Cells(u, 2)\n            Cells(u, s).NumberFormat = \"000.000000000000\"\n            Cells(u, s).Value = Cells(u, s).Value\n         End If\n      Next s\n      End If\n   Next u\n\n   For v = 2 To Dist_LR\n      For w = 12 To Dist_LC\n         If Cells(v, w) &lt;&gt; 0 Then\n            VL_Find = Cells(v, w).Value\n            VL_Rslt = Application.VLookup(VL_Find, VL_Srch_Rng, 2, False)\n            Dist_Sht.Cells(v, w) = VL_Rslt\n            Dist_Sht.Cells(v, w).NumberFormat = 0\n            If IsError(VL_Rslt) Then\n               Dist_Sht.Cells(v, w).Value = \"Not Found\"\n            End If\n         End If\n      Next w\n   Next v\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575477678, "creation_date": 1575471300, "last_edit_date": 1575472658, "question_id": 59178825, "link": "https://stackoverflow.com/questions/59178825/application-vlookup-passes-but-doesnt-return-value", "title": "Application.VLookup passes, but doesn&#39;t return value", "body": "<p>I've been working with some code for several hours and have hit a wall.  I've got the code to pass through the sub, but it doesn't return the value from the selected range, it always returns <code>#N/A</code>.  I have done the vlookup with a formula and get it to return as expected, but I just can't make it work with the VBA application.</p>\n\n<p>I feel certain that this is a formatting error on my part, but I can't figure it out because it looks to me like everything is formatted the same.  If there is an alternate way to execute this, I am open to it.  All objects are declared globally, and I believe the issue is rooted in the <code>VL_Srch_Rng</code> range which is in a different workbook, and maybe that is where my mistake is(?).</p>\n\n<p><strong>Details:</strong> The format of the values that I am looking for is a 3 digit store number a <code>.</code> then a 12 digit UPC.  <code>Source_Bk</code> and <code>Dist_Sht</code> is where the result should land, and the <code>Mvmt_Bk</code> and <code>Mvmt_Sht</code> <code>range(\"H:I\")</code> is where the range being searched is located.  The return value is just a number that reflects units sold.</p>\n\n<pre><code>Dim Dist_Sht As Worksheet, Dist_LR As Long, Dist_LC As Long, Source_Bk As Workbook, VL_Rslt As Variant, VL_Find As String, VL_Srch_Rng As Range, Mvmt_LR As Long, Mvmt_LC As Long\n\nMvmt_Bk.Activate\nMvmt_Sht.Activate\nWith ActiveSheet\n   Range(\"H:H\").Insert Shift:=xlToLeft\n   For o = 4 To Cells(Rows.Count, 2).End(xlUp).Row\n      Range(\"H\" &amp; o).Value = Range(\"A\" &amp; o) &amp; \".\" &amp; Range(\"C\" &amp; o).Value\n   Next o\n   Range(\"H3\").Value = \"Lookup Value\"\n   Range(\"H4\").ColumnWidth = 14\n   Range(\"H:H\").NumberFormat = \"000.000000000000\"\n   Range(\"H:I\").Value = Range(\"H:I\").Value\n\n   Mvmt_LR = .Cells(Rows.Count, 2).End(xlUp).Row\n   Mvmt_LC = .Cells(3, Columns.Count).End(xlToLeft).Column\n   Set VL_Srch_Rng = Mvmt_Sht.Range(Mvmt_Sht.Cells(8, 3), Mvmt_Sht.Cells(Mvmt_LR, Mvmt_LC))\nEnd With\n\nSource_Bk.Activate\nDist_Sht.Activate\nWith Dist_Sht\n   For u = Dist_LR To 2 Step -1\n      If Range(\"J\" &amp; u).Value = \"0\" Then\n         Range(\"J\" &amp; u).EntireRow.Delete\n      lse\n      For s = 12 To Dist_LC\n         If Cells(u, s).Value &lt;&gt; \"0\" Then\n            Cells(u, s).Value = Mid(Cells(1, s), Len(Cells(1, s)) - 7, 3) &amp; \".\" &amp; Cells(u, 2)\n            Cells(u, s).NumberFormat = \"000.000000000000\"\n            Cells(u, s).Value = Cells(u, s).Value\n         End If\n      Next s\n      End If\n   Next u\nEnd With\n'Run to here for the examples below\n   For v = 2 To Dist_LR\n      For w = 12 To Dist_LC\n         If Cells(v, w) &lt;&gt; 0 Then\n            VL_Find = Cells(v, w).Value\n            VL_Rslt = Application.VLookup(VL_Find, VL_Srch_Rng, 2, False)\n            Dist_Sht.Cells(v, w) = VL_Rslt\n            If IsError(VL_Rslt) Then\n               Dist_Sht.Cells(v, w).Value = \"Not Found\"\n            End If\n         End If\n      Next w\n   Next v\n</code></pre>\n\n<p>I inserted a column at the far left of the <code>Dist_Sht</code> and used the formula <code>=VLOOKUP(M3,'[Planogram - 52 Weeks Movement by store (2).xlsm]Master'!$H$4:$I$51171,2,FALSE)</code> and it returns the expected value.</p>\n\n<p>I ran the code up until the comment.  This is the snippet of the search value from <code>Source_Bk.Dist_Sht</code><a href=\"https://i.stack.imgur.com/bHrbf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bHrbf.png\" alt=\"\"></a></p>\n\n<p>This is the snippet of the search range (<code>VL_Srch_Rng</code>) on <code>Mvmt_Bk.Mvmt_Sht</code>.  Obviously these examples don't have matching values, but I assure you there are many in the actual data.\n<a href=\"https://i.stack.imgur.com/DdVvI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DdVvI.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 7, "last_activity_date": 1575469722, "creation_date": 1575469722, "answer_id": 59178317, "question_id": 59178203, "link": "https://stackoverflow.com/questions/59178203/usedrange-loop-bigger-than-anticipated/59178317#59178317", "title": "UsedRange loop bigger than anticipated", "body": "<p><code>UsedRange</code> has issues, as noted <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">here</a>.</p>\n\n<p>Since you have a table, or <code>ListObject</code>, just iterate through the cells in the <code>ListColumn</code>.</p>\n\n<pre><code>Dim myTbl as ListObject\nSet myTbl = Sheet18.ListObjects(\"Table24\")\n\nDim rng as Range\nFor Each rng in myTbl.ListColumns(2).DataBodyRange\n    ...\nNext rng\n</code></pre>\n"}], "owner": {"reputation": 2853, "user_id": 503246, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e7f1f7f952c8ab01a47c186cbae92fbb?s=128&d=identicon&r=PG", "display_name": "TekiusFanatikus", "link": "https://stackoverflow.com/users/503246/tekiusfanatikus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59178317, "answer_count": 1, "score": 1, "last_activity_date": 1575469722, "creation_date": 1575469394, "last_edit_date": 1575469546, "question_id": 59178203, "link": "https://stackoverflow.com/questions/59178203/usedrange-loop-bigger-than-anticipated", "title": "UsedRange loop bigger than anticipated", "body": "<p>I have a table with 22 rows where I want to go through column B only. My loop goes beyond the 22 rows and reaches 259 for some reason.</p>\n\n<p>Code</p>\n\n<pre><code>Debug.Print \"Starting...\"\nDim tempRange As Range\nSet tempRange = Sheet18.UsedRange.Columns(\"B\")\n\nDim i As Integer\ni = 0\nFor Each Cell In tempRange.Cells\n    i = i + 1\nNext Cell\nDebug.Print \"Count: \" &amp; i\n</code></pre>\n\n<p>Intermediate Window</p>\n\n<pre><code>Starting...\nCount: 259\n</code></pre>\n\n<p>Screenshot showing Sheet18 with 22 rows</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZTwKr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZTwKr.png\" alt=\"Table with 22 rows\"></a></p>\n\n<p>Screenshot showing table reference with 22 rows</p>\n\n<p><a href=\"https://i.stack.imgur.com/5pnZ3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5pnZ3.png\" alt=\"Table reference showing 22 rows\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1575470577, "post_id": 59177803, "comment_id": 104578340, "body": "Do you expect 137785973201908000000001 being a valid input? Because it will be truncated if the input are formated as number in Excel. You might want to store the data as text from the start. See <a href=\"https://support.microsoft.com/en-gb/help/269370/last-digits-are-changed-to-zeroes-when-you-type-long-numbers-in-cells\" rel=\"nofollow noreferrer\">support.microsoft.com/en-gb/help/269370/&hellip;</a>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1575475793, "post_id": 59177803, "comment_id": 104581432, "body": "+1 for storing your number as Text - Excel can only support 15 digits of precision, so if your number is larger than that you will lose information."}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1575470672, "post_id": 59177913, "comment_id": 104578395, "body": "Format is another way to do this. Nice :)"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1575468467, "creation_date": 1575468467, "answer_id": 59177913, "question_id": 59177803, "link": "https://stackoverflow.com/questions/59177803/check-if-string-contains-certain-number-without-cstr-conversion-excel-vba/59177913#59177913", "title": "Check if String contains certain Number without CStr conversion - Excel VBA", "body": "<p>Try using <code>Format$</code>.</p>\n\n<pre><code>If InStr(stringVar, Format$(numberVar, \"0\")) &gt; 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1575470024, "creation_date": 1575470024, "answer_id": 59178405, "question_id": 59177803, "link": "https://stackoverflow.com/questions/59177803/check-if-string-contains-certain-number-without-cstr-conversion-excel-vba/59178405#59178405", "title": "Check if String contains certain Number without CStr conversion - Excel VBA", "body": "<p>Use <code>CDec</code>. Is this what you want?</p>\n\n<pre><code>Debug.Print CDec(numbervar)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LuRZG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LuRZG.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1145909"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 59177913, "answer_count": 2, "score": 0, "last_activity_date": 1575541853, "creation_date": 1575468155, "last_edit_date": 1575541853, "question_id": 59177803, "link": "https://stackoverflow.com/questions/59177803/check-if-string-contains-certain-number-without-cstr-conversion-excel-vba", "title": "Check if String contains certain Number without CStr conversion - Excel VBA", "body": "<p>Is it possible to check if a number exists in a string using VBA? Say I have a number - <code>137785973201908000000000</code> - and it is in a cell formatted as Number, how do I convert it to a string to use the <code>InStr</code> function?</p>\n\n<p>At the moment, if I use <code>CStr(number)</code> it will convert it to - <code>1.37785973201908E+23</code> - which is not ideal. The string I am trying to find the number in looks like this - [137785973201908000000000] Product Shipped.</p>\n\n<p>When using <code>If InStr(stringVar, CStr(numberVar)) &gt; 0 Then</code> it will not find the number because it is converting it to the scientific notation when converting to text.</p>\n\n<p>Is there VBA coding that can stop this?</p>\n"}, {"tags": ["vba", "selenium", "google-chrome", "selenium-chromedriver", "browser-automation"], "comments": [{"owner": {"reputation": 1286, "user_id": 7919626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c59n5.png?s=128&g=1", "display_name": "Word Rearranger", "link": "https://stackoverflow.com/users/7919626/word-rearranger"}, "edited": false, "score": 0, "creation_date": 1575468207, "post_id": 59177738, "comment_id": 104576806, "body": "What is the error you are getting?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1575470917, "post_id": 59177738, "comment_id": 104578535, "body": "unable to create session error?"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 12170260, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAip93ENc6cWfb0ycR4-l11SLqS4rGW-4ljcO7u=k-s128", "display_name": "KNAPPYFLASH", "link": "https://stackoverflow.com/users/12170260/knappyflash"}, "is_accepted": false, "score": 0, "last_activity_date": 1600658137, "creation_date": 1600658137, "answer_id": 63985726, "question_id": 59177738, "link": "https://stackoverflow.com/questions/59177738/can%c2%b4t-use-selenium-on-vba/63985726#63985726", "title": "Can&#180;t use selenium on vba", "body": "<p>Check your version of Chrome, then download the ChromeDriver for your version.\nThis code should open Google.</p>\n<p>The browser will close as soon as the Sub ends, so either declare the ChromeDriver on a global variable, or don't let the Sub end.</p>\n<pre><code>Option Explicit\nDim MyChromeDriver As ChromeDriver\n\nsub MyCD\n    Set MyChromeDriver = New ChromeDriver\n    MyChromeDriver.Get &quot;https://www.google.com/&quot;\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12480183, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206674625221552/picture?type=large", "display_name": "Vinicius Oliveira", "link": "https://stackoverflow.com/users/12480183/vinicius-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1600658137, "creation_date": 1575467974, "last_edit_date": 1575471169, "question_id": 59177738, "link": "https://stackoverflow.com/questions/59177738/can%c2%b4t-use-selenium-on-vba", "title": "Can&#180;t use selenium on vba", "body": "<p>I'm used to running a script on vba using selenium in windows 7 with no problem, and since I installed Windows 10 a just can not open the Google Chrome automated window.</p>\n\n<p>Already installed google chromedriver and the selenium library</p>\n\n<p>Put the C:\\....\\AppData\\Local\\SeleniumBasic on the environmental path </p>\n\n<p>The Google Chrome is version 78.0.3904.108 and the chromedriver 78.0.3904.105, and people don't seem to have problems with that...</p>\n\n<p>This is the start of the code, where crashes...</p>\n\n<pre><code>   Dim bot As New Selenium.ChromeDriver, posts As WebElements, post As WebElement, i As Integer, \n   mysheet As Worksheet, keys As Selenium.keys\n   bot.Start \"chrome\", \"https://valor.globo.com/impresso\" **'it gots the error right here**\n   bot.Get \"/\"\n</code></pre>\n\n<p>Anyone having this problem, knows what to do?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 168, "user_id": 12370585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0dd6ea022f7f1102d0b8f1ee72d2e19?s=128&d=identicon&r=PG&f=1", "display_name": "Its_Ady", "link": "https://stackoverflow.com/users/12370585/its-ady"}, "edited": false, "score": 3, "creation_date": 1575468168, "post_id": 59177620, "comment_id": 104576779, "body": "please  post sample data and what have you tried so far."}, {"owner": {"reputation": 9, "user_id": 12213096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22457f5320ed207f3c113f4c863a2857?s=128&d=identicon&r=PG&f=1", "display_name": "pal", "link": "https://stackoverflow.com/users/12213096/pal"}, "reply_to_user": {"reputation": 168, "user_id": 12370585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0dd6ea022f7f1102d0b8f1ee72d2e19?s=128&d=identicon&r=PG&f=1", "display_name": "Its_Ady", "link": "https://stackoverflow.com/users/12370585/its-ady"}, "edited": false, "score": 0, "creation_date": 1575476028, "post_id": 59177620, "comment_id": 104581575, "body": "I have tried with putting &gt;=50 in criteria of the query field but it does&#39;t work."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1575487619, "post_id": 59177620, "comment_id": 104587320, "body": "As already requested, edit question to provide sample data and query SQL. What you show looks like an expression from textbox."}, {"owner": {"reputation": 9, "user_id": 12213096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22457f5320ed207f3c113f4c863a2857?s=128&d=identicon&r=PG&f=1", "display_name": "pal", "link": "https://stackoverflow.com/users/12213096/pal"}, "edited": false, "score": 0, "creation_date": 1575510697, "post_id": 59177620, "comment_id": 104594247, "body": "June 7 I have added the query SQL."}, {"owner": {"reputation": 9, "user_id": 12213096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22457f5320ed207f3c113f4c863a2857?s=128&d=identicon&r=PG&f=1", "display_name": "pal", "link": "https://stackoverflow.com/users/12213096/pal"}, "edited": false, "score": 0, "creation_date": 1575515885, "post_id": 59177620, "comment_id": 104595275, "body": "Yes so how can I make the query show result only upto 50% match. If I remove the &gt;=50 value in the criteria it show me all the percentage results"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 12213096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22457f5320ed207f3c113f4c863a2857?s=128&d=identicon&r=PG&f=1", "display_name": "pal", "link": "https://stackoverflow.com/users/12213096/pal"}, "edited": false, "score": 0, "creation_date": 1575563087, "post_id": 59193719, "comment_id": 104616643, "body": "It is not showing the parameter input box but it is not showing any result."}], "tags": [], "owner": {"reputation": 258, "user_id": 7369240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pHaas.gif?s=128&g=1", "display_name": "AdzzzUK", "link": "https://stackoverflow.com/users/7369240/adzzzuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1575543741, "creation_date": 1575543741, "answer_id": 59193719, "question_id": 59177620, "link": "https://stackoverflow.com/questions/59177620/how-to-show-result-based-on-percentage-value-in-query/59193719#59193719", "title": "how to show result based on percentage value in query", "body": "<p>You can't refer to \"Total\" as it's being calculated on the fly.  Use the calculation in your query, rather than the name of the value:</p>\n\n<pre><code>SELECT \n    Val([SumTest1])+Val([SumTest2]) AS Total, \n    QryDSTResultsGroupbyID2.PatientID, \n    QryDSTResultsGroupbyID2.Test1, \n    QryDSTResultsGroupbyID2.Test2,\n    [Total]/[Forms]![FrmDSTResultsCompare]![mainTotal] AS Expr1\nFROM QryDSTResultsGroupbyID2\nWHERE (((Val([SumTest1])+Val([SumTest2]) )/[Forms]![FrmDSTResultsCompare]![mainTotal])&gt;=50)\nORDER BY Val([SumTest1])+Val([SumTest2]) DESC;\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12213096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22457f5320ed207f3c113f4c863a2857?s=128&d=identicon&r=PG&f=1", "display_name": "pal", "link": "https://stackoverflow.com/users/12213096/pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594233829, "creation_date": 1575467580, "last_edit_date": 1594233829, "question_id": 59177620, "link": "https://stackoverflow.com/questions/59177620/how-to-show-result-based-on-percentage-value-in-query", "title": "how to show result based on percentage value in query", "body": "<p>I have a query where I calculate the percentage value based on  values in controls on a form and subform</p>\n\n<pre><code>=[Total]/[Forms]![FrmDSTResultsCompare]![mainTotal]\n</code></pre>\n\n<p>If I put >= 50 in the query criteria it returns a Parameter value input</p>\n\n<p>What I want to do in the query is show the result up to 50%. Please help. </p>\n\n<pre><code>SELECT Val([SumTest1])+Val([SumTest2]) AS Total, QryDSTResultsGroupbyID2.PatientID, QryDSTResultsGroupbyID2.Test1, QryDSTResultsGroupbyID2.Test2, [Total]/[Forms]![FrmDSTResultsCompare]![mainTotal] AS Expr1\nFROM QryDSTResultsGroupbyID2\nWHERE ((([Total]/[Forms]![FrmDSTResultsCompare]![mainTotal])&gt;=50))\nORDER BY Val([SumTest1])+Val([SumTest2]) DESC;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1575466390, "post_id": 59177184, "comment_id": 104575718, "body": "Does evaluating the formula with <i>Formulas</i> &gt; <i>Evaluate Formula</i> give  you any more detail?"}, {"owner": {"reputation": 1, "user_id": 12404290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0d25f7cea3a31b67e6b31af9127149?s=128&d=identicon&r=PG&f=1", "display_name": "LJW", "link": "https://stackoverflow.com/users/12404290/ljw"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575538282, "post_id": 59177184, "comment_id": 104602802, "body": "Thank you @BigBen, but running the evaluation didn&#39;t throw up any issues."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575542414, "post_id": 59177184, "comment_id": 104605065, "body": "How does Excel know where <code>&#39;Stock Movement Archive Defra.xlsx&#39;</code> is saved? You need the full path if the workbook isn&#39;t open."}, {"owner": {"reputation": 1, "user_id": 12404290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0d25f7cea3a31b67e6b31af9127149?s=128&d=identicon&r=PG&f=1", "display_name": "LJW", "link": "https://stackoverflow.com/users/12404290/ljw"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575560244, "post_id": 59177184, "comment_id": 104614976, "body": "The macro opens the required source sheet so that the data can be retrieved, once done it then closes the source sheet."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575560275, "post_id": 59177184, "comment_id": 104614995, "body": "Can you then explain what &quot;but if I ask a macro to put it into the required cells as the main sheet opens then the formula fails&quot;? What does &quot;as the main sheet opens&quot; mean? Maybe we need more code."}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "edited": false, "score": 0, "creation_date": 1575562688, "post_id": 59177184, "comment_id": 104616400, "body": "So the macro opens the file and closes it, right? What happens if you add a <code>Application.Calculate</code> after you insert the formula? @LJW"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12404290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0d25f7cea3a31b67e6b31af9127149?s=128&d=identicon&r=PG&f=1", "display_name": "LJW", "link": "https://stackoverflow.com/users/12404290/ljw"}, "edited": false, "score": 0, "creation_date": 1575538738, "post_id": 59177293, "comment_id": 104603093, "body": "Hi @Michael Wycisk, adding the <code>.formula</code> property to the code didn&#39;t have any effect, i&#39;m afraid. The formula still stops at the first &quot;If&quot; statement."}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "reply_to_user": {"reputation": 1, "user_id": 12404290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0d25f7cea3a31b67e6b31af9127149?s=128&d=identicon&r=PG&f=1", "display_name": "LJW", "link": "https://stackoverflow.com/users/12404290/ljw"}, "edited": false, "score": 0, "creation_date": 1575547578, "post_id": 59177293, "comment_id": 104607831, "body": "I just see that you reference an external sheet <code>Stock Movement Archive Defra.xlsx</code>. Is that open when you test the formula? You can check if a full reference with file path makes a difference. Besides that, any chance to have a look at the file?"}, {"owner": {"reputation": 1, "user_id": 12404290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0d25f7cea3a31b67e6b31af9127149?s=128&d=identicon&r=PG&f=1", "display_name": "LJW", "link": "https://stackoverflow.com/users/12404290/ljw"}, "edited": false, "score": 0, "creation_date": 1575561131, "post_id": 59177293, "comment_id": 104615448, "body": "Yes, the source sheet is open while testing the formula. And the macro also opens up the required source sheet while it&#39;s running to mine the data, then closes it afterwards. Unfortunately, I can&#39;t share the actual file due to company policy, just snippets of code."}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "reply_to_user": {"reputation": 1, "user_id": 12404290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0d25f7cea3a31b67e6b31af9127149?s=128&d=identicon&r=PG&f=1", "display_name": "LJW", "link": "https://stackoverflow.com/users/12404290/ljw"}, "edited": false, "score": 0, "creation_date": 1575562592, "post_id": 59177293, "comment_id": 104616337, "body": "Really strange. One more thing I remember is that updating connections to SharePoint/OneDrive can be tricky. But that is probably not the case here?"}], "tags": [], "owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "is_accepted": false, "score": 0, "last_activity_date": 1575470369, "last_edit_date": 1575470369, "creation_date": 1575466525, "answer_id": 59177293, "question_id": 59177184, "link": "https://stackoverflow.com/questions/59177184/how-to-insert-a-formula-by-macro/59177293#59177293", "title": "How to insert a formula by macro?", "body": "<p>The formula looks fine for me. The only problem might be that you need to use the <code>.Formula</code> property after the Range object:</p>\n\n<pre><code>WSR.Range(\"ReportTable[Latest Portare Instance:]\").Formula = \"=IFERROR(IF([Date out:]=\"\"\"\",\"\"Nothing Sent\"\",IF(AND([Received by Serial:]=\"\"\"\",[Received by Asset:]=\"\"\"\"),\"\"Not Received\"\",IF([Received by Asset:]&lt;&gt;\"\"\"\",LOOKUP(2,1/('Stock Movement Archive Defra.xlsx'!Archive[Asset No:]=$J2),'Stock Movement Archive Defra.xlsx'!Archive[Location:]),LOOKUP(2,1/('Stock Movement Archive Defra.xlsx'!Archive[S/No:]=$I2),'Stock Movement Archive Defra.xlsx'!Archive[Location:])))),\"\"Issue\"\")\"\n</code></pre>\n\n<p>To make sure that your formula is correct (you say it works fine when typed into the cell), you might type it into the cell, select the cell and then type <code>?ActiveCell.Formula</code> into the Immediate Window inside the VBE (don't forget to check that the quotation marks are correct).</p>\n"}], "owner": {"reputation": 1, "user_id": 12404290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0d25f7cea3a31b67e6b31af9127149?s=128&d=identicon&r=PG&f=1", "display_name": "LJW", "link": "https://stackoverflow.com/users/12404290/ljw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580459741, "creation_date": 1575466145, "last_edit_date": 1580459741, "question_id": 59177184, "link": "https://stackoverflow.com/questions/59177184/how-to-insert-a-formula-by-macro", "title": "How to insert a formula by macro?", "body": "<p>The issue has been solved.</p>\n\n<p>It would appear that when I made some changes to capture data a little while ago, I inadvertently broke the order of things. When the above bit of code was running, the <code>[Date Out:]</code> column was indeed empty, so Excel was reporting properly. </p>\n\n<p>I've since reordered the input of formulas and now the sheet works correctly, with credit to @BigBen and @Michael Wycisk.</p>\n\n<hr>\n\n<p>I created an Excel sheet to draw together the data from several other Excel sheets into one to keep track of a project.</p>\n\n<p>I have a formula that works if it is written into a range of cells with the source data sheet open in the background. If I ask a macro to put it into the required cells as the main sheet opens then the formula fails. By 'fail', I mean the formula checks it's first column to see if data is present or not and then decides that the column is empty regardless, therefore falsely reporting 'nothing sent' if there is a date in the \"Date Out\" column.</p>\n\n<p>Here is the line in question.</p>\n\n<pre><code>WSR.Range(\"ReportTable[Latest Portare Instance:]\") = \"=IFERROR(IF([Date out:]=\"\"\"\",\"\"Nothing Sent\"\",IF(AND([Received by Serial:]=\"\"\"\",[Received by Asset:]=\"\"\"\"),\"\"Not Received\"\",IF([Received by Asset:]&lt;&gt;\"\"\"\",LOOKUP(2,1/('Stock Movement Archive Defra.xlsx'!Archive[Asset No:]=$J2),'Stock Movement Archive Defra.xlsx'!Archive[Location:]),LOOKUP(2,1/('Stock Movement Archive Defra.xlsx'!Archive[S/No:]=$I2),'Stock Movement Archive Defra.xlsx'!Archive[Location:])))),\"\"Issue\"\")\"\n</code></pre>\n\n<p>It's one of several formulas, all inserted the same way and the rest work. As far as I can tell the formula is being inserted correctly, just that this one stops at the first if statement.</p>\n\n<p>For reference, I have tried changing the first 'if' statement to start <code>IF([Date out:]&lt;&gt;\"\"\"\"</code>, the formula then either states \"Nothing Received\" where there is no date or pulls the correct data if there is a date. Also tried changing the format of the \"Date Out\" column.</p>\n"}, {"tags": ["vba", "loops", "email", "ms-access", "recordset"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1575486964, "post_id": 59176831, "comment_id": 104587080, "body": "You should have Option Explicit in module header and declare all variables at beginning of procedure."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1575491317, "post_id": 59176831, "comment_id": 104588851, "body": "Instead of writing records to SendFileTemp, why not just open recordset filtered by recipient from form record?"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1575491653, "last_edit_date": 1575491653, "creation_date": 1575486566, "answer_id": 59183130, "question_id": 59176831, "link": "https://stackoverflow.com/questions/59176831/looping-two-recordsets-in-vba-for-access/59183130#59183130", "title": "Looping two recordsets in VBA for Access", "body": "<p>Using Recordset requires first record of form to have focus. Suggest you use RecordsetClone. </p>\n\n<p>Set MailBody to empty string at end of each iteration.</p>\n\n<p>Consider:</p>\n\n<pre><code>strSMTPRelay = \"mail.vaioni.com\"'\n\nWith Me.RecordsetClone\nDo While Not .EOF\n\n    Set rst = MyDB.OpenRecordset(\"SendFileTemp\", dbOpenForwardOnly)\n    With rst\n    Do While Not .EOF\n        MailBody = MailBody &amp; ![serviceid] &amp; \" | \" &amp; ![status] &amp; \" | \" &amp; ![EventDate] &amp; \" | \" &amp; ![name] &amp; vbCrLf\n        .MoveNext\n    Loop\n    End With\n    rst.Close\n\n    Set oMessage = CreateObject(\"CDO.Message\")\n    oMessage.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n    oMessage.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = strSMTPRelay\n    oMessage.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\n    oMessage.Configuration.Fields.Update\n\n    oMessage.From = !From\n    oMessage.To = !EMAIL\n    oMessage.bcc = !BCC\n    oMessage.Subject = \"Jobs requiring your attention\"\n    oMessage.TextBody = \"Can you please take a look at these jobs that remain open and close them down. Thanks  \" _\n                        &amp; vbCrLf &amp; \" \" &amp; vbCrLf &amp; MailBody &amp; vbCrLf &amp; \" \"\n    oMessage.Send\n    MailBody = \"\"\n    .MoveNext\nLoop\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5613163, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156247375300076/picture?type=large", "display_name": "Simon Metson", "link": "https://stackoverflow.com/users/5613163/simon-metson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575491653, "creation_date": 1575465022, "last_edit_date": 1575465126, "question_id": 59176831, "link": "https://stackoverflow.com/questions/59176831/looping-two-recordsets-in-vba-for-access", "title": "Looping two recordsets in VBA for Access", "body": "<p>I am trying to send email records from a query called \"Deprog3\" to multiple different recipients. The button on the form needs to loop through each record in the form and send an email to the recipient ('Me.EMAIL'). The email it sends should select all of the records from the \"Deprog3\" query that relate to that particular individual. </p>\n\n<p>What actually happens though is that it sends just the records specific to the first individual on the first email, then it sends the records from the first AND second individuals on the second email and so on until the last email contains every record from the query.</p>\n\n<p>If I comment out the second line ('Do While Me.Current Record...') and the second from last line ('Loop'), it takes out the looping and means I have to keep clicking 'Send', but it doesn't send the records from the previous individuals.</p>\n\n<p>Any guidance would be greatly appreciated!</p>\n\n<pre><code>Private Sub Send_Click()\n\nDo While Me.CurrentRecord &lt; Me.Recordset.RecordCount\n\nDoCmd.RunSQL \"delete * from sendfiletemp\"\nDoCmd.OpenQuery \"Deprog3\"\n\nDim MyDB As DAO.Database\nDim rst As DAO.Recordset\n\nSet MyDB = CurrentDb\nSet rst = MyDB.OpenRecordset(\"SendFileTemp\", dbOpenForwardOnly)\n\nstrSMTPFrom = Me.From\nstrSMTPTo = Me.EMAIL\nstrBCC = Me.BCC\nstrSMTPRelay = \"mail.vaioni.com\"\nstrSubject = \"Jobs requiring your attention\"\n\nWith rst\n  Do While Not .EOF\n    MailBody = MailBody &amp; ![serviceid] &amp; \" | \" &amp; ![status] &amp; \" | \" &amp; ![EventDate] &amp; \" | \" &amp; ![name] &amp; vbCrLf\n      .MoveNext\n  Loop\nEnd With\n\nSet oMessage = CreateObject(\"CDO.Message\")\noMessage.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\noMessage.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = strSMTPRelay\noMessage.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\noMessage.Configuration.Fields.Update\n\noMessage.From = strSMTPFrom\noMessage.To = strSMTPTo\noMessage.bcc = strBCC\noMessage.Subject = strSubject\noMessage.TextBody = \"Can you please take a look at these jobs that remain open and close them down. Thanks  \" &amp; vbCrLf &amp; \" \" &amp; vbCrLf &amp; MailBody &amp; vbCrLf &amp; \" \"\n\noMessage.Send\n\nrst.Close\nSet rst = Nothing\n\nMe.Recordset.MoveNext\n\nLoop\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["vba", "text", "copy", "line", "skip"], "answers": [{"tags": [], "owner": {"reputation": 32963, "user_id": 2330053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UKKyC.jpg?s=128&g=1", "display_name": "Idle_Mind", "link": "https://stackoverflow.com/users/2330053/idle-mind"}, "is_accepted": true, "score": 1, "last_activity_date": 1575471040, "last_edit_date": 1575471040, "creation_date": 1575466089, "answer_id": 59177161, "question_id": 59176789, "link": "https://stackoverflow.com/questions/59176789/how-can-i-skip-one-line-in-a-txt-file/59177161#59177161", "title": "How can I skip one line in a txt file", "body": "<p>If I understand correctly, you always want to write to file #2; either the line from file #1, or the line from Cells(f, 17) if we are at the target line number.</p>\n\n<p>Why not just this then?</p>\n\n<pre><code>inFile = \"L:\\\" &amp; Cells(f, 2) &amp; \"\\COMPANY.bat\"\nOpen inFile For Input As #1\n\noutFile = \"L:\\\" &amp; Cells(f, 2) &amp; \"\\COMPANY_NEW.bat\"\nOpen outFile For Output As #2\n\nIf Not IsEmpty(Cells(f, 11)) Then\n    LineNumber = LineNumber + 1\n\n    Do Until EOF(1)\n        Debug.Print LineNumber\n        Line Input #1, data1\n        data2 = Trim(data1)\n\n        If LineNumber = Cells(f, 13) Then\n            data2 = Cells(f, 17)\n        End If\n\n        Print #2, data2\n        LineNumber = LineNumber + 1\n    Loop\nEnd If\n\nLineNumber = 0\n\nClose #1\nClose #2\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10875002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a3bad97e201b08028d48899f8082ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Avidan", "link": "https://stackoverflow.com/users/10875002/dan-avidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 59177161, "answer_count": 1, "score": 0, "last_activity_date": 1575471040, "creation_date": 1575464881, "last_edit_date": 1575469111, "question_id": 59176789, "link": "https://stackoverflow.com/questions/59176789/how-can-i-skip-one-line-in-a-txt-file", "title": "How can I skip one line in a txt file", "body": "<p><a href=\"https://i.stack.imgur.com/GGZQJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GGZQJ.png\" alt=\"line 2 is the new string. line 3 is the one I want to skip\\delete. line 3 is the old string\"></a></p>\n\n<p>I have a <code>txt</code> file called <code>inFile</code>. With VBA, I copy it line by line to a new <code>tx</code>t file called <code>outFile</code>.</p>\n\n<p>I have an Excel worksheet. In this sheet, I have a string and a number. The number is the line where the new string needs to go in the <code>txt</code> called <code>outFile</code>.</p>\n\n<p>95% of my code works.</p>\n\n<p><strong>My problem:</strong> After the code copy the lines from the <code>txt</code> called <code>inFile</code> to <code>outFile</code>, and after I copy the new string from the Excel sheet to the right line.\nWhen I go back to copy the other line from the <code>txt</code> called <code>inFile</code> to the <code>txt</code> called <code>outFile</code>.\nThe code copied the line that I just replaced with the new string.</p>\n\n<p>I'm looking for a way to skip one line while copying the line from <code>inFile</code> to <code>outFile</code>.</p>\n\n<p><strong>P.S.</strong>\n<code>cell(f,13)</code> is where the line number for the new string is placed.\n<code>cell(f,17)</code> is where the new string should be placed.</p>\n\n<p></p>\n\n<pre><code>Sub Update_file()\n\n    Dim FolderName As Double\n    Dim data1, data2, IfExist, inFile, outFile As String\n    Dim f As Integer\n    Dim LineNumber As Long\n\n    f = 2\n    LineNumber = 0\n\n    Do Until IsEmpty(Cells(f, 2))\n        IfExist = \"L:\\\" &amp; Cells(f, 2) &amp; \"\\COMPANY.bat\"\n            If Not Dir(IfExist) = \"\" Then                  \n                inFile = \"L:\\\" &amp; Cells(f, 2) &amp; \"\\COMPANY.bat\"\n                Open inFile For Input As #1                \n                outFile = \"L:\\\" &amp; Cells(f, 2) &amp; \"\\COMPANY_NEW.bat\"\n                Open outFile For Output As #2               \n                    If Not IsEmpty(Cells(f, 11)) Then                \n                        LineNumber = LineNumber + 1\n                            If LineNumber = Cells(f, 13) Then\n    'aaa:\n                                data2 = Cells(f, 17)\n                                Print #2, data2\n                                LineNumber = LineNumber + 1\n                                GoTo bbb\n                            Else\n                                Do Until EOF(1) Or Cells(f, 13) = LineNumber \n    'bbb:\n                                Debug.Print LineNumber\n                                Line Input #1, data1\n                                data2 = Trim(data1)\n                                Print #2, data2\n                                LineNumber = LineNumber + 1                            \n                                    If LineNumber = Cells(f, 13) Then\n                                        GoTo aaa\n                                    End If                        \n                                Loop                        \n                            End If                \n                        End If                \n                LineNumber = 0\n                Close #1\n                Close #2                \n            Else: MsgBox \"\u00e4\u00e7\u00e1\u00f8\u00e4 \" &amp; Mid(inFile, 4, 5) &amp; \" \u00ec\u00e0 \u00f7\u00e9\u00e9\u00ee\u00fa\"            \n            End If    \n        f = f + 1    \n    Loop    \n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1914490"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575466670, "post_id": 59176772, "comment_id": 104575877, "body": "I also changed my description of the issue to be more accurate regarding displaying the fields from the qryDeliverable, not from the projects table. Sorry and thanks!"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1575484677, "post_id": 59176772, "comment_id": 104586196, "body": "A form should do data entry/edit for only one table. You should probably use form/subform arrangement, not include all tables in one form RecordSource."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1575485192, "post_id": 59176772, "comment_id": 104586407, "body": "What are you really trying to accomplish? Do you just need to apply filter to existing records or do you need to populate tblProjects with new data from a deliverables import?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1914490"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1575810596, "post_id": 59176772, "comment_id": 104683187, "body": "I&#39;m not trying to edit/add data to more than one table, I just want to display data from more than one table. The form has a source of the Deliverables table which stores the Project Name. The Project name is a cmbx lookup into the Projects table, so on the form, I want to display other fields from the Pelroject record. The project record contains an STO_ID field which is a link to the STO table. On the same form, I also want to display fields from the STO table.  So, on the Deliverables form, I want to select a Project which is linked to an STO and display fields from  both tables."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1575811088, "post_id": 59176772, "comment_id": 104683296, "body": "Really shouldn&#39;t need code to display data from tables. If you have tables in form RecordSource then bind textboxes to those fields. However, only allow edits to fields from table the form is intended for, not the related &#39;lookup&#39; tables. Dependent tables should be in a subform."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1914490"}, "edited": false, "score": 0, "creation_date": 1578989141, "post_id": 59673504, "comment_id": 105608677, "body": "Thanks! I will attempt this once I return to work in a month. Much appreciated!"}], "tags": [], "owner": {"reputation": 85, "user_id": 11608679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2bad05920c66a1b23703fc341297f2?s=128&d=identicon&r=PG&f=1", "display_name": "Sola Oshinowo", "link": "https://stackoverflow.com/users/11608679/sola-oshinowo"}, "is_accepted": false, "score": 0, "last_activity_date": 1578612019, "creation_date": 1578612019, "answer_id": 59673504, "question_id": 59176772, "link": "https://stackoverflow.com/questions/59176772/auto-fill-form-fields-in-ms-access-using-vba/59673504#59673504", "title": "Auto fill form fields in MS Access using VBA", "body": "<p>I will suggest you do the following</p>\n\n<ol>\n<li>Create a combo box control on a form, in its control source, use the select query that will show all column names across the various tables that you want to retrieve records</li>\n</ol>\n\n<p>2.Under Column count property, this will be the number of columns been retrieved by the select statement</p>\n\n<ol start=\"3\">\n<li>Create text fields for all the columns been retrieved except the first column(this is because the first column would have been handled by the combo box)</li>\n<li>Under the after update event of the combo box, do something like text7.Value=combo13.Column(1)   where text7 is the textbox name, and column (1) is the second column in the select statement of the combo box.\ntext8.Value=combo13.Column(2) where text8 is the textbox name, and column (2) is the third column in the select statement of the combo box.</li>\n</ol>\n\n<p>etc.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1914490"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578612019, "creation_date": 1575464826, "last_edit_date": 1575484622, "question_id": 59176772, "link": "https://stackoverflow.com/questions/59176772/auto-fill-form-fields-in-ms-access-using-vba", "title": "Auto fill form fields in MS Access using VBA", "body": "<p>Thanks in advance for any help.\nThis involves a little VBA code and three MS Access tables.<br>\n1) SR. Technology Officer (tblSTO),<br>\n2) tblProjects,<br>\n3) tblDeliverables.<br>\nAmong other fields, the STO table has an autonumber STO_ID (primary index) and the STO_Name (text).<br>\nThe tblProject table has ProjectNo (text) and STO_ID. These two combined are unique and make the primary key.<br>\nThe tblDeliverables table has ProjectNo, STO_ID, ServiceName (text). These three combined are unique and make the primary key.  </p>\n\n<p>I have a qryDeliverable query which includes all three tables and all the fields from each table. I have a form frmDeliverable which uses the qryDeliverables as the record source and has a combo box field to select the ProjectNo from the Project table. The ProjectNo, STOName (from STO table) are displayed in the combobox drop down.  </p>\n\n<p>Once ProjectNo is selected, I want the ProjectNo, STOName, and a couple other fields from the qryDeliverables displayed, and a field (DesignerPlanner) I try to populate using some VBA in an \"After Update\" event. It's not working. Depending on how I play with the relationships and the VBA code, it either doesn't populate the fields, or the add record controls for the form disappear, or I get some relationship error.</p>\n\n<p>A little history....I had this working perfectly when using an autonumber ID field (primary index) in both the Project and Deliverable tables. However, a new requirement came in to be able to be able to pre-populate (one time) the Deliverables table via import from a spreadsheet of records. With the Project file already populated, the spreadsheet to be imported into the Deliverables table has unique project numbers (ProjectNo) and a common STO_ID across all the records (just as a starting point), but can't possibly have each project ID number, so the index requirement wasn't met. I had to delete the project ID field from the Deliverables table and use the ProjectNo and STO_ID combined as the primary index. This was the start of all my problems.</p>\n\n<p>Here is the VBA code:</p>\n\n<pre><code>Private Sub Project_No_AfterUpdate()\nDim rs As DAO.Recordset\n    Dim qdf As DAO.QueryDef\n    Dim strSQL As String\n    If Not IsNull(ProjectNo) Then\n        Set rs = CurrentDb.OpenRecordset(\"qryProjects\")\n        Me.STO_ID = rs!STO_ID\n        Me.DesignerPlanner = \"Chiu, Derek;\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>I hope this is clear and any help is appreciated. Thanks so much!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1, "user_id": 12479763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JVXeKGFqr5U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTBaXx3zh2NDSq_Z811R8njJM-ww/photo.jpg?sz=128", "display_name": "Patrick Sullivan", "link": "https://stackoverflow.com/users/12479763/patrick-sullivan"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1575466680, "post_id": 59176123, "comment_id": 104575883, "body": "Erik, thanks but none of that seems to have worked.  It&#39;s like the newly created database is not &quot;Trusted&quot;, so it doesn&#39;t allow me to export into it until I &quot;Trust&quot; it.  Is there any work around on this?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1575466731, "post_id": 59176123, "comment_id": 104575919, "body": "Oh, you can&#39;t export to untrusted sources using that. Either trust the database, trust the database location, or use a query to export."}, {"owner": {"reputation": 1, "user_id": 12479763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JVXeKGFqr5U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTBaXx3zh2NDSq_Z811R8njJM-ww/photo.jpg?sz=128", "display_name": "Patrick Sullivan", "link": "https://stackoverflow.com/users/12479763/patrick-sullivan"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1575466935, "post_id": 59176123, "comment_id": 104576053, "body": "How would I go about writing a query to export?  Wouldn&#39;t I still have to open the newly created database?"}, {"owner": {"reputation": 1, "user_id": 12479763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JVXeKGFqr5U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTBaXx3zh2NDSq_Z811R8njJM-ww/photo.jpg?sz=128", "display_name": "Patrick Sullivan", "link": "https://stackoverflow.com/users/12479763/patrick-sullivan"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1575467618, "post_id": 59176123, "comment_id": 104576458, "body": "Erik, I figured it out and THANK YOU, it worked!"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1575468149, "post_id": 59176123, "comment_id": 104576765, "body": "I hope it was similar to my answer which I posted at the same time"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1575467598, "creation_date": 1575467598, "answer_id": 59177622, "question_id": 59176123, "link": "https://stackoverflow.com/questions/59176123/docmd-transferdatabase-issues/59177622#59177622", "title": "DoCmd.TransferDatabase issues", "body": "<p>Untrusted locations can't be exported to using <code>DoCmd.TransferDatabase</code>.</p>\n\n<p>Afaik however, you can export to them just fine using queries, as these are processed on the database engine level, not the application level, and trust issues are at the application level.</p>\n\n<p>To write a query that exports a table:</p>\n\n<pre><code>SELECT * INTO [;DATABASE=C:\\Path\\To\\File.accdb].NewTableName FROM OldTableName\n</code></pre>\n\n<p>Note that this only exports data and not related information (indexes, which columns are visible, lookups, etc) and thus is functionally different.</p>\n"}], "owner": {"reputation": 1, "user_id": 12479763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JVXeKGFqr5U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTBaXx3zh2NDSq_Z811R8njJM-ww/photo.jpg?sz=128", "display_name": "Patrick Sullivan", "link": "https://stackoverflow.com/users/12479763/patrick-sullivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575467598, "creation_date": 1575462597, "last_edit_date": 1575465939, "question_id": 59176123, "link": "https://stackoverflow.com/questions/59176123/docmd-transferdatabase-issues", "title": "DoCmd.TransferDatabase issues", "body": "<p>In my code I'm creating a new database and then using DoCmd.TransferDatabase to copy some tables into it.  This used to work with no issues, now I'm getting the error: \"Run-time error '3709': The search key was not found in any record.  My code is: </p>\n\n<pre><code>Set db = DBEngine.CreateDatabase(sPath, dbLangGeneral)\nDoCmd.TransferDatabase acExport, \"Microsoft Access\", sPath, acTable, \n\"MATerials\", \"MAT\", False\n\nDoCmd.TransferDatabase acExport, \"Microsoft Access\", sPath, acTable, \n\"new_2Kilo\", \"TWOK\", False\n\nDoCmd.TransferDatabase acExport, \"Microsoft Access\", sPath, acTable, \n\"tblCSMP\", \"tblCSMP\", False\n\nDoCmd.TransferDatabase acExport, \"Microsoft Access\", sPath, acTable, \n\"tblICMP\", \"tblICMP\", False\n\nDoCmd.TransferDatabase acExport, \"Microsoft Access\", sPath, acTable, \n\"tblMARMC_USERS\", \"tblMARMC_USERS\", False\n\nDoCmd.TransferDatabase acExport, \"Microsoft Access\", sPath, acTable, \n\"tblVisit_Personnel\", \"tblVisit_Personnel\", False\n\nDoCmd.TransferDatabase acExport, \"Microsoft Access\", sPath, acTable, \n\"Training\", \"Training\", False\n\nDoCmd.TransferDatabase acExport, \"Microsoft Access\", sPath, acTable, \n\"tblTeamMember\", \"tblTeamMember\", False\n\nDoCmd.TransferDatabase acExport, \"Microsoft Access\", sPath, acTable, \n\"WORK_NOTIFICATIONS\", \"WORK_NOTIFICATIONS\", False\n</code></pre>\n\n<p>If I open the newly created database and click the \"Enable Content\" button the function will continue.  Any ideas how to work around this?</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1575461667, "post_id": 59175760, "comment_id": 104573075, "body": "....but what? =). Have a look at <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> a question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and edit your question accordingly. I got a feeling there is a question behind &quot;but...&quot; which you need to clarify. Include sample data, expected output, your current code and where you get stuck."}, {"owner": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "edited": false, "score": 0, "creation_date": 1575463561, "post_id": 59175760, "comment_id": 104574082, "body": "The screenshot doesn&#39;t provide any sort of information.  Make an example and attach that as a screenshot"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1575464078, "post_id": 59175760, "comment_id": 104574382, "body": "Not sure about what you want, but I would incline to suppose that you need to study the Transpose function which is able to transform rows in columns and viceversa."}], "answers": [{"tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 0, "last_activity_date": 1575465838, "creation_date": 1575465838, "answer_id": 59177090, "question_id": 59175760, "link": "https://stackoverflow.com/questions/59175760/excel-vba-rows-to-columns-and-keeping-first-columns/59177090#59177090", "title": "Excel vba - rows to columns and keeping first columns", "body": "<p>In order to move/copy the values of a row in a column you can use Transpose function like in my next code example:</p>\n\n<pre><code>   Dim rng1 As Range, rng2 As Range, arr1 As Variant, arr2 As Variant\n   Set rng1 = Range(\"A1:H10\"): Set rng2 = Range(\"J1:J8\")\n   arr1 = rng1.value\n   arr2 = Application.WorksheetFunction.Transpose(arr1)\n   rng2.value = arr2\n</code></pre>\n\n<p>The code can be optimized, of course, in order to automatically determine the columns number of the row to be transposed and build the column range based of it. I would like to receive a little feedback confirming (or not) that this is what you really need. At least, this is what I could suppose looking to your attached pictures...\nThe sample code will transpose the content of the (first) row (<code>Range(\"A1:H10\")</code>) to the column J:J (<code>Range(\"J1:J8\")</code>).</p>\n"}], "owner": {"reputation": 1, "user_id": 12479683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XxDbPdLW3yc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfHTIFG7BhrqWNSRp-qHVEnb7EWBw/photo.jpg?sz=128", "display_name": "Zaharni Zavodi", "link": "https://stackoverflow.com/users/12479683/zaharni-zavodi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1575465924, "creation_date": 1575461462, "last_edit_date": 1575465924, "question_id": 59175760, "link": "https://stackoverflow.com/questions/59175760/excel-vba-rows-to-columns-and-keeping-first-columns", "title": "Excel vba - rows to columns and keeping first columns", "body": "<p>I am doing a plan for an year, where I have the labels in the first 3 columns and then the values for the 12 months in the next columns. I want to put the values one under another for the 12 months and to repeat the labels for each month then to go on the next record. I believe there should be a loop for it, but I am not sure how to make it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/b3ZEV.png\" rel=\"nofollow noreferrer\">Screenshot</a></p>\n\n<p>My data looks like the one in table A on the screenshot\nI have to make it to look like table B on the screenshot</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575459676, "post_id": 59174829, "comment_id": 104571983, "body": "Any reason you can&#39;t just copy and paste this spin button? You&#39;d need to copy and paste the code for them to each sheet as well, but I don&#39;t see why that wouldn&#39;t work."}, {"owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575459871, "post_id": 59174829, "comment_id": 104572101, "body": "I already firued out how to copy button, although the code must be still inputted manually (at least copied) sheet by sheet."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575460223, "post_id": 59174829, "comment_id": 104572293, "body": "Yes, this is how it is I&#39;m afraid, by design the code for an ActiveX control is located on the sheet it&#39;s on. However <a href=\"https://stackoverflow.com/questions/41612140/automatically-add-option-private-module-to-all-modules-in-vba\">there is a way to add code dynamically</a> but I suppose that solution could take much longer than just manually copy-pasting your code to your sheets."}], "owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1575459578, "creation_date": 1575458370, "last_edit_date": 1575459578, "question_id": 59174829, "link": "https://stackoverflow.com/questions/59174829/vba-excel-copy-activex-spin-button-between-cells", "title": "VBA Excel copy ActiveX Spin button between cells", "body": "<p>I have got 23 cells in my worksheet, where I would like to put the button with next &amp; previous.</p>\n\n<p>I have already the macro code and the button  prepared.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vvHqE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vvHqE.png\" alt=\"enter image description here\"></a></p>\n\n<p>But it looks like it refers only to the 1st sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gH2ad.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gH2ad.png\" alt=\"enter image description here\"></a></p>\n\n<p>I cannot copy and paste this spin button as I did in case of form control buttons.</p>\n\n<p>I found some links here:</p>\n\n<p><a href=\"https://www.excel-easy.com/vba/examples/spin-button.html\" rel=\"nofollow noreferrer\">https://www.excel-easy.com/vba/examples/spin-button.html</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/18466670/launch-a-different-sheet-by-spin-button\">Launch a different sheet by Spin button</a></p>\n\n<p>But they don't help me</p>\n\n<p>Is there some way to speed up this?</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "html-parsing"], "comments": [{"owner": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "edited": false, "score": 0, "creation_date": 1575459029, "post_id": 59174379, "comment_id": 104571651, "body": "Could you include the error message in your question? And can you dump out the value of linkgame?"}, {"owner": {"reputation": 27, "user_id": 12355153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3a3c71e43bbf021af7d37c9df39982?s=128&d=identicon&r=PG&f=1", "display_name": "wsn", "link": "https://stackoverflow.com/users/12355153/wsn"}, "reply_to_user": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "edited": false, "score": 0, "creation_date": 1575459204, "post_id": 59174379, "comment_id": 104571735, "body": "how can i put the value of linkgame in my code?"}, {"owner": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "edited": false, "score": 0, "creation_date": 1575459273, "post_id": 59174379, "comment_id": 104571774, "body": "Use either: debug.print linkgame, or MsgBox linkgame."}, {"owner": {"reputation": 27, "user_id": 12355153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3a3c71e43bbf021af7d37c9df39982?s=128&d=identicon&r=PG&f=1", "display_name": "wsn", "link": "https://stackoverflow.com/users/12355153/wsn"}, "reply_to_user": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "edited": false, "score": 0, "creation_date": 1575459446, "post_id": 59174379, "comment_id": 104571869, "body": "<a href=\"https://prnt.sc/q61nvq\" rel=\"nofollow noreferrer\">prnt.sc/q61nvq</a>"}, {"owner": {"reputation": 27, "user_id": 12355153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3a3c71e43bbf021af7d37c9df39982?s=128&d=identicon&r=PG&f=1", "display_name": "wsn", "link": "https://stackoverflow.com/users/12355153/wsn"}, "reply_to_user": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "edited": false, "score": 0, "creation_date": 1575459495, "post_id": 59174379, "comment_id": 104571889, "body": "the error says : &quot;Error in time execution. The method &#39;Navigate2&#39; of object &#39;IWebBrower2&#39; failed&quot;"}, {"owner": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "edited": false, "score": 0, "creation_date": 1575460156, "post_id": 59174379, "comment_id": 104572255, "body": "Is the value of linkgame correct? It may be that Navigate2 can&#39;t use it. For example, is the URL an absolute path? Does it have HTTP or HTTPS protocol in the URL?"}, {"owner": {"reputation": 27, "user_id": 12355153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3a3c71e43bbf021af7d37c9df39982?s=128&d=identicon&r=PG&f=1", "display_name": "wsn", "link": "https://stackoverflow.com/users/12355153/wsn"}, "reply_to_user": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "edited": false, "score": 0, "creation_date": 1575460282, "post_id": 59174379, "comment_id": 104572323, "body": "i think my linkgame is correct . Maybe the problem is Navigate2 , don&#39;t know why. The URL have HTTP like you can see on the print"}, {"owner": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "edited": false, "score": 0, "creation_date": 1575461357, "post_id": 59174379, "comment_id": 104572892, "body": "You can try using Navigate instead and see what happens. Otherwise, try a different URL just for testing, something like .Navigate2 &quot;<a href=\"https://www.google.com\" rel=\"nofollow noreferrer\">google.com</a>&quot; and see if it works."}, {"owner": {"reputation": 27, "user_id": 12355153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3a3c71e43bbf021af7d37c9df39982?s=128&d=identicon&r=PG&f=1", "display_name": "wsn", "link": "https://stackoverflow.com/users/12355153/wsn"}, "reply_to_user": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "edited": false, "score": 0, "creation_date": 1575461491, "post_id": 59174379, "comment_id": 104572960, "body": "if i switch .Navigate2 &quot;google.com&quot; it works but now shows me error on &quot;oddHome = .document.getElementsByClassName(&quot;aver&quot;)(0).getElementsByCla&zwnj;&#8203;ssName(&quot;right&quot;)(0).i&zwnj;&#8203;nnerText&quot;"}, {"owner": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "edited": false, "score": 0, "creation_date": 1575461926, "post_id": 59174379, "comment_id": 104573221, "body": "I think you should fix your Navigate2 problem first. Does using Navigate instead of Navigate2 work with linkgame?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1575472416, "post_id": 59174379, "comment_id": 104579412, "body": "It would help to show what an example output couple of rows would look like. The re-write you show could have the selector methods optimized I think."}], "answers": [{"comments": [{"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1575473305, "post_id": 59178234, "comment_id": 104579862, "body": "@QHarr, Thanks for reminding me about that, after removing them it is more readable."}, {"owner": {"reputation": 27, "user_id": 12355153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3a3c71e43bbf021af7d37c9df39982?s=128&d=identicon&r=PG&f=1", "display_name": "wsn", "link": "https://stackoverflow.com/users/12355153/wsn"}, "edited": false, "score": 0, "creation_date": 1575501390, "post_id": 59178234, "comment_id": 104592052, "body": "sorry but now i saw one problem"}, {"owner": {"reputation": 27, "user_id": 12355153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3a3c71e43bbf021af7d37c9df39982?s=128&d=identicon&r=PG&f=1", "display_name": "wsn", "link": "https://stackoverflow.com/users/12355153/wsn"}, "edited": false, "score": 0, "creation_date": 1575501433, "post_id": 59178234, "comment_id": 104592068, "body": "when i&#39;m trying to parse oddBtts, oddNbtts, oddOver and oddUnder it shows me basically the 1X2 odds"}, {"owner": {"reputation": 27, "user_id": 12355153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3a3c71e43bbf021af7d37c9df39982?s=128&d=identicon&r=PG&f=1", "display_name": "wsn", "link": "https://stackoverflow.com/users/12355153/wsn"}, "edited": false, "score": 0, "creation_date": 1575501499, "post_id": 59178234, "comment_id": 104592087, "body": "So i think the problem now is that &quot;.document.getElementsByClassName(&quot;aver&quot;)(0).getElementsByCl&zwnj;&#8203;assName(&quot;right&quot;)(0).&zwnj;&#8203;innerText&quot; isn&#39;t looking on the direct link (linkbtts or linkover). Is looking maybe in linkgame"}], "tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": true, "score": 1, "last_activity_date": 1575473200, "last_edit_date": 1575473200, "creation_date": 1575469462, "answer_id": 59178234, "question_id": 59174379, "link": "https://stackoverflow.com/questions/59174379/parsing-odds-from-website-problem-in-excel-vba/59178234#59178234", "title": "Parsing Odds From Website Problem in Excel VBA", "body": "<p>Try to create the IE Object using the <code>CreateObject(\"InternetExplorer.Application\")</code> method, and modify your code as below:</p>\n\n<pre><code>Public Sub GetOddsInfo()\n    Dim IE As Object, URL As String\n    Dim i As Long, ws As Worksheet\n    Dim headers()\n    Dim teams, oddHome, oddDraw, oddAway, oddBtts, oddNbtts, oddOver, oddUnder As String\n    Const MAX_WAIT_SEC As Long = 10\n    URL = \"https://www.oddsportal.com/soccer/germany/2-bundesliga/results/#/page/3/\"\n    Set ws = ThisWorkbook.Worksheets(\"Plan1\")\n    headers = Array(\"Teams\", vbNullString, \"Home Odds\", \"Draw Odds\", \"Away Odds\", \"BTTS\", _\n                    \"NBTTS\", \"O2.5\", \"U2.5\")\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    With IE\n        .Visible = True\n        .Navigate2 URL\n\n        While .Busy Or .ReadyState &lt; 4: DoEvents: Wend\n\n        For i = 0 To 1\n\n    Dim linkgame, linkbtts, linkover As String\n        '.document.getElementsByClassName(\"deactivate\").Length -1\n\n            .Navigate2 URL\n            While .Busy Or .ReadyState &lt; 4: DoEvents: Wend\n\n            linkgame = .document.getElementsByClassName(\"deactivate\")(i).getElementsByClassName(\"name table-participant\")(0).Children(0).href\n            teams = .document.getElementsByClassName(\"deactivate\")(i).getElementsByClassName(\"name table-participant\")(0).Children(0).innerText\n\n            .Navigate2 linkgame\n            While .Busy Or .ReadyState &lt; 4: DoEvents: Wend\n            oddHome = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(0).innerText\n            oddDraw = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(1).innerText\n            oddAway = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(2).innerText\n\n            linkbtts = linkgame &amp; \"#bts;2\"\n\n            .Navigate2 linkbtts\n             While .Busy Or .ReadyState &lt; 4: DoEvents: Wend \n\n            oddBtts = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(0).innerText\n            oddNbtts = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(1).innerText\n\n            linkover = linkgame &amp; \"#over-under;2;2.50;0\"\n\n            .Navigate2 linkover\n\n             While .Busy Or .ReadyState &lt; 4: DoEvents: Wend\n\n            oddOver = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(1).innerText\n            oddUnder = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(2).innerText\n\n            ws.Range(\"A\" &amp; i + 2) = teams\n            ws.Range(\"C\" &amp; i + 2) = oddHome\n            ws.Range(\"D\" &amp; i + 2) = oddDraw\n            ws.Range(\"E\" &amp; i + 2) = oddAway\n            ws.Range(\"F\" &amp; i + 2) = oddBtts\n            ws.Range(\"G\" &amp; i + 2) = oddNbtts\n            ws.Range(\"H\" &amp; i + 2) = oddOver\n            ws.Range(\"I\" &amp; i + 2) = oddUnder \n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>The output as below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UMF94.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UMF94.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 12355153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3a3c71e43bbf021af7d37c9df39982?s=128&d=identicon&r=PG&f=1", "display_name": "wsn", "link": "https://stackoverflow.com/users/12355153/wsn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 59178234, "answer_count": 1, "score": 2, "last_activity_date": 1575473200, "creation_date": 1575457005, "last_edit_date": 1575461045, "question_id": 59174379, "link": "https://stackoverflow.com/questions/59174379/parsing-odds-from-website-problem-in-excel-vba", "title": "Parsing Odds From Website Problem in Excel VBA", "body": "<p>I'm trying to learn VBA to parse website information. Currently I'm trying to parse odds from a website, but shows me a error and I don't know what I'm doing wrong. Can someone help me?</p>\n\n<p><strong>This is my code:</strong></p>\n\n<pre><code>Public Sub GetOddsInfo()\n    Dim IE As New InternetExplorer, URL As String\n    Dim i As Long, ws As Worksheet\n    Dim headers()\n    Dim linkgame, linkbtts, linkover As String\n    Dim teams, oddHome, oddDraw, oddAway, oddBtts, oddNbtts, oddOver, oddUnder As String\n    Const MAX_WAIT_SEC As Long = 10\n    URL = \"https://www.oddsportal.com/soccer/germany/2-bundesliga/results/#/page/3/\"\n    Set ws = ThisWorkbook.Worksheets(\"Plan1\")\n    headers = Array(\"Teams\", vbNullString, \"Home Odds\", \"Draw Odds\", \"Away Odds\", \"BTTS\", _\n                    \"NBTTS\", \"O2.5\", \"U2.5\")\n\n    With IE\n        .Visible = True\n        .Navigate2 URL\n\n        While .Busy Or .ReadyState &lt; 4: DoEvents: Wend\n\n        For i = 0 To 1\n        '.document.getElementsByClassName(\" deactivate\").Length -1\n            .Navigate2 URL\n\n            linkgame = .document.getElementsByClassName(\" deactivate\")(i).getElementsByClassName(\"name table-participant\")(0).Children(0).href\n            teams = .document.getElementsByClassName(\" deactivate\")(i).getElementsByClassName(\"name table-participant\")(0).Children(0).innerText\n\n            .Navigate2 linkgame\n\n            oddHome = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(0).innerText\n            oddDraw = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(1).innerText\n            oddAway = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(2).innerText\n\n            linkbtts = linkgame &amp; \"#bts;2\"\n            .Navigate2 linkbtts\n\n            oddBtts = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(0).innerText\n            oddNbtts = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(1).innerText\n\n            linkover = linkgame &amp; \"#over-under;2;2.50;0\"\n            .Navigate2 linkover\n\n            oddOver = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(1).innerText\n            oddUnder = .document.getElementsByClassName(\"aver\")(0).getElementsByClassName(\"right\")(2).innerText\n\n            ws.Range(\"A\" &amp; i + 2) = teams\n            ws.Range(\"C\" &amp; i + 2) = oddHome\n            ws.Range(\"D\" &amp; i + 2) = oddDraw\n            ws.Range(\"E\" &amp; i + 2) = oddAway\n            ws.Range(\"F\" &amp; i + 2) = oddBtts\n            ws.Range(\"G\" &amp; i + 2) = oddNbtts\n            ws.Range(\"H\" &amp; i + 2) = oddOver\n            ws.Range(\"I\" &amp; i + 2) = oddUnder\n        Next i\n    End With\nEnd Sub\n\n</code></pre>\n\n<p>Shows me error in <code>.Navigate2 linkgame</code> and I don't understand why since <code>linkgame</code> will be the link of the game.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1575457606, "post_id": 59174180, "comment_id": 104570950, "body": "You shouldn&#39;t activate any workbook or worksheet. To do that you can use <code>Worksheet</code> and <code>Workbook</code> variables. You can find more info <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here</a>. Actually you are using them, instead just adding a new workbook, add it the variable. <code>Set NewBook =  Workbooks.Add(...)</code> this way you can reference the new workbook by your variable <code>NewBook</code>"}, {"owner": {"reputation": 49, "user_id": 6555774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w4Jbj.jpg?s=128&g=1", "display_name": "&#197;sa", "link": "https://stackoverflow.com/users/6555774/%c3%85sa"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1575460541, "post_id": 59174180, "comment_id": 104572456, "body": "Thanks. I cannot figure out what you want me to use instead of your 3 dots. Sorry for being stupid. :-P"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6555774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w4Jbj.jpg?s=128&g=1", "display_name": "&#197;sa", "link": "https://stackoverflow.com/users/6555774/%c3%85sa"}, "edited": false, "score": 0, "creation_date": 1575467512, "post_id": 59176181, "comment_id": 104576388, "body": "Thanks! Now I understand the jumping in between workbooks better. I got my macro to work using your tips."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 49, "user_id": 6555774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w4Jbj.jpg?s=128&g=1", "display_name": "&#197;sa", "link": "https://stackoverflow.com/users/6555774/%c3%85sa"}, "edited": false, "score": 0, "creation_date": 1575467957, "post_id": 59176181, "comment_id": 104576659, "body": "@&#197;sa I&#39;m glad you could make it work. If this answer helped you, please consider upvoting/accepting it as correct."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1575464232, "last_edit_date": 1575464232, "creation_date": 1575462806, "answer_id": 59176181, "question_id": 59174180, "link": "https://stackoverflow.com/questions/59174180/generate-new-workbook-and-add-a-template-header-with-multiple-rows/59176181#59176181", "title": "Generate new workbook and add a template header with multiple rows", "body": "<p>I've tried to explain the code so it makes sense. I don't know what do you actually want to do with the copied rows from the sheet templates, I've assumed you wanted to paste the format to the first 5 rows of your new workbok...</p>\n\n<pre><code>Option Explicit\nSub DataExport()\n\n    'Turn off screen updating to save runtime\n    Application.ScreenUpdating = False 'do it at the beginning of your code\n\n    'Declare variables\n    'try to declare your variables just before using them so it's easier to know what do they do.\n\n\n    'Dim rng As Range you are not using this\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets(\"Data\") 'always reference workbook and worksheet\n\n    'The save path for the files created\n    Dim SavePath As String\n    SavePath = Range(\"FolderPath\")\n\n    With ws 'you can use this to reference this worksheet using only a dot\n        'Variables for the column to separate data based on\n        Dim ColumnHeadingInt As Long\n        ColumnHeadingInt = WorksheetFunction.Match(.Range(\"ExportCriteria\").Value, .Range(\"Data[#Headers]\"), 0)\n\n        Dim ColumnHeadingStr As String\n        ColumnHeadingStr = \"Data[[#All],[\" &amp; .Range(\"ExportCriteria\") &amp; \"]]\"\n\n        'Creates a temporary list of unique values\n        .Range(ColumnHeadingStr &amp; \"\").AdvancedFilter Action:=xlFilterCopy, _\n            CopyToRange:=.Range(\"UniqueValues\"), Unique:=True\n\n        'Sort the temporary list of unique values\n        .Range(\"UniqueValues\").EntireColumn.Sort Key1:=ws.Range(\"UniqueValues\").Offset(1, 0), _\n            Order1:=xlAscending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, _\n            Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\n\n        'Add unique field values into an array\n        Dim ArrayOfUniqueValues As Variant\n        ArrayOfUniqueValues = Application.WorksheetFunction.Transpose(.Range(\"UniqueValues\").EntireColumn.SpecialCells(xlCellTypeConstants))\n\n        'Delete the temporary values\n        .Range(\"UniqueValues\").EntireColumn.Clear\n\n    End With 'here ends the reference to your ws sheet\n\n    'You shouldn't declare anything inside a loop, so you do it just before.\n    Dim NewBook As Workbook\n\n    'Loop through the array of unique field values. Then copy paste into new workbooks and save.\n    Dim ArrayItem As Long\n    For ArrayItem = LBound(ArrayOfUniqueValues) To UBound(ArrayOfUniqueValues)\n        .ListObjects(\"Data\").Range.AutoFilter Field:=ColumnHeadingInt, Criteria1:=ArrayOfUniqueValues(ArrayItem)\n        .Range(\"Data[#All]\").SpecialCells(xlCellTypeVisible).Copy\n\n        'Here you use the NewBook variable.\n        Set NewBook = Workbooks.Add 'you can use the workbook variable like this\n        With NewBook.Sheets(1)\n            .Range(\"A1\").PasteSpecial xlPasteAll ' pastes all values\n            .Columns(1).EntireColumn.Delete\n            .Rows(\"1:1\").Insert Shift:=xlDown\n        End With\n\n    'here is where the trouble starts this block can be resumed in one line of code\n'        Windows(\"REFERENCE with export VB.xlsm\").Activate\n'        Sheets(\"Template\").Select\n'        Rows(\"1:5\").Select\n'        Selection.Copy\n\n    'ThisWorkbook always refers to the workbook running the code\n    ThisWorkbook.Sheets(\"Template\").Rows(\"1:5\").Copy\n\n    With NewBook 'again reference the new workbook\n        'This I think is what you want to do, paste formats from rows 1 to 5 on your Template sheet\n        .Sheets(1).Range(\"A1\").PasteSpecial xlPasteFormats\n\n        'saving the new workbook. Should it be places somewhere else?\n        'Should be placed just before the last operation so you don't need to save multiple times\n        .SaveAs SavePath &amp; ArrayOfUniqueValues(ArrayItem) &amp; \".xlsx\", 51\n        .Close\n    End With\n\n        ws.ListObjects(\"Data\").Range.AutoFilter Field:=ColumnHeadingInt\n    Next ArrayItem\n\n    ws.AutoFilterMode = False\n    MsgBox \"Finished exporting!\"\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6555774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w4Jbj.jpg?s=128&g=1", "display_name": "&#197;sa", "link": "https://stackoverflow.com/users/6555774/%c3%85sa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 59176181, "answer_count": 1, "score": 1, "last_activity_date": 1575464232, "creation_date": 1575456409, "last_edit_date": 1575457200, "question_id": 59174180, "link": "https://stackoverflow.com/questions/59174180/generate-new-workbook-and-add-a-template-header-with-multiple-rows", "title": "Generate new workbook and add a template header with multiple rows", "body": "<p>I have compiled a Macro to generate new workbooks based on unique values i the original workbook. Then it copies the rows related to thees values into the new workbook. This works great.</p>\n\n<p>However I also want a template to be copied after this process and inserted as new rows in the new workbook. I am having trouble activating this new workbook to run these actions. </p>\n\n<p>I am guessing that the new workbook needs to be set to something so I can use this as a reference. To later be used in this part: <code>Windows(\"newBook\").Activate</code>. Or should this part be written completely different?</p>\n\n<p>And when should the new workbook be saved to set it\u00b4s name? \nUsing this part <code>ActiveWorkbook.SaveAs SavePath &amp; ArrayOfUniqueValues(ArrayItem) &amp; \".xlsx\", 51</code></p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Option Explicit\n\nSub DataExport()\n\n'Declare variables\nDim ArrayItem As Long\nDim ws As Worksheet\nDim NewBook As Workbook\nDim ArrayOfUniqueValues As Variant\nDim SavePath As String\nDim ColumnHeadingInt As Long\nDim ColumnHeadingStr As String\nDim rng As Range\n\nSet ws = Sheets(\"Data\")\nSet NewBook = 'what?\n\n'The save path for the files created\nSavePath = Range(\"FolderPath\")\n\n'Variables for the column to separate data based on\nColumnHeadingInt = WorksheetFunction.Match(Range(\"ExportCriteria\").Value, Range(\"Data[#Headers]\"), 0)\nColumnHeadingStr = \"Data[[#All],[\" &amp; Range(\"ExportCriteria\").Value &amp; \"]]\"\n\n'Turn off screen updating to save runtime\nApplication.ScreenUpdating = False\n\n'Creates a temporary list of unique values\nRange(ColumnHeadingStr &amp; \"\").AdvancedFilter Action:=xlFilterCopy, _\n    CopyToRange:=Range(\"UniqueValues\"), Unique:=True\n\n'Sort the temporary list of unique values\nws.Range(\"UniqueValues\").EntireColumn.Sort Key1:=ws.Range(\"UniqueValues\").Offset(1, 0), _\n    Order1:=xlAscending, Header:=xlYes, OrderCustom:=1, MatchCase:=False, _\n    Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\n\n'Add unique field values into an array\nArrayOfUniqueValues = Application.WorksheetFunction.Transpose(ws.Range(\"UniqueValues\").EntireColumn.SpecialCells(xlCellTypeConstants))\n\n'Delete the temporary values\nws.Range(\"UniqueValues\").EntireColumn.Clear\n\n'Loop through the array of unique field values. Then copy paste into new workbooks and save.\nFor ArrayItem = 1 To UBound(ArrayOfUniqueValues)\n    ws.ListObjects(\"Data\").Range.AutoFilter Field:=ColumnHeadingInt, Criteria1:=ArrayOfUniqueValues(ArrayItem)\n    ws.Range(\"Data[#All]\").SpecialCells(xlCellTypeVisible).Copy\n    Workbooks.Add\n            Range(\"A1\").PasteSpecial xlPasteAll ' pastes all values\n            Columns(1).EntireColumn.Delete\n\n'saving the new workbook. Should it be places somewhere else?\n  ActiveWorkbook.SaveAs SavePath &amp; ArrayOfUniqueValues(ArrayItem) &amp; \".xlsx\", 51\n\n'here is where the trouble starts\n    Windows(\"REFERENCE with export VB.xlsm\").Activate\n    Sheets(\"Template\").Select\n    Rows(\"1:5\").Select\n    Selection.Copy\n\n'Now the tricky part on how to go back to the new workbook\n    Windows(\"newBook\").Activate\n    Rows(\"1:1\").Select\n    Selection.Insert Shift:=xlDown\n\n'Saving and closing    \n            ActiveWorkbook.Save\n    ActiveWorkbook.Close False\n    ws.ListObjects(\"Data\").Range.AutoFilter Field:=ColumnHeadingInt\nNext ArrayItem\n\nws.AutoFilterMode = False\nMsgBox \"Finished exporting!\"\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 12366104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085e6540757cf86f8d06da9283882e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Lourensohn", "link": "https://stackoverflow.com/users/12366104/lourensohn"}, "edited": false, "score": 0, "creation_date": 1575527549, "post_id": 59174118, "comment_id": 104598382, "body": "Hey there!  This was exactly what I needed! Thank you so, so much! :)"}], "tags": [], "owner": {"reputation": 46, "user_id": 12479006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19f56d1c94c797a0dea781094a39e01?s=128&d=identicon&r=PG", "display_name": "AlSkylark", "link": "https://stackoverflow.com/users/12479006/alskylark"}, "is_accepted": false, "score": 2, "last_activity_date": 1575456194, "creation_date": 1575456194, "answer_id": 59174118, "question_id": 59173311, "link": "https://stackoverflow.com/questions/59173311/how-do-i-prompt-for-multiple-strings-on-open-for-my-form/59174118#59174118", "title": "How do I prompt for multiple Strings on open for my form?", "body": "<p>Your code would work if you surround the filter by quotes. So: </p>\n\n<pre><code>   Private Sub Form_Open(Cancel As Integer)\n   Dim m As String\n\n   m = InputBox(\"Please enter itemIDs, seperated by commas\", \"itemID\")\n   If m &lt;&gt; \"\" Then\n         Me.Filter = \"itemID in ('\" &amp; m &amp; \"')\" 'Notice the single quotes\n         Me.FilterOn = True\n   Else\n         Me.FilterOn = False\n   End If\n   End Sub\n</code></pre>\n\n<p>However the trouble then becomes that multiple itemIDs will not be filtered properly, as you would need to surround them all by quotes. \nLike:</p>\n\n<pre><code>    Me.Filter = \"itemID in ('ID001', 'ID002', 'etc')\"\n</code></pre>\n\n<p>So you need to first add the extra quotes if the user input contains that pesky coma.<br> \nYou could do something like:</p>\n\n<pre><code>   Private Sub Form_Open(Cancel As Integer)\n   Dim m As String\n\n   m = InputBox(\"Please enter itemIDs, seperated by commas\", \"itemID\")\n   If m &lt;&gt; \"\" Then\n        'as a quick example, if m contains comas we surround them by quotes\n         If InStr(1, m, \",\") &lt;&gt; 0 Then m = Replace(m, \",\", \"','\")\n        'however this would only work if the user inputs the ids like \"id1,id2\"\n        'it fails to account for a space after the comas like \"id1, id2\" \n         Me.Filter = \"itemID in ('\" &amp; m &amp; \"')\"\n         Me.FilterOn = True\n   Else\n         Me.FilterOn = False\n   End If\n\n   End Sub\n</code></pre>\n\n<p>Hope this points you in the right direction! </p>\n"}], "owner": {"reputation": 9, "user_id": 12366104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085e6540757cf86f8d06da9283882e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Lourensohn", "link": "https://stackoverflow.com/users/12366104/lourensohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594233838, "creation_date": 1575453600, "last_edit_date": 1594233838, "question_id": 59173311, "link": "https://stackoverflow.com/questions/59173311/how-do-i-prompt-for-multiple-strings-on-open-for-my-form", "title": "How do I prompt for multiple Strings on open for my form?", "body": "<p>In my Access DB, I made a form that asks for user input on open. The user can enter multiple itemIDs (numeric), seperated by comma, and the query returns a table with all the respective items.</p>\n\n<p>My IDs now also contain letters (not my decision!), so I need to change the input type to String. Is there any way I can use the following linbes of VBA code to work just like they did before, but with Strings?</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\nDim m As String\n\nm = InputBox(\"Please enter itemIDs, seperated by commas\", \"itemID\")\nIf m &lt;&gt; \"\" Then\n      Me.Filter = \"itemID in (\" &amp; m &amp; \")\"\n      Me.FilterOn = True\nElse\n     Me.FilterOn = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Thanks for the help! Cheers!</p>\n"}, {"tags": ["excel", "vba", "loops", "listbox"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575454316, "post_id": 59173271, "comment_id": 104569148, "body": "What do you mean with &quot;seperate them&quot;? Do you want to loop a range and do something when that value is selected in a listbox? Are multiple items selected?"}, {"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575454552, "post_id": 59173271, "comment_id": 104569289, "body": "The listbox presents a list of countries. The user should be able to choose 1 or more countries and then the macro should filter a table on the users choice no matter if 1 country or several countries are selected. What I want to do is that the macro runs each choice through a table afterwards in order to filter. Hope that clarifies?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575454660, "post_id": 59173271, "comment_id": 104569356, "body": "So the choises of the listbox determines the filter? Pick (multiple)  countries in the listbox and the rows should be visible when the country is picked? If not picked, it should be invisible?"}, {"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575454959, "post_id": 59173271, "comment_id": 104569535, "body": "Yes exactly right"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575455065, "post_id": 59173271, "comment_id": 104569597, "body": "One more question. Where is your listbox situated? On a userform or on your worksheet?"}, {"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575455467, "post_id": 59173271, "comment_id": 104569825, "body": "It&#39;s in a userform but both solutions would work"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575533468, "post_id": 59174062, "comment_id": 104600661, "body": "Thanks, however this doesn&#39;t seem to work. It doesn&#39;t filter the list properly. Any idea why?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575542422, "post_id": 59174062, "comment_id": 104605067, "body": "@Gisse: I adapted a little the code in order to offer you a check possibility. Run it and it will stop before the line <code>If SelectedItems = &quot;&quot; Then</code>. Move the mouse over the line in discussion and you can see the value of <code>SelectedItems</code>. If there are records in this variable, this means that the code works well until that point. In such a case press F5. If <code>Range(&quot;F&quot; &amp; i).value</code> will be equal with <code>selItem</code> another <code>Stop</code> will confirm that and now it&#39;s time to run the code line by line and see what it does."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575542449, "post_id": 59174062, "comment_id": 104605079, "body": "@Gisse: So check what value <code>i</code> takes, press F8 and see in the workbook if the row <code>i</code> has been hide. If not try to understand where the problem is, or post here a brief description of what happened."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575548001, "post_id": 59174062, "comment_id": 104608078, "body": "@Gisse: Until now I couldn&#39;t test the code I posted. I just observed what is wrong regarding the individual selected item identification. Now I checked the code itself. Like you can see, I commented the part <code>Else: Rows(i).EntireRow.Hidden = False</code>. If this part remains, your code firstly will hide the selected item row but after that, during the iteration will make it visible and you cannot see nothing else then your initial column composition."}, {"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575556334, "post_id": 59174062, "comment_id": 104612795, "body": "Thanks, I just noticed that it doesn&#39;t hide anything either. However why is this the case with above code. I guess I can just delete it making it do what it is supposed to. However why is this? It worked when I ran this code as a test on another sheet."}, {"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575557322, "post_id": 59174062, "comment_id": 104613354, "body": "It doesn&#39;t seem to work. My code doesn&#39;t hide anything even with deletion of the code you suggested. The <code>range(&quot;F&quot; &amp; i).value = Selitem</code> is exactly the same value, but somehow it doesn&#39;t recognize it. At least it doesn&#39;t hide the row. Any suggestions?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575558327, "post_id": 59174062, "comment_id": 104613926, "body": "@Gisse: But you did what I suggested? In order to understand something you must come back with some (real) feedback. Saying that it does not work/hide does not say too much to me. So, does <code>SelectedItems</code> looks as expected? Did you understand how to check that? If yes, this means that the code collected all selected issues in a string works. Secondly, when the code stops at the second <code>Stop</code> line, did you press F8 fore some times and <b>look to the Excel page to check if the row <code>i</code> is hidden</b> (or not), after each F8 press?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575558495, "post_id": 59174062, "comment_id": 104614030, "body": "@Gisse:  If not, how do you believe that we can determine the problem of the code? In my case it works! If you do not understand what I suggested, can you post a link to your real workbook to be able to test the code by myself?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575559470, "post_id": 59174062, "comment_id": 104614534, "body": "@Gisse: Did the code stop to the second <code>Stop</code> line?"}, {"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575559563, "post_id": 59174062, "comment_id": 104614583, "body": "Yes I&#39;ve run the entire code through by clicking F8. However I don&#39;t know what the stop command does? In my case it doesn&#39;t hide the row and I don&#39;t understand why. I check a long the way and the value of the SelItem is exactly the same as the range in the loop. Let me get back to you. Thanks for your help though"}, {"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575559630, "post_id": 59174062, "comment_id": 104614623, "body": "No it doesn&#39;t stop on the second stop line. What does this mean?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575560324, "post_id": 59174062, "comment_id": 104615031, "body": "@Gisse: The <code>Stop</code> &quot;command&quot; does exactly what it means: It stops the code on its line... Does your code stop on <code>Stop</code> line? At least, on the first Stop? If yes, I told you to move the mouse over the variable to be checked and its value will appear. Is it as expected? If the second <code>Stop</code> line is not touched this means that the condition before it is not true. Maybe you run the code on a different sheet, or whatever."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575560405, "post_id": 59174062, "comment_id": 104615060, "body": "@Gisse: In order to be sure that the data in the cell is the same with the one collected form list box you can change the code as following: <code>If CStr(Range(&quot;F&quot; &amp; i).value) = CStr(selItem) Then</code>. It transforms everything in string.   I asked you to send a link to your workbook. Cleaned by confidential data if this is the case. Otherwise, it looks we speak two different languages. Sorry..."}, {"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575560889, "post_id": 59174062, "comment_id": 104615316, "body": "Unfortunately I can&#39;t provide link."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1575562508, "post_id": 59174062, "comment_id": 104616296, "body": "OK. No problem with me. If you are able to describe what I requested in order to be able to help, I will try my best. If not, I wish you all the best, anyhow!"}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": true, "score": 1, "last_activity_date": 1575559337, "last_edit_date": 1575559337, "creation_date": 1575456052, "answer_id": 59174062, "question_id": 59173271, "link": "https://stackoverflow.com/questions/59173271/seperate-listbox-items-to-do-a-for-each-loop/59174062#59174062", "title": "Seperate listbox items to do a for each loop", "body": "<pre><code>Dim SelectedItems As String, LastRow As Long\nDim selItem As Variant, selItems As Variant\n\nLastRow = ActiveSheet.Range(\"F1\").SpecialCells(xlCellTypeLastCell).Row\n\nFor i = 0 To ListBox2.ListCount - 1\n    If ListBox2.Selected(i) = True Then\n        SelectedItems = SelectedItems &amp; ListBox2.List(i) &amp; vbNewLine\n    End If\nNext i\n\nStop\nIf SelectedItems = \"\" Then\n    MsgBox \"Please select minimum one country\"\nElse\n    SelectedItems = left(SelectedItems, Len(SelectedItems) - 1)\n    selItems = Split(SelectedItems, vbNewLine)\n    For Each selItem In selItems\n        For i = LastRow To 11 Step -1\n            If CStr(Range(\"F\" &amp; i).value) = CStr(selItem) Then\n                Stop\n                Rows(i).EntireRow.Hidden = True\n                'Else: Rows(i).EntireRow.Hidden = False\n            End If\n        Next i\n    Next\nEnd If\n</code></pre>\n\n<p>Your code could not identify each selected Item from the string without splitting it in its elements.\nEdited: Transformed the code in a test one. I will explain you (in a comment) how to check.</p>\n\n<p>Note: I just tried to make your code workable. Otherwise, you can make the filtering directly, using Excel AutoFilter (in VBA,  of course)... </p>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1575456926, "last_edit_date": 1575456926, "creation_date": 1575456285, "answer_id": 59174138, "question_id": 59173271, "link": "https://stackoverflow.com/questions/59173271/seperate-listbox-items-to-do-a-for-each-loop/59174138#59174138", "title": "Seperate listbox items to do a for each loop", "body": "<p>So just a small example on how I would approach this, avoiding multiple loops:</p>\n\n<hr>\n\n<p><strong><em><sub>Sample data:</sub></em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/tWDDh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tWDDh.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong><em><sub>UserForm Sample:</sub></em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/pCXdf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pCXdf.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong><em><sub>UserForm Sample Code:</sub></em></strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\nDim x As Long, lr As Long\nDim rng As Range\n\n'Check if anything has been selected at all\nIf Me.ListBox1.ListIndex = 0 Then Exit Sub\n\n'Capture selected items in your ListBox\nFor x = 0 To Me.ListBox1.ListCount - 1\n    If Me.ListBox1.Selected(x) Then\n        dict(ListBox1.List(x)) = 1\n    End If\nNext x\n\n'Filter the range accordingly\nWith Sheet1\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    Set rng = .Range(\"A1:A\" &amp; lr)\n    rng.AutoFilter 1, Array(dict.keys), xlFilterValues\nEnd With\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\nDim lr As Long\n\n'Populate your ListBox\nWith Sheet1\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    Me.ListBox1.RowSource = .Range(\"A2:A\" &amp; lr).Address\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><em><sub>Sample Result:</sub></em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/sxcLL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sxcLL.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/E2oLq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E2oLq.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 59174062, "answer_count": 2, "score": 2, "last_activity_date": 1575559337, "creation_date": 1575453468, "question_id": 59173271, "link": "https://stackoverflow.com/questions/59173271/seperate-listbox-items-to-do-a-for-each-loop", "title": "Seperate listbox items to do a for each loop", "body": "<p>I'm having trouble seperating my listbox items, so I can run them in a loop. I know this atm takes all items and tries to run them through, however I don't know how to seperate them.\nThe code is following:</p>\n\n<pre><code>Dim SelectedItems As String\nDim LastRow As Long\n\nLastRow = ActiveSheet.Range(\"F1\").SpecialCells(xlCellTypeLastCell).Row\n\nFor i = 0 To ListBox2.ListCount - 1\nIf ListBox2.Selected(i) = True Then\nSelectedItems = SelectedItems &amp; ListBox2.List(i) &amp; vbNewLine\nEnd If\nNext i\n\nIf SelectedItems = \"\" Then\nMsgBox \"Please select minimum one country\"\nElse\n\nFor Each SelectedItems In ListBox2\n\n    For i = 11 To LastRow\n\n    If Range(\"F\" &amp; i).Value = SelectedItems Then\n    Rows(i).EntireRow.Hidden = True\n    Else: Rows(i).EntireRow.Hidden = False\n    End If\n\n    Next i\nNext SelectedItems\n</code></pre>\n\n<p>can someone assist?</p>\n"}, {"tags": ["excel", "vba", "add-in", "commandbar"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1575454343, "post_id": 59173073, "comment_id": 104569169, "body": "Might be time to upgrade your add-in to use the Ribbon properly? :)"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1575456526, "post_id": 59173073, "comment_id": 104570391, "body": "Do you see the addin being installed? Can you run any of its procedures from IDE?"}, {"owner": {"reputation": 1, "user_id": 5450117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/059431358c967a3066db046d78f6220d?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Samanta", "link": "https://stackoverflow.com/users/5450117/abhishek-samanta"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1575460087, "post_id": 59173073, "comment_id": 104572214, "body": "@Rory Noted. Any thread where I can read up about moving this to Ribbon?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1575460194, "post_id": 59173073, "comment_id": 104572275, "body": "Read Ron&#39;s pages here: <a href=\"http://www.rondebruin.nl/win/section2.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/section2.htm</a>"}], "owner": {"reputation": 1, "user_id": 5450117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/059431358c967a3066db046d78f6220d?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Samanta", "link": "https://stackoverflow.com/users/5450117/abhishek-samanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575613615, "creation_date": 1575452895, "last_edit_date": 1575613615, "question_id": 59173073, "link": "https://stackoverflow.com/questions/59173073/excel365-commandbar-not-appearing-in-add-in-tab", "title": "Excel365 commandbar not appearing in add-in tab", "body": "<p>I have an Excel add-in for statistical analysis that creates a commandbar with some menu/sub-menu. The code that I use is below:</p>\n\n<pre><code>Sub CreateMyMenu()\n    Dim cbBar As CommandBar\n    Dim cbCtrl As CommandBarControl\n    Dim cbCtrl1 As CommandBarControl\n    Dim cbCtrl2 As CommandBarControl\n    Dim cbCtrl3 As CommandBarControl\n    Dim cbCtrl4 As CommandBarControl\n    Dim cbCtrl5 As CommandBarControl\n    Dim cbCtrlHelp As CommandBarControl\n    Dim cbPop As CommandBarPopup, cbPop1 As CommandBarPopup, cbPop2 As CommandBarPopup, cbPop3 As CommandBarPopup\n\n    ' Delete the CommandBar if it exists already\n    On Error Resume Next\n    Application.CommandBars(\"CreditScoringSuite\").Delete\n\n    Set cbBar = CommandBars.Add(\"CreditScoringSuite\")\n    Set cbPop = cbBar.Controls.Add(Type:=msoControlPopup)\n    'add a popup menu To the custom menu\n    With cbPop\n        .Caption = \"CSS G1 - Xform\"\n        .TooltipText = \"Welcome! Let's get started ...\"\n        .BeginGroup = True\n    End With\n    '-----------------------codes truncated---------------\n\n' Show the command bar\n    cbBar.Visible = True      \n\n    End Sub\n</code></pre>\n\n<p>I also have the following code in \"ThisWorkbook\" </p>\n\n<pre><code>Private Sub Workbook_Open()\n    CreateMyMenu\nEnd Sub\n</code></pre>\n\n<p>The issue I am facing is that the commandbar does not appear in the add-in tab although it is activated. I have been using this add-in for many years but my office switched to Excel365 recently and since then this behaviour is noted. </p>\n\n<p>appreciate any guidance.</p>\n\n<p>EDIT : Based on advice I created a custom ribbon (see pic). Tested in a separate .xlsm file. However when I integrate this within my .xlam add-in the macros do not run automatically and the custom tab does not get created. Seems like the same issue that during launch of Excel as an application these codes are not getting executed.<a href=\"https://i.stack.imgur.com/T2d8a.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["arrays", "excel", "vba", "public"], "comments": [{"owner": {"reputation": 23, "user_id": 9033373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cf6cedef724254a2873a8f04062d36?s=128&d=identicon&r=PG&f=1", "display_name": "OB1", "link": "https://stackoverflow.com/users/9033373/ob1"}, "edited": false, "score": 0, "creation_date": 1575453586, "post_id": 59172977, "comment_id": 104568694, "body": "To add, the error occurs at ``` If dataarray0(k + 2, j + 1) &gt; IRRSAMPSTRENGTH(i, j) Then```"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1575453738, "post_id": 59172977, "comment_id": 104568806, "body": "In your sub, your are defining an new array <code>Dim dataarray0() As Variant, DEST As Variant</code>. This new array is the one use in the Sub, not the public one defined above, and it does not have the same scope."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1575453778, "post_id": 59172977, "comment_id": 104568840, "body": "Remove the additional definition in the Sub."}, {"owner": {"reputation": 23, "user_id": 9033373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cf6cedef724254a2873a8f04062d36?s=128&d=identicon&r=PG&f=1", "display_name": "OB1", "link": "https://stackoverflow.com/users/9033373/ob1"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1575454656, "post_id": 59172977, "comment_id": 104569354, "body": "@VincentG Thanks, but when I do as you suggest removing <code>Dim dataarray0()</code> as variant, it comes up with another error earlier in the process now in the first code at <code>dataarray0()=partderivrng</code> error is also subscript out of range."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9033373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cf6cedef724254a2873a8f04062d36?s=128&d=identicon&r=PG&f=1", "display_name": "OB1", "link": "https://stackoverflow.com/users/9033373/ob1"}, "edited": false, "score": 0, "creation_date": 1575455348, "post_id": 59173526, "comment_id": 104569762, "body": "Thanks, However, when doing this, the error <code>subscript out of range</code> now resides with <code>dataarray0()=partderivrng</code>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 23, "user_id": 9033373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cf6cedef724254a2873a8f04062d36?s=128&d=identicon&r=PG&f=1", "display_name": "OB1", "link": "https://stackoverflow.com/users/9033373/ob1"}, "edited": false, "score": 0, "creation_date": 1575456130, "post_id": 59173526, "comment_id": 104570164, "body": "<code>dataarray0</code> is not defined as an array, but as a Variant... so there is no dataarray0() (yet). Either change the definition to an array of Variant, or initialize the value with <code>dataarray0 = partdelivery</code> (in which case it will be a Variant containing an array)"}, {"owner": {"reputation": 23, "user_id": 9033373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cf6cedef724254a2873a8f04062d36?s=128&d=identicon&r=PG&f=1", "display_name": "OB1", "link": "https://stackoverflow.com/users/9033373/ob1"}, "edited": false, "score": 0, "creation_date": 1575469110, "post_id": 59173526, "comment_id": 104577381, "body": "I am unsure what you mean by this, <code>partdelivrng</code> is a range and I thought that in order to assign a range to an array you need the () at the end.  How when this is called in the module does it know it is 2d array with subscript k and j?"}, {"owner": {"reputation": 23, "user_id": 9033373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cf6cedef724254a2873a8f04062d36?s=128&d=identicon&r=PG&f=1", "display_name": "OB1", "link": "https://stackoverflow.com/users/9033373/ob1"}, "edited": false, "score": 0, "creation_date": 1575471406, "post_id": 59173526, "comment_id": 104578821, "body": "Thanks and sorry to be a pain, but now after applying that in the module it comes up with subscript out of range at <code>If dataarray0(k + 2, j + 1) &gt; IRRSAMPSTRENGTH(i, j) Then</code> so back to the beginning."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 23, "user_id": 9033373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cf6cedef724254a2873a8f04062d36?s=128&d=identicon&r=PG&f=1", "display_name": "OB1", "link": "https://stackoverflow.com/users/9033373/ob1"}, "edited": false, "score": 0, "creation_date": 1575472063, "post_id": 59173526, "comment_id": 104579210, "body": "What are the values of the Lbounds and Ubounds of the arrays, and the values of k, j and i  when it fails? It should indicate where the error lie."}, {"owner": {"reputation": 23, "user_id": 9033373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cf6cedef724254a2873a8f04062d36?s=128&d=identicon&r=PG&f=1", "display_name": "OB1", "link": "https://stackoverflow.com/users/9033373/ob1"}, "edited": false, "score": 0, "creation_date": 1575474190, "post_id": 59173526, "comment_id": 104580416, "body": "I have solved this issue now thanks! Please see the answer I posted above."}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1575470368, "last_edit_date": 1575470368, "creation_date": 1575454223, "answer_id": 59173526, "question_id": 59172977, "link": "https://stackoverflow.com/questions/59172977/subscript-out-of-range-when-using-a-public-declared-array-in-a-different-private/59173526#59173526", "title": "Subscript out of range when using a public declared array in a different private subroutine", "body": "<p>The Public variable <code>dataarray0</code> declared in the module is not modified in the Sub <code>CommandButton2_Click</code> because you also defined a local variable with the same name in the sub.</p>\n\n<p>Hence all access to <code>dataarray0</code> in the Sub are made on the local defined variable, not the global public one. And when trying to access the variable from another place, you are accessing an uninitialized Variant.</p>\n\n<p>If it is not useful, remove the local unneeded local variable which is masking the global one.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n   Dim addr As String, partderivrng As Range, cell As Range, thisbook As String, NROWSPDIV As Integer\n   Dim NCOLSPDIV As Integer\n   Dim mydestination As Range\n   'Dim dataarray0() As Variant, DEST As Variant\n   Dim DEST As Variant\n  .\n  .\n  .\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Edit:\nIn your current code, the public declaration is:</p>\n\n<p><code>Public dataarray0 As Variant</code></p>\n\n<p>A variant can contain an array, so the syntax <code>dataarray0 = partdelivery</code> will assign the content of the range to the variable, which will then become of type Variant/Variant array\n<a href=\"https://i.stack.imgur.com/ISiaZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ISiaZ.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/Rnsa9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rnsa9.png\" alt=\"enter image description here\"></a>\nAnd you will access data like this:<a href=\"https://i.stack.imgur.com/V3HTk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V3HTk.png\" alt=\"enter image description here\"></a></p>\n\n<p>You won't be able to declare dataarray0 as an array of Variant like this, at least not at module scope:</p>\n\n<p><code>Public dataarray0() As Variant 'WRONG -&gt; compile error</code></p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 9033373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cf6cedef724254a2873a8f04062d36?s=128&d=identicon&r=PG&f=1", "display_name": "OB1", "link": "https://stackoverflow.com/users/9033373/ob1"}, "is_accepted": false, "score": 0, "last_activity_date": 1575473852, "creation_date": 1575473852, "answer_id": 59179594, "question_id": 59172977, "link": "https://stackoverflow.com/questions/59172977/subscript-out-of-range-when-using-a-public-declared-array-in-a-different-private/59179594#59179594", "title": "Subscript out of range when using a public declared array in a different private subroutine", "body": "<p>I have found that because <code>dataarray0</code> is declared as public in a <code>userform</code> that it doesn't behave as a global variable and therefore when I use it in my module I should put the userform name prior to the use of dataarray0 i.e. </p>\n\n<p><code>Partderiv.dataarray0</code> this seems to now work </p>\n\n<p>Thanks </p>\n"}], "owner": {"reputation": 23, "user_id": 9033373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9cf6cedef724254a2873a8f04062d36?s=128&d=identicon&r=PG&f=1", "display_name": "OB1", "link": "https://stackoverflow.com/users/9033373/ob1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1575473852, "creation_date": 1575452649, "last_edit_date": 1575457223, "question_id": 59172977, "link": "https://stackoverflow.com/questions/59172977/subscript-out-of-range-when-using-a-public-declared-array-in-a-different-private", "title": "Subscript out of range when using a public declared array in a different private subroutine", "body": "<p>I have assigned a refedit selected range to an array called <code>dataarray0</code> I have declared it as public and then use this array in the main subroutine. However, when I run from the Private sub through to the main subroutine, I get <code>subscript out of range</code> error  which I just can't  figure out. Please find below two codes 1 is the code for the USERFORM that defines the array and 2 the code which uses this array: </p>\n\n<pre><code>Option Explicit\nPublic dataarray0 As Variant\n\nPrivate Sub ActiWorkBook_Change()\n   If ActiWorkBook &lt;&gt; \"\" Then Application.Workbooks(ActiWorkBook.Text).Activate\n   Label1.Caption = \"\": RefEdit1 = \"\"\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nUnload Me\nEnd\nEnd Sub\n\n\nPrivate Sub CommandButton2_Click()\n   Dim addr As String, partderivrng As Range, cell As Range, thisbook As String, NROWSPDIV As Integer\n   Dim NCOLSPDIV As Integer\n   Dim mydestination As Range\n   Dim dataarray0() As Variant, DEST As Variant\n\n\n   If RefEdit1.Value = \"\" Then\n      Partderiv.Hide\n      ERR1.Show\n   Else\n      addr = RefEdit1.Value\n      Set partderivrng = Range(addr)\n      NROWSPDIV = Range(addr).Rows.Count\n      NCOLSPDIV = Range(addr).Columns.Count\n'      ReDim dataarray0(NROWSPDIV, NCOLSPDIV)\n      dataarray0() = partderivrng\n      ThisWorkbook.Activate\n      Sheets(\"PD\").Select\n      Set mydestination = Application.InputBox(Prompt:= _\n          \"What is the first cell in the destination range for data?\", Type:=8)\n      mydestination.Select\n\n'      mydestination.Paste Link:=True\n      Partderiv.Hide\n\n      Set DEST = mydestination.Resize(NROWSPDIV, NCOLSPDIV)\n      DEST.Value = dataarray0\n\n   End If\n   Data1.Show\n   End\nEnd Sub\n\nPrivate Sub CommandButton3_Click()\nUnload Me\nDYNA1.Show\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n   Dim wb As Workbook\n\n   For Each wb In Application.Workbooks\n      ActiWorkBook.AddItem wb.Name\n   Next\n\n   ActiWorkBook = ActiveWorkbook.Name\n   Partderiv.RefEdit1.Text = \"\"\n\nEnd Sub\n\nPrivate Sub RefEdit1_Change()\n   Label1.Caption = \"\"\n   If RefEdit1.Value &lt;&gt; \"\" Then _\n   Label1.Caption = \"[\" &amp; ActiWorkBook &amp; \"]\" &amp; RefEdit1\nEnd Sub\n\n</code></pre>\n\n<pre><code>Sub CALC1_Run(ByRef dataarray1 As Variant, ByRef dataarray0 As Variant)\n' This subroutine runs the calculation for the Isolated brick: Simple KWR Strength Calculation\n' Created 27/11/2019 by Owen Booler\n' Version 1: 27/11/2019 - Creation of subroutine  by Owen Booler\n'Integer definitions\n' Loop Identifiers\nDim i As Integer, j As Integer, k As Integer\n' Other Variables\nDim NSIM As Integer, NSITES As Integer, NKWRS As Integer, NTIME As Integer, NHITS As Integer\n\n' Double Precision definitions\n' String definitions\nDim DIST As String\n\n' Array definitions\nDim Prob() As Double, SAMPSTRENGTH() As Double, SDV23 As Double, IRRSAMPSTRENGTH() As Variant\nDim NEWARRAY() As Variant, HITTIME() As Double\n' Range definitions\nDim DEST1 As Range, DEST2 As Range\n\n\n\nRandomize\n\n' Defintions for Testing\nNSIM = 1000\nDIST = \"N\"\nNTIME = Val(DYNA1.NUMTINC) + 2\n' Real definitions\n\n'NSIM = Val(MCINPUT1.NUMSIM)\n'DIST = Val(MCINPUT1.DSTRENGTH)\nNSITES = 16 ' Number of cracking sites\nNKWRS = 16\n'Re define arrays to match size of number of simulations\nReDim SAMPSTRENGTH(NSIM, NKWRS), Prob(NSIM, NKWRS), IRRSAMPSTRENGTH(NSIM, NKWRS)\nReDim NEWARRAY(2, NKWRS)\nReDim HITTIME(NTIME)\n'NEWARRAY = Array(Data1.dataarray1)\nFor i = 1 To NSIM\n\n   ' Calculate Sample Strength\n   If DIST = \"N\" Then\n\n      For j = 1 To NKWRS\n         HITTIME(0) = 0\n         NHITS = 0\n         Prob(i, j) = Rnd()\n         SAMPSTRENGTH(i, j) = sabNORMINV(Prob(i, j), 27.5653, 1.1777)\n'        SAMPSTRENGTH(i, j) = sabNORMINV(Prob, Val(MCINPUT1.MSTRENGTH), Val(MCINPUT1.SSTRENGTH))\n\n\n         IRRSAMPSTRENGTH(i, j) = SAMPSTRENGTH(i, j) * dataarray1(2, j + 1)\n         For k = 1 To NTIME\n' Maybe put a check in here to see whether keyway root are the same in stress and strength\n            If dataarray0(k + 2, j + 1) &gt; IRRSAMPSTRENGTH(i, j) Then\n               NHITS = NHITS + 1\n               HITTIME(k) = dataarray0(k + 2, 1)\n            Else\n               HITTIME(k) = HITTIME(k - 1)\n            End If\n            If HITTIME(k) = 0 Then\n               GoTo 10\n            ElseIf HITTIME(k) &lt; HITTIME(k - 1) Then\n               HITTIME(j) = HITTIME(k)\n            Else\n            End If\n10       Next\n      Next\n   Else\n      MsgBox \"ERROR - VALUE FOR DISTRIBUTION NOT RECOGNISED\"\n      End\n   End If\nNext\nSet DEST1 = Sheets(\"Sample\").Range(\"B2\").Resize(NSIM + 1, NKWRS + 1)\nSet DEST2 = Sheets(\"Data\").Range(\"B10\").Resize(NSIM + 1, NKWRS + 1)\nDEST1.Value = IRRSAMPSTRENGTH\nDEST2.Value = SAMPSTRENGTH\n\n\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "add", "spreadsheet"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1575452319, "post_id": 59172820, "comment_id": 104567950, "body": "Why are you using separate instances of Excel? That is what is stopping you from copying the sheets."}, {"owner": {"reputation": 1, "user_id": 12084145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P04LU3_3XTA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7hPKKibUwuZLX8UuaYmZgJxiI9w/photo.jpg?sz=128", "display_name": "Oumayma El Jahrani", "link": "https://stackoverflow.com/users/12084145/oumayma-el-jahrani"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1575452739, "post_id": 59172820, "comment_id": 104568185, "body": "I thought it was necessary to create a new file , Removing this part made deleting the new excel file easier , but it still doesn&#39;t permit copying the sheets"}, {"owner": {"reputation": 1, "user_id": 12084145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P04LU3_3XTA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7hPKKibUwuZLX8UuaYmZgJxiI9w/photo.jpg?sz=128", "display_name": "Oumayma El Jahrani", "link": "https://stackoverflow.com/users/12084145/oumayma-el-jahrani"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1575453295, "post_id": 59172820, "comment_id": 104568514, "body": "You&#39;re right but there&#39;s already a sheet in my file so i guessed that copy would add a new sheet and so that&#39;s why for the second one it was sheet(2) etc.. , is there any method to add a sheet ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1575454227, "post_id": 59172820, "comment_id": 104569089, "body": "I didn&#39;t say anything about files. You are starting a completely separate instance of the <b>Excel application</b> and you can&#39;t copy sheets between different application instances. My question is why are you doing that?"}, {"owner": {"reputation": 1, "user_id": 12084145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P04LU3_3XTA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7hPKKibUwuZLX8UuaYmZgJxiI9w/photo.jpg?sz=128", "display_name": "Oumayma El Jahrani", "link": "https://stackoverflow.com/users/12084145/oumayma-el-jahrani"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1575455673, "post_id": 59172820, "comment_id": 104569931, "body": "Because i thought that if you do not have a new App you cannot create a newfile , which i knew was wrong thank&#39;s to you. So now that i know here&#39;s the new lines of code for that part <code>Dim CibleClasseur As Workbook Set CibleClasseur = Workbooks.Add  With CibleClasseur  .Title = &quot;Classeur Cible&quot;  .Subject = &quot;Cible&quot;  .SaveAs Filename:=&quot;C:\\Users\\Oumayna EL JAHRANI\\Desktop\\Test\\ObjetCible.xlsx&quot;  End With</code>  But my code is still not copying the sheets ."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1575457393, "post_id": 59172820, "comment_id": 104570849, "body": "@Oumayma El Jahrani: At what line does your code stop and with what kind of error? Try, please, writing only the line in discussion. Otherwise, we cannot understand anything..."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1575457795, "post_id": 59172820, "comment_id": 104571048, "body": "@Oumayma El Jahrani: Is <code>Sheets(Publi&#233;)</code> activated? If not, you must use <code>ClasseurType.Sheets(Publi&#233;).Copy</code>."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1575460456, "creation_date": 1575460456, "answer_id": 59175438, "question_id": 59172820, "link": "https://stackoverflow.com/questions/59172820/creating-a-workbook-then-adding-sheets-from-another-workbook/59175438#59175438", "title": "Creating a workbook then adding sheets from another workbook", "body": "<p>I believe your code should look like this:</p>\n\n<pre><code>Sub Parametrage()\n'This is the workbook i need to copy sheets from , i chose to store those sheets in variable because i may need them later\n\nDim ClasseurType As Workbook: Set ClasseurType = Workbooks.Open(\"C:\\Users\\Oumayna EL JAHRANI\\Desktop\\Test\\Fichier Type.xlsx\")\nDim Publi\u00e9 As Worksheet: Set Publi\u00e9 = ClasseurType.Worksheets(\"Publi\u00e9\")\nDim Ajustement As Worksheet: Set Ajustement = ClasseurType.Worksheets(\"Ajustement\")\nDim Variables As Worksheet: Set Variables = ClasseurType.Worksheets(\"Variables\")\nDim Source As Worksheet: Set Source = ClasseurType.Worksheets(\"Source\")\n'Here starts the creation of the new file\nDim CibleClasseur As Workbook\nSet CibleClasseur = Workbooks.Add\n With CibleClasseur\n .Title = \"Classeur Cible\"\n .Subject = \"Cible\"\n .SaveAs Filename:=\"C:\\Users\\Oumayna EL JAHRANI\\Desktop\\Test\\ObjetCible.xlsx\"\n End With\n'Here i add the sheets i want to my new workbook and this is the part i can't get to execute\nPubli\u00e9.Copy Before:=CibleClasseur.Sheets(1)\nAjustement.Copy Before:=CibleClasseur.Sheets(2)\nVariables.Copy Before:=CibleClasseur.Sheets(3)\nSource.Copy Before:=CibleClasseur.Sheets(5)\nClasseurType.Close savechanges:=True\n\nEnd Sub\n</code></pre>\n\n<p>It wasn't clear to me which workbook you intended to close at the end.</p>\n"}], "owner": {"reputation": 1, "user_id": 12084145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P04LU3_3XTA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7hPKKibUwuZLX8UuaYmZgJxiI9w/photo.jpg?sz=128", "display_name": "Oumayma El Jahrani", "link": "https://stackoverflow.com/users/12084145/oumayma-el-jahrani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 398, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575460456, "creation_date": 1575452123, "question_id": 59172820, "link": "https://stackoverflow.com/questions/59172820/creating-a-workbook-then-adding-sheets-from-another-workbook", "title": "Creating a workbook then adding sheets from another workbook", "body": "<p>I need a VBA code that could create an excel file with a definite path,name and format , so i wrote these lines of codes : </p>\n\n<pre><code>Sub Parametrage()\n'This is the workbook i need to copy sheets from , i chose to store those sheets in variable because i may need them later \nWorkbooks.Open \"C:\\Users\\Oumayna EL JAHRANI\\Desktop\\Test\\Fichier Type.xlsx\"\nDim ClasseurType As Workbook: Set ClasseurType = ActiveWorkbook\nDim Display As Worksheet: Set Publi\u00e9 = ClasseurType.Worksheets(\"Publi\u00e9\")\nDim Ajustements As Worksheet: Set Ajustement = ClasseurType.Worksheets(\"Ajustement\")\nDim Variables As Worksheet: Set Variables = ClasseurType.Worksheets(\"Variables\")\nDim Database As Worksheet: Set Source = ClasseurType.Worksheets(\"Source\")\n'Here starts the creation of the new file \nDim CibleApp As New Excel.Application\nDim CibleClasseur As Workbook\nSet CibleClasseur = CibleApp.Workbooks.Add\n With CibleClasseur\n .Title = \"Classeur Cible\"\n .Subject = \"Cible\"\n .SaveAs Filename:=\"C:\\Users\\Oumayna EL JAHRANI\\Desktop\\Test\\ObjetCible.xlsx\"\n End With\n'Here i add the sheets i want to my new workbook and this is the part i can't get to execute \nSheets(Publi\u00e9).Copy Before:=Workbooks(CibleClasseur).Sheets(1)\nSheets(Ajustement).Copy Before:=Workbooks(CibleClasseur).Sheets(2)\nSheets(Variables).Copy Before:=Workbooks(CibleClasseur).Sheets(3)\nSheets(Source).Copy Before:=Workbooks(CibleClasseur).Sheets(5)\nWorkbooks(ClasseurType).Close savechanges:=True\nApplication.Quit\nEnd Sub \n</code></pre>\n\n<p>there are two problems in this code , first of all when i execute it it stops at line 16 , the second problem is that since it creates an xlsx file each time i execute for the second time i have an error at the line where i save the new file and i can't delete the old one afterwards . I want to first be able to execute the whole code and be able to delete the file and close the app if ever the code stops . </p>\n"}, {"tags": ["vba", "ms-access", "combobox"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1575448512, "post_id": 59171798, "comment_id": 104565980, "body": "Probably <i>Exports_imports_Table.ID</i> holds unique values - an ID usually does - thus every record will be unique."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1575448530, "post_id": 59171798, "comment_id": 104565994, "body": "What are you getting? Probably you are using a field that is unique but forces other fields to repeat. Besides, you should post details of clarity. How are your tables? Are you sure there are duplicates?"}, {"owner": {"reputation": 5, "user_id": 8842560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a062b04fe4c1d8e3824a1d94d3c9c570?s=128&d=identicon&r=PG&f=1", "display_name": "natali", "link": "https://stackoverflow.com/users/8842560/natali"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1575448730, "post_id": 59171798, "comment_id": 104566080, "body": "@Gustav of corse ID is unique but the value of content is not, I need to display just unique values of content not unique record"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1575449155, "post_id": 59171798, "comment_id": 104566259, "body": "You should be able to figure out the paradox and how to solve it."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8842560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a062b04fe4c1d8e3824a1d94d3c9c570?s=128&d=identicon&r=PG&f=1", "display_name": "natali", "link": "https://stackoverflow.com/users/8842560/natali"}, "edited": false, "score": 0, "creation_date": 1575449262, "post_id": 59171900, "comment_id": 104566315, "body": "I can&#39;t write this because of the event written Automatically by Access (after you add a combo box you should detect from any table will take its values then the event will be written) even that I tried to wite your code in VBA editor (in event onClick) but it appears in red color and editor reject it"}, {"owner": {"reputation": 5, "user_id": 8842560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a062b04fe4c1d8e3824a1d94d3c9c570?s=128&d=identicon&r=PG&f=1", "display_name": "natali", "link": "https://stackoverflow.com/users/8842560/natali"}, "edited": false, "score": 0, "creation_date": 1575450002, "post_id": 59171900, "comment_id": 104566720, "body": "the same code in your comment. also, I try to write in row source  (place of automatically event witten&gt;&gt; it gives me empty values (maybe because there is no ID in the event)"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 5, "user_id": 8842560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a062b04fe4c1d8e3824a1d94d3c9c570?s=128&d=identicon&r=PG&f=1", "display_name": "natali", "link": "https://stackoverflow.com/users/8842560/natali"}, "edited": false, "score": 2, "creation_date": 1575450057, "post_id": 59171900, "comment_id": 104566744, "body": "I did not give you code, I gave you a SELECT statement. The SELECT statement is a string that you use within your &quot;code&quot;."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1575448554, "creation_date": 1575448554, "answer_id": 59171900, "question_id": 59171798, "link": "https://stackoverflow.com/questions/59171798/view-unique-values-in-combobox-using-vba-in-ms-access/59171900#59171900", "title": "view unique values in Combobox using VBA in MS Access", "body": "<p>Assuming the ID field is a unique value (and the content field may have duplicates) you cannot include it in a DISTINCT. Try it like this</p>\n\n<pre><code>SELECT DISTINCT Exports_imports_Table.content FROM Exports_imports_Table;\n</code></pre>\n\n<p>Does that give you what you expect?</p>\n"}], "owner": {"reputation": 5, "user_id": 8842560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a062b04fe4c1d8e3824a1d94d3c9c570?s=128&d=identicon&r=PG&f=1", "display_name": "natali", "link": "https://stackoverflow.com/users/8842560/natali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575448669, "creation_date": 1575448145, "last_edit_date": 1575448669, "question_id": 59171798, "link": "https://stackoverflow.com/questions/59171798/view-unique-values-in-combobox-using-vba-in-ms-access", "title": "view unique values in Combobox using VBA in MS Access", "body": "<p>please read my question to end because I test all previous solutions in Stackoverflow and have no answer.\nI am trying to display Combobox in the form of an MS Access database using VBA, this Combobox takes its values from one table the problem that I can't display just unique values, Combobox views all values even when I use DISTINCT still view all.\nalso, I am trying to use GROUP BY but not work.\nI know it is a simple problem but how can I solve it?</p>\n\n<pre><code>SELECT DISTINCT Exports_imports_Table.ID, Exports_imports_Table.content FROM Exports_imports_Table;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 12112903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb73713df3e5fcc546547a2ce0e79cc?s=128&d=identicon&r=PG&f=1", "display_name": "Roguen", "link": "https://stackoverflow.com/users/12112903/roguen"}, "edited": false, "score": 0, "creation_date": 1575443406, "post_id": 59170495, "comment_id": 104563827, "body": "It is taking only the first set value. I need the next set of number to sum and place in the next blank cell and so on"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 17, "user_id": 12112903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb73713df3e5fcc546547a2ce0e79cc?s=128&d=identicon&r=PG&f=1", "display_name": "Roguen", "link": "https://stackoverflow.com/users/12112903/roguen"}, "edited": false, "score": 0, "creation_date": 1575444200, "post_id": 59170495, "comment_id": 104564139, "body": "@Roguen, the idea is fine. Be thankful someone took time to help you out. Think about how you can add upon the code yourself, how you can work with this sort of code to accomplish what you need. After all, the body of your question is very marginal."}, {"owner": {"reputation": 17, "user_id": 12112903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb73713df3e5fcc546547a2ce0e79cc?s=128&d=identicon&r=PG&f=1", "display_name": "Roguen", "link": "https://stackoverflow.com/users/12112903/roguen"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575444520, "post_id": 59170495, "comment_id": 104564274, "body": "@JvdV I will take your points in action before asking new questions. Thank you all for the timely response"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1575442614, "creation_date": 1575442614, "answer_id": 59170495, "question_id": 59170406, "link": "https://stackoverflow.com/questions/59170406/add-consecutive-numbers-and-paste-in-blank-cell-using-excel-macro/59170495#59170495", "title": "Add Consecutive numbers and paste in blank cell using excel macro", "body": "<p>This would be incredibly easy with worksheet function <code>SUM</code>, so I'd suggest identical approach, just using it in VBA (macro code):</p>\n\n<pre><code>Sub SumRange()\n    Dim rng As Range\n    ' define range to be summed\n    Set rng = Range(\"A1:A11\")\n    ' sum range in A12\n    Cells(12, 1).Value = Application.WorksheetFunction.Sum(rng)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 1, "creation_date": 1575455113, "post_id": 59170755, "comment_id": 104569626, "body": "@JvdV: Very nice! I work in Excel (VBA) for years but I never  knew that the a range area can be defined in such a way..."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 1, "creation_date": 1575457266, "post_id": 59170755, "comment_id": 104570788, "body": "Thanks @FaneDuru. It&#39;s possible because of the gaps in the data."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 4, "last_activity_date": 1575443791, "creation_date": 1575443791, "answer_id": 59170755, "question_id": 59170406, "link": "https://stackoverflow.com/questions/59170406/add-consecutive-numbers-and-paste-in-blank-cell-using-excel-macro/59170755#59170755", "title": "Add Consecutive numbers and paste in blank cell using excel macro", "body": "<p>For example (as per your sample data):</p>\n\n<pre><code>Sub Test()\n\nDim lr As Long\nDim rng As Range\n\nWith Sheet1 'Change according to your sheets CodeName\n\n    'Get your current range\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    Set rng = .Range(\"A1:A\" &amp; lr).SpecialCells(xlCellTypeConstants)\n\n    'Loop through each section to sum it\n    For Each area In rng.Areas\n        area.Offset(area.Rows.Count).Resize(1).Value = Application.Sum(Area)\n    Next\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8561259, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-055Re7b-4Bg/AAAAAAAAAAI/AAAAAAAABdw/QQQg01unrf8/photo.jpg?sz=128", "display_name": "shrinivas iyer", "link": "https://stackoverflow.com/users/8561259/shrinivas-iyer"}, "is_accepted": false, "score": 0, "last_activity_date": 1575444594, "creation_date": 1575444594, "answer_id": 59170944, "question_id": 59170406, "link": "https://stackoverflow.com/questions/59170406/add-consecutive-numbers-and-paste-in-blank-cell-using-excel-macro/59170944#59170944", "title": "Add Consecutive numbers and paste in blank cell using excel macro", "body": "<p>Try this - </p>\n\n<pre><code>Sub SumRange()\n\n\n    lastrow = Range(\"A1000000\").End(xlUp).Row\n\n    Start = 1\n\n    For Each c In Range(\"A2:A\" &amp; (lastrow + 1)).Cells\n\n    If c = \"\" Then\n\n    c.Select\n\n    ActiveCell = Application.WorksheetFunction.Sum(Range(Cells(Start, 1), Cells(ActiveCell.Offset(-1, 0).Row, 1)))\n    Start = c.Offset(1, 0).Row\n\n\n    '''''Color sum cell in green\n    With Selection\n  With .Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 5296274\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n\nEnd With\n\n\n\n\n\n    End If\n\n    Next\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1575454922, "post_id": 59173728, "comment_id": 104569506, "body": "But @JvdV&#39;s answer is obviously the best!"}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 0, "last_activity_date": 1575454863, "creation_date": 1575454863, "answer_id": 59173728, "question_id": 59170406, "link": "https://stackoverflow.com/questions/59170406/add-consecutive-numbers-and-paste-in-blank-cell-using-excel-macro/59173728#59173728", "title": "Add Consecutive numbers and paste in blank cell using excel macro", "body": "<pre><code>Dim arr As Variant, El As Variant\nDim i As Long, lngSum As Long\n\n  With ActiveSheet\n    arr = .Range(\"A1:A\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row + 1).value\n    For Each El In arr\n        i = i + 1\n        If El &lt;&gt; \"\" Then\n            lngSum = lngSum + El\n        Else\n            .Range(\"A\" &amp; i).value = lngSum\n            .Range(\"A\" &amp; i).Font.Color = vbRed ' just to easier identify the updated cell\n            lngSum = 0\n        End If\n    Next\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 12112903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb73713df3e5fcc546547a2ce0e79cc?s=128&d=identicon&r=PG&f=1", "display_name": "Roguen", "link": "https://stackoverflow.com/users/12112903/roguen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 59170755, "answer_count": 4, "score": 0, "last_activity_date": 1575454863, "creation_date": 1575442253, "last_edit_date": 1575442751, "question_id": 59170406, "link": "https://stackoverflow.com/questions/59170406/add-consecutive-numbers-and-paste-in-blank-cell-using-excel-macro", "title": "Add Consecutive numbers and paste in blank cell using excel macro", "body": "<p>I have set of numbers to be added and placed in the next blank cell. In example <code>A1</code> to <code>A11</code> has to be summed in <code>A12</code>. the same for next set. I want a macro to perform this.</p>\n\n<p><img src=\"https://i.stack.imgur.com/OBYoH.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 1, "creation_date": 1575480050, "post_id": 59170756, "comment_id": 104583872, "body": "Did you test your answer?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1575481012, "post_id": 59170756, "comment_id": 104584405, "body": "@EEM I ran a better test and saw a type-o for Row row/s. I fixed. Thanks."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1575481272, "last_edit_date": 1575481272, "creation_date": 1575443793, "answer_id": 59170756, "question_id": 59170362, "link": "https://stackoverflow.com/questions/59170362/remove-duplicate-based-on-value/59170756#59170756", "title": "Remove duplicate based on value", "body": "<p><strong>Updated After Small Correction (Thanks <a href=\"https://stackoverflow.com/users/4892468/eem\">EEM</a>)</strong></p>\n\n<p>For your first code, you can speed it up quite a bit by performing the deletion all at once at the end. Try this....</p>\n\n<pre><code>Sub RemoveDupl()\nDim WS As Worksheet: Set WS = Sheets(\"Sheet1\")\n\n'to check if the Incident ID has duplicates\nlastRow = WS.Cells(Rows.Count, 6).End(xlUp).Row\n\n\n'loop to check all the rows\nDim aRng As Range\n\nSet aRng = WS.Rows(Rows.Count)\n\nFor i = 2 To lastRow\n    Set rangeIDCheck = WS.Range(\"A:A\")\n        For j = 2 To lastRow\n            If WorksheetFunction.CountIf(rangeIDCheck, WS.Cells(j, 6).Value) &gt; 1 And WS.Cells(j, 15).Value = \"Hello\" And WS.Cells(j, 16).Value = \"1\" Then\n                Rows(j).EntireRow.Delete\n\n                Set aRng = Union(aRng, Rows(j))\n\n            End If\n        Next\nNext\naRng.ClearContents\naRng.Delete\nEnd Sub\n</code></pre>\n\n<p>For your second code, you can get the row as a property. So your code would be written like this:</p>\n\n<pre><code>WorksheetFunction.CountIf(Rng, cel.Value) &gt; 1 And Cells(cel.Row, 15) = \"Hello\"  _ \nAnd Cells(cel.Row, 16) = \"1\" Then\n</code></pre>\n\n<p>Hope that works.</p>\n"}], "owner": {"reputation": 56, "user_id": 5214897, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-a7qsdMqiypM/AAAAAAAAAAI/AAAAAAAAADc/kOnKA0xkx1Q/photo.jpg?sz=128", "display_name": "lukenart", "link": "https://stackoverflow.com/users/5214897/lukenart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1607611772, "creation_date": 1575442059, "last_edit_date": 1607611772, "question_id": 59170362, "link": "https://stackoverflow.com/questions/59170362/remove-duplicate-based-on-value", "title": "Remove duplicate based on value", "body": "<p>I have code that will delete the entire row if such conditions are met:</p>\n<ol>\n<li>ID are duplicate AND</li>\n<li>In the duplicate ID the cond1 = Hello AND</li>\n<li>In the duplicate ID the cond2 = 1</li>\n</ol>\n<p>See sample table below. The highlighted should be deleted.\nThe code is slow thus finding a way to optimize it.</p>\n<p><a href=\"https://i.stack.imgur.com/WRN5z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WRN5z.png\" alt=\"enter image description here\" /></a></p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub RemoveDupl()\n\n    'to check if the Incident ID has duplicates\n    lastRow = Worksheets(&quot;Sheet1&quot;).Cells(Rows.Count, 6).End(xlUp).Row\n    \n    'loop to check all the rows\n    For i = 2 To lastRow\n        Set rangeIDCheck = Range(&quot;A:A&quot;)\n        For j = 2 To lastRow\n            If WorksheetFunction.CountIf(rangeIDCheck, Worksheets(&quot;Sheet1&quot;).Cells(j, 6).Value) &gt; 1 And Worksheets(&quot;Sheet1&quot;).Cells(j, 15).Value = &quot;Hello&quot; And Worksheets(&quot;Sheet1&quot;).Cells(j, 16).Value = &quot;1&quot; Then\n                Rows(j).EntireRow.Delete\n            End If\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n<p>My second code. I only need how to get the current row number. I searched but got nothing. Enclosed in * is the one I need to be replaced.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub RemoveDupl()\n        \n    'turning off\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.Calculation = xlCalculationManual\n\n    Dim Rng As Range\n    Dim cel As Range\n    Dim Counter As Integer\n\n    Set Rng = Range(Range(&quot;A1&quot;), Range(&quot;A&quot; &amp; Rows.Count).End(xlUp))\n        \n    For Each cel In Rng\n        If WorksheetFunction.CountIf(Rng, cel.Value) &gt; 1 And Cells(**Rng.Row**, 15) = &quot;Hello&quot; And Cells(**Rng.Row**, 16) = &quot;1&quot; Then\n            cel.EntireRow.Delete\n            'cel.EntireRow.Interior.Color = 5296274\n        End If\n    Next cel\n\n    'turning on\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.Calculation = xlCalculationAutomatic\n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12477723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OHYphDLJDUY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHfLuncH1pfeahZrcl9bZqls6Asw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/12477723/john-smith"}, "edited": false, "score": 0, "creation_date": 1575437195, "post_id": 59169362, "comment_id": 104561932, "body": "Thank you! This worked for my date fields. How would I make it work for fields where I have numbers, letters, and special characters? For example: I have a reference number field where the inputs look like this --&gt; #H392"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 1, "user_id": 12477723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OHYphDLJDUY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHfLuncH1pfeahZrcl9bZqls6Asw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/12477723/john-smith"}, "edited": false, "score": 0, "creation_date": 1575437301, "post_id": 59169362, "comment_id": 104561961, "body": "Then do it the way you did it with the single quotes. Those are used for string fields, which is what you are describing. The only exception is if your string value has a single quote in it, then you have to change that single quote to 2 single quotes."}, {"owner": {"reputation": 1, "user_id": 12477723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OHYphDLJDUY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHfLuncH1pfeahZrcl9bZqls6Asw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/12477723/john-smith"}, "edited": false, "score": 0, "creation_date": 1575438114, "post_id": 59169362, "comment_id": 104562176, "body": "It doesn&#39;t seem to work for any fields that include numbers. Thank you for the help with the Date fields. That is huge!"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 1, "user_id": 12477723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OHYphDLJDUY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHfLuncH1pfeahZrcl9bZqls6Asw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/12477723/john-smith"}, "edited": false, "score": 0, "creation_date": 1575438190, "post_id": 59169362, "comment_id": 104562202, "body": "It works like that for everyone else. Maybe your field that has numbers is defined as a string by mistake."}, {"owner": {"reputation": 1, "user_id": 12477723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OHYphDLJDUY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHfLuncH1pfeahZrcl9bZqls6Asw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/12477723/john-smith"}, "edited": false, "score": 2, "creation_date": 1575439475, "post_id": 59169362, "comment_id": 104562572, "body": "I changed the fields from longtext to shorttext and it is working now! Thank you so much!"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 3, "last_activity_date": 1575436622, "creation_date": 1575436622, "answer_id": 59169362, "question_id": 59169277, "link": "https://stackoverflow.com/questions/59169277/how-can-i-get-this-code-to-work-for-mixed-character-number-or-date-fields/59169362#59169362", "title": "How can I get this code to work for mixed character/number or date fields?", "body": "<p>Assuming <code>[Amount]</code> is numeric, you cannot put single quotes around it... It should look like this:</p>\n\n<pre><code>([Amount] = \" &amp; Me.cboAmount &amp; \")\"\n</code></pre>\n\n<p>if it's a date field, then you use the <code>#</code> sign:</p>\n\n<pre><code>([MyDate] = #\" &amp; Me.DateBox &amp; \"#)\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12477723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OHYphDLJDUY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHfLuncH1pfeahZrcl9bZqls6Asw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/12477723/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575436743, "creation_date": 1575436038, "last_edit_date": 1575436743, "question_id": 59169277, "link": "https://stackoverflow.com/questions/59169277/how-can-i-get-this-code-to-work-for-mixed-character-number-or-date-fields", "title": "How can I get this code to work for mixed character/number or date fields?", "body": "<p>I don't really know anything about coding, but found this useful code on a forum, but it's not working for any fields that have numbers or dates. I need the code to work for fields that have numbers and characters mixed and also for date fields. Any help would be appreciated. Here is the code:</p>\n\n<pre><code>Private Sub cboAmount_AfterUpdate()\nDim myAmount As String\nmyAmount = \"Select * from Records where ([Amount] = '\" &amp; Me.cboAmount &amp; \"')\"\nMe.Records_subform.Form.RecordSource = myAmount\nMe.Records_subform.Form.Requery\nEnd Sub\n</code></pre>\n\n<p>Basically I have a search form that populates the search results in the attached subform so that searched records can be edited quickly from the search form. </p>\n"}, {"tags": ["excel", "vba", "sharepoint", "directory", "mkdir"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1575435289, "post_id": 59168797, "comment_id": 104561448, "body": "<code>\\\\pplanners.sharepoint.com\\sites\\PP\\Shared Documents\\PP WIP\\a Macros</code> might work"}, {"owner": {"reputation": 401, "user_id": 4282505, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QINBocucoTk/AAAAAAAAAAI/AAAAAAAAABw/7KoGct0mpv8/photo.jpg?sz=128", "display_name": "Jaynesh Sharma", "link": "https://stackoverflow.com/users/4282505/jaynesh-sharma"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1575445953, "post_id": 59168797, "comment_id": 104564858, "body": "you need to verify whether WEBDEV is enabled or not(server). and web client services in client Machine  to access the SharePoint as network path. as mention @TimWilliams you use  path dir (\\&#41;. if didn&#39;t  work slight chances it will not work. bcz its need authentication  i will recommended to  use  SharePoint  code and upload. <a href=\"https://stackoverflow.com/questions/468469/how-do-you-upload-a-file-to-a-document-library-in-sharepoint\" title=\"how do you upload a file to a document library in sharepoint\">stackoverflow.com/questions/468469/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 12476583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/614400f7def7f98849129bd46b132c42?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Forer", "link": "https://stackoverflow.com/users/12476583/simon-forer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 467, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1575432424, "creation_date": 1575432424, "question_id": 59168797, "link": "https://stackoverflow.com/questions/59168797/how-do-i-use-dir-and-mkdir-and-reference-sharepoint", "title": "How do I use Dir and Mkdir and reference Sharepoint?", "body": "<p>I have Excel VBA code that sends data to a word template (saves a docx and pdf file).\nThe code then sends the pdf as an email via outlook.</p>\n\n<p>It all works perfectly on my local drive, but opening, checking and saving folders and files to sharepoint has beaten me. I've spent hours searching and experimenting....there seems to be some conflicting ports (mainly on other forums).</p>\n\n<p>Surely I'm not alone here....</p>\n\n<p>Code that works on my local drive is:</p>\n\n<pre><code>thefilepath = Application.ActiveWorkbook.Path\nSet wrdDoc = wrdApp.Documents.Open(thefilepath &amp; \"\\Letter Template.docx\", ReadOnly:=True)\nstrFolderPath = thefilepath &amp; \"\\Results\"\nCheckDir (strFolderPath)\n\n\n&lt;Run code&gt;\n\nwrdDoc.SaveAs thefilepath &amp; \"\\Results\\\" &amp; thefilename &amp; \".doc\"\nwrdDoc.ExportAsFixedFormat OutputFileName:=thefilepath &amp; \"\\Results\\\" &amp; thefilename &amp; \".pdf\", ExportFormat:=wdExportFormatPDF\n\nFunction CheckDir(Path As String)\nIf Dir(Path, vbDirectory) = \"\" Then\nMkDir (Path)\nEnd If\nEnd Function\n</code></pre>\n\n<p>Problems\u2026</p>\n\n<ul>\n<li><p>Thefilepath is not accurate\u2026..returns \u201cC:\\Users\\sf\\PP\\WIP\\a Macros\u201d</p></li>\n<li><p>I\u2019m struggling to create the \u201cresults\u201d subfolder</p></li>\n<li><p>Docx and PDF naming is giving me errors.</p></li>\n</ul>\n\n<p>My excel file is in </p>\n\n<p><code>thisdir = https://pplanners.sharepoint.com/sites/PP/Shared Documents/PP WIP/a Macros</code></p>\n\n<p>I want to save my docx and pdf files to thisdir &amp; \"/results\" Ie.</p>\n\n<p><code>resultsdir = https://pplanners.sharepoint.com/sites/PP/Shared Documents/PP WIP/a Macros/results</code></p>\n\n<p>So to test if the results subdirectory exists I've tried....</p>\n\n<p><code>If Dir(\"/pplanners.sharepoint.com/sites/PP/Shared%20Documents/PP%20WIP/a%20Macros/results\", vbDirectory) = \"\" Then</code></p>\n\n<p><code>If Dir(\"//pplanners.sharepoint.com/sites/PP/Shared%20Documents/PP%20WIP/a%20Macros/results\", vbDirectory) = \"\" Then</code></p>\n\n<p><code>If Dir(\"https://pplanners.sharepoint.com/sites/PP/Shared%20Documents/PP%20WIP/a%20Macros/results\", vbDirectory) = \"\" Then</code></p>\n\n<p>But nothing seems to work</p>\n\n<p>Similarly, for MkDir, I\u2019ve tried </p>\n\n<p><code>MkDir \"https://pplanners.sharepoint.com/sites/PP/Shared%20Documents/PP%20WIP/a%20Macros/Results\"</code></p>\n\n<p><code>MkDir \"//pplanners.sharepoint.com/sites/PP/Shared%20Documents/PP%20WIP/a%20Macros/Results\"</code></p>\n\n<p><code>MkDir \"/pplanners.sharepoint.com/sites/PP/Shared%20Documents/PP%20WIP/a%20Macros/Results\"</code></p>\n\n<p><code>MkDir \"https://pplanners.sharepoint.com/sites/PP/Shared%20Documents/PP%20WIP/a%20Macros/Results\"</code></p>\n\n<p><code>MkDir \"//pplanners.sharepoint.com/sites/PP/Shared%20Documents/PP%20WIP/a%20Macros/Results\"</code></p>\n\n<p><code>MkDir \"/pplanners.sharepoint.com/sites/PP/Shared%20Documents/PP%20WIP/a%20Macros/Results\"</code></p>\n\n<p>Handy code that I\u2019ve used to tweak name so far is:</p>\n\n<pre><code>tr = ThisWorkbook.Path\ntr2 = Replace(Replace(tr, \"http:\", \"\"), \"/\", \"\\\")\ntr3 = Replace(tr2, \" \", \"%20\")\n</code></pre>\n\n<p>Hoping to get some discussion going on file and folder management with sharepoint.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1575429517, "post_id": 59168439, "comment_id": 104560235, "body": "You dont want to put <code>ThisWorkbook.Sheets(&quot;Data&quot;).Range(&quot;K4&quot;)</code> inside of quotes - it becomes a literal string then instead of the value of the objects that you want. Frankly, i&#39;m surprised it even compiles like that."}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575430446, "post_id": 59168439, "comment_id": 104560427, "body": "Im very new to VBA coding so im probably doing everything wrong. I some changes. If I set Size to &quot; Range(&quot;K4&quot;).Value&quot; would it work? I keep getting a Subscript out of Range error"}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575431669, "post_id": 59168439, "comment_id": 104560666, "body": "I took away the quotes and its still giving me a Subscript out of Range Error"}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575432917, "post_id": 59168439, "comment_id": 104560928, "body": "I think thats it. When I step through once I get to Size it still has a value of 0, am I doing something wrong?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575433405, "post_id": 59168861, "comment_id": 104561025, "body": "I got it to set a Size but its gave me a Subscript out of Range Error on the last line"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575433514, "post_id": 59168861, "comment_id": 104561050, "body": "Comment out the <code>Workbooks(&quot;Tournament Master Format 36.xls&quot;).Sheets(&quot;Size&quot;).Range(&quot;A1:AO311&quot;).Copy_          ThisWorkbook.Sheets(&quot;Sheet4&quot;).Range (&quot;A1&quot;)</code> line and try <code>Debug.Print Size</code> to see the value of Size"}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575433686, "post_id": 59168861, "comment_id": 104561081, "body": "Where is it supposed to print? The code ran and nothing happened"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575433736, "post_id": 59168861, "comment_id": 104561097, "body": "In the VBA Editor, go to View &gt; Immediate Window, and once you see the Immediate Window, run the code again."}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575433811, "post_id": 59168861, "comment_id": 104561114, "body": "got it. It returned 20, which is what its supposed to be"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575433907, "post_id": 59168861, "comment_id": 104561138, "body": "So what you&#39;re saying is that you want to copy cells from a sheet called 20? Or is the 20 referring to the index (position) of the sheet?"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575434062, "post_id": 59168861, "comment_id": 104561164, "body": "Since we have defined Size as being a String, it&#39;s looking for a sheet named 20, not the sheet with an index of 20."}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575434123, "post_id": 59168861, "comment_id": 104561184, "body": "The Sheet name is 20. When I replace &quot;Size&quot; with &quot;20&quot; it works"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575434209, "post_id": 59168861, "comment_id": 104561201, "body": "ok, then use <code>Size = CStr(Workbooks(&quot;Scheduling Test Template.xlsx&quot;).Sheets(&quot;Data&quot;).Range(&quot;K4&quot;).Value)</code>"}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575434441, "post_id": 59168861, "comment_id": 104561266, "body": "It copied the sheet for 14 (20th sheet)"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575434547, "post_id": 59168861, "comment_id": 104561297, "body": "Okay, first do <code>Dim Size as String</code>, then <code>Workbooks(&quot;Tournament Master Format 36.xls&quot;).Sheets(Size &amp; &quot;&quot;).Range(&quot;A1:AO311&quot;).Copy_</code> etc, and try it with and without the <code>CStr</code> code I suggested in the previous comment."}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575434796, "post_id": 59168861, "comment_id": 104561331, "body": "Error saying &quot;Object doesnt Support this Property or Method&quot;"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575434904, "post_id": 59168861, "comment_id": 104561353, "body": "Try it with only <code>Sheets(Size)</code> instead of <code>Sheets(Size &amp; &quot;&quot;)</code>. It&#39;s so weird one of these should definitely work. Also which line is throwing an error?"}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575435135, "post_id": 59168861, "comment_id": 104561408, "body": "Same Error. Its that last line still. I made some changes to the code so it will loop through several sizes, Ill edit the original post so you can see if something there is messing it up"}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575435539, "post_id": 59168861, "comment_id": 104561504, "body": "Its Updated Now"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575435713, "post_id": 59168861, "comment_id": 104561553, "body": "Yeah to be honest I don&#39;t see what may be going wrong, can you confirm that inputting &quot;20&quot; instead of Size still works?"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575435766, "post_id": 59168861, "comment_id": 104561561, "body": "Wait if Size is a String, you can&#39;t check <code>If Size &gt; 0</code>"}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575435936, "post_id": 59168861, "comment_id": 104561616, "body": "I commented out the If Statement. I replaced size with &quot;20&quot; and it gave me the same error this time. I dont understand its the same as it was before now?"}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575436135, "post_id": 59168861, "comment_id": 104561664, "body": "So I got rid of the _ after Copy and put it all on the same line and it worked."}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575436174, "post_id": 59168861, "comment_id": 104561672, "body": "Okay that&#39;s sweet!"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575436265, "post_id": 59168861, "comment_id": 104561696, "body": "Would love it if you could mark this answer as being the best answer if this has been helpful. I&#39;ll finally get enough Reputation to comment on the question and others&#39; answers hahaha"}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575436399, "post_id": 59168861, "comment_id": 104561732, "body": "Sure Thing! Thanks for the help"}, {"owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575439134, "post_id": 59168861, "comment_id": 104562466, "body": "So everything with that is working fine. But now I have a new Problem. the original workbook has all the templates in it. One of the formulas in the template is supposed to use data from one of the sheets once its copied to the second workbook. but onec its in the second workbook but it trys to point to the original workbook"}, {"owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "reply_to_user": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "edited": false, "score": 0, "creation_date": 1575439165, "post_id": 59168861, "comment_id": 104562476, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/203569/discussion-between-puravthegreat-and-spenser1235yahoocom\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 136, "user_id": 2790342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfd13510122d7b2f5216ef4faa38f0b?s=128&d=identicon&r=PG&f=1", "display_name": "PuravTheGreat", "link": "https://stackoverflow.com/users/2790342/puravthegreat"}, "is_accepted": true, "score": 3, "last_activity_date": 1575433373, "last_edit_date": 1575433373, "creation_date": 1575433018, "answer_id": 59168861, "question_id": 59168439, "link": "https://stackoverflow.com/questions/59168439/choose-worksheet-based-on-cell-value/59168861#59168861", "title": "Choose Worksheet based on Cell Value", "body": "<p>I can't comment because I don't have enough reputation, but try using <code>Debug.Print Size</code> and see if this is the correct value of Size. If it is the correct value, now check whether there exists a sheet with the same value as <code>Size</code>. </p>\n\n<p>Also, I would recommend against using <code>.Activate</code> and instead using:</p>\n\n<pre><code>Size = Workbooks(\"Scheduling Test Template.xlsx\").Sheets(\"Data\").Range(\"K4\").Value\n</code></pre>\n\n<p>Ps. If you comment under this answer, I will be able to join the conversation with you and braX. </p>\n"}], "owner": {"reputation": 43, "user_id": 12477404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJFKDVnssdA/AAAAAAAAAAI/AAAAAAAAAAA/JWjl1uKxu4s/photo.jpg?sz=128", "display_name": "spenser1235yahoocom", "link": "https://stackoverflow.com/users/12477404/spenser1235yahoocom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 59168861, "answer_count": 1, "score": 4, "last_activity_date": 1575435303, "creation_date": 1575429250, "last_edit_date": 1575435303, "question_id": 59168439, "link": "https://stackoverflow.com/questions/59168439/choose-worksheet-based-on-cell-value", "title": "Choose Worksheet based on Cell Value", "body": "<p>Using Excel 365. \nI am trying to copy a sheet from a template in \"Tournament Master Format 36.xls\" (All tabs are numbers based on how many teams are in the bracket) based on the number of teams from ThisWorkbook sheet Data, Cell K4.</p>\n\n<pre><code>Sub CopyPaste()\n\n    Dim Size As String\n\n    Size = \"ThisWorkbook.Sheets(\"Data\").Range(\"K4\")\"\n\n    Workbooks(\"Tournament Master Format 36.xls\").Sheets(Size).Range(\"A1:AO311\").Copy _\n    ThisWorkbook.Sheets(\"Sheet4\").Range(\"A1\") \n\nEnd Sub\n</code></pre>\n\n<p>Updated Code:</p>\n\n<pre><code>Sub CopyPaste()\n\nDim Size As String\nDim i As Integer\nDim SheetNum As String\nDim ws As Worksheet\n\n    Workbooks(\"Scheduling Test Template.xlsx\").Sheets(\"Data\").Activate\n\nFor i = 2 To 10\n    'Size = Cells(i, 11).Value\n    Size = CStr(Workbooks(\"Scheduling Test \n    Template.xlsx\").Sheets(\"Data\").Range(\"K4\").Value)\n\n    'SheetNum = CStr(Cells(i, 10)) + \" &amp; Under\"\n    SheetNum = i\n    Debug.Print Size\n\n    If Size &gt; 0 Then\n        Set ws = \n\n    ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets\n    (ThisWorkbook.Sheets.Count))\n        ws.Name = SheetNum\n\n        Workbooks(\"Tournament Master Format 36.xls\").Sheets(Size)\n        .Range(\"A1:AO311\").Copy ThisWorkbook.Sheets(SheetNum).Range (\"A1\")\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1575424401, "post_id": 59167810, "comment_id": 104559116, "body": "Are you asking how to declare variables (use the <code>Dim</code> keyword) to satisfy <code>Option Explicit</code>, or you&#39;re asking how to split a string at a specific character index? Is <code>.Value</code> the <code>&quot;20191204...&quot;</code> string or the <code>&quot;hometmastresh_...&quot;</code> string? Please <a href=\"https://stackoverflow.com/posts/59167810/edit\">edit</a> your post to clarify"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1575424829, "post_id": 59167810, "comment_id": 104559202, "body": "hi @MathieuGuindon sorry if i was not clear, i am asking how to split a string at a specific character index yes, but i added in the first code that uses mid function because i prefer to use it instead of split function so if anyone could advice me on how to satisfy option explicit for the first code and get it to work, it would be great , because i have to use paragraphs of split and replace to achieve the result i want. If you have a way for the split function, please feel free to share! any small contribution might end up helping me!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575425615, "post_id": 59167810, "comment_id": 104559379, "body": "<code>without writing paragraphs of coding which slows down the program...</code> Your approach is inefficient. Use <code>.Find</code> and <code>.FindNext</code> to search for &quot;hometmastresh_enciivedexter&quot; and then do the relevant action on that cell. <a href=\"http://www.siddharthrout.com/index.php/2018/01/05/find-and-findnext-in-excel-vba/\" rel=\"nofollow noreferrer\">THIS</a> will get you started."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "edited": false, "score": 0, "creation_date": 1575428482, "post_id": 59167810, "comment_id": 104560030, "body": "Hi thanks for the link! i tried using this code  <code>&#39;Dim strSearch As String     &#39;Dim aCell As Range           &#39;strSearch =  &quot;hometmastresh_enciivedexter&quot;           &#39;Set aCell = wks.Cells(BlankRow, 7).Find(What:=strSearch, LookIn:=xlFormulas, _     &#39;LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _     &#39;MatchCase:=False, SearchFormat:=False)           &#39;If Not aCell Is Nothing Then      &#39;   aCell.Formula = Replace(aCell.Formula, strSearch, &quot;&quot;)     &#39;End If </code> with this code, i am still getting &quot;01tresh_tepoots20191204756890tepootFile&quot; but i only need  &quot;20191204756890&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575428700, "post_id": 59167810, "comment_id": 104560067, "body": "@SiddharthRout could you advice me on what is the next step to remove &quot;01tresh_teapoots&quot; and &quot;tepootFile&quot; and only get the date in between them with a more efficient code and how can i add a space in between the date &quot;20191204756890&quot; to become &quot;20191204 756890&quot;, all in the same row. its similar to this <a href=\"https://stackoverflow.com/questions/31996833/excel-vba-code-mid-function/31997073#31997073\">VBA code Mid Function</a> 2nd question but i can&#39;t seem to implement it into my main code..."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "edited": false, "score": 0, "creation_date": 1575442418, "post_id": 59168776, "comment_id": 104563469, "body": "Thanks for the answer! but i have no idea how to declare these variables so that option explicit will be satisfied in my code...  the <code>.Value</code> part keeps getting <code>complie error:Method or data member not found</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1575442590, "post_id": 59168776, "comment_id": 104563528, "body": "Well it&#39;s inside your <code>With cell...End With</code> block , so the <code>.Value</code> belongs to <code>cell</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1575432245, "creation_date": 1575432245, "answer_id": 59168776, "question_id": 59167810, "link": "https://stackoverflow.com/questions/59167810/vba-how-to-use-mid-function-in-option-explicit/59168776#59168776", "title": "VBA How to use mid function in option explicit", "body": "<p>Use Left/Right to get the ends of the string and concatenate them with a space</p>\n\n<pre><code>Dim v As String\n'...\n'...\nIf CodeExists &gt; 0 Then\n    v = Mid(.Value, CodeExists + 18, 3)\n    .Value = Left(v, 8) &amp; \" \" &amp; Right(v, 6)\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "edited": false, "score": 0, "creation_date": 1575441523, "post_id": 59168933, "comment_id": 104563178, "body": "Thanks it works!, but only if i specify the full string.May i know how can i use split without specifying the name/string? because i have a loop which goes through a folder and gets these strings from many files so i can&#39;t specify the exact string out, also the format of the string will always be the same , the only variable that will change is the numbers &quot;01&quot; and &quot;20191204756890&quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575441789, "post_id": 59168933, "comment_id": 104563261, "body": "Will this <code>&quot;01tresh_tepoots20191204756890tepootFile&quot;</code> be like <code>&quot;01tresh_tepootsXXXXXXXXXXXXXXtepootFile&quot;</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "edited": false, "score": 0, "creation_date": 1575442142, "post_id": 59168933, "comment_id": 104563379, "body": "it will be like <code>&quot;hometmastresh_enciivedexterXXtresh_tepootsXXXXXXXXXXXXXXepo&zwnj;&#8203;otFile&quot;</code> with 2 parts unknown , sometimes it might appear as <code>&quot;hometmastresh_enciivedexterXXtresh_tepootsXXXXXXXXXXXXXXtep&zwnj;&#8203;ootFile.dump&quot;</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575442848, "post_id": 59168933, "comment_id": 104563621, "body": "Than simply use <code>s = Split(aCell.Value, &quot;tepoot&quot;)(1)</code> Where <code>aCell</code> you will get from <code>.Find</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575448617, "post_id": 59168933, "comment_id": 104566032, "body": "Can you update the question with new code that you are using? It is difficult read the code in the comment"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575448731, "post_id": 59168933, "comment_id": 104566081, "body": "Nope there is no confusion. I understand your question correctly. Simply update your question with the new code that you are using."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "edited": false, "score": 0, "creation_date": 1575451572, "post_id": 59168933, "comment_id": 104567534, "body": "Hi siddharth, it works perfectly! thank you so much! can i please ask one last question? how do i add a space into <code>&quot;20191204756890&quot;</code> to become <code>&quot;20191204 756890&quot;</code>? because i have used your code and modified the values <code>If Not aCell Is Nothing Then     s = Split(aCell.Value, &quot;tepoots&quot;)(1)     s = Mid(s, 1, 14) &amp; &quot; &quot; &amp; Right(s, 0)     aCell.Value = s End If</code>  however it does not add a space into it because when 20191204756890 is keyed into excel, it will be converted to E.G 2.0e12 and that happened to me, meaning the space was not added. i&#39;m not sure why it wasn&#39;t added in..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1575451756, "post_id": 59168933, "comment_id": 104567622, "body": "<code>&amp; Right(s, 0)</code> Why do you have a <code>0</code> there? I think you may want to read up how RIGHT/LEFT/MID works :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "edited": false, "score": 0, "creation_date": 1575511727, "post_id": 59168933, "comment_id": 104594432, "body": "i read up about how they work and seems like just using <code>s = Mid(s, 1, 14)  &amp;  &quot; &quot; </code> works! but the space is still not appearing... i tried using numberformat <code>wks.Cells(BlankRow, 7).NumberFormat = &quot;0&quot;</code>and it is able to convert it into <code>20190302041640</code> from <code>2.01903E+13</code> but   is there any other way i can straight convert <code>20190302041640</code> to this date format E.g 2019 March 02 13:30pm? because my main purpose is to change this string into a date format .once again thank you so much for helping!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575513171, "post_id": 59168933, "comment_id": 104594713, "body": "The reason why I asked is becuase you were to use <code>Right(s, 6)</code> and not <code>Right(s, 0)</code> ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "edited": false, "score": 0, "creation_date": 1575516313, "post_id": 59168933, "comment_id": 104595371, "body": "Oh i see , i tried using <code>s = Mid(s , 1 ,8 ) &amp; &quot; &quot; &amp; Right(s, 6)</code>and i got <code>20190302 otFile</code>, is my understanding of Mid and Right Function wrong? i&#39;m confused now shouldn&#39;t it get the rest of the numbers after the space?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575518226, "post_id": 59168933, "comment_id": 104595795, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/203636/discussion-between-siddharth-rout-and-lalalisa\">continue this discussion in chat</a>."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1575518751, "post_id": 59168933, "comment_id": 104595915, "body": "can you join me in the chat above?"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1575450448, "last_edit_date": 1575450448, "creation_date": 1575433444, "answer_id": 59168933, "question_id": 59167810, "link": "https://stackoverflow.com/questions/59167810/vba-how-to-use-mid-function-in-option-explicit/59168933#59168933", "title": "VBA How to use mid function in option explicit", "body": "<blockquote>\n  <p>i am still getting \"01tresh_tepoots20191204756890tepootFile\"</p>\n</blockquote>\n\n<p>So after you have got the text using <code>.Find</code>, you can use <code>Split</code>. For example</p>\n\n<pre><code>Dim s As String\n\ns = Split(\"01tresh_tepoots20191204756890tepootFile\", \"tepoot\")(1)\ns = Mid(s, 2, 8) &amp; \" \" &amp; Right(s, 6)\nDebug.Print s\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>Your code</p>\n\n<pre><code>If Not aCell Is Nothing Then\n    aCell.Formula = Replace(aCell.Formula, , \"\")\n    s = Split(aCell.Value, \"tepoots\")(1)\nEnd If\n</code></pre>\n\n<p>should be as shown below. This will put \"20191204 756890\" or whatever the number is in the cell.</p>\n\n<pre><code>If Not aCell Is Nothing Then\n    s = Split(aCell.Value, \"tepoots\")(1)\n    s = Mid(s, 2, 8) &amp; \" \" &amp; Right(s, 6)\n    aCell.Value = s\nEnd If\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12326522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 59168933, "answer_count": 2, "score": 0, "last_activity_date": 1575594734, "creation_date": 1575423881, "last_edit_date": 1575594734, "question_id": 59167810, "link": "https://stackoverflow.com/questions/59167810/vba-how-to-use-mid-function-in-option-explicit", "title": "VBA How to use mid function in option explicit", "body": "<p>I have a code , it loops through the destinated folder and every single file in the folder.</p>\n\n<p>i have 2 questions</p>\n\n<p>1) how can i modify this code and add it into my main code so that it would work without having compile error for not declaring the variables </p>\n\n<pre><code>For Each cell In Range(\"B1\", Cells(Rows.count, \"B\").End(xlUp))\n   With cell\n       CodeExists = InStr(1, .Value, \"testflow\")\n       'Check that \"Code:\" exists\n       If CodeExists &gt; 0 Then\n           .Value = Mid(.Value, CodeExists + 18, 3)\n       End If\n   End With\nNext  \n</code></pre>\n\n<p>2) if question 1 can't be done, </p>\n\n<pre><code>wks.Cells(BlankRow, 6).Replace What:=\"hometmastresh\", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n</code></pre>\n\n<pre><code>wks.Cells(BlankRow, 6).Value = WorksheetFunction.Transpose(Split(wks.Cells(BlankRow, 6), \"_\"))\n</code></pre>\n\n<p>i would like to know how i can modify these 2 codes so that i can split my original string: <code>\"hometmastresh_enciivedexterXXtresh_tepootsXXXXXXXXXXXXXXtepootFile\"</code> that is currently in row E with \"X\" being unknown numbers and the fact that it will be different in every file.\ni would like to split the original string into \"XX\" into Row F and \"XXXXXXXXXXXXXX\" into Row G respectively </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1575422922, "post_id": 59167551, "comment_id": 104558822, "body": "Where is your code? Can you edit your question and post what you have so far."}, {"owner": {"reputation": 5, "user_id": 12477030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70de2781440a6471bb53d66b0dba172d?s=128&d=identicon&r=PG&f=1", "display_name": "Jkk", "link": "https://stackoverflow.com/users/12477030/jkk"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1575425042, "post_id": 59167551, "comment_id": 104559238, "body": "Hi there, I believe posting my code will not add any value as it is my first time writing VBA code, I appreciate the response!  :)"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1575426137, "post_id": 59167551, "comment_id": 104559512, "body": "I believe that if you don&#39;t post your code you will not be helped. This site offers assistance to those that show they have attempted to resolve their issue themselves.. Without your code and where you are going wrong, how do you expect anyone to help? We aren&#39;t going to write the code for you..."}, {"owner": {"reputation": 5, "user_id": 12477030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70de2781440a6471bb53d66b0dba172d?s=128&d=identicon&r=PG&f=1", "display_name": "Jkk", "link": "https://stackoverflow.com/users/12477030/jkk"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1575429359, "post_id": 59167551, "comment_id": 104560203, "body": "Thank you for the comment, I have edited the question with my current (very broken) attempt!"}, {"owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "edited": false, "score": 0, "creation_date": 1575430917, "post_id": 59167551, "comment_id": 104560536, "body": "you want the macro to make a formula for you or do you want the exact calculated date in column S?"}, {"owner": {"reputation": 5, "user_id": 12477030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70de2781440a6471bb53d66b0dba172d?s=128&d=identicon&r=PG&f=1", "display_name": "Jkk", "link": "https://stackoverflow.com/users/12477030/jkk"}, "edited": false, "score": 0, "creation_date": 1575431378, "post_id": 59167551, "comment_id": 104560627, "body": "The macro should ideally calculate the exact final date in column S"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1575433017, "post_id": 59167551, "comment_id": 104560958, "body": "... and you got an naswer 1 minute after posting your code. Does the answer below fix your problem?"}, {"owner": {"reputation": 5, "user_id": 12477030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70de2781440a6471bb53d66b0dba172d?s=128&d=identicon&r=PG&f=1", "display_name": "Jkk", "link": "https://stackoverflow.com/users/12477030/jkk"}, "edited": false, "score": 0, "creation_date": 1575436923, "post_id": 59167551, "comment_id": 104561858, "body": "Awesome, thank you all! I have edited and added the corrected VBA code into the question."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1575450518, "post_id": 59167551, "comment_id": 104566982, "body": "@JkJkJake I rolled back your post to the original question. If you found a solution please provide it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "is_accepted": true, "score": 0, "last_activity_date": 1575431908, "last_edit_date": 1575431908, "creation_date": 1575431405, "answer_id": 59168674, "question_id": 59167551, "link": "https://stackoverflow.com/questions/59167551/while-loop-until-a-condition-is-met-for-every-cell-in-a-column/59168674#59168674", "title": "While loop until a condition is met for every cell in a column", "body": "<p>make a function which will give you the date more than the cutoff date, instead of using the formula, that way you can use this function in our formula or your subroutine.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function getModifiedDate(date,cutoff,periodicity)\n  while date&lt;cutoff\n    if periodicity=\"Monthly\" then\n        date=date+ 1 month 'your logic to make it add a month (+1 will add a day)\n    'elseif periodicity='....\n    '....\n    'and so on...\n    end if\n  wend\n  getModifiedDate=date\nend Function\n</code></pre>\n\n<p>Now inside your subroutine, loop through the cells you want, and use the function defined earlier.</p>\n\n<p>or directly use the formula in your S column\n<code>=getModifiedDate(P5,P$1,Q5)</code> and you should get the modified date. </p>\n"}], "owner": {"reputation": 5, "user_id": 12477030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70de2781440a6471bb53d66b0dba172d?s=128&d=identicon&r=PG&f=1", "display_name": "Jkk", "link": "https://stackoverflow.com/users/12477030/jkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 59168674, "answer_count": 1, "score": 0, "last_activity_date": 1575450559, "creation_date": 1575421402, "last_edit_date": 1575450559, "question_id": 59167551, "link": "https://stackoverflow.com/questions/59167551/while-loop-until-a-condition-is-met-for-every-cell-in-a-column", "title": "While loop until a condition is met for every cell in a column", "body": "<p>Problem: Add 'Periodicity' values (with a nested if statement) to the 'Draft date' until the date is greater than or equal to the 'Cut off date'. Repeat for all cells in a column.</p>\n\n<p>Referring to the example image: In cell S28 (5/09/2019), it has applied the formula of 'P28+14' but the adjusted date (19/09/2019) is still less than the cut off date (of 25/11/2019). The macro should repeat this periodicity formula until the adjusted date reaches 28/11/2019 (5 additional iterations).</p>\n\n<p>I have tried using a Do While loop where values in the 'Change baseline' loop while the value is still \"Yes\"... but I was not successful due to my lack of VBA experience.</p>\n\n<p>Example Periodicity formula in cell S4:</p>\n\n<pre><code>=IF($G4=\"Weekly\",P4+7,\n   IF($G4=\"Fortnightly\",P4+14,\n     IF($G4=\"Monthly\",EDATE(P4,1),\n       IF($G4=\"2-Monthly\",EDATE(P4,2),\n        IF($G4=\"Quarterly\",EDATE(P4,3),\n          IF($G4=\"6-Monthly\",EDATE(P4,6),\"No\"))))))\n</code></pre>\n\n<p>Example Periodicity formula in VBA:</p>\n\n<pre><code>\"=IF(RC7=\"\"Weekly\"\",RC[-3]+7,IF(RC7=\"\"Fortnightly\"\",RC[-3]+14,IF(RC7=\"\"Monthly\"\",EDATE(RC[-3],1),IF(RC7=\"\"2-Monthly\"\",EDATE(RC[-3],2),IF(RC7=\"\"Quarterly\"\",EDATE(RC[-3],3),IF(RC7=\"\"6-Monthly\"\",EDATE(RC[-3],6),\"\"No\"\"))))))\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TIfgU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TIfgU.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "edited": false, "score": 0, "creation_date": 1575419945, "post_id": 59167256, "comment_id": 104558226, "body": "Hi, what errors are you seeing with the code you have there? Is the text below the table consistent in any way - can you imagine a test to find it?"}], "answers": [{"tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1575424049, "creation_date": 1575424049, "answer_id": 59167833, "question_id": 59167256, "link": "https://stackoverflow.com/questions/59167256/how-do-i-paste-values-of-a-column-in-a-table-into-a-cell-in-text-format/59167833#59167833", "title": "How do I paste values of a column in a table into a cell in text format", "body": "<p>I think you need to get Last row from wsa.</p>\n\n<pre><code>Sub Fill()\n\nDim wsi As Worksheet\nDim wscpy As Worksheet\nDim LastRow as Long\n\nSet wsi = Sheets(\"Raw Data Info\")\nSet wsa = Sheets(\"Raw Data Accts\")\nSet wscpy = Sheets(\"Copy to fund details\")\n\nwscpy.Range(\"A1\").Value = \"Name: \" &amp; wsi.Range(\"A36\").Value\nwscpy.Range(\"A2\").Value = \"D.O.B.: \" &amp; wsi.Range(\"B92\").Value\nwscpy.Range(\"A3\").Value = \"Address: \" &amp; wsi.Range(\"C42\") &amp; \", \" &amp; wsi.Range(\"C44\") &amp; \", \" &amp; wsi.Range(\"C45\") &amp; \" \" &amp; wsi.Range(\"C47\") &amp; \" \" &amp; wsi.Range(\"C46\")\n\n'...blah blah...\n\nwscpy.Range(\"A13\").Value = \"Gross Monthly Income: \" &amp; wsi.Range(\"B89\")\nwscpy.Range(\"A14\").Value = \"Accounts held: \"\n\n'you can get LastRow here\n'LastRow = wsa.Range(\"A43\").End(xlDown).Row\n'or would be better if you use this code\nLastRow = wsa.Cells(Rows.Count,1).End(xlUp).Row\nwscpy.Range(\"A15:A\" &amp; LastRow -28 ).Value = wsa.Range(\"A43:A\" &amp; LastRow).Value\n'I am not sure why you need this\n'wscpy.Range(\"A16:A\" &amp; LastRow -27\").Value = wsa.Range(\"A43:A\" &amp; LastRow).Value\n\n\nEnd Sub\n</code></pre>\n\n<p>Hope this help.</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 29, "user_id": 12446634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9113ae6a7d5f7398977075dfc5df1e?s=128&d=identicon&r=PG&f=1", "display_name": "CheMBurN", "link": "https://stackoverflow.com/users/12446634/chemburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575428679, "creation_date": 1575418611, "last_edit_date": 1575428679, "question_id": 59167256, "link": "https://stackoverflow.com/questions/59167256/how-do-i-paste-values-of-a-column-in-a-table-into-a-cell-in-text-format", "title": "How do I paste values of a column in a table into a cell in text format", "body": "<p>I'm new to VBA and I'm trying to code a rudimentary macro to have data from a Ctrl+A/C'd webpage into lines easily copied into a word document. One of the bits of data exist as a table and the number of rows can vary. There's data after the table so I cant use lastrow and my code doesn't work. I'd really appreciate some help on this.</p>\n\n<pre><code>Sub Fill()\n\nDim wsi As Worksheet\nDim wscpy As Worksheet\n\nSet wsi = Sheets(\"Raw Data Info\")\nSet wsa = Sheets(\"Raw Data Accts\")\nSet wscpy = Sheets(\"Copy to fund details\")\n\nwscpy.Range(\"A1\").Value = \"Name: \" &amp; wsi.Range(\"A36\").Value\nwscpy.Range(\"A2\").Value = \"D.O.B.: \" &amp; wsi.Range(\"B92\").Value\nwscpy.Range(\"A3\").Value = \"Address: \" &amp; wsi.Range(\"C42\") &amp; \", \" &amp; wsi.Range(\"C44\") &amp; \", \" &amp; wsi.Range(\"C45\") &amp; \" \" &amp; wsi.Range(\"C47\") &amp; \" \" &amp; wsi.Range(\"C46\")\n\n'...blah blah...\n\nwscpy.Range(\"A13\").Value = \"Gross Monthly Income: \" &amp; wsi.Range(\"B89\")\nwscpy.Range(\"A14\").Value = \"Accounts held: \"\n'This is the bit I have problems with\nwscpy.Range(\"A15\").Value = wsa.Range(\"A43\", wsa.Range(\"A43\").End(xlDown))\nwscpy.Range(\"A16\").Value = wsa.Range(\"A43\", wsa.Range(\"A43\").End(xlDown))\n\n\nEnd Sub\n</code></pre>\n\n<p>So the accounts table basically looks like this </p>\n\n<p><a href=\"https://gyazo.com/6355ebfe0ebdaf4f0396fc1e632dd34d\" rel=\"nofollow noreferrer\">https://gyazo.com/6355ebfe0ebdaf4f0396fc1e632dd34d</a></p>\n\n<p>How would I be able to code to list out the data (account and number) in their corresponding cells in wscpy?</p>\n\n<p>As always, thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1575416651, "post_id": 59166962, "comment_id": 104557548, "body": "Please include the code you are using to solve this in your question and explain the problems you are having with it."}, {"owner": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575416945, "post_id": 59166962, "comment_id": 104557610, "body": "I am not able to find the code for this."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1575417177, "post_id": 59166962, "comment_id": 104557658, "body": "Have you been deleting rows?  You may have deleted all of your Data Validation cells..."}, {"owner": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "edited": false, "score": 0, "creation_date": 1575417366, "post_id": 59166962, "comment_id": 104557692, "body": "Data Validation cells are configured manually and are in the right place. If I select on e of those cells the drop down list will show up. But I want disable /enable the ones on the right based upon Yes or No selected from the drop down list on the left (Make a selection). I added my code. Please suggest changes to it so that I can make it work."}], "answers": [{"comments": [{"owner": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "edited": false, "score": 1, "creation_date": 1575420509, "post_id": 59167393, "comment_id": 104558336, "body": "Michael you are amazing. Thanks a lot."}, {"owner": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "edited": false, "score": 0, "creation_date": 1575420864, "post_id": 59167393, "comment_id": 104558405, "body": "That certainly helped. Is there any way I can add a different color (show in the figure)  to the drop down where we have removed the data validation from, so that it appears to the user like it was disabled."}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "reply_to_user": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "edited": false, "score": 0, "creation_date": 1575421342, "post_id": 59167393, "comment_id": 104558489, "body": "Yes, sure. The easiest is probably just a conditional formatting (you might use something lik =$Q5=&quot;No&quot;). Alternatively, you can add something like Cells(Target.Row, Target.Column + 2).Interior.Color = RGB(200, 200, 200) for each of the four cases."}, {"owner": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "edited": false, "score": 0, "creation_date": 1575424046, "post_id": 59167393, "comment_id": 104559037, "body": "Interior.ColorIndex or the Interior.Color within the With statement throws an object not supported exception."}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "reply_to_user": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "edited": false, "score": 0, "creation_date": 1575452822, "post_id": 59167393, "comment_id": 104568223, "body": "@Ruruboy You cannot put into the same with-statement, it should look something like the <code>With Cells(Target.Row, Target.Column + 2)             .Interior.Color = RGB(200, 200, 200)             With .Validation                 .InCellDropdown = True                 .ShowError = True             End With     End With</code>"}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "reply_to_user": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "edited": false, "score": 0, "creation_date": 1575452914, "post_id": 59167393, "comment_id": 104568280, "body": "@Ruruboy Sorry for the bad code formatting, I am not sure if that can be done better in the comment section, but I hope you get the gist of it."}, {"owner": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "edited": false, "score": 0, "creation_date": 1575506126, "post_id": 59167393, "comment_id": 104593274, "body": "Michael that color changes now thanks. But I have noticed that Make a selection dropdown list gets triggered when I select &quot;No&quot;,  but the validation in the dropdown list doesn&#39;t clear (still appears) until I mouse out and click on two other cells. The event I am using as above is the Worksheet selection change. Do I need to set another property so that the  worksheet changes immediately after  I  select &quot;Yes&quot; or &quot;No&quot; in the &#39;Make a selection&#39; drop down list"}, {"owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "reply_to_user": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "edited": false, "score": 0, "creation_date": 1575547725, "post_id": 59167393, "comment_id": 104607921, "body": "@Ruruboy So if I understand correctly, you want to delete the value from the drop down? Just add <code>.Value = vbNullString</code> under the line that changes the color."}, {"owner": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "edited": false, "score": 0, "creation_date": 1575658195, "post_id": 59167393, "comment_id": 104653050, "body": "Thanks Michael."}], "tags": [], "owner": {"reputation": 1346, "user_id": 12418842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oB8nm.jpg?s=128&g=1", "display_name": "Michael Wycisk", "link": "https://stackoverflow.com/users/12418842/michael-wycisk"}, "is_accepted": true, "score": 1, "last_activity_date": 1575419995, "last_edit_date": 1575419995, "creation_date": 1575419667, "answer_id": 59167393, "question_id": 59166962, "link": "https://stackoverflow.com/questions/59166962/enable-and-disable-drop-down-lists/59167393#59167393", "title": "Enable and disable drop down lists", "body": "<p>If you already have your data validation drop downs set up, you might <strong>just turn off the in-cell drop down</strong> and the <strong>error message</strong> (so the datavalidation stays, even if it is disabled - but it is invisible for the user.</p>\n\n<p>In order to trigger the macro, you use the <code>Worksheet_Change</code> event. <strong>This code needs to be placed inside your sheet</strong>, not in a module.</p>\n\n<p>I just assumed that your \"Make a selection\" range is <code>O5:O12</code> and that there is a hidden column between \"Make a selection\" and \"Modified by author\"</p>\n\n<pre><code>'Triggered when any cell on the sheet is changed\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    'Check if Target cell in the \"Make a selection\" range is changed\n    If Not Intersect(Target, Range(\"O5:O12\")) Is Nothing Then\n        If Target.Value = \"Yes\" Then\n            'Dropdown and error message on cells 2 and 3 columns left of \"Make a selection\" will be enabled\n            With Cells(Target.Row, Target.Column + 2).Validation\n                .InCellDropdown = True\n                .ShowError = True\n            End With\n            With Cells(Target.Row, Target.Column + 3).Validation\n                .InCellDropdown = True\n                .ShowError = True\n            End With\n        ElseIf Target.Value = \"No\" Then\n            'Dropdown and error message on cells 2 and 3 columns left of \"Make a selection\" will be enabled\n             With Cells(Target.Row, Target.Column + 2).Validation\n                .InCellDropdown = False\n                .ShowError = False\n            End With\n            With Cells(Target.Row, Target.Column + 3).Validation\n                .InCellDropdown = False\n                .ShowError = False\n            End With\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Be aware that you need to to have a data validation already set up - otherwise you will receive an error.</p>\n\n<p>Alternatively, you might use <code>Validation.Delete</code> to remove your drop down and <code>Validation.Add</code> to enable your drop down. But that is more coding.</p>\n"}], "owner": {"reputation": 622, "user_id": 369914, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a9d017d4842ac624417708344b6ca4d?s=128&d=identicon&r=PG", "display_name": "Ruruboy", "link": "https://stackoverflow.com/users/369914/ruruboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 982, "favorite_count": 0, "accepted_answer_id": 59167393, "answer_count": 1, "score": 0, "last_activity_date": 1575419995, "creation_date": 1575416191, "last_edit_date": 1575417495, "question_id": 59166962, "link": "https://stackoverflow.com/questions/59166962/enable-and-disable-drop-down-lists", "title": "Enable and disable drop down lists", "body": "<p><a href=\"https://i.stack.imgur.com/qMb90.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qMb90.png\" alt=\"Enable and disable drop down lists in Excel using VBA\"></a></p>\n\n<pre><code>'Private Sub Worksheet_Change(ByVal Target As Range)\n'On Error Resume Next\n'If Target.Address &lt;&gt; \"$O$5\" Then Exit Sub\n'Select Case UCase(Target.Value)\n'    Case \"NO\"\n'        Application.EnableEvents = False\n'        Range(\"Q5,Q20\").ClearContents\n'        Range(\"R5,R20\").ClearContents\n'    Case \"YES\"\n'        'Range(\"B28,B32\").\n'        Application.EnableEvents = True\n'End Select\n'\n'exitHandler:\n'  Application.EnableEvents = True\n'  Exit Sub\n'\n'End Sub\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n If Target.Address = \"$O$5\" Then\n    Target.Range(\"O5:08\").ClearContents = True\n    Sheet9.d\n End If\n\n\nEnd Sub\n</code></pre>\n\n<p>I need to be able to enable modified by <strong>Author and Modified by User</strong> drop down lists (created in excel) when 'Yes' is selected in <strong>Make a selection</strong> drop down list and disable <strong>Modified by Author</strong> and <strong>Modified by User</strong> drop down list when No' is selected using VBA code.I have tried everything but don't know how to achieve this. There are no forms used in this project. I would appreciate if you could give me an idea how I can do this through VBA code. </p>\n"}, {"tags": ["vba", "replace", "outlook", "find"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1575415692, "post_id": 59166472, "comment_id": 104557366, "body": "Needs a <code>outMailItem.Save</code> to save the changes to the body. If its that weird orange background text line, this may need to be expanded to remove that formatting."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1575419685, "post_id": 59166472, "comment_id": 104558169, "body": "Body is the text body.  BodyHtml is the Html body.  Outlook only shows the Html body so amending the text body will have no effect.  Try amending BodyHtml."}, {"owner": {"reputation": 41, "user_id": 5564739, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xSAeAP0MhR4/AAAAAAAAAAI/AAAAAAAACTI/TVGcfXBYzUE/photo.jpg?sz=128", "display_name": "Christian Fischer", "link": "https://stackoverflow.com/users/5564739/christian-fischer"}, "edited": false, "score": 0, "creation_date": 1575502214, "post_id": 59166472, "comment_id": 104592284, "body": "I have taken on board 2 comments from the community Mike and Tony; thanks: I added a &quot;save&quot;line and amended to &quot;HTMLbody&quot; in the loop. but still no change; also i added a temporary counter too see how many iterations were made in the loop, but instead of going through all emails ( 100+) it stops at 3 or 4 depending on the folder ( drafts or inbox). this is strange ?"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1575660222, "post_id": 59166472, "comment_id": 104653885, "body": "Tested functionality with HTMLBody works fine for me.  You&#39;ve either got some formatting incorrect in your replace statement or you are filtering emails you don&#39;t want to update. You&#39;re currently in the drafts. Are those the emails you want to update?  Note - that even if you remove the TEXT it will not remove the HTML formatting. It may be better to identify the element tag and remove it entirely with the replace if possible."}, {"owner": {"reputation": 41, "user_id": 5564739, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xSAeAP0MhR4/AAAAAAAAAAI/AAAAAAAACTI/TVGcfXBYzUE/photo.jpg?sz=128", "display_name": "Christian Fischer", "link": "https://stackoverflow.com/users/5564739/christian-fischer"}, "edited": false, "score": 0, "creation_date": 1575853585, "post_id": 59166472, "comment_id": 104694022, "body": "Solve most of the issues with your help.I have the impression that fiind/replace does not work with EXISTING emails in Inbox. They need to be opened (displayed) which is  not practical at all ?"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1576002540, "post_id": 59166472, "comment_id": 104753766, "body": "Hi Christian if you use @(username) we&#39;ll see your comments. Otherwise we won&#39;t be notified.  Whats the end result of this? To cleanup emails in your inbox? To adjust them before forwarding them?  If its the first - its looking like display then save/close is the only option that I can find. If you want to edit before sending you can use the the forwarding mechanisms in vba that will allow you to edit the body of the draft before sending without the need for display/save/close. @Tony Dallimore may have more info."}, {"owner": {"reputation": 41, "user_id": 5564739, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xSAeAP0MhR4/AAAAAAAAAAI/AAAAAAAACTI/TVGcfXBYzUE/photo.jpg?sz=128", "display_name": "Christian Fischer", "link": "https://stackoverflow.com/users/5564739/christian-fischer"}, "edited": false, "score": 0, "creation_date": 1576208742, "post_id": 59166472, "comment_id": 104833013, "body": "Christian Fischer: Mike, I used outMailItems(i).Display to display last 10 emails of the selected folder , then find/replace, finally outMailItems(i).Save; see above code. but the 1st email remains now open (displayed). Is there a way to close a displayed email before moving to the next one ? or at the end of the loop ?"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1578502516, "creation_date": 1578502516, "answer_id": 59650504, "question_id": 59166472, "link": "https://stackoverflow.com/questions/59166472/find-and-delete-specific-sentence-in-first-line-of-emails/59650504#59650504", "title": "Find and delete specific sentence in first line of emails", "body": "<p>There is no need to open the mailitems.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub RemoveExpressionFOLDER()\n\nDim outFldr As folder\nDim outItems As Items\nDim outMailItem As MailItem\n\nDim i As Long\nDim cleanCount As Long\n\nSet outFldr = ActiveExplorer.CurrentFolder\n\nSet outItems = outFldr.Items\n\nFor i = 1 To outItems.Count\n\n    If outItems(i).Class = olMail Then\n\n        Set outMailItem = outItems(i)\n\n        With outMailItem\n\n            'Debug.Print .Subject\n\n            If InStr(.Body, \"THINK SECURE. This email has come from an external source. Do not click on links or open attachments unless you recognise the sender.\") Then\n\n                If .BodyFormat = olFormatHTML Then\n                    .HTMLBody = Replace(.HTMLBody, \"THINK SECURE. This email has come from an external source. Do not click on links or open attachments unless you recognise the sender.\", \"\")\n                Else\n                    .Body = Replace(.Body, \"THINK SECURE. This email has come from an external source. Do not click on links or open attachments unless you recognise the sender.\", \"\")\n                End If\n\n                .SAVE\n\n                cleanCount = cleanCount + 1\n\n            End If\n\n        End With\n\n    End If\n\nNext i\n\nMsgBox (cleanCount &amp; \" mailitems cleaned.\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5564739, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xSAeAP0MhR4/AAAAAAAAAAI/AAAAAAAACTI/TVGcfXBYzUE/photo.jpg?sz=128", "display_name": "Christian Fischer", "link": "https://stackoverflow.com/users/5564739/christian-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1578502516, "creation_date": 1575412814, "last_edit_date": 1576208636, "question_id": 59166472, "link": "https://stackoverflow.com/questions/59166472/find-and-delete-specific-sentence-in-first-line-of-emails", "title": "Find and delete specific sentence in first line of emails", "body": "<p>All my emails have this sentence added \" this email has come from an external source. Do not click on links or open attachments unless you recognise the sender.\" </p>\n\n<p>I would like to delete it.; I have made this macro but it does not work. Nothing happens. Other macros do work in outlook session, so it is not a security issue. I would expect the macro to take a minute or so for 100s of emails to search. but nothing happens at all. Can you help ?</p>\n\n<pre><code>Sub RemoveExpressionFOLDER()\n\nDim outNS As Outlook.NameSpace\nDim outFldr As Outlook.Folder\nDim outMailItems As Outlook.Items\n'Dim outMailItem As Outlook.MailItem\nDim outMailItem As Object\nDim myinspector As Outlook.Inspector\n\n\nSet outNS = Application.GetNamespace(\"MAPI\")\nSet outFldr = Application.ActiveExplorer.CurrentFolder\n\n Set myinspector = Application.ActiveInspector\n\n\nSet outMailItems = outFldr.Items\n\nK = outFldr.Items.Count\n</code></pre>\n\n<p>'MsgBox (K)\n    For i = 1 To K</p>\n\n<pre><code>If outMailItems(i).Class &lt;&gt; olMail Then GoTo 20\noutMailItems(i).Display\n\n\n    'outMailItems(i).UnRead = True\n    outMailItems(i).Body = Replace(outMailItems(i).Body, \"THINK SECURE. This \n email has come from an external source. Do not click on links or open \n attachments unless you recognise the sender.\", \"\")\n'outMailItems(i).HTMLBody = Replace(outMailItems(i).HTMLBody, \"THINK SECURE. \nThis email has come from an external source. Do not click on links or open \n attachments unless you recognise the sender.\", \"\")\n outMailItems(i).Save\n Set myinspector = Application.ActiveInspector\n Set outMailItems(i) = myinspector.CurrentItem\n\n outMailItems(i).Close olSave\n\n 20    Next i\n MsgBox (\"cleaned \")\n\nSet outMailItems = Nothing\nSet outFldr = Nothing\nSet outNS = Nothing\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "combobox", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "is_accepted": false, "score": 0, "last_activity_date": 1575413394, "creation_date": 1575413394, "answer_id": 59166585, "question_id": 59166425, "link": "https://stackoverflow.com/questions/59166425/access-2010-dynamically-set-combo-control-source-and-row-source/59166585#59166585", "title": "Access 2010 - Dynamically Set Combo Control Source and Row Source", "body": "<p>And just like that, I figured it out.  Of course it takes me all day, and posting this question to get it.  </p>\n\n<p>Here is the function, with the right syntax:</p>\n\n<pre><code>Private Function MyGroup()\n\n   If Me.Mybitval = True Then\n        Me.cboGroupType.Value = \"Group1\"\n    ElseIf Me.Mybitval = False And Nz(Me.MyID1, 0) &lt;&gt; 0 Then\n        Me.cboGroupType.Value = \"Group2\"\n    ElseIf Me.Mybitval = False And Nz(Me.MyID1, 0) = 0 Then\n        Me.cboGroupType.Value = \"Group3\"\n    End If\n\n    Select Case Me.cboGroupType\n        Case \"Group1\"\n            Me.cboGroupName.RowSource = \"SELECT Group1.ID, Group1.G1Name FROM Group1 ORDER BY Group1.G1Name;\"\n            Me.cboGroupName.ControlSource = \"FKID1\"\n        Case \"Group2\"\n            Me.cboGroupName.RowSource = \"SELECT Group2.ID, Group2.G2Name FROM Group2 ORDER BY Group2.G2Name;\"\n            Me.cboGroupName.ControlSource = \"FKID2\"\n        Case \"Group3\"\n            Me.cboGroupName.RowSource = \"SELECT Group3.G3ID, Group3.G3Name FROM Group3 ORDER BY Group3.G3Name;\"\n            Me.cboGroupName.ControlSource = \"FKID1\"\n    End Select\n\n    Debug.Print Me.cboGroupName.RowSource\n    Debug.Print Me.cboGroupName.ControlSource\n    Debug.Print Me.cboGroupName.Value\nEnd Function\n</code></pre>\n\n<p>Provided your form is bound to a table, such as mine is, the control source needs to = <strong>\"fieldname\"</strong> . It needs to be the field name in double quotes. Not me.fieldname as that ends up making the controlsource the value of that field name. It also can't be [table1]![field1] I tried that and that doesn't work either.  </p>\n\n<p>The above works beautifully.  Now to test the rest of the form!</p>\n"}], "owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593730374, "creation_date": 1575412495, "last_edit_date": 1593730374, "question_id": 59166425, "link": "https://stackoverflow.com/questions/59166425/access-2010-dynamically-set-combo-control-source-and-row-source", "title": "Access 2010 - Dynamically Set Combo Control Source and Row Source", "body": "<p>I am limited in that I have to stick with the old (messy) table design.  On this one interface I am developing, there is a combo drop down that is a fixed values list.  The options are Group1, Group2, and Group 3.  Based on that, a dependent combo needs to be set to the correct row source and control source.</p>\n\n<p>The form is locked, and the user can navigate the records (first, last, next previous, and an unbound combo to jump to a record). During those operations, I just want to refresh which list the dependent combo should pull from, and what value it should bind to, to show the correct value.</p>\n\n<p>When the user clicks to make a \"new\" record, I won't show the dependent drop down (or make it enabled. haven't decided yet) until they choose a value in the first combo, telling us which group it is.</p>\n\n<p>In order to control this, I created a function for use on this form.  This is that function:</p>\n\n<pre><code>Private Function MyGroup()\n   'Mybitval is a table value that is a bit data type. It means group1       \n   If Me.Mybitval = True Then\n        Me.cboGroupType.Value = \"Group1\"\n    ElseIf Me.Mybitval = False And Nz(Me.MyID1, 0) &lt;&gt; 0 Then\n        Me.cboGroupType.Value = \"Group2\"\n    ElseIf Me.Mybitval = False And Nz(Me.MyID1, 0) = 0 Then\n        Me.cboGroupType.Value = \"Group3\"\n    End If\n\n    Select Case Me.cboGroupType\n        Case \"Group1\"\n            Me.cboGroupName.RowSource = \"SELECT Group1.ID, Group1.G1Name FROM Group1 ORDER BY Group1.G1Name;\"\n            Me.cboGroupName.ControlSource = me.FKID1\n        Case \"Group2\"\n            Me.cboGroupName.RowSource = \"SELECT Group2.ID, Group2.G2Name FROM Group2 ORDER BY Group2.G2Name;\"\n            Me.cboGroupName.ControlSource = Me.FKID2\n        Case \"Group3\"\n            Me.cboGroupName.RowSource = \"SELECT Group3.G3ID, Group3.G3Name FROM Group3 ORDER BY Group3.G3Name;\"\n            Me.cboGroupName.ControlSource = me.FKID1\n    End Select\n\n    Debug.Print Me.cboGroupName.RowSource\n    Debug.Print Me.cboGroupName.ControlSource\n    Debug.Print Me.cboGroupName.Value\nEnd Function\n</code></pre>\n\n<p>The idea is that I call this function on load, after I go to the first record, and then on any navigation button click or after update of the go to combo.  </p>\n\n<p>The problem is, that the cbogroupname never shows the value it has in the control source. When I try to load the form, my debug rowsource shows the correct sql, and the control source shows the value of the correct table field for the current record it's on, but 2 things don't seem to work. If I don't do the 3rd debug on the value, the form loads fine, but the combo doesn't show the right value, even though it's bound to a table column that has a value.  If do debug the value, I get a run-time error '2424': \"The expression you entered has a field, control, or property name that [my application] can't find.\"</p>\n\n<p>When I hit debug, it goes to the last line of the function:\nDebug.Print Me.cboGroupName.Value</p>\n\n<p>When I go to save a new record, I run through validation, and having this 1 combo, instead of 3 different ones with alternating the visibility, seems way easier.  Is there a reason this isn't working the way I am wanting it to?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1575412015, "post_id": 59166277, "comment_id": 104556392, "body": "How are you coming up with the <code>$E$4</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1575413329, "post_id": 59166277, "comment_id": 104556805, "body": "BTW you can just use the string in <code>Range()</code>: <code>Range(&quot;$E$4&quot;)</code>"}, {"owner": {"reputation": 117, "user_id": 2651856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a86b4eb18144912d55bf9800a3d9fedd?s=128&d=identicon&r=PG", "display_name": "Jrules80", "link": "https://stackoverflow.com/users/2651856/jrules80"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1575417990, "post_id": 59166277, "comment_id": 104557818, "body": "Scott, Range(&quot;$E$4&quot;) gave me the absolute value of the cell. I need the corresponding number of E (which is 5). To answer your first question, I have added my code that is returning the cell address."}], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": 1, "last_activity_date": 1575417033, "last_edit_date": 1575417033, "creation_date": 1575415200, "answer_id": 59166832, "question_id": 59166277, "link": "https://stackoverflow.com/questions/59166277/vba-translate-column-value-in-alphabet-to-a-numeral/59166832#59166832", "title": "VBA translate column value in alphabet to a numeral", "body": "<pre><code>Debug.Print Range(\"$E$4\").Row &amp; \", \" &amp; Range(\"A1\").Column\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 2651856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a86b4eb18144912d55bf9800a3d9fedd?s=128&d=identicon&r=PG", "display_name": "Jrules80", "link": "https://stackoverflow.com/users/2651856/jrules80"}, "edited": false, "score": 0, "creation_date": 1575421753, "post_id": 59167355, "comment_id": 104558558, "body": "Awesome, this works too. I have replaced my code with this. Thank you, thank you!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1575419457, "creation_date": 1575419457, "answer_id": 59167355, "question_id": 59166277, "link": "https://stackoverflow.com/questions/59166277/vba-translate-column-value-in-alphabet-to-a-numeral/59167355#59167355", "title": "VBA translate column value in alphabet to a numeral", "body": "<p>changing and spliting strings to get to numbers is slow.  Just use the selection.rows and selection.column:</p>\n\n<pre><code>Sub UnMerge()\n\n    Selection.MergeCells = False\n    With ActiveSheet\n        Dim i As Long\n        For i = Selection.Row To Selection.Rows.Count + Selection.Row - 1\n            If .Cells(i, Selection.Column) = \"\" Then\n                .Cells(i, Selection.Column) = .Cells(i - 1, Selection.Column).Value\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 2651856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a86b4eb18144912d55bf9800a3d9fedd?s=128&d=identicon&r=PG", "display_name": "Jrules80", "link": "https://stackoverflow.com/users/2651856/jrules80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 59166832, "answer_count": 2, "score": 0, "last_activity_date": 1575419457, "creation_date": 1575411722, "last_edit_date": 1575418104, "question_id": 59166277, "link": "https://stackoverflow.com/questions/59166277/vba-translate-column-value-in-alphabet-to-a-numeral", "title": "VBA translate column value in alphabet to a numeral", "body": "<p>How do I convert the alpha part of an excel address \"$C$2\" to 3 and 2 so that I could re-use it in a cell object.</p>\n\n<p>If it is \"$E$4\", then I need two separate values like 5 (for the letter E) and 4, so that I could reference that using the object - Cells(4,5)</p>\n\n<p>Basically, I am trying to un-merge cells using this code below and that is where the need to get the numeral of the excel cell came about.</p>\n\n<pre><code>Sub UnMerge()\n    Dim i As Integer\n    Dim fromRange() As String\n    Dim toRange() As String\n    Dim temp() As String\n\n    ActiveSheet.UsedRange.MergeCells = False\n    fromRange() = Split(ActiveCell.Address, \"$\")\n    temp() = Split(Selection.Address, \":\")\n    toRange() = Split(temp(1), \"$\")\n\n\n    For i = fromRange(2) To toRange(2)\n        If Cells(i, Range(temp(0)).Column) = \"\" Then\n            Cells(i, Range(temp(0)).Column) = Cells(i - 1, Range(temp(0)).Column).Value\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1575410270, "post_id": 59165943, "comment_id": 104555761, "body": "First: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Avoid using Select in your code</a>. Second: Something like <code>Cell,Offset(0,1).Value</code> should give you the product code corresponding to the current <code>Cell</code>"}, {"owner": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "edited": false, "score": 0, "creation_date": 1575411999, "post_id": 59165943, "comment_id": 104556385, "body": "do you mean, the name of the image in the spreadsheet (which is generally invisible?) or rename the file that you just imported?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb36783fd532bc7374a6a6c7b9ff4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/12476534/gman"}, "edited": false, "score": 0, "creation_date": 1575552757, "post_id": 59166699, "comment_id": 104610787, "body": "Hi Rowan, thanks for looking at this. So column A has the image URL and column B has the Product code. The result of A should be named B instead of the generic &quot;image#&quot;"}, {"owner": {"reputation": 1, "user_id": 12476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb36783fd532bc7374a6a6c7b9ff4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/12476534/gman"}, "edited": false, "score": 0, "creation_date": 1575561392, "post_id": 59166699, "comment_id": 104615611, "body": "Plus, I&#39;ve noticed that your script downloads the images twice...?"}, {"owner": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "reply_to_user": {"reputation": 1, "user_id": 12476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb36783fd532bc7374a6a6c7b9ff4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/12476534/gman"}, "edited": false, "score": 0, "creation_date": 1575673074, "post_id": 59166699, "comment_id": 104658012, "body": "ok, the code above only imports the image once, but it will do so again if the code is run again? when you say &#39;the result of A&#39; do you mean the image itself, it&#39;s range name, a caption, or something different. The above code currently gives the image a name with the value in B. However, this name is generally invisible - it&#39;s the range name/shapename."}, {"owner": {"reputation": 1, "user_id": 12476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb36783fd532bc7374a6a6c7b9ff4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/12476534/gman"}, "edited": false, "score": 0, "creation_date": 1575887239, "post_id": 59166699, "comment_id": 104703798, "body": "Ok, I think I see what you mean. I download the actual image, then save the excel as an .htm giving me two files, one the .htm with the addresses and the other an .fdl with all the images. In this file, I need the images to have the relevant product code as the image name instead of &quot;image#&quot;. I&#39;m assuming that this process starts in the initial download and naming script. Again thanks a lot for looking at this!"}, {"owner": {"reputation": 1, "user_id": 12476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb36783fd532bc7374a6a6c7b9ff4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/12476534/gman"}, "edited": false, "score": 0, "creation_date": 1575891008, "post_id": 59166699, "comment_id": 104705756, "body": "I guess my other question would be ... Could this issue have anything to do with the fact that I&#39;m running excel of Mac?"}], "tags": [], "owner": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1575414180, "creation_date": 1575414180, "answer_id": 59166699, "question_id": 59165943, "link": "https://stackoverflow.com/questions/59165943/how-to-name-extracted-images-with-a-specific-cell-content/59166699#59166699", "title": "How to name extracted images with a specific cell content?", "body": "<p>For naming the image so that it appears in range / sheets:</p>\n\n<pre><code>Option Explicit\nSub URLPictureInsert()\n\n    Dim xRg As Range\n    Dim xCol As Long\n    Dim rng As Range\n    Dim cell As Variant\n    Dim filenam As String\n    Dim myImg As Picture\n    Application.ScreenUpdating = False\n    Set rng = ActiveSheet.Range(\"A1:A500\")\n    For Each cell In rng\n       filenam = cell.Value\n       Set myImg = ActiveSheet.Pictures.Insert(filenam)\n       If Not myImg Is Nothing Then\n           xCol = cell.Column + 1\n           Set xRg = Cells(cell.Row, xCol)\n           With myImg\n              '.LockAspectRatio = msoFalse\n              .Width = 100\n              .Height = 100\n              .Top = xRg.Top + (xRg.Height - .Height) / 2\n              .Left = xRg.Left + (xRg.Width - .Width) / 2\n            End With\n        End If\n        'this line names the image by taking the value in the cell to the right\n        myImg.Name = cell.Offset(0, 1).Value\n        Set myImg = Nothing\n        Range(\"A1\").Select\n   Next\n   Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb36783fd532bc7374a6a6c7b9ff4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/12476534/gman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578765842, "creation_date": 1575410035, "last_edit_date": 1578765842, "question_id": 59165943, "link": "https://stackoverflow.com/questions/59165943/how-to-name-extracted-images-with-a-specific-cell-content", "title": "How to name extracted images with a specific cell content?", "body": "<p>I import product images from a database into Excel using the code below: </p>\n\n<pre><code>Sub URLPictureInsert() \n'Updateby Extendoffice 20161116 \n    Dim Pshp As Shape \n    Dim xRg As Range \n    Dim xCol As Long \n    On Error Resume Next \n    Application.ScreenUpdating = False \n    Set Rng = ActiveSheet.Range(\"A1:A500\") \n    For Each cell In Rng \n       filenam = cell \n       ActiveSheet.Pictures.Insert(filenam).Select \n       Set Pshp = Selection.ShapeRange.Item(1) \n       If Pshp Is Nothing Then GoTo lab \n       xCol = cell.Column + 1 \n       Set xRg = Cells(cell.Row, xCol) \n       With Pshp \n          .LockAspectRatio = msoFalse \n          .Width = 100 \n          .Height = 100 \n          .Top = xRg.Top + (xRg.Height - .Height) / 2 \n          .Left = xRg.Left + (xRg.Width - .Width) / 2 \n    End With \nlab: \n   Set Pshp = Nothing \n   Range(\"A1\").Select \n   Next \n   Application.ScreenUpdating = True \nEnd Sub \n</code></pre>\n\n<p>I have to download 100's of images at a time and this script names all the images \"image 1\" and so on to 500 at times. </p>\n\n<p>How can I get the code to name each image with the product code in the cell next to it?</p>\n\n<p>Essentially I have the address of the image in column A1...A500 and the corresponding product code in B1...B500. I want it to find the image in A1 and name it the code in B1 and not \"image 1\".</p>\n"}, {"tags": ["excel", "vba", "function", "find", "range"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1575409415, "post_id": 59165741, "comment_id": 104555446, "body": "That&#39;s not how find works I&#39;m afraid. If you do want to continue that path, you&#39;ll need to use FindNext and check it&#39;s offset untill you found your second criteria. How about an AutoFilter? Or an Evaluate operation? What&#39;s you end goal? Pull info from any other column?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1575409752, "post_id": 59165741, "comment_id": 104555561, "body": "You can always use a helper column concatenating the two and then search on that."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1575410762, "post_id": 59165741, "comment_id": 104555945, "body": "The aim is e.g. that in sheet 2 for &quot;Steve&quot; with the ID &quot;1&quot; will be some calculations conducted. The next step is to get back to the first sheet again, looking for &quot;Steve&quot; with the ID &quot;1&quot; and to put the calculated result from sheet 2 in column &quot;B&quot; on the same row as &quot;Steve&quot; with the ID &quot;1&quot;. In other words, I am trying to use the ID to differentiate the names which appear more than once to that the calcuated results get allocated to the right name."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1575412089, "post_id": 59166313, "comment_id": 104556419, "body": "Can I use the Index as a VBA code, e.g. the INDEX contains the two values namely &quot;name&quot; and &quot;ID&quot;?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1575412261, "post_id": 59166313, "comment_id": 104556483, "body": "@YavuzTopal Just try it and see for yourself"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": 0, "last_activity_date": 1575411930, "creation_date": 1575411930, "answer_id": 59166313, "question_id": 59165741, "link": "https://stackoverflow.com/questions/59165741/how-to-use-the-find-function-which-satisfy-two-criteria/59166313#59166313", "title": "How to use the &quot;Find&quot; function which satisfy two criteria", "body": "<p>Don't use <code>FIND</code> in the first place, that's what array formulas are for.</p>\n\n<p><a href=\"https://i.stack.imgur.com/DbCn4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DbCn4.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>.FormulaArray =  \"=INDEX(C1:C5,MATCH(1,((A1:A5=\"\"Steve\"\")*(B1:B5=\"\"C\"\")),0))\"\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 59166313, "answer_count": 1, "score": -1, "last_activity_date": 1575412462, "creation_date": 1575409051, "last_edit_date": 1575412462, "question_id": 59165741, "link": "https://stackoverflow.com/questions/59165741/how-to-use-the-find-function-which-satisfy-two-criteria", "title": "How to use the &quot;Find&quot; function which satisfy two criteria", "body": "<p>The first column contains names that have distinct IDs attached. E.g the first name \"Steve\" has the ID \"1\". The other \"Steve\" the ID \"2\". I am using the \"find\" function in order to find the name \"Steve\" in range A:A but I am struggling to get the \"find\" function to find the \"name\" and the corresponding ID \"1\" in order to differentiate it from the other \"Steve\" with the ID \"2\". In other word, the variable \"Found\" are supposed to contain two informations, the name \"Steve\" with the ID \"1\".\nI just dont know how to incorporate these two criteria into the \"find\" function. </p>\n\n<p><a href=\"https://i.stack.imgur.com/nk2Q3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nk2Q3.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Set RIC=worksheet(\u201eTabel\u201c).range(\u201eA\u201c&amp;t)\nSet ID= worksheet(\u201eTabel\u201c).range(\u201eC\u201c&amp;t)\n\nSet Found= worksheet(\u201erules\u201c).range(A:C).Find(RIC,ID)\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1614815193, "post_id": 59165429, "comment_id": 117503455, "body": "Possibly the default account is no longer account 1. Delete the line <code>objMail.SendUsingAccount = olNS.Accounts.Item(1)</code>."}], "owner": {"reputation": 11, "user_id": 12476209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c47b7b613a843aafee462506f36015?s=128&d=identicon&r=PG&f=1", "display_name": "Microslacker", "link": "https://stackoverflow.com/users/12476209/microslacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1614680688, "creation_date": 1575407638, "last_edit_date": 1614680688, "question_id": 59165429, "link": "https://stackoverflow.com/questions/59165429/send-email-with-sentonbehalfofname", "title": "Send email with .SentOnBehalfOfName", "body": "<p>I have a script that the company has been using for a while and no issues.</p>\n<p>We switched from Outlook 2010 to Outlook 2016.</p>\n<p>The script fills in the right information but when clicking on the send button, it bounces back to the email user's inbox saying &quot;undelivered&quot; and</p>\n<blockquote>\n<p>&quot;This message could not be sent. You do not have the permission to send the message on behalf of the specified user.&quot;</p>\n</blockquote>\n<p>I have verified that the user has full access to that user mailbox.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ForwardA()\n\nDim objMail As Outlook.MailItem\n\nDim GetSMTPAddress As String, s As String, piece As String, i As Long, j As Long\n\nDim olkSnd As Outlook.AddressEntry, olkExu As Outlook.ExchangeUser\nDim olNS As Outlook.NameSpace\nSet olNS = Application.GetNamespace(&quot;MAPI&quot;)\nSet objITEM = GetCurrentItem()\nSet olkSnd = objITEM.Sender\nIf olkSnd.AddressEntryUserType = olExchangeUserAddressEntry Then\n    Set olkExu = olkSnd.GetExchangeUser\n    GetSMTPAddress = olkExu.PrimarySmtpAddress\nElse\n    GetSMTPAddress = objITEM.SenderEmailAddress\nEnd If\nSet olkSnd = Nothing\nSet olkExu = Nothing\ns = GetSMTPAddress\ni = InStr(s, &quot;@&quot;)\nj = InStrRev(s, &quot;.&quot;)\npiece = UCase(Mid(s, i + 1, j - i - 1))\nIf piece = &quot;--------&quot; Then\n    piece = InputBox(&quot;----- - Enter New Company name&quot;)\nEnd If\n'MsgBox piece\nSet objMail = objITEM.Forward\nobjMail.SentOnBehalfOfName = &quot;orders@------.com&quot;\nobjMail.To = &quot;&quot;\nobjMail.Subject = piece &amp; &quot;: CONFIRMATION RECEIPT OF &quot;\nobjMail.BCC = &quot;&quot;\nobjMail.SendUsingAccount = olNS.Accounts.Item(1)\nobjMail.Display\nSet objITEM = Nothing\nSet objMail = Nothing\nMoveToCustomerPO\n</code></pre>\n"}, {"tags": ["excel", "vba", "ambiguous"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12476205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b9ccd66899e9c444a1d95a9922a65f?s=128&d=identicon&r=PG&f=1", "display_name": "brettd03", "link": "https://stackoverflow.com/users/12476205/brettd03"}, "edited": false, "score": 1, "creation_date": 1575407708, "post_id": 59165167, "comment_id": 104554804, "body": "Beautiful- works like a charm.  The end if and elseif get confusing!  Thanks again!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 12476205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b9ccd66899e9c444a1d95a9922a65f?s=128&d=identicon&r=PG&f=1", "display_name": "brettd03", "link": "https://stackoverflow.com/users/12476205/brettd03"}, "edited": false, "score": 2, "creation_date": 1575408507, "post_id": 59165167, "comment_id": 104555100, "body": "@brettd03 notice how consistent <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indentation</a> helps make the nested structures look... nested =)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1575406384, "creation_date": 1575406384, "answer_id": 59165167, "question_id": 59165027, "link": "https://stackoverflow.com/questions/59165027/ambiguous-name-detected-easy-fix/59165167#59165167", "title": "Ambiguous Name Detected- Easy Fix", "body": "<p>Try this. You can just check if either of those two cells have changed and then do the necessary depending on the value.</p>\n\n<p>If you might be changing more than one cell you'd need to incorporate a loop through <code>Target</code>.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Count &gt; 1 Then Exit Sub 'don't do anything if multiple cells changed (could omit)\n\nApplication.ScreenUpdating = False\n\nIf Target.Address = \"$B$11\" Then\n    If Target.Value = \"Yes\" Then\n        Sheets(\"New HSE Start-Up Checklist\").Rows(\"36:42\").EntireRow.Hidden = False\n        Sheets(\"Existing HSE Start-Up Checklist\").Rows(\"36:42\").EntireRow.Hidden = False\n    ElseIf Target.Value = \"No\" Then\n        Sheets(\"New HSE Start-Up Checklist\").Rows(\"36:42\").EntireRow.Hidden = True\n        Sheets(\"Existing HSE Start-Up Checklist\").Rows(\"36:42\").EntireRow.Hidden = True\n    End If\nElseIf Target.Address = \"$E$8\" Then\n    If Target.Value = \"Yes\" Then\n        Sheets(\"New HSE Start-Up Checklist\").Rows(\"43:47\").EntireRow.Hidden = False\n        Sheets(\"Existing HSE Start-Up Checklist\").Rows(\"43:47\").EntireRow.Hidden = False\n    ElseIf Target.Value = \"No\" Then\n        Sheets(\"New HSE Start-Up Checklist\").Rows(\"43:47\").EntireRow.Hidden = True\n        Sheets(\"Existing HSE Start-Up Checklist\").Rows(\"43:47\").EntireRow.Hidden = True\n    End If\nEnd If\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12476205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b9ccd66899e9c444a1d95a9922a65f?s=128&d=identicon&r=PG&f=1", "display_name": "brettd03", "link": "https://stackoverflow.com/users/12476205/brettd03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575447132, "creation_date": 1575405762, "last_edit_date": 1575447132, "question_id": 59165027, "link": "https://stackoverflow.com/questions/59165027/ambiguous-name-detected-easy-fix", "title": "Ambiguous Name Detected- Easy Fix", "body": "<p>I've read through the similar threads that exist here and am still a bit confused on how to translate those answers to my scenario.  I understand that I cannot have 2 changes in one sheet.  So, I need to combine the two conditions.</p>\n\n<p>Basically, on a \"form\", I'm trying to hide rows on two different sheets based on 2 separate inputs.</p>\n\n<p>First statement is working perfectly ($B$11)for the two sheets referenced.</p>\n\n<p>There is another cell on the form that I need to reference to hide additional cells on the same two sheets in the code that is working.  I tried to combine but continue to get errors on my attempts to combine.  </p>\n\n<p>Help combining the two would be much appreciated!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n Application.ScreenUpdating = False\n\n If Intersect(Target, Range(\"$B$11\")) Is Nothing Then Exit Sub\n\n If Target.Address = (\"$B$11\") And Target.Value = \"Yes\" Then\n Sheets(\"New HSE Start-Up Checklist\").Rows(\"36:42\").EntireRow.Hidden = False\n Sheets(\"Existing HSE Start-Up Checklist\").Rows(\"36:42\").EntireRow.Hidden = False\n ElseIf Target.Address = (\"$B$11\") And Target = \"No\" Then\n Sheets(\"New HSE Start-Up Checklist\").Rows(\"36:42\").EntireRow.Hidden = True\n Sheets(\"Existing HSE Start-Up Checklist\").Rows(\"36:42\").EntireRow.Hidden = True\n\n End If\n\n Application.ScreenUpdating = True\n\nEnd Sub\n\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n Application.ScreenUpdating = False\n\n If Intersect(Target, Range(\"$E$8\")) Is Nothing Then Exit Sub\n\n If Target.Address = (\"$E$8\") And Target.Value = \"Yes\" Then\n Sheets(\"New HSE Start-Up Checklist\").Rows(\"43:47\").EntireRow.Hidden = False\n Sheets(\"Existing HSE Start-Up Checklist\").Rows(\"43:47\").EntireRow.Hidden = False\n ElseIf Target.Address = (\"$E$8\") And Target = \"No\" Then\n Sheets(\"New HSE Start-Up Checklist\").Rows(\"43:47\").EntireRow.Hidden = True\n Sheets(\"Existing HSE Start-Up Checklist\").Rows(\"43:47\").EntireRow.Hidden = True\n\n End If\n\n Application.ScreenUpdating = True\n\nEnd Sub\n\n\n\n\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 2651856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a86b4eb18144912d55bf9800a3d9fedd?s=128&d=identicon&r=PG", "display_name": "Jrules80", "link": "https://stackoverflow.com/users/2651856/jrules80"}, "edited": false, "score": 0, "creation_date": 1575409468, "post_id": 59165233, "comment_id": 104555457, "body": "Thanks for responding, Scott. I think your suggestion is great to count the # of items that have been Carried over (which I think I would need also). But, what if I want to get the total sum under column C (&quot;Size&quot;) though for those &quot;Carry Over&quot; items?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 117, "user_id": 2651856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a86b4eb18144912d55bf9800a3d9fedd?s=128&d=identicon&r=PG", "display_name": "Jrules80", "link": "https://stackoverflow.com/users/2651856/jrules80"}, "edited": false, "score": 1, "creation_date": 1575409542, "post_id": 59165233, "comment_id": 104555490, "body": "Then use SUMIFS(): <code>=SUMIFS(C2:C30,E2:E30,&quot;Carry Over&quot;)</code>"}, {"owner": {"reputation": 117, "user_id": 2651856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a86b4eb18144912d55bf9800a3d9fedd?s=128&d=identicon&r=PG", "display_name": "Jrules80", "link": "https://stackoverflow.com/users/2651856/jrules80"}, "edited": false, "score": 0, "creation_date": 1575409605, "post_id": 59165233, "comment_id": 104555516, "body": "On second thoughts, I think I a &quot;lengthy&quot; workaround would be to get the values of corresponding C column cell value for every &quot;Carry Over&quot;. Definitely not a one liner or an efficient way. Let me know if you have other thoughts."}, {"owner": {"reputation": 117, "user_id": 2651856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a86b4eb18144912d55bf9800a3d9fedd?s=128&d=identicon&r=PG", "display_name": "Jrules80", "link": "https://stackoverflow.com/users/2651856/jrules80"}, "edited": false, "score": 0, "creation_date": 1575409646, "post_id": 59165233, "comment_id": 104555536, "body": "Sounds like a plan :) Let me give it a whirl."}, {"owner": {"reputation": 117, "user_id": 2651856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a86b4eb18144912d55bf9800a3d9fedd?s=128&d=identicon&r=PG", "display_name": "Jrules80", "link": "https://stackoverflow.com/users/2651856/jrules80"}, "edited": false, "score": 0, "creation_date": 1575409776, "post_id": 59165233, "comment_id": 104555571, "body": "Scott - You da man :) Works like a charm. Thank you, kind sir!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1575407483, "last_edit_date": 1575407483, "creation_date": 1575406671, "answer_id": 59165233, "question_id": 59165015, "link": "https://stackoverflow.com/questions/59165015/vba-count-values-based-on-font-color/59165233#59165233", "title": "VBA Count values based on font color", "body": "<p>As per <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.displayformat\" rel=\"nofollow noreferrer\">THIS</a></p>\n\n<blockquote>\n  <p>Actions such as changing the conditional formatting or table style of a range can cause what is displayed in the current user interface to be inconsistent with the values in the corresponding properties of the Range object. Use the properties of the DisplayFormat object to return the values as they are displayed in the current user interface.</p>\n</blockquote>\n\n<p>The only way to get the color due to conditional formatting is to use <code>DisplayFormat</code></p>\n\n<pre><code>If cl.DisplayFormat.Font.Color = vbRed Then\n</code></pre>\n\n<p>But per <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.displayformat\" rel=\"nofollow noreferrer\">THIS</a></p>\n\n<blockquote>\n  <p>Note that the DisplayFormat property does not work in user-defined functions.</p>\n</blockquote>\n\n<p>So one cannot use UDF to count the colors directly from the sheet.  One can use a SUB but it would be easier just to use the same criteria that the custom format uses to count:</p>\n\n<pre><code>=COUNTIF(E2:E30,\"Carry Over\")\n</code></pre>\n\n<p>or to count where it is not red:</p>\n\n<pre><code>=COUNTIF(E2:E30,\"&lt;&gt;Carry Over\")\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 2651856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a86b4eb18144912d55bf9800a3d9fedd?s=128&d=identicon&r=PG", "display_name": "Jrules80", "link": "https://stackoverflow.com/users/2651856/jrules80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 1, "accepted_answer_id": 59165233, "answer_count": 1, "score": 0, "last_activity_date": 1575407519, "creation_date": 1575405735, "last_edit_date": 1575407519, "question_id": 59165015, "link": "https://stackoverflow.com/questions/59165015/vba-count-values-based-on-font-color", "title": "VBA Count values based on font color", "body": "<p>I need to add values of a range when its contents are of a certain font color (e.g., black). What I have is a a table where I am conditionally formatting the color of values. For e.g., if the \"Status =Carry Over\" then I am coloring the row Red. (see attachment).</p>\n\n<p>Now, after the conditional formatting, I want to sum all the number values under a specific column that are <strong>NOT</strong> in red color.</p>\n\n<p>I have a piece of vba code to add such values, but the problem is, the conditional coloring is throwing the code off. As long as I am manually coloring the rows, the code is ignoring the red rows. If I use the conditional coloring option, then even the colored rows are taken into account.</p>\n\n<p>I am calling the below UDF using this formula =ConditionalColorSum(C2:C30)</p>\n\n<pre><code>Public Function ConditionalColorSum(rnge As Range) As Double\n' Total only cells with red font numbers\n    Application.Volatile\n    Dim Total As Double, cl As Range\n    Total = 0\n        For Each cl In rnge.Cells\n            If cl.Font.Color = vbRed Then    'Change 'vbRed' to the color you want\n            Total = Total + cl.Value\n            End If\n        Next\n    ConditionalColorSum = Total\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/AE6Bp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AE6Bp.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/a7qYe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a7qYe.png\" alt=\"enter image description here\"></a></p>\n\n<p>The Conditional formatting formula looks like above:</p>\n"}, {"tags": ["excel", "vba", "spreadsheet"], "comments": [{"owner": {"reputation": 243, "user_id": 8993395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s3fdN.jpg?s=128&g=1", "display_name": "Skoddie", "link": "https://stackoverflow.com/users/8993395/skoddie"}, "edited": false, "score": 0, "creation_date": 1575402264, "post_id": 59164233, "comment_id": 104552602, "body": "Since it looks like you&#39;re moving all of the worksheets into a single workbook first, how do you plan to store the filename? Is using the worksheet name an option?"}, {"owner": {"reputation": 13, "user_id": 12292413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f917524d7c3df675ffb6419b739f822?s=128&d=identicon&r=PG&f=1", "display_name": "PolicyGuy", "link": "https://stackoverflow.com/users/12292413/policyguy"}, "reply_to_user": {"reputation": 243, "user_id": 8993395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s3fdN.jpg?s=128&g=1", "display_name": "Skoddie", "link": "https://stackoverflow.com/users/8993395/skoddie"}, "edited": false, "score": 0, "creation_date": 1575402923, "post_id": 59164233, "comment_id": 104552863, "body": "Yes, my first macro has code that when importing the separate spreadsheets it makes the tab/sheet they import into be named the name of the original file. If there is a macro you suggest that can merge these files into one sheet without first creating a combined workbook, please let me know. For Each wksCurSheet In wbkSrcBook.Sheets                     countSheets = countSheets + 1                     wksCurSheet.Copy After:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)                     wbkCurBook.Sheets(wbkCurBook.Sheets.Count).Name = Left(wksCurSheet.Name &amp; wbkSrcBook.Name, 31)"}, {"owner": {"reputation": 243, "user_id": 8993395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s3fdN.jpg?s=128&g=1", "display_name": "Skoddie", "link": "https://stackoverflow.com/users/8993395/skoddie"}, "edited": false, "score": 0, "creation_date": 1575403071, "post_id": 59164233, "comment_id": 104552928, "body": "That&#39;s less easy, I&#39;m writing something quickly that will do what your question asked efficiently."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12292413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f917524d7c3df675ffb6419b739f822?s=128&d=identicon&r=PG&f=1", "display_name": "PolicyGuy", "link": "https://stackoverflow.com/users/12292413/policyguy"}, "edited": false, "score": 0, "creation_date": 1575471826, "post_id": 59166391, "comment_id": 104579087, "body": "Excellent, thanks so much! One thing I realized is that some of the files DO have a different amount of columns. About halfway through 2017 these weekly personnel files are missing a few fields such as PTO (Paid Time Off). Hence the error message is coming up as intended. Do you know a way to combine these separately or do I need to create batches of files with the same amount of columns and fields? In the latter I would then need to separate 2017 into batches with the same field numbers."}, {"owner": {"reputation": 243, "user_id": 8993395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s3fdN.jpg?s=128&g=1", "display_name": "Skoddie", "link": "https://stackoverflow.com/users/8993395/skoddie"}, "reply_to_user": {"reputation": 13, "user_id": 12292413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f917524d7c3df675ffb6419b739f822?s=128&d=identicon&r=PG&f=1", "display_name": "PolicyGuy", "link": "https://stackoverflow.com/users/12292413/policyguy"}, "edited": false, "score": 0, "creation_date": 1575477818, "post_id": 59166391, "comment_id": 104582615, "body": "@PolicyGuy The macro isn&#39;t checking the column headers, so if there are missing columns in the middle then the data will be misaligned. I&#39;d really recommend having all of your data in the same general &#39;shape&#39; before combining it. Working around that would make the code much more complex."}, {"owner": {"reputation": 243, "user_id": 8993395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s3fdN.jpg?s=128&g=1", "display_name": "Skoddie", "link": "https://stackoverflow.com/users/8993395/skoddie"}, "reply_to_user": {"reputation": 13, "user_id": 12292413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f917524d7c3df675ffb6419b739f822?s=128&d=identicon&r=PG&f=1", "display_name": "PolicyGuy", "link": "https://stackoverflow.com/users/12292413/policyguy"}, "edited": false, "score": 0, "creation_date": 1575479905, "post_id": 59166391, "comment_id": 104583798, "body": "@PolicyGuy Please upvote and accept the answer when you have a moment if/when it fits your needs :)"}, {"owner": {"reputation": 13, "user_id": 12292413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f917524d7c3df675ffb6419b739f822?s=128&d=identicon&r=PG&f=1", "display_name": "PolicyGuy", "link": "https://stackoverflow.com/users/12292413/policyguy"}, "edited": false, "score": 1, "creation_date": 1575486367, "post_id": 59166391, "comment_id": 104586838, "body": "Right, makes sense. The macro does work for those spreadsheets with the same number of columns. Thanks again friend! I am new to this relatively. How do I accept the answer? It says I can&#39;t upvote visibly until I have 15 reputation."}, {"owner": {"reputation": 243, "user_id": 8993395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s3fdN.jpg?s=128&g=1", "display_name": "Skoddie", "link": "https://stackoverflow.com/users/8993395/skoddie"}, "reply_to_user": {"reputation": 13, "user_id": 12292413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f917524d7c3df675ffb6419b739f822?s=128&d=identicon&r=PG&f=1", "display_name": "PolicyGuy", "link": "https://stackoverflow.com/users/12292413/policyguy"}, "edited": false, "score": 0, "creation_date": 1575488797, "post_id": 59166391, "comment_id": 104587785, "body": "@PolicyGuy There should be a little check mark underneath the voting buttons"}], "tags": [], "owner": {"reputation": 243, "user_id": 8993395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s3fdN.jpg?s=128&g=1", "display_name": "Skoddie", "link": "https://stackoverflow.com/users/8993395/skoddie"}, "is_accepted": true, "score": 0, "last_activity_date": 1575412361, "creation_date": 1575412361, "answer_id": 59166391, "question_id": 59164233, "link": "https://stackoverflow.com/questions/59164233/adding-a-column-to-multiple-excel-spreadsheets-with-column-entries-being-the-na/59166391#59166391", "title": "Adding a column to multiple excel spreadsheets, with column entries being the name of the excel filename. Then combining sheets into one spreadsheet", "body": "<p>This is maybe long winded, and may have missed the mark, but the macro below will combine the values of multiple worksheets that share dimensions and a header row into a new worksheet with an additional column for the filename and only one header row.</p>\n\n<p>It will not preserve source formatting or formulas, and it uses arrays to build the new worksheet in VBA-space for speed reasons. I've also included an error check if the input sheets have a different number of columns.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPublic Sub Merge_Sheets()\n    On Error GoTo ErrorHandler\n\n    Dim ws As Worksheet\n    Dim varInput() As Variant\n    Dim varOutput() As Variant\n    Dim colData As Collection\n    Dim colWsName As Collection\n    Dim lRows As Long\n    Dim lColumns As Long\n    Dim lOutputRow As Long\n    Dim i As Long\n    Dim j As Long\n    Dim k As Long\n    Dim l As Long\n\n    OptimizationON\n\n    Set colData = New Collection\n    Set colWsName = New Collection\n\n    'Loads source data into Array, then loads array into a collection\n    For Each ws In ActiveWorkbook.Worksheets\n        varInput() = ws.UsedRange.Value2\n        colData.Add varInput()\n        colWsName.Add ws.name\n\n    Next ws\n\n    lRows = 0\n    lColumns = 0\n\n    'Determines how many rows and columns the final output array will need\n    For i = 1 To colData.Count\n        lRows = lRows + UBound(colData(i))\n\n        If i = 1 Then\n            lColumns = UBound(colData(i), 2)\n\n        Else\n            If lColumns &lt;&gt; UBound(colData(i), 2) Then\n                MsgBox \"Input worksheets have a different number of columns!\", vbCritical, \"ERROR!\"\n                OptimizationOFF\n                Exit Sub\n\n            End If\n\n        End If\n\n    Next i\n\n    lColumns = lColumns + 1\n    lRows = lRows - i + 2\n\n    'Initializes the output array\n    ReDim varOutput(1 To lRows, 1 To lColumns)\n\n    'Loads the data into the output array\n    lOutputRow = 1\n    l = 0\n\n    For i = 1 To colData.Count\n        If i &gt; 1 Then l = 1\n\n        For j = 1 To UBound(colData(i)) - l\n            For k = 1 To UBound(colData(i), 2) + 1\n                If k = 1 Then\n                    If lOutputRow = 1 Then\n                        varOutput(lOutputRow, k) = \"Filename\"\n\n                    Else\n                        varOutput(lOutputRow, k) = colWsName(i)\n\n                    End If\n\n                Else\n                    varOutput(lOutputRow, k) = colData(i)(j + l, k - 1)\n\n                End If\n            Next k\n\n            lOutputRow = lOutputRow + 1\n\n        Next j\n\n    Next i\n\n    'Creates a new worksheet and loads the data into it\n    Set ws = ActiveWorkbook.Sheets.Add\n\n    ws.name = \"YearlyCompilation\"\n\n    ArrayToWorksheet varOutput(), ws\n\nErrorHandler:\n    OptimizationOFF\n\nEnd Sub\n\nPrivate Sub ArrayToWorksheet(ByVal varArray As Variant, ByRef ws As Worksheet)\n    'Loads an array into a worksheet\n    Dim range As range\n\n    Set range = ws.range(\"A1\")\n\n    Debug.Assert range.Address = \"$A$1\"\n\n    Set range = range.Resize(UBound(varArray, 1), UBound(varArray, 2))\n\n    range.Value2 = varArray\n\nEnd Sub\n\nPrivate Sub OptimizationON()\n    'Disables certain features to speed up calculation\n    With Application\n        .ScreenUpdating = False\n        .DisplayStatusBar = False\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n        .PrintCommunication = False\n\n    End With\n\nEnd Sub\n\nPrivate Sub OptimizationOFF()\n    'Re-enables disabled features\n    With Application\n        .ScreenUpdating = True\n        .DisplayStatusBar = True\n        .Calculation = xlCalculationAutomatic\n        .EnableEvents = True\n        .PrintCommunication = True\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12292413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f917524d7c3df675ffb6419b739f822?s=128&d=identicon&r=PG&f=1", "display_name": "PolicyGuy", "link": "https://stackoverflow.com/users/12292413/policyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 59166391, "answer_count": 1, "score": 0, "last_activity_date": 1575412361, "creation_date": 1575401927, "last_edit_date": 1575403047, "question_id": 59164233, "link": "https://stackoverflow.com/questions/59164233/adding-a-column-to-multiple-excel-spreadsheets-with-column-entries-being-the-na", "title": "Adding a column to multiple excel spreadsheets, with column entries being the name of the excel filename. Then combining sheets into one spreadsheet", "body": "<p>I need to merge multiple spreadsheets into not only one workbook, but also into one combined spreadsheet. Each file has over 1000 rows and there are three directories with about 40-50 such files. These can be combined separately as they represent personnel records across three years.</p>\n\n<p>I have a VBA Macro that successfully places the sheets into one workbook. I also have a Macro for combining these sheets into one appended spreadsheet. However, I need to take out the header row for each successive file data addition after the first row of the combined file. </p>\n\n<p>Further, I need to either use a Macro to create a column in each file with each row being filled with the file name (such that once combined with the other files it is clear which source each data point is coming from) or find a Macro that does this while combining the sheets. If it's the former using a Macro that does this for every file, prior to my using the single spreadsheet combination Macro, then all I need is an update to my final Macro that only puts a header row for the first row. Here is an example of the data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mdLBi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mdLBi.png\" alt=\"enter image description here\"></a>   </p>\n\n<p>I need the final file to have the column in A, the newly created column, have the file name of each file source from which the row came. See an example below of what I'd like the combined result to look like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/L9tmx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L9tmx.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the Macro I am using for combining the multiple tabs/spreadsheets into one spreadsheet:</p>\n\n<pre><code>Sub Merge_Sheets()\n    'Insert a new worksheet\n    Sheets.Add\n\n    'Rename the new worksheet\n    ActiveSheet.Name = \"YearlyCompilation\"\n\n    'Loop through worksheets and copy the to your new worksheet\n    For Each ws In Worksheets\n        ws.Activate\n\n        'Don't copy the merged sheet again\n        If ws.Name &lt;&gt; \"YearlyCompilation\" Then\n            ws.UsedRange.Select\n            Selection.Copy\n            Sheets(\"YearlyCompilation\").Activate\n\n            'Select the last filled cell\n            ActiveSheet.Range(\"A1048576\").Select\n            Selection.End(xlUp).Select\n\n            'For the first worksheet you don't need to go down one cell\n            If ActiveCell.Address &lt;&gt; \"$A$1\" Then\n                ActiveCell.Offset(1, 0).Select\n            End If\n\n            'Instead of just paste, you can also paste as link, as values etc.\n            ActiveSheet.Paste\n\n        End If\n\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10022011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XketI.png?s=128&g=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/10022011/lukas"}, "edited": false, "score": 0, "creation_date": 1575437887, "post_id": 59164793, "comment_id": 104562123, "body": "But what if I don&#39;t know the exact names of the files and I don&#39;t know what the number of them will be. I need to change this: <code>Set wb = Workbooks.Open(ThisWorkbook.Path &amp; &quot;\\Source&quot; &amp; i &amp; &quot;.xls&quot;)</code> to something like this: <code>Set wb = Workbooks.Open(ThisWorkbook.Path &amp; &quot;\\*&quot; &amp; &quot;.xls&quot;) but it doesn&#39;t work</code>."}, {"owner": {"reputation": 11, "user_id": 10022011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XketI.png?s=128&g=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/10022011/lukas"}, "edited": false, "score": 0, "creation_date": 1575439335, "post_id": 59164793, "comment_id": 104562529, "body": "At first I wonder if there&#39;s easier way to make simple foreach loop which would take all the data (for specific range) from every file in this folder to one Workbook. Beacuse despite the fact that I don&#39;t quite know what is going on in this code, it seems to me that it does a lot of unnecessary things."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 11, "user_id": 10022011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XketI.png?s=128&g=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/10022011/lukas"}, "edited": false, "score": 0, "creation_date": 1575486706, "post_id": 59164793, "comment_id": 104586970, "body": "@Lukas: Answer updated. If you did not write the original code, perhaps starting again so you can use code you understand would help?"}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 1, "last_activity_date": 1575486583, "last_edit_date": 1575486583, "creation_date": 1575404687, "answer_id": 59164793, "question_id": 59163804, "link": "https://stackoverflow.com/questions/59163804/consolidate-data-from-multiple-workbooks-in-a-single-worksheet/59164793#59164793", "title": "Consolidate data from multiple workbooks in a single worksheet", "body": "<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dir-function\" rel=\"nofollow noreferrer\"><code>Dir()</code></a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/filesystemobject-object\" rel=\"nofollow noreferrer\"><code>FileSystemOpbect</code></a> can be used to find relevant files. The FileSystemObject can be used to locate the Folder, and the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/files-property\" rel=\"nofollow noreferrer\"><code>Files</code></a> collection can return a list of files. There are plenty of answers here on StackOverflow that describe the use of both methods.</p>\n\n<p>Im the original code, the workbooks are all opened first. Once you have opened the workbooks:</p>\n\n<pre><code>For Each wb in Application.Workbooks\n    ' Code here\nNext wb\n</code></pre>\n\n<p>An alternative approach is to have an array of names of workbooks:</p>\n\n<pre><code>Dim wbNames as Variant\nDim wbName as String\nDim iterator as Lon\n\nwbNames = Array(\"1.xls\", \"2.xls\")\nFor iterator = LBound(wbNames) to UBound(wbNames)\n    wbName = ThisWorkbook.Path &amp; \"\\\" &amp; wbNames(iterator)\n    Set wb = Application.Workbooks.Open(wbName)\n    ' Code here\nNext iterator\n</code></pre>\n\n<p>But, if you are using the <code>Files</code> collection, you could also use the lines</p>\n\n<pre><code>For each fFile in foundFiles '&lt;--- remember to declare!\n    wbName = ThisWorkbook.Path &amp; \"\\\" &amp; fFile.Name\n</code></pre>\n\n<p>Depending on how you extract the file names, you could even use:</p>\n\n<pre><code>    wbName = fFile.Path &amp; fFile.Name ` Check this, can't remember if Path includes file name\n</code></pre>\n\n<p>Breaking code down into manageable chunks by creating sub-functions is usually a good idea too.</p>\n"}], "owner": {"reputation": 11, "user_id": 10022011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XketI.png?s=128&g=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/10022011/lukas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575486583, "creation_date": 1575400071, "question_id": 59163804, "link": "https://stackoverflow.com/questions/59163804/consolidate-data-from-multiple-workbooks-in-a-single-worksheet", "title": "Consolidate data from multiple workbooks in a single worksheet", "body": "<p><br><br>\nI would like to create a macro function that allows you to collect data from many Excel files (Workbooks) into one a summary statement for a specific stage of implementation and deadline in another file. <br><br>\nAll those files will be collected in one folder (also this summary file). \nI would like to choose the implementation stage and deadline by manually entering (input box) or selecting from the drop-down list of available options after running the macro function (eg. Phase1, term 40 \u2013 like on screenshot) and should be supported if another phase is added.<br><br>\nAfter going through all the files in the above-mentioned folder (completing the data download), macro function needs to sort this data by name or index and calculate the total amount of demand (sum of quantities). (select and calculate values \u200b\u200bfor unique items) but before that it need to sort it in such a way that only the main indexes will be taken for calculations and for the final result (eg. only  1, 2, 3 without 1.1., 1.1.1, 1.2., 2.1. etc). I would like to avoid using filters and pivot table for this if that\u2019s possible and all of this should be done by one macro function. <br><br>\nAll of those files will always have only one sheet and may have different names. <br><br>\nI have to do that but i don\u2019t have any knowledge about programming in VBA or even making marcos In Excel so I would be grateful for any help. <br><br>\nI'm adding some screenshots how i see that should working (for Phase 1 and Term 40) and I hope that will help to understand my problem.<a href=\"https://i.stack.imgur.com/ApvAQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ApvAQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>At this moment I'm working with that code and it works pretty well but i don't know how to change name for reading Workbooks form \"Source\" to \"*\" - any name (i mean this Path to file) and loop that for bigger amout of files. Also don't know if i should make another macro for filtering data or combine with this.</p>\n\n<pre><code>Sub CollectData()\n\nDim i As Long, lCurrRow As Long, lRow As Long, n As Long\nDim wb As Workbook, ans As VbMsgBoxResult\n\nFor i = 1 To 5 Step 1\n\nOn Error Resume Next\nSet wb = Workbooks.Open(ThisWorkbook.Path &amp; \"\\Source\" &amp; i &amp; \".xls\")\nIf Not Err.Number = 0 Then\n  Err.Clear\n\n  Set wb = Workbooks.Open(ThisWorkbook.Path &amp; \"\\Source \" &amp; i &amp; \".xls\")\n  If Not Err.Number = 0 Then\n    Err.Clear\n\n    ans = MsgBox(\"Could not find Source \" &amp; i &amp; \" Workbook.\" &amp; vbNewLine &amp; \"Do you wis\" &amp; _\n                 \"h to continue?\", vbInformation + vbYesNo, \"Error\")\n    If ans = vbNo Then Exit Sub\n    GoTo NextI\n  End If\nEnd If\n\nWith wb.Sheets(\"RAW_DATA\")\n  If Not Err.Number = 0 Then\n    Err.Clear\n\n    ans = MsgBox(\"Could not find Source \" &amp; i &amp; \" Workbook's 'Data Output' tab.\" &amp; _\n                 vbNewLine &amp; \"Do you wish to continue?\", vbInformation + vbYesNo, \"Error\")\n    If ans = vbNo Then\n      wb.Close False\n      Exit Sub\n    End If\n    GoTo NextI\n  End If\n\n  If i = 1 Then\n    lRow = 1\n  Else\n    lRow = 2\n  End If\n\n  Do Until .Range(\"A\" &amp; lRow).Value = vbNullString\n    lCurrRow = lCurrRow + 1\n    For n = 0 To 6 Step 1\n      Me.Range(\"A\" &amp; lCurrRow).Offset(ColumnOffset:=n).Value = .Range(\"A\" &amp; lRow).Offset(ColumnOffset:=n).Value\n    Next n\n    lRow = lRow + 1\n  Loop\nEnd With\n  NextI:\n  wb.Close False\nNext i\nSet wb = Nothing\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1575400126, "post_id": 59163794, "comment_id": 104551653, "body": "Please <a href=\"https://stackoverflow.com/posts/59163794/edit\">edit your question</a> to show us what you have tried so far."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1575400874, "creation_date": 1575400874, "answer_id": 59163997, "question_id": 59163794, "link": "https://stackoverflow.com/questions/59163794/line-chart-shows-all-available-data-series-in-gray-need-to-colorize-only-select/59163997#59163997", "title": "Line chart shows all available data series in gray, need to colorize only selected series and only display these in legend", "body": "<p>You don't need VBA to do that. This can be done entirely in the worksheet. Conceptually:</p>\n\n<ul>\n<li>create five data validation cells where people can select the (up to ) five data series</li>\n<li>use formulas next to these five cells to look up the data for that series from your main chart data source. This will create a range with five rows of data that is the same shape as your chart source data</li>\n<li>add these additional rows to the chart and format the lines with colors. Use the series order to determine which lines sit on top of others.</li>\n<li>remove the original grey data series from the legend.</li>\n</ul>\n\n<p>Now the user can select different constituents and the selected ones will be plotted in color, their names will be in the legend and the rest of the chart remains grey.</p>\n"}, {"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1576213634, "creation_date": 1576213634, "answer_id": 59316426, "question_id": 59163794, "link": "https://stackoverflow.com/questions/59163794/line-chart-shows-all-available-data-series-in-gray-need-to-colorize-only-select/59316426#59316426", "title": "Line chart shows all available data series in gray, need to colorize only selected series and only display these in legend", "body": "<p>In <a href=\"https://peltiertech.com/interactive-controls-to-highlight-selected-data-in-an-excel-chart/\" rel=\"nofollow noreferrer\">Using Worksheet Controls to Highlight Selected Data in an Excel Chart</a> I show how to construct a chart with lots of gray series, and use listboxes to select which series to display in color. No VBA, just worksheet formulas.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SulDw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SulDw.png\" alt=\"Line Chart with Selectively Highlighted Series\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 5604657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f2ea6ab854d1fde5b49405484331e89?s=128&d=identicon&r=PG&f=1", "display_name": "Top_Meat", "link": "https://stackoverflow.com/users/5604657/top-meat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576213634, "creation_date": 1575399997, "last_edit_date": 1575400088, "question_id": 59163794, "link": "https://stackoverflow.com/questions/59163794/line-chart-shows-all-available-data-series-in-gray-need-to-colorize-only-select", "title": "Line chart shows all available data series in gray, need to colorize only selected series and only display these in legend", "body": "<p>I would appreciate help creating a macro that will colorize selected data series from a list and only display these in the legend for this chart:</p>\n\n<p><a href=\"https://i.stack.imgur.com/U73CW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U73CW.png\" alt=\"enter image description here\"></a></p>\n\n<p>From the list of 19 constituents, I would like to number the selected series 1 - 5 so that up to five series can be shown in color among the gray non-selected series.</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575399432, "post_id": 59163618, "comment_id": 104551362, "body": "<code>WorksheetFunction.Match</code> will throw that error if no match. One alternative is to use <code>Application.Match</code> and then test if the result is an error with <code>IsError</code>."}, {"owner": {"reputation": 177, "user_id": 12469023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db8650a2bf5b80503a1307217640204f?s=128&d=identicon&r=PG&f=1", "display_name": "EmmaG", "link": "https://stackoverflow.com/users/12469023/emmag"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575399776, "post_id": 59163618, "comment_id": 104551500, "body": "You mean like this: &quot; Worksheets(&quot;PCAM Commitments&quot;).Cells(i, Value) = WorksheetFunction.IsError(WorksheetFunction.Index(lookRange, Application.Match(Worksheets(&quot;PCAM Commitments&quot;).Cells(i, ID).Value, StartRange, 0), 2), &quot;Include&quot;) &quot;?...It&#39;s not working either"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575399851, "post_id": 59163618, "comment_id": 104551531, "body": "Not <code>WorksheetFunction.IsError</code>, but the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/iserror-function\" rel=\"nofollow noreferrer\"><code>IsError</code></a> function. You&#39;ll need to split this out into multiple lines."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575399952, "post_id": 59163618, "comment_id": 104551573, "body": "Another option is to use <code>Evaluate</code> with your original formula."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1575400876, "post_id": 59163618, "comment_id": 104551993, "body": "In my opinion, the best option will be to get rid of long <code>WorksheetFunction</code> and use other vba tools. Do I understand correctly that you need to go through sheet PCAM Commitments, take a pair of values from columns A and B, find same pair on Exclusions sheet in columns C and B, and fill the column G of PCAM Commitments sheet appropriately?"}, {"owner": {"reputation": 177, "user_id": 12469023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db8650a2bf5b80503a1307217640204f?s=128&d=identicon&r=PG&f=1", "display_name": "EmmaG", "link": "https://stackoverflow.com/users/12469023/emmag"}, "reply_to_user": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1575401459, "post_id": 59163618, "comment_id": 104552246, "body": "@VitaliyPrushak Yes. Except on PCAM Commitments, I only need to care about column A. So, I need to find Column A (of PCAM Commitments) values in Column B of Exclusions, then fill the column G of PCAM Commitments with corresponding values from Columns C of Exclusions. If a value doesn&#39;t exist, then I want it automatically show as &quot;Include&quot; in Column G."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1575401970, "post_id": 59163618, "comment_id": 104552487, "body": "Why not just use the formula?"}, {"owner": {"reputation": 177, "user_id": 12469023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db8650a2bf5b80503a1307217640204f?s=128&d=identicon&r=PG&f=1", "display_name": "EmmaG", "link": "https://stackoverflow.com/users/12469023/emmag"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1575402256, "post_id": 59163618, "comment_id": 104552599, "body": "@SJR long story in short, I have to use Alteryx for data transferring, and Alteryx will erase formulas in its overwriting process, so I have to use VBA"}, {"owner": {"reputation": 177, "user_id": 12469023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db8650a2bf5b80503a1307217640204f?s=128&d=identicon&r=PG&f=1", "display_name": "EmmaG", "link": "https://stackoverflow.com/users/12469023/emmag"}, "reply_to_user": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1575402309, "post_id": 59163618, "comment_id": 104552625, "body": "@VitaliyPrushak What do you mean other vba tools?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1575402326, "post_id": 59163618, "comment_id": 104552630, "body": "Load everything into variant arrays, output to a variant array and loop those."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1575402394, "post_id": 59163618, "comment_id": 104552654, "body": "@EmmaG see my answer"}], "answers": [{"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": true, "score": 0, "last_activity_date": 1575404083, "creation_date": 1575404083, "answer_id": 59164662, "question_id": 59163618, "link": "https://stackoverflow.com/questions/59163618/how-if-use-ifna-in-vba-combined-with-index-match/59164662#59164662", "title": "How if use IFNA in VBA (combined with Index/Match)", "body": "<p>Try it with Vlookup and Application instead of Worksheetfunction,like this:</p>\n\n<pre><code>With Application\nFor i = 2 To LastRow\n    Worksheets(\"PCAM Commitments\").Cells(i, Value) = .IfNa(.VLookup(Worksheets(\"PCAM Commitments\").Cells(i, ID).Value, lookRange, 2, False), \"Include\")\nNext i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 12469023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db8650a2bf5b80503a1307217640204f?s=128&d=identicon&r=PG&f=1", "display_name": "EmmaG", "link": "https://stackoverflow.com/users/12469023/emmag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1509, "favorite_count": 0, "accepted_answer_id": 59164662, "answer_count": 1, "score": 1, "last_activity_date": 1575404918, "creation_date": 1575399290, "last_edit_date": 1575399480, "question_id": 59163618, "link": "https://stackoverflow.com/questions/59163618/how-if-use-ifna-in-vba-combined-with-index-match", "title": "How if use IFNA in VBA (combined with Index/Match)", "body": "<p>I have two sheets. One is called \u201cExclusions\u201d, the other one is called \u201cPCAM Commitments.\u201d Exclusions sheet ONLY contains the projects with a status of \u201cExclude\u201d. PCAM Commitments sheet have all the projects (so both \u201cInclude\u201d and \u201cExclude\u201d projects).\n<a href=\"https://i.stack.imgur.com/9VX17.png\" rel=\"nofollow noreferrer\">Exclusions Sheet</a>; <a href=\"https://i.stack.imgur.com/7Qb5E.png\" rel=\"nofollow noreferrer\">PCAM Commitments Sheet</a></p>\n\n<p>I need to match these Exclude/Include values in Column G of the PCAM Commitments sheet. Since projects with a status of \u201cInclude\u201d are not on the \u201cExclusions\u201d sheet, I need to use IFNA function.</p>\n\n<p>This formula will do the job:\n=IFNA(INDEX(Exclusions!B2:C100, MATCH('PCAM Commitments'!A2,Exclusions!B2:B100,0),2), \"Include\")</p>\n\n<p>But I am having troubles to convert this formula to vba code.</p>\n\n<pre><code>Sub ExIn()\n\nDim i As Integer\nDim lookRange As Range\nDim StartRange As Range\nDim LastRow As Integer\n\nDim ID As Long\nDim Value As Long\n\nID = Application.Match(\"PO/SO\", Rows(1), 0)\nValue = Application.Match(\"Ex/In\", Rows(1), 0)\n\nLastRow = Sheets(\"PCAM Commitments\").Cells(Rows.Count, \"A\").End(xlUp).Row\nSet lookRange = Sheets(\"Exclusions\").Range(\"B2:C136\")\nSet StartRange = Sheets(\"Exclusions\").Range(\"B2:B136\")\n\n\nFor i = 2 To LastRow\n    Worksheets(\"PCAM Commitments\").Cells(i, Value) = WorksheetFunction.IfNa(WorksheetFunction.Index(lookRange, WorksheetFunction.Match(Worksheets(\"PCAM Commitments\").Cells(i, ID).Value, StartRange, 0), 2), \"Include\")\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>This is what I have now. Whenever I run it, an error message will pop up saying \u201cUnable to get the Match property of the WorksheetFunction class\u2026. Any help would be appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 109, "user_id": 10508937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3112d44576ab4ab57e82b79d637f64c2?s=128&d=identicon&r=PG", "display_name": "PhilNBlanks", "link": "https://stackoverflow.com/users/10508937/philnblanks"}, "edited": false, "score": 0, "creation_date": 1575398048, "post_id": 59163275, "comment_id": 104550823, "body": "I have also tried <code>If InDateRange Then</code> without the parentheses"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1575398422, "post_id": 59163275, "comment_id": 104550960, "body": "What is <code>Column_Letter</code>? Though I suppose it is unnecessary as you could just use <code>Cells</code> here instead of <code>Range</code>: <code>Set DateCell = Cells(1, ActiveCell.Column)</code>. Also - <code>InDateRange</code> should <b>really</b> be passed a worksheet parameter, otherwise you&#39;re working off the active sheet."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1575399562, "post_id": 59163275, "comment_id": 104551415, "body": "I&#39;d like to add, that you may omit <code>Dim DateCell As Range: Set DateCell = Cells(1, ActiveCell.Column)</code> in you function and just pass it as a parameter: <code>Public Function InDateRange(DateCell As Range) As Boolean</code> and call it like this <code>If InDateRange(&gt;pass_the_date_range&lt;) Then</code>. Also, using <code>.CurrentRegion</code> is a tricky thing."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 10508937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3112d44576ab4ab57e82b79d637f64c2?s=128&d=identicon&r=PG", "display_name": "PhilNBlanks", "link": "https://stackoverflow.com/users/10508937/philnblanks"}, "edited": false, "score": 0, "creation_date": 1575677038, "post_id": 59163917, "comment_id": 104658852, "body": "AsUsual your answer was perfect. Thanx"}], "tags": [], "owner": {"reputation": 459, "user_id": 10547271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/59Gqb.png?s=128&g=1", "display_name": "AsUsual", "link": "https://stackoverflow.com/users/10547271/asusual"}, "is_accepted": true, "score": 1, "last_activity_date": 1575402627, "last_edit_date": 1575402627, "creation_date": 1575400510, "answer_id": 59163917, "question_id": 59163275, "link": "https://stackoverflow.com/questions/59163275/why-does-my-function-fail-when-moved-to-personal-xlsb/59163917#59163917", "title": "Why does my function fail when moved to Personal.xlsb?", "body": "<p>This works..</p>\n\n<p>Personal.xlsb:</p>\n\n<pre><code>Public Function InDateRange(DateCell As Double, hMin As Double, hMax As Double) As Boolean\n    If DateCell &gt; hMin And DateCell &lt; hMax Then InDateRange = True\nEnd Function\n</code></pre>\n\n<p>Worksheet/Module:</p>\n\n<pre><code>Sub Filter_Summary()\n    If Application.Run(\"PERSONAL.XLSB!InDateRange\", Cells(1, ActiveCell.Column), [HISTMIN], [HISTMAX]) = True Then\n        With Sheets(\"HistoryRptSummary\").Range(\"A1\").CurrentRegion\n            .Range(\"A1:AH3000\").AutoFilter Field:=2, Criteria1:=\"&gt;=\" &amp; .Range(\"STARTDATE\"), _\n            Operator:=xlAnd, Criteria2:=\"&lt;\" &amp; .Range(\"ENDDATE\")     '.Range(\"F1\").Value\n        End With\n    Else\n        MsgBox \"Error msg\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 10508937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3112d44576ab4ab57e82b79d637f64c2?s=128&d=identicon&r=PG", "display_name": "PhilNBlanks", "link": "https://stackoverflow.com/users/10508937/philnblanks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 59163917, "answer_count": 1, "score": 0, "last_activity_date": 1575402627, "creation_date": 1575397785, "last_edit_date": 1575398501, "question_id": 59163275, "link": "https://stackoverflow.com/questions/59163275/why-does-my-function-fail-when-moved-to-personal-xlsb", "title": "Why does my function fail when moved to Personal.xlsb?", "body": "<p>I have a function that checks if a date value is between two dates and returns \"True\" if it is and \"False otherwise.</p>\n\n<p>The problem I'm having is that the function works perfectly if it is in the same module where it is being called from but produces \"Compile error: Expected Function or variable\" if it is in PERSONAL.XLSB.</p>\n\n<p>I have a reference set to personal.xlsb in my project and all my other other Functions and Subs located in Personal.xlsb work without a problem.</p>\n\n<p>Here is the Function in question:</p>\n\n<pre><code>Public Function InDateRange() As Boolean\n     Dim DateCell As Range\n          Set DateCell = Range(Column_Letter(ActiveCell.Column) &amp; 1)\n\n     If DateCell &lt; Range(\"HISTMIN\") Or DateCell &gt; Range(\"HISTMAX\") Then\n          InDateRange = False\n     Else\n          InDateRange = True\n     End If\nEnd Function\n</code></pre>\n\n<p>And here is the routine that calls it:</p>\n\n<pre><code>Sub Filter_Summary()\n     If InDateRange() Then\n           With Sheets(\"HistoryRptSummary\").Range(\"A1\").CurrentRegion\n                .Range(\"A1:AH3000\").AutoFilter Field:=2, Criteria1:=\"&gt;=\" &amp; .Range(\"STARTDATE\"), _\n                Operator:=xlAnd, Criteria2:=\"&lt;\" &amp; .Range(\"ENDDATE\")     '.Range(\"F1\").Value\n           End With\n      Else\n           'Send Error msg\n      End If\nEnd Sub\n</code></pre>\n\n<p>I have tried send \"Range(Column_Letter(ActiveCell.Column) &amp; 1)\" as an argument (as type Range and as type String) but got the error \"Wrong number of arguments or invalid property assignment\"</p>\n\n<p>Any help will be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "caching", "pivot-table"], "comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1575440971, "post_id": 59163181, "comment_id": 104562998, "body": "Instead of <code>.ChangePivotCache</code> suggest to redefine the <code>SourceData</code> (i.e.: your code changes the <code>SourceData</code> to the name <code>Data2</code>, assuming the <code>SourceData</code> before the change is a named <code>Data1</code> just try redefining the name <code>Data1</code> to the required size."}, {"owner": {"reputation": 1, "user_id": 12475639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cec73bef64762e265d60d8ed3ce11e?s=128&d=identicon&r=PG&f=1", "display_name": "Crazyrph", "link": "https://stackoverflow.com/users/12475639/crazyrph"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1575551611, "post_id": 59163181, "comment_id": 104610078, "body": "It is not named but I could make that happen and try it out. Thanks"}, {"owner": {"reputation": 1, "user_id": 12475639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cec73bef64762e265d60d8ed3ce11e?s=128&d=identicon&r=PG&f=1", "display_name": "Crazyrph", "link": "https://stackoverflow.com/users/12475639/crazyrph"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1575558417, "post_id": 59163181, "comment_id": 104613981, "body": "So the existing source data is not named and of the format &#39;Test Data Insert&#39;!$A$2:$P$100000. So redefining the name will not work without losing my columns."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1575562315, "post_id": 59163181, "comment_id": 104616182, "body": "So you have a sheet named &quot;Administration Review&quot; where a pivottable named &quot;PivotTable2&quot; refers to range A2:P100000 of a sheet named &quot;Test Data Insert&quot;. I erroneously thought, that the <code>PivotTable(...).PivotCache.Sourcedata</code> could be set easily to another Range (while preventing a table update), but did not succeed either. So I deleted my answer. Sorry."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1575574294, "post_id": 59163181, "comment_id": 104621999, "body": "Are the headers of the prior <code>SourceData</code> and new <code>SourceData</code> the same?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1575607307, "post_id": 59163181, "comment_id": 104631416, "body": "It seems that Excel is performing as designed, however in order to explain the discrepancies between your expectations and the performance of excel, we need relevant information such as (include all these in your post) :   1. Screenshot of the <code>PivotTable</code> before applying the <code>ChangePivotCache</code> command,   2. Screenshot of the original <code>SourceData</code> range, ensure that the header is included (highlight the column you need to delete), and    3. Screenshot of the <code>Data2</code> range (including header)"}, {"owner": {"reputation": 1, "user_id": 12475639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cec73bef64762e265d60d8ed3ce11e?s=128&d=identicon&r=PG&f=1", "display_name": "Crazyrph", "link": "https://stackoverflow.com/users/12475639/crazyrph"}, "edited": false, "score": 0, "creation_date": 1575654224, "post_id": 59163181, "comment_id": 104651646, "body": "They are not the same until I run some VBA to make them the same."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1576009132, "post_id": 59163181, "comment_id": 104756564, "body": "So this two SourceDatas are different and located in different addresses, then you ran some vba procedures to make then the same (i.e. to contain the same fields\\header) its that correct?.   BTW the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.pivottable\" rel=\"nofollow noreferrer\">PivotTable</a> properties associated with <code>Preserve cell formatting on update</code> and <code>Number of items to retain per field</code> have nothing to do with a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.pivotfield\" rel=\"nofollow noreferrer\">PivotField</a><code>.Orientation</code>"}], "owner": {"reputation": 1, "user_id": 12475639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cec73bef64762e265d60d8ed3ce11e?s=128&d=identicon&r=PG&f=1", "display_name": "Crazyrph", "link": "https://stackoverflow.com/users/12475639/crazyrph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575468120, "creation_date": 1575397385, "last_edit_date": 1575468120, "question_id": 59163181, "link": "https://stackoverflow.com/questions/59163181/loss-of-pivot-columns-when-using-pivotcaches-create-with-new-data-source", "title": "Loss of pivot columns when using pivotcaches.create with new data source", "body": "<p>I am faced with an issue with my data and pivot table VBA.<br>\nMy data now adds a new blank column on the far left. I must delete this column so that my data fits in the correct range and the column all have a header as before. When I delete this column, the range of the source data changes minus the deleted column. </p>\n\n<p>Questions:</p>\n\n<ol>\n<li>Is there a way to prevent the data source from changing when\ndeleting the column?</li>\n<li>Is there a way to prevent the following vba\nfrom removing the missing columns in the pivot table that are not\nfound in the new data.</li>\n</ol>\n\n<p><code>ActiveSheet.PivotTables(\"PivotTable2\").ChangePivotCache ActiveWorkbook. _\n    PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"Data2\", Version:=6)</code></p>\n\n<p>This line of code seems to remove columns from the pivot for the pivot table field instead of leaving them. I have already ensured the following options are set before running the code above:</p>\n\n<ul>\n<li>Preserve cell formatting on update - is checked</li>\n<li>Number of items to retain per field - is set to max</li>\n</ul>\n\n<p>When the code runs, it reverts the \"Number of items to retain per field\" back to automatic and I lose the columns.</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575395246, "post_id": 59162622, "comment_id": 104549654, "body": "<a href=\"https://stackoverflow.com/questions/4507350/provide-a-range-selection-tool-utility-to-the-user-in-excel-vba\" title=\"provide a range selection tool utility to the user in excel vba\">stackoverflow.com/questions/4507350/&hellip;</a>"}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 0, "creation_date": 1575395360, "post_id": 59162622, "comment_id": 104549711, "body": "Which error did you get, and on which line?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1575395655, "post_id": 59162622, "comment_id": 104549845, "body": "<code>userstarting = txtStarting.Value</code> is not how you <code>set</code> a range.  It also needs to be a valid address."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1575396309, "post_id": 59162622, "comment_id": 104550115, "body": "Does <code>txtStarting</code> contain the sheet name or just a cell address? What sheet should the <code>Range</code> object be pulled from? The <code>ActiveSheet</code>? Or a specific one? In any case assigning an object reference will require the <code>Set</code> keyword, but before you take user input and use it to dereference a <code>Range</code> object, you need to take steps to handle an invalid input. This will require error handling."}], "owner": {"reputation": 1, "user_id": 12475519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA3F3EQckleb3OTqHVF-m5nIDMqugSa-X25w_Vy=k-s128", "display_name": "Emma Kuttler", "link": "https://stackoverflow.com/users/12475519/emma-kuttler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575396638, "creation_date": 1575394919, "last_edit_date": 1575396638, "question_id": 59162622, "link": "https://stackoverflow.com/questions/59162622/how-to-have-user-input-a-cell-with-a-userform", "title": "How to have user input a cell with a userform", "body": "<p>I am building a userform with VBA. I want to be able to generate a list of random numbers, and have the user input what cell they start in. I have a textbox called <code>txtStarting</code>and a range called <code>userstarting</code>.</p>\n\n<pre><code>Private Sub txtStarting_Change()\nDim userstarting As Range\nuserstarting = txtStarting.Value\nEnd Sub\n</code></pre>\n\n<p>The form doesn't let me type in the full value of the range. Like if I want to start with cell B1, as soon as I type in B, it gives me an error.</p>\n"}, {"tags": ["excel", "vba", "range", "cell"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 6, "creation_date": 1575393135, "post_id": 59162152, "comment_id": 104548683, "body": "A <code>Range()</code> needs two <code>Cells()</code> you should use <code>Cells()</code> instead."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1575393977, "post_id": 59162152, "comment_id": 104549031, "body": "<a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">Implicit ActiveSheet references</a>: <code>Cells</code> is a member call that&#39;s implicitly qualified with whatever worksheet is currently active, or the worksheet module you&#39;re in, if that&#39;s where the unqualified member calls are. Basically you can&#39;t do <code>Sheet1.Range(Sheet2.Cells(...), Sheet2.Cells(...))</code>, and that&#39;s what happens when <code>Sheet2</code> is active and you do <code>Sheet1.Range(Cells(...), Cells(...))</code>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1575402055, "post_id": 59162152, "comment_id": 104552524, "body": "@MathieuGuindon While you are correct about qualifying calls, the OP&#39;s problem here is that, as Damian said above, that you cannot pass <i>one</i> <code>Range</code>-typed argument to <code>Range()</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1575402320, "post_id": 59162152, "comment_id": 104552628, "body": "@GSerg that is correct. Also the only reason for this to go undetected, is the implicit late binding induced by chaining the <code>.Range</code> call to <code>Workbook.Worksheets(2)</code>, which returns an <code>Object</code>. By pulling that <code>Worksheet</code> object into its own local variable, OP would restore early binding and compile-time checks, and get intellisense / parameter quick-info display a tooltip showing the parameters expected by the <code>.Range</code> property. Should the question be reopened?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1575402733, "post_id": 59162152, "comment_id": 104552788, "body": "@MathieuGuindon Not really caused by late binding, no. The second parameter to <code>Range()</code> is optional, and <code>Dim w As Worksheet : MsgBox w.Range(w.Cells(1, 1)).Address</code> compiles perfectly. Yes, I believe the question should be reopened."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1575403493, "post_id": 59162152, "comment_id": 104553103, "body": "@GSerg here is a more appropriate duplicate: <a href=\"https://stackoverflow.com/questions/17636170/vba-excel-range-with-cell-argument\" title=\"vba excel range with cell argument\">stackoverflow.com/questions/17636170/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 1, "creation_date": 1575439821, "post_id": 59164551, "comment_id": 104562655, "body": "Note that <code>Worksheet.Cells(1)</code> also refers to same cell. Could have also used <code>With sheet.Range(&quot;A1:E10&quot;)</code> to reduce further the redundancy."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1575403552, "creation_date": 1575403552, "answer_id": 59164551, "question_id": 59162152, "link": "https://stackoverflow.com/questions/59162152/range-with-cells-excel-vba/59164551#59164551", "title": "Range() with Cells() Excel VBA", "body": "<p><code>Cells(1, 1)</code> is already a <code>Range</code> object, referring to cell A1 (row 1, column 1) of (assuming this is in a standard module) whatever worksheet happens to be the <code>ActiveSheet</code>.</p>\n\n<blockquote>\n<pre><code>Leftmargin = ThisWorkbook.Worksheets(2).Range(Cells(1, 1)).Left\n</code></pre>\n</blockquote>\n\n<p>But you mean to work with the sheet at index 2 of <code>ThisWorkbook</code>. Pull it into its own local variable:</p>\n\n<pre><code>Dim sheet As Worksheet\nSet sheet = ThisWorkbook.Worksheets(2)\n</code></pre>\n\n<p>Now you no longer need to dereference <code>ThisWorkbook.Worksheets(2)</code> everywhere you need to get ahold of that particular sheet: just use this variable.</p>\n\n<p>So <code>Cells(1, 1)</code> becomes <code>sheet.Cells(1, 1)</code> -- except it's still <em>already a range</em>, so the member call is either redundant, or malformed:</p>\n\n<pre><code>Leftmargin = sheet.Range(sheet.Cells(1, 1)).Left '&lt;~ redundant or malformed range\n</code></pre>\n\n<p>When you pass <code>Range</code> objects to the <code>Worksheet.Range</code> property, you want to give it 2 cells: the first is the cell in the upper-left corner of the range you want; the second is the cell in the bottom-right corner of the range you want... but since you're using A1 and you want the <code>.Left</code> property of that cell, what you want is probably just this:</p>\n\n<pre><code>Leftmargin = sheet.Cells(1, 1).Left + 2\n\nSet sh = sheet.Shapes.AddShape( _\n  Type:=msoShapeRoundedRectangle, _\n  Left:=Leftmargin, _\n  Top:=sheet.Range(\"A1\").Top + 2, _\n  Width:=sheet.Range(\"A1:E1\").Width - 4, _\n  Height:=sheet.Range(\"A1:A10\").Height - 4)\n</code></pre>\n\n<p>...but then I can't help but question why <code>sh.Left</code> would get to be precalculated, but not the other properties... why not just do this and drop the <code>Leftmargin</code> variable altogether?</p>\n\n<pre><code>Set sh = sheet.Shapes.AddShape( _\n  Type:=msoShapeRoundedRectangle, _\n  Left:=sheet.Range(\"A1\").Left + 2, _\n  Top:=sheet.Range(\"A1\").Top + 2, _\n  Width:=sheet.Range(\"A1:E1\").Width - 4, _\n  Height:=sheet.Range(\"A1:A10\").Height - 4)\n</code></pre>\n\n<p>Note that <code>Worksheet.Cells(1, 1)</code> and <code>Worksheet.Range(\"A1\")</code> both refer to the same cell/range.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1575462510, "post_id": 59175409, "comment_id": 104573526, "body": "I&#39;d suggest you re-read the part about unqualified <code>Cells</code> calls implicitly referring to whatever the ActiveSheet is."}], "tags": [], "owner": {"reputation": 1, "user_id": 12475349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5276cab22d0acc7c553dcac9d6c89efc?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Georgiew", "link": "https://stackoverflow.com/users/12475349/micha%c5%82-georgiew"}, "is_accepted": false, "score": -1, "last_activity_date": 1575460351, "creation_date": 1575460351, "answer_id": 59175409, "question_id": 59162152, "link": "https://stackoverflow.com/questions/59162152/range-with-cells-excel-vba/59175409#59175409", "title": "Range() with Cells() Excel VBA", "body": "<p>After reading your answers and related links (in this posts), I came to the result which works for me:</p>\n\n<pre><code>Set sh1 = ThisWorkbook.Worksheets(1)\nSet sh2 = ThisWorkbook.Worksheets(2)\n\nSet sh = ThisWorkbook.Worksheets(2).Shapes.AddShape( _\nType:=msoShapeRoundedRectangle, _\nLeft:=sh2.Range(Cells(1, 1), Cells(1, 1)).Left + 2, _\nTop:=sh2.Range(Cells(1, 1), Cells(1, 1)).Top + 2, _\nWidth:=sh2.Range(Cells(1, 1), Cells(1, 5)).Width - 4, _\nHeight:=sh2.Range(Cells(1, 1), Cells(10, 1)).Height - 4)\n</code></pre>\n\n<p>This way I prepared whole statement for looping through whole list of items, creating cards for it. </p>\n\n<p>Thank you,\nMichal</p>\n"}], "owner": {"reputation": 1, "user_id": 12475349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5276cab22d0acc7c553dcac9d6c89efc?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Georgiew", "link": "https://stackoverflow.com/users/12475349/micha%c5%82-georgiew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 700, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1575460351, "creation_date": 1575393031, "last_edit_date": 1575393736, "question_id": 59162152, "link": "https://stackoverflow.com/questions/59162152/range-with-cells-excel-vba", "title": "Range() with Cells() Excel VBA", "body": "<p>I'm having a problem applying a loop for building rectangles in a spreadsheet, I'm getting error 1004,</p>\n\n<blockquote>\n  <p>Run-time error '1004':<br>\n  Application-defined or object-defined error</p>\n</blockquote>\n\n<p>On line:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Leftmargin = ThisWorkbook.Worksheets(2).Range(Cells(1, 1)).Left\n</code></pre>\n\n<p>I have no idea why this doesn't work. I would also want to switch to cells function with the rest of the parameters as I need to loop over 450 positions to build rectangles as for cards. I'm asking for explanation on the topic so that I can understand the cause of failure.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim sh As Shape\n\nDim Leftmargin\nLeftmargin = ThisWorkbook.Worksheets(2).Range(Cells(1, 1)).Left\nLeftmargin = Leftmargin + 2\n\nSet sh = ThisWorkbook.Worksheets(2).Shapes.AddShape( _\n  Type:=msoShapeRoundedRectangle, _\n  Left:=Leftmargin, _\n  Top:=ThisWorkbook.Worksheets(2).Range(\"A1\").Top + 2, _\n  Width:=ThisWorkbook.Worksheets(2).Range(\"A1:E1\").Width - 4, _\n  Height:=ThisWorkbook.Worksheets(2).Range(\"A1:A10\").Height - 4)\n</code></pre>\n"}, {"tags": ["excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1575393151, "post_id": 59162106, "comment_id": 104548691, "body": "You should checkout <a href=\"http://www.4guysfromrolla.com/webtech/080101-1.shtml\" rel=\"nofollow noreferrer\">Disconnected Recordsets</a> for this."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575394503, "post_id": 59162106, "comment_id": 104549269, "body": "Also check out Transactions - <a href=\"https://codekabinett.com/rdumps.php?Lang=2&amp;targetDoc=how-to-access-transaction\" rel=\"nofollow noreferrer\">codekabinett.com/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 6024492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/916f4c24c36bb420dca69b544dad52f4?s=128&d=identicon&r=PG&f=1", "display_name": "XYZcode", "link": "https://stackoverflow.com/users/6024492/xyzcode"}, "edited": false, "score": 0, "creation_date": 1575406337, "post_id": 59162106, "comment_id": 104554259, "body": "ArcherBird and braX , thanks. I&#39;ve read the suggested links, but I don&#39;t see any solutions to the issue there."}], "owner": {"reputation": 3, "user_id": 6024492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/916f4c24c36bb420dca69b544dad52f4?s=128&d=identicon&r=PG&f=1", "display_name": "XYZcode", "link": "https://stackoverflow.com/users/6024492/xyzcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575393815, "creation_date": 1575392870, "last_edit_date": 1575393815, "question_id": 59162106, "link": "https://stackoverflow.com/questions/59162106/writing-to-sql-server-too-slow", "title": "Writing to SQL server - too slow", "body": "<p>I have an Excel sheet (using Excel version 1902) where i use VBA and an ADODB.connection (using Microsoft ActiveX Data objects 2.8 library) to read/write to an sql server (2016).</p>\n\n<p>At first both the read/write operations were very slow, taking approximately 15 seconds each. There will be multiple read/write sessions so 15 seconds is not acceptable.\nThe amount of data to be read/written varies but is approximately 500 rows in 15 columns in total (split between 7 tables, so the number of rows and columns varies per table). In other words, the amount of data to be transferred is not massive. </p>\n\n<p>At first I thought the problems was in my VBA code (loops, searching for text etc). But by removing those steps, I narrowed the problem down to moving through the recordset (.movenext row by row to read or write to the database).</p>\n\n<p>For the read operation I managed to get acceptable speeds by doing the following:\nChanged the CursorType from adOpenKeyset to adOpenForwardOnly \nChanged the LockType from adLockOptimistic to adLockReadOnly</p>\n\n<p>This reduced read times from 15 seconds to 5 seconds, which is acceptable.</p>\n\n<p>However, I have not managed to achieve any improved speeds for the write operations which are still at 15 seconds.\nI first tried:\nChanged the CursorType from adOpenKeyset to adOpenStatic\nChanged the LockType from adLockOptimistic to adLockBatchOptimistic</p>\n\n<p>And then altered the .update command to .updatebatch.</p>\n\n<p>I thought maybe that updating all in a batch would speed things up, but that did nothing.</p>\n\n<p>Then I tried changing the connection .open statement from:</p>\n\n<pre><code>cn.Open \"Provider = sqloledb;\" &amp; _\n            \"Data Source=datasourcename;\" &amp; _\n            \"Initial Catalog=catalogname;\" &amp; _\n            \"User ID=UserIdname;\"\n</code></pre>\n\n<p>etc. to:</p>\n\n<pre><code>cn.Open \"Driver={SQL Server Native Client 11.0};\" &amp; _\n            \"Server=servername;\" &amp; _\n            \"Database=databasename;\" &amp; _\n            \"Uid=UserIDname;\"\n</code></pre>\n\n<p>Again that did nothing. With the updatebatch the native sql server connection performed worse (28 seconds) than the oledb connection. But with .update (no batch update) both connections were similar in performance at about 15 seconds.</p>\n\n<p>Does anyone have any tips on how to possibly speed up the write operation ?</p>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1575392561, "post_id": 59161970, "comment_id": 104548358, "body": "What sheet are the <code>Cells</code> on? Are you missing the <code>.</code> in front of each <code>Cells</code> call? Also, use <code>Long</code> instead of <code>Integer</code>."}], "answers": [{"tags": [], "owner": {"reputation": 459, "user_id": 10547271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/59Gqb.png?s=128&g=1", "display_name": "AsUsual", "link": "https://stackoverflow.com/users/10547271/asusual"}, "is_accepted": false, "score": 0, "last_activity_date": 1575404244, "creation_date": 1575404244, "answer_id": 59164698, "question_id": 59161970, "link": "https://stackoverflow.com/questions/59161970/excel-with-vba-refer-to-a-sheet-code-name-instead-of-the-tab-name/59164698#59164698", "title": "Excel with VBA: Refer to a sheet code name instead of the tab name", "body": "<p>Try this..</p>\n\n<pre><code>Sub test()\n    Dim LastRow As Long, i As Integer\n    With ThisWorkbook.Sheets(\"update raw data\")\n        LastRow = .Cells(.Rows.Count, 4).End(xlUp).Row\n        For i = 4 To LastRow\n            .Cells(i, 56) = WorksheetFunction.Index(Sheet17.[O3:O300], WorksheetFunction.Match(.Cells(i, 69), Sheet17.[AB3:AB300], 0))\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12475305, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAuMOuk-7ksemUl9IoZObyRF6REk_E-qTiX9PJV=k-s128", "display_name": "NicoleX", "link": "https://stackoverflow.com/users/12475305/nicolex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575404244, "creation_date": 1575392326, "last_edit_date": 1575394484, "question_id": 59161970, "link": "https://stackoverflow.com/questions/59161970/excel-with-vba-refer-to-a-sheet-code-name-instead-of-the-tab-name", "title": "Excel with VBA: Refer to a sheet code name instead of the tab name", "body": "<p>Because I will update the tab name every week, instead of the tab name, I want to use the VBA project sheet name(Sheet17) which won't change if I change the tab name.</p>\n\n<p>My code is:</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"update raw data\")\n    Dim LastRow As Long\n    LastRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row\n\n    Dim i As Integer\n\n    For i = 4 To LastRow\n Cells(i, 56).Value = WorksheetFunction.Index(Sheet17.Range(\"O3:O300\"),WorksheetFunction.Match(Cells(i,69).Value, Sheet17.Range(\"AB3:AB300\"), 0))\n\n     Next i\n\n End With\n</code></pre>\n\n<p>But it gave me this error: </p>\n\n<p><code>'1004' -Unable to get the Match property of the WorksheetFunction class</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1575390075, "post_id": 59161255, "comment_id": 104546964, "body": "Remove the brackets <code>wscel.PasteSpecial (xlPasteValues)</code> should be <code>wscel.PasteSpecial xlPasteValues</code>"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1575391532, "post_id": 59161255, "comment_id": 104547764, "body": "@Tom In this case - a single <code>ByVal</code> argument - VBA doesn&#39;t distinguish between having or omitting the brackets.  If you were using a <code>ByRef</code> argument or two arguments of any type, such as <code>wscel.PasteSpecial xlPasteValues, SkipBlanks:=True</code> then, yes, you would get an error from <code>wscel.PasteSpecial (xlPasteValues, SkipBlanks:=True)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575390690, "post_id": 59161407, "comment_id": 104547307, "body": "Good catch. Of course I noticed the extraneous parentheses, and totally missed the copy/paste from webpage. Upvoted."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 3, "last_activity_date": 1575390452, "creation_date": 1575390452, "answer_id": 59161407, "question_id": 59161255, "link": "https://stackoverflow.com/questions/59161255/unable-to-paste-special-from-clipboard/59161407#59161407", "title": "Unable to paste special from clipboard", "body": "<p>You are using <code>Range.PasteSpecial</code>, which applies to pasting <strong>Excel Formatted Range Objects</strong> - documentation found <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.pastespecial\" rel=\"nofollow noreferrer\">here</a>.  Unfortunately, what sits on your Clipboard <em>isn't</em> an Excel Range Object, so you need <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.Worksheet.pastespecial\" rel=\"nofollow noreferrer\">the <code>Worksheet.PasteSpecial</code> method</a> instead.</p>\n\n<p>If your clipboard contains, for example an HTML sample, then you can \"Paste As Text\" like so:</p>\n\n<pre><code>    wscel.Worksheet.Activate\n    wscel.Activate\n    wscel.Worksheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:= False\n</code></pre>\n\n<p>And, yes - this is one of the few cases were you can't <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using Select</a></p>\n"}], "owner": {"reputation": 29, "user_id": 12446634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9113ae6a7d5f7398977075dfc5df1e?s=128&d=identicon&r=PG&f=1", "display_name": "CheMBurN", "link": "https://stackoverflow.com/users/12446634/chemburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 59161407, "answer_count": 1, "score": 0, "last_activity_date": 1575390817, "creation_date": 1575389907, "last_edit_date": 1575390817, "question_id": 59161255, "link": "https://stackoverflow.com/questions/59161255/unable-to-paste-special-from-clipboard", "title": "Unable to paste special from clipboard", "body": "<p>I've been trying to complete a code which requires me to paste data from a Ctrl+A/C'd webpage into a sheet. This is what I've done so far.</p>\n\n<pre><code>Sub testPaste()\n\nSheets(\"sheet2\").Delete\nSheets.Add.Name = \"Sheet2\"\nApplication.DisplayAlerts = False\n\nDim wscel As Range\nSet wscel = Sheets(\"sheet2\").Range(\"A1\")\n\nDim DataObj As MSForms.DataObject\nSet DataObj = New MSForms.DataObject\nDataObj.GetFromClipboard\n\nstrPaste = DataObj.GetText\n\nwscel.PasteSpecial (xlPasteValues)\n\nEnd Sub\n</code></pre>\n\n<p>The code however gives me an error 1004. Removing <code>(xlPasteValues)</code> fixes it but it pastes the data as is which I can't work with. what is it that I'm doing wrong here?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 11813223, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5kTNDaXAGzo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLB2mkaFRywvAxk79hFMvm4e_x2w/photo.jpg?sz=128", "display_name": "NCRI MTL", "link": "https://stackoverflow.com/users/11813223/ncri-mtl"}, "is_accepted": false, "score": 1, "last_activity_date": 1575399178, "creation_date": 1575399178, "answer_id": 59163595, "question_id": 59161198, "link": "https://stackoverflow.com/questions/59161198/vba-listing-content-from-txt-file-into-excel/59163595#59163595", "title": "vba listing content from txt file into excel", "body": "<p>I managed to get it working by implementing another section from a previous post found.\nfor reference purpose.\n<a href=\"https://stackoverflow.com/questions/11267459/vba-importing-text-file-into-excel-sheet\">vba: Importing text file into excel sheet</a></p>\n\n<p>script was added in the <strong>IF</strong> string and was able to find the file by date and list the content in the file on each cell</p>\n\n<p><code>Sub Sample()\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;C:\\\"Your file path\"\\ &amp; **strFileName,** Destination:=Range(\"$A$1\") _\n        )\n        .Name = \"Sample\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub</code></p>\n"}], "owner": {"reputation": 23, "user_id": 11813223, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5kTNDaXAGzo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcLB2mkaFRywvAxk79hFMvm4e_x2w/photo.jpg?sz=128", "display_name": "NCRI MTL", "link": "https://stackoverflow.com/users/11813223/ncri-mtl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575400462, "creation_date": 1575389744, "last_edit_date": 1575400462, "question_id": 59161198, "link": "https://stackoverflow.com/questions/59161198/vba-listing-content-from-txt-file-into-excel", "title": "vba listing content from txt file into excel", "body": "<p>Im trying to get my vba script to copy content from a text file and place it in individual cells. So far im able to pull content from a file, but it places it all one cell only. Is there a way to modify the script below to have it in each cell after every \"enter\" on the txt file?</p>\n\n<pre><code>  Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    objStartFolder = \"C:\\Users\\mohammad.anwar\\Desktop\\Newfolder4\\\"\n    Dim strNow, strDD, strMM, strYYYY, strFulldate\n    strYYYY = DatePart(\"yyyy\", Now())\n    strMM = Right(\"0\" &amp; DatePart(\"m\", Now()), 2)\n    strDD = Right(\"0\" &amp; DatePart(\"d\", Now()), 2)\n    fulldate = strYYYY &amp; strMM &amp; strDD\n    ForReading = 1\n    Set objFolder = objFSO.GetFolder(objStartFolder)\n\n\n    Set colFiles = objFolder.Files\n\n\n    For Each objFile In colFiles\n    strFileName = objFile.Name\n\n\n    If InStr(strFileName, fulldate) &gt; 0 = True Then\n\n\n    Set file = objFSO.OpenTextFile(objStartFolder + strFileName, 1)\n    Content = file.ReadAll\n    Range(\"A3\").Select\n    ActiveCell.FormulaR1C1 = Content\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 3, "creation_date": 1575388734, "post_id": 59160800, "comment_id": 104546253, "body": "This is a perfect task for <code>Power Query</code> if you want to avoid VBA &gt; Load your data into PQ &gt; Select column C &gt; Split Column &gt; On delimiter (comma obviously) &gt; Advanced &gt; Rows &gt; OK. That&#39;s the free late cyber monday tip. If you do want to go with VBA, please include your code and tell us where you got stuck =)"}, {"owner": {"reputation": 1, "user_id": 11377690, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fhe3H1nrgHI/AAAAAAAAAAI/AAAAAAAADoE/DCy_njSrsE0/photo.jpg?sz=128", "display_name": "Merc", "link": "https://stackoverflow.com/users/11377690/merc"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575455444, "post_id": 59160800, "comment_id": 104569820, "body": "Prefect thanks for you help"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12470441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35eb550af3e2ab1e1dc563b8ba3e4da6?s=128&d=identicon&r=PG", "display_name": "Nandu Tayade", "link": "https://stackoverflow.com/users/12470441/nandu-tayade"}, "is_accepted": false, "score": 0, "last_activity_date": 1576598443, "last_edit_date": 1576598443, "creation_date": 1575402224, "answer_id": 59164291, "question_id": 59160800, "link": "https://stackoverflow.com/questions/59160800/insert-a-new-line-with-information-in-c-copy-the-other-data/59164291#59164291", "title": "insert a new line with information in C copy the other data", "body": "<pre>\nSub getdata()  \n\nDim data_count As Integer  \nDim Outputdata_count As Integer  \nDim part_number As Long  \nDim description As String  \nDim location As String  \nDim arr_location As Variant    \nDim loop_i As Integer  \nDim loop_d As Integer  \n\ndata_count = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFor loop_i = 2 To data_count\n\n     part_number = Cells(loop_i, \"A\")\n     description = Cells(loop_i, \"B\")\n     location = Cells(loop_i, \"C\")\n     arr_location = Split(location, \",\")\n\n    For loop_d = LBound(arr_location) To UBound(arr_location)        \n        Outputdata_count = Cells(Rows.Count, \"D\").End(xlUp).Row + 1\n        Cells(Outputdata_count, \"D\") = part_number\n        Cells(Outputdata_count, \"E\") = description\n        Cells(Outputdata_count, \"F\") = Trim(arr_location(loop_d))    \n    Next loop_d\n\nNext loop_i\n\nEnd Sub\n</pre>\n"}], "owner": {"reputation": 1, "user_id": 11377690, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fhe3H1nrgHI/AAAAAAAAAAI/AAAAAAAADoE/DCy_njSrsE0/photo.jpg?sz=128", "display_name": "Merc", "link": "https://stackoverflow.com/users/11377690/merc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576598443, "creation_date": 1575388361, "last_edit_date": 1575388621, "question_id": 59160800, "link": "https://stackoverflow.com/questions/59160800/insert-a-new-line-with-information-in-c-copy-the-other-data", "title": "insert a new line with information in C copy the other data", "body": "<p>In column C I have the locations of the part numbers what I need to do is for each location separated by coma is to insert a new line with the location and same part number and description that goes with it. can</p>\n\n<p>BEFORE:</p>\n\n<pre><code>A                 B             c\nPart number  Description     Location\n\n12456           black       c1, c2, c5\n98745           blue        c10, r6, ic4, g6, h3\n</code></pre>\n\n<p>What I want</p>\n\n<pre><code>a                 B             C\n\n123456         black          c1\n123456         black          c2\n123456         black          c5\n98745          blue           c10\n98745          blue           r6\n98745          blue           ic4\n98745          blue           g6\n98745          blue           h3\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1575387157, "post_id": 59160168, "comment_id": 104545300, "body": "How would Excel know that it should be row 15? Do you have a lookup table somewhere, with all the relevant criteria a <code>KIT NO</code> should be accounted for?"}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575387878, "post_id": 59160168, "comment_id": 104545747, "body": "Please see the edited post, I have added pictures to try to explain the sequence of events"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 3, "creation_date": 1575388129, "post_id": 59160168, "comment_id": 104545891, "body": "So it&#39;s not really an unique task it seems, but rather a matter of <code>INDEX</code> and <code>MATCH</code>, or in VBA terms &gt; <code>Range.Find</code> and <code>Range.Offset</code>. I must admit that I&#39;m a little lost with where you want to go, but that might just be the right place to start your search =)"}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575388506, "post_id": 59160168, "comment_id": 104546118, "body": "Thanks for the input! I will definitely look into it"}], "owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575387824, "creation_date": 1575386158, "last_edit_date": 1575387824, "question_id": 59160168, "link": "https://stackoverflow.com/questions/59160168/is-there-a-way-to-paste-a-value-in-a-different-column-to-match-the-same-row-as-t", "title": "Is there a way to paste a value in a different column to match the same row as the data entered?", "body": "<p>I would like to complete a unique task that requires combining the code of copying and pasting data from different sheets and pasting the data into the next empty row.</p>\n\n<p>I am currently using this code to copy and paste a \"kit\" from <em>Update_kit</em> to <em>Create_assembly</em>. As new kits are found, the user can add the kit data to the next empty row in the table (4-10 rows of parts and their respective information) in Column C.</p>\n\n<pre><code>'Paste matching kit parts back into Create_assembly\nDim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim db As Worksheet\n\nDim lCopy As Long\nDim lDest As Long\n\nDim lCopy2 As Long\nDim lDest2 As Long\n\nSet db = Sheet10\n\n  Sheets(\"Create_assembly\").range(\"B6\").Value = Sheets(\"Update_kit\").range(\"B3\").Value\n\n  Set wsCopy = Worksheets(\"Update_kit\") 'Copies table\n  Set wsDest = Worksheets(\"Create_assembly\") 'Pastes table\n\n  lCopy = wsCopy.Cells(wsCopy.Rows.count, \"C\").End(xlUp).Row\n  lDest = wsDest.Cells(wsDest.Rows.count, \"C\").End(xlUp).Offset(1).Row\n\n  'Copies any cell within the table\n  wsCopy.range(\"B5:F\" &amp; lCopy).Copy\n  wsDest.range(\"C\" &amp; lDest).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>This line <code>Sheets(\"Create_assembly\").range(\"B6\").Value = Sheets(\"Update_kit\").range(\"B3\").Value</code> places the <em>Kit No.</em> from cell B3 in <em>Update_Kit</em> to <em>Create_assembly</em>. However, as I add new kits, cell B6 is replaced rather than adding the Kit No. to the next empty row in the table. </p>\n\n<p>Also, instead of placing the <em>Kit No.</em> in the next empty row in Column B of <em>Create_Assembly</em> I would like it to match with its respective Kit. In the screenshot below, \"LT-1 GOC\" should be row 15 to match the parts that make up the kit in columns B-F.</p>\n\n<p><a href=\"https://i.stack.imgur.com/41AhI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/41AhI.png\" alt=\"enter image description here\"></a></p>\n\n<p>This might be reallly confusing to follow but please ask away and I will try to clarify! Thanks in advance for the help.</p>\n\n<p><strong><em>EDIT</em></strong></p>\n\n<p>Below shows where the original kit data is stored (Kit_database). After the user makes a selection, whatever data is matched to the kit will be copied over to the next screenshot.\n<a href=\"https://i.stack.imgur.com/kf80m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kf80m.png\" alt=\"enter image description here\"></a></p>\n\n<p>The kit information is dumped here and this is what is copied over to the <em>Create_assembly</em> page.\n<a href=\"https://i.stack.imgur.com/m5PQM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m5PQM.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575385256, "post_id": 59159890, "comment_id": 104544180, "body": "What line throws the error, and what is the error message?"}, {"owner": {"reputation": 23, "user_id": 12474506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/019628cad05b96fdfc399adc56dadc57?s=128&d=identicon&r=PG&f=1", "display_name": "GabeG726", "link": "https://stackoverflow.com/users/12474506/gabeg726"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575386352, "post_id": 59159890, "comment_id": 104544821, "body": "@BigBen its a Run-Time error &#39;91&#39;: Object variable or With block variable not set.    I get this on the line where I try to define what &quot;CRow&quot; is. I&#39;m thinking its something with the &quot;Find&quot; function."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1575386920, "last_edit_date": 1575386920, "creation_date": 1575386539, "answer_id": 59160273, "question_id": 59159890, "link": "https://stackoverflow.com/questions/59159890/vba-from-word-to-excel/59160273#59160273", "title": "VBA from Word to Excel", "body": "<p>You need <code>Set</code> for object variables:</p>\n\n<pre><code>Set CRow = Sheets(\"Log\").Range(\"K:K\").Find(What:=CONum, LookIn:=xlFormulas, LookAt:=xlPart, MatchCase:=False)\n</code></pre>\n\n<p>Then you should test if the <code>Find</code> was successful. And you can use <code>Offset</code> here to simplify.</p>\n\n<pre><code>If Not CRow Is Nothing Then\n    CRow.Offset(,1).Value = \"COMPLETED\"\nEnd If\n</code></pre>\n\n<p>Note, you are not actually using the <code>With...End With</code>.</p>\n\n<p>Revised code:</p>\n\n<pre><code>With openExcel\n    Dim CRow As Excel.Range\n    Set CRow = .Sheets(\"Log\").Range(\"K:K\").Find(What:=CONum, LookIn:=xlFormulas, LookAt:=xlPart, MatchCase:=False)\n\n    If Not CRow Is Nothing Then\n        CRow.Offset(,1).Value = \"COMPLETED\"\n    End If\n\n    .Save 'Filename:=COFile, FileFormat:=52\n    .Close\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12474506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/019628cad05b96fdfc399adc56dadc57?s=128&d=identicon&r=PG&f=1", "display_name": "GabeG726", "link": "https://stackoverflow.com/users/12474506/gabeg726"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 59160273, "answer_count": 1, "score": 2, "last_activity_date": 1575469774, "creation_date": 1575385149, "last_edit_date": 1575469774, "question_id": 59159890, "link": "https://stackoverflow.com/questions/59159890/vba-from-word-to-excel", "title": "VBA from Word to Excel", "body": "<p>I'm having issues with some VBA code that lives in a Word Template. The intent is to have the code open an Excel book, reference to Sheet named \"Log\", and find a row based on the Word document's name. Once the name is matched, I want to change a cells value to \"completed\". Then save and close the Excel workbook. I have tried the code below which will open the correct work book, but wont update the cell to \"Completed\", I get an error:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'***********************************************************************************************\n'Message box asking if you are sure you are ready to submit report for completion\nDim Msg, Style, Title, Help, Ctxt, Response, MyString\nMsg = \"Are you sure you are ready to submitt this Smart Learning Report?\"        ' Define message.\nStyle = vbYesNo + vbCritical + vbDefaultButton2    ' Define buttons.\nTitle = \"Submit SLR\"    ' Define title.\nHelp = \"DEMO.HLP\"    ' Define Help file.\nCtxt = 1000    ' Define topic context.\n    ' Display message.\nResponse = MsgBox(Msg, Style, Title, Help, Ctxt)\nIf Response = vbNo Then    ' User chose Yes.\n    MyString = \"No\"    ' Perform some action.\n    Exit Sub\nEnd If\n\n'***********************************************************************************************\n'File name to be used to update the status in the Log\nDim CONum As String\n\n'File name to be used to save report as PDF\nDim PDF As String\n\nCONum = ActiveDocument.FullName\nPDF = Replace(CONum, \".docm\", \".pdf\")\n\n'***********************************************************************************************\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n'***********************************************************************************************\n'Open excel, find cell with matching Word document name (CONum) in column K, \n_and change the cell value in column J (-1) to COMPLETED, save and close excel when completed.\nDim excelApp As Excel.Application\nDim openExcel As Excel.Workbook\n\n  Set excelApp = Excel.Application\n  Set openExcel = excelApp.Workbooks.Open(\"C:\\Users\\ggonzales\\Desktop\\SLR's\\GPT SLR Submission.xlsm\")\n  excelApp.Visible = True\n\nWith openExcel\n    Dim CRow As Excel.Range\n    Set CRow = Sheets(\"Log\").Range(\"K:K\").Find(What:=CONum,     LookIn:=xlFormulas, LookAt:=xlPart, MatchCase:=False)\n    If Not CRow Is Nothing Then\n    CRow.Offset(, -1).Value = \"COMPLETED\"\n    End If\nActiveWorkbook.Save 'Filename:=COFile, FileFormat:=52\nActiveWorkbook.Close\nEnd With\n\n'***********************************************************************************************\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\n'***********************************************************************************************\n'Delete Command Button so it does not show on the final report, _\nand so no one can submit the same report twice.\nFor Each o In ActiveDocument.InlineShapes\n   If o.OLEFormat.Object.Caption = \"Complete &amp; Submit Report\" Then\n        o.Delete\n    End If\nNext\n\n'***********************************************************************************************\n'Save a copy of the report as a PDF\nActiveDocument.ExportAsFixedFormat OutputFileName:= _\n        PDF, ExportFormat:= _\n        wdExportFormatPDF, OpenAfterExport:=False, OptimizeFor:= _\n        wdExportOptimizeForPrint, Range:=wdExportAllDocument\n\n'***********************************************************************************************\n'Close and save report (Word Document)\nActiveDocument.Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10192214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b9e0d62ce2db79b1985940b16db5f0?s=128&d=identicon&r=PG&f=1", "display_name": "T. Coates", "link": "https://stackoverflow.com/users/10192214/t-coates"}, "edited": false, "score": 0, "creation_date": 1575384448, "post_id": 59159515, "comment_id": 104543592, "body": "Thank you so much! I&#39;m very new to all this but your reply was perfect. Cheers :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 25, "user_id": 10192214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b9e0d62ce2db79b1985940b16db5f0?s=128&d=identicon&r=PG&f=1", "display_name": "T. Coates", "link": "https://stackoverflow.com/users/10192214/t-coates"}, "edited": false, "score": 1, "creation_date": 1575384902, "post_id": 59159515, "comment_id": 104543930, "body": "Please consider making as correct by clicking the check mark by the answer"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1575383955, "creation_date": 1575383955, "answer_id": 59159515, "question_id": 59159442, "link": "https://stackoverflow.com/questions/59159442/elseif-statement-in-vba-not-applying-all-the-conditions/59159515#59159515", "title": "ElseIf Statement in VBA not applying all the conditions?", "body": "<p><code>18 &lt;= BMI &lt; 25</code> is not correct VBA:</p>\n\n<pre><code>18 &lt;= BMI And BMI &lt; 25\n</code></pre>\n\n<p>Would be the correct method.</p>\n\n<p>VBA resolves right to left so first it is asking <code>BMI &lt; 25</code> and returning TRUE or FALSE.  Then the next part is asking <code>18 &lt;= TRUE</code> which it will never be as <code>TRUE</code> is <code>-1</code></p>\n\n<p>Ultimately the Less than or equal to part are not needed as the IF will resolve in order:</p>\n\n<pre><code>If BMI &lt; 18 Then\n    The_Verdict.Value = \"You Are Underweight\"    \nElseIf BMI &lt; 25 Then\n    The_Verdict.Value = \"You Are The Ideal Weight\"    \nElseIf BMI &lt; 30 Then\n    The_Verdict.Value = \"You Are OverWeight\"    \nElse\n    The_Verdict.Value = \"You Are Obese\"    \nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10192214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b9e0d62ce2db79b1985940b16db5f0?s=128&d=identicon&r=PG&f=1", "display_name": "T. Coates", "link": "https://stackoverflow.com/users/10192214/t-coates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 59159515, "answer_count": 1, "score": 0, "last_activity_date": 1575383955, "creation_date": 1575383710, "question_id": 59159442, "link": "https://stackoverflow.com/questions/59159442/elseif-statement-in-vba-not-applying-all-the-conditions", "title": "ElseIf Statement in VBA not applying all the conditions?", "body": "<p>I'm new to coding and attempting to learn some VBA. I've started trying to build simple applications to help me learn, including this BMI calculator. </p>\n\n<p>I would like a simple string text message to be displayed in the specified text box in accordance with the calculated BMI score and the subsequent If and Elseif statements. </p>\n\n<p>If the BMI score returns less than 18, the text box displays \"You Are Underweight\" as desired. Similarly, if the BMI score returns a value of equal or greater than 18, \"You Are The Ideal Weight\" is displayed. </p>\n\n<p>However, this is where the problem is encountered. If the BMI score is greater than 25, \"You Are The Ideal Weight\" continues to be displayed, with the additional ElseIf and Else statements seemingly just ignored?</p>\n\n<p>Can anyone spot what I am missing? My code is shown here:</p>\n\n<pre><code>Option Explicit\n\nSub BMI()\n\nDim Height As Variant\nDim Weight As Variant\nDim BMI As Double\n\nHeight = Height_Input.Value\nWeight = Weight_Input.Value\n\n\nIf IsNumeric(Height_Input.Value) And IsNumeric(Weight_Input.Value) Then\n\n    BMI = CDbl(Weight_Input.Value) / (CDbl(Height_Input.Value) * CDbl(Height_Input.Value))\n\n    BMI_Output.Value = BMI\n\nElse: MsgBox (\"Please Enter Numeric Values\")\n\nEnd If\n\nIf BMI &lt; 18 Then\n    The_Verdict.Value = \"You Are Underweight\"\n\n    ElseIf 18 &lt;= BMI &lt; 25 Then\n        The_Verdict.Value = \"You Are The Ideal Weight\"\n\n        ElseIf 25 &lt;= BMI &lt; 30 Then\n            The_Verdict.Value = \"You Are OverWeight\"\n\nElse: The_Verdict.Value = \"You Are Obese\"\n\nEnd If\n\nIf Height_Input.Value = (\"\") Or Weight_Input.Value = (\"\") Then\n\n    The_Verdict.Value = \"\"\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1575389735, "post_id": 59159321, "comment_id": 104546757, "body": "What does <i>has stopped working</i> mean <b>exactly</b> ? -- And Access 2000 runtime, seriously? That&#39;s kinda obsolete."}, {"owner": {"reputation": 11, "user_id": 10342147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3089820e6f4a4a86c05f22c170c7e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "xjacksssss", "link": "https://stackoverflow.com/users/10342147/xjacksssss"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1575455637, "post_id": 59159321, "comment_id": 104569910, "body": "Have added an edit to the original post explaining what isn&#39;t working. And yes I know access 2000 is very very obsolete."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1575458355, "post_id": 59159321, "comment_id": 104571318, "body": "Ok. You&#39;ll have to set a breakpoint and step through the code, to see where exactly it fails. Then we may be able to help. See <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">How to debug VBA code</a>"}], "answers": [{"tags": [], "owner": {"reputation": 202, "user_id": 5569008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ae435683b0de0fb75cefd9211afdd2?s=128&d=identicon&r=PG&f=1", "display_name": "xShen", "link": "https://stackoverflow.com/users/5569008/xshen"}, "is_accepted": false, "score": 0, "last_activity_date": 1575389698, "creation_date": 1575389698, "answer_id": 59161177, "question_id": 59159321, "link": "https://stackoverflow.com/questions/59159321/creating-word-documents-from-templates-in-access-vba/59161177#59161177", "title": "Creating Word documents from templates in Access VBA", "body": "<p>Try using late binding  like this  </p>\n\n<pre><code>Dim oword As  Object: set oword = CreateObject(\"Word.Application\")\n</code></pre>\n\n<p>insted of </p>\n\n<pre><code>Dim oword As Word.Application\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10342147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3089820e6f4a4a86c05f22c170c7e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "xjacksssss", "link": "https://stackoverflow.com/users/10342147/xjacksssss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575455597, "creation_date": 1575383367, "last_edit_date": 1575455597, "question_id": 59159321, "link": "https://stackoverflow.com/questions/59159321/creating-word-documents-from-templates-in-access-vba", "title": "Creating Word documents from templates in Access VBA", "body": "<p>I have inherited an Access database from someone who built it about 20 years ago. Recently for some users out of the 90 who use it the function to create a Word document from templates that are populated by access has stopped working for some users. I have installed and reinstalled office so many times, I have made machines identical to each other and still one works and one doesn't. I'm hoping the below function will be enough for people who know a lot more about VBA than I to see something wrong. </p>\n\n<p>I have done some research and thought at first it would be missing references but can be 100% sure that it is not. All users are running access runtime 2000 and a mixture of office 2010 and office 365 the users who work are both on office 365 and Office 2010.</p>\n\n<p>Please see the below function and let me know if anything is glaringly obvious with the code, and let me know if more info is needed happy to supply it. </p>\n\n<p>Edit* The issue I currently face is where the user clicks on the \"Create document\" button and then it seemingly does nothing. It doesn't error, it doesn't create the document and doesn't open word full screen like it should. It does however move onto the next part where it asks them if they would like to log this in the logs. What I have noticed is that it appears to try and open Word, which I have seen using \"Procmon\" but nothing opens in the foreground.</p>\n\n<pre><code>    Public Sub PRINT_DOC(TEMPLAT As String)\n\n    Dim oword As Word.Application\n\n'   Array bound increased from 20 to 100 [v1.1]\n    Dim FIELDNAME(100) As String\n    Dim strSQL As String\n    Dim FILE_STR As String\n    Dim dbs As Database\n    Dim COUNTER As Integer\n    Dim COUNTA As Integer\n    On Error GoTo notloaded\n\n    Dim theError As Integer\n\n    Err.NUMBER = 0\n    Set oword = New Word.Application\n\nnotloaded:\n    If Err.NUMBER = 429 Then\n        Set oword = New Word.Application\n        theError = Err.NUMBER\n    End If\n\nOn Error GoTo Err_PRINT_DOC\n    DoCmd.Hourglass True\n\n\n    oword.Documents.Add TEMPLAT\n\n    oword.Visible = True\n    oword.Activate\n\n\n    COUNTER = oword.ActiveDocument.FormFields.COUNT\n    For COUNTA = 1 To COUNTER\n        FIELDNAME(COUNTA) = oword.ActiveDocument.FormFields(COUNTA).Name\n    Next\n\n    For COUNTA = 1 To COUNTER\n        Select Case FIELDNAME(COUNTA)\n            Case \"CONTACT\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![CONTACT]\n            Case \"ADDRESS\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![FULL_ADDRESS]\n            Case \"REFERENCE\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![REFERENCE]\n            Case \"FAX\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![FAX_NO]\n            Case \"SUBJECT\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![JOBTITLE] &amp; \" - \" &amp; Forms![frm_correspondence]![SUBJECT]\n            Case \"JOB\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![JOBTITLE]\n            Case \"REPORT\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![SUBJECT]\n            Case \"DATE\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![DATE]\n            Case \"SIGNED\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![SIGNED]\n            Case \"FROM\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![FROM]\n            Case \"TO\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![TO]\n            Case \"CC\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![CC]\n            Case \"DEAR\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![DEAR]\n\n            Case \"INVOICE_SUM\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![INVOICE SUM]\n            Case \"INVOICE_VAT\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![INVOICE VAT]\n            Case \"INVOICE_NOTES\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![INVOICE NOTES]\n             Case \"INVOICE_NUMBER\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![INVOICE NO]\n            Case \"INVOICE_TOTAL\": oword.ActiveDocument.FormFields(COUNTA).SELECT\n                            oword.Selection.InsertBefore Forms![frm_correspondence]![INVOICE TOTAL]\n        End Select\n    Next\n\n    oword.Visible = True\n    oword.Activate\n\n    If Forms![frm_correspondence]![COR PATH] &lt;&gt; \"\" And Not IsNull(Forms![frm_correspondence]![COR PATH]) Then\n        FILE_STR = Forms![frm_correspondence]![COR PATH] &amp; \"\\\" &amp; Forms![frm_correspondence]![FILE REF]\n        oword.ActiveDocument.SaveAs FILENAME:=FILE_STR\n    End If\n    DoCmd.Hourglass False\n    Set oword = Nothing\n\nExit_PRINT_DOC:\n    Exit Sub\n\nErr_PRINT_DOC:\n    MsgBox Error$, vbExclamation, APP_NAME\n    Resume Exit_PRINT_DOC\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1575382176, "post_id": 59158970, "comment_id": 104542129, "body": "<a href=\"https://stackoverflow.com/questions/47056390/how-to-do-late-binding-in-vba\" title=\"how to do late binding in vba\">stackoverflow.com/questions/47056390/&hellip;</a>. Yes."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1575387227, "post_id": 59158970, "comment_id": 104545344, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/47056390/how-to-do-late-binding-in-vba\">How to do late binding in VBA?</a>"}], "owner": {"reputation": 55, "user_id": 8925147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760a07d02753b53efaf2e9e42504f238?s=128&d=identicon&r=PG&f=1", "display_name": "Adriiboom", "link": "https://stackoverflow.com/users/8925147/adriiboom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575387207, "creation_date": 1575382120, "last_edit_date": 1575387207, "question_id": 59158970, "link": "https://stackoverflow.com/questions/59158970/row-delete-from-access-vba-using-late-binding", "title": "Row.delete from Access vba using late binding", "body": "<p>I have an Access programm that opens an Excel and deletes it's first row with <code>row.delete(1)</code>. But my problem is that I have to perform this task using late binding because this programm it's executed in different versions of Access so I cannot simply add the Excel Library reference to my Access to execute this method.</p>\n\n<p>Is there anyway to perform this <code>row.delete(1)</code> with late binding?</p>\n"}, {"tags": ["vba", "loops", "import", "range", "match"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575381695, "post_id": 59158801, "comment_id": 104541817, "body": "<code>WorksheetFunction</code>. You&#39;re missing a <code>c</code>."}, {"owner": {"reputation": 1, "user_id": 10494441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14246a20b6d8a5a6a7559e5beca00f6?s=128&d=identicon&r=PG&f=1", "display_name": "xie pu", "link": "https://stackoverflow.com/users/10494441/xie-pu"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575382532, "post_id": 59158801, "comment_id": 104542321, "body": "omg thank you, didnt spot it at all... but still couldn&#39;t run the next line, ` wsCopy.Range(&quot;C14:C &amp; lastrow_ir&quot;).Columns(m).Copy`. the error message is &quot;Method  &#39;Range&#39; of object &#39;_Worksheet&#39; failed. I just start learning vba, thanks for the help!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575382575, "post_id": 59158801, "comment_id": 104542348, "body": "<code>&quot;C14:C&quot; &amp; lastrow_ir</code>. Variables should be <i>outside</i> the quotes."}, {"owner": {"reputation": 1, "user_id": 10494441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14246a20b6d8a5a6a7559e5beca00f6?s=128&d=identicon&r=PG&f=1", "display_name": "xie pu", "link": "https://stackoverflow.com/users/10494441/xie-pu"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575382825, "post_id": 59158801, "comment_id": 104542504, "body": "Thanks, corrected it. Do you think my loop is logically correct?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575382861, "post_id": 59158801, "comment_id": 104542526, "body": "Another issue: <code>lastcol = wsDest.Range(&quot;C:AD&quot;).Column</code> - this doesn&#39;t return what you think it does. It will always be <code>3</code>. Use <code>End(xlToLeft)</code> to find the last column."}, {"owner": {"reputation": 1, "user_id": 10494441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14246a20b6d8a5a6a7559e5beca00f6?s=128&d=identicon&r=PG&f=1", "display_name": "xie pu", "link": "https://stackoverflow.com/users/10494441/xie-pu"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575383048, "post_id": 59158801, "comment_id": 104542637, "body": "Coz it is actually not the last column, I need to change the name, I change it to <code>Lcol = wsDest.Range(&quot;C:AD&quot;).Columns.Count</code>, will it work?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575383162, "post_id": 59158801, "comment_id": 104542707, "body": "It&#39;s not a problem with the name, it&#39;s a problem with how you determine the last column."}], "owner": {"reputation": 1, "user_id": 10494441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14246a20b6d8a5a6a7559e5beca00f6?s=128&d=identicon&r=PG&f=1", "display_name": "xie pu", "link": "https://stackoverflow.com/users/10494441/xie-pu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575381611, "creation_date": 1575381611, "question_id": 59158801, "link": "https://stackoverflow.com/questions/59158801/copy-paste-the-matched-columns-from-one-worksheet-to-another", "title": "copy paste the matched columns from one worksheet to another", "body": "<p>I have a question about copy paste specific columns from one worksheet(ws_Copy) to  another(ws_Dest). I need to loop through each column header and match it with the headers in ws_Copy. If it matches, I need to copy the whole column into the ws_Dest with the matched header. </p>\n\n<p>Not sure if my explain is clear or not, here is the sample code: </p>\n\n<pre><code>Sub Import_data()\nDim path As String\nDim file As String\nDim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim lastcol As Integer\nDim lastrow_ir As Integer\nDim i As Integer\nDim m As Integer\n\npath = ThisWorkbook.Sheets(\"MACROS\").Range(\"import_path_IRHedge\").Value\nfile = ThisWorkbook.Sheets(\"MACROS\").Range(\"file_IRHedge\").Value\n\n'Set variables for copy and destination sheets\nSet wsCopy = Workbooks(file).Sheets(\"data_ir_bpv\")\nSet wsDest = ThisWorkbook.Sheets(\"IR Hedge\")\n\n'Find last used column in the destination sheet\n'Find last row in the copy sheet \nlastcol = wsDest.Range(\"C:AD\").Column\nlastrow_ir = wsCopy_ir.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n'Use the Match function to find the corresponding column to copy paste\nFor i = 3 To lastcol\n    Set Rng1 = wsCopy_ir.Range(\"C14:AC14\")\n    m = Application.WorksheetFuntion.Match(wsDest.Cells(1, i).Value, Rng1, 0)\n    wsCopy_ir.Range(\"C14:C &amp; lastrow_ir\").Columns(m).Copy\n    wsDest.Range(\"C2\").Columns(i).PasteSpecial xlPasteValues\n\nNext i\nApplication.CutCopyMode = False\nMsgBox \"Data has been imported successfully\"\nEnd Sub\n</code></pre>\n\n<p>But the error message \"Object doesn't support this property or method\" kept showing up in the row: </p>\n\n<pre><code> m = Application.WorksheetFuntion.Match(wsDest.Cells(1, i).Value, Rng1, 0)\n</code></pre>\n\n<p>Any help would be appreciated! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "edited": false, "score": 0, "creation_date": 1575383054, "post_id": 59158783, "comment_id": 104542640, "body": "Have you tried removing all &quot;On Error Resume Next&quot; to see what errors you get?"}, {"owner": {"reputation": 53, "user_id": 7231915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b6d8fc97e6951997f5e3987209b247?s=128&d=identicon&r=PG&f=1", "display_name": "Hulk Smash 93", "link": "https://stackoverflow.com/users/7231915/hulk-smash-93"}, "reply_to_user": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "edited": false, "score": 0, "creation_date": 1575383556, "post_id": 59158783, "comment_id": 104542988, "body": "Same thing happens. The only error message that appears is when i close outlook and it shows up as &#39;Automation Error&#39;"}], "owner": {"reputation": 53, "user_id": 7231915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b6d8fc97e6951997f5e3987209b247?s=128&d=identicon&r=PG&f=1", "display_name": "Hulk Smash 93", "link": "https://stackoverflow.com/users/7231915/hulk-smash-93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575382667, "creation_date": 1575381550, "last_edit_date": 1575382667, "question_id": 59158783, "link": "https://stackoverflow.com/questions/59158783/excel-vba-freezes-outlook-with-word-editor", "title": "Excel VBA - Freezes outlook with word editor", "body": "<p>Im hoping to get some help with an issue.</p>\n\n<p>I run an excel macro that sends two emails with different attachments, there is also a copied range that goes into the body of the email.</p>\n\n<p>For the copied range i use word as the getinspector. The first email works fine, but when it goes to the 2nd email it freezes my outlook at line </p>\n\n<pre><code>Set wordDoc = MyItem.GetInspector.WordEditor\n</code></pre>\n\n<p>My Outlook completely freezes, it doesnt say 'Not Responding' or go white i just cant click anything and cant close it unless i use task manager.</p>\n\n<p>Its only the 2nd time the above code is referenced where it freezes.</p>\n\n<p>Here is the full code:</p>\n\n<pre><code>Dim myOlApp As Outlook.Application\nDim MyItem As Outlook.MailItem\nDim wordDoc As Word.Document\nDim rngp As Object\nDim shp As Object\nDoEvents\n\nWorkbooks.Open FileName:=\"######\" &amp; Format(Date - 7, \"DD-MM-YY\") &amp; \".xlsx\", ReadOnly:=True\n\nWorkbooks(\"####\" &amp; Format(Date - 7, \"DD-MM-YY\") &amp; \".xlsx\").Activate\n\nSet rng = Nothing\nOn Error Resume Next\nSet rng = Workbooks(\"###\" &amp; Format(Date - 7, \"DD-MM-YY\") &amp; \".xlsx\").Sheets(\"Queue Overview\").Range(\"E1:H11\")\nrng.Copy\n\nSet myOlApp = CreateObject(\"Outlook.Application\")\nSet MyItem = myOlApp.CreateItemFromTemplate(\"#####\")\nOn Error GoTo 0\n\nSet wordDoc = MyItem.GetInspector.WordEditor\n\nWith MyItem\n    .Display\nEnd With\n    Signature = MyItem.HTMLBody\n\n\nWith MyItem\n    .SendUsingAccount = myOlApp.Session.Accounts.Item(3)\n    .To = \"\"\n    .Subject = \"\"\n    .Attachments.Add \"#####\" &amp; Format(Date - 7, \"DD-MM-YY\") &amp; \".xlsx\"\n    wordDoc.Range.PasteAndFormat (wdChartPicture)\n    wordDoc.Range.InsertBefore \"Good Afternoon\" &amp; vbNewLine &amp; vbNewLine &amp; \"Please find attached\"\n    wordDoc.Range.InsertAfter vbNewLine &amp; vbNewLine &amp; \"As I'm sending data\"\n    .HTMLBody = .HTMLBody &amp; vbNewLine &amp; vbNewLine &amp; \"Regards\" &amp; Signature\n    For Each shp In wordDoc.InlineShapes\n        shp.ScaleHeight = 100\n        shp.ScaleWidth = 100\n    Next\n    .Send\n End With\n\n\nSet rng = Nothing\nSet MyItem = Nothing\nSet myOlApp = Nothing\nSet wordDoc = Nothing\n\nWorkbooks(\"###\" &amp; Format(Date - 7, \"DD-MM-YY\") &amp; \".xlsx\").Close savechanges:=True\n\nApplication.Wait (Now + TimeValue(\"0:00:15\"))\n\nWorkbooks.Open FileName:=\"####\" &amp; Format(Date - 7, \"DD-MM-YY\") &amp; \".xlsx\", ReadOnly:=True\n\nWorkbooks(Format(Date - 7, \"DD-MM-YY\") &amp; \".xlsx\").Activate\n\nSet rng = Nothing\nOn Error Resume Next\nSet rng = Workbooks(Format(Date - 7, \"DD-MM-YY\") &amp; \".xlsx\").Sheets(\"Queue Overview\").Range(\"E1:H11\")\nrng.Copy\n\nSet myOlApp = CreateObject(\"Outlook.Application\")\nSet MyItem = myOlApp.CreateItemFromTemplate(\"####\")\nOn Error GoTo 0\n\nSet wordDoc = MyItem.GetInspector.WordEditor\n\nWith MyItem\n    .Display\nEnd With\n    Signature = MyItem.HTMLBody\n\n\nWith MyItem\n    .SendUsingAccount = myOlApp.Session.Accounts.Item(3)\n    .To = \"\"\n    .Subject = \"\"\n    .Attachments.Add \"#####\" &amp; Format(Date - 7, \"DD-MM-YY\") &amp; \".7z\"\n    wordDoc.Range.PasteAndFormat (wdChartPicture)\n    wordDoc.Range.InsertBefore \"Good Afternoon\" &amp; vbNewLine &amp; vbNewLine &amp; \"Please find attached\"\n    wordDoc.Range.InsertAfter vbNewLine &amp; vbNewLine &amp; \"As I'm sending data\"\n    .HTMLBody = .HTMLBody &amp; vbNewLine &amp; vbNewLine &amp; \"Regards\" &amp; Signature\n    For Each shp In wordDoc.InlineShapes\n        shp.ScaleHeight = 100\n        shp.ScaleWidth = 100\n    Next\n    .Send\n End With\n\nSet rng = Nothing\nSet MyItem = Nothing\nSet myOlApp = Nothing\n\nWorkbooks(Format(Date - 7, \"DD-MM-YY\") &amp; \".xlsx\").Close savechanges:=True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 6, "creation_date": 1575381588, "post_id": 59158687, "comment_id": 104541764, "body": "Is the vba project password protected? If so unprotect it before trying to open the reference menu."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1575390850, "post_id": 59158687, "comment_id": 104547391, "body": "Also, if the error has appeared before going to the VBE, make sure you completely halt execution - i.e. not just &#39;Break&#39;. Reference menu remains greyed out in Break mode."}], "owner": {"reputation": 1, "user_id": 12474271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42771f1a8a77258a268e75a2f2e17d9?s=128&d=identicon&r=PG&f=1", "display_name": "Christoffer", "link": "https://stackoverflow.com/users/12474271/christoffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575387066, "creation_date": 1575381227, "last_edit_date": 1575387066, "question_id": 59158687, "link": "https://stackoverflow.com/questions/59158687/32-bit-macro-not-working-on-64-bit-excel-sheet-compile-error-module-1", "title": "32-bit macro not working on 64-bit excel-sheet? Compile error: module 1", "body": "<p>I have an excel-spreadsheet with a macro created in 32-bit excel, and am now running 64-bit.\nI get error message: \"Compile error in hidden module: Module1.\"</p>\n\n<p>I found following solution from <a href=\"https://www.mrexcel.com/board/threads/compile-error-in-hidden-module-module-1.566811/\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/board/threads/compile-error-in-hidden-module-module-1.566811/</a></p>\n\n<ol>\n<li>From the file in question, press Alt + F11 go into its Visual Basic Editor.</li>\n<li>From the Tools menu select References</li>\n<li>Scroll through the Available References listbox and untick any that start with MISSING:</li>\n<li>Press Alt + Q once all of these reference errors have been unticked.\"</li>\n</ol>\n\n<p>However when I open VBA --> Tools --> References, the \"reference\" button is greyed out and I'm unable to click on it. Macro's are already disabled, yet still not open to click \"reference\". </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1575379998, "post_id": 59158289, "comment_id": 104540704, "body": "Just concatenate the variable in with <code>&amp;</code>."}, {"owner": {"reputation": 1, "user_id": 12474194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f81addb17fe4bab90410d147a4eb348?s=128&d=identicon&r=PG&f=1", "display_name": "LBplshelp", "link": "https://stackoverflow.com/users/12474194/lbplshelp"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575381420, "post_id": 59158289, "comment_id": 104541659, "body": "I&#39;ve tried and that doesn&#39;t seem to work. I get an error every time saying &quot;Method &#39;Range&#39; of object &#39;_Global&#39; failed&quot;"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1575381460, "post_id": 59158289, "comment_id": 104541690, "body": "Can you <a href=\"https://stackoverflow.com/posts/59158289/edit\">edit</a> your question with how you&#39;re concatenating?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 3, "creation_date": 1575381814, "post_id": 59158289, "comment_id": 104541910, "body": "You cannot concatenate &quot;inside&quot; a text, but you can concatenate two text. No &quot;A &amp; B &amp; C&quot; but &quot;A&quot; &amp; B &amp; &quot;C&quot;."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1575381901, "post_id": 59158289, "comment_id": 104541965, "body": "In your case &quot;TableA[Department],TableA[[Column1]:[&quot; &amp; ColumnNumber2 &amp; &quot;]]&quot;"}, {"owner": {"reputation": 1, "user_id": 12474194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f81addb17fe4bab90410d147a4eb348?s=128&d=identicon&r=PG&f=1", "display_name": "LBplshelp", "link": "https://stackoverflow.com/users/12474194/lbplshelp"}, "edited": false, "score": 1, "creation_date": 1575382135, "post_id": 59158289, "comment_id": 104542108, "body": "That worked!!! Thank you so much!"}], "owner": {"reputation": 1, "user_id": 12474194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f81addb17fe4bab90410d147a4eb348?s=128&d=identicon&r=PG&f=1", "display_name": "LBplshelp", "link": "https://stackoverflow.com/users/12474194/lbplshelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575381633, "creation_date": 1575379911, "last_edit_date": 1575381633, "question_id": 59158289, "link": "https://stackoverflow.com/questions/59158289/how-to-select-range-based-on-a-variable-from-a-dynamic-table", "title": "How to select Range, based on a variable, from a dynamic table?", "body": "<p>I am new with VBA and need some help. I am trying to make a column chart using a table in excel. The only issue is that the table changes size based on how much data there is. </p>\n\n<p>Right now I have the following code which selects the table from <code>[Column1]:[Column4]</code>. The only issue is that sometimes I have more/less columns than 4. This causes an error when trying to run the macro. </p>\n\n<p>I have found a way to find out how many columns there are in the table and assigned that value as <code>ColumnNumber</code>. I then converted it to a string to appear as \"Column7\" (if there were 7 columns). But for some reason I can't just put the variable <code>ColumnNumber2</code> in the <code>Range.Select</code> in order to select that amount of columns. Any help would be much appreciated!</p>\n\n<pre><code>'Converts Column Number to Letter\nDim ColumnNumber As Integer\nDim ColumnNumber2 As String\n\n'Input Column Number\n  ColumnNumber = maxLength - 6\n  ColumnNumber2 = \"Column\" &amp; ColumnNumber\n\n'Create Chart\n    Range(\"TableA[Department],TableA[[Column1]:[ &amp; ColumnNumber]]\").Select\n    Range(\"G5\").Activate\n    ActiveSheet.Shapes.AddChart.Select\n    ActiveChart.ChartType = xlColumnClustered\n    ActiveChart.SetSourceData Source:=Range(\"Active_PICAs!TableA[Department],Active_PICAs!TableA[[ &amp; ColumnNumber]:[Column4]]\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1575383418, "post_id": 59158014, "comment_id": 104542886, "body": "I&#39;m afraid nobody is able to help in the way you describe your problem... Two list Boxes with &#39;the exact same code and property settings identic&#39; will work identic if they will process the same data type! They <b>look</b> identic but not seeing both of them and what data do they handle, we cannot deduce where the mistake can be."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575384080, "post_id": 59158014, "comment_id": 104543340, "body": "Do you happen to have a <code>Application.displayalerts = false</code> or an <code>onerror resume next</code> hiding somewhere in the routine that writes to your cell? It looks like the issue is not with the code you posted above, but in your other routine."}, {"owner": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "edited": false, "score": 0, "creation_date": 1575384302, "post_id": 59158014, "comment_id": 104543492, "body": "There is neither of those statements in my code."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "is_accepted": false, "score": 0, "last_activity_date": 1575577440, "creation_date": 1575577440, "answer_id": 59202778, "question_id": 59158014, "link": "https://stackoverflow.com/questions/59158014/listbox-fails-to-return-string-value-when-multiselect-enabled/59202778#59202778", "title": "Listbox fails to return string value when multiselect enabled", "body": "<p>I finally figured it out.</p>\n\n<p>The event handler procedure for the problem <code>Private sub</code> was <code>_click</code>. I Changed it to <code>_change</code> and now it works.</p>\n"}], "owner": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575577440, "creation_date": 1575379025, "last_edit_date": 1575387507, "question_id": 59158014, "link": "https://stackoverflow.com/questions/59158014/listbox-fails-to-return-string-value-when-multiselect-enabled", "title": "Listbox fails to return string value when multiselect enabled", "body": "<p>I have two ActiveX Listboxes set up with the multiselect setting set to <code>2-fmMultiselectextended</code>. The first has the following code to take all the selected values and concatenate them into a string.</p>\n\n<pre><code>Private Sub ICPA_Change()\n\n   Dim i As Long\n   Dim arr(1 To 6) As String\n   Dim Receiving As String\n\n   Receiving = \" \"\n'array for 32 variables. First 6 are displayed here.\n    arr(1) = \"e1\"\n    arr(2) = \"e2\"\n    arr(3) = \"e3\"\n    arr(4) = \"e4\"\n    arr(5) = \"e5\"\n    arr(6) = \"e6\"\n\n   'selects each variable in array that is True and concatenates them into a list string\n\n    For i = 0 To ICPAChange.ListCount - 1\n\n\n\n       If ICPAChange.Selected(i) = True Then\n\n          Receiving = Receiving &amp; arr(i + 1) &amp; \",\" &amp; \" \"\n\n       End If\n\n    Next\n\n\n    Module1.ICPE = Receiving\n\nEnd Sub\n\n</code></pre>\n\n<p>From there the values stored in Module1.ICPE are used by another routine using data from both Listboxes to write to cells in other workbooks.</p>\n\n<pre><code>wbSAR.Worksheets(\"COC form\").Range(\"A56\").Value = Module1.ICPElements\nst.Cells(2 + irow, 4).Offset(, 4).Value = Module1.ICPElements\n\n</code></pre>\n\n<p>The first Listbox works perfectly fine . However the second one, with the exact same code and property settings as the first except for a different number of array variables, gives a blank string in both output cells when multiselect is set to 2. This happens whether I select multiple values or just one. Further examination in debug mode shows that the corresponding variable Module1.ICE, has the correct values stored in it but for some reason it is not being written to the cells which will display them. Switching the multiselect option value to 0 results in the listbox returning a string when a value is selected.</p>\n\n<p>Searching through past questions related to multiselect with a Listbox did not turn up this kind of problem.</p>\n\n<p>The properties for these two boxes is initialized as follows:</p>\n\n<pre><code>'For the first Listbox. Only first 6 out of 32 items are displayed in this code.\nWith ws.OLEObjects.Add(\"Forms.Listbox.1\")\n        .Left = 65\n        .Top = 821\n        .Height = 110\n        .Width = 317\n        .Name = \"ICPA\"\n        With .Object\n            .AddItem \"Item1\"\n            .AddItem \"Item2\"\n            .AddItem \"Item3\"\n            .AddItem \"Item4\"\n            .AddItem \"Item5\"\n            .AddItem \"Item6\"\n            .MultiSelect = 2\n\n        End With\n    End With\n\n\n'For the second Listbox\n    With ws.OLEObjects.Add(\"Forms.Listbox.1\")\n\n        .Left = 750\n        .Top = 1124\n        .Width = 143\n        .Height = 101\n        .Name = \"ICA\"\n        With .Object\n            .AddItem \"item1\"\n            .AddItem \"item2\"\n            .AddItem \"item3\"\n            .AddItem \"item4\"\n            .AddItem \"item5\"\n            .AddItem \"item6\"\n            .AddItem \"item7\"\n            .AddItem \"item8\"\n            .MultiSelect = 2\n\n        End With\n    End With\n\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9n4iS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9n4iS.png\" alt=\"Properties of first ListBox\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/5RaEP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5RaEP.png\" alt=\"Properties of second Listbox\"></a></p>\n\n<p>Attached are images of the properties settings of the two listboxes. </p>\n"}, {"tags": ["html", "json", "excel", "vba"], "comments": [{"owner": {"reputation": 20243, "user_id": 633098, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/73ed4ada98edd7d2b842ee5ddc24bf86?s=128&d=identicon&r=PG", "display_name": "silkfire", "link": "https://stackoverflow.com/users/633098/silkfire"}, "edited": false, "score": 0, "creation_date": 1575374615, "post_id": 59156662, "comment_id": 104537494, "body": "Why don&#39;t you do this with help of a proper programming language?"}, {"owner": {"reputation": 51, "user_id": 12366712, "user_type": "registered", "profile_image": "https://graph.facebook.com/2704952759568230/picture?type=large", "display_name": "Thomas Morris", "link": "https://stackoverflow.com/users/12366712/thomas-morris"}, "reply_to_user": {"reputation": 20243, "user_id": 633098, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/73ed4ada98edd7d2b842ee5ddc24bf86?s=128&d=identicon&r=PG", "display_name": "silkfire", "link": "https://stackoverflow.com/users/633098/silkfire"}, "edited": false, "score": 0, "creation_date": 1575383612, "post_id": 59156662, "comment_id": 104543036, "body": "What do you mean a proper programming language?"}, {"owner": {"reputation": 20243, "user_id": 633098, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/73ed4ada98edd7d2b842ee5ddc24bf86?s=128&d=identicon&r=PG", "display_name": "silkfire", "link": "https://stackoverflow.com/users/633098/silkfire"}, "edited": false, "score": 0, "creation_date": 1575384295, "post_id": 59156662, "comment_id": 104543488, "body": "Build an app in Python, C#, Java or anything else to read the Excel file and ouput JSON, much more straightforward than programming a macro in VBA."}, {"owner": {"reputation": 51, "user_id": 12366712, "user_type": "registered", "profile_image": "https://graph.facebook.com/2704952759568230/picture?type=large", "display_name": "Thomas Morris", "link": "https://stackoverflow.com/users/12366712/thomas-morris"}, "reply_to_user": {"reputation": 20243, "user_id": 633098, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/73ed4ada98edd7d2b842ee5ddc24bf86?s=128&d=identicon&r=PG", "display_name": "silkfire", "link": "https://stackoverflow.com/users/633098/silkfire"}, "edited": false, "score": 0, "creation_date": 1575385004, "post_id": 59156662, "comment_id": 104544004, "body": "Ok, I&#39;ll have a look into it, cheers"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 12366712, "user_type": "registered", "profile_image": "https://graph.facebook.com/2704952759568230/picture?type=large", "display_name": "Thomas Morris", "link": "https://stackoverflow.com/users/12366712/thomas-morris"}, "edited": false, "score": 0, "creation_date": 1575383468, "post_id": 59156893, "comment_id": 104542927, "body": "When I run this example I get an error on Dim d As Dictionary. Where you put add reference to scripting run time what do you mean?"}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "reply_to_user": {"reputation": 51, "user_id": 12366712, "user_type": "registered", "profile_image": "https://graph.facebook.com/2704952759568230/picture?type=large", "display_name": "Thomas Morris", "link": "https://stackoverflow.com/users/12366712/thomas-morris"}, "edited": false, "score": 0, "creation_date": 1575385430, "post_id": 59156893, "comment_id": 104544292, "body": "Go to the VBA editor &gt; Tools &gt; References and select the library Microsoft Scripting Runtime"}], "tags": [], "owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "is_accepted": true, "score": 0, "last_activity_date": 1575375222, "creation_date": 1575375222, "answer_id": 59156893, "question_id": 59156662, "link": "https://stackoverflow.com/questions/59156662/excel-to-json-file-from-excel-vba/59156893#59156893", "title": "Excel to json file from Excel VBA", "body": "<p>You will need to import the Json converter to your VBA project first from here:</p>\n\n<p><a href=\"https://raw.githubusercontent.com/VBA-tools/VBA-JSON/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">https://raw.githubusercontent.com/VBA-tools/VBA-JSON/master/JsonConverter.bas</a></p>\n\n<p>Then you can do it like this:</p>\n\n<pre><code>Sub convertJson()\n\n    Dim c As Collection\n    Dim d As Dictionary 'Add reference to scripting runtime\n    Dim v As Dictionary\n    Dim json As String\n\n    Set c = New Collection\n    Set d = New Dictionary\n\n\n    d.Add \"ExcelTest\", c\n    For Each cell In Range(\"A2:A4\") 'Adapt as you need\n        Set v = New Dictionary\n        v.Add \"name\", cell.Value\n        v.Add \"age\", cell.Offset(0, 1).Value\n        c.Add v\n    Next\n\n    json = JsonConverter.ConvertToJson(d)\n\n    Debug.Print json\n\nEnd Sub\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>{\"ExcelTest\":[{\"name\":\"test1\",\"age\":15},{\"name\":\"test2\",\"age\":1},{\"name\":\"test3\",\"age\":435}]}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 12366712, "user_type": "registered", "profile_image": "https://graph.facebook.com/2704952759568230/picture?type=large", "display_name": "Thomas Morris", "link": "https://stackoverflow.com/users/12366712/thomas-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "accepted_answer_id": 59156893, "answer_count": 1, "score": 0, "last_activity_date": 1575375241, "creation_date": 1575374487, "last_edit_date": 1575375241, "question_id": 59156662, "link": "https://stackoverflow.com/questions/59156662/excel-to-json-file-from-excel-vba", "title": "Excel to json file from Excel VBA", "body": "<p>I want to have a button in an excel document (using VBA) which, takes in the data on the sheet and outputs a file (.json). Which I can then use later on within a web page.</p>\n\n<p>I my excel data looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Qyhdy.png\" alt=\"Image of excel table\"></p>\n\n<p>Note  I would like to have more than one instance of data.\nI want it to generate a json file in the format of:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>{\r\n\t\"Excel_test\": [\r\n\t\t{\r\n\t\t\t\"name\" : \"tesintg1\",\r\n\t\t\t\"age\" : 15\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"name\" : \"testng2\",\r\n\t\t\t\"age\" : 1\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"name\" : \"testing3\",\r\n\t\t\t\"age\" : 435\r\n\t\t}\r\n\t]\r\n}\r\nThanks</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1575374601, "post_id": 59156603, "comment_id": 104537486, "body": "You need to explain how to <i>identify</i> which sheet should be copied?"}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1575374931, "creation_date": 1575374931, "answer_id": 59156805, "question_id": 59156603, "link": "https://stackoverflow.com/questions/59156603/amend-macro-to-copy-data-from-worksheets-with-different-names/59156805#59156805", "title": "Amend Macro to copy data from worksheets with different names", "body": "<p>If the name of the workbook will always be the same and only the version will change, you can loop through all the open workbooks you have and check only for \"Prom Code Grid\" in the name ignoring the version.</p>\n\n<pre><code>    Sub get_Prom_Code \n\nDim Prom_WK as Workbook \nFor Each wk in Application.Workbooks \n  If Instr(1, wk.name, \"Prom Code Grid\") &gt; 0 Then \n    Set Prom_WK = wk \n  End if \nNext wk \n\nProm_WK.Activate\nProm_WK.Sheets(\"Prom Code Loading\").Copy Before:=Workbooks(\"gridload.xlsm\").Sheets(1) End Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 12473704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0e82ab248069dcd25a57f6c872f7bd?s=128&d=identicon&r=PG&f=1", "display_name": "noobatexcel", "link": "https://stackoverflow.com/users/12473704/noobatexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "closed_date": 1575398562, "accepted_answer_id": 59156805, "answer_count": 1, "score": -1, "last_activity_date": 1575374931, "creation_date": 1575374297, "last_edit_date": 1575374340, "question_id": 59156603, "link": "https://stackoverflow.com/questions/59156603/amend-macro-to-copy-data-from-worksheets-with-different-names", "closed_reason": "Needs details or clarity", "title": "Amend Macro to copy data from worksheets with different names", "body": "<p>The issue i have is that the workbook will have many versions. e.g Prom Code Grid V43 etc. How can I amend the code so the sheet is copied regardless of the name of the workbook?</p>\n\n<pre><code>Windows(\"Prom Code Grid V42.xlsx\").Activate\nSheets(\"Prom Code Loading\").Select\nSheets(\"Prom Code Loading\").Copy Before:=Workbooks(\"gridload.xlsm\").Sheets(1)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1575374005, "post_id": 59156477, "comment_id": 104537159, "body": "First of all, your path needs a backslash at the end... and remove <code>On Error Resume Next</code> so you can see the errors and troubleshoot them. Use F8 to step through the code. Set breakpoints. Check variables as you go."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1575374114, "post_id": 59156477, "comment_id": 104537229, "body": "Also I can see that You&#39;re doing <code>rg = sFilename</code> and the line below You are trying to &quot;offset&quot; the Filename with <code>rg.Offset(0, 1) = NbRows</code>, it rather won&#39;t work."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575374407, "post_id": 59156477, "comment_id": 104537389, "body": "After testing your issue seems to be this: <code>sFilename = Dir(sPath &amp; &quot;*.xls&quot;)</code> doesn&#39;t return anything, because it strings the filename to the end of your folder name, which obviously doesn&#39;t exist. Change it to <code>sFilename = Dir(sPath &amp; &quot;\\&quot; &amp; &quot;*.xls&quot;)</code>."}, {"owner": {"reputation": 4636, "user_id": 4295763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/q1g7U.jpg?s=128&g=1", "display_name": "Arun Palanisamy", "link": "https://stackoverflow.com/users/4295763/arun-palanisamy"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1575374593, "post_id": 59156477, "comment_id": 104537482, "body": "@braX  Done. I have added the backslash and removed <code>On Error Resume Next</code>. It is not showing any error as well."}, {"owner": {"reputation": 4636, "user_id": 4295763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/q1g7U.jpg?s=128&g=1", "display_name": "Arun Palanisamy", "link": "https://stackoverflow.com/users/4295763/arun-palanisamy"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575374659, "post_id": 59156477, "comment_id": 104537518, "body": "@Plutian , i have tried changing the line that you have mentioned. But still it is same. No output."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575374739, "post_id": 59156477, "comment_id": 104537571, "body": "Line <code>Set wbXLS = Workbooks.Open(sPath &amp; sFilename)</code> has the same issue. <code>Set wbXLS = Workbooks.Open(sPath &amp; &quot;\\&quot; &amp; sFilename)</code>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1575375260, "post_id": 59156477, "comment_id": 104537890, "body": "Set a breakpoint (F9) at <code>Do While Len(sFilename) &gt; 0</code> and check your variables, use F8 to step line by line to see what it&#39;s doing."}], "answers": [{"comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1575376665, "post_id": 59157199, "comment_id": 104538675, "body": "Just an observation. <code>Dim wb, wbXLS As Workbook</code>. In that line, only <code>wbXLS</code> is being defined as <code>Workbook</code>. Variable <code>wb</code>, because there is no data/object type specified, is being defined as <code>Variant</code>. I think it should be <code>Dim wb as Workbook, wbXLS As Workbook</code>. Also <code>wb.Sheets.Cells</code>, you don&#39;t specify a sheet. It should be something like <code>wb.Sheets(1).Cells</code> or <code>wb.ActiveSheet.Cells</code>. Also <code>wbXLS.Sheets(1).Range(&quot;A&quot; &amp; Cells(Rows.Count, 1).End(xlUp).Row).Cells.Count</code> will return cell count, not row count as OP wants"}, {"owner": {"reputation": 4636, "user_id": 4295763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/q1g7U.jpg?s=128&g=1", "display_name": "Arun Palanisamy", "link": "https://stackoverflow.com/users/4295763/arun-palanisamy"}, "edited": false, "score": 0, "creation_date": 1575379573, "post_id": 59157199, "comment_id": 104540450, "body": "@Pablo G, i&#39;m getting <code>run time error 438</code>. this property not supported in the line <code>wb.Sheets.Cells(i, 1).Value = Replace(objFil.Name, &quot;.xls&quot;, &quot;&quot;)</code>"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 0, "creation_date": 1575380687, "post_id": 59157199, "comment_id": 104541160, "body": "Make sure that when you run the macro, you are setting wb with the workbook where you want to output the data. I edited in the answer a comment line. Or else, how is the name of the file where you need the output data?"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1575381024, "post_id": 59157199, "comment_id": 104541378, "body": "@FoxfireAndBurnsAndBurns, you are right. I missed adding Sheets(1), so it was throwing an error"}], "tags": [], "owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1575381064, "last_edit_date": 1575381064, "creation_date": 1575376271, "answer_id": 59157199, "question_id": 59156477, "link": "https://stackoverflow.com/questions/59156477/print-number-of-rows-in-each-file-inside-a-folder/59157199#59157199", "title": "Print number of rows in each file inside a folder", "body": "<p>VBA has methods that make looping through files much easier. Try looping all the .xls files in your folder like this</p>\n\n<pre><code>Sub count_rows()\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nDim wb, wbXLS As Workbook\nSet wb = ActiveWorkbook   'the workbook where you output the data must be active when you run the macro\n\nDim objFSO As Object\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nDim myfolder As Object\nSet myfolder = objFSO.GetFolder(\"INSERT YOUR FOLDER PATH HERE\") 'sets the folder where you have the .xls files to loop\n\nFor Each objFil In myfolder.Files\n    i = i + 1\n    If InStr(1, objFil.name, \".xls\") &gt; 0 Then  'you make sure you are only working with .xls files inside your folder\n        Set wbXLS = Workbooks.Open(objFil.Path)\n        NbRows = wbXLS.Sheets(1).Range(\"A\" &amp; Cells(Rows.Count, 1).End(xlUp).Row).Row   'this will count all the cells in column A (it doesn't discriminate blank cells)\n        wb.Sheets(1).Cells(i, 1).Value = Replace(objFil.name, \".xls\", \"\")\n        wb.Sheets(1).Cells(i, 2).Value = NbRows\n        wbXLS.Close False\n        Set wbXLS = Nothing\n    End If\nNext objFil\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4636, "user_id": 4295763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/q1g7U.jpg?s=128&g=1", "display_name": "Arun Palanisamy", "link": "https://stackoverflow.com/users/4295763/arun-palanisamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 59157199, "answer_count": 1, "score": 0, "last_activity_date": 1575381064, "creation_date": 1575373893, "last_edit_date": 1575375794, "question_id": 59156477, "link": "https://stackoverflow.com/questions/59156477/print-number-of-rows-in-each-file-inside-a-folder", "title": "Print number of rows in each file inside a folder", "body": "<p>I have a folder <code>D:\\Arun\\myfolder</code>. Inside this say I have 60 files. I want to know the number of rows inside each file like below: (probably written in a separate sheet)</p>\n\n<pre><code> File1 - 240 rows\n File2 - 321 rows\n File3 - 178 rows\n .. \n ..\n</code></pre>\n\n<p>So I'm trying with the below code, but it is not giving me any output. I have very little knowledge in <code>VBA</code> and I'm not sure why the below code is not working.</p>\n\n<pre><code>Sub CountRows()\n\n    Dim wb As Workbook, wbXLS As Workbook\n    Dim sPath As String, sFilename As String\n    Dim NbRows As Integer, rg As Range\n    DisplayAlerts = False\n    Set wb = ThisWorkbook\n    Application.ScreenUpdating = False\n    sPath = \"D:\\Arun\\myfolder\"       'Path of XLS Files\n    sFilename = Dir(sPath &amp; \"*.xls\")\n    On Error Resume Next\n    Do While Len(sFilename) &gt; 0\n        If sFilename &lt;&gt; ThisWorkbook.FullName Then\n            Set wbXLS = Workbooks.Open(sPath &amp; sFilename)           'open file\n            NbRows = wbXLS.Sheets(1).Range(\"A60000\").End(xlUp).Row  'nb of rows\n            Set rg = wb.Worksheets(\"Check\").Range(\"A60000\").End(xlUp).Offset(1, 0)\n            rg = sFilename\n            rg.Offset(0, 1) = NbRows\n            wbXLS.Close False   'close file\n        End If\n        sFilename = Dir\n    Loop\n    Application.ScreenUpdating = True\n    DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "insert", "conditional-formatting"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1575373292, "post_id": 59156233, "comment_id": 104536788, "body": "<code>ThisWorkbook.Sheets(&quot;Code&quot;).Rows(4).FormatConditions</code> would reveal them, you could copy and pastespecial formats too.  Your code seems to work ok though.  What are the rules?"}, {"owner": {"reputation": 3, "user_id": 12452508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8cf864143d3a22ecfc696cc72d1e01?s=128&d=identicon&r=PG&f=1", "display_name": "Guyver", "link": "https://stackoverflow.com/users/12452508/guyver"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1575374055, "post_id": 59156233, "comment_id": 104537189, "body": "i tried this but it wouldn&#39;t work and kept debugging, the rule are when specific text is selected from drop down cells it changes the cell colour to the assigned text"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1575374364, "post_id": 59156233, "comment_id": 104537360, "body": "but what do they relate to, is the sheet name in there, are they just to the template sheet etc?"}, {"owner": {"reputation": 3, "user_id": 12452508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8cf864143d3a22ecfc696cc72d1e01?s=128&d=identicon&r=PG&f=1", "display_name": "Guyver", "link": "https://stackoverflow.com/users/12452508/guyver"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1575374827, "post_id": 59156233, "comment_id": 104537616, "body": "sorry, they relate to the sheet PO1&#39;s were the row is being inserted, the template is a copy of one of the rows on it but going forward through the year i will have to insert the template line as i add people to it. all the CF was created on the PO1 sheet"}, {"owner": {"reputation": 689, "user_id": 9423196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJuOc.jpg?s=128&g=1", "display_name": "Daghan", "link": "https://stackoverflow.com/users/9423196/daghan"}, "edited": false, "score": 0, "creation_date": 1575375221, "post_id": 59156233, "comment_id": 104537859, "body": "The drop-down is not conditional formatting but data-validation. Check where the list-source is located."}, {"owner": {"reputation": 3, "user_id": 12452508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8cf864143d3a22ecfc696cc72d1e01?s=128&d=identicon&r=PG&f=1", "display_name": "Guyver", "link": "https://stackoverflow.com/users/12452508/guyver"}, "edited": false, "score": 0, "creation_date": 1575375431, "post_id": 59156233, "comment_id": 104537992, "body": "the conditional format is what colour in changes to from the text selected from the datavalidation"}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1575381541, "creation_date": 1575381541, "answer_id": 59158779, "question_id": 59156233, "link": "https://stackoverflow.com/questions/59156233/copy-conditional-format-when-inserting-new-row/59158779#59158779", "title": "Copy conditional format when inserting new row", "body": "<p>As per documentation, <a href=\"https://docs.microsoft.com/es-es/office/vba/api/excel.xlpastetype\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/es-es/office/vba/api/excel.xlpastetype</a>, you can use PasteSpecial on the row you added, and paste the format</p>\n\n<pre><code>ThisWorkbook.Sheets(\"PO1's\").Range(\"A7\").End(xlDown).Offset(-1, 0).PasteSpecial(xlPasteFormats)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12452508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8cf864143d3a22ecfc696cc72d1e01?s=128&d=identicon&r=PG&f=1", "display_name": "Guyver", "link": "https://stackoverflow.com/users/12452508/guyver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575381541, "creation_date": 1575373052, "last_edit_date": 1575373722, "question_id": 59156233, "link": "https://stackoverflow.com/questions/59156233/copy-conditional-format-when-inserting-new-row", "title": "Copy conditional format when inserting new row", "body": "<p>I've created the code below to copy a template row of data that contains data validation and conditional format colors from a hidden sheet and insert it to a specific row.</p>\n\n<p>The issue is everything works apart from the conditional format, all of the drop down cells remain white?</p>\n\n<pre><code>Sub Newstaff()\n\nThisWorkbook.Sheets(\"Code\").Rows(4).Copy\nThisWorkbook.Sheets(\"PO1's\").Range(\"A7\").End(xlDown).Offset(-1, 0).EntireRow.Insert\n\nEnd Sub\n</code></pre>\n\n<p>How do I change it so that when the new row is inserted it includes the colors from each of the conditions?</p>\n"}, {"tags": ["excel", "xml", "vba"], "comments": [{"owner": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "edited": false, "score": 0, "creation_date": 1575373511, "post_id": 59156203, "comment_id": 104536896, "body": "Hi, and welcome. There&#39;s no attempt at code here, it&#39;s worth reading the <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> guide. Aside from this, it&#39;s possible to import XML without VBA in excel: <a href=\"https://www.howtoexcel.org/power-query/import-xml-files/\" rel=\"nofollow noreferrer\">howtoexcel.org/power-query/import-xml-files</a>"}, {"owner": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "reply_to_user": {"reputation": 1433, "user_id": 2381393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b047e96860b269ecfe7f0870fedeaa4?s=128&d=identicon&r=PG", "display_name": "RowanC", "link": "https://stackoverflow.com/users/2381393/rowanc"}, "edited": false, "score": 0, "creation_date": 1575374918, "post_id": 59156203, "comment_id": 104537677, "body": "@RowanC, Thank you for your inputs. I&#39;m just trying to understand the logic to validate every node from the xml file and get values of some specific tags. And yes, I did try xml import option in excel but that is not going to solve my problem. I have xml files which has more that 5000+ records so its a bit challenging to validate dynamic tags."}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 2, "creation_date": 1575390072, "post_id": 59156203, "comment_id": 104546957, "body": "now all that seems to be missing is the exact error message, and the location in the code where you get that error."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1575444991, "post_id": 59156203, "comment_id": 104564456, "body": "What do you expect <code>authorNodesValue(i)</code> to be? <code>authorNodesValue</code> is an object but an <code>(i)</code> does not exist. What is your goal here. Also <code>&#47;Order&#47;srcOrderId</code> does not exist in your example XML file. Please clarify and <a href=\"https://stackoverflow.com/posts/59156203/edit\">edit</a> your question. \u2022 Do you want to generate the complete output that you show from the XML file? or is there already data in the output sheet? Here it is unclear what your exact goal is."}, {"owner": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1575456407, "post_id": 59156203, "comment_id": 104570334, "body": "@P\u1d07\u029c, I&#39;m checking whether a node exists in xml file or not. If the tag does exists then I&#39;m trying to fetch value of that node and if the tag does not exists then I&#39;m printing a blank value in excel sheet. attached excel sheet is the expected output. As per the xml file, data will get added in excel sheet. Since there are total 3 &quot;books&quot; records in xml file, &quot;i&quot; represents every record starting from books id=1 to id=3."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1575456976, "post_id": 59156203, "comment_id": 104570642, "body": "But what is <code>&#47;Order&#47;srcOrderId</code>? It is neither in your XML nor in your output sheet. Please be more precise."}, {"owner": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1575458387, "post_id": 59156203, "comment_id": 104571334, "body": "@P\u1d07\u029c, By mistakenly I added  /Order/srcOrderId from my original xml file. I have updated the question now."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1575458902, "post_id": 59156203, "comment_id": 104571581, "body": "@Prakash Well, with the updated code there is no error and it works, you really need to be more precise."}, {"owner": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1575459411, "post_id": 59156203, "comment_id": 104571852, "body": "@P\u1d07\u029c, Sorry for the trouble. And yeah that&#39;s true because I did some change in my xml file so It&#39;s working for &quot;author tag&quot; but if you try for &quot;publish_dateNodes&quot; you will encounter this issue (Code updated again). I&#39;m trying my best to be more precise and learning from my first post."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "edited": false, "score": 0, "creation_date": 1575527919, "post_id": 59176386, "comment_id": 104598529, "body": "Thank you for sharing this. Getting some errors while running the given solution but let me try to fix them. If I need any help then will trouble you again :P Thanks a lot mate."}, {"owner": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "edited": false, "score": 0, "creation_date": 1575538562, "post_id": 59176386, "comment_id": 104602980, "body": "Hello, I was debugging the code and found out &quot;Set Books = obj.SelectNodes(&quot;//Books/book&quot;)&quot; returns (0) so its not going inside the For loop. Even if I change loop value from 0 to 3 (any positive value) &quot;Set CurrentNode = Books(iBook).SelectNodes(NodesOutputList(iNode))(0)&quot; line is throwing an error. Error message : Runtime error &#39;91&#39;: Object variable or With block variable not set"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "edited": false, "score": 0, "creation_date": 1575539755, "post_id": 59176386, "comment_id": 104603644, "body": "@Prakash Make sure you used the correct path in <code>XMLFileName = &quot;D:\\code\\Demo.xml&quot;</code>"}, {"owner": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "edited": false, "score": 0, "creation_date": 1575541843, "post_id": 59176386, "comment_id": 104604739, "body": "@PEH, the path is correct. I&#39;m able to access the XML file. :("}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "edited": false, "score": 0, "creation_date": 1575542062, "post_id": 59176386, "comment_id": 104604870, "body": "@Prakash Well I tested it with exactly the content you provided in your question and it worked with that code (see the screenshot which was my result from the XML in your question). Please re-check and use the exact same data to test."}, {"owner": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "edited": false, "score": 0, "creation_date": 1575544777, "post_id": 59176386, "comment_id": 104606382, "body": "Sure, Let me check again. Thank you again."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1575542029, "last_edit_date": 1575542029, "creation_date": 1575463556, "answer_id": 59176386, "question_id": 59156203, "link": "https://stackoverflow.com/questions/59156203/how-to-handle-and-get-values-from-dynamic-tags-from-xml-file-in-vba-macro/59176386#59176386", "title": "How to handle and get values from dynamic tags from XML file in VBA macro", "body": "<ol>\n<li><p>It should be a procedure (<code>Sub</code>) not a function, because it does not return a value (make sure you know the difference).</p></li>\n<li><p>The way you read the sub nodes made it impossible to keep the data consitent. You need to read all books first and then for each book the sub nodes:</p>\n\n<pre><code>Set CurrentNode = Books(iBook).SelectNodes(\"author/text()\")(0)\n</code></pre>\n\n<p>The above reads reads the node <code>author</code> from book number <code>iBook</code> into <code>CurrentNode</code> and if it does not exist then <code>CurrentNode</code> will be <code>Nothing</code>. So you just need to check it and output the <code>.NodeValue</code>.</p>\n\n<p>Note that I introduced an array <code>NodesOutputList</code> to be able to loop through the columns easily instead of repeating similar code over and over.</p></li>\n</ol>\n\n<p>So you end up with something like:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPublic Sub fnReadXMLByTags2()\n    Dim mainWorkBook As Workbook\n    Set mainWorkBook = ThisWorkbook '&lt;-- this is the workbook where this code is in ActiveWorkbook is the worbkook that has focus (is on top)\n\n    Dim wsOutput As Worksheet 'define output sheet\n    Set wsOutput = mainWorkBook.Worksheets(\"Sheet3\")\n\n    Dim XMLFileName As String\n    XMLFileName = \"D:\\code\\Demo.xml\"\n\n    Dim obj As Object\n    Set obj = CreateObject(\"MSXML2.DOMDocument\")\n    obj.async = False\n    obj.Load XMLFileName '&lt;-- no parenthesis here!!!\n\n    Dim Books As Object 'get all books\n    Set Books = obj.SelectNodes(\"//Books/book\")\n\n    Dim NodesOutputList() As Variant 'order in which the nodes are checked and output\n    NodesOutputList = Array(\"author/text()\", \"title/text()\", \"genre/text()\", \"price/text()\", \"publish_date/text()\", \"language/text()\", \"description/text()\")\n\n    Dim iBook As Long\n    For iBook = 0 To Books.Length - 1 'loop through books\n\n        Dim iNode As Long\n        For iNode = LBound(NodesOutputList) To UBound(NodesOutputList) 'loop through nodes in the list\n            Dim CurrentNode As Object\n            Set CurrentNode = Books(iBook).SelectNodes(NodesOutputList(iNode))(0)\n            If Not CurrentNode Is Nothing Then\n                wsOutput.Cells(iBook + 2, iNode + 1).Value = CurrentNode.NodeValue\n            Else\n                wsOutput.Cells(iBook + 2, iNode + 1).Value = \"blank\"\n            End If\n        Next iNode\n\n    Next iBook\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cJFpW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cJFpW.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 11022023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24d1380e44d77107a58e9341190136b9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/11022023/prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 1, "accepted_answer_id": 59176386, "answer_count": 1, "score": -2, "last_activity_date": 1575542029, "creation_date": 1575372945, "last_edit_date": 1575472351, "question_id": 59156203, "link": "https://stackoverflow.com/questions/59156203/how-to-handle-and-get-values-from-dynamic-tags-from-xml-file-in-vba-macro", "title": "How to handle and get values from dynamic tags from XML file in VBA macro", "body": "<p>I have an XML file with 3 levels. Some of the tags are dynamic.<em>(Please check below XML file)</em></p>\n\n<p>I have to validate whether the tag \"price\" is present in all nodes or not and also need to get value of \"price tag\". I also need to fetch a value of every node present in XML file.</p>\n\n<p>I tried validating whether every node in XML file is present or not but getting an error\n<strong>VBA code snippet</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function fnReadXMLByTags2()\n\nDim mainWorkBook As Workbook\nSet mainWorkBook = ActiveWorkbook\n\nDim obj As Object\nSet obj = CreateObject(\"MSXML2.DOMDocument\")\nobj.async = False\n\nXMLFileName = \"C:\\Prakash\\Demo.xml\"\n\nobj.Load (XMLFileName)\n\nSet authorNodes = obj.SelectNodes(\"//Books/book/author/text()\")\nSet titleNodes = obj.SelectNodes(\"//Books/book/title/text()\")\nSet genreNodes = obj.SelectNodes(\"//Books/book/genre/text()\")\nSet priceNodes = obj.SelectNodes(\"//Books/book/price/text()\")\nSet publish_dateNodes = obj.SelectNodes(\"//Books/book/publish_date/text()\")\nSet languageNodes = obj.SelectNodes(\"//Books/book/language/text()\")\n\n    For i = 0 To (authorNodes.Length - 1)\n\n        If Not publish_dateNodes Is Nothing Then\n            Set publish_dateNodesValue = obj.SelectNodes(\"//Books/book/publish_date/text()\")\n            publish_dateObj = publish_dateNodesValue(i).NodeValue\n            mainWorkBook.Sheets(\"Sheet3\").Range(\"E\" &amp; i + 2).Value = publish_dateObj\n        Else\n            mainWorkBook.Sheets(\"Sheet3\").Range(\"E\" &amp; i + 2).Value = \"Blank\"\n        End If\n\n    Next\nEnd Function\n</code></pre>\n\n<p><strong>Below error Message for line \u2026</strong> </p>\n\n<pre><code>publish_dateObj = publish_dateNodesValue(i).NodeValue \n</code></pre>\n\n<blockquote>\n  <p>Runtime error '91':<br>\n  Object variable or With block variable not set</p>\n</blockquote>\n\n<p><strong>This is what I'm expecting in Excel file:</strong> </p>\n\n<p>Excel sheet output</p>\n\n<p><img src=\"https://i.stack.imgur.com/9njVo.png\" alt=\"Excel sheet expected\"></p>\n\n<p>Below is the xml file :</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Books&gt;\n   &lt;book id=\"1\"&gt;\n      &lt;author&gt;ABC&lt;/author&gt;\n      &lt;title&gt;Physics&lt;/title&gt;\n      &lt;genre&gt;asd&lt;/genre&gt;\n      &lt;price&gt;Rs.44&lt;/price&gt;\n      &lt;publish_date&gt;20-10-2001&lt;/publish_date&gt;\n      &lt;description&gt;Book1&lt;/description&gt;\n   &lt;/book&gt;\n   &lt;book id=\"2\"&gt;\n      &lt;author&gt;DEF&lt;/author&gt;\n      &lt;title&gt;Chem&lt;/title&gt;\n      &lt;genre&gt;XYZ&lt;/genre&gt;\n      &lt;publish_date&gt;02-12-2016&lt;/publish_date&gt;\n      &lt;description&gt;Book2&lt;/description&gt;\n   &lt;/book&gt;\n   &lt;book id=\"3\"&gt;\n      &lt;author&gt;GHI&lt;/author&gt;\n      &lt;title&gt;Maths&lt;/title&gt;\n      &lt;genre&gt;ABC&lt;/genre&gt;\n      &lt;price&gt;Rs.500&lt;/price&gt;\n      &lt;language&gt;English&lt;/language&gt;\n      &lt;description&gt;Book3&lt;/description&gt;\n   &lt;/book&gt;\n&lt;/Books&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "userform"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575373577, "post_id": 59156187, "comment_id": 104536933, "body": "I suggest starting <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here</a> on how to avoid using select, as it is bad practise."}, {"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575383121, "post_id": 59156187, "comment_id": 104542676, "body": "Thanks. Could this solve my problem? Do you have an idea why my macro suddenly calls the userform?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575383665, "post_id": 59156187, "comment_id": 104543070, "body": "I don&#39;t see why. Can you give us your complete code? Because this is just your copy-paste action. The trigger might be elsewhere. Please include the code linked to the button which calls your userform as well."}], "owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575387955, "creation_date": 1575372899, "last_edit_date": 1575387955, "question_id": 59156187, "link": "https://stackoverflow.com/questions/59156187/my-vba-code-jumps-to-a-userform-mid-macro-when-copying-one-sheet-to-another-even", "title": "My VBA code jumps to a userform mid macro when copying one sheet to another even though code doesn&#39;t dictate this", "body": "<p>My macro runs the userform initialize macro when copying one sheet to another. On the first sheet I have a button which is starting up the userform and my macro is copying this button to the next sheet along with the data. The macro worked perfectly fine before, however now the userform button seems to call the initializing sub from the userform even though it is not called upon in the code. It happens when copying the sheet. Below is the code.</p>\n\n<pre><code>Sub ExampleSUB()\n\n'Delete Sheets After Sheet\n\n    Dim i As Long\n    Dim j As Long\n    Dim WS As Worksheet\nDim StartCell As Range\nDim Myvalue As String\n\n    j = 0\n    For i = 1 To Sheets.Count\n        If Sheets(i).Name = \"ABC\" Then\n            j = i\n        End If\n    Next i\n\n    If j = 0 Or j = Sheets.Count Then\n    End If\n\n    Application.DisplayAlerts = False\n        For i = Sheets.Count To j + 1 Step -1\n            Sheets(i).Delete\n        Next i\n    Application.DisplayAlerts = True\n\n\nMyvalue = \"Example\"\n\n'Create New Sheet\nSet WS = Sheets.Add(after:=Sheets(Worksheets.Count))\n    WS.Name = Myvalue\n\n'If Sheet is VeryHidden\nDim WasHidden\n\n    Application.ScreenUpdating = False\n    If Sheets(\"total BU cost per product\").Visible = xlSheetVeryHidden Then\n        Sheets(\"total BU cost per product\").Visible = xlSheetVisible\n        WasHidden = True\n    End If\n</code></pre>\n\n<p>calls initialize sub in following section</p>\n\n<pre><code>    Sheets(\"total BU cost per product\").Select\n    Cells.Select\n    Selection.Copy\n    Sheets(Myvalue).Select\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n</code></pre>\n\n<p>Below is code from userform it mysteriously calls:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nWith ListBox1\n    .AddItem \"Denmark\"\n    .AddItem \"Sweden\"\n    .AddItem \"Norway\"\n    .AddItem \"Finland\"\n    .AddItem \"Luxembourg\"\n    .AddItem \"Germany\"\n    .AddItem \"UK\"\n    .AddItem \"Finland\"\nEnd With\n\nOptionButton3.Value = True\n\nEnd Sub\n</code></pre>\n\n<p>The userform is called through below</p>\n\n<pre><code>private sub showuserform ()\nselection.show\nend sub\n</code></pre>\n\n<p>but when I run through the code (F8), it doesn't seem like it calls the showuserform sub</p>\n\n<p>Here is the link to the userform I use: <a href=\"https://www.excel-easy.com/vba/examples/multiple-list-box-selections.html\" rel=\"nofollow noreferrer\">https://www.excel-easy.com/vba/examples/multiple-list-box-selections.html</a></p>\n\n<p>Why does it automatically run the userform sub?</p>\n"}]