[{"tags": ["excel", "macros", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1458778708, "creation_date": 1458778708, "answer_id": 36191128, "question_id": 36190825, "link": "https://stackoverflow.com/questions/36190825/macro-to-repeat-itself-on-the-next-rown-down/36191128#36191128", "title": "Macro to repeat itself on the next rown down", "body": "<p>I think this loop is what you are looking for.</p>\n\n<pre><code>Sub Macro2()\n    ' Macro2 Macro\n    Dim rw As Long\n\n    With Worksheets(\"amps_job_history\")\n        For rw = 2 To .Cells(Rows.Count, \"A\").End(xlUp).Row\n            With Intersect(.Range(\"A:BW\"), .Rows(rw))\n                Worksheets(\"Lookup\").Range(\"F3\").Resize(.Rows.Count, .Columns.Count) = .Value\n            End With\n\n            With Worksheets(\"Lookup\")\n                With .Range(\"F3:V3\")\n                    Worksheets(\"Result\").Range(\"A1\").Offset(rw - 1, 0).Resize(.Rows.Count, .Columns.Count) = .Value\n                End With\n            End With\n        Next rw\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The rows from the source data in the amps_job_history and the destination Result worksheet are shifted down one more row on each loop. The transitional F3:V3 range in the Lookup worksheet remains the same through out.</p>\n\n<p>I've use direct value transfer rather than copy, paste special, values and the <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> provide explicit parent worksheet referencing without the use of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197597.aspx\" rel=\"nofollow\">Range .Select</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221681.aspx\" rel=\"nofollow\">Range .Activate</a> methods.</p>\n"}], "owner": {"reputation": 11, "user_id": 4914527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b38062db86963b9d9ca37ce75b4d09?s=128&d=identicon&r=PG&f=1", "display_name": "ReneeK", "link": "https://stackoverflow.com/users/4914527/reneek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1458778708, "creation_date": 1458776692, "last_edit_date": 1531164843, "question_id": 36190825, "link": "https://stackoverflow.com/questions/36190825/macro-to-repeat-itself-on-the-next-rown-down", "title": "Macro to repeat itself on the next rown down", "body": "<p>I have this macro which works ok on the first row, but once it has completed I want it to run again on the next row down and paste the result on the next row down on the \"results\" sheet and continue the process through the whole document until it reaches the last record - (there are approx. 5300 records in my spreadsheet)</p>\n\n<pre><code>Sub Macro2()\n    ' Macro2 Macro\n\n    Range(\"A2:BW2\").Select\n    Selection.Copy\n    Sheets(\"Lookup\").Select\n    Range(\"F3\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"F3:V3\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Result\").Select\n    Range(\"A2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n\n<p>So basically I am copying the first row of data on sheet named \"amps_job_history\", it them pastes this data into a sheet called \"lookup\", once the data is pasted there a formula does a calculation that marries the data up with data from another worksheet.  I then want to copy the original data plus the extra 3 columns that have been connected to the data with the formulas and the paste it into the sheet called \"result\".  I then want it to go back to the first sheet \"amps_job_hisotry\" move down to the next row of data and repeat the process and when it pastes the data into the \"result\" page it need to past on the next row down and so on and so on until it reaches the last record.</p>\n"}, {"tags": ["excel", "range", "visible", "listobject", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1458785997, "post_id": 36190688, "comment_id": 60018983, "body": "There are already native worksheet functions like <a href=\"https://support.office.com/en-us/article/SUBTOTAL-function-e27c301c-be9a-458b-9d12-b9a2ce3c62af\" rel=\"nofollow noreferrer\">SUBTOTAL</a> and <a href=\"https://support.office.com/en-us/article/AGGREGATE-function-43B9278E-6AA7-4F17-92B6-E19993FA26DF\" rel=\"nofollow noreferrer\">AGGREGATE</a> that do this. What is your end-game?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1458806675, "post_id": 36190688, "comment_id": 60024796, "body": "@jeeped I am actually filtering the listobject using a listbox that is filled with the items from 1st column of the list object. End game is to use the visible words from 2nd column and their indices from 3rd column to create a tag cloud of words. The font size of words would depend on its  index. Font Color would be any chosen color gradient from light to dark (big to small)."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1458826868, "post_id": 36190688, "comment_id": 60036535, "body": "@jeeped it seems listobject doesnt really hide the rows (especially the entire rows), hence the complete range address shows as visible address. Whereas, Activesheet.usedrange seems to take into account the entire rows as hidden, so it is able to give the visible range address."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1458826977, "post_id": 36190688, "comment_id": 60036609, "body": "i really need a workaround to get the visible range from the listobject columns ranges that are passed to the function. also, Subtotal and Aggregate are good for getting a count of visible rows, but they do not return a visible range object from a listobject."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1458833364, "post_id": 36190688, "comment_id": 60041190, "body": "Your first bit of code should work. Did you check what was returned for rng.Address in the immediate window?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1458834082, "post_id": 36190688, "comment_id": 60041717, "body": "which code were you referring? yes, it only shows the full range i.e. A1:C201 or B1:C201 etc."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1458835175, "post_id": 36190688, "comment_id": 60042465, "body": "see section &quot;edit for @Jeeped :&quot; in my original post...in simpler terms, i cannot send a range parameter to a User Defined function called from a worksheet cell, and finally get the visible range from that function. Pls note, the function will work, if i dont send any parameters in it, but it defeats my original purpose."}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1458778050, "post_id": 36190875, "comment_id": 60016880, "body": "cool. the 1st one works fine but the 2nd one only gives me the B column and not B and C.   also my question is, i am calling the tagcloud function passing a listobject range called RngWrdLst to it. RngWrdLst consists of the B &amp; C columns of the list. how do i find out the visible cells of this range in code?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1458778883, "post_id": 36190875, "comment_id": 60017075, "body": "1) Sorry &#39;bout the second. I mistyped the column offset as a 0, not a 1. Amended above. 2) If you pass acrtoss <code>rng</code> that is all you have to do. It may have more than one area (see link above) but it has all of the cells."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1458779588, "post_id": 36190875, "comment_id": 60017241, "body": "the above still gives me only C column and not B &amp; C. Also, my main query to implement your code will be if i have a function called from a cell being passed the B,C columns of the ListObject, then how do i find that range&#39;s visible cells?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1458780444, "post_id": 36190875, "comment_id": 60017463, "body": "a) Wow... I&#39;m really not thinking today. When the range is offset, it is not longer necessary to intersect it. b) The code I write will return a range if written as a function."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1458780001, "last_edit_date": 1458780001, "creation_date": 1458776920, "answer_id": 36190875, "question_id": 36190688, "link": "https://stackoverflow.com/questions/36190688/selecting-specialcellsxlcelltypevisible-from-specific-columns-of-listobject-ta/36190875#36190875", "title": "selecting SpecialCells(xlCellTypeVisible) from specific columns of ListObject table", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195772(v=office.11).aspx\" rel=\"nofollow\">Intersect method</a> on a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834621.aspx\" rel=\"nofollow\">Union method</a> of the columns you want.</p>\n\n<pre><code>Dim rng As Range\nWith ActiveSheet.ListObjects(\"Tab_data\").DataBodyRange\n    Set rng = Intersect(.SpecialCells(xlCellTypeVisible), _\n                        Union(.Columns(2), .Columns(3)))\n    Debug.Print rng.Address(0, 0)\nEnd With\n</code></pre>\n\n<p>Alternately, shift right off the first column and resize one column less than the <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.listobject.databodyrange.aspx\" rel=\"nofollow\">.DataBodyRange property</a> contains.</p>\n\n<pre><code>Dim rng As Range\nWith ActiveSheet.ListObjects(\"Tab_data\").DataBodyRange\n    With .Resize(.Rows.Count, .Columns.Count - 1).Offset(0, 1)\n        Set rng = .SpecialCells(xlCellTypeVisible)\n    End With\n    Debug.Print rng.Address(0, 0)\nEnd With\n</code></pre>\n\n<p>Depending upon what you wnt to do with <code>rng</code>, you may have to loop through the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196243.aspx\" rel=\"nofollow\">Range.Areas property</a>.</p>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2443, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1458780717, "creation_date": 1458775927, "last_edit_date": 1531161705, "question_id": 36190688, "link": "https://stackoverflow.com/questions/36190688/selecting-specialcellsxlcelltypevisible-from-specific-columns-of-listobject-ta", "title": "selecting SpecialCells(xlCellTypeVisible) from specific columns of ListObject table", "body": "<p>I am trying to get only the visible cells of certain columns of a ListObject table into a range object.</p>\n\n<p>This doesn't seem to work.</p>\n\n<pre><code>dim rng as range\nwith activesheet.listobjects(\"Tab_data\").databodyrange\n    set rng=.specialcells(xlcelltypevisible)\nend with\n</code></pre>\n\n<p>but this works when i select entire range then offset 1st column to select the other 2 required columns!</p>\n\n<pre><code>dim rng as range\nwith activesheet.usedrange\n    Set rng = .Offset(1, 1).Resize(.Rows.Count-1, .Columns.Count-1).SpecialCells(xlCellTypeVisible)\nend with\n</code></pre>\n\n<p>but i cannot use the above in a formula as my formula is referring to only the 2 columns in the listobject shown below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xG639.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xG639.png\" alt=\"enter image description here\"></a></p>\n\n<p>UDF Formula on worksheet:</p>\n\n<pre><code>=TagCloud(RngWrdLst as Range)\n</code></pre>\n\n<p>and i am using it as:</p>\n\n<pre><code>=TagCloud(tab_data[[Brands]:[Index]])\n</code></pre>\n\n<p>As you can see from the image, i only want the visible cell ranges from columns \"Brands\" &amp; \"Index\" and not the cells from \"COLUMN\" column.</p>\n\n<p>so the visible ranges i would like to have are:</p>\n\n<pre><code>\"$B$2:$C$3,$B$45:$C$45,$B$75:$C$78\"\n</code></pre>\n\n<h2>edit for @Jeeped :</h2>\n\n<p>If i have a UDF function being called from a worksheet cell and passed a ListObject range of columns B &amp; C (only these columns and not entire databodyrange), then how am i going to find the RngWrdLst visible range?</p>\n\n<p>e.g. </p>\n\n<p>call from worksheet:</p>\n\n<pre><code>=TagCloud(tab_data[[Brands]:[Index]])\n</code></pre>\n\n<p>Function definition:</p>\n\n<pre><code>Function TagCloud(RngWrdLst As Range)\nDim VisibleRng As Range\n\nWith RngWrdLst\n    Set VisibleRng = Intersect(.SpecialCells(xlCellTypeVisible), Union(.Columns(2), .Columns(3)))\n    Debug.Print VisibleRng.Address(0, 0)\nEnd With\n\n'   do something with the visibleRng......\nEnd Function\n</code></pre>\n\n<p>BTW, RngWrdLst would contain the 2 columns B &amp; C. So how do i modify your code and get only the visible range from the function?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1458783533, "post_id": 36190436, "comment_id": 60018360, "body": "You are not concatenating the VBA variables in the string. Hence, the report is looking for the <code>myStartDate</code> and <code>myEndDate</code> within its scope and not passed from VBA."}], "answers": [{"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 0, "last_activity_date": 1458775741, "last_edit_date": 1458775741, "creation_date": 1458775066, "answer_id": 36190513, "question_id": 36190436, "link": "https://stackoverflow.com/questions/36190436/vba-not-recognizing-value-of-unbound-textbox-for-query/36190513#36190513", "title": "VBA not recognizing Value of Unbound Textbox for Query", "body": "<p>You need to escape the string to use these variables.</p>\n\n<p>What you want is:</p>\n\n<pre><code>whereString = \"LabDate Between #\" &amp; myStartDate &amp; \"# AND #\" &amp; myEndDate &amp; \"#\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "edited": false, "score": 0, "creation_date": 1458837083, "post_id": 36196513, "comment_id": 60043788, "body": "Thanks Gustav, @OpiesDad got the answer just a bit before you, but I appreciate your contribution."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "edited": false, "score": 0, "creation_date": 1458837385, "post_id": 36196513, "comment_id": 60043989, "body": "Well, it not that simple. If you don&#39;t format as shown, the query will fail in a non-US environment. That may not present an issue for you, but there is a world out here."}, {"owner": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "edited": false, "score": 0, "creation_date": 1458849476, "post_id": 36196513, "comment_id": 60051341, "body": "True, but I had put a date mask on the textboxes that supply the dates. Thanks for your help."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "edited": false, "score": 0, "creation_date": 1458855648, "post_id": 36196513, "comment_id": 60054177, "body": "If you mean an InputMask, that makes no difference, neither does the format of the textbox. It&#39;s the doubled conversion in your original code with uncontrolled casting to text when concatenating the SQL code you have to modify as shown."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1458810545, "creation_date": 1458810545, "answer_id": 36196513, "question_id": 36190436, "link": "https://stackoverflow.com/questions/36190436/vba-not-recognizing-value-of-unbound-textbox-for-query/36196513#36196513", "title": "VBA not recognizing Value of Unbound Textbox for Query", "body": "<p>If you (and I guess so) have applied a <em>date</em> format to the two textboxes, you don't need most of the converting, but you must pass formatted string expression for the date values to the SQL code:</p>\n\n<pre><code>Private Sub PrintReport_Click()\n\n    Dim myForm As Form\n    Dim myTextBox As TextBox\n    Dim myStartDate As String\n    Dim myEndDate As String\n    Dim whereString As String\n\n    myStartDate = Format(Forms![Data Entry - Ammonia and Alkalinity]![StartDate], \"yyyy\\/mm\\/dd\")\n    myEndDate = Format(Forms![Data Entry - Ammonia and Alkalinity]![EndDate], \"yyyy\\/mm\\/dd\")\n\n    whereString = \"LabDate Between #\" &amp; myStartDate &amp; \"# And #\" &amp; myEndDate &amp; \"#\"\n    DoCmd.OpenReport \"Ammonia and Alkalinity Report\", acViewPreview, , whereString\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6112511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f0a7b9e307815ee96ca96bf12d065ad?s=128&d=identicon&r=PG&f=1", "display_name": "aymhenry", "link": "https://stackoverflow.com/users/6112511/aymhenry"}, "edited": false, "score": 0, "creation_date": 1573001974, "post_id": 36214134, "comment_id": 103735858, "body": "In where string VBA requests to use mm/dd/yyyy date format, which is not (most of times), the same user date format."}], "tags": [], "owner": {"reputation": 31, "user_id": 6112511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f0a7b9e307815ee96ca96bf12d065ad?s=128&d=identicon&r=PG&f=1", "display_name": "aymhenry", "link": "https://stackoverflow.com/users/6112511/aymhenry"}, "is_accepted": false, "score": -1, "last_activity_date": 1458891323, "last_edit_date": 1458891323, "creation_date": 1458880962, "answer_id": 36214134, "question_id": 36190436, "link": "https://stackoverflow.com/questions/36190436/vba-not-recognizing-value-of-unbound-textbox-for-query/36214134#36214134", "title": "VBA not recognizing Value of Unbound Textbox for Query", "body": "<p>Fix whereString be:-</p>\n\n<pre><code>whereString = \"LabDate Between \" &amp; _\n\"#\" &amp; Format (myStartDate, \"mm/dd/yyyy\")  &amp; \" #\" &amp; _\n \" And \" &amp; _\n\"#\" &amp; Format (myEndDate, \"mm/dd/yyyy\") &amp; \"#\"\n</code></pre>\n"}], "owner": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 36190513, "answer_count": 3, "score": 0, "last_activity_date": 1458891323, "creation_date": 1458774600, "question_id": 36190436, "link": "https://stackoverflow.com/questions/36190436/vba-not-recognizing-value-of-unbound-textbox-for-query", "title": "VBA not recognizing Value of Unbound Textbox for Query", "body": "<p>I have a two unbound textboxes in a Form where the user sets the start and end dates for query.  The user than hits a button to generate report.</p>\n\n<p>Everything works except Access pops up a Dialog Box asking for the start and stop dates even though the variables myStartDate and myEndDate have proper values.</p>\n\n<p>I suspect I am missing something simple here.</p>\n\n<pre><code>Private Sub PrintReport_Click()\n    Dim myForm As Form\n    Dim myTextBox As TextBox\n    Dim myStartDate As Date, myEndDate As Date\n\n    myStartDate = CDate(Forms![Data Entry - Ammonia and Alkalinity]![StartDate])\n   myEndDate = CDate(Forms![Data Entry - Ammonia and Alkalinity]![EndDate])\n\n   Dim whereString As String\n   whereString = \"LabDate Between myStartDate And myEndDate\"\n   DoCmd.OpenReport \"Ammonia and Alkalinity Report\", acViewPreview, , whereString\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "merge", "vba"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1458775264, "creation_date": 1458775264, "answer_id": 36190548, "question_id": 36190344, "link": "https://stackoverflow.com/questions/36190344/excel-vba-merge-two-columns/36190548#36190548", "title": "Excel VBA merge two columns", "body": "<p>Cells has two arguments. The first is the row, the second is the column. If you want to combine the text from columns K and L, then use the appropriate numbers.</p>\n\n<p><code>cells(2,11)</code> will address cell K2.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mUJU8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mUJU8.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6106911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd603c1e09f2288cfd9492a83bbc82c7?s=128&d=identicon&r=PG&f=1", "display_name": "marcizoub", "link": "https://stackoverflow.com/users/6106911/marcizoub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 541, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458775264, "creation_date": 1458774081, "last_edit_date": 1531161705, "question_id": 36190344, "link": "https://stackoverflow.com/questions/36190344/excel-vba-merge-two-columns", "title": "Excel VBA merge two columns", "body": "<p>So basically, I figured out the code to merge column A and B. This might seem silly, but no matter how many times I change the X value or the cell numbers I can't figure out for the life of me how to merge columns K and L.</p>\n\n<p>here's what I did to merge A&amp;B. Basically I want to merge first and last name but they're located in columns K and L. Feel free to tell me if there's an easier way to merge columns using VBA. I'm new to this..</p>\n\n<pre><code>Sub MergeColumns()\nDim myText As String, mySpace As String\nmySpace = \" \"\n\nCells(1, 1) = \"AuthorText\"\nCells(1, 2) = \"\"\n\nx = 2\nDo While Cells(x, 1) &lt;&gt; \"\"\nCells(x, 1) = Cells(x, 1) &amp; mySpace &amp; Cells(x, 2)\nCells(x, 2) = \"\"\nx = x + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "hide", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1458781270, "creation_date": 1458781270, "answer_id": 36191482, "question_id": 36190183, "link": "https://stackoverflow.com/questions/36190183/hiding-cells-by-using-vba/36191482#36191482", "title": "Hiding cells by using VBA", "body": "<p>You've got to re-evaluate subsequent calls with new values in Range(\"$F$26\") from scratch; e.g. make everything visible and then decide what gets hidden.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Application.Intersect(Range(\"F26\"), Range(Target.Address)) Is Nothing Then\n        Application.ScreenUpdating = False\n        Rows(\"39:61\").EntireRow.Hidden = False\n        Select Case Range(\"F26\").Value\n            Case Is &lt; 2\n                Rows(\"39:61\").EntireRow.Hidden = True\n            Case 2\n                Rows(\"47:61\").EntireRow.Hidden = True\n            Case 3\n                Rows(\"55:61\").EntireRow.Hidden = True\n        End Select\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>I've changed your condition evaluation to a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278665.aspx\" rel=\"nofollow\">Select Case statement</a> and removed the <code>Cell</code> variable as unnnecessary.</p>\n\n<p>I could not find any contingency for when Range(\"F26\") was blank. Currently, that falls under the <code>&lt; 2</code> condition.</p>\n"}], "owner": {"reputation": 2593, "user_id": 2530371, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08d3901932d5e8c58ee1c40f7ed833c1?s=128&d=identicon&r=PG", "display_name": "S Das", "link": "https://stackoverflow.com/users/2530371/s-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1171, "favorite_count": 0, "accepted_answer_id": 36191482, "answer_count": 1, "score": 1, "last_activity_date": 1458781270, "creation_date": 1458773285, "last_edit_date": 1531161705, "question_id": 36190183, "link": "https://stackoverflow.com/questions/36190183/hiding-cells-by-using-vba", "title": "Hiding cells by using VBA", "body": "<p>I am using the following code to hide the required cells in Excel VBA.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim Cell   As Range\n    Set Cell = Range(\"$F$26\")\n    If Not Application.Intersect(Cell, Range(Target.Address)) Is Nothing Then\n        If Range(\"F26\").Value &lt; 2 Then\n            Rows(\"39:61\").EntireRow.Hidden = True\n            ElseIf Range(\"F26\").Value &lt; 3 Then\n            Rows(\"47:61\").EntireRow.Hidden = True\n            ElseIf Range(\"F26\").Value &lt; 4 Then\n            Rows(\"55:61\").EntireRow.Hidden = True\n            Else: Rows(\"39:61\").EntireRow.Hidden = False\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>It works perfectly when I put values in the descending order (like 4, 3, 2, 1). But after putting 1, if I am plan to switch to 2 or 3 (but not 4). Then it doesn't show the cells in second and third panel group. But if I put 4, then it again shows all panel groups. I attached the screenshots below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mHSbZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mHSbZ.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/NuHGt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NuHGt.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/iH4lw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iH4lw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "macros", "usb"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1458776195, "post_id": 36190101, "comment_id": 60016342, "body": "Please provide all the code and a reproducible test case so that someone can help you debugging."}, {"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1458776424, "post_id": 36190101, "comment_id": 60016411, "body": "@MatteoNNZ : it&#39;s done, hope that helps. Thanks"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1458776902, "post_id": 36190101, "comment_id": 60016565, "body": "Doubt this is a threading issue (VBA isn&#39;t multi-threaded). I suspect it has more to do with the fact that you&#39;re performing file operations during your traversal of the directory. Try commenting out the line <code>CheckFile (file)</code> and replacing it with <code>Debug.Print file.Path</code> to see if it still repeats file paths when you aren&#39;t mucking around with the files."}, {"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1458777762, "post_id": 36190101, "comment_id": 60016795, "body": "@Comintern : yes after commenting that function , it prints the main files only without repeating. then how that can be solved"}], "answers": [{"comments": [{"owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "edited": false, "score": 0, "creation_date": 1458780335, "post_id": 36191129, "comment_id": 60017427, "body": "Thanks it works as expected, and yes it was working on non-usb drive and I checked the file path string."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1458779228, "last_edit_date": 1458779228, "creation_date": 1458778708, "answer_id": 36191129, "question_id": 36190101, "link": "https://stackoverflow.com/questions/36190101/excel-macro-runs-from-usb-keeps-looping/36191129#36191129", "title": "Excel macro runs from usb keeps looping", "body": "<p>Based on the comments, it appears that the USB interface is interfering with the FSO's enumeration of files if the files are being accessed while it is completing the directory traversal.  One solution would be to cache the file paths in one pass, then perform operations on them in a second pass:</p>\n\n<pre><code>Private found As Collection 'Module scope.\n\nSub ScrapData(control As IRibbonControl)\n\n    strFileFullName = ActiveWorkbook.FullName\n    strFileFileName = ActiveWorkbook.Name\n\n    'clear results sheet\n    Sheets(\"Results\").Activate\n    Size = WorksheetFunction.CountA(Worksheets(\"Results\").Columns(12))\n    Dim defRange As String\n    defRange = \"A\" &amp; 2 &amp; \":L\" &amp; CStr(Size + 1)\n    Worksheets(\"Results\").Range(defRange).Clear\n    currentIndex = 2\n\n    'browse for file\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .AllowMultiSelect = False\n        If .Show = -1 Then\n            FolderName = .SelectedItems(1)\n        End If\n    End With\n\n    If (FolderName &lt;&gt; \"\") Then\n        Dim FileSystem As Object\n        Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n        Set found = New Collection\n        'Data gathering pass...\n        DoFolder FileSystem.GetFolder(FolderName)\n\n        Dim path As Variant\n        'Processing pass gathering pass...\n        For Each path In found\n            CheckFile path\n        Next path\n    End If\nEnd Sub\n\nSub DoFolder(Folder)\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n    Next\n    Dim file\n    For Each file In Folder.Files\n        found.Add file\n    Next\nEnd Sub\n</code></pre>\n\n<p>EDIT: The more I think about this, I'm surprised that it works on a <em>non-USB</em> drive - when you open an Excel document it creates a hidden lock file in the directory (~$filename.xlsm) that should be invalidating the FSO's directory cache.</p>\n"}], "owner": {"reputation": 330, "user_id": 690069, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PjpLU.jpg?s=128&g=1", "display_name": "user690069", "link": "https://stackoverflow.com/users/690069/user690069"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 36191129, "answer_count": 1, "score": 0, "last_activity_date": 1458779228, "creation_date": 1458772938, "last_edit_date": 1458777868, "question_id": 36190101, "link": "https://stackoverflow.com/questions/36190101/excel-macro-runs-from-usb-keeps-looping", "title": "Excel macro runs from usb keeps looping", "body": "<p>I've an excel file that has a  macro which opens another sheets and scrap some cells data , it happens by browsing through a folder then looking through subfolder\nthis is the whole macro</p>\n\n<pre><code>Public strFileFullName As String\nPublic currentIndex As Integer\nPublic strFileFileName As String\n\n\n'Callback for customButton onAction\nSub ScrapData(control As IRibbonControl)\n\n strFileFullName = ActiveWorkbook.FullName\nstrFileFileName = ActiveWorkbook.Name\n\n'clear results sheet\nSheets(\"Results\").Activate\nSize = WorksheetFunction.CountA(Worksheets(\"Results\").Columns(12))\nDim defRange As String\ndefRange = \"A\" &amp; 2 &amp; \":L\" &amp; CStr(Size + 1)\nWorksheets(\"Results\").Range(defRange).Clear\ncurrentIndex = 2\n\n'browse for file\n  With Application.FileDialog(msoFileDialogFolderPicker)\n        .AllowMultiSelect = False\n        If .Show = -1 Then\n\n            FolderName = .SelectedItems(1)\n        End If\n    End With\n\n    If (FolderName &lt;&gt; \"\") Then\n    Dim FileSystem As Object\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n    DoFolder FileSystem.GetFolder(FolderName)\n    End If\nEnd Sub\n\nSub CheckFile(file As String)\n      If (InStr(file, \".xlsm\") &gt; 0) And (file &lt;&gt; strFileFullName) Then\n         Call copyCell(file)\n         Exit Sub\n      End If\nEnd Sub\n\nSub copyCell(FileName As String)\n\nOn Error GoTo ErrorHandler1\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nWorkbooks.Open FileName:=FileName\nIf (SheetExists(\"Home\", ActiveWorkbook) And SheetExists(\"Front Section\", ActiveWorkbook)) Then\n    'start copying from Home Sheet\n    Sheets(\"Home\").Activate\n    AccessorName = Cells(26, \"H\").Value\n    LearnerName = Cells(21, \"H\").Value\n    Framework = Cells(6, \"F\").Value\n\n   'Start copying from front section sheet\n    Sheets(\"Front Section\").Activate\n    StartDate = Cells(5, \"G\").Value\n    EndDate = Cells(6, \"G\").Value\n    Overall = Cells(7, \"G\").Text\n    DaysLeft = Cells(8, \"P\").Value\n    Status = Cells(9, \"P\").Value\n    NVQ = Cells(4, \"P\").Text\n    TC = Cells(5, \"P\").Text\n    ErrCel = Cells(6, \"P\").Text\n    FS = Cells(7, \"P\").Text\n\n   Else\n    GoTo ErrorHandler1\n  End If\n\n  'close opened sheet\n    ActiveWorkbook.Close\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n\n    'start pasting into out sheet\n    Sheets(\"Results\").Activate\n    Size = WorksheetFunction.CountA(Worksheets(\"Results\").Columns(12))\n    currentIndex = Size + 1\n    Cells(currentIndex, 1).Value = AccessorName\n    Cells(currentIndex, 2).Value = LearnerName\n    Cells(currentIndex, 3).Value = Framework\n\n    Cells(currentIndex, 4).Value = StartDate\n    Cells(currentIndex, 5).Value = EndDate\n    Cells(currentIndex, 6).Value = Overall\n    Cells(currentIndex, 7).Value = DaysLeft\n    Cells(currentIndex, 8).Value = Status\n    Cells(currentIndex, 9).Value = NVQ\n    Cells(currentIndex, 10).Value = TC\n    Cells(currentIndex, 11).Value = ErrCel\n    Cells(currentIndex, 12).Value = FS\n    Exit Sub\n\nErrorHandler1:\nIf ((ActiveWorkbook.FullName &lt;&gt; strFileFullName) Or (ActiveWorkbook.Name) &lt;&gt; strFileFileName) Then\n    ActiveWorkbook.Close\n    End If\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Exit Sub\n\nExit Sub\n\nEnd Sub\n\n\n\nSub DoFolder(Folder)\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n\n    Next\n\n    Dim file\n    For Each file In Folder.Files\n        CheckFile (file)\n    Next\nEnd Sub\n\nFunction SheetExists(shtName As String, Optional wb As Workbook) As Boolean\n    Dim sht As Worksheet\n\n     If wb Is Nothing Then Set wb = ThisWorkbook\n     On Error Resume Next\n     Set sht = wb.Sheets(shtName)\n     On Error GoTo 0\n     SheetExists = Not sht Is Nothing\n End Function\n</code></pre>\n\n<p>this macro works fine if that scraper file and scraped files are on desktop or if the scraper file is on usb and scraped files are on desktop</p>\n\n<p>the problem raises when they all exist on usb\nit loops multiple time on the same file and repeats calling <code>CheckFile</code> function\nI think it's a threading problem but I can't solve it .. \nif you can help me , it'd be great</p>\n\n<blockquote>\n  <p>Edit</p>\n</blockquote>\n\n<p>I forgot to say that the output (the total rows) every run differs from the previous one (the output should be the same as long as the scraped files are the same)</p>\n"}, {"tags": ["vba", "build", "visual-studio-2015", "resources"], "comments": [{"owner": {"reputation": 17564, "user_id": 2780791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1feea731a99cb95e342d196802bb868a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexei - check Codidact", "link": "https://stackoverflow.com/users/2780791/alexei-check-codidact"}, "edited": false, "score": 0, "creation_date": 1458767974, "post_id": 36188812, "comment_id": 60013047, "body": "Can you increase <a href=\"http://sedodream.com/2008/06/16/ChangingBuildVerbosityInVisualStudio.aspx\" rel=\"nofollow noreferrer\">build verbosity</a>? There is a chance that you receive useful information about failure."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1458771621, "post_id": 36188812, "comment_id": 60014670, "body": "VBA is <i>NOT</i> VB.NET. Please tag your questions correctly, not only for those of us who don&#39;t want to see your question, but for yourself, so that the right people who perhaps can answer see your question!"}], "owner": {"reputation": 11, "user_id": 6106208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70f1e41950f6de8128e85a60fc915b5e?s=128&d=identicon&r=PG&f=1", "display_name": "dries123", "link": "https://stackoverflow.com/users/6106208/dries123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458998201, "creation_date": 1458767698, "last_edit_date": 1458998201, "question_id": 36188812, "link": "https://stackoverflow.com/questions/36188812/taks-generateresource-failed-if-amount-of-png-images-increases-in-resources", "title": "Taks &quot;GenerateResource&quot; -- FAILED if amount of png images increases in Resources Visual studio, visual basic no error", "body": "<p>If the amount of added existing png images 30 MB  in the Rescource folder of a Microsoft Visual Studio 2015 project, than the build fails on my computer. The following steps are taken to include an existing image:\nProject -> <em>Project_name</em> Properties -> Resources -> Add Existing File -> ....png. </p>\n\n<p>No errors or warnings are shown, the output is as followed:\nProcessing resource file \"My Project\\Resources.resx\" into \"obj\\Debug\\Tweede_poging.Resources.resources\". (TaskId:17)\n1>Done executing task \"GenerateResource\" -- FAILED. (TaskId:17)</p>\n\n<p>I've tried the following steps:\n- Clean solution\n- deleted bin folder, obj folder, Resources.rsx and .suo files\n- increased the memory by using editbin and /LARGEADDRESSAWARE, before the implementation the maximum memory used for MSBuild.exe was +- 2.000.0000 kB afterwords it was +- 2.300.000 Kb</p>\n\n<p>The computer which i'm using has the following properties:\nWindows 7 Professional, 3 GB RAM\nMicrosoft Visual Studio 2015 Version (Verison 14.0.24720.00 Update 1) \nThe code is Visual basic, 1 solution and 1 project is created. </p>\n\n<p>There are no errors in the code. The only thing which causes the build to fail is the amount of png images. Does anyone has a suggestions to solve this problem? Is there a possibilty to link the png files instead of adding them into the project?</p>\n\n<p>With kind regards</p>\n"}, {"tags": ["vba", "text", "encoding"], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 6053799, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a7caccb567e3664244bcd555c895904c?s=128&d=identicon&r=PG&f=1", "display_name": "Ali_R4v3n", "link": "https://stackoverflow.com/users/6053799/ali-r4v3n"}, "edited": false, "score": 0, "creation_date": 1458770831, "post_id": 36189557, "comment_id": 60014324, "body": "thanks, and Damn...this stuff requires a lot of work. here is another stack page that talks about it but for c# (<a href=\"http://stackoverflow.com/questions/90838/how-can-i-detect-the-encoding-codepage-of-a-text-file?rq=1\" title=\"how can i detect the encoding codepage of a text file\">stackoverflow.com/questions/90838/&hellip;</a>)"}], "tags": [], "owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "is_accepted": true, "score": 2, "last_activity_date": 1458853714, "last_edit_date": 1458853714, "creation_date": 1458770564, "answer_id": 36189557, "question_id": 36188224, "link": "https://stackoverflow.com/questions/36188224/vba-test-encoding-of-a-text-file/36189557#36189557", "title": "VBA Test Encoding of a text file", "body": "<p>The following was VBScript code. I made minimal changes so it will run in Excel 2010 as VBA code. You'll need to add a Reference to Microsft Scripting Runtime.  You might want to bulk it up with proper type specifications, error-handling etc. It fails if the text file has less than 2 characters in it; you might want to handle that. The main problem with this encoding issue is that there is no encoding attribute in files. What we're doing here is using Byte-Order-Mark to identify encoding. A true test for encoding that doesn't depend on BOM will require for the file to be large and for us to do statistical analysis of contents to determine UTF-32/UTF-16/UTF-8/ANSI/ASCII/EBCDIC</p>\n\n<pre><code>    Public Function IsUnicodeFile(FilePath)\n        Dim objFSO\n        Dim objStream\n\n        Dim intAsc1Chr\n        Dim intAsc2Chr\n\n\n        Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n        If (objFSO.FileExists(FilePath) = False) Then\n            IsUnicodeFile = False\n            Exit Function\n        End If\n\n        ' 1=Read-only, False==do not create if not exist, -1=Unicode 0=ASCII\n        Set objStream = objFSO.OpenTextFile(FilePath, 1, False, 0)\n        intAsc1Chr = Asc(objStream.Read(1))\n        intAsc2Chr = Asc(objStream.Read(1))\n        objStream.Close\n\n        If (intAsc1Chr = 255) And (intAsc2Chr = 254) Then\n            IsUnicodeFile = True\n        Else\n            IsUnicodeFile = False\n        End If\n\n        Set objStream = Nothing\n        Set objFSO = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 6053799, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a7caccb567e3664244bcd555c895904c?s=128&d=identicon&r=PG&f=1", "display_name": "Ali_R4v3n", "link": "https://stackoverflow.com/users/6053799/ali-r4v3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3215, "favorite_count": 1, "accepted_answer_id": 36189557, "answer_count": 1, "score": 1, "last_activity_date": 1458853714, "creation_date": 1458765398, "question_id": 36188224, "link": "https://stackoverflow.com/questions/36188224/vba-test-encoding-of-a-text-file", "title": "VBA Test Encoding of a text file", "body": "<p>here is a question for you, say I have a procedure that <strong>reads a text file</strong> then it does some processing to it, in order to read that text file I'm gonna use the <strong>File System Object</strong> method. and the syntax for it is this <code>object.OpenTextFile(filename[, iomode[, create[, format]]])</code>, now, the optional parameter <code>format</code>is used to read the text file in three Encoding options:</p>\n\n<ul>\n<li>system default </li>\n<li>ASCII </li>\n<li>UNICODE</li>\n</ul>\n\n<hr>\n\n<p><strong><em>my question:</em></strong></p>\n\n<p><strong>How Do i test the file Encoding beforehand, So that i can choose the right <code>Format</code>?</strong></p>\n\n<p>here is a sample code that I'm using as part of a project, in this function the user passes a file type of either (txt, docx, doc, rtf) if the type is (rtf, doc, docx) the actual file object (document) will be returned and if the file is a text file, it will be read line by line into a new document and return that new document :</p>\n\n<pre><code>Sub test()\n    ReadTxtOrDocIntoDocument_1 (\"C:\\Test.txt\")\nEnd Sub\n\nFunction ReadTxtOrDocIntoDocument_1(ByVal DocPath As String) As Document\n'in this func we only create a new doc for the text file\n'because the opening of a text file in word is messy\n'if the file is supported then just open it for further processing\n'======================================================\n    If Not DocPath = \"\" Then    'check if the path is not empty\n        'make sure one temp doc exists throughout the processing time\n        Dim fileExt As String    'stores the file extension of the list file\n        fileExt = Right(DocPath, Len(DocPath) - InStrRev(DocPath, \".\"))\n        '======================================================\n        'let's check if the file is text or doc\n        Select Case LCase(fileExt)\n        Case \"docx\"\n            Set ReadTxtOrDocIntoDocument_1 = Documents.Open(DocPath)\n        Case \"doc\"\n            Set ReadTxtOrDocIntoDocument_1 = Documents.Open(DocPath)\n        Case \"rtf\"\n            Set ReadTxtOrDocIntoDocument_1 = Documents.Open(DocPath)\n        Case \"txt\"\n            'a doc that recieves the list words for comparison\n            Set ReadTxtOrDocIntoDocument_1 = Documents.Add\n            '======================================================\n            Dim FSO As Object\n            Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n            '======================================================\n            Const ForReading = 1\n            Const OpenAsUNICODE = -1\n            Const OpenAsSystemDefault = -2\n            '======================================================\n            Dim TxtFile As Object\n            Set TxtFile = FSO.OpenTextFile(DocPath, ForReading, , OpenAsSystemDefault)\n            Dim ThisLine As String\n            Dim i As Integer\n            i = 0\n            '======================================================\n            Do Until (TxtFile.AtEndOfStream)    'keep looping until end of file\n                ThisLine = TxtFile.ReadLine\n                'go to doc starting point\n                ReadTxtOrDocIntoDocument_1.Range.MoveStart unit:=wdStory, Count:=1\n                'insert text after the begining\n                ReadTxtOrDocIntoDocument_1.Range.InsertAfter ThisLine\n                'go to end of the doc\n                ReadTxtOrDocIntoDocument_1.Range.MoveEnd unit:=wdStory, Count:=1\n                'insert a new line (paragraph)\n                ReadTxtOrDocIntoDocument_1.Range.Paragraphs.Add\n                'increase counter to read next txt line\n                i = i + 1\n            Loop\n            '======================================================\n            TxtFile.Close\n\n            Set FSO = Nothing\n            Set TxtFile = Nothing\n        End Select\n\n    Else\n\n        MsgBox \"no file path was provided\"\n        Exit Function\n        'close the tempDoc after processing\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba", "itextsharp"], "answers": [{"comments": [{"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1458767171, "post_id": 36188537, "comment_id": 60012633, "body": "Users are in another location. I had IT in that location run a regasm, he said he had loaded the DLL&#39;s in both 32 and 64 bit folders. Would I need iTextSharp with the DLL I developed for it to work? I didn&#39;t think that was needed."}, {"owner": {"reputation": 1761, "user_id": 3440152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc7af4998986ac6d0df749496b4b0d0f?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph", "link": "https://stackoverflow.com/users/3440152/christoph"}, "reply_to_user": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1458767272, "post_id": 36188537, "comment_id": 60012699, "body": "Sorry, I didn&#39;t mean to answer, this was only supposed to be a comment."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1458767875, "post_id": 36188537, "comment_id": 60013001, "body": "Not a problem. But yes, I have the DLL in both 32 and 64 bit, I think he registered it in both as well"}], "tags": [], "owner": {"reputation": 1761, "user_id": 3440152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc7af4998986ac6d0df749496b4b0d0f?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph", "link": "https://stackoverflow.com/users/3440152/christoph"}, "is_accepted": false, "score": 0, "last_activity_date": 1458767371, "last_edit_date": 1458767371, "creation_date": 1458766600, "answer_id": 36188537, "question_id": 36187981, "link": "https://stackoverflow.com/questions/36187981/could-not-load-file-or-assembly-itextsharp-dll-excel-vba/36188537#36188537", "title": "Could Not Load File or Assembly iTextSharp.dll Excel VBA", "body": "<p>You will need to ship iTextSharps with your wrapper DLL. DLL means dynamic link library so when you reference a DLL from a wrapper DLL, it does just that, reference it, not include it. In C++ you can do static linking, which means that the statically linked library is fully contained in the linking binary.</p>\n\n<p>Also, I believe that you need to use regsvr32 to register it for COM InterOp, and not regasm (that's the global assembly cache for use by managed DLLs and EXEs).</p>\n"}], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 880, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458767371, "creation_date": 1458764494, "question_id": 36187981, "link": "https://stackoverflow.com/questions/36187981/could-not-load-file-or-assembly-itextsharp-dll-excel-vba", "title": "Could Not Load File or Assembly iTextSharp.dll Excel VBA", "body": "<p>I have developed a C# DLL that acts as a series of wrapper classes for certain methods of iTextSharps that is used by Excel VBA. On my dev machine and test machine it works, but when I tried to deploy it on user machines, after running regasm.exe for the C# DLL and tlb, I get the message \"Could not load file or assembly iTextSharp.dll\"</p>\n\n<p>I have loaded my dll and tlb's onto the user machines and registered them using regasm.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1, "user_id": 6011329, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HnGOHfk_qww/AAAAAAAAAAI/AAAAAAAAAAA/KaG5Mx9Wq60/photo.jpg?sz=128", "display_name": "Lectric", "link": "https://stackoverflow.com/users/6011329/lectric"}, "edited": false, "score": 0, "creation_date": 1459326571, "post_id": 36187739, "comment_id": 60230830, "body": "Thanks for the reply but not quite what I was after. Let me try to explain it a little better. The combo box offers 24 choices from table 1, depending on the choice made the text box needs to show 1 of 2 options from table 2."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6106367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5bf6e7caa5fa28dae077eb2c94d95cf?s=128&d=identicon&r=PG&f=1", "display_name": "ponci", "link": "https://stackoverflow.com/users/6106367/ponci"}, "is_accepted": false, "score": 0, "last_activity_date": 1458803310, "last_edit_date": 1458803310, "creation_date": 1458765236, "answer_id": 36188181, "question_id": 36187739, "link": "https://stackoverflow.com/questions/36187739/get-value-in-textbox-depending-on-combobox/36188181#36188181", "title": "Get value in textbox depending on combobox", "body": "<pre><code>Me.textbox.Value = Me.combobox.Value\n</code></pre>\n\n<p>will give you the value of the <strong>bounded column</strong> of the selected row, usually the first one (e.g. if your combobox shows data like <em>ID;LastName;PreName</em>, it shows the ID)</p>\n\n<p>If you want to show other colums than the bounded one, use</p>\n\n<pre><code>Me.textbox.Value = Me.combobox.Column(n)\n</code></pre>\n\n<p>(n stands for the column, beginning at 0 for the first, 1 for the second, ...)</p>\n\n<p>So if you want to show the <em>LastName</em> of the previous example, go with</p>\n\n<pre><code>Me.textbox.Value = Me.combobox.Column(1)\n</code></pre>\n\n<p>If you just want to show the string when it doesn't fit in the combobox column, I'd make it like</p>\n\n<pre><code>If Len(Nz(Me.combobox.Column(1))) &gt; n Then\n    Me.textbox.Value = Me.combobox.Column(1)\nElse\n    Me.textbox.Value = Null\nEnd If\n</code></pre>\n\n<p>There might be another solution, but this would be an easy one</p>\n"}], "owner": {"reputation": 1, "user_id": 6011329, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HnGOHfk_qww/AAAAAAAAAAI/AAAAAAAAAAA/KaG5Mx9Wq60/photo.jpg?sz=128", "display_name": "Lectric", "link": "https://stackoverflow.com/users/6011329/lectric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458803310, "creation_date": 1458763624, "question_id": 36187739, "link": "https://stackoverflow.com/questions/36187739/get-value-in-textbox-depending-on-combobox", "title": "Get value in textbox depending on combobox", "body": "<p>I have searched high and low for an answer to this. Lots of places come close to what I need but try as I might I can't find exactly what I need. So, here goes. I have a combo box on a user form that reads values from a table. when a user makes a selection, depending on how far down the table the selection falls, I would like a textbox to display one of two strings. I'm currently using a toggle button which seems a bit 'clunky. I'm fairly new to vba so be gentle with me.</p>\n"}, {"tags": ["vba", "com", "scoping"], "comments": [{"owner": {"reputation": 12398, "user_id": 1310566, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5qiMO.jpg?s=128&g=1", "display_name": "Simon Forsberg", "link": "https://stackoverflow.com/users/1310566/simon-forsberg"}, "edited": false, "score": 0, "creation_date": 1458764147, "post_id": 36187652, "comment_id": 60010959, "body": "In Module2, can you define a variable of type <code>Module1.TSomething</code> and assign that to <code>Module1.Something</code> ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 12398, "user_id": 1310566, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5qiMO.jpg?s=128&g=1", "display_name": "Simon Forsberg", "link": "https://stackoverflow.com/users/1310566/simon-forsberg"}, "edited": false, "score": 0, "creation_date": 1458764272, "post_id": 36187652, "comment_id": 60011034, "body": "@SimonForsberg Compile error (as expected) - &quot;User-definted type not defined&quot;... in other words, the type is visible <i>to usages</i>, but not <i>to declarations</i>..."}, {"owner": {"reputation": 12398, "user_id": 1310566, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5qiMO.jpg?s=128&g=1", "display_name": "Simon Forsberg", "link": "https://stackoverflow.com/users/1310566/simon-forsberg"}, "edited": false, "score": 1, "creation_date": 1458764422, "post_id": 36187652, "comment_id": 60011120, "body": "Sounds exaclty how Java works, not that this question is about Java, but anyway. It makes sense to me, but then again... I&#39;m a Java-guy."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 2, "creation_date": 1458764882, "post_id": 36187652, "comment_id": 60011390, "body": "VBA exposes the private type, just like it exposes a private enum. It assumes you can make use of the TypeInfo in the using context, but it won&#39;t allow you to declare instances of  those types or enums."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1458767157, "post_id": 36187652, "comment_id": 60012628, "body": "It just doesn&#39;t make much sense to try to map Visual Basic behavior onto C#.  VB is a &quot;make it work if you can&quot; language, C# is hard-ass."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1458767723, "post_id": 36187652, "comment_id": 60012916, "body": "@HansPassant so, VB (and Java?) basically doesn&#39;t care about the <code>Private</code> access modifier as far as <i>using</i> a type goes - and happily lets you &quot;leak&quot; private types to an interface, even though the client code doesn&#39;t know about the type involved, yet it <i>does</i> know enough to use it, but isn&#39;t allowed to declare variables of that type... but runtime will happily dump it into a <code>Variant</code>... <i>I need a drink</i>."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1458767854, "post_id": 36187652, "comment_id": 60012992, "body": "Well, why not, late binding is a VB feature so it isn&#39;t like client code could not access the members.  That is not different in C# either, you can use Reflection to access private members."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1458773689, "post_id": 36187652, "comment_id": 60015436, "body": "While I can&#39;t speak authoritatively, but I suspect that it has something to do with VBA and COM&#39;s extensive use of <code>IDispatch</code> and <code>IUnknown</code>. It would appear that the compiler is accessing <code>Module1.Something</code> by treating it as an Object instead of a Namespace, then querying the interface to see if it can successfully call <code>Something.Bar</code>. <code>Something</code> is exposed by being <code>Public</code>, so it doesn&#39;t <i>need</i> access to the type - it queries it&#39;s interface to see if it supports the property <code>Bar</code>.  Note that without doing this (kind of like duck typing), late binding would be much more difficult."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1458774390, "post_id": 36187652, "comment_id": 60015710, "body": "Add <code>Debug.Print TypeName(Module1.Something)</code> provides an additional clue that COM is examining the interfaces - the error it produces is (my emphasis) &quot;Only user-defined types defined in public object modules <i>can be coerced to or from a variant</i> or passed to late-bound functions&quot;.  <code>Debug.Print TypeName(Module1.Something.Bar)</code> happily spits out &quot;Integer&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 3, "last_activity_date": 1458774128, "last_edit_date": 1592644375, "creation_date": 1458774128, "answer_id": 36190352, "question_id": 36187652, "link": "https://stackoverflow.com/questions/36187652/is-scoping-broken-in-vba/36190352#36190352", "title": "Is scoping broken in VBA?", "body": "<p>As per my comment, VBA exposes a private Type, just like it exposes a Private Enum.</p>\n<p>VBA assumes you can make use of the TypeInfo in the consuming context, but it won't allow you to declare or create instances of those types or enums.</p>\n<p>This <a href=\"https://stackoverflow.com/a/13532882/5757159\">C++ answer</a> is partly informative:</p>\n<blockquote>\n<p>Access Control is applied to <strong>names</strong></p>\n<p>The access specifier for the name has nothing to do with it's type</p>\n</blockquote>\n<p>But it's perhaps useful to think of a Private Type in a standard module, as something <em>like</em> a &quot;PublicNotCreatable&quot; class. If you provide a public wrapper, then the type is accessible outside the host module.</p>\n<p>But VBA handles things differently when the Type is in a Public Class Module!</p>\n<p>Here's your <code>Module1</code> expanded:</p>\n<pre><code>Option Explicit\n\nPrivate Type TSomething\n    Foo As Integer\n    Bar As Integer\nEnd Type\n\nPublic Type TOtherThing\n    Foo As Integer\n    Bar As Integer\nEnd Type\n\nPublic Type TWrapperThing\n  Something As TSomething\nEnd Type\n\nPublic Something As TSomething\nPublic Otherthing As TOtherThing\nPublic Wrapperthing As TWrapperThing\n\nPublic Function GetSomething() As TSomething\n  GetSomething.Foo = 1\nEnd Function\n\nPublic Function GetOtherthing() As TOtherThing\n  GetOtherthing.Foo = 1\nEnd Function\n</code></pre>\n<p>And <code>Module2</code> expanded:</p>\n<pre><code>Option Explicit\n\nSub DoThings()\n\n'Compile Error: User-defined type not defined\n  'Dim oSomething As TSomething\n  Dim vSomething As Variant\n  \n  Dim oOtherthing As Module1.TOtherThing\n  Dim vOtherthing As Variant\n  Dim oWrapperthing As Module1.TWrapperThing\n  \n  Module1.Something.Foo = 42\n  Module1.Otherthing.Foo = 42\n  Module1.Wrapperthing.Something.Foo = 42\n\n  'Compile Error: Only user-defined types defined in public object modules can be coerced to or from a variant or passed to late-bound functions\n  'vSomething = Module1.Something\n  'vOtherthing = Module1.Otherthing\n  \n  oOtherthing = Module1.Otherthing\n  oOtherthing.Foo = 43\n  \n  'Is 43 &gt; 42?\n  Debug.Assert oOtherthing.Foo &gt; Module1.Otherthing.Foo\n  \n'Compile Errors: &quot;GetSomething&quot; User-defined type not defined\n  'Module1.GetSomething.Foo = 42\n  'Module1.GetSomething().Foo = 42\n  \n  Module1.GetOtherthing.Foo = 42\n  Module1.GetOtherthing().Foo = 42\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 36190352, "answer_count": 1, "score": 11, "last_activity_date": 1458774128, "creation_date": 1458763343, "question_id": 36187652, "link": "https://stackoverflow.com/questions/36187652/is-scoping-broken-in-vba", "title": "Is scoping broken in VBA?", "body": "<p>Say you have this code in a module called <code>Module1</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate Type TSomething\n    Foo As Integer\n    Bar As Integer\nEnd Type\n\nPublic Something As TSomething\n</code></pre>\n\n<p>In equivalent C# code if you made the <code>Something</code> field <code>public</code>, the code would no longer compile, because of <em>inconsistent accessibility</em> - the <em>type</em> of the field being less accessible than the field itself. Which makes sense.</p>\n\n<p>However in VBA you could have this code in <code>Module2</code>:</p>\n\n<pre><code>Sub DoSomething()\n    Module1.Something.Bar = 42\n    Debug.Print Module1.Something.Bar\nEnd Sub\n</code></pre>\n\n<p>And you get IntelliSense while typing it, and it compiles, and it runs, and it outputs <code>42</code>.</p>\n\n<p>Why? How does it even work, from a COM standpoint? Is it part of the language specs?</p>\n"}, {"tags": ["vba", "excel", "formula"], "comments": [{"owner": {"reputation": 389, "user_id": 1723624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdc702eaf60ac3875eaed18f0d57edf1?s=128&d=identicon&r=PG", "display_name": "Daniel Graham", "link": "https://stackoverflow.com/users/1723624/daniel-graham"}, "edited": false, "score": 0, "creation_date": 1458763154, "post_id": 36187533, "comment_id": 60010393, "body": "Consider reconstructing the question to show code in a more readable format and give examples of your inputs with your expected results contrasted to the results you are getting instead."}, {"owner": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "reply_to_user": {"reputation": 389, "user_id": 1723624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdc702eaf60ac3875eaed18f0d57edf1?s=128&d=identicon&r=PG", "display_name": "Daniel Graham", "link": "https://stackoverflow.com/users/1723624/daniel-graham"}, "edited": false, "score": 0, "creation_date": 1458763433, "post_id": 36187533, "comment_id": 60010563, "body": "@DanielGraham - I think I just did that. the first time it was a mess. I can edit to give examples results but it would be just a number (value)."}, {"owner": {"reputation": 389, "user_id": 1723624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdc702eaf60ac3875eaed18f0d57edf1?s=128&d=identicon&r=PG", "display_name": "Daniel Graham", "link": "https://stackoverflow.com/users/1723624/daniel-graham"}, "edited": false, "score": 0, "creation_date": 1458774213, "post_id": 36187533, "comment_id": 60015647, "body": "Ahh, gotchya, I see that now. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "edited": false, "score": 0, "creation_date": 1458763998, "post_id": 36187692, "comment_id": 60010873, "body": "I want the result of the calculation. I tried that and I get the error: Method &#39;Range&#39; of object&#39;_Worksheet&#39; failed"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "edited": false, "score": 0, "creation_date": 1458764607, "post_id": 36187692, "comment_id": 60011226, "body": "I hadn&#39;t noticed the double quotes in the Range objects with the named range&#39;s names and had to edit them out after my original post. Did you use the later revision? What happens then you put <code>currentWk.Range(&quot;grBox&quot;).Address(external:=true)</code> and <code>debug.print prevWk.Range(&quot;grBox&quot;).Address(external:=true)</code> before the calculation? What is reported i the Immediate window? What does the Locals window say about the ranges? Have you set a Watch on the named range values?"}, {"owner": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "edited": false, "score": 0, "creation_date": 1458830444, "post_id": 36187692, "comment_id": 60039024, "body": "OMG @Jeeped I feel like such an idiot! I have been struggling with this again all morning. My original code worked. Range(&quot;chgBox&quot;) = .Range(&quot;grBox&quot;) - prevWk.Range(&quot;grBox&quot;) I forgot to name the cells in the prevWk. Rookie mistake! I am a beginner but that was just dumb. Thanks again for you help."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1458765895, "last_edit_date": 1458765895, "creation_date": 1458763476, "answer_id": 36187692, "question_id": 36187533, "link": "https://stackoverflow.com/questions/36187533/vba-formula-from-one-workbook-to-another-with-named-cells/36187692#36187692", "title": "VBA formula from one workbook to another with named cells", "body": "<p>If you want the result of the subtraction in the  Range(\"chgBox\") cell then performthe actual calculation.</p>\n\n<pre><code>Range(\"chgBox\") = currentWk.Range(\"grBox\") - prevWk.Range(\"grBox\")\n</code></pre>\n\n<p>If you want the formula to remain in the  Range(\"chgBox\") cell then convert the VBA cell references to addresses and concatenate a string that will represent the worksheet formula.</p>\n\n<pre><code>Range(\"chgBox\").Formula = \"=\" &amp; currentWk.Range(\"grBox\").Address(external:=true) &amp; _\n                            \"-\" &amp; prevWk.Range(\"grBox\").Address(external:=true)\n</code></pre>\n\n<p>You were getting the <code>#NAME!</code> error because the worksheet doesn't understand what <code>currentWk.Range(\"\"grBox\"\")</code> is.</p>\n\n<p>Addendum:</p>\n\n<p>I've run through a full sample testing environment and both the formula and direct result work as provided above. I've cleaned up the remainder of the code below.</p>\n\n<pre><code>Option Explicit\n\nSub changeReports()\n    Dim currentWk As Worksheet\n    Dim prevWk As Worksheet\n    Dim filePath As String, destinationPath As String\n    Dim sourceWorkbook As Workbook, targetWorkbook As Workbook\n\n    filePath = \"B:\\Operations\\Aging 031416Wk11.xlsm\"\n    destinationPath = \"B:\\Operations\\Aging 032116Wk12.xlsm\"\n    filePath = Environ(\"TMP\") &amp; \"\\Aging 031416Wk11.xlsm\"\n    destinationPath = Environ(\"TMP\") &amp; \"\\Aging 032116Wk12.xlsm\"\n\n    Set sourceWorkbook = Workbooks.Open(filePath)\n    Set targetWorkbook = Workbooks.Open(destinationPath)\n    Set prevWk = sourceWorkbook.Worksheets(\"2016 Reports\")\n    Set currentWk = targetWorkbook.Worksheets(\"2016 Reports\")\n\n    With currentWk\n        .Range(\"chgBox\") = .Range(\"grBox\") - prevWk.Range(\"grBox\")\n        '.Range(\"chgBox\").Formula = \"=\" &amp; currentWk.Range(\"grBox\").Address &amp; _\n                            \"-\" &amp; prevWk.Range(\"grBox\").Address(external:=True)\n    End With\n\n    sourceWorkbook.Close savechanges:=False\n    targetWorkbook.Close savechanges:=True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 36187692, "answer_count": 1, "score": 0, "last_activity_date": 1458765895, "creation_date": 1458762962, "last_edit_date": 1458763688, "question_id": 36187533, "link": "https://stackoverflow.com/questions/36187533/vba-formula-from-one-workbook-to-another-with-named-cells", "title": "VBA formula from one workbook to another with named cells", "body": "<p>I can't get my formula to work. You can see that I am simply trying to subtract one value (there is a formula in the cells) from another from one workbook to another. What am I missing? It copies the formula in the correct cell but does not calculate. Results #NAME?. </p>\n\n<pre><code>Sub changeReports()\n    Dim currentWk As Worksheet\n    Dim prevYr As Worksheet\n    Dim prevWk As Worksheet\n    Dim File_Path As String\n    Dim Source_Workbook As Workbook\n    Dim Target_workbook As Workbook\n\n    File_Path = \"B:\\Operations\\Aging 031416Wk11.xlsm\"\n    Destination_Path = \"B:\\Operations\\Aging 032116Wk12.xlsm\"\n    Set Source_Workbook = Workbooks.Open(File_Path)\n    Set Target_workbook = Workbooks.Open(Destination_Path)\n    Set prevWk = Source_Workbook.Worksheets(\"2016 Reports\")\n    Set currentWk = Target_workbook.Worksheets(\"2016 Reports\")       \n    currentWk.Activate  \n\n    ' code works to insert formula in cell but formula not working the way    it is written\n    Range(\"chgBox\").formula = \"=currentWk.Range(\"\"grBox\"\")- prevWk.Range(\"\"grBox\"\")\"     \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 1, "creation_date": 1458763156, "post_id": 36187463, "comment_id": 60010394, "body": "What code have you tried? Do you have an idea on how you think the logic should go? It&#39;s hard to know exactly what you want. For example... Do the matrices overlap? Does it matter whether you go horizontally or vertically first? When do we stop finding new matrices? What do you mean by &quot;select ... matrix&quot;?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1458822601, "post_id": 36187463, "comment_id": 60033718, "body": "This is quite unclear. What are you trying to do?"}], "answers": [{"tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1458832736, "creation_date": 1458832736, "answer_id": 36203734, "question_id": 36187463, "link": "https://stackoverflow.com/questions/36187463/select-a-square-matrix-from-excel-table-vba/36203734#36203734", "title": "Select a Square Matrix from Excel table (VBA)", "body": "<p>As per your example, the following code snippet selects the Worksheet <code>Range</code> pertinent to the content of the <code>Cell(1,1)</code>:</p>\n\n<pre><code>Sub SelectRange()\n    Dim size As Integer\n    size = Cells(1, 1).Value\n    Range(Cells(1, 2), Cells(1 + size, 2 + size)).Select\nEnd Sub\n</code></pre>\n\n<p>Hope this may help.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6106238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1522468dfd0f4dc62b62c85a2eef13?s=128&d=identicon&r=PG&f=1", "display_name": "JJ1024", "link": "https://stackoverflow.com/users/6106238/jj1024"}, "is_accepted": false, "score": 0, "last_activity_date": 1459268830, "creation_date": 1459268830, "answer_id": 36289919, "question_id": 36187463, "link": "https://stackoverflow.com/questions/36187463/select-a-square-matrix-from-excel-table-vba/36289919#36289919", "title": "Select a Square Matrix from Excel table (VBA)", "body": "<pre><code> Sub DynamicSelectMatrix()\n\n        size = 4\n             For s = 1 To 10 \n                 For t = 1 To 10 \n                     Range(Cells(6 + size * (s - 1), 5 + size * (t - 1)), Cells(6 + size * s - 1, 5 + size * t - 1)).Select\n                 Next t\n             Next s\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6106238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1522468dfd0f4dc62b62c85a2eef13?s=128&d=identicon&r=PG&f=1", "display_name": "JJ1024", "link": "https://stackoverflow.com/users/6106238/jj1024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1459268830, "creation_date": 1458762702, "last_edit_date": 1458831149, "question_id": 36187463, "link": "https://stackoverflow.com/questions/36187463/select-a-square-matrix-from-excel-table-vba", "title": "Select a Square Matrix from Excel table (VBA)", "body": "<p>How can I select a square Matrix according to a factor number?</p>\n\n<p>For example, if cells(1,1)=4, I should select 4*4 matrix, starts from a certain cell, then create a loop to continue the selections for the next 4*4 matrix both horizontally and vertically.</p>\n\n<p>Many thanks!</p>\n\n<p>I tried to use \"Step i\" based on the factor number, to avoid overlapping issue. So if i=4, basically it would go every 4 steps away horizontally, I just wonder if I could use \"step j\" as well, so how to create a loop to select a range by range?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1399, "user_id": 4092304, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/1bkiN.png?s=128&g=1", "display_name": "Sam Gilbert", "link": "https://stackoverflow.com/users/4092304/sam-gilbert"}, "is_accepted": true, "score": 3, "last_activity_date": 1458761168, "last_edit_date": 1458761168, "creation_date": 1458760964, "answer_id": 36186961, "question_id": 36186814, "link": "https://stackoverflow.com/questions/36186814/using-formula-with-variable-in-cells-object/36186961#36186961", "title": "Using .Formula with variable in cells object", "body": "<p>Try the below, I believe you were nearly there, but you inserting an unnecessary space before the equals sign + the quotes were out.  </p>\n\n<pre><code>main.Cells(main_row, calc_col).Formula = \"= J\" &amp; main_row &amp; \" / I\" &amp; main_row\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 5085662, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/da2338afe56c572483a344ebc82312d0?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/5085662/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 36186961, "answer_count": 1, "score": 3, "last_activity_date": 1458761799, "creation_date": 1458760451, "last_edit_date": 1495540232, "question_id": 36186814, "link": "https://stackoverflow.com/questions/36186814/using-formula-with-variable-in-cells-object", "title": "Using .Formula with variable in cells object", "body": "<p>I've tried a variety of concats and uses of \"\" but I cant get .formula to work in the following code. The macro runs without error but it does not populate my sheet. I feel like this: <a href=\"https://stackoverflow.com/questions/20052930/excel-vba-formula-with-variables\">Excel VBA formula with variables</a> is what I am going for but main_row does not appear to be getting assigned to the variable when it is inside the .formula. </p>\n\n<pre><code>main_row = main.Range(\"b6\").Row\ncalc_col = main.Range(\"k6\").Column\n\nmain.Cells(main_row, calc_col).Formula = \" = j &amp; main_row / i &amp; main_row  \"\n</code></pre>\n\n<ol>\n<li>Is it possible to use .formula with cells object?</li>\n<li>Would rather not use application.worksheetfunction because i want end user to see the formula</li>\n<li>Anyone have a good source to explain the proper way to qualify variables within .formula?</li>\n</ol>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1458760211, "post_id": 36186621, "comment_id": 60008698, "body": "Please included the VBA code snippet and add clarity to your task description: where are those Dropdown are located? Also, a fragment of the Worksheet with this sample data will be helpful. Best regards,"}, {"owner": {"reputation": 409, "user_id": 331470, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oOomy.jpg?s=128&g=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/331470/raja"}, "reply_to_user": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1458760568, "post_id": 36186621, "comment_id": 60008919, "body": "Sheet 2 has two named ranges - range 1 and range 2. In sheet 1, First column is assigned &#39;range 1&#39;. If I select one of the values from range 1, then the adjacent cell should have corresponding &#39;range 2&#39; value. I am not sure how to attach an excel sheet in stack overflow. I will try to do that."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1458760731, "creation_date": 1458760731, "answer_id": 36186903, "question_id": 36186621, "link": "https://stackoverflow.com/questions/36186621/how-can-i-fill-cell-values-from-two-named-ranges-in-excel/36186903#36186903", "title": "How can I fill cell values from two named ranges in excel?", "body": "<p>This should be all you need.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address(0, 0) = \"B3\" Then\n        Application.EnableEvents = False\n        Target.Offset(0, 1) = Range(\"range2\") _\n            (Application.Match(Target.Value, Range(\"range1\"), 0))\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 216, "user_id": 5045578, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9-VygvgDnJY/AAAAAAAAAAI/AAAAAAAAEi4/-NYkWDu8Zek/photo.jpg?sz=128", "display_name": "Michal Schmitt", "link": "https://stackoverflow.com/users/5045578/michal-schmitt"}, "is_accepted": false, "score": 0, "last_activity_date": 1458761370, "creation_date": 1458761370, "answer_id": 36187087, "question_id": 36186621, "link": "https://stackoverflow.com/questions/36186621/how-can-i-fill-cell-values-from-two-named-ranges-in-excel/36187087#36187087", "title": "How can I fill cell values from two named ranges in excel?", "body": "<p>This formula finds the drop down text in range1 and recalls that location in range2.</p>\n\n<p>Replace A1 with location of drop down selection.</p>\n\n<p>Assumptions:  Both arrays are of equal length.</p>\n\n<pre><code>=IFERROR( INDEX( range2, MATCH(D2, range1)), \"\u2022\")\n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 331470, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oOomy.jpg?s=128&g=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/331470/raja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 36186903, "answer_count": 2, "score": 0, "last_activity_date": 1458761582, "creation_date": 1458759809, "last_edit_date": 1458761582, "question_id": 36186621, "link": "https://stackoverflow.com/questions/36186621/how-can-i-fill-cell-values-from-two-named-ranges-in-excel", "title": "How can I fill cell values from two named ranges in excel?", "body": "<p>I have two named ranges</p>\n\n<p>range 1 : test1, test2, test3, test4</p>\n\n<p>range 2 : 20,    30,    50,    80</p>\n\n<p>If I select one of the values from range 1, then the corresponding range 2 value should be copied to next cell.\nFor example, if I select 'test 3' from dropdown, then text '50' should be copied to adjacent cell.</p>\n\n<p>From the OP's comments below:<br/>\nSheet 2 has two named ranges - range 1 and range 2. In sheet 1, First column is assigned 'range 1'. If I select one of the values from range 1, then the adjacent cell should have corresponding 'range 2' value. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1458759552, "post_id": 36186204, "comment_id": 60008314, "body": "Take good care of that crystal ball;it&#39;s certainly better than mine."}, {"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1458760693, "post_id": 36186204, "comment_id": 60008995, "body": "It was a rental, only one charge in it ;)"}], "tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": true, "score": 3, "last_activity_date": 1458758759, "last_edit_date": 1458758759, "creation_date": 1458758332, "answer_id": 36186204, "question_id": 36185873, "link": "https://stackoverflow.com/questions/36185873/create-list-from-column-row-matches/36186204#36186204", "title": "Create list from column-row matches", "body": "<p>I don't fully understand the layout of your table, but assuming it looks like the following example I tested, this VBA should work.</p>\n\n<p><strong>Sheet1 table format</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ijaQx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ijaQx.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Sheet2 output results</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/pivIE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pivIE.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>VBA</strong></p>\n\n<pre><code>Sub test()\n\nDim i As Long\nDim j As Long\nDim lRow As Long\nDim lCol As Long\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\nSet ws1 = Sheets(\"Sheet1\")\nSet ws2 = Sheets(\"Sheet2\")\nlRow = ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row\nlCol = ws1.Cells(1, ws1.Columns.Count).End(xlToLeft).Column\n\nWith ws1\n\n    For j = 2 To lCol\n    ws2.Cells(1, j).Value = .Cells(1, j).Value\n\n        For i = 2 To lRow\n\n            If .Cells(i, j).Value = True Then\n\n                ws2.Cells(ws2.Rows.Count, j).End(xlUp).Offset(1, 0).Value = .Cells(i, 1).Value 'This will probably need to be changed to 'i' to represent the row number for your purposes\n\n            End If\n\n        Next i\n\n    Next j\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 6206, "user_id": 1750282, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/de6f3eebd350eab64f9728c30ede43ef?s=128&d=identicon&r=PG", "display_name": "Randy Hall", "link": "https://stackoverflow.com/users/1750282/randy-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 36186204, "answer_count": 1, "score": 0, "last_activity_date": 1501611805, "creation_date": 1458757288, "last_edit_date": 1458759099, "question_id": 36185873, "link": "https://stackoverflow.com/questions/36185873/create-list-from-column-row-matches", "title": "Create list from column-row matches", "body": "<p>I have a table with the first row being column headers, and the first column being row labels. I have put <code>TRUE</code> in every cell where these match up. </p>\n\n<p>I need to generate a list in a separate sheet for each column, containing only the matching row names where the cells are <code>TRUE</code>.</p>\n\n<p>So if <code>B13</code>, <code>B15</code>, and <code>C12</code> in sheet1 are <code>TRUE</code>, then sheet2 will show column <code>B</code> with <code>13</code> and <code>15</code> under it, and column <code>C</code> with <code>12</code> under it. Except using the labels I've input, instead of letters and numbers. </p>\n\n<p>I haven't managed to wrap my head around where to start with this one, so any pointer in the right direction is appreciated. </p>\n\n<p>I've tried creating a defined name for the column headers and row labels.</p>\n"}, {"tags": ["vba", "catia"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1458761131, "post_id": 36185579, "comment_id": 60009310, "body": "The behaviour is well defined. I&#39;d say that in your case, someFunction is throwing an error and that you have an OnError Resume Next before previously. Without a reproducible example, this is the only thing that makes sense to the behaviour you are describing."}, {"owner": {"reputation": 4269, "user_id": 567326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ecb18cd54a1e3a9b76ffdd59d412a?s=128&d=identicon&r=PG", "display_name": "rskar", "link": "https://stackoverflow.com/users/567326/rskar"}, "edited": false, "score": 0, "creation_date": 1458761634, "post_id": 36185579, "comment_id": 60009612, "body": "Following up on Florent B, avoid <code>On Error Resume Next</code> at all costs. If you must use it, put it inside a very specialized function complete with profuse comments on why it&#39;s really really needed. Otherwise adopt the attitude that there&#39;s never a good reason for <code>On Error Resume Next</code>. It leads to strange things like this."}, {"owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "edited": false, "score": 0, "creation_date": 1458814708, "post_id": 36185579, "comment_id": 60028899, "body": "I completely agree, and i hate and don&#39;t use On Error Resume Next unless impossible to avoid ( 3rd party stuff ) and even then is very well structured code around it..  even this goto err1 is not error handler, its just handler for different return values, pure longs ( c style returns )"}, {"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1458829648, "post_id": 36185579, "comment_id": 60038478, "body": "I&#39;ve experienced this behavior when trying to evaluate booleans in IF statements. I&#39;ve noticed this even more when trying simply <code>If someFunction() Then...</code> will yield false positives. In these cases, your solution at the bottom is typically what I&#39;ve done and works...probably some kind of bug in VBA...A lot of hours were wasted trying to understand how FALSE=TRUE."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "is_accepted": false, "score": 0, "last_activity_date": 1459239327, "creation_date": 1459239327, "answer_id": 36278884, "question_id": 36185579, "link": "https://stackoverflow.com/questions/36185579/catvba-false-positive-if-statement/36278884#36278884", "title": "catvba, false positive if statement", "body": "<p>And yes, i found an answer on my question, in Catia, i have VBA version 7.1.1033, which doesn't work as expected, while the the same piece of code works in Excel, which uses newer VBA version, 7.1.1049...</p>\n\n<p>So answer is, VBA has bug in that release..</p>\n"}], "owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 484, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459239327, "creation_date": 1458756393, "last_edit_date": 1458839682, "question_id": 36185579, "link": "https://stackoverflow.com/questions/36185579/catvba-false-positive-if-statement", "title": "catvba, false positive if statement", "body": "<p>Unfortunately, sometimes when the if statements are more complex, behavior is quite strange, here is a copy of the line which doesnt work as expected when used like this</p>\n\n<pre><code>If someFunction(arg1, arg2, CreatedFromClass(arg3, arg4, arg5)) Then GoTo err1\n</code></pre>\n\n<p><strong>someFunction(...)</strong> itself has return type long, but in this case is absolutely always evaluated as positive, even though <strong>someFunction</strong> before return contains 0 as a return value.</p>\n\n<p>so, it can be wrapped as any of the following and result will be always true</p>\n\n<pre><code>If someFunction() = True Then\nIf someFunction() = False Then\nIf someFunction() = 0 Then\nIf someFunction() = 1 Then\nIf someFunction() &lt;&gt; 0 Then\nIf someFunction() &lt;&gt; 1 Then\nIf Not someFunction() = 0 Then\nIf Not someFunction() = 1 Then\nIf (someFunction() = 0) = False Then\nIf (someFunction() = 0) = True Then\nIf CBool(someFunction() = 0) = True Then\nIf CBool(someFunction() = 1) = True Then\n</code></pre>\n\n<p>but when is split into segments, and manually assigned to the variable, then works as expected</p>\n\n<pre><code>Dim rVal As Long\nrVal = someFunction(arg1, arg2, CreatedFromClass(arg3, arg4, arg5))\nIf rVal Then GoTo err1\n</code></pre>\n\n<p>question is of course why the behavior is not the same? did someone experienced similar?</p>\n\n<p>Additionally, after couple hours, i been able to isolate problematic piece of code!</p>\n\n<p>Class: cls.cls</p>\n\n<pre><code>Option Explicit\n\nPrivate mCol As Collection\n\nPrivate Sub Class_Initialize()\n    Set mCol = New Collection\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set mCol = Nothing\nEnd Sub\n\nPublic Sub Add(iItem)\n    mCol.Add iItem\nEnd Sub\n\nPublic Function DoCopy() As cls\n    Set DoCopy = New cls\n\n    Dim i As Long\n    For i = 1 To mCol.Count\n        DoCopy.Add mCol(i)\n    Next\nEnd Function\n</code></pre>\n\n<p>and testing module</p>\n\n<pre><code>Option Explicit\n\nPublic Function CreateCls(ParamArray params()) As cls\n    Set CreateCls = New cls\n    If UBound(params) &lt; 0 Then Exit Function\n\n    Dim i As Long\n    For i = LBound(params) To UBound(params)\n        CreateCls.Add params(i)\n    Next\nEnd Function\n\nPrivate Function doTest(iCls As cls) As Long\n    doTest = 0\nEnd Function\n\nPrivate Sub CATStart()\n    Dim x As cls\n    Set x = CreateCls(\"param1\", \"param2\", \"param3\", \"param4\")\n\n    If doTest(x.DoCopy) = 0 Then Debug.Print \"long_0\"\n    If doTest(x.DoCopy) = 1 Then Debug.Print \"long_1\"\n    If CBool(doTest(x.DoCopy)) = True Then Debug.Print \"bool_True\"\n    If CBool(doTest(x.DoCopy)) = False Then Debug.Print \"bool_False\"\n\n    Set x = Nothing\nEnd Sub\n</code></pre>\n\n<p>And of course all of them will be evaluated as True valid and result printed!</p>\n"}, {"tags": ["sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 901, "user_id": 4979197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deGfP.png?s=128&g=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/4979197/chuck"}, "edited": false, "score": 0, "creation_date": 1458756790, "post_id": 36185571, "comment_id": 60006704, "body": "Why make a copy in Access, it is way to slow and dies with that kind of rows. If you want create a SQL view, and link Access to that view. It still will be slow."}, {"owner": {"reputation": 21, "user_id": 6105753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3b61a89fb43282ffbcde34605f026c?s=128&d=identicon&r=PG&f=1", "display_name": "kudan", "link": "https://stackoverflow.com/users/6105753/kudan"}, "reply_to_user": {"reputation": 901, "user_id": 4979197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deGfP.png?s=128&g=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/4979197/chuck"}, "edited": false, "score": 0, "creation_date": 1458757163, "post_id": 36185571, "comment_id": 60006909, "body": "Few reasons: 1.) I got no rights for creating views at SQL Servers (read-only) 2.) Access will be used by users with no SQL knowledge 3.) VBA will make few other actions depend on user decision"}, {"owner": {"reputation": 901, "user_id": 4979197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deGfP.png?s=128&g=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/4979197/chuck"}, "edited": false, "score": 0, "creation_date": 1458757420, "post_id": 36185571, "comment_id": 60007076, "body": "Ok, then run your query in SQL, right click in the results page, and pick copy (no headers). Open the Access table and click on the last row and paste."}, {"owner": {"reputation": 21, "user_id": 6105753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3b61a89fb43282ffbcde34605f026c?s=128&d=identicon&r=PG&f=1", "display_name": "kudan", "link": "https://stackoverflow.com/users/6105753/kudan"}, "reply_to_user": {"reputation": 901, "user_id": 4979197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deGfP.png?s=128&g=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/4979197/chuck"}, "edited": false, "score": 1, "creation_date": 1458758037, "post_id": 36185571, "comment_id": 60007461, "body": "1.) It&#39;s going to be a tool for users with no SQL knowledge (including software) 2.) It&#39;s going to be updated frequently. So doing it manually it&#39;s a waste of time and it&#39;s inconvenient 3.) My politics: Don&#39;t do things which can be done automatically."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1458765033, "post_id": 36185571, "comment_id": 60011470, "body": "Why don&#39;t you just link the SQL table(s) to Access and then make a query with the values you want? That&#39;s the same as having a view in SQL server in functionality (but not in performance)."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6105753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3b61a89fb43282ffbcde34605f026c?s=128&d=identicon&r=PG&f=1", "display_name": "kudan", "link": "https://stackoverflow.com/users/6105753/kudan"}, "edited": false, "score": 0, "creation_date": 1458804808, "post_id": 36188604, "comment_id": 60024016, "body": "I tired that. The xlsx/csv files are the fastest way I came up with. Solutions for commas is adding proper Import/Export specification (for example add record in &quot;MSysIMEXspecs&quot; ).   But I was wondering if there is any as fast way which use Access resources only."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 1, "last_activity_date": 1458766875, "creation_date": 1458766875, "answer_id": 36188604, "question_id": 36185571, "link": "https://stackoverflow.com/questions/36185571/vba-insert-whole-adodb-recordset-into-table/36188604#36188604", "title": "VBA Insert whole ADODB.Recordset into table", "body": "<p>I agree with the commenters that you should link if at all possible. But I wanted to see if it could be done. I ended up converting the recordset to a comma delimited file and use <code>TransferText</code> to append it.</p>\n\n<pre><code>Public Sub ImportFromSQLSvr()\n\n    Dim rs As ADODB.Recordset\n    Dim cn As ADODB.Connection\n    Dim sResult As String\n    Dim sFile As String, lFile As Long\n\n    Const sIMPORTFILE As String = \"TestImport.txt\"\n\n    Set cn = New ADODB.Connection\n    cn.Open msCONN\n    Set rs = cn.Execute(\"SELECT SiteID, StoreNumber FROM Site\")\n\n    'Add a header row, replace tabs with commas\n    sResult = rs.GetString\n    sResult = \"SiteID, StoreNumber\" &amp; vbNewLine &amp; sResult\n    sResult = Replace(sResult, vbTab, \",\")\n\n    'Write to a text file\n    lFile = FreeFile\n    sFile = Environ(\"TEMP\") &amp; \"\\\" &amp; sIMPORTFILE\n    Open sFile For Output As lFile\n        Print #lFile, sResult\n    Close lFile\n\n    'Append to table dbo_Site\n    DoCmd.TransferText acImportDelim, , \"dbo_Site\", Environ(\"TEMP\") &amp; \"\\\" &amp; sIMPORTFILE, True\n\n    On Error Resume Next\n        rs.Close\n        Set rs = Nothing\n        cn.Close\n        Set cn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>If you have any commas in your data, you'll need to do some extra work to properly format the csv.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1458811277, "creation_date": 1458811277, "answer_id": 36196724, "question_id": 36185571, "link": "https://stackoverflow.com/questions/36185571/vba-insert-whole-adodb-recordset-into-table/36196724#36196724", "title": "VBA Insert whole ADODB.Recordset into table", "body": "<blockquote>\n  <p>I was wondering if there is any as fast way which use Access\n  resources only.</p>\n</blockquote>\n\n<p>As already mentioned, <em>link</em> the SQL table, then create a simple <em>append</em> query that reads from the linked table and writes to your Access table, and you're done.</p>\n"}], "owner": {"reputation": 21, "user_id": 6105753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3b61a89fb43282ffbcde34605f026c?s=128&d=identicon&r=PG&f=1", "display_name": "kudan", "link": "https://stackoverflow.com/users/6105753/kudan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6363, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1458830393, "creation_date": 1458756376, "last_edit_date": 1458830393, "question_id": 36185571, "link": "https://stackoverflow.com/questions/36185571/vba-insert-whole-adodb-recordset-into-table", "title": "VBA Insert whole ADODB.Recordset into table", "body": "<p>I am trying to run SQL query on sql server (some DWH) and then insert outcome into access table (using VBA).<br>\nI did it by using ADODB.Connection, ADODB.Command and ADODB.Recordset. At this point I have my outcome in Recordset and I Wonder how I can insert it into table without looping it.<br>\nI tried:  </p>\n\n<pre><code>If Not (Rs.EOF And Rs.BOF) Then  \n    Rs.MoveFirst  \n    Do Until Rs.EOF = True  \n        DoCmd.RunSQL (\"INSERT INTO Table (F1, F2) VALUES ( \" &amp; rs![F1] &amp; \", \" &amp; rs[F2] &amp; \")\" \n        Rs.MoveNext  \n    Loop  \nEnd If\n</code></pre>\n\n<p>But Recordset may have over 100k rows. So it would take ages to insert it by using this method.   </p>\n\n<p>Another very fast way is to open a new excel workbook paste it into worksheet and then import it. But I would like to avoid it. Is there any other way ?</p>\n\n<p>---------EDITED-----------<br>\nSorry guys. My bad. I was forcing solution with VBA while linkin it was perfect. THANKS ! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1458757594, "post_id": 36185362, "comment_id": 60007172, "body": "You are using an unreliable way of getting the &quot;last row&quot;, see here: <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\" title=\"error in finding last used cell in vba\">stackoverflow.com/questions/11169445/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 531, "user_id": 1946796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vd55i.jpg?s=128&g=1", "display_name": "Rafa Barragan", "link": "https://stackoverflow.com/users/1946796/rafa-barragan"}, "is_accepted": false, "score": 0, "last_activity_date": 1458761020, "creation_date": 1458761020, "answer_id": 36186973, "question_id": 36185362, "link": "https://stackoverflow.com/questions/36185362/copy-and-paste-data-from-columns-a-to-ai-up-to-the-last-row-in-pivot-table/36186973#36186973", "title": "Copy and paste data from columns A to AI up to the last row in pivot table", "body": "<p>To select a field from a pivot table in <em>VBA</em>, you could use something like this.</p>\n\n<pre><code>Dim Wks as Worksheet, oPvt as PivotTable\nSet Wks = ActiveWorksheet\nSet oPvt = Wks.PivotTables([PivotTableName])\n\noPvt.PivotSelect Name:=\"[Field]\", _\n                    Mode:=xlDataAndLabel, _\n                    UseStandardName:=True\nSelection.Copy\n</code></pre>\n\n<p>More option of what you can select from a PivotTable is <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840451.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\" title=\"Microsoft Help\">here</a> and <code>PivotTable.PivotSelect</code> Method in <a href=\"http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=156:reference-pivot-fields-and-pivot-items-in-an-excel-pivot-table-using-vba&amp;catid=79&amp;Itemid=475#8.\" rel=\"nofollow\" title=\"Select a part of the PivotTable using the PivotTable.PivotSelect Method\">this</a> and show you how to select some specific data from a field.</p>\n"}], "owner": {"reputation": 11, "user_id": 4401942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/057f0b9f9b81d0dd836f3595d1920a25?s=128&d=identicon&r=PG&f=1", "display_name": "Sarvin Kaur", "link": "https://stackoverflow.com/users/4401942/sarvin-kaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458761020, "creation_date": 1458755687, "last_edit_date": 1531161705, "question_id": 36185362, "link": "https://stackoverflow.com/questions/36185362/copy-and-paste-data-from-columns-a-to-ai-up-to-the-last-row-in-pivot-table", "title": "Copy and paste data from columns A to AI up to the last row in pivot table", "body": "<p>I'm trying to copy and paste data from columns A and AI up to the last populated row in a pivot table that is located in columns AO to AP.</p>\n\n<p>I have tried this code but it keeps pasting beyond the last row of the pivot table.</p>\n\n<pre><code>Sub Test1()\n\n    Dim LastRow As Long\n\n    Set blah = Range(\"A2:AI2\")\n\n    Sheets(\"FI\").Activate\n\n    LastRow = Cells(Cells.Rows.Count, \"AO\").End(xlUp).Row\n    Range(\"A2:AI2\" &amp; LastRow).FillDown\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 0, "last_activity_date": 1458920361, "creation_date": 1458920361, "answer_id": 36223036, "question_id": 36184683, "link": "https://stackoverflow.com/questions/36184683/find-exchange-users-officelocation-in-vba/36223036#36223036", "title": "Find Exchange User&#39;s OfficeLocation in VBA", "body": "<p>So, I haven't found a way to query Exchange by email or alias because the <code>.Item</code> method (from the line <code>olGAL.Item(username)</code>) requires <a href=\"https://msdn.microsoft.com/en-us/library/office/aa220122(v=office.11).aspx\" rel=\"nofollow\">Either the index number of the object, or a value used to match the default property of an object in the collection</a>. I did find a way to ensure I am getting the correct user however. The default property for the GAL is the user's name, which in my case (but may not be in everyone's case...can't find good documentation to verify this) the DistinguishedName in Active Directory. So if I search AD with the user's SAM account, I can get the user's DN. I can then search Exchange with that DN to ensure I have the correct \"John Smith\".</p>\n\n<p>Here is my combined code:</p>\n\n<pre><code>'I pass the username (EG: johnsmit) and get the DN (eg John Smith - VP of Sales).\n' This DN gets passed to the function in my question, and returns the correct location.\nPrivate Function GetFullName(strUsername As String) As String\n        Dim objConnection  As Object\n        Dim objCommand As Object\n        Dim objRecordSet As Object\n        Dim strDN As String\n        Dim temp As Variant\n\n        Const ADS_SCOPE_SUBTREE = 2\n\n        Set objConnection = CreateObject(\"ADODB.Connection\")\n        Set objCommand = CreateObject(\"ADODB.Command\")\n        objConnection.Provider = \"ADsDSOObject\"\n        objConnection.Open \"Active Directory Provider\"\n        Set objCommand.ActiveConnection = objConnection\n\n        objCommand.Properties(\"Page Size\") = 1000\n        objCommand.Properties(\"Searchscope\") = ADS_SCOPE_SUBTREE\n\n        objCommand.CommandText = \"SELECT distinguishedName FROM 'LDAP://dc=mydomain,dc=com' WHERE objectCategory='user' AND sAMAccountName='\" &amp; strUsername &amp; \"'\"\n        Set objRecordSet = objCommand.Execute\n\n        objRecordSet.MoveFirst\n        Do Until objRecordSet.EOF\n            strDN = objRecordSet.Fields(\"distinguishedName\").Value\n            temp = Split(strDN, \",\")\n            GetFullName = Replace(temp(0), \"CN=\", \"\")\n            objRecordSet.MoveNext\n        Loop\n\n        objConnection.Close\n        Set objConnection = Nothing\n        Set objCommand = Nothing\n        Set objRecordSet = Nothing\nEnd Function\n</code></pre>\n\n<p>If anyone has a better, faster, cheaper (one that doesn't hit the AD servers) method, I'd love to hear it.</p>\n"}], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "accepted_answer_id": 36223036, "answer_count": 1, "score": 0, "last_activity_date": 1458920361, "creation_date": 1458753519, "question_id": 36184683, "link": "https://stackoverflow.com/questions/36184683/find-exchange-users-officelocation-in-vba", "title": "Find Exchange User&#39;s OfficeLocation in VBA", "body": "<p>When viewing someone's contact card in Outlook, there is a field for Office which gives their location. How can I find that using VBA? Here's my most functional code:</p>\n\n<pre><code>Private Function getLocation(username As String) As String\nDim olApp As Outlook.Application\nDim olNS As Outlook.Namespace\nDim olGAL As Outlook.AddressEntries\nDim olAddressEntry As Outlook.AddressEntry\nDim olUser As Outlook.ExchangeUser\n\nSet olApp = New Outlook.Application\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olGAL = olNS.AddressLists(\"Global Address List\").AddressEntries\nSet olAddressEntry = olGAL.Item(username)\nSet olUser = olAddressEntry.GetExchangeUser\nDebug.Print olGAL.Count 'count is 646718\nDebug.Print olUser.OfficeLocation\nDebug.Print olUser.Address\nDebug.Print olUser.Name\n\ngetLocation = olUser.OfficeLocation\n\nSet olApp = Nothing\nSet olNS = Nothing\nSet olGAL = Nothing\nSet olAddressEntry = Nothing\nSet olUser = Nothing\n\nEnd Function\n</code></pre>\n\n<p>This works when I search for their actual name (EG, John Smith), but it only returns the first John Smith. How can I use their email address or alias to search?</p>\n\n<p>Note: I added a reference to the <code>Microsoft Outlook 16.0 Object Library</code> to take advantage of Intellisense, but I plan on switching to late binding once it works.</p>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 0, "last_activity_date": 1458766000, "creation_date": 1458766000, "answer_id": 36188381, "question_id": 36184238, "link": "https://stackoverflow.com/questions/36184238/cross-dependent-cascading-dropdowns-in-ms-access/36188381#36188381", "title": "Cross Dependent Cascading Dropdowns in MS Access", "body": "<p>You have to use IIF in your control sources to check if there is already a value in the other combo boxes or not.</p>\n\n<pre><code>Me.County.ControlSource = \"Select County_Name FROM Natl_Structure WHERE 1=1\" &amp; \nIIf(IsNull(Forms![Postal]![State]),\"\", \" AND State_Name = \" &amp; Forms![Postal]![State]) &amp; \nIIf(IsNull(Forms![Postal]![Country]),\"\",\" AND Country = \" &amp; Forms![Postal]![Country])\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4317268, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e6fb90539c6f202c7bfdf415009b5572?s=128&d=identicon&r=PG&f=1", "display_name": "Archaimot", "link": "https://stackoverflow.com/users/4317268/archaimot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 36188381, "answer_count": 1, "score": 0, "last_activity_date": 1458821117, "creation_date": 1458752111, "last_edit_date": 1458821117, "question_id": 36184238, "link": "https://stackoverflow.com/questions/36184238/cross-dependent-cascading-dropdowns-in-ms-access", "title": "Cross Dependent Cascading Dropdowns in MS Access", "body": "<p>My concept is this: There are three columns relating to a definite hierarchy. I would like our users to be able to input into the combo boxes in whichever order they'd like and have the information pulled in the other two combo boxes be reactive to this.</p>\n\n<p>Example: <code>Country / State / (County/Region/District/City)</code> in a tracker; The sql referenced table with source info would be <code>Country_Name, State_Name, County_Name</code></p>\n\n<p>If one were to put in \"Vienna\" into County, one would have options for Georgia, Missiouri, etc. under state, and United States and Austria as options for Country (I have no idea the larger provincial structure for Austria to add them to a state field--this is meant as an analogous example).</p>\n\n<p>If one were to put in \"Virginia\" under state one would get United States as an option for Country, and Various counties as options for County.</p>\n\n<p>The hierarchy would be relatively normal for inputting a country, as that's the natural drill down. </p>\n\n<p>I do understand how to do a cascading (one-way) combo-box. The problem lies with being unable to use a nested Iif in the control source, or being unable to temporarily amend the control source through <code>_AfterUpdate</code> cases--please excuse the pseudocode: </p>\n\n<pre><code>Private Sub State_AfterUpdate()\n    If Country = \"\" And County = \"\" Then\n        Me.Country.ControlSource = \"SELECT Country_Name FROM Natl_Structure WHERE State_Name = \" &amp; Forms![Postal]![State]\n\n        Me.County.ControlSource = \"Select County_Name FROM Natl_Structure WHERE State_Name = \" &amp; Forms![Postal]![State] &amp; \";\"\n\n    Elseif Country &lt;&gt; \"\" And County = \"\" Then\n        Me.County ControlSource = \"Select County_Name FROM Natl_Structure WHERE (State_Name = \" &amp; Forms![Postal]![State]) AND (Country_Name = \" &amp; Forms![Postal]![Country] &amp; \";\"\n</code></pre>\n\n<p>...and flip it for the opposite case. And set up the opposite of the first case for if both were setup (not that it would be necessary at that point, but just to account for all cases). Then apply the same sort of measure to the other two combo boxes.</p>\n\n<p>Any and all help would be appreciated.</p>\n"}, {"tags": ["vba", "list", "procedures"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1458752945, "post_id": 36183657, "comment_id": 60004286, "body": "Have a look at <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">Programming The VBA Editor</a>. With <code>VBA Extensibility library</code> you can do almost everything."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1458753089, "post_id": 36183657, "comment_id": 60004383, "body": "@dee that will be a text search. do find actual identifier references you need a symbol table and a lot more work than that. <a href=\"http://www.rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> could help here. (disclaimer: I own &amp; maintain Rubberduck)."}, {"owner": {"reputation": 377, "user_id": 6053799, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a7caccb567e3664244bcd555c895904c?s=128&d=identicon&r=PG&f=1", "display_name": "Ali_R4v3n", "link": "https://stackoverflow.com/users/6053799/ali-r4v3n"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1458753255, "post_id": 36183657, "comment_id": 60004507, "body": "@Mat&#39;s Mug, it would be great if you can come up with some code and thanks for your comment .."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1458803086, "post_id": 36183657, "comment_id": 60023450, "body": "<a href=\"https://twitter.com/rubberduckvba/status/712897109658304512\" rel=\"nofollow noreferrer\">Done :-)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 6053799, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a7caccb567e3664244bcd555c895904c?s=128&d=identicon&r=PG&f=1", "display_name": "Ali_R4v3n", "link": "https://stackoverflow.com/users/6053799/ali-r4v3n"}, "edited": false, "score": 0, "creation_date": 1458751206, "post_id": 36183802, "comment_id": 60003056, "body": "thanks, i was hoping for more elegant way, since this one is very inefficient ...good job Microsoft :)"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1458750949, "creation_date": 1458750949, "answer_id": 36183802, "question_id": 36183657, "link": "https://stackoverflow.com/questions/36183657/vba-show-references-to-other-procedures/36183802#36183802", "title": "vba Show references to other procedures", "body": "<p>In break mode, press <kbd>Ctrl</kbd>+<kbd>L</kbd> to view the call stack. This is the best you're gonna get in the VBE.</p>\n\n<p>Note that the call stack cannot be accessed via code and so what appears to be your end-goal cannot be achieved in VBA.</p>\n"}, {"comments": [{"owner": {"reputation": 377, "user_id": 6053799, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a7caccb567e3664244bcd555c895904c?s=128&d=identicon&r=PG&f=1", "display_name": "Ali_R4v3n", "link": "https://stackoverflow.com/users/6053799/ali-r4v3n"}, "edited": false, "score": 5, "creation_date": 1458755561, "post_id": 36184956, "comment_id": 60005973, "body": "THANK YOU, I really appreciate your contribution to the world by giving us The Rubberduck :), i was actually looking for something that beefs up the VBE and adds more functionalities to it. cheers"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 5, "last_activity_date": 1458754327, "creation_date": 1458754327, "answer_id": 36184956, "question_id": 36183657, "link": "https://stackoverflow.com/questions/36183657/vba-show-references-to-other-procedures/36184956#36184956", "title": "vba Show references to other procedures", "body": "<blockquote>\n  <p><strong>DISCLAIMER:</strong> I wrote this part of the Rubberduck add-in myself, and I own and maintain the <a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\"><strong>Rubberduck</strong></a> project. </p>\n</blockquote>\n\n<hr>\n\n<p>Download and install <a href=\"http://www.rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>. Right-click the procedure name (from its declaration, or any of its usages) and select the \"Find all references\" command from the code pane context menu:</p>\n\n<p><img src=\"https://i.stack.imgur.com/XeIyx.png\" alt=\"Rubberduck 1.4.3 Find all references\"></p>\n\n<p>You can then double-click an item in the list to navigate there.</p>\n\n<p>The latest release dates a little (July 2015), but the project is well alive on GitHub, and version 2.0 should be released in 6-8 weeks. It won't let you iterate procedure/identifier references with VBA code, but a COM API to do exactly that <em>is</em> on the project's roadmap.</p>\n\n<p>Rubberduck 2.0's \"find all references\" can find references to pretty much anything, from classes:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3qVwv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3qVwv.png\" alt=\"Rubberduck 2.0&#39;s search results toolwindow\"></a></p>\n\n<p>To properties:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gI14s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gI14s.png\" alt=\"references to &#39;Cancelled&#39; property accessor\"></a></p>\n\n<p>...and library functions:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oSxKv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oSxKv.png\" alt=\"references to MsgBox\"></a></p>\n\n<hr>\n\n<p>Doing this with code, even very smart code, using the VBIDE API, isn't going to be reliably possible. The reason for this is that it's perfectly legal to have this code in <code>Module1</code>:</p>\n\n<pre><code>Sub DoSomething()\n    'do something\nEnd Sub\n</code></pre>\n\n<p>And then this code in <code>Module2</code>:</p>\n\n<pre><code>Sub DoSomething()\n    'do something\nEnd Sub\n</code></pre>\n\n<p>To correctly resolve references to <code>DoSomething</code> inside <code>Module1</code>, you need to check whether the call is qualified (e.g. <code>Module2.DoSomething</code> will call the procedure inside <code>Module2</code> - an unqualified call will call the procedure inside <code>Module1</code>).</p>\n\n<p>Resolving identifier references is something I've spent pretty much an entire year refining the code for, <em>and it's still not perfect</em> (although it now resolves crazy ambiguous code you wouldn't even think is legal VBA) - doing that in plain VBA is suicidal at best.</p>\n\n<p>Eventually we'll expose a COM API that will allow Rubberduck users to write VBA code something like this completely hypothetical code:</p>\n\n<pre><code>For Each declaration In RubberduckParserState.UserDeclarations\n    If declaration.DeclarationType = Procedure And declaration.ParentScope = \"VBAProject.Module1\" Then\n        For Each reference In declaration.References\n            Debug.Print declaration.IdentifierName \" used in \" &amp; reference.ToString\n        Next\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 6053799, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a7caccb567e3664244bcd555c895904c?s=128&d=identicon&r=PG&f=1", "display_name": "Ali_R4v3n", "link": "https://stackoverflow.com/users/6053799/ali-r4v3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1458754327, "creation_date": 1458750544, "question_id": 36183657, "link": "https://stackoverflow.com/questions/36183657/vba-show-references-to-other-procedures", "title": "vba Show references to other procedures", "body": "<p>Today i want to ask this question.\nsay i have a module and in that module i call different procedures (subs or function ) which are located in other modules, how can i list all the procedure names and their module or class in a simple way in case i wanted to copy those procedures to the current module and delete these modules.\nthanks</p>\n\n<p>i don't know how to achieve that but here is a dummy code</p>\n\n<pre><code>for each UserDefinedProcedure in UserProcuduresCollection\nif UserDefinedProcedure.Name (is Found in this module) then\ndebug.print UserDefinedProcedure.Name\nend if \nnext \n</code></pre>\n"}, {"tags": ["database", "vba", "excel", "combobox"], "owner": {"reputation": 93, "user_id": 2619784, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7867abed849510e0f9a7d0a79a4ae19d?s=128&d=identicon&r=PG", "display_name": "Jacob Deskin", "link": "https://stackoverflow.com/users/2619784/jacob-deskin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458754741, "creation_date": 1458750118, "last_edit_date": 1458754741, "question_id": 36183489, "link": "https://stackoverflow.com/questions/36183489/fill-excel-populate-active-x-comobo-box-from-microsoft-sql-management-studio-d", "title": "Fill Excel + populate active x comobo box from Microsoft Sql Management Studio database table", "body": "<p>I have an excel file I am trying to pull values in from a Microsoft SQL Database. I am trying to add values from a table using the table's ID and string value associated with that ID. I have run into an invalid argument error. I was able to add the xlVal if i declared the integer value and set the first item = 0, then i could add 1 to the xlVal to make each integer value unique but these values won't allow me to reference the specific row in the database if i want to pull the values back to update the database. Basically i am wondering if there is a way to set the pvargindex value = to my database ID value since i don't have an integer in my database starting with 0. I also tried adding a row (select type..., 0) before the loop ran but i was unable to get this to work either.</p>\n\n<pre><code>Private Sub populateType()\nDim dbName As Object\nDim dbResults As Object\nSet dbName = CreateObject(\"ADODB.Connection\")\nSet dbName = openDBConn(\"./System\", \"System\")\nSet dbResults = dbName.Execute(\"SELECT ID_Type, Type FROM Const_Type WHERE Active = 1 AND Type &lt;&gt; 'N/A' ORDER BY Type\")\n\nSheet1.ComboBox1.Clear\n\nDo While Not dbResults.EOF\n\n    Dim xlStr As String\n    xlStr = dbResults(\"Type\").Value\n    Dim xlVal as integer \n    xlVal = dbResults(\"ID_Type\").Value\n\n    Sheet1.ComboBox1.AddItem xlStr, xlVal\n\n    dbResults.MoveNext\n\nLoop\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["arrays", "vba", "excel", "macros"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1458750354, "post_id": 36183472, "comment_id": 60002504, "body": "You are confusing a <b><i>String</i></b> and a <b><i>Workbook</i></b> object.  <code>Set ArrayCM = Activeworkbook.Sheets(Array(&quot;CM YTD&quot;, &quot;CM MTD&quot;, &quot;CM Refurb&quot;, &quot;TBM Local&quot;, &quot;PSM&quot;))</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458750433, "post_id": 36183472, "comment_id": 60002550, "body": "<code>Workbooks(curWB)</code> not just <code>curWB</code>"}, {"owner": {"reputation": 23, "user_id": 5823482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880b444ae1c15905c0ac7739f4ccb6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce ", "link": "https://stackoverflow.com/users/5823482/bruce"}, "edited": false, "score": 0, "creation_date": 1458751974, "post_id": 36183472, "comment_id": 60003620, "body": "I&#39;ve tried both of these and neither worked. I want define the &quot;Parent Workbook&quot; so that I can copy worksheets to the children workbooks."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5823482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880b444ae1c15905c0ac7739f4ccb6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce ", "link": "https://stackoverflow.com/users/5823482/bruce"}, "edited": false, "score": 0, "creation_date": 1458827970, "post_id": 36185152, "comment_id": 60037286, "body": "It gives me an error every time I run <code>With cwb.Worksheets(Array(&quot;Sheet1&quot;, &quot;Sheet3&quot;, &quot;Sheet5&quot;))</code> Only thing I changed was the name to the worksheets that I want in the array. Would I refer to this Array as &quot;wss&quot; correct?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1458755003, "creation_date": 1458755003, "answer_id": 36185152, "question_id": 36183472, "link": "https://stackoverflow.com/questions/36183472/tying-an-array-of-worksheets-to-a-specific-workbook/36185152#36185152", "title": "Tying an Array of worksheets to a specific workbook", "body": "<p>You can create a worksheet type var as an array, redim it and assign each element within the array to a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194464.aspx\" rel=\"nofollow\">Worksheet Object</a>.</p>\n\n<pre><code>Sub manyWSs()\n    Dim w As Long\n    Dim cwb As Workbook\n    Dim wss() As Worksheet\n\n    Set cwb = ThisWorkbook\n\n    With cwb.Worksheets(Array(\"Sheet1\", \"Sheet3\", \"Sheet5\"))\n        ReDim wss(1 To .Count)\n        For w = 1 To .Count\n            Debug.Print .Item(w).Name\n            Set wss(w) = .Item(w)\n        Next w\n    End With\n\n    For w = LBound(wss) To UBound(wss)\n        Debug.Print wss(w).Cells(1, 1).Address(0, 0, external:=True)\n    Next w\nEnd Sub\n</code></pre>\n\n<p>The <code>Worksheets(Array(\"Sheet1\", \"Sheet3\", \"Sheet5\"))</code> is not a true <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224508(v=office.11).aspx\" rel=\"nofollow\">Worksheets collection</a> so <code>.Item(w)</code> is used to pick out the pieces. Once each piece has been <code>Set</code>, all the properties, methods and members of a single <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194464.aspx\" rel=\"nofollow\">Worksheet Object</a> are available to each piece of the array with full parent <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835568.aspx\" rel=\"nofollow\">Workbook object</a> association.</p>\n"}], "owner": {"reputation": 23, "user_id": 5823482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880b444ae1c15905c0ac7739f4ccb6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce ", "link": "https://stackoverflow.com/users/5823482/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458755003, "creation_date": 1458750054, "question_id": 36183472, "link": "https://stackoverflow.com/questions/36183472/tying-an-array-of-worksheets-to-a-specific-workbook", "title": "Tying an Array of worksheets to a specific workbook", "body": "<p>The goal of my macro is from a large set of data, divide the data into separate workbooks for each product. After I paste only the specific data into the file, I want to copy 5 separate worksheets from the workbook with all of the data, each worksheet with a pivot table on them, set the data on the pivot table to the data on the spread sheet that I copied over previously. Then refresh the pivot tables.</p>\n\n<p>My biggest question is how to I name an array of worksheets to a work book</p>\n\n<pre><code>Dim cell As Range, DataRng As Range\nDim curPath As String, curWB As String, newWB\nDim ArrayCM As Variant\nDim InxW As Long\nDim xTable As PivotTable\n\ncurPath = ActiveWorkbook.Path &amp; \"\\\"\ncurWB = ActiveWorkbook.Name\n'Array of worksheets to be copied over for Company Manger\nSet ArrayCM = curWB.Sheets(Array(\"CM YTD\", \"CM MTD\", \"CM Refurb\", \"TBM Local\", \"PSM\")) \n--This Gives me an error\n</code></pre>\n\n<p>Because I'm going to creating several workbooks, I want to define my array to copy over from the master file to the new file. Help on this would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1458749944, "post_id": 36183327, "comment_id": 60002225, "body": "Look at <code>Application.Getopenfilename</code> to allow the user to choose the template to use."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458755531, "post_id": 36183327, "comment_id": 60005954, "body": "another option is to have the user enter the file path in a cell and reference that cell for the template file to use"}, {"owner": {"reputation": 179, "user_id": 5980502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rXShz.jpg?s=128&g=1", "display_name": "larsoevlisen", "link": "https://stackoverflow.com/users/5980502/larsoevlisen"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1459234994, "post_id": 36183327, "comment_id": 60181471, "body": "@Rory. Thank you for both of your inputs. I ended up using the example of <code>Application.Getopenfilename</code> provided here: <a href=\"https://msdn.microsoft.com/en-us/library/office/hh710200(v=office.14).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>. Combined with in-workbook button objects, the end-users are comfortable working with the solution. Do I accept your answer (Rory) or do I post my complete code and accept myself?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1459236798, "post_id": 36183327, "comment_id": 60182557, "body": "Post your code and accept that. Mine was just a comment rather than a complete answer"}], "answers": [{"tags": [], "owner": {"reputation": 179, "user_id": 5980502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rXShz.jpg?s=128&g=1", "display_name": "larsoevlisen", "link": "https://stackoverflow.com/users/5980502/larsoevlisen"}, "is_accepted": true, "score": -1, "last_activity_date": 1557396047, "last_edit_date": 1557396047, "creation_date": 1459239894, "answer_id": 36279063, "question_id": 36183327, "link": "https://stackoverflow.com/questions/36183327/taking-user-input-for-selecting-chart-template-in-excel/36279063#36279063", "title": "Taking user input for selecting Chart Template in Excel", "body": "<p><strong>EDIT</strong>: I ended up using <code>Application.GetOpenFilename</code> and passing that output as a string for <code>ApplyChartTemplate</code></p>\n\n<p>This is the final code: (Note \"PATH_TO_DIR\" needs changing to whatever (if any) custom path you would like to utilize)</p>\n\n<pre><code>Sub Select_File_Or_Files_Windows()\n    Dim SaveDriveDir As String\n    Dim MyPath As String\n    Dim Fname As String\n    Dim i As Long\n    Dim LastRow As Long\n    Dim LastColumn As Long\n    Dim chrt As Chart\n\n    ' Save the current directory.\n    SaveDriveDir = CurDir\n\n    ' Set the path to the folder that you want to open.\n    ' MyPath = Application.DefaultFilePath\n\n    ' You can also use a fixed path.\n    MyPath = \"PATH_TO_DIR\"\n\n    ' Change drive/directory to MyPath.\n    ChDrive MyPath\n    ChDir MyPath\n\n    ' Open GetOpenFilename with the file filters.\n    Fname = Application.GetOpenFilename\n\n    ' Change drive/directory back to SaveDriveDir.\n    ChDrive SaveDriveDir\n    ChDir SaveDriveDir\n\n    'Find the last used row\n    LastRow = Sheets(\"Ark1\").Range(\"A65536\").End(xlUp).Row\n\n    'Find the last used column\n    LastColumn = Sheets(\"Ark1\").Range(\"A1\").End(xlToRight).Column\n\n    'Looping from second row till last row which has the data\n    For i = 2 To LastRow\n        'Sheet 2 is selected bcoz charts will be inserted here\n        Sheets(\"Ark2\").Select\n\n        'Clear cell selection\n        Cells(1, 1).Select\n\n        'Adds chart to the sheet\n        Set chrt = Sheets(\"Ark2\").Shapes.AddChart.Chart\n        'sets the chart type\n        chrt.ChartType = xlColumnClustered\n        chrt.ApplyChartTemplate (CStr(Fname))\n\n        'now the line chart is added...setting its data source here\n        With Sheets(\"Ark1\")\n            chrt.SetSourceData Source:=.Range(.Cells(i, 1), .Cells(i, LastColumn))\n            chrt.SeriesCollection(1).XValues = \"='Ark1'!$B$1:$G$1\"\n        End With\n\n        'Left &amp; top are used to adjust the position of chart on sheet\n        chrt.ChartArea.Left = 1\n        chrt.ChartArea.Top = (i - 2) * chrt.ChartArea.Height\n\n        Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 5980502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rXShz.jpg?s=128&g=1", "display_name": "larsoevlisen", "link": "https://stackoverflow.com/users/5980502/larsoevlisen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 36279063, "answer_count": 1, "score": 0, "last_activity_date": 1560028132, "creation_date": 1458749685, "last_edit_date": 1560028132, "question_id": 36183327, "link": "https://stackoverflow.com/questions/36183327/taking-user-input-for-selecting-chart-template-in-excel", "title": "Taking user input for selecting Chart Template in Excel", "body": "<p>I've a rudimentary solution for creating Excel charts per row of data.</p>\n\n<p>I have the following code (\"ark\" = \"sheet\"):</p>\n\n<pre><code>Sub CreateColumnClustered()\n       'variable declaration\n        Dim i As Long\n        Dim LastRow As Long\n        Dim LastColumn As Long\n        Dim chrt As Chart\n\n        'last row used\n        LastRow = Sheets(\"Ark1\").Range(\"A65536\").End(xlUp).Row\n\n        'last column used\n        LastColumn = Sheets(\"Ark1\").Range(\"A1\").End(xlToRight).Column\n\n        'Looping from row nr. 2 to last row\n        For i = 2 To LastRow\n            'Select Ark 2 where charts will be inserted\n            Sheets(\"Ark2\").Select\n\n            'Clear cell selection\n            Cells(1, 1).Select\n\n            'Add charts to ark\n            Set chrt = Sheets(\"Ark2\").Shapes.AddChart.Chart\n            'chart type\n            chrt.ChartType = xlColumnClustered\n            'chart template\n            chrt.ApplyChartTemplate ( _\n            \"PATH_TO_CHART_TEMPLATE\")\n\n            'establish data source\n            With Sheets(\"Ark1\")\n                chrt.SetSourceData Source:=.Range(.Cells(i, 1), .Cells(i, LastColumn))\n                chrt.SeriesCollection(1).XValues = \"='Ark1'!$B$1:$G$1\"\n            End With\n\n            'anchor position of charts\n            chrt.ChartArea.Left = 1\n            chrt.ChartArea.Top = (i - 2) * chrt.ChartArea.Height\n\n            Next\n\n    End Sub\n</code></pre>\n\n<p>This works for the users, except they are unable to specify their own templates.</p>\n\n<p>I am looking for a way for the user to specify their own .crtx file.</p>\n\n<p>I would like to avoid multiple macros, each with their own hardcoded template file.</p>\n"}, {"tags": ["excel", "macros", "vba"], "comments": [{"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1458753641, "post_id": 36182973, "comment_id": 60004732, "body": "Are you trying to highlight a cell, or just the keyword within the cell?"}, {"owner": {"reputation": 1, "user_id": 6105225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b0b5d81cdccc113332d98b567f5b4e?s=128&d=identicon&r=PG&f=1", "display_name": "Genti Borici", "link": "https://stackoverflow.com/users/6105225/genti-borici"}, "reply_to_user": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1458817056, "post_id": 36182973, "comment_id": 60030304, "body": "Just the keywords for every cell that they might occur."}], "owner": {"reputation": 1, "user_id": 6105225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b0b5d81cdccc113332d98b567f5b4e?s=128&d=identicon&r=PG&f=1", "display_name": "Genti Borici", "link": "https://stackoverflow.com/users/6105225/genti-borici"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1458749004, "answer_count": 0, "score": 0, "last_activity_date": 1458809534, "creation_date": 1458748744, "last_edit_date": 1531161705, "question_id": 36182973, "link": "https://stackoverflow.com/questions/36182973/macro-for-highlighting-and-bold-multiplte-instances-excel-2010-from-a-list-of", "closed_reason": "Duplicate", "title": "Macro for Highlighting and Bold multiplte instances (excel 2010) from a list of Keywords", "body": "<p>I tried to use a similar macro posted on this [topic][1]. However, when I modified to use it for a scenario that covers a list of keywords in column A (A1:A36) while the search has to be applied on every cell of Column B (B2:B100) and highlight in red and bold the words that are found in the Column B. Below is the modified macro that I used:  </p>\n\n<pre><code>  Dim cl As Range\n  Dim startPos As Integer\n  Dim totalLen As Integer\n  Dim searchText As String\n  Dim endPos As Integer\n  Dim testPos As Integer\n\n ' specify text to search.\n  searchText = \"system integration configuration IT\"\n\n ' loop trough all cells in selection/range\n  For Each cl In Selection\n\n  totalLen = Len(searchText)\n  startPos = InStr(cl, searchText)\n  testPos = 0\n\n  Do While startPos &gt; testPos\n  With cl.Characters(startPos, totalLen).Font\n   .FontStyle = \"Bold\"\n   .ColorIndex = 3\n  End With\n\n   endPos = startPos + totalLen\n   testPos = testPos + endPos\n   startPos = InStr(testPos, searchText)\n   Loop\n\n    Next cl\n\n   End Sub\n</code></pre>\n\n<p>Thanks </p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1458748877, "post_id": 36182954, "comment_id": 60001391, "body": "If you don&#39;t know what it is called, don&#39;t know what its ordinal in the collection is, never set a workbook object variable when you opened it and cannot identify it by looping through all workbooks looking for a unique property then no, you will never reliably know where the second workbook is."}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1458748986, "post_id": 36182954, "comment_id": 60001478, "body": "Are you saying that the workbook you need to reference without using a name is the one that contains the macro? If so, you can use <code>Thisworkbook</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1458759558, "post_id": 36182954, "comment_id": 60008318, "body": "you could ask them to select/activate the open workbook, but of course that&#39;s leaving room for more user-error, which you&#39;d have to trap and validate the structure of the workbook is consistent with your procedure&#39;s expectations, etc.... The better way to do this is to have the macro <i>open</i> the workbook for you, you can use the <code>FileDialog</code> to allow the user to select the workbook."}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1458759968, "last_edit_date": 1458759968, "creation_date": 1458750216, "answer_id": 36183533, "question_id": 36182954, "link": "https://stackoverflow.com/questions/36182954/how-do-i-reference-a-workbook-not-using-the-workbooks-name/36183533#36183533", "title": "how do I reference a workbook not using the workbook&#39;s name?", "body": "<p>If it's the <strong><em>only</em></strong> other workbook open, then you can use something like and will be fairly reliable:</p>\n\n<pre><code>Function GetOtherWorkbook(sheetName$)\nDim wb as Workbook\nDim ws as Worksheet\nFor Each wb in Workbooks\n    If Not wb = ThisWorkbook Then\n        For Each ws in wb.Worksheets\n            If ws.Name = sheetName Then\n                Set GetOtherWorkbook = wb\n                GoTo EarlyExit\n            End If\n        Next\n    End If\nNext\nMsgBox sheetName &amp; \" not found in any open workbook.\", vbCritical\nSet GetOtherWorkbook = Nothing\nEarlyExit:\nExit Function\n</code></pre>\n\n<p>Then use this function to return <code>otherWB</code> as the variable for the other workbook:</p>\n\n<pre><code>Set otherWB = GetOtherWorkbook(\"some sheet name\")\n\nIf otherWB Is Nothing Then \n    Exit Sub\nElse\n    'Do stuff...\nEnd If\n</code></pre>\n\n<p>Otherwise no, you cannot <em>reliably</em> reference another workbook without knowing the name or it's index in the <code>Workbooks</code> collection. </p>\n\n<p><strong>NOTE</strong> If there are other open workbooks, then this method may return false positive if multiple workbooks contain the same sheet name.</p>\n"}], "owner": {"reputation": 17, "user_id": 6105202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5dbc6bdfb6d5b6b0d306335ee5c7363?s=128&d=identicon&r=PG&f=1", "display_name": "Leah Wang", "link": "https://stackoverflow.com/users/6105202/leah-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 0, "closed_date": 1458764949, "answer_count": 1, "score": 0, "last_activity_date": 1458759968, "creation_date": 1458748689, "question_id": 36182954, "link": "https://stackoverflow.com/questions/36182954/how-do-i-reference-a-workbook-not-using-the-workbooks-name", "closed_reason": "Not suitable for this site", "title": "how do I reference a workbook not using the workbook&#39;s name?", "body": "<p>I need to write a macro in one workbook, but in that marco I need to tell it to go to another workbook to copy some data and paste in the workbook that has the macro in, now I have a problem of referencing the other workbook because the name of that workbook will always be different, but the sheet I am copying from will always has the same name. Is there a simply way to ask Macro to always grab the data from the correct openbook without using the name of the workbook?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1458749526, "post_id": 36182823, "comment_id": 60001905, "body": "That you Alex, this worked perfectly, and it runs so fast! Really Appreciate the help!"}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1458753611, "post_id": 36182823, "comment_id": 60004707, "body": "You are welcome. Good luck with your project. Best regards,"}], "tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": true, "score": 1, "last_activity_date": 1458748649, "last_edit_date": 1458748649, "creation_date": 1458748327, "answer_id": 36182823, "question_id": 36182467, "link": "https://stackoverflow.com/questions/36182467/vba-loop-through-sheet-and-check-accuracy/36182823#36182823", "title": "VBA Loop through sheet and check accuracy", "body": "<p>Your VBA code snippet does not comply with the business logic as described: you must loop through all matching rows in the range to find out if all cells in the Column \"W\" contain value. It may be achieved by using auxiliary <code>Boolean</code> var <code>ok</code>, like shown below:</p>\n\n<pre><code>Dim ok as boolean\nok = True\nFor add_WIR_check = 3 To lastRow_WIR\nIf sheets(\"Works Instruction Record\").cells(add_WIR_check, 1) = address_Check Then\n    If Not (sheets(\"Works Instruction Record\").cells(add_WIR_check, 23) &lt;&gt; \"\") Then\n        ok = False\nEnd If\nEnd If\nNext add_WIR_check\n</code></pre>\n\n<p>Upon completion, the var <code>ok</code> value will indicate if all cells in Column \"W\" of the matching rows contain values.</p>\n\n<p>Hope this may help.</p>\n"}], "owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 36182823, "answer_count": 1, "score": 1, "last_activity_date": 1458765493, "creation_date": 1458747356, "last_edit_date": 1458765493, "question_id": 36182467, "link": "https://stackoverflow.com/questions/36182467/vba-loop-through-sheet-and-check-accuracy", "title": "VBA Loop through sheet and check accuracy", "body": "<p>I am trying to get a loop to work. </p>\n\n<p>What i need to happen is to loop over a sheet and if address matches in column A does column W have a value, if all instances of address have values in column W then <code>GoTo end_nothing</code>. If only some matches have data in column W then continue with sub.</p>\n\n<p>The problem I am having with my code is that the first entry it matches, it exits the sub without looping over the rest.</p>\n\n<p>My Code:</p>\n\n<pre><code>Private Sub CommandButton3_Click()\nDim add_WIR_check, lastRow_WIR As Long\nDim address_Check  As String: address_Check = sheets(\"Auto Checklist\").cells(3, 2).value\n\nlastRow_WIR = sheets(\"Works Instruction Record\").cells(Rows.count, \"A\").End(xlUp).Row\n\n***** Unprotect Sheet\n\nFor add_WIR_check = 3 To lastRow_WIR\nIf sheets(\"Works Instruction Record\").cells(add_WIR_check, 1) = address_Check Then\n    If sheets(\"Works Instruction Record\").cells(add_WIR_check, 23) &lt;&gt; \"\" Then\n        GoTo end_nothing\n    End If\nEnd If\nNext add_WIR_check\n\n***** Additional code here\n\nend_nothing:\n***** Protect sheet\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "object", "ms-access", "oledb"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1458747497, "post_id": 36182343, "comment_id": 60000329, "body": "We don&#39;t need to see a screenshot of the error message.  When you encounter that error, go into debug mode, and paste this highlighted text as one line in the Immediate window and press enter at the end of that line: <code>Debug.Print err.Number; err.Description</code>  You can copy the output from <code>Debug.Print</code> and paste it into your question."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458748848, "post_id": 36182343, "comment_id": 60001372, "body": "...or Ctrl+C will typically copy the text of the message box to the clipboard"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6105021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb888ca7dd900598dabd51ba2aed1209?s=128&d=identicon&r=PG&f=1", "display_name": "crawfojk", "link": "https://stackoverflow.com/users/6105021/crawfojk"}, "edited": false, "score": 0, "creation_date": 1458752375, "post_id": 36182705, "comment_id": 60003916, "body": "Thanks for your response, i do have a couple of other questions.  Firstly, if the code above is being executed from excel i.e excel is open, surely the dynamic range would be resolved?  Unless I completely mis-understanding the point.  Secondly, if i change the named range toa static named range, I still see the same error message.    I think i&#39;m slowly coming to the conclusion that it maybe best just to stick with referencing the range by columns and rows."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 6105021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb888ca7dd900598dabd51ba2aed1209?s=128&d=identicon&r=PG&f=1", "display_name": "crawfojk", "link": "https://stackoverflow.com/users/6105021/crawfojk"}, "edited": false, "score": 0, "creation_date": 1458754473, "post_id": 36182705, "comment_id": 60005302, "body": "It should work with a static range. But perhaps it doesn&#39;t like that the file is already opened? Can you import from another (closed) file? Also, it appears to me as if you <i>cross the creek to get water</i> ... why not just loop the range and add the values to a recordset?"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1458747982, "creation_date": 1458747982, "answer_id": 36182705, "question_id": 36182343, "link": "https://stackoverflow.com/questions/36182343/access-database-engine-could-not-find-object-object-is-excel-named-range/36182705#36182705", "title": "Access Database Engine could not find object - object is Excel named range", "body": "<p>I learned this the hard way. A <em>dynamic range</em> is resolved only when Excel runs, thus it doesn't exist when you just read the file. </p>\n\n<p>Only a saved and fixed Named Range can be read by Access.</p>\n"}], "owner": {"reputation": 1, "user_id": 6105021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb888ca7dd900598dabd51ba2aed1209?s=128&d=identicon&r=PG&f=1", "display_name": "crawfojk", "link": "https://stackoverflow.com/users/6105021/crawfojk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458748115, "creation_date": 1458747015, "last_edit_date": 1458748115, "question_id": 36182343, "link": "https://stackoverflow.com/questions/36182343/access-database-engine-could-not-find-object-object-is-excel-named-range", "title": "Access Database Engine could not find object - object is Excel named range", "body": "<p>This is something that has had me going round and round in circles for a while now, essentially all I would like to do is to insert the values of an Excel dynamic range into an Access table.</p>\n\n<p>I have had success in doing this by referencing the range as  for example, however to make things a little more self sufficient I would prefer to use a dynamic range.</p>\n\n<p>The code I have is as follows:</p>\n\n<pre><code>Sub ExportDistDatatoSql()\n\nDim cn As ADODB.Connection\nDim STRQUERY As String\n\nSet cn = New ADODB.Connection\n\nWith cn\n.Provider = \"Microsoft.ACE.OLEDB.12.0\"\n.ConnectionString = \"Data Source=\" &amp; ThisWorkbook.Path &amp; \"\\uMyDB.accdb;\"\n.Open\nEnd With\n\nssql = \"INSERT INTO Crude_Prods_DB Select * from [Excel 12.0;HDR=YES;DATABASE=C:\\TEST\\mysheet.xlsm].[n_range]\"\n\ncn.Execute ssql\n\nEnd Sub\n</code></pre>\n\n<p>The error I am seeing is attached and I have checked an [n_range] does exist in the workbook.</p>\n\n<p>[error seen when attempting to insert data into access table from excel named range]</p>\n\n<p>Any suggestions would be much appreciated.</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "edited": false, "score": 0, "creation_date": 1458747231, "post_id": 36182159, "comment_id": 60000113, "body": "Check out the function datevalue"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1458750455, "post_id": 36183094, "comment_id": 60002558, "body": "Good point about the previously converted dates being wrong. In the supplied image all of the left-aligned text are in MDY and the ones that converted (right-aligned) are ambiguously DMY/MDY and have been converted wrong."}, {"owner": {"reputation": 79, "user_id": 5395204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c8ca36b98c8300fe87901695b596556?s=128&d=identicon&r=PG&f=1", "display_name": "wavestone", "link": "https://stackoverflow.com/users/5395204/wavestone"}, "edited": false, "score": 0, "creation_date": 1459051909, "post_id": 36183094, "comment_id": 60117662, "body": "Hello Ron, I work for a very big company due to that sometimes i get information from other teams that i cannot control the quality or other reasons for inconsistency of data :) in this case the column that contains the dates came as is like that ( partially texted as in this format 3/21/16 8:54:42 PM and sometimes as a real date 07/07/2015  08:08:04 ) I have to say both cases came out of the same system which makes it odd but still yet i have to deal with it some how,  im working on automation now, that actually is already done but this little problem, I was looking for a way to use vba:)"}, {"owner": {"reputation": 79, "user_id": 5395204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c8ca36b98c8300fe87901695b596556?s=128&d=identicon&r=PG&f=1", "display_name": "wavestone", "link": "https://stackoverflow.com/users/5395204/wavestone"}, "edited": false, "score": 0, "creation_date": 1459051985, "post_id": 36183094, "comment_id": 60117677, "body": "my code is in vb so far, i managed to solve it though the excel GUI but it will required me to do this in 2 phases and im trying to avoid it"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 79, "user_id": 5395204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c8ca36b98c8300fe87901695b596556?s=128&d=identicon&r=PG&f=1", "display_name": "wavestone", "link": "https://stackoverflow.com/users/5395204/wavestone"}, "edited": false, "score": 0, "creation_date": 1459073935, "post_id": 36183094, "comment_id": 60122213, "body": "@wavestone I see you have marked a previous response as the Answer. I am glad you have a solution that works.  Just be sure that dates which could be interpreted as being either MDY or DMY (e.g. 3/8/2015 could be either 8-Mar-2015  or 3-Aug-2015) are being properly converted."}, {"owner": {"reputation": 79, "user_id": 5395204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c8ca36b98c8300fe87901695b596556?s=128&d=identicon&r=PG&f=1", "display_name": "wavestone", "link": "https://stackoverflow.com/users/5395204/wavestone"}, "edited": false, "score": 0, "creation_date": 1459078591, "post_id": 36183094, "comment_id": 60123413, "body": "Hello Ron, yea it did land perfectly, the code was perfect i just made little modifications in sense of where to copy and what to override, thx for the tips :)"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1458749731, "last_edit_date": 1458749731, "creation_date": 1458749063, "answer_id": 36183094, "question_id": 36182159, "link": "https://stackoverflow.com/questions/36182159/vba-converting-a-mixed-row-data-type-wise-to-date/36183094#36183094", "title": "VBA - Converting a mixed row ( Data Type wise) to Date", "body": "<p>Excel has parsed the dates according to your Windows Regional Settings short date format.  Those that it could not parse (where the month>12) it left as text.  Since there was initially a difference between the date format in the text file, and the date format in your Windows Regional settings, it is likely that many of the dates that appear as dates (or as unformatted numbers) were converted incorrectly.</p>\n\n<p>You have a few options:</p>\n\n<ol>\n<li><code>Import</code> the text file using the <code>Get External Data</code> tab <code>From Text</code> option on the <code>Data Ribbon</code>.  This will open up the text import wizard and allow you to specify the date format of the data being imported.</li>\n<li>Change your Windows Regional settings short date format to match that in the text file.</li>\n</ol>\n\n<p>Those are probably the two simplest options.  The first can be automated through VBA.  The second, not so much.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 5395204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c8ca36b98c8300fe87901695b596556?s=128&d=identicon&r=PG&f=1", "display_name": "wavestone", "link": "https://stackoverflow.com/users/5395204/wavestone"}, "edited": false, "score": 0, "creation_date": 1459053041, "post_id": 36183950, "comment_id": 60117849, "body": "im writing it again  :   Hi Dani, thx for the efforts I appreciate it, it works nice nice :) this code suppose to go between other Code I already wrote in order to complete the automation im working on, i have a question: how can i change the function to aim to column B from the  2nd ( B2)  to the end of columns, and copy the modified cell to the parallel cell on column C ? is it possible if the cell is already a date format simply copy the cell as is to  columns C ? last question - is it possible to make the selection automatically without a user interfering ? so far the code is so great :)"}, {"owner": {"reputation": 79, "user_id": 5395204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c8ca36b98c8300fe87901695b596556?s=128&d=identicon&r=PG&f=1", "display_name": "wavestone", "link": "https://stackoverflow.com/users/5395204/wavestone"}, "edited": false, "score": 0, "creation_date": 1459055372, "post_id": 36183950, "comment_id": 60118226, "body": "Hi Dani, I made all the changes is works like a charm now :) i simply copied the column as is than ran you function and it override the text based cells, its a great solution for me im so thank full :) i have just last minor modification and i would like to add, if i want to keep your function as is with just a minor modification, auto select cells B2 to end of column instead of manually select it ? is it possible ? thx Gal"}], "tags": [], "owner": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "is_accepted": true, "score": 1, "last_activity_date": 1459257170, "last_edit_date": 1459257170, "creation_date": 1458751312, "answer_id": 36183950, "question_id": 36182159, "link": "https://stackoverflow.com/questions/36182159/vba-converting-a-mixed-row-data-type-wise-to-date/36183950#36183950", "title": "VBA - Converting a mixed row ( Data Type wise) to Date", "body": "<p>Assuming wvery bad dates are MM/DD/YYYY, then you could use the following code that I wrote for you:</p>\n\n<pre><code>   Sub main()\n\n    Dim celda As Range\n    Dim s_date As String\n    Dim s_time As String\n    Dim validate_date As String\n    Dim valid_date As String\n    Dim date_arr() As String\n    Dim rango As Range\n    Dim limit As Long\n\n    limit = Columns(\"B\").Find(\"\", Cells(Rows.Count, \"B\")).Row - 1\n    Set rango = ActiveSheet.Range(\"B2:B\" &amp; limit)\n\n\n    ' works only for date values, another value would return non expected values\n    For Each celda In rango\n        validate_date = Left(celda.Value, 1)\n        If validate_date &lt;&gt; \"\" Then\n            If Not celda.Rows.Hidden Then\n                If validate_date &lt;&gt; \"0\" Then\n                    s_date = Trim(Mid(celda.Value, 1, InStr(1, celda.Value, \" \") - 1))\n                    s_time = Trim(Mid(celda.Value, InStr(1, celda.Value, \" \"), Len(celda.Value) - InStr(1, celda.Value, \" \")))\n\n                    date_arr = Split(s_date, \"/\")\n\n                    valid_date = date_arr(1)\n                    valid_date = valid_date &amp; \"/0\" &amp; date_arr(0)\n                    valid_date = valid_date &amp; \"/\" &amp; date_arr(2)\n                    valid_date = valid_date &amp; \" \" &amp; s_time\n\n                    celda.Offset(0, 1).Value = CDate(valid_date)\n                End If\n            End If\n        End If\n    Next celda\n\nEnd Sub\n</code></pre>\n\n<p>In order to use this code you should insert one empty column to the right from target. Second, you should to select entire C column and run the macro.</p>\n\n<p><strong>Edit 1.</strong> Ok, this macro autoselect column B. Select column dates is not necessary now. </p>\n"}], "owner": {"reputation": 79, "user_id": 5395204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c8ca36b98c8300fe87901695b596556?s=128&d=identicon&r=PG&f=1", "display_name": "wavestone", "link": "https://stackoverflow.com/users/5395204/wavestone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 1, "accepted_answer_id": 36183950, "answer_count": 2, "score": 0, "last_activity_date": 1459257170, "creation_date": 1458746583, "question_id": 36182159, "link": "https://stackoverflow.com/questions/36182159/vba-converting-a-mixed-row-data-type-wise-to-date", "title": "VBA - Converting a mixed row ( Data Type wise) to Date", "body": "<p>I have an excel sheet, one of the columns is mixed with Dates and Dates that has been copied to it as text ( see below ).</p>\n\n<p>I dont manage to convert the text type to Date type, i need to do it though VBA to add it to some automation im working on. is there a way to do this at all ?</p>\n\n<p>I noticed excel is looking for format like this 03/09/2016  23:39:57  and it doesn't like 3/21/16 11:07:22 PM, apparently  this is my case :) every look i run i get ( obviously data mismatch ), in the image bellow the spoken column is \"C\"</p>\n\n<p>thx :)</p>\n\n<p><a href=\"http://i.stack.imgur.com/JdFOP.jpg\" rel=\"nofollow\">ExcelSheet bad Date  format</a></p>\n"}, {"tags": ["macos", "vba", "excel", "runtime"], "comments": [{"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 1, "creation_date": 1458753334, "post_id": 36182118, "comment_id": 60004549, "body": "Have you thought about using the <code>.Find</code> and <code>.FindNext</code> methods? It is more efficient than looping. See <a href=\"http://www.siddharthrout.com/2011/07/14/find-and-findnext-in-excel-vba/\" rel=\"nofollow noreferrer\">here</a> for good examples"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1458813806, "post_id": 36182118, "comment_id": 60028384, "body": "and if you use <code>If instr(scd.Cells(i, j).value,Search)&gt;0 Then</code> instead of <code>If scd.Cells(i, j) Like &quot;*&quot; &amp; Search &amp; &quot;*&quot; Then</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": false, "score": 0, "last_activity_date": 1458768171, "creation_date": 1458768171, "answer_id": 36188938, "question_id": 36182118, "link": "https://stackoverflow.com/questions/36182118/excel-vba-run-time-error-7-out-of-memory/36188938#36188938", "title": "Excel VBA: Run time error 7: Out of Memory", "body": "<p>I created an alternate function called \"aLike\" below.\nIn your code you would use it by saying: <code>If aLike(\"*\" &amp; Search &amp; \"*\",scd.Cells(i, j)) Then</code>\nI can't guarantee it works exactly the same way, but I would be interested to see if the Mac can process this function better than \"like\".</p>\n\n<pre><code>Function aLike(asterixString As Variant, matchString As Variant, Optional MatchCaseBoolean As Boolean) As Boolean\n\n    Dim aStr As Variant, mStr As Variant, aStrList As New Collection\n    Dim i As Long, aPart As Variant, mPart As Variant, TempInt As Long, aStart As Boolean, aEnd As Boolean\n\n    aStr = asterixString: mStr = matchString\n    If Not MatchCaseBoolean Then aStr = StrConv(aStr, vbLowerCase): mStr = StrConv(mStr, vbLowerCase)\n    ' Get rid of excess asterix's\n    While InStr(aStr, \"**\") &gt; 0\n        aStr = Replace(aStr, \"**\", \"*\")\n    Wend\n\n    ' Deal with trivial case\n    If aStr = mStr Then aLike = True: GoTo EndFunction\n    If aStr = \"*\" Then aLike = True: GoTo EndFunction\n    If Len(aStr) = 0 Then aLike = False: GoTo EndFunction\n\n    ' Convert to list\n    aStart = Left(aStr, 1) = \"*\": If aStart Then aStr = Right(aStr, Len(aStr) - 1)\n    aEnd = Right(aStr, 1) = \"*\": If aEnd Then aStr = Left(aStr, Len(aStr) - 1)\n    aLike_Parts aStr, aStrList\n\n    ' Check beginning\n    If Not aStart Then\n        aPart = aStrList.Item(1)\n        If Not (aPart = Left(mStr, Len(aPart))) Then aLike = False: GoTo EndFunction\n    End If\n\n    ' Check end\n    If Not aEnd Then\n        aPart = aStrList.Item(aStrList.Count)\n        If Not (aPart = Right(mStr, Len(aPart))) Then aLike = False: GoTo EndFunction\n    End If\n\n    ' Check parts\n    mPart = mStr\n    For i = 1 To aStrList.Count\n        aPart = aStrList.Item(i): TempInt = InStr(mPart, aPart)\n        If TempInt = 0 Then aLike = False: GoTo EndFunction\n        mPart = Right(mPart, Len(mPart) - TempInt - Len(aPart) + 1)\n        If Len(mPart) = 0 And i &lt; aStrList.Count Then aLike = False: GoTo EndFunction\n    Next i\n    aLike = True\n\nEndFunction:\n    Set aStrList = Nothing\n\nEnd Function\nFunction aLike_Parts(Str As Variant, StrList As Collection) As Variant\n\n    Dim Char As String, wPart As String\n\n    For i = 1 To Len(Str)\n        Char = Mid(Str, i, 1)\n        If Char = \"*\" Then\n            StrList.Add wPart: wPart = \"\"\n            Else\n            wPart = wPart &amp; Char\n        End If\n    Next i\n    If Len(wPart) &gt; 0 Then StrList.Add wPart\n\nEnd Function\n</code></pre>\n\n<p>Good Luck!</p>\n"}, {"tags": [], "owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "is_accepted": false, "score": 0, "last_activity_date": 1458815276, "creation_date": 1458815276, "answer_id": 36197979, "question_id": 36182118, "link": "https://stackoverflow.com/questions/36182118/excel-vba-run-time-error-7-out-of-memory/36197979#36197979", "title": "Excel VBA: Run time error 7: Out of Memory", "body": "<p>@Alex P , now <code>.find</code> is NOT more efficient, for example :</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nSub SearchClientRecord()\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\n    .Calculation = xlCalculationManual\nEnd With\n\nDim Search As String\nDim Finalrow As Long\nDim SearchFinalRow As Long\nDim i&amp;, j&amp;\nDim scs As Worksheet\nDim scd As Worksheet\nDim DATA() As Variant\nDim Range_to_Copy As Range\n\nSet scs = Sheets(\"Client Search\")\nSet scd = Sheets(\"Client Database\")\n\nWith scd\n    Finalrow = .Range(\"D100000\").End(xlUp).Row\n    DATA = .Range(.Cells(19, 3), .Cells(Finalrow, 19)).Value2\nEnd With\n\nWith scs\n    .Range(\"C19:S1018\").ClearContents\n    Search = .Range(\"C12\").Value\n    SearchFinalRow = .Range(\"D100000\").End(xlUp).Row\nEnd With\n\n\nWith scd\nFor j = 3 To 19\n    For i = 19 To Finalrow\n        If InStr(DATA(i, j), Search) &gt; 0 Then\n        'If scd.Cells(i, j) Like \"*\" &amp; Search &amp; \"*\" Then\n            If Not Range_to_Copy Is Nothing Then\n                Set Range_to_Copy = Union(Range_to_Copy, .Range(.Cells(i, 3), .Cells(i, 19)))\n                'scd.Range(scd.Cells(i, 3), scd.Cells(i, 19)).Copy\n                'scs.Range(\"C100000\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n            Else\n                Set Range_to_Copy = .Range(.Cells(i, 3), .Cells(i, 19))\n            End If\n    End If\n    Next i\nNext j\nEnd With 'scd\n\nErase DATA\n\nWith scs\n\n    Range_to_Copy.Copy _\n    Destination:=.Range(\"C100000\").End(xlUp).Offset(1, 0) '.PasteSpecial xlPasteFormulasAndNumberFormats\n\n    .Range(\"C19:S1018\").Select 'this line might be superflous\n    .Range(\"$C$18:$S$1009\").RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6, 7), Header:=xlYes\n\nEnd With\n\nCall Border\nColumns(\"C:S\").HorizontalAlignment = xlCenter 'on wich worksheet ??\n\nSet Range_to_Copy = Nothing\nSet scs = Nothing\nSet scd = Nothing\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\n    .Calculation = xlCalculationAutomatic\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6105096, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153473242118803/picture?type=large", "display_name": "user6105096", "link": "https://stackoverflow.com/users/6105096/user6105096"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1458815276, "creation_date": 1458746485, "last_edit_date": 1458747174, "question_id": 36182118, "link": "https://stackoverflow.com/questions/36182118/excel-vba-run-time-error-7-out-of-memory", "title": "Excel VBA: Run time error 7: Out of Memory", "body": "<p>I would appreciate if anybody can help me with this issue I am having. Basically, the VBA is a search function that enables the user to search part of or the entire name of the job, from a job database.</p>\n\n<p>However, it results in \"Runtime error 7: Out of Memory.\" This happens only on my Macbook, and does not happen on a Windows computer. Upon clicking \"debug\", it brought me to this line of code:</p>\n\n<pre><code>`If scd.Cells(i, j) Like \"*\" &amp; Search &amp; \"*\" Then\n</code></pre>\n\n<p>please help! Thank you!</p>\n\n<p>The rest of the code is below:</p>\n\n<pre><code>Option Compare Text\nSub SearchClientRecord()\n\nDim Search As String\nDim Finalrow As Integer\nDim SearchFinalRow As Integer\nDim i As Integer\nDim scs As Worksheet\nDim scd As Worksheet\n\nSet scs = Sheets(\"Client Search\")\nSet scd = Sheets(\"Client Database\")\n\nscs.Range(\"C19:S1018\").ClearContents\n\nSearch = scs.Range(\"C12\")\nFinalrow = scd.Range(\"D100000\").End(xlUp).Row\nSearchFinalRow = scs.Range(\"D100000\").End(xlUp).Row\n\nFor j = 3 To 19\nFor i = 19 To Finalrow\n\nIf scd.Cells(i, j) Like \"*\" &amp; Search &amp; \"*\" Then\nscd.Range(scd.Cells(i, 3), scd.Cells(i, 19)).Copy\nscs.Range(\"C100000\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\nEnd If\nNext i\nNext j\nscs.Range(\"C19:S1018\").Select\n    scs.Range(\"$C$18:$S$1009\").RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6 _\n, 7), Header:=xlYes\n\n\nCall Border\nColumns(\"C:S\").HorizontalAlignment = xlCenter\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "checkbox"], "comments": [{"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1458745941, "post_id": 36181772, "comment_id": 59999067, "body": "You can set the height of each row&#39;s cell by using &#39;Rows(ToRow).RowHeight = X&#39; where X your desired value to make every row&#39;s height consistent. Otherwise I&#39;d suggest an accumulating your variable. EG: MyTop = MyTop + Rows(ToRow).RowHeight. You may have to play around with a &#39;magic number&#39; offset to this accumulator value to get what you&#39;re looking for."}, {"owner": {"reputation": 11, "user_id": 6072668, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209214452340188/picture?type=large", "display_name": "Matt Mignone", "link": "https://stackoverflow.com/users/6072668/matt-mignone"}, "edited": false, "score": 0, "creation_date": 1458746464, "post_id": 36181772, "comment_id": 59999539, "body": "Kris / Scott, thank you for your prompt reply!!!  I will try right now and update.  Thanks again."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6072668, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209214452340188/picture?type=large", "display_name": "Matt Mignone", "link": "https://stackoverflow.com/users/6072668/matt-mignone"}, "edited": false, "score": 0, "creation_date": 1458748326, "post_id": 36182144, "comment_id": 60000967, "body": "Scott, the .Height works good, but still having an issue with some cells getting multiple boxes.  I think it may be a formatting issue with my data and some cells maybe containing line breaks / carriage returns"}, {"owner": {"reputation": 11, "user_id": 6072668, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209214452340188/picture?type=large", "display_name": "Matt Mignone", "link": "https://stackoverflow.com/users/6072668/matt-mignone"}, "edited": false, "score": 1, "creation_date": 1458748676, "post_id": 36182144, "comment_id": 60001237, "body": "Hey, I think i got it, to rid of the carriage return, i added this loop           For Each MyRange In ActiveSheet.UsedRange            If 0 &lt; InStr(MyRange, Chr(10)) Then             MyRange = Replace(MyRange, Chr(10), &quot;&quot;)         End If     Next"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1458746551, "creation_date": 1458746551, "answer_id": 36182144, "question_id": 36181772, "link": "https://stackoverflow.com/questions/36181772/need-to-limit-checkboxes-to-one-per-row-using-vba/36182144#36182144", "title": "need to limit checkboxes to one per row using VBA", "body": "<p>The reason that spacing is an issue in your current code is because you never set the <code>Height</code> of the checkbox, so it's sets to default height. The argument in the <code>Add</code> method simply tell VBA where on the sheet to <em>place</em> the checkbox, it does not seem to actually set the <code>Height</code> of the checkboxm, and thus the boxes overlap based on the row height.</p>\n\n<p>I found placing a <code>.Height = MyHeight</code> inside the <code>With Selection</code> block solved it:</p>\n\n<pre><code>    With Selection\n        .Caption = \"\"\n        .Value = xlOff\n        .LinkedCell = \"K\" &amp; ToRow\n        .Display3DShading = False\n        .Height = myHeight\n     End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6072668, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209214452340188/picture?type=large", "display_name": "Matt Mignone", "link": "https://stackoverflow.com/users/6072668/matt-mignone"}, "is_accepted": false, "score": 0, "last_activity_date": 1458748824, "creation_date": 1458748824, "answer_id": 36183011, "question_id": 36181772, "link": "https://stackoverflow.com/questions/36181772/need-to-limit-checkboxes-to-one-per-row-using-vba/36183011#36183011", "title": "need to limit checkboxes to one per row using VBA", "body": "<p>Added the following and i think i am sorted.  Apologies for the mis-formatted questions, this is my first time posting to stack.  Thanks for all of your help!!!</p>\n\n<p>to rid of the carriage return, i added this loop</p>\n\n<pre><code>For Each MyRange In ActiveSheet.UsedRange\n       If 0 &lt; InStr(MyRange, Chr(10)) Then\n        MyRange = Replace(MyRange, Chr(10), \"\")\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6072668, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209214452340188/picture?type=large", "display_name": "Matt Mignone", "link": "https://stackoverflow.com/users/6072668/matt-mignone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1458748824, "creation_date": 1458745558, "last_edit_date": 1458746768, "question_id": 36181772, "link": "https://stackoverflow.com/questions/36181772/need-to-limit-checkboxes-to-one-per-row-using-vba", "title": "need to limit checkboxes to one per row using VBA", "body": "<p>I am using the following code to create checkboxes next to each row i have.  There can be anywhere from 500-2500 rows, so the number of rows need to be dynamic.  </p>\n\n<p>I am trying to:</p>\n\n<ol>\n<li>Copy a sheet from one workbook to another </li>\n<li>After sheet is copied,add checkboxes next to each row</li>\n<li>I am using conditional formatting to strike through all text in a\nrow if K is TRUE, checkboxes are in J.</li>\n<li>The problem I am having is, if a row is formatted not identical in\nheight, two checkboxes appear in that row and it affects the\nsubsequent rows.</li>\n</ol>\n\n<p>This is what the code i am using looks like. \nPlease help. </p>\n\n<pre><code>Sub create_new_wb_CHECKLIST()\n    Sheets(\"Jobs by Day\").Copy\n    Dim ToRow As Long\n    Dim LastRow As Long\n    Dim MyLeft As Double\n    Dim MyTop As Double\n    Dim MyHeight As Double\n    Dim MyWidth As Double\n    LastRow = Range(\"I20000\").End(xlUp).Row\n    For ToRow = 2 To LastRow\n    If Not IsEmpty(Cells(ToRow, \"I\")) Then            \n        MyLeft = Cells(ToRow, \"J\").Left\n        MyTop = Cells(ToRow, \"J\").Top\n        MyHeight = Cells(ToRow, \"J\").Height\n        MyWidth = MyHeight = Cells(ToRow, \"J\").Width        \n        ActiveSheet.CheckBoxes.Add(MyLeft, MyTop, MyWidth, MyHeight).Select\n         With Selection\n            .Caption = \"\"\n            .Value = xlOff\n            .LinkedCell = \"K\" &amp; ToRow\n            .Display3DShading = False\n         End With\n      End If\n  Next\n\nList item\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1458746197, "post_id": 36181764, "comment_id": 59999290, "body": "Thanks @HansUp - I always try to test my code even if it&#39;s only 1 line and sometimes forget to put the correct references back in."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1458745682, "last_edit_date": 1458745682, "creation_date": 1458745539, "answer_id": 36181764, "question_id": 36181642, "link": "https://stackoverflow.com/questions/36181642/loop-through-controls-with-certain-naming-structure-to-set-visible-property/36181764#36181764", "title": "Loop through controls with certain naming structure to set visible property", "body": "<p>You've defined <code>txtboxName</code> as a string rather than a control object.<br>\nTo refer to the control by it's name use:</p>\n\n<pre><code>Forms!IndProgressTracking.Controls(txtboxname).Visible = True\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6071715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/93a4f3e92b526ec41d288b486625d286?s=128&d=identicon&r=PG&f=1", "display_name": "madelina", "link": "https://stackoverflow.com/users/6071715/madelina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 36181764, "answer_count": 1, "score": 0, "last_activity_date": 1458745682, "creation_date": 1458745196, "question_id": 36181642, "link": "https://stackoverflow.com/questions/36181642/loop-through-controls-with-certain-naming-structure-to-set-visible-property", "title": "Loop through controls with certain naming structure to set visible property", "body": "<p>I have built a form that displays the \"status\" of projects for each month. I want to update the column/control box properties once at the start of each month (unhide the current month as the year progresses). Since future months won't have any data yet I wrote the following code.</p>\n\n<pre><code>Public Function updateProgressForm()\n\nDim currentMonth As String\nDim currentYear As Long\nDim txtDate As String\nDim todaysmonth As Long\nDim txtboxMonth As Integer\nDim txtboxName As String\nDim txtboxLabel As String\n\ntodaysmonth = Month(Now())\ncurrentMonth = MonthName(todaysmonth, 3)\ncurrentYear = Year(Now())\ntxtDate = currentMonth &amp; \" \" &amp; currentYear\n\nDoCmd.OpenForm \"IndProgressTracking\", acDesign, , , , acWindowNormal\nForms!IndProgressTracking!Month12.ControlSource = txtDate\nForms!IndProgressTracking!Month12Label.Caption = txtDate\n\nFor txtboxMonth = 1 To 12 Step 1\n    txtboxName = \"Month\" &amp; txtboxMonth\n    txtboxLabel = txtboxName &amp; \"Label\"\n  If IsNull(txtboxName) Then\n    txtboxName.Visible = False\n    txtboxLabel.Visible = False\n  Else\n    txtboxName.Visible = True\n    txtboxLabel.Visible = True\nEnd If\nNext\n\ntxtboxName = \"Month1\"\nForms!IndProgressTracking.Controls!txtboxName.Visible = True\n\nEnd Function\n</code></pre>\n\n<p>The part that is giving me an error is the txtboxName.Visible it states invalid qualifier. Therefore I tried the last 2 lines instead however, the last line (before end function) states that it cant find the control I referred to (<code>txtboxName</code>). I have a text box and label for each month so its not a huge deal if I have to call each individually using the control name I was just hoping to simplify by using the For loop. Any suggestions are welcome!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1458745356, "post_id": 36181546, "comment_id": 59998603, "body": "I am almost certain you need to have activate the page to work with <code>PageSetup</code>. So place a <code>ws.Activate</code> after the <code>For each ws ...</code> line. For centering see the <code>CenterVertically</code> and <code>CenterHorizontally</code> options (set them to <code>True</code>)"}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458746735, "post_id": 36181546, "comment_id": 59999745, "body": "Thanks for the tips, will give it a go now and see if it works :) will let you know how it goes soon"}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "is_accepted": true, "score": 0, "last_activity_date": 1458776844, "creation_date": 1458776844, "answer_id": 36190858, "question_id": 36181546, "link": "https://stackoverflow.com/questions/36181546/loop-to-alter-worksheet-page-setup-print-area/36190858#36190858", "title": "Loop to alter worksheet page setup/print area", "body": "<ol>\n<li>The <code>.Orientation</code> works for me in Excel 2010. Your use of\n<code>ActiveWorkbook</code> might be the problem; it could be selecting a\ndifferent Workbook than you expected. Try using the workbook name to\nselect it.</li>\n<li>For the <code>.FitToPagesWide</code> and <code>.FitToPagesTall</code> to work, put the\nfollowing before them: <code>.Zoom = False</code></li>\n<li><code>.CenterHorizontally</code> and <code>.CenterVertically</code> properties of the\n<code>PageSetUp</code> object should work without surprises as mentioned by\nScott</li>\n</ol>\n\n<p>I tried in Excel 2010 and this works. For the <code>.FitToPagesWide</code> and <code>.FitToPagesTall</code>, you won't see them populated when you just click on \"Print\" on \"File\" menu; you'll see them populated if you then click on the \"Page Setup\" link at the bottom of the pane between the submenu on the left and preview on the right.</p>\n"}], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 36190858, "answer_count": 1, "score": 0, "last_activity_date": 1458776844, "creation_date": 1458744898, "question_id": 36181546, "link": "https://stackoverflow.com/questions/36181546/loop-to-alter-worksheet-page-setup-print-area", "title": "Loop to alter worksheet page setup/print area", "body": "<p>I've got to a point where I have compiled an Excel workbook of multiple sheets from multiple places. The problem is they all have different page setups, print areas etc. Print area is the main thing, so i'm looking to set up a loop in VBA to go through all the sheets in the document and change the print area to \"fit on one page\". Here Is something I have created and am working on, it runs in VBA but nothing actually happens? :/. Also is there a way to Centralize in the page? So not just fit to page, but fit and center in page?</p>\n\n<pre><code>Sub WsLoop()\n\nDim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n        With ws.PageSetup\n        .Orientation = xlLandscape\n        .FitToPagesWide = 1\n        .FitToPagesTall = 1\n    End With\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "vba", "com", "excel-dna"], "comments": [{"owner": {"reputation": 15406, "user_id": 44264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d941e5d68ed49560a678a4f37c2bbb?s=128&d=identicon&r=PG", "display_name": "Govert", "link": "https://stackoverflow.com/users/44264/govert"}, "edited": false, "score": 0, "creation_date": 1458746956, "post_id": 36181121, "comment_id": 59999907, "body": "Have you tried <code>ref string</code>?"}, {"owner": {"reputation": 15406, "user_id": 44264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d941e5d68ed49560a678a4f37c2bbb?s=128&d=identicon&r=PG", "display_name": "Govert", "link": "https://stackoverflow.com/users/44264/govert"}, "edited": false, "score": 0, "creation_date": 1458748326, "post_id": 36181121, "comment_id": 60000968, "body": "If you can take an early-binding approach, an event would be more straightforward (though that would not address your question)."}, {"owner": {"reputation": 2664, "user_id": 1424754, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BgiTe.png?s=128&g=1", "display_name": "nicholas", "link": "https://stackoverflow.com/users/1424754/nicholas"}, "reply_to_user": {"reputation": 15406, "user_id": 44264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d941e5d68ed49560a678a4f37c2bbb?s=128&d=identicon&r=PG", "display_name": "Govert", "link": "https://stackoverflow.com/users/44264/govert"}, "edited": false, "score": 0, "creation_date": 1458756920, "post_id": 36181121, "comment_id": 60006783, "body": "@Govert, I can&#39;t believe it (after trying a bunch of goofy manual <code>Marshal</code> calls) but simply putting the <code>ref</code> keyword on the C# side does it. Write up a formal answer, and I&#39;ll accept it."}], "answers": [{"comments": [{"owner": {"reputation": 2664, "user_id": 1424754, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BgiTe.png?s=128&g=1", "display_name": "nicholas", "link": "https://stackoverflow.com/users/1424754/nicholas"}, "edited": false, "score": 1, "creation_date": 1458828559, "post_id": 36194717, "comment_id": 60037704, "body": "... should and does work. The Interop marshaler can be surprisingly intelligent sometimes. Note this is the equivalent of manually calling <code>Marshal.StringToBSTR(..)</code> and passing the <code>IntPtr</code> by <code>ref</code>. Either way, performance-wise, passing the string <code>ByVal</code> or <code>ByRef</code> is almost identical, since the BSTR conversion always creates a copy."}], "tags": [], "owner": {"reputation": 15406, "user_id": 44264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d941e5d68ed49560a678a4f37c2bbb?s=128&d=identicon&r=PG", "display_name": "Govert", "link": "https://stackoverflow.com/users/44264/govert"}, "is_accepted": true, "score": 1, "last_activity_date": 1458802663, "creation_date": 1458802663, "answer_id": 36194717, "question_id": 36181121, "link": "https://stackoverflow.com/questions/36181121/excel-dna-marshal-c-string-to-vba-byref-in-callback/36194717#36194717", "title": "Excel DNA - Marshal C# string to VBA ByRef in callback", "body": "<p>Specifying the parameter as <code>ref string</code> should work. </p>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/s9ts558h(v=vs.110).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/s9ts558h(v=vs.110).aspx</a> for more information about the string marshaling options.</p>\n"}], "owner": {"reputation": 2664, "user_id": 1424754, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BgiTe.png?s=128&g=1", "display_name": "nicholas", "link": "https://stackoverflow.com/users/1424754/nicholas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 1, "accepted_answer_id": 36194717, "answer_count": 1, "score": 2, "last_activity_date": 1458802663, "creation_date": 1458743771, "last_edit_date": 1458744543, "question_id": 36181121, "link": "https://stackoverflow.com/questions/36181121/excel-dna-marshal-c-string-to-vba-byref-in-callback", "title": "Excel DNA - Marshal C# string to VBA ByRef in callback", "body": "<p>I am attempting to invoke a VBA callback in Excel from C# code using Excel-DNA. After messing around with the particular data types and marshalling declarations, I was able to finally create a working sample:</p>\n\n<p><strong>C# Code</strong>\n</p>\n\n<pre><code>[ComVisible(true)]\n[ClassInterface(ClassInterfaceType.AutoDispatch)]\n[ProgId(\"CSharpComObject\")]\npublic partial class CSharpComObject\n{\n    Dictionary&lt;string, Callback&gt; _callbackMap = new Dictionary&lt;string, Callback&gt;();\n\n\n    public void SubscribeStringData(string topic, [MarshalAs(UnmanagedType.FunctionPtr)] Callback callback)\n    {\n        _callbackMap[topic] = callback;\n    }\n\n    public void RaiseCallback(string topic, string data)\n    {\n        _callbackMap[topic](data);\n    }\n\n    public delegate void Callback([MarshalAs(UnmanagedType.BStr)] string data);\n}\n</code></pre>\n\n<p><strong>VBA Module</strong>\n</p>\n\n<pre><code>Option Explicit\n\nDim testObj As Object\n\n\n\nSub Subscribe()\n\nSet testObj = CreateObject(\"CSharpComObject\")\n\ntestObj.SubscribeStringData \"someTopic\", AddressOf StringDataCallback\n\nEnd Sub\n\n\n\nSub StringDataCallback(ByVal data As String)\n\nMsgBox \"StringDataCallback Raised [\" + data + \"]\"\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Question</strong></p>\n\n<p>As you can see from the code sample above, the default COM marshalling for strings is <code>BStr</code> a.k.a. <code>ByVal ... As String</code>.</p>\n\n<p>I was wondering if there is a way to pass string data (or any object type for that matter) to the VBA callback <code>ByRef</code>, and if so, what would the C# declarations and marshalling attributes need to be?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 838, "user_id": 862427, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/866dd9f4bd43830ca0e530a5f2df2994?s=128&d=identicon&r=PG", "display_name": "Ric Gaudet", "link": "https://stackoverflow.com/users/862427/ric-gaudet"}, "edited": false, "score": 0, "creation_date": 1458743500, "post_id": 36180561, "comment_id": 59997062, "body": "I pasted your code into a VBA page, and upon first glance, it gets stuck on Cell.Value = iDate (or one of the other choices). iDate has not yet been initialized, because you have already called selectFirstBlankCell.  There may be other problems, but that is the first one I encountered.  Not quite sure what your intent is, so difficult to suggest a way to fix it yet."}, {"owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 0, "creation_date": 1458743632, "post_id": 36180561, "comment_id": 59997164, "body": "I think instead of <code>Cell.Value =...</code> you meant to use <code>Selection.Value =...</code>. But you really should read <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select</a>."}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "is_accepted": false, "score": 0, "last_activity_date": 1458746219, "creation_date": 1458746219, "answer_id": 36182015, "question_id": 36180561, "link": "https://stackoverflow.com/questions/36180561/excel-functions-values-from-input-box-inserted-into-free-cells/36182015#36182015", "title": "Excel functions - values from input box inserted into free cells", "body": "<p>Cell isn't an object in vba. You should use range objects instead. For example, if you want to select a value from A1 cell in sheet1 you must reference it like Worksheets(\"sheet1\").Range (\"A1\"). You could use a different aproach using two range objects, one for cells an one for range; for example to loop in certain cells in column A:</p>\n\n<pre><code>Dim lastrow As Integer\nDim eachcell as range\nDim total_range as range\n\nlastrow = Worksheets(\"sheet name\").Columns(\"A\").Find(\"\", Cells(Rows.Count, \"A\")).Row\n\nset total_range = Worksheets(\"sheet name\").Range(\"A1:A\" &amp; lastrow)\n\nfor each eachcell in total_range\n   'do something\nnext eachcell \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2444840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0afeeed16d2409eb1359516df0a65262?s=128&d=identicon&r=PG", "display_name": "user2444840", "link": "https://stackoverflow.com/users/2444840/user2444840"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458746219, "creation_date": 1458742261, "last_edit_date": 1458743693, "question_id": 36180561, "link": "https://stackoverflow.com/questions/36180561/excel-functions-values-from-input-box-inserted-into-free-cells", "title": "Excel functions - values from input box inserted into free cells", "body": "<p>New to VBA and Excel, haven't programmed anything in years. Quick question. We're trying to make an Inventory list in Excel With a button calling an input Box where data can be inserted. The data from the input boxes should eb inserted into the first available row. There are 10 columns per row, and each row represents a new item in the Inventory. Here is my code, which gives me \"Run-time error 424: Object required\":</p>\n\n<pre><code>Dim iDate, iVessel, iOrder, iCourier, iWaybill, iSender, iPcs, iWeight, iRemark As Variant\nDim col As Integer\nPublic Function selectFirstBlankCell()\n    Dim sourceCol As Integer, rowCount As Integer, currentRow As Integer\n    Dim currentRowValue As String\n    col = 2\n    sourceCol = col\n    rowCount = Cells(Rows.Count, sourceCol).End(xlUp).Row\n\n    While col &lt; 11\n        For currentRow = 1 To rowCount\n            currentRowValue = Cells(currentRow, sourceCol).Value\n            If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then\n                Cells(currentRow, sourceCol).Select\n                If sourceCol = 2 Then\n                    Cell.Value = iDate\n                ElseIf sourceCol = 3 Then\n                    Cell.Value = iVessel\n                ElseIf sourceCol = 4 Then\n                    Cell.Value = iOrder\n                ElseIf sourceCol = 5 Then\n                    Cell.Value = iCourier\n                ElseIf sourceCol = 6 Then\n                    Cell.Value = iWaybill\n                ElseIf sourceCol = 7 Then\n                    Cell.Value = iSender\n                ElseIf sourceCol = 8 Then\n                    Cell.Value = iPcs\n                ElseIf sourceCol = 9 Then\n                    Cell.Value = iWeight\n                ElseIf sourceCol = 10 Then\n                    Cell.Value = iRemark\n                End If\n            col = col + 1\n            End If\n        Next\n    Wend\n    End Function\n\n    Public Sub newParcel_Click()\n    Call selectFirstBlankCell\n    iDate = InputBox(\"Tast inn dato, format dd.mm.yyy\")\n    iVessel = InputBox(\"Tast inn b\u00e5tens navn\")\n    iOrder = InputBox(\"Tast inn eventuell P.O.\")\n    iCourier = InputBox(\"Tast inn courier\")\n    iWaybill = InputBox(\"Tast inn waybillnummer\")\n    iSender = InputBox(\"Tast inn avsender\")\n    iPcs = InputBox(\"Tast inn antall kolli\")\n    iWeight = InputBox(\"Tast inn vekt\")\n    iRemark = InputBox(\"Tast inn eventuelle anmerkninger\")\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "charts", "macros"], "answers": [{"comments": [{"owner": {"reputation": 949, "user_id": 5168414, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-jaoZcYbU0uw/AAAAAAAAAAI/AAAAAAAAABQ/9fysHqdvLOY/photo.jpg?sz=128", "display_name": "Anahit DEV", "link": "https://stackoverflow.com/users/5168414/anahit-dev"}, "edited": false, "score": 0, "creation_date": 1458796315, "post_id": 36183044, "comment_id": 60021430, "body": "But i need to do that automatically with a VBA code not manually @Dani Aya"}, {"owner": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "reply_to_user": {"reputation": 949, "user_id": 5168414, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-jaoZcYbU0uw/AAAAAAAAAAI/AAAAAAAAABQ/9fysHqdvLOY/photo.jpg?sz=128", "display_name": "Anahit DEV", "link": "https://stackoverflow.com/users/5168414/anahit-dev"}, "edited": false, "score": 0, "creation_date": 1458850387, "post_id": 36183044, "comment_id": 60051796, "body": "you could create pivot table from vba code. See next link: <a href=\"http://www.thespreadsheetguru.com/blog/2014/9/27/vba-guide-excel-pivot-tables\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 949, "user_id": 5168414, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-jaoZcYbU0uw/AAAAAAAAAAI/AAAAAAAAABQ/9fysHqdvLOY/photo.jpg?sz=128", "display_name": "Anahit DEV", "link": "https://stackoverflow.com/users/5168414/anahit-dev"}, "edited": false, "score": 0, "creation_date": 1458891371, "post_id": 36183044, "comment_id": 60063937, "body": "So how my code will look like? Could you help me please @Dani Aya?"}], "tags": [], "owner": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "is_accepted": false, "score": 0, "last_activity_date": 1458924045, "last_edit_date": 1458924045, "creation_date": 1458748904, "answer_id": 36183044, "question_id": 36180466, "link": "https://stackoverflow.com/questions/36180466/how-i-can-have-the-data-in-quarters-instead-of-month-with-excel-vba-macro/36183044#36183044", "title": "How i can have the data in quarters instead of month with Excel VBA Macro", "body": "<p>Best approach to summarize data into quarters is inserting a pivot table and use \"group\" feature by right clicking into any date value.</p>\n\n<p><strong>Edit 1</strong>\nIn response to @Anahit DEV comment. It is very hard to write any code without a source to work with. However, the next macro would help you to achive your goal. Please notice that I wrote some comments for you, and you must to replace these values where required.</p>\n\n<pre><code>Sub CreatePivotTable()\n'PURPOSE: Creates a brand new Pivot table on a new worksheet from data in the ActiveSheet\n'Source: www.TheSpreadsheetGuru.com\n'Modified by Dani Aya on 25/03/2016\n\nDim sht As Worksheet\nDim pvtCache As PivotCache\nDim pvt As PivotTable\nDim StartPvt As String\nDim SrcData As String\nDim celda As Range\nDim adrs_date_cell As String\nDim adrs_src_table As String 'address of source table\n\n'you must select the worksheet where the data source table is and then run this macro\nadrs_src_table = ActiveSheet.Range(\"A2\").CurrentRegion.Address '&lt;--- assuming second cell in the table is A2\n\n'Determine the data range you want to pivot\n\n  SrcData = ActiveSheet.Name &amp; \"!\" &amp; Range(adrs_src_table).Address(ReferenceStyle:=xlR1C1)\n\n'Create a new worksheet\n  Set sht = Sheets.Add\n  sht.Name = \"PT2\"\n\n'Where do you want Pivot Table to start?\n  StartPvt = \"PT2!\" &amp; sht.Range(\"A3\").Address(ReferenceStyle:=xlR1C1)\n\n'Create Pivot Cache from Source Data\n  Set pvtCache = ActiveWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=SrcData)\n\n'Create Pivot table from Pivot Cache\n  Set pvt = pvtCache.CreatePivotTable( _\n    TableDestination:=StartPvt, _\n    TableName:=\"QuartersPivotTable1\")\n\n\n'turn on dates in pivot table. Next segment of code insert two row labels (it's means two name columns) and one count value\n\n    'inserting firs row label from the pivot field lists\n    With ActiveSheet.PivotTables(\"QuartersPivotTable1\").PivotFields( _\n        \"date\") '&lt;----- place here a valid field date name from your table\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    'inserting one count value from the pivot field list\n    ActiveSheet.PivotTables(\"QuartersPivotTable1\").AddDataField ActiveSheet. _\n        PivotTables(\"QuartersPivotTable1\")\n        .PivotFields (\"any_field\"), \"#\", xlCount '&lt;----- Place your field to count rows from table instead if \"any_field\"\n    'inserting second row label from the pivot field list\n    With ActiveSheet.PivotTables(\"QuartersPivotTable1\").PivotFields(\"another_field\") '&lt;----- place here another field name from your table.\n        .Orientation = xlRowField\n        .Position = 2\n    End With\n\n\n'group your dates by quarters\n    '1. Search any date value\n    For Each celda In ActiveSheet.Range(\"A1:A1048576\")\n        If IsDate(celda.Value) Then\n            'get address where a date value were found\n            adrs_date_cell = celda.Address\n            Exit For\n        End If\n    Next celda\n    '2. Group by quarters selecting a valid date\n    ActiveSheet.Range(adrs_date_cell).Group Start:=True, End:=True, Periods:=Array(False, False, False, _\n        False, True, False, True)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 949, "user_id": 5168414, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-jaoZcYbU0uw/AAAAAAAAAAI/AAAAAAAAABQ/9fysHqdvLOY/photo.jpg?sz=128", "display_name": "Anahit DEV", "link": "https://stackoverflow.com/users/5168414/anahit-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458924045, "creation_date": 1458741999, "question_id": 36180466, "link": "https://stackoverflow.com/questions/36180466/how-i-can-have-the-data-in-quarters-instead-of-month-with-excel-vba-macro", "title": "How i can have the data in quarters instead of month with Excel VBA Macro", "body": "<p>I had created a Macro with VBA and created a month chart.See the code below</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nActiveSheet.Shapes.AddChart.Select\nActiveChart.SetSourceData Source:=Range(\"'Chart'!$A$1:$L$2\")\nActiveChart.ChartType = xlLineStacked\nDim cht As Chart\nDim ser As Series\nSet cht = ActiveChart\nSet ser = cht.SeriesCollection(1)\ncht.Parent.Width = 227\ncht.Parent.Height = 200\nser.Format.Line.Visible = msoFalse\nser.Format.Line.Visible = msoTrue\nser.Format.Line.ForeColor.RGB = RGB(26, 46, 74)\nser.Format.Fill.ForeColor.RGB = RGB(26, 46, 74)\nWith Worksheets(\"Chart\").ChartObjects(1).Chart\n.HasTitle = True\n.ChartTitle.Text = Sheets(\"Chart\").Range(\"B10\")\n.ChartTitle.Font.Size = 12\n.ChartTitle.Font.Color = RGB(26, 46, 74)\nEnd With\nWith cht.PlotArea.Format.Fill\n    .Visible = msoTrue\n    .ForeColor.RGB = RGB(239, 239, 239)\n    .Transparency = 0\n    .Solid\n   End With\n With cht.ChartArea.Fill\n.Visible = True\n.ForeColor.SchemeColor = 15\n.BackColor.SchemeColor = 15\n.TwoColorGradient Style:=msoGradientHorizontal, Variant:=1\nEnd With\nDim co As ChartObject\nFor Each co In ActiveSheet.ChartObjects\nco.Chart.ChartArea.Format.Fill.Visible = msoFalse\nco.Chart.PlotArea.Format.Fill.Visible = msoFalse\nNext\nDim Srs As Series\nSet Srs = ActiveChart.SeriesCollection(1)\nSrs.Name = \"\"\nDim ChartObj As Object\nFor Each ChartObj In Sheets(\"Chart\").ChartObjects\nChartObj.Chart.Location xlLocationAsObject, \"Factsheet\"\nWith ActiveSheet\n.ChartObjects(1).Top = .Range(\"D8\").Top\n.ChartObjects(1).Left = .Range(\"D8\").Left\nEnd With\nNext ChartObj\nEnd Sub\n</code></pre>\n\n<p>How i can create the chart with a quarter data in the place of displaying months it will display Q1, Q2, Q3, Q4.</p>\n\n<p>Is that possible to create with VBA?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458741613, "post_id": 36180265, "comment_id": 59995520, "body": "do you always want to format column <code>G</code> (the absolute column G) or do you want to format the <code>7th</code> column away from the user selection, or do you want to format the entire column of the user selection?"}, {"owner": {"reputation": 204, "user_id": 2735929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100003823470058/picture?type=large", "display_name": "Brett Comardelle", "link": "https://stackoverflow.com/users/2735929/brett-comardelle"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458742119, "post_id": 36180265, "comment_id": 59995947, "body": "The user must select columns A:n through N:n, I want only column G:n to be changed in that selection. So it&#39;s like a range inside of a selected area that I need to be changed. I should mention that the range r&#39;s value is nothing when it executes."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458742240, "post_id": 36180265, "comment_id": 59996048, "body": "okay, so it&#39;s the 7th column from the left most column selected in the range? (column G is 7 columns from column A in a spreadsheet)?"}, {"owner": {"reputation": 204, "user_id": 2735929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100003823470058/picture?type=large", "display_name": "Brett Comardelle", "link": "https://stackoverflow.com/users/2735929/brett-comardelle"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458742341, "post_id": 36180265, "comment_id": 59996130, "body": "Yes, it is the 7th column then. Sorry, I&#39;m sorta new to vba and not exactly sure what was meant by &quot;absolute column G&quot;."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458742510, "post_id": 36180265, "comment_id": 59996279, "body": "posting an answer in a moment ... when I said <code>absolute column G</code> I meant the literal column G on the spreadsheet"}], "answers": [{"comments": [{"owner": {"reputation": 204, "user_id": 2735929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100003823470058/picture?type=large", "display_name": "Brett Comardelle", "link": "https://stackoverflow.com/users/2735929/brett-comardelle"}, "edited": false, "score": 0, "creation_date": 1458743103, "post_id": 36180691, "comment_id": 59996758, "body": "It isn&#39;t working. rCol is getting the correct column (column 7, or &quot;G&quot; in my case), but the number format still remains the same (which is currency)."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 204, "user_id": 2735929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100003823470058/picture?type=large", "display_name": "Brett Comardelle", "link": "https://stackoverflow.com/users/2735929/brett-comardelle"}, "edited": false, "score": 0, "creation_date": 1458743532, "post_id": 36180691, "comment_id": 59997089, "body": "@BrettComardelle - I used the <code>NumberFormat</code> you provided in your original question. to get the accounting format, see my edited answer for the format to use."}, {"owner": {"reputation": 204, "user_id": 2735929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100003823470058/picture?type=large", "display_name": "Brett Comardelle", "link": "https://stackoverflow.com/users/2735929/brett-comardelle"}, "edited": false, "score": 0, "creation_date": 1458744568, "post_id": 36180691, "comment_id": 59997976, "body": "I added rCol.Select and noticed that rCol is assigned to a row much lower on the spreasheet than what was originally selected."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 204, "user_id": 2735929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100003823470058/picture?type=large", "display_name": "Brett Comardelle", "link": "https://stackoverflow.com/users/2735929/brett-comardelle"}, "edited": false, "score": 0, "creation_date": 1458744797, "post_id": 36180691, "comment_id": 59998178, "body": "@BrettComardelle - try this simpler version in my edited answer (again). You&#39;re original approach was good, except you did not have the correct <code>NumberFormat</code>. Keep in mind that this will only format the 7th column when there are <i>at least</i> 7 columns selected. To remove this check, comment out the <code>If</code> block."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1458744814, "last_edit_date": 1458744814, "creation_date": 1458742607, "answer_id": 36180691, "question_id": 36180265, "link": "https://stackoverflow.com/questions/36180265/how-to-change-the-number-format-of-a-column-in-vba/36180691#36180691", "title": "How to change the number format of a column in vba", "body": "<p>Try this out:</p>\n\n<pre><code>Dim rSel As Range, rCol As Range\n\nSet r = Selection\nIf r.Columns.Count &gt; 6 Then 'make sure there are even 7 columns\n\n    Set rCol = r.Columns(7) 'Columns(\"G\")\n    rCol.NumberFormat = \"_($* #,##0.00_);_($* (#,##0.00);_($* \"\"-\"\"??_);_(@_)\"\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 204, "user_id": 2735929, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100003823470058/picture?type=large", "display_name": "Brett Comardelle", "link": "https://stackoverflow.com/users/2735929/brett-comardelle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1703, "favorite_count": 0, "accepted_answer_id": 36180691, "answer_count": 1, "score": 0, "last_activity_date": 1458744814, "creation_date": 1458741506, "question_id": 36180265, "link": "https://stackoverflow.com/questions/36180265/how-to-change-the-number-format-of-a-column-in-vba", "title": "How to change the number format of a column in vba", "body": "<p>I am trying to use a user selection to alter the number format of a column inside that selection. The number format I am attempting to change it to is Accounting. The code I have tried is below.</p>\n\n<pre><code>Dim r As Range\nDim s As String\ns = Selection.Address(ReferenceStyle:=xlA1, RowAbsolute:=False, ColumnAbsolute:=False)\nr = Range(s).Columns(\"G\")\nr.NumberFormat = \"$#,##0.00\"\n</code></pre>\n\n<p>I know for sure that String s gets the correct string value of the user selection. Getting the range of just column G is what seems to be incorrect.</p>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1458740808, "post_id": 36179876, "comment_id": 59994858, "body": "It would be helpful to share the error you are getting. In this case, probably &quot;Type Mismatch&quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1458742097, "post_id": 36179876, "comment_id": 59995934, "body": "Please do not use <code>Activeheet</code> or <code>Usedrange</code> or even hardcode the cells to find the last row. You may want to see <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">THIS</a> Also avoid using <code>.Select</code>. You may want to see <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">THIS</a>"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 5695509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/535ff673adca418dd5660a9272853c50?s=128&d=identicon&r=PG&f=1", "display_name": "Prospidnick", "link": "https://stackoverflow.com/users/5695509/prospidnick"}, "edited": false, "score": 0, "creation_date": 1458827478, "post_id": 36180032, "comment_id": 60036936, "body": "Many thanks for your quick responses, i did not appreciate not using .select by doing do so i could see the range selected."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 3, "last_activity_date": 1458740877, "creation_date": 1458740877, "answer_id": 36180032, "question_id": 36179876, "link": "https://stackoverflow.com/questions/36179876/vba-return-message-if-cells-in-range-are-blank/36180032#36180032", "title": "VBA Return message if cell(s) in range are blank", "body": "<p>To fix, just remove the <code>.select</code> from the end of your range variable set line:</p>\n\n<pre><code>Set OrderRng = Range(\"c1:\" &amp; ActiveSheet.Range(\"c65536\").End(xlUp).Address)\n</code></pre>\n\n<p>The <code>.select</code> method returns a <code>TRUE</code> or <code>FALSE</code> value, so you end up with a type mismatch trying to <code>Set OrderRng</code> to <code>TRUE</code>, which is a boolean, not a range.</p>\n\n<p>Also there's 100% no reason to <code>select</code> here and your code should continue on fine. </p>\n"}], "owner": {"reputation": 133, "user_id": 5695509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/535ff673adca418dd5660a9272853c50?s=128&d=identicon&r=PG&f=1", "display_name": "Prospidnick", "link": "https://stackoverflow.com/users/5695509/prospidnick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1133, "favorite_count": 0, "accepted_answer_id": 36180032, "answer_count": 1, "score": 1, "last_activity_date": 1459504321, "creation_date": 1458740533, "last_edit_date": 1459504321, "question_id": 36179876, "link": "https://stackoverflow.com/questions/36179876/vba-return-message-if-cells-in-range-are-blank", "title": "VBA Return message if cell(s) in range are blank", "body": "<p>i am trying to return a message if any cells in a given range are blank. If i declare the range i.e. </p>\n\n<pre><code>Set OrderRng = [C1: C41]\n</code></pre>\n\n<p>it works fine, but if i declare it as such;</p>\n\n<pre><code>Set OrderRng = Range(\"c1:\" &amp; ActiveSheet.Range(\"c65536\"). End(xlUp).Address).Select`\n</code></pre>\n\n<p>It does not work.</p>\n\n<p>I know the second argument range is declared correctly as it always highlights the correct cells.</p>\n\n<p>My entire code looks like this;</p>\n\n<pre><code>&gt; Sub BlankCell() Dim OrderRng As Range On Error Resume Next\n&gt; \n&gt;     Set OrderRng = Range(\"c1:\" &amp; ActiveSheet.Range(\"c65536\").End(xlUp).Address).Select\n&gt; \n&gt; ' Set OrderRng = [C1: C41]  ' Rm'd for testing\n&gt; \n&gt;   Set OrderRng = OrderRng.SpecialCells(xlCellTypeBlanks)\n&gt; \n&gt; If Err = 0 Then MsgBox \"An Order ID is missing on one of your entries,\n&gt; please amend then try again\" End If End Sub\n</code></pre>\n\n<p>What am i doing wrong, i know it will be obvious, but not to me.</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["vba", "combobox", "setfocus", "msgbox"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1458740154, "post_id": 36179609, "comment_id": 59994422, "body": "I don&#39;t see where you are setting the focus to anything..."}, {"owner": {"reputation": 7, "user_id": 6104532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a5b44b6b1d8ebb518dd66982170aff33?s=128&d=identicon&r=PG&f=1", "display_name": "aoman49", "link": "https://stackoverflow.com/users/6104532/aoman49"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1458828004, "post_id": 36179609, "comment_id": 60037303, "body": "yep, you are correct. In trying so many things, I think that line got inadvertently deleted. However, even when the code is as below, still, no focus.                                          &#39;If chooses yes, goes back to form to allow user to input data Cancel = True MsgBox &quot;code working&quot; UserForm1.aceCount.SetFocus UserForm1.aceCount.SelStart = 0 MsgBox &quot;after focus&quot; &#39;If chooses no, submits code as normal"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6104532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a5b44b6b1d8ebb518dd66982170aff33?s=128&d=identicon&r=PG&f=1", "display_name": "aoman49", "link": "https://stackoverflow.com/users/6104532/aoman49"}, "edited": false, "score": 0, "creation_date": 1458828183, "post_id": 36180226, "comment_id": 60037423, "body": "I apologize, both you and @Macro Man are correct. In editing the code so many times, that line must have been deleted. However, even when I try your solution, (as I had many times before), it doesn&#39;t work. Shows first message box prompting to make changes, shows &#39;code working&#39; message box, skips setfocus, and shows &#39;after focus&#39; message box. Then closes out the form. It does run the necessary code AFTER that point though, so no issues there."}], "tags": [], "owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "is_accepted": false, "score": 0, "last_activity_date": 1458741410, "creation_date": 1458741410, "answer_id": 36180226, "question_id": 36179609, "link": "https://stackoverflow.com/questions/36179609/after-msgbox-vba-ignores-setfocus-to-combobox/36180226#36180226", "title": "After MsgBox, VBA ignores setfocus to ComboBox", "body": "<p>You don't use <code>SetFocus</code>. The line <code>UserForm1.aceCount.SelStart = 0</code> doesn't set focus to UserForm1.aceCount. If you want to set focus to that control, you should write <code>UserForm1.aceCount.SetFocus</code>.</p>\n\n<p>If UserForm1 is a Subform of your current form, you can use</p>\n\n<pre><code>UserForm1.Form.aceCount.SetFocus\nUserForm1.SetFocus\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6104532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a5b44b6b1d8ebb518dd66982170aff33?s=128&d=identicon&r=PG&f=1", "display_name": "aoman49", "link": "https://stackoverflow.com/users/6104532/aoman49"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 844, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458829978, "creation_date": 1458739880, "last_edit_date": 1458829978, "question_id": 36179609, "link": "https://stackoverflow.com/questions/36179609/after-msgbox-vba-ignores-setfocus-to-combobox", "title": "After MsgBox, VBA ignores setfocus to ComboBox", "body": "<p>After a messageBox answer, I want the user to be directed back to the ComboBox, 'aceCount'. However, it appears to be jumping over that line entirely. In the code below, I have two message boxes \"Code working\" and \"After focus\"; both show up so I know it is reading the code in that area, it just is literally ignoring the setfocus piece. I have read every article I can and tried multiple solutions for other questions, to no avail. It also doesn't setfocus to ANYTHING on the form after the messagebox. I've tried with textboxes and comboboxes. </p>\n\n<p>Edit: it appears to be setfocus on the combobox I need, but then executes to End If bolded below and runs through code. It doesn't give user the chance to resubmit. </p>\n\n<pre><code> Private Sub SubmitButton_Click()\n'Calls all necessary subs to perform required actions. If you add a sub, you     will have to call it here if you want it to perform when you submit the form.\n'If you have requested any number of HA Oracle servers, checks also if ACE and F5 are empty:\n    If Me.oracleCount.ListIndex &gt; 0 Then\n\n'If Ace and F5 are empty, MessageBox requesting review.\n    If aceCount.Value = 0 And F5Count.Value = 0 Then\n       If MsgBox(\"You have requested a HA Oracle server, but no Ace or F5. Do you need ACE or F5?\", vbYesNo + vbQuestion, \"ACE or F5?\") = vbYes Then\n'If chooses yes, goes back to form to allow user to input data\n     Cancel = True\n     MsgBox \"code working\"\n     UserForm1.aceCount.SelStart = 0\n     MsgBox \"after focus\"\n'If chooses no, submits code as normal\n       Else\n\n        Call EnterData\n        Call HideSheets\n        Unload Me\n\n    **End If**\n'If value in either Ace or F5, submits code as normal\n   ElseIf (Me.aceCount.Value &lt;&gt; 0 Or Me.F5Count.Value &lt;&gt; 0) Then\n        Call EnterData\n        Call HideSheets\n        Unload Me\n\n  End If\n  Else\n  End If\n  Call EnterData\n  Call HideSheets\n  Unload Me\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458741918, "post_id": 36180117, "comment_id": 59995780, "body": "first of all thank you for responding to my question :)"}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458742107, "post_id": 36180117, "comment_id": 59995940, "body": "the code that you gave me is working geat with the deleted functionalities , but not with the new functionalities  for exemple in the excel file that i puted in the user_v2 we have a user4 wich didn&#39;t exist in user_v1 but when i run the code i dont find him in the results , do you have any idea on how to solve this , thank you in advance"}, {"owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458742242, "post_id": 36180117, "comment_id": 59996050, "body": "So you want to include every user in column F, even if he only is in either column A or column C?"}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458743646, "post_id": 36180117, "comment_id": 59997184, "body": "like if we have user in column C  but he do not exist in column A he will be puted directly user  and his functionality will be puted as new functionality !! is there a way to do this ?"}, {"owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458744616, "post_id": 36180117, "comment_id": 59998029, "body": "I changed the code, hope it is working now! Can a single user appear several times in one column?"}, {"owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458745138, "post_id": 36180117, "comment_id": 59998446, "body": "Okay, then the above code should work? Or are you still encountering any problems?"}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458745251, "post_id": 36180117, "comment_id": 59998528, "body": "thank you very much for your effort , still have just one more thing , a little problem  is that now in the column new functionalities its not what it should be showing for example  for user1 in column A it has Fonc2 in column C it has Fonc6 so Fonc6 is the new functionality but it does not apear in the column H what can be done for this ??"}, {"owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458745534, "post_id": 36180117, "comment_id": 59998737, "body": "I thought there are user names in column C once again and the new functionalities are in column D? If your table is set up this way I am afraid I can&#39;t help you any further because for me the code works just as it is supposed to, showing the new functionality in column H."}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458745797, "post_id": 36180117, "comment_id": 59998944, "body": "yes yes the only thing is that the functionalities that exist in column D but do not exist in column B goes to the column H with their user ? is that doable ??"}, {"owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "reply_to_user": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458746310, "post_id": 36180117, "comment_id": 59999393, "body": "But isn&#39;t that already done by the code? All functionalities from column D are in column H."}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458746747, "post_id": 36180117, "comment_id": 59999751, "body": "unfortunately no :( i don&#39;t know how to fix it"}], "tags": [], "owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "is_accepted": false, "score": 0, "last_activity_date": 1458744488, "last_edit_date": 1458744488, "creation_date": 1458741103, "answer_id": 36180117, "question_id": 36179462, "link": "https://stackoverflow.com/questions/36179462/compare-4-columns-in-one-excel-sheet-using-vba/36180117#36180117", "title": "Compare 4 columns in one excel sheet using vba", "body": "<p>I hope I get what you want to achieve. Does the following solve your problem?</p>\n\n<pre><code> Private Sub CommandButton2_Click()\n  Dim rngCell As Range\n    For Each rngCell In Range(\"A2:A20000\")\n        If WorksheetFunction.CountIf(Range(\"C2:C20000\"), rngCell) &gt; 0 Then\n            Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(1) = rngCell\n            Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(0, 1) = rngCell.Offset(0, 1).Value\n            Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(0, 2) = Application.WorksheetFunction.VLookup(rngCell.Value, Range(\"C2:D20000\"), 2, 0)\n        ElseIf (rngCell &lt;&gt; \"\") Then\n\n            Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(1) = rngCell\n            Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(0, 1) = rngCell.Offset(0, 1).Value\n\n        End If\n    Next\n\n    For Each rngCell In Range(\"C2:C20000\")\n        If (WorksheetFunction.CountIf(Range(\"A2:A20000\"), rngCell) = 0 And rngCell &lt;&gt; \"\") Then\n              Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(1) = rngCell\n              Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(0, 2) = rngCell.Offset(0, 1).Value\n        End If\n    Next\n\n\nEnd Sub\n</code></pre>\n\n<p>A user is only included in column F when he appears both in columns A and C.In case you want to include every user that is either in column A or C the code has to be altered. </p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1458912924, "post_id": 36200433, "comment_id": 60073331, "body": "thank you i have updated the code for my needs and it works halalouya lool thank you again"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1458823189, "creation_date": 1458823189, "answer_id": 36200433, "question_id": 36179462, "link": "https://stackoverflow.com/questions/36179462/compare-4-columns-in-one-excel-sheet-using-vba/36200433#36200433", "title": "Compare 4 columns in one excel sheet using vba", "body": "<p>try this</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim ws As Worksheet\nDim cell As Range, funcCell As Range\nDim oldUserRng As Range, newUserRng As Range, reportRng As Range\nDim iReport As Long\nDim oldFunc As String, newFunc As String\n\nSet ws = ThisWorkbook.Worksheets(\"users\") '&lt;== adapt it to your needs\nWith ws\n    Set oldUserRng = .Columns(1).Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeConstants, xlTextValues)\n    Set newUserRng = .Columns(3).Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeConstants, xlTextValues)\n    Set reportRng = .Range(\"F1:I1\") '&lt;== added one report column to account for unchanged functions\nEnd With\n\nreportRng.Value = Array(\"user\", \"deleted\", \"new\", \"same\")\niReport = 1\nFor Each cell In oldUserRng\n    With cell\n        oldFunc = .Offset(, 1).Value\n        Set funcCell = FindAndOffset(newUserRng, .Value, 1)\n        If funcCell Is Nothing Then\n            reportRng.Offset(iReport) = Array(.Value, \"\", \"\", oldFunc)\n        Else\n            newFunc = funcCell.Value\n            If newFunc = oldFunc Then\n                reportRng.Offset(iReport) = Array(.Value, \"\", \"\", newFunc)\n            Else\n                reportRng.Offset(iReport) = Array(.Value, oldFunc, newFunc, \"\")\n            End If\n        End If\n        iReport = iReport + 1\n    End With\nNext cell\n\nFor Each cell In newUserRng\n    With cell\n        Set funcCell = FindAndOffset(oldUserRng, .Value, 1)\n        If funcCell Is Nothing Then\n            reportRng.Offset(iReport) = Array(.Value, \"\", .Offset(, 1).Value, \"\")\n            iReport = iReport + 1\n        End If\n    End With\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>Not so sure it does what you need.\nyou'd better provide screenshots of \"before\" and \"after\" scenarios.\nBTW, is it safe to assume that both old and new user columns cannot hold duplicates (i.e.: two or more \"userX\" in column A and/or column C?)</p>\n\n<p>But it does speed up thing considerably since it iterates only through non empty cells. </p>\n"}], "owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 1, "accepted_answer_id": 36200433, "answer_count": 2, "score": 1, "last_activity_date": 1460814961, "creation_date": 1458739539, "last_edit_date": 1460814961, "question_id": 36179462, "link": "https://stackoverflow.com/questions/36179462/compare-4-columns-in-one-excel-sheet-using-vba", "title": "Compare 4 columns in one excel sheet using vba", "body": "<p>I need your help please, I have 4 columns in an excel sheet and I need to compare them 2 by 2 i will explain to you :</p>\n\n<p>In column A i have users(user1,user2,user3 ...)\nIn column B i have functionalities ( fonc1, fonc2, fonc3.....)</p>\n\n<p>In column C i have users(user1,user2,user3 ...)\nIn column D i have functionalities ( fonc1, fonc2, fonc3.....)</p>\n\n<p>The columns C and D are a new version of columns A and B in the columns C and D the users may change order or change functionalities .</p>\n\n<p>When i execute my code i put the result in other new columns:\ncolumn F where i have the users \ncolumn G where i put the  Deleted_functionalities\ncolumn H where i put the New_functionalities </p>\n\n<p>The first problem is that the code doesn't get the users it get only the new and deleted functionalities. The second problem is that when the column A is more than column C where the users are stocked the code doesn't work. Can you please help me to find a solution? Thank you in advance .\nHere is my code and the file I am working on :</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n  Dim rngCell As Range\n    For Each rngCell In Range(\"B2:B2000\")\n        If WorksheetFunction.CountIf(Range(\"D2:D2000\"), rngCell) = 0 Then\n            Range(\"G\" &amp; Rows.Count).End(xlUp).Offset(1) = rngCell\n        End If\n    Next\n    For Each rngCell In Range(\"D2:D2000\")\n        If WorksheetFunction.CountIf(Range(\"B2:B2000\"), rngCell) = 0 Then\n            Range(\"H\" &amp; Rows.Count).End(xlUp).Offset(1) = rngCell\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>and this is the excel file \n<a href=\"http://www.cjoint.com/c/FCxnwjp22rv\" rel=\"nofollow\">http://www.cjoint.com/c/FCxnwjp22rv</a></p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 5263383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1fb6afc6a2b1bcf01aaacdc6cbdb28?s=128&d=identicon&r=PG&f=1", "display_name": "tamat", "link": "https://stackoverflow.com/users/5263383/tamat"}, "is_accepted": true, "score": 0, "last_activity_date": 1459869170, "creation_date": 1459869170, "answer_id": 36430321, "question_id": 36179371, "link": "https://stackoverflow.com/questions/36179371/table-load-vba-vs-built-in-function/36430321#36430321", "title": "Table load VBA vs Built in function", "body": "<p>One of the easiest way to control upload(if you have to change upload scenario dynamically) is to use custom VBA code to create and fill table with date from the source. The reason for that, in my opinion, the specifications and export/import system in Access is working, but weak and have pretty low level tools to use it via VBA, because it was mainly created for hand import/export with Access interface. </p>\n\n<p>PS by custom VBA code, i mean the code that absolutely avoid built-in import features. Again this only make sense if your import/export scenario is dynamic and need to make choices in a process. If it's static and can be created using standard features, then just do it by hand with a step by step wizard and then call it with your VBA code without any changes.</p>\n"}], "owner": {"reputation": 107, "user_id": 6104146, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154083379249365/picture?type=large", "display_name": "Steve O&#39;Dea", "link": "https://stackoverflow.com/users/6104146/steve-odea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 36430321, "answer_count": 1, "score": 1, "last_activity_date": 1459869170, "creation_date": 1458739311, "question_id": 36179371, "link": "https://stackoverflow.com/questions/36179371/table-load-vba-vs-built-in-function", "title": "Table load VBA vs Built in function", "body": "<p>I have a rather odd thing happening to me when I import a table into access.</p>\n\n<p>I have tried doing this in three ways...</p>\n\n<p>Firstly, I import the table (from a text file) using the built in functionality and having defined (and saved) the Import Specification everything works tickety-boo.</p>\n\n<p>Next I re-run the upload by creating a macro but with reference to the Import Specification file that I saved above.</p>\n\n<p>The problem is, some of the Import Specifications are not holding when I do it this way, in particular, I have requested that one field has indexing (No Duplicates), however when it loads with the macro it sets the fields indexing back to the default position back to \"No\"</p>\n\n<p>I also tried to load the table using VBA (with reference to the same Import Specification File), but encounter the same problem.</p>\n\n<p>Does anyone know how to maintain the integrity of the indexing when doing automated loads based of spec files?</p>\n"}, {"tags": ["vba", "loops", "solidworks"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 0, "creation_date": 1458739595, "post_id": 36179378, "comment_id": 59994001, "body": "Sorry but when I run it I get the following error: Run-time error&#39;55&#39; File already open. The loop doesn&#39;t seem to be progressing"}, {"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "reply_to_user": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 1, "creation_date": 1458739872, "post_id": 36179378, "comment_id": 59994210, "body": "Move Close #1  before next i"}, {"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "reply_to_user": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 0, "creation_date": 1458740990, "post_id": 36179378, "comment_id": 59995008, "body": "Since you are editing the file it should be For Output As #1"}], "tags": [], "owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "is_accepted": false, "score": 0, "last_activity_date": 1458739329, "creation_date": 1458739329, "answer_id": 36179378, "question_id": 36179244, "link": "https://stackoverflow.com/questions/36179244/loop-through-files-to-retrieve-data-for-solidworks/36179378#36179378", "title": "Loop through files to retrieve data for solidworks", "body": "<p>Change to \"C:\\Users\\jerry.obrien\\Desktop\\2MW Blade\\Solidworks\\output_\" &amp; i &amp; \".txt\"</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 0, "creation_date": 1458739803, "post_id": 36179431, "comment_id": 59994156, "body": "Sorry but it says the path is not found"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 0, "creation_date": 1458740511, "post_id": 36179431, "comment_id": 59994650, "body": "fixed. Sorry I goofed up the file name in my original answer"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 0, "creation_date": 1458743400, "post_id": 36179431, "comment_id": 59996990, "body": "See if this helps. I am thinking maybe it has to do with the file type?"}, {"owner": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 0, "creation_date": 1458746482, "post_id": 36179431, "comment_id": 59999555, "body": "<code>Dim swApp As Object Sub main()  Set swApp = Application.SldWorks Set Part = swApp.ActiveDoc swApp.ActiveDoc.ActiveView.FrameState = 1 Dim Temp As Object  For i = 1 To 61 Set Temp = CreateObject(&quot;Shell.Application&quot;)  rTemP = &quot;C:\\Users\\jerry.obrien\\Desktop\\2MW Blade\\Solidworks&quot; &amp; &quot;\\&quot; &amp; &quot;output_i.txt&quot; For Input As #1  Temp.Open (rTemP)    Part.SketchManager.Insert3DSketch True Do While Not EOF(1) Input #1, X, Y, Z Set skPoint = Part.SketchManager.CreatePoint(X &#47; 1, Y &#47; 1, Z &#47; 1) Loop Next i Close #1  Part.ShowNamedView2 &quot;*Isometric&quot;, 7 Part.ViewZoomtofit2 End Sub</code> get a syntax error."}, {"owner": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 0, "creation_date": 1458746725, "post_id": 36179431, "comment_id": 59999739, "body": "I must be going blind but I cannot see it"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 0, "creation_date": 1458822107, "post_id": 36179431, "comment_id": 60033416, "body": "sorry wasnt able to look at this again till this morning. Ill have to look at it some more and figure out the issue. I thought it was as simple as a directory pointing error. I will however add some generic looping through a file logic in my original answer for you though (as your loop only looks at one file not all files in the folder)"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1458822791, "last_edit_date": 1458822791, "creation_date": 1458739456, "answer_id": 36179431, "question_id": 36179244, "link": "https://stackoverflow.com/questions/36179244/loop-through-files-to-retrieve-data-for-solidworks/36179431#36179431", "title": "Loop through files to retrieve data for solidworks", "body": "<p>Some generic looping stuff</p>\n\n<pre><code> path = \"C:\\Users\\jerry.obrien\\Desktop\\2MW Blade\\Solidworks\" &amp; \"\\\" \n Filename = Dir(path &amp; \"*.txt??\")\n\n Do While Len(Filename) &gt; 0\n     DoEvents\n     debug.? \"found \"; path &amp; Filename\n     Filename = Dir()\n         For Each..... \n         Next .....\n   Filename = Dir\n Loop\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 813, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465165843, "creation_date": 1458738979, "last_edit_date": 1465165843, "question_id": 36179244, "link": "https://stackoverflow.com/questions/36179244/loop-through-files-to-retrieve-data-for-solidworks", "title": "Loop through files to retrieve data for solidworks", "body": "<p>I have written the following code which works fine when I open one file. However, my knowledge of vba coding is low. I used a for loop in order to open a range of file names output_1 to output_61, but I get the error of \"Run-time error '53' File not found\". Can anyone help me with this?</p>\n\n<p>Here is the code I have wrote:\nRegards,\nJer</p>\n\n<pre><code>Dim swApp As Object\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    Set Part = swApp.ActiveDoc\n    swApp.ActiveDoc.ActiveView.FrameState = 1\n    Dim skPoint As Object\n\n    For i = 1 To 61\n        Open \"C:\\Users\\jerry.obrien\\Desktop\\2MW Blade\\Solidworks\\output_i.txt\" For Input As #1\n        Part.SketchManager.Insert3DSketch True\n        Do While Not EOF(1)\n            Input #1, X, Y, Z\n            Set skPoint = Part.SketchManager.CreatePoint(X / 1, Y / 1, Z / 1)\n        Loop\n    Next i\n    Close #1\n\n    Part.ShowNamedView2 \"*Isometric\", 7\n    Part.ViewZoomtofit2\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1458738231, "post_id": 36178721, "comment_id": 59993045, "body": "try rst.MoveFirst before you start the  loop"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1458752966, "post_id": 36178721, "comment_id": 60004300, "body": "as well as <code>MoveFirst</code> check whether there are records in the first place - <code>If Not .BOF AND Not .EOF THEN: DO UNTIL .EOF.....</code>"}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4941977, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0268c5e3b7fbc8a268b345e7b943c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "DotyDot", "link": "https://stackoverflow.com/users/4941977/dotydot"}, "edited": false, "score": 0, "creation_date": 1458738663, "post_id": 36179027, "comment_id": 59993368, "body": "Thank you so much! So simple but overlooked that fact."}, {"owner": {"reputation": 135, "user_id": 4941977, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0268c5e3b7fbc8a268b345e7b943c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "DotyDot", "link": "https://stackoverflow.com/users/4941977/dotydot"}, "edited": false, "score": 0, "creation_date": 1458740023, "post_id": 36179027, "comment_id": 59994320, "body": "One last question, The phone numbers keep getting added on to the next record when they appear in the bcc field. I&#39;m not sure were to reset the fields or am i attaching them wrong?"}, {"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "reply_to_user": {"reputation": 135, "user_id": 4941977, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0268c5e3b7fbc8a268b345e7b943c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "DotyDot", "link": "https://stackoverflow.com/users/4941977/dotydot"}, "edited": false, "score": 0, "creation_date": 1458742311, "post_id": 36179027, "comment_id": 59996104, "body": "Well, I don&#39;t see where you are sending the mail, but I did not question it, as it wasn&#39;t part of the question. - Anyway, you are appending the current number to your variable strBCC. If you don&#39;t want that, just set it to the new value: strBCC = strTextEmail"}, {"owner": {"reputation": 135, "user_id": 4941977, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0268c5e3b7fbc8a268b345e7b943c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "DotyDot", "link": "https://stackoverflow.com/users/4941977/dotydot"}, "edited": false, "score": 0, "creation_date": 1458742738, "post_id": 36179027, "comment_id": 59996465, "body": "i figured it out but thank you for the response. Had to set the clean variable to &quot;&quot; before each iteration of the loop."}], "tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": true, "score": 2, "last_activity_date": 1458738377, "creation_date": 1458738377, "answer_id": 36179027, "question_id": 36178721, "link": "https://stackoverflow.com/questions/36178721/looping-through-query-in-access/36179027#36179027", "title": "Looping through query in access", "body": "<p>You are not reading the values from the recordset into your local variables. What you do right now, is reading the values from form controls (I guess). So these will not change if you move to the next record in the recordset.</p>\n\n<p>Change the beginning of the loop like this:</p>\n\n<pre><code>With rst\n  Do Until .EOF\n    strCell = Nz(rst.Fields(\"CellPhone\").Value, \"0\")\n    strProv = Nz(rst.Fields(\"CellProvider\").Value, \"0\")\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4941977, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0268c5e3b7fbc8a268b345e7b943c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "DotyDot", "link": "https://stackoverflow.com/users/4941977/dotydot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2341, "favorite_count": 0, "accepted_answer_id": 36179027, "answer_count": 1, "score": 1, "last_activity_date": 1458738377, "creation_date": 1458737458, "question_id": 36178721, "link": "https://stackoverflow.com/questions/36178721/looping-through-query-in-access", "title": "Looping through query in access", "body": "<pre><code>Dim strCell As String\nDim strProv As String\nDim strTextEmail As String\nDim oApp As Outlook.Application\nDim oMail As MailItem\nSet oApp = CreateObject(\"Outlook.application\")\n\n\nDim StrBCC As String\nDim rst As DAO.Recordset\nDim qdf As DAO.QueryDef\nDim db As DAO.Database\n\nSet db = CurrentDb\nSet qdf = db.QueryDefs(\"Staff Query\")\n\nSet rst = qdf.OpenRecordset()\n\nWith rst\nDo Until .EOF\n\nstrCell = Nz([CellPhone], \"0\")\nstrProv = Nz([CellProvider], \"0\")\nMsgBox [CellPhone]\nMsgBox [CellProvider]\n\nIf strCell = \"0\" Or strProv = \"0\" Then\n    MsgBox \"MISSING DATA: Please double check the agent name, cell phone number and provider are entered in the staff table.\"\nElse\n         Dim Clean As String\n         Dim Pos, A_Char\n         Pos = 1\n         For Pos = 1 To Len(strCell)\n            A_Char = Mid(strCell, Pos, 1)\n            If A_Char &gt;= \"0\" And A_Char &lt;= \"9\" Then\n              Clean = Clean + A_Char\n            End If\n         Next Pos\n         strCell = Clean\n         strProv = DLookup(\"[EmailExt]\", \"CellProviders\", \"[CellProvider]='\" &amp; strProv &amp; \"'\")\nstrTextEmail = strCell &amp; strProv\nEnd If\n\n\nStrBCC = StrBCC &amp; strTextEmail &amp; \";\"\n\nrst.MoveNext\nLoop\n\nEnd With\nStrBCC = Left(StrBCC, Len(StrBCC) - 1)\n\nSet oMail = oApp.CreateItem(olMailItem)\noMail.BCC = StrBCC\noMail.Display\n\nSet oMail = Nothing\nSet oApp = Nothing\nSet rst = Nothing\n</code></pre>\n\n<p>I am trying to loop through the query \"Staff Query\" to send a text to everyone in it. I have everything working except the fact that it wont loop through the query, it loops through the first record on the form I open it on and it wont move. \nAnyone have any suggestions for this? \nThank you in advance. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1458738218, "post_id": 36178243, "comment_id": 59993030, "body": "How about adding &quot;activeworkbook.save false&quot; after your code saves the book?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1458739421, "post_id": 36178243, "comment_id": 59993880, "body": "If your user first does a <code>Save</code> and immediately after does a <code>Close</code>, do you want <b>2</b> distinct copies of the file saved ??"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1458740071, "post_id": 36178243, "comment_id": 59994363, "body": "@Absinthe - <code>.Save False</code> isn&#39;t a VBA command (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff197585.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff197585.aspx</a>). @Gary&#39;s Student - I&#39;d expect it not to save when closed in that instance as the previous save would mark Excels &quot;dirty flag&quot; as clean."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1458741350, "post_id": 36178243, "comment_id": 59995298, "body": "Sorry, I meant .Close false"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1458741540, "post_id": 36178243, "comment_id": 59995458, "body": "Even though @Mr.Burns comment about <code>ActiveWorkbook.Close False</code> has been deleted it did give me an idea which appears to have worked. @Absinthe - guess your comment was the same as Mr.Burns.  I can&#39;t put <code>.Close</code> in the BeforeSave as it would close the file if they only saved the file, but I can check the BeforeClose event.  I&#39;ll put it as an answer and see if anyone can see a problem with it."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458741731, "post_id": 36178243, "comment_id": 59995624, "body": "<code>but if they close the file it will auto-save with the updated file name</code> How does the autosave happen?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458743216, "post_id": 36178243, "comment_id": 59996835, "body": "You&#39;re dead right there @Siddharth - it doesn&#39;t auto-save, it asks if you want to save the file, saves it and then asks if  you want to save the file, etc.  I&#39;ll update the question so it doesn&#39;t look like I&#39;m making it up as I go along. :)"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1458743461, "post_id": 36178243, "comment_id": 59997034, "body": "Yup, I meant in before close. Need coffee."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458747478, "post_id": 36178243, "comment_id": 60000318, "body": "I thought so :) Anyways check the answer that I posted. let me know if I missed anything and I will rectify it :)"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458742169, "post_id": 36180423, "comment_id": 59995995, "body": "is this an actual answer or an edit to your original question? if it&#39;s an edit, please edit your original question and remove this answer."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1458743689, "post_id": 36180423, "comment_id": 59997225, "body": "I&#39;ve put it as an answer as it does resolve the problem by adding code to the <code>BeforeClose</code> event which I hadn&#39;t done previously, and was pointed out in the comment made by Absinthe.  I think if I add it to my original question it will become more of a statement and less of a question."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1458744446, "last_edit_date": 1458744446, "creation_date": 1458741876, "answer_id": 36180423, "question_id": 36178243, "link": "https://stackoverflow.com/questions/36178243/update-the-file-name-on-workbook-beforesave/36180423#36180423", "title": "Update the file name on Workbook_BeforeSave", "body": "<p>I've updated my <code>BeforeSave</code> code slightly - I'm still not sure if     <code>ThisWorkbook.Saved = True : Cancel = True</code> is correct, but I do know it crashes if I don't put in the <code>Cancel = True</code>:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim NewFileName As String\n\n    On Error GoTo ERROR_HANDLER\n\n    ThisWorkbook.Saved = True\n    Cancel = True\n\n    NewFileName = GenerateUniqueName(ThisWorkbook.FullName)\n    If NewFileName &lt;&gt; \"\" Then\n        Application.EnableEvents = False\n        ThisWorkbook.SaveAs NewFileName, ThisWorkbook.FileFormat\n        Application.EnableEvents = True\n    End If\n\nFastExit:\n\n    On Error GoTo 0\n    Exit Sub\n\nERROR_HANDLER:\n    MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n        \" (\" &amp; Err.Description &amp; \") in procedure ThisWorkbook.Workbook_BeforeSave.\" &amp; vbCr &amp; vbCr &amp; _\n        \"DOCUMENT NOT SAVED.\", vbCritical + vbOKOnly\n    Application.EnableEvents = True\n    Resume FastExit\n\nEnd Sub\n</code></pre>\n\n<p>This will Save the file with a new name, but not close it.  </p>\n\n<p>As Absinthe and Mr.Burns said - look at the close event.<br>\nThis looks to see if the workbook has been saved.  If it hasn't then the close event is cancelled, the workbook is saved and then it's closed otherwise it will just close without saving.</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    Dim NewFileName As String\n\n    If Not ThisWorkbook.Saved Then\n        Cancel = True\n        NewFileName = GenerateUniqueName(ThisWorkbook.FullName)\n        If NewFileName &lt;&gt; \"\" Then\n            Application.EnableEvents = False\n            ThisWorkbook.SaveAs NewFileName, ThisWorkbook.FileFormat\n            Application.EnableEvents = True\n            ThisWorkbook.Close Not ThisWorkbook.Saved\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone spot any pitfalls here?<br>\n<strong>Edit:</strong> I've found one pitfall - you can't use <code>Save As</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1458749540, "post_id": 36182482, "comment_id": 60001915, "body": "That works, thanks Siddharth.  I&#39;ll take it over my answer as it still allows for <code>Save As</code>, asks about Saving on BeforeClose and looks tidier."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1458747403, "creation_date": 1458747403, "answer_id": 36182482, "question_id": 36178243, "link": "https://stackoverflow.com/questions/36178243/update-the-file-name-on-workbook-beforesave/36182482#36182482", "title": "Update the file name on Workbook_BeforeSave", "body": "<p>Please try this and see if your problems are solved? I have not included your function below as that remains unchanged.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Dim Ret As Variant\n\n    If ThisWorkbook.Saved = False Then\n        ThisWorkbook.Saved = True\n\n        Ret = MsgBox(\"Would you like to save this workbook?\", vbYesNo)\n\n        If Ret = vbYes Then SaveWithUniqueName\n    End If\nEnd Sub\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    If ThisWorkbook.Saved = True Then Exit Sub\n\n    If SaveAsUI = True Then Exit Sub '~~&gt; Checks for Save As\n\n    Cancel = True\n    SaveWithUniqueName\nEnd Sub\n\nSub SaveWithUniqueName()\n    Dim NewFileName As String\n\n    On Error GoTo ERROR_HANDLER\n\n        NewFileName = GenerateUniqueName(ThisWorkbook.FullName)\n\n    If NewFileName &lt;&gt; \"\" Then\n        Application.EnableEvents = False\n        ThisWorkbook.SaveAs NewFileName, ThisWorkbook.FileFormat\n        ThisWorkbook.Saved = True\n        Application.EnableEvents = True\n    End If\n\nFastExit:\n    On Error GoTo 0\n    Exit Sub\n\nERROR_HANDLER:\n    MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n        \" (\" &amp; Err.Description &amp; \") in procedure ThisWorkbook.Workbook_BeforeSave.\" &amp; vbCr &amp; vbCr &amp; _\n        \"DOCUMENT NOT SAVED.\", vbCritical + vbOKOnly\n    Application.EnableEvents = True\n    Resume FastExit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2307, "favorite_count": 0, "accepted_answer_id": 36182482, "answer_count": 2, "score": 0, "last_activity_date": 1458747403, "creation_date": 1458736179, "last_edit_date": 1458743390, "question_id": 36178243, "link": "https://stackoverflow.com/questions/36178243/update-the-file-name-on-workbook-beforesave", "title": "Update the file name on Workbook_BeforeSave", "body": "<p>I'm trying to have Excel save a file with a unique name whenever it's saved.<br>\n  This will mostly be used within Excel 2003, but must also work on 2010.</p>\n\n<p>The idea is that the user opens a template file and if they click 'Save' or just close the workbook it will save as template_1, template_2, etc.</p>\n\n<p><strong>This works fine if they click 'Save', but if they close the file it will ask if you want to save changes on the original file, saves it under the new name and then ask if the user wants to save changes... and then saves and asks if the user wants to save changes, and so on.</strong>  Obviously, I only want it to save the once and then close - but it doesn't.</p>\n\n<p>I've tried setting the <code>Saved</code> property to TRUE. I've tried <code>Cancel = True</code> after the save but this causes Excel to crash with a <strong>Excel has encountered a problem and really needs to screw your day up</strong> type message.</p>\n\n<p>In the code below I've tried removing the <code>Saved=TRUE</code> and the <code>Cancel=TRUE</code>, I've tried moving them around - Cancel before the Save, Cancel after the Save but within the <code>If...End If</code> block, before and after the <code>EnableEvents</code> code:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim NewFileName As String\n\n    On Error GoTo ERROR_HANDLER\n\n    NewFileName = GenerateUniqueName(ThisWorkbook.FullName)\n    If NewFileName &lt;&gt; \"\" Then\n        Application.EnableEvents = False\n        ThisWorkbook.SaveAs NewFileName, ThisWorkbook.FileFormat\n        ThisWorkbook.Saved = True\n        Application.EnableEvents = True\n    End If\n\nFastExit:\n\n    Cancel = True\n\n    On Error GoTo 0\n    Exit Sub\n\nERROR_HANDLER:\n    MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n        \" (\" &amp; Err.Description &amp; \") in procedure ThisWorkbook.Workbook_BeforeSave.\" &amp; vbCr &amp; vbCr &amp; _\n        \"DOCUMENT NOT SAVED.\", vbCritical + vbOKOnly\n    Application.EnableEvents = True\n    Resume FastExit\n\nEnd Sub\n</code></pre>\n\n<p>The <code>GenerateUniqueName</code> code is below - this assumes the file name doesn't contain an underscore character and appends the number to the file name as _1, _2, etc:</p>\n\n<pre><code>'----------------------------------------------------------------------\n' GenerateUniqueName\n'\n'   Generates a file name that doesn't exist by appending a number\n'   inbetween the base name and the extension.\n'   Example: GenerateUniqueName(\"c:\\folder\\file.ext\") = \"c:\\folder\\file_4.ext\"\n'----------------------------------------------------------------------\nFunction GenerateUniqueName(FullFileName As String, Optional fAlwaysAddNumber As Boolean) As String\n\n    Dim oFSO As Object\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    If Not oFSO.FileExists(FullFileName) And Not fAlwaysAddNumber Then\n        GenerateUniqueName = FullFileName\n    Else\n        Dim strExt As String\n        Dim strNonExt As String\n        Dim strBaseName As String\n        Dim strNewName As String\n        Dim i As Integer\n        strExt = oFSO.GetExtensionName(FullFileName)\n        If strExt &lt;&gt; \"\" Then\n            strBaseName = oFSO.GetBaseName(FullFileName)\n            If InStrRev(strBaseName, \"_\") &gt; 0 Then\n                i = Val(Mid(strBaseName, InStrRev(strBaseName, \"_\") + 1, Len(strBaseName)))\n                strBaseName = Left(strBaseName, InStrRev(strBaseName, \"_\") - 1)\n            End If\n            strNonExt = oFSO.buildpath(oFSO.GetParentFolderName(FullFileName), strBaseName)\n            Do\n                i = i + 1\n                strNewName = strNonExt &amp; \"_\" &amp; i &amp; \".\" &amp; strExt\n            Loop While oFSO.FileExists(strNewName)\n            GenerateUniqueName = strNewName\n        Else\n            MsgBox \"File name must contain a file extension.\" &amp; vbCr &amp; _\n                \"e.g. .xls or .xlsx\", vbCritical + vbOKOnly\n            GenerateUniqueName = \"\"\n        End If\n    End If\n\n    Set oFSO = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1458736731, "post_id": 36178053, "comment_id": 59991911, "body": "Why not just use <code>ActiveSheet</code>? What object is <code>Me</code> supposed to represent if it isn&#39;t the active sheet?"}, {"owner": {"reputation": 135, "user_id": 6104138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16587ca77066925c1845b34c0d6e9364?s=128&d=identicon&r=PG&f=1", "display_name": "Mobz", "link": "https://stackoverflow.com/users/6104138/mobz"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1458737010, "post_id": 36178053, "comment_id": 59992104, "body": "I guess it could work but I&#39;m just not too happy about using &#39;ActiveSheet&#39;. Is there a way to make it work without using activesheet?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1458737418, "post_id": 36178053, "comment_id": 59992438, "body": "You could obviously hard-code the worksheet name, but calling <code>ActiveSheet</code> once at the very start to pull it into a variable isn&#39;t bad - i.e., <code>Set test = ActiveSheet</code>."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1458737692, "post_id": 36178053, "comment_id": 59992647, "body": "What exactly are you trying to accomplish? If you describe your problem in more detail perhaps someone could suggest a more specific solution."}], "answers": [{"tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": true, "score": 3, "last_activity_date": 1458740918, "creation_date": 1458740918, "answer_id": 36180055, "question_id": 36178053, "link": "https://stackoverflow.com/questions/36178053/use-me-in-functions/36180055#36180055", "title": "Use Me. in functions", "body": "<p>In VBA <code>Me</code> is context sensitive.  It provides a reference to the parent object.  If your code is declared within <code>ThisWorkbook</code> <code>Me</code> will point to the current <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835568.aspx\" rel=\"nofollow noreferrer\">workbook object</a>.  If you declare your code within a userform <code>Me</code> will refer to that <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264663.aspx\" rel=\"nofollow noreferrer\">userform</a>.</p>\n\n<p>I suspect your code was originally declared within a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194464.aspx\" rel=\"nofollow noreferrer\">Sheet object</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uAwNR.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uAwNR.gif\" alt=\"Worksheet objects with IDE\"></a></p>\n\n<p>From here it would access to the current <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194464.aspx\" rel=\"nofollow noreferrer\">worksheet object</a>, which contains the <code>ChartObjects</code> object.</p>\n\n<p>One way to fix your code is to move it into the required worksheet.  You could also parameterise the workbook name, like so:</p>\n\n<pre><code>Sub DeleteGraph(ByVal WorksheetName AS String)\n\n    For Each objCht In Sheets(WorksheetName).ChartObjects\n        For Each s In objCht.Chart.SeriesCollection\n            s.Delete\n        Next s\n    Next objCht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 6104138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16587ca77066925c1845b34c0d6e9364?s=128&d=identicon&r=PG&f=1", "display_name": "Mobz", "link": "https://stackoverflow.com/users/6104138/mobz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1626, "favorite_count": 0, "accepted_answer_id": 36180055, "answer_count": 1, "score": 1, "last_activity_date": 1458740918, "creation_date": 1458735689, "question_id": 36178053, "link": "https://stackoverflow.com/questions/36178053/use-me-in-functions", "title": "Use Me. in functions", "body": "<p>First my sub looked like this:</p>\n\n<pre><code>Sub DeleteGraph()\n\nFor Each objCht In Me.ChartObjects\n    For Each s In objCht.Chart.SeriesCollection\n        s.Delete\n    Next s\nNext objCht\n\nEnd Sub\n</code></pre>\n\n<p>This didn't work when called from the main code because of Me.</p>\n\n<p>Then I tried this:</p>\n\n<pre><code>Sub Main()\n\n     Dim test As Worksheet\n     Set test = Me.CodeName\n     DeleteGraph test\nEnd sub\n\nSub DeleteGraph(sheets As Worksheet)\n    For Each objCht In sheets.ChartObjects\n        For Each s In objCht.Chart.SeriesCollection\n            s.Delete\n        Next s\n    Next objCht\nEnd Sub\n</code></pre>\n\n<p>This didn't work of the \"Set test = Me.CodeName\"</p>\n\n<p>I searched around the web and found out that I might have to use 'CallByName' but I can't seem to make it work. Is this the right approach and if so, how?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1458735769, "post_id": 36177937, "comment_id": 59991224, "body": "I did not think of that. Thanks a million! :)"}, {"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 1, "creation_date": 1458741815, "post_id": 36177937, "comment_id": 59995692, "body": "You could also use a character code for the quotes. In your string, you can use ...find(&quot; &amp; chr(34) &amp; &quot;,RC... instead of the double quotes. I don&#39;t think there&#39;s much difference, but I personally do it because it is easier for me to separate what quotes begin and end strings and what quotes belong inside strings."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 5, "last_activity_date": 1458735353, "creation_date": 1458735353, "answer_id": 36177937, "question_id": 36177779, "link": "https://stackoverflow.com/questions/36177779/my-vba-code-for-extracting-information-from-between-brackets-is-returning-a-type/36177937#36177937", "title": "My VBA code for extracting information from between brackets is returning a type mismatch, but I&#39;m not quite sure why.", "body": "<p><code>\"</code> quotes inside a <code>\"quoted\"</code> string need to be escaped (by doubling them) if they are not how would the compiler know where the string truly ended?</p>\n\n<pre><code>FormulaR1C1 = \"=mid(left(RC[-1],find(\"\" &gt; \"\",RC[-1])-1),find(\"\" &lt; \"\",RC[-1])+1,len(RC[-1]))\"\n</code></pre>\n\n<p>(In your current code <code>&lt;</code> &amp; <code>&gt;</code> are outside the string so are interpreted as the GT/LT operators)</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1458735720, "creation_date": 1458735720, "answer_id": 36178068, "question_id": 36177779, "link": "https://stackoverflow.com/questions/36177779/my-vba-code-for-extracting-information-from-between-brackets-is-returning-a-type/36178068#36178068", "title": "My VBA code for extracting information from between brackets is returning a type mismatch, but I&#39;m not quite sure why.", "body": "<p>Alex already gave the answer\nI only add this to reduce the code, if of interest</p>\n\n<pre><code>Sub test()\n\nDim Rng As Range\nDim i As Long\ni = 2\nWhile i &lt;= 20000\n    Set Rng = Range(\"B\" &amp; i)\n    If InStr(Rng, \"&lt;\") &gt; 0 Then\n        If InStr(Rng, \"&lt;\") &gt; 0 Then Rng.Offset(0, 1).FormulaR1C1 = \"=mid(left(RC[-1],find(\"\"&gt;\"\",RC[-1])-1),find(\"\"&lt;\"\",RC[-1])+1,len(RC[-1]))\"\n    End If\n    i = i + 1\nWend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 36177937, "answer_count": 2, "score": 0, "last_activity_date": 1458735720, "creation_date": 1458734841, "question_id": 36177779, "link": "https://stackoverflow.com/questions/36177779/my-vba-code-for-extracting-information-from-between-brackets-is-returning-a-type", "title": "My VBA code for extracting information from between brackets is returning a type mismatch, but I&#39;m not quite sure why.", "body": "<p>I have the following script written to separate characters between \"&lt;\" and \">\" in a range.</p>\n\n<p>What I have is:</p>\n\n<pre><code> Dim Rng As Range\n Dim i As Long\n i = 2\n While i &lt;= 20000\n\n Set Rng = Range(\"B\" &amp; i)\n\n If InStr(Rng, \"&lt;\") = 0 Then\n i = i + 1\n\n ElseIf InStr(Rng, \"&lt;\") &gt; 0 Then\n Rng.Offset(0, 1).FormulaR1C1 = \"=mid(left(RC[-1],find(\" &gt; \",RC[-1])-1),find(\" &lt; \",RC[-1])+1,len(RC[-1]))\"\n i = i + 1\n Else: i = i + 1\n End If\n Wend\n End Sub\n</code></pre>\n\n<p>This works well when I substitute the long formula with something simpler. Yet I'm getting a Type Mismatch when I run this. I have a feeling that I'm missing something very simple. Any suggestions?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["excel", "vba", "decimal", "point", "comma"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1458734941, "post_id": 36177218, "comment_id": 59990628, "body": "Excel use the system local settings to format numbers, currencies and times."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1458739061, "post_id": 36177218, "comment_id": 59993632, "body": "VBA is respecting the regional decimal symbol in its output.  It appears that Visio is not respecting the decimal symbol as being a comma, even though it is defined that way in your Windows Regional settings.  What version of Visio?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1458739776, "post_id": 36177218, "comment_id": 59994127, "body": "Another thought, from someone not familiar with Visio.  Perhaps you could <code>Round</code> or <code>Truncate</code> the value.  You may not need to specify the dimension to fractions of a millimeter.  eg.  <code>pgeWidth = Int(pgeWidth)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 0, "last_activity_date": 1458736831, "creation_date": 1458736831, "answer_id": 36178473, "question_id": 36177218, "link": "https://stackoverflow.com/questions/36177218/variable-using-decimal-comma-instead-of-decimal-point/36178473#36178473", "title": "Variable using decimal comma instead of decimal point", "body": "<p>If you want to pass the value further with point, consider converting variable to a string and then replacing comma with point:</p>\n\n<pre><code>pgeWidth = replace(CStr(pgeWidth), \",\",\".\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6103954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e8440f23944dc73b23afd955142b93?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Martin", "link": "https://stackoverflow.com/users/6103954/sam-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1049, "favorite_count": 0, "accepted_answer_id": 36178473, "answer_count": 1, "score": 0, "last_activity_date": 1458736831, "creation_date": 1458733263, "question_id": 36177218, "link": "https://stackoverflow.com/questions/36177218/variable-using-decimal-comma-instead-of-decimal-point", "title": "Variable using decimal comma instead of decimal point", "body": "<p>I have been using Excel VBA for a while now and I have come across a problem that I have never encountered before. I am using someone elses computer that is set up as Polish, so the decimal separator is set to comma. But even when I had my computer set up similarly in the past I did not have any problem.</p>\n\n<p>This current project creates a drawing in Visio.</p>\n\n<p>So, </p>\n\n<p>I have a variable of type double that is calculated as <code>pgeWidth = 550 / 1.4</code></p>\n\n<p>What I would expect is that VBA would calculate <code>pageWidth = 392.857...</code> \nHowever what VBA is doing is <code>pgeWidth = 392,857...</code> If I put a break in and check the value of pgeWidth it shows the value with a comma separator. pgeWidth is then set to the page width property in Visio which thinks it should be 392857.... mm wide which obviously gives an error. </p>\n\n<p>Why is VBA using a comma decimal separator instead of a point?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1458733629, "post_id": 36177202, "comment_id": 59989771, "body": "Seems like it is being referenced somewhere in your code."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1458733708, "post_id": 36177202, "comment_id": 59989829, "body": "Somewhere you declared a variable as that class. Search for the class name in the project."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1458739992, "post_id": 36177202, "comment_id": 59994298, "body": "Are you requiring all variables to be declared?  Is <code>Option Explicit</code> at the beginning of your regular module?  If it is, it may help to find the problem, although it should highlight even without that."}, {"owner": {"reputation": 36, "user_id": 6103935, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eZ5ZDr5fFnM/AAAAAAAAAAI/AAAAAAAAABk/G0Rl0m8EpCA/photo.jpg?sz=128", "display_name": "Geoff Kelly", "link": "https://stackoverflow.com/users/6103935/geoff-kelly"}, "edited": false, "score": 0, "creation_date": 1458864110, "post_id": 36177202, "comment_id": 60057085, "body": "Every module uses Option Explicit. I deleted all references to the class and cleared the contents of the class module, even changed the module name, and it still compiled correctly. So it is a mystery why it will not compile when I remove the class module from the project. I guess I can just leave it there, perhaps use it for some other code, but that concerns me there may be a deeper problem."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 6103935, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eZ5ZDr5fFnM/AAAAAAAAAAI/AAAAAAAAABk/G0Rl0m8EpCA/photo.jpg?sz=128", "display_name": "Geoff Kelly", "link": "https://stackoverflow.com/users/6103935/geoff-kelly"}, "is_accepted": false, "score": 1, "last_activity_date": 1458878859, "creation_date": 1458878859, "answer_id": 36213846, "question_id": 36177202, "link": "https://stackoverflow.com/questions/36177202/excel-vba-user-type-not-defined-after-removing-class-module/36213846#36213846", "title": "excel vba user type not defined after removing class module", "body": "<p>The problem was experienced using Excel 2016.\nThe problem was solved by opening the file in Excel 2007, which I fortunately retained before installing Office 365. In Excel 2007 I was able to remove the now empty class module and re-compile and save. On re-opening in Excel 2016, the project again compiled just fine.\nI repeated the process on another backup copy with both Excel 2007 and 2016 and the problem consistently occurs with Excel 2016 but not with Excel 2007.\nThanks for other's comments.</p>\n"}], "owner": {"reputation": 36, "user_id": 6103935, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eZ5ZDr5fFnM/AAAAAAAAAAI/AAAAAAAAABk/G0Rl0m8EpCA/photo.jpg?sz=128", "display_name": "Geoff Kelly", "link": "https://stackoverflow.com/users/6103935/geoff-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458878859, "creation_date": 1458733198, "question_id": 36177202, "link": "https://stackoverflow.com/questions/36177202/excel-vba-user-type-not-defined-after-removing-class-module", "title": "excel vba user type not defined after removing class module", "body": "<p>I have an Excel VBA Project which included a custom class module. I changed the code to remove all references to this class, then removed the class module after exporting it. The program then had a compile error</p>\n\n<blockquote>\n  <p>user type not defined</p>\n</blockquote>\n\n<p>I re-imported the custom class and the program compiled normally. I deleted all code and comments from the custom class module, leaving it as a blank module, and the program still compiled OK. Again, after removing the custom class I get the \"user type not defined\" error. \nNo offending code line is highlighted at any of the above steps.\nAny ideas?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1458746411, "post_id": 36177072, "comment_id": 59999491, "body": "I&#39;ve just posted some code that will generate a unique file name - <a href=\"http://stackoverflow.com/questions/36178243/update-the-file-name-on-workbook-beforesave\" title=\"update the file name on workbook beforesave\">stackoverflow.com/questions/36178243/&hellip;</a>.  Paste the <code>GenerateUniqueName</code> function into a module and on the line after <code>strFile = strFolderpath &amp; strFile</code> in your code add <code>strFile = GenerateUniqueName(strFile)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6103881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cff0de3dc7f2b16fe261b4ee2c54a77?s=128&d=identicon&r=PG&f=1", "display_name": "b2001", "link": "https://stackoverflow.com/users/6103881/b2001"}, "edited": false, "score": 0, "creation_date": 1458738156, "post_id": 36177969, "comment_id": 59992979, "body": "@ A Taylor....appreciate the response but that code doesn&#39;t seem get going. I&#39;m getting &#39;compile error&#39; at the &#39;Set messageAttachments.item(i).Attachments&#39; step. I saved the code as you posted under a new module and changed only the name of the folders. What am i doing wrong? Going back to the code i posted, would it be easier to add an &#39;if&#39; step at the point where the attachment is saved to the folder to check for an existing file name and if already exists then add a variation.. e.g &quot;v2&quot;?"}, {"owner": {"reputation": 142, "user_id": 6104192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed8b435f1ff1a3724366e2889470e075?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Taylor", "link": "https://stackoverflow.com/users/6104192/austin-taylor"}, "reply_to_user": {"reputation": 11, "user_id": 6103881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cff0de3dc7f2b16fe261b4ee2c54a77?s=128&d=identicon&r=PG&f=1", "display_name": "b2001", "link": "https://stackoverflow.com/users/6103881/b2001"}, "edited": false, "score": 0, "creation_date": 1458745191, "post_id": 36177969, "comment_id": 59998482, "body": "@b2001 I had an error in my code. Instead of   <code>Set messageAttachments.item(i).Attachments</code>  it would be:  <code>Set messageAttachments = folderItems.item(i).Attachments</code>  Hope this fixes it!"}, {"owner": {"reputation": 142, "user_id": 6104192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed8b435f1ff1a3724366e2889470e075?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Taylor", "link": "https://stackoverflow.com/users/6104192/austin-taylor"}, "reply_to_user": {"reputation": 11, "user_id": 6103881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cff0de3dc7f2b16fe261b4ee2c54a77?s=128&d=identicon&r=PG&f=1", "display_name": "b2001", "link": "https://stackoverflow.com/users/6103881/b2001"}, "edited": false, "score": 0, "creation_date": 1458745677, "post_id": 36177969, "comment_id": 59998842, "body": "@b2011  Also, that would be a good idea to add a &quot;v2&quot; to your file name that you are saving the attachment under. You can see that I included a <code>number = 1</code> to the file name (i.e. &quot;File1.xlsx&quot;), and then every time it saved, I added 1 to the integer <code>number</code>. Then, when it saved again, it would save as &quot;File2.xlsx&quot;. However, you can do this any way you&#39;d like."}, {"owner": {"reputation": 11, "user_id": 6103881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cff0de3dc7f2b16fe261b4ee2c54a77?s=128&d=identicon&r=PG&f=1", "display_name": "b2001", "link": "https://stackoverflow.com/users/6103881/b2001"}, "edited": false, "score": 0, "creation_date": 1458864593, "post_id": 36177969, "comment_id": 60057186, "body": "@ATaylor....that seems to have worked. Thank you. If i could improve the code it would be to delete the outlook message or attachment less I copy the same attachment again the next time i run the macro.The original code I used did do that....any way i can incorporate something similar? Thanks once again"}, {"owner": {"reputation": 142, "user_id": 6104192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed8b435f1ff1a3724366e2889470e075?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Taylor", "link": "https://stackoverflow.com/users/6104192/austin-taylor"}, "reply_to_user": {"reputation": 11, "user_id": 6103881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cff0de3dc7f2b16fe261b4ee2c54a77?s=128&d=identicon&r=PG&f=1", "display_name": "b2001", "link": "https://stackoverflow.com/users/6103881/b2001"}, "edited": false, "score": 0, "creation_date": 1458865935, "post_id": 36177969, "comment_id": 60057509, "body": "@b2011 Then you would use: <code>folderItems.item(i).Move DestFolder</code> after setting your DestFolder earlier. I&#39;ve edited my code in my original post above to demonstrate."}, {"owner": {"reputation": 142, "user_id": 6104192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed8b435f1ff1a3724366e2889470e075?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Taylor", "link": "https://stackoverflow.com/users/6104192/austin-taylor"}, "reply_to_user": {"reputation": 11, "user_id": 6103881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cff0de3dc7f2b16fe261b4ee2c54a77?s=128&d=identicon&r=PG&f=1", "display_name": "b2001", "link": "https://stackoverflow.com/users/6103881/b2001"}, "edited": false, "score": 0, "creation_date": 1458866951, "post_id": 36177969, "comment_id": 60057766, "body": "@b2001 Apologies. You could use <code>folderItems.item(i).Delete</code>, as you had previously in your code. Just add it at the end of the loop, and remember to loop backwards."}], "tags": [], "owner": {"reputation": 142, "user_id": 6104192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed8b435f1ff1a3724366e2889470e075?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Taylor", "link": "https://stackoverflow.com/users/6104192/austin-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1458866633, "last_edit_date": 1458866633, "creation_date": 1458735472, "answer_id": 36177969, "question_id": 36177072, "link": "https://stackoverflow.com/questions/36177072/save-attachments-to-a-folder-in-outlook-and-rename-them/36177969#36177969", "title": "Save attachments to a folder in outlook and rename them", "body": "<p>Take a look at my code below. It goes through all of the items in a specific Outlook folder (that you designate), goes through each attachment in each item, and saves the attachment in a specified file path. </p>\n\n<pre><code>'Establish path of folder you want to save to\n\nDim FilePath As Variant\n\nFilePath = \"C:\\Users\\Owner\\my folder is here\\my subfolder is here\\\"\n\n    Set FSOobj = CreateObject(\"Scripting.FilesystemObject\")\n\n    'If path doesn't exist, create it. If it does, either do nothing or delete its contents\n    If FSOobj.FolderExists(FilePath) = False Then\n        FSOobj.CreateFolder FilePath\n    Else\n        ' This code is if you want to delete the items in the existing folder first. \n        ' It's not necessary for your case.\n        On Error Resume Next\n        Kill FilePath &amp; \"*.*\"\n        On Error GoTo 0\n    End If\n\n'Establish Outlook folders, attachments, and other items\n\nDim msOutlook As Outlook.NameSpace 'Establish Outlook NameSpace\nDim Folder As Outlook.MAPIFolder 'Establish Folder as a MAPIFolder\nDim messageAttachments As Outlook.Attachments\n\nSet msOutlook = Application.GetNamespace(\"MAPI\")\n\n'Set the folder that contains the email with the attachment\nSet Folder = msOutlook.GetDefaultFolder(olFolderInbox).Folders(\"FOLDER NAME HERE\")\n\nSet folderItems = Folder.Items\n\nDim folderItemsCount As Long\nfolderItemsCount = folderItems.Count\n\nDim number as Integer\nnumber = 1\n\nFor i = 1 To folderItemsCount\n    'If you want to pull the attachments on some criteria, like the Subject of the email or \n    'the date received, you need to write an IF statement like:\n    'If InStr(Folder.Items(i).Subject, \"SPECIFIC SUBJECT TEXT\") Then\n\n    Set messageAttachments = folderItems.item(i).Attachments\n    lngCount = messageAttachments.Count 'This lets you pull more than one attachment per message\n    For thisAttachment = 1 To lngCount\n        messageAttachments.item(thisAttachment).SaveAsFile FilePath &amp; \"YOUR_CHOSEN_FILENAME\" &amp; number &amp; \".xlsx\"\n        number = number + 1\n    Next thisAttachment\nNext i\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>In order to delete the items after scraping the attachments, you would use the same code as above except you would also include <code>folderItems.item(i).Delete</code>. Also, since you are moving items, I switched to looping backwards in your <code>for</code> loop as to not mess up your iteration. I've written it below:</p>\n\n<pre><code>For i = folderItemsCount To 1 Step -1\n    'If you want to pull the attachments on some criteria, like the Subject of the email or \n    'the date received, you need to write an IF statement like:\n    'If InStr(Folder.Items(i).Subject, \"SPECIFIC SUBJECT TEXT\") Then\n\n    Set messageAttachments = folderItems.item(i).Attachments\n    lngCount = messageAttachments.Count 'This lets you pull more than one attachment per message\n    For thisAttachment = 1 To lngCount\n        messageAttachments.item(thisAttachment).SaveAsFile FilePath &amp; \"YOUR_CHOSEN_FILENAME\" &amp; number &amp; \".xlsx\"\n        number = number + 1\n    Next thisAttachment\n    folderItems.item(i).Delete\nNext i\n</code></pre>\n\n<p>I hope this helps!</p>\n"}], "owner": {"reputation": 11, "user_id": 6103881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cff0de3dc7f2b16fe261b4ee2c54a77?s=128&d=identicon&r=PG&f=1", "display_name": "b2001", "link": "https://stackoverflow.com/users/6103881/b2001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1291, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1458866633, "creation_date": 1458732799, "last_edit_date": 1495542230, "question_id": 36177072, "link": "https://stackoverflow.com/questions/36177072/save-attachments-to-a-folder-in-outlook-and-rename-them", "title": "Save attachments to a folder in outlook and rename them", "body": "<p>I am trying to save outlook attachments to a folder and where the filename already exists save the newer file under a different name so as not to save over the existing file....perhaps just give an extension \"v2\" or even \"v3\" if \"v2\" exists.</p>\n\n<p>I came across this answer but am finding that the newer file is saved over the existing file </p>\n\n<p><a href=\"https://stackoverflow.com/questions/15531093/save-attachments-to-a-folder-and-rename-them\">Save attachments to a folder and rename them</a></p>\n\n<p>I have used the below code;</p>\n\n<pre><code>Dim objAttachments As Outlook.Attachments\nDim objSelection As Outlook.Selection\nDim i As Long\nDim lngCount As Long\nDim strFile As String\nDim strFolderpath As String\nDim strDeletedFiles As String\n\n\n\n' Get the path to your My Documents folder\nstrFolderpath = \"C:\\Users\\Owner\\my folder is here\"\nOn Error Resume Next\n\n' Instantiate an Outlook Application object.\nSet objOL = CreateObject(\"Outlook.Application\")\n\n' Get the collection of selected objects.\nSet objSelection = objOL.ActiveExplorer.Selection\n\n' Set the Attachment folder.\nstrFolderpath = strFolderpath &amp; \"\\my subfolder is here\\\"\n\n' Check each selected item for attachments. If attachments exist,\n' save them to the strFolderPath folder and strip them from the item.\nFor Each objMsg In objSelection\n\n' This code only strips attachments from mail items.\n' If objMsg.class=olMail Then\n' Get the Attachments collection of the item.\nSet objAttachments = objMsg.Attachments\nlngCount = objAttachments.Count\nstrDeletedFiles = \"\"\n\nIf lngCount &gt; 0 Then\n\n    ' We need to use a count down loop for removing items\n    ' from a collection. Otherwise, the loop counter gets\n    ' confused and only every other item is removed.\n\n    For i = lngCount To 1 Step -1\n\n        ' Save attachment before deleting from item.\n        ' Get the file name.\n        strFile = objAttachments.Item(i).FileName\n\n        ' Combine with the path to the Temp folder.\n        strFile = strFolderpath &amp; strFile\n\n        ' Save the attachment as a file.\n        objAttachments.Item(i).SaveAsFile strFile\n\n\n        ' Delete the attachment.\n        objAttachments.Item(i).Delete\n\n        'write the save as path to a string to add to the message\n        'check for html and use html tags in link\n        If objMsg.BodyFormat &lt;&gt; olFormatHTML Then\n            strDeletedFiles = strDeletedFiles &amp; vbCrLf &amp; \"&lt;file://\" &amp; strFile &amp; \"&gt;\"\n        Else\n            strDeletedFiles = strDeletedFiles &amp; \"&lt;br&gt;\" &amp; \"&lt;a href='file://\" &amp; _\n            strFile &amp; \"'&gt;\" &amp; strFile &amp; \"&lt;/a&gt;\"\n        End If\n\n        'Use the MsgBox command to troubleshoot. Remove it from the final code.\n        'MsgBox strDeletedFiles\n\n    Next i\n\n    ' Adds the filename string to the message body and save it\n    ' Check for HTML body\n    If objMsg.BodyFormat &lt;&gt; olFormatHTML Then\n        objMsg.Body = vbCrLf &amp; \"The file(s) were saved to \" &amp; strDeletedFiles &amp; vbCrLf &amp; objMsg.Body\n    Else\n        objMsg.HTMLBody = \"&lt;p&gt;\" &amp; \"The file(s) were saved to \" &amp; strDeletedFiles &amp; \"&lt;/p&gt;\" &amp; objMsg.HTMLBody\n    End If\n    objMsg.Save\nEnd If\nNext\n\nExitSub:\n\nSet objAttachments = Nothing\nSet objMsg = Nothing\nSet objSelection = Nothing\nSet objOL = Nothing\nEnd Sub\n</code></pre>\n\n<p>I am relatively new to vba so perhaps the solution is there but am not seeing it!</p>\n"}, {"tags": ["sql", "excel", "vba", "oledb"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1458738289, "post_id": 36177029, "comment_id": 59993082, "body": "Can you provide the entire code block not just line snippets? Whether ADO or DAO is used and how recordsets are defined matters."}], "answers": [{"comments": [{"owner": {"reputation": 2785, "user_id": 2700593, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2082f9bdef8ba46ab9be67fe3a8e0c6d?s=128&d=identicon&r=PG&f=1", "display_name": "rex", "link": "https://stackoverflow.com/users/2700593/rex"}, "edited": false, "score": 0, "creation_date": 1458733331, "post_id": 36177220, "comment_id": 59989573, "body": "hmm using that string now gives me &quot;Could not find installable ISAM&quot;"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 2785, "user_id": 2700593, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2082f9bdef8ba46ab9be67fe3a8e0c6d?s=128&d=identicon&r=PG&f=1", "display_name": "rex", "link": "https://stackoverflow.com/users/2700593/rex"}, "edited": false, "score": 0, "creation_date": 1458733387, "post_id": 36177220, "comment_id": 59989614, "body": "Which version of Excel do you have?"}, {"owner": {"reputation": 2785, "user_id": 2700593, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2082f9bdef8ba46ab9be67fe3a8e0c6d?s=128&d=identicon&r=PG&f=1", "display_name": "rex", "link": "https://stackoverflow.com/users/2700593/rex"}, "edited": false, "score": 0, "creation_date": 1458733587, "post_id": 36177220, "comment_id": 59989736, "body": "Excel 2010 on windows 7"}, {"owner": {"reputation": 2785, "user_id": 2700593, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2082f9bdef8ba46ab9be67fe3a8e0c6d?s=128&d=identicon&r=PG&f=1", "display_name": "rex", "link": "https://stackoverflow.com/users/2700593/rex"}, "edited": false, "score": 0, "creation_date": 1458735711, "post_id": 36177220, "comment_id": 59991177, "body": "Thatnks, the connection string works but i still have the same problem."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 2785, "user_id": 2700593, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2082f9bdef8ba46ab9be67fe3a8e0c6d?s=128&d=identicon&r=PG&f=1", "display_name": "rex", "link": "https://stackoverflow.com/users/2700593/rex"}, "edited": false, "score": 0, "creation_date": 1458735859, "post_id": 36177220, "comment_id": 59991287, "body": "I tried the same query and it worked. I&#39;m on win8 excel 2010."}, {"owner": {"reputation": 2785, "user_id": 2700593, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2082f9bdef8ba46ab9be67fe3a8e0c6d?s=128&d=identicon&r=PG&f=1", "display_name": "rex", "link": "https://stackoverflow.com/users/2700593/rex"}, "edited": false, "score": 0, "creation_date": 1458736236, "post_id": 36177220, "comment_id": 59991572, "body": "I found the problem. Since the workbook is xlsx, i need to fully qualify it with a &quot;.&quot; in the path. I saved the file to .XLS and now i can refer to the workbook without the . and it works....."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 2785, "user_id": 2700593, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2082f9bdef8ba46ab9be67fe3a8e0c6d?s=128&d=identicon&r=PG&f=1", "display_name": "rex", "link": "https://stackoverflow.com/users/2700593/rex"}, "edited": false, "score": 0, "creation_date": 1458736251, "post_id": 36177220, "comment_id": 59991583, "body": "Also make sure that Sheet1 is the correct sheet. The Sheet.Name can be different from the Sheet.CodeName and the driver tries the codename first."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1458734553, "last_edit_date": 1458734553, "creation_date": 1458733266, "answer_id": 36177220, "question_id": 36177029, "link": "https://stackoverflow.com/questions/36177029/vba-sql-no-value-given-for-one-or-more-required-parameters-but-field-exists/36177220#36177220", "title": "VBA SQL &#39;No value given for one or more required parameters&#39; but field exists", "body": "<p>Try with this one:</p>\n\n<pre><code>strConnection = \"Provider=Microsoft.Jet.OLEDB.4.0\" _\n              &amp; \";Data Source=\" &amp; workbookPath _\n              &amp; \";Extended Properties=\"\"Excel 8.0;HDR=Yes;IMEX=1\"\";\"\n</code></pre>\n"}], "owner": {"reputation": 2785, "user_id": 2700593, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2082f9bdef8ba46ab9be67fe3a8e0c6d?s=128&d=identicon&r=PG&f=1", "display_name": "rex", "link": "https://stackoverflow.com/users/2700593/rex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 431, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458734553, "creation_date": 1458732715, "question_id": 36177029, "link": "https://stackoverflow.com/questions/36177029/vba-sql-no-value-given-for-one-or-more-required-parameters-but-field-exists", "title": "VBA SQL &#39;No value given for one or more required parameters&#39; but field exists", "body": "<p>I am trying to run sql queries on one spreadsheet from another in Excel 2010 VBA.</p>\n\n<p>My connection is set up properly and works as expected, except for 1 column, which for some reason is giving me this error. I checked the name of the column and I also tried renaming it to something super simple, but it still still doesn't. Can anyone think of what else the issue might be. All other columns work for selecting.</p>\n\n<blockquote>\n<pre><code>strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; workbookPath _\n                            &amp; \";Extended Properties=\"\"Excel 12.0;HDR=Yes;IMEX=1\"\";\"\n</code></pre>\n</blockquote>\n\n<p>This is the query, it works for all other fields except the \"Ticker Number\" column. I tried renaming it in the source file but no luck...</p>\n\n<blockquote>\n  <p>sqlString = \"SELECT [Ticket Number] FROM [Sheet1$A1:Z100]\"</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1458733778, "post_id": 36177083, "comment_id": 59989875, "body": "Since there are times involved, using a Double would be better."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458733871, "post_id": 36177083, "comment_id": 59989945, "body": "Good idea! :) Done"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1458733990, "post_id": 36177083, "comment_id": 59990012, "body": "<code>Double</code> would also facilitate comparing mixed <i>date/times</i>"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1458733860, "last_edit_date": 1458733860, "creation_date": 1458732854, "answer_id": 36177083, "question_id": 36176843, "link": "https://stackoverflow.com/questions/36176843/using-evaluate-to-compare-date-type-and-int-type/36177083#36177083", "title": "Using Evaluate to compare date type and int type", "body": "<p>If your date was in the format <code>dd/mm/yyyy</code> then the evaluate expression would have worked but it is in the format <code>m/dd/yyyy hh:mm:ss am/pm</code></p>\n\n<p>Since we know that Excel stores the date and time in number format, simply try this and it will work :)</p>\n\n<pre><code>Dim myDate1 As Double\nDim myDate2 As Double\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6056982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db52bb3a2deb6dd01bf016b24d81ce6?s=128&d=identicon&r=PG&f=1", "display_name": "CSEbe", "link": "https://stackoverflow.com/users/6056982/csebe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 36177083, "answer_count": 1, "score": 2, "last_activity_date": 1459255019, "creation_date": 1458732231, "last_edit_date": 1459255019, "question_id": 36176843, "link": "https://stackoverflow.com/questions/36176843/using-evaluate-to-compare-date-type-and-int-type", "title": "Using Evaluate to compare date type and int type", "body": "<p>I've been trying to use the Evaluate function in Excel (office2010) to compare date types but keep running into the wall. Appreciate any help.<br>\nBelow is the subroutine used</p>\n\n<pre><code>Sub tyrEval()\nDim myDate1 As Date\nDim myDate2 As Date\nDim myInt1 As Integer\nDim myInt2 As Integer\nDim myBool As Boolean\nDim myBool1 As Boolean\nDim myBool2 As Boolean\nDim myOperator As String\nmyDate1 = CDate(\"3/13/2016 01:04:53 am\")\nmyDate2 = CDate(\"3/13/2016 12:23:37 am\")\nmyOperator = \"&gt;\"\nmyInt1 = 7\nmyInt2 = 6\n\nmyBool = Evaluate(myInt1 &amp; myOperator &amp; myInt2)\nmyBool1 = Evaluate(myDate1 &amp; myOperator &amp; myDate2)\nmyBool2 = myDate1 &gt; myDate2\n\n'myBool1 = Evaluate(Chr(34) &amp; myDate1 &amp; Chr(34) &amp; myOperator &amp; Chr(34) &amp; myDate2 &amp; Chr(34)) - working but wrong answer\n'myBool1 = Evaluate(Chr(34) &amp; \"myDate1\" &amp; Chr(34) &amp; myOperator &amp; Chr(34) &amp; \"myDate2\" &amp; Chr(34)) - working but wrong answer    \n'myBool = Evaluate(myInt1 &amp; myOperator &amp; myInt2) - works    \nEnd Sub\n</code></pre>\n\n<p>When I step through the code I get a 'Type Mismatch error' at </p>\n\n<pre><code>myBool1 = Evaluate(myDate1 &amp; myOperator &amp; myDate2)\n</code></pre>\n\n<p>The myBool and myBool2 are getting results as expected.  I cant figure out my error in the myBool1 statement.  I have tried adding chr(34) across various locations but it dint get me anywhere.  The commented-out line shows one such variation which came up as myBool1 ='FALSE' which I'm guessing that the compare operation is being done as a string type and not as a date type.  </p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1458732790, "post_id": 36176793, "comment_id": 59989236, "body": "The Code itself works, it highlights the cell where the Hex Code is in. Could you post a screenshot of your table, so we can see what you really mean by &quot;hidden inside the cells&quot; and how you did hide the data?"}, {"owner": {"reputation": 1, "user_id": 6098132, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209001685343500/picture?type=large", "display_name": "John H", "link": "https://stackoverflow.com/users/6098132/john-h"}, "reply_to_user": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1458733678, "post_id": 36176793, "comment_id": 59989806, "body": "Here&#39;s a screenshot with an explanation: <a href=\"http://i.imgur.com/mxOBbNb.png\" rel=\"nofollow noreferrer\">i.imgur.com/mxOBbNb.png</a> Does this code move through all the cells in the document or is it maybe getting stuck somewhere. The top of the document with Date/Time etc is also a table, I&#39;m wondering if it&#39;s getting stuck up there?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6098132, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209001685343500/picture?type=large", "display_name": "John H", "link": "https://stackoverflow.com/users/6098132/john-h"}, "edited": false, "score": 1, "creation_date": 1458734864, "post_id": 36177700, "comment_id": 59990560, "body": "oh wow thanks, that looks like it works perfectly. Thanks so much!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "edited": false, "score": 1, "creation_date": 1458735136, "post_id": 36177700, "comment_id": 59990748, "body": "FWIW A Select Case might be a better approach than ElseIf."}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1458735176, "post_id": 36177700, "comment_id": 59990778, "body": "Yeah, obviously. Edited my answer"}, {"owner": {"reputation": 1, "user_id": 6098132, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209001685343500/picture?type=large", "display_name": "John H", "link": "https://stackoverflow.com/users/6098132/john-h"}, "edited": false, "score": 0, "creation_date": 1458735542, "post_id": 36177700, "comment_id": 59991058, "body": "Ah yeah I saw an example that used Select Case but tbh I don&#39;t fully grasp it. I know where I am with If statements at least ;)"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": true, "score": 0, "last_activity_date": 1458735207, "last_edit_date": 1458735207, "creation_date": 1458734657, "answer_id": 36177700, "question_id": 36176793, "link": "https://stackoverflow.com/questions/36176793/use-word-vba-to-color-cells-in-tables-based-on-cell-value/36177700#36177700", "title": "Use Word VBA to color cells in tables based on cell value", "body": "<p>Your Code is getting stuck nowhere. But you are checking the whole Cell Value against the Hex code, and this will not work since \"blablabla FFFFFF\" is never equal to \"FFFFFF\". So you have to check if the Hex code is in the Cell value:</p>\n\n<pre><code>Sub ColourIn()\n\nDim oTbl As Table\nDim oCel As Cell\nDim oRng As Range\nDim oClr As String\n\nFor Each oTbl In ActiveDocument.Tables\n\n    For Each oCel In oTbl.Range.Cells\n\n        Set oRng = oCel.Range\n        oRng.End = oRng.End - 1\n\n        Dim cellvalue As String\n\n        'check if Colorcode is in cell\n        If InStr(oRng, \"CCFFCC\") Then\n\n            'Set Cell color\n            oCel.Shading.BackgroundPatternColor = wdColorLightYellow\n\n            'Remove Colorcode from Cell\n            cellvalue = Replace(oRng, \"CCFFCC\", \"\")\n\n            'load new value into cell\n            oRng = cellvalue\n        End If\n    Next\nNext\nEnd Sub\n</code></pre>\n\n<p>Now you just have to add all the colors you want to use (I would prefer a Select Case statement) and the code should work fine</p>\n"}], "owner": {"reputation": 1, "user_id": 6098132, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209001685343500/picture?type=large", "display_name": "John H", "link": "https://stackoverflow.com/users/6098132/john-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1676, "favorite_count": 0, "accepted_answer_id": 36177700, "answer_count": 1, "score": -1, "last_activity_date": 1458768825, "creation_date": 1458732102, "last_edit_date": 1458768825, "question_id": 36176793, "link": "https://stackoverflow.com/questions/36176793/use-word-vba-to-color-cells-in-tables-based-on-cell-value", "title": "Use Word VBA to color cells in tables based on cell value", "body": "<p>In Word I have a document with multiple tables full of data. Hidden inside these cells (out of view but the data is there) is the Hex code of the color I want to shade the cells. I chose the hex value just because it's relatively short and it's a unique bit of text that won't be confused with the rest of the text in the cell.</p>\n\n<p>I've found some code online to modify but I can't seem to make it work. It doesn't give any errors, just nothing happens. I feel like the problem is in searching the tables for the text value but I've spent hours on this and I think I've confused myself now!</p>\n\n<pre><code>Sub ColourIn()\n\nDim oTbl As Table\nDim oCel As Cell\nDim oRng As Range\nDim oClr As String\n\nFor Each oTbl In ActiveDocument.Tables\nFor Each oCel In oTbl.Range.Cells\nSet oRng = oCel.Range\noRng.End = oRng.End - 1\n\nIf oRng = \"CCFFCC\" Then\noCel.Shading.BackgroundPatternColor = wdColorLightYellow\nEnd If\nIf oRng = \"FFFF99\" Then\noCel.Shading.BackgroundPatternColor = wdColorPaleBlue\nEnd If\n\nNext\nNext\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n\n<p>Edit:</p>\n\n<p>I've also tried this code wit the same result of nothing happening:</p>\n\n<pre><code>Sub EachCellText()\n\nDim oCell As Word.Cell\nDim strCellString As String\n\nFor Each oCell In ActiveDocument.Tables(1).Range.Cells\nstrCellString = Left(oCell.Range.Text, _\nLen(oCell.Range.Text) - 1)\n\nIf strCellString = \"CCFFFF\" Then\noCell.Shading.BackgroundPatternColor = wdColorLightGreen\nIf strCellString = \"CCFFCC\" Then\noCell.Shading.BackgroundPatternColor = wdColorLightYellow\nIf strCellString = \"FFFF99\" Then\noCell.Shading.BackgroundPatternColor = wdColorPaleBlue\n\nEnd If\nEnd If\nEnd If\n\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1458732219, "post_id": 36176664, "comment_id": 59988868, "body": "Your destination argument is non-existent.  Look at Help for the range.copy method"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5324729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/026d920e03bb2593dc2a85a313f49aca?s=128&d=identicon&r=PG&f=1", "display_name": "JKlein", "link": "https://stackoverflow.com/users/5324729/jklein"}, "is_accepted": false, "score": 0, "last_activity_date": 1458732209, "creation_date": 1458732209, "answer_id": 36176839, "question_id": 36176664, "link": "https://stackoverflow.com/questions/36176664/copy-rows-with-certain-value-vba-excel/36176839#36176839", "title": "Copy rows with certain value vba excel", "body": "<p>If this is really all of your code, you forgot to paste your copied row to the new sheet.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 3237076, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/33662c3c59339d32f3fb89ceef410bb1?s=128&d=identicon&r=PG&f=1", "display_name": "user3237076", "link": "https://stackoverflow.com/users/3237076/user3237076"}, "edited": false, "score": 0, "creation_date": 1458733779, "post_id": 36177112, "comment_id": 59989877, "body": "Object variable or with block not set. While try to debug it stops near copy comand."}, {"owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "reply_to_user": {"reputation": 45, "user_id": 3237076, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/33662c3c59339d32f3fb89ceef410bb1?s=128&d=identicon&r=PG&f=1", "display_name": "user3237076", "link": "https://stackoverflow.com/users/3237076/user3237076"}, "edited": false, "score": 0, "creation_date": 1458734471, "post_id": 36177112, "comment_id": 59990298, "body": "I changed the code such that the range is only copied if copiedRange is not empty. Does it work now? If not, can you upload your table? Because the code works just fine for me."}], "tags": [], "owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "is_accepted": true, "score": 2, "last_activity_date": 1458734379, "last_edit_date": 1458734379, "creation_date": 1458732947, "answer_id": 36177112, "question_id": 36176664, "link": "https://stackoverflow.com/questions/36176664/copy-rows-with-certain-value-vba-excel/36177112#36177112", "title": "Copy rows with certain value vba excel", "body": "<p>The following copies all rows containing \"Energizer\" in column A into the clipboard. </p>\n\n<pre><code>    Sub Macro3()\n    Dim rngA As Range\n    Dim cell As Range\n    Dim col As Range\n    Dim copiedRange As Range\n    Dim r As Integer\n\n    Set col = Cells(Rows.Count, \"A\").End(xlUp)\n    r = 0\n    Set rngA = Range(\"A2\", col)\n\n    For Each cell In rngA\n        If cell.Value = \"Energizer\" Then\n            If r = 0 Then\n                Set copiedRange = cell.EntireRow\n                r = 1\n            Else\n                Set copiedRange = Union(copiedRange, cell.EntireRow)\n            End If\n        End If\n    Next cell\n\n\n    If r = 1 Then\n        copiedRange.Copy\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>As mentioned in the code, if you want to copy the rows directly to a new sheet, add the destination after the copy command. </p>\n"}], "owner": {"reputation": 45, "user_id": 3237076, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/33662c3c59339d32f3fb89ceef410bb1?s=128&d=identicon&r=PG&f=1", "display_name": "user3237076", "link": "https://stackoverflow.com/users/3237076/user3237076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 0, "accepted_answer_id": 36177112, "answer_count": 2, "score": 0, "last_activity_date": 1458734379, "creation_date": 1458731748, "question_id": 36176664, "link": "https://stackoverflow.com/questions/36176664/copy-rows-with-certain-value-vba-excel", "title": "Copy rows with certain value vba excel", "body": "<p>Hi all I have a sheet with more then 60 000 rows and I want to copy all rows to a new sheet if column of row contains certain value for example Energizer like in the following code</p>\n\n<pre><code> Sub Macro3()\n    Dim rngA As Range\n    Dim cell As Range\n    Set col = Cells(Rows.Count, \"A\").End(xlUp)\n\n    Set rngA = Range(\"A2\", col)\n    For Each cell In rngA\n        If cell.Value = \"Energizer\" Then\n            cell.EntireRow.Copy\n\n        End If\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>Code doesn't work at all what could be done?</p>\n"}, {"tags": ["excel", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458731783, "post_id": 36176471, "comment_id": 59988595, "body": "You&#39;d get the object variable error if the search value isn&#39;t found in that row."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458731923, "post_id": 36176471, "comment_id": 59988681, "body": "But It is. in 1st row I have column named &quot;\u0160tevilo&quot;. I forgot to mention - this code worked properly for 2 weeks, now suddently It doesn&#39;t..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458733657, "post_id": 36176471, "comment_id": 59989794, "body": "Does: <code>i = XcelApp.Match(&quot;\u0160tevilo&quot;, XcelApp.Rows(1), 0)</code> work?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458734011, "post_id": 36176471, "comment_id": 59990024, "body": "You are using latebinding? In that case you will also have to pass values for <code>xlValues</code> and <code>xlWhole</code>. Which is <code>-4163</code> and <code>1</code> respectively."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458734098, "post_id": 36176471, "comment_id": 59990072, "body": "I would also recommend going through <a href=\"http://www.siddharthrout.com/2011/07/14/find-and-findnext-in-excel-vba/\" rel=\"nofollow noreferrer\">THIS</a> link on how to use <code>.Find</code>"}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458734381, "post_id": 36176471, "comment_id": 59990254, "body": "@Rory,yes It looks like IT works, but then It stucks in next line, with declaring x."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458735705, "post_id": 36176471, "comment_id": 59991167, "body": "@SiddharthRout,I have tried various methods before, I&#39;ll try this one too, but I had simmilar solution allready and It didn&#39;t work. Everything works in Excel, but not from Access."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458736858, "post_id": 36176471, "comment_id": 59991995, "body": "That suggests that the text is not being found. Are you sure the correct sheet is active, and it&#39;s an exact match?"}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1458737258, "post_id": 36176471, "comment_id": 59992294, "body": "Yes, i&#39;m sure. Data is only in Sheet1, nowhere else. And exact string is &quot;\u0160tevilo&quot;, that is column name. I had simmilar problems before, when column names has dots (.) in their names - I figured that Access replaces dots with #. Is character &quot;\u0160&quot; in my column name maybe a problem ? Unfortunally, this character mustn&#39;t be changed."}], "answers": [{"tags": [], "owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "is_accepted": true, "score": 0, "last_activity_date": 1464082518, "creation_date": 1464082518, "answer_id": 37409666, "question_id": 36176471, "link": "https://stackoverflow.com/questions/36176471/access-vba-loop-through-excel-columns/37409666#37409666", "title": "Access VBa - loop through Excel columns", "body": "<p>I have manged to get It working:</p>\n\n<pre><code> Sub Xceltest()\n\n        Dim XcelApp As Object\n\n        Dim x, i\n        Set XcelApp = CreateObject(\"Excel.Application\")\n        XcelApp.ScreenUpdating = False\n\n        XcelApp.Workbooks.Open(\"C:\\Users\\Lucky\\Desktop\\Test\\Sample.xlsx\")\n\n   With XcelApp\n\ni = XcelApp.Rows(1).Find(What:=\"\u0160tevilo\", LookIn:=xlValues, Lookat:=xlWhole).Column\n\nx = XcelApp.Range(XcelApp.Cells(1, i), XcelApp.Cells(XcelApp.Rows.Count, i).End(xlUp)).Value\n\n        For i = 2 To UBound(x)\n            If Not IsNumeric(x(i, 1)) Then\n\n            ExcelApp.Quit\n            Set ExcelApp = Nothing\n            MsgBox \"This Excel file is not valid\"\n        : Exit Sub\n\n            End If\n\n        Next i\n\n        End With\n\n        XcelApp.Quit\n        XcelApp = Nothing\n\n        End Sub\n</code></pre>\n\n<p>I just had to remove ExcelBook from code, now It works fine.</p>\n"}], "owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1416, "favorite_count": 0, "accepted_answer_id": 37409666, "answer_count": 1, "score": 0, "last_activity_date": 1594642078, "creation_date": 1458731275, "last_edit_date": 1594642078, "question_id": 36176471, "link": "https://stackoverflow.com/questions/36176471/access-vba-loop-through-excel-columns", "title": "Access VBa - loop through Excel columns", "body": "<p>I'm having troubles with looping through Excel file from Access. Here is my code:</p>\n\n<pre><code>     Sub Xceltest()\n\n        Dim XcelApp As Object\n        Dim XcelBook As Excel.Workbook\n        Dim x, i\n        Set XcelApp = CreateObject(\"Excel.Application\")\n        XcelApp.ScreenUpdating = False\n\nSet XcelBook = XcelApp.Workbooks.Open(\"C:\\Users\\Lucky\\Desktop\\Test\\Sample.xlsx\")\n\n   With XcelBook\n\ni = XcelApp.Rows(1).Find(What:=\"\u0160tevilo\", LookIn:=xlValues, Lookat:=xlWhole).Column\n\nx = XcelApp.Range(XcelApp.Cells(1, i), XcelApp.Cells(XcelApp.Rows.Count, i).End(xlUp)).Value\n\n        For i = 2 To UBound(x)\n            If Not IsNumeric(x(i, 1)) Then\n\n            ExcelApp.Quit\n            Set ExcelApp = Nothing\n            MsgBox \"This Excel file is not valid\"\n        : Exit Sub\n\n            End If\n\n        Next i\n\n        End With\n\n        XcelApp.Quit\n        XcelApp = Nothing\n\n        End Sub\n</code></pre>\n\n<p>Whatever I do, I always get an error in this line:</p>\n\n<pre><code>i = XcelApp.Rows(1).Find(What:=\"\u0160tevilo\", LookIn:=xlValues, Lookat:=xlWhole).Column\n</code></pre>\n\n<p>or this one:</p>\n\n<pre><code> For i = 2 To UBound(x)\n</code></pre>\n\n<p>Errors are \"object doesn't support this property or method\"  or \"object variable or with block variable not set\". How can I fix this, does anybody have a clue ??</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1458731920, "post_id": 36175965, "comment_id": 59988678, "body": "I suggest you set breakpoints and use the <code>Locals</code> window to examine the status of your variables as the code executes.  That should point you in the right direction."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1458732132, "post_id": 36175965, "comment_id": 59988821, "body": "fwiw, the way you have it set up all three comparisons have to fail. If you want it to fail on only one mismatch then change the two <code>And</code> to <code>Or</code>. Additionally, you are exiting the loop after getting your first &#39;hit&#39;"}], "owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458744834, "creation_date": 1458729843, "last_edit_date": 1458744834, "question_id": 36175965, "link": "https://stackoverflow.com/questions/36175965/excel-vba-not-equal-not-working", "title": "Excel VBA Not Equal not working", "body": "<p>Hi have found a macro on another forum that solved my problem: It copies cells from Sheet 2 matching Sheet 1.</p>\n\n<p>Sub Compare()</p>\n\n<pre><code>Dim WS As Worksheet\nSet WS = Sheets(\"Master\")\n\nDim RowsMaster As Integer, Rows2 As Integer\nDim Rows3 As Integer\nRowsMaster = WS.Cells(1048576, 1).End(xlUp).Row\nRows2 = Worksheets(2).Cells(1048576, 1).End(xlUp).Row\nRows3 = WS.Cells(WS.Rows.Count, 1).End(xlUp).Row\n' Get the number of used rows for each sheet\nScreenUpdating = False\nWith Worksheets(2)\n    For i = 2 To Rows2\n    ' Loop through Sheet 2\n        For j = 2 To RowsMaster\n        ' Loop through the Master sheet\n            'below line checks for matches to variable number, file and field\n            If .Cells(i, 1) = WS.Cells(j, 1) And .Cells(i, 3) = WS.Cells(j, 3) And .Cells(i, 4) = WS.Cells(j, 4) Then\n            ' If a match is found:\n                WS.Cells(j, 6) = .Cells(i, 1)\n                  WS.Cells(j, 7) = .Cells(i, 2)\n                    WS.Cells(j, 8) = .Cells(i, 3)\n                      WS.Cells(j, 9) = .Cells(i, 4)\n\n                ' above copies in the data\n                 Exit For\n                ' No point in continuing the search for that company\n\n            ElseIf j = RowsMaster Then\n            ' If we got to the end of the Master sheet\n            ' and haven't found a company match\n\n                Rows3 = Rows3 + 1\n                ' Increment the number of rows\n                For k = 1 To 4\n                'For l = 2 To 4 ' Change 3 to however many fields Sheet2 has\n\n                    WS.Cells(Rows3, 11) = .Cells(i, k)\n                    ' Copy the data from Sheet2 in on the bottom row of Master\n                Next\n            End If\n\n        Next j\n    Next i\nEnd With\nScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This code matches up the values from sheet2 to master. The ones that dont match end up in cell K6 only - what I need is for the ones that done match to start in column K (4 columns of date K:N) and then each one on a new row.</p>\n\n<p>Can anyone help me with this - been working on it for 2 days and cant get it working!</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "csv"], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "is_accepted": false, "score": 1, "last_activity_date": 1458730110, "creation_date": 1458730110, "answer_id": 36176072, "question_id": 36175903, "link": "https://stackoverflow.com/questions/36175903/export-multiple-worksheets-to-csv-and-specify-save-folder/36176072#36176072", "title": "Export multiple worksheets to CSV and specify save folder", "body": "<p>You need to specify the location you want it saved to in the code.</p>\n\n<p>Try this.</p>\n\n<pre><code>.SaveAs FileName:=\"C:\\OutputFilepath\\\" &amp; ws.Name &amp; \".csv\", FileFormat:=xlCSV, CreateBackup:=False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 2653322, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1f44b7da4be06b8f22dec6a97095bfa3?s=128&d=identicon&r=PG", "display_name": "user2653322", "link": "https://stackoverflow.com/users/2653322/user2653322"}, "edited": false, "score": 0, "creation_date": 1458735423, "post_id": 36176104, "comment_id": 59990960, "body": "Struggling to make this work, probably because I&#39;m on a mac running OS X.  Tried dropping in &quot;/Users/myusername/Desktop&quot; as a path, but it&#39;s not working? Any ideas?"}, {"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "edited": false, "score": 0, "creation_date": 1458747898, "post_id": 36176104, "comment_id": 60000638, "body": "add another &quot;/&quot; after Desktop. &quot;/Users/myusername/Desktop/&quot; Directory locations end with a forward slash."}], "tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": false, "score": 1, "last_activity_date": 1458730202, "creation_date": 1458730202, "answer_id": 36176104, "question_id": 36175903, "link": "https://stackoverflow.com/questions/36175903/export-multiple-worksheets-to-csv-and-specify-save-folder/36176104#36176104", "title": "Export multiple worksheets to CSV and specify save folder", "body": "<p>Replace this line</p>\n\n<pre><code>.SaveAs ws.Name &amp; \".csv\", xlCSVWindows\n</code></pre>\n\n<p>With</p>\n\n<pre><code>.SaveAs \"D:\\MyFolder\\\" &amp; ws.Name &amp; \".csv\", xlCSVWindows\n</code></pre>\n\n<p>Change the \"D:\\MyFolder\\\" to your desired path.</p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 2653322, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1f44b7da4be06b8f22dec6a97095bfa3?s=128&d=identicon&r=PG", "display_name": "user2653322", "link": "https://stackoverflow.com/users/2653322/user2653322"}, "edited": false, "score": 0, "creation_date": 1458733478, "post_id": 36176107, "comment_id": 59989659, "body": "Hi, could you explain the environ(&quot;TEMP&quot;) &amp; Chr(92) bit? The Chr(92) has confused me."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 105, "user_id": 2653322, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1f44b7da4be06b8f22dec6a97095bfa3?s=128&d=identicon&r=PG", "display_name": "user2653322", "link": "https://stackoverflow.com/users/2653322/user2653322"}, "edited": false, "score": 0, "creation_date": 1458747097, "post_id": 36176107, "comment_id": 60000017, "body": "The ninety-second character in the ASCII table is the backslash. The <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264486.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Environ function</a> does not typically end with one."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1458730215, "creation_date": 1458730215, "answer_id": 36176107, "question_id": 36175903, "link": "https://stackoverflow.com/questions/36175903/export-multiple-worksheets-to-csv-and-specify-save-folder/36176107#36176107", "title": "Export multiple worksheets to CSV and specify save folder", "body": "<p>Add a string type var that contains the full path to the folder. In the following example, I'll use the temp directory.</p>\n\n<pre><code>Sub asdf()\n\n    Dim ws As Worksheet, newWb As Workbook, fp as string\n\n    fp = environ(\"TEMP\") &amp; Chr(92)\n    'could be something like\n    'fp = environ(\"USER\") &amp; \"\\desktop\\\"\n\n    Application.ScreenUpdating = False\n    For Each ws In Sheets(Array(\"sheet1\", \"sheet2\", \"sheet3\"))\n       ws.Copy\n       Set newWb = ActiveWorkbook\n       With newWb\n          .SaveAs fp &amp; ws.Name, xlCSVWindows   'add the path, let saveas add the extension\n          .Close savechanges:=False\n       End With\n    Next ws\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 2653322, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1f44b7da4be06b8f22dec6a97095bfa3?s=128&d=identicon&r=PG", "display_name": "user2653322", "link": "https://stackoverflow.com/users/2653322/user2653322"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1458730354, "creation_date": 1458729701, "last_edit_date": 1458730354, "question_id": 36175903, "link": "https://stackoverflow.com/questions/36175903/export-multiple-worksheets-to-csv-and-specify-save-folder", "title": "Export multiple worksheets to CSV and specify save folder", "body": "<p>I've got this Macro working beautifully, but every now and again it will save the exported sheets into the last folder I was working in, and not the specific folder I want them in. How do I specify the folder they should go into?</p>\n\n<pre><code>Sub asdf()\nDim ws As Worksheet, newWb As Workbook\n\nApplication.ScreenUpdating = False\nFor Each ws In Sheets(Array(\"sheet1\", \"sheet2\", \"sheet3\"))\n   ws.Copy\n   Set newWb = ActiveWorkbook\n   With newWb\n      .SaveAs ws.Name &amp; \".csv\", xlCSVWindows\n      .Close (False)\n   End With\nNext ws\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "edited": false, "score": 2, "creation_date": 1458728215, "post_id": 36175281, "comment_id": 59986176, "body": "try FileFormat:=52"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1458729352, "creation_date": 1458729352, "answer_id": 36175768, "question_id": 36175281, "link": "https://stackoverflow.com/questions/36175281/run-time-error-1004-application-defined-or-object-defined/36175768#36175768", "title": "run-time error &#39;1004&#39; application-defined or object-defined", "body": "<p>25 is an International Macro format.</p>\n\n<p>You want <strong>52</strong>, which is Open XML Macro Enabled.</p>\n\n<p>You can also use the <code>xlFileFormat</code> enumeration:</p>\n\n<pre><code>ActiveSheet.SaveAs Filename:=varDirectory, FileFormat:=xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6103560, "user_type": "registered", "profile_image": "https://graph.facebook.com/966442950076304/picture?type=large", "display_name": "Philippe Fassin", "link": "https://stackoverflow.com/users/6103560/philippe-fassin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458734120, "creation_date": 1458728043, "last_edit_date": 1531164843, "question_id": 36175281, "link": "https://stackoverflow.com/questions/36175281/run-time-error-1004-application-defined-or-object-defined", "title": "run-time error &#39;1004&#39; application-defined or object-defined", "body": "<p>I'm working on a file for HR, to keep track of the start- and end times of employees. I get their name and required hours, and want to open a save as dialog to save the file using the name of the employee so the HR department only has to open the template and fill in the data and save, all in one fluid motion. I made a sub for all of this and it works nice, but after the save location has been defined, I get a run-time '1004' application-defined or object-defined error.</p>\n\n<pre><code>If ThisWorkbook.BuiltinDocumentProperties(\"title\") = \"\" Then\nstrTitle = \"Timesheet \" &amp; UCase(strNaam) &amp; \" \" &amp; StrConv(strVoornaam, 3)\nvarDirectory = Application.GetSaveAsFilename(strTitle, \"Timesheet Files(*.xlsm), *.xlsm\")\nSheets(\"Data\").Range(\"B25\") = varDirectory\n\nActiveSheet.SaveAs Filename:=varDirectory, FileFormat:=25 ------------&gt; error\nThisWorkbook.BuiltinDocumentProperties(\"title\") = strTitle\n\nEnd If\n</code></pre>\n\n<p>Basically it changes the title of the file to something, and prompts a dialog to choose the location which it then writes in a cell (not ideal, but it's  nice workaround).</p>\n\n<p>I get the error on the second to last line.</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1458728931, "post_id": 36175138, "comment_id": 59986714, "body": "Are you speaking of autofilling a J2:J1 range?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1458728761, "creation_date": 1458728761, "answer_id": 36175528, "question_id": 36175138, "link": "https://stackoverflow.com/questions/36175138/apply-autofill-for-more-than-1-row-else-do-not-apply/36175528#36175528", "title": "Apply autofill for more than 1 ROW else do not apply", "body": "<p>You need to explicitly reference the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224980(v=office.11).aspx\" rel=\"nofollow\">Range.Parent</a> worksheet property for all <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow\">Range.Cells properties</a>. You cannot rely on the implicit reference to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx\" rel=\"nofollow\">ActiveSheet property</a>.</p>\n\n<pre><code>with Sheets(1)\n    .Range(\"J2\").AutoFill Destination:=.Range(\"J2:J\" &amp; .Cells(Rows.Count, \"I\").End(xlUp).Row)\nend with\n</code></pre>\n\n<p>You might find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838404.aspx\" rel=\"nofollow\">Range.FillDown method</a> easier to code.</p>\n\n<pre><code>with Sheets(1)\n    .Range(\"J2:J\" &amp; .Cells(Rows.Count, \"I\").End(xlUp).Row).FillDown\nend with\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> passes the parent worksheet reference to all <code>.Range</code> and <code>.Cells</code> that have the prefix period (aka <em>full stop</em> or <code>.</code>).</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1458729676, "post_id": 36175680, "comment_id": 59987203, "body": "The <code>Range(&quot;J1:J&quot; &amp; L)</code> might need a <code>.</code>."}, {"owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "edited": false, "score": 0, "creation_date": 1458732934, "post_id": 36175680, "comment_id": 59989311, "body": "It is working for rows count of 2 or more in column &quot;I&quot;. However, if there is only 1 entry in the column I (not including the header), this error appears: &quot;AutoFill method of Range class failed&quot;."}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1458816999, "last_edit_date": 1458816999, "creation_date": 1458729096, "answer_id": 36175680, "question_id": 36175138, "link": "https://stackoverflow.com/questions/36175138/apply-autofill-for-more-than-1-row-else-do-not-apply/36175680#36175680", "title": "Apply autofill for more than 1 ROW else do not apply", "body": "<p>I have used copy and paste method to do autofill function. \nYou can use paste special as values or formula as per yourrequirement. It is another way of doing auto fill</p>\n\n<pre><code>Sub test11()\nDim L As Long\n\nL = Sheets(1).Range(\"J1:J\" &amp; Sheets(1).Cells(Sheets(1).Rows.Count, \"J\").End(xlUp).Row).Count\n\n   With Sheets(\"Sheet1\")\n\n       .Range(\"J1\").Copy\n\n        ' Change Range as per your requirement and paste function as per your requirement\n\n        .Range(\"J2:J\" &amp; L).PasteSpecial xlValues\n\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1458816999, "creation_date": 1458727706, "question_id": 36175138, "link": "https://stackoverflow.com/questions/36175138/apply-autofill-for-more-than-1-row-else-do-not-apply", "title": "Apply autofill for more than 1 ROW else do not apply", "body": "<p>What's the neatest way of applying Autofill if the ROW count is more than 1?\nI use the below line and it's working. However, if there's an instance where there is only 1 count ROW in column \"I\", there will be an error.</p>\n\n<pre><code>Sheets(1).Range(\"J2\").AutoFill Destination:=Range(\"J2:J\" &amp; Cells(Rows.Count, \"I\").End(xlUp).Row)\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer-8"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5935014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-48EBY4q7mEs/AAAAAAAAAAI/AAAAAAAAAHU/7Qw0xDQ0Cd0/photo.jpg?sz=128", "display_name": "Malhar Patil", "link": "https://stackoverflow.com/users/5935014/malhar-patil"}, "edited": false, "score": 0, "creation_date": 1458733596, "post_id": 36175819, "comment_id": 59989741, "body": "Thanks a lot! I need some more help. Is there any way to save the ID (of the same element which we recover using getElementById) in some variable like myElement_1 ?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 1, "user_id": 5935014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-48EBY4q7mEs/AAAAAAAAAAI/AAAAAAAAAHU/7Qw0xDQ0Cd0/photo.jpg?sz=128", "display_name": "Malhar Patil", "link": "https://stackoverflow.com/users/5935014/malhar-patil"}, "edited": false, "score": 0, "creation_date": 1458733692, "post_id": 36175819, "comment_id": 59989819, "body": "try <code>myElement_1 = myElement.Id</code>"}, {"owner": {"reputation": 1, "user_id": 5935014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-48EBY4q7mEs/AAAAAAAAAAI/AAAAAAAAAHU/7Qw0xDQ0Cd0/photo.jpg?sz=128", "display_name": "Malhar Patil", "link": "https://stackoverflow.com/users/5935014/malhar-patil"}, "edited": false, "score": 0, "creation_date": 1459148388, "post_id": 36175819, "comment_id": 60143860, "body": "Thanks! I did these changes. It is working now but there are further requirements for which I need to get an element by ID and then compare its Class (JAVA script class) with a particular pre-defined class. Can I use myElement_1 = myElement.Class"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1458729480, "creation_date": 1458729480, "answer_id": 36175819, "question_id": 36175091, "link": "https://stackoverflow.com/questions/36175091/how-to-use-getelementbyid-inside-if-statement/36175819#36175819", "title": "How to use getElementByID inside If statement?", "body": "<p>Check if it's <code>Nothing</code></p>\n\n<pre><code>Set myElement = doc.getElementById(\"my_ID\")\n\nIf myElement Is Nothing Then\n    MsgBox \"Element not found\"\n    Exit Sub '// Optional\nElse\n    '// Do something with element\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5935014, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-48EBY4q7mEs/AAAAAAAAAAI/AAAAAAAAAHU/7Qw0xDQ0Cd0/photo.jpg?sz=128", "display_name": "Malhar Patil", "link": "https://stackoverflow.com/users/5935014/malhar-patil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458729480, "creation_date": 1458727591, "question_id": 36175091, "link": "https://stackoverflow.com/questions/36175091/how-to-use-getelementbyid-inside-if-statement", "title": "How to use getElementByID inside If statement?", "body": "<p>How to use getElementByID inside If statement ?\nI have to if check a particular logo appears after running some file on a IE software. I can get the logo using getElementByID. Once getting that i want check if the logo is present. If present, then go ahead, else stop.</p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "edited": false, "score": 0, "creation_date": 1458729057, "post_id": 36175305, "comment_id": 59986786, "body": "I am expecting an integer"}], "tags": [], "owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "is_accepted": true, "score": 0, "last_activity_date": 1458728890, "last_edit_date": 1458728890, "creation_date": 1458728096, "answer_id": 36175305, "question_id": 36175030, "link": "https://stackoverflow.com/questions/36175030/vba-want-user-to-force-fill-form-when-not-filled-programme-should-not-continue-f/36175305#36175305", "title": "Vba want user to force fill form when not filled programme should not continue futher", "body": "<p>This can be a problem:</p>\n\n<pre><code>nssf = Me.cbTyreNsf.value\n</code></pre>\n\n<p>it does not pass any value to nssf if there is no value in the cbTyreNsf. (try msgbox(nssf) at that point. It will give you blank message box). If you want to test it using your current select case then you can try checking length of the value which will be 0 for empty cbTyreNsf.</p>\n\n<pre><code>nssf =Len(Me.cbTyreNsR.value)\n</code></pre>\n"}], "owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 36175305, "answer_count": 1, "score": 0, "last_activity_date": 1458728890, "creation_date": 1458727419, "question_id": 36175030, "link": "https://stackoverflow.com/questions/36175030/vba-want-user-to-force-fill-form-when-not-filled-programme-should-not-continue-f", "title": "Vba want user to force fill form when not filled programme should not continue futher", "body": "<p>I have a form that a user should fill and if certain fields are not filled the form should not continue further but it still does may be I am not see some thing help please</p>\n\n<p>this is  under the button presed  If Me.cbTyreNsf.value = \" \" Then</p>\n\n<pre><code>    MsgBox \"You must complete the Wheel Nsf value\", vbCritical\n    Exit Sub\n\nEnd If\n\nIf Me.cbTyreNsR.value = \"\" Then\n\n    MsgBox \"You must complete  Wheel Nsr value\", vbCritical\n    Exit Sub\nEnd If\n\nthe function called\n Call CheckifRecordExistOnWheelTable\n</code></pre>\n\n<p>the code for the function\n Select Case avar\n    Case \"NULL\"\n        Call insertWheel\n    Case Else\n        Call updateWheel\n    End Select</p>\n\n<p>and the code for the function called by the function</p>\n\n<pre><code> nssf = Me.cbTyreNsf.value\n\nSelect Case nssf\nCase \"0\"\n    MsgBox \" Please enter the NSF tyre value\", vbCritical\n    Me.cbTyreNsf.SetFocus\n   ' MsgBox \"about to exit\"\n    Exit Sub\n\nCase Else\n    nsf = CInt(nssf)\nEnd Select\n</code></pre>\n\n<p>any help please i have been on it for 24 hours counting tried every thing</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "is_accepted": false, "score": 0, "last_activity_date": 1458726859, "creation_date": 1458726859, "answer_id": 36174813, "question_id": 36174389, "link": "https://stackoverflow.com/questions/36174389/vba-range-replace-method-not-working/36174813#36174813", "title": "VBA Range.Replace Method not working", "body": "<p>In your code, specify which Workbook / Sheet you work on:</p>\n\n<pre><code>this_workbook = \"myWorkBook.xlsm\"\nmySheet = \"theSheet\"\n' then specify the range like this   \nyourRange = \"[\" &amp; this_workbook &amp; \"]\" &amp; mySheet &amp; \"!B2:G22\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 76, "user_id": 5766916, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lO4w7.jpg?s=128&g=1", "display_name": "MrDominikku", "link": "https://stackoverflow.com/users/5766916/mrdominikku"}, "edited": false, "score": 0, "creation_date": 1458728670, "post_id": 36175155, "comment_id": 59986540, "body": "Still the same, all range are <code>ws.Range</code>. Maybe you misunderstood me because I only copy <code>ws.Range(&quot;B2:G22&quot;).Select</code>. I work on I2 cell. Let me explain: rows=2 col = 9 (I2 = Cells(2,9)) so <code>With ws.Range(Cells(2,9),Cells(22,9)).Offset(1,0) = ws.Range(I2:I22)</code> . I want macro to replace word &quot;ABCDE&quot; in range I2:I22 with word from Inputbox."}], "tags": [], "owner": {"reputation": 519, "user_id": 5988856, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4a4c7f4751c9816babf4ba9e81c43b62?s=128&d=identicon&r=PG", "display_name": "Chinwobble", "link": "https://stackoverflow.com/users/5988856/chinwobble"}, "is_accepted": false, "score": 0, "last_activity_date": 1458727758, "creation_date": 1458727758, "answer_id": 36175155, "question_id": 36174389, "link": "https://stackoverflow.com/questions/36174389/vba-range-replace-method-not-working/36175155#36175155", "title": "VBA Range.Replace Method not working", "body": "<p>You can also specify the range you want to work with using this code:</p>\n\n<pre><code>dim ws as worksheet\nset ws = ThisWorkBook.sheets(1) 'set the first tab of this work book\n</code></pre>\n\n<p>then when you want to interact with you a cell you use:</p>\n\n<pre><code>ws.Range(\"B2:G22\").select \n</code></pre>\n\n<p>Also if you want to paste a value to a cell then you do not need to \"select\" it unless you want to show the user.\nYour code:</p>\n\n<pre><code>Range(\"B2:G22\").Select\nSelection.Copy\nRange(ValDate).Select\nSelection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>can be changed to: </p>\n\n<pre><code>Range(\"B2:G22\").Copy\nRange(ValDate).PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 76, "user_id": 5766916, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lO4w7.jpg?s=128&g=1", "display_name": "MrDominikku", "link": "https://stackoverflow.com/users/5766916/mrdominikku"}, "edited": false, "score": 0, "creation_date": 1458729360, "post_id": 36175519, "comment_id": 59986968, "body": "Error 13: Type mismatch when trying execute Replace function"}, {"owner": {"reputation": 1215, "user_id": 1418533, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/832e7fd1713de344d00ba3cc9c6fae54?s=128&d=identicon&r=PG", "display_name": "Ken Ingram", "link": "https://stackoverflow.com/users/1418533/ken-ingram"}, "edited": false, "score": 0, "creation_date": 1530750237, "post_id": 36175519, "comment_id": 89346303, "body": "This worked perfectly for me: associated_char = Chr(151) For Each cells In Selection   cells.Value = Replace(cells.Value, associated_char, &quot; - &quot;) Next Change all the emdashes to hyphens"}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 1, "last_activity_date": 1458728739, "creation_date": 1458728739, "answer_id": 36175519, "question_id": 36174389, "link": "https://stackoverflow.com/questions/36174389/vba-range-replace-method-not-working/36175519#36175519", "title": "VBA Range.Replace Method not working", "body": "<p>Try to use Replace() Function instead of .Replace</p>\n\n<p>For Example</p>\n\n<pre><code>Dim Rng as Range\n\nSet Rng = Range(Cells(rows, col), Cells(rows + c, col)).Offset(1, 0)\n\nRng.Value = Replace(Rng.Value, \"ABCDE\", FName)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 76, "user_id": 5766916, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lO4w7.jpg?s=128&g=1", "display_name": "MrDominikku", "link": "https://stackoverflow.com/users/5766916/mrdominikku"}, "edited": false, "score": 1, "creation_date": 1458730251, "post_id": 36175790, "comment_id": 59987587, "body": "This is my macro created by me from the beginning so I need to use Visual Basic. Option Explicit is set up by default and I debugging my macro with F8 all the time to see if macro use good variable. So you comment is unrelevant here... No error and no problem with code. Just can&#39;t understand why macro SKIPS code with .Replace and do nothing."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": false, "score": 2, "last_activity_date": 1458729864, "last_edit_date": 1458729864, "creation_date": 1458729410, "answer_id": 36175790, "question_id": 36174389, "link": "https://stackoverflow.com/questions/36174389/vba-range-replace-method-not-working/36175790#36175790", "title": "VBA Range.Replace Method not working", "body": "<p>I could give you a fish, but I will hand you a fishing pole instead.</p>\n\n<p>When you ever happen to have any similar problems, navigate to your Developer tab and select Visual Basic. Find the object containing your code, right click it, view code (or if the code is directly in your sheet, then just right click + view code on your sheet tab).</p>\n\n<p>Remember to always add Option Explicit on top of your macro (before declaring variables) for easier debugging.</p>\n\n<p>By repeatedly pressing F8 in your code, you execute your macro line by line and unless screen updating is false, you can preview current results of the macro on your sheet. You will also know at what point the macro doesn't behave as You would like and can narrow it down to part of the code which is causing problems.</p>\n"}, {"comments": [{"owner": {"reputation": 76, "user_id": 5766916, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lO4w7.jpg?s=128&g=1", "display_name": "MrDominikku", "link": "https://stackoverflow.com/users/5766916/mrdominikku"}, "edited": false, "score": 0, "creation_date": 1458737447, "post_id": 36177521, "comment_id": 59992464, "body": "Thank you for you comment. I&#39;ve just solved it. Simple thing: <code>With Range(Cells(rows, col), Cells(rows + c, col)).Offset(1, 0) .Replace What:=&quot;ABCDE&quot;, Replacement:=FName, LookAt:=xlPart, MatchCase:=True</code> . Now works every time :) I think macro couldn&#39;t find word in range so it skips it or do nothing."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 0, "last_activity_date": 1458734160, "creation_date": 1458734160, "answer_id": 36177521, "question_id": 36174389, "link": "https://stackoverflow.com/questions/36174389/vba-range-replace-method-not-working/36177521#36177521", "title": "VBA Range.Replace Method not working", "body": "<p>I hope this helps, even if you want to do things in a different way than I expect. The code replaces \"ABCDE\" text with your input FName (even if \"ABCDE\" is only a part of cell's content). <strong>All changes are applied to original data</strong>. </p>\n\n<p>You must first specify sheet's name by editing:\nsheetname = \"<strong>Sheet1</strong>\"</p>\n\n<p>Then specify data range by editing:\nv_data = .Range(\"<strong>b2:g</strong>\" &amp; thelastrow)</p>\n\n<p>The last row will be automatically set as last row in your sheet containing any data.</p>\n\n<p>If you want any modifications to code's behaviour, let me know.</p>\n\n<pre><code>Dim FName As String, sheetname As String\nDim thelastrow As Integer, dataRow As Integer, dataCol As Integer\nDim v_data As Variant\n\nApplication.ScreenUpdating = False\n\nsheetname = \"Sheet1\"\n\nWith ThisWorkbook.Worksheets(sheetname)\n    thelastrow = .Cells.Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    v_data = .Range(\"b2:g\" &amp; thelastrow)\n\n    FName = InputBox(\"Enter name:\")\n\n    For dataRow = LBound(v_data) To UBound(v_data)\n        For dataCol = LBound(v_data, 2) To UBound(v_data, 2)\n            If InStr(1, v_data(dataRow, dataCol), \"ABCDE\") &lt;&gt; 0 Then\n                v_data(dataRow, dataCol) = Replace(v_data(dataRow, dataCol), \"ABCDE\", FName)\n            End If\n        Next dataCol\n    Next dataRow\n\n    .Range(\"b2:g\" &amp; thelastrow) = v_data\n\nEnd With\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 76, "user_id": 5766916, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lO4w7.jpg?s=128&g=1", "display_name": "MrDominikku", "link": "https://stackoverflow.com/users/5766916/mrdominikku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8550, "favorite_count": 0, "accepted_answer_id": 36177521, "answer_count": 5, "score": 0, "last_activity_date": 1458734160, "creation_date": 1458725655, "question_id": 36174389, "link": "https://stackoverflow.com/questions/36174389/vba-range-replace-method-not-working", "title": "VBA Range.Replace Method not working", "body": "<p>This is my code:</p>\n\n<pre><code>Dim ValDate As String\nDim FName As String\nDim rows As Integer\nDim col As Integer\n\nValDate = InputBox(\"Enter cell range:\")\n\nIf ValDate = \"\" Then\n    Exit Sub\nEnd If\n\nr = 1\nc = 20\nrows = Range(ValDate).Row\ncol = Range(ValDate).Column\n\n\nFName = InputBox(\"Enter name:\")\n\nRange(\"B2:G22\").Select\nSelection.Copy\nRange(ValDate).Select\nSelection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\nActiveSheet.Paste\nRange(ValDate).Offset(0, 1) = FName\n\n\nWith Range(Cells(rows, col), Cells(rows + c, col)).Offset(1, 0)\n.Replace \"ABCDE\", FName\nEnd With\nWith Range(Cells(rows, col), Cells(rows + c, col)).Offset(1, 1)\n.Replace \"ABCDE\", FName\nEnd With\nWith Range(Cells(rows, col), Cells(rows + c, col)).Offset(1, 3)\n.Replace \"ABCDE\", FName\nEnd With\n</code></pre>\n\n<p>Problem is when macro trying to Replace word. Nothing happen. Yesterday I was working on this and all was good. Today I tried to continue work on this macro and run for test. Nothing. Can someone explain why? I haven't changed anything.\nNo errors when I run macro. Just reading code and skips it.</p>\n"}, {"tags": ["ms-access", "vba", "runtime"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6103281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1da61e7cc799638721db5da6bfafde8?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6103281/rob"}, "edited": false, "score": 0, "creation_date": 1458731738, "post_id": 36176041, "comment_id": 59988560, "body": "Ah thank you so much @Gustav you wouldn&#39;t believe how long this has confused me for!! Works like a charm!!"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1458730565, "last_edit_date": 1458730565, "creation_date": 1458730047, "answer_id": 36176041, "question_id": 36174388, "link": "https://stackoverflow.com/questions/36174388/run-time-3464-in-access-vba-trying-to-open-a-recordset-with-sql-select-statemen/36176041#36176041", "title": "Run-time 3464 in Access VBA. Trying to open a recordset with SQL select statement", "body": "<p>Use <em>DMax</em> and <em>DLookup</em> for this:</p>\n\n<pre><code>fs = DMax(\"fldMovementDate\", \"[tblMovements]\", \"[fldMovementTypeIdfk] = 1\")\n\nss = DLookup(\"fldMovementLocationIdfk\", \"[tblMovements]\", \"[fldMovementDate]= #\" &amp; Format(fs, \"yyyy\\/mm\\/dd\") &amp; \"#\")\n</code></pre>\n\n<p>Or do like this:</p>\n\n<pre><code>Public Sub GetDepot()\n\n    Dim rs As DAO.Recordset\n    Dim ss As Long\n\n    Set rs = CurrentDb.OpenRecordset(\"SELECT TOP 1 fldMovementLocationIdfk FROM [tblMovements] WHERE [fldMovementTypeIdfk] = 1 ORDER BY fldMovementDate DESC\")\n\n    ss = rs(0).Value\n    rs.Close\n\n    Set rs = Nothing\n\n    MsgBox (ss)\n\nEnd Sub`\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6103281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1da61e7cc799638721db5da6bfafde8?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6103281/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 36176041, "answer_count": 1, "score": 0, "last_activity_date": 1594642512, "creation_date": 1458725652, "last_edit_date": 1594642512, "question_id": 36174388, "link": "https://stackoverflow.com/questions/36174388/run-time-3464-in-access-vba-trying-to-open-a-recordset-with-sql-select-statemen", "title": "Run-time 3464 in Access VBA. Trying to open a recordset with SQL select statement", "body": "<p>I'm having trouble trying to get this code to work:</p>\n\n<pre><code>Public Sub GetDepot()\n    Dim fs As Date\n    Dim ss As Long\n\n    fs = CurrentDb.OpenRecordset(\"SELECT Max(fldMovementDate) FROM [tblMovements] WHERE [fldMovementTypeIdfk] =1\")(0)\n\n    ss = CurrentDb.OpenRecordset(\"SELECT(fldMovementLocationIdfk) FROM [tblMovements]  WHERE [fldMovementDate]= '\" &amp; fs &amp; \"'\")(0)\n\n    MsgBox (ss)\nEnd Sub\n</code></pre>\n\n<p>Ultimately I am trying to populate a textbox on a form with from its last depot location. The debug picks out where I am trying to set the ss variable. There is something going wrong with my SQL statement and have tried various things to correct it but to no avail. I have also tried storing the variable as different data types thinking that this might be where I've gone wrong but again this approach as yet hasn't worked to fix the problem.</p>\n\n<p>The MsgBox at the end was just there to help try and debug but the code isn't getting that far. I understand that I will need to add more to this Sub to get it to complete what I need but cant get it any further.</p>\n\n<p>I've also tried setting a MsgBox up to show what the fs variable is storing and this seems to be showing a correct date i.e. 18/02/16.</p>\n\n<p>If any one could help it would be massively appreciated!</p>\n"}, {"tags": ["excel", "vba", "excel-2010", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "is_accepted": false, "score": 1, "last_activity_date": 1458744990, "creation_date": 1458744990, "answer_id": 36181579, "question_id": 36174276, "link": "https://stackoverflow.com/questions/36174276/vba-excel-word-formatting-of-horizontal-line-from-excel-in-word-header/36181579#36181579", "title": "VBA, EXCEL, WORD: Formatting of Horizontal line from Excel in Word Header", "body": "<p>Try this:      </p>\n\n<pre><code>Dim a As Object\nSet a = GetObject(, \"Word.Application\")\nWith a.ActiveDocument.Sections(1).headers(wdHeaderFooterPrimary)\n    .Range.InlineShapes.AddHorizontalLineStandard.Height = 1\nEnd With                                \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1458766619, "creation_date": 1458766619, "answer_id": 36188539, "question_id": 36174276, "link": "https://stackoverflow.com/questions/36174276/vba-excel-word-formatting-of-horizontal-line-from-excel-in-word-header/36188539#36188539", "title": "VBA, EXCEL, WORD: Formatting of Horizontal line from Excel in Word Header", "body": "<p>Try the following, which uses an InlineShape object to \"hold\" the line you're adding so that you can address it directly. I can't figure out why what you have isn't working, but if this doesn't work it might at least give you a more informative error message:</p>\n\n<pre><code>Dim rng As word.Range\nDim ils As word.InlineShape\n\nSet rng = oWord.ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Range\nrng.Collpase Direction:=wdCollapseEnd\nSet ils = rng.InlineShapes.AddHorizontalLineStandard(rng)\nils.height = 1\n</code></pre>\n"}], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 0, "accepted_answer_id": 36188539, "answer_count": 2, "score": 1, "last_activity_date": 1458766619, "creation_date": 1458725342, "last_edit_date": 1458732699, "question_id": 36174276, "link": "https://stackoverflow.com/questions/36174276/vba-excel-word-formatting-of-horizontal-line-from-excel-in-word-header", "title": "VBA, EXCEL, WORD: Formatting of Horizontal line from Excel in Word Header", "body": "<p>From excel VBA I am adding a horizontal line to a header of a Word document.</p>\n\n<pre><code>Dim a As Word.Range\nSet a = oWord.ActiveDocument.Sections(1).headers(wdHeaderFooterPrimary).Range\na.Collapse Direction:=wdCollapseEnd\na.InlineShapes.AddHorizontalLineStandard \n</code></pre>\n\n<p>Next I want to format that line:</p>\n\n<pre><code>a.InlineShapes(1).Height = 1\n</code></pre>\n\n<p>But this throws and error <em>5941 - The requested member of the collection does not exist.</em></p>\n\n<p>I also tried </p>\n\n<pre><code>With a.InlineShapes.AddHorizontalLineStandard \n    .Height = 1\nEnd With\n</code></pre>\n\n<p>But didnt work either.</p>\n\n<p>I tried the code in Word vba, which worked. Am I missing something here? How can I format the line from Excel?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I stopped the code after adding the line. Then I executed <code>.InlineShapes.Count</code>, which returned 0. Then I added a line in the document body and executed again, which return 1 then. So the problem seems to be that the header can not be access from Excel?</p>\n"}, {"tags": ["excel", "lotusscript", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458726966, "post_id": 36174275, "comment_id": 59985359, "body": "A shot in the dark. It&#39;s been long since I worked with Lotusscript. Try something like this <code>MyAr = doc.GetItemValue( &quot;name of item&quot; )</code> and then <code>Ubound(MyAr)</code> to get the count of itmes?"}, {"owner": {"reputation": 1, "user_id": 6103146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5669b08b5e5536d7cb9ce42a953c60be?s=128&d=identicon&r=PG&f=1", "display_name": "Ocmer", "link": "https://stackoverflow.com/users/6103146/ocmer"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458807462, "post_id": 36174275, "comment_id": 60025143, "body": "Thanks! This does seem to do the trick."}, {"owner": {"reputation": 2133, "user_id": 818824, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/ae43903a6f689a84253732cf10817726?s=128&d=identicon&r=PG", "display_name": "D.Bugger", "link": "https://stackoverflow.com/users/818824/d-bugger"}, "edited": false, "score": 0, "creation_date": 1458809504, "post_id": 36174275, "comment_id": 60026101, "body": "Actually, it&#39;s Ubound(MyAr)+1, since array element 1 is at index 0."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6103146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5669b08b5e5536d7cb9ce42a953c60be?s=128&d=identicon&r=PG&f=1", "display_name": "Ocmer", "link": "https://stackoverflow.com/users/6103146/ocmer"}, "edited": false, "score": 0, "creation_date": 1458807487, "post_id": 36180330, "comment_id": 60025163, "body": "Thanks for the solution."}], "tags": [], "owner": {"reputation": 10664, "user_id": 2266289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17776372b3ca8289aa964360a7a60b35?s=128&d=identicon&r=PG", "display_name": "Torsten Link", "link": "https://stackoverflow.com/users/2266289/torsten-link"}, "is_accepted": false, "score": 2, "last_activity_date": 1458741673, "creation_date": 1458741673, "answer_id": 36180330, "question_id": 36174275, "link": "https://stackoverflow.com/questions/36174275/count-of-lotusnote-item-via-vba/36180330#36180330", "title": "Count of LotusNote Item via VBA", "body": "<p>GetitemValue returns an array with all values in an item.</p>\n\n<p>As pointed out in the comments you simply assign the result to a variable and cycle through using ubound:</p>\n\n<pre><code>Dim DomSession As Object\nDim DomDir As NotesDatabase\nDim DomContacts As NotesView\nDim DomDoc As NotesDocument\nDim varValues\n\nWhile Not (DomDoc Is Nothing)\n    varValues = DomDoc.GetItemValue(\"name of item\")\n    max = ubound( varValues )\n    For i = 0 to max\n       yourValue = varValues(i)\n       '- do whatever you want with values\n    Next\n    Set DomDoc = DomContacts.GetNextDocument(DomDoc)\nWend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6103146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5669b08b5e5536d7cb9ce42a953c60be?s=128&d=identicon&r=PG&f=1", "display_name": "Ocmer", "link": "https://stackoverflow.com/users/6103146/ocmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458741673, "creation_date": 1458725341, "last_edit_date": 1531164843, "question_id": 36174275, "link": "https://stackoverflow.com/questions/36174275/count-of-lotusnote-item-via-vba", "title": "Count of LotusNote Item via VBA", "body": "<p>I have a VBA macro that gets some data from a LotusNotes application.  Most of it works well but I don't get around retrieving the number of elements in an Item. </p>\n\n<p>For example:</p>\n\n<pre><code>Dim DomSession As Object\nDim DomDir As NotesDatabase\nDim DomContacts As NotesView\nDim DomDoc As NotesDocument\n\nWhile Not (DomDoc Is Nothing)\nGetItemValue(\"name of item\")(0)  \nSet DomDoc = DomContacts.GetNextDocument(DomDoc)\nWend\n</code></pre>\n\n<p>GetItemValue(\"name of item\")(0)  gets me the first or only value of the Item. However, if there are more elements in an Item, which happens, than I do not know how many.  Looping trough the indexes (i) results in a runtime error in VBA as it loops until the list gets out of bounds. </p>\n\n<p>In LotusScript itself there is @Count that should do what I want, but this does not work via VBA.  Any suggestions?</p>\n"}, {"tags": ["sql", "oracle", "vba"], "comments": [{"owner": {"reputation": 1486, "user_id": 344027, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/aef8ba0e218645117805811e467f91ce?s=128&d=identicon&r=PG", "display_name": "Nitish", "link": "https://stackoverflow.com/users/344027/nitish"}, "edited": false, "score": 0, "creation_date": 1458725929, "post_id": 36174180, "comment_id": 59984651, "body": "Welcome to Stack Overflow! Please take the <a href=\"http://stackoverflow.com/tour\">tour</a> and read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> to learn what we expect from questions here. Please be aware that we do not provide from-scratch coding service here. Please show us what you&#39;ve tried already, how it failed and we might be able to help."}, {"owner": {"reputation": 82580, "user_id": 1509264, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ab28e5358f7959b75d8649c7e1759874?s=128&d=identicon&r=PG", "display_name": "MT0", "link": "https://stackoverflow.com/users/1509264/mt0"}, "edited": false, "score": 0, "creation_date": 1458734912, "post_id": 36174180, "comment_id": 59990604, "body": "Put this formula <code>=&quot;INSERT INTO table_name ( column_name ) VALUES ( &quot;&amp;E20&amp;&quot;);&quot;</code> into <code>F20</code> and then copy/paste down into <code>F21:F40</code> and <code>F70:F90</code> (or any empty column) then copy the output of those cells and paste it into your SQL client."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 4947266, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc8b5c74a07ca66ac08539d50ebe4bdc?s=128&d=identicon&r=PG&f=1", "display_name": "KaiEn Suizai", "link": "https://stackoverflow.com/users/4947266/kaien-suizai"}, "is_accepted": false, "score": 0, "last_activity_date": 1458725706, "last_edit_date": 1495542687, "creation_date": 1458725706, "answer_id": 36174409, "question_id": 36174180, "link": "https://stackoverflow.com/questions/36174180/transfer-a-range-of-data-from-excel-to-oracle-using-vba/36174409#36174409", "title": "Transfer a range of data from excel to oracle using vba", "body": "<p>There are many source there, do some self learning first then come with the problem you face.</p>\n\n<p><a href=\"http://www.encodedna.com/excel/copy-data-from-closed-excel-workbook-without-opening.htm\" rel=\"nofollow noreferrer\">http://www.encodedna.com/excel/copy-data-from-closed-excel-workbook-without-opening.htm</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/22154288/excel-vba-connect-to-remote-oracle-db-with-instantclient\">Excel VBA connect to remote Oracle DB with InstantClient</a></p>\n"}], "owner": {"reputation": 1, "user_id": 2088386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3af3c4eefa6280cba4cfba4c466546a?s=128&d=identicon&r=PG", "display_name": "user2088386", "link": "https://stackoverflow.com/users/2088386/user2088386"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1497, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1458725706, "creation_date": 1458725093, "question_id": 36174180, "link": "https://stackoverflow.com/questions/36174180/transfer-a-range-of-data-from-excel-to-oracle-using-vba", "title": "Transfer a range of data from excel to oracle using vba", "body": "<p>I have a requirement.\nI have an excel report with 5 sheets  and I want  to send a range of values (for example : values from cell E20:E40) ,( E70: E90 ) )from excel report sheet 3 to my local database table(oracle). Can anybody help to write some code in vba.</p>\n\n<p>Thanks in advance ..\nARUN</p>\n"}, {"tags": ["excel", "form-control", "vba"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5761418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AcYfL.png?s=128&g=1", "display_name": "xtoybox", "link": "https://stackoverflow.com/users/5761418/xtoybox"}, "edited": false, "score": 0, "creation_date": 1459140739, "post_id": 36173028, "comment_id": 60141525, "body": "sorry for not giving any words for almost a week now, just had an Easter holiday and just got back to work, will be trying out the code in a bit, thank you."}, {"owner": {"reputation": 47, "user_id": 5761418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AcYfL.png?s=128&g=1", "display_name": "xtoybox", "link": "https://stackoverflow.com/users/5761418/xtoybox"}, "edited": false, "score": 0, "creation_date": 1459389130, "post_id": 36173028, "comment_id": 60268619, "body": "thanks you two, I tried mashing your codes together and it&#39;s working, thank you."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1458721497, "creation_date": 1458721497, "answer_id": 36173028, "question_id": 36172828, "link": "https://stackoverflow.com/questions/36172828/similar-syntax-for-multiple-objects/36173028#36173028", "title": "similar syntax for multiple objects", "body": "<p>Put hte bulk of the code into its own Sub procedure and pass the object to it from the 'handler' sub of each button.</p>\n\n<pre><code>Private Sub button1_Click()\n    allSpin Me.TextBox1\nEnd Sub\n\nPrivate Sub button2_Click()\n    allSpin Me.TextBox2\nEnd Sub\n\nPrivate Sub button3_Click()\n    allSpin Me.TextBox3\nEnd Sub\n\nSub allSpin(ByRef tb As Object)\n    With tb\n        .Value = .Value - 1\n        If .Value = 0 Then\n            .Value = 12\n        ElseIf .Value &lt; 10 Then\n            .Value = \"0\" &amp; .Value\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>That is pretty generalized and tbh, I doubt if it would work straight out of the box but I hope it is enough to give you an idea on how it works.</p>\n\n<p>That last sub may be better like this,</p>\n\n<pre><code>Sub allSpin(ByRef tb As Object)\n    With tb\n        If Int(.Value) = 1 Then\n            .Value = 12\n        Else\n            .Value = Format(Int(.Value) - 1, \"00\")\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 5761418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AcYfL.png?s=128&g=1", "display_name": "xtoybox", "link": "https://stackoverflow.com/users/5761418/xtoybox"}, "edited": false, "score": 0, "creation_date": 1459140758, "post_id": 36178060, "comment_id": 60141530, "body": "sorry for not giving any words for almost a week now, just had an Easter holiday and just got back to work, will be trying out the code in a bit, thank you."}, {"owner": {"reputation": 47, "user_id": 5761418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AcYfL.png?s=128&g=1", "display_name": "xtoybox", "link": "https://stackoverflow.com/users/5761418/xtoybox"}, "edited": false, "score": 0, "creation_date": 1459389128, "post_id": 36178060, "comment_id": 60268618, "body": "thanks you two, I tried mashing your codes together and it&#39;s working, thank you."}], "tags": [], "owner": {"reputation": 36, "user_id": 6103935, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eZ5ZDr5fFnM/AAAAAAAAAAI/AAAAAAAAABk/G0Rl0m8EpCA/photo.jpg?sz=128", "display_name": "Geoff Kelly", "link": "https://stackoverflow.com/users/6103935/geoff-kelly"}, "is_accepted": false, "score": 1, "last_activity_date": 1458735701, "creation_date": 1458735701, "answer_id": 36178060, "question_id": 36172828, "link": "https://stackoverflow.com/questions/36172828/similar-syntax-for-multiple-objects/36178060#36178060", "title": "similar syntax for multiple objects", "body": "<p>Your code refers to Textbox.value as an integer.\nI think what you might be wanting to do is to get the spin buttons to wrap from 0 to 12 when clicking down, and perhaps stop at 12 when clicking up. Assuming the SpinButtons are SpinButton1, SpinButton2, SpinButton3 and there are related textboxes of the same number:\nTry this</p>\n\n<pre><code>Private Sub SpinButton1_Change()\n  SpinUpdate\nEnd Sub\nPrivate Sub SpinButton2_Change()\n  SpinUpdate\nEnd Sub\nPrivate Sub SpinButton3_Change()\n  SpinUpdate\nEnd Sub\nPrivate Sub SpinUpdate()\nDim StrI As String\n  StrI = Right(ActiveControl.Name, 1)\n  With Me.Controls(\"SpinButton\" &amp; StrI)\n    If .Value = 0 Then\n        .Value = 12\n    End If\n    Me.Controls(\"TextBox\" &amp; StrI).Text = Format(.Value, \"00\")\n  End With\nEnd Sub\nPrivate Sub UserForm_Click()\nDim i As Integer\n  For i = 1 To 3\n    With Me.Controls(\"SpinButton\" &amp; Format(i))\n      .Min = 0\n      .Max = 12\n    End With\n  Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5761418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AcYfL.png?s=128&g=1", "display_name": "xtoybox", "link": "https://stackoverflow.com/users/5761418/xtoybox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1458735701, "creation_date": 1458720803, "last_edit_date": 1531161705, "question_id": 36172828, "link": "https://stackoverflow.com/questions/36172828/similar-syntax-for-multiple-objects", "title": "similar syntax for multiple objects", "body": "<p>I have multiple spinbuttons on my userform and I want to put the same codes on each one of them, </p>\n\n<pre><code>Me.TextBox1.Value = Me.TextBox1.Value - 1\n\nIf Me.TextBox1.Value = 0 Then\n    Me.TextBox1.Value = 12\nEnd If\n\nIf Me.TextBox1.Value &lt; 10 Then\n    Me.TextBox1.Value = \"0\" &amp; Me.TextBox1.Value\nEnd If\n</code></pre>\n\n<p>but is there a simplified way rather than putting multiple blocks on multiple spinbuttons, and just group them all together in one block?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3822047, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2445afa2417ba1b2a5ffa7b89e9d5813?s=128&d=identicon&r=PG&f=1", "display_name": "user3822047", "link": "https://stackoverflow.com/users/3822047/user3822047"}, "edited": false, "score": 0, "creation_date": 1458714117, "post_id": 36170349, "comment_id": 59978721, "body": "I now have it like this.     Range(Range(&quot;B13&quot;).Value).GoalSeek _     Goal:=Range(&quot;C13&quot;).Value, _     ChangingCell:=Range(Range(&quot;D13&quot;).Value) it gives me the error: Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed. the Goal range is on the home page, so I don&#39;t think we need to nest it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 3822047, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2445afa2417ba1b2a5ffa7b89e9d5813?s=128&d=identicon&r=PG&f=1", "display_name": "user3822047", "link": "https://stackoverflow.com/users/3822047/user3822047"}, "edited": false, "score": 0, "creation_date": 1458714547, "post_id": 36170349, "comment_id": 59978882, "body": "Yes, you provided only two cells with cell addresses in them but I used three. My bad; I was trying to be thorough and misinterpreted what I thought was a shortcoming in the example."}, {"owner": {"reputation": 51, "user_id": 3822047, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2445afa2417ba1b2a5ffa7b89e9d5813?s=128&d=identicon&r=PG&f=1", "display_name": "user3822047", "link": "https://stackoverflow.com/users/3822047/user3822047"}, "edited": false, "score": 0, "creation_date": 1458714917, "post_id": 36170349, "comment_id": 59979009, "body": "No Problem. But any idea on what the error is all about? Even a simple line fails with the same error.   MsgBox (&quot;The value is: &quot; &amp; Range(Range(&quot;B13&quot;).Value)) fails."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 3822047, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2445afa2417ba1b2a5ffa7b89e9d5813?s=128&d=identicon&r=PG&f=1", "display_name": "user3822047", "link": "https://stackoverflow.com/users/3822047/user3822047"}, "edited": false, "score": 0, "creation_date": 1458715254, "post_id": 36170349, "comment_id": 59979113, "body": "Not off the top of my head but then again, I know very little about your project. I was concerned about parent worksheet references; that is likely the issue but I don&#39;t even know what workshett that private sub belongs in."}, {"owner": {"reputation": 51, "user_id": 3822047, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2445afa2417ba1b2a5ffa7b89e9d5813?s=128&d=identicon&r=PG&f=1", "display_name": "user3822047", "link": "https://stackoverflow.com/users/3822047/user3822047"}, "edited": false, "score": 0, "creation_date": 1458737658, "post_id": 36170349, "comment_id": 59992617, "body": "Everything is on one sheet (Sheet1) except the GoalSeek formula and the ChangingCell.  The command button, this GoalSeek command routine all on this sheet."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1458710208, "creation_date": 1458710208, "answer_id": 36170349, "question_id": 36169855, "link": "https://stackoverflow.com/questions/36169855/reference-a-cell-that-is-defined-in-a-string-in-another-cell/36170349#36170349", "title": "Reference a cell that is defined in a string in another cell", "body": "<p>You need to nest a couple of <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a>s; one to put the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193.aspx\" rel=\"nofollow\">Range.Value property</a> and another one wrapping the first to use the cell's value to define the range.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Range(Range(\"B13\").Value).GoalSeek _\n        Goal:=Range(Range(\"C13\").Value), _\n        ChangingCell:=Range(Range(\"D13\").Value)\n\nEnd Sub\n</code></pre>\n\n<p>So <code>Range(Range(\"D13\").Value).Address(external:=True)</code> will resolve to TopCap'!$E$12.</p>\n\n<p>I've removed the <strong>$</strong> absolute anchors from the string cell addresses. As strings, they are not going to change and are unnecessary. This is a Private Sub so parent worksheet references may not be necessary (e.g. <code>Range(\"D13\").Value</code>) but wrapping that in a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> wouldn't be a bad idea.</p>\n"}], "owner": {"reputation": 51, "user_id": 3822047, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2445afa2417ba1b2a5ffa7b89e9d5813?s=128&d=identicon&r=PG&f=1", "display_name": "user3822047", "link": "https://stackoverflow.com/users/3822047/user3822047"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1458720037, "creation_date": 1458707215, "last_edit_date": 1531161705, "question_id": 36169855, "link": "https://stackoverflow.com/questions/36169855/reference-a-cell-that-is-defined-in-a-string-in-another-cell", "title": "Reference a cell that is defined in a string in another cell", "body": "<p>I have a worksheet set up as follows:</p>\n\n<pre><code>$B$13 = the string \"'TopCap'!$C$12\"\n$D$13 = the string \"'TopCap'!$E$12\"\n</code></pre>\n\n<p>The cell in Worksheet TopCap cell $C$12 has the formula that the Goal Seek needs. And TopCap!$E$12 is where the changing cell is.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Range(\"$B$13\").GoalSeek _\n        goal:=Range(\"$C$13\").Value, _\n        ChangingCell:=Range(\"$D$13\").Value\n\nEnd Sub\n</code></pre>\n\n<p>How do I write the code to have the GoalSeek Range look in the cell in TopCap for the formula?\nLike Range('TopCap'!$C$12).GoalSeek _</p>\n\n<p>I hope I have described this well.\nPlease ask if I need to describe it better.</p>\n\n<p>Any assistance is appreciated.\nRich</p>\n"}, {"tags": ["excel", "excel-addins", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1458701262, "post_id": 36168859, "comment_id": 59974905, "body": "you can create Application Event Handler in your addin to respond to events from any workbook.  <a href=\"http://www.cpearson.com/excel/AppEvent.aspx\" rel=\"nofollow noreferrer\">see here</a>"}, {"owner": {"reputation": 155, "user_id": 1490046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6481148dce422481123430fe7c3953c2?s=128&d=identicon&r=PG", "display_name": "rookie error", "link": "https://stackoverflow.com/users/1490046/rookie-error"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1458714736, "post_id": 36168859, "comment_id": 59978954, "body": "Perfect, just what I was looking for. Thanks a lot!"}], "owner": {"reputation": 155, "user_id": 1490046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6481148dce422481123430fe7c3953c2?s=128&d=identicon&r=PG", "display_name": "rookie error", "link": "https://stackoverflow.com/users/1490046/rookie-error"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 398, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458700839, "creation_date": 1458700839, "last_edit_date": 1531164843, "question_id": 36168859, "link": "https://stackoverflow.com/questions/36168859/reacting-to-workbook-beforesave-event-from-an-excel-add-in", "title": "Reacting to Workbook.BeforeSave event from an excel add-in", "body": "<p>I want to run a validation VBA function on save of any workbook which uses my excel add-in when certain conditions are met, but my users are non technical so adding VBA code to each workbook's BeforeSave event to run the function is not an option.</p>\n\n<p>Is it possible to attach a VBA function to the Workbook.BeforeSave event when the add-in loads?</p>\n"}, {"tags": ["vba", "ms-word", "ole"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1458769539, "creation_date": 1458769539, "answer_id": 36189283, "question_id": 36168797, "link": "https://stackoverflow.com/questions/36168797/can-you-get-image-data-from-an-ole-object-in-word-using-vba/36189283#36189283", "title": "Can you get image data from an OLE object in Word using VBA?", "body": "<p>Since I don't know what OLE server is linked to these, and probably don't even have that, I can't do a definitive test, however...</p>\n\n<p>OLE objects in Word, the same as with any dynamic information, are managed by field codes. You can toggle the display of field codes on and off using Alt+F9. For the formats I tested, these were EMBED fields.</p>\n\n<p>To turn field content into static content (the OLE objects into their graphic representation) unlinking the field should suffice. Based on the code you show us, something like this seems likely:</p>\n\n<pre><code>For Each oIshp In ActiveDocument.InlineShapes\n    i = i + 1\n    'On Error Resume Next ' do NOT use this!\n    Application.StatusBar = \"Progress: \" &amp; i &amp; \" of \" &amp; total\n    With oIshp   \n       If oIshp.Range.Fields.Count = 1 Then\n         oIshp.Range.Fields.Unlink\n       End If \n    End With\nNext oIshp\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4466153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8ce57f899ea32228128768ab45ecd7?s=128&d=identicon&r=PG", "display_name": "Morley Tooke", "link": "https://stackoverflow.com/users/4466153/morley-tooke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 0, "accepted_answer_id": 36189283, "answer_count": 1, "score": 0, "last_activity_date": 1508677912, "creation_date": 1458700449, "last_edit_date": 1459255095, "question_id": 36168797, "link": "https://stackoverflow.com/questions/36168797/can-you-get-image-data-from-an-ole-object-in-word-using-vba", "title": "Can you get image data from an OLE object in Word using VBA?", "body": "<p>I'm using a script (that I didn't write) to convert Word docs to XML. Everything works perfectly as long as the Word doc is consistently styled. One of the things that the script can't handle is when images are inserted as OLE objects. These images are simply ignored by the script, whereas images that were inserted regularly, as non-OLE objects, are picked up by the script just fine.</p>\n\n<p>I've also been using a VBA script (see part of it below) to clean up the document prior to transforming it. The script adds styles to the document, moves some things, and...what I'm trying to make it do is convert OLE images to non-OLE images. </p>\n\n<p>So what I want to know is: is there a way to iterate through the inlineShapes in the document and convert OLE graphics to regular graphics or, is there a way to get the image data out of the OLE object and paste it into the document as a PNG.</p>\n\n<p>This is what <em>my</em> vba script does right now:</p>\n\n<pre><code>Sub docscrubber()\n\nDim i  As Integer\nDim total  As Integer\nDim oIshp As InlineShape\n\ntotal = ActiveDocument.InlineShapes.Count\ni = 0\nFor Each oIshp In ActiveDocument.InlineShapes\n    i = i + 1\n    On Error Resume Next\n    Application.StatusBar = \"Progress: \" &amp; i &amp; \" of \" &amp; total\n        With oIshp\n\n         oIshp.Range.Copy\n         oIshp.Select\n         Selection.Paste\n\n        End With\nNext oIshp\n\nEnd Sub\n</code></pre>\n\n<p>Instead of getting the image data, I get the document code. </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c#", "vb.net", "vba", "generics", "dll"], "answers": [{"comments": [{"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1458699791, "post_id": 36168534, "comment_id": 59974516, "body": "Also I should note, it&#39;s a bit strange for a instance property to return a static (and public) field."}], "tags": [], "owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "is_accepted": true, "score": 1, "last_activity_date": 1458698907, "last_edit_date": 1458698907, "creation_date": 1458698445, "answer_id": 36168534, "question_id": 36168356, "link": "https://stackoverflow.com/questions/36168356/non-generic-indexer-for-c-com-dll-property/36168534#36168534", "title": "Non-generic indexer for C# COM DLL property", "body": "<p>The closest in C# of the VB.NET code you posted is this:</p>\n\n<pre><code>class Thing\n{\n    public static string[] _ReportParameters = new string[10];\n    public string[] ReportParameters { get { return _ReportParameters; } }\n}\n</code></pre>\n\n<p>Which is used as</p>\n\n<pre><code>var thing = new Thing();\nvar result = thing.ReportParameters[0];\nthing.ReportParameters[1] = \"Test\";\n</code></pre>\n\n<p>However, an indexer is written as follows:</p>\n\n<pre><code>class Thing\n{\n    public static string[] _ReportParameters = new string[10];\n    public string this[int index]\n    {\n        get\n        {   \n            return _ReportParameters[index];\n        }\n        set\n        {\n            _ReportParameters[index] = value;\n        }\n    }\n}\n</code></pre>\n\n<p>Which is used as </p>\n\n<pre><code>var thing = new Thing();\nvar result = thing[0];\nthing[1] = \"Test\";\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 3125278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9102a97fb74967f7ad3bb61f7a27197e?s=128&d=identicon&r=PG&f=1", "display_name": "user3125278", "link": "https://stackoverflow.com/users/3125278/user3125278"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 36168534, "answer_count": 1, "score": 1, "last_activity_date": 1458698907, "creation_date": 1458697154, "question_id": 36168356, "link": "https://stackoverflow.com/questions/36168356/non-generic-indexer-for-c-com-dll-property", "title": "Non-generic indexer for C# COM DLL property", "body": "<p>I'm trying to create an object array with an index that can be exposed inside Microsoft Access. I've found how to create an indexer class, but since it's generic the property is not exposed inside Access VBA. To be more specific, I'm converting a VB.NET COM DLL that works with Access, and this is a string array property code I'm trying to convert:</p>\n\n<pre><code>    Public Shared _ReportParameters(0 To 9) As String\n    Public Property ReportParameters(Optional index As Integer = Nothing) As String\n        Get\n            Return _ReportParameters(index)\n        End Get\n\n        Set(ByVal Value As String)\n            _ReportParameters(index) = Value\n        End Set\n    End Property\n</code></pre>\n\n<p>Here's the code I've converted to C# that is using an indexer class that cannot be exposed inside the DLL:</p>\n\n<pre><code>    public static string[] _ReportParameters = new string[10];\n    public Indexer&lt;string&gt; ReportParameters\n    {\n        get\n        {\n            return _ReportParameters.GetIndexer();\n        }\n    }\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1458697907, "creation_date": 1458697907, "answer_id": 36168464, "question_id": 36168237, "link": "https://stackoverflow.com/questions/36168237/writing-array-values-to-a-worksheet/36168464#36168464", "title": "Writing array values to a worksheet", "body": "<p>You cannot change with a function the content of other cells:\n<a href=\"https://support.microsoft.com/en-us/kb/170787\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/170787</a></p>\n\n<p>If you want to change another cell then you'll have to use a sub. If you couple the sub with an event (for example Worksheet_Change or Worksheet_SelectionChange) then you can get a similar result. But to avoid slowing down you Excel too much, I'd recommend that only the change or a few cells on the sheet can trigger such an event. Example:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Intersect(Target, Range(\"A1:C4\")) Is Nothing Then Exit Sub\nApplication.EnableEvents = False\n\n'Do you things\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6085009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b757b3546746fac9a654de063221cc8?s=128&d=identicon&r=PG&f=1", "display_name": "ipvincent54", "link": "https://stackoverflow.com/users/6085009/ipvincent54"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1458820714, "creation_date": 1458696362, "last_edit_date": 1458820714, "question_id": 36168237, "link": "https://stackoverflow.com/questions/36168237/writing-array-values-to-a-worksheet", "title": "Writing array values to a worksheet", "body": "<p>I was able to write the values in array x(n,3) if I enter the UDF shown below as array formula.  (The UDF below is only used for demonstration purpose. The actual task involves frequent changes of the array dimension as determined by the number n.)   Instead of entering the UDF as an array formula by highlighting the range (in excess of 150 rows) every time, I try to automate the process by using the function \"Resize\".   I get \"#Value!\" error in Cell \"K1\".  It also gives me \"#Value!\" if I enter the UDF as an array formula.</p>\n\n<p>Please advise.</p>\n\n<pre><code>Function Loadnumbers(n%, alpha#)\nDim Destination As Range\nSet Destination = Range(\"K1\")\nDim I As Integer\nReDim x(n, 3) As Double\n        For I = 1 To n\n                For J = 1 To 3\n                    x(I, J) = (x(I, 1) + 1) * alpha\n                    x(I, J) = (x(I, 1) + 2) * alpha\n                    x(I, J) = (x(I, 2) + 2) * alpha\n                Next J\n        Next I\nDestination.Resize(UBound(x, 1), UBound(x, 3)).Value = x() \n'The above statement gives me \"#Value!\" error either in a single cell (\"K1\") or the array.\n'Loadnumbers = x() \n'The above statement works using this statement as I enter as an array formula\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "radio-button", "inputbox"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1458699756, "post_id": 36167913, "comment_id": 59974507, "body": "I&#39;m not sure I understand what you want to do - where is the <code>target</code> parameter supposed to be coming from? How exactly is clicking on the Option Button supposed to pass a <code>Range</code>? This doesn&#39;t have anything to do with the visibility of the <code>Sub</code> - you can attach the click handler to either a <code>Public</code> or <code>Private</code> <code>Sub</code>."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458715576, "post_id": 36167913, "comment_id": 59979206, "body": "Is this radio button a form control? If yes, then why not use the ActiveX control? You can double click the control in design mode to access it&#39;s code area where you can put the code"}], "owner": {"reputation": 1, "user_id": 6079354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7825ce42dabb3fd65bd1590d1d394310?s=128&d=identicon&r=PG&f=1", "display_name": "Shane I.", "link": "https://stackoverflow.com/users/6079354/shane-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 935, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459499545, "creation_date": 1458694247, "last_edit_date": 1459499545, "question_id": 36167913, "link": "https://stackoverflow.com/questions/36167913/enter-value-into-cell-with-an-inputbox-when-a-radio-button-is-selected", "title": "Enter value into cell with an InputBox when a radio button is selected", "body": "<p>I have a worksheet named \"Main\" that I would like to have an InputBox to pop up when a radio button is selected; (Option Button 3 with value = 1 in cell A311), and have the value of the InputBox placed into cell R2. I have placed the following code directly into the objects sheet but can get it to only run when I assign the macro directly to the radio button.</p>\n\n<pre><code>Sub Pumped_WS()\n\nDim userinput As String\n\nSet pumped = ActiveSheet.Range(\"A311\")\nSet ws = ActiveSheet.Range(\"R2\")\n\nIf pumped.Value = 1 Then userinput = Application.InputBox(\"Please enter elevation for the pumping water surface!\")\n\n    ws.Value = userinput\n\nEnd Sub\n</code></pre>\n\n<p>I would like to set it up as a private sub and run based just on the selection of the radio button without having to assign the button a macro.  When I try:</p>\n\n<pre><code>Private Pumped_WS(ByVal target As Range)\n</code></pre>\n\n<p>with the rest of the code in the public sub; nothing happens when the radio button is selected.  Please help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 10, "creation_date": 1458695433, "post_id": 36167672, "comment_id": 59973395, "body": "Immediately after the <code>Application.ScreenUpdating = True</code> that is intended to update the screen off the deleted worksheet, put a <code>DoEvents</code> command. The message pump may be so crammed with backlogged queued commands that your screen update is getting lost. Also consider some judiciously applied <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> to reduce the repetitive parent workbook and worksheet references made in ADSformGen."}, {"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1458744324, "post_id": 36167672, "comment_id": 59997777, "body": "@Jeeped Thank you (+1) <code>DoEvents</code> is news to me, and is <b>awesome</b> - that works like a charm. I was looking it up some before I entered it, and someone mentions to take care using it (watch where you put it and what calls it?). I&#39;m not sure what the caveats are with it, but I put it immediately before [the &quot;End Sub&quot; line in my example above] and it just flips over. TYVM."}, {"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1458744638, "post_id": 36167672, "comment_id": 59998042, "body": "@Jeeped As far as &quot;With ... End With&quot; statements (and clean coding) goes: I&#39;m still not savvy (<i>at all</i>) with VBA, and am struggling with stuff like that as well as <i>not</i> activating sheets/workbooks (or cells/ranges) all the freaking time. I would <b>love</b> to learn better practices, and suggestions on resources that point me in the right direction (aside from Google searches) are certainly welcome and very appreciated. I am reading the link you posted and trying to wrap my head around that ATM, though - thank you again."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1458760280, "post_id": 36167672, "comment_id": 60008745, "body": "See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid Select/Activate methods in Excel VBA macros</a>"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 2, "creation_date": 1458772363, "post_id": 36167672, "comment_id": 60014950, "body": "See also <a href=\"http://www.homeandlearn.org/with_end_with.html\" rel=\"nofollow noreferrer\">homeandlearn.org/with_end_with.html</a>"}, {"owner": {"reputation": 3, "user_id": 8658182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e6a42b306ff17b380782c578b8d801b?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/8658182/mike-s"}, "edited": false, "score": 0, "creation_date": 1506112618, "post_id": 36167672, "comment_id": 79709076, "body": "This may or may not help for your specific situation, but there is a known issue with Excel 2016 screen refresh. The following link points to the KB update to fix the issue. It worked for me. <a href=\"https://support.microsoft.com/en-us/help/4011165/september-12-2017-update-for-excel-2016-kb4011165\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/4011165/&hellip;</a>"}, {"owner": {"reputation": 319, "user_id": 8920274, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/485Ds.jpg?s=128&g=1", "display_name": "I. \u042f. Newb", "link": "https://stackoverflow.com/users/8920274/i-%d0%af-newb"}, "edited": false, "score": 0, "creation_date": 1542406935, "post_id": 36167672, "comment_id": 93571225, "body": "@JGR, as @Jeeped advised use <code>With...End With</code> to avoid using <code>.Select</code>, which is a no-no in VBA, except for debugging."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1458743365, "post_id": 36168585, "comment_id": 59996957, "body": "In the Main sub, with no references to &quot;Screenupdating&quot; changes - where screen updating should be always on - I have these lines: <code>Call ADSformGen</code>;  <code>MainWrkBk.Worksheets(&quot;ADSform&quot;).Activate</code>;   <code>MainWrkBk.Worksheets(&quot;ADSform&quot;).Range(&quot;B2&quot;).Select</code>;  <code>&#39;MsgBox &quot;Enter antenna information from RFDS&quot;</code>;  <code>Call ADSinputFormShow</code>. Plus, I&#39;ve tried it immediately following a change to &quot;True&quot; within the lower subs w/o change."}, {"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1458744390, "post_id": 36168585, "comment_id": 59997833, "body": "I understand what you&#39;re saying, though - it&#39;s <b>supposed</b> to work that way (right??), it&#39;s just not flipping over."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 2, "creation_date": 1458753813, "post_id": 36168585, "comment_id": 60004849, "body": "@JGR - It <i>is</i> supposed to work that way.  If the message handler is swamped, you could try explicitly calling for a <code>ScreenRefresh</code>. See the edit."}, {"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1458765502, "post_id": 36168585, "comment_id": 60011761, "body": "I don&#39;t seem to have an <code>Application.ScreenRefresh</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 1, "creation_date": 1458772032, "post_id": 36168585, "comment_id": 60014819, "body": "@JGR - Doh! Apparently that&#39;s Word only - rolled back."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1458772063, "last_edit_date": 1458772063, "creation_date": 1458698766, "answer_id": 36168585, "question_id": 36167672, "link": "https://stackoverflow.com/questions/36167672/excle-vba-screenupdating-true-malfunction-screen-doesnt-refresh-e-g-to-c/36168585#36168585", "title": "Excle VBA - &quot;Screenupdating=True&quot; malfunction: Screen doesn&#39;t refresh (e.g. to change worksheet view)", "body": "<p>If you want to ensure that the screen updates when you active the sheet, turn screen updating on <em>before</em> you active it.  Otherwise, you risk the redraw event that the <code>Activate</code> call will generate getting swallowed:</p>\n\n<pre><code>    '...\n    Application.ScreenUpdating = True\n    MainWrkBk.Worksheets(\"ADSform\").Activate\n    MainWrkBk.Worksheets(\"ADSform\").Range(\"B2\").Select    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3789, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506112618, "creation_date": 1458692546, "question_id": 36167672, "link": "https://stackoverflow.com/questions/36167672/excle-vba-screenupdating-true-malfunction-screen-doesnt-refresh-e-g-to-c", "title": "Excle VBA - &quot;Screenupdating=True&quot; malfunction: Screen doesn&#39;t refresh (e.g. to change worksheet view)", "body": "<p>I'm having issues with a workbook not changing view to a newly unhidden/activated worksheet in-between toggling screen updating from off to on and back off again - it's not actually refreshing the screen. (code below)</p>\n\n<p>I have module that calls forms and subs from a main sub to carry out a number of tasks - within each of the subs (except the main) I turn off screen updating in the beginning and turn it on at the end (example below). The workbook has a number of worksheets (mostly hidden) that are used for processing or as the final visible view - when opened, only one sheet is visible (used to launch the main sub). </p>\n\n<p>While running, one of the subs unhides and activates the final worksheet, then deletes the starting worksheet - and toggles screen updating back on (\"True\"), and exits back to the main sub (which calls another sub again). </p>\n\n<p>But it doesn't change view, the view stays on the deleted sheet while the subs all finish. (I can \"trick\" it into changing view to the newly active worksheet by inserting a \"MsgBox\" - but don't want to do that.)</p>\n\n<p>This has been a hard one for me to search out answers (because looking up \"Screenupdating\" and anything else brings up a myriad of answers regarding \"how to stop the screen from updating\").</p>\n\n<pre><code>Sub createADS()\nDim oneForm As Object\n    Set MainWrkBk = ActiveWorkbook\n    cancel = False 'initialise\nCall ADSheaderFormShow\n    Set MainWrkBk = ActiveWorkbook 're-Set MainWrkBk after doing \"SaveAs\" in previous form\nCall ADSformGen\n    MainWrkBk.Worksheets(\"ADSform\").Activate 'Doesn't change view\n'MsgBox \"Enter antenna information from RFDS\"\n'^^^ Tricks it into refreshing worksheet when active\nCall ADSinputFormShow\nCall ADSsetAntennas\nCall ADSpullData\n\nGoTo ExitHandler\n\nExitHandler:\n    For Each oneForm In UserForms\n        Unload oneForm\n        ThisWorkbook.Save\n    Next oneForm\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True   \nEnd Sub\n\nPrivate Sub ADSformGen()\n    Application.ScreenUpdating = False 'Returned to True after running sub\nMainWrkBk.Worksheets(\"HidDbSh\").Visible = True\n\nMainWrkBk.Worksheets(\"HidDbSh\").Cells(1, 1).Value = \"Site Info\"\nMainWrkBk.Worksheets(\"HidSiteTemp\").Range(\"a1\").CurrentRegion.Copy _\n    Destination:=MainWrkBk.Worksheets(\"HidDbSh\").Cells(2, 1)\n    Columns.AutoFit\n    Application.Calculation = xlCalculationAutomatic 'to reset all formula calcs before deleting source\nMainWrkBk.Worksheets(\"HidDbSh\").Visible = False\n\nApplication.DisplayAlerts = False\nMainWrkBk.Worksheets(\"HidSiteTemp\").Delete\nApplication.DisplayAlerts = True\n\nMainWrkBk.Worksheets(\"HidADSform\").Visible = True\nMainWrkBk.Worksheets(\"HidADSform\").Name = \"ADSform\"\nWith MainWrkBk.Worksheets(\"ADSform\").UsedRange\n        .Copy\n        .PasteSpecial Paste:=xlPasteValues, _\n        Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n        Application.CutCopyMode = False\nEnd With\n\nApplication.DisplayAlerts = False\nMainWrkBk.Worksheets(\"BlankADSForm\").Delete\nApplication.DisplayAlerts = True\n\nMainWrkBk.Worksheets(\"ADSform\").Activate\n    MainWrkBk.Worksheets(\"ADSform\").Range(\"B2\").Select\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word", "office-2013"], "answers": [{"comments": [{"owner": {"reputation": 439, "user_id": 1071405, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f460d020753471e8c7c2215f0d141d0d?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1071405/jules"}, "edited": false, "score": 1, "creation_date": 1458748002, "post_id": 36172605, "comment_id": 60000722, "body": "Thanks for the code sample, it&#39;s interesting how different it is to the code I&#39;m messing with. The final line to get the sheet in my code is: Set myWS = myXL.Application.Worksheets(&quot;Sheet1&quot;), and after that things look similar, though it does a myXL.Quit at the end rather than changing visibility."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1458748939, "last_edit_date": 1458748939, "creation_date": 1458719969, "answer_id": 36172605, "question_id": 36167639, "link": "https://stackoverflow.com/questions/36167639/how-to-retrieve-data-from-excel-and-add-to-word/36172605#36172605", "title": "How to retrieve data from Excel and add to Word", "body": "<p>To retrieve data from an Excel</p>\n\n<p>An Example would be...</p>\n\n<pre><code>Option Explicit\nSub ExcelData()\n    Dim xlApp As Object ' Application\n    Dim xlBook As Object ' Workbook\n    Dim xlSht As Object ' Worksheet\n    Dim FilePath As String\n\n    FilePath = \"C:\\Temp\\Book1.xlsx\"\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    Set xlBook = xlApp.Workbooks.Open(FilePath)\n    Set xlSht = xlBook.Sheets(\"Sheet1\")\n\n    With ActiveDocument\n        .Content = xlSht.Range(\"A1\").Value\n    End With\n\n    xlApp.Visible = True\n\n    Set xlApp = Nothing\n    Set xlBook = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 439, "user_id": 1071405, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f460d020753471e8c7c2215f0d141d0d?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1071405/jules"}, "is_accepted": true, "score": 1, "last_activity_date": 1458744437, "creation_date": 1458744437, "answer_id": 36181360, "question_id": 36167639, "link": "https://stackoverflow.com/questions/36167639/how-to-retrieve-data-from-excel-and-add-to-word/36181360#36181360", "title": "How to retrieve data from Excel and add to Word", "body": "<p>To make the code work on Office 2013 I added the line myXL.Activate before trying to make the Window visible. So the code becomes:</p>\n\n<pre><code>Dim myXL As Object\nSet myXL = Getobject(\"myfile.xls\")\nmyXL.Application.Visible = True\nmyXL.Activate\nmyXL.Parent.Windows(1).Visible = True\n</code></pre>\n\n<p>This fixed the run-time error, and the code went back to working well.</p>\n"}], "owner": {"reputation": 439, "user_id": 1071405, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f460d020753471e8c7c2215f0d141d0d?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1071405/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 36181360, "answer_count": 2, "score": 1, "last_activity_date": 1594068088, "creation_date": 1458692369, "last_edit_date": 1594068088, "question_id": 36167639, "link": "https://stackoverflow.com/questions/36167639/how-to-retrieve-data-from-excel-and-add-to-word", "title": "How to retrieve data from Excel and add to Word", "body": "<p>I have a Word template file that retrieves data from an Excel file to populate a form.</p>\n\n<p>The code looks something like this:</p>\n\n<pre><code>Dim myXL As Object\nSet myXL = Getobject(\"myfile.xls\")\nmyXL.Application.Visible = True\nmyXL.Parent.Windows(1).Visible = True\n</code></pre>\n\n<p>This code works fine in Office 2010 and 2007, but when I try it in 2013, it gives <strong><code>run time error 9</code></strong> which is an <strong><code>array subscript error</code></strong>. When I check the Windows array it has zero elements, so error is correct.</p>\n\n<p>How do I achieve the same result in 2013?</p>\n\n<p>The next bit of code attempts to access the <strong><code>Worksheets(\"mysheet\"</code></strong>) and if I skip the Visible = True line accessing the worksheet gives <strong><code>runtime error 1004.</code></strong></p>\n\n<p>Any help with fixing this would be greatly appreciated.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1, "user_id": 5570005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d029f6ff7a578b432d8d418f4de9d30f?s=128&d=identicon&r=PG&f=1", "display_name": "CookinByTheBook", "link": "https://stackoverflow.com/users/5570005/cookinbythebook"}, "reply_to_user": {"reputation": 2984, "user_id": 643675, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/bbf4e261eb18df1d5589067e60669d61?s=128&d=identicon&r=PG", "display_name": "elhefe", "link": "https://stackoverflow.com/users/643675/elhefe"}, "edited": false, "score": 0, "creation_date": 1458693276, "post_id": 36166997, "comment_id": 59972796, "body": "well right now i have it  Private NameValue() Dim ProcedureCost if listbox.selectedindex = 0 then ProcedureCost = cint(45.00) end if  Haven&#39;t gotten to test it yet but hopefully this works...."}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1458691432, "creation_date": 1458691432, "answer_id": 36167497, "question_id": 36166997, "link": "https://stackoverflow.com/questions/36166997/giving-items-in-a-listbox-integer-value/36167497#36167497", "title": "Giving Items in a ListBox integer Value", "body": "<pre><code> Private Sub UserDidntBotherTryingItFirst()\n      If listbox.value = \"STUFF\" Then OtherVariableYouNeedToDeclare = \"SomeArbitraryNumber\"\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5570005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d029f6ff7a578b432d8d418f4de9d30f?s=128&d=identicon&r=PG&f=1", "display_name": "CookinByTheBook", "link": "https://stackoverflow.com/users/5570005/cookinbythebook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458691432, "creation_date": 1458688589, "question_id": 36166997, "link": "https://stackoverflow.com/questions/36166997/giving-items-in-a-listbox-integer-value", "title": "Giving Items in a ListBox integer Value", "body": "<p>I'm very new to programming in Visual Basic.\nRequirements:\nHave a listbox with prepopulated string values.  These are seen as medical procedures\nNose Job\nEyebrow Job\nLip Botox\nFace Lift</p>\n\n<p>Need these values:\n45.00\n75.00\n100.00\n150.00</p>\n\n<p>These each need to have a value that when selected can be calculated into other things.  </p>\n\n<p>I am also required to be able to add a new items to the listbox and each of these items need to have a vaule of 25.00.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1458686425, "post_id": 36166501, "comment_id": 59970365, "body": "What have you coded / tried thus far? Please add your VBA code to the question. I&#39;d be especially interested to see the function which does not seem to pose a problem."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1458735162, "post_id": 36166501, "comment_id": 59990769, "body": "you said &quot;every third column&quot; but the examples you gave seem to act on every column. how&#39;s that?"}, {"owner": {"reputation": 13, "user_id": 6008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c2d42705e4be21df5a3ae398adb2e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/6008845/ana"}, "edited": false, "score": 0, "creation_date": 1458736635, "post_id": 36166501, "comment_id": 59991842, "body": "Added an example of the actual file. Thanks for the clarifyin question."}], "answers": [{"comments": [{"owner": {"reputation": 415, "user_id": 6099655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d343b8c6fa75c600166e1b9aa9183a05?s=128&d=identicon&r=PG&f=1", "display_name": "CWilson", "link": "https://stackoverflow.com/users/6099655/cwilson"}, "edited": false, "score": 0, "creation_date": 1458755328, "post_id": 36170177, "comment_id": 60005831, "body": "I see the edit you put in this morning. I am still not sure why running a loop 30+ million times would crash excel, but if you are having that problem, I suggest reformatting the data."}, {"owner": {"reputation": 415, "user_id": 6099655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d343b8c6fa75c600166e1b9aa9183a05?s=128&d=identicon&r=PG&f=1", "display_name": "CWilson", "link": "https://stackoverflow.com/users/6099655/cwilson"}, "edited": false, "score": 0, "creation_date": 1458755764, "post_id": 36170177, "comment_id": 60006098, "body": "Not quite as easy as what I suggested, but still pretty easy. You could code something fancy if you wanted, but since we are only talking about 300-400 columns, it would be faster to just record a macro. Highlight columns D-F, cut, new sheet (or better a database table in something meant to hold data, even Access would work, but not my call), paste in A1, switch back to original sheet. Stop recording, add a hotkey, and just press the hotkey about a hundred times."}], "tags": [], "owner": {"reputation": 415, "user_id": 6099655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d343b8c6fa75c600166e1b9aa9183a05?s=128&d=identicon&r=PG&f=1", "display_name": "CWilson", "link": "https://stackoverflow.com/users/6099655/cwilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1458755192, "last_edit_date": 1458755192, "creation_date": 1458709165, "answer_id": 36170177, "question_id": 36166501, "link": "https://stackoverflow.com/questions/36166501/looping-a-function-over-columns-with-different-number-of-rows-in-vba/36170177#36170177", "title": "Looping a function over columns with different number of rows in VBA", "body": "<p>sorry I don't have the code in front of me, but I think I can still help.</p>\n\n<p>What about xlLastCell? I mean, that might not be the most efficient, but that would be the easiest. Just get the row and column of xlLastCell, and for row=1 to lastrow, for col=1 to lastcol, if it is blank then next col/next row, if abs(cell.value)=cell.value then sheets(2).cells(row,col)=1, else it =-1. You mentioned every third column, I would then just use an if .row mod 3 = (1,2,0 depending on what you need) to decide if you should next col or do that column.\nNow, this only works if by 'another matrix' you just mean another spreadsheet. If you mean a 2d array, you could find xlLastCell, and then redim matrix(lastrow,lastcol) as int, and put it all in the matrix instead of sheet2.\nOr, if you mean something completely different, then I apologize, and I am not sure.</p>\n"}], "owner": {"reputation": 13, "user_id": 6008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c2d42705e4be21df5a3ae398adb2e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/6008845/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458755192, "creation_date": 1458685976, "last_edit_date": 1458736614, "question_id": 36166501, "link": "https://stackoverflow.com/questions/36166501/looping-a-function-over-columns-with-different-number-of-rows-in-vba", "title": "Looping a function over columns with different number of rows in VBA", "body": "<p>I am dealing with a large dataset where every third column contains values for which I need to perform a function that takes value of 1 if it is positive than 0 and value of -1 if it is negative. Writing the function itself is no problem, but the dimensions of the data matrix are large and the columns are not of equal length. Thus I would need to be able to write a code that loops over the columns, performing the task, and saves the results in another matrix with equal number of colummns and rows of the same length. To be more concrete, an example of the dataset I am dealing with and what I want to achieve:</p>\n\n<pre><code>x1;x2;x3;x4\n1;-1;2;4\n-5;1;2;-1\n1; ;2;1\n3; ; ;-4\n5; ; ; \n6; ; ;\n</code></pre>\n\n<p>And transfer this into:</p>\n\n<pre><code>y1;y2;y3;y4\n1;-1;1;1\n-1;1;1;-1\n1; ;1;1\n1; ; ;-1\n1; ; ;\n1; ; ;\n</code></pre>\n\n<p>x's and y's need to be on the same row.</p>\n\n<p>Thank you in advance!</p>\n\n<p>EDIT:\nIn reality, what I am dealing with is something that looks more like this:</p>\n\n<pre><code>Timestamp   Last    Trade Volume    Timestamp   Last    Trade Volume    Timestamp   Last    Trade Volume    Timestamp   Last    Trade Volume\n4.1.2016 13:34  3.12    3300    4.1.2016 13:34  7.82    100 4.1.2016 13:34  4.58    3000    4.1.2016 13:35  4.59    #N/A\n4.1.2016 13:34  3.12    600 4.1.2016 13:34  7.83    300 4.1.2016 13:34  4.58    5750    4.1.2016 13:34  4.61    1000\n4.1.2016 13:34  3.12    1000    4.1.2016 13:34  7.85    200 4.1.2016 13:34  4.59    300 4.1.2016 13:34  4.61    9500\n4.1.2016 13:34  3.12    800 4.1.2016 13:34  7.85    500 4.1.2016 13:34  4.59    2000    4.1.2016 13:34  4.6 2200\n4.1.2016 13:34  3.12    1200    4.1.2016 13:34  7.85    1700    4.1.2016 13:34  4.59    1000    4.1.2016 13:34  4.6 1200\n4.1.2016 13:34  3.12    400 4.1.2016 13:34  7.85    100 4.1.2016 13:34  4.59    950 4.1.2016 13:33  4.6 500\n4.1.2016 13:34  3.12    600 4.1.2016 13:34  7.85    200 4.1.2016 13:34  4.59    100 4.1.2016 13:33  4.6 2000\n4.1.2016 13:34  3.11    4500    4.1.2016 13:34  7.85    1800    4.1.2016 13:34  4.59    750 4.1.2016 13:33  4.61    7500\n4.1.2016 13:34  3.11    300 4.1.2016 13:34  7.82    2000    4.1.2016 13:34  4.58    500 4.1.2016 13:33  4.59    1400\n4.1.2016 13:34  3.11    3700    4.1.2016 13:34  7.83    1000    4.1.2016 13:34  4.59    2000    4.1.2016 13:33  4.59    11000\n</code></pre>\n\n<p>Except that the rows are not of equal length, I have 300+ columns and the longest rows are over 100,000+ long. I need to be able to run this thing over the Last columns only, I have a different code to be ran over the Volume column. I am completely fine with a solution that allows for me to paste a cell including the formula for a column of corresponding length, but pasting the code over the whole array is not doable because it will crash the whole excel, i.e. I need to be able to omit the cells that have no values form the loop.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1458711967, "post_id": 36166377, "comment_id": 59977940, "body": "You need to provide detailed information about what this macro should run on, the results it is currently giving you and what the desired result should be. And what do you mean, exactly, by &quot;Track Change to trigger on macro run&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "is_accepted": true, "score": 0, "last_activity_date": 1458725879, "last_edit_date": 1458725879, "creation_date": 1458725532, "answer_id": 36174341, "question_id": 36166377, "link": "https://stackoverflow.com/questions/36166377/macro-to-add-leading-zeroes-to-date-with-tracking-on-microsoft-vba/36174341#36174341", "title": "Macro to add leading zeroes to date with Tracking on - Microsoft VBA", "body": "<p>You need to provide details in neat. If I understood correctly form your question,</p>\n\n<blockquote>\n  <p>\"script won't keep looping endlessly on the first result\",</p>\n</blockquote>\n\n<p>I think while Track changes are on, words find and replace replaces entire date, so it when you collpse at <code>.find .execute</code> there is again the new replaced date so it loops endlessly. You need to add one more .find.execute to skip the new date inserted. I think this will solve the problem.</p>\n\n<pre><code>Sub TestTrackOn()\nWith ActiveDocument.Range\nWith .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"([0-9]{1,2})[/]([0-9]{1,2})[/]([0-9]{4})\"\n    .Format = True\n    .Wrap = wdFindStop\n    .Forward = True\n    .MatchWildcards = True\n    .Execute\n    End With\n    Do While .Find.Found\nIf IsDate(.Text) Then\n    .Text = Format(.Text, \"dd/mm/yyyy\")\nEnd If\n.Collapse wdCollapseEnd\n.Find.Execute\n.Find.Execute\nLoop\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6091637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1d323867f22dd89f409c063a06f4d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent Duong", "link": "https://stackoverflow.com/users/6091637/vincent-duong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 36174341, "answer_count": 1, "score": 1, "last_activity_date": 1459254266, "creation_date": 1458685410, "last_edit_date": 1495541266, "question_id": 36166377, "link": "https://stackoverflow.com/questions/36166377/macro-to-add-leading-zeroes-to-date-with-tracking-on-microsoft-vba", "title": "Macro to add leading zeroes to date with Tracking on - Microsoft VBA", "body": "<p>The following code works without Track Changes on. What changes would have to be made for 'Track Changes' to trigger on macro run and that the script won't keep looping endlessly on the first result? </p>\n\n<pre><code>Sub ConvertDateFormat()\nWith ActiveDocument.Range\nWith .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"([0-9]{1,2})[/]([0-9]{1,2})[/]([0-9]{4})\"\n    .Format = True\n    .Wrap = wdFindStop\n    .Forward = True\n    .MatchWildcards = True\n    .Execute\n    End With\n    Do While .Find.Found\n\nIf IsDate(.Text) Then\n    .Text = Format(.Text, \"dd/mm/yyyy\")\nEnd If\n.Collapse wdCollapseEnd\n.Find.Execute\nLoop\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Above solution is from:\n<a href=\"https://stackoverflow.com/questions/36122915/working-with-microsoft-word-vba-macro-to-add-leading-zeroes-to-date/36123805?noredirect=1#comment59945481_36123805\">Working with Microsoft Word VBA - macro to add leading zeroes to date</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458684201, "post_id": 36165887, "comment_id": 59969368, "body": "Interesting. Would you do me a favor and test one thing? Replace <code>ThisWorkbook.Sheets(&quot;Input&quot;).Range(&quot;A1&quot;).Select</code> with <code>shtInputSheetCodeName.Range(&quot;A1&quot;).Select</code> and try it again. Of course you&#39;ll have to exchange the CodeName for the real one <code>? ThisWorkbook.Sheets(&quot;Input&quot;).CodeName</code> Another thing would be to <code>Activate</code> the sheet before <code>.Select</code>ing anything on the sheet. So, try to place a <code>ThisWorkbook.Sheets(&quot;Input&quot;).Activate</code> just before you <code>Select</code>."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458717157, "post_id": 36165887, "comment_id": 59979916, "body": "Also see <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a>"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1458746198, "post_id": 36165887, "comment_id": 59999294, "body": "Same issue using CodeName. Note that it had the generic <code>Sheet1</code> CodeName which is identical to the only sheet from another open workbook. Any further ideas would be welcome."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458746557, "post_id": 36165887, "comment_id": 59999614, "body": "@SiddharthRout I understand those concerns and I am not doing any data manipulation through the select. It is just to reset the sheet to it&#39;s initial stage with the top right hand cell selected."}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1458747234, "post_id": 36166669, "comment_id": 60000117, "body": "Excellent explanation and resolution to my issue. As I mentioned on my comment above I am not doing any data manipulation with the <code>.Select</code> but just resetting the Worksheet to its initial state with focus set to the top right cell. Regards and thank you."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1458747769, "post_id": 36166669, "comment_id": 60000535, "body": "I would recommend adding one more line to ensure that you do not get an error if the worksheet is hidden. <code>wb.Visible = xlSheetVisible</code> before the line  <code>wb.Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).Select</code>"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1458750415, "post_id": 36166669, "comment_id": 60002542, "body": "@SiddharthRout love how your thinking of all possible situations. Since the users have to activate the sheet to trigger the script though I don&#39;t think this will be a situation that we will run into operationally. Thanks though for the idea :)"}, {"owner": {"reputation": 911, "user_id": 1844634, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/6eaf3b44073a8a3c9f7dd238ca8ff4a1?s=128&d=identicon&r=PG", "display_name": "user1844634", "link": "https://stackoverflow.com/users/1844634/user1844634"}, "edited": false, "score": 0, "creation_date": 1504769779, "post_id": 36166669, "comment_id": 79142642, "body": "Hi, I have a similar problem. Though i did the wb.activate and wb.Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).Select throwing the error selected method or range class failed. I am using office 2016"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 11, "last_activity_date": 1458687176, "last_edit_date": 1458687176, "creation_date": 1458686826, "answer_id": 36166669, "question_id": 36165887, "link": "https://stackoverflow.com/questions/36165887/run-time-error-1004-select-method-of-range-class-failed-using-thisworkbook/36166669#36166669", "title": "Run Time Error &#39;1004&#39;: Select method of Range Class failed using ThisWorkbook", "body": "<p>It doesn't have anything to do with the reference to <code>ThisWorkbook</code> at all.  You simply can't Select a Range in an object that isn't active.  Consider this code, which exhibits the same error:</p>\n\n<pre><code>Private Sub OneOhOhFour()\n\n    'Executing with Book1.xlsm active and Book2.xlsx open.\n    Dim wb As Workbook\n    Set wb = Application.Workbooks(\"Book2.xlsx\")\n    Debug.Print ThisWorkbook.Name\n    'Outputs 'Book1.xlsm' to Immediate window.\n    wb.Sheets(\"Sheet1\").Range(\"A1\").Select   'Error 1004\n\nEnd Sub \n</code></pre>\n\n<p>Same thing with Worksheets:</p>\n\n<pre><code>Private Sub OneOhOhFourVTwo()\n    'Starting on anywhere but Sheet2 gives an error.\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet2\")\n    ws.Range(\"A1\").Select  'Error 1004.\nEnd Sub\n</code></pre>\n\n<p>The simple solution is to Activate the object before you Select within it:</p>\n\n<pre><code>Private Sub NoOneOhOhFour()\n\n    Dim wb As Workbook\n    Set wb = Application.Workbooks(\"Book2.xlsx\")\n    wb.Activate\n    wb.Sheets(\"Sheet1\").Range(\"A1\").Select  'No error.\n\nEnd Sub\n</code></pre>\n\n<p>Even better is using references and trying to avoid using the Selection and Active* objects entirely.</p>\n"}], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34159, "favorite_count": 1, "accepted_answer_id": 36166669, "answer_count": 1, "score": 7, "last_activity_date": 1458687176, "creation_date": 1458683305, "last_edit_date": 1531161705, "question_id": 36165887, "link": "https://stackoverflow.com/questions/36165887/run-time-error-1004-select-method-of-range-class-failed-using-thisworkbook", "title": "Run Time Error &#39;1004&#39;: Select method of Range Class failed using ThisWorkbook", "body": "<p>During the process of running a script if I manually remove focus from the Workbook containing the macro I get the error quoted. If I don't click on anything it works without issue. Script errors out only when I'm trying to place selection back into <code>A1</code> from the \"Input\" sheet. Break point is on following line:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Input\").Range(\"A1\").Select\n</code></pre>\n\n<p>If I debug and place focus back on macro Worksheet the script completes without issue. Previous line:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Input\").Cells.Delete\n</code></pre>\n\n<p>runs without error so I'm guessing its the range that is falling out of scope but don't quite understand why as it should be defined by the previous scope notations.\nCan someone explain why that line is falling out of scope? Shouldn't the <code>ThisWorkbook</code> define fairly explicitly the Workbook that my code is referencing? Any guidance is greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "user-defined-functions", "udf"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1458679613, "post_id": 36164605, "comment_id": 59966926, "body": "I wouldn&#39;t know how to achieve all of that in one single step without using a macro (which is according to your question not an option). Unless @Jeeped has a clue I am pretty sure you are out of luck."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 1, "creation_date": 1458687144, "post_id": 36164605, "comment_id": 59970656, "body": "Have to agree, this looks to be more than a &quot;tall order&quot; if you can&#39;t use VBA. Funny thing is that this would be a trivial tasks with VBA and could be fully &quot;automatic&quot; if you trapped the events that you wanted to trigger the calculation."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1458687489, "post_id": 36164605, "comment_id": 59970809, "body": "&quot;It also needs to be done automatically, so no Macros&quot; this statement is nonsense.  Like saying &quot;I need to wear pants, so I cannot wear pants.&quot;  Macros are how Excel is automated.  You cannot automate Excel without Macros."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1458687628, "post_id": 36164605, "comment_id": 59970862, "body": "Of note: Step 1 cannot be accomplished with a UDF, except perhaps through some ill-advised hack.  For this you will need a macro."}, {"owner": {"reputation": 11, "user_id": 6093813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ead0b5b399c06c2f4d17cd37ecc1ed?s=128&d=identicon&r=PG&f=1", "display_name": "5il3nc3r", "link": "https://stackoverflow.com/users/6093813/5il3nc3r"}, "reply_to_user": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1458734272, "post_id": 36164605, "comment_id": 59990191, "body": "@n8: UDFs are in VBA too, no? Do you consider UDFs as Macros too? To me, Macros are functions or a series of actions that you need to &quot;press start to run&quot;. What I&#39;m looking for is a (or multiple) UDFs that I can just enter in cells, as custom formulas, that will eventually get me the result I seek, dynamically, without having to manually run them each time.  Also, for step one, it&#39;s already being done with my first example (the one that starts with =IFERROR( ) so I hardly see it as impossible without a &quot;hack&quot;."}, {"owner": {"reputation": 11, "user_id": 6093813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ead0b5b399c06c2f4d17cd37ecc1ed?s=128&d=identicon&r=PG&f=1", "display_name": "5il3nc3r", "link": "https://stackoverflow.com/users/6093813/5il3nc3r"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458734373, "post_id": 36164605, "comment_id": 59990248, "body": "@Ralph Doesn&#39;t have to be in one single step. Like I said, I use an &quot;Intermediate&quot; worksheet for any multi-step process, so the user will only see the end-result."}, {"owner": {"reputation": 11, "user_id": 6093813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ead0b5b399c06c2f4d17cd37ecc1ed?s=128&d=identicon&r=PG&f=1", "display_name": "5il3nc3r", "link": "https://stackoverflow.com/users/6093813/5il3nc3r"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1458734479, "post_id": 36164605, "comment_id": 59990301, "body": "@Ambie I might have misunderstood terms then. I can use VBA for this (as shown with my second sample, which is a UDF). I just don&#39;t want something that requires user-input to run, which was my understanding of what a macro is."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1458746130, "post_id": 36164605, "comment_id": 59999225, "body": "UDFs return a single value, it populates a single cell.  All macros are VBA, but not all VBA are macros.  I was speaking purely in terms of your language, a UDF cannot &quot;Remove all blank cells&quot;, but it can disregard them."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1458746240, "post_id": 36164605, "comment_id": 59999338, "body": "What you are trying to do is set up something that will run very slowly, be very hard to understand, and be very hard to validate.  Can I ask why you are opposed to requiring a user-trigger?"}, {"owner": {"reputation": 11, "user_id": 6093813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ead0b5b399c06c2f4d17cd37ecc1ed?s=128&d=identicon&r=PG&f=1", "display_name": "5il3nc3r", "link": "https://stackoverflow.com/users/6093813/5il3nc3r"}, "reply_to_user": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1458760865, "post_id": 36164605, "comment_id": 60009115, "body": "@n8 Lets just say I have limited trust in my users&#39; ability to not screw up.  Although I guess I won&#39;t have much choice, based on the feedback I got here. Just gotta hope for the best."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1458761063, "post_id": 36164605, "comment_id": 60009254, "body": "There are a lot of options.  For example, you can schedule a job to run the macro if the data source is dumped on a schedule, so users just get the end product.  There are a lot of ways to constrain user input."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6093813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ead0b5b399c06c2f4d17cd37ecc1ed?s=128&d=identicon&r=PG&f=1", "display_name": "5il3nc3r", "link": "https://stackoverflow.com/users/6093813/5il3nc3r"}, "edited": false, "score": 0, "creation_date": 1458735472, "post_id": 36165794, "comment_id": 59990996, "body": "Thanks for that. Can you tell me what the syntax is for it though?  I tried to just add the range of values in the Raw worksheet (one column, 4000 lines) and it gives me a #NAME error.  (Also, I had to rename the function, since excel tells me &quot;PerformTask&quot; is not a valid name (possibly because it conflicts with a built-in name)"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1458747321, "post_id": 36165794, "comment_id": 60000196, "body": "#NAME error means that the function doesn&#39;t exist.  This is a macro, so you cannot call it as a UDF.  You just run it."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "reply_to_user": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1458766836, "post_id": 36165794, "comment_id": 60012468, "body": "as per @n8 comment,  the task is not suitable for UDF.  Macro/vba is more suitable for the purpose."}, {"owner": {"reputation": 11, "user_id": 6093813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ead0b5b399c06c2f4d17cd37ecc1ed?s=128&d=identicon&r=PG&f=1", "display_name": "5il3nc3r", "link": "https://stackoverflow.com/users/6093813/5il3nc3r"}, "edited": false, "score": 0, "creation_date": 1458821393, "post_id": 36165794, "comment_id": 60032995, "body": "Oh okay, I&#39;m gonna have to look up how to set up/use macros then.  Thanks for the code :D"}], "tags": [], "owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "is_accepted": false, "score": 1, "last_activity_date": 1458686753, "last_edit_date": 1458686753, "creation_date": 1458682920, "answer_id": 36165794, "question_id": 36164605, "link": "https://stackoverflow.com/questions/36164605/how-can-i-take-a-list-of-values-perform-multiple-cleaning-operations-on-them/36165794#36165794", "title": "How can I take a list of values, perform multiple &quot;cleaning&quot; operations on them and place them elsewhere in the workbook?", "body": "<p>Here is the solution in vba :)</p>\n\n<pre><code>Sub PerformTask()\n    Dim oSel As Range\n    Dim oWS As Worksheet\n    Dim iCol As Integer\n    Dim iMax As Integer\n\n    iMax = 10\n\n    'Copy original sheet\n    Set oWS = ActiveWorkbook.Sheets(1)\n    oWS.Copy after:=oWS\n\n    ' get the new worksheet\n    Set oWS = ActiveWorkbook.Sheets(oWS.Index + 1)\n\n    'sort column to remove blanks\n    SortColumn oWS, 1\n\n    Set oSel = oWS.Columns(1)\n    oSel.TextToColumns DataType:=xlDelimited, Space:=True 'parse data\n\n    ' sort columns assuming not more than 10 if more change iMax\n    For iCol = 2 To iMax\n        SortColumn oWS, iCol 'Sort column to remove blanks\n    Next\n\n    'copy data to column 1\n    For iCol = 2 To iMax\n        Set oSel = oWS.Cells(1, iCol)\n\n        ' if more than one row select all\n        If oSel.Offset(1, 0).Value &lt;&gt; \"\" Then\n            Set oSel = Range(oSel, oSel.End(xlDown))\n        End If\n\n        oSel.Cut\n\n        ' Move to the last free cell on column 1\n        oWS.Cells(1, 1).End(xlDown).Offset(1, 0).Select\n        oWS.Paste\n    Next\n\n    SortColumn oWS, 1 'Sort\n\nEnd Sub\n\nSub SortColumn(poWS As Worksheet, piCol As Integer)\n    Dim oSel As Range\n\n    Set oSel = poWS.Columns(piCol)\n    With poWS.Sort\n        .SortFields.Clear\n        .SortFields.Add oSel\n        .SetRange oSel\n        .Apply\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6093813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ead0b5b399c06c2f4d17cd37ecc1ed?s=128&d=identicon&r=PG&f=1", "display_name": "5il3nc3r", "link": "https://stackoverflow.com/users/6093813/5il3nc3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458686753, "creation_date": 1458678692, "question_id": 36164605, "link": "https://stackoverflow.com/questions/36164605/how-can-i-take-a-list-of-values-perform-multiple-cleaning-operations-on-them", "title": "How can I take a list of values, perform multiple &quot;cleaning&quot; operations on them and place them elsewhere in the workbook?", "body": "<p>I just spent most of the day trying to figure out how to do this, and the most I've gotten is one or two of the operations I wanted done, and then I can't get the rest to work.</p>\n\n<p>I will preface by saying that I currently have an \"Intermediate\" worksheet for multi-step processes, so having to do what I want that way is perfectly acceptable.</p>\n\n<p>Now for that actual problem:</p>\n\n<ul>\n<li>I have a very large list (approaching 2000 lines) of raw data. Each cell in this list can contain either nothing (blank), 0, or either a 6 digit number (243300, 143356, etc.) or multiple 6 digit numbers in the same cell, separated by a space.</li>\n</ul>\n\n<p>What I want to do is:</p>\n\n<ol>\n<li>Remove all blank cells</li>\n<li>Separate, if applicable, cells that contain more than one value</li>\n<li>Remove the duplicate values</li>\n<li>Sort the remaining values alpha-numerically</li>\n<li>Place the resulting list in the \"Main\" worksheet, for a clean presentation to the users.</li>\n</ol>\n\n<p>The solution cannot modify the values in the raw list (that's why I have the \"Intermediate\" worksheet)\nIt also needs to be done automatically, so no Macros.</p>\n\n<hr>\n\n<p>What I currently have is either:</p>\n\n<pre><code>    =IFERROR(INDEX(Raw!$G$2:$G$5000, MATCH(0, COUNTIF(Intermediate!$F$2:$F2, Raw!$G$2:$G$5000), 0)),\"\")\n</code></pre>\n\n<p>which gives me a list without blanks, no duplicates, but not sorted, and without the multi-value cells split;\nor</p>\n\n<pre><code>    Public Function Blah(ParamArray args()) As String\n'Declarations\nDim uniqueParts As Collection\nDim area As Range\nDim arg, arr, ele, part\nDim i As Long\n\n'Initialisations\nSet uniqueParts = New Collection\n\n'Enumerate through the arguments passed to this function\nFor Each arg In args\n    If TypeOf arg Is Range Then 'range so we need to enumerate its .Areas\n        For Each area In arg.Areas\n        arr = area.Value 'for large ranges it is greatly quicker to load the data at once rather than enumerating each cell in turn\n            For Each ele In arr 'enumerate the array\n                 addParts CStr(ele), uniqueParts 'Call our sub to parse the data\n            Next ele\n        Next area\n    ElseIf VarType(arg) &gt; vbArray Then 'an array has been passed in\n        For Each ele In arg 'enumerate the array\n            addParts CStr(ele), uniqueParts 'Call our sub to parse the data\n        Next ele\n    Else 'assume can be validly converted to a string. If it cannot then it will fail fast (as intended)\n        addParts CStr(arg), uniqueParts 'Call our sub to parse the data\n    End If\nNext arg\n\n'process our results\nIf uniqueParts.Count &gt; 0 Then\n    ReDim arr(0 To uniqueParts.Count - 1)\n    For i = 1 To uniqueParts.Count\n        arr(i - 1) = uniqueParts(i)\n    Next i\n    'we now have an array of the unique parts, which we glue together using the Join function, and then return it\n    Blah = Join(arr, \",\")\nEnd If\n\nEnd Function\n'Sub to parse the data. In this case the sub splits the string and adds the split elements to a collection, ignoring duplicates\nPrivate Sub addParts(partsString As String, ByRef outputC As Collection)\n'ByRef is unecessary but I use it to document that outputC must be instantiated\n    Dim part\n    For Each part In Split(partsString, \",\")\n        On Error Resume Next 'existing same key will raise an error, so we skip it and just carry on\n        outputC.Add part, part\n        On Error GoTo 0\n    Next part\nEnd Sub\n</code></pre>\n\n<p>which I was given a few years ago for a different need. This UDF splits multi-value cells, gets rid of blanks and duplicates, but concatenates the result afterwards.</p>\n\n<p>I'm unfortunately a noob when it comes to UDF and VBA, so I can't even figure out how to change that UDF so it exports to a series of rows instead of merging the results. (I know it's the \"Join\" part at the end, but I don't know what to replace it with)</p>\n\n<p>I'm aware that this is a tall order, but any help or nudges in the right direction are greatly welcome.</p>\n\n<p>Feel free to ask if I forgot to include helpful information.</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 496, "user_id": 6054151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fab15122ab6b555defabdd6984cc48?s=128&d=identicon&r=PG&f=1", "display_name": "LMM9790", "link": "https://stackoverflow.com/users/6054151/lmm9790"}, "is_accepted": false, "score": 1, "last_activity_date": 1458678723, "creation_date": 1458678723, "answer_id": 36164613, "question_id": 36164147, "link": "https://stackoverflow.com/questions/36164147/need-a-macro-to-pull-data-from-tabs/36164613#36164613", "title": "Need a macro to pull data from tabs", "body": "<p>The following code assumes that your main sheet is the first worksheet in the workbook. In the first column the names of the individual employees is displayed (given that your sheets are named after the employees).  </p>\n\n<pre><code>Sub GetInfo()\n\n        Dim intCounter As Integer\n\n        For intCounter = 2 To Worksheets.Count\n            Worksheets(1).Cells(intCounter, 1) = Worksheets(intCounter).Name\n            Worksheets(1).Cells(intCounter, 2) = Worksheets(intCounter).Range(\"C1\").Value\n            Worksheets(1).Cells(intCounter, 3) = Worksheets(intCounter).Range(\"D1\").Value\n            Worksheets(1).Cells(intCounter, 4) = Worksheets(intCounter).Range(\"U11\").Value\n            Worksheets(1).Cells(intCounter, 5) = Worksheets(intCounter).Range(\"I20\").Value\n        Next\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6100798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8c7b7f00f327602199a92d4946547f7?s=128&d=identicon&r=PG&f=1", "display_name": "J Smith", "link": "https://stackoverflow.com/users/6100798/j-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1478253751, "creation_date": 1458677196, "last_edit_date": 1531161705, "question_id": 36164147, "link": "https://stackoverflow.com/questions/36164147/need-a-macro-to-pull-data-from-tabs", "title": "Need a macro to pull data from tabs", "body": "<p>My spreadsheet has one \"Main\" sheet that displays info that it gathers from other sheets and populate a table. I need to grab the info from 4 cells that are the same in each info sheet. The data it pulls is name, hours worked, etc. and it's from cells c1, d1, u11, and i20.  </p>\n\n<p>The number of sheets will vary as employees vary but I can put a cell in a1 of the main sheet to indicate the number of employees. Each tab is named after the employee, but I'm hoping they are somehow numbered in the background by Excel?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6100610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a096c49a7e99882483f8e4d8b993697a?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100610/tim"}, "edited": false, "score": 0, "creation_date": 1458939523, "post_id": 36164625, "comment_id": 60087031, "body": "This was perfect and thank you @TheGuyThatDoesn&#39;tKnowMuch!  I was able to add taking the difference in CurrentDate and the dates for each record to show outstanding days next to the IDs in the msgbox as well."}], "tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": true, "score": 1, "last_activity_date": 1458678774, "creation_date": 1458678774, "answer_id": 36164625, "question_id": 36164023, "link": "https://stackoverflow.com/questions/36164023/excel-vba-find-row-based-on-2-conditions-and-add-to-msgbox/36164625#36164625", "title": "Excel VBA Find row based on 2 conditions and add to msgbox", "body": "<p>Try the following:</p>\n\n<pre><code>Sub test()\n\nDim i As Long\nDim lRow As Long\nDim msg As String\n\nlRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nWith ThisWorkbook.ActiveSheet\n\nFor i = 2 To lRow\n\nIf IsNumeric(.Cells(i, 1).Value) And .Cells(i, 1).Value &lt;&gt; \"\" Then\n\n    If .Cells(i, 8).Value = \"\" Then\n\n        If msg = \"\" Then\n\n            msg = CStr(.Cells(i, 1).Value)\n\n        Else\n\n            msg = msg + \", \" + CStr(.Cells(i, 1).Value)\n\n        End If\n\n    End If\n\nEnd If\n\nNext i\n\nEnd With\n\nMsgBox msg\n\nEnd Sub\n</code></pre>\n\n<p>It loops through each cell in Column A (IDs), and when not blank AND is a number(in case some values are not IDs, but instead text fields), then if the cell in the same row in Column H is blank, add it to <code>msg</code>, then show a message box at the end that is <code>msg</code>.</p>\n\n<p>Output from my testing is the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GvP8n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GvP8n.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 6100610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a096c49a7e99882483f8e4d8b993697a?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100610/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 36164625, "answer_count": 1, "score": 0, "last_activity_date": 1459254260, "creation_date": 1458676699, "last_edit_date": 1459254260, "question_id": 36164023, "link": "https://stackoverflow.com/questions/36164023/excel-vba-find-row-based-on-2-conditions-and-add-to-msgbox", "title": "Excel VBA Find row based on 2 conditions and add to msgbox", "body": "<p>I have a log sheet that tracks projects. I'm trying to figure out how to look at each row, find if there is an ID# in column A, if so then check that row to see if there is a date in column H. If the date is missing then a msgbox would popup on open to list all the ID#s that are missing the date.  What I have works when the StrID is defined, but I want to be able to find all the ID#s and list them on a msgbox. Any guidance or a point in the right direction would greatly be appreciated. Thx</p>\n\n<pre><code>    Dim rngFound As Range\n    Dim strFirst As String\n    Dim strid As String\n    Dim strDate As String\n\n    strid = \"8\"\n    strDate = vbNullString\n\n    Set rngFound = Columns(\"a:a\").Find(strid, Cells(Rows.Count, \"a:a\"), xlValues, xlWhole)\n    If Not rngFound Is Nothing Then\n        strFirst = rngFound.Address\n        Do\n            If LCase(Cells(rngFound.Row, \"h:h\").Text) = LCase(strDate) Then\n                'Found a match\n                MsgBox \"ID #\" &amp; Cells(rngFound.Row, \"a:a\").Text &amp; \"is open.\"\n\n            End If\n            Set rngFound = Columns(\"a:a\").Find(strid, rngFound, xlValues, xlWhole)\n        Loop While rngFound.Address &lt;&gt; strFirst\n    End If\n\n    Set rngFound = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "excel", "vba", "ribbonx"], "comments": [{"owner": {"reputation": 7096, "user_id": 3990767, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5741a212e3b0e6bd46a8a1e6d76a4a?s=128&d=identicon&r=PG", "display_name": "SOFe", "link": "https://stackoverflow.com/users/3990767/sofe"}, "edited": false, "score": 0, "creation_date": 1458676120, "post_id": 36163774, "comment_id": 59964788, "body": "You should answer your own question in the answers."}, {"owner": {"reputation": 2526, "user_id": 2785041, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Jdmdp.jpg?s=128&g=1", "display_name": "morxa", "link": "https://stackoverflow.com/users/2785041/morxa"}, "edited": false, "score": 0, "creation_date": 1458676196, "post_id": 36163774, "comment_id": 59964834, "body": "Providing an answer to your own question is completely okay and also often quite useful. However, you should not answer in the question; post your answer as a separate answer instead. The question should really only contain the question."}, {"owner": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "edited": false, "score": 0, "creation_date": 1458676838, "post_id": 36163774, "comment_id": 59965274, "body": "Ok, thanks for your advise."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6266899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c01cc5f94f00321cd381009dc0a90fbd?s=128&d=identicon&r=PG&f=1", "display_name": "MIchael G.", "link": "https://stackoverflow.com/users/6266899/michael-g"}, "is_accepted": false, "score": 4, "last_activity_date": 1461850809, "creation_date": 1461850809, "answer_id": 36916461, "question_id": 36163774, "link": "https://stackoverflow.com/questions/36163774/contextmenu-for-table-xml-excel/36916461#36916461", "title": "ContextMenu for table xml excel", "body": "<p>Try using idMso=\"ContextMenuListRange\" for excel table context menu modification.</p>\n"}], "owner": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461850809, "creation_date": 1458675932, "last_edit_date": 1458676796, "question_id": 36163774, "link": "https://stackoverflow.com/questions/36163774/contextmenu-for-table-xml-excel", "title": "ContextMenu for table xml excel", "body": "<p>Today, I was looking for a method for customize contextual menu in excel. I found this topic useful:</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s6/win001.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s6/win001.htm</a></p>\n\n<p>However in the following XML code, this snnipet idMso=\"ContextMenuCell\" doesn't work under any circumstances. I spent several hours looking for a table object id for idMso.</p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n   &lt;contextMenus&gt;\n      &lt;contextMenu idMso=\"ContextMenuCell\"&gt;\n         &lt;dynamicMenu id=\"MyDynamicMenu\" \n        label= \"My Dynamic Menu\" imageMso=\"HappyFace\" \n        getContent=\"GetContent\" insertBeforeMso=\"Cut\"/&gt;\n      &lt;/contextMenu&gt;\n   &lt;/contextMenus&gt;\n&lt;/customUI&gt;\n</code></pre>\n"}, {"tags": ["arrays", "vba", "multidimensional-array", "range", "jagged-arrays"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1458676623, "post_id": 36163627, "comment_id": 59965135, "body": "The only way I know is to create a 2D-array and fill it with a for loop."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1458676728, "post_id": 36163627, "comment_id": 59965203, "body": "how do i setup such a 2D array? can you give me an example?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1458676819, "post_id": 36163627, "comment_id": 59965257, "body": "Have a look here: <a href=\"http://www.homeandlearn.org/multidimensional_arrays.html\" rel=\"nofollow noreferrer\">homeandlearn.org/multidimensional_arrays.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1458689449, "post_id": 36164384, "comment_id": 59971523, "body": "You won&#39;t find anything quicker since it&#39;s the only way. However you could improve this one by declaring tarr() As Variant, c as Long, r as long and by using variables for the bounds in the second for."}], "tags": [], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "is_accepted": false, "score": 2, "last_activity_date": 1458678003, "creation_date": 1458678003, "answer_id": 36164384, "question_id": 36163627, "link": "https://stackoverflow.com/questions/36163627/jagged-array-to-2d-array/36164384#36164384", "title": "Jagged Array to 2D Array", "body": "<p>On Florent's idea, i actually wrote my own Jagged2Rectconverter:</p>\n\n<pre><code>   Dim tarr\n   ReDim tarr(1 To UBound(TempArr(1), 1), 1 To UBound(TempArr, 1))\n\n   For c = LBound(TempArr, 1) To UBound(TempArr, 1)\n       For r = LBound(TempArr(c), 1) To UBound(TempArr(c), 1)\n           tarr(r, c) = TempArr(c)(r, 1)\n       Next r\n   Next c\n</code></pre>\n\n<p>now tarr() gives me the same Rect array:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hxYTU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hxYTU.png\" alt=\"enter image description here\"></a></p>\n\n<p>any quicker way of doing this without looping? :)</p>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 865, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1458678003, "creation_date": 1458675511, "last_edit_date": 1458677803, "question_id": 36163627, "link": "https://stackoverflow.com/questions/36163627/jagged-array-to-2d-array", "title": "Jagged Array to 2D Array", "body": "<p>i had created a jagged array of non-contigeous columns from a range (excluding any blank or zero-filled columns). now i want to join the different columns in the jagged array and convert it to a 2-Dimensional array that we get if we pass a range to a variant. i am unable to pull the column names using INDEX or TRANSPOSE to populate XValues, Values and Series.Name of a 100%StackedBarChart, hence the need.</p>\n\n<p>here are the screenshots:</p>\n\n<h2>JAGGED ARRAY:</h2>\n\n<p><a href=\"https://i.stack.imgur.com/lZyKg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lZyKg.png\" alt=\"enter image description here\"></a></p>\n\n<h2>RANGE ARRAY:</h2>\n\n<p><a href=\"https://i.stack.imgur.com/jN95i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jN95i.png\" alt=\"enter image description here\"></a></p>\n\n<p>as you can see in the jagged array, each column cells are shown outermost and row cells 1 to 5 are shown innermost, whereas in range 2d-array, it is viceversa. the columns and rows are of same size viz., 5 rows and 2 columns.</p>\n\n<p>how do i convert back the jagged array to a normal range type rectangular 2D-array? Can anyone help me quickly?\nThanks.</p>\n"}, {"tags": ["sql", "ms-access", "vba", "duplicates"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 3, "creation_date": 1458675889, "post_id": 36163569, "comment_id": 59964627, "body": "try using a last or subquery to do this, it will be easier for you to read up on sub queries."}, {"owner": {"reputation": 45, "user_id": 5999935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153674301077261/picture?type=large", "display_name": "Jason Chan", "link": "https://stackoverflow.com/users/5999935/jason-chan"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458676277, "post_id": 36163569, "comment_id": 59964887, "body": "Sorry I am still kinda new to sql, Do you mind if you guide my through subquery? &quot;Last&quot; does not give me the result i wanted :( @Nathan_Sav"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1458676830, "post_id": 36163569, "comment_id": 59965267, "body": "That&#39;s why I said it&#39;s best for you to read them, understand them"}, {"owner": {"reputation": 45, "user_id": 5999935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153674301077261/picture?type=large", "display_name": "Jason Chan", "link": "https://stackoverflow.com/users/5999935/jason-chan"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458678154, "post_id": 36163569, "comment_id": 59966109, "body": "Yeah yeah, but where should i begin from? @Nathan_Sav"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1458681784, "post_id": 36163569, "comment_id": 59968092, "body": "<a href=\"http://allenbrowne.com/subquery-01.html\" rel=\"nofollow noreferrer\">allenbrowne.com/subquery-01.html</a> is a good place to start"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1458682142, "post_id": 36163569, "comment_id": 59968302, "body": "Also, have you tried <code>SELECT DISTINCT ...</code> or <code>LEFT JOIN tbl_Records ...</code> (instead of <code>INNER JOIN</code>)? Also check if the fields you are joining this table on are have unique values in both tables."}], "owner": {"reputation": 45, "user_id": 5999935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153674301077261/picture?type=large", "display_name": "Jason Chan", "link": "https://stackoverflow.com/users/5999935/jason-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458678139, "creation_date": 1458675278, "last_edit_date": 1458678139, "question_id": 36163569, "link": "https://stackoverflow.com/questions/36163569/max-of-date-with-distinct-id", "title": "Max of Date with distinct ID", "body": "<p>I have a query involved 7 tables (but i think the main issue is on [tbl_Records]</p>\n\n<p>Table setup:</p>\n\n<p><strong>qry_CofC</strong>: [ID], [Desc], [Maker], [Model], [S_N], [Tolerance], [Location], [Calibration Freq]</p>\n\n<p><strong>tbl_Instruments</strong>:[Remark]</p>\n\n<p><strong>tbl_Records</strong>: [Cal_Date], [Path]</p>\n\n<p><strong>tbl_Unit</strong>: [Unit]</p>\n\n<p><strong>tbl_Status</strong>: [txt_Status]</p>\n\n<p><strong>tbl_Category</strong>: [Category]</p>\n\n<p><strong>tbl_Used_By</strong>: [Name]</p>\n\n<p>below is a snapshot of the query without [tbl_Records.Path]\n[<img src=\"https://i.stack.imgur.com/PY8SC.png\" alt=\"enter image description here\"></p>\n\n<p>But When I add in [tbl_Records.Path], duplicated records appears\n<a href=\"https://i.stack.imgur.com/UwJvX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UwJvX.png\" alt=\"enter image description here\"></a>\nHere is my sql:</p>\n\n<pre><code>SELECT\n    qry_CofC.ID, [tbl_Instruments].[Type] &amp; \"-\" &amp; [tbl_Instruments].[Item] AS Tool_ID,\n    tbl_Unit.Unit, tbl_Status.txt_Status AS Status,\n    tbl_Category.Category, tbl_Used_By.Name AS Used_By,\n    Max(tbl_Records.Cal_Date) AS MaxOfCal_Date,\n    Max(DateAdd(\"d\",[qry_CofC]![Lead],(DateAdd(\"m\",[qry_CofC]![Calibration Freq],[tbl_Records]![Cal_date])))) AS Due_Date,\n    Max(DateDiff(\"d\",Date(),DateAdd(\"d\",[qry_CofC]![Lead],DateAdd(\"m\",[qry_CofC]![Calibration Freq],[tbl_Records]![Cal_date])))) AS Due,\n    tbl_Instruments.Remark,\n    tbl_Records.Path\nFROM tbl_Unit\n    INNER JOIN (tbl_Status\n        INNER JOIN (tbl_Used_By\n            INNER JOIN (tbl_Category\n                INNER JOIN (tbl_Tol\n                    INNER JOIN ((qry_CofC INNER JOIN tbl_Instruments ON qry_CofC.[ID] = tbl_Instruments.[ID])\n                    INNER JOIN tbl_Records ON tbl_Instruments.[ID] = tbl_Records.[Inst_ID])\n                    ON tbl_Tol.ID = tbl_Instruments.Accuracy)\n                ON tbl_Category.ID = tbl_Instruments.Category)\n            ON tbl_Used_By.ID = tbl_Instruments.Used_By_Operator)\n        ON tbl_Status.Index = tbl_Instruments.Status)\n    ON tbl_Unit.ID = tbl_Instruments.Unit\n\nGROUP BY qry_CofC.ID, [tbl_Instruments].[Type] &amp; \"-\" &amp; [tbl_Instruments].[Item], tbl_Unit.Unit, tbl_Status.txt_Status, tbl_Category.Category, tbl_Used_By.Name, tbl_Instruments.Remark, tbl_Records.Path\n\nORDER BY [tbl_Instruments].[Type] &amp; \"-\" &amp; [tbl_Instruments].[Item];\n</code></pre>\n\n<p>Your help is much appreciated!</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1458675689, "post_id": 36163091, "comment_id": 59964525, "body": "What error does it throw when it highlights the line?"}, {"owner": {"reputation": 177, "user_id": 5128704, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb8ab6b841991c7342deb6cee33588d3?s=128&d=identicon&r=PG&f=1", "display_name": "MilesToGoBeforeISleep", "link": "https://stackoverflow.com/users/5128704/milestogobeforeisleep"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1458676526, "post_id": 36163091, "comment_id": 59965060, "body": "Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method"}], "answers": [{"comments": [{"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 3, "creation_date": 1458677500, "post_id": 36163978, "comment_id": 59965718, "body": "It works just fine for me without the activate statement - I was just about to post a very similar answer to yours :) Maybe because I use fully qualified references? ThisWorkbook.Sheets(Array(&quot;Page1&quot;, &quot;Page2&quot;)).Select"}, {"owner": {"reputation": 177, "user_id": 5128704, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb8ab6b841991c7342deb6cee33588d3?s=128&d=identicon&r=PG&f=1", "display_name": "MilesToGoBeforeISleep", "link": "https://stackoverflow.com/users/5128704/milestogobeforeisleep"}, "edited": false, "score": 1, "creation_date": 1458680114, "post_id": 36163978, "comment_id": 59967187, "body": "Brilliant. Thanks Scott. I concur with Miqi that the Activate statement is not needed."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1458687456, "post_id": 36163978, "comment_id": 59970791, "body": "<a href=\"http://stackoverflow.com/a/36107539/4088852\">Select and Activate are not even required if you only want to print a range of sheets in the Workbook.</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1458737555, "post_id": 36163978, "comment_id": 59992549, "body": "@Comintern - bear in mind that the link you provided uses the <code>ExportAsFixedFormat</code> method on an <b>an entire workbook</b>, as opposed to only selected sheets (granted I do see the work around to only use certain sheets within the workbook.)."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1458737944, "post_id": 36163978, "comment_id": 59992827, "body": "@ScottHoltzman - That&#39;s my point - you don&#39;t have to use <code>Select</code> if you use a higher level object."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1458738317, "post_id": 36163978, "comment_id": 59993107, "body": "@Comintern - it&#39;s a valid point, but I also think its worth knowing how to do both ways - as there may be complications in a workbook structure that make it easier to the method on selected sheets only."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1458676579, "creation_date": 1458676579, "answer_id": 36163978, "question_id": 36163091, "link": "https://stackoverflow.com/questions/36163091/saving-a-file-as-pdf-using-the-file-name-and-a-specific-file-path/36163978#36163978", "title": "Saving a File as PDF using the file name and a specific file path", "body": "<p>For some reason, the <code>ExportAsFixedFormat</code> method does not work directly with an array of sheets.</p>\n\n<p>The below will work <em>(it's one of the rare cases where <code>Select</code> and <code>Activate</code> are necessary in Excel VBA)</em>.</p>\n\n<pre><code>Sheets(Array(\"Page1\", \"Page2\")).Select\nSheets(\"Page1\").Activate\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\n                                              FileName:=SaveFileName, _\n                                              Quality:=xlQualityStandard, _\n                                              IncludeDocProperties:=True, _\n                                              IgnorePrintAreas:=False, _\n                                              OpenAfterPublish:=False\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 5128704, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb8ab6b841991c7342deb6cee33588d3?s=128&d=identicon&r=PG&f=1", "display_name": "MilesToGoBeforeISleep", "link": "https://stackoverflow.com/users/5128704/milestogobeforeisleep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 36163978, "answer_count": 1, "score": 0, "last_activity_date": 1502881564, "creation_date": 1458673618, "last_edit_date": 1502881564, "question_id": 36163091, "link": "https://stackoverflow.com/questions/36163091/saving-a-file-as-pdf-using-the-file-name-and-a-specific-file-path", "title": "Saving a File as PDF using the file name and a specific file path", "body": "<p>I'm new to VBA and trying to create a macro that will automatically save my file as a PDF file using the file's base name. This topic has been covered quite a bit in various sites so I was able to get most of the code I needed but for some reason I'm getting tripped up in the very last statement. Here is what I have so far:</p>\n\n<pre><code>Sub SaveAsPDF()\n\nDim SaveDirectory As String\nDim SaveFileName As String\nDim BaseName As String\nDim fso\n\nSaveDirectory = Environ(\"Userprofile\") &amp; \"\\Dropbox\\Operations\\VBA Projects\\\"\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nBaseName = fso.GetBaseName(ActiveWorkbook.Name)\n\nSaveFileName = SaveDirectory &amp; BaseName &amp; \".pdf\"\n\nSheets(Array(\"Page1\", \"Page2\")).ExportAsFixedFormat Type:=xlTypePDF, _\n                                              FileName:=SaveFileName, _\n                                              Quality:=xlQualityStandard, _\n                                              IncludeDocProperties:=True, _\n                                              IgnorePrintAreas:=False, _\n                                              OpenAfterPublish:=False\n\nEnd Sub\n</code></pre>\n\n<p>When I debug through the whole code, that last statement gets highlighted. Not sure what I\"m doing wrong.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1458673531, "post_id": 36162853, "comment_id": 59963263, "body": "<code>Set listrange = Range(&quot;A6&quot;, Range(&quot;A6&quot;).End(xlDown))</code> What sheet should that be from? You clarified for <code>clientwks</code> and <code>clientlist2</code>, but not this one.  Make sure to put the worksheet before both uses of <code>Range()</code>  Also, what line throws your error?"}, {"owner": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1458673683, "post_id": 36162853, "comment_id": 59963351, "body": "listrange opens on sheet1 of a temporary workbook that is generated from another program. The error is thrown in the For loop at this line: a.Offset(0, 6).value = clientlist2.Cells.Find(a).Row I&#39;ll try it now, thanks for the speedy reply!"}, {"owner": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1458673919, "post_id": 36162853, "comment_id": 59963494, "body": "Thanks Bruce, but I&#39;m still getting the error at the same line."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1458674598, "post_id": 36162853, "comment_id": 59963894, "body": "Oh, I think it&#39;s because you&#39;re trying to set a cell value to a row&#39;s value. <code>clientlist2.cells.find(a).Row</code> should be  ...what? Do you want to return the <code>.Row</code>? What are you trying to set the <code>.Value</code> to?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1458690020, "post_id": 36162853, "comment_id": 59971727, "body": "@BruceWayne  I&#39;m pretty sure <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196952.aspx\" rel=\"nofollow noreferrer\">range.row</a> returns a integer-value?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "edited": false, "score": 0, "creation_date": 1458674958, "post_id": 36163259, "comment_id": 59964119, "body": "Thanks eirik, that helped in stopping the error but it only worked on one name that&#39;s an exact match. The other names have characters not found in the clientlist2 strings. I tried using &quot;<i>&quot; &amp; a &amp; &quot;</i>&quot; to work around it but it&#39;s not working."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "edited": false, "score": 0, "creation_date": 1458676378, "post_id": 36163259, "comment_id": 59964958, "body": "Does it help providing more arguments to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\"><code>Find</code></a>? E.g. setting <code>Lookat:=xlPart</code>? It&#39;s a bit hard knowing what is causing the find to fail, without knowing more about what strings you put into the function. Maybe you could add a couple of examples to your question? @user6100466"}, {"owner": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "edited": false, "score": 0, "creation_date": 1458676613, "post_id": 36163259, "comment_id": 59965126, "body": "I managed to add formatting rules that make it easier for the find to work. Here&#39;s an example of one that does not work: &quot;Something Finance LTD&quot; and in the other workbook it&#39;s just listed as &quot;Something&quot;. There are many names like this that aren&#39;t pulling any data."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "edited": false, "score": 0, "creation_date": 1458676773, "post_id": 36163259, "comment_id": 59965235, "body": "@user6100466 You are searching for the string something ltd and want to find something, or vice versa?"}, {"owner": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "edited": false, "score": 0, "creation_date": 1458677488, "post_id": 36163259, "comment_id": 59965708, "body": "I have &quot;Something Finance LTD&quot; on one sheet, and I&#39;m trying to match it with the name &quot;Something&quot; in the other workbook and return the row number."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "edited": false, "score": 0, "creation_date": 1458689965, "post_id": 36163259, "comment_id": 59971710, "body": "Yes, but which are you using for which input to the find-function? @user6100466"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1458676162, "last_edit_date": 1458676162, "creation_date": 1458674243, "answer_id": 36163259, "question_id": 36162853, "link": "https://stackoverflow.com/questions/36162853/return-row-number-from-cells-find-method-on-another-workbook/36163259#36163259", "title": "Return row number from Cells.Find method on another workbook", "body": "<p>I'd advise you to do the operation inside the for-statement in two steps to avoid errors, and to make it easier to troubleshoot.</p>\n\n<p>If I was going to find a cell, and then copy something (or some property) from it, I'd first attempt to set it to a variable, and then check what result I got from that before attempting to  do anything more with it.</p>\n\n<p>In your case;</p>\n\n<pre><code>Dim foundValue As Range\nFor Each a In listrange\n  Set foundValue = clientlist2.Cells.Find(a)\n  If Not foundValue Is Nothing Then\n    a.Offset(0, 6).Value = foundValue.Row\n  End If\nNext a\n</code></pre>\n\n<p>This also makes it easier to troubleshoot, as you can examine what values your different variables have at each step of the way, by using e.g. <code>Debug.Print</code> or message boxes.</p>\n\n<p>Another good idea is adding <code>Option Explicit</code> at the top of your module. This makes it necessary for you to define (dim) all your variables, preventing accidental misspellings in the middle of your code.</p>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "is_accepted": false, "score": -2, "last_activity_date": 1458680277, "creation_date": 1458680277, "answer_id": 36165069, "question_id": 36162853, "link": "https://stackoverflow.com/questions/36162853/return-row-number-from-cells-find-method-on-another-workbook/36165069#36165069", "title": "Return row number from Cells.Find method on another workbook", "body": "<p>I you think the problem occur when the workbook is deactive, so activate it before find method.</p>\n\n<p>Workbooks(\"BOOK4.XLS\").Activate</p>\n"}], "owner": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 818, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1458680277, "creation_date": 1458672804, "last_edit_date": 1458675747, "question_id": 36162853, "link": "https://stackoverflow.com/questions/36162853/return-row-number-from-cells-find-method-on-another-workbook", "title": "Return row number from Cells.Find method on another workbook", "body": "<p>I keep getting run-time error 91: Object variable or with block variable not set.</p>\n\n<p>I need to return the row number of a string I'm searching for in another workbook and place it 6 columns away from the name I'm looking up. The names have slight variations in the strings which is why I preferred using <code>Cells.Find</code> as opposed to vlookup.</p>\n\n<p>I tried setting the range I'm searching in as a public range to no avail. Both workbooks are open but it seems as if the <code>Cells.Find</code> method only works when the workbook with the range I'm searching in is active. </p>\n\n<p>FYI, <code>listrange</code> is the range of names on the active workbook. <code>clientlist</code> is a named range in the other workbook I'm searching in (open but not active), <code>clientlist2</code> is the declared version of that named range.</p>\n\n<p>Here's the code snippet:</p>\n\n<pre><code>Public clientlist2 As Range\n\nSub sortout()\n\n    Dim wkb As Workbook\n    Dim clientwks As Worksheet\n    Dim listrange As Range\n\n    Set wkb = Workbooks(\"workbook.xlsm\")\n    Set clientwks = wkb.Sheets(\"Sheet1\")\n    Set clientlist2 = clientwks.Range(\"clientlist\")\n    Set listrange = Range(\"A6\", Range(\"A6\").End(xlDown))\n\n    For Each a In listrange\n\n        a.Offset(0, 6).value = clientlist2.Cells.Find(a).Row\n\n    Next a\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1458674876, "post_id": 36162589, "comment_id": 59964067, "body": "HOW is it not working properly?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1458675251, "post_id": 36162589, "comment_id": 59964288, "body": "Loop over ActiveDocument.ContentControls and delete each item."}, {"owner": {"reputation": 81, "user_id": 6056595, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd9c73ca095b34e2d84e8c9b0d829c99?s=128&d=identicon&r=PG&f=1", "display_name": "Thilina", "link": "https://stackoverflow.com/users/6056595/thilina"}, "edited": false, "score": 0, "creation_date": 1458741389, "post_id": 36162589, "comment_id": 59995333, "body": "@ Cindy Meister: It&#39;s not work properly means I didn&#39;t see any change in the document after running that macro code. I&#39;ve try to remove the content controllers from this document. <a href=\"https://drive.google.com/open?id=0B1yWnlyZ8msEM2JHeFdxa1VLX2M\" rel=\"nofollow noreferrer\">Download</a>"}, {"owner": {"reputation": 81, "user_id": 6056595, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd9c73ca095b34e2d84e8c9b0d829c99?s=128&d=identicon&r=PG&f=1", "display_name": "Thilina", "link": "https://stackoverflow.com/users/6056595/thilina"}, "edited": false, "score": 0, "creation_date": 1458741823, "post_id": 36162589, "comment_id": 59995698, "body": "@ Florent B: Thanks, Can you provide an answer with example code to me."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 6056595, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd9c73ca095b34e2d84e8c9b0d829c99?s=128&d=identicon&r=PG&f=1", "display_name": "Thilina", "link": "https://stackoverflow.com/users/6056595/thilina"}, "is_accepted": true, "score": 1, "last_activity_date": 1459087354, "creation_date": 1459087354, "answer_id": 36248200, "question_id": 36162589, "link": "https://stackoverflow.com/questions/36162589/is-there-any-method-or-macro-to-remove-all-content-controls-in-ms-word/36248200#36248200", "title": "Is there any method or macro to remove all content controls in MS Word?", "body": "<p>I've found the answer by my own way :)</p>\n\n<pre><code>Public Sub Test()\n\n  Dim oRng As Range\n  Dim CC   As ContentControl\n  Dim LC   As Integer\n  Dim LRCC As Integer\n  Dim LTCC As Integer\n  Dim LE   As Boolean\n\n'Remove all content controls\nSet oRng = ActiveDocument.Content\nLTCC = LTCC + oRng.ContentControls.Count\nFor LC = oRng.ContentControls.Count To 1 Step -1\n\nSet CC = oRng.ContentControls(LC)\nIf CC.LockContentControl = True Then\n    CC.LockContentControl = False\nEnd If\nCC.Delete\nIf Not LE Then\n    LRCC = LRCC + 1\n    End If\n    LE = False\nNext\nEnd Sub\n</code></pre>\n\n<p>This will helpful to someone.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8914750, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/babeabec8e9e3d73ede9076ad6fa2a8b?s=128&d=identicon&r=PG", "display_name": "user8914750", "link": "https://stackoverflow.com/users/8914750/user8914750"}, "is_accepted": false, "score": 1, "last_activity_date": 1510243224, "creation_date": 1510243224, "answer_id": 47206336, "question_id": 36162589, "link": "https://stackoverflow.com/questions/36162589/is-there-any-method-or-macro-to-remove-all-content-controls-in-ms-word/47206336#47206336", "title": "Is there any method or macro to remove all content controls in MS Word?", "body": "<p>Thanks for this answer--it was just what I was looking for. I ended up using the following:</p>\n\n<pre><code>Sub ContentControlRemoval()\n'\n'Remove all content controls\nSet oRng = ActiveDocument.Content\nLTCC = LTCC + oRng.ContentControls.Count\nFor LC = oRng.ContentControls.Count To 1 Step -1\n\nSet CC = oRng.ContentControls(LC)\nIf CC.LockContentControl = True Then\n    CC.LockContentControl = False\nEnd If\nCC.Delete\nIf Not LE Then\n    LRCC = LRCC + 1\n    End If\n    LE = False\nNext\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 5, "creation_date": 1553806768, "post_id": 55400544, "comment_id": 97534075, "body": "Saving a document in the older .doc format will also remove any content controls, leaving behind only the displayed content."}, {"owner": {"reputation": 413, "user_id": 5153063, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6b69d8569532cfcc74468c599c20d20e?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/5153063/robert"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1593500431, "post_id": 55400544, "comment_id": 110795184, "body": "Thank you @macropod.  I was going crazy trying to figure out why Word wasn&#39;t behaving."}], "tags": [], "owner": {"reputation": 171, "user_id": 2709002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c375c69c078ca8925f7086f4425f0f?s=128&d=identicon&r=PG", "display_name": "Theodore", "link": "https://stackoverflow.com/users/2709002/theodore"}, "is_accepted": false, "score": 7, "last_activity_date": 1553784552, "creation_date": 1553784552, "answer_id": 55400544, "question_id": 36162589, "link": "https://stackoverflow.com/questions/36162589/is-there-any-method-or-macro-to-remove-all-content-controls-in-ms-word/55400544#55400544", "title": "Is there any method or macro to remove all content controls in MS Word?", "body": "<p>I was able to remove all content controls (in Word 2013) without any macros as follows:</p>\n\n<ol>\n<li>On the developer menu, select Design Mode.</li>\n<li>If no content controls are visible, scroll through until one is.</li>\n<li>Press Ctrl+A to select the entire document.</li>\n<li>Right-click a visible content control.</li>\n<li>In the context menu, click Remove Content Control.</li>\n</ol>\n\n<p>I don't know if it works for all types of Content Controls.</p>\n"}], "owner": {"reputation": 81, "user_id": 6056595, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd9c73ca095b34e2d84e8c9b0d829c99?s=128&d=identicon&r=PG&f=1", "display_name": "Thilina", "link": "https://stackoverflow.com/users/6056595/thilina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20431, "favorite_count": 1, "accepted_answer_id": 36248200, "answer_count": 3, "score": 1, "last_activity_date": 1553784552, "creation_date": 1458671985, "last_edit_date": 1495541693, "question_id": 36162589, "link": "https://stackoverflow.com/questions/36162589/is-there-any-method-or-macro-to-remove-all-content-controls-in-ms-word", "title": "Is there any method or macro to remove all content controls in MS Word?", "body": "<p>I need to remove all content controllers (Loked and unlocked) in active document without removing any text. I've search and found a macro for this. But I think it's not work properly.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/27989926/word-vba-to-delete-content-controls-with-specific-tags\">Word VBA to delete Content Controls with specific Tags</a></p>\n\n<p>Is it possible to do this?</p>\n\n<p>Edited:\nI've tried below code. It'll remove content controllers with text content. I need to remove only content controllers.</p>\n\n<pre><code>Sub Test()\nDim objCC As ContentControl\nDo While ActiveDocument.ContentControls.Count &gt; 0\nFor Each objCC In ActiveDocument.ContentControls\nobjCC.Delete True\nNext\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458671243, "post_id": 36162296, "comment_id": 59961822, "body": "Look at using the filesystemobject, and the datelastmodifed, and you can use like in the search, so if fl.name like &quot; * Spanish * &quot; then compare the date...."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458671299, "post_id": 36162296, "comment_id": 59961875, "body": "<a href=\"http://stackoverflow.com/questions/9205137/using-vbscript-to-find-most-recent-file-date-in-a-single-folder\" title=\"using vbscript to find most recent file date in a single folder\">stackoverflow.com/questions/9205137/&hellip;</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458671356, "post_id": 36162296, "comment_id": 59961906, "body": "<a href=\"http://www.4guysfromrolla.com/webtech/faq/FileSystemObject/faq5.shtml\" rel=\"nofollow noreferrer\">4guysfromrolla.com/webtech/faq/FileSystemObject/faq5.shtml</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458671370, "post_id": 36162296, "comment_id": 59961916, "body": "those are good places to start.... hope they help."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458671644, "post_id": 36162296, "comment_id": 59962089, "body": "@Nathan_Sav - those are great places to start, but bear in mind they may fail if someone modifies an older version of a file for whatever reason."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458671759, "post_id": 36162296, "comment_id": 59962160, "body": "wouklnt that be the latest version then? or are you thinking the (x).csv is acting as ver number?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458672253, "post_id": 36162296, "comment_id": 59962469, "body": "@Nathan_Sav - that is exactly what I am thinking."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458673686, "post_id": 36162296, "comment_id": 59963352, "body": "What happens if the spanish(6).csv is renamed to spanish(1).csv ? :)"}, {"owner": {"reputation": 73, "user_id": 1803626, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/05d7aedb0f816d0cf03a802fce3c9040?s=128&d=identicon&r=PG", "display_name": "Kimber Warden", "link": "https://stackoverflow.com/users/1803626/kimber-warden"}, "edited": false, "score": 0, "creation_date": 1458681081, "post_id": 36162296, "comment_id": 59967708, "body": "The files are downloaded statistics from a website, so they are never edited and resaved, and they always have the same name every time they are downloaded. Since Windows appends a &quot;(1)&quot; to a filename when it&#39;s dragged into a folder where an identically named file already exists, I need to make sure that my Excel file always imports the most recent download. Checking for either datelastmodified or a number on the end of the filename would likely work."}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1458673266, "post_id": 36162756, "comment_id": 59963101, "body": "Ok :) I&#39;ve recently started using something like this to extract the number from within brackets in a string Split(Split(strInput, &quot;(&quot;)(1), &quot;)&quot;)(0) little less to track than mid&#39;s."}, {"owner": {"reputation": 73, "user_id": 1803626, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/05d7aedb0f816d0cf03a802fce3c9040?s=128&d=identicon&r=PG", "display_name": "Kimber Warden", "link": "https://stackoverflow.com/users/1803626/kimber-warden"}, "edited": false, "score": 0, "creation_date": 1458678360, "post_id": 36162756, "comment_id": 59966243, "body": "Thanks, @Scott Holtzman. I did as you suggested and am getting the following error at Spanish = Dir.  &quot;Invalid procedure call or argument&quot;"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 73, "user_id": 1803626, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/05d7aedb0f816d0cf03a802fce3c9040?s=128&d=identicon&r=PG", "display_name": "Kimber Warden", "link": "https://stackoverflow.com/users/1803626/kimber-warden"}, "edited": false, "score": 0, "creation_date": 1458738529, "post_id": 36162756, "comment_id": 59993274, "body": "@KimberWarden - that is strange. Code worked for me when I tested. Also, it&#39;s a pretty standard line (see <a href=\"http://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">here</a>)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1458738689, "last_edit_date": 1458738689, "creation_date": 1458672491, "answer_id": 36162756, "question_id": 36162296, "link": "https://stackoverflow.com/questions/36162296/select-most-recent-of-multiple-files-then-import-to-one-excel-sheet/36162756#36162756", "title": "Select most recent of multiple files, then import to one Excel sheet", "body": "<p>Place the below loop inside the area where you wrote: </p>\n\n<pre><code>I WANT TO SOMEHOW GET THE MOST RECENT VERSION OF EACH AND PASS IT TO THE LANGUAGEFILES \n</code></pre>\n\n<p>I just wrote the loop for the Spanish files, but you can easily add another loop to capture the French, English, etc. file and adjust the variable names to load into the <code>LanguageFiles</code> array.</p>\n\n<pre><code>Do While Spanish &lt;&gt; \"\"\n\n        If InStr(1, Spanish, \"(\") Then 'test to see if there is a number\n\n            Dim bVersion As Boolean\n            bVersion = True 'set this variable to true for later\n\n            'extract which version it is - will work for any digit version number\n            Dim iVersionTest As Integer, iVersion As Integer\n            iVersionTest = CInt(Mid(Spanish, InStr(1, Spanish, \"(\") + 1, InStr(1, Spanish, \")\") - InStr(1, Spanish, \"(\") - 1)) \n            'for another method see\n            'iVersionTest = CInt(Split(Split(Spanish,\"(\")(1),\")\")(0)\n\n            'is current version greater than what is already stored? if so, make it latest version\n            Dim sLatestVersion \n            If iVersionTest &gt; iVersion Then\n                sLatestVersion = Spanish\n                iVersion = iVersionTest\n            End If\n\n        Else\n\n            'if there's no other version make the lone file the latest version\n            If Not bVersion Then sLatestVersion = Spanish\n\n        End If\n\n        Spanish = Dir\n\nLoop\n\nLanguageFiles(0) = sLatestVersion\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 1803626, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/05d7aedb0f816d0cf03a802fce3c9040?s=128&d=identicon&r=PG", "display_name": "Kimber Warden", "link": "https://stackoverflow.com/users/1803626/kimber-warden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458738689, "creation_date": 1458671017, "question_id": 36162296, "link": "https://stackoverflow.com/questions/36162296/select-most-recent-of-multiple-files-then-import-to-one-excel-sheet", "title": "Select most recent of multiple files, then import to one Excel sheet", "body": "<p>I'm having trouble finding a way to select the most recent version of several files in the same folder and importing them into Excel. For example:</p>\n\n<p>Files in the folder:\nSpanish.csv\nSpanish(1).csv\nSpanish(2).csv\nEnglish.csv\nEnglish(1).csv\nFrench.csv\n(There are many more languages and files here, but I'm including only these for simplicity)</p>\n\n<p>From that folder, I want to select these files:\nSpanish(2).csv\nEnglish(1).csv\nFrench.csv</p>\n\n<p>and import them into one existing worksheet.</p>\n\n<p>So far I have:</p>\n\n<pre><code>Sub GetFiles()\n\n    Dim MyPath As String\n    Dim Spanish As String\n    Dim English As String\n    Dim French As String\n    Dim LanguageFiles(2) As String\n\n    MyPath = \"C:\\example\\\"\n\n    'Make sure that the path ends in a backslash\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n\n    Spanish = Dir(MyPath &amp; \"Spanish*.csv\")\n    English = Dir(MyPath &amp; \"English*.csv\")\n    French = Dir(MyPath &amp; \"French*.csv\")\n\n    I WANT TO SOMEHOW GET THE MOST RECENT VERSION OF EACH AND PASS IT TO THE LANGUAGEFILES ARRAY AND IMPORT IT TO A SINGLE WORKSHEET.\n\n    LanguageFiles(0) = Spanish\n    LanguageFiles(1) = English\n    LanguageFiles(2) = French\n\nFor i = LBound(LanguageFiles) To UBound(LanguageFiles)\n         With ActiveSheet.QueryTables.Add(Connection:= _\n            \"TEXT;\" &amp; LanguageFiles(i), Destination:=Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0))\n            .Name = \"Sample\"\n            .FieldNames = False\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .TextFilePromptOnRefresh = False\n            .TextFilePlatform = 437\n            .TextFileStartRow = 1\n            .TextFileParseType = xlDelimited\n            .TextFileTextQualifier = xlTextQualifierDoubleQuote\n            .TextFileConsecutiveDelimiter = False\n            .TextFileTabDelimiter = False\n            .TextFileSemicolonDelimiter = False\n            .TextFileCommaDelimiter = True\n            .TextFileSpaceDelimiter = False\n            .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n            .TextFileTrailingMinusNumbers = True\n            .Refresh BackgroundQuery:=False\n        End With\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This code doesn't actually work because I'm cobbling several pieces together, and I don't know if I'm even on the right track. Can someone help me out please?</p>\n"}, {"tags": ["vba", "excel", "userform", "billing"], "answers": [{"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1458672332, "post_id": 36162685, "comment_id": 59962519, "body": "note some of my cell directions in the above sample code is incorrect. adjust accordingly"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1458672277, "creation_date": 1458672277, "answer_id": 36162685, "question_id": 36162209, "link": "https://stackoverflow.com/questions/36162209/excel-vba-billing-userform-input-data-questions/36162685#36162685", "title": "Excel VBA Billing Userform input data questions", "body": "<p>1) You do not need a loop for this\n2) You do not have any logic that checks if the userform checkboxes are set to true or false and then what to do if they are true/false.\n3) Offset Property will be need to put information in lowe table in next available row. Offset can be sued to adjust left or right based obn your criteria, which will most likely be IF's\n4) if first billing cycle you can direct the input to the first location in the lower area. \n5) seeing in how your just dumping these into a spreadsheet, having to declare variables from textboxes in userforms is wont be needed. I do mention it however, because if you ever need to manipulate that information in VBA, it may need to be done so. And it looks like that simple math needs ot be done, so if you run into issues that may be the problem. </p>\n\n<p>This should get you started in the right place</p>\n\n<pre><code>Private Sub commandbutton_click()\n\n    If CheckBox1.Value = True Then Sheet1.Range(\"E4\").Value = \"Wherever you hid the predetermined value\"\n    If Sheet1.Range(\"d47\").Value = vbNullString Then\n        Sheet1.Range(\"d47\").Value = BillingDateTextBox.Value\n    Else\n        Sheet1.Cells(Sheet1.Rows.Count, 1).End(xlUp).Offset(1, 0).Value = BillingDateTextBox.Value\n        Sheet1.Cells(Sheet1.Rows.Count, 1).End(xlUp).Offset(0, 1).Value = \"Wherever you hid the predetermined value\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6100151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O0XpP6oQGzs/AAAAAAAAAAI/AAAAAAAAAD0/FkR7_fjEm4E/photo.jpg?sz=128", "display_name": "Ian Custodio", "link": "https://stackoverflow.com/users/6100151/ian-custodio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458672277, "creation_date": 1458670685, "question_id": 36162209, "link": "https://stackoverflow.com/questions/36162209/excel-vba-billing-userform-input-data-questions", "title": "Excel VBA Billing Userform input data questions", "body": "<p>So I'm trying to code for an Excel VBA billing archive/tracker form for my work, and I am very new to excel vba. Any help would be much appreciated. Essentially, I want my userform to input billing date on the bottom table, then take the sum of the parts selected (A1-A19) and input the sum to the nearest, empty cell to the left of the input billing date. If it's the first billing cycle, then I just want to call the dollar amount in the Grand Total Engagement and put that value to the right of the input billing date. Attached are my snippits of the Excel sheet, and userform. Thanks so much community!</p>\n\n<p><a href=\"http://i.stack.imgur.com/dX9hI.jpg\" rel=\"nofollow\">Excel Sheet</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/55ils.jpg\" rel=\"nofollow\">BillingArchiveUserform</a></p>\n\n<pre><code>'Creates \"LastRow\" variable\nIf Range(\"D47\").Value = \"\" Then\nLastRow = 47\nElse\nMain.Range(\"D46\").Select\nLastRow = Selection.End(xlDown).Row\nEnd If\n\ni = 47\nDo While i &lt;= LastRow\nIf BillingDate.Value = Range(\"D\" &amp; i).Value Then\nIf CmBBill.Value = \"Yes\" Then\n'Range(\"D\" &amp; i).Offset( 'resume from here and figure it out, but I want to choose the nearest empty cell to the right of date\n'Input project specific information (i.e. the sum of the parts that need to be billed)\nElse\ni = i + 1\nEnd If\nLoop\n\nCells(LastRow + 1, 4).Value = BillingDate.Value 'Inputs Billing Date\n\n'2. Choose column of ProjectToBill based on value in textbox\nMain.Range(\"E5\").Select\nLastCol = Selection.End(xlToRight).Column\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5899235, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/30c81ae8884910ee24a0c245568f5e1b?s=128&d=identicon&r=PG&f=1", "display_name": "BMRobin", "link": "https://stackoverflow.com/users/5899235/bmrobin"}, "edited": false, "score": 0, "creation_date": 1458827559, "post_id": 36168760, "comment_id": 60036999, "body": "To answer your question above, I&#39;m hoping to select and copy all active cells in the initial worksheet. Also, I&#39;ve combined the three groups of code into one but keep getting an error message on line: Set sheetCells = Sheet.Cells. Can&#39;t figure out why :S Thank you @Sfadal !"}, {"owner": {"reputation": 1, "user_id": 6010921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d36382213966d5df23cf25479ef881?s=128&d=identicon&r=PG&f=1", "display_name": "Sfadal", "link": "https://stackoverflow.com/users/6010921/sfadal"}, "reply_to_user": {"reputation": 75, "user_id": 5899235, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/30c81ae8884910ee24a0c245568f5e1b?s=128&d=identicon&r=PG&f=1", "display_name": "BMRobin", "link": "https://stackoverflow.com/users/5899235/bmrobin"}, "edited": false, "score": 0, "creation_date": 1459283768, "post_id": 36168760, "comment_id": 60214356, "body": "@BMRobin, Sorry it has taken a while to reply. What is the error description? It is possible the loop did not find the worksheet by the name provided, so the object does not exist. Check the name of the sheet and run in debug with a breakpoint after the loop to check the &quot;Sheet&quot; object in you watch tab."}, {"owner": {"reputation": 75, "user_id": 5899235, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/30c81ae8884910ee24a0c245568f5e1b?s=128&d=identicon&r=PG&f=1", "display_name": "BMRobin", "link": "https://stackoverflow.com/users/5899235/bmrobin"}, "edited": false, "score": 0, "creation_date": 1459870176, "post_id": 36168760, "comment_id": 60475698, "body": "Thank you @Sfadal I get the following error: Run-time error &#39;91&#39;: Object variable or With block variable not set. The name of the worksheet I wants the data to be pasted to is called &#39;Sheet1&#39; so I didn&#39;t have to change anything in the code. Thank you for your help!"}], "tags": [], "owner": {"reputation": 1, "user_id": 6010921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d36382213966d5df23cf25479ef881?s=128&d=identicon&r=PG&f=1", "display_name": "Sfadal", "link": "https://stackoverflow.com/users/6010921/sfadal"}, "is_accepted": false, "score": 0, "last_activity_date": 1458700159, "creation_date": 1458700159, "answer_id": 36168760, "question_id": 36162168, "link": "https://stackoverflow.com/questions/36162168/copy-and-pasting-data-from-one-workbook-into-another/36168760#36168760", "title": "copy and pasting data from one workbook into another", "body": "<p>Here are two snippets of code I have used in recent times which should help you in your predicament. </p>\n\n<p>This first code allows you to find a specific worksheet by name (or index as stated by <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821537.aspx\" rel=\"nofollow\">Office Documentation</a>). This does not need you to specify the workbook as it loops through all currently open worksheets. </p>\n\n<pre><code>Dim Sheet As Worksheet\nDim sheetName As String\n\nsheetName = \"Sheet1\"\n\nFor Each Sheet In Worksheets\n    If Sheet.Name = sheetName Then\n        Set GetSheet = Worksheets(sheetName)\n        Exit For\n    End If\nNext Sheet\n</code></pre>\n\n<p>The next Code snippet (I can not take credit for, but have lost info of origin) which will search a specified worksheet for any and all data contained with-in and create a range object with the cell range found.</p>\n\n<p>(This may not be what you want as I am unsure from your question as to if you want all the data or just a selection).</p>\n\n<pre><code>    Dim dataRange as Range\n    Dim lastCol As Long\n    Dim lastRow As Long\n    Dim sheetCells As range\n\n    Set sheetCells = Sheet.Cells\n\n\n    If WorksheetFunction.CountA(sheetCells) &gt; 0 Then\n        'Search for any entry, by searching backwards by Rows.\n        lastRow = sheetCells.Find(What:=\"*\", after:=[A1], _\n                   SearchOrder:=xlByRows, _\n                   SearchDirection:=xlPrevious).Row\n               '    Search for any entry, by searching backwards by Columns.\n        lastCol = sheetCells.Find(What:=\"*\", after:=[A1], _\n                   SearchOrder:=xlByColumns, _\n                   SearchDirection:=xlPrevious).Column\n\n            ' Set the range from 1st cell of sheet to last cell found to contain data\n            Set dataRange = Sheet.range(Sheet.Cells(1, 1), Sheet.Cells(lastRow, lastCol))\n\n\n    End If\n</code></pre>\n\n<p>Once you have a range object, there is a lot you can do with it but to simply insert values into another worksheet:</p>\n\n<pre><code>Dim newSheet as WorkSheet\n\nset newSheet = ThisWorkbook.Worksheets(\"New Sheet\") ' Just an example\n\n'Using fields from last code snippet\nnewSheet.Range(newSheet.Cells(1,1), newSheet.Cells(lastRow,lastCol)).value = dataRange.Value\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5899235, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/30c81ae8884910ee24a0c245568f5e1b?s=128&d=identicon&r=PG&f=1", "display_name": "BMRobin", "link": "https://stackoverflow.com/users/5899235/bmrobin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 823, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458700159, "creation_date": 1458670576, "last_edit_date": 1458672606, "question_id": 36162168, "link": "https://stackoverflow.com/questions/36162168/copy-and-pasting-data-from-one-workbook-into-another", "title": "copy and pasting data from one workbook into another", "body": "<p>I am trying to copy a select range of cells from one workbook into another. This is my select range and copy code so far used in the first workbook:</p>\n\n<pre><code>Sub Copy()\n\n'This selects the range of active cells, adds a border and copies all data.\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\nEnd Sub\n</code></pre>\n\n<p>While this selects and copies the cells in the 1st workbook, I am having difficulties incorporating it with a macro that pastes it into another workbook. Here is a sample of a macro that pastes data from one workbook into another:</p>\n\n<pre><code>Sub Paste()\nDim x As Workbook\nDim y As Workbook\n\n'## Open both workbooks first:\nSet x = Workbooks.Open(\" path to copying book \")\nSet y = Workbooks.Open(\" path to destination book \")\n\n'Now, transfer values from x to y:\ny.Sheets(\"sheetname\").Range(\"A1\").Value = x.Sheets(\"name of copying sheet\").Range(\"A1\") \n\n'Close x:\nx.Close\n\nEnd Sub\n</code></pre>\n\n<p>Two things:</p>\n\n<ol>\n<li>The 1st workbook with the initial data is not a saved document on my computer. It's an exported sheet from the internet I am trying to paste into a saved workbook on my computer. Therefore, I don't think a file path or worksheet name for the first workbook is possible to get.</li>\n<li>I am hoping to paste the data in the first available blank cell in column A of the second workbook. I believe the code for that is something like: <code>CurrentRow = Range(\"A1\").End(xlDown).Offset(1, 0).Row</code> and then obviously paste into that row starting in the A column.</li>\n</ol>\n\n<p>Can someone help me incorporate these two codes into one?</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 1, "creation_date": 1458671132, "post_id": 36162142, "comment_id": 59961769, "body": "You can&#39;t add a range to a listbox like that. If you want the value of A#, then you need to specify that you want the value of the range."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 1, "creation_date": 1458671467, "post_id": 36162142, "comment_id": 59961978, "body": "I addition to what @asp8811 mentioned you might want to <code>Dim</code> all variables, use <code>.Value2</code> whenever possible, change the dates for <code>DateDiff</code> as I would assume that <code>Now</code> is greater than any value in the <code>J</code> column and <b>stop</b> distributing Excel workbooks with password protected macros. Nobody would ever allow to run foreign code on their computer without the option to review the code first. Finally, you might want to remove passwords from your VBA code. There seems to be an admin password = <code>test</code>."}, {"owner": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458672243, "post_id": 36162142, "comment_id": 59962463, "body": "I take all comments on board - Unfortunately this is all new to me so not sure what I am doing so apologies for sending them password protected, didnt even realise what I done.  Regarding your solutions, unfortunately ive no idea how to do what you have recommended."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 1, "creation_date": 1458675850, "post_id": 36162142, "comment_id": 59964607, "body": "Welcome to SO!  Please make sure to come back after the help you&#39;ve gotten works out for you and mark the answer, we like points a lot.  :)"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458673448, "post_id": 36162902, "comment_id": 59963215, "body": "Thank you for your time, it really is appreciated - I ran this code, no errors popped up but nothing is listed in the listbox"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458673509, "post_id": 36162902, "comment_id": 59963249, "body": "What is the name of the sheet from which it should take the accounts / dates?"}, {"owner": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458673731, "post_id": 36162902, "comment_id": 59963374, "body": "Sheet is called Sheet1 - I just tried this but didnt work: Sheets(&quot;Sheet1&quot;).Range(&quot;J&quot; &amp; I)"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458673982, "post_id": 36162902, "comment_id": 59963536, "body": "I just changed the code to reflect your sheet name. Furthermore, I adjusted the code to automatically detect the last row based on how many accounts are in column <code>A</code>."}, {"owner": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458674733, "post_id": 36162902, "comment_id": 59963976, "body": "I must be doing something wrong, still not working. Would you mind checking my code, I have removed the password off the application: <a href=\"https://www.dropbox.com/s/u8ex7nstlbju6sm/tracker%20new.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/u8ex7nstlbju6sm/tracker%20new.xlsm?dl=0</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458675427, "post_id": 36162902, "comment_id": 59964381, "body": "I had a look at your file. Apparently there are not only dates in column <code>J</code> (starting with row 1). So, I added another <code>If</code> statement for you. Like this the code runs only when a value in column <code>J</code> can be recognized as a date. Then it works."}, {"owner": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458676016, "post_id": 36162902, "comment_id": 59964716, "body": "That didnt work for me either...hmmm - sorry to be a pain"}, {"owner": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458676501, "post_id": 36162902, "comment_id": 59965044, "body": "Well, that has blown my mind  I downloaded it and still didnt work. I will try this on a different system tomorrow and then accept your answer once I am home. Thank you for spending so much time helping me, greatly appreciated"}, {"owner": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458677159, "post_id": 36162902, "comment_id": 59965485, "body": "Thanks Ralph - listbox1 is located on the tab 3 weeks, thats the one that think remains blank for some reason. The rest working fine :)"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 0, "creation_date": 1458677896, "post_id": 36162902, "comment_id": 59965968, "body": "I made three final adjustments: (1) <code>If IsDate(.Range(&quot;J&quot; &amp; I).Value) Then</code> instead of <code>If IsDate(.Range(&quot;J&quot; &amp; I).Value2) Then</code> (2) Explicit reference to the <code>Reporting</code> form. (3) Remove <code>DateDiff(&quot;d&quot;)</code> because for Excel its the same as subtracting two numbers from one another."}, {"owner": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "edited": false, "score": 1, "creation_date": 1458679369, "post_id": 36162902, "comment_id": 59966813, "body": "Ralph - That works 100%. Perfect. I can see how it works now, as its more or less new to me it was a big struggle. Thank you so much, I wish you all the best. Big thumbs up"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1458678116, "last_edit_date": 1458678116, "creation_date": 1458672949, "answer_id": 36162902, "question_id": 36162142, "link": "https://stackoverflow.com/questions/36162142/conditionally-add-to-a-listbox/36162902#36162902", "title": "conditionally add to a listbox", "body": "<p>Maybe this will work for you:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim I As Long\nDim maxRow As Long\n\nListBox1.Clear\n\nWith Worksheets(\"Sheet1\")\n    maxRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    For I = 1 To maxRow\n        If IsDate(.Range(\"J\" &amp; I).Value) Then\n            If Now() - .Range(\"J\" &amp; I).Value2 &gt; 14 Then\n                Reporting.ListBox1.AddItem .Range(\"A\" &amp; I).Value2\n            End If\n        End If\n    Next I\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bvcn7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bvcn7.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 19, "user_id": 6079492, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/098484222b9cbc2de0e1e7193bfe0a42?s=128&d=identicon&r=PG&f=1", "display_name": "Variety Mix", "link": "https://stackoverflow.com/users/6079492/variety-mix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 36162902, "answer_count": 1, "score": 1, "last_activity_date": 1458678116, "creation_date": 1458670466, "question_id": 36162142, "link": "https://stackoverflow.com/questions/36162142/conditionally-add-to-a-listbox", "title": "conditionally add to a listbox", "body": "<p>I have literally struggled for about 8 hours today trying to get this to work and cant seem to work out where I am going wrong.</p>\n\n<p>I have listbox1 and would like it to be populated with account numbers that are over 14 days old.</p>\n\n<p>Column A hold the account numbers\nColumn J holds the date</p>\n\n<p>Here is the code I am using so far that was kindly provided to me, I have been amending it all day with no success</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n        Dim I As Integer\n    Dim maxRow As Integer\n\n    maxRow = 100\n    ListBox1.Clear\n    For I = 1 To maxRow\n        If (DateDiff(\"d\", Now, Range(\"J\" &amp; I).Value) &gt; 14) Then\n            ListBox1.AddItem Range(\"A\" &amp; I)\n        End If\n    Next I\n    End Sub\n</code></pre>\n\n<p>I have also included a link to my document so you can see if its any other coding that could be causing it  not work work.</p>\n\n<p>Thank you in advance </p>\n\n<p><a href=\"https://www.dropbox.com/s/u8ex7nstlbju6sm/tracker%20new.xlsm?dl=0\" rel=\"nofollow\">Click here to download my document</a></p>\n"}, {"tags": ["vba", "excel", "asynchronous", "sap"], "comments": [{"owner": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "edited": false, "score": 1, "creation_date": 1458673300, "post_id": 36162050, "comment_id": 59963123, "body": "Can you post the code you&#39;re working with?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1458688098, "post_id": 36162050, "comment_id": 59971031, "body": "I&#39;ve had this issue before in both VBA and C# when debugging code that references COM libraries.  No idea what causes it, but I suspect that something in the interop process gets in the way of the debugging symbols generating asserts.  Only solution I&#39;ve found is to curse at it and try to find the best places to insert breakpoints."}], "owner": {"reputation": 136, "user_id": 3507691, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/o653q.png?s=128&g=1", "display_name": "Tocchetto", "link": "https://stackoverflow.com/users/3507691/tocchetto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1458771931, "creation_date": 1458670159, "last_edit_date": 1531164843, "question_id": 36162050, "link": "https://stackoverflow.com/questions/36162050/vba-code-rushing-on-debugg-mode-while-interacting-with-sap", "title": "VBA code rushing on debugg mode while interacting with SAP", "body": "<p>I'm having some issues with my code that I wasn't able to find anywhere.</p>\n\n<p><strong>Issue</strong>: While debugging my code, running it line by line with F8 in Excel, at some specific points excel does not wait for the application with which it's interacting to finish and proceeds to execute the rest of the code.</p>\n\n<p><strong>What is the macro:</strong> It's an a macro to automatically input information on SAP, in this case VA02. I do belive that this question is more VBA related than SAP related thus I'm posting here and not on SCN.</p>\n\n<p><strong>Where the problem occurs:</strong> The issue only happens when I'm changing the partners numbers in the Partner tab(either header or line item level). I've also saw this happens whenever I was trying to add something on the Conditions tab.</p>\n\n<p><strong>What error does it cause?:</strong>  None, that's the odd part. While debugging, after I execute the line to change the Bill to Party for example ( Only change the number, no Enter or any other key is send) the code keeps running and execute the next lines. The even more off thing is that SAP seems to still be processing some of the changes but the VBA code keeps running without errors, meaning that SAP is not on the screen its showing.</p>\n\n<p><strong>So, if there's no errors what you want?:</strong> Well, while in regullar run mode it work flawleslly, this issue really makes it very hard to debug, forcing me to put a breakpoint in every... single...code...line...</p>\n\n<p><strong>What have you tried?:</strong> I've looked into Async and forced sync, no avail. Also looked in something related to Background Refresh but I guess that's only for query connections, I tried it with SAP GUI connection but also didn't worked.</p>\n\n<p>Hope anyone can shed some light on this subject, maybe saw this previously. I will try to test on a peers computes but didn't had the chance yet, will post my findings after.</p>\n\n<p>Thank you for reading and maybe replying =)</p>\n\n<p>This is just a pice of the code as it's huge, I've noticed the problem is different parts, always the part that's inputing info on SAP. My peer write similar codes, that do the same thing on the same fields and he never got this erro so I think it might be related to excel somehow</p>\n\n<pre><code>    'Bill site\nConnection.findById(\"ses[\" &amp; Sesn &amp; \"]/wnd[0]/usr/\" &amp; ref &amp; \"/subSUBSCREEN_PARTNER_OVERVIEW:SAPLV09C:1000/tblSAPLV09CGV_TC_PARTNER_OVERVIEW/ctxtGVS_TC_DATA-REC-PARTNER[1,1]\").Text = Dwks.Cells(2, \"N\")\n</code></pre>\n\n<p>For this program the erro usually start on this line, but on other ones i've seen it start on different ones. There's nothing special about this code line, i've used it many times. What comes before it is also pretty standard, just the SAP connection. I'm avoiding post the code here because I'm sure that this is not the cause of the problem, is the same sintax i've always used, with the same elements. This is something excel related.</p>\n"}, {"tags": ["vba", "forms", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1458674968, "post_id": 36161850, "comment_id": 59964122, "body": "Look into the concept of BuildingBlocks, to start with. And look at using a MacroButton field for the button, otherwise you run into problems linking the code to the button."}], "answers": [{"comments": [{"owner": {"reputation": 791, "user_id": 2558764, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81db839a7ab31ef6790518a9851782af?s=128&d=identicon&r=PG", "display_name": "kecman", "link": "https://stackoverflow.com/users/2558764/kecman"}, "edited": false, "score": 0, "creation_date": 1458762945, "post_id": 36170520, "comment_id": 60010274, "body": "One more question: Instead of &quot;click here&quot; I have inserted an picture. But it&#39;s not clickable.. in order to run macro, user must click on a small portion of grey background of that image. How can I make this picture clickable, so when it is clicked, macro assigned to MacroButton is run?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 791, "user_id": 2558764, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81db839a7ab31ef6790518a9851782af?s=128&d=identicon&r=PG", "display_name": "kecman", "link": "https://stackoverflow.com/users/2558764/kecman"}, "edited": false, "score": 0, "creation_date": 1458768613, "post_id": 36170520, "comment_id": 60013335, "body": "Added to the &quot;Answer&quot; - I hadn&#39;t realized the behavior had changed &lt;sigh&gt;"}, {"owner": {"reputation": 791, "user_id": 2558764, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81db839a7ab31ef6790518a9851782af?s=128&d=identicon&r=PG", "display_name": "kecman", "link": "https://stackoverflow.com/users/2558764/kecman"}, "edited": false, "score": 0, "creation_date": 1458769218, "post_id": 36170520, "comment_id": 60013568, "body": "I tried with first option, but when I change my MacroButton to look like this: &#39;{MacroButton MyMacro {IncludePicture &quot;C:\\Users\\stefanmarkovic\\Desktop\\Untitled.png&quot; }}&#39;  it only displays text: &quot;{IncludePicture &quot;C:\\Users\\stefanmarkovic\\Desktop\\Untitled.png&quot; }, and no image is loaded when i press Shift+F9"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 791, "user_id": 2558764, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81db839a7ab31ef6790518a9851782af?s=128&d=identicon&r=PG", "display_name": "kecman", "link": "https://stackoverflow.com/users/2558764/kecman"}, "edited": false, "score": 0, "creation_date": 1458769681, "post_id": 36170520, "comment_id": 60013799, "body": "Don&#39;t forget to use Ctrl+F9 to insert the field code brackets! And use double-backslashes for the file path - I missed that the SO site requires me to escape backslashes for them to be visible, so I&#39;ve fixed that &lt;sigh&gt; And it&#39;s ctrl+shift+f9 (a correction I made a few minutes ago)."}, {"owner": {"reputation": 791, "user_id": 2558764, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81db839a7ab31ef6790518a9851782af?s=128&d=identicon&r=PG", "display_name": "kecman", "link": "https://stackoverflow.com/users/2558764/kecman"}, "edited": false, "score": 0, "creation_date": 1458773990, "post_id": 36170520, "comment_id": 60015562, "body": "I have managed somehow to make the picture clickable, but when the macro makes a copy of content, and I click on the new, copied picture, it doesn&#39;t run macro.. yet i can click that little portion of grey background around it and edit that MacroButton code, but I need it to be automatically like for first one."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 791, "user_id": 2558764, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81db839a7ab31ef6790518a9851782af?s=128&d=identicon&r=PG", "display_name": "kecman", "link": "https://stackoverflow.com/users/2558764/kecman"}, "edited": false, "score": 0, "creation_date": 1458774705, "post_id": 36170520, "comment_id": 60015809, "body": "It&#39;s not clear from which &quot;version&quot; of the composite field code you&#39;re creating the BuildingBlock... Or are you not using a BuildingBlock...? We&#39;ve reached a point where providing sufficient information is going to be a problem."}, {"owner": {"reputation": 791, "user_id": 2558764, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81db839a7ab31ef6790518a9851782af?s=128&d=identicon&r=PG", "display_name": "kecman", "link": "https://stackoverflow.com/users/2558764/kecman"}, "edited": false, "score": 0, "creation_date": 1458776051, "post_id": 36170520, "comment_id": 60016301, "body": "I create Building Block after I set that MacroButton, and I include it to the BuildingBlock."}, {"owner": {"reputation": 791, "user_id": 2558764, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81db839a7ab31ef6790518a9851782af?s=128&d=identicon&r=PG", "display_name": "kecman", "link": "https://stackoverflow.com/users/2558764/kecman"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1458776277, "post_id": 36170520, "comment_id": 60016372, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/107188/discussion-between-kecman-and-cindy-meister\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1458769592, "last_edit_date": 1458769592, "creation_date": 1458711186, "answer_id": 36170520, "question_id": 36161850, "link": "https://stackoverflow.com/questions/36161850/word-macro-to-add-predefined-content-at-the-end-of-document-on-click-of-button/36170520#36170520", "title": "Word Macro to add predefined content at the end of document on click of button", "body": "<p>The main problem with what you want to do is dynamically linking the button to the macro code to be executed. The most obvious type of button to use is the legacy ActiveX control in the Ribbon's Developer tab. But that requires its own procedure entry in the document's <code>ThisDocument</code> class module. While it's possible to add code to modules \"on the fly\" this involves disabling a security option.</p>\n\n<p>A more straignt forward approach is to use the <code>MacroButton</code> field. This creates a clickable text within the document. It can display text or a graphic (so that it looks like a button) and is assigned the name of any public Sub that takes no parameters:</p>\n\n<pre><code> { MACROBUTTON NameOfMacro Click here }\n</code></pre>\n\n<p>Ctrl+F9 to insert the field code brackets; Alt+F9 to toggle between field code and field result.</p>\n\n<p><strong>Graphics in Word 2010 and later</strong>:* The was a change to the graphics engine in Word 2010 which affects the behavior of graphics objects in the MacroButton field. Clicking the object triggers the Ribbon utility for working with graphics - the field code no longer \"hides\" the graphic. There are a number of ways you can work around this:</p>\n\n<ol>\n<li><p>Use an IncludePicture field (which works with the old graphics format) to bring in an outside picture file. Once the linked picture is in the field it can be converted to a static picture by selecting the IncludePicture field and pressing Ctrl+Shift+F9. Word respects the old graphic format and the picture is click-able.</p>\n\n<p>{ MacroButton NameOfMacro {IncludePicture \"C:\\\\Path\\\\picture.jpg\" } }</p></li>\n<li><p>Use the old *.doc file format. Note that this will restrict some of the things that can be done with the document, but it will force use of the old graphics engine.</p></li>\n<li>Instead of a MacroButton field, use the WindowBeforeDoubleClick event or WindowSelectionChange event to run the code.</li>\n</ol>\n\n<p>*With the exception of unlinking the IncludePicture field (which I discovered myself), this information came from <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-word/using-graphic-with-macrobutton/a9c1ef3b-cf1f-48ba-92a8-c44bffcdc131?auth=1\" rel=\"nofollow\" title=\"this discussion on the Microsoft Answers site\">this discussion on the Microsoft Answers site</a></p>\n\n<p>If you want to run the macro with a single rather than a double-click (the default) you need to run the following line of code. This applies to the entire Word application and needs to be run everytime Word restarts. You could put it in an <code>AutoNew</code> macro in the template / <code>AutoOpen</code> macro in the document:</p>\n\n<pre><code>Application.Options.ButtonFieldClicks = 1\n</code></pre>\n\n<p>The simplest way to store the entire content you want to insert repeatedly is as a Building Block (formerly known as AutoText). </p>\n\n<p>BuildingBlocks are stored in templates. If your document is being created from a template, that would be the logical place. Another possibility would be a special template you use for this purpose. Normal.dotm can also be used but keep in mind this does sometimes get removed.</p>\n\n<p>(Note: if you're using a template for the document that would also be the best place to store the macro attached to the macro button.)</p>\n\n<p>Once this is set up, all your code needs to do is insert the BuidlingBlock at the end of the document.</p>\n"}], "owner": {"reputation": 791, "user_id": 2558764, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81db839a7ab31ef6790518a9851782af?s=128&d=identicon&r=PG", "display_name": "kecman", "link": "https://stackoverflow.com/users/2558764/kecman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 36170520, "answer_count": 1, "score": 0, "last_activity_date": 1593885204, "creation_date": 1458669507, "last_edit_date": 1593885204, "question_id": 36161850, "link": "https://stackoverflow.com/questions/36161850/word-macro-to-add-predefined-content-at-the-end-of-document-on-click-of-button", "title": "Word Macro to add predefined content at the end of document on click of button", "body": "<p>I have an document in word, which has some fields to be filled, and an button to which I want to assign a macro. When that button is clicked, that same form with empty fields needs to be appended to the end of document, including the button (which can be clicked again and do the same thing).</p>\n\n<p>Here is the document I have:\n<a href=\"https://drive.google.com/file/d/0B_2kyqxMx5x4UkxfOHJhOGVPdnc/view?usp=sharing\" rel=\"nofollow\">https://drive.google.com/file/d/0B_2kyqxMx5x4UkxfOHJhOGVPdnc/view?usp=sharing</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1458674148, "post_id": 36162196, "comment_id": 59963627, "body": "If these are sorted in xlAscending order then a <code>MATCH(1E-99, H:H)</code> can find the row containing the last non-positive number very quickly. Offset 1 row down and grab everything to the bottom should be quick."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1458674628, "post_id": 36162196, "comment_id": 59963912, "body": "@Jeeped - never thought of that, thanks for the tip!"}, {"owner": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "edited": false, "score": 0, "creation_date": 1458676195, "post_id": 36162196, "comment_id": 59964833, "body": "Thanks @BruceWayne I tried this one first because it seemed closer to my coding style but I got stuck in the end. It wouldn&#39;t execute the second with statement. I am fairly new to vba so not sure why. I tried a number of different tweaks but it didn&#39;t work."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "edited": false, "score": 0, "creation_date": 1458678336, "post_id": 36162196, "comment_id": 59966226, "body": "@chefAna - I wonder if it&#39;s the quote types I used accidentally in <code>&quot;Sheet1&quot;</code> when I declare <code>myWS</code>. Those should be straight quotes. Oh well, glad Jeeped got it!"}, {"owner": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "edited": false, "score": 0, "creation_date": 1458732416, "post_id": 36162196, "comment_id": 59988990, "body": "No, I had used the generic &quot;Sheet1&quot; to preserve the integrity of my document so I didn&#39;t copy or paste or anything. It was in the 2nd with statement:  If .cells(i,8).Value &gt; 0 Then         .Rows(i).EntireRow.Delete"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1458670644, "creation_date": 1458670644, "answer_id": 36162196, "question_id": 36161805, "link": "https://stackoverflow.com/questions/36161805/delete-rows-where-hh-has-positive-values/36162196#36162196", "title": "Delete rows where &quot;H:H&quot; has positive values", "body": "<p>Try this, loop through each cell in the range. Double check that my <code>lastRow</code> is an accurate and sustainable way to get the last row in your project:</p>\n\n<pre><code>Sub t()\nDim lastRow as Long, i as Long\nDim myWS as worksheet\nDim mySourceWB as workbook\nDim cel as Range\n\nSet mySourceWB = Source_Workbook \u2018 you will probably need to tweak this\nSet myWS = mySourceWB.Worksheets(\u201cSheet1\u201d)\n\nmyWS.Sort.SortFields.Add Key:=myWS.Range(\"H:H\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n\nWith myWS.Sort\n    .SetRange Range(\"A1:R65800\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With \u2018myWS.sort\n\nWith myWS\n    lastRow = .Cells(.Rows.Count,8).End(xlup).Row\n    For i = lastRow to 1 \u2018 change to 2, if you have headers\n    If .cells(i,8).Value &gt; 0 Then\n        .Rows(i).EntireRow.Delete\n    End if\n    Next i\nEnd with \u2018myWS\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "edited": false, "score": 0, "creation_date": 1458676012, "post_id": 36162440, "comment_id": 59964712, "body": "Thanks so much for your help! It worked perfectly and I will be able to use this method for other reports."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1458671520, "creation_date": 1458671520, "answer_id": 36162440, "question_id": 36161805, "link": "https://stackoverflow.com/questions/36161805/delete-rows-where-hh-has-positive-values/36162440#36162440", "title": "Delete rows where &quot;H:H&quot; has positive values", "body": "<p>This seems suited to a single field <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow\">Range.AutoFilter Method</a>.</p>\n\n<pre><code>Sub del_positives()\n    With ActiveWorkbook.Worksheets(\"Sheet1\")\n        'turn off any exiting autofilter\n        If .AutoFilterMode Then .AutoFilterMode = False\n        'work with the block of cells radiating out from A1\n        With .Cells(1, 1).CurrentRegion\n            'apply the positive number filter to column H\n            .AutoFilter field:=8, Criteria1:=\"&gt;0\"\n            'step off the header row\n            With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                'determine if there are cells to delete\n                If CBool(Application.Subtotal(102, .Cells)) Then\n                    'if there are, delete them\n                    .SpecialCells(xlCellTypeVisible).EntireRow.Delete\n                End If\n            End With\n            'remove the filter\n            .AutoFilter\n            'if you still want to sort, then do so\n            .Cells.Sort Key1:=.Columns(8), Order1:=xlAscending, _\n                        Orientation:=xlTopToBottom, Header:=xlYes\n        End With\n        If .AutoFilterMode Then .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>I've added a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow\">Range.Sort method</a> in case you wanted to continue with a sorted output.</p>\n"}], "owner": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 36162440, "answer_count": 2, "score": 1, "last_activity_date": 1458671612, "creation_date": 1458669330, "last_edit_date": 1458671612, "question_id": 36161805, "link": "https://stackoverflow.com/questions/36161805/delete-rows-where-hh-has-positive-values", "title": "Delete rows where &quot;H:H&quot; has positive values", "body": "<p>I need to delete rows where the positive values begin in column H after sorting. I was trying to use the find feature. I know >0 does not work but not sure where to go from here. I can switch the sort to descending and search for \"-\" if I can figure out how to select upwards and delete. </p>\n\n<pre><code>    Source_Workbook.Worksheets(\"Sheet1\").Activate\nSource_Workbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"H:H\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nCells.Select\n\nWith ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n    .SetRange Range(\"A1:R65800\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\n\nColumns(\"H:H\").Select\nSelection.Find(What:=\"&gt;0\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    False, SearchFormat:=False).Select\n\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nSelection.EntireRow.Delete\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 5822893, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28069d0d8ec9855aa00cb68da126ed66?s=128&d=identicon&r=PG&f=1", "display_name": "David S.", "link": "https://stackoverflow.com/users/5822893/david-s"}, "edited": false, "score": 0, "creation_date": 1458670607, "post_id": 36162006, "comment_id": 59961475, "body": "So would I use it like this?: StoreTableName = A3.ListObject.Name"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 109, "user_id": 5822893, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28069d0d8ec9855aa00cb68da126ed66?s=128&d=identicon&r=PG&f=1", "display_name": "David S.", "link": "https://stackoverflow.com/users/5822893/david-s"}, "edited": false, "score": 0, "creation_date": 1458670657, "post_id": 36162006, "comment_id": 59961501, "body": "StoreTableName = Range(&quot;A3&quot;).ListObject.Name"}, {"owner": {"reputation": 109, "user_id": 5822893, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28069d0d8ec9855aa00cb68da126ed66?s=128&d=identicon&r=PG&f=1", "display_name": "David S.", "link": "https://stackoverflow.com/users/5822893/david-s"}, "edited": false, "score": 0, "creation_date": 1458743683, "post_id": 36162006, "comment_id": 59997218, "body": "And how about if I&#39;d like to have that range stored in a variable called &quot;GetCellsTable&quot;? I am getting close to what I need as I tinker."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 109, "user_id": 5822893, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28069d0d8ec9855aa00cb68da126ed66?s=128&d=identicon&r=PG&f=1", "display_name": "David S.", "link": "https://stackoverflow.com/users/5822893/david-s"}, "edited": false, "score": 0, "creation_date": 1458806588, "post_id": 36162006, "comment_id": 60024756, "body": "I don&#39;t understand your question. Do you mean you want to create a function called GetCellsTable?"}, {"owner": {"reputation": 109, "user_id": 5822893, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28069d0d8ec9855aa00cb68da126ed66?s=128&d=identicon&r=PG&f=1", "display_name": "David S.", "link": "https://stackoverflow.com/users/5822893/david-s"}, "edited": false, "score": 0, "creation_date": 1458818910, "post_id": 36162006, "comment_id": 60031473, "body": "I was thinking something like this: Dim GetCellsTable as ? StoreTableName = Range(GetCellsTable).ListObject.Name I am just not sure if that is the correct way to state this."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 109, "user_id": 5822893, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28069d0d8ec9855aa00cb68da126ed66?s=128&d=identicon&r=PG&f=1", "display_name": "David S.", "link": "https://stackoverflow.com/users/5822893/david-s"}, "edited": false, "score": 0, "creation_date": 1458831447, "post_id": 36162006, "comment_id": 60039748, "body": "I&#39;m still not quite sure what you are after. Perhaps you can provide some context? See my edit above which is maybe what you are after."}, {"owner": {"reputation": 109, "user_id": 5822893, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28069d0d8ec9855aa00cb68da126ed66?s=128&d=identicon&r=PG&f=1", "display_name": "David S.", "link": "https://stackoverflow.com/users/5822893/david-s"}, "edited": false, "score": 0, "creation_date": 1458832265, "post_id": 36162006, "comment_id": 60040354, "body": "Actually I believe what you stated in your first code snippet was what I was looking for. Thank you!"}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": true, "score": 3, "last_activity_date": 1458831409, "last_edit_date": 1458831409, "creation_date": 1458669996, "answer_id": 36162006, "question_id": 36161769, "link": "https://stackoverflow.com/questions/36161769/input-cell-address-get-table-name/36162006#36162006", "title": "Input cell address, get table name", "body": "<pre><code>MyVariable = SomeCell.ListObject.Name\n</code></pre>\n\n<p>Edit:</p>\n\n<p>If you want to store the cell address (say cell \"A3\") in a variable and then use it to get the table name:</p>\n\n<pre><code>Dim GetCellsTable As String\nGetCellsTable = \"A3\"\nMyTableName = Range(GetCellsTable).ListObject.Name\n</code></pre>\n\n<p>Or, if you want to store the cell itself as a range object in a variable:</p>\n\n<pre><code>Dim GetCellsTable as Range\nSet GetCellsTable = Range(\"A3\")\nMyTableName = GetCellsTable.ListObject.Name\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 5822893, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28069d0d8ec9855aa00cb68da126ed66?s=128&d=identicon&r=PG&f=1", "display_name": "David S.", "link": "https://stackoverflow.com/users/5822893/david-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 36162006, "answer_count": 1, "score": 2, "last_activity_date": 1458831998, "creation_date": 1458669185, "last_edit_date": 1458831998, "question_id": 36161769, "link": "https://stackoverflow.com/questions/36161769/input-cell-address-get-table-name", "title": "Input cell address, get table name", "body": "<p>I am looking for some excel VBA code that when I input a cell address it'll give me the name of the table that that cell is apart of of and store the name of the table in a variable. I would also like to store the cell address in a variable called \"GetCellsTable\".</p>\n\n<p>Is there anyway I can go about doing this?</p>\n\n<p>Example:</p>\n\n<pre><code>Dim StoreTableName as String?\nDim GetCellsTable as ?\nStoreTableName = Range(GetCellsTable).ListObject.Name\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1458668873, "post_id": 36161515, "comment_id": 59960364, "body": "Not exactly sure what you&#39;re trying to do.  The problem most likely stems from the fact that you&#39;re trying to use an unset range object in a for loop.  You Dim the object, but never set it to anything so one of your errors is probably being thrown from an &quot;nothing&quot; object.  What are you looking for in Range(&quot;x030Pols&quot;)?  Not to mention I don&#39;t think you can iterate through a range with another range object.  In my head, it would only execute once since that range would only appear once (if any) in the specified range."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1458668996, "post_id": 36161515, "comment_id": 59960427, "body": "Also, you&#39;re only passing one argument to your function, which is Acell as a range object."}, {"owner": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "edited": false, "score": 0, "creation_date": 1458669117, "post_id": 36161515, "comment_id": 59960508, "body": "Try adding <code>.Cells</code> to the end of your <code>For Each</code> line"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1458669271, "post_id": 36161515, "comment_id": 59960602, "body": "Post your function code pls."}, {"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1458669427, "post_id": 36161515, "comment_id": 59960705, "body": "@StormsEdge Apologies, I tried to simplify the question by only including ONE of the Range objects. I am passing 2 Ranges, a loop within a loop, but this is the code for just one . I have used the For Each format like this many times before. I can refer to the properties of each of the cells within my loop but when I try to pass them to the Function, the error occurs."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1458669715, "post_id": 36161515, "comment_id": 59960887, "body": "If you can post the rest of the code it would be helpful.  There is a piece missing somewhere and it&#39;s difficult to tell what it is elsewhere.  You can definitely use For Each, but my point was that it depends entirely on how you&#39;re using the range object.  Is OneCell a global object(Guessing by it&#39;s naming convention?)?  .Cells might work like Dan mentioned"}, {"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "reply_to_user": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1458669731, "post_id": 36161515, "comment_id": 59960902, "body": "@ExcelDevelopers It&#39;s now in the question."}, {"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "reply_to_user": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "edited": false, "score": 0, "creation_date": 1458669777, "post_id": 36161515, "comment_id": 59960924, "body": "@Dan, I tried Cells but it didn&#39;t work."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 1, "creation_date": 1458669900, "post_id": 36161515, "comment_id": 59961025, "body": "Your function requires two arguments but you are only passing one."}, {"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "reply_to_user": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1458670048, "post_id": 36161515, "comment_id": 59961120, "body": "@ExcelDevelopers The full code is now in the question - with 2 arguments."}], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "edited": false, "score": 0, "creation_date": 1458670476, "post_id": 36162032, "comment_id": 59961375, "body": "Thank you very much! I seriously had no idea that Dim worked this way. I&#39;ve used this syntax on ALL of my VBA projects to date and obviously getting variants all over the place instead of what I actually thought I was getting. I&#39;ve changed it, tested it and it works, thank you!"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 5, "last_activity_date": 1458670097, "creation_date": 1458670097, "answer_id": 36162032, "question_id": 36161515, "link": "https://stackoverflow.com/questions/36161515/excel-vba-range-object-as-parameter/36162032#36162032", "title": "Excel VBA Range object as parameter", "body": "<p>The problem is in your variable declaration:</p>\n\n<pre><code>Dim OneCell, TwoCell As Range\n</code></pre>\n\n<p>This is the same as writing:</p>\n\n<pre><code>Dim oneCell as Variant\nDim TwoCell as Range\n</code></pre>\n\n<p>Instead:</p>\n\n<pre><code>Dim oneCell as Range\nDim TwoCell as Range\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>Dim OneCell as Range, TwoCell As Range\n</code></pre>\n\n<p>So that VBA doesn't have to guess at your type.</p>\n"}], "owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 0, "accepted_answer_id": 36162032, "answer_count": 1, "score": 0, "last_activity_date": 1458820703, "creation_date": 1458668396, "last_edit_date": 1458820703, "question_id": 36161515, "link": "https://stackoverflow.com/questions/36161515/excel-vba-range-object-as-parameter", "title": "Excel VBA Range object as parameter", "body": "<p>I've written this pretty short VBA macro in Excel which passes 2 Range objects to my own Function. This is the entire code:</p>\n\n<pre><code>Sub Cmp()\n\nDim OneMatch As Boolean\nDim NoMatches As Integer\nDim OneCell, TwoCell As Range\n\nFor Each OneCell In Range(\"X030Pols\").Cells\n   OneMatch = False: NoMatches = 0\n\n   For Each TwoCell In Range(\"X206Pols\").Cells\n\n           TwoCell.Offset(0, 23).Value = 0\n\n   Next\n\n   For Each TwoCell In Range(\"X206Pols\")\n       If TwoCell.Offset(0, 22).Value = \"\" Then\n           TwoCell.Offset(0, 23).Value = PolComp(OneCell, TwoCell)\n           If TwoCell.Offset(0, 23).Value &gt; 0 Then\n               NoMatches = NoMatches + 1\n           End If\n       End If\n   Next\n\n    If NoMatches = 1 Then\n       TwoCell.Offset(0, 22).Value = OneCell.Offset(0, -1).Value\n       OneCell.Offset(0, 22).Value = TwoCell.Offset(0, -1).Value\n    End If\nNext\n\nEnd Sub\nPrivate Function PolComp(Acell As Range, Bcell As Range) As Integer\n\nIf Left(Acell.Offset(0, 1).Value, 4) = Left(Bcell.Offset(0, 1).Value, 4) Then\n   PolComp = PolComp + 50\nEnd If\n\nIf Acell.Offset(0, 6).Value = Bcell.Offset(0, 6).Value And Acell.Offset(0, 6).Value &lt;&gt; \"\" Then\n   PolComp = PolComp + 50\nEnd If\n\nIf Acell.Offset(0, 8).Value = Bcell.Offset(0, 8).Value Then\n   PolComp = PolComp + 50\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>but when I try to run it I get this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ozEsn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ozEsn.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So OneCell is defined as a Range, my function uses a Range, but there's a mismatch. The error occurs as it tries to parse my code before it runs anything.</p>\n\n<p>I could work around it but I'm more concerned about understanding what I've done wrong.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458669174, "post_id": 36161391, "comment_id": 59960541, "body": "not sure, but try ws.range(cells(j,5),cells(j+51,5)).select    ws.paste  What do you mean by multiply them?"}, {"owner": {"reputation": 1, "user_id": 6100030, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154053940351532/picture?type=large", "display_name": "Peter S&#248;gaard", "link": "https://stackoverflow.com/users/6100030/peter-s%c3%b8gaard"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1458670978, "post_id": 36161391, "comment_id": 59961685, "body": "Thank you ! That was it :D"}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1458670561, "creation_date": 1458670561, "answer_id": 36162161, "question_id": 36161391, "link": "https://stackoverflow.com/questions/36161391/copying-cells-and-multiply-them-then-paste-each-cell-beneath-each-other/36162161#36162161", "title": "Copying cells and multiply them, then paste each cell beneath each other", "body": "<p>I'm not sure if I understood correctly as it wasn't obvious to me by looking at your code. But maybe you've been looking for something like this:</p>\n\n<pre><code>Option Explicit\n\nSub Copy_bud()\n\nDim WB As Workbook\nDim WS As Worksheet\n\nDim lngRow As Long\nDim lngLastRow As Long\n\nSet WB = ThisWorkbook\nSet WS = WB.Worksheets(\"Ark1\")\n\nlngLastRow = WS.Cells(1, 1).CurrentRegion.Rows.Count\nFor lngRow = 1 To lngLastRow\n    WS.Range(WS.Cells(1, 4 + lngRow), WS.Cells(lngLastRow, 4 + lngRow)).Value2 = WS.Cells(lngRow, 1).Value2\nNext lngRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6100030, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154053940351532/picture?type=large", "display_name": "Peter S&#248;gaard", "link": "https://stackoverflow.com/users/6100030/peter-s%c3%b8gaard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1458670561, "creation_date": 1458668068, "last_edit_date": 1531164843, "question_id": 36161391, "link": "https://stackoverflow.com/questions/36161391/copying-cells-and-multiply-them-then-paste-each-cell-beneath-each-other", "title": "Copying cells and multiply them, then paste each cell beneath each other", "body": "<p>I want to copy 90 cells, and each cell has to be copied into another column. Every copied cell have to become 52 identical cells beneath each other and all the cells should be created without any blanks. Therefore, I should end up with 4680 cells, but the code doesn't work.</p>\n\n<p>Can anyone help? </p>\n\n<pre><code>Sub Copy_bud()\nDim WB As Workbook\nDim WS As Worksheet\nDim i, j As Long\nDim kopi As Boolean\n\nSet WB = ThisWorkbook\nSet WS = WB.Worksheets(\"Ark1\")\n\nn = WS.Cells(1, 1).CurrentRegion.Rows.Count\nj = 1\n\nFor i = 1 To n\n    While kopi = True\n        WS.Cells(i, 1).Select\n        Selection.copy\n        WS.Cells(j, 5).Paste\n        j = j + 51\n    Wend \n  Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1458668032, "post_id": 36161094, "comment_id": 59959759, "body": "Why are you looking at <b>xlPart</b>? Should the X be the only thing in the cell?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4986979"}, "edited": false, "score": 0, "creation_date": 1458668143, "post_id": 36161094, "comment_id": 59959832, "body": "Yes, it is a giant grid of blank cells with only an X where there is a &quot;hit&quot;.  This grid is roughly 12.6 million cells"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4986979"}, "edited": false, "score": 0, "creation_date": 1458669150, "post_id": 36161414, "comment_id": 59960526, "body": "&quot;Invalid or unqualified reference&quot; for  .Range"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458669923, "post_id": 36161414, "comment_id": 59961041, "body": "@Antibios - you must have copied the code b4 my edits. glad you got your answer, either way."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1458668522, "last_edit_date": 1458668522, "creation_date": 1458668132, "answer_id": 36161414, "question_id": 36161094, "link": "https://stackoverflow.com/questions/36161094/need-to-loop-a-formula-increasing-until-last-column/36161414#36161414", "title": "Need to loop a formula increasing until last column", "body": "<p>Here's a loop that should get you what you need based on your description:</p>\n\n<pre><code>Sub LoopColumns()\n\nDim ws1 As Worksheet\nSet ws1 = Worksheets(\"Sheet1\") 'chnage as needed\n\nDim rColumns As Range, rCell As Range\nSet rColumns = ws1.Range(ws1.Range(\"B2\"), ws1.Range(\"B2\").End(xlToRight)) ' asssumes contiguous range of headers\n\nFor Each rCell In rColumns\n\n    rCell.EntireColumn.Replace What:=\"X\", Replacement:=rCell.Value2, LookAt:=xlPart, _\n        SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4986979"}, "edited": false, "score": 0, "creation_date": 1458669231, "post_id": 36161483, "comment_id": 59960582, "body": "This works perfectly.  You just saved me couple hours of work. I owe you a beer"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1458668313, "creation_date": 1458668313, "answer_id": 36161483, "question_id": 36161094, "link": "https://stackoverflow.com/questions/36161094/need-to-loop-a-formula-increasing-until-last-column/36161483#36161483", "title": "Need to loop a formula increasing until last column", "body": "<p>I think that row 2 is one that you should base the extent upon seeing as that is what gets transferred in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194086.aspx\" rel=\"nofollow\">Range.Replace method</a>.</p>\n\n<pre><code>Sub X_to_HDR()\n    Dim c As Long\n    With Worksheets(\"sheet1\")\n        With .Cells(2, 1).CurrentRegion\n            With .Resize(.Rows.Count - 1, .Columns.Count - 1).Offset(1, 1)\n                For c = 1 To .Columns.Count\n                    With .Columns(c)\n                        .Replace What:=\"X\", Replacement:=Chr(61) &amp; .Parent.Cells(2, c + 1).Address(0, 0), _\n                                 LookAt:=xlWhole, MatchCase:=False\n                    End With\n                Next c\n            End With\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>I've changed your <em>xlPart</em> to <em>xlWhole</em>; change this back if you feel the original was more appropriate.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4986979"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 36161483, "answer_count": 2, "score": 0, "last_activity_date": 1459500402, "creation_date": 1458667226, "last_edit_date": 1459500402, "question_id": 36161094, "link": "https://stackoverflow.com/questions/36161094/need-to-loop-a-formula-increasing-until-last-column", "title": "Need to loop a formula increasing until last column", "body": "<p>I looked around but can't find quite exactly a function that does what I need. I am basically doing a find a replace but only on cells with an X and replacing with the value of it's own header</p>\n\n<pre><code>Columns(\"B:B\").Select\nSelection.Replace What:=\"X\", Replacement:=\"=B2\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nColumns(\"C:C\").Select\nSelection.Replace What:=\"X\", Replacement:=\"=C2\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nColumns(\"D:D\").Select\nSelection.Replace What:=\"X\", Replacement:=\"=D2\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n</code></pre>\n\n<p>This continues all the way until whatever the last column is. In this case it is CD. This is incredibly impractical obviously and a way to loop this, where the value for Replacement:=\"=B2\" would just go up by a column value on each pass would be ideal.</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "formulas"], "comments": [{"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1458668557, "post_id": 36161024, "comment_id": 59960137, "body": "This may help: <a href=\"http://stackoverflow.com/questions/24436389/dependent-drop-down-list-excel-unique-values/24438387#24438387\" title=\"dependent drop down list excel unique values\">stackoverflow.com/questions/24436389/&hellip;</a>  You will need to have a dynamic list for the drop down to populate from."}, {"owner": {"reputation": 19, "user_id": 5304964, "user_type": "registered", "profile_image": "https://graph.facebook.com/982359588454279/picture?type=large", "display_name": "Kenneth Luiggi", "link": "https://stackoverflow.com/users/5304964/kenneth-luiggi"}, "reply_to_user": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1458672593, "post_id": 36161024, "comment_id": 59962679, "body": "That doesn&#39;t give me exactly what I am looking for but Thank you for the suggestion. =)"}, {"owner": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "edited": false, "score": 0, "creation_date": 1458673805, "post_id": 36161024, "comment_id": 59963413, "body": "Using VBA, you can find the IDs <a href=\"https://support.office.com/en-us/article/INDEX-function-a5dcf0dd-996d-40a4-a822-b56b061328bd?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">with an <code>INDEX</code> function</a>, store those values in an array, then create a drop-down menu using those items from the array."}, {"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1458684254, "post_id": 36161024, "comment_id": 59969387, "body": "That&#39;s just to get you started. If your list values are changing, the easiest thing to do is create a dynamic named range on a hidden sheet that holds your list values, then have that range populate itself based on your entered data using a formula.  In that scenario, the second and third drop downs are populated based on the first and second respectively. Your scenario would be a little bit simpler in that you could use your days input to specify a range limit for the formula that populates your list. The pieces are there, you would just need to rearrange them."}, {"owner": {"reputation": 19, "user_id": 5304964, "user_type": "registered", "profile_image": "https://graph.facebook.com/982359588454279/picture?type=large", "display_name": "Kenneth Luiggi", "link": "https://stackoverflow.com/users/5304964/kenneth-luiggi"}, "edited": false, "score": 0, "creation_date": 1459190935, "post_id": 36161024, "comment_id": 60165050, "body": "Thank you everyone for your help and Idea&#39;s I greatly appreciate the feed back."}], "owner": {"reputation": 19, "user_id": 5304964, "user_type": "registered", "profile_image": "https://graph.facebook.com/982359588454279/picture?type=large", "display_name": "Kenneth Luiggi", "link": "https://stackoverflow.com/users/5304964/kenneth-luiggi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 509, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458670711, "creation_date": 1458666991, "last_edit_date": 1458670711, "question_id": 36161024, "link": "https://stackoverflow.com/questions/36161024/excel-fill-drop-down-list-with-automated-values", "title": "Excel fill drop down list with automated values", "body": "<p>I have a formula in excel that counts the items in a table by ID of the past few days given by a user. </p>\n\n<p><code>=COUNTIFS('Sheet1'!J:J,\"&lt;\"&amp;TODAY()+1,'Sheet1'!B:B,\"blocker\")-COUNTIFS('Sheet1'!J:J,\"&lt;\"&amp;TODAY()-F14+1,'Sheet1'!B:B,\"blocker\")</code></p>\n\n<p>Example: \nEnter the amount of past days: 10<br>\nblocker = 5</p>\n\n<p>So that being said, the goal I now have is to create a drop down list that grabs the 5 items IDs (blocker) and fills the drop down list with those IDs.</p>\n\n<pre><code>id    name          status\n231   blocker       NEW\n32    normal        ASSIGNED\n312   blocker       RESOLVED\n</code></pre>\n\n<p>etc...</p>\n\n<p>The drop down list I would prefer would be the ALT + D + L list as to the active X because it changes the cell's value and I can put conditional formatting on it.</p>\n\n<p>I do know some VBA and I have been scouring for solutions but have yet found any either in excel formula or macros would be nice.</p>\n\n<p>Appreciate all and any help, this is a great community.</p>\n\n<p>-KL</p>\n"}]